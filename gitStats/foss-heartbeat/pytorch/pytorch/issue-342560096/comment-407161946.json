{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/407161946", "html_url": "https://github.com/pytorch/pytorch/issues/9580#issuecomment-407161946", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9580", "id": 407161946, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNzE2MTk0Ng==", "user": {"login": "sadatnfs", "id": 19790145, "node_id": "MDQ6VXNlcjE5NzkwMTQ1", "avatar_url": "https://avatars2.githubusercontent.com/u/19790145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sadatnfs", "html_url": "https://github.com/sadatnfs", "followers_url": "https://api.github.com/users/sadatnfs/followers", "following_url": "https://api.github.com/users/sadatnfs/following{/other_user}", "gists_url": "https://api.github.com/users/sadatnfs/gists{/gist_id}", "starred_url": "https://api.github.com/users/sadatnfs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sadatnfs/subscriptions", "organizations_url": "https://api.github.com/users/sadatnfs/orgs", "repos_url": "https://api.github.com/users/sadatnfs/repos", "events_url": "https://api.github.com/users/sadatnfs/events{/privacy}", "received_events_url": "https://api.github.com/users/sadatnfs/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-23T18:48:04Z", "updated_at": "2018-07-23T18:48:04Z", "author_association": "NONE", "body_html": "<p>Thanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a> , this is what I changed my build call to in my Docker:</p>\n<pre><code>RUN cd /opt &amp;&amp; git clone --recursive https://github.com/pytorch/pytorch \\\n    &amp;&amp; cd pytorch &amp;&amp; git submodule update --init\n\nRUN cd /opt/pytorch &amp;&amp; \\\n    PYTHON_EXECUTABLE=/opt/conda/lib/libpython3.6m.so \\\n    PYTHON_INCLUDE_DIR=/opt/conda/include/python3.6m \\\n    FULL_CAFFE2=1 \\\n    USE_OPENMP=1 \\\n    USE_MKLDNN=1 \\\n    MKLDNN_LIBRARY=/usr/local/lib \\\n    MKLDNN_INCLUDE_DIR=/usr/local/include \\\n    MKLDNN_LIB_DIR=/usr/local/lib \\\n    python setup.py install &amp;&amp; \\\n    cd /opt &amp;&amp; rm -rf /opt/pytorch\n</code></pre>\n<p>Here's the CMake configuration :</p>\n<pre><code>-- ******** Summary ********\n-- General:\n--   CMake version         : 3.7.2\n--   CMake command         : /usr/bin/cmake\n--   Git version           : v0.1.11-9427-g14d4bdb40\n--   System                : Linux\n--   C++ compiler          : /usr/local/bin/c++\n--   C++ compiler version  : 8.1.0\n--   BLAS                  : MKL\n--   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -Wno-deprecated -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_torch -D_FORCE_INLINES -D_MWAITXINTRIN_H_INCLUDED -D__STRICT_ANSI__ -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -faligned-new\n--   Build type            : Release\n--   Compile definitions   : USE_C11_ATOMICS=1;TH_BLAS_MKL;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\n--   CMAKE_PREFIX_PATH     : /opt/conda/lib/python3.6/site-packages\n--   CMAKE_INSTALL_PREFIX  : /opt/pytorch/torch/lib/tmp_install\n-- \n--   BUILD_CAFFE2          : 1\n--   BUILD_ATEN            : ON\n--   BUILD_BINARY          : OFF\n--   BUILD_CUSTOM_PROTOBUF : ON\n--     Link local protobuf : ON\n--   BUILD_DOCS            : OFF\n--   BUILD_PYTHON          : 1\n--     Python version      : 3.6.6\n--     Python executable   : /opt/conda/bin/python\n--     Pythonlibs version  : 3.6.6+\n--     Python library      : /opt/conda/lib/python3.6\n--     Python includes     : /opt/conda/include/python3.6m\n--     Python site-packages: lib/python3.6/site-packages\n--   BUILD_SHARED_LIBS     : ON\n--   BUILD_TEST            : OFF\n--   USE_ASAN              : OFF\n--   USE_ATEN              : OFF\n--   USE_CUDA              : 0\n--   USE_ROCM              : OFF\n--   USE_EIGEN_FOR_BLAS    : \n--   USE_FFMPEG            : OFF\n--   USE_GFLAGS            : OFF\n--   USE_GLOG              : OFF\n--   USE_GLOO              : ON\n--     USE_GLOO_IBVERBS    : OFF\n--   USE_LEVELDB           : OFF\n--   USE_LITE_PROTO        : OFF\n--   USE_LMDB              : OFF\n--   USE_METAL             : OFF\n--   USE_MKL               : \n--   USE_MOBILE_OPENGL     : OFF\n--   USE_MPI               : ON\n--   USE_NCCL              : OFF\n--   USE_NERVANA_GPU       : OFF\n--   USE_NNPACK            : 1\n--   USE_OBSERVERS         : ON\n--   USE_OPENCL            : OFF\n--   USE_OPENCV            : ON\n--     OpenCV version      : 2.4.9.1\n--   USE_OPENMP            : OFF\n--   USE_PROF              : OFF\n--   USE_REDIS             : OFF\n--   USE_ROCKSDB           : OFF\n--   USE_ZMQ               : OFF\n--   USE_DISTRIBUTED       : OFF\n--   Public Dependencies  : Threads::Threads;/opt/intel/mkl/lib/intel64/libmkl_intel_lp64.so;/opt/intel/mkl/lib/intel64/libmkl_gnu_thread.so;/opt/intel/mkl/lib/intel64/libmkl_core.so;-fopenmp;/usr/lib/x86_64-linux-gnu/libpthread.so;/usr/lib/x86_64-linux-gnu/libm.so;/usr/lib/x86_64-linux-gnu/libdl.so\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_cxx.so;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi.so;gloo;aten_op_header_gen;onnxifi_loader;rt;gcc_s;gcc;dl\n-- Configuring done\n\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m-- Generating done\n\ufffd[91mCMake Warning:\n  Manually-specified variables were not used by the project:\n\n    CUDNN_INCLUDE_DIR\n    CUDNN_LIBRARY\n    CUDNN_LIB_DIR\n\n\n\ufffd[0m-- Build files have been written to: /opt/pytorch/build\n</code></pre>", "body_text": "Thanks @pjh5 , this is what I changed my build call to in my Docker:\nRUN cd /opt && git clone --recursive https://github.com/pytorch/pytorch \\\n    && cd pytorch && git submodule update --init\n\nRUN cd /opt/pytorch && \\\n    PYTHON_EXECUTABLE=/opt/conda/lib/libpython3.6m.so \\\n    PYTHON_INCLUDE_DIR=/opt/conda/include/python3.6m \\\n    FULL_CAFFE2=1 \\\n    USE_OPENMP=1 \\\n    USE_MKLDNN=1 \\\n    MKLDNN_LIBRARY=/usr/local/lib \\\n    MKLDNN_INCLUDE_DIR=/usr/local/include \\\n    MKLDNN_LIB_DIR=/usr/local/lib \\\n    python setup.py install && \\\n    cd /opt && rm -rf /opt/pytorch\n\nHere's the CMake configuration :\n-- ******** Summary ********\n-- General:\n--   CMake version         : 3.7.2\n--   CMake command         : /usr/bin/cmake\n--   Git version           : v0.1.11-9427-g14d4bdb40\n--   System                : Linux\n--   C++ compiler          : /usr/local/bin/c++\n--   C++ compiler version  : 8.1.0\n--   BLAS                  : MKL\n--   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -Wno-deprecated -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_torch -D_FORCE_INLINES -D_MWAITXINTRIN_H_INCLUDED -D__STRICT_ANSI__ -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -faligned-new\n--   Build type            : Release\n--   Compile definitions   : USE_C11_ATOMICS=1;TH_BLAS_MKL;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\n--   CMAKE_PREFIX_PATH     : /opt/conda/lib/python3.6/site-packages\n--   CMAKE_INSTALL_PREFIX  : /opt/pytorch/torch/lib/tmp_install\n-- \n--   BUILD_CAFFE2          : 1\n--   BUILD_ATEN            : ON\n--   BUILD_BINARY          : OFF\n--   BUILD_CUSTOM_PROTOBUF : ON\n--     Link local protobuf : ON\n--   BUILD_DOCS            : OFF\n--   BUILD_PYTHON          : 1\n--     Python version      : 3.6.6\n--     Python executable   : /opt/conda/bin/python\n--     Pythonlibs version  : 3.6.6+\n--     Python library      : /opt/conda/lib/python3.6\n--     Python includes     : /opt/conda/include/python3.6m\n--     Python site-packages: lib/python3.6/site-packages\n--   BUILD_SHARED_LIBS     : ON\n--   BUILD_TEST            : OFF\n--   USE_ASAN              : OFF\n--   USE_ATEN              : OFF\n--   USE_CUDA              : 0\n--   USE_ROCM              : OFF\n--   USE_EIGEN_FOR_BLAS    : \n--   USE_FFMPEG            : OFF\n--   USE_GFLAGS            : OFF\n--   USE_GLOG              : OFF\n--   USE_GLOO              : ON\n--     USE_GLOO_IBVERBS    : OFF\n--   USE_LEVELDB           : OFF\n--   USE_LITE_PROTO        : OFF\n--   USE_LMDB              : OFF\n--   USE_METAL             : OFF\n--   USE_MKL               : \n--   USE_MOBILE_OPENGL     : OFF\n--   USE_MPI               : ON\n--   USE_NCCL              : OFF\n--   USE_NERVANA_GPU       : OFF\n--   USE_NNPACK            : 1\n--   USE_OBSERVERS         : ON\n--   USE_OPENCL            : OFF\n--   USE_OPENCV            : ON\n--     OpenCV version      : 2.4.9.1\n--   USE_OPENMP            : OFF\n--   USE_PROF              : OFF\n--   USE_REDIS             : OFF\n--   USE_ROCKSDB           : OFF\n--   USE_ZMQ               : OFF\n--   USE_DISTRIBUTED       : OFF\n--   Public Dependencies  : Threads::Threads;/opt/intel/mkl/lib/intel64/libmkl_intel_lp64.so;/opt/intel/mkl/lib/intel64/libmkl_gnu_thread.so;/opt/intel/mkl/lib/intel64/libmkl_core.so;-fopenmp;/usr/lib/x86_64-linux-gnu/libpthread.so;/usr/lib/x86_64-linux-gnu/libm.so;/usr/lib/x86_64-linux-gnu/libdl.so\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_cxx.so;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi.so;gloo;aten_op_header_gen;onnxifi_loader;rt;gcc_s;gcc;dl\n-- Configuring done\n\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m\ufffd[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\n\ufffd[0m-- Generating done\n\ufffd[91mCMake Warning:\n  Manually-specified variables were not used by the project:\n\n    CUDNN_INCLUDE_DIR\n    CUDNN_LIBRARY\n    CUDNN_LIB_DIR\n\n\n\ufffd[0m-- Build files have been written to: /opt/pytorch/build", "body": "Thanks @pjh5 , this is what I changed my build call to in my Docker:\r\n```\r\nRUN cd /opt && git clone --recursive https://github.com/pytorch/pytorch \\\r\n    && cd pytorch && git submodule update --init\r\n\r\nRUN cd /opt/pytorch && \\\r\n    PYTHON_EXECUTABLE=/opt/conda/lib/libpython3.6m.so \\\r\n    PYTHON_INCLUDE_DIR=/opt/conda/include/python3.6m \\\r\n    FULL_CAFFE2=1 \\\r\n    USE_OPENMP=1 \\\r\n    USE_MKLDNN=1 \\\r\n    MKLDNN_LIBRARY=/usr/local/lib \\\r\n    MKLDNN_INCLUDE_DIR=/usr/local/include \\\r\n    MKLDNN_LIB_DIR=/usr/local/lib \\\r\n    python setup.py install && \\\r\n    cd /opt && rm -rf /opt/pytorch\r\n```\r\n\r\nHere's the CMake configuration :\r\n```\r\n-- ******** Summary ********\r\n-- General:\r\n--   CMake version         : 3.7.2\r\n--   CMake command         : /usr/bin/cmake\r\n--   Git version           : v0.1.11-9427-g14d4bdb40\r\n--   System                : Linux\r\n--   C++ compiler          : /usr/local/bin/c++\r\n--   C++ compiler version  : 8.1.0\r\n--   BLAS                  : MKL\r\n--   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -Wno-deprecated -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_torch -D_FORCE_INLINES -D_MWAITXINTRIN_H_INCLUDED -D__STRICT_ANSI__ -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -faligned-new\r\n--   Build type            : Release\r\n--   Compile definitions   : USE_C11_ATOMICS=1;TH_BLAS_MKL;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\r\n--   CMAKE_PREFIX_PATH     : /opt/conda/lib/python3.6/site-packages\r\n--   CMAKE_INSTALL_PREFIX  : /opt/pytorch/torch/lib/tmp_install\r\n-- \r\n--   BUILD_CAFFE2          : 1\r\n--   BUILD_ATEN            : ON\r\n--   BUILD_BINARY          : OFF\r\n--   BUILD_CUSTOM_PROTOBUF : ON\r\n--     Link local protobuf : ON\r\n--   BUILD_DOCS            : OFF\r\n--   BUILD_PYTHON          : 1\r\n--     Python version      : 3.6.6\r\n--     Python executable   : /opt/conda/bin/python\r\n--     Pythonlibs version  : 3.6.6+\r\n--     Python library      : /opt/conda/lib/python3.6\r\n--     Python includes     : /opt/conda/include/python3.6m\r\n--     Python site-packages: lib/python3.6/site-packages\r\n--   BUILD_SHARED_LIBS     : ON\r\n--   BUILD_TEST            : OFF\r\n--   USE_ASAN              : OFF\r\n--   USE_ATEN              : OFF\r\n--   USE_CUDA              : 0\r\n--   USE_ROCM              : OFF\r\n--   USE_EIGEN_FOR_BLAS    : \r\n--   USE_FFMPEG            : OFF\r\n--   USE_GFLAGS            : OFF\r\n--   USE_GLOG              : OFF\r\n--   USE_GLOO              : ON\r\n--     USE_GLOO_IBVERBS    : OFF\r\n--   USE_LEVELDB           : OFF\r\n--   USE_LITE_PROTO        : OFF\r\n--   USE_LMDB              : OFF\r\n--   USE_METAL             : OFF\r\n--   USE_MKL               : \r\n--   USE_MOBILE_OPENGL     : OFF\r\n--   USE_MPI               : ON\r\n--   USE_NCCL              : OFF\r\n--   USE_NERVANA_GPU       : OFF\r\n--   USE_NNPACK            : 1\r\n--   USE_OBSERVERS         : ON\r\n--   USE_OPENCL            : OFF\r\n--   USE_OPENCV            : ON\r\n--     OpenCV version      : 2.4.9.1\r\n--   USE_OPENMP            : OFF\r\n--   USE_PROF              : OFF\r\n--   USE_REDIS             : OFF\r\n--   USE_ROCKSDB           : OFF\r\n--   USE_ZMQ               : OFF\r\n--   USE_DISTRIBUTED       : OFF\r\n--   Public Dependencies  : Threads::Threads;/opt/intel/mkl/lib/intel64/libmkl_intel_lp64.so;/opt/intel/mkl/lib/intel64/libmkl_gnu_thread.so;/opt/intel/mkl/lib/intel64/libmkl_core.so;-fopenmp;/usr/lib/x86_64-linux-gnu/libpthread.so;/usr/lib/x86_64-linux-gnu/libm.so;/usr/lib/x86_64-linux-gnu/libdl.so\r\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_cxx.so;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi.so;gloo;aten_op_header_gen;onnxifi_loader;rt;gcc_s;gcc;dl\r\n-- Configuring done\r\n\u001b[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\r\n\u001b[0m\u001b[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\r\n\u001b[0m\u001b[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\r\n\u001b[0m\u001b[91mWARNING: Target \"caffe2\" requests linking to directory \"/usr/local/lib\".  Targets may link only to libraries.  CMake is dropping the item.\r\n\u001b[0m-- Generating done\r\n\u001b[91mCMake Warning:\r\n  Manually-specified variables were not used by the project:\r\n\r\n    CUDNN_INCLUDE_DIR\r\n    CUDNN_LIBRARY\r\n    CUDNN_LIB_DIR\r\n\r\n\r\n\u001b[0m-- Build files have been written to: /opt/pytorch/build\r\n```\r\n"}