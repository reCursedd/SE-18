{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/183580661", "pull_request_review_id": 114605436, "id": 183580661, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4MzU4MDY2MQ==", "diff_hunk": "@@ -329,7 +329,7 @@ IF(NOT TARGET cpuinfo)\n   SET(CPUINFO_BUILD_UNIT_TESTS OFF CACHE BOOL \"\")\n   SET(CPUINFO_BUILD_MOCK_TESTS OFF CACHE BOOL \"\")\n   SET(CPUINFO_BUILD_BENCHMARKS OFF CACHE BOOL \"\")", "path": "aten/src/ATen/CMakeLists.txt", "position": null, "original_position": 12, "commit_id": "3110556e552718370d78dee516aff57d15a9052d", "original_commit_id": "b2c29bb42ea81c12ba6e093d45fcf24d27126950", "user": {"login": "Maratyszcza", "id": 1093985, "node_id": "MDQ6VXNlcjEwOTM5ODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1093985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Maratyszcza", "html_url": "https://github.com/Maratyszcza", "followers_url": "https://api.github.com/users/Maratyszcza/followers", "following_url": "https://api.github.com/users/Maratyszcza/following{/other_user}", "gists_url": "https://api.github.com/users/Maratyszcza/gists{/gist_id}", "starred_url": "https://api.github.com/users/Maratyszcza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Maratyszcza/subscriptions", "organizations_url": "https://api.github.com/users/Maratyszcza/orgs", "repos_url": "https://api.github.com/users/Maratyszcza/repos", "events_url": "https://api.github.com/users/Maratyszcza/events{/privacy}", "received_events_url": "https://api.github.com/users/Maratyszcza/received_events", "type": "User", "site_admin": false}, "body": "I suggest to copy the code in Caffe2 (with modification for `CPUINFO_SOURCE_DIR` w.r.t. ATen path and `CAFFE2_USE_MSVC_STATIC_RUNTIME`), see: https://github.com/pytorch/pytorch/blob/master/cmake/Dependencies.cmake#L95-L118\r\nThis will support some nice options:\r\n- Overriding `cpuinfo` location for development by specifying `-DCPUINFO_SOURCE_DIR=/path/to/your/cpuinfo/checkout`.\r\n- Avoiding double-import of `cpuinfo` when `cpuinfo` is already imported through another dependency.\r\n- Linking `cpuinfo` statically even when other libs are linked dynamically. This prevents issues with mulitple cpuinfo versions overwriting each other, e.g. in conda installation.\r\n- Support MSVC build with static runtime library, if needed.", "created_at": "2018-04-24T01:12:13Z", "updated_at": "2018-11-23T15:43:03Z", "html_url": "https://github.com/pytorch/pytorch/pull/6866#discussion_r183580661", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/6866", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/183580661"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/6866#discussion_r183580661"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/6866"}}, "body_html": "<p>I suggest to copy the code in Caffe2 (with modification for <code>CPUINFO_SOURCE_DIR</code> w.r.t. ATen path and <code>CAFFE2_USE_MSVC_STATIC_RUNTIME</code>), see: <a href=\"https://github.com/pytorch/pytorch/blob/master/cmake/Dependencies.cmake#L95-L118\">https://github.com/pytorch/pytorch/blob/master/cmake/Dependencies.cmake#L95-L118</a><br>\nThis will support some nice options:</p>\n<ul>\n<li>Overriding <code>cpuinfo</code> location for development by specifying <code>-DCPUINFO_SOURCE_DIR=/path/to/your/cpuinfo/checkout</code>.</li>\n<li>Avoiding double-import of <code>cpuinfo</code> when <code>cpuinfo</code> is already imported through another dependency.</li>\n<li>Linking <code>cpuinfo</code> statically even when other libs are linked dynamically. This prevents issues with mulitple cpuinfo versions overwriting each other, e.g. in conda installation.</li>\n<li>Support MSVC build with static runtime library, if needed.</li>\n</ul>", "body_text": "I suggest to copy the code in Caffe2 (with modification for CPUINFO_SOURCE_DIR w.r.t. ATen path and CAFFE2_USE_MSVC_STATIC_RUNTIME), see: https://github.com/pytorch/pytorch/blob/master/cmake/Dependencies.cmake#L95-L118\nThis will support some nice options:\n\nOverriding cpuinfo location for development by specifying -DCPUINFO_SOURCE_DIR=/path/to/your/cpuinfo/checkout.\nAvoiding double-import of cpuinfo when cpuinfo is already imported through another dependency.\nLinking cpuinfo statically even when other libs are linked dynamically. This prevents issues with mulitple cpuinfo versions overwriting each other, e.g. in conda installation.\nSupport MSVC build with static runtime library, if needed."}