{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/411831271", "html_url": "https://github.com/pytorch/pytorch/issues/10357#issuecomment-411831271", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/10357", "id": 411831271, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTgzMTI3MQ==", "user": {"login": "davidmascharka", "id": 5611862, "node_id": "MDQ6VXNlcjU2MTE4NjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5611862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmascharka", "html_url": "https://github.com/davidmascharka", "followers_url": "https://api.github.com/users/davidmascharka/followers", "following_url": "https://api.github.com/users/davidmascharka/following{/other_user}", "gists_url": "https://api.github.com/users/davidmascharka/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmascharka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmascharka/subscriptions", "organizations_url": "https://api.github.com/users/davidmascharka/orgs", "repos_url": "https://api.github.com/users/davidmascharka/repos", "events_url": "https://api.github.com/users/davidmascharka/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmascharka/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-09T17:14:02Z", "updated_at": "2018-08-09T17:14:02Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=648532\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fritzo\">@fritzo</a> that actually points me to a problem with just <code>torch.bernoulli</code>:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span>  p <span class=\"pl-k\">=</span> torch.FloatTensor([<span class=\"pl-c1\">1.5</span>])\n\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.bernoulli(p) <span class=\"pl-c\"><span class=\"pl-c\">#</span> note no expand</span>\n<span class=\"pl-ii\">--------------------------------------------------------------------------</span><span class=\"pl-k\">-</span>\n<span class=\"pl-c1\">RuntimeError</span>                              Traceback (most recent call last)\n<span class=\"pl-k\">&lt;</span>ipython<span class=\"pl-k\">-</span><span class=\"pl-c1\">input</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">3</span><span class=\"pl-k\">-</span><span class=\"pl-ii\">10ad530fb7ed</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>()\n<span class=\"pl-ii\">----</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">1</span> torch.bernoulli(p)\n\n<span class=\"pl-c1\">RuntimeError</span>: invalid argument <span class=\"pl-c1\">1</span>: must be <span class=\"pl-k\">&gt;=</span> <span class=\"pl-c1\">0</span> <span class=\"pl-k\">and</span> <span class=\"pl-k\">&lt;=</span> <span class=\"pl-c1\">1</span> at <span class=\"pl-k\">/</span>pytorch<span class=\"pl-k\">/</span>aten<span class=\"pl-k\">/</span>src<span class=\"pl-k\">/</span><span class=\"pl-c1\">TH</span><span class=\"pl-k\">/</span>THRandom.cpp:<span class=\"pl-c1\">314</span>\n\n\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.bernoulli(p.cuda())\ntensor([<span class=\"pl-c1\">1</span>.], <span class=\"pl-v\">device</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>cuda:0<span class=\"pl-pds\">'</span></span>)</pre></div>", "body_text": "@fritzo that actually points me to a problem with just torch.bernoulli:\n>>>  p = torch.FloatTensor([1.5])\n\n>>> torch.bernoulli(p) # note no expand\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-3-10ad530fb7ed> in <module>()\n----> 1 torch.bernoulli(p)\n\nRuntimeError: invalid argument 1: must be >= 0 and <= 1 at /pytorch/aten/src/TH/THRandom.cpp:314\n\n\n>>> torch.bernoulli(p.cuda())\ntensor([1.], device='cuda:0')", "body": "@fritzo that actually points me to a problem with just `torch.bernoulli`:\r\n\r\n``` python\r\n>>>  p = torch.FloatTensor([1.5])\r\n\r\n>>> torch.bernoulli(p) # note no expand\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-3-10ad530fb7ed> in <module>()\r\n----> 1 torch.bernoulli(p)\r\n\r\nRuntimeError: invalid argument 1: must be >= 0 and <= 1 at /pytorch/aten/src/TH/THRandom.cpp:314\r\n\r\n\r\n>>> torch.bernoulli(p.cuda())\r\ntensor([1.], device='cuda:0')\r\n```"}