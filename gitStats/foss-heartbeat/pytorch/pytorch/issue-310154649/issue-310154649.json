{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6151", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6151/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6151/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6151/events", "html_url": "https://github.com/pytorch/pytorch/pull/6151", "id": 310154649, "node_id": "MDExOlB1bGxSZXF1ZXN0MTc4NjI0ODA3", "number": 6151, "title": "Delete NNPACK", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-03-30T19:56:54Z", "updated_at": "2018-03-31T18:29:01Z", "closed_at": "2018-03-31T18:28:31Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/6151", "html_url": "https://github.com/pytorch/pytorch/pull/6151", "diff_url": "https://github.com/pytorch/pytorch/pull/6151.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/6151.patch"}, "body_html": "<p>Since we added cpuinfo as a vendored dependency, this created a problem<br>\nwith our NNPACK integration, because NNPACK also depends on cpuinfo,<br>\nas per <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"309417277\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/6068\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/6068/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/6068\">#6068</a>.  This is particularly difficult to resolve because we<br>\ndepend on a fairly recent version of cpuinfo, which we generally cannot<br>\nassume users have installed (it is submoduled.)  So, it would seem that<br>\nto fix this properly, NNPACK would have to be vendored and built against<br>\nthe correct cpuinfo.</p>\n<p>However, discussion with Christian Puhrsch and Marat Dukhan suggests<br>\nthat the benefit of carrying on with NNPACK integration is not all that<br>\ngreat, because mkldnn has since come out with a CPU convolution implementation<br>\nthat performs better than NNPACK.  NNPACK's x86 implementation is not<br>\nreally maintained, and its ARM support is not really relevant to PyTorch.</p>\n<p>So rather than go through all the rigamarole of vendoring NNPACK, better<br>\nto just delete it.  If you need good perf for CPU convolutions, please<br>\nmake sure you build against mkldnn.</p>\n<p>Signed-off-by: Edward Z. Yang <a href=\"mailto:ezyang@fb.com\">ezyang@fb.com</a></p>\n<p>CC <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1093985\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/Maratyszcza\">@Maratyszcza</a></p>", "body_text": "Since we added cpuinfo as a vendored dependency, this created a problem\nwith our NNPACK integration, because NNPACK also depends on cpuinfo,\nas per #6068.  This is particularly difficult to resolve because we\ndepend on a fairly recent version of cpuinfo, which we generally cannot\nassume users have installed (it is submoduled.)  So, it would seem that\nto fix this properly, NNPACK would have to be vendored and built against\nthe correct cpuinfo.\nHowever, discussion with Christian Puhrsch and Marat Dukhan suggests\nthat the benefit of carrying on with NNPACK integration is not all that\ngreat, because mkldnn has since come out with a CPU convolution implementation\nthat performs better than NNPACK.  NNPACK's x86 implementation is not\nreally maintained, and its ARM support is not really relevant to PyTorch.\nSo rather than go through all the rigamarole of vendoring NNPACK, better\nto just delete it.  If you need good perf for CPU convolutions, please\nmake sure you build against mkldnn.\nSigned-off-by: Edward Z. Yang ezyang@fb.com\nCC @Maratyszcza", "body": "Since we added cpuinfo as a vendored dependency, this created a problem\r\nwith our NNPACK integration, because NNPACK also depends on cpuinfo,\r\nas per #6068.  This is particularly difficult to resolve because we\r\ndepend on a fairly recent version of cpuinfo, which we generally cannot\r\nassume users have installed (it is submoduled.)  So, it would seem that\r\nto fix this properly, NNPACK would have to be vendored and built against\r\nthe correct cpuinfo.\r\n\r\nHowever, discussion with Christian Puhrsch and Marat Dukhan suggests\r\nthat the benefit of carrying on with NNPACK integration is not all that\r\ngreat, because mkldnn has since come out with a CPU convolution implementation\r\nthat performs better than NNPACK.  NNPACK's x86 implementation is not\r\nreally maintained, and its ARM support is not really relevant to PyTorch.\r\n\r\nSo rather than go through all the rigamarole of vendoring NNPACK, better\r\nto just delete it.  If you need good perf for CPU convolutions, please\r\nmake sure you build against mkldnn.\r\n\r\nSigned-off-by: Edward Z. Yang <ezyang@fb.com>\r\n\r\nCC @Maratyszcza "}