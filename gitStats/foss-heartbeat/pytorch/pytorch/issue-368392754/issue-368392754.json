{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12500", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12500/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12500/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12500/events", "html_url": "https://github.com/pytorch/pytorch/pull/12500", "id": 368392754, "node_id": "MDExOlB1bGxSZXF1ZXN0MjIxNTgxNzIy", "number": 12500, "title": "create type hint stub files for module torch", "user": {"login": "t-vi", "id": 20787943, "node_id": "MDQ6VXNlcjIwNzg3OTQz", "avatar_url": "https://avatars2.githubusercontent.com/u/20787943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/t-vi", "html_url": "https://github.com/t-vi", "followers_url": "https://api.github.com/users/t-vi/followers", "following_url": "https://api.github.com/users/t-vi/following{/other_user}", "gists_url": "https://api.github.com/users/t-vi/gists{/gist_id}", "starred_url": "https://api.github.com/users/t-vi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/t-vi/subscriptions", "organizations_url": "https://api.github.com/users/t-vi/orgs", "repos_url": "https://api.github.com/users/t-vi/repos", "events_url": "https://api.github.com/users/t-vi/events{/privacy}", "received_events_url": "https://api.github.com/users/t-vi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2018-10-09T20:52:48Z", "updated_at": "2018-11-23T15:52:54Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/12500", "html_url": "https://github.com/pytorch/pytorch/pull/12500", "diff_url": "https://github.com/pytorch/pytorch/pull/12500.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/12500.patch"}, "body_html": "<p>This is more a basis for discussion that a ready solution, as it does lots of funny things, and for many of them a better solution will be found, but to facilitate discussion, I'm putting this out.</p>\n<p>After many improvements, this could contribute to fixing <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"320500148\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/7318\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/7318/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/7318\">#7318</a>.</p>\n<p>We have</p>\n<ul>\n<li>This is an initial stab at creating a type stub <code>torch/__init__.pyi</code> .</li>\n<li>We only do this for Python 3 because we want to use type hint introspection.</li>\n<li>So far, we only aim at doing this for torch functions and torch.Tensor.</li>\n<li>We need to import the newly build torch. Thus we do this at the end of the build.<br>\nWe use os.fork to only import the module in a child process.</li>\n<li>We use an annotate decorator to be able to put type hints on the native python functions in a way that<br>\na) they're available in the usual place for Python 3<br>\nb) we stay Python 2 compatible</li>\n<li>Some annotations in torch/functional.py are provided as examples, but the remaining ones still need to be done if you are OK with the decorator approach. At first glance, it seems that the annotations are also available to Python3 introspection, e.g. on Jupyter.</li>\n</ul>\n<p>For me, PyCharm (the non-paid one) didn't seem to indicate errors in the .pyi when opening and seemed to be able to get the type hint for the few functions I tried, but I don't use PyCharm for my usual PyTorch activities, so I didn't extensively try this out.</p>\n<p>An example of a generated PYI is at <a href=\"https://gist.github.com/t-vi/0d0ae013072f96f50fa11fbc2287e33b\">this gist</a>.</p>", "body_text": "This is more a basis for discussion that a ready solution, as it does lots of funny things, and for many of them a better solution will be found, but to facilitate discussion, I'm putting this out.\nAfter many improvements, this could contribute to fixing #7318.\nWe have\n\nThis is an initial stab at creating a type stub torch/__init__.pyi .\nWe only do this for Python 3 because we want to use type hint introspection.\nSo far, we only aim at doing this for torch functions and torch.Tensor.\nWe need to import the newly build torch. Thus we do this at the end of the build.\nWe use os.fork to only import the module in a child process.\nWe use an annotate decorator to be able to put type hints on the native python functions in a way that\na) they're available in the usual place for Python 3\nb) we stay Python 2 compatible\nSome annotations in torch/functional.py are provided as examples, but the remaining ones still need to be done if you are OK with the decorator approach. At first glance, it seems that the annotations are also available to Python3 introspection, e.g. on Jupyter.\n\nFor me, PyCharm (the non-paid one) didn't seem to indicate errors in the .pyi when opening and seemed to be able to get the type hint for the few functions I tried, but I don't use PyCharm for my usual PyTorch activities, so I didn't extensively try this out.\nAn example of a generated PYI is at this gist.", "body": "This is more a basis for discussion that a ready solution, as it does lots of funny things, and for many of them a better solution will be found, but to facilitate discussion, I'm putting this out.\r\n\r\nAfter many improvements, this could contribute to fixing #7318.\r\n\r\nWe have\r\n\r\n- This is an initial stab at creating a type stub `torch/__init__.pyi` .\r\n- We only do this for Python 3 because we want to use type hint introspection.\r\n- So far, we only aim at doing this for torch functions and torch.Tensor.\r\n- We need to import the newly build torch. Thus we do this at the end of the build.\r\n  We use os.fork to only import the module in a child process.\r\n- We use an annotate decorator to be able to put type hints on the native python functions in a way that\r\n      a) they're available in the usual place for Python 3\r\n      b) we stay Python 2 compatible\r\n- Some annotations in torch/functional.py are provided as examples, but the remaining ones still need to be done if you are OK with the decorator approach. At first glance, it seems that the annotations are also available to Python3 introspection, e.g. on Jupyter.\r\n\r\nFor me, PyCharm (the non-paid one) didn't seem to indicate errors in the .pyi when opening and seemed to be able to get the type hint for the few functions I tried, but I don't use PyCharm for my usual PyTorch activities, so I didn't extensively try this out.\r\n\r\nAn example of a generated PYI is at [this gist](https://gist.github.com/t-vi/0d0ae013072f96f50fa11fbc2287e33b)."}