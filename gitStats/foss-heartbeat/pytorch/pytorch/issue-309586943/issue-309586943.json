{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6094", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6094/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6094/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6094/events", "html_url": "https://github.com/pytorch/pytorch/issues/6094", "id": 309586943, "node_id": "MDU6SXNzdWUzMDk1ODY5NDM=", "number": 6094, "title": "impossible to install from source cuda9.1 cudnn7.0.5 gcc5-7", "user": {"login": "kirk86", "id": 2902390, "node_id": "MDQ6VXNlcjI5MDIzOTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/2902390?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kirk86", "html_url": "https://github.com/kirk86", "followers_url": "https://api.github.com/users/kirk86/followers", "following_url": "https://api.github.com/users/kirk86/following{/other_user}", "gists_url": "https://api.github.com/users/kirk86/gists{/gist_id}", "starred_url": "https://api.github.com/users/kirk86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kirk86/subscriptions", "organizations_url": "https://api.github.com/users/kirk86/orgs", "repos_url": "https://api.github.com/users/kirk86/repos", "events_url": "https://api.github.com/users/kirk86/events{/privacy}", "received_events_url": "https://api.github.com/users/kirk86/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 778855555, "node_id": "MDU6TGFiZWw3Nzg4NTU1NTU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/build", "name": "build", "color": "bfdadc", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-29T01:25:09Z", "updated_at": "2018-05-02T15:01:25Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2>PyTorch GitHub Issues Guidelines</h2>\n<ul>\n<li>OS: Ubuntu 16.0.4</li>\n<li>PyTorch version: 0.4.x.x master branch</li>\n<li>How you installed PyTorch (conda, pip, source): from source in a conda environment</li>\n<li>Python version: 3.6</li>\n<li>CUDA/cuDNN version: cuda9.1/cudnn7.0.5</li>\n<li>GPU models and configuration: 1080Ti</li>\n<li>GCC version (if compiling from source): tried gcc-5 up to gcc-7 also gcc-4.8.5 from conda</li>\n</ul>\n<pre><code>1. install conda \n2. conda create -n torch\n3. conda install numpy pyyaml mkl mkl-include setuptools cmake cffi typing\n4. conda install -c pytorch magma-cuda90\n5. export CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"\n</code></pre>\n<p>Before I continue I have to explain that in my system there are installed cuda-8.0, cuda-9.0, cuda-9.1, cudnn-6 and cudnn-7.</p>\n<p>Cuda is located under the directory <code>/usr/local/cuda-8.x</code>, <code>/usr/loca/cuda-9.x</code>, etc.. I've checked those locations and the <code>cudnn.h</code> is not located there.</p>\n<p>The <code>cudnn.h</code> is located at <code>/usr/include/cudnn.h</code>.</p>\n<p>The only problem is that is the wrong <code>cudnn version</code>:</p>\n<pre><code>cat /usr/include/cudnn.h | grep CUDNN_MAJOR -A 2\n#define CUDNN_MAJOR      6\n#define CUDNN_MINOR      0\n#define CUDNN_PATCHLEVEL 21\n#define CUDNN_VERSION    (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)\n</code></pre>\n<p>Instead what I want is <code>cudnn version 7</code>.</p>\n<p>I have the following files:</p>\n<pre><code>find /usr/include/x86_64-linux-gnu/ -iname cudnn*\n/usr/include/x86_64-linux-gnu/cudnn_v6.h\n/usr/include/x86_64-linux-gnu/cudnn_v7.h --&gt; this is the one we want\n</code></pre>\n<p>Next make some soft links in order to remove <code>cudnn_v6</code> not to be picked up by the setup script.</p>\n<pre><code>mkdir -p $HOME/cuDNN7-LIB\nmkdir -p $HOME/cuDNN7-INC\ncp -r -P /usr/include/x86_64-linux-gnu/ $HOME/cuDNN7-INC; cd $HOME/cuDNN7-INC;  mv x86_64-linux-gnu/* .; rmdir x86_64-linux-gnu\ncp -r -P /usr/lib/x86_64-linux-gnu/ $HOME/cuDNN7-LIB; cd $HOME/cuDNN7-LIB;  mv x86_64-linux-gnu/* .; rmdir x86_64-linux-gnu\nrm cuDNN7-INC/cudnn_v6.h\nmv cuDNN7-INC/cudnn_v7.h cuDNN7-INC/cudnn.h\nrm cuDNN7-LIB/libcudnn.so.6\n</code></pre>\n<p>Edit and modify <code>.bashrc</code> accordingly:</p>\n<pre><code># added by Miniconda3 installer\nexport PATH=\"$HOME/miniconda3/bin:$PATH\"\n\nexport WITH_CUDA=1\nexport WITH_CUDNN=1\nexport CUDNN_LIBRARY=$HOME/cuDNN7-LIB\nexport CUDNN_LIB_DIR=$HOME/cuDNN7-LIB\nexport CUDNN_INCLUDE_DIR=$HOME/cuDNN7-INC\nexport CUDA_HOME=/usr/local/cuda-9.1\n\n# gcc version\nexport CC=/usr/bin/gcc-7\nexport CXX=/usr/bin/g++-7\n</code></pre>\n<p>Run the setup:</p>\n<pre><code>git clone https://github.com/pytorch/pytorch.git --recursive\ncd pytorch; python setup.py install\n\nrunning install\nrunning build_deps\n+ WITH_CUDA=0\n+ [[ --with-cuda == \\-\\-\\w\\i\\t\\h\\-\\c\\u\\d\\a ]]\n+ WITH_CUDA=1\n+ shift\n+ WITH_NNPACK=0\n+ [[ --with-nnpack == \\-\\-\\w\\i\\t\\h\\-\\n\\n\\p\\a\\c\\k ]]\n+ WITH_NNPACK=1\n+ shift\n+ WITH_GLOO_IBVERBS=0\n+ [[ nccl == \\-\\-\\w\\i\\t\\h\\-\\g\\l\\o\\o\\-\\i\\b\\v\\e\\r\\b\\s ]]\n+ CMAKE_INSTALL='make install'\n+ USER_CFLAGS=\n+ USER_LDFLAGS=\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n++ dirname tools/build_pytorch_libs.sh\n+ cd tools/..\n+++ pwd\n++ printf '%q\\n' /home/user/pytorch\n+ PWD=/home/user/pytorch\n+ BASE_DIR=/home/user/pytorch\n+ TORCH_LIB_DIR=/home/user/pytorch/torch/lib\n+ INSTALL_DIR=/home/user/pytorch/torch/lib/tmp_install\n+ THIRD_PARTY_DIR=/home/user/pytorch/third_party\n+ CMAKE_VERSION=cmake\n+ C_FLAGS=' -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"'\n+ C_FLAGS=' -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"\n-DOMPI_SKIP_MPICXX=1'\n+ LDFLAGS='-L\"/home/user/pytorch/torch/lib/tmp_install/lib\" '\n+ LD_POSTFIX=.so.1\n+ LD_POSTFIX_UNVERSIONED=.so\n++ uname\n+ [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n+ LDFLAGS='-L\"/home/user/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\n+ CPP_FLAGS=' -std=c++11 '\n+ GLOO_FLAGS=\n+ THD_FLAGS=\n+ NCCL_ROOT_DIR=/home/user/pytorch/torch/lib/tmp_install\n+ [[ 1 -eq 1 ]]\n+ GLOO_FLAGS='-DUSE_CUDA=1\n-DNCCL_ROOT_DIR=/home/user/pytorch/torch/lib/tmp_install'\n+ [[ 0 -eq 1 ]]\n+\nCWRAP_FILES='/home/user/pytorch/torch/lib/ATen/Declarations.cwrap;/home/user/pytorch/torch/lib/THNN/generic/THNN.h;/home/user/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/home/user/pytorch/torch/lib/ATen/nn.yaml'\n+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"\n-DOMPI_SKIP_MPICXX=1'\n+ [[ '' -eq 1 ]]\n+ '[' -z 72 ']'\n+ mkdir -p torch/lib/tmp_install\n+ for arg in '\"$@\"'\n+ [[ nccl == \\n\\c\\c\\l ]]\n+ pushd /home/user/pytorch/third_party\n~/pytorch/third_party ~/pytorch\n+ build_nccl\n+ mkdir -p build/nccl\n+ pushd build/nccl\n~/pytorch/third_party/build/nccl ~/pytorch/third_party ~/pytorch\n+ cmake ../../nccl -DCMAKE_MODULE_PATH=/home/user/pytorch/cmake/FindCUDA\n-DCMAKE_BUILD_TYPE=Release\n-DCMAKE_INSTALL_PREFIX=/home/user/pytorch/torch/lib/tmp_install\n'-DCMAKE_C_FLAGS= -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1\n' '-DCMAKE_CXX_FLAGS= -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1\n-std=c++11  ' -DCMAKE_SHARED_LINKER_FLAGS=\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/user/pytorch/third_party/build/nccl\n+ make install\n[100%] Generating lib/libnccl.so\nCompiling src/libwrap.cu                      &gt;\n/home/user/pytorch/third_party/build/nccl/obj/libwrap.o\nCompiling src/core.cu                         &gt;\n/home/user/pytorch/third_party/build/nccl/obj/core.o\nCompiling src/all_gather.cu                   &gt;\n/home/user/pytorch/third_party/build/nccl/obj/all_gather.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/all_reduce.cu                   &gt;\n/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/broadcast.cu                    &gt;\n/home/user/pytorch/third_party/build/nccl/obj/broadcast.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/reduce.cu                       &gt;\n/home/user/pytorch/third_party/build/nccl/obj/reduce.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/reduce_scatter.cu               &gt;\n/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from &lt;command-line&gt;:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/libwrap.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/libwrap.o] Error 1\nmake[3]: *** Waiting for unfinished jobs....\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/core.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/core.o] Error 1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/all_gather.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/all_gather.o] Error\n1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/broadcast.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/broadcast.o] Error 1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o] Error\n1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/reduce.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/reduce.o] Error 1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o]\nError 1\nCMakeFiles/nccl.dir/build.make:60: recipe for target 'lib/libnccl.so' failed\nmake[2]: *** [lib/libnccl.so] Error 2\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/nccl.dir/all' failed\nmake[1]: *** [CMakeFiles/nccl.dir/all] Error 2\nMakefile:129: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n<p>Edit <code>.bashrc</code> and change version to <code>gcc-5</code> and try again:</p>\n<pre><code>have a look at compilation logs file\n</code></pre>\n<p><a href=\"https://github.com/pytorch/pytorch/files/1858311/logs.txt\">logs.txt</a></p>\n<p>I've also tried installing gcc-4.8.5 using conda since no admin rights, by reading some other issues, but again no go.</p>\n<p>How should I install pytorch version 0.4 using cuda9 and cudnn7?</p>", "body_text": "PyTorch GitHub Issues Guidelines\n\nOS: Ubuntu 16.0.4\nPyTorch version: 0.4.x.x master branch\nHow you installed PyTorch (conda, pip, source): from source in a conda environment\nPython version: 3.6\nCUDA/cuDNN version: cuda9.1/cudnn7.0.5\nGPU models and configuration: 1080Ti\nGCC version (if compiling from source): tried gcc-5 up to gcc-7 also gcc-4.8.5 from conda\n\n1. install conda \n2. conda create -n torch\n3. conda install numpy pyyaml mkl mkl-include setuptools cmake cffi typing\n4. conda install -c pytorch magma-cuda90\n5. export CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"\n\nBefore I continue I have to explain that in my system there are installed cuda-8.0, cuda-9.0, cuda-9.1, cudnn-6 and cudnn-7.\nCuda is located under the directory /usr/local/cuda-8.x, /usr/loca/cuda-9.x, etc.. I've checked those locations and the cudnn.h is not located there.\nThe cudnn.h is located at /usr/include/cudnn.h.\nThe only problem is that is the wrong cudnn version:\ncat /usr/include/cudnn.h | grep CUDNN_MAJOR -A 2\n#define CUDNN_MAJOR      6\n#define CUDNN_MINOR      0\n#define CUDNN_PATCHLEVEL 21\n#define CUDNN_VERSION    (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)\n\nInstead what I want is cudnn version 7.\nI have the following files:\nfind /usr/include/x86_64-linux-gnu/ -iname cudnn*\n/usr/include/x86_64-linux-gnu/cudnn_v6.h\n/usr/include/x86_64-linux-gnu/cudnn_v7.h --> this is the one we want\n\nNext make some soft links in order to remove cudnn_v6 not to be picked up by the setup script.\nmkdir -p $HOME/cuDNN7-LIB\nmkdir -p $HOME/cuDNN7-INC\ncp -r -P /usr/include/x86_64-linux-gnu/ $HOME/cuDNN7-INC; cd $HOME/cuDNN7-INC;  mv x86_64-linux-gnu/* .; rmdir x86_64-linux-gnu\ncp -r -P /usr/lib/x86_64-linux-gnu/ $HOME/cuDNN7-LIB; cd $HOME/cuDNN7-LIB;  mv x86_64-linux-gnu/* .; rmdir x86_64-linux-gnu\nrm cuDNN7-INC/cudnn_v6.h\nmv cuDNN7-INC/cudnn_v7.h cuDNN7-INC/cudnn.h\nrm cuDNN7-LIB/libcudnn.so.6\n\nEdit and modify .bashrc accordingly:\n# added by Miniconda3 installer\nexport PATH=\"$HOME/miniconda3/bin:$PATH\"\n\nexport WITH_CUDA=1\nexport WITH_CUDNN=1\nexport CUDNN_LIBRARY=$HOME/cuDNN7-LIB\nexport CUDNN_LIB_DIR=$HOME/cuDNN7-LIB\nexport CUDNN_INCLUDE_DIR=$HOME/cuDNN7-INC\nexport CUDA_HOME=/usr/local/cuda-9.1\n\n# gcc version\nexport CC=/usr/bin/gcc-7\nexport CXX=/usr/bin/g++-7\n\nRun the setup:\ngit clone https://github.com/pytorch/pytorch.git --recursive\ncd pytorch; python setup.py install\n\nrunning install\nrunning build_deps\n+ WITH_CUDA=0\n+ [[ --with-cuda == \\-\\-\\w\\i\\t\\h\\-\\c\\u\\d\\a ]]\n+ WITH_CUDA=1\n+ shift\n+ WITH_NNPACK=0\n+ [[ --with-nnpack == \\-\\-\\w\\i\\t\\h\\-\\n\\n\\p\\a\\c\\k ]]\n+ WITH_NNPACK=1\n+ shift\n+ WITH_GLOO_IBVERBS=0\n+ [[ nccl == \\-\\-\\w\\i\\t\\h\\-\\g\\l\\o\\o\\-\\i\\b\\v\\e\\r\\b\\s ]]\n+ CMAKE_INSTALL='make install'\n+ USER_CFLAGS=\n+ USER_LDFLAGS=\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n++ dirname tools/build_pytorch_libs.sh\n+ cd tools/..\n+++ pwd\n++ printf '%q\\n' /home/user/pytorch\n+ PWD=/home/user/pytorch\n+ BASE_DIR=/home/user/pytorch\n+ TORCH_LIB_DIR=/home/user/pytorch/torch/lib\n+ INSTALL_DIR=/home/user/pytorch/torch/lib/tmp_install\n+ THIRD_PARTY_DIR=/home/user/pytorch/third_party\n+ CMAKE_VERSION=cmake\n+ C_FLAGS=' -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"'\n+ C_FLAGS=' -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"\n-DOMPI_SKIP_MPICXX=1'\n+ LDFLAGS='-L\"/home/user/pytorch/torch/lib/tmp_install/lib\" '\n+ LD_POSTFIX=.so.1\n+ LD_POSTFIX_UNVERSIONED=.so\n++ uname\n+ [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n+ LDFLAGS='-L\"/home/user/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\n+ CPP_FLAGS=' -std=c++11 '\n+ GLOO_FLAGS=\n+ THD_FLAGS=\n+ NCCL_ROOT_DIR=/home/user/pytorch/torch/lib/tmp_install\n+ [[ 1 -eq 1 ]]\n+ GLOO_FLAGS='-DUSE_CUDA=1\n-DNCCL_ROOT_DIR=/home/user/pytorch/torch/lib/tmp_install'\n+ [[ 0 -eq 1 ]]\n+\nCWRAP_FILES='/home/user/pytorch/torch/lib/ATen/Declarations.cwrap;/home/user/pytorch/torch/lib/THNN/generic/THNN.h;/home/user/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/home/user/pytorch/torch/lib/ATen/nn.yaml'\n+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"\n-DOMPI_SKIP_MPICXX=1'\n+ [[ '' -eq 1 ]]\n+ '[' -z 72 ']'\n+ mkdir -p torch/lib/tmp_install\n+ for arg in '\"$@\"'\n+ [[ nccl == \\n\\c\\c\\l ]]\n+ pushd /home/user/pytorch/third_party\n~/pytorch/third_party ~/pytorch\n+ build_nccl\n+ mkdir -p build/nccl\n+ pushd build/nccl\n~/pytorch/third_party/build/nccl ~/pytorch/third_party ~/pytorch\n+ cmake ../../nccl -DCMAKE_MODULE_PATH=/home/user/pytorch/cmake/FindCUDA\n-DCMAKE_BUILD_TYPE=Release\n-DCMAKE_INSTALL_PREFIX=/home/user/pytorch/torch/lib/tmp_install\n'-DCMAKE_C_FLAGS= -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1\n' '-DCMAKE_CXX_FLAGS= -DTH_INDEX_BASE=0\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1\n-std=c++11  ' -DCMAKE_SHARED_LINKER_FLAGS=\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/user/pytorch/third_party/build/nccl\n+ make install\n[100%] Generating lib/libnccl.so\nCompiling src/libwrap.cu                      >\n/home/user/pytorch/third_party/build/nccl/obj/libwrap.o\nCompiling src/core.cu                         >\n/home/user/pytorch/third_party/build/nccl/obj/core.o\nCompiling src/all_gather.cu                   >\n/home/user/pytorch/third_party/build/nccl/obj/all_gather.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/all_reduce.cu                   >\n/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/broadcast.cu                    >\n/home/user/pytorch/third_party/build/nccl/obj/broadcast.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/reduce.cu                       >\n/home/user/pytorch/third_party/build/nccl/obj/reduce.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nCompiling src/reduce_scatter.cu               >\n/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\n                 from <command-line>:0:\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\nGNU version! gcc versions later than 5 are not supported!\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\n  ^~~~~\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/libwrap.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/libwrap.o] Error 1\nmake[3]: *** Waiting for unfinished jobs....\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/core.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/core.o] Error 1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/all_gather.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/all_gather.o] Error\n1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/broadcast.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/broadcast.o] Error 1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o] Error\n1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/reduce.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/reduce.o] Error 1\nMakefile:136: recipe for target\n'/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o' failed\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o]\nError 1\nCMakeFiles/nccl.dir/build.make:60: recipe for target 'lib/libnccl.so' failed\nmake[2]: *** [lib/libnccl.so] Error 2\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/nccl.dir/all' failed\nmake[1]: *** [CMakeFiles/nccl.dir/all] Error 2\nMakefile:129: recipe for target 'all' failed\nmake: *** [all] Error 2\n\nEdit .bashrc and change version to gcc-5 and try again:\nhave a look at compilation logs file\n\nlogs.txt\nI've also tried installing gcc-4.8.5 using conda since no admin rights, by reading some other issues, but again no go.\nHow should I install pytorch version 0.4 using cuda9 and cudnn7?", "body": "PyTorch GitHub Issues Guidelines\r\n--------------------------------\r\n- OS: Ubuntu 16.0.4\r\n- PyTorch version: 0.4.x.x master branch\r\n- How you installed PyTorch (conda, pip, source): from source in a conda environment\r\n- Python version: 3.6\r\n- CUDA/cuDNN version: cuda9.1/cudnn7.0.5\r\n- GPU models and configuration: 1080Ti\r\n- GCC version (if compiling from source): tried gcc-5 up to gcc-7 also gcc-4.8.5 from conda\r\n\r\n```\r\n1. install conda \r\n2. conda create -n torch\r\n3. conda install numpy pyyaml mkl mkl-include setuptools cmake cffi typing\r\n4. conda install -c pytorch magma-cuda90\r\n5. export CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"\r\n```\r\n\r\nBefore I continue I have to explain that in my system there are installed cuda-8.0, cuda-9.0, cuda-9.1, cudnn-6 and cudnn-7.\r\n\r\nCuda is located under the directory `/usr/local/cuda-8.x`, `/usr/loca/cuda-9.x`, etc.. I've checked those locations and the `cudnn.h` is not located there.\r\n\r\nThe `cudnn.h` is located at `/usr/include/cudnn.h`. \r\n\r\nThe only problem is that is the wrong `cudnn version`:\r\n```\r\ncat /usr/include/cudnn.h | grep CUDNN_MAJOR -A 2\r\n#define CUDNN_MAJOR      6\r\n#define CUDNN_MINOR      0\r\n#define CUDNN_PATCHLEVEL 21\r\n#define CUDNN_VERSION    (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)\r\n```\r\nInstead what I want is `cudnn version 7`.\r\n\r\nI have the following files:\r\n```\r\nfind /usr/include/x86_64-linux-gnu/ -iname cudnn*\r\n/usr/include/x86_64-linux-gnu/cudnn_v6.h\r\n/usr/include/x86_64-linux-gnu/cudnn_v7.h --> this is the one we want\r\n```\r\nNext make some soft links in order to remove `cudnn_v6` not to be picked up by the setup script.\r\n```\r\nmkdir -p $HOME/cuDNN7-LIB\r\nmkdir -p $HOME/cuDNN7-INC\r\ncp -r -P /usr/include/x86_64-linux-gnu/ $HOME/cuDNN7-INC; cd $HOME/cuDNN7-INC;  mv x86_64-linux-gnu/* .; rmdir x86_64-linux-gnu\r\ncp -r -P /usr/lib/x86_64-linux-gnu/ $HOME/cuDNN7-LIB; cd $HOME/cuDNN7-LIB;  mv x86_64-linux-gnu/* .; rmdir x86_64-linux-gnu\r\nrm cuDNN7-INC/cudnn_v6.h\r\nmv cuDNN7-INC/cudnn_v7.h cuDNN7-INC/cudnn.h\r\nrm cuDNN7-LIB/libcudnn.so.6\r\n```\r\n\r\nEdit and modify `.bashrc` accordingly:\r\n```\r\n# added by Miniconda3 installer\r\nexport PATH=\"$HOME/miniconda3/bin:$PATH\"\r\n\r\nexport WITH_CUDA=1\r\nexport WITH_CUDNN=1\r\nexport CUDNN_LIBRARY=$HOME/cuDNN7-LIB\r\nexport CUDNN_LIB_DIR=$HOME/cuDNN7-LIB\r\nexport CUDNN_INCLUDE_DIR=$HOME/cuDNN7-INC\r\nexport CUDA_HOME=/usr/local/cuda-9.1\r\n\r\n# gcc version\r\nexport CC=/usr/bin/gcc-7\r\nexport CXX=/usr/bin/g++-7\r\n```\r\n\r\nRun the setup:\r\n```\r\ngit clone https://github.com/pytorch/pytorch.git --recursive\r\ncd pytorch; python setup.py install\r\n\r\nrunning install\r\nrunning build_deps\r\n+ WITH_CUDA=0\r\n+ [[ --with-cuda == \\-\\-\\w\\i\\t\\h\\-\\c\\u\\d\\a ]]\r\n+ WITH_CUDA=1\r\n+ shift\r\n+ WITH_NNPACK=0\r\n+ [[ --with-nnpack == \\-\\-\\w\\i\\t\\h\\-\\n\\n\\p\\a\\c\\k ]]\r\n+ WITH_NNPACK=1\r\n+ shift\r\n+ WITH_GLOO_IBVERBS=0\r\n+ [[ nccl == \\-\\-\\w\\i\\t\\h\\-\\g\\l\\o\\o\\-\\i\\b\\v\\e\\r\\b\\s ]]\r\n+ CMAKE_INSTALL='make install'\r\n+ USER_CFLAGS=\r\n+ USER_LDFLAGS=\r\n+ [[ -n '' ]]\r\n+ [[ -n '' ]]\r\n+ [[ -n '' ]]\r\n++ dirname tools/build_pytorch_libs.sh\r\n+ cd tools/..\r\n+++ pwd\r\n++ printf '%q\\n' /home/user/pytorch\r\n+ PWD=/home/user/pytorch\r\n+ BASE_DIR=/home/user/pytorch\r\n+ TORCH_LIB_DIR=/home/user/pytorch/torch/lib\r\n+ INSTALL_DIR=/home/user/pytorch/torch/lib/tmp_install\r\n+ THIRD_PARTY_DIR=/home/user/pytorch/third_party\r\n+ CMAKE_VERSION=cmake\r\n+ C_FLAGS=' -DTH_INDEX_BASE=0\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"'\r\n+ C_FLAGS=' -DTH_INDEX_BASE=0\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"\r\n-DOMPI_SKIP_MPICXX=1'\r\n+ LDFLAGS='-L\"/home/user/pytorch/torch/lib/tmp_install/lib\" '\r\n+ LD_POSTFIX=.so.1\r\n+ LD_POSTFIX_UNVERSIONED=.so\r\n++ uname\r\n+ [[ Linux == \\D\\a\\r\\w\\i\\n ]]\r\n+ LDFLAGS='-L\"/home/user/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\r\n+ CPP_FLAGS=' -std=c++11 '\r\n+ GLOO_FLAGS=\r\n+ THD_FLAGS=\r\n+ NCCL_ROOT_DIR=/home/user/pytorch/torch/lib/tmp_install\r\n+ [[ 1 -eq 1 ]]\r\n+ GLOO_FLAGS='-DUSE_CUDA=1\r\n-DNCCL_ROOT_DIR=/home/user/pytorch/torch/lib/tmp_install'\r\n+ [[ 0 -eq 1 ]]\r\n+\r\nCWRAP_FILES='/home/user/pytorch/torch/lib/ATen/Declarations.cwrap;/home/user/pytorch/torch/lib/THNN/generic/THNN.h;/home/user/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/home/user/pytorch/torch/lib/ATen/nn.yaml'\r\n+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\"\r\n-DOMPI_SKIP_MPICXX=1'\r\n+ [[ '' -eq 1 ]]\r\n+ '[' -z 72 ']'\r\n+ mkdir -p torch/lib/tmp_install\r\n+ for arg in '\"$@\"'\r\n+ [[ nccl == \\n\\c\\c\\l ]]\r\n+ pushd /home/user/pytorch/third_party\r\n~/pytorch/third_party ~/pytorch\r\n+ build_nccl\r\n+ mkdir -p build/nccl\r\n+ pushd build/nccl\r\n~/pytorch/third_party/build/nccl ~/pytorch/third_party ~/pytorch\r\n+ cmake ../../nccl -DCMAKE_MODULE_PATH=/home/user/pytorch/cmake/FindCUDA\r\n-DCMAKE_BUILD_TYPE=Release\r\n-DCMAKE_INSTALL_PREFIX=/home/user/pytorch/torch/lib/tmp_install\r\n'-DCMAKE_C_FLAGS= -DTH_INDEX_BASE=0\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1\r\n' '-DCMAKE_CXX_FLAGS= -DTH_INDEX_BASE=0\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/TH\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THC\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCS\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THNN\"\r\n-I\"/home/user/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1\r\n-std=c++11  ' -DCMAKE_SHARED_LINKER_FLAGS=\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /home/user/pytorch/third_party/build/nccl\r\n+ make install\r\n[100%] Generating lib/libnccl.so\r\nCompiling src/libwrap.cu                      >\r\n/home/user/pytorch/third_party/build/nccl/obj/libwrap.o\r\nCompiling src/core.cu                         >\r\n/home/user/pytorch/third_party/build/nccl/obj/core.o\r\nCompiling src/all_gather.cu                   >\r\n/home/user/pytorch/third_party/build/nccl/obj/all_gather.o\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nCompiling src/all_reduce.cu                   >\r\n/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nCompiling src/broadcast.cu                    >\r\n/home/user/pytorch/third_party/build/nccl/obj/broadcast.o\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nCompiling src/reduce.cu                       >\r\n/home/user/pytorch/third_party/build/nccl/obj/reduce.o\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nCompiling src/reduce_scatter.cu               >\r\n/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nIn file included from /usr/local/cuda-8.0/include/cuda_runtime.h:78:0,\r\n                 from <command-line>:0:\r\n/usr/local/cuda-8.0/include/host_config.h:119:2: error: #error -- unsupported\r\nGNU version! gcc versions later than 5 are not supported!\r\n #error -- unsupported GNU version! gcc versions later than 5 are not supported!\r\n  ^~~~~\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/libwrap.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/libwrap.o] Error 1\r\nmake[3]: *** Waiting for unfinished jobs....\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/core.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/core.o] Error 1\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/all_gather.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/all_gather.o] Error\r\n1\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/broadcast.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/broadcast.o] Error 1\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/all_reduce.o] Error\r\n1\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/reduce.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/reduce.o] Error 1\r\nMakefile:136: recipe for target\r\n'/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o' failed\r\nmake[3]: *** [/home/user/pytorch/third_party/build/nccl/obj/reduce_scatter.o]\r\nError 1\r\nCMakeFiles/nccl.dir/build.make:60: recipe for target 'lib/libnccl.so' failed\r\nmake[2]: *** [lib/libnccl.so] Error 2\r\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/nccl.dir/all' failed\r\nmake[1]: *** [CMakeFiles/nccl.dir/all] Error 2\r\nMakefile:129: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\n```\r\n\r\nEdit `.bashrc` and change version to `gcc-5` and try again:\r\n```\r\nhave a look at compilation logs file\r\n```\r\n[logs.txt](https://github.com/pytorch/pytorch/files/1858311/logs.txt)\r\n\r\nI've also tried installing gcc-4.8.5 using conda since no admin rights, by reading some other issues, but again no go.\r\n\r\nHow should I install pytorch version 0.4 using cuda9 and cudnn7?"}