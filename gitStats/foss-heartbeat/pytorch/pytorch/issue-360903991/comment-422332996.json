{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/422332996", "html_url": "https://github.com/pytorch/pytorch/issues/11756#issuecomment-422332996", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11756", "id": 422332996, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjMzMjk5Ng==", "user": {"login": "chenwc07", "id": 40051091, "node_id": "MDQ6VXNlcjQwMDUxMDkx", "avatar_url": "https://avatars2.githubusercontent.com/u/40051091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chenwc07", "html_url": "https://github.com/chenwc07", "followers_url": "https://api.github.com/users/chenwc07/followers", "following_url": "https://api.github.com/users/chenwc07/following{/other_user}", "gists_url": "https://api.github.com/users/chenwc07/gists{/gist_id}", "starred_url": "https://api.github.com/users/chenwc07/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chenwc07/subscriptions", "organizations_url": "https://api.github.com/users/chenwc07/orgs", "repos_url": "https://api.github.com/users/chenwc07/repos", "events_url": "https://api.github.com/users/chenwc07/events{/privacy}", "received_events_url": "https://api.github.com/users/chenwc07/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-18T10:01:32Z", "updated_at": "2018-09-18T10:01:32Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9845\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pietern\">@pietern</a> I ran it with CUDA_LAUNCH_BLOCKING=1, and got the same error. I ran  it on jupyter yesterday and on terminal today and get extra error output. The  terminal outputs:<br>\nTraceback (most recent call last):<br>\nFile \"test_cuda.py\", line 26, in <br>\nout = model(testdata)<br>\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 477, in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)<br>\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 122, in forward<br>\nreplicas = self.replicate(self.module, self.device_ids[:len(inputs)])<br>\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 127, in replicate<br>\nreturn replicate(module, device_ids)<br>\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/replicate.py\", line 12, in replicate<br>\nparam_copies = Broadcast.apply(devices, *params)<br>\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/_functions.py\", line 19, in forward<br>\noutputs = comm.broadcast_coalesced(inputs, ctx.target_gpus)<br>\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/cuda/comm.py\", line 40, in broadcast_coalesced<br>\nreturn torch._C._broadcast_coalesced(tensors, devices, buffer_size)<br>\nRuntimeError: NCCL Error 1: unhandled cuda error<br>\nterminate called after throwing an instance of 'at::Error'<br>\nwhat():  CUDA error: invalid device pointer (CudaCachingDeleter at /opt/conda/conda-bld/pytorch_1532576128691/work/aten/src/THC/THCCachingAllocator.cpp:498)<br>\nframe #0: THStorage_free + 0x44 (0x7f97187aa314 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2.so)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171281708\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1\">#1</a>: THTensor_free + 0x2f (0x7f9718849a1f in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2.so)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171402941\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/2\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/2/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/2\">#2</a>: at::CUDAFloatTensor::~CUDAFloatTensor() + 0x9 (0x7f96fc40bce9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2_gpu.so)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171485123\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/3/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/3\">#3</a>: torch::autograd::Variable::Impl::~Impl() + 0x291 (0x7f971a394931 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171522963\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/4\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/4/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/4\">#4</a>: torch::autograd::Variable::Impl::~Impl() + 0x9 (0x7f971a394aa9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"173498149\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/5/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/5\">#5</a>:  + 0x770ea9 (0x7f971a3adea9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"174289461\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/6\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/6/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/6\">#6</a>:  + 0x770f54 (0x7f971a3adf54 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)<br>\n<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"176137249\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/20\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/20/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/20\">#20</a>: __libc_start_main + 0xf0 (0x7f972ed46830 in /lib/x86_64-linux-gnu/libc.so.6)</p>\n<p>Aborted (core dumped)</p>", "body_text": "@pietern I ran it with CUDA_LAUNCH_BLOCKING=1, and got the same error. I ran  it on jupyter yesterday and on terminal today and get extra error output. The  terminal outputs:\nTraceback (most recent call last):\nFile \"test_cuda.py\", line 26, in \nout = model(testdata)\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 477, in call\nresult = self.forward(*input, **kwargs)\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 122, in forward\nreplicas = self.replicate(self.module, self.device_ids[:len(inputs)])\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 127, in replicate\nreturn replicate(module, device_ids)\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/replicate.py\", line 12, in replicate\nparam_copies = Broadcast.apply(devices, *params)\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/_functions.py\", line 19, in forward\noutputs = comm.broadcast_coalesced(inputs, ctx.target_gpus)\nFile \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/cuda/comm.py\", line 40, in broadcast_coalesced\nreturn torch._C._broadcast_coalesced(tensors, devices, buffer_size)\nRuntimeError: NCCL Error 1: unhandled cuda error\nterminate called after throwing an instance of 'at::Error'\nwhat():  CUDA error: invalid device pointer (CudaCachingDeleter at /opt/conda/conda-bld/pytorch_1532576128691/work/aten/src/THC/THCCachingAllocator.cpp:498)\nframe #0: THStorage_free + 0x44 (0x7f97187aa314 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2.so)\nframe #1: THTensor_free + 0x2f (0x7f9718849a1f in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2.so)\nframe #2: at::CUDAFloatTensor::~CUDAFloatTensor() + 0x9 (0x7f96fc40bce9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2_gpu.so)\nframe #3: torch::autograd::Variable::Impl::~Impl() + 0x291 (0x7f971a394931 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #4: torch::autograd::Variable::Impl::~Impl() + 0x9 (0x7f971a394aa9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #5:  + 0x770ea9 (0x7f971a3adea9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #6:  + 0x770f54 (0x7f971a3adf54 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\n\nframe #20: __libc_start_main + 0xf0 (0x7f972ed46830 in /lib/x86_64-linux-gnu/libc.so.6)\nAborted (core dumped)", "body": "@pietern I ran it with CUDA_LAUNCH_BLOCKING=1, and got the same error. I ran  it on jupyter yesterday and on terminal today and get extra error output. The  terminal outputs: \r\nTraceback (most recent call last):\r\n  File \"test_cuda.py\", line 26, in <module>\r\n    out = model(testdata)\r\n  File \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 122, in forward\r\n    replicas = self.replicate(self.module, self.device_ids[:len(inputs)])\r\n  File \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 127, in replicate\r\n    return replicate(module, device_ids)\r\n  File \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/replicate.py\", line 12, in replicate\r\n    param_copies = Broadcast.apply(devices, *params)\r\n  File \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/nn/parallel/_functions.py\", line 19, in forward\r\n    outputs = comm.broadcast_coalesced(inputs, ctx.target_gpus)\r\n  File \"/home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/cuda/comm.py\", line 40, in broadcast_coalesced\r\n    return torch._C._broadcast_coalesced(tensors, devices, buffer_size)\r\nRuntimeError: NCCL Error 1: unhandled cuda error\r\nterminate called after throwing an instance of 'at::Error'\r\n  what():  CUDA error: invalid device pointer (CudaCachingDeleter at /opt/conda/conda-bld/pytorch_1532576128691/work/aten/src/THC/THCCachingAllocator.cpp:498)\r\nframe #0: THStorage_free + 0x44 (0x7f97187aa314 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2.so)\r\nframe #1: THTensor_free + 0x2f (0x7f9718849a1f in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2.so)\r\nframe #2: at::CUDAFloatTensor::~CUDAFloatTensor() + 0x9 (0x7f96fc40bce9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/lib/libcaffe2_gpu.so)\r\nframe #3: torch::autograd::Variable::Impl::~Impl() + 0x291 (0x7f971a394931 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #4: torch::autograd::Variable::Impl::~Impl() + 0x9 (0x7f971a394aa9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #5: <unknown function> + 0x770ea9 (0x7f971a3adea9 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #6: <unknown function> + 0x770f54 (0x7f971a3adf54 in /home/zhangd/anaconda3/envs/pytorch/lib/python3.5/site-packages/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\n<omitting python frames>\r\nframe #20: __libc_start_main + 0xf0 (0x7f972ed46830 in /lib/x86_64-linux-gnu/libc.so.6)\r\n\r\nAborted (core dumped)\r\n"}