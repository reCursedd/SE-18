{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/310835727", "html_url": "https://github.com/pytorch/pytorch/issues/494#issuecomment-310835727", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/494", "id": 310835727, "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDgzNTcyNw==", "user": {"login": "magic282", "id": 2285145, "node_id": "MDQ6VXNlcjIyODUxNDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/2285145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magic282", "html_url": "https://github.com/magic282", "followers_url": "https://api.github.com/users/magic282/followers", "following_url": "https://api.github.com/users/magic282/following{/other_user}", "gists_url": "https://api.github.com/users/magic282/gists{/gist_id}", "starred_url": "https://api.github.com/users/magic282/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magic282/subscriptions", "organizations_url": "https://api.github.com/users/magic282/orgs", "repos_url": "https://api.github.com/users/magic282/repos", "events_url": "https://api.github.com/users/magic282/events{/privacy}", "received_events_url": "https://api.github.com/users/magic282/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-24T12:27:56Z", "updated_at": "2017-06-24T12:27:56Z", "author_association": "NONE", "body_html": "<p>Hi, recently I want to map the entire Anaconda folder to a Windows cluster. But it reports an error:</p>\n<pre><code>Traceback (most recent call last):\n  File \"test.py\", line 21, in &lt;module&gt;\n    input_emd = torch.cat((wb, bb), dim=2)\n  File \"Z:\\user\\v\\Anaconda3\\lib\\site-packages\\torch\\autograd\\variable.py\", line 837, in cat\n    return Concat.apply(dim, *iterable)\n  File \"Z:\\user\\v\\Anaconda3\\lib\\site-packages\\torch\\autograd\\_functions\\tensor.py\", line 287, in forward\n    return torch.cat(inputs, dim)\nRuntimeError: cuda runtime error (8) : invalid device function at D:\\users\\v-qizhou\\pytorch\\pytorch\\torch\\lib\\THC\\THCGeneral.c:833\nTHCudaCheck FAIL file=D:\\users\\v\\pytorch\\pytorch\\torch\\lib\\THC\\THCGeneral.c line=833 error=8 : invalid device function\n</code></pre>\n<p>The test code is:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"><span class=\"pl-c\">#</span> CUDA TEST</span>\n<span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">from</span> torch.autograd <span class=\"pl-k\">import</span> Variable\n<span class=\"pl-k\">from</span> torch <span class=\"pl-k\">import</span> nn\nx <span class=\"pl-k\">=</span> torch.Tensor([<span class=\"pl-c1\">1.0</span>])\nxx <span class=\"pl-k\">=</span> x.cuda()\n<span class=\"pl-c1\">print</span>(xx)\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> CUDNN TEST</span>\n<span class=\"pl-k\">from</span> torch.backends <span class=\"pl-k\">import</span> cudnn\n<span class=\"pl-c1\">print</span>(cudnn.is_acceptable(xx))\n\nword_embedding <span class=\"pl-k\">=</span> nn.Embedding(<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">300</span>).cuda()\nbio_embedding <span class=\"pl-k\">=</span> nn.Embedding(<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">32</span>).cuda()\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> a batch of 2 samples of 4 indices each</span>\nword_input <span class=\"pl-k\">=</span> Variable(torch.LongTensor([[<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">4</span>,<span class=\"pl-c1\">5</span>],[<span class=\"pl-c1\">4</span>,<span class=\"pl-c1\">3</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">9</span>]]).cuda())\nbio_input <span class=\"pl-k\">=</span> Variable(torch.LongTensor([[<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">4</span>,<span class=\"pl-c1\">5</span>],[<span class=\"pl-c1\">4</span>,<span class=\"pl-c1\">3</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">9</span>]]).cuda())\nwb <span class=\"pl-k\">=</span> word_embedding(word_input)\nbb <span class=\"pl-k\">=</span> bio_embedding(bio_input)\n\ninput_emd <span class=\"pl-k\">=</span> torch.cat((wb, bb), <span class=\"pl-v\">dim</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">2</span>)\n<span class=\"pl-c1\">print</span>(input_emd.size())\nloss <span class=\"pl-k\">=</span> input_emd.sum()\n<span class=\"pl-c1\">print</span>(loss)\nloss.backward()</pre></div>\n<p>Is there any idea about this error? Thanks.</p>", "body_text": "Hi, recently I want to map the entire Anaconda folder to a Windows cluster. But it reports an error:\nTraceback (most recent call last):\n  File \"test.py\", line 21, in <module>\n    input_emd = torch.cat((wb, bb), dim=2)\n  File \"Z:\\user\\v\\Anaconda3\\lib\\site-packages\\torch\\autograd\\variable.py\", line 837, in cat\n    return Concat.apply(dim, *iterable)\n  File \"Z:\\user\\v\\Anaconda3\\lib\\site-packages\\torch\\autograd\\_functions\\tensor.py\", line 287, in forward\n    return torch.cat(inputs, dim)\nRuntimeError: cuda runtime error (8) : invalid device function at D:\\users\\v-qizhou\\pytorch\\pytorch\\torch\\lib\\THC\\THCGeneral.c:833\nTHCudaCheck FAIL file=D:\\users\\v\\pytorch\\pytorch\\torch\\lib\\THC\\THCGeneral.c line=833 error=8 : invalid device function\n\nThe test code is:\n# CUDA TEST\nimport torch\nfrom torch.autograd import Variable\nfrom torch import nn\nx = torch.Tensor([1.0])\nxx = x.cuda()\nprint(xx)\n\n# CUDNN TEST\nfrom torch.backends import cudnn\nprint(cudnn.is_acceptable(xx))\n\nword_embedding = nn.Embedding(10, 300).cuda()\nbio_embedding = nn.Embedding(10, 32).cuda()\n# a batch of 2 samples of 4 indices each\nword_input = Variable(torch.LongTensor([[1,2,4,5],[4,3,2,9]]).cuda())\nbio_input = Variable(torch.LongTensor([[1,2,4,5],[4,3,2,9]]).cuda())\nwb = word_embedding(word_input)\nbb = bio_embedding(bio_input)\n\ninput_emd = torch.cat((wb, bb), dim=2)\nprint(input_emd.size())\nloss = input_emd.sum()\nprint(loss)\nloss.backward()\nIs there any idea about this error? Thanks.", "body": "Hi, recently I want to map the entire Anaconda folder to a Windows cluster. But it reports an error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 21, in <module>\r\n    input_emd = torch.cat((wb, bb), dim=2)\r\n  File \"Z:\\user\\v\\Anaconda3\\lib\\site-packages\\torch\\autograd\\variable.py\", line 837, in cat\r\n    return Concat.apply(dim, *iterable)\r\n  File \"Z:\\user\\v\\Anaconda3\\lib\\site-packages\\torch\\autograd\\_functions\\tensor.py\", line 287, in forward\r\n    return torch.cat(inputs, dim)\r\nRuntimeError: cuda runtime error (8) : invalid device function at D:\\users\\v-qizhou\\pytorch\\pytorch\\torch\\lib\\THC\\THCGeneral.c:833\r\nTHCudaCheck FAIL file=D:\\users\\v\\pytorch\\pytorch\\torch\\lib\\THC\\THCGeneral.c line=833 error=8 : invalid device function\r\n```\r\n\r\nThe test code is:\r\n```python\r\n# CUDA TEST\r\nimport torch\r\nfrom torch.autograd import Variable\r\nfrom torch import nn\r\nx = torch.Tensor([1.0])\r\nxx = x.cuda()\r\nprint(xx)\r\n\r\n# CUDNN TEST\r\nfrom torch.backends import cudnn\r\nprint(cudnn.is_acceptable(xx))\r\n\r\nword_embedding = nn.Embedding(10, 300).cuda()\r\nbio_embedding = nn.Embedding(10, 32).cuda()\r\n# a batch of 2 samples of 4 indices each\r\nword_input = Variable(torch.LongTensor([[1,2,4,5],[4,3,2,9]]).cuda())\r\nbio_input = Variable(torch.LongTensor([[1,2,4,5],[4,3,2,9]]).cuda())\r\nwb = word_embedding(word_input)\r\nbb = bio_embedding(bio_input)\r\n\r\ninput_emd = torch.cat((wb, bb), dim=2)\r\nprint(input_emd.size())\r\nloss = input_emd.sum()\r\nprint(loss)\r\nloss.backward()\r\n```\r\nIs there any idea about this error? Thanks."}