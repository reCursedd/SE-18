{"url": "https://api.github.com/repos/pytorch/pytorch/issues/14321", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/14321/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/14321/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/14321/events", "html_url": "https://github.com/pytorch/pytorch/issues/14321", "id": 383578172, "node_id": "MDU6SXNzdWUzODM1NzgxNzI=", "number": 14321, "title": "Wrong rpath / RUNPATH set when building from source", "user": {"login": "t-vi", "id": 20787943, "node_id": "MDQ6VXNlcjIwNzg3OTQz", "avatar_url": "https://avatars2.githubusercontent.com/u/20787943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/t-vi", "html_url": "https://github.com/t-vi", "followers_url": "https://api.github.com/users/t-vi/followers", "following_url": "https://api.github.com/users/t-vi/following{/other_user}", "gists_url": "https://api.github.com/users/t-vi/gists{/gist_id}", "starred_url": "https://api.github.com/users/t-vi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/t-vi/subscriptions", "organizations_url": "https://api.github.com/users/t-vi/orgs", "repos_url": "https://api.github.com/users/t-vi/repos", "events_url": "https://api.github.com/users/t-vi/events{/privacy}", "received_events_url": "https://api.github.com/users/t-vi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-11-22T15:20:11Z", "updated_at": "2018-11-22T15:38:17Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>The runpath in the installed libraries is set to the tmp_install directory of the build:</p>\n<pre><code>objdump  -p /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch.so | grep RUNPATH\n  RUNPATH              :/home/something/pytorch/torch/lib/tmp_install/lib:/opt/intel/mkl/lib/intel64\n</code></pre>\n<p>This causes the loader to not find dependency libraries (if they don't exist there or it doesn't have access) or load the wrong ones (when the version I'm fiddling with isn't the one installed and I want the installed one).</p>\n<h2>To Reproduce</h2>\n<pre><code>PATH=/usr/lib/ccache/:$PATH python3 setup.py  bdist_wheel \nsudo pip3 install dist/*.whl\n</code></pre>\n<p>I sometimes use gcc/g++-7 by specifying CC/CXX and use DEBUG=1.</p>\n<h2>Expected behavior</h2>\n<p>Probably some rpath with $ORIGIN</p>\n<h2>Environment</h2>\n<p>Debian sid, gcc-7, PyTorch/master from today.</p>", "body_text": "\ud83d\udc1b Bug\nThe runpath in the installed libraries is set to the tmp_install directory of the build:\nobjdump  -p /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch.so | grep RUNPATH\n  RUNPATH              :/home/something/pytorch/torch/lib/tmp_install/lib:/opt/intel/mkl/lib/intel64\n\nThis causes the loader to not find dependency libraries (if they don't exist there or it doesn't have access) or load the wrong ones (when the version I'm fiddling with isn't the one installed and I want the installed one).\nTo Reproduce\nPATH=/usr/lib/ccache/:$PATH python3 setup.py  bdist_wheel \nsudo pip3 install dist/*.whl\n\nI sometimes use gcc/g++-7 by specifying CC/CXX and use DEBUG=1.\nExpected behavior\nProbably some rpath with $ORIGIN\nEnvironment\nDebian sid, gcc-7, PyTorch/master from today.", "body": "## \ud83d\udc1b Bug\r\n\r\nThe runpath in the installed libraries is set to the tmp_install directory of the build:\r\n```\r\nobjdump  -p /usr/local/lib/python3.6/dist-packages/torch/lib/libtorch.so | grep RUNPATH\r\n  RUNPATH              :/home/something/pytorch/torch/lib/tmp_install/lib:/opt/intel/mkl/lib/intel64\r\n```\r\nThis causes the loader to not find dependency libraries (if they don't exist there or it doesn't have access) or load the wrong ones (when the version I'm fiddling with isn't the one installed and I want the installed one).\r\n\r\n## To Reproduce\r\n\r\n```\r\nPATH=/usr/lib/ccache/:$PATH python3 setup.py  bdist_wheel \r\nsudo pip3 install dist/*.whl\r\n```\r\nI sometimes use gcc/g++-7 by specifying CC/CXX and use DEBUG=1.\r\n\r\n## Expected behavior\r\n\r\nProbably some rpath with $ORIGIN\r\n\r\n## Environment\r\n\r\nDebian sid, gcc-7, PyTorch/master from today.\r\n"}