{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3717", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3717/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3717/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3717/events", "html_url": "https://github.com/pytorch/pytorch/issues/3717", "id": 274220570, "node_id": "MDU6SXNzdWUyNzQyMjA1NzA=", "number": 3717, "title": "Pytorch AssertionError: Torch not compiled with CUDA enabled", "user": {"login": "sharmalakshay93", "id": 8191481, "node_id": "MDQ6VXNlcjgxOTE0ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/8191481?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sharmalakshay93", "html_url": "https://github.com/sharmalakshay93", "followers_url": "https://api.github.com/users/sharmalakshay93/followers", "following_url": "https://api.github.com/users/sharmalakshay93/following{/other_user}", "gists_url": "https://api.github.com/users/sharmalakshay93/gists{/gist_id}", "starred_url": "https://api.github.com/users/sharmalakshay93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sharmalakshay93/subscriptions", "organizations_url": "https://api.github.com/users/sharmalakshay93/orgs", "repos_url": "https://api.github.com/users/sharmalakshay93/repos", "events_url": "https://api.github.com/users/sharmalakshay93/events{/privacy}", "received_events_url": "https://api.github.com/users/sharmalakshay93/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-11-15T16:30:52Z", "updated_at": "2018-01-16T19:50:47Z", "closed_at": "2018-01-16T19:50:47Z", "author_association": "NONE", "body_html": "<p>I am trying to run code from <a href=\"https://github.com/eladhoffer/captionGen\">this repo</a>. I have disabled cuda by changing lines 39/40 in <a href=\"https://github.com/eladhoffer/captionGen/blob/master/main.py\">main.py</a> from</p>\n<div class=\"highlight highlight-source-python\"><pre>parser.add_argument(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>--type<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">default</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>torch.cuda.FloatTensor<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">help</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>type of tensor - e.g torch.cuda.HalfTensor<span class=\"pl-pds\">'</span></span>)</pre></div>\n<p>to</p>\n<div class=\"highlight highlight-source-python\"><pre>parser.add_argument(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>--type<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">default</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>torch.FloatTensor<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">help</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>type of tensor - e.g torch.HalfTensor<span class=\"pl-pds\">'</span></span>)</pre></div>\n<p>However, I keep receiving the aforementioned AssertionError. Below is the trace:</p>\n<div class=\"highlight highlight-source-python\"><pre>Traceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>main.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">190</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    main()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>main.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">178</span>, <span class=\"pl-k\">in</span> main\n    model, train_data, training<span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>, optimizer<span class=\"pl-k\">=</span>optimizer)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>main.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">135</span>, <span class=\"pl-k\">in</span> forward\n    <span class=\"pl-k\">for</span> i, (imgs, (captions, lengths)) <span class=\"pl-k\">in</span> <span class=\"pl-c1\">enumerate</span>(data):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">201</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__next__</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._process_next_batch(batch)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">221</span>, <span class=\"pl-k\">in</span> _process_next_batch\n    <span class=\"pl-k\">raise</span> batch.exc_type(batch.exc_msg)\n<span class=\"pl-c1\">AssertionError</span>: Traceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">62</span>, <span class=\"pl-k\">in</span> _pin_memory_loop\n    batch <span class=\"pl-k\">=</span> pin_memory_batch(batch)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">123</span>, <span class=\"pl-k\">in</span> pin_memory_batch\n    <span class=\"pl-k\">return</span> [pin_memory_batch(sample) <span class=\"pl-k\">for</span> sample <span class=\"pl-k\">in</span> batch]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">123</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>listcomp<span class=\"pl-k\">&gt;</span>\n    <span class=\"pl-k\">return</span> [pin_memory_batch(sample) <span class=\"pl-k\">for</span> sample <span class=\"pl-k\">in</span> batch]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">117</span>, <span class=\"pl-k\">in</span> pin_memory_batch\n    <span class=\"pl-k\">return</span> batch.pin_memory()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/tensor.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">82</span>, <span class=\"pl-k\">in</span> pin_memory\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">type</span>(<span class=\"pl-c1\">self</span>)().set_(storage.pin_memory()).view_as(<span class=\"pl-c1\">self</span>)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/storage.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">83</span>, <span class=\"pl-k\">in</span> pin_memory\n    allocator <span class=\"pl-k\">=</span> torch.cuda._host_allocator()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">220</span>, <span class=\"pl-k\">in</span> _host_allocator\n    _lazy_init()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">84</span>, <span class=\"pl-k\">in</span> _lazy_init\n    _check_driver()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">51</span>, <span class=\"pl-k\">in</span> _check_driver\n    <span class=\"pl-k\">raise</span> <span class=\"pl-c1\">AssertionError</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Torch not compiled with CUDA enabled<span class=\"pl-pds\">\"</span></span>)\n<span class=\"pl-c1\">AssertionError</span>: Torch <span class=\"pl-k\">not</span> compiled <span class=\"pl-k\">with</span> <span class=\"pl-c1\">CUDA</span> enabled</pre></div>\n<p>Unable to figure this out. Please help? Thanks!</p>", "body_text": "I am trying to run code from this repo. I have disabled cuda by changing lines 39/40 in main.py from\nparser.add_argument('--type', default='torch.cuda.FloatTensor', help='type of tensor - e.g torch.cuda.HalfTensor')\nto\nparser.add_argument('--type', default='torch.FloatTensor', help='type of tensor - e.g torch.HalfTensor')\nHowever, I keep receiving the aforementioned AssertionError. Below is the trace:\nTraceback (most recent call last):\n  File \"main.py\", line 190, in <module>\n    main()\n  File \"main.py\", line 178, in main\n    model, train_data, training=True, optimizer=optimizer)\n  File \"main.py\", line 135, in forward\n    for i, (imgs, (captions, lengths)) in enumerate(data):\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 201, in __next__\n    return self._process_next_batch(batch)\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 221, in _process_next_batch\n    raise batch.exc_type(batch.exc_msg)\nAssertionError: Traceback (most recent call last):\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 62, in _pin_memory_loop\n    batch = pin_memory_batch(batch)\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 123, in pin_memory_batch\n    return [pin_memory_batch(sample) for sample in batch]\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 123, in <listcomp>\n    return [pin_memory_batch(sample) for sample in batch]\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 117, in pin_memory_batch\n    return batch.pin_memory()\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/tensor.py\", line 82, in pin_memory\n    return type(self)().set_(storage.pin_memory()).view_as(self)\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/storage.py\", line 83, in pin_memory\n    allocator = torch.cuda._host_allocator()\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 220, in _host_allocator\n    _lazy_init()\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 84, in _lazy_init\n    _check_driver()\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 51, in _check_driver\n    raise AssertionError(\"Torch not compiled with CUDA enabled\")\nAssertionError: Torch not compiled with CUDA enabled\nUnable to figure this out. Please help? Thanks!", "body": "I am trying to run code from [this repo](https://github.com/eladhoffer/captionGen). I have disabled cuda by changing lines 39/40 in [main.py](https://github.com/eladhoffer/captionGen/blob/master/main.py) from\r\n\r\n```Python\r\nparser.add_argument('--type', default='torch.cuda.FloatTensor', help='type of tensor - e.g torch.cuda.HalfTensor')\r\n```\r\n\r\nto\r\n\r\n```Python\r\nparser.add_argument('--type', default='torch.FloatTensor', help='type of tensor - e.g torch.HalfTensor')\r\n```\r\n\r\nHowever, I keep receiving the aforementioned AssertionError. Below is the trace:\r\n\r\n```Python\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 190, in <module>\r\n    main()\r\n  File \"main.py\", line 178, in main\r\n    model, train_data, training=True, optimizer=optimizer)\r\n  File \"main.py\", line 135, in forward\r\n    for i, (imgs, (captions, lengths)) in enumerate(data):\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 201, in __next__\r\n    return self._process_next_batch(batch)\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 221, in _process_next_batch\r\n    raise batch.exc_type(batch.exc_msg)\r\nAssertionError: Traceback (most recent call last):\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 62, in _pin_memory_loop\r\n    batch = pin_memory_batch(batch)\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 123, in pin_memory_batch\r\n    return [pin_memory_batch(sample) for sample in batch]\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 123, in <listcomp>\r\n    return [pin_memory_batch(sample) for sample in batch]\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 117, in pin_memory_batch\r\n    return batch.pin_memory()\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/tensor.py\", line 82, in pin_memory\r\n    return type(self)().set_(storage.pin_memory()).view_as(self)\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/storage.py\", line 83, in pin_memory\r\n    allocator = torch.cuda._host_allocator()\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 220, in _host_allocator\r\n    _lazy_init()\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 84, in _lazy_init\r\n    _check_driver()\r\n  File \"/Users/lakshay/anaconda/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 51, in _check_driver\r\n    raise AssertionError(\"Torch not compiled with CUDA enabled\")\r\nAssertionError: Torch not compiled with CUDA enabled\r\n```\r\n\r\nUnable to figure this out. Please help? Thanks!\r\n\r\n"}