{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12637", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12637/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12637/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12637/events", "html_url": "https://github.com/pytorch/pytorch/issues/12637", "id": 369944643, "node_id": "MDU6SXNzdWUzNjk5NDQ2NDM=", "number": 12637, "title": "Pytorch C++: How to divide Tensor by a Tensor with gradient?", "user": {"login": "slaweku", "id": 25310162, "node_id": "MDQ6VXNlcjI1MzEwMTYy", "avatar_url": "https://avatars0.githubusercontent.com/u/25310162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/slaweku", "html_url": "https://github.com/slaweku", "followers_url": "https://api.github.com/users/slaweku/followers", "following_url": "https://api.github.com/users/slaweku/following{/other_user}", "gists_url": "https://api.github.com/users/slaweku/gists{/gist_id}", "starred_url": "https://api.github.com/users/slaweku/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/slaweku/subscriptions", "organizations_url": "https://api.github.com/users/slaweku/orgs", "repos_url": "https://api.github.com/users/slaweku/repos", "events_url": "https://api.github.com/users/slaweku/events{/privacy}", "received_events_url": "https://api.github.com/users/slaweku/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-10-14T21:17:22Z", "updated_at": "2018-10-15T17:59:17Z", "closed_at": "2018-10-15T15:47:13Z", "author_association": "NONE", "body_html": "<p>Hi,<br>\nI am trying to port my Python code to C++ frontend, and got stuck on a following issue:<br>\nI am trying to divide a \"normal\" tensor obtained by<br>\nTensor input1_t = at::native::from_blob(input_vect.data(),{INPUT_SIZE});<br>\nby a Tensor with gradient, derived by some simple formulas from a parameter of the model<br>\nNow I want to calculate<br>\nTensor lev_t=levels_tVect[i][0];  //scalar with gradient<br>\nTensor input11_t=input1_t/lev_t;<br>\nand it dies on the second line with<br>\nlibc++abi.dylib: terminating with uncaught exception of type at::Error: copy_from does not support automatic differentiation; use copy_ instead (<em>s_copy_from at /Users/administrator/nightlies/2018_10_08/wheel_build_dirs/libtorch_2.7/pytorch/torch/csrc/autograd/generated/VariableType.cpp:431)<br>\nframe #0: at::CPUFloatType::s_copy</em>(at::Tensor&amp;, at::Tensor const&amp;, bool) const + 288 (0x101365880 in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171281708\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1\">#1</a>: at::TypeDefault::copy_(at::Tensor&amp;, at::Tensor const&amp;, bool) const + 363 (0x10148aecb in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171402941\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/2\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/2/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/2\">#2</a>: at::TypeDefault::copy(at::Tensor const&amp;, bool, at::optionalat::Device) const + 627 (0x10148b333 in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171485123\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/3/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/3\">#3</a>: at::TensorIterator::compute_common_type() + 907 (0x1012bcb3b in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171522963\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/4\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/4/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/4\">#4</a>: at::TensorIterator::Builder::build() + 63 (0x1012bfb1f in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"173498149\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/5/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/5\">#5</a>: at::TensorIterator::binary_op(at::Tensor&amp;, at::Tensor const&amp;, at::Tensor const&amp;) + 436 (0x1012bf984 in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"174289461\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/6\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/6/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/6\">#6</a>: at::native::div_out(at::Tensor&amp;, at::Tensor const&amp;, at::Tensor const&amp;) + 140 (0x1011b663c in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"174818921\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/7\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/7/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/7\">#7</a>: at::native::div(at::Tensor const&amp;, at::Tensor const&amp;) + 34 (0x1011b6d62 in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"174871471\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/8\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/8/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/8\">#8</a>: at::TypeDefault::div(at::Tensor const&amp;, at::Tensor const&amp;) const + 111 (0x1014cd5cf in libcaffe2.dylib)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"175537036\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/9\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/9/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/9\">#9</a>: at::Tensor::div(at::Tensor const&amp;) const + 82 (0x1000681b2 in ctorch1)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"175552272\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/10\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/10/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/10\">#10</a>: at::operator/(at::Tensor const&amp;, at::Tensor const&amp;) + 36 (0x10005a274 in ctorch1)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"175559413\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/11\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/11/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/11\">#11</a>: main + 51199 (0x100041c4f in ctorch1)<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"175559558\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/12\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/12/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/12\">#12</a>: start + 1 (0x7fff718bd015 in libdyld.dylib)</p>\n<p>Regards,<br>\nSlawek</p>", "body_text": "Hi,\nI am trying to port my Python code to C++ frontend, and got stuck on a following issue:\nI am trying to divide a \"normal\" tensor obtained by\nTensor input1_t = at::native::from_blob(input_vect.data(),{INPUT_SIZE});\nby a Tensor with gradient, derived by some simple formulas from a parameter of the model\nNow I want to calculate\nTensor lev_t=levels_tVect[i][0];  //scalar with gradient\nTensor input11_t=input1_t/lev_t;\nand it dies on the second line with\nlibc++abi.dylib: terminating with uncaught exception of type at::Error: copy_from does not support automatic differentiation; use copy_ instead (s_copy_from at /Users/administrator/nightlies/2018_10_08/wheel_build_dirs/libtorch_2.7/pytorch/torch/csrc/autograd/generated/VariableType.cpp:431)\nframe #0: at::CPUFloatType::s_copy(at::Tensor&, at::Tensor const&, bool) const + 288 (0x101365880 in libcaffe2.dylib)\nframe #1: at::TypeDefault::copy_(at::Tensor&, at::Tensor const&, bool) const + 363 (0x10148aecb in libcaffe2.dylib)\nframe #2: at::TypeDefault::copy(at::Tensor const&, bool, at::optionalat::Device) const + 627 (0x10148b333 in libcaffe2.dylib)\nframe #3: at::TensorIterator::compute_common_type() + 907 (0x1012bcb3b in libcaffe2.dylib)\nframe #4: at::TensorIterator::Builder::build() + 63 (0x1012bfb1f in libcaffe2.dylib)\nframe #5: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&) + 436 (0x1012bf984 in libcaffe2.dylib)\nframe #6: at::native::div_out(at::Tensor&, at::Tensor const&, at::Tensor const&) + 140 (0x1011b663c in libcaffe2.dylib)\nframe #7: at::native::div(at::Tensor const&, at::Tensor const&) + 34 (0x1011b6d62 in libcaffe2.dylib)\nframe #8: at::TypeDefault::div(at::Tensor const&, at::Tensor const&) const + 111 (0x1014cd5cf in libcaffe2.dylib)\nframe #9: at::Tensor::div(at::Tensor const&) const + 82 (0x1000681b2 in ctorch1)\nframe #10: at::operator/(at::Tensor const&, at::Tensor const&) + 36 (0x10005a274 in ctorch1)\nframe #11: main + 51199 (0x100041c4f in ctorch1)\nframe #12: start + 1 (0x7fff718bd015 in libdyld.dylib)\nRegards,\nSlawek", "body": "Hi, \r\nI am trying to port my Python code to C++ frontend, and got stuck on a following issue:\r\nI am trying to divide a \"normal\" tensor obtained by\r\nTensor input1_t = at::native::from_blob(input_vect.data(),{INPUT_SIZE});\r\nby a Tensor with gradient, derived by some simple formulas from a parameter of the model \r\nNow I want to calculate\r\n            Tensor lev_t=levels_tVect[i][0];  //scalar with gradient\r\n            Tensor input11_t=input1_t/lev_t;\r\nand it dies on the second line with\r\nlibc++abi.dylib: terminating with uncaught exception of type at::Error: copy_from does not support automatic differentiation; use copy_ instead (_s_copy_from at /Users/administrator/nightlies/2018_10_08/wheel_build_dirs/libtorch_2.7/pytorch/torch/csrc/autograd/generated/VariableType.cpp:431)\r\nframe #0: at::CPUFloatType::s_copy_(at::Tensor&, at::Tensor const&, bool) const + 288 (0x101365880 in libcaffe2.dylib)\r\nframe #1: at::TypeDefault::copy_(at::Tensor&, at::Tensor const&, bool) const + 363 (0x10148aecb in libcaffe2.dylib)\r\nframe #2: at::TypeDefault::copy(at::Tensor const&, bool, at::optional<at::Device>) const + 627 (0x10148b333 in libcaffe2.dylib)\r\nframe #3: at::TensorIterator::compute_common_type() + 907 (0x1012bcb3b in libcaffe2.dylib)\r\nframe #4: at::TensorIterator::Builder::build() + 63 (0x1012bfb1f in libcaffe2.dylib)\r\nframe #5: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&) + 436 (0x1012bf984 in libcaffe2.dylib)\r\nframe #6: at::native::div_out(at::Tensor&, at::Tensor const&, at::Tensor const&) + 140 (0x1011b663c in libcaffe2.dylib)\r\nframe #7: at::native::div(at::Tensor const&, at::Tensor const&) + 34 (0x1011b6d62 in libcaffe2.dylib)\r\nframe #8: at::TypeDefault::div(at::Tensor const&, at::Tensor const&) const + 111 (0x1014cd5cf in libcaffe2.dylib)\r\nframe #9: at::Tensor::div(at::Tensor const&) const + 82 (0x1000681b2 in ctorch1)\r\nframe #10: at::operator/(at::Tensor const&, at::Tensor const&) + 36 (0x10005a274 in ctorch1)\r\nframe #11: main + 51199 (0x100041c4f in ctorch1)\r\nframe #12: start + 1 (0x7fff718bd015 in libdyld.dylib)\r\n\r\nRegards,\r\nSlawek"}