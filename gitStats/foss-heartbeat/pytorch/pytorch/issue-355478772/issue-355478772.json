{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11071", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11071/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11071/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11071/events", "html_url": "https://github.com/pytorch/pytorch/issues/11071", "id": 355478772, "node_id": "MDU6SXNzdWUzNTU0Nzg3NzI=", "number": 11071, "title": "undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'", "user": {"login": "chrissaher", "id": 4969425, "node_id": "MDQ6VXNlcjQ5Njk0MjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/4969425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrissaher", "html_url": "https://github.com/chrissaher", "followers_url": "https://api.github.com/users/chrissaher/followers", "following_url": "https://api.github.com/users/chrissaher/following{/other_user}", "gists_url": "https://api.github.com/users/chrissaher/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrissaher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrissaher/subscriptions", "organizations_url": "https://api.github.com/users/chrissaher/orgs", "repos_url": "https://api.github.com/users/chrissaher/repos", "events_url": "https://api.github.com/users/chrissaher/events{/privacy}", "received_events_url": "https://api.github.com/users/chrissaher/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 778855555, "node_id": "MDU6TGFiZWw3Nzg4NTU1NTU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/build", "name": "build", "color": "bfdadc", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-30T08:29:35Z", "updated_at": "2018-09-04T16:45:12Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>I finished compiling caffe2 from source on pytorch repository following this instructions: [(https://caffe2.ai/docs/getting-started.html?platform=ubuntu&amp;configuration=compile)]</p>\n<p>Now I am making some simple code to test caffe2 with C++ and getting this error:</p>\n<pre><code>g++ -c -std=gnu++0x -msse2 -I. -I/usr/local/cuda-9.0/include -I/home/ficha/Documents/external/pytorch/aten/src -I/usr/local/include -I/usr/include -I/home/ficha/Documents/external/pytorch/build/caffe2/proto -I/home/ficha/Documents/external/pytorch/thrid_party -I/home/ficha/Documents/external/pytorch/caffe2_include demo.cpp -o demo.o\ng++ demo.o -I. -I/usr/local/cuda-9.0/include -I/home/ficha/Documents/external/pytorch/aten/src -I/usr/local/include -I/usr/include -I/home/ficha/Documents/external/pytorch/build/caffe2/proto -I/home/ficha/Documents/external/pytorch/thrid_party -I/home/ficha/Documents/external/pytorch/caffe2_include -L/usr/local/lib -L/usr/local/cuda-9.0/lib64 -L/usr/local/cuda-9.0/lib -lcudart -lcublas -lcurand -lglog -lgflags -lprotobuf -lleveldb -lsnappy -llmdb -lboost_system -lm -lopencv_core -lopencv_highgui -lopencv_imgproc -lboost_thread -lstdc++ -lcblas -latlas -L/home/ficha/Documents/external/pytorch/build/lib/ -lcaffe2_gpu -lcaffe2 -lhdf5_hl -lhdf5 -lopencv_imgcodecs -L/home/ficha/Documents/external/pytorch/build/lib -L/usr/lib/x86_64-linux-gnu -L/usr/local/cuda-9.0/lib64 -L/home/ficha/Documents/external/pytorch/thrid_party -o demo\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_init_net::Caffe2FlagParser_init_net(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\ndemo.cpp:(.text+0xa4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_predict_net::Caffe2FlagParser_predict_net(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\ndemo.cpp:(.text+0xe4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_file::Caffe2FlagParser_file(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\ndemo.cpp:(.text+0x124): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_classes::Caffe2FlagParser_classes(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\ndemo.cpp:(.text+0x164): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse&lt;std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; &gt;(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_size::Caffe2FlagParser_size(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)':\ndemo.cpp:(.text+0x1a4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse&lt;int&gt;(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, int*)'\ndemo.o: In function '__static_initialization_and_destruction_0(int, int)':\ndemo.cpp:(.text+0x10d2): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x11e8): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x12fe): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x1414): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x14df): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ncollect2: error: ld returned 1 exit status\nmakefile:52: recipe for target 'demo' failed\nmake: *** [demo] Error 1\n</code></pre>\n<p>The code I want to compile is this:</p>\n<pre><code>#include &lt;caffe2/core/init.h&gt;\n#include &lt;caffe2/core/net.h&gt;\n#include &lt;caffe2/utils/proto_utils.h&gt;\n\n#include &lt;fstream&gt;\nusing namespace std;\n\nCAFFE2_DEFINE_string(init_net, \"res/squeezenet_init_net.pb\",\n                     \"The given path to the init protobuffer.\");\nCAFFE2_DEFINE_string(predict_net, \"res/squeezenet_predict_net.pb\",\n                     \"The given path to the predict protobuffer.\");\nCAFFE2_DEFINE_string(file, \"res/image_file.jpg\", \"The image file.\");\nCAFFE2_DEFINE_string(classes, \"res/imagenet_classes.txt\", \"The classes file.\");\nCAFFE2_DEFINE_int(size, 227, \"The image file.\");\n\nnamespace caffe2 {\n\n}\n\nint main(int argc, char** argv) {\n  caffe2::GlobalInit(&amp;argc, &amp;argv);\n  google::protobuf::ShutdownProtobufLibrary();\n  cout &lt;&lt; \"caffe loaded correctly\" &lt;&lt; endl;\n  return 0;\n}\n</code></pre>\n<p>This is the result of the cmake</p>\n<pre><code>-- ******** Summary ********\n-- General:\n--   CMake version         : 3.5.1\n--   CMake command         : /usr/bin/cmake\n--   Git version           : v0.1.11-9987-gb885dea-dirty\n--   System                : Linux\n--   C++ compiler          : /usr/bin/c++\n--   C++ compiler version  : 5.4.0\n--   BLAS                  : MKL\n--   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -rdynamic -DONNX_NAMESPACE=onnx_torch -fopenmp -D__GLIBCXX_USE_CXX11_ABI=0 -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow\n--   Build type            : Release\n--   Compile definitions   : USE_GCC_ATOMICS=1;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\n--   CMAKE_PREFIX_PATH     : /home/ficha/.envs/pytorch0_4/lib/python3.5/site-packages\n--   CMAKE_INSTALL_PREFIX  : /home/ficha/Documents/external/pytorch/torch/lib/tmp_install\n--\n--   BUILD_CAFFE2          : 1\n--   BUILD_ATEN_MOBILE     : OFF\n--   BUILD_BINARY          : OFF\n--   BUILD_CUSTOM_PROTOBUF : ON\n--     Link local protobuf : ON\n--   BUILD_DOCS            : OFF\n--   BUILD_PYTHON          : 1\n--     Python version      : 3.5.2\n--     Python executable   : /home/ficha/.envs/pytorch0_4/bin/python\n--     Pythonlibs version  : 3.5.2\n--     Python library      : /home/ficha/.envs/pytorch0_4/lib/python3.5\n--     Python includes     : /usr/include/python3.5m\n--     Python site-packages: lib/python3.5/site-packages\n--   BUILD_SHARED_LIBS     : ON\n--   BUILD_TEST            : OFF\n--   USE_ASAN              : OFF\n--   USE_CUDA              : 1\n--     CUDA static link    :\n--     USE_CUDNN           : ON\n--     CUDA version        : 9.0\n--     cuDNN version       : 7.1.3\n--     CUDA root directory : /usr/local/cuda-9.0\n--     CUDA library        : /usr/local/cuda-9.0/lib64/stubs/libcuda.so\n--     cudart library      : /usr/local/cuda-9.0/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\n--     cublas library      : /usr/local/cuda-9.0/lib64/libcublas.so;/usr/local/cuda-9.0/lib64/libcublas_device.a\n--     cufft library       : /usr/local/cuda-9.0/lib64/libcufft.so\n--     curand library      : /usr/local/cuda-9.0/lib64/libcurand.so\n--     cuDNN library       : /usr/local/cuda-9.0/lib64/libcudnn.so.7\n--     nvrtc               : /usr/local/cuda-9.0/lib64/libnvrtc.so\n--     CUDA include path   : /usr/local/cuda-9.0/include\n--     NVCC executable     : /usr/local/cuda-9.0/bin/nvcc\n--     CUDA host compiler  : /usr/bin/cc\n--     USE_TENSORRT        : OFF\n--   USE_ROCM              : OFF\n--   USE_EIGEN_FOR_BLAS    : ON\n--   USE_FFMPEG            : OFF\n--   USE_GFLAGS            : ON\n--   USE_GLOG              : ON\n--   USE_GLOO              : ON\n--     USE_GLOO_IBVERBS    : OFF\n--   USE_LEVELDB           : ON\n--     LevelDB version     : 1.18\n--     Snappy version      : 1.1.3\n--   USE_LITE_PROTO        : OFF\n--   USE_LMDB              : ON\n--     LMDB version        : 0.9.17\n--   USE_METAL             : OFF\n--   USE_MKL               :\n--   USE_MOBILE_OPENGL     : OFF\n--   USE_MPI               : ON\n--   USE_NCCL              : ON\n--     USE_SYSTEM_NCCL     : OFF\n--   USE_NERVANA_GPU       : OFF\n--   USE_NNPACK            : 1\n--   USE_OBSERVERS         : ON\n--   USE_OPENCL            : OFF\n--   USE_OPENCV            : ON\n--     OpenCV version      : 3.2.0\n--   USE_OPENMP            : OFF\n--   USE_PROF              : OFF\n--   USE_REDIS             : OFF\n--   USE_ROCKSDB           : OFF\n--   USE_ZMQ               : OFF\n--   USE_DISTRIBUTED       : OFF\n--   Public Dependencies  : Threads::Threads;gflags;glog::glog\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/liblmdb.so;/usr/lib/x86_64-linux-gnu/libleveldb.so;/usr/lib/x86_64-linux-gnu/libsnappy.so;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;opencv_imgcodecs;opencv_videoio;opencv_video;/usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so;gloo;gloo;aten_op_header_gen;onnxifi_loader;rt;gcc_s;gcc;dl\n-- Configuring done\n-- Generating done\n</code></pre>\n<p>Can anyone please bring me some help? If any more information is required, let me know. Thanks community.</p>", "body_text": "I finished compiling caffe2 from source on pytorch repository following this instructions: [(https://caffe2.ai/docs/getting-started.html?platform=ubuntu&configuration=compile)]\nNow I am making some simple code to test caffe2 with C++ and getting this error:\ng++ -c -std=gnu++0x -msse2 -I. -I/usr/local/cuda-9.0/include -I/home/ficha/Documents/external/pytorch/aten/src -I/usr/local/include -I/usr/include -I/home/ficha/Documents/external/pytorch/build/caffe2/proto -I/home/ficha/Documents/external/pytorch/thrid_party -I/home/ficha/Documents/external/pytorch/caffe2_include demo.cpp -o demo.o\ng++ demo.o -I. -I/usr/local/cuda-9.0/include -I/home/ficha/Documents/external/pytorch/aten/src -I/usr/local/include -I/usr/include -I/home/ficha/Documents/external/pytorch/build/caffe2/proto -I/home/ficha/Documents/external/pytorch/thrid_party -I/home/ficha/Documents/external/pytorch/caffe2_include -L/usr/local/lib -L/usr/local/cuda-9.0/lib64 -L/usr/local/cuda-9.0/lib -lcudart -lcublas -lcurand -lglog -lgflags -lprotobuf -lleveldb -lsnappy -llmdb -lboost_system -lm -lopencv_core -lopencv_highgui -lopencv_imgproc -lboost_thread -lstdc++ -lcblas -latlas -L/home/ficha/Documents/external/pytorch/build/lib/ -lcaffe2_gpu -lcaffe2 -lhdf5_hl -lhdf5 -lopencv_imgcodecs -L/home/ficha/Documents/external/pytorch/build/lib -L/usr/lib/x86_64-linux-gnu -L/usr/local/cuda-9.0/lib64 -L/home/ficha/Documents/external/pytorch/thrid_party -o demo\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_init_net::Caffe2FlagParser_init_net(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\ndemo.cpp:(.text+0xa4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_predict_net::Caffe2FlagParser_predict_net(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\ndemo.cpp:(.text+0xe4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_file::Caffe2FlagParser_file(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\ndemo.cpp:(.text+0x124): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_classes::Caffe2FlagParser_classes(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\ndemo.cpp:(.text+0x164): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_size::Caffe2FlagParser_size(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\ndemo.cpp:(.text+0x1a4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<int>(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int*)'\ndemo.o: In function '__static_initialization_and_destruction_0(int, int)':\ndemo.cpp:(.text+0x10d2): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x11e8): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x12fe): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x1414): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ndemo.cpp:(.text+0x14df): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\ncollect2: error: ld returned 1 exit status\nmakefile:52: recipe for target 'demo' failed\nmake: *** [demo] Error 1\n\nThe code I want to compile is this:\n#include <caffe2/core/init.h>\n#include <caffe2/core/net.h>\n#include <caffe2/utils/proto_utils.h>\n\n#include <fstream>\nusing namespace std;\n\nCAFFE2_DEFINE_string(init_net, \"res/squeezenet_init_net.pb\",\n                     \"The given path to the init protobuffer.\");\nCAFFE2_DEFINE_string(predict_net, \"res/squeezenet_predict_net.pb\",\n                     \"The given path to the predict protobuffer.\");\nCAFFE2_DEFINE_string(file, \"res/image_file.jpg\", \"The image file.\");\nCAFFE2_DEFINE_string(classes, \"res/imagenet_classes.txt\", \"The classes file.\");\nCAFFE2_DEFINE_int(size, 227, \"The image file.\");\n\nnamespace caffe2 {\n\n}\n\nint main(int argc, char** argv) {\n  caffe2::GlobalInit(&argc, &argv);\n  google::protobuf::ShutdownProtobufLibrary();\n  cout << \"caffe loaded correctly\" << endl;\n  return 0;\n}\n\nThis is the result of the cmake\n-- ******** Summary ********\n-- General:\n--   CMake version         : 3.5.1\n--   CMake command         : /usr/bin/cmake\n--   Git version           : v0.1.11-9987-gb885dea-dirty\n--   System                : Linux\n--   C++ compiler          : /usr/bin/c++\n--   C++ compiler version  : 5.4.0\n--   BLAS                  : MKL\n--   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -rdynamic -DONNX_NAMESPACE=onnx_torch -fopenmp -D__GLIBCXX_USE_CXX11_ABI=0 -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow\n--   Build type            : Release\n--   Compile definitions   : USE_GCC_ATOMICS=1;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\n--   CMAKE_PREFIX_PATH     : /home/ficha/.envs/pytorch0_4/lib/python3.5/site-packages\n--   CMAKE_INSTALL_PREFIX  : /home/ficha/Documents/external/pytorch/torch/lib/tmp_install\n--\n--   BUILD_CAFFE2          : 1\n--   BUILD_ATEN_MOBILE     : OFF\n--   BUILD_BINARY          : OFF\n--   BUILD_CUSTOM_PROTOBUF : ON\n--     Link local protobuf : ON\n--   BUILD_DOCS            : OFF\n--   BUILD_PYTHON          : 1\n--     Python version      : 3.5.2\n--     Python executable   : /home/ficha/.envs/pytorch0_4/bin/python\n--     Pythonlibs version  : 3.5.2\n--     Python library      : /home/ficha/.envs/pytorch0_4/lib/python3.5\n--     Python includes     : /usr/include/python3.5m\n--     Python site-packages: lib/python3.5/site-packages\n--   BUILD_SHARED_LIBS     : ON\n--   BUILD_TEST            : OFF\n--   USE_ASAN              : OFF\n--   USE_CUDA              : 1\n--     CUDA static link    :\n--     USE_CUDNN           : ON\n--     CUDA version        : 9.0\n--     cuDNN version       : 7.1.3\n--     CUDA root directory : /usr/local/cuda-9.0\n--     CUDA library        : /usr/local/cuda-9.0/lib64/stubs/libcuda.so\n--     cudart library      : /usr/local/cuda-9.0/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\n--     cublas library      : /usr/local/cuda-9.0/lib64/libcublas.so;/usr/local/cuda-9.0/lib64/libcublas_device.a\n--     cufft library       : /usr/local/cuda-9.0/lib64/libcufft.so\n--     curand library      : /usr/local/cuda-9.0/lib64/libcurand.so\n--     cuDNN library       : /usr/local/cuda-9.0/lib64/libcudnn.so.7\n--     nvrtc               : /usr/local/cuda-9.0/lib64/libnvrtc.so\n--     CUDA include path   : /usr/local/cuda-9.0/include\n--     NVCC executable     : /usr/local/cuda-9.0/bin/nvcc\n--     CUDA host compiler  : /usr/bin/cc\n--     USE_TENSORRT        : OFF\n--   USE_ROCM              : OFF\n--   USE_EIGEN_FOR_BLAS    : ON\n--   USE_FFMPEG            : OFF\n--   USE_GFLAGS            : ON\n--   USE_GLOG              : ON\n--   USE_GLOO              : ON\n--     USE_GLOO_IBVERBS    : OFF\n--   USE_LEVELDB           : ON\n--     LevelDB version     : 1.18\n--     Snappy version      : 1.1.3\n--   USE_LITE_PROTO        : OFF\n--   USE_LMDB              : ON\n--     LMDB version        : 0.9.17\n--   USE_METAL             : OFF\n--   USE_MKL               :\n--   USE_MOBILE_OPENGL     : OFF\n--   USE_MPI               : ON\n--   USE_NCCL              : ON\n--     USE_SYSTEM_NCCL     : OFF\n--   USE_NERVANA_GPU       : OFF\n--   USE_NNPACK            : 1\n--   USE_OBSERVERS         : ON\n--   USE_OPENCL            : OFF\n--   USE_OPENCV            : ON\n--     OpenCV version      : 3.2.0\n--   USE_OPENMP            : OFF\n--   USE_PROF              : OFF\n--   USE_REDIS             : OFF\n--   USE_ROCKSDB           : OFF\n--   USE_ZMQ               : OFF\n--   USE_DISTRIBUTED       : OFF\n--   Public Dependencies  : Threads::Threads;gflags;glog::glog\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/liblmdb.so;/usr/lib/x86_64-linux-gnu/libleveldb.so;/usr/lib/x86_64-linux-gnu/libsnappy.so;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;opencv_imgcodecs;opencv_videoio;opencv_video;/usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so;gloo;gloo;aten_op_header_gen;onnxifi_loader;rt;gcc_s;gcc;dl\n-- Configuring done\n-- Generating done\n\nCan anyone please bring me some help? If any more information is required, let me know. Thanks community.", "body": "I finished compiling caffe2 from source on pytorch repository following this instructions: [(https://caffe2.ai/docs/getting-started.html?platform=ubuntu&configuration=compile)]\r\n\r\nNow I am making some simple code to test caffe2 with C++ and getting this error:\r\n\r\n```\r\ng++ -c -std=gnu++0x -msse2 -I. -I/usr/local/cuda-9.0/include -I/home/ficha/Documents/external/pytorch/aten/src -I/usr/local/include -I/usr/include -I/home/ficha/Documents/external/pytorch/build/caffe2/proto -I/home/ficha/Documents/external/pytorch/thrid_party -I/home/ficha/Documents/external/pytorch/caffe2_include demo.cpp -o demo.o\r\ng++ demo.o -I. -I/usr/local/cuda-9.0/include -I/home/ficha/Documents/external/pytorch/aten/src -I/usr/local/include -I/usr/include -I/home/ficha/Documents/external/pytorch/build/caffe2/proto -I/home/ficha/Documents/external/pytorch/thrid_party -I/home/ficha/Documents/external/pytorch/caffe2_include -L/usr/local/lib -L/usr/local/cuda-9.0/lib64 -L/usr/local/cuda-9.0/lib -lcudart -lcublas -lcurand -lglog -lgflags -lprotobuf -lleveldb -lsnappy -llmdb -lboost_system -lm -lopencv_core -lopencv_highgui -lopencv_imgproc -lboost_thread -lstdc++ -lcblas -latlas -L/home/ficha/Documents/external/pytorch/build/lib/ -lcaffe2_gpu -lcaffe2 -lhdf5_hl -lhdf5 -lopencv_imgcodecs -L/home/ficha/Documents/external/pytorch/build/lib -L/usr/lib/x86_64-linux-gnu -L/usr/local/cuda-9.0/lib64 -L/home/ficha/Documents/external/pytorch/thrid_party -o demo\r\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_init_net::Caffe2FlagParser_init_net(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\r\ndemo.cpp:(.text+0xa4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\r\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_predict_net::Caffe2FlagParser_predict_net(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\r\ndemo.cpp:(.text+0xe4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\r\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_file::Caffe2FlagParser_file(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\r\ndemo.cpp:(.text+0x124): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\r\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_classes::Caffe2FlagParser_classes(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\r\ndemo.cpp:(.text+0x164): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'\r\ndemo.o: In function 'caffe2::(anonymous namespace)::Caffe2FlagParser_size::Caffe2FlagParser_size(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)':\r\ndemo.cpp:(.text+0x1a4): undefined reference to 'bool caffe2::Caffe2FlagParser::Parse<int>(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int*)'\r\ndemo.o: In function '__static_initialization_and_destruction_0(int, int)':\r\ndemo.cpp:(.text+0x10d2): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\r\ndemo.cpp:(.text+0x11e8): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\r\ndemo.cpp:(.text+0x12fe): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\r\ndemo.cpp:(.text+0x1414): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\r\ndemo.cpp:(.text+0x14df): undefined reference to 'caffe2::Caffe2FlagsRegistry[abi:cxx11]()'\r\ncollect2: error: ld returned 1 exit status\r\nmakefile:52: recipe for target 'demo' failed\r\nmake: *** [demo] Error 1\r\n```\r\n\r\nThe code I want to compile is this: \r\n\r\n```\r\n#include <caffe2/core/init.h>\r\n#include <caffe2/core/net.h>\r\n#include <caffe2/utils/proto_utils.h>\r\n\r\n#include <fstream>\r\nusing namespace std;\r\n\r\nCAFFE2_DEFINE_string(init_net, \"res/squeezenet_init_net.pb\",\r\n                     \"The given path to the init protobuffer.\");\r\nCAFFE2_DEFINE_string(predict_net, \"res/squeezenet_predict_net.pb\",\r\n                     \"The given path to the predict protobuffer.\");\r\nCAFFE2_DEFINE_string(file, \"res/image_file.jpg\", \"The image file.\");\r\nCAFFE2_DEFINE_string(classes, \"res/imagenet_classes.txt\", \"The classes file.\");\r\nCAFFE2_DEFINE_int(size, 227, \"The image file.\");\r\n\r\nnamespace caffe2 {\r\n\r\n}\r\n\r\nint main(int argc, char** argv) {\r\n  caffe2::GlobalInit(&argc, &argv);\r\n  google::protobuf::ShutdownProtobufLibrary();\r\n  cout << \"caffe loaded correctly\" << endl;\r\n  return 0;\r\n}\r\n```\r\n\r\nThis is the result of the cmake\r\n\r\n```\r\n-- ******** Summary ********\r\n-- General:\r\n--   CMake version         : 3.5.1\r\n--   CMake command         : /usr/bin/cmake\r\n--   Git version           : v0.1.11-9987-gb885dea-dirty\r\n--   System                : Linux\r\n--   C++ compiler          : /usr/bin/c++\r\n--   C++ compiler version  : 5.4.0\r\n--   BLAS                  : MKL\r\n--   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -rdynamic -DONNX_NAMESPACE=onnx_torch -fopenmp -D__GLIBCXX_USE_CXX11_ABI=0 -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow\r\n--   Build type            : Release\r\n--   Compile definitions   : USE_GCC_ATOMICS=1;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\r\n--   CMAKE_PREFIX_PATH     : /home/ficha/.envs/pytorch0_4/lib/python3.5/site-packages\r\n--   CMAKE_INSTALL_PREFIX  : /home/ficha/Documents/external/pytorch/torch/lib/tmp_install\r\n--\r\n--   BUILD_CAFFE2          : 1\r\n--   BUILD_ATEN_MOBILE     : OFF\r\n--   BUILD_BINARY          : OFF\r\n--   BUILD_CUSTOM_PROTOBUF : ON\r\n--     Link local protobuf : ON\r\n--   BUILD_DOCS            : OFF\r\n--   BUILD_PYTHON          : 1\r\n--     Python version      : 3.5.2\r\n--     Python executable   : /home/ficha/.envs/pytorch0_4/bin/python\r\n--     Pythonlibs version  : 3.5.2\r\n--     Python library      : /home/ficha/.envs/pytorch0_4/lib/python3.5\r\n--     Python includes     : /usr/include/python3.5m\r\n--     Python site-packages: lib/python3.5/site-packages\r\n--   BUILD_SHARED_LIBS     : ON\r\n--   BUILD_TEST            : OFF\r\n--   USE_ASAN              : OFF\r\n--   USE_CUDA              : 1\r\n--     CUDA static link    :\r\n--     USE_CUDNN           : ON\r\n--     CUDA version        : 9.0\r\n--     cuDNN version       : 7.1.3\r\n--     CUDA root directory : /usr/local/cuda-9.0\r\n--     CUDA library        : /usr/local/cuda-9.0/lib64/stubs/libcuda.so\r\n--     cudart library      : /usr/local/cuda-9.0/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\r\n--     cublas library      : /usr/local/cuda-9.0/lib64/libcublas.so;/usr/local/cuda-9.0/lib64/libcublas_device.a\r\n--     cufft library       : /usr/local/cuda-9.0/lib64/libcufft.so\r\n--     curand library      : /usr/local/cuda-9.0/lib64/libcurand.so\r\n--     cuDNN library       : /usr/local/cuda-9.0/lib64/libcudnn.so.7\r\n--     nvrtc               : /usr/local/cuda-9.0/lib64/libnvrtc.so\r\n--     CUDA include path   : /usr/local/cuda-9.0/include\r\n--     NVCC executable     : /usr/local/cuda-9.0/bin/nvcc\r\n--     CUDA host compiler  : /usr/bin/cc\r\n--     USE_TENSORRT        : OFF\r\n--   USE_ROCM              : OFF\r\n--   USE_EIGEN_FOR_BLAS    : ON\r\n--   USE_FFMPEG            : OFF\r\n--   USE_GFLAGS            : ON\r\n--   USE_GLOG              : ON\r\n--   USE_GLOO              : ON\r\n--     USE_GLOO_IBVERBS    : OFF\r\n--   USE_LEVELDB           : ON\r\n--     LevelDB version     : 1.18\r\n--     Snappy version      : 1.1.3\r\n--   USE_LITE_PROTO        : OFF\r\n--   USE_LMDB              : ON\r\n--     LMDB version        : 0.9.17\r\n--   USE_METAL             : OFF\r\n--   USE_MKL               :\r\n--   USE_MOBILE_OPENGL     : OFF\r\n--   USE_MPI               : ON\r\n--   USE_NCCL              : ON\r\n--     USE_SYSTEM_NCCL     : OFF\r\n--   USE_NERVANA_GPU       : OFF\r\n--   USE_NNPACK            : 1\r\n--   USE_OBSERVERS         : ON\r\n--   USE_OPENCL            : OFF\r\n--   USE_OPENCV            : ON\r\n--     OpenCV version      : 3.2.0\r\n--   USE_OPENMP            : OFF\r\n--   USE_PROF              : OFF\r\n--   USE_REDIS             : OFF\r\n--   USE_ROCKSDB           : OFF\r\n--   USE_ZMQ               : OFF\r\n--   USE_DISTRIBUTED       : OFF\r\n--   Public Dependencies  : Threads::Threads;gflags;glog::glog\r\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/liblmdb.so;/usr/lib/x86_64-linux-gnu/libleveldb.so;/usr/lib/x86_64-linux-gnu/libsnappy.so;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;opencv_imgcodecs;opencv_videoio;opencv_video;/usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so;gloo;gloo;aten_op_header_gen;onnxifi_loader;rt;gcc_s;gcc;dl\r\n-- Configuring done\r\n-- Generating done\r\n```\r\n\r\nCan anyone please bring me some help? If any more information is required, let me know. Thanks community."}