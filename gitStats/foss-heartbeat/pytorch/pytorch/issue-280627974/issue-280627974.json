{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4093", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4093/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4093/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4093/events", "html_url": "https://github.com/pytorch/pytorch/issues/4093", "id": 280627974, "node_id": "MDU6SXNzdWUyODA2Mjc5NzQ=", "number": 4093, "title": "Crash with invalid indices to a sparse matrix", "user": {"login": "t-vi", "id": 20787943, "node_id": "MDQ6VXNlcjIwNzg3OTQz", "avatar_url": "https://avatars2.githubusercontent.com/u/20787943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/t-vi", "html_url": "https://github.com/t-vi", "followers_url": "https://api.github.com/users/t-vi/followers", "following_url": "https://api.github.com/users/t-vi/following{/other_user}", "gists_url": "https://api.github.com/users/t-vi/gists{/gist_id}", "starred_url": "https://api.github.com/users/t-vi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/t-vi/subscriptions", "organizations_url": "https://api.github.com/users/t-vi/orgs", "repos_url": "https://api.github.com/users/t-vi/repos", "events_url": "https://api.github.com/users/t-vi/events{/privacy}", "received_events_url": "https://api.github.com/users/t-vi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-12-08T21:52:27Z", "updated_at": "2018-02-02T03:08:21Z", "closed_at": "2018-02-02T03:08:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi,</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c1\">1</span><span class=\"pl-k\">/</span>torch.sparse.FloatTensor((torch.randperm(<span class=\"pl-c1\">1000</span>)<span class=\"pl-k\">%</span><span class=\"pl-c1\">10</span>).unsqueeze(<span class=\"pl-c1\">0</span>), torch.ones(<span class=\"pl-c1\">1000</span>), torch.Size((<span class=\"pl-c1\">4</span>,))).to_dense()</pre></div>\n<p>seems to crash 0.3.0 post 4 on python 3.6.</p>\n<p>Best regards</p>\n<p>Thomas</p>\n<p>Stack trace:</p>\n<pre><code>#1  0x00007ffff6ce819a in __GI_abort () at abort.c:89\n#2  0x00007ffff6d25310 in __libc_message (do_abort=do_abort@entry=2, fmt=fmt@entry=0x7ffff6e1fd30 \"*** Error in `%s': %s: 0x%s ***\\n\") at ../sysdeps/posix/libc_fatal.c:175\n#3  0x00007ffff6d2b96e in malloc_printerr (action=3, str=0x7ffff6e1c838 \"corrupted double-linked list\", ptr=&lt;optimized out&gt;, ar_ptr=&lt;optimized out&gt;) at malloc.c:5079\n#4  0x00007ffff6d2bd18 in malloc_consolidate (av=av@entry=0x7ffff7050b00 &lt;main_arena&gt;) at malloc.c:4192\n#5  0x00007ffff6d2d7ca in _int_malloc (av=av@entry=0x7ffff7050b00 &lt;main_arena&gt;, bytes=bytes@entry=1528) at malloc.c:3452\n#6  0x00007ffff6d2f874 in __GI___libc_malloc (bytes=1528) at malloc.c:2892\n#7  0x00007fffb2a722b9 in ?? () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\n#8  0x00007fffb2a7c13b in ?? () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\n#9  0x00007fffb2a77b3c in GOMP_parallel_start () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\n#10 0x00007fffd0f0c3bb in THFloatTensor_fill () from /usr/local/lib/python3.6/dist-packages/torch/lib/libTH.so.1\n#11 0x00007fffe5946f10 in THPFloatTensor_fill_ (self=&lt;torch.FloatTensor at remote 0x7ffff6a8a7c8&gt;, args=&lt;optimized out&gt;, kwargs=&lt;optimized out&gt;) at /pytorch/torch/csrc/generic/TensorMethods.cpp:993\n#12 0x00000000004c4e7b in _PyCFunction_FastCallDict (kwargs=0x0, nargs=140737331636168, args=0x7ffff6b54e50, func_obj=&lt;built-in method fill_ of torch.FloatTensor object at remote 0x7ffff6a8a7c8&gt;)\n    at ../Objects/methodobject.c:231\n#13 _PyCFunction_FastCallKeywords (func=func@entry=&lt;built-in method fill_ of torch.FloatTensor object at remote 0x7ffff6a8a7c8&gt;, stack=stack@entry=0x7ffff6b54e50, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0)\n    at ../Objects/methodobject.c:294\n#14 0x000000000054f924 in call_function (pp_stack=pp_stack@entry=0x7fffffffdcc8, oparg=&lt;optimized out&gt;, kwnames=kwnames@entry=0x0) at ../Python/ceval.c:4824\n#15 0x000000000055400f in _PyEval_EvalFrameDefault (f=&lt;optimized out&gt;, throwflag=&lt;optimized out&gt;) at ../Python/ceval.c:3322\n#16 0x000000000054ea28 in PyEval_EvalFrameEx (throwflag=0, f=\n    Frame 0x7ffff6b54cc0, for file /usr/local/lib/python3.6/dist-packages/torch/tensor.py, line 334, in __rdiv__ (self=&lt;torch.FloatTensor at remote 0x7ffff6a8a748&gt;, other=1)) at ../Python/ceval.c:753\n#17 _PyFunction_FastCall (co=co@entry=0x7fffa7c4b660, args=&lt;optimized out&gt;, args@entry=0x7fffffffde20, nargs=nargs@entry=2, \n    globals=globals@entry={'__name__': 'torch.tensor', '__doc__': None, '__package__': 'torch', '__loader__': &lt;SourceFileLoader(name='torch.tensor', path='/usr/local/lib/python3.6/dist-packages/torch/tensor.py') at remote 0x7fffa7c3eb70&gt;, '__spec__': &lt;ModuleSpec(name='torch.tensor', loader=&lt;...&gt;, origin='/usr/local/lib/python3.6/dist-packages/torch/tensor.py', loader_state=None, submodule_search_locations=None, _set_fileattr=True, _cached='/usr/local/lib/python3.6/dist-packages/torch/__pycache__/tensor.cpython-36.pyc', _initializing=False) at remote 0x7fffa7c3eba8&gt;, '__file__': '/usr/local/lib/python3.6/dist-packages/torch/tensor.py', '__cached__': '/usr/local/lib/python3.6/dist-packages/torch/__pycache__/tensor.cpython-36.pyc', '__builtins__': {'__name__': 'builtins', '__doc__': \"Built-in functions, exceptions, and other objects.\\n\\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices.\", '__package__': '', '__loader__': &lt;type at remote 0xaa0b98&gt;, '__spec__': &lt;ModuleSpec(name='builtins', loader=&lt;type at remote 0xa...(truncated)) at ../Python/ceval.c:4906\n#18 0x0000000000558832 in _PyFunction_FastCallDict (func=func@entry=&lt;function at remote 0x7fffa7c4f158&gt;, args=args@entry=0x7fffffffde20, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at ../Python/ceval.c:5008\n#19 0x0000000000459fb1 in _PyObject_FastCallDict (kwargs=0x0, nargs=2, args=0x7fffffffde20, func=&lt;function at remote 0x7fffa7c4f158&gt;) at ../Objects/abstract.c:2310\n#20 _PyObject_Call_Prepend (func=&lt;function at remote 0x7fffa7c4f158&gt;, obj=&lt;optimized out&gt;, args=(1,), kwargs=0x0) at ../Objects/abstract.c:2373\n#21 0x0000000000459a3e in PyObject_Call (func=func@entry=&lt;method at remote 0x7ffff6c66b08&gt;, args=args@entry=(1,), kwargs=kwargs@entry=0x0) at ../Objects/abstract.c:2261\n#22 0x00000000004e1208 in call_maybe (o=&lt;torch.FloatTensor at remote 0x7ffff6a8a748&gt;, nameid=&lt;optimized out&gt;, format=0x7716aa \"(O)\", format=0x7716aa \"(O)\") at ../Objects/typeobject.c:1493\n#23 0x0000000000455083 in binary_op1 (op_slot=240, w=&lt;torch.FloatTensor at remote 0x7ffff6a8a748&gt;, v=1) at ../Objects/abstract.c:786\n#24 binary_op (op_name=0x66065a \"/\", op_slot=240, w=&lt;torch.FloatTensor at remote 0x7ffff6a8a748&gt;, v=1, v@entry=0x0) at ../Objects/abstract.c:809\n#25 PyNumber_TrueDivide (v=v@entry=1, w=w@entry=&lt;torch.FloatTensor at remote 0x7ffff6a8a748&gt;) at ../Objects/abstract.c:992\n#26 0x0000000000552993 in _PyEval_EvalFrameDefault (f=&lt;optimized out&gt;, throwflag=&lt;optimized out&gt;) at ../Python/ceval.c:1434\n</code></pre>", "body_text": "Hi,\n1/torch.sparse.FloatTensor((torch.randperm(1000)%10).unsqueeze(0), torch.ones(1000), torch.Size((4,))).to_dense()\nseems to crash 0.3.0 post 4 on python 3.6.\nBest regards\nThomas\nStack trace:\n#1  0x00007ffff6ce819a in __GI_abort () at abort.c:89\n#2  0x00007ffff6d25310 in __libc_message (do_abort=do_abort@entry=2, fmt=fmt@entry=0x7ffff6e1fd30 \"*** Error in `%s': %s: 0x%s ***\\n\") at ../sysdeps/posix/libc_fatal.c:175\n#3  0x00007ffff6d2b96e in malloc_printerr (action=3, str=0x7ffff6e1c838 \"corrupted double-linked list\", ptr=<optimized out>, ar_ptr=<optimized out>) at malloc.c:5079\n#4  0x00007ffff6d2bd18 in malloc_consolidate (av=av@entry=0x7ffff7050b00 <main_arena>) at malloc.c:4192\n#5  0x00007ffff6d2d7ca in _int_malloc (av=av@entry=0x7ffff7050b00 <main_arena>, bytes=bytes@entry=1528) at malloc.c:3452\n#6  0x00007ffff6d2f874 in __GI___libc_malloc (bytes=1528) at malloc.c:2892\n#7  0x00007fffb2a722b9 in ?? () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\n#8  0x00007fffb2a7c13b in ?? () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\n#9  0x00007fffb2a77b3c in GOMP_parallel_start () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\n#10 0x00007fffd0f0c3bb in THFloatTensor_fill () from /usr/local/lib/python3.6/dist-packages/torch/lib/libTH.so.1\n#11 0x00007fffe5946f10 in THPFloatTensor_fill_ (self=<torch.FloatTensor at remote 0x7ffff6a8a7c8>, args=<optimized out>, kwargs=<optimized out>) at /pytorch/torch/csrc/generic/TensorMethods.cpp:993\n#12 0x00000000004c4e7b in _PyCFunction_FastCallDict (kwargs=0x0, nargs=140737331636168, args=0x7ffff6b54e50, func_obj=<built-in method fill_ of torch.FloatTensor object at remote 0x7ffff6a8a7c8>)\n    at ../Objects/methodobject.c:231\n#13 _PyCFunction_FastCallKeywords (func=func@entry=<built-in method fill_ of torch.FloatTensor object at remote 0x7ffff6a8a7c8>, stack=stack@entry=0x7ffff6b54e50, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0)\n    at ../Objects/methodobject.c:294\n#14 0x000000000054f924 in call_function (pp_stack=pp_stack@entry=0x7fffffffdcc8, oparg=<optimized out>, kwnames=kwnames@entry=0x0) at ../Python/ceval.c:4824\n#15 0x000000000055400f in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at ../Python/ceval.c:3322\n#16 0x000000000054ea28 in PyEval_EvalFrameEx (throwflag=0, f=\n    Frame 0x7ffff6b54cc0, for file /usr/local/lib/python3.6/dist-packages/torch/tensor.py, line 334, in __rdiv__ (self=<torch.FloatTensor at remote 0x7ffff6a8a748>, other=1)) at ../Python/ceval.c:753\n#17 _PyFunction_FastCall (co=co@entry=0x7fffa7c4b660, args=<optimized out>, args@entry=0x7fffffffde20, nargs=nargs@entry=2, \n    globals=globals@entry={'__name__': 'torch.tensor', '__doc__': None, '__package__': 'torch', '__loader__': <SourceFileLoader(name='torch.tensor', path='/usr/local/lib/python3.6/dist-packages/torch/tensor.py') at remote 0x7fffa7c3eb70>, '__spec__': <ModuleSpec(name='torch.tensor', loader=<...>, origin='/usr/local/lib/python3.6/dist-packages/torch/tensor.py', loader_state=None, submodule_search_locations=None, _set_fileattr=True, _cached='/usr/local/lib/python3.6/dist-packages/torch/__pycache__/tensor.cpython-36.pyc', _initializing=False) at remote 0x7fffa7c3eba8>, '__file__': '/usr/local/lib/python3.6/dist-packages/torch/tensor.py', '__cached__': '/usr/local/lib/python3.6/dist-packages/torch/__pycache__/tensor.cpython-36.pyc', '__builtins__': {'__name__': 'builtins', '__doc__': \"Built-in functions, exceptions, and other objects.\\n\\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices.\", '__package__': '', '__loader__': <type at remote 0xaa0b98>, '__spec__': <ModuleSpec(name='builtins', loader=<type at remote 0xa...(truncated)) at ../Python/ceval.c:4906\n#18 0x0000000000558832 in _PyFunction_FastCallDict (func=func@entry=<function at remote 0x7fffa7c4f158>, args=args@entry=0x7fffffffde20, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at ../Python/ceval.c:5008\n#19 0x0000000000459fb1 in _PyObject_FastCallDict (kwargs=0x0, nargs=2, args=0x7fffffffde20, func=<function at remote 0x7fffa7c4f158>) at ../Objects/abstract.c:2310\n#20 _PyObject_Call_Prepend (func=<function at remote 0x7fffa7c4f158>, obj=<optimized out>, args=(1,), kwargs=0x0) at ../Objects/abstract.c:2373\n#21 0x0000000000459a3e in PyObject_Call (func=func@entry=<method at remote 0x7ffff6c66b08>, args=args@entry=(1,), kwargs=kwargs@entry=0x0) at ../Objects/abstract.c:2261\n#22 0x00000000004e1208 in call_maybe (o=<torch.FloatTensor at remote 0x7ffff6a8a748>, nameid=<optimized out>, format=0x7716aa \"(O)\", format=0x7716aa \"(O)\") at ../Objects/typeobject.c:1493\n#23 0x0000000000455083 in binary_op1 (op_slot=240, w=<torch.FloatTensor at remote 0x7ffff6a8a748>, v=1) at ../Objects/abstract.c:786\n#24 binary_op (op_name=0x66065a \"/\", op_slot=240, w=<torch.FloatTensor at remote 0x7ffff6a8a748>, v=1, v@entry=0x0) at ../Objects/abstract.c:809\n#25 PyNumber_TrueDivide (v=v@entry=1, w=w@entry=<torch.FloatTensor at remote 0x7ffff6a8a748>) at ../Objects/abstract.c:992\n#26 0x0000000000552993 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at ../Python/ceval.c:1434", "body": "Hi,\r\n\r\n```python\r\n1/torch.sparse.FloatTensor((torch.randperm(1000)%10).unsqueeze(0), torch.ones(1000), torch.Size((4,))).to_dense()\r\n```\r\nseems to crash 0.3.0 post 4 on python 3.6.\r\n\r\nBest regards\r\n\r\nThomas\r\n\r\nStack trace:\r\n```\r\n#1  0x00007ffff6ce819a in __GI_abort () at abort.c:89\r\n#2  0x00007ffff6d25310 in __libc_message (do_abort=do_abort@entry=2, fmt=fmt@entry=0x7ffff6e1fd30 \"*** Error in `%s': %s: 0x%s ***\\n\") at ../sysdeps/posix/libc_fatal.c:175\r\n#3  0x00007ffff6d2b96e in malloc_printerr (action=3, str=0x7ffff6e1c838 \"corrupted double-linked list\", ptr=<optimized out>, ar_ptr=<optimized out>) at malloc.c:5079\r\n#4  0x00007ffff6d2bd18 in malloc_consolidate (av=av@entry=0x7ffff7050b00 <main_arena>) at malloc.c:4192\r\n#5  0x00007ffff6d2d7ca in _int_malloc (av=av@entry=0x7ffff7050b00 <main_arena>, bytes=bytes@entry=1528) at malloc.c:3452\r\n#6  0x00007ffff6d2f874 in __GI___libc_malloc (bytes=1528) at malloc.c:2892\r\n#7  0x00007fffb2a722b9 in ?? () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\r\n#8  0x00007fffb2a7c13b in ?? () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\r\n#9  0x00007fffb2a77b3c in GOMP_parallel_start () from /usr/local/lib/python3.6/dist-packages/torch/lib/libgomp.so.1\r\n#10 0x00007fffd0f0c3bb in THFloatTensor_fill () from /usr/local/lib/python3.6/dist-packages/torch/lib/libTH.so.1\r\n#11 0x00007fffe5946f10 in THPFloatTensor_fill_ (self=<torch.FloatTensor at remote 0x7ffff6a8a7c8>, args=<optimized out>, kwargs=<optimized out>) at /pytorch/torch/csrc/generic/TensorMethods.cpp:993\r\n#12 0x00000000004c4e7b in _PyCFunction_FastCallDict (kwargs=0x0, nargs=140737331636168, args=0x7ffff6b54e50, func_obj=<built-in method fill_ of torch.FloatTensor object at remote 0x7ffff6a8a7c8>)\r\n    at ../Objects/methodobject.c:231\r\n#13 _PyCFunction_FastCallKeywords (func=func@entry=<built-in method fill_ of torch.FloatTensor object at remote 0x7ffff6a8a7c8>, stack=stack@entry=0x7ffff6b54e50, nargs=nargs@entry=1, kwnames=kwnames@entry=0x0)\r\n    at ../Objects/methodobject.c:294\r\n#14 0x000000000054f924 in call_function (pp_stack=pp_stack@entry=0x7fffffffdcc8, oparg=<optimized out>, kwnames=kwnames@entry=0x0) at ../Python/ceval.c:4824\r\n#15 0x000000000055400f in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at ../Python/ceval.c:3322\r\n#16 0x000000000054ea28 in PyEval_EvalFrameEx (throwflag=0, f=\r\n    Frame 0x7ffff6b54cc0, for file /usr/local/lib/python3.6/dist-packages/torch/tensor.py, line 334, in __rdiv__ (self=<torch.FloatTensor at remote 0x7ffff6a8a748>, other=1)) at ../Python/ceval.c:753\r\n#17 _PyFunction_FastCall (co=co@entry=0x7fffa7c4b660, args=<optimized out>, args@entry=0x7fffffffde20, nargs=nargs@entry=2, \r\n    globals=globals@entry={'__name__': 'torch.tensor', '__doc__': None, '__package__': 'torch', '__loader__': <SourceFileLoader(name='torch.tensor', path='/usr/local/lib/python3.6/dist-packages/torch/tensor.py') at remote 0x7fffa7c3eb70>, '__spec__': <ModuleSpec(name='torch.tensor', loader=<...>, origin='/usr/local/lib/python3.6/dist-packages/torch/tensor.py', loader_state=None, submodule_search_locations=None, _set_fileattr=True, _cached='/usr/local/lib/python3.6/dist-packages/torch/__pycache__/tensor.cpython-36.pyc', _initializing=False) at remote 0x7fffa7c3eba8>, '__file__': '/usr/local/lib/python3.6/dist-packages/torch/tensor.py', '__cached__': '/usr/local/lib/python3.6/dist-packages/torch/__pycache__/tensor.cpython-36.pyc', '__builtins__': {'__name__': 'builtins', '__doc__': \"Built-in functions, exceptions, and other objects.\\n\\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices.\", '__package__': '', '__loader__': <type at remote 0xaa0b98>, '__spec__': <ModuleSpec(name='builtins', loader=<type at remote 0xa...(truncated)) at ../Python/ceval.c:4906\r\n#18 0x0000000000558832 in _PyFunction_FastCallDict (func=func@entry=<function at remote 0x7fffa7c4f158>, args=args@entry=0x7fffffffde20, nargs=nargs@entry=2, kwargs=kwargs@entry=0x0) at ../Python/ceval.c:5008\r\n#19 0x0000000000459fb1 in _PyObject_FastCallDict (kwargs=0x0, nargs=2, args=0x7fffffffde20, func=<function at remote 0x7fffa7c4f158>) at ../Objects/abstract.c:2310\r\n#20 _PyObject_Call_Prepend (func=<function at remote 0x7fffa7c4f158>, obj=<optimized out>, args=(1,), kwargs=0x0) at ../Objects/abstract.c:2373\r\n#21 0x0000000000459a3e in PyObject_Call (func=func@entry=<method at remote 0x7ffff6c66b08>, args=args@entry=(1,), kwargs=kwargs@entry=0x0) at ../Objects/abstract.c:2261\r\n#22 0x00000000004e1208 in call_maybe (o=<torch.FloatTensor at remote 0x7ffff6a8a748>, nameid=<optimized out>, format=0x7716aa \"(O)\", format=0x7716aa \"(O)\") at ../Objects/typeobject.c:1493\r\n#23 0x0000000000455083 in binary_op1 (op_slot=240, w=<torch.FloatTensor at remote 0x7ffff6a8a748>, v=1) at ../Objects/abstract.c:786\r\n#24 binary_op (op_name=0x66065a \"/\", op_slot=240, w=<torch.FloatTensor at remote 0x7ffff6a8a748>, v=1, v@entry=0x0) at ../Objects/abstract.c:809\r\n#25 PyNumber_TrueDivide (v=v@entry=1, w=w@entry=<torch.FloatTensor at remote 0x7ffff6a8a748>) at ../Objects/abstract.c:992\r\n#26 0x0000000000552993 in _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at ../Python/ceval.c:1434\r\n```"}