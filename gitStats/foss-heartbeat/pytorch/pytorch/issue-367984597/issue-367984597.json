{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12471", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12471/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12471/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12471/events", "html_url": "https://github.com/pytorch/pytorch/issues/12471", "id": 367984597, "node_id": "MDU6SXNzdWUzNjc5ODQ1OTc=", "number": 12471, "title": "c10d build depends on non-standard OpenMPI header mpi-ext.h", "user": {"login": "sparticlesteve", "id": 6074319, "node_id": "MDQ6VXNlcjYwNzQzMTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/6074319?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sparticlesteve", "html_url": "https://github.com/sparticlesteve", "followers_url": "https://api.github.com/users/sparticlesteve/followers", "following_url": "https://api.github.com/users/sparticlesteve/following{/other_user}", "gists_url": "https://api.github.com/users/sparticlesteve/gists{/gist_id}", "starred_url": "https://api.github.com/users/sparticlesteve/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sparticlesteve/subscriptions", "organizations_url": "https://api.github.com/users/sparticlesteve/orgs", "repos_url": "https://api.github.com/users/sparticlesteve/repos", "events_url": "https://api.github.com/users/sparticlesteve/events{/privacy}", "received_events_url": "https://api.github.com/users/sparticlesteve/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953883, "node_id": "MDU6TGFiZWw2Nzk5NTM4ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/distributed", "name": "distributed", "color": "c2e0c6", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-10-08T23:14:50Z", "updated_at": "2018-11-20T19:40:40Z", "closed_at": "2018-11-20T19:29:38Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>The file torch/lib/c10d/ProcessGroupMPI.cpp includes this header which as far as I can tell is specific to OpenMPI:</p>\n<pre><code>#include &lt;mpi-ext.h&gt; // Needed for CUDA-aware check\n</code></pre>\n<p>So this won't build with other MPI implementations, including Cray MPICH which we use at NERSC.<br>\nI was able to work around it with the following change:<br>\n<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/a59d94749b535e2e278036d89ae8904de18bd0b9/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/a59d94749b535e2e278036d89ae8904de18bd0b9\"><tt>a59d947</tt></a><br>\nbut maybe it also/instead needs a check on <code>#if defined (OPEN_MPI)</code>, and/or an alternate include or implementation when not using OpenMPI.</p>\n<h2>To Reproduce</h2>\n<p>I'm building pytorch from source on our systems, so the instructions won't be trivial. I can provide more details if asked but I hope the above description speaks for itself.</p>\n\n<h2>Environment</h2>\n<ul>\n<li>PyTorch Version (e.g., 1.0): 1.0rc1</li>\n<li>OS (e.g., Linux): Linux</li>\n<li>How you installed PyTorch (<code>conda</code>, <code>pip</code>, source): source</li>\n<li>Build command you used (if compiling from source): will provide on request</li>\n<li>Python version: 3.6.6</li>\n</ul>", "body_text": "\ud83d\udc1b Bug\nThe file torch/lib/c10d/ProcessGroupMPI.cpp includes this header which as far as I can tell is specific to OpenMPI:\n#include <mpi-ext.h> // Needed for CUDA-aware check\n\nSo this won't build with other MPI implementations, including Cray MPICH which we use at NERSC.\nI was able to work around it with the following change:\na59d947\nbut maybe it also/instead needs a check on #if defined (OPEN_MPI), and/or an alternate include or implementation when not using OpenMPI.\nTo Reproduce\nI'm building pytorch from source on our systems, so the instructions won't be trivial. I can provide more details if asked but I hope the above description speaks for itself.\n\nEnvironment\n\nPyTorch Version (e.g., 1.0): 1.0rc1\nOS (e.g., Linux): Linux\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): will provide on request\nPython version: 3.6.6", "body": "## \ud83d\udc1b Bug\r\n\r\nThe file torch/lib/c10d/ProcessGroupMPI.cpp includes this header which as far as I can tell is specific to OpenMPI:\r\n```\r\n#include <mpi-ext.h> // Needed for CUDA-aware check\r\n```\r\nSo this won't build with other MPI implementations, including Cray MPICH which we use at NERSC.\r\nI was able to work around it with the following change:\r\nhttps://github.com/pytorch/pytorch/commit/a59d94749b535e2e278036d89ae8904de18bd0b9\r\nbut maybe it also/instead needs a check on `#if defined (OPEN_MPI)`, and/or an alternate include or implementation when not using OpenMPI.\r\n\r\n## To Reproduce\r\n\r\nI'm building pytorch from source on our systems, so the instructions won't be trivial. I can provide more details if asked but I hope the above description speaks for itself.\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n## Environment\r\n\r\n - PyTorch Version (e.g., 1.0): 1.0rc1\r\n - OS (e.g., Linux): Linux\r\n - How you installed PyTorch (`conda`, `pip`, source): source\r\n - Build command you used (if compiling from source): will provide on request\r\n - Python version: 3.6.6\r\n"}