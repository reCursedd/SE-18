{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12984", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12984/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12984/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12984/events", "html_url": "https://github.com/pytorch/pytorch/issues/12984", "id": 372980375, "node_id": "MDU6SXNzdWUzNzI5ODAzNzU=", "number": 12984, "title": "Build Broken on master", "user": {"login": "realdoug", "id": 2383488, "node_id": "MDQ6VXNlcjIzODM0ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/2383488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/realdoug", "html_url": "https://github.com/realdoug", "followers_url": "https://api.github.com/users/realdoug/followers", "following_url": "https://api.github.com/users/realdoug/following{/other_user}", "gists_url": "https://api.github.com/users/realdoug/gists{/gist_id}", "starred_url": "https://api.github.com/users/realdoug/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/realdoug/subscriptions", "organizations_url": "https://api.github.com/users/realdoug/orgs", "repos_url": "https://api.github.com/users/realdoug/repos", "events_url": "https://api.github.com/users/realdoug/events{/privacy}", "received_events_url": "https://api.github.com/users/realdoug/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-10-23T12:44:08Z", "updated_at": "2018-10-24T10:22:24Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>Looks like as of <a href=\"https://github.com/pytorch/pytorch/commit/d401dc4374bd5532b3481f389dbe69f6835d5f3a\">this</a> commit, pytorch build fails on master</p>\n<p>Ubuntu 16.04 w/ CUDA 9</p>\n<p>after fresh checkout of master:<br>\n<code>python setup.py clean &amp;&amp; python setup.py install</code></p>\n<p>Build succeeds on the commit immediately previous.</p>\n<pre><code>Oct 23 07:50:26 [ 98%] Building CXX object test_api/CMakeFiles/test_api.dir/expanding-array.cpp.o\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:73:7: error: 'optional' in namespace 'at' does not name a template type\nOct 23 07:50:30    at::optional&lt;std::vector&lt;size_t&gt;&gt; next(size_t batch_size) override {\nOct 23 07:50:30        ^\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp: In member function 'virtual void DataTest_InfiniteStreamDataset_Test::TestBody()':\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:82:22: error: cannot declare variable 'sampler' to be of abstract type 'BatchSizeSampler'\nOct 23 07:50:30      BatchSizeSampler sampler;\nOct 23 07:50:30                       ^\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:71:8: note:   because the following virtual functions are pure within 'BatchSizeSampler':\nOct 23 07:50:30  struct BatchSizeSampler : samplers::Sampler {\nOct 23 07:50:30         ^\nOct 23 07:50:30 In file included from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/samplers/random.h:3:0,\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/dataloader.h:7,\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data.h:3,\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:3:\nOct 23 07:50:30 /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/samplers/base.h:24:41: note: virtual c10::optional&lt;std::vector&lt;long unsigned int&gt; &gt; torch::data::samplers::Sampler::next(size_t)\nOct 23 07:50:30    virtual optional&lt;std::vector&lt;size_t&gt;&gt; next(size_t batch_size) = 0;\nOct 23 07:50:30                                          ^\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:93:24: error: invalid cast to abstract class type 'BatchSizeSampler'\nOct 23 07:50:30        BatchSizeSampler{});\nOct 23 07:50:30                         ^\nOct 23 07:50:30 test_api/CMakeFiles/test_api.dir/build.make:134: recipe for target 'test_api/CMakeFiles/test_api.dir/dataloader.cpp.o' failed\nOct 23 07:50:30 make[2]: *** [test_api/CMakeFiles/test_api.dir/dataloader.cpp.o] Error 1\nOct 23 07:50:30 make[2]: *** Waiting for unfinished jobs....\nOct 23 07:50:31 make[1]: *** [test_api/CMakeFiles/test_api.dir/all] Error 2\nOct 23 07:50:31 make[1]: *** Waiting for unfinished jobs....\nOct 23 07:50:31 CMakeFiles/Makefile2:6638: recipe for target 'test_api/CMakeFiles/test_api.dir/all' failed\nOct 23 07:50:34 [ 98%] Linking CXX executable ../bin/test_jit\nOct 23 07:50:34 [ 98%] Built target test_jit\nOct 23 07:50:34 Makefile:138: recipe for target 'all' failed\nOct 23 07:50:34 make: *** [all] Error 2\nOct 23 07:50:34 setup.py::build_deps::run()\nOct 23 07:50:34 Failed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack caffe2 libshm c10d THD'\nExited with code 1\n</code></pre>", "body_text": "Looks like as of this commit, pytorch build fails on master\nUbuntu 16.04 w/ CUDA 9\nafter fresh checkout of master:\npython setup.py clean && python setup.py install\nBuild succeeds on the commit immediately previous.\nOct 23 07:50:26 [ 98%] Building CXX object test_api/CMakeFiles/test_api.dir/expanding-array.cpp.o\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:73:7: error: 'optional' in namespace 'at' does not name a template type\nOct 23 07:50:30    at::optional<std::vector<size_t>> next(size_t batch_size) override {\nOct 23 07:50:30        ^\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp: In member function 'virtual void DataTest_InfiniteStreamDataset_Test::TestBody()':\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:82:22: error: cannot declare variable 'sampler' to be of abstract type 'BatchSizeSampler'\nOct 23 07:50:30      BatchSizeSampler sampler;\nOct 23 07:50:30                       ^\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:71:8: note:   because the following virtual functions are pure within 'BatchSizeSampler':\nOct 23 07:50:30  struct BatchSizeSampler : samplers::Sampler {\nOct 23 07:50:30         ^\nOct 23 07:50:30 In file included from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/samplers/random.h:3:0,\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/dataloader.h:7,\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data.h:3,\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:3:\nOct 23 07:50:30 /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/samplers/base.h:24:41: note: virtual c10::optional<std::vector<long unsigned int> > torch::data::samplers::Sampler::next(size_t)\nOct 23 07:50:30    virtual optional<std::vector<size_t>> next(size_t batch_size) = 0;\nOct 23 07:50:30                                          ^\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:93:24: error: invalid cast to abstract class type 'BatchSizeSampler'\nOct 23 07:50:30        BatchSizeSampler{});\nOct 23 07:50:30                         ^\nOct 23 07:50:30 test_api/CMakeFiles/test_api.dir/build.make:134: recipe for target 'test_api/CMakeFiles/test_api.dir/dataloader.cpp.o' failed\nOct 23 07:50:30 make[2]: *** [test_api/CMakeFiles/test_api.dir/dataloader.cpp.o] Error 1\nOct 23 07:50:30 make[2]: *** Waiting for unfinished jobs....\nOct 23 07:50:31 make[1]: *** [test_api/CMakeFiles/test_api.dir/all] Error 2\nOct 23 07:50:31 make[1]: *** Waiting for unfinished jobs....\nOct 23 07:50:31 CMakeFiles/Makefile2:6638: recipe for target 'test_api/CMakeFiles/test_api.dir/all' failed\nOct 23 07:50:34 [ 98%] Linking CXX executable ../bin/test_jit\nOct 23 07:50:34 [ 98%] Built target test_jit\nOct 23 07:50:34 Makefile:138: recipe for target 'all' failed\nOct 23 07:50:34 make: *** [all] Error 2\nOct 23 07:50:34 setup.py::build_deps::run()\nOct 23 07:50:34 Failed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack caffe2 libshm c10d THD'\nExited with code 1", "body": "Looks like as of [this](https://github.com/pytorch/pytorch/commit/d401dc4374bd5532b3481f389dbe69f6835d5f3a) commit, pytorch build fails on master\r\n\r\nUbuntu 16.04 w/ CUDA 9\r\n\r\nafter fresh checkout of master:\r\n```python setup.py clean && python setup.py install```\r\n\r\nBuild succeeds on the commit immediately previous.\r\n\r\n```\r\nOct 23 07:50:26 [ 98%] Building CXX object test_api/CMakeFiles/test_api.dir/expanding-array.cpp.o\r\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:73:7: error: 'optional' in namespace 'at' does not name a template type\r\nOct 23 07:50:30    at::optional<std::vector<size_t>> next(size_t batch_size) override {\r\nOct 23 07:50:30        ^\r\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp: In member function 'virtual void DataTest_InfiniteStreamDataset_Test::TestBody()':\r\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:82:22: error: cannot declare variable 'sampler' to be of abstract type 'BatchSizeSampler'\r\nOct 23 07:50:30      BatchSizeSampler sampler;\r\nOct 23 07:50:30                       ^\r\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:71:8: note:   because the following virtual functions are pure within 'BatchSizeSampler':\r\nOct 23 07:50:30  struct BatchSizeSampler : samplers::Sampler {\r\nOct 23 07:50:30         ^\r\nOct 23 07:50:30 In file included from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/samplers/random.h:3:0,\r\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/dataloader.h:7,\r\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data.h:3,\r\nOct 23 07:50:30                  from /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:3:\r\nOct 23 07:50:30 /var/lib/jenkins/workspace/torch/csrc/api/include/torch/data/samplers/base.h:24:41: note: virtual c10::optional<std::vector<long unsigned int> > torch::data::samplers::Sampler::next(size_t)\r\nOct 23 07:50:30    virtual optional<std::vector<size_t>> next(size_t batch_size) = 0;\r\nOct 23 07:50:30                                          ^\r\nOct 23 07:50:30 /var/lib/jenkins/workspace/test/cpp/api/dataloader.cpp:93:24: error: invalid cast to abstract class type 'BatchSizeSampler'\r\nOct 23 07:50:30        BatchSizeSampler{});\r\nOct 23 07:50:30                         ^\r\nOct 23 07:50:30 test_api/CMakeFiles/test_api.dir/build.make:134: recipe for target 'test_api/CMakeFiles/test_api.dir/dataloader.cpp.o' failed\r\nOct 23 07:50:30 make[2]: *** [test_api/CMakeFiles/test_api.dir/dataloader.cpp.o] Error 1\r\nOct 23 07:50:30 make[2]: *** Waiting for unfinished jobs....\r\nOct 23 07:50:31 make[1]: *** [test_api/CMakeFiles/test_api.dir/all] Error 2\r\nOct 23 07:50:31 make[1]: *** Waiting for unfinished jobs....\r\nOct 23 07:50:31 CMakeFiles/Makefile2:6638: recipe for target 'test_api/CMakeFiles/test_api.dir/all' failed\r\nOct 23 07:50:34 [ 98%] Linking CXX executable ../bin/test_jit\r\nOct 23 07:50:34 [ 98%] Built target test_jit\r\nOct 23 07:50:34 Makefile:138: recipe for target 'all' failed\r\nOct 23 07:50:34 make: *** [all] Error 2\r\nOct 23 07:50:34 setup.py::build_deps::run()\r\nOct 23 07:50:34 Failed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack caffe2 libshm c10d THD'\r\nExited with code 1\r\n```"}