{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9561", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9561/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9561/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9561/events", "html_url": "https://github.com/pytorch/pytorch/pull/9561", "id": 342483945, "node_id": "MDExOlB1bGxSZXF1ZXN0MjAyMzczNjg0", "number": 9561, "title": "Eliminate direct access to size/strides of THTensor; replace them with std::vector", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-07-18T20:41:09Z", "updated_at": "2018-11-23T15:47:42Z", "closed_at": "2018-07-19T21:11:09Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/9561", "html_url": "https://github.com/pytorch/pytorch/pull/9561", "diff_url": "https://github.com/pytorch/pytorch/pull/9561.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/9561.patch"}, "body_html": "<ul>\n<li>THTensor now stores <code>sizes_</code> and <code>strides_</code> which is a <code>std::vector&lt;int64_t&gt;</code></li>\n<li>Anywhere a \"public\" API function made use of a int64_t* of sizes, I opted to just finagle it out of the tensor using THTensor_getSizePtr rather than try to rewrite all of these sites to use ArrayRef. They should use ArrayRef eventually, but not yet.</li>\n<li>There are new utility functions for resizing sizes/strides in one go (THTensor_resizeDim), or replacing sizes and strides with completely new values (THTensor_setSizesAndStrides)</li>\n<li>Anywhere you said <code>t-&gt;size[n] = 0</code>, we now say <code>THTensor_setSizeAt(t, n, 0)</code>, ditto for strides</li>\n<li>Anywhere you said <code>t-&gt;size[n]</code>, we now say <code>t-&gt;size(n)</code> (coming soon: ditto for strides)</li>\n</ul>\n<p>Previous review of just the <code>std::vector</code> change in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"342148201\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/9518\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/9518/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/9518\">#9518</a>, but I'm planning to merge this all in one go.</p>\n<p>Note for <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3768583\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gchanan\">@gchanan</a>: review from commit \"ci\" and after</p>", "body_text": "THTensor now stores sizes_ and strides_ which is a std::vector<int64_t>\nAnywhere a \"public\" API function made use of a int64_t* of sizes, I opted to just finagle it out of the tensor using THTensor_getSizePtr rather than try to rewrite all of these sites to use ArrayRef. They should use ArrayRef eventually, but not yet.\nThere are new utility functions for resizing sizes/strides in one go (THTensor_resizeDim), or replacing sizes and strides with completely new values (THTensor_setSizesAndStrides)\nAnywhere you said t->size[n] = 0, we now say THTensor_setSizeAt(t, n, 0), ditto for strides\nAnywhere you said t->size[n], we now say t->size(n) (coming soon: ditto for strides)\n\nPrevious review of just the std::vector change in #9518, but I'm planning to merge this all in one go.\nNote for @gchanan: review from commit \"ci\" and after", "body": "* THTensor now stores `sizes_` and `strides_` which is a `std::vector<int64_t>`\r\n* Anywhere a \"public\" API function made use of a int64_t* of sizes, I opted to just finagle it out of the tensor using THTensor_getSizePtr rather than try to rewrite all of these sites to use ArrayRef. They should use ArrayRef eventually, but not yet.\r\n* There are new utility functions for resizing sizes/strides in one go (THTensor_resizeDim), or replacing sizes and strides with completely new values (THTensor_setSizesAndStrides)\r\n* Anywhere you said `t->size[n] = 0`, we now say `THTensor_setSizeAt(t, n, 0)`, ditto for strides\r\n* Anywhere you said `t->size[n]`, we now say `t->size(n)` (coming soon: ditto for strides)\r\n\r\nPrevious review of just the `std::vector` change in #9518, but I'm planning to merge this all in one go.\r\n\r\nNote for @gchanan: review from commit \"ci\" and after"}