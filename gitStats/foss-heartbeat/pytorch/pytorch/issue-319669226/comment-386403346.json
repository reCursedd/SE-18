{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/386403346", "html_url": "https://github.com/pytorch/pytorch/pull/7190#issuecomment-386403346", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/7190", "id": 386403346, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjQwMzM0Ng==", "user": {"login": "cpuhrsch", "id": 1716488, "node_id": "MDQ6VXNlcjE3MTY0ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1716488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cpuhrsch", "html_url": "https://github.com/cpuhrsch", "followers_url": "https://api.github.com/users/cpuhrsch/followers", "following_url": "https://api.github.com/users/cpuhrsch/following{/other_user}", "gists_url": "https://api.github.com/users/cpuhrsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/cpuhrsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cpuhrsch/subscriptions", "organizations_url": "https://api.github.com/users/cpuhrsch/orgs", "repos_url": "https://api.github.com/users/cpuhrsch/repos", "events_url": "https://api.github.com/users/cpuhrsch/events{/privacy}", "received_events_url": "https://api.github.com/users/cpuhrsch/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-03T19:04:54Z", "updated_at": "2018-05-03T23:35:44Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15994775\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/shibatch\">@shibatch</a></p>\n<p>Here's another error I encountered when rewriting the project to use our \"custom\" CMakeLists</p>\n<pre><code>18:56:32 In file included from /usr/lib/gcc/x86_64-linux-gnu/7/include/immintrin.h:45:0,\n18:56:32                  from /usr/lib/gcc/x86_64-linux-gnu/7/include/x86intrin.h:48,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:33,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/libm/sleefsimdsp.c:87:\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_tanf16_u35avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_logf16_u35avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_logf16_u10avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_log10f16_u10avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_log2f16_u10avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 make[2]: *** [sleef/src/libm/CMakeFiles/sleefavx512f.dir/sleefsimdsp.c.o] Error 1\n18:56:32 make[2]: Leaving directory `/var/lib/jenkins/cpp-build/aten'\n18:56:32 make[1]: *** [sleef/src/libm/CMakeFiles/sleefavx512f.dir/all] Error 2\n18:56:32 make[1]: *** Waiting for unfinished jobs....\n18:56:32 In file included from /usr/lib/gcc/x86_64-linux-gnu/7/include/immintrin.h:45:0,\n18:56:32                  from /usr/lib/gcc/x86_64-linux-gnu/7/include/x86intrin.h:48,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:33,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/libm/sleefsimdsp.c:87:\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_tanf_u35':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_logf_u35':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_logf':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_log10f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_log2f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n</code></pre>\n<p>You can see that <a href=\"https://ci.pytorch.org/jenkins/job/pytorch-builds/job/pytorch-linux-trusty-py3.6-gcc7.2-build/6391/console\" rel=\"nofollow\">here</a> and <a href=\"https://ci.pytorch.org/jenkins/job/pytorch-builds/job/pytorch-linux-xenial-cuda9-cudnn7-py3-build/8121/console\" rel=\"nofollow\">here</a>. For some reason some platforms have problems with avx512. I ended up resolving this by removing all references to avx512 from our copy of the Configure file and CMakeLists. I could send a PR that makes avx512 entirely optional, if that's ok?</p>\n<p>A second problem was with Windows</p>\n<pre><code>19:00:06 FAILED: src/ATen/ATen.dll src/ATen/ATen.lib \n19:00:06 cmd.exe /C \"cd . &amp;&amp; \"C:\\Program Files\\CMake\\bin\\cmake.exe\" -E vs_link_dll --intdir=src\\ATen\\CMakeFiles\\ATen.dir --manifests  -- C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo @CMakeFiles/ATen.rsp  /out:src\\ATen\\ATen.dll /implib:src\\ATen\\ATen.lib /pdb:src\\ATen\\ATen.pdb /dll /version:0.0 /machine:x64 /LIBPATH:C:/Jenkins/workspace/pytorch-builds/pytorch-win-ws2016-cuda9-cudnn7-py3-build/torch/lib/tmp_install/lib /INCREMENTAL:NO /NODEFAULTLIB:vcomp   &amp;&amp; cd .\"\n19:00:06 LINK: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo @CMakeFiles/ATen.rsp /out:src\\ATen\\ATen.dll /implib:src\\ATen\\ATen.lib /pdb:src\\ATen\\ATen.pdb /dll /version:0.0 /machine:x64 /LIBPATH:C:/Jenkins/workspace/pytorch-builds/pytorch-win-ws2016-cuda9-cudnn7-py3-build/torch/lib/tmp_install/lib /INCREMENTAL:NO /NODEFAULTLIB:vcomp /MANIFEST /MANIFESTFILE:src\\ATen\\ATen.dll.manifest\" failed (exit code 1120) with the following output:\n19:00:06    Creating library src\\ATen\\ATen.lib and object src\\ATen\\ATen.exp\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_asind4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_49ec3e4c529a342fb4ce0da0765471ab&gt; &gt;(double *,double const *,__int64,class &lt;lambda_49ec3e4c529a342fb4ce0da0765471ab&gt;)\" (??$unary_kernel@NV&lt;lambda_49ec3e4c529a342fb4ce0da0765471ab&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_49ec3e4c529a342fb4ce0da0765471ab&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_asind4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_acosd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_eb09788f20f24c9678332629f1ed4edd&gt; &gt;(double *,double const *,__int64,class &lt;lambda_eb09788f20f24c9678332629f1ed4edd&gt;)\" (??$unary_kernel@NV&lt;lambda_eb09788f20f24c9678332629f1ed4edd&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_eb09788f20f24c9678332629f1ed4edd&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_acosd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_atand4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_cf2f78fc2963a707f6c6031dcbbd5720&gt; &gt;(double *,double const *,__int64,class &lt;lambda_cf2f78fc2963a707f6c6031dcbbd5720&gt;)\" (??$unary_kernel@NV&lt;lambda_cf2f78fc2963a707f6c6031dcbbd5720&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_cf2f78fc2963a707f6c6031dcbbd5720&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_atand4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_logd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_5d1763c218b5d668ead00e13924446d0&gt; &gt;(double *,double const *,__int64,class &lt;lambda_5d1763c218b5d668ead00e13924446d0&gt;)\" (??$unary_kernel@NV&lt;lambda_5d1763c218b5d668ead00e13924446d0&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_5d1763c218b5d668ead00e13924446d0&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_logd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_0996d033fa046024693a2024480aa3b0&gt; &gt;(double *,double const *,__int64,class &lt;lambda_0996d033fa046024693a2024480aa3b0&gt;)\" (??$unary_kernel@NV&lt;lambda_0996d033fa046024693a2024480aa3b0&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_0996d033fa046024693a2024480aa3b0&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expm1d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_f7af78b47d356413bab5234e83c055dd&gt; &gt;(double *,double const *,__int64,class &lt;lambda_f7af78b47d356413bab5234e83c055dd&gt;)\" (??$unary_kernel@NV&lt;lambda_f7af78b47d356413bab5234e83c055dd&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_f7af78b47d356413bab5234e83c055dd&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expm1d4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log10d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_39bb7718e48fd20ab3afc735131aaf4b&gt; &gt;(double *,double const *,__int64,class &lt;lambda_39bb7718e48fd20ab3afc735131aaf4b&gt;)\" (??$unary_kernel@NV&lt;lambda_39bb7718e48fd20ab3afc735131aaf4b&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_39bb7718e48fd20ab3afc735131aaf4b&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log10d4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log2d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_5261ba857b5de1b2f8c3006bbc372638&gt; &gt;(double *,double const *,__int64,class &lt;lambda_5261ba857b5de1b2f8c3006bbc372638&gt;)\" (??$unary_kernel@NV&lt;lambda_5261ba857b5de1b2f8c3006bbc372638&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_5261ba857b5de1b2f8c3006bbc372638&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log2d4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log1pd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_6b4ac17de425ff64db5852886d11be4b&gt; &gt;(double *,double const *,__int64,class &lt;lambda_6b4ac17de425ff64db5852886d11be4b&gt;)\" (??$unary_kernel@NV&lt;lambda_6b4ac17de425ff64db5852886d11be4b&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_6b4ac17de425ff64db5852886d11be4b&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log1pd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_erfd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;double,class &lt;lambda_2881fad789195ab02830362915cc6620&gt; &gt;(double *,double const *,__int64,class &lt;lambda_2881fad789195ab02830362915cc6620&gt;)\" (??$unary_kernel@NV&lt;lambda_2881fad789195ab02830362915cc6620&gt;@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV&lt;lambda_2881fad789195ab02830362915cc6620&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_erfd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_asinf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_e45bf61f754f1c603b4a75998456e926&gt; &gt;(float *,float const *,__int64,class &lt;lambda_e45bf61f754f1c603b4a75998456e926&gt;)\" (??$unary_kernel@MV&lt;lambda_e45bf61f754f1c603b4a75998456e926&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_e45bf61f754f1c603b4a75998456e926&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_asinf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_acosf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_478c177d128bfb9c4f6d8a3b72ad6b0e&gt; &gt;(float *,float const *,__int64,class &lt;lambda_478c177d128bfb9c4f6d8a3b72ad6b0e&gt;)\" (??$unary_kernel@MV&lt;lambda_478c177d128bfb9c4f6d8a3b72ad6b0e&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_478c177d128bfb9c4f6d8a3b72ad6b0e&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_acosf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_atanf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_e03bc096bfa76d5f0f5e7846ba298ba2&gt; &gt;(float *,float const *,__int64,class &lt;lambda_e03bc096bfa76d5f0f5e7846ba298ba2&gt;)\" (??$unary_kernel@MV&lt;lambda_e03bc096bfa76d5f0f5e7846ba298ba2&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_e03bc096bfa76d5f0f5e7846ba298ba2&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_atanf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_logf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_a9b86030cfad76cfc12632322bd24b0b&gt; &gt;(float *,float const *,__int64,class &lt;lambda_a9b86030cfad76cfc12632322bd24b0b&gt;)\" (??$unary_kernel@MV&lt;lambda_a9b86030cfad76cfc12632322bd24b0b&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_a9b86030cfad76cfc12632322bd24b0b&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_logf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_7c1103ead5ec27cd9551070536dc28c2&gt; &gt;(float *,float const *,__int64,class &lt;lambda_7c1103ead5ec27cd9551070536dc28c2&gt;)\" (??$unary_kernel@MV&lt;lambda_7c1103ead5ec27cd9551070536dc28c2&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_7c1103ead5ec27cd9551070536dc28c2&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expm1f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_e4b2f109757640bf69e96bf6954438b9&gt; &gt;(float *,float const *,__int64,class &lt;lambda_e4b2f109757640bf69e96bf6954438b9&gt;)\" (??$unary_kernel@MV&lt;lambda_e4b2f109757640bf69e96bf6954438b9&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_e4b2f109757640bf69e96bf6954438b9&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expm1f8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log10f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3&gt; &gt;(float *,float const *,__int64,class &lt;lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3&gt;)\" (??$unary_kernel@MV&lt;lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log10f8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log2f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_95a209db842bb7de23a05cbd5a28da9f&gt; &gt;(float *,float const *,__int64,class &lt;lambda_95a209db842bb7de23a05cbd5a28da9f&gt;)\" (??$unary_kernel@MV&lt;lambda_95a209db842bb7de23a05cbd5a28da9f&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_95a209db842bb7de23a05cbd5a28da9f&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log2f8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log1pf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_dc112bf10ad16937dc9e48935723719e&gt; &gt;(float *,float const *,__int64,class &lt;lambda_dc112bf10ad16937dc9e48935723719e&gt;)\" (??$unary_kernel@MV&lt;lambda_dc112bf10ad16937dc9e48935723719e&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_dc112bf10ad16937dc9e48935723719e&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log1pf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_erff8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel&lt;float,class &lt;lambda_02f49f7875e190510ffc220e6e8b628a&gt; &gt;(float *,float const *,__int64,class &lt;lambda_02f49f7875e190510ffc220e6e8b628a&gt;)\" (??$unary_kernel@MV&lt;lambda_02f49f7875e190510ffc220e6e8b628a&gt;@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV&lt;lambda_02f49f7875e190510ffc220e6e8b628a&gt;@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_erff8_u10\n19:00:06 src\\ATen\\ATen.dll : fatal error LNK1120: 20 unresolved externals\n</code></pre>\n<p>I had resolved this one by building sleef has a shared library for Windows instead of as a static library. I remember there being an <a href=\"https://github.com/shibatch/sleef/pull/173\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/shibatch/sleef/pull/173/hovercard\">issue, and fix</a>, around a similar error pattern, however this still appears to remain for us. I'd do this again by branching on MSVC within our cmake file, unless you want to investigate this further?</p>\n<p>EDIT: I'm trying a shared library build for Windows<br>\nEDIT2: This fixed the Windows build. The avx512 errors are still there.</p>", "body_text": "@shibatch\nHere's another error I encountered when rewriting the project to use our \"custom\" CMakeLists\n18:56:32 In file included from /usr/lib/gcc/x86_64-linux-gnu/7/include/immintrin.h:45:0,\n18:56:32                  from /usr/lib/gcc/x86_64-linux-gnu/7/include/x86intrin.h:48,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:33,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/libm/sleefsimdsp.c:87:\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_tanf16_u35avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_logf16_u35avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_logf16_u10avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_log10f16_u10avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_log2f16_u10avx512f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 make[2]: *** [sleef/src/libm/CMakeFiles/sleefavx512f.dir/sleefsimdsp.c.o] Error 1\n18:56:32 make[2]: Leaving directory `/var/lib/jenkins/cpp-build/aten'\n18:56:32 make[1]: *** [sleef/src/libm/CMakeFiles/sleefavx512f.dir/all] Error 2\n18:56:32 make[1]: *** Waiting for unfinished jobs....\n18:56:32 In file included from /usr/lib/gcc/x86_64-linux-gnu/7/include/immintrin.h:45:0,\n18:56:32                  from /usr/lib/gcc/x86_64-linux-gnu/7/include/x86intrin.h:48,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:33,\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/libm/sleefsimdsp.c:87:\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_tanf_u35':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_logf_u35':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_logf':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_log10f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_log2f':\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\n18:56:32                                                                                            ^\n\nYou can see that here and here. For some reason some platforms have problems with avx512. I ended up resolving this by removing all references to avx512 from our copy of the Configure file and CMakeLists. I could send a PR that makes avx512 entirely optional, if that's ok?\nA second problem was with Windows\n19:00:06 FAILED: src/ATen/ATen.dll src/ATen/ATen.lib \n19:00:06 cmd.exe /C \"cd . && \"C:\\Program Files\\CMake\\bin\\cmake.exe\" -E vs_link_dll --intdir=src\\ATen\\CMakeFiles\\ATen.dir --manifests  -- C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo @CMakeFiles/ATen.rsp  /out:src\\ATen\\ATen.dll /implib:src\\ATen\\ATen.lib /pdb:src\\ATen\\ATen.pdb /dll /version:0.0 /machine:x64 /LIBPATH:C:/Jenkins/workspace/pytorch-builds/pytorch-win-ws2016-cuda9-cudnn7-py3-build/torch/lib/tmp_install/lib /INCREMENTAL:NO /NODEFAULTLIB:vcomp   && cd .\"\n19:00:06 LINK: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo @CMakeFiles/ATen.rsp /out:src\\ATen\\ATen.dll /implib:src\\ATen\\ATen.lib /pdb:src\\ATen\\ATen.pdb /dll /version:0.0 /machine:x64 /LIBPATH:C:/Jenkins/workspace/pytorch-builds/pytorch-win-ws2016-cuda9-cudnn7-py3-build/torch/lib/tmp_install/lib /INCREMENTAL:NO /NODEFAULTLIB:vcomp /MANIFEST /MANIFESTFILE:src\\ATen\\ATen.dll.manifest\" failed (exit code 1120) with the following output:\n19:00:06    Creating library src\\ATen\\ATen.lib and object src\\ATen\\ATen.exp\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_asind4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_49ec3e4c529a342fb4ce0da0765471ab> >(double *,double const *,__int64,class <lambda_49ec3e4c529a342fb4ce0da0765471ab>)\" (??$unary_kernel@NV<lambda_49ec3e4c529a342fb4ce0da0765471ab>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_49ec3e4c529a342fb4ce0da0765471ab>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_asind4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_acosd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_eb09788f20f24c9678332629f1ed4edd> >(double *,double const *,__int64,class <lambda_eb09788f20f24c9678332629f1ed4edd>)\" (??$unary_kernel@NV<lambda_eb09788f20f24c9678332629f1ed4edd>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_eb09788f20f24c9678332629f1ed4edd>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_acosd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_atand4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_cf2f78fc2963a707f6c6031dcbbd5720> >(double *,double const *,__int64,class <lambda_cf2f78fc2963a707f6c6031dcbbd5720>)\" (??$unary_kernel@NV<lambda_cf2f78fc2963a707f6c6031dcbbd5720>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_cf2f78fc2963a707f6c6031dcbbd5720>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_atand4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_logd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_5d1763c218b5d668ead00e13924446d0> >(double *,double const *,__int64,class <lambda_5d1763c218b5d668ead00e13924446d0>)\" (??$unary_kernel@NV<lambda_5d1763c218b5d668ead00e13924446d0>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_5d1763c218b5d668ead00e13924446d0>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_logd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_0996d033fa046024693a2024480aa3b0> >(double *,double const *,__int64,class <lambda_0996d033fa046024693a2024480aa3b0>)\" (??$unary_kernel@NV<lambda_0996d033fa046024693a2024480aa3b0>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_0996d033fa046024693a2024480aa3b0>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expm1d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_f7af78b47d356413bab5234e83c055dd> >(double *,double const *,__int64,class <lambda_f7af78b47d356413bab5234e83c055dd>)\" (??$unary_kernel@NV<lambda_f7af78b47d356413bab5234e83c055dd>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_f7af78b47d356413bab5234e83c055dd>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expm1d4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log10d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_39bb7718e48fd20ab3afc735131aaf4b> >(double *,double const *,__int64,class <lambda_39bb7718e48fd20ab3afc735131aaf4b>)\" (??$unary_kernel@NV<lambda_39bb7718e48fd20ab3afc735131aaf4b>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_39bb7718e48fd20ab3afc735131aaf4b>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log10d4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log2d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_5261ba857b5de1b2f8c3006bbc372638> >(double *,double const *,__int64,class <lambda_5261ba857b5de1b2f8c3006bbc372638>)\" (??$unary_kernel@NV<lambda_5261ba857b5de1b2f8c3006bbc372638>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_5261ba857b5de1b2f8c3006bbc372638>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log2d4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log1pd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_6b4ac17de425ff64db5852886d11be4b> >(double *,double const *,__int64,class <lambda_6b4ac17de425ff64db5852886d11be4b>)\" (??$unary_kernel@NV<lambda_6b4ac17de425ff64db5852886d11be4b>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_6b4ac17de425ff64db5852886d11be4b>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log1pd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_erfd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_2881fad789195ab02830362915cc6620> >(double *,double const *,__int64,class <lambda_2881fad789195ab02830362915cc6620>)\" (??$unary_kernel@NV<lambda_2881fad789195ab02830362915cc6620>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_2881fad789195ab02830362915cc6620>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_erfd4_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_asinf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_e45bf61f754f1c603b4a75998456e926> >(float *,float const *,__int64,class <lambda_e45bf61f754f1c603b4a75998456e926>)\" (??$unary_kernel@MV<lambda_e45bf61f754f1c603b4a75998456e926>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_e45bf61f754f1c603b4a75998456e926>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_asinf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_acosf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_478c177d128bfb9c4f6d8a3b72ad6b0e> >(float *,float const *,__int64,class <lambda_478c177d128bfb9c4f6d8a3b72ad6b0e>)\" (??$unary_kernel@MV<lambda_478c177d128bfb9c4f6d8a3b72ad6b0e>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_478c177d128bfb9c4f6d8a3b72ad6b0e>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_acosf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_atanf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_e03bc096bfa76d5f0f5e7846ba298ba2> >(float *,float const *,__int64,class <lambda_e03bc096bfa76d5f0f5e7846ba298ba2>)\" (??$unary_kernel@MV<lambda_e03bc096bfa76d5f0f5e7846ba298ba2>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_e03bc096bfa76d5f0f5e7846ba298ba2>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_atanf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_logf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_a9b86030cfad76cfc12632322bd24b0b> >(float *,float const *,__int64,class <lambda_a9b86030cfad76cfc12632322bd24b0b>)\" (??$unary_kernel@MV<lambda_a9b86030cfad76cfc12632322bd24b0b>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_a9b86030cfad76cfc12632322bd24b0b>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_logf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_7c1103ead5ec27cd9551070536dc28c2> >(float *,float const *,__int64,class <lambda_7c1103ead5ec27cd9551070536dc28c2>)\" (??$unary_kernel@MV<lambda_7c1103ead5ec27cd9551070536dc28c2>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_7c1103ead5ec27cd9551070536dc28c2>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expm1f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_e4b2f109757640bf69e96bf6954438b9> >(float *,float const *,__int64,class <lambda_e4b2f109757640bf69e96bf6954438b9>)\" (??$unary_kernel@MV<lambda_e4b2f109757640bf69e96bf6954438b9>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_e4b2f109757640bf69e96bf6954438b9>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expm1f8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log10f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3> >(float *,float const *,__int64,class <lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3>)\" (??$unary_kernel@MV<lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log10f8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log2f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_95a209db842bb7de23a05cbd5a28da9f> >(float *,float const *,__int64,class <lambda_95a209db842bb7de23a05cbd5a28da9f>)\" (??$unary_kernel@MV<lambda_95a209db842bb7de23a05cbd5a28da9f>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_95a209db842bb7de23a05cbd5a28da9f>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log2f8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log1pf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_dc112bf10ad16937dc9e48935723719e> >(float *,float const *,__int64,class <lambda_dc112bf10ad16937dc9e48935723719e>)\" (??$unary_kernel@MV<lambda_dc112bf10ad16937dc9e48935723719e>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_dc112bf10ad16937dc9e48935723719e>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log1pf8_u10\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_erff8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_02f49f7875e190510ffc220e6e8b628a> >(float *,float const *,__int64,class <lambda_02f49f7875e190510ffc220e6e8b628a>)\" (??$unary_kernel@MV<lambda_02f49f7875e190510ffc220e6e8b628a>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_02f49f7875e190510ffc220e6e8b628a>@@@Z)\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_erff8_u10\n19:00:06 src\\ATen\\ATen.dll : fatal error LNK1120: 20 unresolved externals\n\nI had resolved this one by building sleef has a shared library for Windows instead of as a static library. I remember there being an issue, and fix, around a similar error pattern, however this still appears to remain for us. I'd do this again by branching on MSVC within our cmake file, unless you want to investigate this further?\nEDIT: I'm trying a shared library build for Windows\nEDIT2: This fixed the Windows build. The avx512 errors are still there.", "body": "@shibatch \r\n\r\nHere's another error I encountered when rewriting the project to use our \"custom\" CMakeLists\r\n\r\n```\r\n18:56:32 In file included from /usr/lib/gcc/x86_64-linux-gnu/7/include/immintrin.h:45:0,\r\n18:56:32                  from /usr/lib/gcc/x86_64-linux-gnu/7/include/x86intrin.h:48,\r\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:33,\r\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/libm/sleefsimdsp.c:87:\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_tanf16_u35avx512f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_logf16_u35avx512f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_logf16_u10avx512f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_log10f16_u10avx512f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function 'Sleef_log2f16_u10avx512f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 make[2]: *** [sleef/src/libm/CMakeFiles/sleefavx512f.dir/sleefsimdsp.c.o] Error 1\r\n18:56:32 make[2]: Leaving directory `/var/lib/jenkins/cpp-build/aten'\r\n18:56:32 make[1]: *** [sleef/src/libm/CMakeFiles/sleefavx512f.dir/all] Error 2\r\n18:56:32 make[1]: *** Waiting for unfinished jobs....\r\n18:56:32 In file included from /usr/lib/gcc/x86_64-linux-gnu/7/include/immintrin.h:45:0,\r\n18:56:32                  from /usr/lib/gcc/x86_64-linux-gnu/7/include/x86intrin.h:48,\r\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:33,\r\n18:56:32                  from /var/lib/jenkins/workspace/third_party/sleef/src/libm/sleefsimdsp.c:87:\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_tanf_u35':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_logf_u35':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_logf':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_log10f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h: In function '_ZGVeN16v_log2f':\r\n18:56:32 /var/lib/jenkins/workspace/third_party/sleef/src/arch/helperavx512f.h:281:91: error: the immediate argument must be an 8-bit immediate\r\n18:56:32  static INLINE vfloat vfixup_vf_vf_vf_vi2_i(vfloat a, vfloat b, vint2 c, int imm) { return _mm512_fixupimm_ps(a, b, c, imm); }\r\n18:56:32                                                                                            ^\r\n```\r\n\r\nYou can see that [here](https://ci.pytorch.org/jenkins/job/pytorch-builds/job/pytorch-linux-trusty-py3.6-gcc7.2-build/6391/console) and [here](https://ci.pytorch.org/jenkins/job/pytorch-builds/job/pytorch-linux-xenial-cuda9-cudnn7-py3-build/8121/console). For some reason some platforms have problems with avx512. I ended up resolving this by removing all references to avx512 from our copy of the Configure file and CMakeLists. I could send a PR that makes avx512 entirely optional, if that's ok?\r\n\r\nA second problem was with Windows\r\n\r\n```\r\n19:00:06 FAILED: src/ATen/ATen.dll src/ATen/ATen.lib \r\n19:00:06 cmd.exe /C \"cd . && \"C:\\Program Files\\CMake\\bin\\cmake.exe\" -E vs_link_dll --intdir=src\\ATen\\CMakeFiles\\ATen.dir --manifests  -- C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo @CMakeFiles/ATen.rsp  /out:src\\ATen\\ATen.dll /implib:src\\ATen\\ATen.lib /pdb:src\\ATen\\ATen.pdb /dll /version:0.0 /machine:x64 /LIBPATH:C:/Jenkins/workspace/pytorch-builds/pytorch-win-ws2016-cuda9-cudnn7-py3-build/torch/lib/tmp_install/lib /INCREMENTAL:NO /NODEFAULTLIB:vcomp   && cd .\"\r\n19:00:06 LINK: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo @CMakeFiles/ATen.rsp /out:src\\ATen\\ATen.dll /implib:src\\ATen\\ATen.lib /pdb:src\\ATen\\ATen.pdb /dll /version:0.0 /machine:x64 /LIBPATH:C:/Jenkins/workspace/pytorch-builds/pytorch-win-ws2016-cuda9-cudnn7-py3-build/torch/lib/tmp_install/lib /INCREMENTAL:NO /NODEFAULTLIB:vcomp /MANIFEST /MANIFESTFILE:src\\ATen\\ATen.dll.manifest\" failed (exit code 1120) with the following output:\r\n19:00:06    Creating library src\\ATen\\ATen.lib and object src\\ATen\\ATen.exp\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_asind4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_49ec3e4c529a342fb4ce0da0765471ab> >(double *,double const *,__int64,class <lambda_49ec3e4c529a342fb4ce0da0765471ab>)\" (??$unary_kernel@NV<lambda_49ec3e4c529a342fb4ce0da0765471ab>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_49ec3e4c529a342fb4ce0da0765471ab>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_asind4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_acosd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_eb09788f20f24c9678332629f1ed4edd> >(double *,double const *,__int64,class <lambda_eb09788f20f24c9678332629f1ed4edd>)\" (??$unary_kernel@NV<lambda_eb09788f20f24c9678332629f1ed4edd>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_eb09788f20f24c9678332629f1ed4edd>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_acosd4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_atand4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_cf2f78fc2963a707f6c6031dcbbd5720> >(double *,double const *,__int64,class <lambda_cf2f78fc2963a707f6c6031dcbbd5720>)\" (??$unary_kernel@NV<lambda_cf2f78fc2963a707f6c6031dcbbd5720>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_cf2f78fc2963a707f6c6031dcbbd5720>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_atand4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_logd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_5d1763c218b5d668ead00e13924446d0> >(double *,double const *,__int64,class <lambda_5d1763c218b5d668ead00e13924446d0>)\" (??$unary_kernel@NV<lambda_5d1763c218b5d668ead00e13924446d0>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_5d1763c218b5d668ead00e13924446d0>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_logd4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_0996d033fa046024693a2024480aa3b0> >(double *,double const *,__int64,class <lambda_0996d033fa046024693a2024480aa3b0>)\" (??$unary_kernel@NV<lambda_0996d033fa046024693a2024480aa3b0>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_0996d033fa046024693a2024480aa3b0>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expd4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expm1d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_f7af78b47d356413bab5234e83c055dd> >(double *,double const *,__int64,class <lambda_f7af78b47d356413bab5234e83c055dd>)\" (??$unary_kernel@NV<lambda_f7af78b47d356413bab5234e83c055dd>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_f7af78b47d356413bab5234e83c055dd>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expm1d4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log10d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_39bb7718e48fd20ab3afc735131aaf4b> >(double *,double const *,__int64,class <lambda_39bb7718e48fd20ab3afc735131aaf4b>)\" (??$unary_kernel@NV<lambda_39bb7718e48fd20ab3afc735131aaf4b>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_39bb7718e48fd20ab3afc735131aaf4b>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log10d4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log2d4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_5261ba857b5de1b2f8c3006bbc372638> >(double *,double const *,__int64,class <lambda_5261ba857b5de1b2f8c3006bbc372638>)\" (??$unary_kernel@NV<lambda_5261ba857b5de1b2f8c3006bbc372638>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_5261ba857b5de1b2f8c3006bbc372638>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log2d4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log1pd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_6b4ac17de425ff64db5852886d11be4b> >(double *,double const *,__int64,class <lambda_6b4ac17de425ff64db5852886d11be4b>)\" (??$unary_kernel@NV<lambda_6b4ac17de425ff64db5852886d11be4b>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_6b4ac17de425ff64db5852886d11be4b>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log1pd4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_erfd4_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<double,class <lambda_2881fad789195ab02830362915cc6620> >(double *,double const *,__int64,class <lambda_2881fad789195ab02830362915cc6620>)\" (??$unary_kernel@NV<lambda_2881fad789195ab02830362915cc6620>@@@?A0x8b28b232@native@at@@YAXPEANPEBN_JV<lambda_2881fad789195ab02830362915cc6620>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_erfd4_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_asinf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_e45bf61f754f1c603b4a75998456e926> >(float *,float const *,__int64,class <lambda_e45bf61f754f1c603b4a75998456e926>)\" (??$unary_kernel@MV<lambda_e45bf61f754f1c603b4a75998456e926>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_e45bf61f754f1c603b4a75998456e926>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_asinf8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_acosf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_478c177d128bfb9c4f6d8a3b72ad6b0e> >(float *,float const *,__int64,class <lambda_478c177d128bfb9c4f6d8a3b72ad6b0e>)\" (??$unary_kernel@MV<lambda_478c177d128bfb9c4f6d8a3b72ad6b0e>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_478c177d128bfb9c4f6d8a3b72ad6b0e>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_acosf8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_atanf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_e03bc096bfa76d5f0f5e7846ba298ba2> >(float *,float const *,__int64,class <lambda_e03bc096bfa76d5f0f5e7846ba298ba2>)\" (??$unary_kernel@MV<lambda_e03bc096bfa76d5f0f5e7846ba298ba2>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_e03bc096bfa76d5f0f5e7846ba298ba2>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_atanf8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_logf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_a9b86030cfad76cfc12632322bd24b0b> >(float *,float const *,__int64,class <lambda_a9b86030cfad76cfc12632322bd24b0b>)\" (??$unary_kernel@MV<lambda_a9b86030cfad76cfc12632322bd24b0b>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_a9b86030cfad76cfc12632322bd24b0b>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_logf8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_7c1103ead5ec27cd9551070536dc28c2> >(float *,float const *,__int64,class <lambda_7c1103ead5ec27cd9551070536dc28c2>)\" (??$unary_kernel@MV<lambda_7c1103ead5ec27cd9551070536dc28c2>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_7c1103ead5ec27cd9551070536dc28c2>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expf8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_expm1f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_e4b2f109757640bf69e96bf6954438b9> >(float *,float const *,__int64,class <lambda_e4b2f109757640bf69e96bf6954438b9>)\" (??$unary_kernel@MV<lambda_e4b2f109757640bf69e96bf6954438b9>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_e4b2f109757640bf69e96bf6954438b9>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_expm1f8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log10f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3> >(float *,float const *,__int64,class <lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3>)\" (??$unary_kernel@MV<lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_7c5ef2f309ea43fbecb40e5cb92a4ee3>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log10f8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log2f8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_95a209db842bb7de23a05cbd5a28da9f> >(float *,float const *,__int64,class <lambda_95a209db842bb7de23a05cbd5a28da9f>)\" (??$unary_kernel@MV<lambda_95a209db842bb7de23a05cbd5a28da9f>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_95a209db842bb7de23a05cbd5a28da9f>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log2f8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_log1pf8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_dc112bf10ad16937dc9e48935723719e> >(float *,float const *,__int64,class <lambda_dc112bf10ad16937dc9e48935723719e>)\" (??$unary_kernel@MV<lambda_dc112bf10ad16937dc9e48935723719e>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_dc112bf10ad16937dc9e48935723719e>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_log1pf8_u10\r\n19:00:06 UnaryOpsKernel.cpp.AVX2.cpp.obj : error LNK2019: unresolved external symbol __imp_Sleef_erff8_u10 referenced in function \"void __cdecl at::native::`anonymous namespace'::unary_kernel<float,class <lambda_02f49f7875e190510ffc220e6e8b628a> >(float *,float const *,__int64,class <lambda_02f49f7875e190510ffc220e6e8b628a>)\" (??$unary_kernel@MV<lambda_02f49f7875e190510ffc220e6e8b628a>@@@?A0x8b28b232@native@at@@YAXPEAMPEBM_JV<lambda_02f49f7875e190510ffc220e6e8b628a>@@@Z)\r\n19:00:06 UnaryOpsKernel.cpp.AVX.cpp.obj : error LNK2001: unresolved external symbol __imp_Sleef_erff8_u10\r\n19:00:06 src\\ATen\\ATen.dll : fatal error LNK1120: 20 unresolved externals\r\n```\r\n\r\nI had resolved this one by building sleef has a shared library for Windows instead of as a static library. I remember there being an [issue, and fix](https://github.com/shibatch/sleef/pull/173), around a similar error pattern, however this still appears to remain for us. I'd do this again by branching on MSVC within our cmake file, unless you want to investigate this further?\r\n\r\n EDIT: I'm trying a shared library build for Windows\r\n EDIT2: This fixed the Windows build. The avx512 errors are still there."}