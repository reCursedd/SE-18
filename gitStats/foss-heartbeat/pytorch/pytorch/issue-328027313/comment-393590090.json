{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/393590090", "html_url": "https://github.com/pytorch/pytorch/pull/7984#issuecomment-393590090", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/7984", "id": 393590090, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzU5MDA5MA==", "user": {"login": "dzhulgakov", "id": 17890620, "node_id": "MDQ6VXNlcjE3ODkwNjIw", "avatar_url": "https://avatars2.githubusercontent.com/u/17890620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dzhulgakov", "html_url": "https://github.com/dzhulgakov", "followers_url": "https://api.github.com/users/dzhulgakov/followers", "following_url": "https://api.github.com/users/dzhulgakov/following{/other_user}", "gists_url": "https://api.github.com/users/dzhulgakov/gists{/gist_id}", "starred_url": "https://api.github.com/users/dzhulgakov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dzhulgakov/subscriptions", "organizations_url": "https://api.github.com/users/dzhulgakov/orgs", "repos_url": "https://api.github.com/users/dzhulgakov/repos", "events_url": "https://api.github.com/users/dzhulgakov/events{/privacy}", "received_events_url": "https://api.github.com/users/dzhulgakov/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-31T16:23:35Z", "updated_at": "2018-05-31T16:23:35Z", "author_association": "MEMBER", "body_html": "<p>Thanks for the pointers to benchmarks.</p>\n<p>From run on my devgpu:</p>\n<p>before:<br>\nget 1.02us<br>\nset 4.17us<br>\ndynet 4.131s (not stat-sig)</p>\n<p>after:<br>\nget 1.13us<br>\nset 4.3us<br>\ndynet 4.132s (not stat-sig)</p>\n<p>dynet benchmark: <a href=\"https://gist.github.com/dzhulgakov/bd53c5b1cbac795321c30a51f92b2d72\">https://gist.github.com/dzhulgakov/bd53c5b1cbac795321c30a51f92b2d72</a> (tweaked a bit)<br>\nran with <code>time OMP_NUM_THREADS=1 MKL_NUM_THREADS=1 python mini_sequence_labeler.py</code> (with mkl time is higher and variability is huge)<br>\ngovernor is on performance<br>\nvariability is still quite high for dynet one</p>\n<p>So I'd take the microbench with a grain of salt on how much it impacts actual perf</p>", "body_text": "Thanks for the pointers to benchmarks.\nFrom run on my devgpu:\nbefore:\nget 1.02us\nset 4.17us\ndynet 4.131s (not stat-sig)\nafter:\nget 1.13us\nset 4.3us\ndynet 4.132s (not stat-sig)\ndynet benchmark: https://gist.github.com/dzhulgakov/bd53c5b1cbac795321c30a51f92b2d72 (tweaked a bit)\nran with time OMP_NUM_THREADS=1 MKL_NUM_THREADS=1 python mini_sequence_labeler.py (with mkl time is higher and variability is huge)\ngovernor is on performance\nvariability is still quite high for dynet one\nSo I'd take the microbench with a grain of salt on how much it impacts actual perf", "body": "Thanks for the pointers to benchmarks.\r\n\r\nFrom run on my devgpu:\r\n\r\nbefore:\r\nget 1.02us\r\nset 4.17us\r\ndynet 4.131s (not stat-sig)\r\n\r\nafter:\r\nget 1.13us\r\nset 4.3us\r\ndynet 4.132s (not stat-sig)\r\n\r\ndynet benchmark: https://gist.github.com/dzhulgakov/bd53c5b1cbac795321c30a51f92b2d72 (tweaked a bit)\r\nran with `time OMP_NUM_THREADS=1 MKL_NUM_THREADS=1 python mini_sequence_labeler.py` (with mkl time is higher and variability is huge)\r\ngovernor is on performance\r\nvariability is still quite high for dynet one\r\n\r\nSo I'd take the microbench with a grain of salt on how much it impacts actual perf"}