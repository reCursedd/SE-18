{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/378629202", "html_url": "https://github.com/pytorch/pytorch/issues/6183#issuecomment-378629202", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/6183", "id": 378629202, "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODYyOTIwMg==", "user": {"login": "kpoman", "id": 9864839, "node_id": "MDQ6VXNlcjk4NjQ4Mzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/9864839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kpoman", "html_url": "https://github.com/kpoman", "followers_url": "https://api.github.com/users/kpoman/followers", "following_url": "https://api.github.com/users/kpoman/following{/other_user}", "gists_url": "https://api.github.com/users/kpoman/gists{/gist_id}", "starred_url": "https://api.github.com/users/kpoman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kpoman/subscriptions", "organizations_url": "https://api.github.com/users/kpoman/orgs", "repos_url": "https://api.github.com/users/kpoman/repos", "events_url": "https://api.github.com/users/kpoman/events{/privacy}", "received_events_url": "https://api.github.com/users/kpoman/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-04T14:53:53Z", "updated_at": "2018-04-04T14:56:28Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9998726\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/peterjc123\">@peterjc123</a> sorry, my post was not very specific. See here:</p>\n<pre><code># this code is executed\nimport torch\nfrom torchvision import datasets, transforms\n\nuse_cuda = True\nbatch_size = 64\n\nkwargs = {'num_workers': 1, 'pin_memory': True} if use_cuda else {}\ntrain_loader = torch.utils.data.DataLoader(\n    datasets.MNIST('../data', train=True, download=True,\n                   transform=transforms.Compose([\n                       transforms.ToTensor(),\n                       transforms.Normalize((0.1307,), (0.3081,))\n                   ])),\n    batch_size=batch_size, shuffle=True, **kwargs)\n\nfor batch_idx, (data, target) in enumerate(train_loader):\n    print(batch_idx)\n</code></pre>\n<p>and this is the result on the console (it even hangs the python process that I need to kill with task manager)</p>\n<blockquote>\n<p>(base) C:\\Users\\kpoman\\conda_mnist&gt;python test.py<br>\nC:\\Anaconda3\\lib\\site-packages\\torch\\cuda_<em>init</em>_.py:116: UserWarning:<br>\nFound GPU0 Quadro M1000M which is of cuda capability 5.0.<br>\nPyTorch no longer supports this GPU because it is too old.</p>\n<p>warnings.warn(old_gpu_warn % (d, name, major, capability[1]))<br>\nC:\\Anaconda3\\lib\\site-packages\\torch\\cuda_<em>init</em>_.py:116: UserWarning:<br>\nFound GPU0 Quadro M1000M which is of cuda capability 5.0.<br>\nPyTorch no longer supports this GPU because it is too old.</p>\n<p>warnings.warn(old_gpu_warn % (d, name, major, capability[1]))<br>\nTraceback (most recent call last):<br>\nFile \"\", line 1, in <br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 105, in spawn_main<br>\nexitcode = _main(fd)<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 114, in _main<br>\nprepare(preparation_data)<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 225, in prepare<br>\n_fixup_main_from_path(data['init_main_from_path'])<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 277, in _fixup_main_from_path<br>\nrun_name=\"<strong>mp_main</strong>\")<br>\nFile \"C:\\Anaconda3\\lib\\runpy.py\", line 263, in run_path<br>\npkg_name=pkg_name, script_name=fname)<br>\nFile \"C:\\Anaconda3\\lib\\runpy.py\", line 96, in _run_module_code<br>\nmod_name, mod_spec, pkg_name, script_name)<br>\nFile \"C:\\Anaconda3\\lib\\runpy.py\", line 85, in _run_code<br>\nexec(code, run_globals)<br>\nFile \"C:\\Users\\kpoman\\conda_mnist\\test.py\", line 16, in <br>\nfor batch_idx, (data, target) in enumerate(train_loader):<br>\nFile \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 417, in <strong>iter</strong><br>\nreturn DataLoaderIter(self)<br>\nFile \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 234, in <strong>init</strong><br>\nw.start()<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\process.py\", line 105, in start<br>\nself._popen = self._Popen(self)<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 223, in _Popen<br>\nreturn _default_context.get_context().Process._Popen(process_obj)<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 322, in _Popen<br>\nreturn Popen(process_obj)<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\popen_spawn_win32.py\", line 33, in <strong>init</strong><br>\nprep_data = spawn.get_preparation_data(process_obj._name)<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 143, in get_preparation_data<br>\n_check_not_importing_main()<br>\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 136, in _check_not_importing_main<br>\nis not going to be frozen to produce an executable.''')<br>\nRuntimeError:<br>\nAn attempt has been made to start a new process before the<br>\ncurrent process has finished its bootstrapping phase.</p>\n<p>This probably means that you are not using fork to start your<br>\nchild processes and you have forgotten to use the proper idiom<br>\nin the main module:</p>\n<p>if <strong>name</strong> == '<strong>main</strong>':<br>\nfreeze_support()<br>\n...</p>\n<p>The \"freeze_support()\" line can be omitted if the program<br>\nis not going to be frozen to produce an executable.</p>\n<p>(base) C:\\Users\\kpoman\\conda_mnist&gt;</p>\n</blockquote>", "body_text": "@peterjc123 sorry, my post was not very specific. See here:\n# this code is executed\nimport torch\nfrom torchvision import datasets, transforms\n\nuse_cuda = True\nbatch_size = 64\n\nkwargs = {'num_workers': 1, 'pin_memory': True} if use_cuda else {}\ntrain_loader = torch.utils.data.DataLoader(\n    datasets.MNIST('../data', train=True, download=True,\n                   transform=transforms.Compose([\n                       transforms.ToTensor(),\n                       transforms.Normalize((0.1307,), (0.3081,))\n                   ])),\n    batch_size=batch_size, shuffle=True, **kwargs)\n\nfor batch_idx, (data, target) in enumerate(train_loader):\n    print(batch_idx)\n\nand this is the result on the console (it even hangs the python process that I need to kill with task manager)\n\n(base) C:\\Users\\kpoman\\conda_mnist>python test.py\nC:\\Anaconda3\\lib\\site-packages\\torch\\cuda_init_.py:116: UserWarning:\nFound GPU0 Quadro M1000M which is of cuda capability 5.0.\nPyTorch no longer supports this GPU because it is too old.\nwarnings.warn(old_gpu_warn % (d, name, major, capability[1]))\nC:\\Anaconda3\\lib\\site-packages\\torch\\cuda_init_.py:116: UserWarning:\nFound GPU0 Quadro M1000M which is of cuda capability 5.0.\nPyTorch no longer supports this GPU because it is too old.\nwarnings.warn(old_gpu_warn % (d, name, major, capability[1]))\nTraceback (most recent call last):\nFile \"\", line 1, in \nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 105, in spawn_main\nexitcode = _main(fd)\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 114, in _main\nprepare(preparation_data)\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 225, in prepare\n_fixup_main_from_path(data['init_main_from_path'])\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 277, in _fixup_main_from_path\nrun_name=\"mp_main\")\nFile \"C:\\Anaconda3\\lib\\runpy.py\", line 263, in run_path\npkg_name=pkg_name, script_name=fname)\nFile \"C:\\Anaconda3\\lib\\runpy.py\", line 96, in _run_module_code\nmod_name, mod_spec, pkg_name, script_name)\nFile \"C:\\Anaconda3\\lib\\runpy.py\", line 85, in _run_code\nexec(code, run_globals)\nFile \"C:\\Users\\kpoman\\conda_mnist\\test.py\", line 16, in \nfor batch_idx, (data, target) in enumerate(train_loader):\nFile \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 417, in iter\nreturn DataLoaderIter(self)\nFile \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 234, in init\nw.start()\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\process.py\", line 105, in start\nself._popen = self._Popen(self)\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 223, in _Popen\nreturn _default_context.get_context().Process._Popen(process_obj)\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 322, in _Popen\nreturn Popen(process_obj)\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\popen_spawn_win32.py\", line 33, in init\nprep_data = spawn.get_preparation_data(process_obj._name)\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 143, in get_preparation_data\n_check_not_importing_main()\nFile \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 136, in _check_not_importing_main\nis not going to be frozen to produce an executable.''')\nRuntimeError:\nAn attempt has been made to start a new process before the\ncurrent process has finished its bootstrapping phase.\nThis probably means that you are not using fork to start your\nchild processes and you have forgotten to use the proper idiom\nin the main module:\nif name == 'main':\nfreeze_support()\n...\nThe \"freeze_support()\" line can be omitted if the program\nis not going to be frozen to produce an executable.\n(base) C:\\Users\\kpoman\\conda_mnist>", "body": "@peterjc123 sorry, my post was not very specific. See here:\r\n\r\n\r\n```\r\n# this code is executed\r\nimport torch\r\nfrom torchvision import datasets, transforms\r\n\r\nuse_cuda = True\r\nbatch_size = 64\r\n\r\nkwargs = {'num_workers': 1, 'pin_memory': True} if use_cuda else {}\r\ntrain_loader = torch.utils.data.DataLoader(\r\n    datasets.MNIST('../data', train=True, download=True,\r\n                   transform=transforms.Compose([\r\n                       transforms.ToTensor(),\r\n                       transforms.Normalize((0.1307,), (0.3081,))\r\n                   ])),\r\n    batch_size=batch_size, shuffle=True, **kwargs)\r\n\r\nfor batch_idx, (data, target) in enumerate(train_loader):\r\n    print(batch_idx)\r\n```\r\n\r\nand this is the result on the console (it even hangs the python process that I need to kill with task manager)\r\n\r\n> (base) C:\\Users\\kpoman\\conda_mnist>python test.py\r\n> C:\\Anaconda3\\lib\\site-packages\\torch\\cuda\\__init__.py:116: UserWarning:\r\n>     Found GPU0 Quadro M1000M which is of cuda capability 5.0.\r\n>     PyTorch no longer supports this GPU because it is too old.\r\n> \r\n>   warnings.warn(old_gpu_warn % (d, name, major, capability[1]))\r\n> C:\\Anaconda3\\lib\\site-packages\\torch\\cuda\\__init__.py:116: UserWarning:\r\n>     Found GPU0 Quadro M1000M which is of cuda capability 5.0.\r\n>     PyTorch no longer supports this GPU because it is too old.\r\n> \r\n>   warnings.warn(old_gpu_warn % (d, name, major, capability[1]))\r\n> Traceback (most recent call last):\r\n>   File \"<string>\", line 1, in <module>\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 105, in spawn_main\r\n>     exitcode = _main(fd)\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 114, in _main\r\n>     prepare(preparation_data)\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 225, in prepare\r\n>     _fixup_main_from_path(data['init_main_from_path'])\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 277, in _fixup_main_from_path\r\n>     run_name=\"__mp_main__\")\r\n>   File \"C:\\Anaconda3\\lib\\runpy.py\", line 263, in run_path\r\n>     pkg_name=pkg_name, script_name=fname)\r\n>   File \"C:\\Anaconda3\\lib\\runpy.py\", line 96, in _run_module_code\r\n>     mod_name, mod_spec, pkg_name, script_name)\r\n>   File \"C:\\Anaconda3\\lib\\runpy.py\", line 85, in _run_code\r\n>     exec(code, run_globals)\r\n>   File \"C:\\Users\\kpoman\\conda_mnist\\test.py\", line 16, in <module>\r\n>     for batch_idx, (data, target) in enumerate(train_loader):\r\n>   File \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 417, in __iter__\r\n>     return DataLoaderIter(self)\r\n>   File \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 234, in __init__\r\n>     w.start()\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\process.py\", line 105, in start\r\n>     self._popen = self._Popen(self)\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 223, in _Popen\r\n>     return _default_context.get_context().Process._Popen(process_obj)\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 322, in _Popen\r\n>     return Popen(process_obj)\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\popen_spawn_win32.py\", line 33, in __init__\r\n>     prep_data = spawn.get_preparation_data(process_obj._name)\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 143, in get_preparation_data\r\n>     _check_not_importing_main()\r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\spawn.py\", line 136, in _check_not_importing_main\r\n>     is not going to be frozen to produce an executable.''')\r\n> RuntimeError:\r\n>   An attempt has been made to start a new process before the\r\n>   current process has finished its bootstrapping phase.\r\n> \r\n>   This probably means that you are not using fork to start your\r\n>   child processes and you have forgotten to use the proper idiom\r\n>   in the main module:\r\n> \r\n>   if __name__ == '__main__':\r\n>       freeze_support()\r\n>                 ...\r\n> \r\n>   The \"freeze_support()\" line can be omitted if the program\r\n>   is not going to be frozen to produce an executable.\r\n> \r\n> (base) C:\\Users\\kpoman\\conda_mnist>"}