{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4377", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4377/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4377/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4377/events", "html_url": "https://github.com/pytorch/pytorch/issues/4377", "id": 284893858, "node_id": "MDU6SXNzdWUyODQ4OTM4NTg=", "number": 4377, "title": "Getting Cuda error (3): initialization error", "user": {"login": "fer-git", "id": 13661217, "node_id": "MDQ6VXNlcjEzNjYxMjE3", "avatar_url": "https://avatars1.githubusercontent.com/u/13661217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fer-git", "html_url": "https://github.com/fer-git", "followers_url": "https://api.github.com/users/fer-git/followers", "following_url": "https://api.github.com/users/fer-git/following{/other_user}", "gists_url": "https://api.github.com/users/fer-git/gists{/gist_id}", "starred_url": "https://api.github.com/users/fer-git/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fer-git/subscriptions", "organizations_url": "https://api.github.com/users/fer-git/orgs", "repos_url": "https://api.github.com/users/fer-git/repos", "events_url": "https://api.github.com/users/fer-git/events{/privacy}", "received_events_url": "https://api.github.com/users/fer-git/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-12-28T11:13:34Z", "updated_at": "2017-12-28T15:29:35Z", "closed_at": "2017-12-28T15:29:35Z", "author_association": "NONE", "body_html": "<p>I got a problem when I need to iterate through DataLoader. I think the problem lies on num_workers parameter in DataLoader. Here is a snippet to reproduce the error:</p>\n<pre><code>import torch\nfrom torch.utils.data import DataLoader, TensorDataset\n\nfeatures = torch.cuda.LongTensor(range(12)).view(3, 4)\nlabels = torch.cuda.LongTensor(range(3))\ndataset = TensorDataset(features, labels)\ndataloader = DataLoader(dataset, num_workers=2)\nfor feat, lab in dataloader:\n    print(feat)\n    print(lab)\n</code></pre>\n<p>The error that I got:</p>\n<pre><code>Traceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 210, in __next__\n    return self._process_next_batch(batch)\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 230, in _process_next_batch\n    raise batch.exc_type(batch.exc_msg)\nRuntimeError: Traceback (most recent call last):\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 42, in _worker_loop\n    samples = collate_fn([dataset[i] for i in batch_indices])\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 42, in &lt;listcomp&gt;\n    samples = collate_fn([dataset[i] for i in batch_indices])\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataset.py\", line 39, in __getitem__\n    return self.data_tensor[index], self.target_tensor[index]\nRuntimeError: CUDA error (3): initialization error\n</code></pre>\n<p>I do not have issues when I run it on CPU with num_workers &gt; 0 and on GPU with num_workers=0.</p>\n<p>My torch version is 0.3.0.post4<br>\nPython version is 3.6.4<br>\nUbuntu version is 17.04<br>\nCuda version is 9.0.176</p>", "body_text": "I got a problem when I need to iterate through DataLoader. I think the problem lies on num_workers parameter in DataLoader. Here is a snippet to reproduce the error:\nimport torch\nfrom torch.utils.data import DataLoader, TensorDataset\n\nfeatures = torch.cuda.LongTensor(range(12)).view(3, 4)\nlabels = torch.cuda.LongTensor(range(3))\ndataset = TensorDataset(features, labels)\ndataloader = DataLoader(dataset, num_workers=2)\nfor feat, lab in dataloader:\n    print(feat)\n    print(lab)\n\nThe error that I got:\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 210, in __next__\n    return self._process_next_batch(batch)\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 230, in _process_next_batch\n    raise batch.exc_type(batch.exc_msg)\nRuntimeError: Traceback (most recent call last):\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 42, in _worker_loop\n    samples = collate_fn([dataset[i] for i in batch_indices])\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 42, in <listcomp>\n    samples = collate_fn([dataset[i] for i in batch_indices])\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataset.py\", line 39, in __getitem__\n    return self.data_tensor[index], self.target_tensor[index]\nRuntimeError: CUDA error (3): initialization error\n\nI do not have issues when I run it on CPU with num_workers > 0 and on GPU with num_workers=0.\nMy torch version is 0.3.0.post4\nPython version is 3.6.4\nUbuntu version is 17.04\nCuda version is 9.0.176", "body": "I got a problem when I need to iterate through DataLoader. I think the problem lies on num_workers parameter in DataLoader. Here is a snippet to reproduce the error:\r\n\r\n```\r\nimport torch\r\nfrom torch.utils.data import DataLoader, TensorDataset\r\n\r\nfeatures = torch.cuda.LongTensor(range(12)).view(3, 4)\r\nlabels = torch.cuda.LongTensor(range(3))\r\ndataset = TensorDataset(features, labels)\r\ndataloader = DataLoader(dataset, num_workers=2)\r\nfor feat, lab in dataloader:\r\n    print(feat)\r\n    print(lab)\r\n```\r\nThe error that I got:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 210, in __next__\r\n    return self._process_next_batch(batch)\r\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 230, in _process_next_batch\r\n    raise batch.exc_type(batch.exc_msg)\r\nRuntimeError: Traceback (most recent call last):\r\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 42, in _worker_loop\r\n    samples = collate_fn([dataset[i] for i in batch_indices])\r\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 42, in <listcomp>\r\n    samples = collate_fn([dataset[i] for i in batch_indices])\r\n  File \"/home/fernandopratama/anaconda3/envs/pyt/lib/python3.6/site-packages/torch/utils/data/dataset.py\", line 39, in __getitem__\r\n    return self.data_tensor[index], self.target_tensor[index]\r\nRuntimeError: CUDA error (3): initialization error\r\n```\r\nI do not have issues when I run it on CPU with num_workers > 0 and on GPU with num_workers=0.\r\n\r\nMy torch version is 0.3.0.post4\r\nPython version is 3.6.4\r\nUbuntu version is 17.04\r\nCuda version is 9.0.176"}