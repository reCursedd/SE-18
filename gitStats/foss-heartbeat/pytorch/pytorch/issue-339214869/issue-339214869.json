{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9242", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9242/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9242/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9242/events", "html_url": "https://github.com/pytorch/pytorch/issues/9242", "id": 339214869, "node_id": "MDU6SXNzdWUzMzkyMTQ4Njk=", "number": 9242, "title": "CUDA error: no kernel image is available for execution on the device Error from operator: output", "user": {"login": "CarlosYeverino", "id": 25825048, "node_id": "MDQ6VXNlcjI1ODI1MDQ4", "avatar_url": "https://avatars0.githubusercontent.com/u/25825048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CarlosYeverino", "html_url": "https://github.com/CarlosYeverino", "followers_url": "https://api.github.com/users/CarlosYeverino/followers", "following_url": "https://api.github.com/users/CarlosYeverino/following{/other_user}", "gists_url": "https://api.github.com/users/CarlosYeverino/gists{/gist_id}", "starred_url": "https://api.github.com/users/CarlosYeverino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CarlosYeverino/subscriptions", "organizations_url": "https://api.github.com/users/CarlosYeverino/orgs", "repos_url": "https://api.github.com/users/CarlosYeverino/repos", "events_url": "https://api.github.com/users/CarlosYeverino/events{/privacy}", "received_events_url": "https://api.github.com/users/CarlosYeverino/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2018-07-08T10:29:41Z", "updated_at": "2018-07-09T16:32:53Z", "closed_at": "2018-07-09T12:13:05Z", "author_association": "NONE", "body_html": "<p>If you have a question or would like help and support, please ask at our<br>\n<a href=\"https://discuss.pytorch.org/\" rel=\"nofollow\">forums</a>.</p>\n<p>If you are submitting a feature request, please preface the title with [feature request].<br>\nIf you are submitting a bug report, please fill in the following details.</p>\n<h2>Issue description</h2>\n<p>I compiled whole pythorch with GPU support and console output was successfully compiled. Therefore I was able to get caffe2_pybind11_state.pyd and caffe2_pybind11_state_gpu.pyd.</p>\n<p>When I run python the following code without GPU support it succeeds:<br>\n<code>python char_rnn.py --train_data shakespeare.txt</code></p>\n<p>However, when I run it with GPU I got a CUDA error:<br>\n<code>python char_rnn.py --train_data shakespeare.txt --gpu</code></p>\n<p>Output from console:<br>\nD:\\yev\\git_projects\\pytorch\\caffe2\\python\\examples&gt;python char_rnn.py --train_data shakespeare.txt --gpu<br>\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature avx is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.<br>\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature avx2 is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.<br>\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature fma is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.<br>\nInput has 62 characters. Total input size: 99993<br>\nDEBUG:char_rnn:Start training<br>\nDEBUG:char_rnn:Training model<br>\nWARNING:caffe2.python.workspace:Original python traceback for operator <code>0</code> in network <code>char_rnn_init</code> in exception above (most recent call last):<br>\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 276, in <br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 329, in wrapper<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 291, in run<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 328, in func<br>\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 270, in main<br>\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 71, in CreateModel<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 1571, in _LSTM<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 93, in apply_over_sequence<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 491, in prepare_input<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\brew.py\", line 107, in scope_wrapper<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\helpers\\fc.py\", line 58, in fc<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\helpers\\fc.py\", line 37, in _FC_or_packed_FC<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\model_helper.py\", line 214, in create_param<br>\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\modeling\\initializers.py\", line 30, in create_param<br>\nEntering interactive debugger. Type \"bt\" to print the full stacktrace. Type \"help\" to see command listing.<br>\n[enforce fail at context_gpu.h:171] . Encountered CUDA error: no kernel image is available for execution on the device Error from operator:<br>\noutput: \"LSTM/i2h_w\" name: \"\" type: \"XavierFill\" arg { name: \"shape\" ints: 400 ints: 62 } device_option { device_type: 1 cuda_gpu_id: 0 }</p>\n<blockquote>\n<p>d:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\workspace.py(178)CallWithExceptionIntercept()<br>\n-&gt; return func(*args, **kwargs)<br>\n(Pdb)</p>\n</blockquote>\n<h2>Code example</h2>\n<p><code>python char_rnn.py --train_data shakespeare.txt --gpu</code></p>\n<h2>System Info</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<ul>\n<li>PyTorch or Caffe2: Pythorch cloned to be able to use Caffe2</li>\n<li>How you installed PyTorch (conda, pip, source): github</li>\n<li>Build command you used (if compiling from source):</li>\n<li>OS: Windows 10</li>\n<li>PyTorch version: current version</li>\n<li>Python version: 2.7</li>\n<li>CUDA/cuDNN version: 9.2/7.1</li>\n<li>GPU models and configuration: NVIDIA GeForce GTX 1050</li>\n<li>GCC version (if compiling from source):</li>\n<li>CMake version: cmake-3.12.0-rc2-win64-x64.msi</li>\n<li>Versions of any other relevant libraries: Visual Studio 2017</li>\n</ul>", "body_text": "If you have a question or would like help and support, please ask at our\nforums.\nIf you are submitting a feature request, please preface the title with [feature request].\nIf you are submitting a bug report, please fill in the following details.\nIssue description\nI compiled whole pythorch with GPU support and console output was successfully compiled. Therefore I was able to get caffe2_pybind11_state.pyd and caffe2_pybind11_state_gpu.pyd.\nWhen I run python the following code without GPU support it succeeds:\npython char_rnn.py --train_data shakespeare.txt\nHowever, when I run it with GPU I got a CUDA error:\npython char_rnn.py --train_data shakespeare.txt --gpu\nOutput from console:\nD:\\yev\\git_projects\\pytorch\\caffe2\\python\\examples>python char_rnn.py --train_data shakespeare.txt --gpu\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature avx is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature avx2 is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature fma is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\nInput has 62 characters. Total input size: 99993\nDEBUG:char_rnn:Start training\nDEBUG:char_rnn:Training model\nWARNING:caffe2.python.workspace:Original python traceback for operator 0 in network char_rnn_init in exception above (most recent call last):\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 276, in \nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 329, in wrapper\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 291, in run\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 328, in func\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 270, in main\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 71, in CreateModel\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 1571, in _LSTM\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 93, in apply_over_sequence\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 491, in prepare_input\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\brew.py\", line 107, in scope_wrapper\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\helpers\\fc.py\", line 58, in fc\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\helpers\\fc.py\", line 37, in _FC_or_packed_FC\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\model_helper.py\", line 214, in create_param\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\modeling\\initializers.py\", line 30, in create_param\nEntering interactive debugger. Type \"bt\" to print the full stacktrace. Type \"help\" to see command listing.\n[enforce fail at context_gpu.h:171] . Encountered CUDA error: no kernel image is available for execution on the device Error from operator:\noutput: \"LSTM/i2h_w\" name: \"\" type: \"XavierFill\" arg { name: \"shape\" ints: 400 ints: 62 } device_option { device_type: 1 cuda_gpu_id: 0 }\n\nd:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\workspace.py(178)CallWithExceptionIntercept()\n-> return func(*args, **kwargs)\n(Pdb)\n\nCode example\npython char_rnn.py --train_data shakespeare.txt --gpu\nSystem Info\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\n\nPyTorch or Caffe2: Pythorch cloned to be able to use Caffe2\nHow you installed PyTorch (conda, pip, source): github\nBuild command you used (if compiling from source):\nOS: Windows 10\nPyTorch version: current version\nPython version: 2.7\nCUDA/cuDNN version: 9.2/7.1\nGPU models and configuration: NVIDIA GeForce GTX 1050\nGCC version (if compiling from source):\nCMake version: cmake-3.12.0-rc2-win64-x64.msi\nVersions of any other relevant libraries: Visual Studio 2017", "body": "If you have a question or would like help and support, please ask at our\r\n[forums](https://discuss.pytorch.org/).\r\n\r\nIf you are submitting a feature request, please preface the title with [feature request].\r\nIf you are submitting a bug report, please fill in the following details.\r\n\r\n## Issue description\r\n\r\nI compiled whole pythorch with GPU support and console output was successfully compiled. Therefore I was able to get caffe2_pybind11_state.pyd and caffe2_pybind11_state_gpu.pyd.\r\n\r\nWhen I run python the following code without GPU support it succeeds:\r\n`python char_rnn.py --train_data shakespeare.txt`\r\n\r\nHowever, when I run it with GPU I got a CUDA error:\r\n`python char_rnn.py --train_data shakespeare.txt --gpu`\r\n\r\nOutput from console:\r\nD:\\yev\\git_projects\\pytorch\\caffe2\\python\\examples>python char_rnn.py --train_data shakespeare.txt --gpu\r\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature avx is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\r\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature avx2 is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\r\n[E D:\\yev\\git_projects\\pytorch\\caffe2\\core\\init_intrinsics_check.cc:43] CPU feature fma is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\r\nInput has 62 characters. Total input size: 99993\r\nDEBUG:char_rnn:Start training\r\nDEBUG:char_rnn:Training model\r\nWARNING:caffe2.python.workspace:Original python traceback for operator `0` in network `char_rnn_init` in exception above (most recent call last):\r\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 276, in <module>\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 329, in wrapper\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 291, in run\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\utils.py\", line 328, in func\r\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 270, in main\r\nWARNING:caffe2.python.workspace:  File \"char_rnn.py\", line 71, in CreateModel\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 1571, in _LSTM\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 93, in apply_over_sequence\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\rnn_cell.py\", line 491, in prepare_input\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\brew.py\", line 107, in scope_wrapper\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\helpers\\fc.py\", line 58, in fc\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\helpers\\fc.py\", line 37, in _FC_or_packed_FC\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\model_helper.py\", line 214, in create_param\r\nWARNING:caffe2.python.workspace:  File \"D:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\modeling\\initializers.py\", line 30, in create_param\r\nEntering interactive debugger. Type \"bt\" to print the full stacktrace. Type \"help\" to see command listing.\r\n[enforce fail at context_gpu.h:171] . Encountered CUDA error: no kernel image is available for execution on the device Error from operator:\r\noutput: \"LSTM/i2h_w\" name: \"\" type: \"XavierFill\" arg { name: \"shape\" ints: 400 ints: 62 } device_option { device_type: 1 cuda_gpu_id: 0 }\r\n> d:\\yev\\git_projects\\pytorch\\build\\caffe2\\python\\workspace.py(178)CallWithExceptionIntercept()\r\n-> return func(*args, **kwargs)\r\n(Pdb)\r\n\r\n## Code example\r\n\r\n`python char_rnn.py --train_data shakespeare.txt --gpu`\r\n\r\n## System Info\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n- PyTorch or Caffe2: Pythorch cloned to be able to use Caffe2\r\n- How you installed PyTorch (conda, pip, source): github\r\n- Build command you used (if compiling from source): \r\n- OS: Windows 10\r\n- PyTorch version: current version\r\n- Python version: 2.7\r\n- CUDA/cuDNN version: 9.2/7.1\r\n- GPU models and configuration: NVIDIA GeForce GTX 1050\r\n- GCC version (if compiling from source):\r\n- CMake version: cmake-3.12.0-rc2-win64-x64.msi\r\n- Versions of any other relevant libraries: Visual Studio 2017\r\n"}