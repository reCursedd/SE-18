{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6064", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6064/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6064/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6064/events", "html_url": "https://github.com/pytorch/pytorch/issues/6064", "id": 309240124, "node_id": "MDU6SXNzdWUzMDkyNDAxMjQ=", "number": 6064, "title": "[jit]][script] handling of 'void' returns", "user": {"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-03-28T06:45:12Z", "updated_at": "2018-03-31T16:35:45Z", "closed_at": "2018-03-31T16:35:45Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Methods returning no values generate weird error messages:</p>\n<p>For instance:</p>\n<pre><code>    def test_script_module_for(self):\n        class M(torch.jit.ScriptModule):\n            def __init__(self):\n                super(M, self).__init__(False)\n               \n            @torch.jit.script_method\n            def forward(self):\n                return\n</code></pre>\n<p>produces</p>\n<pre><code>Traceback (most recent call last):\n  File \"test/test_jit.py\", line 2059, in test_script_module_for\n    class M(torch.jit.ScriptModule):\n  File \"test/test_jit.py\", line 2064, in M\n    @torch.jit.script_method\n  File \"/data/users/zdevito/pytorch/torch/jit/__init__.py\", line 539, in script_method\n    return ScriptMethodStub(createResolutionCallback(), get_jit_ast(fn))\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 127, in get_jit_ast\n    return build_def(SourceRangeFactory(source), py_ast.body[0])\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 146, in build_def\n    [build_stmt(ctx, stmt) for stmt in body])\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 135, in __call__\n    return method(ctx, node)\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 207, in build_Return\n    return Return(r, [build_expr(ctx, val) for val in values])\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 134, in __call__\n    raise UnsupportedNodeError(ctx, node)\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 110, in __init__\n    source_range = ctx.make_range(offending_node.lineno,\nAttributeError: 'NoneType' object has no attribute 'lineno'\n</code></pre>\n<p>What is expected?</p>\n<ul>\n<li>omitting a return statement should be valid and just return 0 values (someone might just be print debugging at this point and hasn't written the return yet)</li>\n<li><code>return</code> with no value should work.</li>\n</ul>", "body_text": "Methods returning no values generate weird error messages:\nFor instance:\n    def test_script_module_for(self):\n        class M(torch.jit.ScriptModule):\n            def __init__(self):\n                super(M, self).__init__(False)\n               \n            @torch.jit.script_method\n            def forward(self):\n                return\n\nproduces\nTraceback (most recent call last):\n  File \"test/test_jit.py\", line 2059, in test_script_module_for\n    class M(torch.jit.ScriptModule):\n  File \"test/test_jit.py\", line 2064, in M\n    @torch.jit.script_method\n  File \"/data/users/zdevito/pytorch/torch/jit/__init__.py\", line 539, in script_method\n    return ScriptMethodStub(createResolutionCallback(), get_jit_ast(fn))\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 127, in get_jit_ast\n    return build_def(SourceRangeFactory(source), py_ast.body[0])\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 146, in build_def\n    [build_stmt(ctx, stmt) for stmt in body])\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 135, in __call__\n    return method(ctx, node)\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 207, in build_Return\n    return Return(r, [build_expr(ctx, val) for val in values])\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 134, in __call__\n    raise UnsupportedNodeError(ctx, node)\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 110, in __init__\n    source_range = ctx.make_range(offending_node.lineno,\nAttributeError: 'NoneType' object has no attribute 'lineno'\n\nWhat is expected?\n\nomitting a return statement should be valid and just return 0 values (someone might just be print debugging at this point and hasn't written the return yet)\nreturn with no value should work.", "body": "Methods returning no values generate weird error messages:\r\n\r\nFor instance:\r\n\r\n```\r\n    def test_script_module_for(self):\r\n        class M(torch.jit.ScriptModule):\r\n            def __init__(self):\r\n                super(M, self).__init__(False)\r\n               \r\n            @torch.jit.script_method\r\n            def forward(self):\r\n                return\r\n```\r\n\r\nproduces \r\n```\r\nTraceback (most recent call last):\r\n  File \"test/test_jit.py\", line 2059, in test_script_module_for\r\n    class M(torch.jit.ScriptModule):\r\n  File \"test/test_jit.py\", line 2064, in M\r\n    @torch.jit.script_method\r\n  File \"/data/users/zdevito/pytorch/torch/jit/__init__.py\", line 539, in script_method\r\n    return ScriptMethodStub(createResolutionCallback(), get_jit_ast(fn))\r\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 127, in get_jit_ast\r\n    return build_def(SourceRangeFactory(source), py_ast.body[0])\r\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 146, in build_def\r\n    [build_stmt(ctx, stmt) for stmt in body])\r\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 135, in __call__\r\n    return method(ctx, node)\r\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 207, in build_Return\r\n    return Return(r, [build_expr(ctx, val) for val in values])\r\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 134, in __call__\r\n    raise UnsupportedNodeError(ctx, node)\r\n  File \"/data/users/zdevito/pytorch/torch/jit/frontend.py\", line 110, in __init__\r\n    source_range = ctx.make_range(offending_node.lineno,\r\nAttributeError: 'NoneType' object has no attribute 'lineno'\r\n```\r\n\r\nWhat is expected?\r\n\r\n* omitting a return statement should be valid and just return 0 values (someone might just be print debugging at this point and hasn't written the return yet)\r\n* `return` with no value should work."}