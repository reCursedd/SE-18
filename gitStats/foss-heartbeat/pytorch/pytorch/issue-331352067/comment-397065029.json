{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/397065029", "html_url": "https://github.com/pytorch/pytorch/issues/8348#issuecomment-397065029", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8348", "id": 397065029, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzA2NTAyOQ==", "user": {"login": "abaisero", "id": 1794938, "node_id": "MDQ6VXNlcjE3OTQ5Mzg=", "avatar_url": "https://avatars3.githubusercontent.com/u/1794938?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abaisero", "html_url": "https://github.com/abaisero", "followers_url": "https://api.github.com/users/abaisero/followers", "following_url": "https://api.github.com/users/abaisero/following{/other_user}", "gists_url": "https://api.github.com/users/abaisero/gists{/gist_id}", "starred_url": "https://api.github.com/users/abaisero/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abaisero/subscriptions", "organizations_url": "https://api.github.com/users/abaisero/orgs", "repos_url": "https://api.github.com/users/abaisero/repos", "events_url": "https://api.github.com/users/abaisero/events{/privacy}", "received_events_url": "https://api.github.com/users/abaisero/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-13T19:55:52Z", "updated_at": "2018-06-13T19:55:52Z", "author_association": "NONE", "body_html": "<p>I've been trying to install pytorch 0.4 on Red Hat Enterprise Linux Server 6.3 in the past few days, and I'm having the exact same issue, namely that the install script uses a different compiler than the one specified by the CC or CXX env variables, one which does not support c++11 (I could even set them to random strings and it wouldn't matter).  (Sidenote:  Unless I'm reading it wrong, setup.py indicates to use CC rather than CXX;  nonetheless neither work).</p>\n<p>In case this might help, here is my failed compilation log:</p>\n<pre><code>running install\nrunning build_deps\n+ WITH_CUDA=0\n+ WITH_ROCM=0\n+ WITH_NNPACK=0\n+ WITH_MKLDNN=0\n+ WITH_GLOO_IBVERBS=0\n+ WITH_DISTRIBUTED_MW=0\n+ FULL_CAFFE2=0\n+ [[ 9 -gt 0 ]]\n+ case \"$1\" in\n+ WITH_CUDA=1\n+ shift\n+ [[ 8 -gt 0 ]]\n+ case \"$1\" in\n+ WITH_NNPACK=1\n+ shift\n+ [[ 7 -gt 0 ]]\n+ case \"$1\" in\n+ WITH_MKLDNN=1\n+ shift\n+ [[ 6 -gt 0 ]]\n+ case \"$1\" in\n+ break\n+ CMAKE_INSTALL='make install'\n+ USER_CFLAGS=\n+ USER_LDFLAGS=\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n++ dirname tools/build_pytorch_libs.sh\n+ cd tools/..\n+++ pwd\n++ printf '%q\\n' /home/baisero.a/git/pytorch\n+ PWD=/home/baisero.a/git/pytorch\n+ BASE_DIR=/home/baisero.a/git/pytorch\n+ TORCH_LIB_DIR=/home/baisero.a/git/pytorch/torch/lib\n+ INSTALL_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install\n+ THIRD_PARTY_DIR=/home/baisero.a/git/pytorch/third_party\n+ CMAKE_VERSION=cmake\n+ C_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\"'\n+ C_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n+ LDFLAGS='-L\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/lib\" '\n+ LD_POSTFIX=.so\n++ uname\n+ [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n+ LDFLAGS='-L\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\n+ CPP_FLAGS=' -std=c++11 '\n+ GLOO_FLAGS=\n+ THD_FLAGS=\n+ NCCL_ROOT_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install\n+ [[ 1 -eq 1 ]]\n+ GLOO_FLAGS='-DUSE_CUDA=1 -DNCCL_ROOT_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install'\n+ [[ 0 -eq 1 ]]\n+ [[ 0 -eq 1 ]]\n+ CWRAP_FILES='/home/baisero.a/git/pytorch/torch/lib/ATen/Declarations.cwrap;/home/baisero.a/git/pytorch/torch/lib/THNN/generic/THNN.h;/home/baisero.a/git/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/home/baisero.a/git/pytorch/torch/lib/ATen/nn.yaml'\n+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n+ [[ '' -eq 1 ]]\n+ '[' -z 32 ']'\n+ BUILD_TYPE=Release\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n+ echo 'Building in Release mode'\nBuilding in Release mode\n+ mkdir -p torch/lib/tmp_install\n+ for arg in '\"$@\"'\n+ [[ nccl == \\n\\c\\c\\l ]]\n+ pushd /home/baisero.a/git/pytorch/third_party\n~/git/pytorch/third_party ~/git/pytorch\n+ build_nccl\n+ mkdir -p build/nccl\n+ pushd build/nccl\n~/git/pytorch/third_party/build/nccl ~/git/pytorch/third_party ~/git/pytorch\n+ cmake ../../nccl -DCMAKE_MODULE_PATH=/home/baisero.a/git/pytorch/cmake/FindCUDA -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/home/baisero.a/git/pytorch/torch/lib/tmp_install '-DCMAKE_C_FLAGS= -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 ' '-DCMAKE_CXX_FLAGS= -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1  -std=c++11  ' -DCMAKE_SHARED_LINKER_FLAGS=\n-- The CXX compiler identification is GNU 4.4.7\n-- Check for working CXX compiler: /shared/apps/gnu-compilers/usr/bin/c++\n-- Check for working CXX compiler: /shared/apps/gnu-compilers/usr/bin/c++ -- broken\nCMake Error at /home/baisero.a/anaconda3/share/cmake-3.11/Modules/CMakeTestCXXCompiler.cmake:45 (message):\n  The C++ compiler\n\n    \"/shared/apps/gnu-compilers/usr/bin/c++\"\n\n  is not able to compile a simple test program.\n\n  It fails with the following output:\n\n    Change Dir: /home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp\n    \n    Run Build Command:\"/usr/bin/gmake\" \"cmTC_37932/fast\"\n    /usr/bin/gmake -f CMakeFiles/cmTC_37932.dir/build.make CMakeFiles/cmTC_37932.dir/build\n    gmake[1]: Entering directory `/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp'\n    Building CXX object CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o\n    /shared/apps/gnu-compilers/usr/bin/c++    -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1  -std=c++11    -o CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o -c /home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp/testCXXCompiler.cxx\n    cc1plus: error: unrecognized command line option \"-std=c++11\"\n    gmake[1]: *** [CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o] Error 1\n    gmake[1]: Leaving directory `/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp'\n    gmake: *** [cmTC_37932/fast] Error 2\n    \n\n  \n\n  CMake will not be able to correctly generate this project.\nCall Stack (most recent call first):\n  CMakeLists.txt\n\n\n-- Configuring incomplete, errors occurred!\nSee also \"/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeOutput.log\".\nSee also \"/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeError.log\".\nFailed to run 'bash tools/build_pytorch_libs.sh --with-cuda --with-nnpack --with-mkldnn nccl caffe2 nanopb libshm gloo THD'\n</code></pre>\n<p>System Info</p>\n<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\" CC=$(which gcc) CXX=$(which c++) python setup.py install</li>\n<li>OS: Linux xxxx.yy.edu 2.6.32-279.el6.x86_64 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171281708\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1\">#1</a> SMP Wed Jun 13 18:24:36 EDT 2012 x86_64 x86_64 x86_64 GNU/Linux</li>\n<li>PyTorch version: 0.4</li>\n<li>Python version: 3.6.5</li>\n<li>CUDA/cuDNN version: I have the following installed, don't know which one it is trying to use:  8.0, 8.0 with cudnn-5.1.3, cuda-9.0</li>\n<li>GPU models and configuration: NVIDIA Tesla K20m GPU</li>\n<li>GCC version (if compiling from source): 4.9.3, but the one used at /shared/apps/gnu-compilers/usr/bin/c++ is 4.4.7</li>\n<li>CMake version: 3.11.1</li>\n<li>Versions of any other relevant libraries:</li>\n<li>glibc: 2.12</li>\n<li>conda: 4.5.4</li>\n</ul>\n<p>Thanks for the help with this issue!</p>", "body_text": "I've been trying to install pytorch 0.4 on Red Hat Enterprise Linux Server 6.3 in the past few days, and I'm having the exact same issue, namely that the install script uses a different compiler than the one specified by the CC or CXX env variables, one which does not support c++11 (I could even set them to random strings and it wouldn't matter).  (Sidenote:  Unless I'm reading it wrong, setup.py indicates to use CC rather than CXX;  nonetheless neither work).\nIn case this might help, here is my failed compilation log:\nrunning install\nrunning build_deps\n+ WITH_CUDA=0\n+ WITH_ROCM=0\n+ WITH_NNPACK=0\n+ WITH_MKLDNN=0\n+ WITH_GLOO_IBVERBS=0\n+ WITH_DISTRIBUTED_MW=0\n+ FULL_CAFFE2=0\n+ [[ 9 -gt 0 ]]\n+ case \"$1\" in\n+ WITH_CUDA=1\n+ shift\n+ [[ 8 -gt 0 ]]\n+ case \"$1\" in\n+ WITH_NNPACK=1\n+ shift\n+ [[ 7 -gt 0 ]]\n+ case \"$1\" in\n+ WITH_MKLDNN=1\n+ shift\n+ [[ 6 -gt 0 ]]\n+ case \"$1\" in\n+ break\n+ CMAKE_INSTALL='make install'\n+ USER_CFLAGS=\n+ USER_LDFLAGS=\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n++ dirname tools/build_pytorch_libs.sh\n+ cd tools/..\n+++ pwd\n++ printf '%q\\n' /home/baisero.a/git/pytorch\n+ PWD=/home/baisero.a/git/pytorch\n+ BASE_DIR=/home/baisero.a/git/pytorch\n+ TORCH_LIB_DIR=/home/baisero.a/git/pytorch/torch/lib\n+ INSTALL_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install\n+ THIRD_PARTY_DIR=/home/baisero.a/git/pytorch/third_party\n+ CMAKE_VERSION=cmake\n+ C_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\"'\n+ C_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n+ LDFLAGS='-L\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/lib\" '\n+ LD_POSTFIX=.so\n++ uname\n+ [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n+ LDFLAGS='-L\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\n+ CPP_FLAGS=' -std=c++11 '\n+ GLOO_FLAGS=\n+ THD_FLAGS=\n+ NCCL_ROOT_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install\n+ [[ 1 -eq 1 ]]\n+ GLOO_FLAGS='-DUSE_CUDA=1 -DNCCL_ROOT_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install'\n+ [[ 0 -eq 1 ]]\n+ [[ 0 -eq 1 ]]\n+ CWRAP_FILES='/home/baisero.a/git/pytorch/torch/lib/ATen/Declarations.cwrap;/home/baisero.a/git/pytorch/torch/lib/THNN/generic/THNN.h;/home/baisero.a/git/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/home/baisero.a/git/pytorch/torch/lib/ATen/nn.yaml'\n+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n+ [[ '' -eq 1 ]]\n+ '[' -z 32 ']'\n+ BUILD_TYPE=Release\n+ [[ -n '' ]]\n+ [[ -n '' ]]\n+ echo 'Building in Release mode'\nBuilding in Release mode\n+ mkdir -p torch/lib/tmp_install\n+ for arg in '\"$@\"'\n+ [[ nccl == \\n\\c\\c\\l ]]\n+ pushd /home/baisero.a/git/pytorch/third_party\n~/git/pytorch/third_party ~/git/pytorch\n+ build_nccl\n+ mkdir -p build/nccl\n+ pushd build/nccl\n~/git/pytorch/third_party/build/nccl ~/git/pytorch/third_party ~/git/pytorch\n+ cmake ../../nccl -DCMAKE_MODULE_PATH=/home/baisero.a/git/pytorch/cmake/FindCUDA -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/home/baisero.a/git/pytorch/torch/lib/tmp_install '-DCMAKE_C_FLAGS= -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 ' '-DCMAKE_CXX_FLAGS= -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1  -std=c++11  ' -DCMAKE_SHARED_LINKER_FLAGS=\n-- The CXX compiler identification is GNU 4.4.7\n-- Check for working CXX compiler: /shared/apps/gnu-compilers/usr/bin/c++\n-- Check for working CXX compiler: /shared/apps/gnu-compilers/usr/bin/c++ -- broken\nCMake Error at /home/baisero.a/anaconda3/share/cmake-3.11/Modules/CMakeTestCXXCompiler.cmake:45 (message):\n  The C++ compiler\n\n    \"/shared/apps/gnu-compilers/usr/bin/c++\"\n\n  is not able to compile a simple test program.\n\n  It fails with the following output:\n\n    Change Dir: /home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp\n    \n    Run Build Command:\"/usr/bin/gmake\" \"cmTC_37932/fast\"\n    /usr/bin/gmake -f CMakeFiles/cmTC_37932.dir/build.make CMakeFiles/cmTC_37932.dir/build\n    gmake[1]: Entering directory `/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp'\n    Building CXX object CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o\n    /shared/apps/gnu-compilers/usr/bin/c++    -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1  -std=c++11    -o CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o -c /home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp/testCXXCompiler.cxx\n    cc1plus: error: unrecognized command line option \"-std=c++11\"\n    gmake[1]: *** [CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o] Error 1\n    gmake[1]: Leaving directory `/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp'\n    gmake: *** [cmTC_37932/fast] Error 2\n    \n\n  \n\n  CMake will not be able to correctly generate this project.\nCall Stack (most recent call first):\n  CMakeLists.txt\n\n\n-- Configuring incomplete, errors occurred!\nSee also \"/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeOutput.log\".\nSee also \"/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeError.log\".\nFailed to run 'bash tools/build_pytorch_libs.sh --with-cuda --with-nnpack --with-mkldnn nccl caffe2 nanopb libshm gloo THD'\n\nSystem Info\n\nPyTorch or Caffe2: PyTorch\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\" CC=$(which gcc) CXX=$(which c++) python setup.py install\nOS: Linux xxxx.yy.edu 2.6.32-279.el6.x86_64 #1 SMP Wed Jun 13 18:24:36 EDT 2012 x86_64 x86_64 x86_64 GNU/Linux\nPyTorch version: 0.4\nPython version: 3.6.5\nCUDA/cuDNN version: I have the following installed, don't know which one it is trying to use:  8.0, 8.0 with cudnn-5.1.3, cuda-9.0\nGPU models and configuration: NVIDIA Tesla K20m GPU\nGCC version (if compiling from source): 4.9.3, but the one used at /shared/apps/gnu-compilers/usr/bin/c++ is 4.4.7\nCMake version: 3.11.1\nVersions of any other relevant libraries:\nglibc: 2.12\nconda: 4.5.4\n\nThanks for the help with this issue!", "body": "I've been trying to install pytorch 0.4 on Red Hat Enterprise Linux Server 6.3 in the past few days, and I'm having the exact same issue, namely that the install script uses a different compiler than the one specified by the CC or CXX env variables, one which does not support c++11 (I could even set them to random strings and it wouldn't matter).  (Sidenote:  Unless I'm reading it wrong, setup.py indicates to use CC rather than CXX;  nonetheless neither work).\r\n\r\nIn case this might help, here is my failed compilation log:\r\n\r\n```\r\nrunning install\r\nrunning build_deps\r\n+ WITH_CUDA=0\r\n+ WITH_ROCM=0\r\n+ WITH_NNPACK=0\r\n+ WITH_MKLDNN=0\r\n+ WITH_GLOO_IBVERBS=0\r\n+ WITH_DISTRIBUTED_MW=0\r\n+ FULL_CAFFE2=0\r\n+ [[ 9 -gt 0 ]]\r\n+ case \"$1\" in\r\n+ WITH_CUDA=1\r\n+ shift\r\n+ [[ 8 -gt 0 ]]\r\n+ case \"$1\" in\r\n+ WITH_NNPACK=1\r\n+ shift\r\n+ [[ 7 -gt 0 ]]\r\n+ case \"$1\" in\r\n+ WITH_MKLDNN=1\r\n+ shift\r\n+ [[ 6 -gt 0 ]]\r\n+ case \"$1\" in\r\n+ break\r\n+ CMAKE_INSTALL='make install'\r\n+ USER_CFLAGS=\r\n+ USER_LDFLAGS=\r\n+ [[ -n '' ]]\r\n+ [[ -n '' ]]\r\n+ [[ -n '' ]]\r\n++ dirname tools/build_pytorch_libs.sh\r\n+ cd tools/..\r\n+++ pwd\r\n++ printf '%q\\n' /home/baisero.a/git/pytorch\r\n+ PWD=/home/baisero.a/git/pytorch\r\n+ BASE_DIR=/home/baisero.a/git/pytorch\r\n+ TORCH_LIB_DIR=/home/baisero.a/git/pytorch/torch/lib\r\n+ INSTALL_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install\r\n+ THIRD_PARTY_DIR=/home/baisero.a/git/pytorch/third_party\r\n+ CMAKE_VERSION=cmake\r\n+ C_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\"'\r\n+ C_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\r\n+ LDFLAGS='-L\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/lib\" '\r\n+ LD_POSTFIX=.so\r\n++ uname\r\n+ [[ Linux == \\D\\a\\r\\w\\i\\n ]]\r\n+ LDFLAGS='-L\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\r\n+ CPP_FLAGS=' -std=c++11 '\r\n+ GLOO_FLAGS=\r\n+ THD_FLAGS=\r\n+ NCCL_ROOT_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install\r\n+ [[ 1 -eq 1 ]]\r\n+ GLOO_FLAGS='-DUSE_CUDA=1 -DNCCL_ROOT_DIR=/home/baisero.a/git/pytorch/torch/lib/tmp_install'\r\n+ [[ 0 -eq 1 ]]\r\n+ [[ 0 -eq 1 ]]\r\n+ CWRAP_FILES='/home/baisero.a/git/pytorch/torch/lib/ATen/Declarations.cwrap;/home/baisero.a/git/pytorch/torch/lib/THNN/generic/THNN.h;/home/baisero.a/git/pytorch/torch/lib/THCUNN/generic/THCUNN.h;/home/baisero.a/git/pytorch/torch/lib/ATen/nn.yaml'\r\n+ CUDA_NVCC_FLAGS=' -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\r\n+ [[ '' -eq 1 ]]\r\n+ '[' -z 32 ']'\r\n+ BUILD_TYPE=Release\r\n+ [[ -n '' ]]\r\n+ [[ -n '' ]]\r\n+ echo 'Building in Release mode'\r\nBuilding in Release mode\r\n+ mkdir -p torch/lib/tmp_install\r\n+ for arg in '\"$@\"'\r\n+ [[ nccl == \\n\\c\\c\\l ]]\r\n+ pushd /home/baisero.a/git/pytorch/third_party\r\n~/git/pytorch/third_party ~/git/pytorch\r\n+ build_nccl\r\n+ mkdir -p build/nccl\r\n+ pushd build/nccl\r\n~/git/pytorch/third_party/build/nccl ~/git/pytorch/third_party ~/git/pytorch\r\n+ cmake ../../nccl -DCMAKE_MODULE_PATH=/home/baisero.a/git/pytorch/cmake/FindCUDA -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/home/baisero.a/git/pytorch/torch/lib/tmp_install '-DCMAKE_C_FLAGS= -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 ' '-DCMAKE_CXX_FLAGS= -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1  -std=c++11  ' -DCMAKE_SHARED_LINKER_FLAGS=\r\n-- The CXX compiler identification is GNU 4.4.7\r\n-- Check for working CXX compiler: /shared/apps/gnu-compilers/usr/bin/c++\r\n-- Check for working CXX compiler: /shared/apps/gnu-compilers/usr/bin/c++ -- broken\r\nCMake Error at /home/baisero.a/anaconda3/share/cmake-3.11/Modules/CMakeTestCXXCompiler.cmake:45 (message):\r\n  The C++ compiler\r\n\r\n    \"/shared/apps/gnu-compilers/usr/bin/c++\"\r\n\r\n  is not able to compile a simple test program.\r\n\r\n  It fails with the following output:\r\n\r\n    Change Dir: /home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp\r\n    \r\n    Run Build Command:\"/usr/bin/gmake\" \"cmTC_37932/fast\"\r\n    /usr/bin/gmake -f CMakeFiles/cmTC_37932.dir/build.make CMakeFiles/cmTC_37932.dir/build\r\n    gmake[1]: Entering directory `/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp'\r\n    Building CXX object CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o\r\n    /shared/apps/gnu-compilers/usr/bin/c++    -DTH_INDEX_BASE=0 -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/baisero.a/git/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1  -std=c++11    -o CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o -c /home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp/testCXXCompiler.cxx\r\n    cc1plus: error: unrecognized command line option \"-std=c++11\"\r\n    gmake[1]: *** [CMakeFiles/cmTC_37932.dir/testCXXCompiler.cxx.o] Error 1\r\n    gmake[1]: Leaving directory `/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeTmp'\r\n    gmake: *** [cmTC_37932/fast] Error 2\r\n    \r\n\r\n  \r\n\r\n  CMake will not be able to correctly generate this project.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt\r\n\r\n\r\n-- Configuring incomplete, errors occurred!\r\nSee also \"/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeOutput.log\".\r\nSee also \"/home/baisero.a/git/pytorch/third_party/build/nccl/CMakeFiles/CMakeError.log\".\r\nFailed to run 'bash tools/build_pytorch_libs.sh --with-cuda --with-nnpack --with-mkldnn nccl caffe2 nanopb libshm gloo THD'\r\n```\r\n\r\nSystem Info\r\n\r\n* PyTorch or Caffe2: PyTorch\r\n* How you installed PyTorch (conda, pip, source): source\r\n* Build command you used (if compiling from source): CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\" CC=$(which gcc) CXX=$(which c++) python setup.py install\r\n* OS: Linux xxxx.yy.edu 2.6.32-279.el6.x86_64 #1 SMP Wed Jun 13 18:24:36 EDT 2012 x86_64 x86_64 x86_64 GNU/Linux\r\n* PyTorch version: 0.4\r\n* Python version: 3.6.5\r\n* CUDA/cuDNN version: I have the following installed, don't know which one it is trying to use:  8.0, 8.0 with cudnn-5.1.3, cuda-9.0\r\n* GPU models and configuration: NVIDIA Tesla K20m GPU\r\n* GCC version (if compiling from source): 4.9.3, but the one used at /shared/apps/gnu-compilers/usr/bin/c++ is 4.4.7\r\n* CMake version: 3.11.1\r\n* Versions of any other relevant libraries:\r\n* glibc: 2.12\r\n* conda: 4.5.4\r\n\r\nThanks for the help with this issue!"}