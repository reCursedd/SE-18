{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4490", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4490/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4490/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4490/events", "html_url": "https://github.com/pytorch/pytorch/issues/4490", "id": 286170118, "node_id": "MDU6SXNzdWUyODYxNzAxMTg=", "number": 4490, "title": "cuda topk dim=0 crash on small tensor in two lines of code", "user": {"login": "davidbau", "id": 3458792, "node_id": "MDQ6VXNlcjM0NTg3OTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/3458792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidbau", "html_url": "https://github.com/davidbau", "followers_url": "https://api.github.com/users/davidbau/followers", "following_url": "https://api.github.com/users/davidbau/following{/other_user}", "gists_url": "https://api.github.com/users/davidbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidbau/subscriptions", "organizations_url": "https://api.github.com/users/davidbau/orgs", "repos_url": "https://api.github.com/users/davidbau/repos", "events_url": "https://api.github.com/users/davidbau/events{/privacy}", "received_events_url": "https://api.github.com/users/davidbau/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-01-05T02:03:14Z", "updated_at": "2018-02-06T04:34:32Z", "closed_at": "2018-02-06T04:34:32Z", "author_association": "NONE", "body_html": "<p>Repro:</p>\n<pre><code>import torch\na = torch.randn(25, 1, 8).cuda()\nb = torch.randn(25, 1, 9).cuda()\nprint('This one works')\nprint(a.topk(3, dim=0)[1])\nprint('This one crashes')\nprint(b.topk(3, dim=0)[1])\n</code></pre>\n<p>Expect two small tensors of small integers to be printed.  Instead, only the first case works. In the second case, you get a series of failed assertions starting with this:</p>\n<pre><code>pytorch/aten/src/THC/THCTensorTopK.c\nuh:251: DataType findPattern(DataType *, DataType *, IndexType, IndexType, BitDa\ntaType, BitDataType) [with DataType = float, BitDataType = unsigned int, IndexTy\npe = unsigned int]: block: [46,0,0], thread: [0,0,0] Assertion `false` failed.\n</code></pre>\n<p>I wonder if it is related to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"278345652\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3959\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/3959/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/3959\">#3959</a></p>", "body_text": "Repro:\nimport torch\na = torch.randn(25, 1, 8).cuda()\nb = torch.randn(25, 1, 9).cuda()\nprint('This one works')\nprint(a.topk(3, dim=0)[1])\nprint('This one crashes')\nprint(b.topk(3, dim=0)[1])\n\nExpect two small tensors of small integers to be printed.  Instead, only the first case works. In the second case, you get a series of failed assertions starting with this:\npytorch/aten/src/THC/THCTensorTopK.c\nuh:251: DataType findPattern(DataType *, DataType *, IndexType, IndexType, BitDa\ntaType, BitDataType) [with DataType = float, BitDataType = unsigned int, IndexTy\npe = unsigned int]: block: [46,0,0], thread: [0,0,0] Assertion `false` failed.\n\nI wonder if it is related to #3959", "body": "Repro:\r\n```\r\nimport torch\r\na = torch.randn(25, 1, 8).cuda()\r\nb = torch.randn(25, 1, 9).cuda()\r\nprint('This one works')\r\nprint(a.topk(3, dim=0)[1])\r\nprint('This one crashes')\r\nprint(b.topk(3, dim=0)[1])\r\n```\r\n\r\nExpect two small tensors of small integers to be printed.  Instead, only the first case works. In the second case, you get a series of failed assertions starting with this:\r\n\r\n```\r\npytorch/aten/src/THC/THCTensorTopK.c\r\nuh:251: DataType findPattern(DataType *, DataType *, IndexType, IndexType, BitDa\r\ntaType, BitDataType) [with DataType = float, BitDataType = unsigned int, IndexTy\r\npe = unsigned int]: block: [46,0,0], thread: [0,0,0] Assertion `false` failed.\r\n```\r\n\r\nI wonder if it is related to #3959\r\n"}