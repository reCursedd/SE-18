{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11804", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11804/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11804/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11804/events", "html_url": "https://github.com/pytorch/pytorch/issues/11804", "id": 361376046, "node_id": "MDU6SXNzdWUzNjEzNzYwNDY=", "number": 11804, "title": "Capture recv source rank in async work instead of passing int pointer", "user": {"login": "pietern", "id": 9845, "node_id": "MDQ6VXNlcjk4NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/9845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietern", "html_url": "https://github.com/pietern", "followers_url": "https://api.github.com/users/pietern/followers", "following_url": "https://api.github.com/users/pietern/following{/other_user}", "gists_url": "https://api.github.com/users/pietern/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietern/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietern/subscriptions", "organizations_url": "https://api.github.com/users/pietern/orgs", "repos_url": "https://api.github.com/users/pietern/repos", "events_url": "https://api.github.com/users/pietern/events{/privacy}", "received_events_url": "https://api.github.com/users/pietern/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1002728630, "node_id": "MDU6TGFiZWwxMDAyNzI4NjMw", "url": "https://api.github.com/repos/pytorch/pytorch/labels/1.0", "name": "1.0", "color": "f9db31", "default": false}, {"id": 679953883, "node_id": "MDU6TGFiZWw2Nzk5NTM4ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/distributed", "name": "distributed", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": {"login": "pietern", "id": 9845, "node_id": "MDQ6VXNlcjk4NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/9845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietern", "html_url": "https://github.com/pietern", "followers_url": "https://api.github.com/users/pietern/followers", "following_url": "https://api.github.com/users/pietern/following{/other_user}", "gists_url": "https://api.github.com/users/pietern/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietern/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietern/subscriptions", "organizations_url": "https://api.github.com/users/pietern/orgs", "repos_url": "https://api.github.com/users/pietern/repos", "events_url": "https://api.github.com/users/pietern/events{/privacy}", "received_events_url": "https://api.github.com/users/pietern/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pietern", "id": 9845, "node_id": "MDQ6VXNlcjk4NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/9845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietern", "html_url": "https://github.com/pietern", "followers_url": "https://api.github.com/users/pietern/followers", "following_url": "https://api.github.com/users/pietern/following{/other_user}", "gists_url": "https://api.github.com/users/pietern/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietern/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietern/subscriptions", "organizations_url": "https://api.github.com/users/pietern/orgs", "repos_url": "https://api.github.com/users/pietern/repos", "events_url": "https://api.github.com/users/pietern/events{/privacy}", "received_events_url": "https://api.github.com/users/pietern/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-09-18T16:01:42Z", "updated_at": "2018-11-16T23:14:06Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>Currently the recv-from-any call in torch.distributed does some gymnastics to retrieve the source rank of the process that fulfilled the recv call. It allocates a 1-element tensor and passes an int pointer to the call, which then writes the source rank there only after the call completes. It would be better to extend the work class to allow access to this variable so that this pointer-from-tensor trick can be removed.</p>\n<p>This is identical to what MPI does, where you fill an MPI_Status struct based on an MPI_Request. This status contains success/failure, source rank, and some other details about the request.</p>\n<p>Discussed this with <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=8120856\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/teng-li\">@teng-li</a> offline.</p>", "body_text": "Currently the recv-from-any call in torch.distributed does some gymnastics to retrieve the source rank of the process that fulfilled the recv call. It allocates a 1-element tensor and passes an int pointer to the call, which then writes the source rank there only after the call completes. It would be better to extend the work class to allow access to this variable so that this pointer-from-tensor trick can be removed.\nThis is identical to what MPI does, where you fill an MPI_Status struct based on an MPI_Request. This status contains success/failure, source rank, and some other details about the request.\nDiscussed this with @teng-li offline.", "body": "Currently the recv-from-any call in torch.distributed does some gymnastics to retrieve the source rank of the process that fulfilled the recv call. It allocates a 1-element tensor and passes an int pointer to the call, which then writes the source rank there only after the call completes. It would be better to extend the work class to allow access to this variable so that this pointer-from-tensor trick can be removed.\r\n\r\nThis is identical to what MPI does, where you fill an MPI_Status struct based on an MPI_Request. This status contains success/failure, source rank, and some other details about the request.\r\n\r\nDiscussed this with @teng-li offline. \r\n"}