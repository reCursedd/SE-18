{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4737", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4737/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4737/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4737/events", "html_url": "https://github.com/pytorch/pytorch/issues/4737", "id": 289837299, "node_id": "MDU6SXNzdWUyODk4MzcyOTk=", "number": 4737, "title": "iterative matrix multiplication gets gradually slower in CPU", "user": {"login": "kose-y", "id": 8198142, "node_id": "MDQ6VXNlcjgxOTgxNDI=", "avatar_url": "https://avatars0.githubusercontent.com/u/8198142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kose-y", "html_url": "https://github.com/kose-y", "followers_url": "https://api.github.com/users/kose-y/followers", "following_url": "https://api.github.com/users/kose-y/following{/other_user}", "gists_url": "https://api.github.com/users/kose-y/gists{/gist_id}", "starred_url": "https://api.github.com/users/kose-y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kose-y/subscriptions", "organizations_url": "https://api.github.com/users/kose-y/orgs", "repos_url": "https://api.github.com/users/kose-y/repos", "events_url": "https://api.github.com/users/kose-y/events{/privacy}", "received_events_url": "https://api.github.com/users/kose-y/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-01-19T01:50:47Z", "updated_at": "2018-04-03T13:07:05Z", "closed_at": "2018-04-03T13:07:05Z", "author_association": "NONE", "body_html": "<p>Hi, I implemented a classical multiplicative NMF algorithm with PyTorch, but it slows down after iterations on CPU. It is significant for single precision, and it also happens for double precision.</p>\n<p>It is basically a sequence of matrix multiplications, and of course the most time-consuming part is where the dense data matrix is an operand (can also be confirmed by profiling). The thing is, that particular multiplication step is getting slower. The same also happens when I use the argument <code>out=</code> in <code>torch.mm</code>. Memory usage was not increased over time. The same happens whatever I set the values to OMP_NUM_THREADS or MKL_NUM_THREADS.</p>\n<p>The version I'm running is 0.4.0a0+059299b, compiled from source on Ubuntu 16.04. It is tested on two different systems (Intel\u00ae Xeon\u00ae CPU E5-2680 v2 and Intel\u00ae Xeon\u00ae CPU E5-2650 v4).</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">import</span> time\n<span class=\"pl-k\">class</span> <span class=\"pl-en\">NMF</span>():\n    <span class=\"pl-k\">def</span> <span class=\"pl-c1\">__init__</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>, <span class=\"pl-smi\">data</span>, <span class=\"pl-smi\">r</span>, <span class=\"pl-smi\">TType</span><span class=\"pl-k\">=</span>torch.DoubleTensor):\n        <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"</span></span>\n<span class=\"pl-s\">        data: a Tensor.</span>\n<span class=\"pl-s\">        r: a small integer</span>\n<span class=\"pl-s\">        <span class=\"pl-pds\">\"\"\"</span></span>\n        <span class=\"pl-c1\">self</span>.TType <span class=\"pl-k\">=</span> TType\n\n        <span class=\"pl-c1\">self</span>.p, <span class=\"pl-c1\">self</span>.q <span class=\"pl-k\">=</span> data.shape\n        <span class=\"pl-c1\">self</span>.r <span class=\"pl-k\">=</span> r\n        p, q <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.p, <span class=\"pl-c1\">self</span>.q\n        <span class=\"pl-k\">assert</span> <span class=\"pl-c1\">self</span>.r<span class=\"pl-k\">&lt;=</span><span class=\"pl-c1\">self</span>.p <span class=\"pl-k\">and</span> <span class=\"pl-c1\">self</span>.r<span class=\"pl-k\">&lt;=</span><span class=\"pl-c1\">self</span>.q\n\n        <span class=\"pl-c\"><span class=\"pl-c\">#</span> initialize V and W</span>\n        <span class=\"pl-c1\">self</span>.V_prev <span class=\"pl-k\">=</span> TType(p, r)\n        <span class=\"pl-c1\">self</span>.W_prev <span class=\"pl-k\">=</span> TType(q, r).t() \n\n        <span class=\"pl-c1\">self</span>.V <span class=\"pl-k\">=</span> TType(p, r).uniform_()\n        <span class=\"pl-c1\">self</span>.W <span class=\"pl-k\">=</span> TType(q, r).uniform_().t()\n\n        <span class=\"pl-c1\">self</span>.data <span class=\"pl-k\">=</span> data\n\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">update_V</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>):\n        XWt <span class=\"pl-k\">=</span>  torch.mm(<span class=\"pl-c1\">self</span>.data, <span class=\"pl-c1\">self</span>.W.t()) <span class=\"pl-c\"><span class=\"pl-c\">#</span> this line gets slower over iterations</span>\n        WWt <span class=\"pl-k\">=</span>  torch.mm(<span class=\"pl-c1\">self</span>.W, <span class=\"pl-c1\">self</span>.W.t())\n        VWWt <span class=\"pl-k\">=</span> torch.mm(<span class=\"pl-c1\">self</span>.V, WWt)\n        <span class=\"pl-c1\">self</span>.V <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.V.mul_(XWt).div_(VWWt)\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">update_W</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>):\n        VtX  <span class=\"pl-k\">=</span> torch.mm(<span class=\"pl-c1\">self</span>.V.t(), <span class=\"pl-c1\">self</span>.data) <span class=\"pl-c\"><span class=\"pl-c\">#</span> this line gets slower over iterations</span>\n        VtV  <span class=\"pl-k\">=</span> torch.mm(<span class=\"pl-c1\">self</span>.V.t(), <span class=\"pl-c1\">self</span>.V)\n        VtVW <span class=\"pl-k\">=</span> torch.mm(VtV, <span class=\"pl-c1\">self</span>.W)\n        <span class=\"pl-c1\">self</span>.W <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.W.mul_(VtX).div_(VtVW)\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">get_objective</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>):\n        outer <span class=\"pl-k\">=</span> torch.mm(<span class=\"pl-c1\">self</span>.V, <span class=\"pl-c1\">self</span>.W)\n        val <span class=\"pl-k\">=</span> torch.sum(((<span class=\"pl-c1\">self</span>.data <span class=\"pl-k\">-</span> outer)<span class=\"pl-k\">**</span><span class=\"pl-c1\">2</span>))\n        <span class=\"pl-k\">return</span> val\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">check_convergence</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>,<span class=\"pl-smi\">tol</span>, <span class=\"pl-smi\">verbose</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>, <span class=\"pl-smi\">check_obj</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">False</span>):\n        obj <span class=\"pl-k\">=</span> <span class=\"pl-c1\">None</span>\n        diff_norm_1 <span class=\"pl-k\">=</span> torch.max(torch.abs(<span class=\"pl-c1\">self</span>.V_prev<span class=\"pl-k\">-</span><span class=\"pl-c1\">self</span>.V))\n        diff_norm_2 <span class=\"pl-k\">=</span> torch.max(torch.abs(<span class=\"pl-c1\">self</span>.W_prev<span class=\"pl-k\">-</span><span class=\"pl-c1\">self</span>.W))\n        <span class=\"pl-k\">if</span> check_obj:\n            obj <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.get_objective()\n        converged <span class=\"pl-k\">=</span> diff_norm_1 <span class=\"pl-k\">&lt;</span> tol <span class=\"pl-k\">and</span> diff_norm_2 <span class=\"pl-k\">&lt;</span> tol\n        <span class=\"pl-k\">return</span> (diff_norm_1, diff_norm_2, obj), converged\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">run</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>, <span class=\"pl-smi\">maxiter</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">100</span>, <span class=\"pl-smi\">tol</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">1e-5</span>, <span class=\"pl-smi\">check_interval</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">1</span>, <span class=\"pl-smi\">verbose</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>, <span class=\"pl-smi\">check_obj</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">False</span>):\n        <span class=\"pl-k\">if</span> verbose:\n            <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Starting...<span class=\"pl-pds\">\"</span></span>)\n            <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>p=<span class=\"pl-c1\">{}</span>, q=<span class=\"pl-c1\">{}</span>, r=<span class=\"pl-c1\">{}</span><span class=\"pl-pds\">\"</span></span>.format(<span class=\"pl-c1\">self</span>.p, <span class=\"pl-c1\">self</span>.q, <span class=\"pl-c1\">self</span>.r))\n            <span class=\"pl-k\">if</span> <span class=\"pl-k\">not</span> check_obj:\n                <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-c1\">%6s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">%</span> (<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>iter<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>V_maxdiff<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>W_maxdiff<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>time<span class=\"pl-pds\">\"</span></span>))\n            <span class=\"pl-k\">else</span>:\n                <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-c1\">%6s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10s</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">%</span> (<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>iter<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>V_maxdiff<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>W_maxdiff<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>obj<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>time<span class=\"pl-pds\">\"</span></span> ))\n            <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>-<span class=\"pl-pds\">'</span></span><span class=\"pl-k\">*</span><span class=\"pl-c1\">80</span>)\n\n        t0 <span class=\"pl-k\">=</span> time.time()\n        t_start <span class=\"pl-k\">=</span> t0\n\n        <span class=\"pl-k\">for</span> i <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(maxiter):\n            <span class=\"pl-c1\">self</span>.V_prev.copy_(<span class=\"pl-c1\">self</span>.V)\n            <span class=\"pl-c1\">self</span>.W_prev.copy_(<span class=\"pl-c1\">self</span>.W)\n\n            <span class=\"pl-c1\">self</span>.update_V()\n            <span class=\"pl-c1\">self</span>.update_W()\n            <span class=\"pl-k\">if</span> (i<span class=\"pl-k\">+</span><span class=\"pl-c1\">1</span>) <span class=\"pl-k\">%</span> check_interval <span class=\"pl-k\">==</span><span class=\"pl-c1\">0</span>:\n                t1 <span class=\"pl-k\">=</span> time.time()\n                (v_maxdiff, w_maxdiff, obj), converged <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.check_convergence(tol, verbose, check_obj)\n                <span class=\"pl-k\">if</span> verbose:\n                    <span class=\"pl-k\">if</span> <span class=\"pl-k\">not</span> check_obj:\n                        <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-c1\">%6d</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.4e</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.4e</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.5f</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">%</span> (i<span class=\"pl-k\">+</span><span class=\"pl-c1\">1</span>, v_maxdiff, w_maxdiff, t1<span class=\"pl-k\">-</span>t0))\n                    <span class=\"pl-k\">else</span>:\n                        <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-c1\">%6d</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.4e</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.4e</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.4e</span><span class=\"pl-cce\">\\t</span><span class=\"pl-c1\">%10.5f</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">%</span> (i<span class=\"pl-k\">+</span><span class=\"pl-c1\">1</span>, v_maxdiff, w_maxdiff,\n                                                                            obj, t1<span class=\"pl-k\">-</span>t0))\n                <span class=\"pl-k\">if</span> converged: <span class=\"pl-k\">break</span>\n                t0 <span class=\"pl-k\">=</span> t1\n\n        <span class=\"pl-k\">if</span> verbose:\n            <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>-<span class=\"pl-pds\">'</span></span><span class=\"pl-k\">*</span><span class=\"pl-c1\">80</span>)\n            <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Completed. total time: <span class=\"pl-c1\">{}</span><span class=\"pl-pds\">\"</span></span>.format(time.time()<span class=\"pl-k\">-</span>t_start))\n<span class=\"pl-k\">if</span> <span class=\"pl-c1\">__name__</span><span class=\"pl-k\">==</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>__main__<span class=\"pl-pds\">'</span></span>:\n    torch.manual_seed(<span class=\"pl-c1\">95376</span>)\n    TType<span class=\"pl-k\">=</span>torch.FloatTensor <span class=\"pl-c\"><span class=\"pl-c\">#</span> or torch.DoubleTensor</span>\n    m <span class=\"pl-k\">=</span> TType(<span class=\"pl-c1\">100</span>, <span class=\"pl-c1\">100</span>).uniform_() <span class=\"pl-c\"><span class=\"pl-c\">#</span> this is an example.</span>\n    nmf_driver <span class=\"pl-k\">=</span> NMF(m, <span class=\"pl-c1\">10</span>, TType)\n    nmf_driver.run(<span class=\"pl-c1\">100000</span>, <span class=\"pl-v\">check_interval</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">100</span>, <span class=\"pl-v\">check_obj</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>) </pre></div>\n<p>For single precision, the output on one of the machines was:</p>\n<pre><code>Starting...\np=100, q=100, r=10\n  iter\t V_maxdiff\t W_maxdiff\t       obj\t      time\n--------------------------------------------------------------------------------\n   100\t1.3119e-03\t6.6189e-03\t6.2078e+02\t   0.01510\n   200\t6.5940e-04\t3.3028e-03\t6.1045e+02\t   0.01169\n   300\t4.3547e-04\t3.1788e-03\t6.0724e+02\t   0.01114\n   400\t3.9439e-04\t2.3619e-03\t6.0541e+02\t   0.01090\n   500\t4.1880e-04\t1.8042e-03\t6.0420e+02\t   0.01092\n   600\t4.4276e-04\t1.5563e-03\t6.0327e+02\t   0.01098\n   700\t3.5451e-04\t1.2529e-03\t6.0248e+02\t   0.01114\n   800\t2.8326e-04\t1.2453e-03\t6.0187e+02\t   0.01262\n   900\t2.2144e-04\t1.0453e-03\t6.0142e+02\t   0.01667\n  1000\t1.7189e-04\t9.8240e-04\t6.0104e+02\t   0.01870\n  1100\t2.5006e-04\t1.6117e-03\t6.0060e+02\t   0.02041\n  1200\t1.6262e-04\t8.6427e-04\t6.0022e+02\t   0.02390\n  1300\t1.5678e-04\t7.2819e-04\t5.9991e+02\t   0.02604\n  1400\t1.4988e-04\t1.1668e-03\t5.9963e+02\t   0.02976\n  1500\t3.0002e-04\t1.6271e-03\t5.9927e+02\t   0.03425\n  1600\t2.1374e-04\t1.3682e-03\t5.9901e+02\t   0.04055\n  1700\t1.8387e-04\t9.8372e-04\t5.9878e+02\t   0.04655\n  1800\t1.2274e-04\t7.3430e-04\t5.9864e+02\t   0.05056\n  1900\t1.2808e-04\t7.3991e-04\t5.9844e+02\t   0.05459\n  2000\t1.0507e-04\t5.5665e-04\t5.9822e+02\t   0.05986\n  2100\t1.0122e-04\t5.9545e-04\t5.9805e+02\t   0.06360\n  2200\t7.7765e-05\t4.3631e-04\t5.9789e+02\t   0.06675\n  2300\t6.8538e-05\t3.6190e-04\t5.9779e+02\t   0.06986\n  2400\t4.5005e-05\t2.6327e-04\t5.9773e+02\t   0.07313\n  2500\t4.9658e-05\t3.0780e-04\t5.9768e+02\t   0.07640\n  2600\t3.4593e-05\t2.2912e-04\t5.9764e+02\t   0.08022\n  2700\t4.4137e-05\t2.8223e-04\t5.9759e+02\t   0.08401\n  2800\t9.8012e-05\t4.3392e-04\t5.9749e+02\t   0.08970\n  2900\t7.3388e-05\t3.0982e-04\t5.9743e+02\t   0.08717\n  3000\t5.1551e-05\t2.4986e-04\t5.9738e+02\t   0.07530\n  3100\t4.1783e-05\t2.8586e-04\t5.9734e+02\t   0.07525\n  3200\t3.8460e-05\t2.5535e-04\t5.9731e+02\t   0.07630\n  3300\t4.7788e-05\t4.2939e-04\t5.9727e+02\t   0.07898\n  3400\t4.1649e-05\t1.9139e-04\t5.9725e+02\t   0.07948\n  3500\t3.4884e-05\t1.8650e-04\t5.9722e+02\t   0.07985\n  3600\t4.3005e-05\t1.6895e-04\t5.9719e+02\t   0.08154\n  3700\t4.6715e-05\t1.6725e-04\t5.9715e+02\t   0.08338\n  3800\t3.4064e-05\t1.5116e-04\t5.9711e+02\t   0.08471\n  3900\t3.4675e-05\t1.6737e-04\t5.9709e+02\t   0.08635\n  4000\t2.7195e-05\t2.9254e-04\t5.9706e+02\t   0.08792\n  4100\t2.2151e-05\t1.6105e-04\t5.9704e+02\t   0.08961\n  4200\t1.9073e-05\t1.1778e-04\t5.9703e+02\t   0.09092\n  4300\t2.4661e-05\t1.2285e-04\t5.9701e+02\t   0.09233\n  4400\t2.4348e-05\t9.6858e-05\t5.9700e+02\t   0.09298\n  4500\t1.8656e-05\t7.8678e-05\t5.9700e+02\t   0.09346\n  4600\t2.7746e-05\t2.3198e-04\t5.9697e+02\t   0.09448\n  4700\t5.1215e-05\t3.3328e-04\t5.9691e+02\t   0.09553\n  4800\t3.1725e-05\t2.2525e-04\t5.9688e+02\t   0.09641\n  4900\t2.2836e-05\t1.5676e-04\t5.9686e+02\t   0.09729\n  5000\t2.1532e-05\t1.3620e-04\t5.9685e+02\t   0.09757\n  5100\t2.9176e-05\t1.3584e-04\t5.9684e+02\t   0.09838\n  5200\t3.8736e-05\t1.3852e-04\t5.9682e+02\t   0.09885\n  5300\t3.8072e-05\t1.2064e-04\t5.9681e+02\t   0.09973\n  5400\t3.0108e-05\t9.7394e-05\t5.9681e+02\t   0.10012\n  5500\t2.1681e-05\t8.1182e-05\t5.9680e+02\t   0.10153\n  5600\t2.3846e-05\t1.4779e-04\t5.9679e+02\t   0.10219\n  5700\t2.4244e-05\t1.5914e-04\t5.9678e+02\t   0.10259\n  5800\t1.8716e-05\t1.2057e-04\t5.9677e+02\t   0.10286\n  5900\t1.5788e-05\t8.9869e-05\t5.9676e+02\t   0.10322\n  6000\t1.6764e-05\t8.1718e-05\t5.9675e+02\t   0.10343\n  6100\t1.9893e-05\t1.2720e-04\t5.9674e+02\t   0.10417\n  6200\t4.7639e-05\t1.6403e-04\t5.9671e+02\t   0.10413\n  6300\t3.9786e-05\t1.4874e-04\t5.9670e+02\t   0.10451\n  6400\t2.8454e-05\t1.1134e-04\t5.9669e+02\t   0.10469\n  6500\t2.1398e-05\t1.1218e-04\t5.9669e+02\t   0.10558\n  6600\t2.2944e-05\t1.3828e-04\t5.9668e+02\t   0.10557\n  6700\t2.7187e-05\t1.5700e-04\t5.9667e+02\t   0.10566\n  6800\t2.9683e-05\t1.8024e-04\t5.9665e+02\t   0.10588\n  6900\t2.9683e-05\t1.6534e-04\t5.9665e+02\t   0.10649\n  7000\t2.5630e-05\t1.5831e-04\t5.9664e+02\t   0.10708\n  7100\t2.1935e-05\t1.4281e-04\t5.9664e+02\t   0.10753\n  7200\t1.9044e-05\t1.2743e-04\t5.9664e+02\t   0.10795\n  7300\t1.6563e-05\t1.1551e-04\t5.9663e+02\t   0.10821\n  7400\t2.0899e-05\t1.0800e-04\t5.9662e+02\t   0.10848\n  7500\t2.1543e-05\t1.0037e-04\t5.9662e+02\t   0.10893\n  7600\t1.8679e-05\t8.9169e-05\t5.9662e+02\t   0.10994\n  7700\t1.5087e-05\t7.7248e-05\t5.9661e+02\t   0.11038\n  7800\t1.2025e-05\t6.7592e-05\t5.9661e+02\t   0.11068\n  7900\t9.9614e-06\t6.0081e-05\t5.9661e+02\t   0.11107\n  8000\t1.1057e-05\t5.3525e-05\t5.9661e+02\t   0.11141\n  8100\t1.3798e-05\t4.9829e-05\t5.9661e+02\t   0.11187\n  8200\t1.3217e-05\t5.2810e-05\t5.9660e+02\t   0.11200\n  8300\t1.0297e-05\t4.3392e-05\t5.9660e+02\t   0.11205\n  8400\t9.8795e-06\t4.5002e-05\t5.9660e+02\t   0.11202\n  8500\t1.0192e-05\t4.9174e-05\t5.9660e+02\t   0.11210\n  8600\t9.7826e-06\t4.1559e-05\t5.9659e+02\t   0.11222\n  8700\t1.9178e-05\t5.4002e-05\t5.9659e+02\t   0.11238\n  8800\t2.6975e-05\t7.4863e-05\t5.9658e+02\t   0.11255\n  8900\t2.1780e-05\t6.9916e-05\t5.9658e+02\t   0.11277\n  9000\t1.4499e-05\t5.4181e-05\t5.9658e+02\t   0.11281\n  9100\t1.0202e-05\t4.6313e-05\t5.9657e+02\t   0.11295\n  9200\t7.8622e-06\t4.3124e-05\t5.9657e+02\t   0.11310\n  9300\t7.6145e-06\t4.0978e-05\t5.9657e+02\t   0.11293\n  9400\t7.5400e-06\t3.9369e-05\t5.9657e+02\t   0.11282\n  9500\t7.5549e-06\t3.7968e-05\t5.9657e+02\t   0.11296\n  9600\t7.5623e-06\t3.6806e-05\t5.9657e+02\t   0.11311\n  9700\t7.4953e-06\t3.5912e-05\t5.9657e+02\t   0.11326\n  9800\t7.3463e-06\t3.5286e-05\t5.9657e+02\t   0.11335\n  9900\t7.1824e-06\t3.4571e-05\t5.9657e+02\t   0.11347\n 10000\t7.0632e-06\t3.3557e-05\t5.9657e+02\t   0.11377\n 10100\t6.9663e-06\t3.2604e-05\t5.9656e+02\t   0.11394\n 10200\t6.8918e-06\t3.1471e-05\t5.9656e+02\t   0.11399\n 10300\t6.8918e-06\t3.0488e-05\t5.9656e+02\t   0.11419\n 10400\t6.8620e-06\t2.9415e-05\t5.9656e+02\t   0.11438\n 10500\t6.8843e-06\t2.8461e-05\t5.9656e+02\t   0.11458\n 10600\t6.8843e-06\t2.8372e-05\t5.9656e+02\t   0.11468\n 10700\t6.8694e-06\t2.8193e-05\t5.9656e+02\t   0.11465\n 10800\t6.8247e-06\t2.8133e-05\t5.9656e+02\t   0.11477\n 10900\t6.8694e-06\t2.7895e-05\t5.9656e+02\t   0.11484\n 11000\t6.9812e-06\t2.7537e-05\t5.9656e+02\t   0.11502\n 11100\t7.7821e-06\t3.1471e-05\t5.9656e+02\t   0.11497\n 11200\t6.8694e-06\t3.0637e-05\t5.9656e+02\t   0.11500\n 11300\t6.6012e-06\t2.7418e-05\t5.9656e+02\t   0.11519\n 11400\t6.3255e-06\t2.4199e-05\t5.9656e+02\t   0.11538\n 11500\t6.0573e-06\t2.3484e-05\t5.9656e+02\t   0.11573\n 11600\t5.8413e-06\t2.3127e-05\t5.9656e+02\t   0.11583\n 11700\t5.6699e-06\t2.2650e-05\t5.9656e+02\t   0.11626\n 11800\t5.5060e-06\t2.1935e-05\t5.9656e+02\t   0.11619\n 11900\t5.3868e-06\t2.1458e-05\t5.9656e+02\t   0.11684\n 12000\t5.2676e-06\t2.1219e-05\t5.9656e+02\t   0.11689\n 12100\t5.1260e-06\t2.0266e-05\t5.9656e+02\t   0.11692\n 12200\t5.0142e-06\t1.9789e-05\t5.9656e+02\t   0.11713\n 12300\t4.8652e-06\t1.9073e-05\t5.9656e+02\t   0.11729\n 12400\t4.7460e-06\t1.8954e-05\t5.9656e+02\t   0.11746\n 12500\t4.5896e-06\t1.8716e-05\t5.9656e+02\t   0.11765\n 12600\t4.4256e-06\t1.9014e-05\t5.9655e+02\t   0.11790\n 12700\t4.2915e-06\t2.0087e-05\t5.9655e+02\t   0.11785\n 12800\t4.2617e-06\t2.3007e-05\t5.9655e+02\t   0.11786\n 12900\t4.3511e-06\t2.8193e-05\t5.9655e+02\t   0.11789\n 13000\t6.5118e-06\t3.3557e-05\t5.9655e+02\t   0.11798\n 13100\t7.5474e-06\t3.4571e-05\t5.9655e+02\t   0.11790\n 13200\t6.9216e-06\t2.9802e-05\t5.9655e+02\t   0.11833\n 13300\t5.5954e-06\t2.4319e-05\t5.9655e+02\t   0.11840\n 13400\t4.6492e-06\t2.4319e-05\t5.9655e+02\t   0.11853\n 13500\t4.0159e-06\t2.1696e-05\t5.9655e+02\t   0.11857\n 13600\t3.5167e-06\t1.8239e-05\t5.9655e+02\t   0.11888\n 13700\t3.0920e-06\t1.4901e-05\t5.9655e+02\t   0.11885\n 13800\t3.3453e-06\t1.4067e-05\t5.9655e+02\t   0.11885\n 13900\t4.5449e-06\t1.6809e-05\t5.9655e+02\t   0.11894\n 14000\t6.7577e-06\t2.3514e-05\t5.9655e+02\t   0.11889\n 14100\t9.2164e-06\t3.6329e-05\t5.9655e+02\t   0.11910\n 14200\t1.0073e-05\t4.3869e-05\t5.9655e+02\t   0.11961\n 14300\t9.0972e-06\t4.1485e-05\t5.9654e+02\t   0.11928\n 14400\t7.5996e-06\t3.3975e-05\t5.9654e+02\t   0.11937\n 14500\t6.3628e-06\t2.6256e-05\t5.9654e+02\t   0.11935\n 14600\t5.5134e-06\t2.3186e-05\t5.9654e+02\t   0.11954\n 14700\t4.9621e-06\t2.1219e-05\t5.9654e+02\t   0.11942\n 14800\t4.5896e-06\t1.9193e-05\t5.9654e+02\t   0.11936\n 14900\t4.3288e-06\t1.7226e-05\t5.9654e+02\t   0.11960\n 15000\t4.1202e-06\t1.5795e-05\t5.9654e+02\t   0.11997\n 15100\t3.9935e-06\t1.5080e-05\t5.9654e+02\t   0.12017\n 15200\t3.8892e-06\t1.5736e-05\t5.9654e+02\t   0.11988\n 15300\t3.9041e-06\t2.2531e-05\t5.9654e+02\t   0.11988\n 15400\t4.3400e-06\t2.4796e-05\t5.9654e+02\t   0.12006\n 15500\t4.5411e-06\t2.6137e-05\t5.9654e+02\t   0.11990\n 15600\t6.9439e-06\t2.4915e-05\t5.9654e+02\t   0.12012\n 15700\t8.5682e-06\t3.0041e-05\t5.9654e+02\t   0.12033\n 15800\t7.8678e-06\t3.0041e-05\t5.9654e+02\t   0.12036\n 15900\t5.6922e-06\t2.5153e-05\t5.9654e+02\t   0.12058\n 16000\t3.7998e-06\t2.0012e-05\t5.9654e+02\t   0.12034\n 16100\t3.0920e-06\t1.5691e-05\t5.9654e+02\t   0.12077\n 16200\t3.0026e-06\t1.3232e-05\t5.9654e+02\t   0.12044\n 16300\t2.9281e-06\t1.2577e-05\t5.9654e+02\t   0.12046\n 16400\t2.8387e-06\t1.1802e-05\t5.9654e+02\t   0.12043\n 16500\t2.7418e-06\t1.1265e-05\t5.9654e+02\t   0.12038\n 16600\t2.6599e-06\t1.1086e-05\t5.9654e+02\t   0.12047\n 16700\t2.5854e-06\t1.0669e-05\t5.9653e+02\t   0.12062\n 16800\t2.4885e-06\t1.0252e-05\t5.9653e+02\t   0.12049\n 16900\t2.4214e-06\t9.9540e-06\t5.9653e+02\t   0.12048\n--------------------------------------------------------------------------------\n</code></pre>\n<p>and for double precision:</p>\n<pre><code>Starting...\np=100, q=100, r=10\n  iter\t V_maxdiff\t W_maxdiff\t       obj\t      time\n--------------------------------------------------------------------------------\n   100\t1.3119e-03\t6.6189e-03\t6.2078e+02\t   0.01510\n   200\t6.5940e-04\t3.3028e-03\t6.1045e+02\t   0.01169\n   300\t4.3547e-04\t3.1788e-03\t6.0724e+02\t   0.01114\n   400\t3.9439e-04\t2.3619e-03\t6.0541e+02\t   0.01090\n   500\t4.1880e-04\t1.8042e-03\t6.0420e+02\t   0.01092\n   600\t4.4276e-04\t1.5563e-03\t6.0327e+02\t   0.01098\n   700\t3.5451e-04\t1.2529e-03\t6.0248e+02\t   0.01114\n   800\t2.8326e-04\t1.2453e-03\t6.0187e+02\t   0.01262\n   900\t2.2144e-04\t1.0453e-03\t6.0142e+02\t   0.01667\n  1000\t1.7189e-04\t9.8240e-04\t6.0104e+02\t   0.01870\n  1100\t2.5006e-04\t1.6117e-03\t6.0060e+02\t   0.02041\n  1200\t1.6262e-04\t8.6427e-04\t6.0022e+02\t   0.02390\n  1300\t1.5678e-04\t7.2819e-04\t5.9991e+02\t   0.02604\n  1400\t1.4988e-04\t1.1668e-03\t5.9963e+02\t   0.02976\n  1500\t3.0002e-04\t1.6271e-03\t5.9927e+02\t   0.03425\n  1600\t2.1374e-04\t1.3682e-03\t5.9901e+02\t   0.04055\n  1700\t1.8387e-04\t9.8372e-04\t5.9878e+02\t   0.04655\n  1800\t1.2274e-04\t7.3430e-04\t5.9864e+02\t   0.05056\n  1900\t1.2808e-04\t7.3991e-04\t5.9844e+02\t   0.05459\n  2000\t1.0507e-04\t5.5665e-04\t5.9822e+02\t   0.05986\n  2100\t1.0122e-04\t5.9545e-04\t5.9805e+02\t   0.06360\n  2200\t7.7765e-05\t4.3631e-04\t5.9789e+02\t   0.06675\n  2300\t6.8538e-05\t3.6190e-04\t5.9779e+02\t   0.06986\n  2400\t4.5005e-05\t2.6327e-04\t5.9773e+02\t   0.07313\n  2500\t4.9658e-05\t3.0780e-04\t5.9768e+02\t   0.07640\n  2600\t3.4593e-05\t2.2912e-04\t5.9764e+02\t   0.08022\n  2700\t4.4137e-05\t2.8223e-04\t5.9759e+02\t   0.08401\n  2800\t9.8012e-05\t4.3392e-04\t5.9749e+02\t   0.08970\n  2900\t7.3388e-05\t3.0982e-04\t5.9743e+02\t   0.08717\n  3000\t5.1551e-05\t2.4986e-04\t5.9738e+02\t   0.07530\n  3100\t4.1783e-05\t2.8586e-04\t5.9734e+02\t   0.07525\n  3200\t3.8460e-05\t2.5535e-04\t5.9731e+02\t   0.07630\n  3300\t4.7788e-05\t4.2939e-04\t5.9727e+02\t   0.07898\n  3400\t4.1649e-05\t1.9139e-04\t5.9725e+02\t   0.07948\n  3500\t3.4884e-05\t1.8650e-04\t5.9722e+02\t   0.07985\n  3600\t4.3005e-05\t1.6895e-04\t5.9719e+02\t   0.08154\n  3700\t4.6715e-05\t1.6725e-04\t5.9715e+02\t   0.08338\n  3800\t3.4064e-05\t1.5116e-04\t5.9711e+02\t   0.08471\n  3900\t3.4675e-05\t1.6737e-04\t5.9709e+02\t   0.08635\n  4000\t2.7195e-05\t2.9254e-04\t5.9706e+02\t   0.08792\n  4100\t2.2151e-05\t1.6105e-04\t5.9704e+02\t   0.08961\n  4200\t1.9073e-05\t1.1778e-04\t5.9703e+02\t   0.09092\n  4300\t2.4661e-05\t1.2285e-04\t5.9701e+02\t   0.09233\n  4400\t2.4348e-05\t9.6858e-05\t5.9700e+02\t   0.09298\n  4500\t1.8656e-05\t7.8678e-05\t5.9700e+02\t   0.09346\n  4600\t2.7746e-05\t2.3198e-04\t5.9697e+02\t   0.09448\n  4700\t5.1215e-05\t3.3328e-04\t5.9691e+02\t   0.09553\n  4800\t3.1725e-05\t2.2525e-04\t5.9688e+02\t   0.09641\n  4900\t2.2836e-05\t1.5676e-04\t5.9686e+02\t   0.09729\n  5000\t2.1532e-05\t1.3620e-04\t5.9685e+02\t   0.09757\n  5100\t2.9176e-05\t1.3584e-04\t5.9684e+02\t   0.09838\n  5200\t3.8736e-05\t1.3852e-04\t5.9682e+02\t   0.09885\n  5300\t3.8072e-05\t1.2064e-04\t5.9681e+02\t   0.09973\n  5400\t3.0108e-05\t9.7394e-05\t5.9681e+02\t   0.10012\n  5500\t2.1681e-05\t8.1182e-05\t5.9680e+02\t   0.10153\n  5600\t2.3846e-05\t1.4779e-04\t5.9679e+02\t   0.10219\n  5700\t2.4244e-05\t1.5914e-04\t5.9678e+02\t   0.10259\n  5800\t1.8716e-05\t1.2057e-04\t5.9677e+02\t   0.10286\n  5900\t1.5788e-05\t8.9869e-05\t5.9676e+02\t   0.10322\n  6000\t1.6764e-05\t8.1718e-05\t5.9675e+02\t   0.10343\n  6100\t1.9893e-05\t1.2720e-04\t5.9674e+02\t   0.10417\n  6200\t4.7639e-05\t1.6403e-04\t5.9671e+02\t   0.10413\n  6300\t3.9786e-05\t1.4874e-04\t5.9670e+02\t   0.10451\n  6400\t2.8454e-05\t1.1134e-04\t5.9669e+02\t   0.10469\n  6500\t2.1398e-05\t1.1218e-04\t5.9669e+02\t   0.10558\n  6600\t2.2944e-05\t1.3828e-04\t5.9668e+02\t   0.10557\n  6700\t2.7187e-05\t1.5700e-04\t5.9667e+02\t   0.10566\n  6800\t2.9683e-05\t1.8024e-04\t5.9665e+02\t   0.10588\n  6900\t2.9683e-05\t1.6534e-04\t5.9665e+02\t   0.10649\n  7000\t2.5630e-05\t1.5831e-04\t5.9664e+02\t   0.10708\n  7100\t2.1935e-05\t1.4281e-04\t5.9664e+02\t   0.10753\n  7200\t1.9044e-05\t1.2743e-04\t5.9664e+02\t   0.10795\n  7300\t1.6563e-05\t1.1551e-04\t5.9663e+02\t   0.10821\n  7400\t2.0899e-05\t1.0800e-04\t5.9662e+02\t   0.10848\n  7500\t2.1543e-05\t1.0037e-04\t5.9662e+02\t   0.10893\n  7600\t1.8679e-05\t8.9169e-05\t5.9662e+02\t   0.10994\n  7700\t1.5087e-05\t7.7248e-05\t5.9661e+02\t   0.11038\n  7800\t1.2025e-05\t6.7592e-05\t5.9661e+02\t   0.11068\n  7900\t9.9614e-06\t6.0081e-05\t5.9661e+02\t   0.11107\n  8000\t1.1057e-05\t5.3525e-05\t5.9661e+02\t   0.11141\n  8100\t1.3798e-05\t4.9829e-05\t5.9661e+02\t   0.11187\n  8200\t1.3217e-05\t5.2810e-05\t5.9660e+02\t   0.11200\n  8300\t1.0297e-05\t4.3392e-05\t5.9660e+02\t   0.11205\n  8400\t9.8795e-06\t4.5002e-05\t5.9660e+02\t   0.11202\n  8500\t1.0192e-05\t4.9174e-05\t5.9660e+02\t   0.11210\n  8600\t9.7826e-06\t4.1559e-05\t5.9659e+02\t   0.11222\n  8700\t1.9178e-05\t5.4002e-05\t5.9659e+02\t   0.11238\n  8800\t2.6975e-05\t7.4863e-05\t5.9658e+02\t   0.11255\n  8900\t2.1780e-05\t6.9916e-05\t5.9658e+02\t   0.11277\n  9000\t1.4499e-05\t5.4181e-05\t5.9658e+02\t   0.11281\n  9100\t1.0202e-05\t4.6313e-05\t5.9657e+02\t   0.11295\n  9200\t7.8622e-06\t4.3124e-05\t5.9657e+02\t   0.11310\n  9300\t7.6145e-06\t4.0978e-05\t5.9657e+02\t   0.11293\n  9400\t7.5400e-06\t3.9369e-05\t5.9657e+02\t   0.11282\n  9500\t7.5549e-06\t3.7968e-05\t5.9657e+02\t   0.11296\n  9600\t7.5623e-06\t3.6806e-05\t5.9657e+02\t   0.11311\n  9700\t7.4953e-06\t3.5912e-05\t5.9657e+02\t   0.11326\n  9800\t7.3463e-06\t3.5286e-05\t5.9657e+02\t   0.11335\n  9900\t7.1824e-06\t3.4571e-05\t5.9657e+02\t   0.11347\n 10000\t7.0632e-06\t3.3557e-05\t5.9657e+02\t   0.11377\n 10100\t6.9663e-06\t3.2604e-05\t5.9656e+02\t   0.11394\n 10200\t6.8918e-06\t3.1471e-05\t5.9656e+02\t   0.11399\n 10300\t6.8918e-06\t3.0488e-05\t5.9656e+02\t   0.11419\n 10400\t6.8620e-06\t2.9415e-05\t5.9656e+02\t   0.11438\n 10500\t6.8843e-06\t2.8461e-05\t5.9656e+02\t   0.11458\n 10600\t6.8843e-06\t2.8372e-05\t5.9656e+02\t   0.11468\n 10700\t6.8694e-06\t2.8193e-05\t5.9656e+02\t   0.11465\n 10800\t6.8247e-06\t2.8133e-05\t5.9656e+02\t   0.11477\n 10900\t6.8694e-06\t2.7895e-05\t5.9656e+02\t   0.11484\n 11000\t6.9812e-06\t2.7537e-05\t5.9656e+02\t   0.11502\n 11100\t7.7821e-06\t3.1471e-05\t5.9656e+02\t   0.11497\n 11200\t6.8694e-06\t3.0637e-05\t5.9656e+02\t   0.11500\n 11300\t6.6012e-06\t2.7418e-05\t5.9656e+02\t   0.11519\n 11400\t6.3255e-06\t2.4199e-05\t5.9656e+02\t   0.11538\n 11500\t6.0573e-06\t2.3484e-05\t5.9656e+02\t   0.11573\n 11600\t5.8413e-06\t2.3127e-05\t5.9656e+02\t   0.11583\n 11700\t5.6699e-06\t2.2650e-05\t5.9656e+02\t   0.11626\n 11800\t5.5060e-06\t2.1935e-05\t5.9656e+02\t   0.11619\n 11900\t5.3868e-06\t2.1458e-05\t5.9656e+02\t   0.11684\n 12000\t5.2676e-06\t2.1219e-05\t5.9656e+02\t   0.11689\n 12100\t5.1260e-06\t2.0266e-05\t5.9656e+02\t   0.11692\n 12200\t5.0142e-06\t1.9789e-05\t5.9656e+02\t   0.11713\n 12300\t4.8652e-06\t1.9073e-05\t5.9656e+02\t   0.11729\n 12400\t4.7460e-06\t1.8954e-05\t5.9656e+02\t   0.11746\n 12500\t4.5896e-06\t1.8716e-05\t5.9656e+02\t   0.11765\n 12600\t4.4256e-06\t1.9014e-05\t5.9655e+02\t   0.11790\n 12700\t4.2915e-06\t2.0087e-05\t5.9655e+02\t   0.11785\n 12800\t4.2617e-06\t2.3007e-05\t5.9655e+02\t   0.11786\n 12900\t4.3511e-06\t2.8193e-05\t5.9655e+02\t   0.11789\n 13000\t6.5118e-06\t3.3557e-05\t5.9655e+02\t   0.11798\n 13100\t7.5474e-06\t3.4571e-05\t5.9655e+02\t   0.11790\n 13200\t6.9216e-06\t2.9802e-05\t5.9655e+02\t   0.11833\n 13300\t5.5954e-06\t2.4319e-05\t5.9655e+02\t   0.11840\n 13400\t4.6492e-06\t2.4319e-05\t5.9655e+02\t   0.11853\n 13500\t4.0159e-06\t2.1696e-05\t5.9655e+02\t   0.11857\n 13600\t3.5167e-06\t1.8239e-05\t5.9655e+02\t   0.11888\n 13700\t3.0920e-06\t1.4901e-05\t5.9655e+02\t   0.11885\n 13800\t3.3453e-06\t1.4067e-05\t5.9655e+02\t   0.11885\n 13900\t4.5449e-06\t1.6809e-05\t5.9655e+02\t   0.11894\n 14000\t6.7577e-06\t2.3514e-05\t5.9655e+02\t   0.11889\n 14100\t9.2164e-06\t3.6329e-05\t5.9655e+02\t   0.11910\n 14200\t1.0073e-05\t4.3869e-05\t5.9655e+02\t   0.11961\n 14300\t9.0972e-06\t4.1485e-05\t5.9654e+02\t   0.11928\n 14400\t7.5996e-06\t3.3975e-05\t5.9654e+02\t   0.11937\n 14500\t6.3628e-06\t2.6256e-05\t5.9654e+02\t   0.11935\n 14600\t5.5134e-06\t2.3186e-05\t5.9654e+02\t   0.11954\n 14700\t4.9621e-06\t2.1219e-05\t5.9654e+02\t   0.11942\n 14800\t4.5896e-06\t1.9193e-05\t5.9654e+02\t   0.11936\n 14900\t4.3288e-06\t1.7226e-05\t5.9654e+02\t   0.11960\n 15000\t4.1202e-06\t1.5795e-05\t5.9654e+02\t   0.11997\n 15100\t3.9935e-06\t1.5080e-05\t5.9654e+02\t   0.12017\n 15200\t3.8892e-06\t1.5736e-05\t5.9654e+02\t   0.11988\n 15300\t3.9041e-06\t2.2531e-05\t5.9654e+02\t   0.11988\n 15400\t4.3400e-06\t2.4796e-05\t5.9654e+02\t   0.12006\n 15500\t4.5411e-06\t2.6137e-05\t5.9654e+02\t   0.11990\n 15600\t6.9439e-06\t2.4915e-05\t5.9654e+02\t   0.12012\n 15700\t8.5682e-06\t3.0041e-05\t5.9654e+02\t   0.12033\n 15800\t7.8678e-06\t3.0041e-05\t5.9654e+02\t   0.12036\n 15900\t5.6922e-06\t2.5153e-05\t5.9654e+02\t   0.12058\n 16000\t3.7998e-06\t2.0012e-05\t5.9654e+02\t   0.12034\n 16100\t3.0920e-06\t1.5691e-05\t5.9654e+02\t   0.12077\n 16200\t3.0026e-06\t1.3232e-05\t5.9654e+02\t   0.12044\n 16300\t2.9281e-06\t1.2577e-05\t5.9654e+02\t   0.12046\n 16400\t2.8387e-06\t1.1802e-05\t5.9654e+02\t   0.12043\n 16500\t2.7418e-06\t1.1265e-05\t5.9654e+02\t   0.12038\n 16600\t2.6599e-06\t1.1086e-05\t5.9654e+02\t   0.12047\n 16700\t2.5854e-06\t1.0669e-05\t5.9653e+02\t   0.12062\n 16800\t2.4885e-06\t1.0252e-05\t5.9653e+02\t   0.12049\n 16900\t2.4214e-06\t9.9540e-06\t5.9653e+02\t   0.12048\n--------------------------------------------------------------------------------\n</code></pre>\n<p>Both several times slower towards the end. This also happens when the size of the data is larger.</p>", "body_text": "Hi, I implemented a classical multiplicative NMF algorithm with PyTorch, but it slows down after iterations on CPU. It is significant for single precision, and it also happens for double precision.\nIt is basically a sequence of matrix multiplications, and of course the most time-consuming part is where the dense data matrix is an operand (can also be confirmed by profiling). The thing is, that particular multiplication step is getting slower. The same also happens when I use the argument out= in torch.mm. Memory usage was not increased over time. The same happens whatever I set the values to OMP_NUM_THREADS or MKL_NUM_THREADS.\nThe version I'm running is 0.4.0a0+059299b, compiled from source on Ubuntu 16.04. It is tested on two different systems (Intel\u00ae Xeon\u00ae CPU E5-2680 v2 and Intel\u00ae Xeon\u00ae CPU E5-2650 v4).\nimport torch\nimport time\nclass NMF():\n    def __init__(self, data, r, TType=torch.DoubleTensor):\n        \"\"\"\n        data: a Tensor.\n        r: a small integer\n        \"\"\"\n        self.TType = TType\n\n        self.p, self.q = data.shape\n        self.r = r\n        p, q = self.p, self.q\n        assert self.r<=self.p and self.r<=self.q\n\n        # initialize V and W\n        self.V_prev = TType(p, r)\n        self.W_prev = TType(q, r).t() \n\n        self.V = TType(p, r).uniform_()\n        self.W = TType(q, r).uniform_().t()\n\n        self.data = data\n\n    def update_V(self):\n        XWt =  torch.mm(self.data, self.W.t()) # this line gets slower over iterations\n        WWt =  torch.mm(self.W, self.W.t())\n        VWWt = torch.mm(self.V, WWt)\n        self.V = self.V.mul_(XWt).div_(VWWt)\n    def update_W(self):\n        VtX  = torch.mm(self.V.t(), self.data) # this line gets slower over iterations\n        VtV  = torch.mm(self.V.t(), self.V)\n        VtVW = torch.mm(VtV, self.W)\n        self.W = self.W.mul_(VtX).div_(VtVW)\n    def get_objective(self):\n        outer = torch.mm(self.V, self.W)\n        val = torch.sum(((self.data - outer)**2))\n        return val\n    def check_convergence(self,tol, verbose=True, check_obj=False):\n        obj = None\n        diff_norm_1 = torch.max(torch.abs(self.V_prev-self.V))\n        diff_norm_2 = torch.max(torch.abs(self.W_prev-self.W))\n        if check_obj:\n            obj = self.get_objective()\n        converged = diff_norm_1 < tol and diff_norm_2 < tol\n        return (diff_norm_1, diff_norm_2, obj), converged\n    def run(self, maxiter=100, tol=1e-5, check_interval=1, verbose=True, check_obj=False):\n        if verbose:\n            print(\"Starting...\")\n            print(\"p={}, q={}, r={}\".format(self.p, self.q, self.r))\n            if not check_obj:\n                print(\"%6s\\t%10s\\t%10s\\t%10s\" % (\"iter\", \"V_maxdiff\", \"W_maxdiff\", \"time\"))\n            else:\n                print(\"%6s\\t%10s\\t%10s\\t%10s\\t%10s\" % (\"iter\", \"V_maxdiff\", \"W_maxdiff\", \"obj\", \"time\" ))\n            print('-'*80)\n\n        t0 = time.time()\n        t_start = t0\n\n        for i in range(maxiter):\n            self.V_prev.copy_(self.V)\n            self.W_prev.copy_(self.W)\n\n            self.update_V()\n            self.update_W()\n            if (i+1) % check_interval ==0:\n                t1 = time.time()\n                (v_maxdiff, w_maxdiff, obj), converged = self.check_convergence(tol, verbose, check_obj)\n                if verbose:\n                    if not check_obj:\n                        print(\"%6d\\t%10.4e\\t%10.4e\\t%10.5f\" % (i+1, v_maxdiff, w_maxdiff, t1-t0))\n                    else:\n                        print(\"%6d\\t%10.4e\\t%10.4e\\t%10.4e\\t%10.5f\" % (i+1, v_maxdiff, w_maxdiff,\n                                                                            obj, t1-t0))\n                if converged: break\n                t0 = t1\n\n        if verbose:\n            print('-'*80)\n            print(\"Completed. total time: {}\".format(time.time()-t_start))\nif __name__=='__main__':\n    torch.manual_seed(95376)\n    TType=torch.FloatTensor # or torch.DoubleTensor\n    m = TType(100, 100).uniform_() # this is an example.\n    nmf_driver = NMF(m, 10, TType)\n    nmf_driver.run(100000, check_interval=100, check_obj=True) \nFor single precision, the output on one of the machines was:\nStarting...\np=100, q=100, r=10\n  iter\t V_maxdiff\t W_maxdiff\t       obj\t      time\n--------------------------------------------------------------------------------\n   100\t1.3119e-03\t6.6189e-03\t6.2078e+02\t   0.01510\n   200\t6.5940e-04\t3.3028e-03\t6.1045e+02\t   0.01169\n   300\t4.3547e-04\t3.1788e-03\t6.0724e+02\t   0.01114\n   400\t3.9439e-04\t2.3619e-03\t6.0541e+02\t   0.01090\n   500\t4.1880e-04\t1.8042e-03\t6.0420e+02\t   0.01092\n   600\t4.4276e-04\t1.5563e-03\t6.0327e+02\t   0.01098\n   700\t3.5451e-04\t1.2529e-03\t6.0248e+02\t   0.01114\n   800\t2.8326e-04\t1.2453e-03\t6.0187e+02\t   0.01262\n   900\t2.2144e-04\t1.0453e-03\t6.0142e+02\t   0.01667\n  1000\t1.7189e-04\t9.8240e-04\t6.0104e+02\t   0.01870\n  1100\t2.5006e-04\t1.6117e-03\t6.0060e+02\t   0.02041\n  1200\t1.6262e-04\t8.6427e-04\t6.0022e+02\t   0.02390\n  1300\t1.5678e-04\t7.2819e-04\t5.9991e+02\t   0.02604\n  1400\t1.4988e-04\t1.1668e-03\t5.9963e+02\t   0.02976\n  1500\t3.0002e-04\t1.6271e-03\t5.9927e+02\t   0.03425\n  1600\t2.1374e-04\t1.3682e-03\t5.9901e+02\t   0.04055\n  1700\t1.8387e-04\t9.8372e-04\t5.9878e+02\t   0.04655\n  1800\t1.2274e-04\t7.3430e-04\t5.9864e+02\t   0.05056\n  1900\t1.2808e-04\t7.3991e-04\t5.9844e+02\t   0.05459\n  2000\t1.0507e-04\t5.5665e-04\t5.9822e+02\t   0.05986\n  2100\t1.0122e-04\t5.9545e-04\t5.9805e+02\t   0.06360\n  2200\t7.7765e-05\t4.3631e-04\t5.9789e+02\t   0.06675\n  2300\t6.8538e-05\t3.6190e-04\t5.9779e+02\t   0.06986\n  2400\t4.5005e-05\t2.6327e-04\t5.9773e+02\t   0.07313\n  2500\t4.9658e-05\t3.0780e-04\t5.9768e+02\t   0.07640\n  2600\t3.4593e-05\t2.2912e-04\t5.9764e+02\t   0.08022\n  2700\t4.4137e-05\t2.8223e-04\t5.9759e+02\t   0.08401\n  2800\t9.8012e-05\t4.3392e-04\t5.9749e+02\t   0.08970\n  2900\t7.3388e-05\t3.0982e-04\t5.9743e+02\t   0.08717\n  3000\t5.1551e-05\t2.4986e-04\t5.9738e+02\t   0.07530\n  3100\t4.1783e-05\t2.8586e-04\t5.9734e+02\t   0.07525\n  3200\t3.8460e-05\t2.5535e-04\t5.9731e+02\t   0.07630\n  3300\t4.7788e-05\t4.2939e-04\t5.9727e+02\t   0.07898\n  3400\t4.1649e-05\t1.9139e-04\t5.9725e+02\t   0.07948\n  3500\t3.4884e-05\t1.8650e-04\t5.9722e+02\t   0.07985\n  3600\t4.3005e-05\t1.6895e-04\t5.9719e+02\t   0.08154\n  3700\t4.6715e-05\t1.6725e-04\t5.9715e+02\t   0.08338\n  3800\t3.4064e-05\t1.5116e-04\t5.9711e+02\t   0.08471\n  3900\t3.4675e-05\t1.6737e-04\t5.9709e+02\t   0.08635\n  4000\t2.7195e-05\t2.9254e-04\t5.9706e+02\t   0.08792\n  4100\t2.2151e-05\t1.6105e-04\t5.9704e+02\t   0.08961\n  4200\t1.9073e-05\t1.1778e-04\t5.9703e+02\t   0.09092\n  4300\t2.4661e-05\t1.2285e-04\t5.9701e+02\t   0.09233\n  4400\t2.4348e-05\t9.6858e-05\t5.9700e+02\t   0.09298\n  4500\t1.8656e-05\t7.8678e-05\t5.9700e+02\t   0.09346\n  4600\t2.7746e-05\t2.3198e-04\t5.9697e+02\t   0.09448\n  4700\t5.1215e-05\t3.3328e-04\t5.9691e+02\t   0.09553\n  4800\t3.1725e-05\t2.2525e-04\t5.9688e+02\t   0.09641\n  4900\t2.2836e-05\t1.5676e-04\t5.9686e+02\t   0.09729\n  5000\t2.1532e-05\t1.3620e-04\t5.9685e+02\t   0.09757\n  5100\t2.9176e-05\t1.3584e-04\t5.9684e+02\t   0.09838\n  5200\t3.8736e-05\t1.3852e-04\t5.9682e+02\t   0.09885\n  5300\t3.8072e-05\t1.2064e-04\t5.9681e+02\t   0.09973\n  5400\t3.0108e-05\t9.7394e-05\t5.9681e+02\t   0.10012\n  5500\t2.1681e-05\t8.1182e-05\t5.9680e+02\t   0.10153\n  5600\t2.3846e-05\t1.4779e-04\t5.9679e+02\t   0.10219\n  5700\t2.4244e-05\t1.5914e-04\t5.9678e+02\t   0.10259\n  5800\t1.8716e-05\t1.2057e-04\t5.9677e+02\t   0.10286\n  5900\t1.5788e-05\t8.9869e-05\t5.9676e+02\t   0.10322\n  6000\t1.6764e-05\t8.1718e-05\t5.9675e+02\t   0.10343\n  6100\t1.9893e-05\t1.2720e-04\t5.9674e+02\t   0.10417\n  6200\t4.7639e-05\t1.6403e-04\t5.9671e+02\t   0.10413\n  6300\t3.9786e-05\t1.4874e-04\t5.9670e+02\t   0.10451\n  6400\t2.8454e-05\t1.1134e-04\t5.9669e+02\t   0.10469\n  6500\t2.1398e-05\t1.1218e-04\t5.9669e+02\t   0.10558\n  6600\t2.2944e-05\t1.3828e-04\t5.9668e+02\t   0.10557\n  6700\t2.7187e-05\t1.5700e-04\t5.9667e+02\t   0.10566\n  6800\t2.9683e-05\t1.8024e-04\t5.9665e+02\t   0.10588\n  6900\t2.9683e-05\t1.6534e-04\t5.9665e+02\t   0.10649\n  7000\t2.5630e-05\t1.5831e-04\t5.9664e+02\t   0.10708\n  7100\t2.1935e-05\t1.4281e-04\t5.9664e+02\t   0.10753\n  7200\t1.9044e-05\t1.2743e-04\t5.9664e+02\t   0.10795\n  7300\t1.6563e-05\t1.1551e-04\t5.9663e+02\t   0.10821\n  7400\t2.0899e-05\t1.0800e-04\t5.9662e+02\t   0.10848\n  7500\t2.1543e-05\t1.0037e-04\t5.9662e+02\t   0.10893\n  7600\t1.8679e-05\t8.9169e-05\t5.9662e+02\t   0.10994\n  7700\t1.5087e-05\t7.7248e-05\t5.9661e+02\t   0.11038\n  7800\t1.2025e-05\t6.7592e-05\t5.9661e+02\t   0.11068\n  7900\t9.9614e-06\t6.0081e-05\t5.9661e+02\t   0.11107\n  8000\t1.1057e-05\t5.3525e-05\t5.9661e+02\t   0.11141\n  8100\t1.3798e-05\t4.9829e-05\t5.9661e+02\t   0.11187\n  8200\t1.3217e-05\t5.2810e-05\t5.9660e+02\t   0.11200\n  8300\t1.0297e-05\t4.3392e-05\t5.9660e+02\t   0.11205\n  8400\t9.8795e-06\t4.5002e-05\t5.9660e+02\t   0.11202\n  8500\t1.0192e-05\t4.9174e-05\t5.9660e+02\t   0.11210\n  8600\t9.7826e-06\t4.1559e-05\t5.9659e+02\t   0.11222\n  8700\t1.9178e-05\t5.4002e-05\t5.9659e+02\t   0.11238\n  8800\t2.6975e-05\t7.4863e-05\t5.9658e+02\t   0.11255\n  8900\t2.1780e-05\t6.9916e-05\t5.9658e+02\t   0.11277\n  9000\t1.4499e-05\t5.4181e-05\t5.9658e+02\t   0.11281\n  9100\t1.0202e-05\t4.6313e-05\t5.9657e+02\t   0.11295\n  9200\t7.8622e-06\t4.3124e-05\t5.9657e+02\t   0.11310\n  9300\t7.6145e-06\t4.0978e-05\t5.9657e+02\t   0.11293\n  9400\t7.5400e-06\t3.9369e-05\t5.9657e+02\t   0.11282\n  9500\t7.5549e-06\t3.7968e-05\t5.9657e+02\t   0.11296\n  9600\t7.5623e-06\t3.6806e-05\t5.9657e+02\t   0.11311\n  9700\t7.4953e-06\t3.5912e-05\t5.9657e+02\t   0.11326\n  9800\t7.3463e-06\t3.5286e-05\t5.9657e+02\t   0.11335\n  9900\t7.1824e-06\t3.4571e-05\t5.9657e+02\t   0.11347\n 10000\t7.0632e-06\t3.3557e-05\t5.9657e+02\t   0.11377\n 10100\t6.9663e-06\t3.2604e-05\t5.9656e+02\t   0.11394\n 10200\t6.8918e-06\t3.1471e-05\t5.9656e+02\t   0.11399\n 10300\t6.8918e-06\t3.0488e-05\t5.9656e+02\t   0.11419\n 10400\t6.8620e-06\t2.9415e-05\t5.9656e+02\t   0.11438\n 10500\t6.8843e-06\t2.8461e-05\t5.9656e+02\t   0.11458\n 10600\t6.8843e-06\t2.8372e-05\t5.9656e+02\t   0.11468\n 10700\t6.8694e-06\t2.8193e-05\t5.9656e+02\t   0.11465\n 10800\t6.8247e-06\t2.8133e-05\t5.9656e+02\t   0.11477\n 10900\t6.8694e-06\t2.7895e-05\t5.9656e+02\t   0.11484\n 11000\t6.9812e-06\t2.7537e-05\t5.9656e+02\t   0.11502\n 11100\t7.7821e-06\t3.1471e-05\t5.9656e+02\t   0.11497\n 11200\t6.8694e-06\t3.0637e-05\t5.9656e+02\t   0.11500\n 11300\t6.6012e-06\t2.7418e-05\t5.9656e+02\t   0.11519\n 11400\t6.3255e-06\t2.4199e-05\t5.9656e+02\t   0.11538\n 11500\t6.0573e-06\t2.3484e-05\t5.9656e+02\t   0.11573\n 11600\t5.8413e-06\t2.3127e-05\t5.9656e+02\t   0.11583\n 11700\t5.6699e-06\t2.2650e-05\t5.9656e+02\t   0.11626\n 11800\t5.5060e-06\t2.1935e-05\t5.9656e+02\t   0.11619\n 11900\t5.3868e-06\t2.1458e-05\t5.9656e+02\t   0.11684\n 12000\t5.2676e-06\t2.1219e-05\t5.9656e+02\t   0.11689\n 12100\t5.1260e-06\t2.0266e-05\t5.9656e+02\t   0.11692\n 12200\t5.0142e-06\t1.9789e-05\t5.9656e+02\t   0.11713\n 12300\t4.8652e-06\t1.9073e-05\t5.9656e+02\t   0.11729\n 12400\t4.7460e-06\t1.8954e-05\t5.9656e+02\t   0.11746\n 12500\t4.5896e-06\t1.8716e-05\t5.9656e+02\t   0.11765\n 12600\t4.4256e-06\t1.9014e-05\t5.9655e+02\t   0.11790\n 12700\t4.2915e-06\t2.0087e-05\t5.9655e+02\t   0.11785\n 12800\t4.2617e-06\t2.3007e-05\t5.9655e+02\t   0.11786\n 12900\t4.3511e-06\t2.8193e-05\t5.9655e+02\t   0.11789\n 13000\t6.5118e-06\t3.3557e-05\t5.9655e+02\t   0.11798\n 13100\t7.5474e-06\t3.4571e-05\t5.9655e+02\t   0.11790\n 13200\t6.9216e-06\t2.9802e-05\t5.9655e+02\t   0.11833\n 13300\t5.5954e-06\t2.4319e-05\t5.9655e+02\t   0.11840\n 13400\t4.6492e-06\t2.4319e-05\t5.9655e+02\t   0.11853\n 13500\t4.0159e-06\t2.1696e-05\t5.9655e+02\t   0.11857\n 13600\t3.5167e-06\t1.8239e-05\t5.9655e+02\t   0.11888\n 13700\t3.0920e-06\t1.4901e-05\t5.9655e+02\t   0.11885\n 13800\t3.3453e-06\t1.4067e-05\t5.9655e+02\t   0.11885\n 13900\t4.5449e-06\t1.6809e-05\t5.9655e+02\t   0.11894\n 14000\t6.7577e-06\t2.3514e-05\t5.9655e+02\t   0.11889\n 14100\t9.2164e-06\t3.6329e-05\t5.9655e+02\t   0.11910\n 14200\t1.0073e-05\t4.3869e-05\t5.9655e+02\t   0.11961\n 14300\t9.0972e-06\t4.1485e-05\t5.9654e+02\t   0.11928\n 14400\t7.5996e-06\t3.3975e-05\t5.9654e+02\t   0.11937\n 14500\t6.3628e-06\t2.6256e-05\t5.9654e+02\t   0.11935\n 14600\t5.5134e-06\t2.3186e-05\t5.9654e+02\t   0.11954\n 14700\t4.9621e-06\t2.1219e-05\t5.9654e+02\t   0.11942\n 14800\t4.5896e-06\t1.9193e-05\t5.9654e+02\t   0.11936\n 14900\t4.3288e-06\t1.7226e-05\t5.9654e+02\t   0.11960\n 15000\t4.1202e-06\t1.5795e-05\t5.9654e+02\t   0.11997\n 15100\t3.9935e-06\t1.5080e-05\t5.9654e+02\t   0.12017\n 15200\t3.8892e-06\t1.5736e-05\t5.9654e+02\t   0.11988\n 15300\t3.9041e-06\t2.2531e-05\t5.9654e+02\t   0.11988\n 15400\t4.3400e-06\t2.4796e-05\t5.9654e+02\t   0.12006\n 15500\t4.5411e-06\t2.6137e-05\t5.9654e+02\t   0.11990\n 15600\t6.9439e-06\t2.4915e-05\t5.9654e+02\t   0.12012\n 15700\t8.5682e-06\t3.0041e-05\t5.9654e+02\t   0.12033\n 15800\t7.8678e-06\t3.0041e-05\t5.9654e+02\t   0.12036\n 15900\t5.6922e-06\t2.5153e-05\t5.9654e+02\t   0.12058\n 16000\t3.7998e-06\t2.0012e-05\t5.9654e+02\t   0.12034\n 16100\t3.0920e-06\t1.5691e-05\t5.9654e+02\t   0.12077\n 16200\t3.0026e-06\t1.3232e-05\t5.9654e+02\t   0.12044\n 16300\t2.9281e-06\t1.2577e-05\t5.9654e+02\t   0.12046\n 16400\t2.8387e-06\t1.1802e-05\t5.9654e+02\t   0.12043\n 16500\t2.7418e-06\t1.1265e-05\t5.9654e+02\t   0.12038\n 16600\t2.6599e-06\t1.1086e-05\t5.9654e+02\t   0.12047\n 16700\t2.5854e-06\t1.0669e-05\t5.9653e+02\t   0.12062\n 16800\t2.4885e-06\t1.0252e-05\t5.9653e+02\t   0.12049\n 16900\t2.4214e-06\t9.9540e-06\t5.9653e+02\t   0.12048\n--------------------------------------------------------------------------------\n\nand for double precision:\nStarting...\np=100, q=100, r=10\n  iter\t V_maxdiff\t W_maxdiff\t       obj\t      time\n--------------------------------------------------------------------------------\n   100\t1.3119e-03\t6.6189e-03\t6.2078e+02\t   0.01510\n   200\t6.5940e-04\t3.3028e-03\t6.1045e+02\t   0.01169\n   300\t4.3547e-04\t3.1788e-03\t6.0724e+02\t   0.01114\n   400\t3.9439e-04\t2.3619e-03\t6.0541e+02\t   0.01090\n   500\t4.1880e-04\t1.8042e-03\t6.0420e+02\t   0.01092\n   600\t4.4276e-04\t1.5563e-03\t6.0327e+02\t   0.01098\n   700\t3.5451e-04\t1.2529e-03\t6.0248e+02\t   0.01114\n   800\t2.8326e-04\t1.2453e-03\t6.0187e+02\t   0.01262\n   900\t2.2144e-04\t1.0453e-03\t6.0142e+02\t   0.01667\n  1000\t1.7189e-04\t9.8240e-04\t6.0104e+02\t   0.01870\n  1100\t2.5006e-04\t1.6117e-03\t6.0060e+02\t   0.02041\n  1200\t1.6262e-04\t8.6427e-04\t6.0022e+02\t   0.02390\n  1300\t1.5678e-04\t7.2819e-04\t5.9991e+02\t   0.02604\n  1400\t1.4988e-04\t1.1668e-03\t5.9963e+02\t   0.02976\n  1500\t3.0002e-04\t1.6271e-03\t5.9927e+02\t   0.03425\n  1600\t2.1374e-04\t1.3682e-03\t5.9901e+02\t   0.04055\n  1700\t1.8387e-04\t9.8372e-04\t5.9878e+02\t   0.04655\n  1800\t1.2274e-04\t7.3430e-04\t5.9864e+02\t   0.05056\n  1900\t1.2808e-04\t7.3991e-04\t5.9844e+02\t   0.05459\n  2000\t1.0507e-04\t5.5665e-04\t5.9822e+02\t   0.05986\n  2100\t1.0122e-04\t5.9545e-04\t5.9805e+02\t   0.06360\n  2200\t7.7765e-05\t4.3631e-04\t5.9789e+02\t   0.06675\n  2300\t6.8538e-05\t3.6190e-04\t5.9779e+02\t   0.06986\n  2400\t4.5005e-05\t2.6327e-04\t5.9773e+02\t   0.07313\n  2500\t4.9658e-05\t3.0780e-04\t5.9768e+02\t   0.07640\n  2600\t3.4593e-05\t2.2912e-04\t5.9764e+02\t   0.08022\n  2700\t4.4137e-05\t2.8223e-04\t5.9759e+02\t   0.08401\n  2800\t9.8012e-05\t4.3392e-04\t5.9749e+02\t   0.08970\n  2900\t7.3388e-05\t3.0982e-04\t5.9743e+02\t   0.08717\n  3000\t5.1551e-05\t2.4986e-04\t5.9738e+02\t   0.07530\n  3100\t4.1783e-05\t2.8586e-04\t5.9734e+02\t   0.07525\n  3200\t3.8460e-05\t2.5535e-04\t5.9731e+02\t   0.07630\n  3300\t4.7788e-05\t4.2939e-04\t5.9727e+02\t   0.07898\n  3400\t4.1649e-05\t1.9139e-04\t5.9725e+02\t   0.07948\n  3500\t3.4884e-05\t1.8650e-04\t5.9722e+02\t   0.07985\n  3600\t4.3005e-05\t1.6895e-04\t5.9719e+02\t   0.08154\n  3700\t4.6715e-05\t1.6725e-04\t5.9715e+02\t   0.08338\n  3800\t3.4064e-05\t1.5116e-04\t5.9711e+02\t   0.08471\n  3900\t3.4675e-05\t1.6737e-04\t5.9709e+02\t   0.08635\n  4000\t2.7195e-05\t2.9254e-04\t5.9706e+02\t   0.08792\n  4100\t2.2151e-05\t1.6105e-04\t5.9704e+02\t   0.08961\n  4200\t1.9073e-05\t1.1778e-04\t5.9703e+02\t   0.09092\n  4300\t2.4661e-05\t1.2285e-04\t5.9701e+02\t   0.09233\n  4400\t2.4348e-05\t9.6858e-05\t5.9700e+02\t   0.09298\n  4500\t1.8656e-05\t7.8678e-05\t5.9700e+02\t   0.09346\n  4600\t2.7746e-05\t2.3198e-04\t5.9697e+02\t   0.09448\n  4700\t5.1215e-05\t3.3328e-04\t5.9691e+02\t   0.09553\n  4800\t3.1725e-05\t2.2525e-04\t5.9688e+02\t   0.09641\n  4900\t2.2836e-05\t1.5676e-04\t5.9686e+02\t   0.09729\n  5000\t2.1532e-05\t1.3620e-04\t5.9685e+02\t   0.09757\n  5100\t2.9176e-05\t1.3584e-04\t5.9684e+02\t   0.09838\n  5200\t3.8736e-05\t1.3852e-04\t5.9682e+02\t   0.09885\n  5300\t3.8072e-05\t1.2064e-04\t5.9681e+02\t   0.09973\n  5400\t3.0108e-05\t9.7394e-05\t5.9681e+02\t   0.10012\n  5500\t2.1681e-05\t8.1182e-05\t5.9680e+02\t   0.10153\n  5600\t2.3846e-05\t1.4779e-04\t5.9679e+02\t   0.10219\n  5700\t2.4244e-05\t1.5914e-04\t5.9678e+02\t   0.10259\n  5800\t1.8716e-05\t1.2057e-04\t5.9677e+02\t   0.10286\n  5900\t1.5788e-05\t8.9869e-05\t5.9676e+02\t   0.10322\n  6000\t1.6764e-05\t8.1718e-05\t5.9675e+02\t   0.10343\n  6100\t1.9893e-05\t1.2720e-04\t5.9674e+02\t   0.10417\n  6200\t4.7639e-05\t1.6403e-04\t5.9671e+02\t   0.10413\n  6300\t3.9786e-05\t1.4874e-04\t5.9670e+02\t   0.10451\n  6400\t2.8454e-05\t1.1134e-04\t5.9669e+02\t   0.10469\n  6500\t2.1398e-05\t1.1218e-04\t5.9669e+02\t   0.10558\n  6600\t2.2944e-05\t1.3828e-04\t5.9668e+02\t   0.10557\n  6700\t2.7187e-05\t1.5700e-04\t5.9667e+02\t   0.10566\n  6800\t2.9683e-05\t1.8024e-04\t5.9665e+02\t   0.10588\n  6900\t2.9683e-05\t1.6534e-04\t5.9665e+02\t   0.10649\n  7000\t2.5630e-05\t1.5831e-04\t5.9664e+02\t   0.10708\n  7100\t2.1935e-05\t1.4281e-04\t5.9664e+02\t   0.10753\n  7200\t1.9044e-05\t1.2743e-04\t5.9664e+02\t   0.10795\n  7300\t1.6563e-05\t1.1551e-04\t5.9663e+02\t   0.10821\n  7400\t2.0899e-05\t1.0800e-04\t5.9662e+02\t   0.10848\n  7500\t2.1543e-05\t1.0037e-04\t5.9662e+02\t   0.10893\n  7600\t1.8679e-05\t8.9169e-05\t5.9662e+02\t   0.10994\n  7700\t1.5087e-05\t7.7248e-05\t5.9661e+02\t   0.11038\n  7800\t1.2025e-05\t6.7592e-05\t5.9661e+02\t   0.11068\n  7900\t9.9614e-06\t6.0081e-05\t5.9661e+02\t   0.11107\n  8000\t1.1057e-05\t5.3525e-05\t5.9661e+02\t   0.11141\n  8100\t1.3798e-05\t4.9829e-05\t5.9661e+02\t   0.11187\n  8200\t1.3217e-05\t5.2810e-05\t5.9660e+02\t   0.11200\n  8300\t1.0297e-05\t4.3392e-05\t5.9660e+02\t   0.11205\n  8400\t9.8795e-06\t4.5002e-05\t5.9660e+02\t   0.11202\n  8500\t1.0192e-05\t4.9174e-05\t5.9660e+02\t   0.11210\n  8600\t9.7826e-06\t4.1559e-05\t5.9659e+02\t   0.11222\n  8700\t1.9178e-05\t5.4002e-05\t5.9659e+02\t   0.11238\n  8800\t2.6975e-05\t7.4863e-05\t5.9658e+02\t   0.11255\n  8900\t2.1780e-05\t6.9916e-05\t5.9658e+02\t   0.11277\n  9000\t1.4499e-05\t5.4181e-05\t5.9658e+02\t   0.11281\n  9100\t1.0202e-05\t4.6313e-05\t5.9657e+02\t   0.11295\n  9200\t7.8622e-06\t4.3124e-05\t5.9657e+02\t   0.11310\n  9300\t7.6145e-06\t4.0978e-05\t5.9657e+02\t   0.11293\n  9400\t7.5400e-06\t3.9369e-05\t5.9657e+02\t   0.11282\n  9500\t7.5549e-06\t3.7968e-05\t5.9657e+02\t   0.11296\n  9600\t7.5623e-06\t3.6806e-05\t5.9657e+02\t   0.11311\n  9700\t7.4953e-06\t3.5912e-05\t5.9657e+02\t   0.11326\n  9800\t7.3463e-06\t3.5286e-05\t5.9657e+02\t   0.11335\n  9900\t7.1824e-06\t3.4571e-05\t5.9657e+02\t   0.11347\n 10000\t7.0632e-06\t3.3557e-05\t5.9657e+02\t   0.11377\n 10100\t6.9663e-06\t3.2604e-05\t5.9656e+02\t   0.11394\n 10200\t6.8918e-06\t3.1471e-05\t5.9656e+02\t   0.11399\n 10300\t6.8918e-06\t3.0488e-05\t5.9656e+02\t   0.11419\n 10400\t6.8620e-06\t2.9415e-05\t5.9656e+02\t   0.11438\n 10500\t6.8843e-06\t2.8461e-05\t5.9656e+02\t   0.11458\n 10600\t6.8843e-06\t2.8372e-05\t5.9656e+02\t   0.11468\n 10700\t6.8694e-06\t2.8193e-05\t5.9656e+02\t   0.11465\n 10800\t6.8247e-06\t2.8133e-05\t5.9656e+02\t   0.11477\n 10900\t6.8694e-06\t2.7895e-05\t5.9656e+02\t   0.11484\n 11000\t6.9812e-06\t2.7537e-05\t5.9656e+02\t   0.11502\n 11100\t7.7821e-06\t3.1471e-05\t5.9656e+02\t   0.11497\n 11200\t6.8694e-06\t3.0637e-05\t5.9656e+02\t   0.11500\n 11300\t6.6012e-06\t2.7418e-05\t5.9656e+02\t   0.11519\n 11400\t6.3255e-06\t2.4199e-05\t5.9656e+02\t   0.11538\n 11500\t6.0573e-06\t2.3484e-05\t5.9656e+02\t   0.11573\n 11600\t5.8413e-06\t2.3127e-05\t5.9656e+02\t   0.11583\n 11700\t5.6699e-06\t2.2650e-05\t5.9656e+02\t   0.11626\n 11800\t5.5060e-06\t2.1935e-05\t5.9656e+02\t   0.11619\n 11900\t5.3868e-06\t2.1458e-05\t5.9656e+02\t   0.11684\n 12000\t5.2676e-06\t2.1219e-05\t5.9656e+02\t   0.11689\n 12100\t5.1260e-06\t2.0266e-05\t5.9656e+02\t   0.11692\n 12200\t5.0142e-06\t1.9789e-05\t5.9656e+02\t   0.11713\n 12300\t4.8652e-06\t1.9073e-05\t5.9656e+02\t   0.11729\n 12400\t4.7460e-06\t1.8954e-05\t5.9656e+02\t   0.11746\n 12500\t4.5896e-06\t1.8716e-05\t5.9656e+02\t   0.11765\n 12600\t4.4256e-06\t1.9014e-05\t5.9655e+02\t   0.11790\n 12700\t4.2915e-06\t2.0087e-05\t5.9655e+02\t   0.11785\n 12800\t4.2617e-06\t2.3007e-05\t5.9655e+02\t   0.11786\n 12900\t4.3511e-06\t2.8193e-05\t5.9655e+02\t   0.11789\n 13000\t6.5118e-06\t3.3557e-05\t5.9655e+02\t   0.11798\n 13100\t7.5474e-06\t3.4571e-05\t5.9655e+02\t   0.11790\n 13200\t6.9216e-06\t2.9802e-05\t5.9655e+02\t   0.11833\n 13300\t5.5954e-06\t2.4319e-05\t5.9655e+02\t   0.11840\n 13400\t4.6492e-06\t2.4319e-05\t5.9655e+02\t   0.11853\n 13500\t4.0159e-06\t2.1696e-05\t5.9655e+02\t   0.11857\n 13600\t3.5167e-06\t1.8239e-05\t5.9655e+02\t   0.11888\n 13700\t3.0920e-06\t1.4901e-05\t5.9655e+02\t   0.11885\n 13800\t3.3453e-06\t1.4067e-05\t5.9655e+02\t   0.11885\n 13900\t4.5449e-06\t1.6809e-05\t5.9655e+02\t   0.11894\n 14000\t6.7577e-06\t2.3514e-05\t5.9655e+02\t   0.11889\n 14100\t9.2164e-06\t3.6329e-05\t5.9655e+02\t   0.11910\n 14200\t1.0073e-05\t4.3869e-05\t5.9655e+02\t   0.11961\n 14300\t9.0972e-06\t4.1485e-05\t5.9654e+02\t   0.11928\n 14400\t7.5996e-06\t3.3975e-05\t5.9654e+02\t   0.11937\n 14500\t6.3628e-06\t2.6256e-05\t5.9654e+02\t   0.11935\n 14600\t5.5134e-06\t2.3186e-05\t5.9654e+02\t   0.11954\n 14700\t4.9621e-06\t2.1219e-05\t5.9654e+02\t   0.11942\n 14800\t4.5896e-06\t1.9193e-05\t5.9654e+02\t   0.11936\n 14900\t4.3288e-06\t1.7226e-05\t5.9654e+02\t   0.11960\n 15000\t4.1202e-06\t1.5795e-05\t5.9654e+02\t   0.11997\n 15100\t3.9935e-06\t1.5080e-05\t5.9654e+02\t   0.12017\n 15200\t3.8892e-06\t1.5736e-05\t5.9654e+02\t   0.11988\n 15300\t3.9041e-06\t2.2531e-05\t5.9654e+02\t   0.11988\n 15400\t4.3400e-06\t2.4796e-05\t5.9654e+02\t   0.12006\n 15500\t4.5411e-06\t2.6137e-05\t5.9654e+02\t   0.11990\n 15600\t6.9439e-06\t2.4915e-05\t5.9654e+02\t   0.12012\n 15700\t8.5682e-06\t3.0041e-05\t5.9654e+02\t   0.12033\n 15800\t7.8678e-06\t3.0041e-05\t5.9654e+02\t   0.12036\n 15900\t5.6922e-06\t2.5153e-05\t5.9654e+02\t   0.12058\n 16000\t3.7998e-06\t2.0012e-05\t5.9654e+02\t   0.12034\n 16100\t3.0920e-06\t1.5691e-05\t5.9654e+02\t   0.12077\n 16200\t3.0026e-06\t1.3232e-05\t5.9654e+02\t   0.12044\n 16300\t2.9281e-06\t1.2577e-05\t5.9654e+02\t   0.12046\n 16400\t2.8387e-06\t1.1802e-05\t5.9654e+02\t   0.12043\n 16500\t2.7418e-06\t1.1265e-05\t5.9654e+02\t   0.12038\n 16600\t2.6599e-06\t1.1086e-05\t5.9654e+02\t   0.12047\n 16700\t2.5854e-06\t1.0669e-05\t5.9653e+02\t   0.12062\n 16800\t2.4885e-06\t1.0252e-05\t5.9653e+02\t   0.12049\n 16900\t2.4214e-06\t9.9540e-06\t5.9653e+02\t   0.12048\n--------------------------------------------------------------------------------\n\nBoth several times slower towards the end. This also happens when the size of the data is larger.", "body": "Hi, I implemented a classical multiplicative NMF algorithm with PyTorch, but it slows down after iterations on CPU. It is significant for single precision, and it also happens for double precision. \r\n\r\nIt is basically a sequence of matrix multiplications, and of course the most time-consuming part is where the dense data matrix is an operand (can also be confirmed by profiling). The thing is, that particular multiplication step is getting slower. The same also happens when I use the argument `out=` in `torch.mm`. Memory usage was not increased over time. The same happens whatever I set the values to OMP_NUM_THREADS or MKL_NUM_THREADS.\r\n\r\nThe version I'm running is 0.4.0a0+059299b, compiled from source on Ubuntu 16.04. It is tested on two different systems (Intel\u00ae Xeon\u00ae CPU E5-2680 v2 and Intel\u00ae Xeon\u00ae CPU E5-2650 v4).\r\n\r\n```python\r\nimport torch\r\nimport time\r\nclass NMF():\r\n    def __init__(self, data, r, TType=torch.DoubleTensor):\r\n        \"\"\"\r\n        data: a Tensor.\r\n        r: a small integer\r\n        \"\"\"\r\n        self.TType = TType\r\n\r\n        self.p, self.q = data.shape\r\n        self.r = r\r\n        p, q = self.p, self.q\r\n        assert self.r<=self.p and self.r<=self.q\r\n\r\n        # initialize V and W\r\n        self.V_prev = TType(p, r)\r\n        self.W_prev = TType(q, r).t() \r\n\r\n        self.V = TType(p, r).uniform_()\r\n        self.W = TType(q, r).uniform_().t()\r\n\r\n        self.data = data\r\n\r\n    def update_V(self):\r\n        XWt =  torch.mm(self.data, self.W.t()) # this line gets slower over iterations\r\n        WWt =  torch.mm(self.W, self.W.t())\r\n        VWWt = torch.mm(self.V, WWt)\r\n        self.V = self.V.mul_(XWt).div_(VWWt)\r\n    def update_W(self):\r\n        VtX  = torch.mm(self.V.t(), self.data) # this line gets slower over iterations\r\n        VtV  = torch.mm(self.V.t(), self.V)\r\n        VtVW = torch.mm(VtV, self.W)\r\n        self.W = self.W.mul_(VtX).div_(VtVW)\r\n    def get_objective(self):\r\n        outer = torch.mm(self.V, self.W)\r\n        val = torch.sum(((self.data - outer)**2))\r\n        return val\r\n    def check_convergence(self,tol, verbose=True, check_obj=False):\r\n        obj = None\r\n        diff_norm_1 = torch.max(torch.abs(self.V_prev-self.V))\r\n        diff_norm_2 = torch.max(torch.abs(self.W_prev-self.W))\r\n        if check_obj:\r\n            obj = self.get_objective()\r\n        converged = diff_norm_1 < tol and diff_norm_2 < tol\r\n        return (diff_norm_1, diff_norm_2, obj), converged\r\n    def run(self, maxiter=100, tol=1e-5, check_interval=1, verbose=True, check_obj=False):\r\n        if verbose:\r\n            print(\"Starting...\")\r\n            print(\"p={}, q={}, r={}\".format(self.p, self.q, self.r))\r\n            if not check_obj:\r\n                print(\"%6s\\t%10s\\t%10s\\t%10s\" % (\"iter\", \"V_maxdiff\", \"W_maxdiff\", \"time\"))\r\n            else:\r\n                print(\"%6s\\t%10s\\t%10s\\t%10s\\t%10s\" % (\"iter\", \"V_maxdiff\", \"W_maxdiff\", \"obj\", \"time\" ))\r\n            print('-'*80)\r\n\r\n        t0 = time.time()\r\n        t_start = t0\r\n\r\n        for i in range(maxiter):\r\n            self.V_prev.copy_(self.V)\r\n            self.W_prev.copy_(self.W)\r\n\r\n            self.update_V()\r\n            self.update_W()\r\n            if (i+1) % check_interval ==0:\r\n                t1 = time.time()\r\n                (v_maxdiff, w_maxdiff, obj), converged = self.check_convergence(tol, verbose, check_obj)\r\n                if verbose:\r\n                    if not check_obj:\r\n                        print(\"%6d\\t%10.4e\\t%10.4e\\t%10.5f\" % (i+1, v_maxdiff, w_maxdiff, t1-t0))\r\n                    else:\r\n                        print(\"%6d\\t%10.4e\\t%10.4e\\t%10.4e\\t%10.5f\" % (i+1, v_maxdiff, w_maxdiff,\r\n                                                                            obj, t1-t0))\r\n                if converged: break\r\n                t0 = t1\r\n\r\n        if verbose:\r\n            print('-'*80)\r\n            print(\"Completed. total time: {}\".format(time.time()-t_start))\r\nif __name__=='__main__':\r\n    torch.manual_seed(95376)\r\n    TType=torch.FloatTensor # or torch.DoubleTensor\r\n    m = TType(100, 100).uniform_() # this is an example.\r\n    nmf_driver = NMF(m, 10, TType)\r\n    nmf_driver.run(100000, check_interval=100, check_obj=True) \r\n```\r\n\r\nFor single precision, the output on one of the machines was:\r\n\r\n```\r\nStarting...\r\np=100, q=100, r=10\r\n  iter\t V_maxdiff\t W_maxdiff\t       obj\t      time\r\n--------------------------------------------------------------------------------\r\n   100\t1.3119e-03\t6.6189e-03\t6.2078e+02\t   0.01510\r\n   200\t6.5940e-04\t3.3028e-03\t6.1045e+02\t   0.01169\r\n   300\t4.3547e-04\t3.1788e-03\t6.0724e+02\t   0.01114\r\n   400\t3.9439e-04\t2.3619e-03\t6.0541e+02\t   0.01090\r\n   500\t4.1880e-04\t1.8042e-03\t6.0420e+02\t   0.01092\r\n   600\t4.4276e-04\t1.5563e-03\t6.0327e+02\t   0.01098\r\n   700\t3.5451e-04\t1.2529e-03\t6.0248e+02\t   0.01114\r\n   800\t2.8326e-04\t1.2453e-03\t6.0187e+02\t   0.01262\r\n   900\t2.2144e-04\t1.0453e-03\t6.0142e+02\t   0.01667\r\n  1000\t1.7189e-04\t9.8240e-04\t6.0104e+02\t   0.01870\r\n  1100\t2.5006e-04\t1.6117e-03\t6.0060e+02\t   0.02041\r\n  1200\t1.6262e-04\t8.6427e-04\t6.0022e+02\t   0.02390\r\n  1300\t1.5678e-04\t7.2819e-04\t5.9991e+02\t   0.02604\r\n  1400\t1.4988e-04\t1.1668e-03\t5.9963e+02\t   0.02976\r\n  1500\t3.0002e-04\t1.6271e-03\t5.9927e+02\t   0.03425\r\n  1600\t2.1374e-04\t1.3682e-03\t5.9901e+02\t   0.04055\r\n  1700\t1.8387e-04\t9.8372e-04\t5.9878e+02\t   0.04655\r\n  1800\t1.2274e-04\t7.3430e-04\t5.9864e+02\t   0.05056\r\n  1900\t1.2808e-04\t7.3991e-04\t5.9844e+02\t   0.05459\r\n  2000\t1.0507e-04\t5.5665e-04\t5.9822e+02\t   0.05986\r\n  2100\t1.0122e-04\t5.9545e-04\t5.9805e+02\t   0.06360\r\n  2200\t7.7765e-05\t4.3631e-04\t5.9789e+02\t   0.06675\r\n  2300\t6.8538e-05\t3.6190e-04\t5.9779e+02\t   0.06986\r\n  2400\t4.5005e-05\t2.6327e-04\t5.9773e+02\t   0.07313\r\n  2500\t4.9658e-05\t3.0780e-04\t5.9768e+02\t   0.07640\r\n  2600\t3.4593e-05\t2.2912e-04\t5.9764e+02\t   0.08022\r\n  2700\t4.4137e-05\t2.8223e-04\t5.9759e+02\t   0.08401\r\n  2800\t9.8012e-05\t4.3392e-04\t5.9749e+02\t   0.08970\r\n  2900\t7.3388e-05\t3.0982e-04\t5.9743e+02\t   0.08717\r\n  3000\t5.1551e-05\t2.4986e-04\t5.9738e+02\t   0.07530\r\n  3100\t4.1783e-05\t2.8586e-04\t5.9734e+02\t   0.07525\r\n  3200\t3.8460e-05\t2.5535e-04\t5.9731e+02\t   0.07630\r\n  3300\t4.7788e-05\t4.2939e-04\t5.9727e+02\t   0.07898\r\n  3400\t4.1649e-05\t1.9139e-04\t5.9725e+02\t   0.07948\r\n  3500\t3.4884e-05\t1.8650e-04\t5.9722e+02\t   0.07985\r\n  3600\t4.3005e-05\t1.6895e-04\t5.9719e+02\t   0.08154\r\n  3700\t4.6715e-05\t1.6725e-04\t5.9715e+02\t   0.08338\r\n  3800\t3.4064e-05\t1.5116e-04\t5.9711e+02\t   0.08471\r\n  3900\t3.4675e-05\t1.6737e-04\t5.9709e+02\t   0.08635\r\n  4000\t2.7195e-05\t2.9254e-04\t5.9706e+02\t   0.08792\r\n  4100\t2.2151e-05\t1.6105e-04\t5.9704e+02\t   0.08961\r\n  4200\t1.9073e-05\t1.1778e-04\t5.9703e+02\t   0.09092\r\n  4300\t2.4661e-05\t1.2285e-04\t5.9701e+02\t   0.09233\r\n  4400\t2.4348e-05\t9.6858e-05\t5.9700e+02\t   0.09298\r\n  4500\t1.8656e-05\t7.8678e-05\t5.9700e+02\t   0.09346\r\n  4600\t2.7746e-05\t2.3198e-04\t5.9697e+02\t   0.09448\r\n  4700\t5.1215e-05\t3.3328e-04\t5.9691e+02\t   0.09553\r\n  4800\t3.1725e-05\t2.2525e-04\t5.9688e+02\t   0.09641\r\n  4900\t2.2836e-05\t1.5676e-04\t5.9686e+02\t   0.09729\r\n  5000\t2.1532e-05\t1.3620e-04\t5.9685e+02\t   0.09757\r\n  5100\t2.9176e-05\t1.3584e-04\t5.9684e+02\t   0.09838\r\n  5200\t3.8736e-05\t1.3852e-04\t5.9682e+02\t   0.09885\r\n  5300\t3.8072e-05\t1.2064e-04\t5.9681e+02\t   0.09973\r\n  5400\t3.0108e-05\t9.7394e-05\t5.9681e+02\t   0.10012\r\n  5500\t2.1681e-05\t8.1182e-05\t5.9680e+02\t   0.10153\r\n  5600\t2.3846e-05\t1.4779e-04\t5.9679e+02\t   0.10219\r\n  5700\t2.4244e-05\t1.5914e-04\t5.9678e+02\t   0.10259\r\n  5800\t1.8716e-05\t1.2057e-04\t5.9677e+02\t   0.10286\r\n  5900\t1.5788e-05\t8.9869e-05\t5.9676e+02\t   0.10322\r\n  6000\t1.6764e-05\t8.1718e-05\t5.9675e+02\t   0.10343\r\n  6100\t1.9893e-05\t1.2720e-04\t5.9674e+02\t   0.10417\r\n  6200\t4.7639e-05\t1.6403e-04\t5.9671e+02\t   0.10413\r\n  6300\t3.9786e-05\t1.4874e-04\t5.9670e+02\t   0.10451\r\n  6400\t2.8454e-05\t1.1134e-04\t5.9669e+02\t   0.10469\r\n  6500\t2.1398e-05\t1.1218e-04\t5.9669e+02\t   0.10558\r\n  6600\t2.2944e-05\t1.3828e-04\t5.9668e+02\t   0.10557\r\n  6700\t2.7187e-05\t1.5700e-04\t5.9667e+02\t   0.10566\r\n  6800\t2.9683e-05\t1.8024e-04\t5.9665e+02\t   0.10588\r\n  6900\t2.9683e-05\t1.6534e-04\t5.9665e+02\t   0.10649\r\n  7000\t2.5630e-05\t1.5831e-04\t5.9664e+02\t   0.10708\r\n  7100\t2.1935e-05\t1.4281e-04\t5.9664e+02\t   0.10753\r\n  7200\t1.9044e-05\t1.2743e-04\t5.9664e+02\t   0.10795\r\n  7300\t1.6563e-05\t1.1551e-04\t5.9663e+02\t   0.10821\r\n  7400\t2.0899e-05\t1.0800e-04\t5.9662e+02\t   0.10848\r\n  7500\t2.1543e-05\t1.0037e-04\t5.9662e+02\t   0.10893\r\n  7600\t1.8679e-05\t8.9169e-05\t5.9662e+02\t   0.10994\r\n  7700\t1.5087e-05\t7.7248e-05\t5.9661e+02\t   0.11038\r\n  7800\t1.2025e-05\t6.7592e-05\t5.9661e+02\t   0.11068\r\n  7900\t9.9614e-06\t6.0081e-05\t5.9661e+02\t   0.11107\r\n  8000\t1.1057e-05\t5.3525e-05\t5.9661e+02\t   0.11141\r\n  8100\t1.3798e-05\t4.9829e-05\t5.9661e+02\t   0.11187\r\n  8200\t1.3217e-05\t5.2810e-05\t5.9660e+02\t   0.11200\r\n  8300\t1.0297e-05\t4.3392e-05\t5.9660e+02\t   0.11205\r\n  8400\t9.8795e-06\t4.5002e-05\t5.9660e+02\t   0.11202\r\n  8500\t1.0192e-05\t4.9174e-05\t5.9660e+02\t   0.11210\r\n  8600\t9.7826e-06\t4.1559e-05\t5.9659e+02\t   0.11222\r\n  8700\t1.9178e-05\t5.4002e-05\t5.9659e+02\t   0.11238\r\n  8800\t2.6975e-05\t7.4863e-05\t5.9658e+02\t   0.11255\r\n  8900\t2.1780e-05\t6.9916e-05\t5.9658e+02\t   0.11277\r\n  9000\t1.4499e-05\t5.4181e-05\t5.9658e+02\t   0.11281\r\n  9100\t1.0202e-05\t4.6313e-05\t5.9657e+02\t   0.11295\r\n  9200\t7.8622e-06\t4.3124e-05\t5.9657e+02\t   0.11310\r\n  9300\t7.6145e-06\t4.0978e-05\t5.9657e+02\t   0.11293\r\n  9400\t7.5400e-06\t3.9369e-05\t5.9657e+02\t   0.11282\r\n  9500\t7.5549e-06\t3.7968e-05\t5.9657e+02\t   0.11296\r\n  9600\t7.5623e-06\t3.6806e-05\t5.9657e+02\t   0.11311\r\n  9700\t7.4953e-06\t3.5912e-05\t5.9657e+02\t   0.11326\r\n  9800\t7.3463e-06\t3.5286e-05\t5.9657e+02\t   0.11335\r\n  9900\t7.1824e-06\t3.4571e-05\t5.9657e+02\t   0.11347\r\n 10000\t7.0632e-06\t3.3557e-05\t5.9657e+02\t   0.11377\r\n 10100\t6.9663e-06\t3.2604e-05\t5.9656e+02\t   0.11394\r\n 10200\t6.8918e-06\t3.1471e-05\t5.9656e+02\t   0.11399\r\n 10300\t6.8918e-06\t3.0488e-05\t5.9656e+02\t   0.11419\r\n 10400\t6.8620e-06\t2.9415e-05\t5.9656e+02\t   0.11438\r\n 10500\t6.8843e-06\t2.8461e-05\t5.9656e+02\t   0.11458\r\n 10600\t6.8843e-06\t2.8372e-05\t5.9656e+02\t   0.11468\r\n 10700\t6.8694e-06\t2.8193e-05\t5.9656e+02\t   0.11465\r\n 10800\t6.8247e-06\t2.8133e-05\t5.9656e+02\t   0.11477\r\n 10900\t6.8694e-06\t2.7895e-05\t5.9656e+02\t   0.11484\r\n 11000\t6.9812e-06\t2.7537e-05\t5.9656e+02\t   0.11502\r\n 11100\t7.7821e-06\t3.1471e-05\t5.9656e+02\t   0.11497\r\n 11200\t6.8694e-06\t3.0637e-05\t5.9656e+02\t   0.11500\r\n 11300\t6.6012e-06\t2.7418e-05\t5.9656e+02\t   0.11519\r\n 11400\t6.3255e-06\t2.4199e-05\t5.9656e+02\t   0.11538\r\n 11500\t6.0573e-06\t2.3484e-05\t5.9656e+02\t   0.11573\r\n 11600\t5.8413e-06\t2.3127e-05\t5.9656e+02\t   0.11583\r\n 11700\t5.6699e-06\t2.2650e-05\t5.9656e+02\t   0.11626\r\n 11800\t5.5060e-06\t2.1935e-05\t5.9656e+02\t   0.11619\r\n 11900\t5.3868e-06\t2.1458e-05\t5.9656e+02\t   0.11684\r\n 12000\t5.2676e-06\t2.1219e-05\t5.9656e+02\t   0.11689\r\n 12100\t5.1260e-06\t2.0266e-05\t5.9656e+02\t   0.11692\r\n 12200\t5.0142e-06\t1.9789e-05\t5.9656e+02\t   0.11713\r\n 12300\t4.8652e-06\t1.9073e-05\t5.9656e+02\t   0.11729\r\n 12400\t4.7460e-06\t1.8954e-05\t5.9656e+02\t   0.11746\r\n 12500\t4.5896e-06\t1.8716e-05\t5.9656e+02\t   0.11765\r\n 12600\t4.4256e-06\t1.9014e-05\t5.9655e+02\t   0.11790\r\n 12700\t4.2915e-06\t2.0087e-05\t5.9655e+02\t   0.11785\r\n 12800\t4.2617e-06\t2.3007e-05\t5.9655e+02\t   0.11786\r\n 12900\t4.3511e-06\t2.8193e-05\t5.9655e+02\t   0.11789\r\n 13000\t6.5118e-06\t3.3557e-05\t5.9655e+02\t   0.11798\r\n 13100\t7.5474e-06\t3.4571e-05\t5.9655e+02\t   0.11790\r\n 13200\t6.9216e-06\t2.9802e-05\t5.9655e+02\t   0.11833\r\n 13300\t5.5954e-06\t2.4319e-05\t5.9655e+02\t   0.11840\r\n 13400\t4.6492e-06\t2.4319e-05\t5.9655e+02\t   0.11853\r\n 13500\t4.0159e-06\t2.1696e-05\t5.9655e+02\t   0.11857\r\n 13600\t3.5167e-06\t1.8239e-05\t5.9655e+02\t   0.11888\r\n 13700\t3.0920e-06\t1.4901e-05\t5.9655e+02\t   0.11885\r\n 13800\t3.3453e-06\t1.4067e-05\t5.9655e+02\t   0.11885\r\n 13900\t4.5449e-06\t1.6809e-05\t5.9655e+02\t   0.11894\r\n 14000\t6.7577e-06\t2.3514e-05\t5.9655e+02\t   0.11889\r\n 14100\t9.2164e-06\t3.6329e-05\t5.9655e+02\t   0.11910\r\n 14200\t1.0073e-05\t4.3869e-05\t5.9655e+02\t   0.11961\r\n 14300\t9.0972e-06\t4.1485e-05\t5.9654e+02\t   0.11928\r\n 14400\t7.5996e-06\t3.3975e-05\t5.9654e+02\t   0.11937\r\n 14500\t6.3628e-06\t2.6256e-05\t5.9654e+02\t   0.11935\r\n 14600\t5.5134e-06\t2.3186e-05\t5.9654e+02\t   0.11954\r\n 14700\t4.9621e-06\t2.1219e-05\t5.9654e+02\t   0.11942\r\n 14800\t4.5896e-06\t1.9193e-05\t5.9654e+02\t   0.11936\r\n 14900\t4.3288e-06\t1.7226e-05\t5.9654e+02\t   0.11960\r\n 15000\t4.1202e-06\t1.5795e-05\t5.9654e+02\t   0.11997\r\n 15100\t3.9935e-06\t1.5080e-05\t5.9654e+02\t   0.12017\r\n 15200\t3.8892e-06\t1.5736e-05\t5.9654e+02\t   0.11988\r\n 15300\t3.9041e-06\t2.2531e-05\t5.9654e+02\t   0.11988\r\n 15400\t4.3400e-06\t2.4796e-05\t5.9654e+02\t   0.12006\r\n 15500\t4.5411e-06\t2.6137e-05\t5.9654e+02\t   0.11990\r\n 15600\t6.9439e-06\t2.4915e-05\t5.9654e+02\t   0.12012\r\n 15700\t8.5682e-06\t3.0041e-05\t5.9654e+02\t   0.12033\r\n 15800\t7.8678e-06\t3.0041e-05\t5.9654e+02\t   0.12036\r\n 15900\t5.6922e-06\t2.5153e-05\t5.9654e+02\t   0.12058\r\n 16000\t3.7998e-06\t2.0012e-05\t5.9654e+02\t   0.12034\r\n 16100\t3.0920e-06\t1.5691e-05\t5.9654e+02\t   0.12077\r\n 16200\t3.0026e-06\t1.3232e-05\t5.9654e+02\t   0.12044\r\n 16300\t2.9281e-06\t1.2577e-05\t5.9654e+02\t   0.12046\r\n 16400\t2.8387e-06\t1.1802e-05\t5.9654e+02\t   0.12043\r\n 16500\t2.7418e-06\t1.1265e-05\t5.9654e+02\t   0.12038\r\n 16600\t2.6599e-06\t1.1086e-05\t5.9654e+02\t   0.12047\r\n 16700\t2.5854e-06\t1.0669e-05\t5.9653e+02\t   0.12062\r\n 16800\t2.4885e-06\t1.0252e-05\t5.9653e+02\t   0.12049\r\n 16900\t2.4214e-06\t9.9540e-06\t5.9653e+02\t   0.12048\r\n--------------------------------------------------------------------------------\r\n```\r\n\r\nand for double precision:\r\n```\r\nStarting...\r\np=100, q=100, r=10\r\n  iter\t V_maxdiff\t W_maxdiff\t       obj\t      time\r\n--------------------------------------------------------------------------------\r\n   100\t1.3119e-03\t6.6189e-03\t6.2078e+02\t   0.01510\r\n   200\t6.5940e-04\t3.3028e-03\t6.1045e+02\t   0.01169\r\n   300\t4.3547e-04\t3.1788e-03\t6.0724e+02\t   0.01114\r\n   400\t3.9439e-04\t2.3619e-03\t6.0541e+02\t   0.01090\r\n   500\t4.1880e-04\t1.8042e-03\t6.0420e+02\t   0.01092\r\n   600\t4.4276e-04\t1.5563e-03\t6.0327e+02\t   0.01098\r\n   700\t3.5451e-04\t1.2529e-03\t6.0248e+02\t   0.01114\r\n   800\t2.8326e-04\t1.2453e-03\t6.0187e+02\t   0.01262\r\n   900\t2.2144e-04\t1.0453e-03\t6.0142e+02\t   0.01667\r\n  1000\t1.7189e-04\t9.8240e-04\t6.0104e+02\t   0.01870\r\n  1100\t2.5006e-04\t1.6117e-03\t6.0060e+02\t   0.02041\r\n  1200\t1.6262e-04\t8.6427e-04\t6.0022e+02\t   0.02390\r\n  1300\t1.5678e-04\t7.2819e-04\t5.9991e+02\t   0.02604\r\n  1400\t1.4988e-04\t1.1668e-03\t5.9963e+02\t   0.02976\r\n  1500\t3.0002e-04\t1.6271e-03\t5.9927e+02\t   0.03425\r\n  1600\t2.1374e-04\t1.3682e-03\t5.9901e+02\t   0.04055\r\n  1700\t1.8387e-04\t9.8372e-04\t5.9878e+02\t   0.04655\r\n  1800\t1.2274e-04\t7.3430e-04\t5.9864e+02\t   0.05056\r\n  1900\t1.2808e-04\t7.3991e-04\t5.9844e+02\t   0.05459\r\n  2000\t1.0507e-04\t5.5665e-04\t5.9822e+02\t   0.05986\r\n  2100\t1.0122e-04\t5.9545e-04\t5.9805e+02\t   0.06360\r\n  2200\t7.7765e-05\t4.3631e-04\t5.9789e+02\t   0.06675\r\n  2300\t6.8538e-05\t3.6190e-04\t5.9779e+02\t   0.06986\r\n  2400\t4.5005e-05\t2.6327e-04\t5.9773e+02\t   0.07313\r\n  2500\t4.9658e-05\t3.0780e-04\t5.9768e+02\t   0.07640\r\n  2600\t3.4593e-05\t2.2912e-04\t5.9764e+02\t   0.08022\r\n  2700\t4.4137e-05\t2.8223e-04\t5.9759e+02\t   0.08401\r\n  2800\t9.8012e-05\t4.3392e-04\t5.9749e+02\t   0.08970\r\n  2900\t7.3388e-05\t3.0982e-04\t5.9743e+02\t   0.08717\r\n  3000\t5.1551e-05\t2.4986e-04\t5.9738e+02\t   0.07530\r\n  3100\t4.1783e-05\t2.8586e-04\t5.9734e+02\t   0.07525\r\n  3200\t3.8460e-05\t2.5535e-04\t5.9731e+02\t   0.07630\r\n  3300\t4.7788e-05\t4.2939e-04\t5.9727e+02\t   0.07898\r\n  3400\t4.1649e-05\t1.9139e-04\t5.9725e+02\t   0.07948\r\n  3500\t3.4884e-05\t1.8650e-04\t5.9722e+02\t   0.07985\r\n  3600\t4.3005e-05\t1.6895e-04\t5.9719e+02\t   0.08154\r\n  3700\t4.6715e-05\t1.6725e-04\t5.9715e+02\t   0.08338\r\n  3800\t3.4064e-05\t1.5116e-04\t5.9711e+02\t   0.08471\r\n  3900\t3.4675e-05\t1.6737e-04\t5.9709e+02\t   0.08635\r\n  4000\t2.7195e-05\t2.9254e-04\t5.9706e+02\t   0.08792\r\n  4100\t2.2151e-05\t1.6105e-04\t5.9704e+02\t   0.08961\r\n  4200\t1.9073e-05\t1.1778e-04\t5.9703e+02\t   0.09092\r\n  4300\t2.4661e-05\t1.2285e-04\t5.9701e+02\t   0.09233\r\n  4400\t2.4348e-05\t9.6858e-05\t5.9700e+02\t   0.09298\r\n  4500\t1.8656e-05\t7.8678e-05\t5.9700e+02\t   0.09346\r\n  4600\t2.7746e-05\t2.3198e-04\t5.9697e+02\t   0.09448\r\n  4700\t5.1215e-05\t3.3328e-04\t5.9691e+02\t   0.09553\r\n  4800\t3.1725e-05\t2.2525e-04\t5.9688e+02\t   0.09641\r\n  4900\t2.2836e-05\t1.5676e-04\t5.9686e+02\t   0.09729\r\n  5000\t2.1532e-05\t1.3620e-04\t5.9685e+02\t   0.09757\r\n  5100\t2.9176e-05\t1.3584e-04\t5.9684e+02\t   0.09838\r\n  5200\t3.8736e-05\t1.3852e-04\t5.9682e+02\t   0.09885\r\n  5300\t3.8072e-05\t1.2064e-04\t5.9681e+02\t   0.09973\r\n  5400\t3.0108e-05\t9.7394e-05\t5.9681e+02\t   0.10012\r\n  5500\t2.1681e-05\t8.1182e-05\t5.9680e+02\t   0.10153\r\n  5600\t2.3846e-05\t1.4779e-04\t5.9679e+02\t   0.10219\r\n  5700\t2.4244e-05\t1.5914e-04\t5.9678e+02\t   0.10259\r\n  5800\t1.8716e-05\t1.2057e-04\t5.9677e+02\t   0.10286\r\n  5900\t1.5788e-05\t8.9869e-05\t5.9676e+02\t   0.10322\r\n  6000\t1.6764e-05\t8.1718e-05\t5.9675e+02\t   0.10343\r\n  6100\t1.9893e-05\t1.2720e-04\t5.9674e+02\t   0.10417\r\n  6200\t4.7639e-05\t1.6403e-04\t5.9671e+02\t   0.10413\r\n  6300\t3.9786e-05\t1.4874e-04\t5.9670e+02\t   0.10451\r\n  6400\t2.8454e-05\t1.1134e-04\t5.9669e+02\t   0.10469\r\n  6500\t2.1398e-05\t1.1218e-04\t5.9669e+02\t   0.10558\r\n  6600\t2.2944e-05\t1.3828e-04\t5.9668e+02\t   0.10557\r\n  6700\t2.7187e-05\t1.5700e-04\t5.9667e+02\t   0.10566\r\n  6800\t2.9683e-05\t1.8024e-04\t5.9665e+02\t   0.10588\r\n  6900\t2.9683e-05\t1.6534e-04\t5.9665e+02\t   0.10649\r\n  7000\t2.5630e-05\t1.5831e-04\t5.9664e+02\t   0.10708\r\n  7100\t2.1935e-05\t1.4281e-04\t5.9664e+02\t   0.10753\r\n  7200\t1.9044e-05\t1.2743e-04\t5.9664e+02\t   0.10795\r\n  7300\t1.6563e-05\t1.1551e-04\t5.9663e+02\t   0.10821\r\n  7400\t2.0899e-05\t1.0800e-04\t5.9662e+02\t   0.10848\r\n  7500\t2.1543e-05\t1.0037e-04\t5.9662e+02\t   0.10893\r\n  7600\t1.8679e-05\t8.9169e-05\t5.9662e+02\t   0.10994\r\n  7700\t1.5087e-05\t7.7248e-05\t5.9661e+02\t   0.11038\r\n  7800\t1.2025e-05\t6.7592e-05\t5.9661e+02\t   0.11068\r\n  7900\t9.9614e-06\t6.0081e-05\t5.9661e+02\t   0.11107\r\n  8000\t1.1057e-05\t5.3525e-05\t5.9661e+02\t   0.11141\r\n  8100\t1.3798e-05\t4.9829e-05\t5.9661e+02\t   0.11187\r\n  8200\t1.3217e-05\t5.2810e-05\t5.9660e+02\t   0.11200\r\n  8300\t1.0297e-05\t4.3392e-05\t5.9660e+02\t   0.11205\r\n  8400\t9.8795e-06\t4.5002e-05\t5.9660e+02\t   0.11202\r\n  8500\t1.0192e-05\t4.9174e-05\t5.9660e+02\t   0.11210\r\n  8600\t9.7826e-06\t4.1559e-05\t5.9659e+02\t   0.11222\r\n  8700\t1.9178e-05\t5.4002e-05\t5.9659e+02\t   0.11238\r\n  8800\t2.6975e-05\t7.4863e-05\t5.9658e+02\t   0.11255\r\n  8900\t2.1780e-05\t6.9916e-05\t5.9658e+02\t   0.11277\r\n  9000\t1.4499e-05\t5.4181e-05\t5.9658e+02\t   0.11281\r\n  9100\t1.0202e-05\t4.6313e-05\t5.9657e+02\t   0.11295\r\n  9200\t7.8622e-06\t4.3124e-05\t5.9657e+02\t   0.11310\r\n  9300\t7.6145e-06\t4.0978e-05\t5.9657e+02\t   0.11293\r\n  9400\t7.5400e-06\t3.9369e-05\t5.9657e+02\t   0.11282\r\n  9500\t7.5549e-06\t3.7968e-05\t5.9657e+02\t   0.11296\r\n  9600\t7.5623e-06\t3.6806e-05\t5.9657e+02\t   0.11311\r\n  9700\t7.4953e-06\t3.5912e-05\t5.9657e+02\t   0.11326\r\n  9800\t7.3463e-06\t3.5286e-05\t5.9657e+02\t   0.11335\r\n  9900\t7.1824e-06\t3.4571e-05\t5.9657e+02\t   0.11347\r\n 10000\t7.0632e-06\t3.3557e-05\t5.9657e+02\t   0.11377\r\n 10100\t6.9663e-06\t3.2604e-05\t5.9656e+02\t   0.11394\r\n 10200\t6.8918e-06\t3.1471e-05\t5.9656e+02\t   0.11399\r\n 10300\t6.8918e-06\t3.0488e-05\t5.9656e+02\t   0.11419\r\n 10400\t6.8620e-06\t2.9415e-05\t5.9656e+02\t   0.11438\r\n 10500\t6.8843e-06\t2.8461e-05\t5.9656e+02\t   0.11458\r\n 10600\t6.8843e-06\t2.8372e-05\t5.9656e+02\t   0.11468\r\n 10700\t6.8694e-06\t2.8193e-05\t5.9656e+02\t   0.11465\r\n 10800\t6.8247e-06\t2.8133e-05\t5.9656e+02\t   0.11477\r\n 10900\t6.8694e-06\t2.7895e-05\t5.9656e+02\t   0.11484\r\n 11000\t6.9812e-06\t2.7537e-05\t5.9656e+02\t   0.11502\r\n 11100\t7.7821e-06\t3.1471e-05\t5.9656e+02\t   0.11497\r\n 11200\t6.8694e-06\t3.0637e-05\t5.9656e+02\t   0.11500\r\n 11300\t6.6012e-06\t2.7418e-05\t5.9656e+02\t   0.11519\r\n 11400\t6.3255e-06\t2.4199e-05\t5.9656e+02\t   0.11538\r\n 11500\t6.0573e-06\t2.3484e-05\t5.9656e+02\t   0.11573\r\n 11600\t5.8413e-06\t2.3127e-05\t5.9656e+02\t   0.11583\r\n 11700\t5.6699e-06\t2.2650e-05\t5.9656e+02\t   0.11626\r\n 11800\t5.5060e-06\t2.1935e-05\t5.9656e+02\t   0.11619\r\n 11900\t5.3868e-06\t2.1458e-05\t5.9656e+02\t   0.11684\r\n 12000\t5.2676e-06\t2.1219e-05\t5.9656e+02\t   0.11689\r\n 12100\t5.1260e-06\t2.0266e-05\t5.9656e+02\t   0.11692\r\n 12200\t5.0142e-06\t1.9789e-05\t5.9656e+02\t   0.11713\r\n 12300\t4.8652e-06\t1.9073e-05\t5.9656e+02\t   0.11729\r\n 12400\t4.7460e-06\t1.8954e-05\t5.9656e+02\t   0.11746\r\n 12500\t4.5896e-06\t1.8716e-05\t5.9656e+02\t   0.11765\r\n 12600\t4.4256e-06\t1.9014e-05\t5.9655e+02\t   0.11790\r\n 12700\t4.2915e-06\t2.0087e-05\t5.9655e+02\t   0.11785\r\n 12800\t4.2617e-06\t2.3007e-05\t5.9655e+02\t   0.11786\r\n 12900\t4.3511e-06\t2.8193e-05\t5.9655e+02\t   0.11789\r\n 13000\t6.5118e-06\t3.3557e-05\t5.9655e+02\t   0.11798\r\n 13100\t7.5474e-06\t3.4571e-05\t5.9655e+02\t   0.11790\r\n 13200\t6.9216e-06\t2.9802e-05\t5.9655e+02\t   0.11833\r\n 13300\t5.5954e-06\t2.4319e-05\t5.9655e+02\t   0.11840\r\n 13400\t4.6492e-06\t2.4319e-05\t5.9655e+02\t   0.11853\r\n 13500\t4.0159e-06\t2.1696e-05\t5.9655e+02\t   0.11857\r\n 13600\t3.5167e-06\t1.8239e-05\t5.9655e+02\t   0.11888\r\n 13700\t3.0920e-06\t1.4901e-05\t5.9655e+02\t   0.11885\r\n 13800\t3.3453e-06\t1.4067e-05\t5.9655e+02\t   0.11885\r\n 13900\t4.5449e-06\t1.6809e-05\t5.9655e+02\t   0.11894\r\n 14000\t6.7577e-06\t2.3514e-05\t5.9655e+02\t   0.11889\r\n 14100\t9.2164e-06\t3.6329e-05\t5.9655e+02\t   0.11910\r\n 14200\t1.0073e-05\t4.3869e-05\t5.9655e+02\t   0.11961\r\n 14300\t9.0972e-06\t4.1485e-05\t5.9654e+02\t   0.11928\r\n 14400\t7.5996e-06\t3.3975e-05\t5.9654e+02\t   0.11937\r\n 14500\t6.3628e-06\t2.6256e-05\t5.9654e+02\t   0.11935\r\n 14600\t5.5134e-06\t2.3186e-05\t5.9654e+02\t   0.11954\r\n 14700\t4.9621e-06\t2.1219e-05\t5.9654e+02\t   0.11942\r\n 14800\t4.5896e-06\t1.9193e-05\t5.9654e+02\t   0.11936\r\n 14900\t4.3288e-06\t1.7226e-05\t5.9654e+02\t   0.11960\r\n 15000\t4.1202e-06\t1.5795e-05\t5.9654e+02\t   0.11997\r\n 15100\t3.9935e-06\t1.5080e-05\t5.9654e+02\t   0.12017\r\n 15200\t3.8892e-06\t1.5736e-05\t5.9654e+02\t   0.11988\r\n 15300\t3.9041e-06\t2.2531e-05\t5.9654e+02\t   0.11988\r\n 15400\t4.3400e-06\t2.4796e-05\t5.9654e+02\t   0.12006\r\n 15500\t4.5411e-06\t2.6137e-05\t5.9654e+02\t   0.11990\r\n 15600\t6.9439e-06\t2.4915e-05\t5.9654e+02\t   0.12012\r\n 15700\t8.5682e-06\t3.0041e-05\t5.9654e+02\t   0.12033\r\n 15800\t7.8678e-06\t3.0041e-05\t5.9654e+02\t   0.12036\r\n 15900\t5.6922e-06\t2.5153e-05\t5.9654e+02\t   0.12058\r\n 16000\t3.7998e-06\t2.0012e-05\t5.9654e+02\t   0.12034\r\n 16100\t3.0920e-06\t1.5691e-05\t5.9654e+02\t   0.12077\r\n 16200\t3.0026e-06\t1.3232e-05\t5.9654e+02\t   0.12044\r\n 16300\t2.9281e-06\t1.2577e-05\t5.9654e+02\t   0.12046\r\n 16400\t2.8387e-06\t1.1802e-05\t5.9654e+02\t   0.12043\r\n 16500\t2.7418e-06\t1.1265e-05\t5.9654e+02\t   0.12038\r\n 16600\t2.6599e-06\t1.1086e-05\t5.9654e+02\t   0.12047\r\n 16700\t2.5854e-06\t1.0669e-05\t5.9653e+02\t   0.12062\r\n 16800\t2.4885e-06\t1.0252e-05\t5.9653e+02\t   0.12049\r\n 16900\t2.4214e-06\t9.9540e-06\t5.9653e+02\t   0.12048\r\n--------------------------------------------------------------------------------\r\n```\r\n\r\nBoth several times slower towards the end. This also happens when the size of the data is larger."}