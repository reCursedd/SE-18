{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2757", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2757/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2757/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2757/events", "html_url": "https://github.com/pytorch/pytorch/issues/2757", "id": 258215878, "node_id": "MDU6SXNzdWUyNTgyMTU4Nzg=", "number": 2757, "title": "DataLoader raises an exception when exit()ing", "user": {"login": "francoisfleuret", "id": 11032892, "node_id": "MDQ6VXNlcjExMDMyODky", "avatar_url": "https://avatars0.githubusercontent.com/u/11032892?v=4", "gravatar_id": "", "url": "https://api.github.com/users/francoisfleuret", "html_url": "https://github.com/francoisfleuret", "followers_url": "https://api.github.com/users/francoisfleuret/followers", "following_url": "https://api.github.com/users/francoisfleuret/following{/other_user}", "gists_url": "https://api.github.com/users/francoisfleuret/gists{/gist_id}", "starred_url": "https://api.github.com/users/francoisfleuret/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/francoisfleuret/subscriptions", "organizations_url": "https://api.github.com/users/francoisfleuret/orgs", "repos_url": "https://api.github.com/users/francoisfleuret/repos", "events_url": "https://api.github.com/users/francoisfleuret/events{/privacy}", "received_events_url": "https://api.github.com/users/francoisfleuret/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}, {"id": 679955625, "node_id": "MDU6TGFiZWw2Nzk5NTU2MjU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/crash", "name": "crash", "color": "d93f0b", "default": false}, {"id": 553773019, "node_id": "MDU6TGFiZWw1NTM3NzMwMTk=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/needs-reproduction", "name": "needs-reproduction", "color": "e99695", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-09-16T07:44:14Z", "updated_at": "2017-11-07T00:02:37Z", "closed_at": "2017-11-07T00:02:37Z", "author_association": "NONE", "body_html": "<p>This piece of code</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch, torchvision\n\ntransform <span class=\"pl-k\">=</span>  torchvision.transforms.ToTensor()\ntrain_set <span class=\"pl-k\">=</span> torchvision.datasets.CIFAR10(<span class=\"pl-v\">root</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>./<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">train</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">True</span>, <span class=\"pl-v\">download</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">True</span>, <span class=\"pl-v\">transform</span> <span class=\"pl-k\">=</span> transform)\ntrain_loader <span class=\"pl-k\">=</span> torch.utils.data.DataLoader(train_set, <span class=\"pl-v\">batch_size</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>, <span class=\"pl-v\">num_workers</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">2</span>)\n\ndata_iter <span class=\"pl-k\">=</span> <span class=\"pl-c1\">iter</span>(train_loader)\n\n<span class=\"pl-c1\">exit</span>(<span class=\"pl-c1\">0</span>)</pre></div>\n<p>generates [often, non-deterministically]</p>\n<pre><code>Exception ignored in: &lt;bound method DataLoaderIter.__del__ of &lt;torch.utils.data.dataloader.DataLoaderIter object at 0x7f5b3f117908&gt;&gt;\nTraceback (most recent call last):\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/site-packages/torch/utils/data/dataloader.py\", line 241, in __del__\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/site-packages/torch/utils/data/dataloader.py\", line 237, in _shutdown_workers\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/multiprocessing/queues.py\", line 349, in put\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/multiprocessing/reduction.py\", line 49, in dumps\nTypeError: 'NoneType' object is not callable\n\n</code></pre>", "body_text": "This piece of code\nimport torch, torchvision\n\ntransform =  torchvision.transforms.ToTensor()\ntrain_set = torchvision.datasets.CIFAR10(root = './', train = True, download = True, transform = transform)\ntrain_loader = torch.utils.data.DataLoader(train_set, batch_size = 100, num_workers = 2)\n\ndata_iter = iter(train_loader)\n\nexit(0)\ngenerates [often, non-deterministically]\nException ignored in: <bound method DataLoaderIter.__del__ of <torch.utils.data.dataloader.DataLoaderIter object at 0x7f5b3f117908>>\nTraceback (most recent call last):\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/site-packages/torch/utils/data/dataloader.py\", line 241, in __del__\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/site-packages/torch/utils/data/dataloader.py\", line 237, in _shutdown_workers\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/multiprocessing/queues.py\", line 349, in put\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/multiprocessing/reduction.py\", line 49, in dumps\nTypeError: 'NoneType' object is not callable", "body": "This piece of code\r\n\r\n```python\r\nimport torch, torchvision\r\n\r\ntransform =  torchvision.transforms.ToTensor()\r\ntrain_set = torchvision.datasets.CIFAR10(root = './', train = True, download = True, transform = transform)\r\ntrain_loader = torch.utils.data.DataLoader(train_set, batch_size = 100, num_workers = 2)\r\n\r\ndata_iter = iter(train_loader)\r\n\r\nexit(0)\r\n```\r\n\r\ngenerates [often, non-deterministically]\r\n\r\n```\r\nException ignored in: <bound method DataLoaderIter.__del__ of <torch.utils.data.dataloader.DataLoaderIter object at 0x7f5b3f117908>>\r\nTraceback (most recent call last):\r\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/site-packages/torch/utils/data/dataloader.py\", line 241, in __del__\r\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/site-packages/torch/utils/data/dataloader.py\", line 237, in _shutdown_workers\r\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/multiprocessing/queues.py\", line 349, in put\r\n  File \"/home/fleuret/misc/anaconda3/lib/python3.5/multiprocessing/reduction.py\", line 49, in dumps\r\nTypeError: 'NoneType' object is not callable\r\n\r\n```"}