{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/428376038", "html_url": "https://github.com/pytorch/pytorch/issues/2474#issuecomment-428376038", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/2474", "id": 428376038, "node_id": "MDEyOklzc3VlQ29tbWVudDQyODM3NjAzOA==", "user": {"login": "vadimkantorov", "id": 1041752, "node_id": "MDQ6VXNlcjEwNDE3NTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1041752?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vadimkantorov", "html_url": "https://github.com/vadimkantorov", "followers_url": "https://api.github.com/users/vadimkantorov/followers", "following_url": "https://api.github.com/users/vadimkantorov/following{/other_user}", "gists_url": "https://api.github.com/users/vadimkantorov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vadimkantorov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vadimkantorov/subscriptions", "organizations_url": "https://api.github.com/users/vadimkantorov/orgs", "repos_url": "https://api.github.com/users/vadimkantorov/repos", "events_url": "https://api.github.com/users/vadimkantorov/events{/privacy}", "received_events_url": "https://api.github.com/users/vadimkantorov/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-09T22:33:17Z", "updated_at": "2018-10-09T22:33:17Z", "author_association": "NONE", "body_html": "<p>What would happen if:<br>\n0) Does the mp.Queue lock if we push a large object?</p>\n<ol>\n<li>Priming loop puts a large enough index object so that the index_queues[i].put() locks, two times num_workers</li>\n<li>Workers are all locked at data_queue.put()</li>\n<li>Everything is locked, because number of batches under priming well exceeds the number of workers (that are all locked, since the main thread is locked at adding large indices objects)</li>\n</ol>\n<p>This can only happen if the queue locks (and not throws) when a large object is put in.</p>", "body_text": "What would happen if:\n0) Does the mp.Queue lock if we push a large object?\n\nPriming loop puts a large enough index object so that the index_queues[i].put() locks, two times num_workers\nWorkers are all locked at data_queue.put()\nEverything is locked, because number of batches under priming well exceeds the number of workers (that are all locked, since the main thread is locked at adding large indices objects)\n\nThis can only happen if the queue locks (and not throws) when a large object is put in.", "body": "What would happen if:\r\n0) Does the mp.Queue lock if we push a large object?\r\n1) Priming loop puts a large enough index object so that the index_queues[i].put() locks, two times num_workers\r\n2) Workers are all locked at data_queue.put()\r\n3) Everything is locked, because number of batches under priming well exceeds the number of workers (that are all locked, since the main thread is locked at adding large indices objects)\r\n\r\nThis can only happen if the queue locks (and not throws) when a large object is put in."}