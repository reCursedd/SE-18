{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/396084438", "html_url": "https://github.com/pytorch/pytorch/pull/8313#issuecomment-396084438", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8313", "id": 396084438, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjA4NDQzOA==", "user": {"login": "bstriner", "id": 12462956, "node_id": "MDQ6VXNlcjEyNDYyOTU2", "avatar_url": "https://avatars3.githubusercontent.com/u/12462956?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bstriner", "html_url": "https://github.com/bstriner", "followers_url": "https://api.github.com/users/bstriner/followers", "following_url": "https://api.github.com/users/bstriner/following{/other_user}", "gists_url": "https://api.github.com/users/bstriner/gists{/gist_id}", "starred_url": "https://api.github.com/users/bstriner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bstriner/subscriptions", "organizations_url": "https://api.github.com/users/bstriner/orgs", "repos_url": "https://api.github.com/users/bstriner/repos", "events_url": "https://api.github.com/users/bstriner/events{/privacy}", "received_events_url": "https://api.github.com/users/bstriner/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-10T21:46:28Z", "updated_at": "2018-06-10T21:46:28Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1310570\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/soumith\">@soumith</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9998726\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/peterjc123\">@peterjc123</a> Any thoughts on an approach to this current error (unrelated to this PR)? It looks like onnx sets /WX (treat warnings as errors) and includes protobuf, and protobuf has a small warning in it (forcing int to bool). Making that an atomic bool instead of an atomic int is marked as a todo in protobuf (at least the version that is the submodule).</p>\n<p>Maybe remove the /WX from onnx, fix or supress the warning in protobuf, or try updating the submodules to see if there are any changes. Not sure if there would be a good way to inject a pragma disable from torch that would propagate through onnx to protobuf.</p>\n<p>Relevant build log below:</p>\n<pre><code> C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\CL.exe /c /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\eigen\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\pybind11\\include\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\cub\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\onnx\" /nologo /W3 /WX /MP /O2 /Ob2 /D WIN32 /D _WINDOWS /D NDEBUG /D ONNX_NAMESPACE=onnx_c2 /D \"CMAKE_INTDIR=\\\"Release\\\"\" /D _MBCS /Gm- /EHsc /MT /GS /fp:precise /Zc:wchar_t /Zc:forScope /Zc:inline /GR /Fo\"onnx_proto.dir\\Release\\\\\" /Fd\"onnx_proto.dir\\Release\\onnx_proto.pdb\" /Gd /TP /wd4146 /errorReport:queue \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc\" \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc\"\n...\n20:26:13      3&gt;Done Building Project \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\caffe2\\caffe2_protos.vcxproj\" (default targets).\n20:26:13     19&gt;C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): error C2220: warning treated as error - no 'object' file generated (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19&gt;C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): warning C4800: 'google::protobuf::internal::Atomic64': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19&gt;C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): error C2220: warning treated as error - no 'object' file generated (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19&gt;C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): warning C4800: 'google::protobuf::internal::Atomic64': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19&gt;C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/generated_message_util.h(160): warning C4800: 'google::protobuf::uint32': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19&gt;C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/generated_message_util.h(160): warning C4800: 'google::protobuf::uint32': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n</code></pre>", "body_text": "@soumith @peterjc123 Any thoughts on an approach to this current error (unrelated to this PR)? It looks like onnx sets /WX (treat warnings as errors) and includes protobuf, and protobuf has a small warning in it (forcing int to bool). Making that an atomic bool instead of an atomic int is marked as a todo in protobuf (at least the version that is the submodule).\nMaybe remove the /WX from onnx, fix or supress the warning in protobuf, or try updating the submodules to see if there are any changes. Not sure if there would be a good way to inject a pragma disable from torch that would propagate through onnx to protobuf.\nRelevant build log below:\n C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\CL.exe /c /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\eigen\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\pybind11\\include\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\cub\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\onnx\" /nologo /W3 /WX /MP /O2 /Ob2 /D WIN32 /D _WINDOWS /D NDEBUG /D ONNX_NAMESPACE=onnx_c2 /D \"CMAKE_INTDIR=\\\"Release\\\"\" /D _MBCS /Gm- /EHsc /MT /GS /fp:precise /Zc:wchar_t /Zc:forScope /Zc:inline /GR /Fo\"onnx_proto.dir\\Release\\\\\" /Fd\"onnx_proto.dir\\Release\\onnx_proto.pdb\" /Gd /TP /wd4146 /errorReport:queue \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc\" \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc\"\n...\n20:26:13      3>Done Building Project \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\caffe2\\caffe2_protos.vcxproj\" (default targets).\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): error C2220: warning treated as error - no 'object' file generated (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): warning C4800: 'google::protobuf::internal::Atomic64': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): error C2220: warning treated as error - no 'object' file generated (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): warning C4800: 'google::protobuf::internal::Atomic64': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/generated_message_util.h(160): warning C4800: 'google::protobuf::uint32': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/generated_message_util.h(160): warning C4800: 'google::protobuf::uint32': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]", "body": "@soumith @peterjc123 Any thoughts on an approach to this current error (unrelated to this PR)? It looks like onnx sets /WX (treat warnings as errors) and includes protobuf, and protobuf has a small warning in it (forcing int to bool). Making that an atomic bool instead of an atomic int is marked as a todo in protobuf (at least the version that is the submodule).\r\n\r\nMaybe remove the /WX from onnx, fix or supress the warning in protobuf, or try updating the submodules to see if there are any changes. Not sure if there would be a good way to inject a pragma disable from torch that would propagate through onnx to protobuf.\r\n\r\nRelevant build log below:\r\n```\r\n C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin\\x86_amd64\\CL.exe /c /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\eigen\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\pybind11\\include\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\cmake\\..\\third_party\\cub\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\" /I\"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\onnx\" /nologo /W3 /WX /MP /O2 /Ob2 /D WIN32 /D _WINDOWS /D NDEBUG /D ONNX_NAMESPACE=onnx_c2 /D \"CMAKE_INTDIR=\\\"Release\\\"\" /D _MBCS /Gm- /EHsc /MT /GS /fp:precise /Zc:wchar_t /Zc:forScope /Zc:inline /GR /Fo\"onnx_proto.dir\\Release\\\\\" /Fd\"onnx_proto.dir\\Release\\onnx_proto.pdb\" /Gd /TP /wd4146 /errorReport:queue \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc\" \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc\"\r\n...\r\n20:26:13      3>Done Building Project \"C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\caffe2\\caffe2_protos.vcxproj\" (default targets).\r\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): error C2220: warning treated as error - no 'object' file generated (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\r\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): warning C4800: 'google::protobuf::internal::Atomic64': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\r\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): error C2220: warning treated as error - no 'object' file generated (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\r\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/io/coded_stream.h(869): warning C4800: 'google::protobuf::internal::Atomic64': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\r\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/generated_message_util.h(160): warning C4800: 'google::protobuf::uint32': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\r\n20:26:13     19>C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\third_party\\protobuf\\src\\google/protobuf/generated_message_util.h(160): warning C4800: 'google::protobuf::uint32': forcing value to bool 'true' or 'false' (performance warning) (compiling source file C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx\\onnx-operators_onnx_c2.pb.cc) [C:\\Jenkins\\workspace\\caffe2-builds\\py2-cuda9.0-cudnn7-windows-build\\build\\third_party\\onnx\\onnx_proto.vcxproj]\r\n```"}