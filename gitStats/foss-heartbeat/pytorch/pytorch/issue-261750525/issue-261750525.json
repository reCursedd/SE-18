{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2905", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2905/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2905/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2905/events", "html_url": "https://github.com/pytorch/pytorch/issues/2905", "id": 261750525, "node_id": "MDU6SXNzdWUyNjE3NTA1MjU=", "number": 2905, "title": "Error while updating shared grads", "user": {"login": "shiretzet", "id": 19285900, "node_id": "MDQ6VXNlcjE5Mjg1OTAw", "avatar_url": "https://avatars0.githubusercontent.com/u/19285900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shiretzet", "html_url": "https://github.com/shiretzet", "followers_url": "https://api.github.com/users/shiretzet/followers", "following_url": "https://api.github.com/users/shiretzet/following{/other_user}", "gists_url": "https://api.github.com/users/shiretzet/gists{/gist_id}", "starred_url": "https://api.github.com/users/shiretzet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shiretzet/subscriptions", "organizations_url": "https://api.github.com/users/shiretzet/orgs", "repos_url": "https://api.github.com/users/shiretzet/repos", "events_url": "https://api.github.com/users/shiretzet/events{/privacy}", "received_events_url": "https://api.github.com/users/shiretzet/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-09-29T19:43:17Z", "updated_at": "2017-12-13T03:56:13Z", "closed_at": "2017-09-29T21:39:13Z", "author_association": "NONE", "body_html": "<p>I followed the example of A3C - <a href=\"https://github.com/ikostrikov/pytorch-a3c\">link</a>, and got an error in this function:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">ensure_shared_grads</span>(<span class=\"pl-smi\">model</span>, <span class=\"pl-smi\">shared_model</span>):\n    <span class=\"pl-k\">for</span> param, shared_param <span class=\"pl-k\">in</span> <span class=\"pl-c1\">zip</span>(model.parameters(),\n                                   shared_model.parameters()):\n        <span class=\"pl-k\">if</span> shared_param.grad <span class=\"pl-k\">is</span> <span class=\"pl-k\">not</span> <span class=\"pl-c1\">None</span>:\n            <span class=\"pl-k\">return</span>\n        shared_param._grad <span class=\"pl-k\">=</span> param.grad</pre></div>\n<p>ERROR:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c1\">...</span>\nshared_param._grad <span class=\"pl-k\">=</span> param.grad\n<span class=\"pl-c1\">RuntimeError</span>: assigned grad has data of a different <span class=\"pl-c1\">type</span></pre></div>\n<p>Type of shared_param._grad == &lt;class 'NoneType'&gt;<br>\nType of param.grad == &lt;class 'torch.autograd.variable.Variable'&gt;</p>\n<p>Why is that?</p>\n<p>Thanks</p>\n<p>UPDATE : This does not happen on CPU, only CUDA</p>", "body_text": "I followed the example of A3C - link, and got an error in this function:\ndef ensure_shared_grads(model, shared_model):\n    for param, shared_param in zip(model.parameters(),\n                                   shared_model.parameters()):\n        if shared_param.grad is not None:\n            return\n        shared_param._grad = param.grad\nERROR:\n...\nshared_param._grad = param.grad\nRuntimeError: assigned grad has data of a different type\nType of shared_param._grad == <class 'NoneType'>\nType of param.grad == <class 'torch.autograd.variable.Variable'>\nWhy is that?\nThanks\nUPDATE : This does not happen on CPU, only CUDA", "body": "I followed the example of A3C - [link](https://github.com/ikostrikov/pytorch-a3c), and got an error in this function:\r\n```python\r\ndef ensure_shared_grads(model, shared_model):\r\n    for param, shared_param in zip(model.parameters(),\r\n                                   shared_model.parameters()):\r\n        if shared_param.grad is not None:\r\n            return\r\n        shared_param._grad = param.grad\r\n```\r\nERROR:\r\n```python\r\n...\r\nshared_param._grad = param.grad\r\nRuntimeError: assigned grad has data of a different type\r\n```\r\nType of shared_param._grad == <class 'NoneType'>\r\nType of param.grad == <class 'torch.autograd.variable.Variable'>\r\n\r\nWhy is that?\r\n\r\nThanks\r\n\r\nUPDATE : This does not happen on CPU, only CUDA"}