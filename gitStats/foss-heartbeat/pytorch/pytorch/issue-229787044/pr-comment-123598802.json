{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/123598802", "pull_request_review_id": 45819235, "id": 123598802, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMzU5ODgwMg==", "diff_hunk": "@@ -14,13 +14,19 @@ def forward(ctx, i, index):\n         ctx.input_size = i.size()\n         ctx.index = index\n         result = i.index(ctx.index)\n-        ctx.mark_shared_storage((i, result))\n+        ctx.advanced_indexing = i._check_advanced_indexing(index)\n+        if not ctx.advanced_indexing:\n+            ctx.mark_shared_storage((i, result))\n         return result\n \n     @staticmethod\n     def backward(ctx, grad_output):\n-        grad_input = Variable(grad_output.data.new(ctx.input_size).zero_())\n-        grad_input[ctx.index] = grad_output\n+        grad_input = grad_output.data.new(ctx.input_size).zero_()\n+        grad_input = Variable(grad_input)\n+        if ctx.advanced_indexing:\n+            grad_input._advanced_index_add(ctx.index, grad_output)\n+        else:\n+            grad_input[ctx.index] = grad_output", "path": "torch/autograd/_functions/tensor.py", "position": 19, "original_position": 19, "commit_id": "99ce824c967a7ed87303842db5478d6b7d509b2f", "original_commit_id": "7794c92efab6a8b7b27b92142ac08484fd885bbb", "user": {"login": "killeent", "id": 4529377, "node_id": "MDQ6VXNlcjQ1MjkzNzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/4529377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/killeent", "html_url": "https://github.com/killeent", "followers_url": "https://api.github.com/users/killeent/followers", "following_url": "https://api.github.com/users/killeent/following{/other_user}", "gists_url": "https://api.github.com/users/killeent/gists{/gist_id}", "starred_url": "https://api.github.com/users/killeent/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/killeent/subscriptions", "organizations_url": "https://api.github.com/users/killeent/orgs", "repos_url": "https://api.github.com/users/killeent/repos", "events_url": "https://api.github.com/users/killeent/events{/privacy}", "received_events_url": "https://api.github.com/users/killeent/received_events", "type": "User", "site_admin": false}, "body": "Advanced indexing is only triggered if we have `ndim` sequence objects, where `ndim` is the number of dimensions of the Tensor being indexed. In subsequent PRs, with more advanced indexing functionality, this will be relaxed.", "created_at": "2017-06-22T19:14:27Z", "updated_at": "2018-11-23T15:33:58Z", "html_url": "https://github.com/pytorch/pytorch/pull/1588#discussion_r123598802", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/1588", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/123598802"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/1588#discussion_r123598802"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/1588"}}, "body_html": "<p>Advanced indexing is only triggered if we have <code>ndim</code> sequence objects, where <code>ndim</code> is the number of dimensions of the Tensor being indexed. In subsequent PRs, with more advanced indexing functionality, this will be relaxed.</p>", "body_text": "Advanced indexing is only triggered if we have ndim sequence objects, where ndim is the number of dimensions of the Tensor being indexed. In subsequent PRs, with more advanced indexing functionality, this will be relaxed.", "in_reply_to_id": 123589944}