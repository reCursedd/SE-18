{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/399655504", "html_url": "https://github.com/pytorch/pytorch/issues/8820#issuecomment-399655504", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8820", "id": 399655504, "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTY1NTUwNA==", "user": {"login": "saturdays", "id": 5194117, "node_id": "MDQ6VXNlcjUxOTQxMTc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5194117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saturdays", "html_url": "https://github.com/saturdays", "followers_url": "https://api.github.com/users/saturdays/followers", "following_url": "https://api.github.com/users/saturdays/following{/other_user}", "gists_url": "https://api.github.com/users/saturdays/gists{/gist_id}", "starred_url": "https://api.github.com/users/saturdays/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saturdays/subscriptions", "organizations_url": "https://api.github.com/users/saturdays/orgs", "repos_url": "https://api.github.com/users/saturdays/repos", "events_url": "https://api.github.com/users/saturdays/events{/privacy}", "received_events_url": "https://api.github.com/users/saturdays/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-23T09:08:54Z", "updated_at": "2018-06-23T09:08:54Z", "author_association": "NONE", "body_html": "<p>Here is another test that much weird.<br>\nInstead of inference in a separate script, I run validation immediately after train by save and reload. The inference result is correct. Code is:</p>\n<pre><code>epoch =0\nwhile epoch&lt;10:\n    epoch += 1\n    adjust_learning_rate(optimizer, epoch)\n    acc1 = train(args, model, device, train_loader, optimizer, epoch)\n    torch.save(model, 'checkpoints/mnist_gpu_%d.pt'%epoch)\n    acc2 = test(args, model, device, test_loader)\n    acc = (acc1+acc2)*0.5\nmodel = torch.load('checkpoints/mnist_gpu_%d.pt'%epoch)\nacc2 = test(args, model, device, test_loader)\nprint(acc2)\n</code></pre>", "body_text": "Here is another test that much weird.\nInstead of inference in a separate script, I run validation immediately after train by save and reload. The inference result is correct. Code is:\nepoch =0\nwhile epoch<10:\n    epoch += 1\n    adjust_learning_rate(optimizer, epoch)\n    acc1 = train(args, model, device, train_loader, optimizer, epoch)\n    torch.save(model, 'checkpoints/mnist_gpu_%d.pt'%epoch)\n    acc2 = test(args, model, device, test_loader)\n    acc = (acc1+acc2)*0.5\nmodel = torch.load('checkpoints/mnist_gpu_%d.pt'%epoch)\nacc2 = test(args, model, device, test_loader)\nprint(acc2)", "body": "Here is another test that much weird.\r\nInstead of inference in a separate script, I run validation immediately after train by save and reload. The inference result is correct. Code is:\r\n\r\n    epoch =0\r\n    while epoch<10:\r\n        epoch += 1\r\n        adjust_learning_rate(optimizer, epoch)\r\n        acc1 = train(args, model, device, train_loader, optimizer, epoch)\r\n        torch.save(model, 'checkpoints/mnist_gpu_%d.pt'%epoch)\r\n        acc2 = test(args, model, device, test_loader)\r\n        acc = (acc1+acc2)*0.5\r\n    model = torch.load('checkpoints/mnist_gpu_%d.pt'%epoch)\r\n    acc2 = test(args, model, device, test_loader)\r\n    print(acc2)\r\n\r\n"}