{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4296", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4296/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4296/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4296/events", "html_url": "https://github.com/pytorch/pytorch/issues/4296", "id": 283925552, "node_id": "MDU6SXNzdWUyODM5MjU1NTI=", "number": 4296, "title": "unstable `torch.potrs`, `torch.trtrs` ops", "user": {"login": "fehiepsi", "id": 4736342, "node_id": "MDQ6VXNlcjQ3MzYzNDI=", "avatar_url": "https://avatars1.githubusercontent.com/u/4736342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fehiepsi", "html_url": "https://github.com/fehiepsi", "followers_url": "https://api.github.com/users/fehiepsi/followers", "following_url": "https://api.github.com/users/fehiepsi/following{/other_user}", "gists_url": "https://api.github.com/users/fehiepsi/gists{/gist_id}", "starred_url": "https://api.github.com/users/fehiepsi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fehiepsi/subscriptions", "organizations_url": "https://api.github.com/users/fehiepsi/orgs", "repos_url": "https://api.github.com/users/fehiepsi/repos", "events_url": "https://api.github.com/users/fehiepsi/events{/privacy}", "received_events_url": "https://api.github.com/users/fehiepsi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-12-21T15:56:58Z", "updated_at": "2018-04-18T11:54:13Z", "closed_at": "2018-04-18T11:54:13Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The following simple script says that the current implementations of <code>torch.trtrs</code>, <code>torch.potrs</code> are not stable with high dimensional linear equations. These methods are useful, especially when working with Cholesky decomposition.</p>\n<pre><code>import torch\n\nA = torch.randn(100, 100).tril()\nB = torch.randn(100, 1)\nX = torch.gesv(B, A)[0]\nX_ = torch.trtrs(B, A, False)[0]\nX__ = torch.potrs(B, A, False)   # solution for (A.A_t)X = B\nprint(\"gesv error: \", torch.dist(A.matmul(X), B))\nprint(\"trtrs error: \", torch.dist(A.matmul(X_), B))\nprint(\"potrs error: \", torch.dist(A.matmul(A.t()).matmul(X__), B))\n</code></pre>\n<p>Output:</p>\n<pre><code>gesv error:  80.30836486816406\ntrtrs error:  inf\npotrs error:  nan\n</code></pre>", "body_text": "The following simple script says that the current implementations of torch.trtrs, torch.potrs are not stable with high dimensional linear equations. These methods are useful, especially when working with Cholesky decomposition.\nimport torch\n\nA = torch.randn(100, 100).tril()\nB = torch.randn(100, 1)\nX = torch.gesv(B, A)[0]\nX_ = torch.trtrs(B, A, False)[0]\nX__ = torch.potrs(B, A, False)   # solution for (A.A_t)X = B\nprint(\"gesv error: \", torch.dist(A.matmul(X), B))\nprint(\"trtrs error: \", torch.dist(A.matmul(X_), B))\nprint(\"potrs error: \", torch.dist(A.matmul(A.t()).matmul(X__), B))\n\nOutput:\ngesv error:  80.30836486816406\ntrtrs error:  inf\npotrs error:  nan", "body": "The following simple script says that the current implementations of `torch.trtrs`, `torch.potrs` are not stable with high dimensional linear equations. These methods are useful, especially when working with Cholesky decomposition.\r\n```\r\nimport torch\r\n\r\nA = torch.randn(100, 100).tril()\r\nB = torch.randn(100, 1)\r\nX = torch.gesv(B, A)[0]\r\nX_ = torch.trtrs(B, A, False)[0]\r\nX__ = torch.potrs(B, A, False)   # solution for (A.A_t)X = B\r\nprint(\"gesv error: \", torch.dist(A.matmul(X), B))\r\nprint(\"trtrs error: \", torch.dist(A.matmul(X_), B))\r\nprint(\"potrs error: \", torch.dist(A.matmul(A.t()).matmul(X__), B))\r\n```\r\nOutput:\r\n```\r\ngesv error:  80.30836486816406\r\ntrtrs error:  inf\r\npotrs error:  nan\r\n```"}