{"url": "https://api.github.com/repos/pytorch/pytorch/issues/13460", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/13460/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/13460/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/13460/events", "html_url": "https://github.com/pytorch/pytorch/issues/13460", "id": 376512859, "node_id": "MDU6SXNzdWUzNzY1MTI4NTk=", "number": 13460, "title": "What is the net *.pb file encoding?", "user": {"login": "Suhail", "id": 66225, "node_id": "MDQ6VXNlcjY2MjI1", "avatar_url": "https://avatars1.githubusercontent.com/u/66225?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Suhail", "html_url": "https://github.com/Suhail", "followers_url": "https://api.github.com/users/Suhail/followers", "following_url": "https://api.github.com/users/Suhail/following{/other_user}", "gists_url": "https://api.github.com/users/Suhail/gists{/gist_id}", "starred_url": "https://api.github.com/users/Suhail/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Suhail/subscriptions", "organizations_url": "https://api.github.com/users/Suhail/orgs", "repos_url": "https://api.github.com/users/Suhail/repos", "events_url": "https://api.github.com/users/Suhail/events{/privacy}", "received_events_url": "https://api.github.com/users/Suhail/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-01T18:26:20Z", "updated_at": "2018-11-07T16:07:03Z", "closed_at": "2018-11-07T16:06:41Z", "author_association": "NONE", "body_html": "<p>Hi there,</p>\n<p>I am running the following code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">with</span> <span class=\"pl-c1\">open</span>(<span class=\"pl-c1\">EXPORT_PATH</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>mnist_init_net.pb<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-v\">encoding</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>utf-8<span class=\"pl-pds\">\"</span></span>) <span class=\"pl-k\">as</span> f:\n    init_net <span class=\"pl-k\">=</span> f.read()</pre></div>\n<p>I get the following error:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c1\">UnicodeDecodeError</span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>utf-8<span class=\"pl-pds\">'</span></span> codec can<span class=\"pl-s\"><span class=\"pl-pds\">'</span>t decode byte 0xf1 in position 24: invalid continuation byte<span class=\"pl-ii\"></span></span></pre></div>\n<p>It seems like the simple thing to do is to change the encoding type from not being utf-8 (which open() defaults to it seems in this case). What encoding should I use?</p>\n<p>mnist_init_net.pb file is generated via:</p>\n<div class=\"highlight highlight-source-python\"><pre>init_net, predict_net <span class=\"pl-k\">=</span> c2.onnx_graph_to_caffe2_net(model)\n<span class=\"pl-k\">with</span> <span class=\"pl-c1\">open</span>(<span class=\"pl-c1\">EXPORT_PATH</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>mnist_init_net.pb<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>wb<span class=\"pl-pds\">\"</span></span>) <span class=\"pl-k\">as</span> f:\n    f.write(init_net.SerializeToString())</pre></div>\n<p>Is ISO-8859-1 correct?</p>\n<hr>\n<pre><code>python -c \"import torch; print(torch.__version__)\"\n1.0.0.dev20181029\n\npython -c \"import onnx; print(onnx.__version__)\"\n1.3.0\n\nOS: OS X 10.13\n\npython --version\nPython 3.6.6 :: Anaconda custom (64-bit)\n</code></pre>", "body_text": "Hi there,\nI am running the following code:\nwith open(EXPORT_PATH + \"mnist_init_net.pb\", encoding=\"utf-8\") as f:\n    init_net = f.read()\nI get the following error:\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 24: invalid continuation byte\nIt seems like the simple thing to do is to change the encoding type from not being utf-8 (which open() defaults to it seems in this case). What encoding should I use?\nmnist_init_net.pb file is generated via:\ninit_net, predict_net = c2.onnx_graph_to_caffe2_net(model)\nwith open(EXPORT_PATH + \"mnist_init_net.pb\", \"wb\") as f:\n    f.write(init_net.SerializeToString())\nIs ISO-8859-1 correct?\n\npython -c \"import torch; print(torch.__version__)\"\n1.0.0.dev20181029\n\npython -c \"import onnx; print(onnx.__version__)\"\n1.3.0\n\nOS: OS X 10.13\n\npython --version\nPython 3.6.6 :: Anaconda custom (64-bit)", "body": "Hi there,\r\n\r\nI am running the following code:\r\n\r\n```python\r\nwith open(EXPORT_PATH + \"mnist_init_net.pb\", encoding=\"utf-8\") as f:\r\n    init_net = f.read()\r\n```\r\n\r\nI get the following error:\r\n```python\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 24: invalid continuation byte\r\n```\r\n\r\nIt seems like the simple thing to do is to change the encoding type from not being utf-8 (which open() defaults to it seems in this case). What encoding should I use?\r\n\r\nmnist_init_net.pb file is generated via:\r\n\r\n```python\r\ninit_net, predict_net = c2.onnx_graph_to_caffe2_net(model)\r\nwith open(EXPORT_PATH + \"mnist_init_net.pb\", \"wb\") as f:\r\n    f.write(init_net.SerializeToString())\r\n```\r\n\r\nIs ISO-8859-1 correct?\r\n\r\n---- \r\n```\r\npython -c \"import torch; print(torch.__version__)\"\r\n1.0.0.dev20181029\r\n\r\npython -c \"import onnx; print(onnx.__version__)\"\r\n1.3.0\r\n\r\nOS: OS X 10.13\r\n\r\npython --version\r\nPython 3.6.6 :: Anaconda custom (64-bit)\r\n```"}