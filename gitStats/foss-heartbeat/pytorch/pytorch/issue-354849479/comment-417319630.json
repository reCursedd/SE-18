{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/417319630", "html_url": "https://github.com/pytorch/pytorch/issues/10960#issuecomment-417319630", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/10960", "id": 417319630, "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzMxOTYzMA==", "user": {"login": "hanyunfan", "id": 6924448, "node_id": "MDQ6VXNlcjY5MjQ0NDg=", "avatar_url": "https://avatars2.githubusercontent.com/u/6924448?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hanyunfan", "html_url": "https://github.com/hanyunfan", "followers_url": "https://api.github.com/users/hanyunfan/followers", "following_url": "https://api.github.com/users/hanyunfan/following{/other_user}", "gists_url": "https://api.github.com/users/hanyunfan/gists{/gist_id}", "starred_url": "https://api.github.com/users/hanyunfan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hanyunfan/subscriptions", "organizations_url": "https://api.github.com/users/hanyunfan/orgs", "repos_url": "https://api.github.com/users/hanyunfan/repos", "events_url": "https://api.github.com/users/hanyunfan/events{/privacy}", "received_events_url": "https://api.github.com/users/hanyunfan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-30T13:29:42Z", "updated_at": "2018-08-30T13:29:42Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9845\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pietern\">@pietern</a> Thank you but without FULL_CAFFFE2=1, it still reporting errors, here are details:</p>\n<p>[ 66%] Linking CXX executable FileStoreTest<br>\ncd /home/frank/pytorch/torch/lib/build/c10d/test &amp;&amp; /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/FileStoreTest.dir/link.txt --verbose=1<br>\n/bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o  -o FileStoreTest  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so<br>\n/home/frank/pytorch/torch/lib/c10d/example/allreduce.cpp: In function \u2018int main(int, char**)\u2019:<br>\n/home/frank/pytorch/torch/lib/c10d/example/allreduce.cpp:16:64: warning: \u2018at::Tensor at::ones(const at::Type&amp;, at::IntList)\u2019 is deprecated (declared at <strong>/home/frank/pytorch/torch/lib/tmp_install/include/ATen/Functions.h:3991) [-Wdeprecated-declarations]<br>\nauto x = at::ones(at::CPU(at::kFloat), {1000, 16 * (i + 1)});</strong><br>\n^<br>\nmake[2]: Leaving directory <code>/home/frank/pytorch/torch/lib/build/c10d' [ 66%] Built target FileStoreTest [ 71%] Linking CXX executable allreduce cd /home/frank/pytorch/torch/lib/build/c10d/example &amp;&amp; /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/allreduce.dir/link.txt --verbose=1 /bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/allreduce.dir/allreduce.cpp.o  -o allreduce  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so [ 76%] Linking CXX executable TCPStoreTest cd /home/frank/pytorch/torch/lib/build/c10d/test &amp;&amp; /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/TCPStoreTest.dir/link.txt --verbose=1 /bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o  -o TCPStoreTest  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so ../libc10d.a(ProcessGroupGloo.cpp.o): In function </code>std::_Function_handler&lt;void (), c10d::ProcessGroupGloo::broadcast(std::vector&lt;at::Tensor, std::allocatorat::Tensor &gt;&amp;, c10d::BroadcastOptions const&amp;)::{lambda()<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171281708\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1\">#1</a>}&gt;::_M_invoke(std::_Any_data const&amp;)':<br>\nProcessGroupGloo.cpp:(.text+0x1c53): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function </code>std::_Function_handler&lt;void (), c10d::ProcessGroupGloo::allreduce(std::vector&lt;at::Tensor, std::allocatorat::Tensor &gt;&amp;, c10d::AllreduceOptions const&amp;)::{lambda()<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171281708\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1\">#1</a>}&gt;::_M_invoke(std::_Any_data const&amp;)':<br>\nProcessGroupGloo.cpp:(.text+0x1f13): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function </code>at::DeviceGuard::set_index(int)':<br>\nProcessGroupGloo.cpp:(.text._ZN2at11DeviceGuard9set_indexEi[_ZN2at11DeviceGuard9set_indexEi]+0xcc): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function </code>c10d::THCStreamGuard::~THCStreamGuard()':<br>\nProcessGroupGloo.cpp:(.text._ZN4c10d14THCStreamGuardD2Ev[_ZN4c10d14THCStreamGuardD5Ev]+0x144): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function </code>std::vector&lt;at::Tensor, std::allocatorat::Tensor &gt;::vector(std::vector&lt;at::Tensor, std::allocatorat::Tensor &gt; const&amp;)':<br>\nProcessGroupGloo.cpp:(.text.<em>ZNSt6vectorIN2at6TensorESaIS1_EEC2ERKS3</em>[<em>ZNSt6vectorIN2at6TensorESaIS1_EEC5ERKS3</em>]+0x283): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function </code>gloo::BroadcastOneToAll::BroadcastOneToAll(std::shared_ptrgloo::Context const&amp;, std::vector&lt;float*, std::allocator&lt;float*&gt; &gt; const&amp;, unsigned long, int, int)':<br>\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x3b8): undefined reference to <code>gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&amp;)' ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x4a8): undefined reference to </code>gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&amp;)'<br>\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x882): undefined reference to <code>gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&amp;)' ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x90b): undefined reference to </code>gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&amp;)'<br>\n../libc10d.a(ProcessGroupGloo.cpp.o): In function <code>gloo::BroadcastOneToAll&lt;double&gt;::BroadcastOneToAll(std::shared_ptr&lt;gloo::Context&gt; const&amp;, std::vector&lt;double*, std::allocator&lt;double*&gt; &gt; const&amp;, unsigned long, int, int)': ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIdEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIdEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii]+0x3b8): undefined reference to </code>gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&amp;)'<br>\n../libc10d.a(ProcessGroupGloo.cpp.o):ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIdEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIdEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii]+0x4a8): more undefined references to <code>gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&amp;)' follow CMakeFiles/allreduce.dir/allreduce.cpp.o: In function </code>void std::vector&lt;at::Tensor, std::allocatorat::Tensor &gt;::_M_emplace_back_aux&lt;at::Tensor const&amp;&gt;(at::Tensor const&amp;)':<br>\nallreduce.cpp:(.text.<em>ZNSt6vectorIN2at6TensorESaIS1_EE19_M_emplace_back_auxIIRKS1_EEEvDpOT</em>[<em>ZNSt6vectorIN2at6TensorESaIS1_EE19_M_emplace_back_auxIIRKS1_EEEvDpOT</em>]+0x271): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' CMakeFiles/allreduce.dir/allreduce.cpp.o: In function </code>main':<br>\nallreduce.cpp:(.text.startup+0x75e): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' allreduce.cpp:(.text.startup+0x7e9): undefined reference to </code>at::Error::Error(at::SourceLocation, std::string const&amp;)'<br>\nallreduce.cpp:(.text.startup+0x995): undefined reference to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' allreduce.cpp:(.text.startup+0xb14): undefined reference to </code>at::Error::Error(at::SourceLocation, std::string const&amp;)'<br>\nCMakeFiles/allreduce.dir/allreduce.cpp.o:allreduce.cpp:(.text.startup+0xd62): more undefined references to <code>at::Error::Error(at::SourceLocation, std::string const&amp;)' follow collect2: error: ld returned 1 exit status make[2]: *** [example/allreduce] Error 1 make[2]: Leaving directory </code>/home/frank/pytorch/torch/lib/build/c10d'<br>\nmake[1]: *** [example/CMakeFiles/allreduce.dir/all] Error 2<br>\nmake[1]: *** Waiting for unfinished jobs....<br>\nmake[2]: Leaving directory <code>/home/frank/pytorch/torch/lib/build/c10d' [ 76%] Built target TCPStoreTest Generated /home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir//./c10d_cuda_test_generated_CUDATest.cu.o successfully. cd /home/frank/pytorch/torch/lib/build/c10d &amp;&amp; /home/frank/miniconda2/bin/cmake -E cmake_depends \"Unix Makefiles\" /home/frank/pytorch/torch/lib/c10d /home/frank/pytorch/torch/lib/c10d/test /home/frank/pytorch/torch/lib/build/c10d /home/frank/pytorch/torch/lib/build/c10d/test /home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/DependInfo.cmake --color= Dependee \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/DependInfo.cmake\" is newer than depender \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/depend.internal\". Dependee \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/CMakeDirectoryInformation.cmake\" is newer than depender \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/depend.internal\". Scanning dependencies of target c10d_cuda_test make[2]: Leaving directory </code>/home/frank/pytorch/torch/lib/build/c10d'<br>\nmake -f test/CMakeFiles/c10d_cuda_test.dir/build.make test/CMakeFiles/c10d_cuda_test.dir/build<br>\nmake[2]: Entering directory <code>/home/frank/pytorch/torch/lib/build/c10d' [ 80%] Linking CXX static library libc10d_cuda_test.a cd /home/frank/pytorch/torch/lib/build/c10d/test &amp;&amp; /home/frank/miniconda2/bin/cmake -P CMakeFiles/c10d_cuda_test.dir/cmake_clean_target.cmake cd /home/frank/pytorch/torch/lib/build/c10d/test &amp;&amp; /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/c10d_cuda_test.dir/link.txt --verbose=1 /bin/ar qc libc10d_cuda_test.a  CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o /bin/ranlib libc10d_cuda_test.a make[2]: Leaving directory </code>/home/frank/pytorch/torch/lib/build/c10d'<br>\n[ 80%] Built target c10d_cuda_test<br>\nmake[1]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'<br>\nmake: *** [all] Error 2<br>\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn --use-gloo-ibverbs nccl caffe2 libshm gloo THD c10d'</p>", "body_text": "@pietern Thank you but without FULL_CAFFFE2=1, it still reporting errors, here are details:\n[ 66%] Linking CXX executable FileStoreTest\ncd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/FileStoreTest.dir/link.txt --verbose=1\n/bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o  -o FileStoreTest  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so\n/home/frank/pytorch/torch/lib/c10d/example/allreduce.cpp: In function \u2018int main(int, char**)\u2019:\n/home/frank/pytorch/torch/lib/c10d/example/allreduce.cpp:16:64: warning: \u2018at::Tensor at::ones(const at::Type&, at::IntList)\u2019 is deprecated (declared at /home/frank/pytorch/torch/lib/tmp_install/include/ATen/Functions.h:3991) [-Wdeprecated-declarations]\nauto x = at::ones(at::CPU(at::kFloat), {1000, 16 * (i + 1)});\n^\nmake[2]: Leaving directory /home/frank/pytorch/torch/lib/build/c10d' [ 66%] Built target FileStoreTest [ 71%] Linking CXX executable allreduce cd /home/frank/pytorch/torch/lib/build/c10d/example && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/allreduce.dir/link.txt --verbose=1 /bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/allreduce.dir/allreduce.cpp.o  -o allreduce  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so [ 76%] Linking CXX executable TCPStoreTest cd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/TCPStoreTest.dir/link.txt --verbose=1 /bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o  -o TCPStoreTest  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so ../libc10d.a(ProcessGroupGloo.cpp.o): In function std::_Function_handler<void (), c10d::ProcessGroupGloo::broadcast(std::vector<at::Tensor, std::allocatorat::Tensor >&, c10d::BroadcastOptions const&)::{lambda()#1}>::_M_invoke(std::_Any_data const&)':\nProcessGroupGloo.cpp:(.text+0x1c53): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function std::_Function_handler<void (), c10d::ProcessGroupGloo::allreduce(std::vector<at::Tensor, std::allocatorat::Tensor >&, c10d::AllreduceOptions const&)::{lambda()#1}>::_M_invoke(std::_Any_data const&)':\nProcessGroupGloo.cpp:(.text+0x1f13): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function at::DeviceGuard::set_index(int)':\nProcessGroupGloo.cpp:(.text._ZN2at11DeviceGuard9set_indexEi[_ZN2at11DeviceGuard9set_indexEi]+0xcc): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function c10d::THCStreamGuard::~THCStreamGuard()':\nProcessGroupGloo.cpp:(.text._ZN4c10d14THCStreamGuardD2Ev[_ZN4c10d14THCStreamGuardD5Ev]+0x144): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function std::vector<at::Tensor, std::allocatorat::Tensor >::vector(std::vector<at::Tensor, std::allocatorat::Tensor > const&)':\nProcessGroupGloo.cpp:(.text.ZNSt6vectorIN2at6TensorESaIS1_EEC2ERKS3[ZNSt6vectorIN2at6TensorESaIS1_EEC5ERKS3]+0x283): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' ../libc10d.a(ProcessGroupGloo.cpp.o): In function gloo::BroadcastOneToAll::BroadcastOneToAll(std::shared_ptrgloo::Context const&, std::vector<float*, std::allocator<float*> > const&, unsigned long, int, int)':\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x3b8): undefined reference to gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)' ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x4a8): undefined reference to gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x882): undefined reference to gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)' ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x90b): undefined reference to gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\n../libc10d.a(ProcessGroupGloo.cpp.o): In function gloo::BroadcastOneToAll<double>::BroadcastOneToAll(std::shared_ptr<gloo::Context> const&, std::vector<double*, std::allocator<double*> > const&, unsigned long, int, int)': ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIdEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIdEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii]+0x3b8): undefined reference to gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\n../libc10d.a(ProcessGroupGloo.cpp.o):ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIdEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIdEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii]+0x4a8): more undefined references to gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)' follow CMakeFiles/allreduce.dir/allreduce.cpp.o: In function void std::vector<at::Tensor, std::allocatorat::Tensor >::_M_emplace_back_aux<at::Tensor const&>(at::Tensor const&)':\nallreduce.cpp:(.text.ZNSt6vectorIN2at6TensorESaIS1_EE19_M_emplace_back_auxIIRKS1_EEEvDpOT[ZNSt6vectorIN2at6TensorESaIS1_EE19_M_emplace_back_auxIIRKS1_EEEvDpOT]+0x271): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' CMakeFiles/allreduce.dir/allreduce.cpp.o: In function main':\nallreduce.cpp:(.text.startup+0x75e): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' allreduce.cpp:(.text.startup+0x7e9): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)'\nallreduce.cpp:(.text.startup+0x995): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)' allreduce.cpp:(.text.startup+0xb14): undefined reference to at::Error::Error(at::SourceLocation, std::string const&)'\nCMakeFiles/allreduce.dir/allreduce.cpp.o:allreduce.cpp:(.text.startup+0xd62): more undefined references to at::Error::Error(at::SourceLocation, std::string const&)' follow collect2: error: ld returned 1 exit status make[2]: *** [example/allreduce] Error 1 make[2]: Leaving directory /home/frank/pytorch/torch/lib/build/c10d'\nmake[1]: *** [example/CMakeFiles/allreduce.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\nmake[2]: Leaving directory /home/frank/pytorch/torch/lib/build/c10d' [ 76%] Built target TCPStoreTest Generated /home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir//./c10d_cuda_test_generated_CUDATest.cu.o successfully. cd /home/frank/pytorch/torch/lib/build/c10d && /home/frank/miniconda2/bin/cmake -E cmake_depends \"Unix Makefiles\" /home/frank/pytorch/torch/lib/c10d /home/frank/pytorch/torch/lib/c10d/test /home/frank/pytorch/torch/lib/build/c10d /home/frank/pytorch/torch/lib/build/c10d/test /home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/DependInfo.cmake --color= Dependee \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/DependInfo.cmake\" is newer than depender \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/depend.internal\". Dependee \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/CMakeDirectoryInformation.cmake\" is newer than depender \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/depend.internal\". Scanning dependencies of target c10d_cuda_test make[2]: Leaving directory /home/frank/pytorch/torch/lib/build/c10d'\nmake -f test/CMakeFiles/c10d_cuda_test.dir/build.make test/CMakeFiles/c10d_cuda_test.dir/build\nmake[2]: Entering directory /home/frank/pytorch/torch/lib/build/c10d' [ 80%] Linking CXX static library libc10d_cuda_test.a cd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -P CMakeFiles/c10d_cuda_test.dir/cmake_clean_target.cmake cd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/c10d_cuda_test.dir/link.txt --verbose=1 /bin/ar qc libc10d_cuda_test.a  CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o /bin/ranlib libc10d_cuda_test.a make[2]: Leaving directory /home/frank/pytorch/torch/lib/build/c10d'\n[ 80%] Built target c10d_cuda_test\nmake[1]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\nmake: *** [all] Error 2\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn --use-gloo-ibverbs nccl caffe2 libshm gloo THD c10d'", "body": "@pietern Thank you but without FULL_CAFFFE2=1, it still reporting errors, here are details:\r\n\r\n[ 66%] Linking CXX executable FileStoreTest\r\ncd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/FileStoreTest.dir/link.txt --verbose=1\r\n/bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o  -o FileStoreTest  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so\r\n/home/frank/pytorch/torch/lib/c10d/example/allreduce.cpp: In function \u2018int main(int, char**)\u2019:\r\n/home/frank/pytorch/torch/lib/c10d/example/allreduce.cpp:16:64: warning: \u2018at::Tensor at::ones(const at::Type&, at::IntList)\u2019 is deprecated (declared at **/home/frank/pytorch/torch/lib/tmp_install/include/ATen/Functions.h:3991) [-Wdeprecated-declarations]\r\n     auto x = at::ones(at::CPU(at::kFloat), {1000, 16 * (i + 1)});**\r\n                                                                ^\r\nmake[2]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\r\n[ 66%] Built target FileStoreTest\r\n[ 71%] Linking CXX executable allreduce\r\ncd /home/frank/pytorch/torch/lib/build/c10d/example && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/allreduce.dir/link.txt --verbose=1\r\n/bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/allreduce.dir/allreduce.cpp.o  -o allreduce  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so\r\n[ 76%] Linking CXX executable TCPStoreTest\r\ncd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/TCPStoreTest.dir/link.txt --verbose=1\r\n/bin/c++   -I\"/home/frank/pytorch/torch/lib/tmp_install/include\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/TH\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THC\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THS\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCS\"   -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THNN\" -I\"/home/frank/pytorch/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11 -O3 -DNDEBUG  -L\"/home/frank/pytorch/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN -rdynamic CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o  -o TCPStoreTest  -L/home/frank/miniconda2/lib -Wl,-rpath,/home/frank/pytorch/torch/lib/tmp_install/lib:/home/frank/miniconda2/lib -lpthread ../libc10d.a /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2_gpu.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcudart_static.a -ldl -lrt /home/frank/pytorch/torch/lib/tmp_install/lib/libcaffe2.so /home/frank/pytorch/torch/lib/tmp_install/lib64/libprotobuf.a -lpthread -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -fopenmp -lpthread -lm -ldl /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcufft.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcurand.so /home/rengan/apps/cudnn/7.2.1/lib64/libcudnn.so.7 /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas.so /cm/shared/apps/cuda92/toolkit/9.2.88/lib64/libcublas_device.a /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.so /home/frank/pytorch/torch/lib/tmp_install/lib/libgloo.so\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `std::_Function_handler<void (), c10d::ProcessGroupGloo::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&)::{lambda()#1}>::_M_invoke(std::_Any_data const&)':\r\nProcessGroupGloo.cpp:(.text+0x1c53): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `std::_Function_handler<void (), c10d::ProcessGroupGloo::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&)::{lambda()#1}>::_M_invoke(std::_Any_data const&)':\r\nProcessGroupGloo.cpp:(.text+0x1f13): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `at::DeviceGuard::set_index(int)':\r\nProcessGroupGloo.cpp:(.text._ZN2at11DeviceGuard9set_indexEi[_ZN2at11DeviceGuard9set_indexEi]+0xcc): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `c10d::THCStreamGuard::~THCStreamGuard()':\r\nProcessGroupGloo.cpp:(.text._ZN4c10d14THCStreamGuardD2Ev[_ZN4c10d14THCStreamGuardD5Ev]+0x144): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `std::vector<at::Tensor, std::allocator<at::Tensor> >::vector(std::vector<at::Tensor, std::allocator<at::Tensor> > const&)':\r\nProcessGroupGloo.cpp:(.text._ZNSt6vectorIN2at6TensorESaIS1_EEC2ERKS3_[_ZNSt6vectorIN2at6TensorESaIS1_EEC5ERKS3_]+0x283): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `gloo::BroadcastOneToAll<float>::BroadcastOneToAll(std::shared_ptr<gloo::Context> const&, std::vector<float*, std::allocator<float*> > const&, unsigned long, int, int)':\r\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x3b8): undefined reference to `gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\r\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x4a8): undefined reference to `gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\r\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x882): undefined reference to `gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\r\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIfEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIfEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPfSaIS8_EEmii]+0x90b): undefined reference to `gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o): In function `gloo::BroadcastOneToAll<double>::BroadcastOneToAll(std::shared_ptr<gloo::Context> const&, std::vector<double*, std::allocator<double*> > const&, unsigned long, int, int)':\r\nProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIdEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIdEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii]+0x3b8): undefined reference to `gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)'\r\n../libc10d.a(ProcessGroupGloo.cpp.o):ProcessGroupGloo.cpp:(.text._ZN4gloo17BroadcastOneToAllIdEC2ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii[_ZN4gloo17BroadcastOneToAllIdEC5ERKSt10shared_ptrINS_7ContextEERKSt6vectorIPdSaIS8_EEmii]+0x4a8): more undefined references to `gloo::EnforceNotMet::EnforceNotMet(char const*, int, char const*, std::string const&)' follow\r\nCMakeFiles/allreduce.dir/allreduce.cpp.o: In function `void std::vector<at::Tensor, std::allocator<at::Tensor> >::_M_emplace_back_aux<at::Tensor const&>(at::Tensor const&)':\r\nallreduce.cpp:(.text._ZNSt6vectorIN2at6TensorESaIS1_EE19_M_emplace_back_auxIIRKS1_EEEvDpOT_[_ZNSt6vectorIN2at6TensorESaIS1_EE19_M_emplace_back_auxIIRKS1_EEEvDpOT_]+0x271): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\nCMakeFiles/allreduce.dir/allreduce.cpp.o: In function `main':\r\nallreduce.cpp:(.text.startup+0x75e): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\nallreduce.cpp:(.text.startup+0x7e9): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\nallreduce.cpp:(.text.startup+0x995): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\nallreduce.cpp:(.text.startup+0xb14): undefined reference to `at::Error::Error(at::SourceLocation, std::string const&)'\r\nCMakeFiles/allreduce.dir/allreduce.cpp.o:allreduce.cpp:(.text.startup+0xd62): more undefined references to `at::Error::Error(at::SourceLocation, std::string const&)' follow\r\ncollect2: error: ld returned 1 exit status\r\nmake[2]: *** [example/allreduce] Error 1\r\nmake[2]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\r\nmake[1]: *** [example/CMakeFiles/allreduce.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\nmake[2]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\r\n[ 76%] Built target TCPStoreTest\r\nGenerated /home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir//./c10d_cuda_test_generated_CUDATest.cu.o successfully.\r\ncd /home/frank/pytorch/torch/lib/build/c10d && /home/frank/miniconda2/bin/cmake -E cmake_depends \"Unix Makefiles\" /home/frank/pytorch/torch/lib/c10d /home/frank/pytorch/torch/lib/c10d/test /home/frank/pytorch/torch/lib/build/c10d /home/frank/pytorch/torch/lib/build/c10d/test /home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/DependInfo.cmake --color=\r\nDependee \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/DependInfo.cmake\" is newer than depender \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/depend.internal\".\r\nDependee \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/CMakeDirectoryInformation.cmake\" is newer than depender \"/home/frank/pytorch/torch/lib/build/c10d/test/CMakeFiles/c10d_cuda_test.dir/depend.internal\".\r\nScanning dependencies of target c10d_cuda_test\r\nmake[2]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\r\nmake -f test/CMakeFiles/c10d_cuda_test.dir/build.make test/CMakeFiles/c10d_cuda_test.dir/build\r\nmake[2]: Entering directory `/home/frank/pytorch/torch/lib/build/c10d'\r\n[ 80%] Linking CXX static library libc10d_cuda_test.a\r\ncd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -P CMakeFiles/c10d_cuda_test.dir/cmake_clean_target.cmake\r\ncd /home/frank/pytorch/torch/lib/build/c10d/test && /home/frank/miniconda2/bin/cmake -E cmake_link_script CMakeFiles/c10d_cuda_test.dir/link.txt --verbose=1\r\n/bin/ar qc libc10d_cuda_test.a  CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o\r\n/bin/ranlib libc10d_cuda_test.a\r\nmake[2]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\r\n[ 80%] Built target c10d_cuda_test\r\nmake[1]: Leaving directory `/home/frank/pytorch/torch/lib/build/c10d'\r\nmake: *** [all] Error 2\r\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn --use-gloo-ibverbs nccl caffe2 libshm gloo THD c10d'\r\n"}