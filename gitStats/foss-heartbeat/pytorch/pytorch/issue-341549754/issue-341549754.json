{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9465", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9465/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9465/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9465/events", "html_url": "https://github.com/pytorch/pytorch/issues/9465", "id": 341549754, "node_id": "MDU6SXNzdWUzNDE1NDk3NTQ=", "number": 9465, "title": "Floating point exception (core dumped) with Conv2d ", "user": {"login": "rotabulo", "id": 28045295, "node_id": "MDQ6VXNlcjI4MDQ1Mjk1", "avatar_url": "https://avatars3.githubusercontent.com/u/28045295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rotabulo", "html_url": "https://github.com/rotabulo", "followers_url": "https://api.github.com/users/rotabulo/followers", "following_url": "https://api.github.com/users/rotabulo/following{/other_user}", "gists_url": "https://api.github.com/users/rotabulo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rotabulo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rotabulo/subscriptions", "organizations_url": "https://api.github.com/users/rotabulo/orgs", "repos_url": "https://api.github.com/users/rotabulo/repos", "events_url": "https://api.github.com/users/rotabulo/events{/privacy}", "received_events_url": "https://api.github.com/users/rotabulo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-07-16T14:46:23Z", "updated_at": "2018-08-29T22:28:47Z", "closed_at": "2018-08-29T22:28:36Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>The following code produces a <code>Floating point exception (core dumped)</code> on Volta series with fp16:</p>\n<pre><code>import torch\nfrom torch.nn import Conv2d\nconv=torch.nn.Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False).cuda().half()\nx=torch.rand(2,256,196,196, requires_grad=True).cuda().half()\ny=conv(x)\nloss=y.min()\nloss.backward()\n</code></pre>\n<p>By changing the convolution parameters by +1/-1 the code works.</p>\n<p>I suspect this to be a cudnn bug.</p>\n<h2>System Info</h2>\n<pre><code>Collecting environment information...\nPyTorch version: 0.4.0a0+3749c58\nIs debug build: No\nCUDA used to build PyTorch: 9.2.88\n\nOS: Ubuntu 16.04.4 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\nCMake version: version 3.5.1\n\nPython version: 3.5\nIs CUDA available: Yes\nCUDA runtime version: 9.2.88\nGPU models and configuration: \nGPU 0: TITAN V\nGPU 1: TITAN V\nGPU 2: TITAN V\nGPU 3: TITAN V\n\nNvidia driver version: 396.26\ncuDNN version: Probably one of the following:\n/usr/local/cuda-9.2/cuda/lib64/libcudnn.so.7.1.4\n/usr/local/cuda-9.2/cuda/lib64/libcudnn_static.a\n/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn.so.7.1.4\n/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn_static.a\n\nVersions of relevant libraries:\n[pip3] numpy (1.14.5)\n[pip3] torch (0.4.0a0+3749c58)\n[pip3] torchvision (0.2.1)\n[conda] Could not collect\n</code></pre>\n<p>Reproducible also on V100.</p>", "body_text": "Issue description\nThe following code produces a Floating point exception (core dumped) on Volta series with fp16:\nimport torch\nfrom torch.nn import Conv2d\nconv=torch.nn.Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False).cuda().half()\nx=torch.rand(2,256,196,196, requires_grad=True).cuda().half()\ny=conv(x)\nloss=y.min()\nloss.backward()\n\nBy changing the convolution parameters by +1/-1 the code works.\nI suspect this to be a cudnn bug.\nSystem Info\nCollecting environment information...\nPyTorch version: 0.4.0a0+3749c58\nIs debug build: No\nCUDA used to build PyTorch: 9.2.88\n\nOS: Ubuntu 16.04.4 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\nCMake version: version 3.5.1\n\nPython version: 3.5\nIs CUDA available: Yes\nCUDA runtime version: 9.2.88\nGPU models and configuration: \nGPU 0: TITAN V\nGPU 1: TITAN V\nGPU 2: TITAN V\nGPU 3: TITAN V\n\nNvidia driver version: 396.26\ncuDNN version: Probably one of the following:\n/usr/local/cuda-9.2/cuda/lib64/libcudnn.so.7.1.4\n/usr/local/cuda-9.2/cuda/lib64/libcudnn_static.a\n/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn.so.7.1.4\n/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn_static.a\n\nVersions of relevant libraries:\n[pip3] numpy (1.14.5)\n[pip3] torch (0.4.0a0+3749c58)\n[pip3] torchvision (0.2.1)\n[conda] Could not collect\n\nReproducible also on V100.", "body": "## Issue description\r\n\r\nThe following code produces a `Floating point exception (core dumped)` on Volta series with fp16:\r\n```\r\nimport torch\r\nfrom torch.nn import Conv2d\r\nconv=torch.nn.Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False).cuda().half()\r\nx=torch.rand(2,256,196,196, requires_grad=True).cuda().half()\r\ny=conv(x)\r\nloss=y.min()\r\nloss.backward()\r\n```\r\n\r\nBy changing the convolution parameters by +1/-1 the code works.\r\n\r\nI suspect this to be a cudnn bug.\r\n\r\n## System Info\r\n```\r\nCollecting environment information...\r\nPyTorch version: 0.4.0a0+3749c58\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.2.88\r\n\r\nOS: Ubuntu 16.04.4 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 3.5\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.2.88\r\nGPU models and configuration: \r\nGPU 0: TITAN V\r\nGPU 1: TITAN V\r\nGPU 2: TITAN V\r\nGPU 3: TITAN V\r\n\r\nNvidia driver version: 396.26\r\ncuDNN version: Probably one of the following:\r\n/usr/local/cuda-9.2/cuda/lib64/libcudnn.so.7.1.4\r\n/usr/local/cuda-9.2/cuda/lib64/libcudnn_static.a\r\n/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn.so.7.1.4\r\n/usr/local/cuda-9.2/targets/x86_64-linux/lib/libcudnn_static.a\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy (1.14.5)\r\n[pip3] torch (0.4.0a0+3749c58)\r\n[pip3] torchvision (0.2.1)\r\n[conda] Could not collect\r\n```\r\n\r\nReproducible also on V100."}