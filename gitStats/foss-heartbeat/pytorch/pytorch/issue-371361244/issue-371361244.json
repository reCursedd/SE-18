{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12801", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12801/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12801/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12801/events", "html_url": "https://github.com/pytorch/pytorch/issues/12801", "id": 371361244, "node_id": "MDU6SXNzdWUzNzEzNjEyNDQ=", "number": 12801, "title": "RNN issue when Converting to Torch Script via Annotation", "user": {"login": "thunn", "id": 19165683, "node_id": "MDQ6VXNlcjE5MTY1Njgz", "avatar_url": "https://avatars1.githubusercontent.com/u/19165683?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thunn", "html_url": "https://github.com/thunn", "followers_url": "https://api.github.com/users/thunn/followers", "following_url": "https://api.github.com/users/thunn/following{/other_user}", "gists_url": "https://api.github.com/users/thunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/thunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thunn/subscriptions", "organizations_url": "https://api.github.com/users/thunn/orgs", "repos_url": "https://api.github.com/users/thunn/repos", "events_url": "https://api.github.com/users/thunn/events{/privacy}", "received_events_url": "https://api.github.com/users/thunn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-10-18T04:55:15Z", "updated_at": "2018-10-18T22:50:40Z", "closed_at": "2018-10-18T22:50:40Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n\n<h2>To Reproduce</h2>\n<p>Steps to reproduce the behavior:</p>\n<ol>\n<li>Using PyTorch version 1.0.0.dev20181017 on AWS E2C Deep Learning Instance</li>\n<li>Following code:</li>\n</ol>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch \n<span class=\"pl-k\">import</span> torch.nn <span class=\"pl-k\">as</span> nn\n<span class=\"pl-c1\">print</span>(torch.<span class=\"pl-c1\">__version__</span>)\n\n<span class=\"pl-k\">class</span> <span class=\"pl-en\">test</span>(<span class=\"pl-e\">torch</span>.<span class=\"pl-e\">jit</span>.<span class=\"pl-e\">ScriptModule</span>):\n    \n    <span class=\"pl-k\">def</span> <span class=\"pl-c1\">__init__</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>, <span class=\"pl-smi\">rnn_dims</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">512</span>):\n        <span class=\"pl-c1\">super</span>().<span class=\"pl-c1\">__init__</span>()\n        <span class=\"pl-c1\">self</span>.rnn <span class=\"pl-k\">=</span> nn.GRU(<span class=\"pl-v\">input_size</span><span class=\"pl-k\">=</span>rnn_dims, <span class=\"pl-v\">hidden_size</span><span class=\"pl-k\">=</span>rnn_dims, <span class=\"pl-v\">batch_first</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n    \n    <span class=\"pl-en\">@torch.jit.script_method</span>   \n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">forward</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>, <span class=\"pl-smi\">x</span>):\n        \n        h1 <span class=\"pl-k\">=</span> (torch.zeros(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">512</span>), torch.zeros(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">512</span>))\n        out, h1 <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.rnn(x, h1[<span class=\"pl-c1\">1</span>])\n        \n        <span class=\"pl-k\">return</span> h1\n        \n        \nnet <span class=\"pl-k\">=</span> test()\n\noutput <span class=\"pl-k\">=</span> net(torch.randn(<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">512</span>))\n\n<span class=\"pl-c1\">print</span>(output.shape)\n</pre></div>\n<ol start=\"3\">\n<li>Error:</li>\n</ol>\n<pre><code>---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-33-188aafc970e8&gt; in &lt;module&gt;\n     18 \n     19 \n---&gt; 20 net = test()\n     21 \n     22 output = net(torch.randn(1,1,512))\n\n/home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/jit/__init__.py in init_then_register(self, *args, **kwargs)\n    915             rcbs = [m.resolution_callback for m in methods]\n    916             defaults = [get_default_args(m.original_method) for m in methods]\n--&gt; 917             self._create_methods(defs, rcbs, defaults)\n    918 \n    919         cls.__init__ = init_then_register\n\nRuntimeError: gatherable-&gt;type()-&gt;isSubtypeOf(DynamicType::get()) ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1539769716489/work/torch/csrc/jit/script/compiler.cpp:1831, please report a bug to PyTorch. (emitBasicGather at /opt/conda/conda-bld/pytorch-nightly_1539769716489/work/torch/csrc/jit/script/compiler.cpp:1831)\nframe #0: &lt;unknown function&gt; + 0x5323c4 (0x7fd0875753c4 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #1: &lt;unknown function&gt; + 0x5329c8 (0x7fd0875759c8 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #2: &lt;unknown function&gt; + 0x532ddd (0x7fd087575ddd in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #3: &lt;unknown function&gt; + 0x53612e (0x7fd08757912e in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #4: &lt;unknown function&gt; + 0x53683f (0x7fd08757983f in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #5: &lt;unknown function&gt; + 0x532c9c (0x7fd087575c9c in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #6: &lt;unknown function&gt; + 0x537334 (0x7fd08757a334 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #7: &lt;unknown function&gt; + 0x538e01 (0x7fd08757be01 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #8: &lt;unknown function&gt; + 0x53c6f7 (0x7fd08757f6f7 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #9: &lt;unknown function&gt; + 0x5172ab (0x7fd08755a2ab in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #10: torch::jit::script::Method::ensure_defined() + 0xdb (0x7fd0b63208ab in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\nframe #11: torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::vector&lt;torch::jit::script::Def, std::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::vector&lt;std::function&lt;std::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::string const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::allocator&lt;std::function&lt;std::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::string const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::shared_ptr&lt;torch::jit::script::SugaredValue&gt;) + 0x708 (0x7fd087556868 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #12: &lt;unknown function&gt; + 0x475de3 (0x7fd0b62f6de3 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\nframe #13: &lt;unknown function&gt; + 0x1a684b (0x7fd0b602784b in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\nframe #14: _PyCFunction_FastCallDict + 0x154 (0x55b29c92c1a4 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #15: &lt;unknown function&gt; + 0x19a58e (0x55b29c9b358e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #16: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #17: &lt;unknown function&gt; + 0x193b3e (0x55b29c9acb3e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #18: _PyFunction_FastCallDict + 0x1bc (0x55b29c9adb8c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #19: _PyObject_FastCallDict + 0x26f (0x55b29c92c56f in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #20: _PyObject_Call_Prepend + 0x63 (0x55b29c930fe3 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #21: PyObject_Call + 0x3e (0x55b29c92bfae in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #22: &lt;unknown function&gt; + 0x16d12b (0x55b29c98612b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #23: &lt;unknown function&gt; + 0x19a777 (0x55b29c9b3777 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #24: _PyObject_FastCallDict + 0x8b (0x55b29c92c38b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #25: &lt;unknown function&gt; + 0x19a58e (0x55b29c9b358e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #26: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #27: PyEval_EvalCodeEx + 0x329 (0x55b29c9ae1c9 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #28: PyEval_EvalCode + 0x1c (0x55b29c9aef5c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #29: &lt;unknown function&gt; + 0x1bc46b (0x55b29c9d546b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #30: _PyCFunction_FastCallDict + 0x91 (0x55b29c92c0e1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #31: &lt;unknown function&gt; + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #32: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #33: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #34: _PyEval_EvalFrameDefault + 0x1311 (0x55b29c9d8a31 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #35: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #36: _PyEval_EvalFrameDefault + 0x1311 (0x55b29c9d8a31 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #37: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #38: _PyCFunction_FastCallDict + 0x115 (0x55b29c92c165 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #39: &lt;unknown function&gt; + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #40: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #41: &lt;unknown function&gt; + 0x19447b (0x55b29c9ad47b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #42: &lt;unknown function&gt; + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #43: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #44: &lt;unknown function&gt; + 0x19447b (0x55b29c9ad47b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #45: &lt;unknown function&gt; + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #46: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #47: &lt;unknown function&gt; + 0x193814 (0x55b29c9ac814 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #48: _PyFunction_FastCallDict + 0x3d7 (0x55b29c9adda7 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #49: _PyObject_FastCallDict + 0x26f (0x55b29c92c56f in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #50: _PyObject_Call_Prepend + 0x63 (0x55b29c930fe3 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #51: PyObject_Call + 0x3e (0x55b29c92bfae in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #52: _PyEval_EvalFrameDefault + 0x1bba (0x55b29c9d92da in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #53: &lt;unknown function&gt; + 0x1939b6 (0x55b29c9ac9b6 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #54: &lt;unknown function&gt; + 0x1946b1 (0x55b29c9ad6b1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #55: &lt;unknown function&gt; + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #56: _PyEval_EvalFrameDefault + 0x1014 (0x55b29c9d8734 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #57: &lt;unknown function&gt; + 0x19d0f0 (0x55b29c9b60f0 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #58: _PyCFunction_FastCallDict + 0x91 (0x55b29c92c0e1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #59: &lt;unknown function&gt; + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #60: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #61: &lt;unknown function&gt; + 0x193b3e (0x55b29c9acb3e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #62: &lt;unknown function&gt; + 0x1946b1 (0x55b29c9ad6b1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #63: &lt;unknown function&gt; + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\n</code></pre>\n<h2>Expected behavior</h2>\n<p>Expect to generate Torch Script.</p>\n<h2>Environment</h2>\n<pre><code>Collecting environment information...\nPyTorch version: 1.0.0.dev20181017\nIs debug build: No\nCUDA used to build PyTorch: 9.0.176\n\nOS: Ubuntu 16.04.5 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\nCMake version: version 3.9.4\n\nPython version: 3.6\nIs CUDA available: Yes\nCUDA runtime version: 9.0.176\nGPU models and configuration: GPU 0: Tesla K80\nNvidia driver version: 384.81\ncuDNN version: Probably one of the following:\n/usr/local/cuda-8.0/lib64/libcudnn.so.6.0.21\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\n/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.3\n/usr/local/cuda-9.0/lib64/libcudnn_static.a\n\nVersions of relevant libraries:\n[pip3] numpy (1.13.3)\n[conda] pytorch-nightly           1.0.0.dev20181017 py3.6_cuda9.0.176_cudnn7.1.2_0    pytorch\n</code></pre>", "body_text": "\ud83d\udc1b Bug\n\nTo Reproduce\nSteps to reproduce the behavior:\n\nUsing PyTorch version 1.0.0.dev20181017 on AWS E2C Deep Learning Instance\nFollowing code:\n\nimport torch \nimport torch.nn as nn\nprint(torch.__version__)\n\nclass test(torch.jit.ScriptModule):\n    \n    def __init__(self, rnn_dims=512):\n        super().__init__()\n        self.rnn = nn.GRU(input_size=rnn_dims, hidden_size=rnn_dims, batch_first=True)\n    \n    @torch.jit.script_method   \n    def forward(self, x):\n        \n        h1 = (torch.zeros(1, 1, 512), torch.zeros(1, 1, 512))\n        out, h1 = self.rnn(x, h1[1])\n        \n        return h1\n        \n        \nnet = test()\n\noutput = net(torch.randn(1,1,512))\n\nprint(output.shape)\n\n\nError:\n\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-33-188aafc970e8> in <module>\n     18 \n     19 \n---> 20 net = test()\n     21 \n     22 output = net(torch.randn(1,1,512))\n\n/home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/jit/__init__.py in init_then_register(self, *args, **kwargs)\n    915             rcbs = [m.resolution_callback for m in methods]\n    916             defaults = [get_default_args(m.original_method) for m in methods]\n--> 917             self._create_methods(defs, rcbs, defaults)\n    918 \n    919         cls.__init__ = init_then_register\n\nRuntimeError: gatherable->type()->isSubtypeOf(DynamicType::get()) ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1539769716489/work/torch/csrc/jit/script/compiler.cpp:1831, please report a bug to PyTorch. (emitBasicGather at /opt/conda/conda-bld/pytorch-nightly_1539769716489/work/torch/csrc/jit/script/compiler.cpp:1831)\nframe #0: <unknown function> + 0x5323c4 (0x7fd0875753c4 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #1: <unknown function> + 0x5329c8 (0x7fd0875759c8 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #2: <unknown function> + 0x532ddd (0x7fd087575ddd in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #3: <unknown function> + 0x53612e (0x7fd08757912e in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #4: <unknown function> + 0x53683f (0x7fd08757983f in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #5: <unknown function> + 0x532c9c (0x7fd087575c9c in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #6: <unknown function> + 0x537334 (0x7fd08757a334 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #7: <unknown function> + 0x538e01 (0x7fd08757be01 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #8: <unknown function> + 0x53c6f7 (0x7fd08757f6f7 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #9: <unknown function> + 0x5172ab (0x7fd08755a2ab in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #10: torch::jit::script::Method::ensure_defined() + 0xdb (0x7fd0b63208ab in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\nframe #11: torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::vector<torch::jit::script::Def, std::allocator<torch::jit::script::Def> > const&, std::vector<std::function<std::shared_ptr<torch::jit::script::SugaredValue> (std::string const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::allocator<std::function<std::shared_ptr<torch::jit::script::SugaredValue> (std::string const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::shared_ptr<torch::jit::script::SugaredValue>) + 0x708 (0x7fd087556868 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\nframe #12: <unknown function> + 0x475de3 (0x7fd0b62f6de3 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\nframe #13: <unknown function> + 0x1a684b (0x7fd0b602784b in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\nframe #14: _PyCFunction_FastCallDict + 0x154 (0x55b29c92c1a4 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #15: <unknown function> + 0x19a58e (0x55b29c9b358e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #16: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #17: <unknown function> + 0x193b3e (0x55b29c9acb3e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #18: _PyFunction_FastCallDict + 0x1bc (0x55b29c9adb8c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #19: _PyObject_FastCallDict + 0x26f (0x55b29c92c56f in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #20: _PyObject_Call_Prepend + 0x63 (0x55b29c930fe3 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #21: PyObject_Call + 0x3e (0x55b29c92bfae in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #22: <unknown function> + 0x16d12b (0x55b29c98612b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #23: <unknown function> + 0x19a777 (0x55b29c9b3777 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #24: _PyObject_FastCallDict + 0x8b (0x55b29c92c38b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #25: <unknown function> + 0x19a58e (0x55b29c9b358e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #26: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #27: PyEval_EvalCodeEx + 0x329 (0x55b29c9ae1c9 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #28: PyEval_EvalCode + 0x1c (0x55b29c9aef5c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #29: <unknown function> + 0x1bc46b (0x55b29c9d546b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #30: _PyCFunction_FastCallDict + 0x91 (0x55b29c92c0e1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #31: <unknown function> + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #32: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #33: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #34: _PyEval_EvalFrameDefault + 0x1311 (0x55b29c9d8a31 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #35: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #36: _PyEval_EvalFrameDefault + 0x1311 (0x55b29c9d8a31 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #37: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #38: _PyCFunction_FastCallDict + 0x115 (0x55b29c92c165 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #39: <unknown function> + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #40: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #41: <unknown function> + 0x19447b (0x55b29c9ad47b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #42: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #43: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #44: <unknown function> + 0x19447b (0x55b29c9ad47b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #45: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #46: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #47: <unknown function> + 0x193814 (0x55b29c9ac814 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #48: _PyFunction_FastCallDict + 0x3d7 (0x55b29c9adda7 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #49: _PyObject_FastCallDict + 0x26f (0x55b29c92c56f in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #50: _PyObject_Call_Prepend + 0x63 (0x55b29c930fe3 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #51: PyObject_Call + 0x3e (0x55b29c92bfae in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #52: _PyEval_EvalFrameDefault + 0x1bba (0x55b29c9d92da in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #53: <unknown function> + 0x1939b6 (0x55b29c9ac9b6 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #54: <unknown function> + 0x1946b1 (0x55b29c9ad6b1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #55: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #56: _PyEval_EvalFrameDefault + 0x1014 (0x55b29c9d8734 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #57: <unknown function> + 0x19d0f0 (0x55b29c9b60f0 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #58: _PyCFunction_FastCallDict + 0x91 (0x55b29c92c0e1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #59: <unknown function> + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #60: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #61: <unknown function> + 0x193b3e (0x55b29c9acb3e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #62: <unknown function> + 0x1946b1 (0x55b29c9ad6b1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\nframe #63: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\n\nExpected behavior\nExpect to generate Torch Script.\nEnvironment\nCollecting environment information...\nPyTorch version: 1.0.0.dev20181017\nIs debug build: No\nCUDA used to build PyTorch: 9.0.176\n\nOS: Ubuntu 16.04.5 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\nCMake version: version 3.9.4\n\nPython version: 3.6\nIs CUDA available: Yes\nCUDA runtime version: 9.0.176\nGPU models and configuration: GPU 0: Tesla K80\nNvidia driver version: 384.81\ncuDNN version: Probably one of the following:\n/usr/local/cuda-8.0/lib64/libcudnn.so.6.0.21\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\n/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.3\n/usr/local/cuda-9.0/lib64/libcudnn_static.a\n\nVersions of relevant libraries:\n[pip3] numpy (1.13.3)\n[conda] pytorch-nightly           1.0.0.dev20181017 py3.6_cuda9.0.176_cudnn7.1.2_0    pytorch", "body": "## \ud83d\udc1b Bug\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n## To Reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\n1. Using PyTorch version 1.0.0.dev20181017 on AWS E2C Deep Learning Instance\r\n2. Following code:\r\n\r\n```python\r\n\r\nimport torch \r\nimport torch.nn as nn\r\nprint(torch.__version__)\r\n\r\nclass test(torch.jit.ScriptModule):\r\n    \r\n    def __init__(self, rnn_dims=512):\r\n        super().__init__()\r\n        self.rnn = nn.GRU(input_size=rnn_dims, hidden_size=rnn_dims, batch_first=True)\r\n    \r\n    @torch.jit.script_method   \r\n    def forward(self, x):\r\n        \r\n        h1 = (torch.zeros(1, 1, 512), torch.zeros(1, 1, 512))\r\n        out, h1 = self.rnn(x, h1[1])\r\n        \r\n        return h1\r\n        \r\n        \r\nnet = test()\r\n\r\noutput = net(torch.randn(1,1,512))\r\n\r\nprint(output.shape)\r\n\r\n```\r\n\r\n3. Error:\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-33-188aafc970e8> in <module>\r\n     18 \r\n     19 \r\n---> 20 net = test()\r\n     21 \r\n     22 output = net(torch.randn(1,1,512))\r\n\r\n/home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/jit/__init__.py in init_then_register(self, *args, **kwargs)\r\n    915             rcbs = [m.resolution_callback for m in methods]\r\n    916             defaults = [get_default_args(m.original_method) for m in methods]\r\n--> 917             self._create_methods(defs, rcbs, defaults)\r\n    918 \r\n    919         cls.__init__ = init_then_register\r\n\r\nRuntimeError: gatherable->type()->isSubtypeOf(DynamicType::get()) ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1539769716489/work/torch/csrc/jit/script/compiler.cpp:1831, please report a bug to PyTorch. (emitBasicGather at /opt/conda/conda-bld/pytorch-nightly_1539769716489/work/torch/csrc/jit/script/compiler.cpp:1831)\r\nframe #0: <unknown function> + 0x5323c4 (0x7fd0875753c4 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #1: <unknown function> + 0x5329c8 (0x7fd0875759c8 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #2: <unknown function> + 0x532ddd (0x7fd087575ddd in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #3: <unknown function> + 0x53612e (0x7fd08757912e in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #4: <unknown function> + 0x53683f (0x7fd08757983f in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #5: <unknown function> + 0x532c9c (0x7fd087575c9c in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #6: <unknown function> + 0x537334 (0x7fd08757a334 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #7: <unknown function> + 0x538e01 (0x7fd08757be01 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #8: <unknown function> + 0x53c6f7 (0x7fd08757f6f7 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #9: <unknown function> + 0x5172ab (0x7fd08755a2ab in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #10: torch::jit::script::Method::ensure_defined() + 0xdb (0x7fd0b63208ab in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\r\nframe #11: torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::vector<torch::jit::script::Def, std::allocator<torch::jit::script::Def> > const&, std::vector<std::function<std::shared_ptr<torch::jit::script::SugaredValue> (std::string const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::allocator<std::function<std::shared_ptr<torch::jit::script::SugaredValue> (std::string const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::shared_ptr<torch::jit::script::SugaredValue>) + 0x708 (0x7fd087556868 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/lib/libtorch.so.1)\r\nframe #12: <unknown function> + 0x475de3 (0x7fd0b62f6de3 in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\r\nframe #13: <unknown function> + 0x1a684b (0x7fd0b602784b in /home/ubuntu/anaconda3/envs/pytorch_edge/lib/python3.6/site-packages/torch/_C.cpython-36m-x86_64-linux-gnu.so)\r\nframe #14: _PyCFunction_FastCallDict + 0x154 (0x55b29c92c1a4 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #15: <unknown function> + 0x19a58e (0x55b29c9b358e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #16: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #17: <unknown function> + 0x193b3e (0x55b29c9acb3e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #18: _PyFunction_FastCallDict + 0x1bc (0x55b29c9adb8c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #19: _PyObject_FastCallDict + 0x26f (0x55b29c92c56f in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #20: _PyObject_Call_Prepend + 0x63 (0x55b29c930fe3 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #21: PyObject_Call + 0x3e (0x55b29c92bfae in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #22: <unknown function> + 0x16d12b (0x55b29c98612b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #23: <unknown function> + 0x19a777 (0x55b29c9b3777 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #24: _PyObject_FastCallDict + 0x8b (0x55b29c92c38b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #25: <unknown function> + 0x19a58e (0x55b29c9b358e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #26: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #27: PyEval_EvalCodeEx + 0x329 (0x55b29c9ae1c9 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #28: PyEval_EvalCode + 0x1c (0x55b29c9aef5c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #29: <unknown function> + 0x1bc46b (0x55b29c9d546b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #30: _PyCFunction_FastCallDict + 0x91 (0x55b29c92c0e1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #31: <unknown function> + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #32: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #33: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #34: _PyEval_EvalFrameDefault + 0x1311 (0x55b29c9d8a31 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #35: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #36: _PyEval_EvalFrameDefault + 0x1311 (0x55b29c9d8a31 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #37: _PyGen_Send + 0x256 (0x55b29c9b6586 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #38: _PyCFunction_FastCallDict + 0x115 (0x55b29c92c165 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #39: <unknown function> + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #40: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #41: <unknown function> + 0x19447b (0x55b29c9ad47b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #42: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #43: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #44: <unknown function> + 0x19447b (0x55b29c9ad47b in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #45: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #46: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #47: <unknown function> + 0x193814 (0x55b29c9ac814 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #48: _PyFunction_FastCallDict + 0x3d7 (0x55b29c9adda7 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #49: _PyObject_FastCallDict + 0x26f (0x55b29c92c56f in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #50: _PyObject_Call_Prepend + 0x63 (0x55b29c930fe3 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #51: PyObject_Call + 0x3e (0x55b29c92bfae in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #52: _PyEval_EvalFrameDefault + 0x1bba (0x55b29c9d92da in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #53: <unknown function> + 0x1939b6 (0x55b29c9ac9b6 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #54: <unknown function> + 0x1946b1 (0x55b29c9ad6b1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #55: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #56: _PyEval_EvalFrameDefault + 0x1014 (0x55b29c9d8734 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #57: <unknown function> + 0x19d0f0 (0x55b29c9b60f0 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #58: _PyCFunction_FastCallDict + 0x91 (0x55b29c92c0e1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #59: <unknown function> + 0x19a43c (0x55b29c9b343c in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #60: _PyEval_EvalFrameDefault + 0x2fa (0x55b29c9d7a1a in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #61: <unknown function> + 0x193b3e (0x55b29c9acb3e in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #62: <unknown function> + 0x1946b1 (0x55b29c9ad6b1 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\nframe #63: <unknown function> + 0x19a515 (0x55b29c9b3515 in /home/ubuntu/anaconda3/envs/pytorch_edge/bin/python)\r\n```\r\n\r\n## Expected behavior\r\n\r\nExpect to generate Torch Script.\r\n\r\n## Environment\r\n\r\n```\r\nCollecting environment information...\r\nPyTorch version: 1.0.0.dev20181017\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 16.04.5 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.9.4\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.0.176\r\nGPU models and configuration: GPU 0: Tesla K80\r\nNvidia driver version: 384.81\r\ncuDNN version: Probably one of the following:\r\n/usr/local/cuda-8.0/lib64/libcudnn.so.6.0.21\r\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\r\n/usr/local/cuda-9.0/lib64/libcudnn.so.7.0.3\r\n/usr/local/cuda-9.0/lib64/libcudnn_static.a\r\n\r\nVersions of relevant libraries:\r\n[pip3] numpy (1.13.3)\r\n[conda] pytorch-nightly           1.0.0.dev20181017 py3.6_cuda9.0.176_cudnn7.1.2_0    pytorch\r\n```\r\n"}