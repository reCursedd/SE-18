{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/365370577", "html_url": "https://github.com/pytorch/pytorch/issues/5218#issuecomment-365370577", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5218", "id": 365370577, "node_id": "MDEyOklzc3VlQ29tbWVudDM2NTM3MDU3Nw==", "user": {"login": "jlquinn", "id": 826841, "node_id": "MDQ6VXNlcjgyNjg0MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/826841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlquinn", "html_url": "https://github.com/jlquinn", "followers_url": "https://api.github.com/users/jlquinn/followers", "following_url": "https://api.github.com/users/jlquinn/following{/other_user}", "gists_url": "https://api.github.com/users/jlquinn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlquinn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlquinn/subscriptions", "organizations_url": "https://api.github.com/users/jlquinn/orgs", "repos_url": "https://api.github.com/users/jlquinn/repos", "events_url": "https://api.github.com/users/jlquinn/events{/privacy}", "received_events_url": "https://api.github.com/users/jlquinn/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-13T19:07:11Z", "updated_at": "2018-02-13T19:07:11Z", "author_association": "NONE", "body_html": "<p>The following script reproduces the crash:</p>\n<p>import torch<br>\nimport torch.nn<br>\nfrom torch.optim.lr_scheduler import ReduceLROnPlateau</p>\n<p>if <strong>name</strong> == '<strong>main</strong>':<br>\nmodel = torch.nn.Linear(10,10)<br>\noptim = torch.optim.Adam(model.parameters())<br>\nsched = ReduceLROnPlateau(optim, mode='max', factor=0.5)<br>\nwith open('tmp.state','wb') as f:<br>\n# Works<br>\n# torch.save((model.state_dict(), optim.state_dict()), f)<br>\n# Crashes<br>\ntorch.save((model.state_dict(), optim.state_dict(), sched), f)</p>", "body_text": "The following script reproduces the crash:\nimport torch\nimport torch.nn\nfrom torch.optim.lr_scheduler import ReduceLROnPlateau\nif name == 'main':\nmodel = torch.nn.Linear(10,10)\noptim = torch.optim.Adam(model.parameters())\nsched = ReduceLROnPlateau(optim, mode='max', factor=0.5)\nwith open('tmp.state','wb') as f:\n# Works\n# torch.save((model.state_dict(), optim.state_dict()), f)\n# Crashes\ntorch.save((model.state_dict(), optim.state_dict(), sched), f)", "body": "The following script reproduces the crash:\r\n\r\nimport torch\r\nimport torch.nn\r\nfrom torch.optim.lr_scheduler import ReduceLROnPlateau\r\n\r\n\r\nif __name__ == '__main__':\r\n    model = torch.nn.Linear(10,10)\r\n    optim = torch.optim.Adam(model.parameters())\r\n    sched = ReduceLROnPlateau(optim, mode='max', factor=0.5)\r\n    with open('tmp.state','wb') as f:\r\n        # Works\r\n        # torch.save((model.state_dict(), optim.state_dict()), f)\r\n        # Crashes\r\n        torch.save((model.state_dict(), optim.state_dict(), sched), f)\r\n"}