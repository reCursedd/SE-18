{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5218", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5218/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5218/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5218/events", "html_url": "https://github.com/pytorch/pytorch/issues/5218", "id": 296850971, "node_id": "MDU6SXNzdWUyOTY4NTA5NzE=", "number": 5218, "title": "Saving ReduceLROnPlateau crashes", "user": {"login": "jlquinn", "id": 826841, "node_id": "MDQ6VXNlcjgyNjg0MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/826841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlquinn", "html_url": "https://github.com/jlquinn", "followers_url": "https://api.github.com/users/jlquinn/followers", "following_url": "https://api.github.com/users/jlquinn/following{/other_user}", "gists_url": "https://api.github.com/users/jlquinn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlquinn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlquinn/subscriptions", "organizations_url": "https://api.github.com/users/jlquinn/orgs", "repos_url": "https://api.github.com/users/jlquinn/repos", "events_url": "https://api.github.com/users/jlquinn/events{/privacy}", "received_events_url": "https://api.github.com/users/jlquinn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-13T19:06:34Z", "updated_at": "2018-02-20T05:59:15Z", "closed_at": "2018-02-20T05:59:15Z", "author_association": "NONE", "body_html": "<p>I'm working on checkpointing in our nn trainer.  When saving the state objects, I get an error:</p>\n<p>PicklingError: Can't pickle &lt;type 'function'&gt;: attribute lookup <strong>builtin</strong>.function failed</p>\n<p>I tracked it down to trying to save the scheduler ReduceLROnPlateau.  I think the issue is due to the scheduler referencing the optimizer, which has to be saved with state_dict().  I presume the same error will occur with other schedulers too.</p>\n<p>It seems like the problem could be solved by providing a state_dict() and load_state_dict() in the scheduler classes.</p>\n<p>pytorch master rev <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/a5440717ae0ede5e398ea9cbb9fb3e368eb325b8/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/a5440717ae0ede5e398ea9cbb9fb3e368eb325b8\"><tt>a544071</tt></a> (Jan 22)<br>\ninstalled from source<br>\nx86_64 on centos 7.4<br>\ncuda 9.0 cudnn 7<br>\nk80<br>\ngcc 5.4<br>\npython 2.7.14</p>", "body_text": "I'm working on checkpointing in our nn trainer.  When saving the state objects, I get an error:\nPicklingError: Can't pickle <type 'function'>: attribute lookup builtin.function failed\nI tracked it down to trying to save the scheduler ReduceLROnPlateau.  I think the issue is due to the scheduler referencing the optimizer, which has to be saved with state_dict().  I presume the same error will occur with other schedulers too.\nIt seems like the problem could be solved by providing a state_dict() and load_state_dict() in the scheduler classes.\npytorch master rev a544071 (Jan 22)\ninstalled from source\nx86_64 on centos 7.4\ncuda 9.0 cudnn 7\nk80\ngcc 5.4\npython 2.7.14", "body": "I'm working on checkpointing in our nn trainer.  When saving the state objects, I get an error:\r\n\r\nPicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\r\n\r\nI tracked it down to trying to save the scheduler ReduceLROnPlateau.  I think the issue is due to the scheduler referencing the optimizer, which has to be saved with state_dict().  I presume the same error will occur with other schedulers too.\r\n\r\nIt seems like the problem could be solved by providing a state_dict() and load_state_dict() in the scheduler classes.\r\n\r\n\r\npytorch master rev a5440717ae0ede5e398ea9cbb9fb3e368eb325b8 (Jan 22)\r\ninstalled from source\r\nx86_64 on centos 7.4\r\ncuda 9.0 cudnn 7\r\nk80\r\ngcc 5.4\r\npython 2.7.14\r\n\r\n"}