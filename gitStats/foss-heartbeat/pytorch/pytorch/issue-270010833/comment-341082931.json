{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/341082931", "html_url": "https://github.com/pytorch/pytorch/issues/3396#issuecomment-341082931", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/3396", "id": 341082931, "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTA4MjkzMQ==", "user": {"login": "trypag", "id": 13003839, "node_id": "MDQ6VXNlcjEzMDAzODM5", "avatar_url": "https://avatars1.githubusercontent.com/u/13003839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/trypag", "html_url": "https://github.com/trypag", "followers_url": "https://api.github.com/users/trypag/followers", "following_url": "https://api.github.com/users/trypag/following{/other_user}", "gists_url": "https://api.github.com/users/trypag/gists{/gist_id}", "starred_url": "https://api.github.com/users/trypag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/trypag/subscriptions", "organizations_url": "https://api.github.com/users/trypag/orgs", "repos_url": "https://api.github.com/users/trypag/repos", "events_url": "https://api.github.com/users/trypag/events{/privacy}", "received_events_url": "https://api.github.com/users/trypag/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-01T11:37:12Z", "updated_at": "2017-11-01T11:37:12Z", "author_association": "NONE", "body_html": "<p>Sure, I think we can agree this kind of code should not take more than 1 second to run on a gpu, instead of this running this full repro will take an indefinite time (at least more than 30 sec, did not wait longer).<br>\nWhen removing the last two lines it runs smoothly as expected by this kind of work (1 sec). Adding the last two lines creates what I think is a GPU synchronization problem related to the call of <code>.topk</code> and results in what may be a deadlock.<br>\nI hope you will be able to reproduce</p>", "body_text": "Sure, I think we can agree this kind of code should not take more than 1 second to run on a gpu, instead of this running this full repro will take an indefinite time (at least more than 30 sec, did not wait longer).\nWhen removing the last two lines it runs smoothly as expected by this kind of work (1 sec). Adding the last two lines creates what I think is a GPU synchronization problem related to the call of .topk and results in what may be a deadlock.\nI hope you will be able to reproduce", "body": "Sure, I think we can agree this kind of code should not take more than 1 second to run on a gpu, instead of this running this full repro will take an indefinite time (at least more than 30 sec, did not wait longer).\r\nWhen removing the last two lines it runs smoothly as expected by this kind of work (1 sec). Adding the last two lines creates what I think is a GPU synchronization problem related to the call of `.topk` and results in what may be a deadlock.\r\nI hope you will be able to reproduce"}