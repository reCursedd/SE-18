{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10687", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10687/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10687/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10687/events", "html_url": "https://github.com/pytorch/pytorch/issues/10687", "id": 352197278, "node_id": "MDU6SXNzdWUzNTIxOTcyNzg=", "number": 10687, "title": "Pytorch docker build fail", "user": {"login": "krumo", "id": 9900913, "node_id": "MDQ6VXNlcjk5MDA5MTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/9900913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krumo", "html_url": "https://github.com/krumo", "followers_url": "https://api.github.com/users/krumo/followers", "following_url": "https://api.github.com/users/krumo/following{/other_user}", "gists_url": "https://api.github.com/users/krumo/gists{/gist_id}", "starred_url": "https://api.github.com/users/krumo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krumo/subscriptions", "organizations_url": "https://api.github.com/users/krumo/orgs", "repos_url": "https://api.github.com/users/krumo/repos", "events_url": "https://api.github.com/users/krumo/events{/privacy}", "received_events_url": "https://api.github.com/users/krumo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-08-20T15:57:20Z", "updated_at": "2018-10-19T16:44:13Z", "closed_at": "2018-10-19T16:44:13Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>When I am trying to build a Pytorch docker container, I encounter the following errors:</p>\n<pre><code>    Install the project...\n    -- Install configuration: \"Release\"\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHD.a\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/THD.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/THDGenerateAllTypes.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/TensorDescriptor.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/Cuda.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/ChannelType.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/DataChannelRequest.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/DataChannel.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/process_group/Collectives.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/process_group/General.h\n    + popd\n    /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\n    ++ uname\n    + [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n    + popd\n    /tmp/pip-req-build-2s8ksvn3/build\n    + for arg in '\"$@\"'\n    + [[ c10d == \\n\\c\\c\\l ]]\n    + [[ c10d == \\g\\l\\o\\o ]]\n    + [[ c10d == \\c\\a\\f\\f\\e\\2 ]]\n    + [[ c10d == \\T\\H\\D ]]\n    + [[ c10d == \\l\\i\\b\\s\\h\\m ]]\n    + [[ c10d == \\l\\i\\b\\s\\h\\m\\_\\w\\i\\n\\d\\o\\w\\s ]]\n    + [[ c10d == \\c\\1\\0\\d ]]\n    + pushd /tmp/pip-req-build-2s8ksvn3/torch/lib\n    /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\n    + build c10d\n    + [[ -z '' ]]\n    + CMAKE_ARGS=()\n    + mkdir -p build/c10d\n    + pushd build/c10d\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/build/c10d /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\n    + BUILD_C_FLAGS=\n    + case $1 in\n    + BUILD_C_FLAGS=' -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions'\n    + cmake ../../c10d -DCMAKE_MODULE_PATH=/tmp/pip-req-build-2s8ksvn3/cmake/Modules_CUDA_fix -DTorch_FOUND=1 -DCMAKE_INSTALL_PREFIX=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install '-DCMAKE_C_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions ' '-DCMAKE_CXX_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11  ' '-DCMAKE_EXE_LINKER_FLAGS=-L\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN ' '-DCMAKE_SHARED_LINKER_FLAGS=-L\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN ' -DCMAKE_INSTALL_LIBDIR=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib '-DCUDA_NVCC_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1' -DCUDA_DEVICE_DEBUG=0 -DCMAKE_PREFIX_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install '-Dcwrap_files=/tmp/pip-req-build-2s8ksvn3/torch/lib/ATen/Declarations.cwrap;/tmp/pip-req-build-2s8ksvn3/torch/lib/THNN/generic/THNN.h;/tmp/pip-req-build-2s8ksvn3/torch/lib/THCUNN/generic/THCUNN.h;/tmp/pip-req-build-2s8ksvn3/torch/lib/ATen/nn.yaml' -DTH_INCLUDE_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include -DTH_LIB_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib -DTH_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTH.so -DCAFFE2_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libcaffe2.so -DTHNN_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHNN.so -DTHCUNN_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHCUNN.so -DTHS_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHS.so -DTHC_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHC.so -DTHCS_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHCS.so -DTH_SO_VERSION=1 -DTHC_SO_VERSION=1 -DTHNN_SO_VERSION=1 -DTHCUNN_SO_VERSION=1 -DTHD_SO_VERSION=1 -DUSE_CUDA=1 -DNO_NNPACK=0 -DNCCL_EXTERNAL=1 -Dnanopb_BUILD_GENERATOR=0 -DCMAKE_DEBUG_POSTFIX= -DCMAKE_BUILD_TYPE=Release -DCMAKE_EXPORT_COMPILE_COMMANDS=1\n    -- The C compiler identification is GNU 5.4.0\n    -- The CXX compiler identification is GNU 5.4.0\n    -- Check for working C compiler: /usr/bin/cc\n    -- Check for working C compiler: /usr/bin/cc -- works\n    -- Detecting C compiler ABI info\n    -- Detecting C compiler ABI info - done\n    -- Detecting C compile features\n    -- Detecting C compile features - done\n    -- Check for working CXX compiler: /usr/bin/c++\n    -- Check for working CXX compiler: /usr/bin/c++ -- works\n    -- Detecting CXX compiler ABI info\n    -- Detecting CXX compiler ABI info - done\n    -- Detecting CXX compile features\n    -- Detecting CXX compile features - done\n    -- Looking for pthread.h\n    -- Looking for pthread.h - found\n    -- Looking for pthread_create\n    -- Looking for pthread_create - not found\n    -- Looking for pthread_create in pthreads\n    -- Looking for pthread_create in pthreads - not found\n    -- Looking for pthread_create in pthread\n    -- Looking for pthread_create in pthread - found\n    -- Found Threads: TRUE\n    -- Caffe2: Found protobuf with new-style protobuf targets.\n    -- Caffe2: Protobuf version 3.5.0\n    -- Found CUDA: /usr/local/cuda (found suitable version \"9.0\", minimum required is \"7.0\")\n    -- Caffe2: CUDA detected: 9.0\n    -- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\n    -- Caffe2: CUDA toolkit directory: /usr/local/cuda\n    -- Caffe2: Header version is: 9.0\n    -- Found CUDNN: /usr/include/\n    -- Found cuDNN: v7.1.4  (include: /usr/include/, library: /usr/lib/x86_64-linux-gnu/libcudnn.so.7)\n    CMake Warning at /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/public/utils.cmake:173 (message):\n      In the future we will require one to explicitly pass TORCH_CUDA_ARCH_LIST\n      to cmake instead of implicitly setting it as an env variable.  This will\n      become a FATAL_ERROR in future version of pytorch.\n    Call Stack (most recent call first):\n      /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/public/cuda.cmake:332 (torch_cuda_get_nvcc_gencode_flag)\n      /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/Caffe2Config.cmake:79 (include)\n      CMakeLists.txt:13 (find_package)\n\n\n    -- Added CUDA NVCC flags for: -gencode;arch=compute_35,code=sm_35;-gencode;arch=compute_52,code=sm_52;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_70,code=compute_70\n    -- Found Gloo: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\n    -- Gloo_LIBRARY: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libgloo_cuda.a\n    -- Gloo_NATIVE_LIBRARY: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libgloo.a\n    -- Gloo_INCLUDE_DIR: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\n    -- Could NOT find MPI_C (missing:  MPI_C_LIBRARIES MPI_C_INCLUDE_PATH)\n    -- Could NOT find MPI_CXX (missing:  MPI_CXX_LIBRARIES MPI_CXX_INCLUDE_PATH)\n    -- Not able to find MPI, will compile c10d without MPI support\n    -- Found NCCL: /usr/include\n    -- Determining NCCL version from the header file: /usr/include/nccl.h\n    -- NCCL_MAJOR_VERSION: 2\n    -- Found NCCL (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnccl.so)\n    -- NCCL_LIBRARIES: /usr/lib/x86_64-linux-gnu/libnccl.so\n    -- NCCL_INCLUDE_DIRS: /usr/include\n    -- NCCL Version 2 or higher found, will compile with NCCL distributed backend\n    -- Found CUDA: /usr/local/cuda (found version \"9.0\")\n    -- Configuring done\n    -- Generating done\n    CMake Warning:\n      Manually-specified variables were not used by the project:\n\n        CAFFE2_LIBRARIES\n        CMAKE_DEBUG_POSTFIX\n        CMAKE_INSTALL_LIBDIR\n        NCCL_EXTERNAL\n        NO_NNPACK\n        THCS_LIBRARIES\n        THCUNN_LIBRARIES\n        THCUNN_SO_VERSION\n        THC_LIBRARIES\n        THC_SO_VERSION\n        THD_SO_VERSION\n        THNN_LIBRARIES\n        THNN_SO_VERSION\n        THS_LIBRARIES\n        TH_INCLUDE_PATH\n        TH_LIBRARIES\n        TH_LIB_PATH\n        TH_SO_VERSION\n        Torch_FOUND\n        USE_CUDA\n        cwrap_files\n        nanopb_BUILD_GENERATOR\n\n\n    -- Build files have been written to: /tmp/pip-req-build-2s8ksvn3/torch/lib/build/c10d\n    + make install -j80\n    Scanning dependencies of target c10d\n    [  4%] Building CXX object CMakeFiles/c10d.dir/CUDAUtils.cpp.o\n    [  8%] Building CXX object CMakeFiles/c10d.dir/FileStore.cpp.o\n    [ 13%] Building CXX object CMakeFiles/c10d.dir/Store.cpp.o\n    [ 17%] Building CXX object CMakeFiles/c10d.dir/TCPStore.cpp.o\n    [ 21%] Building CXX object CMakeFiles/c10d.dir/ProcessGroup.cpp.o\n    [ 26%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupGloo.cpp.o\n    [ 30%] Building CXX object CMakeFiles/c10d.dir/Utils.cpp.o\n    [ 34%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/ProcessGroupGloo.cpp: In member function 'c10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&amp;)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/ProcessGroupGloo.cpp:445:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n       if (vec.size() != cacheNumAlgorithmEntries_) {\n                      ^\n    [ 39%] Linking CXX static library libc10d.a\n    [ 39%] Built target c10d\n    [ 43%] Building NVCC (Device) object test/CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o\n    Scanning dependencies of target FileStoreTest\n    Scanning dependencies of target TCPStoreTest\n    [ 47%] Building CXX object test/CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o\n    [ 52%] Building CXX object test/CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o\n    Scanning dependencies of target allreduce\n    [ 56%] Building CXX object example/CMakeFiles/allreduce.dir/allreduce.cpp.o\n    [ 60%] Linking CXX executable FileStoreTest\n    [ 60%] Built target FileStoreTest\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp: In function 'int main(int, char**)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp:16:64: warning: 'at::Tensor at::ones(const at::Type&amp;, at::IntList)' is deprecated [-Wdeprecated-declarations]\n         auto x = at::ones(at::CPU(at::kFloat), {1000, 16 * (i + 1)});\n                                                                    ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp:2:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type &amp; dtype, IntList size) {\n                          ^\n    [ 65%] Linking CXX executable TCPStoreTest\n    [ 69%] Linking CXX executable allreduce\n    [ 69%] Built target TCPStoreTest\n    [ 69%] Built target allreduce\n    Scanning dependencies of target c10d_cuda_test\n    [ 73%] Linking CXX static library libc10d_cuda_test.a\n    [ 73%] Built target c10d_cuda_test\n    Scanning dependencies of target ProcessGroupGlooTest\n    Scanning dependencies of target ProcessGroupNCCLTest\n    Scanning dependencies of target ProcessGroupGlooAsyncTest\n    [ 78%] Building CXX object test/CMakeFiles/ProcessGroupGlooTest.dir/ProcessGroupGlooTest.cpp.o\n    [ 82%] Building CXX object test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o\n    [ 86%] Building CXX object test/CMakeFiles/ProcessGroupGlooAsyncTest.dir/ProcessGroupGlooAsyncTest.cpp.o\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp: In member function 'std::vector&lt;at::Tensor&gt; NCCLTest::getTensors()':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:99:49: error: no matching function for call to 'at::Tensor::toBackend(const at::DeviceType&amp;)'\n           outputs[i] = inputs_[i].toBackend(at::kCPU);\n                                                     ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/NativeFunctions.h:7:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:11,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupNCCL.hpp:8,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:5:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note: candidate: at::Tensor at::Tensor::toBackend(at::Backend) const\n     inline Tensor Tensor::toBackend(Backend b) const {\n                   ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note:   no known conversion for argument 1 from 'const at::DeviceType' to 'at::Backend'\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp: In member function 'std::vector&lt;std::vector&lt;at::Tensor&gt; &gt; NCCLTest::getOutputTensors()':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:118:58: error: no matching function for call to 'at::Tensor::toBackend(const at::DeviceType&amp;)'\n             outputs[i][j] = outputs_[i][j].toBackend(at::kCPU);\n                                                              ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/NativeFunctions.h:7:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:11,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupNCCL.hpp:8,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:5:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note: candidate: at::Tensor at::Tensor::toBackend(at::Backend) const\n     inline Tensor Tensor::toBackend(Backend b) const {\n                   ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note:   no known conversion for argument 1 from 'const at::DeviceType' to 'at::Backend'\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In member function 'std::shared_ptr&lt;c10d::ProcessGroup::Work&gt; SignalTest::run(int, int)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:51:47: warning: 'at::Tensor at::ones(const at::Type&amp;, at::IntList)' is deprecated [-Wdeprecated-declarations]\n             at::ones(at::CPU(at::kFloat), {16, 16}),\n                                                   ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type &amp; dtype, IntList size) {\n                          ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In function 'void testAllreduce(const string&amp;, at::Backend)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:158:64: warning: 'at::Tensor at::ones(const at::Type&amp;, at::IntList)' is deprecated [-Wdeprecated-declarations]\n         auto tensor = at::ones(at::getType(b, at::kFloat), {16, 16}) * i;\n                                                                    ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type &amp; dtype, IntList size) {\n                          ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In function 'void testBroadcast(const string&amp;, at::Backend)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:208:49: warning: 'at::Tensor at::ones(const at::Type&amp;, at::IntList)' is deprecated [-Wdeprecated-declarations]\n               inputs[k][l] = at::ones(type, {16, 16}) * (k * stride + l);\n                                                     ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type &amp; dtype, IntList size) {\n                          ^\n    test/CMakeFiles/ProcessGroupNCCLTest.dir/build.make:62: recipe for target 'test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o' failed\n    make[2]: *** [test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o] Error 1\n    CMakeFiles/Makefile2:375: recipe for target 'test/CMakeFiles/ProcessGroupNCCLTest.dir/all' failed\n    make[1]: *** [test/CMakeFiles/ProcessGroupNCCLTest.dir/all] Error 2\n    make[1]: *** Waiting for unfinished jobs....\n    [ 91%] Linking CXX executable ProcessGroupGlooTest\n    [ 95%] Linking CXX executable ProcessGroupGlooAsyncTest\n    [ 95%] Built target ProcessGroupGlooTest\n    [ 95%] Built target ProcessGroupGlooAsyncTest\n    Makefile:138: recipe for target 'all' failed\n    make: *** [all] Error 2\n    Failed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack caffe2 nanopb libshm gloo THD c10d'\n    Running setup.py install for torch: finished with status 'error'\nCleaning up...\n  Removing source in /tmp/pip-req-build-2s8ksvn3\nCommand \"/opt/conda/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-req-build-2s8ksvn3/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-ppouch5h/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-req-build-2s8ksvn3/\nException information:\nTraceback (most recent call last):\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/basecommand.py\", line 228, in main\n    status = self.run(options, args)\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/commands/install.py\", line 335, in run\n    use_user_site=options.use_user_site,\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/req/__init__.py\", line 49, in install_given_reqs\n    **kwargs\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/req/req_install.py\", line 779, in install\n    spinner=spinner,\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/utils/misc.py\", line 698, in call_subprocess\n    % (command_desc, proc.returncode, cwd))\npip._internal.exceptions.InstallationError: Command \"/opt/conda/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-req-build-2s8ksvn3/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-ppouch5h/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-req-build-2s8ksvn3/\n\n</code></pre>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source): Docker</li>\n<li>Build command you used (if compiling from source):</li>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: 0.4.1</li>\n<li>Python version: 3.6.6</li>\n<li>CUDA/cuDNN version: CUDA9.0, cuDNN 7</li>\n<li>GPU models and configuration: Pascal P100</li>\n<li>GCC version (if compiling from source): 5.4.0</li>\n<li>CMake version: 3.5.1</li>\n</ul>", "body_text": "Issue description\nWhen I am trying to build a Pytorch docker container, I encounter the following errors:\n    Install the project...\n    -- Install configuration: \"Release\"\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHD.a\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/THD.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/THDGenerateAllTypes.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/TensorDescriptor.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/Cuda.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/ChannelType.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/DataChannelRequest.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/DataChannel.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/process_group/Collectives.h\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/process_group/General.h\n    + popd\n    /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\n    ++ uname\n    + [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n    + popd\n    /tmp/pip-req-build-2s8ksvn3/build\n    + for arg in '\"$@\"'\n    + [[ c10d == \\n\\c\\c\\l ]]\n    + [[ c10d == \\g\\l\\o\\o ]]\n    + [[ c10d == \\c\\a\\f\\f\\e\\2 ]]\n    + [[ c10d == \\T\\H\\D ]]\n    + [[ c10d == \\l\\i\\b\\s\\h\\m ]]\n    + [[ c10d == \\l\\i\\b\\s\\h\\m\\_\\w\\i\\n\\d\\o\\w\\s ]]\n    + [[ c10d == \\c\\1\\0\\d ]]\n    + pushd /tmp/pip-req-build-2s8ksvn3/torch/lib\n    /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\n    + build c10d\n    + [[ -z '' ]]\n    + CMAKE_ARGS=()\n    + mkdir -p build/c10d\n    + pushd build/c10d\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/build/c10d /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\n    + BUILD_C_FLAGS=\n    + case $1 in\n    + BUILD_C_FLAGS=' -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions'\n    + cmake ../../c10d -DCMAKE_MODULE_PATH=/tmp/pip-req-build-2s8ksvn3/cmake/Modules_CUDA_fix -DTorch_FOUND=1 -DCMAKE_INSTALL_PREFIX=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install '-DCMAKE_C_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions ' '-DCMAKE_CXX_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11  ' '-DCMAKE_EXE_LINKER_FLAGS=-L\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN ' '-DCMAKE_SHARED_LINKER_FLAGS=-L\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN ' -DCMAKE_INSTALL_LIBDIR=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib '-DCUDA_NVCC_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1' -DCUDA_DEVICE_DEBUG=0 -DCMAKE_PREFIX_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install '-Dcwrap_files=/tmp/pip-req-build-2s8ksvn3/torch/lib/ATen/Declarations.cwrap;/tmp/pip-req-build-2s8ksvn3/torch/lib/THNN/generic/THNN.h;/tmp/pip-req-build-2s8ksvn3/torch/lib/THCUNN/generic/THCUNN.h;/tmp/pip-req-build-2s8ksvn3/torch/lib/ATen/nn.yaml' -DTH_INCLUDE_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include -DTH_LIB_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib -DTH_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTH.so -DCAFFE2_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libcaffe2.so -DTHNN_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHNN.so -DTHCUNN_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHCUNN.so -DTHS_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHS.so -DTHC_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHC.so -DTHCS_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHCS.so -DTH_SO_VERSION=1 -DTHC_SO_VERSION=1 -DTHNN_SO_VERSION=1 -DTHCUNN_SO_VERSION=1 -DTHD_SO_VERSION=1 -DUSE_CUDA=1 -DNO_NNPACK=0 -DNCCL_EXTERNAL=1 -Dnanopb_BUILD_GENERATOR=0 -DCMAKE_DEBUG_POSTFIX= -DCMAKE_BUILD_TYPE=Release -DCMAKE_EXPORT_COMPILE_COMMANDS=1\n    -- The C compiler identification is GNU 5.4.0\n    -- The CXX compiler identification is GNU 5.4.0\n    -- Check for working C compiler: /usr/bin/cc\n    -- Check for working C compiler: /usr/bin/cc -- works\n    -- Detecting C compiler ABI info\n    -- Detecting C compiler ABI info - done\n    -- Detecting C compile features\n    -- Detecting C compile features - done\n    -- Check for working CXX compiler: /usr/bin/c++\n    -- Check for working CXX compiler: /usr/bin/c++ -- works\n    -- Detecting CXX compiler ABI info\n    -- Detecting CXX compiler ABI info - done\n    -- Detecting CXX compile features\n    -- Detecting CXX compile features - done\n    -- Looking for pthread.h\n    -- Looking for pthread.h - found\n    -- Looking for pthread_create\n    -- Looking for pthread_create - not found\n    -- Looking for pthread_create in pthreads\n    -- Looking for pthread_create in pthreads - not found\n    -- Looking for pthread_create in pthread\n    -- Looking for pthread_create in pthread - found\n    -- Found Threads: TRUE\n    -- Caffe2: Found protobuf with new-style protobuf targets.\n    -- Caffe2: Protobuf version 3.5.0\n    -- Found CUDA: /usr/local/cuda (found suitable version \"9.0\", minimum required is \"7.0\")\n    -- Caffe2: CUDA detected: 9.0\n    -- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\n    -- Caffe2: CUDA toolkit directory: /usr/local/cuda\n    -- Caffe2: Header version is: 9.0\n    -- Found CUDNN: /usr/include/\n    -- Found cuDNN: v7.1.4  (include: /usr/include/, library: /usr/lib/x86_64-linux-gnu/libcudnn.so.7)\n    CMake Warning at /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/public/utils.cmake:173 (message):\n      In the future we will require one to explicitly pass TORCH_CUDA_ARCH_LIST\n      to cmake instead of implicitly setting it as an env variable.  This will\n      become a FATAL_ERROR in future version of pytorch.\n    Call Stack (most recent call first):\n      /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/public/cuda.cmake:332 (torch_cuda_get_nvcc_gencode_flag)\n      /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/Caffe2Config.cmake:79 (include)\n      CMakeLists.txt:13 (find_package)\n\n\n    -- Added CUDA NVCC flags for: -gencode;arch=compute_35,code=sm_35;-gencode;arch=compute_52,code=sm_52;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_70,code=compute_70\n    -- Found Gloo: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\n    -- Gloo_LIBRARY: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libgloo_cuda.a\n    -- Gloo_NATIVE_LIBRARY: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libgloo.a\n    -- Gloo_INCLUDE_DIR: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\n    -- Could NOT find MPI_C (missing:  MPI_C_LIBRARIES MPI_C_INCLUDE_PATH)\n    -- Could NOT find MPI_CXX (missing:  MPI_CXX_LIBRARIES MPI_CXX_INCLUDE_PATH)\n    -- Not able to find MPI, will compile c10d without MPI support\n    -- Found NCCL: /usr/include\n    -- Determining NCCL version from the header file: /usr/include/nccl.h\n    -- NCCL_MAJOR_VERSION: 2\n    -- Found NCCL (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnccl.so)\n    -- NCCL_LIBRARIES: /usr/lib/x86_64-linux-gnu/libnccl.so\n    -- NCCL_INCLUDE_DIRS: /usr/include\n    -- NCCL Version 2 or higher found, will compile with NCCL distributed backend\n    -- Found CUDA: /usr/local/cuda (found version \"9.0\")\n    -- Configuring done\n    -- Generating done\n    CMake Warning:\n      Manually-specified variables were not used by the project:\n\n        CAFFE2_LIBRARIES\n        CMAKE_DEBUG_POSTFIX\n        CMAKE_INSTALL_LIBDIR\n        NCCL_EXTERNAL\n        NO_NNPACK\n        THCS_LIBRARIES\n        THCUNN_LIBRARIES\n        THCUNN_SO_VERSION\n        THC_LIBRARIES\n        THC_SO_VERSION\n        THD_SO_VERSION\n        THNN_LIBRARIES\n        THNN_SO_VERSION\n        THS_LIBRARIES\n        TH_INCLUDE_PATH\n        TH_LIBRARIES\n        TH_LIB_PATH\n        TH_SO_VERSION\n        Torch_FOUND\n        USE_CUDA\n        cwrap_files\n        nanopb_BUILD_GENERATOR\n\n\n    -- Build files have been written to: /tmp/pip-req-build-2s8ksvn3/torch/lib/build/c10d\n    + make install -j80\n    Scanning dependencies of target c10d\n    [  4%] Building CXX object CMakeFiles/c10d.dir/CUDAUtils.cpp.o\n    [  8%] Building CXX object CMakeFiles/c10d.dir/FileStore.cpp.o\n    [ 13%] Building CXX object CMakeFiles/c10d.dir/Store.cpp.o\n    [ 17%] Building CXX object CMakeFiles/c10d.dir/TCPStore.cpp.o\n    [ 21%] Building CXX object CMakeFiles/c10d.dir/ProcessGroup.cpp.o\n    [ 26%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupGloo.cpp.o\n    [ 30%] Building CXX object CMakeFiles/c10d.dir/Utils.cpp.o\n    [ 34%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/ProcessGroupGloo.cpp: In member function 'c10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/ProcessGroupGloo.cpp:445:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n       if (vec.size() != cacheNumAlgorithmEntries_) {\n                      ^\n    [ 39%] Linking CXX static library libc10d.a\n    [ 39%] Built target c10d\n    [ 43%] Building NVCC (Device) object test/CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o\n    Scanning dependencies of target FileStoreTest\n    Scanning dependencies of target TCPStoreTest\n    [ 47%] Building CXX object test/CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o\n    [ 52%] Building CXX object test/CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o\n    Scanning dependencies of target allreduce\n    [ 56%] Building CXX object example/CMakeFiles/allreduce.dir/allreduce.cpp.o\n    [ 60%] Linking CXX executable FileStoreTest\n    [ 60%] Built target FileStoreTest\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp: In function 'int main(int, char**)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp:16:64: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\n         auto x = at::ones(at::CPU(at::kFloat), {1000, 16 * (i + 1)});\n                                                                    ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp:2:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type & dtype, IntList size) {\n                          ^\n    [ 65%] Linking CXX executable TCPStoreTest\n    [ 69%] Linking CXX executable allreduce\n    [ 69%] Built target TCPStoreTest\n    [ 69%] Built target allreduce\n    Scanning dependencies of target c10d_cuda_test\n    [ 73%] Linking CXX static library libc10d_cuda_test.a\n    [ 73%] Built target c10d_cuda_test\n    Scanning dependencies of target ProcessGroupGlooTest\n    Scanning dependencies of target ProcessGroupNCCLTest\n    Scanning dependencies of target ProcessGroupGlooAsyncTest\n    [ 78%] Building CXX object test/CMakeFiles/ProcessGroupGlooTest.dir/ProcessGroupGlooTest.cpp.o\n    [ 82%] Building CXX object test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o\n    [ 86%] Building CXX object test/CMakeFiles/ProcessGroupGlooAsyncTest.dir/ProcessGroupGlooAsyncTest.cpp.o\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp: In member function 'std::vector<at::Tensor> NCCLTest::getTensors()':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:99:49: error: no matching function for call to 'at::Tensor::toBackend(const at::DeviceType&)'\n           outputs[i] = inputs_[i].toBackend(at::kCPU);\n                                                     ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/NativeFunctions.h:7:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:11,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupNCCL.hpp:8,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:5:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note: candidate: at::Tensor at::Tensor::toBackend(at::Backend) const\n     inline Tensor Tensor::toBackend(Backend b) const {\n                   ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note:   no known conversion for argument 1 from 'const at::DeviceType' to 'at::Backend'\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp: In member function 'std::vector<std::vector<at::Tensor> > NCCLTest::getOutputTensors()':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:118:58: error: no matching function for call to 'at::Tensor::toBackend(const at::DeviceType&)'\n             outputs[i][j] = outputs_[i][j].toBackend(at::kCPU);\n                                                              ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/NativeFunctions.h:7:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:11,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupNCCL.hpp:8,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:5:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note: candidate: at::Tensor at::Tensor::toBackend(at::Backend) const\n     inline Tensor Tensor::toBackend(Backend b) const {\n                   ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note:   no known conversion for argument 1 from 'const at::DeviceType' to 'at::Backend'\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In member function 'std::shared_ptr<c10d::ProcessGroup::Work> SignalTest::run(int, int)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:51:47: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\n             at::ones(at::CPU(at::kFloat), {16, 16}),\n                                                   ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type & dtype, IntList size) {\n                          ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In function 'void testAllreduce(const string&, at::Backend)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:158:64: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\n         auto tensor = at::ones(at::getType(b, at::kFloat), {16, 16}) * i;\n                                                                    ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type & dtype, IntList size) {\n                          ^\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In function 'void testBroadcast(const string&, at::Backend)':\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:208:49: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\n               inputs[k][l] = at::ones(type, {16, 16}) * (k * stride + l);\n                                                     ^\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\n     static inline Tensor ones(const Type & dtype, IntList size) {\n                          ^\n    test/CMakeFiles/ProcessGroupNCCLTest.dir/build.make:62: recipe for target 'test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o' failed\n    make[2]: *** [test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o] Error 1\n    CMakeFiles/Makefile2:375: recipe for target 'test/CMakeFiles/ProcessGroupNCCLTest.dir/all' failed\n    make[1]: *** [test/CMakeFiles/ProcessGroupNCCLTest.dir/all] Error 2\n    make[1]: *** Waiting for unfinished jobs....\n    [ 91%] Linking CXX executable ProcessGroupGlooTest\n    [ 95%] Linking CXX executable ProcessGroupGlooAsyncTest\n    [ 95%] Built target ProcessGroupGlooTest\n    [ 95%] Built target ProcessGroupGlooAsyncTest\n    Makefile:138: recipe for target 'all' failed\n    make: *** [all] Error 2\n    Failed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack caffe2 nanopb libshm gloo THD c10d'\n    Running setup.py install for torch: finished with status 'error'\nCleaning up...\n  Removing source in /tmp/pip-req-build-2s8ksvn3\nCommand \"/opt/conda/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-req-build-2s8ksvn3/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-ppouch5h/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-req-build-2s8ksvn3/\nException information:\nTraceback (most recent call last):\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/basecommand.py\", line 228, in main\n    status = self.run(options, args)\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/commands/install.py\", line 335, in run\n    use_user_site=options.use_user_site,\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/req/__init__.py\", line 49, in install_given_reqs\n    **kwargs\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/req/req_install.py\", line 779, in install\n    spinner=spinner,\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/utils/misc.py\", line 698, in call_subprocess\n    % (command_desc, proc.returncode, cwd))\npip._internal.exceptions.InstallationError: Command \"/opt/conda/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-req-build-2s8ksvn3/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-ppouch5h/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-req-build-2s8ksvn3/\n\n\nSystem Info\n\nPyTorch or Caffe2: PyTorch\nHow you installed PyTorch (conda, pip, source): Docker\nBuild command you used (if compiling from source):\nOS: Ubuntu 16.04\nPyTorch version: 0.4.1\nPython version: 3.6.6\nCUDA/cuDNN version: CUDA9.0, cuDNN 7\nGPU models and configuration: Pascal P100\nGCC version (if compiling from source): 5.4.0\nCMake version: 3.5.1", "body": "## Issue description\r\n\r\nWhen I am trying to build a Pytorch docker container, I encounter the following errors:\r\n\r\n```\r\n    Install the project...\r\n    -- Install configuration: \"Release\"\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHD.a\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/THD.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/THDGenerateAllTypes.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/TensorDescriptor.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/Cuda.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/ChannelType.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/DataChannelRequest.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/base/DataChannel.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/process_group/Collectives.h\r\n    -- Installing: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THD/process_group/General.h\r\n    + popd\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\r\n    ++ uname\r\n    + [[ Linux == \\D\\a\\r\\w\\i\\n ]]\r\n    + popd\r\n    /tmp/pip-req-build-2s8ksvn3/build\r\n    + for arg in '\"$@\"'\r\n    + [[ c10d == \\n\\c\\c\\l ]]\r\n    + [[ c10d == \\g\\l\\o\\o ]]\r\n    + [[ c10d == \\c\\a\\f\\f\\e\\2 ]]\r\n    + [[ c10d == \\T\\H\\D ]]\r\n    + [[ c10d == \\l\\i\\b\\s\\h\\m ]]\r\n    + [[ c10d == \\l\\i\\b\\s\\h\\m\\_\\w\\i\\n\\d\\o\\w\\s ]]\r\n    + [[ c10d == \\c\\1\\0\\d ]]\r\n    + pushd /tmp/pip-req-build-2s8ksvn3/torch/lib\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\r\n    + build c10d\r\n    + [[ -z '' ]]\r\n    + CMAKE_ARGS=()\r\n    + mkdir -p build/c10d\r\n    + pushd build/c10d\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/build/c10d /tmp/pip-req-build-2s8ksvn3/torch/lib /tmp/pip-req-build-2s8ksvn3/build\r\n    + BUILD_C_FLAGS=\r\n    + case $1 in\r\n    + BUILD_C_FLAGS=' -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions'\r\n    + cmake ../../c10d -DCMAKE_MODULE_PATH=/tmp/pip-req-build-2s8ksvn3/cmake/Modules_CUDA_fix -DTorch_FOUND=1 -DCMAKE_INSTALL_PREFIX=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install '-DCMAKE_C_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions ' '-DCMAKE_CXX_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1 -fexceptions  -std=c++11  ' '-DCMAKE_EXE_LINKER_FLAGS=-L\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN ' '-DCMAKE_SHARED_LINKER_FLAGS=-L\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN ' -DCMAKE_INSTALL_LIBDIR=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib '-DCUDA_NVCC_FLAGS= -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/TH\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THC\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THS\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCS\"   -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THNN\" -I\"/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1' -DCUDA_DEVICE_DEBUG=0 -DCMAKE_PREFIX_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install '-Dcwrap_files=/tmp/pip-req-build-2s8ksvn3/torch/lib/ATen/Declarations.cwrap;/tmp/pip-req-build-2s8ksvn3/torch/lib/THNN/generic/THNN.h;/tmp/pip-req-build-2s8ksvn3/torch/lib/THCUNN/generic/THCUNN.h;/tmp/pip-req-build-2s8ksvn3/torch/lib/ATen/nn.yaml' -DTH_INCLUDE_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include -DTH_LIB_PATH=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib -DTH_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTH.so -DCAFFE2_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libcaffe2.so -DTHNN_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHNN.so -DTHCUNN_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHCUNN.so -DTHS_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHS.so -DTHC_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHC.so -DTHCS_LIBRARIES=/tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libTHCS.so -DTH_SO_VERSION=1 -DTHC_SO_VERSION=1 -DTHNN_SO_VERSION=1 -DTHCUNN_SO_VERSION=1 -DTHD_SO_VERSION=1 -DUSE_CUDA=1 -DNO_NNPACK=0 -DNCCL_EXTERNAL=1 -Dnanopb_BUILD_GENERATOR=0 -DCMAKE_DEBUG_POSTFIX= -DCMAKE_BUILD_TYPE=Release -DCMAKE_EXPORT_COMPILE_COMMANDS=1\r\n    -- The C compiler identification is GNU 5.4.0\r\n    -- The CXX compiler identification is GNU 5.4.0\r\n    -- Check for working C compiler: /usr/bin/cc\r\n    -- Check for working C compiler: /usr/bin/cc -- works\r\n    -- Detecting C compiler ABI info\r\n    -- Detecting C compiler ABI info - done\r\n    -- Detecting C compile features\r\n    -- Detecting C compile features - done\r\n    -- Check for working CXX compiler: /usr/bin/c++\r\n    -- Check for working CXX compiler: /usr/bin/c++ -- works\r\n    -- Detecting CXX compiler ABI info\r\n    -- Detecting CXX compiler ABI info - done\r\n    -- Detecting CXX compile features\r\n    -- Detecting CXX compile features - done\r\n    -- Looking for pthread.h\r\n    -- Looking for pthread.h - found\r\n    -- Looking for pthread_create\r\n    -- Looking for pthread_create - not found\r\n    -- Looking for pthread_create in pthreads\r\n    -- Looking for pthread_create in pthreads - not found\r\n    -- Looking for pthread_create in pthread\r\n    -- Looking for pthread_create in pthread - found\r\n    -- Found Threads: TRUE\r\n    -- Caffe2: Found protobuf with new-style protobuf targets.\r\n    -- Caffe2: Protobuf version 3.5.0\r\n    -- Found CUDA: /usr/local/cuda (found suitable version \"9.0\", minimum required is \"7.0\")\r\n    -- Caffe2: CUDA detected: 9.0\r\n    -- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\r\n    -- Caffe2: CUDA toolkit directory: /usr/local/cuda\r\n    -- Caffe2: Header version is: 9.0\r\n    -- Found CUDNN: /usr/include/\r\n    -- Found cuDNN: v7.1.4  (include: /usr/include/, library: /usr/lib/x86_64-linux-gnu/libcudnn.so.7)\r\n    CMake Warning at /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/public/utils.cmake:173 (message):\r\n      In the future we will require one to explicitly pass TORCH_CUDA_ARCH_LIST\r\n      to cmake instead of implicitly setting it as an env variable.  This will\r\n      become a FATAL_ERROR in future version of pytorch.\r\n    Call Stack (most recent call first):\r\n      /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/public/cuda.cmake:332 (torch_cuda_get_nvcc_gencode_flag)\r\n      /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/share/cmake/Caffe2/Caffe2Config.cmake:79 (include)\r\n      CMakeLists.txt:13 (find_package)\r\n\r\n\r\n    -- Added CUDA NVCC flags for: -gencode;arch=compute_35,code=sm_35;-gencode;arch=compute_52,code=sm_52;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_70,code=compute_70\r\n    -- Found Gloo: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\r\n    -- Gloo_LIBRARY: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libgloo_cuda.a\r\n    -- Gloo_NATIVE_LIBRARY: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/lib/libgloo.a\r\n    -- Gloo_INCLUDE_DIR: /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include\r\n    -- Could NOT find MPI_C (missing:  MPI_C_LIBRARIES MPI_C_INCLUDE_PATH)\r\n    -- Could NOT find MPI_CXX (missing:  MPI_CXX_LIBRARIES MPI_CXX_INCLUDE_PATH)\r\n    -- Not able to find MPI, will compile c10d without MPI support\r\n    -- Found NCCL: /usr/include\r\n    -- Determining NCCL version from the header file: /usr/include/nccl.h\r\n    -- NCCL_MAJOR_VERSION: 2\r\n    -- Found NCCL (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnccl.so)\r\n    -- NCCL_LIBRARIES: /usr/lib/x86_64-linux-gnu/libnccl.so\r\n    -- NCCL_INCLUDE_DIRS: /usr/include\r\n    -- NCCL Version 2 or higher found, will compile with NCCL distributed backend\r\n    -- Found CUDA: /usr/local/cuda (found version \"9.0\")\r\n    -- Configuring done\r\n    -- Generating done\r\n    CMake Warning:\r\n      Manually-specified variables were not used by the project:\r\n\r\n        CAFFE2_LIBRARIES\r\n        CMAKE_DEBUG_POSTFIX\r\n        CMAKE_INSTALL_LIBDIR\r\n        NCCL_EXTERNAL\r\n        NO_NNPACK\r\n        THCS_LIBRARIES\r\n        THCUNN_LIBRARIES\r\n        THCUNN_SO_VERSION\r\n        THC_LIBRARIES\r\n        THC_SO_VERSION\r\n        THD_SO_VERSION\r\n        THNN_LIBRARIES\r\n        THNN_SO_VERSION\r\n        THS_LIBRARIES\r\n        TH_INCLUDE_PATH\r\n        TH_LIBRARIES\r\n        TH_LIB_PATH\r\n        TH_SO_VERSION\r\n        Torch_FOUND\r\n        USE_CUDA\r\n        cwrap_files\r\n        nanopb_BUILD_GENERATOR\r\n\r\n\r\n    -- Build files have been written to: /tmp/pip-req-build-2s8ksvn3/torch/lib/build/c10d\r\n    + make install -j80\r\n    Scanning dependencies of target c10d\r\n    [  4%] Building CXX object CMakeFiles/c10d.dir/CUDAUtils.cpp.o\r\n    [  8%] Building CXX object CMakeFiles/c10d.dir/FileStore.cpp.o\r\n    [ 13%] Building CXX object CMakeFiles/c10d.dir/Store.cpp.o\r\n    [ 17%] Building CXX object CMakeFiles/c10d.dir/TCPStore.cpp.o\r\n    [ 21%] Building CXX object CMakeFiles/c10d.dir/ProcessGroup.cpp.o\r\n    [ 26%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupGloo.cpp.o\r\n    [ 30%] Building CXX object CMakeFiles/c10d.dir/Utils.cpp.o\r\n    [ 34%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/ProcessGroupGloo.cpp: In member function 'c10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&)':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/ProcessGroupGloo.cpp:445:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n       if (vec.size() != cacheNumAlgorithmEntries_) {\r\n                      ^\r\n    [ 39%] Linking CXX static library libc10d.a\r\n    [ 39%] Built target c10d\r\n    [ 43%] Building NVCC (Device) object test/CMakeFiles/c10d_cuda_test.dir/c10d_cuda_test_generated_CUDATest.cu.o\r\n    Scanning dependencies of target FileStoreTest\r\n    Scanning dependencies of target TCPStoreTest\r\n    [ 47%] Building CXX object test/CMakeFiles/FileStoreTest.dir/FileStoreTest.cpp.o\r\n    [ 52%] Building CXX object test/CMakeFiles/TCPStoreTest.dir/TCPStoreTest.cpp.o\r\n    Scanning dependencies of target allreduce\r\n    [ 56%] Building CXX object example/CMakeFiles/allreduce.dir/allreduce.cpp.o\r\n    [ 60%] Linking CXX executable FileStoreTest\r\n    [ 60%] Built target FileStoreTest\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp: In function 'int main(int, char**)':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp:16:64: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\r\n         auto x = at::ones(at::CPU(at::kFloat), {1000, 16 * (i + 1)});\r\n                                                                    ^\r\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/example/allreduce.cpp:2:\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\r\n     static inline Tensor ones(const Type & dtype, IntList size) {\r\n                          ^\r\n    [ 65%] Linking CXX executable TCPStoreTest\r\n    [ 69%] Linking CXX executable allreduce\r\n    [ 69%] Built target TCPStoreTest\r\n    [ 69%] Built target allreduce\r\n    Scanning dependencies of target c10d_cuda_test\r\n    [ 73%] Linking CXX static library libc10d_cuda_test.a\r\n    [ 73%] Built target c10d_cuda_test\r\n    Scanning dependencies of target ProcessGroupGlooTest\r\n    Scanning dependencies of target ProcessGroupNCCLTest\r\n    Scanning dependencies of target ProcessGroupGlooAsyncTest\r\n    [ 78%] Building CXX object test/CMakeFiles/ProcessGroupGlooTest.dir/ProcessGroupGlooTest.cpp.o\r\n    [ 82%] Building CXX object test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o\r\n    [ 86%] Building CXX object test/CMakeFiles/ProcessGroupGlooAsyncTest.dir/ProcessGroupGlooAsyncTest.cpp.o\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp: In member function 'std::vector<at::Tensor> NCCLTest::getTensors()':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:99:49: error: no matching function for call to 'at::Tensor::toBackend(const at::DeviceType&)'\r\n           outputs[i] = inputs_[i].toBackend(at::kCPU);\r\n                                                     ^\r\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/NativeFunctions.h:7:0,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:11,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupNCCL.hpp:8,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:5:\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note: candidate: at::Tensor at::Tensor::toBackend(at::Backend) const\r\n     inline Tensor Tensor::toBackend(Backend b) const {\r\n                   ^\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note:   no known conversion for argument 1 from 'const at::DeviceType' to 'at::Backend'\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp: In member function 'std::vector<std::vector<at::Tensor> > NCCLTest::getOutputTensors()':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:118:58: error: no matching function for call to 'at::Tensor::toBackend(const at::DeviceType&)'\r\n             outputs[i][j] = outputs_[i][j].toBackend(at::kCPU);\r\n                                                              ^\r\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/NativeFunctions.h:7:0,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:11,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupNCCL.hpp:8,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupNCCLTest.cpp:5:\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note: candidate: at::Tensor at::Tensor::toBackend(at::Backend) const\r\n     inline Tensor Tensor::toBackend(Backend b) const {\r\n                   ^\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/TensorMethods.h:38:15: note:   no known conversion for argument 1 from 'const at::DeviceType' to 'at::Backend'\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In member function 'std::shared_ptr<c10d::ProcessGroup::Work> SignalTest::run(int, int)':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:51:47: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\r\n             at::ones(at::CPU(at::kFloat), {16, 16}),\r\n                                                   ^\r\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\r\n     static inline Tensor ones(const Type & dtype, IntList size) {\r\n                          ^\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In function 'void testAllreduce(const string&, at::Backend)':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:158:64: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\r\n         auto tensor = at::ones(at::getType(b, at::kFloat), {16, 16}) * i;\r\n                                                                    ^\r\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\r\n     static inline Tensor ones(const Type & dtype, IntList size) {\r\n                          ^\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp: In function 'void testBroadcast(const string&, at::Backend)':\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:208:49: warning: 'at::Tensor at::ones(const at::Type&, at::IntList)' is deprecated [-Wdeprecated-declarations]\r\n               inputs[k][l] = at::ones(type, {16, 16}) * (k * stride + l);\r\n                                                     ^\r\n    In file included from /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/ATen.h:13:0,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroup.hpp:7,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/../c10d/ProcessGroupGloo.hpp:19,\r\n                     from /tmp/pip-req-build-2s8ksvn3/torch/lib/c10d/test/ProcessGroupGlooTest.cpp:16:\r\n    /tmp/pip-req-build-2s8ksvn3/torch/lib/tmp_install/include/ATen/Functions.h:3949:22: note: declared here\r\n     static inline Tensor ones(const Type & dtype, IntList size) {\r\n                          ^\r\n    test/CMakeFiles/ProcessGroupNCCLTest.dir/build.make:62: recipe for target 'test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o' failed\r\n    make[2]: *** [test/CMakeFiles/ProcessGroupNCCLTest.dir/ProcessGroupNCCLTest.cpp.o] Error 1\r\n    CMakeFiles/Makefile2:375: recipe for target 'test/CMakeFiles/ProcessGroupNCCLTest.dir/all' failed\r\n    make[1]: *** [test/CMakeFiles/ProcessGroupNCCLTest.dir/all] Error 2\r\n    make[1]: *** Waiting for unfinished jobs....\r\n    [ 91%] Linking CXX executable ProcessGroupGlooTest\r\n    [ 95%] Linking CXX executable ProcessGroupGlooAsyncTest\r\n    [ 95%] Built target ProcessGroupGlooTest\r\n    [ 95%] Built target ProcessGroupGlooAsyncTest\r\n    Makefile:138: recipe for target 'all' failed\r\n    make: *** [all] Error 2\r\n    Failed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack caffe2 nanopb libshm gloo THD c10d'\r\n    Running setup.py install for torch: finished with status 'error'\r\nCleaning up...\r\n  Removing source in /tmp/pip-req-build-2s8ksvn3\r\nCommand \"/opt/conda/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-req-build-2s8ksvn3/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-ppouch5h/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-req-build-2s8ksvn3/\r\nException information:\r\nTraceback (most recent call last):\r\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/basecommand.py\", line 228, in main\r\n    status = self.run(options, args)\r\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/commands/install.py\", line 335, in run\r\n    use_user_site=options.use_user_site,\r\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/req/__init__.py\", line 49, in install_given_reqs\r\n    **kwargs\r\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/req/req_install.py\", line 779, in install\r\n    spinner=spinner,\r\n  File \"/opt/conda/lib/python3.6/site-packages/pip/_internal/utils/misc.py\", line 698, in call_subprocess\r\n    % (command_desc, proc.returncode, cwd))\r\npip._internal.exceptions.InstallationError: Command \"/opt/conda/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-req-build-2s8ksvn3/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-record-ppouch5h/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-req-build-2s8ksvn3/\r\n\r\n```\r\n\r\n## System Info\r\n\r\n- PyTorch or Caffe2: PyTorch\r\n- How you installed PyTorch (conda, pip, source): Docker\r\n- Build command you used (if compiling from source):\r\n- OS: Ubuntu 16.04\r\n- PyTorch version: 0.4.1\r\n- Python version: 3.6.6\r\n- CUDA/cuDNN version: CUDA9.0, cuDNN 7\r\n- GPU models and configuration: Pascal P100\r\n- GCC version (if compiling from source): 5.4.0\r\n- CMake version: 3.5.1\r\n"}