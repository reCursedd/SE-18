{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/434666341", "html_url": "https://github.com/pytorch/pytorch/issues/8582#issuecomment-434666341", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8582", "id": 434666341, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDY2NjM0MQ==", "user": {"login": "314rated", "id": 11274497, "node_id": "MDQ6VXNlcjExMjc0NDk3", "avatar_url": "https://avatars2.githubusercontent.com/u/11274497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/314rated", "html_url": "https://github.com/314rated", "followers_url": "https://api.github.com/users/314rated/followers", "following_url": "https://api.github.com/users/314rated/following{/other_user}", "gists_url": "https://api.github.com/users/314rated/gists{/gist_id}", "starred_url": "https://api.github.com/users/314rated/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/314rated/subscriptions", "organizations_url": "https://api.github.com/users/314rated/orgs", "repos_url": "https://api.github.com/users/314rated/repos", "events_url": "https://api.github.com/users/314rated/events{/privacy}", "received_events_url": "https://api.github.com/users/314rated/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-31T12:20:51Z", "updated_at": "2018-10-31T12:21:36Z", "author_association": "NONE", "body_html": "<p>I too am facing the same issue.<br>\nThere is a LSTM model which needs to be frozen. The output of the LSTM goes to another net, Net2, which needs to be trained.<br>\nI am setting lstm to eval mode, setting net2 to train. When I do backprop on loss, I get the error:<br>\n<em><strong>RuntimeError: cudnn RNN backward can only be called in training mode</strong></em></p>\n<p>If I change the LSTM to train mode and then do backprop, it works. However, I need the LSTM to be frozen.</p>\n<p>Could you please help?<br>\nThanks</p>", "body_text": "I too am facing the same issue.\nThere is a LSTM model which needs to be frozen. The output of the LSTM goes to another net, Net2, which needs to be trained.\nI am setting lstm to eval mode, setting net2 to train. When I do backprop on loss, I get the error:\nRuntimeError: cudnn RNN backward can only be called in training mode\nIf I change the LSTM to train mode and then do backprop, it works. However, I need the LSTM to be frozen.\nCould you please help?\nThanks", "body": "I too am facing the same issue.\r\nThere is a LSTM model which needs to be frozen. The output of the LSTM goes to another net, Net2, which needs to be trained. \r\nI am setting lstm to eval mode, setting net2 to train. When I do backprop on loss, I get the error:\r\n***RuntimeError: cudnn RNN backward can only be called in training mode***\r\n\r\nIf I change the LSTM to train mode and then do backprop, it works. However, I need the LSTM to be frozen.\r\n\r\nCould you please help?\r\nThanks"}