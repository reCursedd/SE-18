{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6714", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6714/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6714/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6714/events", "html_url": "https://github.com/pytorch/pytorch/issues/6714", "id": 315588328, "node_id": "MDU6SXNzdWUzMTU1ODgzMjg=", "number": 6714, "title": "[JIT] integer constant handling seems inconsistent", "user": {"login": "gchanan", "id": 3768583, "node_id": "MDQ6VXNlcjM3Njg1ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/3768583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gchanan", "html_url": "https://github.com/gchanan", "followers_url": "https://api.github.com/users/gchanan/followers", "following_url": "https://api.github.com/users/gchanan/following{/other_user}", "gists_url": "https://api.github.com/users/gchanan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gchanan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gchanan/subscriptions", "organizations_url": "https://api.github.com/users/gchanan/orgs", "repos_url": "https://api.github.com/users/gchanan/repos", "events_url": "https://api.github.com/users/gchanan/events{/privacy}", "received_events_url": "https://api.github.com/users/gchanan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-18T18:15:35Z", "updated_at": "2018-06-29T21:39:58Z", "closed_at": "2018-06-29T21:39:58Z", "author_association": "CONTRIBUTOR", "body_html": "<p>After removing some zero-dim handling in ATen (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"315276476\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/6683\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/6683/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/6683\">#6683</a>), I get a test failure in <code>python test/test_jit.py TestScript.test_script_module_for</code>.   The error given is:</p>\n<pre><code>======================================================================\nERROR: test_script_module_for (__main__.TestScript)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"test/test_jit.py\", line 2158, in test_script_module_for\n    self.assertEqual(m(), 10)\n  File \"/data/users/gchanan/pytorch9j/torch/nn/modules/module.py\", line 460, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/data/users/gchanan/pytorch9j/torch/jit/__init__.py\", line 761, in forward\n    return self.__getattr__('forward')(*args, **kwargs)\nRuntimeError:\nExpected object of type CPULongType but found type CPUIntType for argument #3 'other' (checked_cast_tensor at ../src/ATen/Utils.h:30)\nframe #0: at::CPULongTensor* at::checked_cast_tensor&lt;at::CPULongTensor, at::TensorImpl&gt;(at::TensorImpl*, char const*, int, bool) + 0x110 (0x7f8613781106 in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\nframe #1: at::CPULongType::s_add(at::Tensor const&amp;, at::Tensor const&amp;, at::Scalar) const + 0x152 (0x7f861382d240 in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\nframe #2: torch::autograd::VariableType::s_add(at::Tensor const&amp;, at::Tensor const&amp;, at::Scalar) const + 0x2e9 (0x7f86159403cb in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #3: at::Type::add(at::Tensor const&amp;, at::Tensor const&amp;, at::Scalar) const + 0xda (0x7f861387099c in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\nframe #4: &lt;unknown function&gt; + 0xed673c (0x7f861560a73c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #5: &lt;unknown function&gt; + 0xefa28c (0x7f861562e28c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #6: &lt;unknown function&gt; + 0xff8e63 (0x7f861572ce63 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #7: std::function&lt;int (std::vector&lt;at::Tensor, std::allocator&lt;at::Tensor&gt; &gt;&amp;)&gt;::operator()(std::vector&lt;at::Tensor, std::allocator&lt;at::Tensor&gt; &gt;&amp;) const + 0x49 (0x7f86154a7c1f in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #8: torch::jit::InterpreterStateImpl::runOneStage(std::vector&lt;at::Tensor, std::allocator&lt;at::Tensor&gt; &gt;&amp;) + 0xb2 (0x7f86154a3e2c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #9: torch::jit::InterpreterState::runOneStage(std::vector&lt;at::Tensor, std::allocator&lt;at::Tensor&gt; &gt;&amp;) + 0x2b (0x7f861549b1d1 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #10: torch::jit::GraphExecutorImpl::runFallback(torch::jit::variable_tensor_list) + 0x69 (0x7f86154ef411 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #11: torch::jit::GraphExecutorImpl::run(torch::jit::variable_tensor_list) + 0x219 (0x7f86154eef05 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #12: torch::jit::GraphExecutor::run(torch::jit::variable_tensor_list&amp;&amp;) + 0x55 (0x7f86154eaa51 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #13: torch::jit::script::Method::run(torch::jit::variable_tensor_list&amp;&amp;) + 0xd0 (0x7f8615860dc8 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #14: &lt;unknown function&gt; + 0x1127035 (0x7f861585b035 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #15: &lt;unknown function&gt; + 0x112c873 (0x7f8615860873 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #16: &lt;unknown function&gt; + 0x112c0c3 (0x7f86158600c3 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #17: &lt;unknown function&gt; + 0x112b79a (0x7f861585f79a in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #18: &lt;unknown function&gt; + 0x112b82b (0x7f861585f82b in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #19: &lt;unknown function&gt; + 0xc7fcf4 (0x7f86153b3cf4 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #20: PyCFunction_Call + 0x131 (0x7f8629dbedd1 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #21: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #22: &lt;unknown function&gt; + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #23: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #24: &lt;unknown function&gt; + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #25: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #26: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #27: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #28: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #29: &lt;unknown function&gt; + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #30: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #31: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #32: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #33: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #34: &lt;unknown function&gt; + 0x9ab72 (0x7f8629d9cb72 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #35: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #36: &lt;unknown function&gt; + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #37: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #38: &lt;unknown function&gt; + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #39: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #40: PyEval_EvalFrameEx + 0x778c (0x7f8629e4579c in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #41: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #42: PyEval_EvalFrameEx + 0x812d (0x7f8629e4613d in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #43: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #44: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #45: &lt;unknown function&gt; + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #46: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #47: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #48: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #49: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #50: &lt;unknown function&gt; + 0x9ab72 (0x7f8629d9cb72 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #51: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #52: &lt;unknown function&gt; + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #53: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #54: &lt;unknown function&gt; + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #55: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #56: PyEval_EvalFrameEx + 0x778c (0x7f8629e4579c in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #57: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #58: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #59: &lt;unknown function&gt; + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #60: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #61: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #62: &lt;unknown function&gt; + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #63: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\n:\noperation failed in interpreter:\n@torch.jit.script_method\ndef forward(self):\n    sum = 0\n    for i in self.b:\n        sum += i\n        ~~~~~~~~ &lt;--- HERE\n    return sum\n</code></pre>\n<p>This seems fishy because everything is a python (long) constant here and the test passes if I turn all the constants in floats.</p>\n<p>CC <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4583066\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/apaszke\">@apaszke</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=370202\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zdevito\">@zdevito</a>.</p>", "body_text": "After removing some zero-dim handling in ATen (#6683), I get a test failure in python test/test_jit.py TestScript.test_script_module_for.   The error given is:\n======================================================================\nERROR: test_script_module_for (__main__.TestScript)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"test/test_jit.py\", line 2158, in test_script_module_for\n    self.assertEqual(m(), 10)\n  File \"/data/users/gchanan/pytorch9j/torch/nn/modules/module.py\", line 460, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/data/users/gchanan/pytorch9j/torch/jit/__init__.py\", line 761, in forward\n    return self.__getattr__('forward')(*args, **kwargs)\nRuntimeError:\nExpected object of type CPULongType but found type CPUIntType for argument #3 'other' (checked_cast_tensor at ../src/ATen/Utils.h:30)\nframe #0: at::CPULongTensor* at::checked_cast_tensor<at::CPULongTensor, at::TensorImpl>(at::TensorImpl*, char const*, int, bool) + 0x110 (0x7f8613781106 in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\nframe #1: at::CPULongType::s_add(at::Tensor const&, at::Tensor const&, at::Scalar) const + 0x152 (0x7f861382d240 in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\nframe #2: torch::autograd::VariableType::s_add(at::Tensor const&, at::Tensor const&, at::Scalar) const + 0x2e9 (0x7f86159403cb in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #3: at::Type::add(at::Tensor const&, at::Tensor const&, at::Scalar) const + 0xda (0x7f861387099c in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\nframe #4: <unknown function> + 0xed673c (0x7f861560a73c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #5: <unknown function> + 0xefa28c (0x7f861562e28c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #6: <unknown function> + 0xff8e63 (0x7f861572ce63 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #7: std::function<int (std::vector<at::Tensor, std::allocator<at::Tensor> >&)>::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&) const + 0x49 (0x7f86154a7c1f in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #8: torch::jit::InterpreterStateImpl::runOneStage(std::vector<at::Tensor, std::allocator<at::Tensor> >&) + 0xb2 (0x7f86154a3e2c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #9: torch::jit::InterpreterState::runOneStage(std::vector<at::Tensor, std::allocator<at::Tensor> >&) + 0x2b (0x7f861549b1d1 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #10: torch::jit::GraphExecutorImpl::runFallback(torch::jit::variable_tensor_list) + 0x69 (0x7f86154ef411 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #11: torch::jit::GraphExecutorImpl::run(torch::jit::variable_tensor_list) + 0x219 (0x7f86154eef05 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #12: torch::jit::GraphExecutor::run(torch::jit::variable_tensor_list&&) + 0x55 (0x7f86154eaa51 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #13: torch::jit::script::Method::run(torch::jit::variable_tensor_list&&) + 0xd0 (0x7f8615860dc8 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #14: <unknown function> + 0x1127035 (0x7f861585b035 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #15: <unknown function> + 0x112c873 (0x7f8615860873 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #16: <unknown function> + 0x112c0c3 (0x7f86158600c3 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #17: <unknown function> + 0x112b79a (0x7f861585f79a in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #18: <unknown function> + 0x112b82b (0x7f861585f82b in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #19: <unknown function> + 0xc7fcf4 (0x7f86153b3cf4 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\nframe #20: PyCFunction_Call + 0x131 (0x7f8629dbedd1 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #21: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #22: <unknown function> + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #23: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #24: <unknown function> + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #25: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #26: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #27: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #28: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #29: <unknown function> + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #30: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #31: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #32: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #33: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #34: <unknown function> + 0x9ab72 (0x7f8629d9cb72 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #35: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #36: <unknown function> + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #37: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #38: <unknown function> + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #39: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #40: PyEval_EvalFrameEx + 0x778c (0x7f8629e4579c in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #41: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #42: PyEval_EvalFrameEx + 0x812d (0x7f8629e4613d in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #43: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #44: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #45: <unknown function> + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #46: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #47: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #48: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #49: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #50: <unknown function> + 0x9ab72 (0x7f8629d9cb72 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #51: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #52: <unknown function> + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #53: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #54: <unknown function> + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #55: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #56: PyEval_EvalFrameEx + 0x778c (0x7f8629e4579c in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #57: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #58: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #59: <unknown function> + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #60: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #61: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #62: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\nframe #63: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\n:\noperation failed in interpreter:\n@torch.jit.script_method\ndef forward(self):\n    sum = 0\n    for i in self.b:\n        sum += i\n        ~~~~~~~~ <--- HERE\n    return sum\n\nThis seems fishy because everything is a python (long) constant here and the test passes if I turn all the constants in floats.\nCC @apaszke @zdevito.", "body": "After removing some zero-dim handling in ATen (https://github.com/pytorch/pytorch/pull/6683), I get a test failure in `python test/test_jit.py TestScript.test_script_module_for`.   The error given is:\r\n\r\n```\r\n======================================================================\r\nERROR: test_script_module_for (__main__.TestScript)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"test/test_jit.py\", line 2158, in test_script_module_for\r\n    self.assertEqual(m(), 10)\r\n  File \"/data/users/gchanan/pytorch9j/torch/nn/modules/module.py\", line 460, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/data/users/gchanan/pytorch9j/torch/jit/__init__.py\", line 761, in forward\r\n    return self.__getattr__('forward')(*args, **kwargs)\r\nRuntimeError:\r\nExpected object of type CPULongType but found type CPUIntType for argument #3 'other' (checked_cast_tensor at ../src/ATen/Utils.h:30)\r\nframe #0: at::CPULongTensor* at::checked_cast_tensor<at::CPULongTensor, at::TensorImpl>(at::TensorImpl*, char const*, int, bool) + 0x110 (0x7f8613781106 in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\r\nframe #1: at::CPULongType::s_add(at::Tensor const&, at::Tensor const&, at::Scalar) const + 0x152 (0x7f861382d240 in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\r\nframe #2: torch::autograd::VariableType::s_add(at::Tensor const&, at::Tensor const&, at::Scalar) const + 0x2e9 (0x7f86159403cb in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #3: at::Type::add(at::Tensor const&, at::Tensor const&, at::Scalar) const + 0xda (0x7f861387099c in /data/users/gchanan/pytorch9j/torch/lib/libATen.so)\r\nframe #4: <unknown function> + 0xed673c (0x7f861560a73c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #5: <unknown function> + 0xefa28c (0x7f861562e28c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #6: <unknown function> + 0xff8e63 (0x7f861572ce63 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #7: std::function<int (std::vector<at::Tensor, std::allocator<at::Tensor> >&)>::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&) const + 0x49 (0x7f86154a7c1f in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #8: torch::jit::InterpreterStateImpl::runOneStage(std::vector<at::Tensor, std::allocator<at::Tensor> >&) + 0xb2 (0x7f86154a3e2c in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #9: torch::jit::InterpreterState::runOneStage(std::vector<at::Tensor, std::allocator<at::Tensor> >&) + 0x2b (0x7f861549b1d1 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #10: torch::jit::GraphExecutorImpl::runFallback(torch::jit::variable_tensor_list) + 0x69 (0x7f86154ef411 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #11: torch::jit::GraphExecutorImpl::run(torch::jit::variable_tensor_list) + 0x219 (0x7f86154eef05 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #12: torch::jit::GraphExecutor::run(torch::jit::variable_tensor_list&&) + 0x55 (0x7f86154eaa51 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #13: torch::jit::script::Method::run(torch::jit::variable_tensor_list&&) + 0xd0 (0x7f8615860dc8 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #14: <unknown function> + 0x1127035 (0x7f861585b035 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #15: <unknown function> + 0x112c873 (0x7f8615860873 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #16: <unknown function> + 0x112c0c3 (0x7f86158600c3 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #17: <unknown function> + 0x112b79a (0x7f861585f79a in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #18: <unknown function> + 0x112b82b (0x7f861585f82b in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #19: <unknown function> + 0xc7fcf4 (0x7f86153b3cf4 in /data/users/gchanan/pytorch9j/torch/_C.cpython-35m-x86_64-linux-gnu.so)\r\nframe #20: PyCFunction_Call + 0x131 (0x7f8629dbedd1 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #21: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #22: <unknown function> + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #23: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #24: <unknown function> + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #25: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #26: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #27: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #28: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #29: <unknown function> + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #30: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #31: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #32: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #33: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #34: <unknown function> + 0x9ab72 (0x7f8629d9cb72 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #35: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #36: <unknown function> + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #37: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #38: <unknown function> + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #39: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #40: PyEval_EvalFrameEx + 0x778c (0x7f8629e4579c in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #41: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #42: PyEval_EvalFrameEx + 0x812d (0x7f8629e4613d in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #43: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #44: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #45: <unknown function> + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #46: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #47: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #48: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #49: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #50: <unknown function> + 0x9ab72 (0x7f8629d9cb72 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #51: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #52: <unknown function> + 0x83bdc (0x7f8629d85bdc in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #53: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #54: <unknown function> + 0xdb25f (0x7f8629ddd25f in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #55: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #56: PyEval_EvalFrameEx + 0x778c (0x7f8629e4579c in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #57: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #58: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #59: <unknown function> + 0x9ac91 (0x7f8629d9cc91 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #60: PyObject_Call + 0x56 (0x7f8629d694c6 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #61: PyEval_EvalFrameEx + 0x6276 (0x7f8629e44286 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #62: <unknown function> + 0x145fc9 (0x7f8629e47fc9 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\nframe #63: PyEval_EvalCodeEx + 0x48 (0x7f8629e48158 in /data/users/gchanan/anaconda3/envs/py35b/bin/../lib/libpython3.5m.so.1.0)\r\n:\r\noperation failed in interpreter:\r\n@torch.jit.script_method\r\ndef forward(self):\r\n    sum = 0\r\n    for i in self.b:\r\n        sum += i\r\n        ~~~~~~~~ <--- HERE\r\n    return sum\r\n```\r\n\r\nThis seems fishy because everything is a python (long) constant here and the test passes if I turn all the constants in floats.\r\n\r\nCC @apaszke @zdevito.\r\n"}