{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11195", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11195/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11195/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11195/events", "html_url": "https://github.com/pytorch/pytorch/issues/11195", "id": 356372412, "node_id": "MDU6SXNzdWUzNTYzNzI0MTI=", "number": 11195, "title": "[Caffe2] CUDA compile error from WeightedSumOp", "user": {"login": "xkszltl", "id": 5203025, "node_id": "MDQ6VXNlcjUyMDMwMjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5203025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xkszltl", "html_url": "https://github.com/xkszltl", "followers_url": "https://api.github.com/users/xkszltl/followers", "following_url": "https://api.github.com/users/xkszltl/following{/other_user}", "gists_url": "https://api.github.com/users/xkszltl/gists{/gist_id}", "starred_url": "https://api.github.com/users/xkszltl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xkszltl/subscriptions", "organizations_url": "https://api.github.com/users/xkszltl/orgs", "repos_url": "https://api.github.com/users/xkszltl/repos", "events_url": "https://api.github.com/users/xkszltl/events{/privacy}", "received_events_url": "https://api.github.com/users/xkszltl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-03T06:24:48Z", "updated_at": "2018-09-12T04:11:02Z", "closed_at": "2018-09-12T04:11:02Z", "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue description</h2>\n<p>This is a new issue popped out recently.<br>\nI ran into compile error in CUDA code.</p>\n<p>Here's the log:</p>\n<pre><code>FAILED: caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_loss_op.cu.o \ncd &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators &amp;&amp; /usr/local/bin/cmake -E make_directory &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. &amp;&amp; /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=&lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o -D generated_cubin_file:STRING=&lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o.cubin.txt -P &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_loss_op.cu.o.Release.cmake\n&lt;...&gt;/caffe2/operators/utility_ops.h: In member function \u2018bool caffe2::WeightedSumOp&lt;Context&gt;::DoRunWithType()\u2019:\n&lt;...&gt;/caffe2/operators/utility_ops.h:328:55: error: cannot call member function \u2018int caffe2::OperatorBase::InputSize() const\u2019 without object\n     const int input_size = InputSize();\n                        ~~~~~~~~~~~~~~~~               ^ \nCMake Error at caffe2_gpu_generated_loss_op.cu.o.Release.cmake:279 (message):\n  Error generating file\n  &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o\n\n\n[7/354] cd &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators &amp;&amp; /usr/local/bin/cmake -E make_directory &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. &amp;&amp; /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=&lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o -D generated_cubin_file:STRING=&lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o.cubin.txt -P &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o.Release.cmake\nFAILED: caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o \ncd &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators &amp;&amp; /usr/local/bin/cmake -E make_directory &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. &amp;&amp; /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=&lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o -D generated_cubin_file:STRING=&lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o.cubin.txt -P &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o.Release.cmake\n&lt;...&gt;/caffe2/operators/utility_ops.h: In member function \u2018bool caffe2::WeightedSumOp&lt;Context&gt;::DoRunWithType()\u2019:\n&lt;...&gt;/caffe2/operators/utility_ops.h:328:55: error: cannot call member function \u2018int caffe2::OperatorBase::InputSize() const\u2019 without object\n     const int input_size = InputSize();\n                        ~~~~~~~~~~~~~~~~               ^ \nCMake Error at caffe2_gpu_generated_utility_ops.cu.o.Release.cmake:279 (message):\n  Error generating file\n  &lt;...&gt;/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o\n\n\nninja: build stopped: subcommand failed.\n</code></pre>\n<p>Probably triggered from: <div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/24eb5ad0c5388bd98f3f0ee3296ab4ad2c13bdd4/caffe2/operators/loss_op.h#L8\">pytorch/caffe2/operators/loss_op.h</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 8\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/24eb5ad0c5388bd98f3f0ee3296ab4ad2c13bdd4\">24eb5ad</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L8\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"8\"></td>\n          <td id=\"LC8\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> #<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>caffe2/operators/utility_ops.h<span class=\"pl-pds\">\"</span></span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/24eb5ad0c5388bd98f3f0ee3296ab4ad2c13bdd4/caffe2/operators/utility_ops.h#L328\">pytorch/caffe2/operators/utility_ops.h</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 328\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/24eb5ad0c5388bd98f3f0ee3296ab4ad2c13bdd4\">24eb5ad</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L328\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"328\"></td>\n          <td id=\"LC328\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">const</span> <span class=\"pl-k\">int</span> input_size = <span class=\"pl-c1\">InputSize</span>(); </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p>This PR might be the cause: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"355378499\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/11049\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/11049/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/11049\">#11049</a></p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: Caffe2</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): cmake+ninja</li>\n<li>OS: CentOS 7</li>\n<li>PyTorch version: master</li>\n<li>CUDA/cuDNN version: 9.2/7.1.4</li>\n<li>GPU models and configuration: Volta (compile for all arch)</li>\n<li>GCC version (if compiling from source): 7.3.1</li>\n<li>CMake version: 3.12.1</li>\n</ul>", "body_text": "Issue description\nThis is a new issue popped out recently.\nI ran into compile error in CUDA code.\nHere's the log:\nFAILED: caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_loss_op.cu.o \ncd <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators && /usr/local/bin/cmake -E make_directory <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. && /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o -D generated_cubin_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o.cubin.txt -P <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_loss_op.cu.o.Release.cmake\n<...>/caffe2/operators/utility_ops.h: In member function \u2018bool caffe2::WeightedSumOp<Context>::DoRunWithType()\u2019:\n<...>/caffe2/operators/utility_ops.h:328:55: error: cannot call member function \u2018int caffe2::OperatorBase::InputSize() const\u2019 without object\n     const int input_size = InputSize();\n                        ~~~~~~~~~~~~~~~~               ^ \nCMake Error at caffe2_gpu_generated_loss_op.cu.o.Release.cmake:279 (message):\n  Error generating file\n  <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o\n\n\n[7/354] cd <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators && /usr/local/bin/cmake -E make_directory <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. && /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o -D generated_cubin_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o.cubin.txt -P <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o.Release.cmake\nFAILED: caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o \ncd <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators && /usr/local/bin/cmake -E make_directory <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. && /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o -D generated_cubin_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o.cubin.txt -P <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o.Release.cmake\n<...>/caffe2/operators/utility_ops.h: In member function \u2018bool caffe2::WeightedSumOp<Context>::DoRunWithType()\u2019:\n<...>/caffe2/operators/utility_ops.h:328:55: error: cannot call member function \u2018int caffe2::OperatorBase::InputSize() const\u2019 without object\n     const int input_size = InputSize();\n                        ~~~~~~~~~~~~~~~~               ^ \nCMake Error at caffe2_gpu_generated_utility_ops.cu.o.Release.cmake:279 (message):\n  Error generating file\n  <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o\n\n\nninja: build stopped: subcommand failed.\n\nProbably triggered from: \n  \n    \n      pytorch/caffe2/operators/loss_op.h\n    \n    \n         Line 8\n      in\n      24eb5ad\n    \n    \n    \n    \n\n        \n          \n           #include \"caffe2/operators/utility_ops.h\" \n        \n    \n  \n\n\n\n  \n    \n      pytorch/caffe2/operators/utility_ops.h\n    \n    \n         Line 328\n      in\n      24eb5ad\n    \n    \n    \n    \n\n        \n          \n           const int input_size = InputSize(); \n        \n    \n  \n\n\nThis PR might be the cause: #11049\nSystem Info\n\nPyTorch or Caffe2: Caffe2\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): cmake+ninja\nOS: CentOS 7\nPyTorch version: master\nCUDA/cuDNN version: 9.2/7.1.4\nGPU models and configuration: Volta (compile for all arch)\nGCC version (if compiling from source): 7.3.1\nCMake version: 3.12.1", "body": "## Issue description\r\n\r\nThis is a new issue popped out recently.\r\nI ran into compile error in CUDA code.\r\n\r\nHere's the log:\r\n```\r\nFAILED: caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_loss_op.cu.o \r\ncd <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators && /usr/local/bin/cmake -E make_directory <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. && /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o -D generated_cubin_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o.cubin.txt -P <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_loss_op.cu.o.Release.cmake\r\n<...>/caffe2/operators/utility_ops.h: In member function \u2018bool caffe2::WeightedSumOp<Context>::DoRunWithType()\u2019:\r\n<...>/caffe2/operators/utility_ops.h:328:55: error: cannot call member function \u2018int caffe2::OperatorBase::InputSize() const\u2019 without object\r\n     const int input_size = InputSize();\r\n                        ~~~~~~~~~~~~~~~~               ^ \r\nCMake Error at caffe2_gpu_generated_loss_op.cu.o.Release.cmake:279 (message):\r\n  Error generating file\r\n  <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_loss_op.cu.o\r\n\r\n\r\n[7/354] cd <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators && /usr/local/bin/cmake -E make_directory <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. && /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o -D generated_cubin_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o.cubin.txt -P <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o.Release.cmake\r\nFAILED: caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o \r\ncd <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators && /usr/local/bin/cmake -E make_directory <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/. && /usr/local/bin/cmake -D verbose:BOOL=OFF -D build_configuration:STRING=Release -D generated_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o -D generated_cubin_file:STRING=<...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o.cubin.txt -P <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_utility_ops.cu.o.Release.cmake\r\n<...>/caffe2/operators/utility_ops.h: In member function \u2018bool caffe2::WeightedSumOp<Context>::DoRunWithType()\u2019:\r\n<...>/caffe2/operators/utility_ops.h:328:55: error: cannot call member function \u2018int caffe2::OperatorBase::InputSize() const\u2019 without object\r\n     const int input_size = InputSize();\r\n                        ~~~~~~~~~~~~~~~~               ^ \r\nCMake Error at caffe2_gpu_generated_utility_ops.cu.o.Release.cmake:279 (message):\r\n  Error generating file\r\n  <...>/build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_utility_ops.cu.o\r\n\r\n\r\nninja: build stopped: subcommand failed.\r\n```\r\n\r\nProbably triggered from: https://github.com/pytorch/pytorch/blob/24eb5ad0c5388bd98f3f0ee3296ab4ad2c13bdd4/caffe2/operators/loss_op.h#L8\r\nhttps://github.com/pytorch/pytorch/blob/24eb5ad0c5388bd98f3f0ee3296ab4ad2c13bdd4/caffe2/operators/utility_ops.h#L328\r\n\r\nThis PR might be the cause: #11049 \r\n\r\n## System Info\r\n\r\n- PyTorch or Caffe2: Caffe2\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): cmake+ninja\r\n- OS: CentOS 7\r\n- PyTorch version: master\r\n- CUDA/cuDNN version: 9.2/7.1.4\r\n- GPU models and configuration: Volta (compile for all arch)\r\n- GCC version (if compiling from source): 7.3.1\r\n- CMake version: 3.12.1"}