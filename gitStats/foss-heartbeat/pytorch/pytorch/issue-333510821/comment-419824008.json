{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/419824008", "html_url": "https://github.com/pytorch/pytorch/issues/8637#issuecomment-419824008", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8637", "id": 419824008, "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTgyNDAwOA==", "user": {"login": "maozhiqiang", "id": 23501322, "node_id": "MDQ6VXNlcjIzNTAxMzIy", "avatar_url": "https://avatars2.githubusercontent.com/u/23501322?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maozhiqiang", "html_url": "https://github.com/maozhiqiang", "followers_url": "https://api.github.com/users/maozhiqiang/followers", "following_url": "https://api.github.com/users/maozhiqiang/following{/other_user}", "gists_url": "https://api.github.com/users/maozhiqiang/gists{/gist_id}", "starred_url": "https://api.github.com/users/maozhiqiang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maozhiqiang/subscriptions", "organizations_url": "https://api.github.com/users/maozhiqiang/orgs", "repos_url": "https://api.github.com/users/maozhiqiang/repos", "events_url": "https://api.github.com/users/maozhiqiang/events{/privacy}", "received_events_url": "https://api.github.com/users/maozhiqiang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-10T08:04:43Z", "updated_at": "2018-09-10T08:04:43Z", "author_association": "NONE", "body_html": "<p>i use DataParallel to computer <a href=\"https://github.com/JohnVinyard/experiments/blob/master/audio-loss/audio_loss.py\">https://github.com/JohnVinyard/experiments/blob/master/audio-loss/audio_loss.py</a><br>\nIt is worked use single gpu! but multiply gpu have problem!<br>\nmy code like<br>\nsamplerate = SR22050()<br>\nscale = BarkScale(FrequencyBand(50, samplerate.nyquist - 300), n_bands=512)<br>\nperceptual_loss = PerceptualLoss(<br>\nscale,<br>\nsamplerate,<br>\nlap=1,<br>\nlog_factor=10,<br>\nbasis_size=512,<br>\nfrequency_weighting=AWeighting(),<br>\ncosine_similarity=True).to(device)</p>\n<pre><code># perceptual_loss(input=, target=)\nfrom audio import load_wav\n# print(1 + perceptual_loss(input=torch.Tensor([a[:41885]]).cuda(), target=torch.Tensor([b[:41885]]).cuda()))\nloss = 1 + torch.nn.parallel.data_parallel(perceptual_loss, (torch.Tensor([a[:134301]]).cuda()\n</code></pre>\n<p>the error like this:<br>\nRuntimeError: Expected tensor for argument <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171281708\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1\">#1</a> 'input' to have the same device as tensor for argument <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"171402941\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/2\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/2/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/2\">#2</a> 'weight'; but device 1 does not equal 0 (while checking arguments for cudnn_convolution)<br>\nhow to solve this!</p>", "body_text": "i use DataParallel to computer https://github.com/JohnVinyard/experiments/blob/master/audio-loss/audio_loss.py\nIt is worked use single gpu! but multiply gpu have problem!\nmy code like\nsamplerate = SR22050()\nscale = BarkScale(FrequencyBand(50, samplerate.nyquist - 300), n_bands=512)\nperceptual_loss = PerceptualLoss(\nscale,\nsamplerate,\nlap=1,\nlog_factor=10,\nbasis_size=512,\nfrequency_weighting=AWeighting(),\ncosine_similarity=True).to(device)\n# perceptual_loss(input=, target=)\nfrom audio import load_wav\n# print(1 + perceptual_loss(input=torch.Tensor([a[:41885]]).cuda(), target=torch.Tensor([b[:41885]]).cuda()))\nloss = 1 + torch.nn.parallel.data_parallel(perceptual_loss, (torch.Tensor([a[:134301]]).cuda()\n\nthe error like this:\nRuntimeError: Expected tensor for argument #1 'input' to have the same device as tensor for argument #2 'weight'; but device 1 does not equal 0 (while checking arguments for cudnn_convolution)\nhow to solve this!", "body": "i use DataParallel to computer https://github.com/JohnVinyard/experiments/blob/master/audio-loss/audio_loss.py\r\nIt is worked use single gpu! but multiply gpu have problem! \r\nmy code like\r\n        samplerate = SR22050()\r\n    scale = BarkScale(FrequencyBand(50, samplerate.nyquist - 300), n_bands=512)\r\n    perceptual_loss = PerceptualLoss(\r\n        scale,\r\n        samplerate,\r\n        lap=1,\r\n        log_factor=10,\r\n        basis_size=512,\r\n        frequency_weighting=AWeighting(),\r\n        cosine_similarity=True).to(device)\r\n\r\n    # perceptual_loss(input=, target=)\r\n    from audio import load_wav\r\n    # print(1 + perceptual_loss(input=torch.Tensor([a[:41885]]).cuda(), target=torch.Tensor([b[:41885]]).cuda()))\r\n    loss = 1 + torch.nn.parallel.data_parallel(perceptual_loss, (torch.Tensor([a[:134301]]).cuda()\r\n\r\n\r\nthe error like this:\r\n RuntimeError: Expected tensor for argument #1 'input' to have the same device as tensor for argument #2 'weight'; but device 1 does not equal 0 (while checking arguments for cudnn_convolution)\r\nhow to solve this!\r\n"}