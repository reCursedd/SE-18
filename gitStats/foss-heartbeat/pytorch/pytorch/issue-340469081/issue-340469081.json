{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9372", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9372/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9372/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9372/events", "html_url": "https://github.com/pytorch/pytorch/pull/9372", "id": 340469081, "node_id": "MDExOlB1bGxSZXF1ZXN0MjAwODczNjYz", "number": 9372, "title": "[C++ API] Fix Sequential::clone()", "user": {"login": "goldsborough", "id": 6429851, "node_id": "MDQ6VXNlcjY0Mjk4NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6429851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldsborough", "html_url": "https://github.com/goldsborough", "followers_url": "https://api.github.com/users/goldsborough/followers", "following_url": "https://api.github.com/users/goldsborough/following{/other_user}", "gists_url": "https://api.github.com/users/goldsborough/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldsborough/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldsborough/subscriptions", "organizations_url": "https://api.github.com/users/goldsborough/orgs", "repos_url": "https://api.github.com/users/goldsborough/repos", "events_url": "https://api.github.com/users/goldsborough/events{/privacy}", "received_events_url": "https://api.github.com/users/goldsborough/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-12T02:38:48Z", "updated_at": "2018-11-23T15:47:32Z", "closed_at": "2018-07-17T04:54:43Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/9372", "html_url": "https://github.com/pytorch/pytorch/pull/9372", "diff_url": "https://github.com/pytorch/pytorch/pull/9372.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/9372.patch"}, "body_html": "<p>I noticed that <code>Sequential::clone()</code> does not work. This is because <code>Sequential</code> does not use <code>reset()</code> which is normally where modules have to initialize and register its submodules. Further, this is because of the way <code>Sequential</code> allows its modules to be passed in the constructor, which doesn't work with <code>reset()</code> (since it does \"late\" initialization).</p>\n<p>I've added some better error messages inside <code>Cloneable::clone()</code> which makes this kind of mistake clearer for other users, and tests for <code>Sequential::clone()</code>.</p>\n<p>I also had to give <code>AnyModule</code> a deep <code>clone()</code> method.</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3605224\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ebetica\">@ebetica</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=13564\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ezyang\">@ezyang</a></p>", "body_text": "I noticed that Sequential::clone() does not work. This is because Sequential does not use reset() which is normally where modules have to initialize and register its submodules. Further, this is because of the way Sequential allows its modules to be passed in the constructor, which doesn't work with reset() (since it does \"late\" initialization).\nI've added some better error messages inside Cloneable::clone() which makes this kind of mistake clearer for other users, and tests for Sequential::clone().\nI also had to give AnyModule a deep clone() method.\n@ebetica @ezyang", "body": "I noticed that `Sequential::clone()` does not work. This is because `Sequential` does not use `reset()` which is normally where modules have to initialize and register its submodules. Further, this is because of the way `Sequential` allows its modules to be passed in the constructor, which doesn't work with `reset()` (since it does \"late\" initialization).\r\n\r\nI've added some better error messages inside `Cloneable::clone()` which makes this kind of mistake clearer for other users, and tests for `Sequential::clone()`.\r\n\r\nI also had to give `AnyModule` a deep `clone()` method.\r\n\r\n@ebetica @ezyang "}