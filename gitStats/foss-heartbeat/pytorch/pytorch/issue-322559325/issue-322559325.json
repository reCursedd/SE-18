{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7528", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7528/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7528/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7528/events", "html_url": "https://github.com/pytorch/pytorch/issues/7528", "id": 322559325, "node_id": "MDU6SXNzdWUzMjI1NTkzMjU=", "number": 7528, "title": "[caffe2] C2 ONNX build is flaky due to lack of ordering dep", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}, {"id": 693805995, "node_id": "MDU6TGFiZWw2OTM4MDU5OTU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/onnx", "name": "onnx", "color": "e99695", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-13T02:54:24Z", "updated_at": "2018-05-13T03:54:33Z", "closed_at": "2018-05-13T03:54:33Z", "author_association": "CONTRIBUTOR", "body_html": "<p>When it fails it looks like this:</p>\n<pre><code>02:41:21 [ 53%] Running C++ protocol buffer compiler on /var/lib/jenkins/workspace/build/third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto\n02:41:21 onnx_ONNX_NAMESPACE_FOR_C2_CI.proto: File not found.\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto: Import \"onnx_ONNX_NAMESPACE_FOR_C2_CI.proto\" was not found or had errors.\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto:64:12: \"NodeProto\" is not defined.\n02:41:21 third_party/onnx/CMakeFiles/onnx_proto.dir/build.make:68: recipe for target 'third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.pb.cc' failed\n</code></pre>\n<p>This indicates we're trying to run the proto compiler before the proto file is created. This probably means there should be some dep declared which we didn't. It's intermittent because sometimes we're lucky and the build gets ordered the right way.</p>\n<p>Maybe this should get reported to onnx repo.</p>\n<p>CC <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=30275821\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/houseroad\">@houseroad</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9300575\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/bddppq\">@bddppq</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1388690\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/anderspapitto\">@anderspapitto</a></p>\n<p>Cases of this failing:</p>\n<ul>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"321935421\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/7465\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/7465/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/7465\">#7465</a></li>\n<li><a href=\"https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-build/4286//console\" rel=\"nofollow\">https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-build/4286//console</a></li>\n</ul>", "body_text": "When it fails it looks like this:\n02:41:21 [ 53%] Running C++ protocol buffer compiler on /var/lib/jenkins/workspace/build/third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto\n02:41:21 onnx_ONNX_NAMESPACE_FOR_C2_CI.proto: File not found.\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto: Import \"onnx_ONNX_NAMESPACE_FOR_C2_CI.proto\" was not found or had errors.\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto:64:12: \"NodeProto\" is not defined.\n02:41:21 third_party/onnx/CMakeFiles/onnx_proto.dir/build.make:68: recipe for target 'third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.pb.cc' failed\n\nThis indicates we're trying to run the proto compiler before the proto file is created. This probably means there should be some dep declared which we didn't. It's intermittent because sometimes we're lucky and the build gets ordered the right way.\nMaybe this should get reported to onnx repo.\nCC @houseroad @bddppq @anderspapitto\nCases of this failing:\n\n#7465\nhttps://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-build/4286//console", "body": "When it fails it looks like this:\r\n\r\n```\r\n02:41:21 [ 53%] Running C++ protocol buffer compiler on /var/lib/jenkins/workspace/build/third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto\r\n02:41:21 onnx_ONNX_NAMESPACE_FOR_C2_CI.proto: File not found.\r\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto: Import \"onnx_ONNX_NAMESPACE_FOR_C2_CI.proto\" was not found or had errors.\r\n02:41:21 onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.proto:64:12: \"NodeProto\" is not defined.\r\n02:41:21 third_party/onnx/CMakeFiles/onnx_proto.dir/build.make:68: recipe for target 'third_party/onnx/onnx/onnx-operators_ONNX_NAMESPACE_FOR_C2_CI.pb.cc' failed\r\n```\r\n\r\nThis indicates we're trying to run the proto compiler before the proto file is created. This probably means there should be some dep declared which we didn't. It's intermittent because sometimes we're lucky and the build gets ordered the right way.\r\n\r\nMaybe this should get reported to onnx repo.\r\n\r\nCC @houseroad @bddppq @anderspapitto \r\n\r\nCases of this failing:\r\n- https://github.com/pytorch/pytorch/pull/7465\r\n- https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-build/4286//console"}