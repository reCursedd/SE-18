{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7729", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7729/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7729/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7729/events", "html_url": "https://github.com/pytorch/pytorch/issues/7729", "id": 324817672, "node_id": "MDU6SXNzdWUzMjQ4MTc2NzI=", "number": 7729, "title": "[Caffe2][Caffe] Caffe to Caffe2 ParseError", "user": {"login": "PauliusPoc", "id": 31746944, "node_id": "MDQ6VXNlcjMxNzQ2OTQ0", "avatar_url": "https://avatars3.githubusercontent.com/u/31746944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PauliusPoc", "html_url": "https://github.com/PauliusPoc", "followers_url": "https://api.github.com/users/PauliusPoc/followers", "following_url": "https://api.github.com/users/PauliusPoc/following{/other_user}", "gists_url": "https://api.github.com/users/PauliusPoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/PauliusPoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PauliusPoc/subscriptions", "organizations_url": "https://api.github.com/users/PauliusPoc/orgs", "repos_url": "https://api.github.com/users/PauliusPoc/repos", "events_url": "https://api.github.com/users/PauliusPoc/events{/privacy}", "received_events_url": "https://api.github.com/users/PauliusPoc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-05-21T07:37:29Z", "updated_at": "2018-05-21T13:57:17Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><code>google.protobuf.text_format.ParseError: 78:5 : Message type \"caffe.PoolingParameter\" has no field named \"torch_pooling\". </code></p>\n<p>So I am trying to convert from Caffe to Caffe 2 with custom pooling parameter using floor and ceil.</p>\n<p>implemented it like this in <code>pooling_layer.cpp</code></p>\n<pre><code>template &lt;typename Dtype&gt;\nvoid PoolingLayer&lt;Dtype&gt;::Reshape(const vector&lt;Blob&lt;Dtype&gt;*&gt;&amp; bottom,\n      const vector&lt;Blob&lt;Dtype&gt;*&gt;&amp; top) {\n//unrelated code\nswitch (this-&gt;layer_param_.pooling_param().torch_pooling()) {\n/// implementation\n    }\n}\n</code></pre>\n<p>Found out on <a href=\"https://github.com/caffe2/caffe2/blob/master/caffe2/python/caffe_translator.py\">caffe_translator.py</a> line 521, that facebook has basically the same thing.</p>\n<pre><code>        # In the Facebook port of Caffe, a torch_pooling field was added to\n        # map the pooling computation of Torch. Essentially, it uses\n        #   floor((height + 2 * padding - kernel) / stride) + 1\n        # instead of\n        #   ceil((height + 2 * padding - kernel) / stride) + 1\n        # which is Caffe's version.\n        # Torch pooling is actually the same as Caffe2 pooling, so we don't\n        # need to do anything.\n</code></pre>\n<p>I dont exactly understand how to register it so the parser will understand it.<br>\nI tried, in <code>caffe.proto</code>:</p>\n<pre><code>message LayerParameter {\n  optional PoolingParameter torch_pooling = 149;\n</code></pre>\n<p>Is there any documentation how facebook implemented its torch_pooling? I didn't find any information on the internet.</p>\n<p>If the question above is unansverable, can you help me to register that pooling parameter to be parsed succesfully?</p>", "body_text": "google.protobuf.text_format.ParseError: 78:5 : Message type \"caffe.PoolingParameter\" has no field named \"torch_pooling\". \nSo I am trying to convert from Caffe to Caffe 2 with custom pooling parameter using floor and ceil.\nimplemented it like this in pooling_layer.cpp\ntemplate <typename Dtype>\nvoid PoolingLayer<Dtype>::Reshape(const vector<Blob<Dtype>*>& bottom,\n      const vector<Blob<Dtype>*>& top) {\n//unrelated code\nswitch (this->layer_param_.pooling_param().torch_pooling()) {\n/// implementation\n    }\n}\n\nFound out on caffe_translator.py line 521, that facebook has basically the same thing.\n        # In the Facebook port of Caffe, a torch_pooling field was added to\n        # map the pooling computation of Torch. Essentially, it uses\n        #   floor((height + 2 * padding - kernel) / stride) + 1\n        # instead of\n        #   ceil((height + 2 * padding - kernel) / stride) + 1\n        # which is Caffe's version.\n        # Torch pooling is actually the same as Caffe2 pooling, so we don't\n        # need to do anything.\n\nI dont exactly understand how to register it so the parser will understand it.\nI tried, in caffe.proto:\nmessage LayerParameter {\n  optional PoolingParameter torch_pooling = 149;\n\nIs there any documentation how facebook implemented its torch_pooling? I didn't find any information on the internet.\nIf the question above is unansverable, can you help me to register that pooling parameter to be parsed succesfully?", "body": "`google.protobuf.text_format.ParseError: 78:5 : Message type \"caffe.PoolingParameter\" has no field named \"torch_pooling\".\r\n`\r\n\r\nSo I am trying to convert from Caffe to Caffe 2 with custom pooling parameter using floor and ceil.\r\n\r\nimplemented it like this in `pooling_layer.cpp`\r\n```\r\ntemplate <typename Dtype>\r\nvoid PoolingLayer<Dtype>::Reshape(const vector<Blob<Dtype>*>& bottom,\r\n      const vector<Blob<Dtype>*>& top) {\r\n//unrelated code\r\nswitch (this->layer_param_.pooling_param().torch_pooling()) {\r\n/// implementation\r\n    }\r\n}\r\n```\r\n\r\n\r\nFound out on [caffe_translator.py](https://github.com/caffe2/caffe2/blob/master/caffe2/python/caffe_translator.py) line 521, that facebook has basically the same thing.\r\n```\r\n        # In the Facebook port of Caffe, a torch_pooling field was added to\r\n        # map the pooling computation of Torch. Essentially, it uses\r\n        #   floor((height + 2 * padding - kernel) / stride) + 1\r\n        # instead of\r\n        #   ceil((height + 2 * padding - kernel) / stride) + 1\r\n        # which is Caffe's version.\r\n        # Torch pooling is actually the same as Caffe2 pooling, so we don't\r\n        # need to do anything.\r\n```\r\n\r\nI dont exactly understand how to register it so the parser will understand it.\r\nI tried, in `caffe.proto`:\r\n\r\n```\r\nmessage LayerParameter {\r\n  optional PoolingParameter torch_pooling = 149;\r\n```\r\n\r\nIs there any documentation how facebook implemented its torch_pooling? I didn't find any information on the internet.\r\n\r\nIf the question above is unansverable, can you help me to register that pooling parameter to be parsed succesfully?\r\n\r\n"}