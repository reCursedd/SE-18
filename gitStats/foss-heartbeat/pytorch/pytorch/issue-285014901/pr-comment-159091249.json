{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/159091249", "pull_request_review_id": 85995671, "id": 159091249, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE1OTA5MTI0OQ==", "diff_hunk": "@@ -1093,6 +1094,23 @@ def test_var_stability(self):\n         tensor = tensor.unsqueeze(1)\n         self.assertEqual(tensor.var(0)[0], 0.03125)\n \n+    def test_digamma(self):\n+        def test(use_double=False):\n+            cpu_tensor = torch.randn(10, 10, 10)\n+            gpu_tensor = cpu_tensor.cuda()\n+            zeros = torch.zeros(10, 10, 10)\n+            if (use_double):\n+                cpu_tensor = cpu_tensor.double()\n+                gpu_tensor = gpu_tensor.double()\n+                zeros = zeros.double()\n+            cpu_out = cpu_tensor.digamma()\n+            gpu_out = gpu_tensor.digamma()\n+            norm_errors = (gpu_out - cpu_out.cuda()) / gpu_out\n+            self.assertEqual(norm_errors, zeros)\n+\n+        test(True)\n+        test(False)", "path": "test/test_cuda.py", "position": 37, "original_position": 27, "commit_id": "92cec60d58a6a7c1567abad8d2720d070481c837", "original_commit_id": "6fbcb0513752353663d2f2327dfe4eeb5828eb29", "user": {"login": "fritzo", "id": 648532, "node_id": "MDQ6VXNlcjY0ODUzMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/648532?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fritzo", "html_url": "https://github.com/fritzo", "followers_url": "https://api.github.com/users/fritzo/followers", "following_url": "https://api.github.com/users/fritzo/following{/other_user}", "gists_url": "https://api.github.com/users/fritzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/fritzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fritzo/subscriptions", "organizations_url": "https://api.github.com/users/fritzo/orgs", "repos_url": "https://api.github.com/users/fritzo/repos", "events_url": "https://api.github.com/users/fritzo/events{/privacy}", "received_events_url": "https://api.github.com/users/fritzo/received_events", "type": "User", "site_admin": false}, "body": "Quoting Richard from the PR on which this is based #3955 :\r\n> The values of digamma on gpu when compared to cpu are the same to 6 digits. I tried making this a normal test and some output values were high (~100), resulting in an error of around 1e-3, which is above the error threshold\r\n\r\nIt's probably out of scope for this PR, but maybe you could change the generic tests to assert on relative error rather than absolute error?", "created_at": "2017-12-29T18:38:08Z", "updated_at": "2018-11-23T15:37:43Z", "html_url": "https://github.com/pytorch/pytorch/pull/4399#discussion_r159091249", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/4399", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/159091249"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/4399#discussion_r159091249"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/4399"}}, "body_html": "<p>Quoting Richard from the PR on which this is based <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"278251815\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3955\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/3955/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/3955\">#3955</a> :</p>\n<blockquote>\n<p>The values of digamma on gpu when compared to cpu are the same to 6 digits. I tried making this a normal test and some output values were high (~100), resulting in an error of around 1e-3, which is above the error threshold</p>\n</blockquote>\n<p>It's probably out of scope for this PR, but maybe you could change the generic tests to assert on relative error rather than absolute error?</p>", "body_text": "Quoting Richard from the PR on which this is based #3955 :\n\nThe values of digamma on gpu when compared to cpu are the same to 6 digits. I tried making this a normal test and some output values were high (~100), resulting in an error of around 1e-3, which is above the error threshold\n\nIt's probably out of scope for this PR, but maybe you could change the generic tests to assert on relative error rather than absolute error?", "in_reply_to_id": 159049336}