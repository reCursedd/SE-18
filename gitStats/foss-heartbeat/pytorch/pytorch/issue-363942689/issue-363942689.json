{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12082", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12082/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12082/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12082/events", "html_url": "https://github.com/pytorch/pytorch/issues/12082", "id": 363942689, "node_id": "MDU6SXNzdWUzNjM5NDI2ODk=", "number": 12082, "title": "[feature request] API to change loc and scale to cuda tensor in torch.distributions.Normal", "user": {"login": "qbx2", "id": 5977817, "node_id": "MDQ6VXNlcjU5Nzc4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5977817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qbx2", "html_url": "https://github.com/qbx2", "followers_url": "https://api.github.com/users/qbx2/followers", "following_url": "https://api.github.com/users/qbx2/following{/other_user}", "gists_url": "https://api.github.com/users/qbx2/gists{/gist_id}", "starred_url": "https://api.github.com/users/qbx2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qbx2/subscriptions", "organizations_url": "https://api.github.com/users/qbx2/orgs", "repos_url": "https://api.github.com/users/qbx2/repos", "events_url": "https://api.github.com/users/qbx2/events{/privacy}", "received_events_url": "https://api.github.com/users/qbx2/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-26T09:46:22Z", "updated_at": "2018-09-26T12:40:41Z", "closed_at": "2018-09-26T12:40:41Z", "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue description</h2>\n<p>When I use some functions in Distribution with CUDA tensors, it will fail.</p>\n<pre><code>m = torch.distributions.Normal(0, 1)\n&gt;&gt;&gt; m.cdf(torch.tensor(.5, device='cuda'))\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/home/qbx2/anaconda3/lib/python3.6/site-packages/torch/distributions/normal.py\", line 72, in cdf\n    return 0.5 * (1 + torch.erf((value - self.loc) * self.scale.reciprocal() / math.sqrt(2)))\nRuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.FloatTensor for argument #3 'other'\n</code></pre>\n<p>I think it is helpful if there is to() or cuda() to move internal variables to wanted device.</p>\n<p>I temporarily solved the problem by</p>\n<pre><code>&gt;&gt;&gt; m.loc = m.loc.to('cuda')\n&gt;&gt;&gt; m.scale = m.scale.to('cuda')\n&gt;&gt;&gt; m.cdf(torch.tensor(.5, device='cuda'))\ntensor(0.6915, device='cuda:0')\n</code></pre>\n<p>It would be easy to add the function, how do you think?</p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: pytorch</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source):</li>\n<li>OS: Ubuntu 18.04 LTS</li>\n<li>PyTorch version: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/a24163a95edb193ff7b06e98cd69bf7cfd4c0d2f/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/a24163a95edb193ff7b06e98cd69bf7cfd4c0d2f\"><tt>a24163a</tt></a> (I've checked the source in master though)</li>\n<li>Python version: 3.6.5+</li>\n<li>CUDA/cuDNN version:</li>\n<li>GPU models and configuration:</li>\n<li>GCC version (if compiling from source):</li>\n<li>CMake version:</li>\n<li>Versions of any other relevant libraries:</li>\n</ul>", "body_text": "Issue description\nWhen I use some functions in Distribution with CUDA tensors, it will fail.\nm = torch.distributions.Normal(0, 1)\n>>> m.cdf(torch.tensor(.5, device='cuda'))\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/home/qbx2/anaconda3/lib/python3.6/site-packages/torch/distributions/normal.py\", line 72, in cdf\n    return 0.5 * (1 + torch.erf((value - self.loc) * self.scale.reciprocal() / math.sqrt(2)))\nRuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.FloatTensor for argument #3 'other'\n\nI think it is helpful if there is to() or cuda() to move internal variables to wanted device.\nI temporarily solved the problem by\n>>> m.loc = m.loc.to('cuda')\n>>> m.scale = m.scale.to('cuda')\n>>> m.cdf(torch.tensor(.5, device='cuda'))\ntensor(0.6915, device='cuda:0')\n\nIt would be easy to add the function, how do you think?\nSystem Info\n\nPyTorch or Caffe2: pytorch\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source):\nOS: Ubuntu 18.04 LTS\nPyTorch version: a24163a (I've checked the source in master though)\nPython version: 3.6.5+\nCUDA/cuDNN version:\nGPU models and configuration:\nGCC version (if compiling from source):\nCMake version:\nVersions of any other relevant libraries:", "body": "## Issue description\r\nWhen I use some functions in Distribution with CUDA tensors, it will fail.\r\n```\r\nm = torch.distributions.Normal(0, 1)\r\n>>> m.cdf(torch.tensor(.5, device='cuda'))\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/qbx2/anaconda3/lib/python3.6/site-packages/torch/distributions/normal.py\", line 72, in cdf\r\n    return 0.5 * (1 + torch.erf((value - self.loc) * self.scale.reciprocal() / math.sqrt(2)))\r\nRuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.FloatTensor for argument #3 'other'\r\n```\r\n\r\nI think it is helpful if there is to() or cuda() to move internal variables to wanted device.\r\n\r\nI temporarily solved the problem by\r\n```\r\n>>> m.loc = m.loc.to('cuda')\r\n>>> m.scale = m.scale.to('cuda')\r\n>>> m.cdf(torch.tensor(.5, device='cuda'))\r\ntensor(0.6915, device='cuda:0')\r\n```\r\nIt would be easy to add the function, how do you think?\r\n\r\n## System Info\r\n- PyTorch or Caffe2: pytorch\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source):\r\n- OS: Ubuntu 18.04 LTS\r\n- PyTorch version: a24163a95edb193ff7b06e98cd69bf7cfd4c0d2f (I've checked the source in master though)\r\n- Python version: 3.6.5+\r\n- CUDA/cuDNN version:\r\n- GPU models and configuration:\r\n- GCC version (if compiling from source):\r\n- CMake version:\r\n- Versions of any other relevant libraries:\r\n"}