{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2527", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2527/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2527/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2527/events", "html_url": "https://github.com/pytorch/pytorch/issues/2527", "id": 252594798, "node_id": "MDU6SXNzdWUyNTI1OTQ3OTg=", "number": 2527, "title": "Pytorch giving a cuda runtime error (30)", "user": {"login": "Dawny33", "id": 4637008, "node_id": "MDQ6VXNlcjQ2MzcwMDg=", "avatar_url": "https://avatars3.githubusercontent.com/u/4637008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dawny33", "html_url": "https://github.com/Dawny33", "followers_url": "https://api.github.com/users/Dawny33/followers", "following_url": "https://api.github.com/users/Dawny33/following{/other_user}", "gists_url": "https://api.github.com/users/Dawny33/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dawny33/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dawny33/subscriptions", "organizations_url": "https://api.github.com/users/Dawny33/orgs", "repos_url": "https://api.github.com/users/Dawny33/repos", "events_url": "https://api.github.com/users/Dawny33/events{/privacy}", "received_events_url": "https://api.github.com/users/Dawny33/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-08-24T13:04:28Z", "updated_at": "2017-08-24T13:49:26Z", "closed_at": "2017-08-24T13:49:26Z", "author_association": "NONE", "body_html": "<p>I have made small changes in the <code>imagenet</code> example code. Changed <a href=\"https://github.com/pytorch/examples/blob/86bc3e516dde92fee0ce00668a3714c03155dd44/imagenet/main.py#L80-L88\">these lines</a> to:</p>\n<pre><code>\n   if not args.distributed:\n        if args.arch.startswith('alexnet') or args.arch.startswith('vgg'):\n            #model.features = torch.nn.DataParallel(model.features)\n            model.cuda()\n        #else:\n            #model = torch.nn.DataParallel(model).cuda()\n    else:\n        model.cuda()\n        #model = torch.nn.parallel.DistributedDataParallel(model)\n\n    # define loss function (criterion) and optimizer\n    criterion = nn.CrossEntropyLoss().cuda()\n</code></pre>\n<p>And, when I run the script, it throws a cuda runtime error which is as follows:</p>\n<pre><code>\nubuntu@ip-x-y-z-a:~$ time CUDA_VISIBLE_DEVICES=0 python imagenet2.py --world-size 1 --arch 'alexnet' ImageNet2\n=&gt; creating model 'alexnet'\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/THCGeneral.c line=70 error=30 : unknown error\nTraceback (most recent call last):\n  File \"imagenet2.py\", line 319, in &lt;module&gt;\n    main()\n  File \"imagenet2.py\", line 87, in main\n    model.cuda()\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 147, in cuda\n    return self._apply(lambda t: t.cuda(device_id))\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 118, in _apply\n    module._apply(fn)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 118, in _apply\n    module._apply(fn)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 124, in _apply\n    param.data = fn(param.data)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 147, in &lt;lambda&gt;\n    return self._apply(lambda t: t.cuda(device_id))\n  File \"/usr/local/lib/python2.7/dist-packages/torch/_utils.py\", line 66, in _cuda\n    return new_type(self.size()).copy_(self, async)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py\", line 266, in _lazy_new\n    _lazy_init()\n  File \"/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py\", line 85, in _lazy_init\n    torch._C._cuda_init()\nRuntimeError: cuda runtime error (30) : unknown error at /pytorch/torch/lib/THC/THCGeneral.c:70\n</code></pre>\n<p>My cuda version is as follows:</p>\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2016 NVIDIA Corporation\nBuilt on Tue_Jan_10_13:22:03_CST_2017\nCuda compilation tools, release 8.0, V8.0.61\n</code></pre>\n<p>A much more detailed post is also available here: <a href=\"https://stackoverflow.com/q/45861767/4993513\" rel=\"nofollow\">https://stackoverflow.com/q/45861767/4993513</a></p>", "body_text": "I have made small changes in the imagenet example code. Changed these lines to:\n\n   if not args.distributed:\n        if args.arch.startswith('alexnet') or args.arch.startswith('vgg'):\n            #model.features = torch.nn.DataParallel(model.features)\n            model.cuda()\n        #else:\n            #model = torch.nn.DataParallel(model).cuda()\n    else:\n        model.cuda()\n        #model = torch.nn.parallel.DistributedDataParallel(model)\n\n    # define loss function (criterion) and optimizer\n    criterion = nn.CrossEntropyLoss().cuda()\n\nAnd, when I run the script, it throws a cuda runtime error which is as follows:\n\nubuntu@ip-x-y-z-a:~$ time CUDA_VISIBLE_DEVICES=0 python imagenet2.py --world-size 1 --arch 'alexnet' ImageNet2\n=> creating model 'alexnet'\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/THCGeneral.c line=70 error=30 : unknown error\nTraceback (most recent call last):\n  File \"imagenet2.py\", line 319, in <module>\n    main()\n  File \"imagenet2.py\", line 87, in main\n    model.cuda()\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 147, in cuda\n    return self._apply(lambda t: t.cuda(device_id))\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 118, in _apply\n    module._apply(fn)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 118, in _apply\n    module._apply(fn)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 124, in _apply\n    param.data = fn(param.data)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 147, in <lambda>\n    return self._apply(lambda t: t.cuda(device_id))\n  File \"/usr/local/lib/python2.7/dist-packages/torch/_utils.py\", line 66, in _cuda\n    return new_type(self.size()).copy_(self, async)\n  File \"/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py\", line 266, in _lazy_new\n    _lazy_init()\n  File \"/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py\", line 85, in _lazy_init\n    torch._C._cuda_init()\nRuntimeError: cuda runtime error (30) : unknown error at /pytorch/torch/lib/THC/THCGeneral.c:70\n\nMy cuda version is as follows:\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2016 NVIDIA Corporation\nBuilt on Tue_Jan_10_13:22:03_CST_2017\nCuda compilation tools, release 8.0, V8.0.61\n\nA much more detailed post is also available here: https://stackoverflow.com/q/45861767/4993513", "body": "I have made small changes in the `imagenet` example code. Changed [these lines](https://github.com/pytorch/examples/blob/86bc3e516dde92fee0ce00668a3714c03155dd44/imagenet/main.py#L80-L88) to:\r\n```\r\n\r\n   if not args.distributed:\r\n        if args.arch.startswith('alexnet') or args.arch.startswith('vgg'):\r\n            #model.features = torch.nn.DataParallel(model.features)\r\n            model.cuda()\r\n        #else:\r\n            #model = torch.nn.DataParallel(model).cuda()\r\n    else:\r\n        model.cuda()\r\n        #model = torch.nn.parallel.DistributedDataParallel(model)\r\n\r\n    # define loss function (criterion) and optimizer\r\n    criterion = nn.CrossEntropyLoss().cuda()\r\n```\r\n\r\nAnd, when I run the script, it throws a cuda runtime error which is as follows:\r\n```\r\n\r\nubuntu@ip-x-y-z-a:~$ time CUDA_VISIBLE_DEVICES=0 python imagenet2.py --world-size 1 --arch 'alexnet' ImageNet2\r\n=> creating model 'alexnet'\r\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/THCGeneral.c line=70 error=30 : unknown error\r\nTraceback (most recent call last):\r\n  File \"imagenet2.py\", line 319, in <module>\r\n    main()\r\n  File \"imagenet2.py\", line 87, in main\r\n    model.cuda()\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 147, in cuda\r\n    return self._apply(lambda t: t.cuda(device_id))\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 118, in _apply\r\n    module._apply(fn)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 118, in _apply\r\n    module._apply(fn)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 124, in _apply\r\n    param.data = fn(param.data)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/nn/modules/module.py\", line 147, in <lambda>\r\n    return self._apply(lambda t: t.cuda(device_id))\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/_utils.py\", line 66, in _cuda\r\n    return new_type(self.size()).copy_(self, async)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py\", line 266, in _lazy_new\r\n    _lazy_init()\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/cuda/__init__.py\", line 85, in _lazy_init\r\n    torch._C._cuda_init()\r\nRuntimeError: cuda runtime error (30) : unknown error at /pytorch/torch/lib/THC/THCGeneral.c:70\r\n```\r\n\r\nMy cuda version is as follows:\r\n```\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2016 NVIDIA Corporation\r\nBuilt on Tue_Jan_10_13:22:03_CST_2017\r\nCuda compilation tools, release 8.0, V8.0.61\r\n```\r\n\r\nA much more detailed post is also available here: https://stackoverflow.com/q/45861767/4993513"}