{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8223", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8223/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8223/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8223/events", "html_url": "https://github.com/pytorch/pytorch/issues/8223", "id": 330066450, "node_id": "MDU6SXNzdWUzMzAwNjY0NTA=", "number": 8223, "title": "[feature request] cpp_extension inside a docker with CUDA_HOME set", "user": {"login": "dashesy", "id": 873905, "node_id": "MDQ6VXNlcjg3MzkwNQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/873905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dashesy", "html_url": "https://github.com/dashesy", "followers_url": "https://api.github.com/users/dashesy/followers", "following_url": "https://api.github.com/users/dashesy/following{/other_user}", "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}", "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions", "organizations_url": "https://api.github.com/users/dashesy/orgs", "repos_url": "https://api.github.com/users/dashesy/repos", "events_url": "https://api.github.com/users/dashesy/events{/privacy}", "received_events_url": "https://api.github.com/users/dashesy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 884152160, "node_id": "MDU6TGFiZWw4ODQxNTIxNjA=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/cpp-extensions", "name": "cpp-extensions", "color": "1c689e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-06-06T23:24:43Z", "updated_at": "2018-06-08T20:37:50Z", "closed_at": "2018-06-08T20:37:50Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Can we <a href=\"https://pytorch.org/tutorials/advanced/cpp_extension.html\" rel=\"nofollow\">build cpp extension</a> from inside a Docker, where I have installed CUDA, but of course no runtime? this is enough to build other CUDA applications.</p>\n<pre><code>python setup.py install\n</code></pre>\n<p>This line in cpp_extension.py:</p>\n<pre><code>CUDA_HOME = _find_cuda_home() if torch.cuda.is_available() else None\n</code></pre>\n<p>Basically prevents the build, because even though <code>_find_cuda_home()</code> has a home, cuda.is_available() returns false. The returned error message is also confusing/wrong:</p>\n<pre lang=\"text\"><code>    EnvironmentError: CUDA_HOME environment variable is not set. Please set it to your CUDA install root.\n</code></pre>\n<p>is incorrect.</p>\n<h2>System Info</h2>\n<p>This is the result of collect_env.py from inside the docker:</p>\n<p>Collecting environment information...<br>\nPyTorch version: 0.4.0<br>\nIs debug build: No<br>\nCUDA used to build PyTorch: 8.0.61</p>\n<p>OS: Ubuntu 16.04.3 LTS<br>\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609<br>\nCMake version: version 3.5.1</p>\n<p>Python version: 2.7<br>\nIs CUDA available: No<br>\nCUDA runtime version: 8.0.61<br>\nGPU models and configuration: Could not collect<br>\nNvidia driver version: Could not collect<br>\ncuDNN version: Probably one of the following:<br>\n/usr/lib/x86_64-linux-gnu/libcudnn.so.6.0.21<br>\n/usr/lib/x86_64-linux-gnu/libcudnn_static_v6.a</p>\n<p>Versions of relevant libraries:<br>\n[pip] numpy (1.14.3)<br>\n[pip] numpydoc (0.8.0)<br>\n[pip] torch (0.4.0)<br>\n[pip] torchvision (0.2.1)<br>\n[conda] pytorch                   0.4.0           py27_cuda8.0.61_cudnn7.1.2_1    pytorch<br>\n[conda] torchvision               0.2.1                    py27_1    pytorch</p>", "body_text": "Can we build cpp extension from inside a Docker, where I have installed CUDA, but of course no runtime? this is enough to build other CUDA applications.\npython setup.py install\n\nThis line in cpp_extension.py:\nCUDA_HOME = _find_cuda_home() if torch.cuda.is_available() else None\n\nBasically prevents the build, because even though _find_cuda_home() has a home, cuda.is_available() returns false. The returned error message is also confusing/wrong:\n    EnvironmentError: CUDA_HOME environment variable is not set. Please set it to your CUDA install root.\n\nis incorrect.\nSystem Info\nThis is the result of collect_env.py from inside the docker:\nCollecting environment information...\nPyTorch version: 0.4.0\nIs debug build: No\nCUDA used to build PyTorch: 8.0.61\nOS: Ubuntu 16.04.3 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609\nCMake version: version 3.5.1\nPython version: 2.7\nIs CUDA available: No\nCUDA runtime version: 8.0.61\nGPU models and configuration: Could not collect\nNvidia driver version: Could not collect\ncuDNN version: Probably one of the following:\n/usr/lib/x86_64-linux-gnu/libcudnn.so.6.0.21\n/usr/lib/x86_64-linux-gnu/libcudnn_static_v6.a\nVersions of relevant libraries:\n[pip] numpy (1.14.3)\n[pip] numpydoc (0.8.0)\n[pip] torch (0.4.0)\n[pip] torchvision (0.2.1)\n[conda] pytorch                   0.4.0           py27_cuda8.0.61_cudnn7.1.2_1    pytorch\n[conda] torchvision               0.2.1                    py27_1    pytorch", "body": "Can we [build cpp extension](https://pytorch.org/tutorials/advanced/cpp_extension.html) from inside a Docker, where I have installed CUDA, but of course no runtime? this is enough to build other CUDA applications.\r\n\r\n    python setup.py install\r\n\r\nThis line in cpp_extension.py:\r\n\r\n    CUDA_HOME = _find_cuda_home() if torch.cuda.is_available() else None\r\n\r\nBasically prevents the build, because even though `_find_cuda_home()` has a home, cuda.is_available() returns false. The returned error message is also confusing/wrong:\r\n\r\n```text\r\n    EnvironmentError: CUDA_HOME environment variable is not set. Please set it to your CUDA install root.\r\n```\r\nis incorrect.\r\n\r\n## System Info\r\nThis is the result of collect_env.py from inside the docker:\r\n\r\nCollecting environment information...\r\nPyTorch version: 0.4.0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 8.0.61\r\n\r\nOS: Ubuntu 16.04.3 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609\r\nCMake version: version 3.5.1\r\n\r\nPython version: 2.7\r\nIs CUDA available: No\r\nCUDA runtime version: 8.0.61\r\nGPU models and configuration: Could not collect\r\nNvidia driver version: Could not collect\r\ncuDNN version: Probably one of the following:\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.6.0.21\r\n/usr/lib/x86_64-linux-gnu/libcudnn_static_v6.a\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.14.3)\r\n[pip] numpydoc (0.8.0)\r\n[pip] torch (0.4.0)\r\n[pip] torchvision (0.2.1)\r\n[conda] pytorch                   0.4.0           py27_cuda8.0.61_cudnn7.1.2_1    pytorch\r\n[conda] torchvision               0.2.1                    py27_1    pytorch\r\n"}