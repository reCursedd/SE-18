{"url": "https://api.github.com/repos/pytorch/pytorch/issues/14050", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/14050/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/14050/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/14050/events", "html_url": "https://github.com/pytorch/pytorch/issues/14050", "id": 381384730, "node_id": "MDU6SXNzdWUzODEzODQ3MzA=", "number": 14050, "title": "libtorch latest-deps cuasing an error: PyTorch script module file is too old", "user": {"login": "Suhail", "id": 66225, "node_id": "MDQ6VXNlcjY2MjI1", "avatar_url": "https://avatars1.githubusercontent.com/u/66225?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Suhail", "html_url": "https://github.com/Suhail", "followers_url": "https://api.github.com/users/Suhail/followers", "following_url": "https://api.github.com/users/Suhail/following{/other_user}", "gists_url": "https://api.github.com/users/Suhail/gists{/gist_id}", "starred_url": "https://api.github.com/users/Suhail/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Suhail/subscriptions", "organizations_url": "https://api.github.com/users/Suhail/orgs", "repos_url": "https://api.github.com/users/Suhail/repos", "events_url": "https://api.github.com/users/Suhail/events{/privacy}", "received_events_url": "https://api.github.com/users/Suhail/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-15T23:34:26Z", "updated_at": "2018-11-16T07:09:19Z", "closed_at": "2018-11-16T07:09:19Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<pre><code>./example-app ../mnist-traced.pt\nterminate called after throwing an instance of 'c10::Error'\n  what():  file_format_version &gt;= kMinSupportedFileFormatVersion ASSERT FAILED at /pytorch/caffe2/serialize/inline_container.h:215, please report a bug to PyTorch. Attempted to read a PyTorch file with version 1, but the minimum supported version for reading is 2. Your PyTorch script module file is too old. Please re-export it again. (readAndValidateFileHeader at /pytorch/caffe2/serialize/inline_container.h:215)\nframe #0: std::function&lt;std::string ()&gt;::operator()() const + 0x11 (0x7f204dc3aca1 in /home/paperspace/mnist-torch-script-test/libtorch/lib/libc10.so)\n</code></pre>\n<p>I just downloaded &amp; unzipped the latest deps:</p>\n<p>wget <a href=\"https://download.pytorch.org/libtorch/nightly/cpu/libtorch-shared-with-deps-latest.zip\" rel=\"nofollow\">https://download.pytorch.org/libtorch/nightly/cpu/libtorch-shared-with-deps-latest.zip</a><br>\nunzip libtorch-shared-with-deps-latest.zip</p>\n<p>Old deps work fine</p>\n<p>Code:</p>\n<div class=\"highlight highlight-source-c++\"><pre><span class=\"pl-k\">if</span> (argc != <span class=\"pl-c1\">2</span>) {\n        cerr &lt;&lt; <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>usage: example-app &lt;path-to-exported-script-module&gt;<span class=\"pl-cce\">\\n</span><span class=\"pl-pds\">\"</span></span>;\n        <span class=\"pl-k\">return</span> -<span class=\"pl-c1\">1</span>;\n    }\n\n    <span class=\"pl-c\"><span class=\"pl-c\">//</span> Deserialize the ScriptModule from a file using torch::jit::load().</span>\n    shared_ptr&lt;torch::jit::script::Module&gt; module = torch::jit::load(argv[<span class=\"pl-c1\">1</span>]);\n\n    <span class=\"pl-en\">assert</span>(module != <span class=\"pl-c1\">nullptr</span>);\n    cout &lt;&lt; <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Model loaded.<span class=\"pl-cce\">\\n</span><span class=\"pl-pds\">\"</span></span>;\n</pre></div>\n<p>I'll try redoing the trace &amp; exporting my model and installing the latest nightly of pytorch and see if it works though. Was just unexpected (though I know I am running on nightlys)</p>\n<h2>To Reproduce</h2>\n<p>Steps to reproduce the behavior:</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n\n<h2>Expected behavior</h2>\n\n<h2>Environment</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre lang=\"PyTorch\" data-meta=\"version: 1.0.0.dev20181106\"><code>Is debug build: No\nCUDA used to build PyTorch: 9.0.176\n\nOS: Ubuntu 16.04.5 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\nCMake version: version 3.12.2\n\nPython version: 3.7\nIs CUDA available: No\nCUDA runtime version: No CUDA\nGPU models and configuration: No CUDA\nNvidia driver version: No CUDA\ncuDNN version: No CUDA\n\nVersions of relevant libraries:\n[pip] Could not collect\n[conda] pytorch-nightly           1.0.0.dev20181106 py3.7_cuda9.0.176_cudnn7.1.2_0    pytorch\n[conda] torchvision-nightly       0.2.1                      py_0    fastai```\n\n## Additional context\n\n&lt;!-- Add any other context about the problem here. --&gt;\n</code></pre>", "body_text": "\ud83d\udc1b Bug\n./example-app ../mnist-traced.pt\nterminate called after throwing an instance of 'c10::Error'\n  what():  file_format_version >= kMinSupportedFileFormatVersion ASSERT FAILED at /pytorch/caffe2/serialize/inline_container.h:215, please report a bug to PyTorch. Attempted to read a PyTorch file with version 1, but the minimum supported version for reading is 2. Your PyTorch script module file is too old. Please re-export it again. (readAndValidateFileHeader at /pytorch/caffe2/serialize/inline_container.h:215)\nframe #0: std::function<std::string ()>::operator()() const + 0x11 (0x7f204dc3aca1 in /home/paperspace/mnist-torch-script-test/libtorch/lib/libc10.so)\n\nI just downloaded & unzipped the latest deps:\nwget https://download.pytorch.org/libtorch/nightly/cpu/libtorch-shared-with-deps-latest.zip\nunzip libtorch-shared-with-deps-latest.zip\nOld deps work fine\nCode:\nif (argc != 2) {\n        cerr << \"usage: example-app <path-to-exported-script-module>\\n\";\n        return -1;\n    }\n\n    // Deserialize the ScriptModule from a file using torch::jit::load().\n    shared_ptr<torch::jit::script::Module> module = torch::jit::load(argv[1]);\n\n    assert(module != nullptr);\n    cout << \"Model loaded.\\n\";\n\nI'll try redoing the trace & exporting my model and installing the latest nightly of pytorch and see if it works though. Was just unexpected (though I know I am running on nightlys)\nTo Reproduce\nSteps to reproduce the behavior:\n\n\n\n\n\n\nExpected behavior\n\nEnvironment\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nIs debug build: No\nCUDA used to build PyTorch: 9.0.176\n\nOS: Ubuntu 16.04.5 LTS\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\nCMake version: version 3.12.2\n\nPython version: 3.7\nIs CUDA available: No\nCUDA runtime version: No CUDA\nGPU models and configuration: No CUDA\nNvidia driver version: No CUDA\ncuDNN version: No CUDA\n\nVersions of relevant libraries:\n[pip] Could not collect\n[conda] pytorch-nightly           1.0.0.dev20181106 py3.7_cuda9.0.176_cudnn7.1.2_0    pytorch\n[conda] torchvision-nightly       0.2.1                      py_0    fastai```\n\n## Additional context\n\n<!-- Add any other context about the problem here. -->", "body": "## \ud83d\udc1b Bug\r\n```\r\n./example-app ../mnist-traced.pt\r\nterminate called after throwing an instance of 'c10::Error'\r\n  what():  file_format_version >= kMinSupportedFileFormatVersion ASSERT FAILED at /pytorch/caffe2/serialize/inline_container.h:215, please report a bug to PyTorch. Attempted to read a PyTorch file with version 1, but the minimum supported version for reading is 2. Your PyTorch script module file is too old. Please re-export it again. (readAndValidateFileHeader at /pytorch/caffe2/serialize/inline_container.h:215)\r\nframe #0: std::function<std::string ()>::operator()() const + 0x11 (0x7f204dc3aca1 in /home/paperspace/mnist-torch-script-test/libtorch/lib/libc10.so)\r\n```\r\n\r\nI just downloaded & unzipped the latest deps: \r\n\r\nwget https://download.pytorch.org/libtorch/nightly/cpu/libtorch-shared-with-deps-latest.zip\r\nunzip libtorch-shared-with-deps-latest.zip\r\n\r\nOld deps work fine\r\n\r\nCode:\r\n\r\n```c++\r\nif (argc != 2) {\r\n        cerr << \"usage: example-app <path-to-exported-script-module>\\n\";\r\n        return -1;\r\n    }\r\n\r\n    // Deserialize the ScriptModule from a file using torch::jit::load().\r\n    shared_ptr<torch::jit::script::Module> module = torch::jit::load(argv[1]);\r\n\r\n    assert(module != nullptr);\r\n    cout << \"Model loaded.\\n\";\r\n\r\n```\r\n\r\nI'll try redoing the trace & exporting my model and installing the latest nightly of pytorch and see if it works though. Was just unexpected (though I know I am running on nightlys)\r\n\r\n## To Reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\n1.\r\n1.\r\n1.\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n## Expected behavior\r\n\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n\r\n```PyTorch version: 1.0.0.dev20181106\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 16.04.5 LTS\r\nGCC version: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCMake version: version 3.12.2\r\n\r\nPython version: 3.7\r\nIs CUDA available: No\r\nCUDA runtime version: No CUDA\r\nGPU models and configuration: No CUDA\r\nNvidia driver version: No CUDA\r\ncuDNN version: No CUDA\r\n\r\nVersions of relevant libraries:\r\n[pip] Could not collect\r\n[conda] pytorch-nightly           1.0.0.dev20181106 py3.7_cuda9.0.176_cudnn7.1.2_0    pytorch\r\n[conda] torchvision-nightly       0.2.1                      py_0    fastai```\r\n\r\n## Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n"}