{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9760", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9760/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9760/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9760/events", "html_url": "https://github.com/pytorch/pytorch/issues/9760", "id": 344063770, "node_id": "MDU6SXNzdWUzNDQwNjM3NzA=", "number": 9760, "title": "[JIT] Parsing of declarations at static initialization time leads to very strange errors when _C.so is stale", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-24T14:30:10Z", "updated_at": "2018-08-17T20:06:47Z", "closed_at": "2018-08-17T20:06:47Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The root cause is the same as <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"341941487\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/9493\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/9493/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/9493\">#9493</a> but I think some stuff JIT is doing is exacerbating the problem.</p>\n<p>I was doing a rebuild of PyTorch one day after making some modifications, and I got this error:</p>\n<pre><code>/home/ezyang/Dev/pytorch-tmp-env/bin/python tools/setup_helpers/generate_code.py\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  expected long but found 'int' here:\naten::RoiPooling2d_backward(Tensor input, Tensor rois, int pooledHeight, int pooledWidth, float spatialScale\n, Tensor gradOutput, Tensor argmaxes) -&gt; Tensor\n                                                       ~~~ &lt;--- HERE\n\nninja: build stopped: subcommand failed.\n</code></pre>\n<p>Deleting torch/*.so fixed the problem.</p>\n<p>I think there are a few problems here:</p>\n<ol>\n<li>This is ostensibly some sort of internal error for the JIT schema, but the error gives no indication as such</li>\n<li>Parsing at static initialization time means that you get this error even if you don't use any JIT functionality</li>\n</ol>", "body_text": "The root cause is the same as #9493 but I think some stuff JIT is doing is exacerbating the problem.\nI was doing a rebuild of PyTorch one day after making some modifications, and I got this error:\n/home/ezyang/Dev/pytorch-tmp-env/bin/python tools/setup_helpers/generate_code.py\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  expected long but found 'int' here:\naten::RoiPooling2d_backward(Tensor input, Tensor rois, int pooledHeight, int pooledWidth, float spatialScale\n, Tensor gradOutput, Tensor argmaxes) -> Tensor\n                                                       ~~~ <--- HERE\n\nninja: build stopped: subcommand failed.\n\nDeleting torch/*.so fixed the problem.\nI think there are a few problems here:\n\nThis is ostensibly some sort of internal error for the JIT schema, but the error gives no indication as such\nParsing at static initialization time means that you get this error even if you don't use any JIT functionality", "body": "The root cause is the same as #9493 but I think some stuff JIT is doing is exacerbating the problem.\r\n\r\nI was doing a rebuild of PyTorch one day after making some modifications, and I got this error:\r\n\r\n```\r\n/home/ezyang/Dev/pytorch-tmp-env/bin/python tools/setup_helpers/generate_code.py\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  expected long but found 'int' here:\r\naten::RoiPooling2d_backward(Tensor input, Tensor rois, int pooledHeight, int pooledWidth, float spatialScale\r\n, Tensor gradOutput, Tensor argmaxes) -> Tensor\r\n                                                       ~~~ <--- HERE\r\n\r\nninja: build stopped: subcommand failed.\r\n```\r\n\r\nDeleting torch/*.so fixed the problem.\r\n\r\nI think there are a few problems here:\r\n\r\n1. This is ostensibly some sort of internal error for the JIT schema, but the error gives no indication as such\r\n2. Parsing at static initialization time means that you get this error even if you don't use any JIT functionality"}