{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/276130077", "html_url": "https://github.com/pytorch/pytorch/issues/631#issuecomment-276130077", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/631", "id": 276130077, "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjEzMDA3Nw==", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-30T17:34:35Z", "updated_at": "2017-01-30T17:34:35Z", "author_association": "MEMBER", "body_html": "<p>If you look into the list of types in the <code>got (...)</code> part, you'll find a mix of CPU and CUDA tensors, with <code>input</code> and <code>output</code> being on CPU, while <code>weight</code> and <code>bias</code> is on the GPU.</p>\n<p>You probably forgot to send the input to the GPU. Alternatively, keep in mind that <code>.cuda()</code> is an out of place operation i.e.</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c1\">input</span>.cuda()\nmodel(Variable(<span class=\"pl-c1\">input</span>))</pre></div>\n<p>will fail. You need to overwrite the reference with a new CUDA tensor:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c1\">input</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">input</span>.cuda()\nmodel(Variable(<span class=\"pl-c1\">input</span>))</pre></div>", "body_text": "If you look into the list of types in the got (...) part, you'll find a mix of CPU and CUDA tensors, with input and output being on CPU, while weight and bias is on the GPU.\nYou probably forgot to send the input to the GPU. Alternatively, keep in mind that .cuda() is an out of place operation i.e.\ninput.cuda()\nmodel(Variable(input))\nwill fail. You need to overwrite the reference with a new CUDA tensor:\ninput = input.cuda()\nmodel(Variable(input))", "body": "If you look into the list of types in the `got (...)` part, you'll find a mix of CPU and CUDA tensors, with `input` and `output` being on CPU, while `weight` and `bias` is on the GPU.\r\n\r\nYou probably forgot to send the input to the GPU. Alternatively, keep in mind that `.cuda()` is an out of place operation i.e.\r\n```python\r\ninput.cuda()\r\nmodel(Variable(input))\r\n```\r\nwill fail. You need to overwrite the reference with a new CUDA tensor:\r\n```python\r\ninput = input.cuda()\r\nmodel(Variable(input))\r\n```"}