{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/140280397", "pull_request_review_id": 64118102, "id": 140280397, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0MDI4MDM5Nw==", "diff_hunk": "@@ -84,18 +286,79 @@ def create_autograd_functions(top_env, declarations):\n     These contain the auto-generated subclasses of torch::autograd::Function\n     for each every differentiable torch function.\n     \"\"\"\n-    # function_definitions = top_env['autograd_function_definitions']\n-    # function_declarations = top_env['autograd_function_declarations']\n+    function_definitions = top_env['autograd_function_definitions']\n+    function_declarations = top_env['autograd_function_declarations']\n+    py_function_initializers = top_env['py_autograd_function_initializers']\n+\n+    def group_by_name(options):\n+        res = {}\n+        for option in options:\n+            name = option['name']\n+            if name not in res:\n+                res[name] = []\n+            res[name].append(option)\n+        return res\n+\n+    for name, options in group_by_name(declarations).items():\n+        for i, option in enumerate(options):\n+            name = option['name']\n+            option['op'] = name[0].upper() + name[1:] + 'Backward'\n+            if len(options) > 1:\n+                option['op'] += str(i)", "path": "tools/autograd/gen_variable_type.py", "position": null, "original_position": 285, "commit_id": "e471756dd09f27c1ac6fff4e977d1faeb4b030cf", "original_commit_id": "a5e60c1254517fffaebc9f5432faf08fb533ae4e", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "It feels weird that generating autograd functions will mutate the name of the ops. It adds this silent dependency that functions have to be generated before methods, which is not so obvious. Why not do this grouping in `load_derivatives`?", "created_at": "2017-09-21T15:42:10Z", "updated_at": "2018-11-23T15:34:43Z", "html_url": "https://github.com/pytorch/pytorch/pull/2805#discussion_r140280397", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/2805", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/140280397"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/2805#discussion_r140280397"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/2805"}}, "body_html": "<p>It feels weird that generating autograd functions will mutate the name of the ops. It adds this silent dependency that functions have to be generated before methods, which is not so obvious. Why not do this grouping in <code>load_derivatives</code>?</p>", "body_text": "It feels weird that generating autograd functions will mutate the name of the ops. It adds this silent dependency that functions have to be generated before methods, which is not so obvious. Why not do this grouping in load_derivatives?"}