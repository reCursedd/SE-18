{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/384717903", "html_url": "https://github.com/pytorch/pytorch/issues/3879#issuecomment-384717903", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/3879", "id": 384717903, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDcxNzkwMw==", "user": {"login": "martinbel", "id": 4535400, "node_id": "MDQ6VXNlcjQ1MzU0MDA=", "avatar_url": "https://avatars3.githubusercontent.com/u/4535400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinbel", "html_url": "https://github.com/martinbel", "followers_url": "https://api.github.com/users/martinbel/followers", "following_url": "https://api.github.com/users/martinbel/following{/other_user}", "gists_url": "https://api.github.com/users/martinbel/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinbel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinbel/subscriptions", "organizations_url": "https://api.github.com/users/martinbel/orgs", "repos_url": "https://api.github.com/users/martinbel/repos", "events_url": "https://api.github.com/users/martinbel/events{/privacy}", "received_events_url": "https://api.github.com/users/martinbel/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-26T17:10:15Z", "updated_at": "2018-04-26T17:10:51Z", "author_association": "NONE", "body_html": "<p>I'm got the same error as above (in the screenshot) and after changing everything to cuda got this:</p>\n<p>Any ideas?</p>\n<pre><code>wg = torch.Tensor([1.,  4.,  2., 1., 1., 3.,  3.,  3., 4., \n  4., 1., 2., 1., 1., 3., 4., 1.]).cuda()\ncriterion = torch.nn.MultiLabelSoftMarginLoss(weight=wg).cuda()\n\nmdl = train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs=25)\n## -- End pasted text --\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n&lt;ipython-input-1-85e810cd12fe&gt; in &lt;module&gt;()\n    182 \n    183 \n--&gt; 184 mdl = train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs=25)\n\n/mnt/kaggle_data/planet-understanding-the-amazon-from-space/helpers.py in train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs)\n     95 \n     96                 running_loss += loss.data[0]\n---&gt; 97                 running_corrects += torch.sum(preds == labels.data)\n     98 \n     99             if phase == 'train':\n\n~/anaconda3/lib/python3.6/site-packages/torch/tensor.py in __eq__(self, other)\n    358 \n    359     def __eq__(self, other):\n--&gt; 360         return self.eq(other)\n    361 \n    362     def __ne__(self, other):\n\nTypeError: eq received an invalid combination of arguments - got (torch.cuda.FloatTensor), but expected one of:\n * (int value)\n      didn't match because some of the arguments have invalid types: (torch.cuda.FloatTensor)\n * (torch.cuda.LongTensor other)\n      didn't match because some of the arguments have invalid types: (torch.cuda.FloatTensor)\n\n</code></pre>", "body_text": "I'm got the same error as above (in the screenshot) and after changing everything to cuda got this:\nAny ideas?\nwg = torch.Tensor([1.,  4.,  2., 1., 1., 3.,  3.,  3., 4., \n  4., 1., 2., 1., 1., 3., 4., 1.]).cuda()\ncriterion = torch.nn.MultiLabelSoftMarginLoss(weight=wg).cuda()\n\nmdl = train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs=25)\n## -- End pasted text --\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-85e810cd12fe> in <module>()\n    182 \n    183 \n--> 184 mdl = train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs=25)\n\n/mnt/kaggle_data/planet-understanding-the-amazon-from-space/helpers.py in train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs)\n     95 \n     96                 running_loss += loss.data[0]\n---> 97                 running_corrects += torch.sum(preds == labels.data)\n     98 \n     99             if phase == 'train':\n\n~/anaconda3/lib/python3.6/site-packages/torch/tensor.py in __eq__(self, other)\n    358 \n    359     def __eq__(self, other):\n--> 360         return self.eq(other)\n    361 \n    362     def __ne__(self, other):\n\nTypeError: eq received an invalid combination of arguments - got (torch.cuda.FloatTensor), but expected one of:\n * (int value)\n      didn't match because some of the arguments have invalid types: (torch.cuda.FloatTensor)\n * (torch.cuda.LongTensor other)\n      didn't match because some of the arguments have invalid types: (torch.cuda.FloatTensor)", "body": "I'm got the same error as above (in the screenshot) and after changing everything to cuda got this: \r\n\r\nAny ideas? \r\n\r\n```\r\nwg = torch.Tensor([1.,  4.,  2., 1., 1., 3.,  3.,  3., 4., \r\n  4., 1., 2., 1., 1., 3., 4., 1.]).cuda()\r\ncriterion = torch.nn.MultiLabelSoftMarginLoss(weight=wg).cuda()\r\n\r\nmdl = train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs=25)\r\n## -- End pasted text --\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-1-85e810cd12fe> in <module>()\r\n    182 \r\n    183 \r\n--> 184 mdl = train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs=25)\r\n\r\n/mnt/kaggle_data/planet-understanding-the-amazon-from-space/helpers.py in train_model(dataloaders, model, criterion, optimizer, scheduler, num_epochs)\r\n     95 \r\n     96                 running_loss += loss.data[0]\r\n---> 97                 running_corrects += torch.sum(preds == labels.data)\r\n     98 \r\n     99             if phase == 'train':\r\n\r\n~/anaconda3/lib/python3.6/site-packages/torch/tensor.py in __eq__(self, other)\r\n    358 \r\n    359     def __eq__(self, other):\r\n--> 360         return self.eq(other)\r\n    361 \r\n    362     def __ne__(self, other):\r\n\r\nTypeError: eq received an invalid combination of arguments - got (torch.cuda.FloatTensor), but expected one of:\r\n * (int value)\r\n      didn't match because some of the arguments have invalid types: (torch.cuda.FloatTensor)\r\n * (torch.cuda.LongTensor other)\r\n      didn't match because some of the arguments have invalid types: (torch.cuda.FloatTensor)\r\n\r\n``` "}