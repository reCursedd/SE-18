{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11383", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11383/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11383/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11383/events", "html_url": "https://github.com/pytorch/pytorch/issues/11383", "id": 358137186, "node_id": "MDU6SXNzdWUzNTgxMzcxODY=", "number": 11383, "title": "PyTorch breaks with gcc in same environment (anaconda)", "user": {"login": "mdevl", "id": 16110942, "node_id": "MDQ6VXNlcjE2MTEwOTQy", "avatar_url": "https://avatars0.githubusercontent.com/u/16110942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdevl", "html_url": "https://github.com/mdevl", "followers_url": "https://api.github.com/users/mdevl/followers", "following_url": "https://api.github.com/users/mdevl/following{/other_user}", "gists_url": "https://api.github.com/users/mdevl/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdevl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdevl/subscriptions", "organizations_url": "https://api.github.com/users/mdevl/orgs", "repos_url": "https://api.github.com/users/mdevl/repos", "events_url": "https://api.github.com/users/mdevl/events{/privacy}", "received_events_url": "https://api.github.com/users/mdevl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 778855555, "node_id": "MDU6TGFiZWw3Nzg4NTU1NTU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/build", "name": "build", "color": "bfdadc", "default": false}], "state": "open", "locked": false, "assignee": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-09-07T16:41:20Z", "updated_at": "2018-09-10T17:28:51Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>I have PyTorch in a virtual anaconda environment (Python 3.6) and want to install a different python package (fenics) that brings along gcc version 4.8.5. This breaks Pytorch, and any attempt to import torch henceforth in Python yields</p>\n<p><code>import torch Traceback (most recent call last): File \"&lt;stdin&gt;\", line 1, in &lt;module&gt; File \"/home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/__init__.py\", line 80, in &lt;module&gt; from torch._C import * ImportError: /home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/lib/../../../../libgomp.so.1: version GOMP_4.0 not found (required by /home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/lib/libcaffe2.so)</code></p>\n<p>Similarly, if I create a new environment and install first gcc=4.8.5 and subsequently PyTorch, I will get the same import error. I.e., <strong>PyTorch breaks due to different gcc version in the same virtual environment.</strong></p>\n<p>The issue seems to be libgomp.so.1 and libstdc++.so.6 in the virtual environment - if I manually replace them with the original files from PyTorch, the issue disappears. But it breaks the other package (fenics) that depends on gcc=4.8.5</p>\n<p>How does one solve this issue? Can I tell PyTorch to use different libraries? I'd highly appreciate any help on this matter. Thanks!</p>\n<p>I've attached a strace on the import command, in case that is relevant.<br>\n<a href=\"https://github.com/pytorch/pytorch/files/2361788/strace.txt\">strace.txt</a></p>\n<h2>Code</h2>\n<p>% Install pytorch - works!<br>\nconda create -n pytorch python=3.6<br>\nsource activate pytorch<br>\nconda install pytorch torchvision -c pytorch<br>\n% Install gcc - breaks PyTorch<br>\nconda install gcc=4.8.5<br>\n% Alternatively, install fenics - brings along gcc 4.8.5-7<br>\nconda install -c conda-forge fenics<br>\n% breaks as well</p>\n<h2>System Info</h2>\n<p>Ubuntu 16.04 (same result on Ubuntu 18.04 in VM)<br>\nDefault (system) compiler: GCC 5.4.0<br>\ncollect_env.py script fails, obviously</p>", "body_text": "Issue description\nI have PyTorch in a virtual anaconda environment (Python 3.6) and want to install a different python package (fenics) that brings along gcc version 4.8.5. This breaks Pytorch, and any attempt to import torch henceforth in Python yields\nimport torch Traceback (most recent call last): File \"<stdin>\", line 1, in <module> File \"/home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/__init__.py\", line 80, in <module> from torch._C import * ImportError: /home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/lib/../../../../libgomp.so.1: version GOMP_4.0 not found (required by /home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/lib/libcaffe2.so)\nSimilarly, if I create a new environment and install first gcc=4.8.5 and subsequently PyTorch, I will get the same import error. I.e., PyTorch breaks due to different gcc version in the same virtual environment.\nThe issue seems to be libgomp.so.1 and libstdc++.so.6 in the virtual environment - if I manually replace them with the original files from PyTorch, the issue disappears. But it breaks the other package (fenics) that depends on gcc=4.8.5\nHow does one solve this issue? Can I tell PyTorch to use different libraries? I'd highly appreciate any help on this matter. Thanks!\nI've attached a strace on the import command, in case that is relevant.\nstrace.txt\nCode\n% Install pytorch - works!\nconda create -n pytorch python=3.6\nsource activate pytorch\nconda install pytorch torchvision -c pytorch\n% Install gcc - breaks PyTorch\nconda install gcc=4.8.5\n% Alternatively, install fenics - brings along gcc 4.8.5-7\nconda install -c conda-forge fenics\n% breaks as well\nSystem Info\nUbuntu 16.04 (same result on Ubuntu 18.04 in VM)\nDefault (system) compiler: GCC 5.4.0\ncollect_env.py script fails, obviously", "body": "## Issue description\r\n\r\nI have PyTorch in a virtual anaconda environment (Python 3.6) and want to install a different python package (fenics) that brings along gcc version 4.8.5. This breaks Pytorch, and any attempt to import torch henceforth in Python yields\r\n\r\n`import torch\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/__init__.py\", line 80, in <module>\r\n    from torch._C import *\r\nImportError: /home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/lib/../../../../libgomp.so.1: version GOMP_4.0 not found (required by /home/user/opt/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/lib/libcaffe2.so)`\r\n\r\n\r\nSimilarly, if I create a new environment and install first gcc=4.8.5 and subsequently PyTorch, I will get the same import error. I.e., **PyTorch breaks due to different gcc version in the same virtual environment.**\r\n\r\nThe issue seems to be libgomp.so.1 and libstdc++.so.6 in the virtual environment - if I manually replace them with the original files from PyTorch, the issue disappears. But it breaks the other package (fenics) that depends on gcc=4.8.5\r\n\r\nHow does one solve this issue? Can I tell PyTorch to use different libraries? I'd highly appreciate any help on this matter. Thanks!\r\n\r\nI've attached a strace on the import command, in case that is relevant.\r\n[strace.txt](https://github.com/pytorch/pytorch/files/2361788/strace.txt)\r\n\r\n## Code\r\n\r\n% Install pytorch - works!\r\nconda create -n pytorch python=3.6\r\nsource activate pytorch\r\nconda install pytorch torchvision -c pytorch\r\n% Install gcc - breaks PyTorch\r\nconda install gcc=4.8.5\r\n% Alternatively, install fenics - brings along gcc 4.8.5-7\r\nconda install -c conda-forge fenics\r\n% breaks as well\r\n\r\n\r\n\r\n## System Info\r\nUbuntu 16.04 (same result on Ubuntu 18.04 in VM)\r\nDefault (system) compiler: GCC 5.4.0\r\ncollect_env.py script fails, obviously\r\n\r\n"}