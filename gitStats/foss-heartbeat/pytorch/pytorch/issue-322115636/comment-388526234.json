{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/388526234", "html_url": "https://github.com/pytorch/pytorch/pull/7487#issuecomment-388526234", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/7487", "id": 388526234, "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODUyNjIzNA==", "user": {"login": "mruberry", "id": 38511765, "node_id": "MDQ6VXNlcjM4NTExNzY1", "avatar_url": "https://avatars3.githubusercontent.com/u/38511765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mruberry", "html_url": "https://github.com/mruberry", "followers_url": "https://api.github.com/users/mruberry/followers", "following_url": "https://api.github.com/users/mruberry/following{/other_user}", "gists_url": "https://api.github.com/users/mruberry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mruberry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mruberry/subscriptions", "organizations_url": "https://api.github.com/users/mruberry/orgs", "repos_url": "https://api.github.com/users/mruberry/repos", "events_url": "https://api.github.com/users/mruberry/events{/privacy}", "received_events_url": "https://api.github.com/users/mruberry/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-12T03:20:18Z", "updated_at": "2018-05-12T03:20:18Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I believe I resolved the above issues. I also changed other uses of ScalarConvert, and while reviewing removed dead code from THCTensorMathReduce.cuh and enforced consistent use of THCNumerics there. Note that with the simplification to all reductions it may be possible to replace more of these structs with Thrust alternatives.</p>\n<p>In addition, I folded my follow-up PR into this one. It changes mean and norm to only call THC_reduceDim by adding a \"FinalizeOp\" to THC_reduceDim and its associated kernels in THCReduce.cuh. This PR removed a reduce op,  and the cost of adding finalize op should be smaller (in terms of build time), anyway.</p>\n<p>The failure on pynightly seems unrelated:</p>\n<p>02:34:29 Searching for tqdm<br>\n02:34:29 Reading <a href=\"https://pypi.python.org/simple/tqdm/\" rel=\"nofollow\">https://pypi.python.org/simple/tqdm/</a><br>\n02:34:29 Downloading <a href=\"https://files.pythonhosted.org/packages/6a/8c/7d79a901f28a98b1ff66e0cef456dbf38b7b8be4ba7da88394039e020c96/tqdm-4.23.3.tar.gz#sha256=ce205451a27b6050faed0bb2bcbea96c6a550f8c27cd2b5441d72e948113ad18\" rel=\"nofollow\">https://files.pythonhosted.org/packages/6a/8c/7d79a901f28a98b1ff66e0cef456dbf38b7b8be4ba7da88394039e020c96/tqdm-4.23.3.tar.gz#sha256=ce205451a27b6050faed0bb2bcbea96c6a550f8c27cd2b5441d72e948113ad18</a><br>\n02:34:29 Best match: tqdm 4.23.3<br>\n02:34:29 Processing tqdm-4.23.3.tar.gz<br>\n02:34:29 Writing /tmp/easy_install-e2cexpi8/tqdm-4.23.3/setup.cfg<br>\n02:34:29 Running tqdm-4.23.3/setup.py -q bdist_egg --dist-dir /tmp/easy_install-e2cexpi8/tqdm-4.23.3/egg-dist-tmp-i40gdpf4<br>\n02:34:29 zip_safe flag not set; analyzing archive contents...<br>\n02:34:29 Traceback (most recent call last):<br>\n02:34:29   File \"/opt/python/nightly/lib/python3.7/site-packages/setuptools/sandbox.py\", line 157, in save_modules</p>", "body_text": "I believe I resolved the above issues. I also changed other uses of ScalarConvert, and while reviewing removed dead code from THCTensorMathReduce.cuh and enforced consistent use of THCNumerics there. Note that with the simplification to all reductions it may be possible to replace more of these structs with Thrust alternatives.\nIn addition, I folded my follow-up PR into this one. It changes mean and norm to only call THC_reduceDim by adding a \"FinalizeOp\" to THC_reduceDim and its associated kernels in THCReduce.cuh. This PR removed a reduce op,  and the cost of adding finalize op should be smaller (in terms of build time), anyway.\nThe failure on pynightly seems unrelated:\n02:34:29 Searching for tqdm\n02:34:29 Reading https://pypi.python.org/simple/tqdm/\n02:34:29 Downloading https://files.pythonhosted.org/packages/6a/8c/7d79a901f28a98b1ff66e0cef456dbf38b7b8be4ba7da88394039e020c96/tqdm-4.23.3.tar.gz#sha256=ce205451a27b6050faed0bb2bcbea96c6a550f8c27cd2b5441d72e948113ad18\n02:34:29 Best match: tqdm 4.23.3\n02:34:29 Processing tqdm-4.23.3.tar.gz\n02:34:29 Writing /tmp/easy_install-e2cexpi8/tqdm-4.23.3/setup.cfg\n02:34:29 Running tqdm-4.23.3/setup.py -q bdist_egg --dist-dir /tmp/easy_install-e2cexpi8/tqdm-4.23.3/egg-dist-tmp-i40gdpf4\n02:34:29 zip_safe flag not set; analyzing archive contents...\n02:34:29 Traceback (most recent call last):\n02:34:29   File \"/opt/python/nightly/lib/python3.7/site-packages/setuptools/sandbox.py\", line 157, in save_modules", "body": "I believe I resolved the above issues. I also changed other uses of ScalarConvert, and while reviewing removed dead code from THCTensorMathReduce.cuh and enforced consistent use of THCNumerics there. Note that with the simplification to all reductions it may be possible to replace more of these structs with Thrust alternatives.\r\n\r\nIn addition, I folded my follow-up PR into this one. It changes mean and norm to only call THC_reduceDim by adding a \"FinalizeOp\" to THC_reduceDim and its associated kernels in THCReduce.cuh. This PR removed a reduce op,  and the cost of adding finalize op should be smaller (in terms of build time), anyway. \r\n\r\nThe failure on pynightly seems unrelated:\r\n\r\n02:34:29 Searching for tqdm\r\n02:34:29 Reading https://pypi.python.org/simple/tqdm/\r\n02:34:29 Downloading https://files.pythonhosted.org/packages/6a/8c/7d79a901f28a98b1ff66e0cef456dbf38b7b8be4ba7da88394039e020c96/tqdm-4.23.3.tar.gz#sha256=ce205451a27b6050faed0bb2bcbea96c6a550f8c27cd2b5441d72e948113ad18\r\n02:34:29 Best match: tqdm 4.23.3\r\n02:34:29 Processing tqdm-4.23.3.tar.gz\r\n02:34:29 Writing /tmp/easy_install-e2cexpi8/tqdm-4.23.3/setup.cfg\r\n02:34:29 Running tqdm-4.23.3/setup.py -q bdist_egg --dist-dir /tmp/easy_install-e2cexpi8/tqdm-4.23.3/egg-dist-tmp-i40gdpf4\r\n02:34:29 zip_safe flag not set; analyzing archive contents...\r\n02:34:29 Traceback (most recent call last):\r\n02:34:29   File \"/opt/python/nightly/lib/python3.7/site-packages/setuptools/sandbox.py\", line 157, in save_modules"}