{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/310427595", "html_url": "https://github.com/pytorch/pytorch/issues/1139#issuecomment-310427595", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/1139", "id": 310427595, "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDQyNzU5NQ==", "user": {"login": "fedeblock", "id": 2471090, "node_id": "MDQ6VXNlcjI0NzEwOTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/2471090?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fedeblock", "html_url": "https://github.com/fedeblock", "followers_url": "https://api.github.com/users/fedeblock/followers", "following_url": "https://api.github.com/users/fedeblock/following{/other_user}", "gists_url": "https://api.github.com/users/fedeblock/gists{/gist_id}", "starred_url": "https://api.github.com/users/fedeblock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fedeblock/subscriptions", "organizations_url": "https://api.github.com/users/fedeblock/orgs", "repos_url": "https://api.github.com/users/fedeblock/repos", "events_url": "https://api.github.com/users/fedeblock/events{/privacy}", "received_events_url": "https://api.github.com/users/fedeblock/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-22T16:10:12Z", "updated_at": "2017-06-22T16:10:12Z", "author_association": "NONE", "body_html": "<p>Hi, I followed Kyle steps and i\u00b4m getting these errors:</p>\n<pre><code>In file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.cpp:1:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.cpp:10:1: error: thread-local storage is\n      not supported for the current target\nthread_local rank_type THDState::s_current_worker = 1;\n^\n2 errors generated.\nmake[2]: *** [CMakeFiles/THD.dir/master_worker/master/State.cpp.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDStorage.cpp:2:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDTensor.cpp:2:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/Master.cpp:3:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDRandom.cpp:5:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n</code></pre>\n<p>I did a <code>git clean -xfd</code>  and <code>python setup.py clean</code></p>\n<p>I checked clang and it was 7.3.1, i noticed Kyle was using 8.0.0, so I downloaded Xcode and command line utilities and verified 8.0.0 and was pointing to the command line utilities.</p>\n<p>Nevertheless I had this error:</p>\n<pre><code>Scanning dependencies of target THD\n[  4%] Building CXX object CMakeFiles/THD.dir/base/ChannelUtils.cpp.o\n[ 12%] Building CXX object CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o\n[ 12%] Building CXX object CMakeFiles/THD.dir/base/Cuda.cpp.o\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/DataChannel.cpp.o\n[ 25%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethod.cpp.o\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/DataChannelRequest.cpp.o\n[ 29%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodFile.cpp.o\n[ 33%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodEnv.cpp.o\n[ 41%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodTCP.cpp.o\n[ 41%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelTCP.cpp.o\n[ 45%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodUtils.cpp.o\n[ 50%] Building CXX object CMakeFiles/THD.dir/process_group/General.cpp.o\n[ 54%] Building CXX object CMakeFiles/THD.dir/master_worker/common/ByteArray.cpp.o\n[ 58%] Building CXX object CMakeFiles/THD.dir/process_group/Collectives.cpp.o\n[ 70%] Building CXX object CMakeFiles/THD.dir/master_worker/common/CommandChannel.cpp.o\n[ 70%] Building CXX object CMakeFiles/THD.dir/master_worker/master/Master.cpp.o\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/worker/Dispatch.cpp.o\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDRandom.cpp.o\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/master/State.cpp.o\n[ 87%] Building CXX object CMakeFiles/THD.dir/master_worker/worker/Worker.cpp.o\n[ 87%] Building CXX object CMakeFiles/THD.dir/master_worker/common/RPC.cpp.o\n[ 91%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDStorage.cpp.o\n[ 95%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDTensor.cpp.o\n[100%] Linking CXX shared library libTHD.dylib\nld: warning: directory not found for option '-L/usr/local/cuda/lib64'\nUndefined symbols for architecture x86_64:\n  \"_state\", referenced from:\n      _THDTensorDescriptor_newFromTHCudaDoubleTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaFloatTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaLongTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaIntTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaShortTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaCharTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaByteTensor in TensorDescriptor.cpp.o\n      ...\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[2]: *** [libTHD.1.dylib] Error 1\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre>\n<p>Help, please!</p>", "body_text": "Hi, I followed Kyle steps and i\u00b4m getting these errors:\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.cpp:1:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.cpp:10:1: error: thread-local storage is\n      not supported for the current target\nthread_local rank_type THDState::s_current_worker = 1;\n^\n2 errors generated.\nmake[2]: *** [CMakeFiles/THD.dir/master_worker/master/State.cpp.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDStorage.cpp:2:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDTensor.cpp:2:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/Master.cpp:3:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n  ^\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDRandom.cpp:5:\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\n      not supported for the current target\n  thread_local static rank_type s_current_worker;\n\nI did a git clean -xfd  and python setup.py clean\nI checked clang and it was 7.3.1, i noticed Kyle was using 8.0.0, so I downloaded Xcode and command line utilities and verified 8.0.0 and was pointing to the command line utilities.\nNevertheless I had this error:\nScanning dependencies of target THD\n[  4%] Building CXX object CMakeFiles/THD.dir/base/ChannelUtils.cpp.o\n[ 12%] Building CXX object CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o\n[ 12%] Building CXX object CMakeFiles/THD.dir/base/Cuda.cpp.o\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/DataChannel.cpp.o\n[ 25%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethod.cpp.o\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/DataChannelRequest.cpp.o\n[ 29%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodFile.cpp.o\n[ 33%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodEnv.cpp.o\n[ 41%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodTCP.cpp.o\n[ 41%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelTCP.cpp.o\n[ 45%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodUtils.cpp.o\n[ 50%] Building CXX object CMakeFiles/THD.dir/process_group/General.cpp.o\n[ 54%] Building CXX object CMakeFiles/THD.dir/master_worker/common/ByteArray.cpp.o\n[ 58%] Building CXX object CMakeFiles/THD.dir/process_group/Collectives.cpp.o\n[ 70%] Building CXX object CMakeFiles/THD.dir/master_worker/common/CommandChannel.cpp.o\n[ 70%] Building CXX object CMakeFiles/THD.dir/master_worker/master/Master.cpp.o\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/worker/Dispatch.cpp.o\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDRandom.cpp.o\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/master/State.cpp.o\n[ 87%] Building CXX object CMakeFiles/THD.dir/master_worker/worker/Worker.cpp.o\n[ 87%] Building CXX object CMakeFiles/THD.dir/master_worker/common/RPC.cpp.o\n[ 91%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDStorage.cpp.o\n[ 95%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDTensor.cpp.o\n[100%] Linking CXX shared library libTHD.dylib\nld: warning: directory not found for option '-L/usr/local/cuda/lib64'\nUndefined symbols for architecture x86_64:\n  \"_state\", referenced from:\n      _THDTensorDescriptor_newFromTHCudaDoubleTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaFloatTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaLongTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaIntTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaShortTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaCharTensor in TensorDescriptor.cpp.o\n      _THDTensorDescriptor_newFromTHCudaByteTensor in TensorDescriptor.cpp.o\n      ...\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[2]: *** [libTHD.1.dylib] Error 1\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\nmake: *** [all] Error 2\n\nHelp, please!", "body": "Hi, I followed Kyle steps and i\u00b4m getting these errors:\r\n\r\n```\r\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.cpp:1:\r\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\r\n      not supported for the current target\r\n  thread_local static rank_type s_current_worker;\r\n  ^\r\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.cpp:10:1: error: thread-local storage is\r\n      not supported for the current target\r\nthread_local rank_type THDState::s_current_worker = 1;\r\n^\r\n2 errors generated.\r\nmake[2]: *** [CMakeFiles/THD.dir/master_worker/master/State.cpp.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDStorage.cpp:2:\r\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\r\n      not supported for the current target\r\n  thread_local static rank_type s_current_worker;\r\n  ^\r\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDTensor.cpp:2:\r\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\r\n      not supported for the current target\r\n  thread_local static rank_type s_current_worker;\r\n  ^\r\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/Master.cpp:3:\r\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\r\n      not supported for the current target\r\n  thread_local static rank_type s_current_worker;\r\n  ^\r\nIn file included from /Users/macintosh/pytorch/torch/lib/THD/master_worker/master/THDRandom.cpp:5:\r\n/Users/macintosh/pytorch/torch/lib/THD/master_worker/master/State.hpp:23:3: error: thread-local storage is\r\n      not supported for the current target\r\n  thread_local static rank_type s_current_worker;\r\n```\r\n\r\n\r\nI did a `git clean -xfd`  and `python setup.py clean`\r\n\r\nI checked clang and it was 7.3.1, i noticed Kyle was using 8.0.0, so I downloaded Xcode and command line utilities and verified 8.0.0 and was pointing to the command line utilities.\r\n\r\nNevertheless I had this error:\r\n\r\n```\r\nScanning dependencies of target THD\r\n[  4%] Building CXX object CMakeFiles/THD.dir/base/ChannelUtils.cpp.o\r\n[ 12%] Building CXX object CMakeFiles/THD.dir/base/TensorDescriptor.cpp.o\r\n[ 12%] Building CXX object CMakeFiles/THD.dir/base/Cuda.cpp.o\r\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/DataChannel.cpp.o\r\n[ 25%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethod.cpp.o\r\n[ 20%] Building CXX object CMakeFiles/THD.dir/base/DataChannelRequest.cpp.o\r\n[ 29%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodFile.cpp.o\r\n[ 33%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodEnv.cpp.o\r\n[ 41%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodTCP.cpp.o\r\n[ 41%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelTCP.cpp.o\r\n[ 45%] Building CXX object CMakeFiles/THD.dir/base/init_methods/InitMethodUtils.cpp.o\r\n[ 50%] Building CXX object CMakeFiles/THD.dir/process_group/General.cpp.o\r\n[ 54%] Building CXX object CMakeFiles/THD.dir/master_worker/common/ByteArray.cpp.o\r\n[ 58%] Building CXX object CMakeFiles/THD.dir/process_group/Collectives.cpp.o\r\n[ 70%] Building CXX object CMakeFiles/THD.dir/master_worker/common/CommandChannel.cpp.o\r\n[ 70%] Building CXX object CMakeFiles/THD.dir/master_worker/master/Master.cpp.o\r\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/worker/Dispatch.cpp.o\r\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDRandom.cpp.o\r\n[ 79%] Building CXX object CMakeFiles/THD.dir/master_worker/master/State.cpp.o\r\n[ 87%] Building CXX object CMakeFiles/THD.dir/master_worker/worker/Worker.cpp.o\r\n[ 87%] Building CXX object CMakeFiles/THD.dir/master_worker/common/RPC.cpp.o\r\n[ 91%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDStorage.cpp.o\r\n[ 95%] Building CXX object CMakeFiles/THD.dir/master_worker/master/THDTensor.cpp.o\r\n[100%] Linking CXX shared library libTHD.dylib\r\nld: warning: directory not found for option '-L/usr/local/cuda/lib64'\r\nUndefined symbols for architecture x86_64:\r\n  \"_state\", referenced from:\r\n      _THDTensorDescriptor_newFromTHCudaDoubleTensor in TensorDescriptor.cpp.o\r\n      _THDTensorDescriptor_newFromTHCudaFloatTensor in TensorDescriptor.cpp.o\r\n      _THDTensorDescriptor_newFromTHCudaLongTensor in TensorDescriptor.cpp.o\r\n      _THDTensorDescriptor_newFromTHCudaIntTensor in TensorDescriptor.cpp.o\r\n      _THDTensorDescriptor_newFromTHCudaShortTensor in TensorDescriptor.cpp.o\r\n      _THDTensorDescriptor_newFromTHCudaCharTensor in TensorDescriptor.cpp.o\r\n      _THDTensorDescriptor_newFromTHCudaByteTensor in TensorDescriptor.cpp.o\r\n      ...\r\nld: symbol(s) not found for architecture x86_64\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\nmake[2]: *** [libTHD.1.dylib] Error 1\r\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\r\nmake: *** [all] Error 2\r\n```\r\nHelp, please!\r\n"}