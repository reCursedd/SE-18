{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/408650195", "html_url": "https://github.com/pytorch/pytorch/pull/9078#issuecomment-408650195", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9078", "id": 408650195, "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY1MDE5NQ==", "user": {"login": "kshitij12345", "id": 19503980, "node_id": "MDQ6VXNlcjE5NTAzOTgw", "avatar_url": "https://avatars3.githubusercontent.com/u/19503980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kshitij12345", "html_url": "https://github.com/kshitij12345", "followers_url": "https://api.github.com/users/kshitij12345/followers", "following_url": "https://api.github.com/users/kshitij12345/following{/other_user}", "gists_url": "https://api.github.com/users/kshitij12345/gists{/gist_id}", "starred_url": "https://api.github.com/users/kshitij12345/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kshitij12345/subscriptions", "organizations_url": "https://api.github.com/users/kshitij12345/orgs", "repos_url": "https://api.github.com/users/kshitij12345/repos", "events_url": "https://api.github.com/users/kshitij12345/events{/privacy}", "received_events_url": "https://api.github.com/users/kshitij12345/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-29T03:57:57Z", "updated_at": "2018-07-31T14:31:26Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=20787943\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/t-vi\">@t-vi</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5674597\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/SsnL\">@SsnL</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=655866\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/colesbury\">@colesbury</a> , please review the code once.</p>\n<p>Changes:</p>\n<ul>\n<li><strong>Optional argument of weight is added to <code>index_add_</code>.</strong></li>\n</ul>\n<ol>\n<li>The size of weight vector should be the same as index vector.</li>\n<li><code>weight.dtype</code> should be the same as <code>src</code> tensor.</li>\n<li>Test is added in <a href=\"https://github.com/kshitij12345/pytorch/blob/b903357decad0a38be8d9ffadca07c2468ffe31d/test/test_autograd.py#L2320-L2358\"><code>test_autograd.py</code></a> when the weight argument is given.</li>\n</ol>\n<ul>\n<li><strong><a href=\"https://github.com/kshitij12345/pytorch/blob/b903357decad0a38be8d9ffadca07c2468ffe31d/aten/src/ATen/native/Embedding.cpp#L72-L108\"><code>embedding_dense_backward</code></a> is rewritten using <code>index_add_</code></strong></li>\n</ul>\n<ol>\n<li>Test is added in <a href=\"https://github.com/kshitij12345/pytorch/blob/b903357decad0a38be8d9ffadca07c2468ffe31d/test/test_nn.py#L1734-L1753\"><code>test_nn.py</code></a> to check the gradients using <code>gradcheck</code> and <code>gradgradcheck</code> .</li>\n</ol>", "body_text": "@t-vi @SsnL @colesbury , please review the code once.\nChanges:\n\nOptional argument of weight is added to index_add_.\n\n\nThe size of weight vector should be the same as index vector.\nweight.dtype should be the same as src tensor.\nTest is added in test_autograd.py when the weight argument is given.\n\n\nembedding_dense_backward is rewritten using index_add_\n\n\nTest is added in test_nn.py to check the gradients using gradcheck and gradgradcheck .", "body": "@t-vi @SsnL @colesbury , please review the code once.\r\n\r\nChanges:\r\n\r\n-  **Optional argument of weight is added to `index_add_`.**\r\n\r\n1. The size of weight vector should be the same as index vector.\r\n2. `weight.dtype` should be the same as `src` tensor.\r\n3. Test is added in [`test_autograd.py`](https://github.com/kshitij12345/pytorch/blob/b903357decad0a38be8d9ffadca07c2468ffe31d/test/test_autograd.py#L2320-L2358) when the weight argument is given.\r\n\r\n- **[`embedding_dense_backward`](https://github.com/kshitij12345/pytorch/blob/b903357decad0a38be8d9ffadca07c2468ffe31d/aten/src/ATen/native/Embedding.cpp#L72-L108) is rewritten using `index_add_`**\r\n1. Test is added in [`test_nn.py`](https://github.com/kshitij12345/pytorch/blob/b903357decad0a38be8d9ffadca07c2468ffe31d/test/test_nn.py#L1734-L1753) to check the gradients using `gradcheck` and `gradgradcheck` .\r\n"}