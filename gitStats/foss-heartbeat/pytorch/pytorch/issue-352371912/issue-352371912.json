{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10719", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10719/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10719/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10719/events", "html_url": "https://github.com/pytorch/pytorch/issues/10719", "id": 352371912, "node_id": "MDU6SXNzdWUzNTIzNzE5MTI=", "number": 10719, "title": "size mismatch when trying to reconstruct predifined network", "user": {"login": "Ao-Lee", "id": 26970695, "node_id": "MDQ6VXNlcjI2OTcwNjk1", "avatar_url": "https://avatars1.githubusercontent.com/u/26970695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ao-Lee", "html_url": "https://github.com/Ao-Lee", "followers_url": "https://api.github.com/users/Ao-Lee/followers", "following_url": "https://api.github.com/users/Ao-Lee/following{/other_user}", "gists_url": "https://api.github.com/users/Ao-Lee/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ao-Lee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ao-Lee/subscriptions", "organizations_url": "https://api.github.com/users/Ao-Lee/orgs", "repos_url": "https://api.github.com/users/Ao-Lee/repos", "events_url": "https://api.github.com/users/Ao-Lee/events{/privacy}", "received_events_url": "https://api.github.com/users/Ao-Lee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-21T03:26:52Z", "updated_at": "2018-08-21T03:26:52Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>I tried resnet18 and vgg13, both cases return similar error. is there anything I missed?</p>\n<pre><code>import torch \nfrom torchvision.models import resnet18, vgg13\nimport torch.nn as nn\nimport numpy as np\nfrom collections import OrderedDict\n\ninput_size = (10, 3, 224, 224)\n\ndef GetSelf(model):\n    # l = list(model.named_children())[:-1]\n    l = list(model.named_children())\n    d = OrderedDict(l)\n    return nn.Sequential(d)\n \n# m1 = vgg13(pretrained=False)    \nm1 = resnet18(pretrained=False)\nm2 = GetSelf(m1)\ninputs = np.random.random(input_size).astype(np.float32)\ninputs = torch.from_numpy(inputs)\n\nif torch.cuda.is_available():\n    m1.cuda()\n    m2.cuda()\n    inputs = inputs.cuda()\nwith torch.no_grad():\n    o1 = m1(inputs)\n    o2 = m2(inputs)\n    o1 = o1.cpu().numpy() if torch.cuda.is_available() else o1.numpy()\n    o2 = o2.cpu().numpy() if torch.cuda.is_available() else o2.numpy()\n</code></pre>\n<pre><code>  File \"&lt;ipython-input-12-044c200d14f5&gt;\", line 1, in &lt;module&gt;\n    runfile('C:/Users/Administrator/Desktop/a.py', wdir='C:/Users/Administrator/Desktop')\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\spyder\\utils\\site\\sitecustomize.py\", line 866, in runfile\n    execfile(filename, namespace)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\spyder\\utils\\site\\sitecustomize.py\", line 102, in execfile\n    exec(compile(f.read(), filename, 'exec'), namespace)\n\n  File \"C:/Users/Administrator/Desktop/a.py\", line 27, in &lt;module&gt;\n    o2 = m2(inputs)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\n    result = self.forward(*input, **kwargs)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\container.py\", line 91, in forward\n    input = module(input)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\n    result = self.forward(*input, **kwargs)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\linear.py\", line 55, in forward\n    return F.linear(input, self.weight, self.bias)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 1026, in linear\n    output = input.matmul(weight.t())\n\nRuntimeError: size mismatch, m1: [5120 x 1], m2: [512 x 1000] at c:\\new-builder_3\\win-wheel\\pytorch\\aten\\src\\thc\\generic/THCTensorMathBlas.cu:249\n</code></pre>", "body_text": "I tried resnet18 and vgg13, both cases return similar error. is there anything I missed?\nimport torch \nfrom torchvision.models import resnet18, vgg13\nimport torch.nn as nn\nimport numpy as np\nfrom collections import OrderedDict\n\ninput_size = (10, 3, 224, 224)\n\ndef GetSelf(model):\n    # l = list(model.named_children())[:-1]\n    l = list(model.named_children())\n    d = OrderedDict(l)\n    return nn.Sequential(d)\n \n# m1 = vgg13(pretrained=False)    \nm1 = resnet18(pretrained=False)\nm2 = GetSelf(m1)\ninputs = np.random.random(input_size).astype(np.float32)\ninputs = torch.from_numpy(inputs)\n\nif torch.cuda.is_available():\n    m1.cuda()\n    m2.cuda()\n    inputs = inputs.cuda()\nwith torch.no_grad():\n    o1 = m1(inputs)\n    o2 = m2(inputs)\n    o1 = o1.cpu().numpy() if torch.cuda.is_available() else o1.numpy()\n    o2 = o2.cpu().numpy() if torch.cuda.is_available() else o2.numpy()\n\n  File \"<ipython-input-12-044c200d14f5>\", line 1, in <module>\n    runfile('C:/Users/Administrator/Desktop/a.py', wdir='C:/Users/Administrator/Desktop')\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\spyder\\utils\\site\\sitecustomize.py\", line 866, in runfile\n    execfile(filename, namespace)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\spyder\\utils\\site\\sitecustomize.py\", line 102, in execfile\n    exec(compile(f.read(), filename, 'exec'), namespace)\n\n  File \"C:/Users/Administrator/Desktop/a.py\", line 27, in <module>\n    o2 = m2(inputs)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\n    result = self.forward(*input, **kwargs)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\container.py\", line 91, in forward\n    input = module(input)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\n    result = self.forward(*input, **kwargs)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\linear.py\", line 55, in forward\n    return F.linear(input, self.weight, self.bias)\n\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 1026, in linear\n    output = input.matmul(weight.t())\n\nRuntimeError: size mismatch, m1: [5120 x 1], m2: [512 x 1000] at c:\\new-builder_3\\win-wheel\\pytorch\\aten\\src\\thc\\generic/THCTensorMathBlas.cu:249", "body": "I tried resnet18 and vgg13, both cases return similar error. is there anything I missed?\r\n\r\n```\r\nimport torch \r\nfrom torchvision.models import resnet18, vgg13\r\nimport torch.nn as nn\r\nimport numpy as np\r\nfrom collections import OrderedDict\r\n\r\ninput_size = (10, 3, 224, 224)\r\n\r\ndef GetSelf(model):\r\n    # l = list(model.named_children())[:-1]\r\n    l = list(model.named_children())\r\n    d = OrderedDict(l)\r\n    return nn.Sequential(d)\r\n \r\n# m1 = vgg13(pretrained=False)    \r\nm1 = resnet18(pretrained=False)\r\nm2 = GetSelf(m1)\r\ninputs = np.random.random(input_size).astype(np.float32)\r\ninputs = torch.from_numpy(inputs)\r\n\r\nif torch.cuda.is_available():\r\n    m1.cuda()\r\n    m2.cuda()\r\n    inputs = inputs.cuda()\r\nwith torch.no_grad():\r\n    o1 = m1(inputs)\r\n    o2 = m2(inputs)\r\n    o1 = o1.cpu().numpy() if torch.cuda.is_available() else o1.numpy()\r\n    o2 = o2.cpu().numpy() if torch.cuda.is_available() else o2.numpy()\r\n```\r\n\r\n\r\n```\r\n  File \"<ipython-input-12-044c200d14f5>\", line 1, in <module>\r\n    runfile('C:/Users/Administrator/Desktop/a.py', wdir='C:/Users/Administrator/Desktop')\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\spyder\\utils\\site\\sitecustomize.py\", line 866, in runfile\r\n    execfile(filename, namespace)\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\spyder\\utils\\site\\sitecustomize.py\", line 102, in execfile\r\n    exec(compile(f.read(), filename, 'exec'), namespace)\r\n\r\n  File \"C:/Users/Administrator/Desktop/a.py\", line 27, in <module>\r\n    o2 = m2(inputs)\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\container.py\", line 91, in forward\r\n    input = module(input)\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\linear.py\", line 55, in forward\r\n    return F.linear(input, self.weight, self.bias)\r\n\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 1026, in linear\r\n    output = input.matmul(weight.t())\r\n\r\nRuntimeError: size mismatch, m1: [5120 x 1], m2: [512 x 1000] at c:\\new-builder_3\\win-wheel\\pytorch\\aten\\src\\thc\\generic/THCTensorMathBlas.cu:249\r\n```"}