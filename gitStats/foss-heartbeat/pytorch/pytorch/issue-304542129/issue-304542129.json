{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5719", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5719/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5719/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5719/events", "html_url": "https://github.com/pytorch/pytorch/issues/5719", "id": 304542129, "node_id": "MDU6SXNzdWUzMDQ1NDIxMjk=", "number": 5719, "title": "Multiprocessing: sharing a zero-sized tensor fails", "user": {"login": "colesbury", "id": 655866, "node_id": "MDQ6VXNlcjY1NTg2Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/655866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colesbury", "html_url": "https://github.com/colesbury", "followers_url": "https://api.github.com/users/colesbury/followers", "following_url": "https://api.github.com/users/colesbury/following{/other_user}", "gists_url": "https://api.github.com/users/colesbury/gists{/gist_id}", "starred_url": "https://api.github.com/users/colesbury/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colesbury/subscriptions", "organizations_url": "https://api.github.com/users/colesbury/orgs", "repos_url": "https://api.github.com/users/colesbury/repos", "events_url": "https://api.github.com/users/colesbury/events{/privacy}", "received_events_url": "https://api.github.com/users/colesbury/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-03-12T21:13:00Z", "updated_at": "2018-04-03T15:49:41Z", "closed_at": "2018-04-03T15:49:41Z", "author_association": "MEMBER", "body_html": "<ul>\n<li>PyTorch version: 0.4.0a0+c7611f7</li>\n</ul>\n<p>Repro:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">import</span> torch.multiprocessing <span class=\"pl-k\">as</span> mp\n\nq <span class=\"pl-k\">=</span> mp.Queue()\nt <span class=\"pl-k\">=</span> torch.tensor([])\nq.put(t)</pre></div>\n<p>Result:</p>\n<pre><code>  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/queues.py\", line 241, in _feed\n    obj = ForkingPickler.dumps(obj)\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/reduction.py\", line 50, in dumps\n    cls(buf, protocol).dump(obj)\n  File \"/data/users/sgross/pytorch/torch/multiprocessing/reductions.py\", line 117, in reduce_storage\n    df = multiprocessing.reduction.DupFd(fd)\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/reduction.py\", line 190, in DupFd\n    return resource_sharer.DupFd(fd)\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/resource_sharer.py\", line 48, in __init__\n    new_fd = os.dup(fd)\nOSError: [Errno 9] Bad file descriptor\n</code></pre>", "body_text": "PyTorch version: 0.4.0a0+c7611f7\n\nRepro:\nimport torch\nimport torch.multiprocessing as mp\n\nq = mp.Queue()\nt = torch.tensor([])\nq.put(t)\nResult:\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/queues.py\", line 241, in _feed\n    obj = ForkingPickler.dumps(obj)\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/reduction.py\", line 50, in dumps\n    cls(buf, protocol).dump(obj)\n  File \"/data/users/sgross/pytorch/torch/multiprocessing/reductions.py\", line 117, in reduce_storage\n    df = multiprocessing.reduction.DupFd(fd)\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/reduction.py\", line 190, in DupFd\n    return resource_sharer.DupFd(fd)\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/resource_sharer.py\", line 48, in __init__\n    new_fd = os.dup(fd)\nOSError: [Errno 9] Bad file descriptor", "body": "- PyTorch version: 0.4.0a0+c7611f7\r\n\r\nRepro:\r\n\r\n```python\r\nimport torch\r\nimport torch.multiprocessing as mp\r\n\r\nq = mp.Queue()\r\nt = torch.tensor([])\r\nq.put(t)\r\n```\r\n\r\nResult:\r\n\r\n```\r\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/queues.py\", line 241, in _feed\r\n    obj = ForkingPickler.dumps(obj)\r\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/reduction.py\", line 50, in dumps\r\n    cls(buf, protocol).dump(obj)\r\n  File \"/data/users/sgross/pytorch/torch/multiprocessing/reductions.py\", line 117, in reduce_storage\r\n    df = multiprocessing.reduction.DupFd(fd)\r\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/reduction.py\", line 190, in DupFd\r\n    return resource_sharer.DupFd(fd)\r\n  File \"/data/users/sgross/python3/lib/python3.5/multiprocessing/resource_sharer.py\", line 48, in __init__\r\n    new_fd = os.dup(fd)\r\nOSError: [Errno 9] Bad file descriptor\r\n```"}