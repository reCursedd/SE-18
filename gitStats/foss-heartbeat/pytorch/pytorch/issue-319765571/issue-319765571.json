{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7214", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7214/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7214/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7214/events", "html_url": "https://github.com/pytorch/pytorch/issues/7214", "id": 319765571, "node_id": "MDU6SXNzdWUzMTk3NjU1NzE=", "number": 7214, "title": "Do not put system paths in RPATH", "user": {"login": "flx42", "id": 3645581, "node_id": "MDQ6VXNlcjM2NDU1ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/3645581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flx42", "html_url": "https://github.com/flx42", "followers_url": "https://api.github.com/users/flx42/followers", "following_url": "https://api.github.com/users/flx42/following{/other_user}", "gists_url": "https://api.github.com/users/flx42/gists{/gist_id}", "starred_url": "https://api.github.com/users/flx42/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flx42/subscriptions", "organizations_url": "https://api.github.com/users/flx42/orgs", "repos_url": "https://api.github.com/users/flx42/repos", "events_url": "https://api.github.com/users/flx42/events{/privacy}", "received_events_url": "https://api.github.com/users/flx42/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-05-03T01:50:21Z", "updated_at": "2018-05-07T18:02:32Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>This is what I'm seeing today:</p>\n<pre><code>$ readelf -d /opt/conda/envs/pytorch-py3.6/lib/python3.6/site-packages/torch/_nvrtc.cpython-36m-x86_64-linux-gnu.so | grep RPATH\n 0x000000000000000f (RPATH)              Library rpath: [/opt/conda/envs/pytorch-py3.6/lib:/usr/lib/x86_64-linux-gnu/:/usr/local/cuda/lib64:$ORIGIN/lib]\n</code></pre>\n<p>Paths <code>/usr/lib/x86_64-linux-gnu</code> and <code>/usr/local/cuda/lib64</code> were taken from the build environment, but they do not belong in RPATH since those paths are not shipped with the application. Those paths may contain versions of DT_NEEDED libraries that you do not want to use with pytorch, however RPATH has precedence over everything else, so those libraries will get picked, and there is no way around that.</p>\n<p>For example, let's say libcublas provided in  <code>/usr/local/cuda/lib64</code> is not the version I want since it's too old, I have a newest version in <code>~/cuda/lib64</code>, but I have no way to point to it since <code>LD_LIBRARY_PATH</code> will be ignored.</p>\n<p>Caused by: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"267974661\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3255\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/3255/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/3255\">#3255</a> (for <code>/usr/lib/x86_64-linux-gnu</code>)</p>", "body_text": "This is what I'm seeing today:\n$ readelf -d /opt/conda/envs/pytorch-py3.6/lib/python3.6/site-packages/torch/_nvrtc.cpython-36m-x86_64-linux-gnu.so | grep RPATH\n 0x000000000000000f (RPATH)              Library rpath: [/opt/conda/envs/pytorch-py3.6/lib:/usr/lib/x86_64-linux-gnu/:/usr/local/cuda/lib64:$ORIGIN/lib]\n\nPaths /usr/lib/x86_64-linux-gnu and /usr/local/cuda/lib64 were taken from the build environment, but they do not belong in RPATH since those paths are not shipped with the application. Those paths may contain versions of DT_NEEDED libraries that you do not want to use with pytorch, however RPATH has precedence over everything else, so those libraries will get picked, and there is no way around that.\nFor example, let's say libcublas provided in  /usr/local/cuda/lib64 is not the version I want since it's too old, I have a newest version in ~/cuda/lib64, but I have no way to point to it since LD_LIBRARY_PATH will be ignored.\nCaused by: #3255 (for /usr/lib/x86_64-linux-gnu)", "body": "This is what I'm seeing today:\r\n```\r\n$ readelf -d /opt/conda/envs/pytorch-py3.6/lib/python3.6/site-packages/torch/_nvrtc.cpython-36m-x86_64-linux-gnu.so | grep RPATH\r\n 0x000000000000000f (RPATH)              Library rpath: [/opt/conda/envs/pytorch-py3.6/lib:/usr/lib/x86_64-linux-gnu/:/usr/local/cuda/lib64:$ORIGIN/lib]\r\n```\r\n\r\nPaths `/usr/lib/x86_64-linux-gnu` and `/usr/local/cuda/lib64` were taken from the build environment, but they do not belong in RPATH since those paths are not shipped with the application. Those paths may contain versions of DT_NEEDED libraries that you do not want to use with pytorch, however RPATH has precedence over everything else, so those libraries will get picked, and there is no way around that.\r\n\r\nFor example, let's say libcublas provided in  `/usr/local/cuda/lib64` is not the version I want since it's too old, I have a newest version in `~/cuda/lib64`, but I have no way to point to it since `LD_LIBRARY_PATH` will be ignored.\r\n\r\nCaused by: https://github.com/pytorch/pytorch/pull/3255 (for `/usr/lib/x86_64-linux-gnu`)\r\n\r\n"}