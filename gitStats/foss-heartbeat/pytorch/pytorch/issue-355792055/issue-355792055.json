{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11119", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11119/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11119/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11119/events", "html_url": "https://github.com/pytorch/pytorch/issues/11119", "id": 355792055, "node_id": "MDU6SXNzdWUzNTU3OTIwNTU=", "number": 11119, "title": "[Caffe2] Error C2492: data with thread storage duration may not have dll interface", "user": {"login": "xkszltl", "id": 5203025, "node_id": "MDQ6VXNlcjUyMDMwMjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5203025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xkszltl", "html_url": "https://github.com/xkszltl", "followers_url": "https://api.github.com/users/xkszltl/followers", "following_url": "https://api.github.com/users/xkszltl/following{/other_user}", "gists_url": "https://api.github.com/users/xkszltl/gists{/gist_id}", "starred_url": "https://api.github.com/users/xkszltl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xkszltl/subscriptions", "organizations_url": "https://api.github.com/users/xkszltl/orgs", "repos_url": "https://api.github.com/users/xkszltl/repos", "events_url": "https://api.github.com/users/xkszltl/events{/privacy}", "received_events_url": "https://api.github.com/users/xkszltl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-30T23:44:06Z", "updated_at": "2018-08-31T10:27:43Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue description</h2>\n<p>Getting error C2492 from <code>caffe2\\core\\net_async_base.h</code> when building Caffe2 as DLL on Windows.</p>\n<pre><code>caffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_tracing.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector&lt;int,std::allocator&lt;int&gt; &gt; caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_tracing.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_polling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector&lt;int,std::allocator&lt;int&gt; &gt; caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_polling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_scheduling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector&lt;int,std::allocator&lt;int&gt; &gt; caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_scheduling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_base.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector&lt;int,std::allocator&lt;int&gt; &gt; caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_base.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_dag.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector&lt;int,std::allocator&lt;int&gt; &gt; caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_dag.cc) [build\\caffe2\\caffe2.vcxproj]\n</code></pre>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: Caffe2</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): cmake</li>\n<li>OS: Win10</li>\n<li>PyTorch version: master</li>\n<li>VS version (if compiling from source): 2017 15.8.1</li>\n<li>CMake version: 3.12.1</li>\n</ul>", "body_text": "Issue description\nGetting error C2492 from caffe2\\core\\net_async_base.h when building Caffe2 as DLL on Windows.\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_tracing.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_tracing.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_polling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_polling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_scheduling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_scheduling.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_base.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_base.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_dag.cc) [build\\caffe2\\caffe2.vcxproj]\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_dag.cc) [build\\caffe2\\caffe2.vcxproj]\n\nSystem Info\n\nPyTorch or Caffe2: Caffe2\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): cmake\nOS: Win10\nPyTorch version: master\nVS version (if compiling from source): 2017 15.8.1\nCMake version: 3.12.1", "body": "## Issue description\r\n\r\nGetting error C2492 from `caffe2\\core\\net_async_base.h` when building Caffe2 as DLL on Windows.\r\n\r\n```\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_tracing.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_tracing.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_polling.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_polling.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_scheduling.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_scheduling.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_base.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_async_base.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_dag.cc) [build\\caffe2\\caffe2.vcxproj]\r\ncaffe2\\core\\net_async_base.h(103): error C2492: 'protected: static std::vector<int,std::allocator<int> > caffe2::AsyncNetBase::stream_counters_': data with thread storage duration may not have dll interface (compiling source file caffe2\\core\\net_dag.cc) [build\\caffe2\\caffe2.vcxproj]\r\n```\r\n\r\n## System Info\r\n\r\n- PyTorch or Caffe2: Caffe2\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): cmake\r\n- OS: Win10\r\n- PyTorch version: master\r\n- VS version (if compiling from source): 2017 15.8.1\r\n- CMake version: 3.12.1\r\n"}