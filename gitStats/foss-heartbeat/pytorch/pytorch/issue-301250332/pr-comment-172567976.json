{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/172567976", "pull_request_review_id": 101606279, "id": 172567976, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MjU2Nzk3Ng==", "diff_hunk": "@@ -0,0 +1,29 @@\n+#pragma once\n+#include \"vec256.h\"\n+#include \"parallel.h\"\n+\n+#include \"ATen/ATen.h\"\n+#include \"ATen/ExpandUtils.h\"\n+#include \"ATen/NativeFunctions.h\"\n+#include \"ATen/WrapDimUtils.h\"\n+\n+#include <algorithm>\n+#include <functional>\n+#include <numeric>\n+#include <vector>\n+\n+#include <iostream>\n+#include <map>\n+\n+\n+namespace at {\n+namespace native {\n+\n+using sumImplF = void(Tensor &, const Tensor &, size_t, bool);\n+sumImplF sumImplAVX;\n+sumImplF sumImplAVX2;\n+sumImplF sumImplNONE;", "path": "aten/src/ATen/native/cpu/ReduceOpsKernel.h", "position": null, "original_position": 25, "commit_id": "92e4e0671ee0326a1744e3b3b2c3c57694eae39d", "original_commit_id": "cc65e71c0b223ad75cf0d077d825e33ddd4c1cc6", "user": {"login": "cpuhrsch", "id": 1716488, "node_id": "MDQ6VXNlcjE3MTY0ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1716488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cpuhrsch", "html_url": "https://github.com/cpuhrsch", "followers_url": "https://api.github.com/users/cpuhrsch/followers", "following_url": "https://api.github.com/users/cpuhrsch/following{/other_user}", "gists_url": "https://api.github.com/users/cpuhrsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/cpuhrsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cpuhrsch/subscriptions", "organizations_url": "https://api.github.com/users/cpuhrsch/orgs", "repos_url": "https://api.github.com/users/cpuhrsch/repos", "events_url": "https://api.github.com/users/cpuhrsch/events{/privacy}", "received_events_url": "https://api.github.com/users/cpuhrsch/received_events", "type": "User", "site_admin": false}, "body": "If we use march=native for all compilation units the instructions used will depend on [what cpu is used to compile pytorch](https://wiki.gentoo.org/wiki/GCC_optimization#-march). This will then cause all copies to be compiled with avx2 if the current cpu supports it.", "created_at": "2018-03-06T16:06:19Z", "updated_at": "2018-11-23T15:40:24Z", "html_url": "https://github.com/pytorch/pytorch/pull/5481#discussion_r172567976", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/5481", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/172567976"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/5481#discussion_r172567976"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/5481"}}, "body_html": "<p>If we use march=native for all compilation units the instructions used will depend on <a href=\"https://wiki.gentoo.org/wiki/GCC_optimization#-march\" rel=\"nofollow\">what cpu is used to compile pytorch</a>. This will then cause all copies to be compiled with avx2 if the current cpu supports it.</p>", "body_text": "If we use march=native for all compilation units the instructions used will depend on what cpu is used to compile pytorch. This will then cause all copies to be compiled with avx2 if the current cpu supports it.", "in_reply_to_id": 172461430}