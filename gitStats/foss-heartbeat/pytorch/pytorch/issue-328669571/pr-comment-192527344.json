{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/192527344", "pull_request_review_id": 125331137, "id": 192527344, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjUyNzM0NA==", "diff_hunk": "@@ -0,0 +1,141 @@\n+import time\n+from collections import defaultdict\n+from functools import partial\n+\n+\n+# Unfortunately it doesn't seem as if there was any way to get TensorBoard to do\n+# anything without having TF installed, and so this file has a hard dependency on it\n+# as well. It really is a debugging tool, so it doesn't matter.\n+try:\n+    from tensorflow.core.util import event_pb2\n+    from tensorflow.core.framework import graph_pb2\n+    from tensorflow.python.summary.writer.writer import FileWriter\n+except ImportError:\n+    raise ImportError(\"TensorBoard visualization of GraphExecutors requires having \"\n+                      \"TensorFlow installed\")\n+\n+\n+def dump_tensorboard_summary(graph_executor, logdir):\n+    with FileWriter(logdir) as w:\n+        pb_graph = visualize(graph_executor)\n+        evt = event_pb2.Event(wall_time=time.time(), graph_def=pb_graph.SerializeToString())\n+        w.add_event(evt)\n+\n+\n+def visualize(graph, name_prefix='', pb_graph=None, executors_it=None):\n+    \"\"\"Visualizes an independent graph, or a graph executor.\"\"\"\n+    value_map = {}\n+    pb_graph = pb_graph or graph_pb2.GraphDef()\n+\n+    if isinstance(graph, (torch._C.GraphExecutor, torch._C.GraphExecutorState)):\n+        visualize_graph_executor(graph, name_prefix, pb_graph,", "path": "torch/contrib/_tensorboard_vis.py", "position": 31, "original_position": 31, "commit_id": "962283991e319cf269e59e6d988950666a3b1530", "original_commit_id": "fbb211548370785271c9deb49154939a6920672b", "user": {"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, "body": "The interaction between `visualize_graph_executor`'s `inline_graph` field and `visualize` is hard for me to follow.  If there is a way to simplify it that would be nice, but I don't want to block getting this debug code merged just because of this.", "created_at": "2018-06-01T22:13:07Z", "updated_at": "2018-11-23T15:44:52Z", "html_url": "https://github.com/pytorch/pytorch/pull/8050#discussion_r192527344", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/8050", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/192527344"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/8050#discussion_r192527344"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/8050"}}, "body_html": "<p>The interaction between <code>visualize_graph_executor</code>'s <code>inline_graph</code> field and <code>visualize</code> is hard for me to follow.  If there is a way to simplify it that would be nice, but I don't want to block getting this debug code merged just because of this.</p>", "body_text": "The interaction between visualize_graph_executor's inline_graph field and visualize is hard for me to follow.  If there is a way to simplify it that would be nice, but I don't want to block getting this debug code merged just because of this."}