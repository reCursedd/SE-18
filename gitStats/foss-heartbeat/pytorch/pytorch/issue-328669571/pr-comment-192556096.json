{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/192556096", "pull_request_review_id": 125362188, "id": 192556096, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjU1NjA5Ng==", "diff_hunk": "@@ -0,0 +1,141 @@\n+import time\n+from collections import defaultdict\n+from functools import partial\n+\n+\n+# Unfortunately it doesn't seem as if there was any way to get TensorBoard to do\n+# anything without having TF installed, and so this file has a hard dependency on it\n+# as well. It really is a debugging tool, so it doesn't matter.\n+try:\n+    from tensorflow.core.util import event_pb2\n+    from tensorflow.core.framework import graph_pb2\n+    from tensorflow.python.summary.writer.writer import FileWriter\n+except ImportError:\n+    raise ImportError(\"TensorBoard visualization of GraphExecutors requires having \"\n+                      \"TensorFlow installed\")\n+\n+\n+def dump_tensorboard_summary(graph_executor, logdir):\n+    with FileWriter(logdir) as w:\n+        pb_graph = visualize(graph_executor)\n+        evt = event_pb2.Event(wall_time=time.time(), graph_def=pb_graph.SerializeToString())\n+        w.add_event(evt)\n+\n+\n+def visualize(graph, name_prefix='', pb_graph=None, executors_it=None):\n+    \"\"\"Visualizes an independent graph, or a graph executor.\"\"\"\n+    value_map = {}\n+    pb_graph = pb_graph or graph_pb2.GraphDef()\n+\n+    if isinstance(graph, (torch._C.GraphExecutor, torch._C.GraphExecutorState)):\n+        visualize_graph_executor(graph, name_prefix, pb_graph,", "path": "torch/contrib/_tensorboard_vis.py", "position": 31, "original_position": 31, "commit_id": "962283991e319cf269e59e6d988950666a3b1530", "original_commit_id": "fbb211548370785271c9deb49154939a6920672b", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "I agree. The issue is that `visualize_graph_executor` can be called either as a top-level thing, that doesn't have the input/output nodes created just yet, but it can also appear as a nested part of the graph. Both of those cases have to be handled differently if we want to display them as they are right now.", "created_at": "2018-06-02T10:19:24Z", "updated_at": "2018-11-23T15:44:52Z", "html_url": "https://github.com/pytorch/pytorch/pull/8050#discussion_r192556096", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/8050", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/192556096"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/8050#discussion_r192556096"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/8050"}}, "body_html": "<p>I agree. The issue is that <code>visualize_graph_executor</code> can be called either as a top-level thing, that doesn't have the input/output nodes created just yet, but it can also appear as a nested part of the graph. Both of those cases have to be handled differently if we want to display them as they are right now.</p>", "body_text": "I agree. The issue is that visualize_graph_executor can be called either as a top-level thing, that doesn't have the input/output nodes created just yet, but it can also appear as a nested part of the graph. Both of those cases have to be handled differently if we want to display them as they are right now.", "in_reply_to_id": 192527344}