{"url": "https://api.github.com/repos/pytorch/pytorch/issues/14320", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/14320/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/14320/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/14320/events", "html_url": "https://github.com/pytorch/pytorch/issues/14320", "id": 383530023, "node_id": "MDU6SXNzdWUzODM1MzAwMjM=", "number": 14320, "title": "[caffe2] Fails to build with fbgemm enabled", "user": {"login": "dbermond", "id": 16004942, "node_id": "MDQ6VXNlcjE2MDA0OTQy", "avatar_url": "https://avatars3.githubusercontent.com/u/16004942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbermond", "html_url": "https://github.com/dbermond", "followers_url": "https://api.github.com/users/dbermond/followers", "following_url": "https://api.github.com/users/dbermond/following{/other_user}", "gists_url": "https://api.github.com/users/dbermond/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbermond/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbermond/subscriptions", "organizations_url": "https://api.github.com/users/dbermond/orgs", "repos_url": "https://api.github.com/users/dbermond/repos", "events_url": "https://api.github.com/users/dbermond/events{/privacy}", "received_events_url": "https://api.github.com/users/dbermond/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-11-22T13:12:06Z", "updated_at": "2018-11-22T13:12:06Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>Caffe2 git master fails to build with fbgemm enabled (<code>USE_FBGEMM:BOOL='ON'</code>), giving the following error:</p>\n<pre><code>[ 45%] Building CXX object caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o\nIn file included from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/dnnlowp.h:11,\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/caffe2_dnnlowp_utils.h:4,\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/utility_dnnlowp_ops.h:4,\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/elementwise_sum_dnnlowp_op_avx2.cc:1:\n/storage/linux/abs/caffe2-git/src/pytorch/third_party/fbgemm/include/fbgemm/QuantUtils.h:9:10: fatal error: cpuinfo.h: No such file or directory\n #include &lt;cpuinfo.h&gt;\n          ^~~~~~~~~~~\ncompilation terminated.\nmake[2]: *** [caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/build.make:63: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o] Error 1\nmake[1]: *** [CMakeFiles/Makefile2:4460: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/all] Error 2\nmake: *** [Makefile:141: all] Error 2\n</code></pre>\n<p>This error seems to be caused by the recent commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/fb8c3d62feacf5c3d39f6fb034db944a89a0bcf4/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/fb8c3d62feacf5c3d39f6fb034db944a89a0bcf4\"><tt>fb8c3d6</tt></a>. It was building fine some commits before it.</p>\n<h2>To Reproduce</h2>\n<p>Steps to reproduce the behavior:</p>\n<ol>\n<li>mkdir build</li>\n<li>cd build</li>\n<li><a href=\"https://bpaste.net/show/ca5a7eb99368\" rel=\"nofollow\">cmake options</a></li>\n<li>make -j1</li>\n</ol>\n<h2>Expected behavior</h2>\n<p>A succesful build with fbgemm enabled.</p>\n<h2>Environment</h2>\n<ul>\n<li><strong>PyTorch Version:</strong> git master (currently at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/f79fb58744ba70970de652e46ea039b03e9ce9ff/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/f79fb58744ba70970de652e46ea039b03e9ce9ff\"><tt>f79fb58</tt></a>)</li>\n<li><strong>OS:</strong> Arch Linux x86_64</li>\n<li><strong>How you installed PyTorch:</strong> source</li>\n<li><strong>Build command you used (if compiling from source):</strong> already shown above</li>\n<li><strong>Python version:</strong> 3.7.1</li>\n<li><strong>CUDA/cuDNN version:</strong> not enabled in this example</li>\n<li><strong>GPU models and configuration:</strong> not enabled in this example</li>\n<li><strong>Compiler:</strong> gcc 8.2.1</li>\n<li><strong>Any other relevant information:</strong> the same error occurs when enabling cuda and using gcc 7.3.1</li>\n</ul>\n<h2>Additional context</h2>\n<p>It builds fine when disabling fbgemm (<code>USE_FBGEMM:BOOL='OFF'</code>).</p>", "body_text": "\ud83d\udc1b Bug\nCaffe2 git master fails to build with fbgemm enabled (USE_FBGEMM:BOOL='ON'), giving the following error:\n[ 45%] Building CXX object caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o\nIn file included from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/dnnlowp.h:11,\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/caffe2_dnnlowp_utils.h:4,\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/utility_dnnlowp_ops.h:4,\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/elementwise_sum_dnnlowp_op_avx2.cc:1:\n/storage/linux/abs/caffe2-git/src/pytorch/third_party/fbgemm/include/fbgemm/QuantUtils.h:9:10: fatal error: cpuinfo.h: No such file or directory\n #include <cpuinfo.h>\n          ^~~~~~~~~~~\ncompilation terminated.\nmake[2]: *** [caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/build.make:63: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o] Error 1\nmake[1]: *** [CMakeFiles/Makefile2:4460: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/all] Error 2\nmake: *** [Makefile:141: all] Error 2\n\nThis error seems to be caused by the recent commit fb8c3d6. It was building fine some commits before it.\nTo Reproduce\nSteps to reproduce the behavior:\n\nmkdir build\ncd build\ncmake options\nmake -j1\n\nExpected behavior\nA succesful build with fbgemm enabled.\nEnvironment\n\nPyTorch Version: git master (currently at f79fb58)\nOS: Arch Linux x86_64\nHow you installed PyTorch: source\nBuild command you used (if compiling from source): already shown above\nPython version: 3.7.1\nCUDA/cuDNN version: not enabled in this example\nGPU models and configuration: not enabled in this example\nCompiler: gcc 8.2.1\nAny other relevant information: the same error occurs when enabling cuda and using gcc 7.3.1\n\nAdditional context\nIt builds fine when disabling fbgemm (USE_FBGEMM:BOOL='OFF').", "body": "## \ud83d\udc1b Bug\r\n\r\nCaffe2 git master fails to build with fbgemm enabled (`USE_FBGEMM:BOOL='ON'`), giving the following error:\r\n```\r\n[ 45%] Building CXX object caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o\r\nIn file included from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/dnnlowp.h:11,\r\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/caffe2_dnnlowp_utils.h:4,\r\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/utility_dnnlowp_ops.h:4,\r\n                 from /storage/linux/abs/caffe2-git/src/pytorch/caffe2/quantization/server/elementwise_sum_dnnlowp_op_avx2.cc:1:\r\n/storage/linux/abs/caffe2-git/src/pytorch/third_party/fbgemm/include/fbgemm/QuantUtils.h:9:10: fatal error: cpuinfo.h: No such file or directory\r\n #include <cpuinfo.h>\r\n          ^~~~~~~~~~~\r\ncompilation terminated.\r\nmake[2]: *** [caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/build.make:63: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/elementwise_sum_dnnlowp_op_avx2.cc.o] Error 1\r\nmake[1]: *** [CMakeFiles/Makefile2:4460: caffe2/quantization/server/CMakeFiles/caffe2_dnnlowp_avx2_ops.dir/all] Error 2\r\nmake: *** [Makefile:141: all] Error 2\r\n```\r\nThis error seems to be caused by the recent commit https://github.com/pytorch/pytorch/commit/fb8c3d62feacf5c3d39f6fb034db944a89a0bcf4. It was building fine some commits before it.\r\n\r\n## To Reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\n1. mkdir build\r\n1. cd build\r\n1. [cmake options](https://bpaste.net/show/ca5a7eb99368)\r\n1. make -j1\r\n\r\n## Expected behavior\r\n\r\nA succesful build with fbgemm enabled.\r\n\r\n## Environment\r\n\r\n - **PyTorch Version:** git master (currently at https://github.com/pytorch/pytorch/commit/f79fb58744ba70970de652e46ea039b03e9ce9ff)\r\n - **OS:** Arch Linux x86_64\r\n - **How you installed PyTorch:** source\r\n - **Build command you used (if compiling from source):** already shown above\r\n - **Python version:** 3.7.1\r\n - **CUDA/cuDNN version:** not enabled in this example\r\n - **GPU models and configuration:** not enabled in this example\r\n - **Compiler:** gcc 8.2.1\r\n - **Any other relevant information:** the same error occurs when enabling cuda and using gcc 7.3.1\r\n\r\n## Additional context\r\n\r\nIt builds fine when disabling fbgemm (`USE_FBGEMM:BOOL='OFF'`)."}