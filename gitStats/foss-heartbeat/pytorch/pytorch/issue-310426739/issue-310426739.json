{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6180", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6180/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6180/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6180/events", "html_url": "https://github.com/pytorch/pytorch/issues/6180", "id": 310426739, "node_id": "MDU6SXNzdWUzMTA0MjY3Mzk=", "number": 6180, "title": "GIF in README needs to be edited", "user": {"login": "nikhilraghava", "id": 18715837, "node_id": "MDQ6VXNlcjE4NzE1ODM3", "avatar_url": "https://avatars1.githubusercontent.com/u/18715837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikhilraghava", "html_url": "https://github.com/nikhilraghava", "followers_url": "https://api.github.com/users/nikhilraghava/followers", "following_url": "https://api.github.com/users/nikhilraghava/following{/other_user}", "gists_url": "https://api.github.com/users/nikhilraghava/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikhilraghava/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikhilraghava/subscriptions", "organizations_url": "https://api.github.com/users/nikhilraghava/orgs", "repos_url": "https://api.github.com/users/nikhilraghava/repos", "events_url": "https://api.github.com/users/nikhilraghava/events{/privacy}", "received_events_url": "https://api.github.com/users/nikhilraghava/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "SsnL", "id": 5674597, "node_id": "MDQ6VXNlcjU2NzQ1OTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/5674597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SsnL", "html_url": "https://github.com/SsnL", "followers_url": "https://api.github.com/users/SsnL/followers", "following_url": "https://api.github.com/users/SsnL/following{/other_user}", "gists_url": "https://api.github.com/users/SsnL/gists{/gist_id}", "starred_url": "https://api.github.com/users/SsnL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SsnL/subscriptions", "organizations_url": "https://api.github.com/users/SsnL/orgs", "repos_url": "https://api.github.com/users/SsnL/repos", "events_url": "https://api.github.com/users/SsnL/events{/privacy}", "received_events_url": "https://api.github.com/users/SsnL/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "SsnL", "id": 5674597, "node_id": "MDQ6VXNlcjU2NzQ1OTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/5674597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SsnL", "html_url": "https://github.com/SsnL", "followers_url": "https://api.github.com/users/SsnL/followers", "following_url": "https://api.github.com/users/SsnL/following{/other_user}", "gists_url": "https://api.github.com/users/SsnL/gists{/gist_id}", "starred_url": "https://api.github.com/users/SsnL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SsnL/subscriptions", "organizations_url": "https://api.github.com/users/SsnL/orgs", "repos_url": "https://api.github.com/users/SsnL/repos", "events_url": "https://api.github.com/users/SsnL/events{/privacy}", "received_events_url": "https://api.github.com/users/SsnL/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-04-02T08:21:13Z", "updated_at": "2018-05-03T21:23:09Z", "closed_at": "2018-05-03T21:23:09Z", "author_association": "NONE", "body_html": "<p>This GIF (see below) needs to be tweaked a bit:</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/docs/source/_static/img/dynamic_graph.gif\"><img src=\"https://raw.githubusercontent.com/pytorch/pytorch/master/docs/source/_static/img/dynamic_graph.gif\" alt=\"GIF\" style=\"max-width:100%;\"></a></p>\n<p>When I run this code, the first error is:</p>\n<blockquote>\n<p>RuntimeError: element 0 of variables does not require grad and does not have a grad_fn</p>\n</blockquote>\n<p>Looking at the direction of arrows and assuming that we need to calculate the gradient with respect to three variables (prev_h, W_h, W_x), setting <code>requires_grad=True</code> for all four variables raises another error:</p>\n<blockquote>\n<p>RuntimeError: output and gradOutput shapes do not match: output [20 x 1], gradOutput [1 x 20]</p>\n</blockquote>\n<p>So I changed the <code>next_h.backward</code> to <code>next_h.backward(torch.ones(20, 1))</code>. So now the code is:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">from</span> torch.autograd <span class=\"pl-k\">import</span> Variable\n\nx <span class=\"pl-k\">=</span> Variable(torch.randn(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">10</span>))\nprev_h <span class=\"pl-k\">=</span> Variable(torch.randn(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">20</span>), <span class=\"pl-v\">requires_grad</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\nW_h <span class=\"pl-k\">=</span> Variable(torch.randn(<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">20</span>), <span class=\"pl-v\">requires_grad</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\nW_x <span class=\"pl-k\">=</span> Variable(torch.randn(<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">10</span>), <span class=\"pl-v\">requires_grad</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n\ni2h <span class=\"pl-k\">=</span> torch.mm(W_x, x.t())\nh2h <span class=\"pl-k\">=</span> torch.mm(W_h, prev_h.t())\nnext_h <span class=\"pl-k\">=</span> i2h <span class=\"pl-k\">+</span> h2h\nnext_h <span class=\"pl-k\">=</span> next_h.tanh()\n\nnext_h.backward(torch.ones(<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">1</span>))</pre></div>\n<p>I am submitting this issue because I don't want this GIF to mislead beginners when learning PyTorch.</p>", "body_text": "This GIF (see below) needs to be tweaked a bit:\n\nWhen I run this code, the first error is:\n\nRuntimeError: element 0 of variables does not require grad and does not have a grad_fn\n\nLooking at the direction of arrows and assuming that we need to calculate the gradient with respect to three variables (prev_h, W_h, W_x), setting requires_grad=True for all four variables raises another error:\n\nRuntimeError: output and gradOutput shapes do not match: output [20 x 1], gradOutput [1 x 20]\n\nSo I changed the next_h.backward to next_h.backward(torch.ones(20, 1)). So now the code is:\nimport torch\nfrom torch.autograd import Variable\n\nx = Variable(torch.randn(1, 10))\nprev_h = Variable(torch.randn(1, 20), requires_grad=True)\nW_h = Variable(torch.randn(20, 20), requires_grad=True)\nW_x = Variable(torch.randn(20, 10), requires_grad=True)\n\ni2h = torch.mm(W_x, x.t())\nh2h = torch.mm(W_h, prev_h.t())\nnext_h = i2h + h2h\nnext_h = next_h.tanh()\n\nnext_h.backward(torch.ones(20, 1))\nI am submitting this issue because I don't want this GIF to mislead beginners when learning PyTorch.", "body": "This GIF (see below) needs to be tweaked a bit:\r\n\r\n![GIF](https://raw.githubusercontent.com/pytorch/pytorch/master/docs/source/_static/img/dynamic_graph.gif)\r\n\r\nWhen I run this code, the first error is:\r\n>  RuntimeError: element 0 of variables does not require grad and does not have a grad_fn\r\n\r\nLooking at the direction of arrows and assuming that we need to calculate the gradient with respect to three variables (prev_h, W_h, W_x), setting `requires_grad=True` for all four variables raises another error:\r\n> RuntimeError: output and gradOutput shapes do not match: output [20 x 1], gradOutput [1 x 20]\r\n\r\nSo I changed the `next_h.backward` to `next_h.backward(torch.ones(20, 1))`. So now the code is:\r\n\r\n```python\r\nimport torch\r\nfrom torch.autograd import Variable\r\n\r\nx = Variable(torch.randn(1, 10))\r\nprev_h = Variable(torch.randn(1, 20), requires_grad=True)\r\nW_h = Variable(torch.randn(20, 20), requires_grad=True)\r\nW_x = Variable(torch.randn(20, 10), requires_grad=True)\r\n\r\ni2h = torch.mm(W_x, x.t())\r\nh2h = torch.mm(W_h, prev_h.t())\r\nnext_h = i2h + h2h\r\nnext_h = next_h.tanh()\r\n\r\nnext_h.backward(torch.ones(20, 1))\r\n```\r\nI am submitting this issue because I don't want this GIF to mislead beginners when learning PyTorch."}