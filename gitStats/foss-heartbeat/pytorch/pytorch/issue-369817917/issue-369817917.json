{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12627", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12627/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12627/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12627/events", "html_url": "https://github.com/pytorch/pytorch/issues/12627", "id": 369817917, "node_id": "MDU6SXNzdWUzNjk4MTc5MTc=", "number": 12627, "title": "using pytorch 0.4 using cuda show grad was None", "user": {"login": "liuwenjie1995", "id": 18378841, "node_id": "MDQ6VXNlcjE4Mzc4ODQx", "avatar_url": "https://avatars0.githubusercontent.com/u/18378841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liuwenjie1995", "html_url": "https://github.com/liuwenjie1995", "followers_url": "https://api.github.com/users/liuwenjie1995/followers", "following_url": "https://api.github.com/users/liuwenjie1995/following{/other_user}", "gists_url": "https://api.github.com/users/liuwenjie1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/liuwenjie1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liuwenjie1995/subscriptions", "organizations_url": "https://api.github.com/users/liuwenjie1995/orgs", "repos_url": "https://api.github.com/users/liuwenjie1995/repos", "events_url": "https://api.github.com/users/liuwenjie1995/events{/privacy}", "received_events_url": "https://api.github.com/users/liuwenjie1995/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-13T16:30:02Z", "updated_at": "2018-10-13T16:57:25Z", "closed_at": "2018-10-13T16:57:25Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n\n<p>when i use cuda grad , it shows grad was None</p>\n<h2>To Reproduce</h2>\n<p>Steps to reproduce the <code>behavior:</code></p>\n<p>1.cuda 9.1<br>\n2.torch 0.4</p>\n\n<pre><code>import torch\nfrom torch import nn,optim\nimport torch.nn.functional as F\n\ninputs = torch.Tensor(torch.randn(3, 5))\ntargets = torch.Tensor([1, 2, 3]).long()\ninputs.requires_grad = True\n\ninputs, targets = inputs.cuda(),targets.cuda()\n\nNet = nn.Sequential(\n    nn.Linear(5, 5),\n    nn.Softmax()\n).cuda()\n\nout = Net(inputs[0])\nNet.train()\noptimizer = optim.Adam(Net.parameters(), lr=0.001)\nloss_fn = nn.NLLLoss()\nfor i in range(3):\n\n    optimizer.zero_grad()\n\n    loss = loss_fn(out.view(1, 5), targets[0].view(1))\n    loss.backward(retain_graph=True)\n    print(inputs.grad)\n    optimizer.step()\n</code></pre>\n<h2>Expected behavior</h2>\n\n<h2>Environment</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<h2>Additional context</h2>\n", "body_text": "\ud83d\udc1b Bug\n\nwhen i use cuda grad , it shows grad was None\nTo Reproduce\nSteps to reproduce the behavior:\n1.cuda 9.1\n2.torch 0.4\n\nimport torch\nfrom torch import nn,optim\nimport torch.nn.functional as F\n\ninputs = torch.Tensor(torch.randn(3, 5))\ntargets = torch.Tensor([1, 2, 3]).long()\ninputs.requires_grad = True\n\ninputs, targets = inputs.cuda(),targets.cuda()\n\nNet = nn.Sequential(\n    nn.Linear(5, 5),\n    nn.Softmax()\n).cuda()\n\nout = Net(inputs[0])\nNet.train()\noptimizer = optim.Adam(Net.parameters(), lr=0.001)\nloss_fn = nn.NLLLoss()\nfor i in range(3):\n\n    optimizer.zero_grad()\n\n    loss = loss_fn(out.view(1, 5), targets[0].view(1))\n    loss.backward(retain_graph=True)\n    print(inputs.grad)\n    optimizer.step()\n\nExpected behavior\n\nEnvironment\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nAdditional context", "body": "## \ud83d\udc1b Bug\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\nwhen i use cuda grad , it shows grad was None \r\n## To Reproduce\r\n\r\nSteps to reproduce the `behavior:`\r\n\r\n1.cuda 9.1\r\n2.torch 0.4\r\n\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n```\r\nimport torch\r\nfrom torch import nn,optim\r\nimport torch.nn.functional as F\r\n\r\ninputs = torch.Tensor(torch.randn(3, 5))\r\ntargets = torch.Tensor([1, 2, 3]).long()\r\ninputs.requires_grad = True\r\n\r\ninputs, targets = inputs.cuda(),targets.cuda()\r\n\r\nNet = nn.Sequential(\r\n    nn.Linear(5, 5),\r\n    nn.Softmax()\r\n).cuda()\r\n\r\nout = Net(inputs[0])\r\nNet.train()\r\noptimizer = optim.Adam(Net.parameters(), lr=0.001)\r\nloss_fn = nn.NLLLoss()\r\nfor i in range(3):\r\n\r\n    optimizer.zero_grad()\r\n\r\n    loss = loss_fn(out.view(1, 5), targets[0].view(1))\r\n    loss.backward(retain_graph=True)\r\n    print(inputs.grad)\r\n    optimizer.step()\r\n```\r\n\r\n## Expected behavior\r\n\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\n\r\n## Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n"}