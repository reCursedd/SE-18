{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/10981", "id": 211591008, "node_id": "MDExOlB1bGxSZXF1ZXN0MjExNTkxMDA4", "html_url": "https://github.com/pytorch/pytorch/pull/10981", "diff_url": "https://github.com/pytorch/pytorch/pull/10981.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/10981.patch", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/10981", "number": 10981, "state": "closed", "locked": false, "title": "Splits CPU and CUDA fusion compilers", "user": {"login": "mruberry", "id": 38511765, "node_id": "MDQ6VXNlcjM4NTExNzY1", "avatar_url": "https://avatars3.githubusercontent.com/u/38511765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mruberry", "html_url": "https://github.com/mruberry", "followers_url": "https://api.github.com/users/mruberry/followers", "following_url": "https://api.github.com/users/mruberry/following{/other_user}", "gists_url": "https://api.github.com/users/mruberry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mruberry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mruberry/subscriptions", "organizations_url": "https://api.github.com/users/mruberry/orgs", "repos_url": "https://api.github.com/users/mruberry/repos", "events_url": "https://api.github.com/users/mruberry/events{/privacy}", "received_events_url": "https://api.github.com/users/mruberry/received_events", "type": "User", "site_admin": false}, "body": "This PR splits the CPU and CUDA fusion compilers, putting them into a new jit/fusers/ directory with jit/fusers/common for common components. In particular:\r\n\r\n- A fusion interface is created that allows \"fusion handles\" to be requested\r\n- The CPU and CUDA fusers implement this interface, with dispatch determined by device\r\n- The fusion compilers, fusion function specializations and resource strings are split\r\n- CPU-specific classes like TempFile and DynamicLibrary are in the CPU fuser\r\n- Common classes likes TensorDesc and the base fusion function class are in jit/fusers/common\r\n- There is still some specialization in jit/fusers/common, but these specializations are small(-ish)\r\n- Updates the build system to remove the dummy interface on Windows and minimize the use of macros\r\n\r\nThis structure should allow in-flight PRs to easily rebase while providing a clear interface to the fusers.", "created_at": "2018-08-28T23:54:49Z", "updated_at": "2018-11-23T15:50:45Z", "closed_at": "2018-09-14T21:06:54Z", "merged_at": null, "merge_commit_sha": "60193a711c0412a511c4ceb046fd7e42313d016a", "assignee": null, "assignees": [], "requested_reviewers": [{"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, {"login": "colesbury", "id": 655866, "node_id": "MDQ6VXNlcjY1NTg2Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/655866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colesbury", "html_url": "https://github.com/colesbury", "followers_url": "https://api.github.com/users/colesbury/followers", "following_url": "https://api.github.com/users/colesbury/following{/other_user}", "gists_url": "https://api.github.com/users/colesbury/gists{/gist_id}", "starred_url": "https://api.github.com/users/colesbury/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colesbury/subscriptions", "organizations_url": "https://api.github.com/users/colesbury/orgs", "repos_url": "https://api.github.com/users/colesbury/repos", "events_url": "https://api.github.com/users/colesbury/events{/privacy}", "received_events_url": "https://api.github.com/users/colesbury/received_events", "type": "User", "site_admin": false}, {"login": "gchanan", "id": 3768583, "node_id": "MDQ6VXNlcjM3Njg1ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/3768583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gchanan", "html_url": "https://github.com/gchanan", "followers_url": "https://api.github.com/users/gchanan/followers", "following_url": "https://api.github.com/users/gchanan/following{/other_user}", "gists_url": "https://api.github.com/users/gchanan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gchanan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gchanan/subscriptions", "organizations_url": "https://api.github.com/users/gchanan/orgs", "repos_url": "https://api.github.com/users/gchanan/repos", "events_url": "https://api.github.com/users/gchanan/events{/privacy}", "received_events_url": "https://api.github.com/users/gchanan/received_events", "type": "User", "site_admin": false}], "requested_teams": [], "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "milestone": null, "commits_url": "https://api.github.com/repos/pytorch/pytorch/pulls/10981/commits", "review_comments_url": "https://api.github.com/repos/pytorch/pytorch/pulls/10981/comments", "review_comment_url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10981/comments", "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/b8793a0e4816739a48d503f6388d92e61b8c83a1", "head": {"label": "mruberry:fusion_compiler_split", "ref": "fusion_compiler_split", "sha": "b8793a0e4816739a48d503f6388d92e61b8c83a1", "user": {"login": "mruberry", "id": 38511765, "node_id": "MDQ6VXNlcjM4NTExNzY1", "avatar_url": "https://avatars3.githubusercontent.com/u/38511765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mruberry", "html_url": "https://github.com/mruberry", "followers_url": "https://api.github.com/users/mruberry/followers", "following_url": "https://api.github.com/users/mruberry/following{/other_user}", "gists_url": "https://api.github.com/users/mruberry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mruberry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mruberry/subscriptions", "organizations_url": "https://api.github.com/users/mruberry/orgs", "repos_url": "https://api.github.com/users/mruberry/repos", "events_url": "https://api.github.com/users/mruberry/events{/privacy}", "received_events_url": "https://api.github.com/users/mruberry/received_events", "type": "User", "site_admin": false}, "repo": {"id": 130132886, "node_id": "MDEwOlJlcG9zaXRvcnkxMzAxMzI4ODY=", "name": "pytorch", "full_name": "mruberry/pytorch", "private": false, "owner": {"login": "mruberry", "id": 38511765, "node_id": "MDQ6VXNlcjM4NTExNzY1", "avatar_url": "https://avatars3.githubusercontent.com/u/38511765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mruberry", "html_url": "https://github.com/mruberry", "followers_url": "https://api.github.com/users/mruberry/followers", "following_url": "https://api.github.com/users/mruberry/following{/other_user}", "gists_url": "https://api.github.com/users/mruberry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mruberry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mruberry/subscriptions", "organizations_url": "https://api.github.com/users/mruberry/orgs", "repos_url": "https://api.github.com/users/mruberry/repos", "events_url": "https://api.github.com/users/mruberry/events{/privacy}", "received_events_url": "https://api.github.com/users/mruberry/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/mruberry/pytorch", "description": "Tensors and Dynamic neural networks in Python  with strong GPU acceleration", "fork": true, "url": "https://api.github.com/repos/mruberry/pytorch", "forks_url": "https://api.github.com/repos/mruberry/pytorch/forks", "keys_url": "https://api.github.com/repos/mruberry/pytorch/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/mruberry/pytorch/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/mruberry/pytorch/teams", "hooks_url": "https://api.github.com/repos/mruberry/pytorch/hooks", "issue_events_url": "https://api.github.com/repos/mruberry/pytorch/issues/events{/number}", "events_url": "https://api.github.com/repos/mruberry/pytorch/events", "assignees_url": "https://api.github.com/repos/mruberry/pytorch/assignees{/user}", "branches_url": "https://api.github.com/repos/mruberry/pytorch/branches{/branch}", "tags_url": "https://api.github.com/repos/mruberry/pytorch/tags", "blobs_url": "https://api.github.com/repos/mruberry/pytorch/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/mruberry/pytorch/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/mruberry/pytorch/git/refs{/sha}", "trees_url": "https://api.github.com/repos/mruberry/pytorch/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/mruberry/pytorch/statuses/{sha}", "languages_url": "https://api.github.com/repos/mruberry/pytorch/languages", "stargazers_url": "https://api.github.com/repos/mruberry/pytorch/stargazers", "contributors_url": "https://api.github.com/repos/mruberry/pytorch/contributors", "subscribers_url": "https://api.github.com/repos/mruberry/pytorch/subscribers", "subscription_url": "https://api.github.com/repos/mruberry/pytorch/subscription", "commits_url": "https://api.github.com/repos/mruberry/pytorch/commits{/sha}", "git_commits_url": "https://api.github.com/repos/mruberry/pytorch/git/commits{/sha}", "comments_url": "https://api.github.com/repos/mruberry/pytorch/comments{/number}", "issue_comment_url": "https://api.github.com/repos/mruberry/pytorch/issues/comments{/number}", "contents_url": "https://api.github.com/repos/mruberry/pytorch/contents/{+path}", "compare_url": "https://api.github.com/repos/mruberry/pytorch/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/mruberry/pytorch/merges", "archive_url": "https://api.github.com/repos/mruberry/pytorch/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/mruberry/pytorch/downloads", "issues_url": "https://api.github.com/repos/mruberry/pytorch/issues{/number}", "pulls_url": "https://api.github.com/repos/mruberry/pytorch/pulls{/number}", "milestones_url": "https://api.github.com/repos/mruberry/pytorch/milestones{/number}", "notifications_url": "https://api.github.com/repos/mruberry/pytorch/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/mruberry/pytorch/labels{/name}", "releases_url": "https://api.github.com/repos/mruberry/pytorch/releases{/id}", "deployments_url": "https://api.github.com/repos/mruberry/pytorch/deployments", "created_at": "2018-04-18T23:24:38Z", "updated_at": "2018-06-07T02:21:06Z", "pushed_at": "2018-11-02T19:48:38Z", "git_url": "git://github.com/mruberry/pytorch.git", "ssh_url": "git@github.com:mruberry/pytorch.git", "clone_url": "https://github.com/mruberry/pytorch.git", "svn_url": "https://github.com/mruberry/pytorch", "homepage": "http://pytorch.org", "size": 82858, "stargazers_count": 0, "watchers_count": 0, "language": "C++", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "forks_count": 0, "mirror_url": null, "archived": false, "open_issues_count": 0, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "pytorch:master", "ref": "master", "sha": "cda71e260026b84990650809b5b5eae3a201742f", "user": {"login": "pytorch", "id": 21003710, "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/21003710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytorch", "html_url": "https://github.com/pytorch", "followers_url": "https://api.github.com/users/pytorch/followers", "following_url": "https://api.github.com/users/pytorch/following{/other_user}", "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions", "organizations_url": "https://api.github.com/users/pytorch/orgs", "repos_url": "https://api.github.com/users/pytorch/repos", "events_url": "https://api.github.com/users/pytorch/events{/privacy}", "received_events_url": "https://api.github.com/users/pytorch/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 65600975, "node_id": "MDEwOlJlcG9zaXRvcnk2NTYwMDk3NQ==", "name": "pytorch", "full_name": "pytorch/pytorch", "private": false, "owner": {"login": "pytorch", "id": 21003710, "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/21003710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytorch", "html_url": "https://github.com/pytorch", "followers_url": "https://api.github.com/users/pytorch/followers", "following_url": "https://api.github.com/users/pytorch/following{/other_user}", "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions", "organizations_url": "https://api.github.com/users/pytorch/orgs", "repos_url": "https://api.github.com/users/pytorch/repos", "events_url": "https://api.github.com/users/pytorch/events{/privacy}", "received_events_url": "https://api.github.com/users/pytorch/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/pytorch/pytorch", "description": "Tensors and Dynamic neural networks in Python  with strong GPU acceleration", "fork": false, "url": "https://api.github.com/repos/pytorch/pytorch", "forks_url": "https://api.github.com/repos/pytorch/pytorch/forks", "keys_url": "https://api.github.com/repos/pytorch/pytorch/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/pytorch/pytorch/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/pytorch/pytorch/teams", "hooks_url": "https://api.github.com/repos/pytorch/pytorch/hooks", "issue_events_url": "https://api.github.com/repos/pytorch/pytorch/issues/events{/number}", "events_url": "https://api.github.com/repos/pytorch/pytorch/events", "assignees_url": "https://api.github.com/repos/pytorch/pytorch/assignees{/user}", "branches_url": "https://api.github.com/repos/pytorch/pytorch/branches{/branch}", "tags_url": "https://api.github.com/repos/pytorch/pytorch/tags", "blobs_url": "https://api.github.com/repos/pytorch/pytorch/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/pytorch/pytorch/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/pytorch/pytorch/git/refs{/sha}", "trees_url": "https://api.github.com/repos/pytorch/pytorch/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/{sha}", "languages_url": "https://api.github.com/repos/pytorch/pytorch/languages", "stargazers_url": "https://api.github.com/repos/pytorch/pytorch/stargazers", "contributors_url": "https://api.github.com/repos/pytorch/pytorch/contributors", "subscribers_url": "https://api.github.com/repos/pytorch/pytorch/subscribers", "subscription_url": "https://api.github.com/repos/pytorch/pytorch/subscription", "commits_url": "https://api.github.com/repos/pytorch/pytorch/commits{/sha}", "git_commits_url": "https://api.github.com/repos/pytorch/pytorch/git/commits{/sha}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/comments{/number}", "issue_comment_url": "https://api.github.com/repos/pytorch/pytorch/issues/comments{/number}", "contents_url": "https://api.github.com/repos/pytorch/pytorch/contents/{+path}", "compare_url": "https://api.github.com/repos/pytorch/pytorch/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/pytorch/pytorch/merges", "archive_url": "https://api.github.com/repos/pytorch/pytorch/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/pytorch/pytorch/downloads", "issues_url": "https://api.github.com/repos/pytorch/pytorch/issues{/number}", "pulls_url": "https://api.github.com/repos/pytorch/pytorch/pulls{/number}", "milestones_url": "https://api.github.com/repos/pytorch/pytorch/milestones{/number}", "notifications_url": "https://api.github.com/repos/pytorch/pytorch/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/pytorch/pytorch/labels{/name}", "releases_url": "https://api.github.com/repos/pytorch/pytorch/releases{/id}", "deployments_url": "https://api.github.com/repos/pytorch/pytorch/deployments", "created_at": "2016-08-13T05:26:41Z", "updated_at": "2018-11-24T05:35:41Z", "pushed_at": "2018-11-24T05:34:07Z", "git_url": "git://github.com/pytorch/pytorch.git", "ssh_url": "git@github.com:pytorch/pytorch.git", "clone_url": "https://github.com/pytorch/pytorch.git", "svn_url": "https://github.com/pytorch/pytorch", "homepage": "http://pytorch.org", "size": 89651, "stargazers_count": 21577, "watchers_count": 21577, "language": "C++", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "forks_count": 5149, "mirror_url": null, "archived": false, "open_issues_count": 2193, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "forks": 5149, "open_issues": 2193, "watchers": 21577, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/10981"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/10981"}, "issue": {"href": "https://api.github.com/repos/pytorch/pytorch/issues/10981"}, "comments": {"href": "https://api.github.com/repos/pytorch/pytorch/issues/10981/comments"}, "review_comments": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/10981/comments"}, "review_comment": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/10981/commits"}, "statuses": {"href": "https://api.github.com/repos/pytorch/pytorch/statuses/b8793a0e4816739a48d503f6388d92e61b8c83a1"}}, "author_association": "CONTRIBUTOR", "body_html": "<p>This PR splits the CPU and CUDA fusion compilers, putting them into a new jit/fusers/ directory with jit/fusers/common for common components. In particular:</p>\n<ul>\n<li>A fusion interface is created that allows \"fusion handles\" to be requested</li>\n<li>The CPU and CUDA fusers implement this interface, with dispatch determined by device</li>\n<li>The fusion compilers, fusion function specializations and resource strings are split</li>\n<li>CPU-specific classes like TempFile and DynamicLibrary are in the CPU fuser</li>\n<li>Common classes likes TensorDesc and the base fusion function class are in jit/fusers/common</li>\n<li>There is still some specialization in jit/fusers/common, but these specializations are small(-ish)</li>\n<li>Updates the build system to remove the dummy interface on Windows and minimize the use of macros</li>\n</ul>\n<p>This structure should allow in-flight PRs to easily rebase while providing a clear interface to the fusers.</p>", "body_text": "This PR splits the CPU and CUDA fusion compilers, putting them into a new jit/fusers/ directory with jit/fusers/common for common components. In particular:\n\nA fusion interface is created that allows \"fusion handles\" to be requested\nThe CPU and CUDA fusers implement this interface, with dispatch determined by device\nThe fusion compilers, fusion function specializations and resource strings are split\nCPU-specific classes like TempFile and DynamicLibrary are in the CPU fuser\nCommon classes likes TensorDesc and the base fusion function class are in jit/fusers/common\nThere is still some specialization in jit/fusers/common, but these specializations are small(-ish)\nUpdates the build system to remove the dummy interface on Windows and minimize the use of macros\n\nThis structure should allow in-flight PRs to easily rebase while providing a clear interface to the fusers.", "merged": false, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": null, "comments": 20, "review_comments": 16, "maintainer_can_modify": false, "commits": 21, "additions": 2534, "deletions": 1822, "changed_files": 41}