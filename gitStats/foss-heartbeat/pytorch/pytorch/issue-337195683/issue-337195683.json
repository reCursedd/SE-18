{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9062", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9062/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9062/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9062/events", "html_url": "https://github.com/pytorch/pytorch/issues/9062", "id": 337195683, "node_id": "MDU6SXNzdWUzMzcxOTU2ODM=", "number": 9062, "title": "CUDA error with torch.multinomial", "user": {"login": "Oktai15", "id": 17337773, "node_id": "MDQ6VXNlcjE3MzM3Nzcz", "avatar_url": "https://avatars1.githubusercontent.com/u/17337773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Oktai15", "html_url": "https://github.com/Oktai15", "followers_url": "https://api.github.com/users/Oktai15/followers", "following_url": "https://api.github.com/users/Oktai15/following{/other_user}", "gists_url": "https://api.github.com/users/Oktai15/gists{/gist_id}", "starred_url": "https://api.github.com/users/Oktai15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Oktai15/subscriptions", "organizations_url": "https://api.github.com/users/Oktai15/orgs", "repos_url": "https://api.github.com/users/Oktai15/repos", "events_url": "https://api.github.com/users/Oktai15/events{/privacy}", "received_events_url": "https://api.github.com/users/Oktai15/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}, {"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-06-30T07:45:15Z", "updated_at": "2018-09-21T18:05:43Z", "closed_at": "2018-09-21T18:05:43Z", "author_association": "NONE", "body_html": "<p>I have the following code:<br>\n<code>a = torch.multinomial(b, 5)</code><br>\nwhere <code>b</code> is<br>\n<code>tensor([ 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], device='cuda:0')</code></p>\n<p>I notice that tensor has one non-zero element.</p>\n<p>I got the next CUDA error when I ran my code:</p>\n<p>/opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/THCTensorRandom.cuh:109: void renormRowsL1(T *, long, long) [with T = float]: block: [0,0,0], thread: [0,0,0] Assertion <code>THCNumerics&lt;T&gt;::gt(sum, zero)</code> failed.<br>\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/generic/THCTensorMathScan.cu line=74 error=59 : device-side assert triggered</p>\n<p>RuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/generic/THCTensorMathScan.cu:74</p>\n<p>Also I noticed that everything is okay if I transfer tensor to CPU</p>", "body_text": "I have the following code:\na = torch.multinomial(b, 5)\nwhere b is\ntensor([ 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], device='cuda:0')\nI notice that tensor has one non-zero element.\nI got the next CUDA error when I ran my code:\n/opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/THCTensorRandom.cuh:109: void renormRowsL1(T *, long, long) [with T = float]: block: [0,0,0], thread: [0,0,0] Assertion THCNumerics<T>::gt(sum, zero) failed.\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/generic/THCTensorMathScan.cu line=74 error=59 : device-side assert triggered\nRuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/generic/THCTensorMathScan.cu:74\nAlso I noticed that everything is okay if I transfer tensor to CPU", "body": "I have the following code:\r\n`a = torch.multinomial(b, 5)`\r\nwhere `b` is \r\n`tensor([ 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\r\n0., 0., 0., 0., 0., 0., 0., 0.], device='cuda:0')`\r\n\r\nI notice that tensor has one non-zero element.\r\n\r\nI got the next CUDA error when I ran my code:\r\n\r\n/opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/THCTensorRandom.cuh:109: void renormRowsL1(T *, long, long) [with T = float]: block: [0,0,0], thread: [0,0,0] Assertion `THCNumerics<T>::gt(sum, zero)` failed.\r\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/generic/THCTensorMathScan.cu line=74 error=59 : device-side assert triggered\r\n\r\nRuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1524586445097/work/aten/src/THC/generic/THCTensorMathScan.cu:74\r\n\r\nAlso I noticed that everything is okay if I transfer tensor to CPU\r\n"}