{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6618", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6618/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6618/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6618/events", "html_url": "https://github.com/pytorch/pytorch/issues/6618", "id": 314556362, "node_id": "MDU6SXNzdWUzMTQ1NTYzNjI=", "number": 6618, "title": "[Caffe2] CUDNN_STATUS_BAD_PARAM Error with the LRN layer while trying to run the code using CUDA. The training works fine on CPU", "user": {"login": "pradeephike", "id": 29882389, "node_id": "MDQ6VXNlcjI5ODgyMzg5", "avatar_url": "https://avatars2.githubusercontent.com/u/29882389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pradeephike", "html_url": "https://github.com/pradeephike", "followers_url": "https://api.github.com/users/pradeephike/followers", "following_url": "https://api.github.com/users/pradeephike/following{/other_user}", "gists_url": "https://api.github.com/users/pradeephike/gists{/gist_id}", "starred_url": "https://api.github.com/users/pradeephike/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pradeephike/subscriptions", "organizations_url": "https://api.github.com/users/pradeephike/orgs", "repos_url": "https://api.github.com/users/pradeephike/repos", "events_url": "https://api.github.com/users/pradeephike/events{/privacy}", "received_events_url": "https://api.github.com/users/pradeephike/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-16T08:53:51Z", "updated_at": "2018-10-31T22:48:09Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>Original python traceback for operator 39 in network <code>fast_style_train</code> in exception above (most recent call last):<br>\nFile \"styleCaffe.py\", line 284, in <br>\nFile \"styleCaffe.py\", line 250, in main<br>\nFile \"styleCaffe.py\", line 126, in styleNetModelDef<br>\nFile \"styleCaffe.py\", line 68, in customVGGY<br>\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/brew.py\", line 121, in scope_wrapper<br>\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/helpers/normalization.py\", line 43, in lrn<br>\nTraceback (most recent call last):<br>\nFile \"styleCaffe.py\", line 284, in <br>\nmain()<br>\nFile \"styleCaffe.py\", line 260, in main<br>\nworkspace.CreateNet(train_model.net, overwrite=True)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py\", line 166, in CreateNet<br>\nStringifyProto(net), overwrite,<br>\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py\", line 192, in CallWithExceptionIntercept<br>\nreturn func(*args, **kwargs)<br>\nRuntimeError: [enforce fail at local_response_normalization_op_cudnn.cc:39] status == CUDNN_STATUS_SUCCESS. 3 vs 0. , Error at: /home/prasanna/Installations/caffe2/caffe2/operators/local_response_normalization_op_cudnn.cc:39: CUDNN_STATUS_BAD_PARAM</p>\n<p>I am facing the error of Bad parameters while creating the LRN Layer. I have defined the layer in the following way:</p>\n<pre><code>conv1_vggx = brew.conv(model, data, 'conv1_vggx', 3, 96,kernel= 7,stride=2,weight_init=('GaussianFill',{'mean':0.0, 'std':1e-2}))\nrelu1_vggx = brew.relu(model, conv1_vggx, 'relu1_vggx')\ninst1_vggx = brew.lrn(model,relu1_vggx,'inst1_vggx',size = 5)\npool1_vggx = brew.max_pool(model, inst1_vggx, 'pool1_vggx', kernel=3, stride=2)\n</code></pre>\n<p>brew.lrn is the layer in which<br>\nCUDNN_ENFORCE(<br>\ncudnnSetLRNDescriptor(norm_desc_, size_, alpha_, beta_, bias_));</p>\n<p>is failing.</p>\n<p>I looked at the parameter they seem to be correct to me.</p>\n<p>How to workaround this problem?</p>", "body_text": "Original python traceback for operator 39 in network fast_style_train in exception above (most recent call last):\nFile \"styleCaffe.py\", line 284, in \nFile \"styleCaffe.py\", line 250, in main\nFile \"styleCaffe.py\", line 126, in styleNetModelDef\nFile \"styleCaffe.py\", line 68, in customVGGY\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/brew.py\", line 121, in scope_wrapper\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/helpers/normalization.py\", line 43, in lrn\nTraceback (most recent call last):\nFile \"styleCaffe.py\", line 284, in \nmain()\nFile \"styleCaffe.py\", line 260, in main\nworkspace.CreateNet(train_model.net, overwrite=True)\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py\", line 166, in CreateNet\nStringifyProto(net), overwrite,\nFile \"/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py\", line 192, in CallWithExceptionIntercept\nreturn func(*args, **kwargs)\nRuntimeError: [enforce fail at local_response_normalization_op_cudnn.cc:39] status == CUDNN_STATUS_SUCCESS. 3 vs 0. , Error at: /home/prasanna/Installations/caffe2/caffe2/operators/local_response_normalization_op_cudnn.cc:39: CUDNN_STATUS_BAD_PARAM\nI am facing the error of Bad parameters while creating the LRN Layer. I have defined the layer in the following way:\nconv1_vggx = brew.conv(model, data, 'conv1_vggx', 3, 96,kernel= 7,stride=2,weight_init=('GaussianFill',{'mean':0.0, 'std':1e-2}))\nrelu1_vggx = brew.relu(model, conv1_vggx, 'relu1_vggx')\ninst1_vggx = brew.lrn(model,relu1_vggx,'inst1_vggx',size = 5)\npool1_vggx = brew.max_pool(model, inst1_vggx, 'pool1_vggx', kernel=3, stride=2)\n\nbrew.lrn is the layer in which\nCUDNN_ENFORCE(\ncudnnSetLRNDescriptor(norm_desc_, size_, alpha_, beta_, bias_));\nis failing.\nI looked at the parameter they seem to be correct to me.\nHow to workaround this problem?", "body": "Original python traceback for operator 39 in network `fast_style_train` in exception above (most recent call last):\r\n  File \"styleCaffe.py\", line 284, in <module>\r\n  File \"styleCaffe.py\", line 250, in main\r\n  File \"styleCaffe.py\", line 126, in styleNetModelDef\r\n  File \"styleCaffe.py\", line 68, in customVGGY\r\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/brew.py\", line 121, in scope_wrapper\r\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/helpers/normalization.py\", line 43, in lrn\r\nTraceback (most recent call last):\r\n  File \"styleCaffe.py\", line 284, in <module>\r\n    main()\r\n  File \"styleCaffe.py\", line 260, in main\r\n    workspace.CreateNet(train_model.net, overwrite=True)\r\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py\", line 166, in CreateNet\r\n    StringifyProto(net), overwrite,\r\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/workspace.py\", line 192, in CallWithExceptionIntercept\r\n    return func(*args, **kwargs)\r\nRuntimeError: [enforce fail at local_response_normalization_op_cudnn.cc:39] status == CUDNN_STATUS_SUCCESS. 3 vs 0. , Error at: /home/prasanna/Installations/caffe2/caffe2/operators/local_response_normalization_op_cudnn.cc:39: CUDNN_STATUS_BAD_PARAM \r\n\r\nI am facing the error of Bad parameters while creating the LRN Layer. I have defined the layer in the following way:\r\n\r\n    conv1_vggx = brew.conv(model, data, 'conv1_vggx', 3, 96,kernel= 7,stride=2,weight_init=('GaussianFill',{'mean':0.0, 'std':1e-2}))\r\n    relu1_vggx = brew.relu(model, conv1_vggx, 'relu1_vggx')\r\n    inst1_vggx = brew.lrn(model,relu1_vggx,'inst1_vggx',size = 5)\r\n    pool1_vggx = brew.max_pool(model, inst1_vggx, 'pool1_vggx', kernel=3, stride=2)\r\n\r\n\r\nbrew.lrn is the layer in which    \r\nCUDNN_ENFORCE(\r\n        cudnnSetLRNDescriptor(norm_desc_, size_, alpha_, beta_, bias_));\r\n\r\nis failing.\r\n\r\nI looked at the parameter they seem to be correct to me.\r\n\r\nHow to workaround this problem?\r\n"}