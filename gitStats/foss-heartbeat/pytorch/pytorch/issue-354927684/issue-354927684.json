{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10979", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10979/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10979/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10979/events", "html_url": "https://github.com/pytorch/pytorch/issues/10979", "id": 354927684, "node_id": "MDU6SXNzdWUzNTQ5Mjc2ODQ=", "number": 10979, "title": "Dataloader behavior changed in 0.4.1", "user": {"login": "zcqian", "id": 7196478, "node_id": "MDQ6VXNlcjcxOTY0Nzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7196478?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zcqian", "html_url": "https://github.com/zcqian", "followers_url": "https://api.github.com/users/zcqian/followers", "following_url": "https://api.github.com/users/zcqian/following{/other_user}", "gists_url": "https://api.github.com/users/zcqian/gists{/gist_id}", "starred_url": "https://api.github.com/users/zcqian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zcqian/subscriptions", "organizations_url": "https://api.github.com/users/zcqian/orgs", "repos_url": "https://api.github.com/users/zcqian/repos", "events_url": "https://api.github.com/users/zcqian/events{/privacy}", "received_events_url": "https://api.github.com/users/zcqian/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-28T22:28:36Z", "updated_at": "2018-08-29T01:37:20Z", "closed_at": "2018-08-29T01:37:06Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>Given the same random seed, <code>DataLoader</code> shuffles differently in version 0.4.1 (and in git HEAD). It was consistent across versions 0.3.0, 0.3.1, and 0.4.0.</p>\n<p>If this is the intended behavior, please close the issue, thanks.</p>\n<h2>Code example</h2>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">from</span> torch.utils.data <span class=\"pl-k\">import</span> DataLoader, TensorDataset\n\ntorch.manual_seed(<span class=\"pl-c1\">10001</span>)\n\nX <span class=\"pl-k\">=</span> torch.rand(<span class=\"pl-c1\">100</span>)\ny <span class=\"pl-k\">=</span> torch.LongTensor(<span class=\"pl-c1\">100</span>).random_(<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">10</span>)\n\ndataloader <span class=\"pl-k\">=</span> DataLoader(TensorDataset(X, y), <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">5</span>, <span class=\"pl-v\">shuffle</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n\n<span class=\"pl-k\">for</span> batch_idx, (data, target) <span class=\"pl-k\">in</span> <span class=\"pl-c1\">enumerate</span>(dataloader):\n    <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Batch: <span class=\"pl-c1\">%2d</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">%</span> batch_idx, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Target:<span class=\"pl-pds\">\"</span></span>, target.numpy())\n\n<span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>PyTorch:<span class=\"pl-pds\">\"</span></span>, torch.<span class=\"pl-c1\">__version__</span>)</pre></div>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source): conda</li>\n<li>OS: macOS 10.14</li>\n<li>PyTorch version: 0.4.1</li>\n<li>Python version: Python 3.6.6 |Anaconda, Inc.| (default, Jun 28 2018, 11:07:29)</li>\n</ul>", "body_text": "Issue description\nGiven the same random seed, DataLoader shuffles differently in version 0.4.1 (and in git HEAD). It was consistent across versions 0.3.0, 0.3.1, and 0.4.0.\nIf this is the intended behavior, please close the issue, thanks.\nCode example\nimport torch\nfrom torch.utils.data import DataLoader, TensorDataset\n\ntorch.manual_seed(10001)\n\nX = torch.rand(100)\ny = torch.LongTensor(100).random_(0, 10)\n\ndataloader = DataLoader(TensorDataset(X, y), batch_size=5, shuffle=True)\n\nfor batch_idx, (data, target) in enumerate(dataloader):\n    print(\"Batch: %2d\" % batch_idx, \"Target:\", target.numpy())\n\nprint(\"PyTorch:\", torch.__version__)\nSystem Info\n\nPyTorch or Caffe2: PyTorch\nHow you installed PyTorch (conda, pip, source): conda\nOS: macOS 10.14\nPyTorch version: 0.4.1\nPython version: Python 3.6.6 |Anaconda, Inc.| (default, Jun 28 2018, 11:07:29)", "body": "## Issue description\r\n\r\nGiven the same random seed, `DataLoader` shuffles differently in version 0.4.1 (and in git HEAD). It was consistent across versions 0.3.0, 0.3.1, and 0.4.0.\r\n\r\nIf this is the intended behavior, please close the issue, thanks.\r\n\r\n## Code example\r\n```py\r\nimport torch\r\nfrom torch.utils.data import DataLoader, TensorDataset\r\n\r\ntorch.manual_seed(10001)\r\n\r\nX = torch.rand(100)\r\ny = torch.LongTensor(100).random_(0, 10)\r\n\r\ndataloader = DataLoader(TensorDataset(X, y), batch_size=5, shuffle=True)\r\n\r\nfor batch_idx, (data, target) in enumerate(dataloader):\r\n    print(\"Batch: %2d\" % batch_idx, \"Target:\", target.numpy())\r\n\r\nprint(\"PyTorch:\", torch.__version__)\r\n```\r\n## System Info\r\n- PyTorch or Caffe2: PyTorch\r\n- How you installed PyTorch (conda, pip, source): conda\r\n- OS: macOS 10.14\r\n- PyTorch version: 0.4.1\r\n- Python version: Python 3.6.6 |Anaconda, Inc.| (default, Jun 28 2018, 11:07:29) "}