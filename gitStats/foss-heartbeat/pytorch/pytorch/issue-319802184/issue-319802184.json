{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7231", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7231/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7231/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7231/events", "html_url": "https://github.com/pytorch/pytorch/issues/7231", "id": 319802184, "node_id": "MDU6SXNzdWUzMTk4MDIxODQ=", "number": 7231, "title": "device = torch.device(\"cuda\" if args.cuda else \"cpu\") AttributeError: 'module' object has no attribute 'device'", "user": {"login": "pradeephike", "id": 29882389, "node_id": "MDQ6VXNlcjI5ODgyMzg5", "avatar_url": "https://avatars2.githubusercontent.com/u/29882389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pradeephike", "html_url": "https://github.com/pradeephike", "followers_url": "https://api.github.com/users/pradeephike/followers", "following_url": "https://api.github.com/users/pradeephike/following{/other_user}", "gists_url": "https://api.github.com/users/pradeephike/gists{/gist_id}", "starred_url": "https://api.github.com/users/pradeephike/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pradeephike/subscriptions", "organizations_url": "https://api.github.com/users/pradeephike/orgs", "repos_url": "https://api.github.com/users/pradeephike/repos", "events_url": "https://api.github.com/users/pradeephike/events{/privacy}", "received_events_url": "https://api.github.com/users/pradeephike/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-03T06:36:47Z", "updated_at": "2018-05-03T06:50:53Z", "closed_at": "2018-05-03T06:50:53Z", "author_association": "NONE", "body_html": "<p>Hi ,</p>\n<p>I am trying to train the fast_neural_style repo.<br>\nI am facing the error :<br>\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")<br>\nAttributeError: 'module' object has no attribute 'device'</p>\n<p>Traceback :<br>\nTraceback (most recent call last):<br>\nFile \"neural_style.py\", line 239, in <br>\nmain()<br>\nFile \"neural_style.py\", line 233, in main<br>\ntrain(args)<br>\nFile \"neural_style.py\", line 32, in train<br>\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")<br>\nAttributeError: 'module' object has no attribute 'device'</p>\n<p>Below is the piece of code in which I am facing this error:</p>\n<p>def train(args):<br>\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")</p>\n<pre><code>np.random.seed(args.seed)\ntorch.manual_seed(args.seed)\n\ntransform = transforms.Compose([\n    transforms.Resize(args.image_size),\n    transforms.CenterCrop(args.image_size),\n    transforms.ToTensor(),\n    transforms.Lambda(lambda x: x.mul(255))\n])\ntrain_dataset = datasets.ImageFolder(args.dataset, transform)\ntrain_loader = DataLoader(train_dataset, batch_size=args.batch_size)\n\ntransformer = TransformerNet().to(device)\noptimizer = Adam(transformer.parameters(), args.lr)\nmse_loss = torch.nn.MSELoss()\n\nvgg = Vgg16(requires_grad=False).to(device)\nstyle_transform = transforms.Compose([\n    transforms.ToTensor(),\n    transforms.Lambda(lambda x: x.mul(255))\n])\nstyle = utils.load_image(args.style_image, size=args.style_size)\nstyle = style_transform(style)\nstyle = style.repeat(args.batch_size, 1, 1, 1).to(device)\n\nfeatures_style = vgg(utils.normalize_batch(style))\ngram_style = [utils.gram_matrix(y) for y in features_style]\n</code></pre>", "body_text": "Hi ,\nI am trying to train the fast_neural_style repo.\nI am facing the error :\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")\nAttributeError: 'module' object has no attribute 'device'\nTraceback :\nTraceback (most recent call last):\nFile \"neural_style.py\", line 239, in \nmain()\nFile \"neural_style.py\", line 233, in main\ntrain(args)\nFile \"neural_style.py\", line 32, in train\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")\nAttributeError: 'module' object has no attribute 'device'\nBelow is the piece of code in which I am facing this error:\ndef train(args):\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")\nnp.random.seed(args.seed)\ntorch.manual_seed(args.seed)\n\ntransform = transforms.Compose([\n    transforms.Resize(args.image_size),\n    transforms.CenterCrop(args.image_size),\n    transforms.ToTensor(),\n    transforms.Lambda(lambda x: x.mul(255))\n])\ntrain_dataset = datasets.ImageFolder(args.dataset, transform)\ntrain_loader = DataLoader(train_dataset, batch_size=args.batch_size)\n\ntransformer = TransformerNet().to(device)\noptimizer = Adam(transformer.parameters(), args.lr)\nmse_loss = torch.nn.MSELoss()\n\nvgg = Vgg16(requires_grad=False).to(device)\nstyle_transform = transforms.Compose([\n    transforms.ToTensor(),\n    transforms.Lambda(lambda x: x.mul(255))\n])\nstyle = utils.load_image(args.style_image, size=args.style_size)\nstyle = style_transform(style)\nstyle = style.repeat(args.batch_size, 1, 1, 1).to(device)\n\nfeatures_style = vgg(utils.normalize_batch(style))\ngram_style = [utils.gram_matrix(y) for y in features_style]", "body": "Hi ,\r\n\r\nI am trying to train the fast_neural_style repo.\r\nI am facing the error :\r\ndevice = torch.device(\"cuda\" if args.cuda else \"cpu\")\r\nAttributeError: 'module' object has no attribute 'device'\r\n\r\nTraceback :\r\nTraceback (most recent call last):\r\n  File \"neural_style.py\", line 239, in <module>\r\n    main()\r\n  File \"neural_style.py\", line 233, in main\r\n    train(args)\r\n  File \"neural_style.py\", line 32, in train\r\n    device = torch.device(\"cuda\" if args.cuda else \"cpu\")\r\nAttributeError: 'module' object has no attribute 'device'\r\n\r\nBelow is the piece of code in which I am facing this error:\r\n\r\ndef train(args):\r\n    device = torch.device(\"cuda\" if args.cuda else \"cpu\")\r\n\r\n    np.random.seed(args.seed)\r\n    torch.manual_seed(args.seed)\r\n\r\n    transform = transforms.Compose([\r\n        transforms.Resize(args.image_size),\r\n        transforms.CenterCrop(args.image_size),\r\n        transforms.ToTensor(),\r\n        transforms.Lambda(lambda x: x.mul(255))\r\n    ])\r\n    train_dataset = datasets.ImageFolder(args.dataset, transform)\r\n    train_loader = DataLoader(train_dataset, batch_size=args.batch_size)\r\n\r\n    transformer = TransformerNet().to(device)\r\n    optimizer = Adam(transformer.parameters(), args.lr)\r\n    mse_loss = torch.nn.MSELoss()\r\n\r\n    vgg = Vgg16(requires_grad=False).to(device)\r\n    style_transform = transforms.Compose([\r\n        transforms.ToTensor(),\r\n        transforms.Lambda(lambda x: x.mul(255))\r\n    ])\r\n    style = utils.load_image(args.style_image, size=args.style_size)\r\n    style = style_transform(style)\r\n    style = style.repeat(args.batch_size, 1, 1, 1).to(device)\r\n\r\n    features_style = vgg(utils.normalize_batch(style))\r\n    gram_style = [utils.gram_matrix(y) for y in features_style]\r\n"}