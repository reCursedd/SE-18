{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6787", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6787/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6787/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6787/events", "html_url": "https://github.com/pytorch/pytorch/pull/6787", "id": 316079130, "node_id": "MDExOlB1bGxSZXF1ZXN0MTgyOTI3NzI5", "number": 6787, "title": "Let Gloo close socket, destroy() not needed for non-NCCL backend", "user": {"login": "teng-li", "id": 8120856, "node_id": "MDQ6VXNlcjgxMjA4NTY=", "avatar_url": "https://avatars2.githubusercontent.com/u/8120856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teng-li", "html_url": "https://github.com/teng-li", "followers_url": "https://api.github.com/users/teng-li/followers", "following_url": "https://api.github.com/users/teng-li/following{/other_user}", "gists_url": "https://api.github.com/users/teng-li/gists{/gist_id}", "starred_url": "https://api.github.com/users/teng-li/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teng-li/subscriptions", "organizations_url": "https://api.github.com/users/teng-li/orgs", "repos_url": "https://api.github.com/users/teng-li/repos", "events_url": "https://api.github.com/users/teng-li/events{/privacy}", "received_events_url": "https://api.github.com/users/teng-li/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-19T23:51:31Z", "updated_at": "2018-04-20T06:52:19Z", "closed_at": "2018-04-20T06:52:13Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/6787", "html_url": "https://github.com/pytorch/pytorch/pull/6787", "diff_url": "https://github.com/pytorch/pytorch/pull/6787.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/6787.patch"}, "body_html": "<p>Gloo should close the socket at destruction, destroy() is only needed for NCCL backend since CUDA runtime doesn't need to be destroyed at destructor unless specifically called. And destroy() is not needed for all other backends.</p>\n<p>This is so that we can always<br>\ninit_process_group(world_size=2)<br>\ndestroy_process_group()<br>\ninit_process_group(world_size=4)</p>\n<p>for elastic training. Tested by myself and the above code works fine.</p>", "body_text": "Gloo should close the socket at destruction, destroy() is only needed for NCCL backend since CUDA runtime doesn't need to be destroyed at destructor unless specifically called. And destroy() is not needed for all other backends.\nThis is so that we can always\ninit_process_group(world_size=2)\ndestroy_process_group()\ninit_process_group(world_size=4)\nfor elastic training. Tested by myself and the above code works fine.", "body": "Gloo should close the socket at destruction, destroy() is only needed for NCCL backend since CUDA runtime doesn't need to be destroyed at destructor unless specifically called. And destroy() is not needed for all other backends.\r\n\r\nThis is so that we can always\r\ninit_process_group(world_size=2)\r\ndestroy_process_group()\r\ninit_process_group(world_size=4)\r\n\r\nfor elastic training. Tested by myself and the above code works fine.\r\n"}