{"url": "https://api.github.com/repos/pytorch/pytorch/issues/883", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/883/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/883/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/883/events", "html_url": "https://github.com/pytorch/pytorch/issues/883", "id": 211048738, "node_id": "MDU6SXNzdWUyMTEwNDg3Mzg=", "number": 883, "title": "Import model from lua torch", "user": {"login": "KangolHsu", "id": 7868842, "node_id": "MDQ6VXNlcjc4Njg4NDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/7868842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KangolHsu", "html_url": "https://github.com/KangolHsu", "followers_url": "https://api.github.com/users/KangolHsu/followers", "following_url": "https://api.github.com/users/KangolHsu/following{/other_user}", "gists_url": "https://api.github.com/users/KangolHsu/gists{/gist_id}", "starred_url": "https://api.github.com/users/KangolHsu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KangolHsu/subscriptions", "organizations_url": "https://api.github.com/users/KangolHsu/orgs", "repos_url": "https://api.github.com/users/KangolHsu/repos", "events_url": "https://api.github.com/users/KangolHsu/events{/privacy}", "received_events_url": "https://api.github.com/users/KangolHsu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-03-01T11:07:05Z", "updated_at": "2017-03-02T03:27:00Z", "closed_at": "2017-03-01T11:32:30Z", "author_association": "NONE", "body_html": "<p>I import lua model to pytorch ,the model was printed like this:</p>\n<p>nn.Sequential {<br>\n[input -&gt; (0) -&gt; (1) -&gt; (2) -&gt; (3) -&gt; (4) -&gt; (5) -&gt; (6) -&gt; (7) -&gt; (8) -&gt; (9) -&gt; (10) -&gt; (11) -&gt; (12) -&gt; (13) -&gt; (14) -&gt; (15) -&gt; (16) -&gt; output]<br>\n(0): nn.SpatialConvolution(3 -&gt; 32, 5x5, 2, 2, 2, 2)<br>\n(1): nn.SpatialBatchNormalization<br>\n(2): nn.ReLU<br>\n(3): nn.SpatialConvolution(32 -&gt; 64, 5x5, 2, 2, 2, 2)<br>\n(4): nn.SpatialBatchNormalization<br>\n(5): nn.ReLU<br>\n(6): nn.SpatialConvolution(64 -&gt; 128, 5x5, 2, 2, 2, 2)<br>\n(7): nn.SpatialBatchNormalization<br>\n(8): nn.ReLU<br>\n(9): nn.SpatialConvolution(128 -&gt; 256, 5x5, 2, 2, 2, 2)<br>\n(10): nn.SpatialBatchNormalization<br>\n(11): nn.ReLU<br>\n(12): nn.View(-1)<br>\n(13): nn.Linear(4096 -&gt; 512)<br>\n(14): nn.BatchNormalization<br>\n(15): nn.ReLU<br>\n(16): nn.Linear(512 -&gt; 18)<br>\n}</p>\n<p>but when i test the model ,it occure error below:<br>\nInput:           inputX (FloatTensor :3<em>64</em>64)<br>\nOutput size :18</p>\n<p>(1)<br>\nencZ.forward(inputX)</p>\n<p>ERROR:<br>\nTraceback (most recent call last):<br>\nFile \"test.py\", line 74, in <br>\nZ = encZ.forward(inputX)  #  net:forward<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward<br>\nreturn self.updateOutput(input)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput<br>\ncurrentOutput = module.updateOutput(currentOutput)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/BatchNormalization.py\", line 100, in updateOutput<br>\nself._checkInputDim(input)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/BatchNormalization.py\", line 79, in _checkInputDim<br>\n'only mini-batch supported ({}D tensor), got {}D tensor instead'.format(self.nDim, input.dim()))<br>\nRuntimeError: only mini-batch supported (4D tensor), got 3D tensor instead</p>\n<p>(2)<br>\ninputX=Variable(inputX, volatile=True)<br>\nencZ.forward(inputX)</p>\n<p>ERROR:<br>\nTraceback (most recent call last):<br>\nFile \"test.py\", line 74, in <br>\nZ = encZ.forward(inputX)  #  net:forward<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward<br>\nreturn self.updateOutput(input)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput<br>\ncurrentOutput = module.updateOutput(currentOutput)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/SpatialConvolution.py\", line 96, in updateOutput<br>\nself.padW, self.padH<br>\nTypeError: FloatSpatialConvolutionMM_updateOutput received an invalid combination of arguments - got (int, Variable, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, int, int, int, int, int, int), but expected (int state, torch.FloatTensor input, torch.FloatTensor output, torch.FloatTensor weight, [torch.FloatTensor bias or None], torch.FloatTensor finput, torch.FloatTensor fgradInput, int kW, int kH, int dW, int dH, int padW, int padH)</p>\n<p>(3)<br>\nencZ.eval()<br>\nencZ.forward(inputX)</p>\n<p>ERROR:<br>\nTraceback (most recent call last):<br>\nFile \"test.py\", line 68, in <br>\nencZ.eval()<br>\nAttributeError: 'Sequential' object has no attribute 'eval'</p>\n<p>(4)<br>\nX = inputX.resize_(1, 3, 64, 64)<br>\nencZ.forward(X)</p>\n<p>ERROR:<br>\nTraceback (most recent call last):<br>\nFile \"test.py\", line 74, in <br>\nZ = encZ.forward(X)  #  net:forward<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward<br>\nreturn self.updateOutput(input)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput<br>\ncurrentOutput = module.updateOutput(currentOutput)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Linear.py\", line 44, in updateOutput<br>\nassert input.dim() == 2<br>\nAssertionError</p>\n<p>I REALLY don not kown what happen ,could you give me some clues?</p>", "body_text": "I import lua model to pytorch ,the model was printed like this:\nnn.Sequential {\n[input -> (0) -> (1) -> (2) -> (3) -> (4) -> (5) -> (6) -> (7) -> (8) -> (9) -> (10) -> (11) -> (12) -> (13) -> (14) -> (15) -> (16) -> output]\n(0): nn.SpatialConvolution(3 -> 32, 5x5, 2, 2, 2, 2)\n(1): nn.SpatialBatchNormalization\n(2): nn.ReLU\n(3): nn.SpatialConvolution(32 -> 64, 5x5, 2, 2, 2, 2)\n(4): nn.SpatialBatchNormalization\n(5): nn.ReLU\n(6): nn.SpatialConvolution(64 -> 128, 5x5, 2, 2, 2, 2)\n(7): nn.SpatialBatchNormalization\n(8): nn.ReLU\n(9): nn.SpatialConvolution(128 -> 256, 5x5, 2, 2, 2, 2)\n(10): nn.SpatialBatchNormalization\n(11): nn.ReLU\n(12): nn.View(-1)\n(13): nn.Linear(4096 -> 512)\n(14): nn.BatchNormalization\n(15): nn.ReLU\n(16): nn.Linear(512 -> 18)\n}\nbut when i test the model ,it occure error below:\nInput:           inputX (FloatTensor :36464)\nOutput size :18\n(1)\nencZ.forward(inputX)\nERROR:\nTraceback (most recent call last):\nFile \"test.py\", line 74, in \nZ = encZ.forward(inputX)  #  net:forward\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward\nreturn self.updateOutput(input)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput\ncurrentOutput = module.updateOutput(currentOutput)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/BatchNormalization.py\", line 100, in updateOutput\nself._checkInputDim(input)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/BatchNormalization.py\", line 79, in _checkInputDim\n'only mini-batch supported ({}D tensor), got {}D tensor instead'.format(self.nDim, input.dim()))\nRuntimeError: only mini-batch supported (4D tensor), got 3D tensor instead\n(2)\ninputX=Variable(inputX, volatile=True)\nencZ.forward(inputX)\nERROR:\nTraceback (most recent call last):\nFile \"test.py\", line 74, in \nZ = encZ.forward(inputX)  #  net:forward\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward\nreturn self.updateOutput(input)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput\ncurrentOutput = module.updateOutput(currentOutput)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/SpatialConvolution.py\", line 96, in updateOutput\nself.padW, self.padH\nTypeError: FloatSpatialConvolutionMM_updateOutput received an invalid combination of arguments - got (int, Variable, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, int, int, int, int, int, int), but expected (int state, torch.FloatTensor input, torch.FloatTensor output, torch.FloatTensor weight, [torch.FloatTensor bias or None], torch.FloatTensor finput, torch.FloatTensor fgradInput, int kW, int kH, int dW, int dH, int padW, int padH)\n(3)\nencZ.eval()\nencZ.forward(inputX)\nERROR:\nTraceback (most recent call last):\nFile \"test.py\", line 68, in \nencZ.eval()\nAttributeError: 'Sequential' object has no attribute 'eval'\n(4)\nX = inputX.resize_(1, 3, 64, 64)\nencZ.forward(X)\nERROR:\nTraceback (most recent call last):\nFile \"test.py\", line 74, in \nZ = encZ.forward(X)  #  net:forward\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward\nreturn self.updateOutput(input)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput\ncurrentOutput = module.updateOutput(currentOutput)\nFile \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Linear.py\", line 44, in updateOutput\nassert input.dim() == 2\nAssertionError\nI REALLY don not kown what happen ,could you give me some clues?", "body": "I import lua model to pytorch ,the model was printed like this:\r\n\r\nnn.Sequential {\r\n  [input -> (0) -> (1) -> (2) -> (3) -> (4) -> (5) -> (6) -> (7) -> (8) -> (9) -> (10) -> (11) -> (12) -> (13) -> (14) -> (15) -> (16) -> output]\r\n  (0): nn.SpatialConvolution(3 -> 32, 5x5, 2, 2, 2, 2)\r\n  (1): nn.SpatialBatchNormalization\r\n  (2): nn.ReLU\r\n  (3): nn.SpatialConvolution(32 -> 64, 5x5, 2, 2, 2, 2)\r\n  (4): nn.SpatialBatchNormalization\r\n  (5): nn.ReLU\r\n  (6): nn.SpatialConvolution(64 -> 128, 5x5, 2, 2, 2, 2)\r\n  (7): nn.SpatialBatchNormalization\r\n  (8): nn.ReLU\r\n  (9): nn.SpatialConvolution(128 -> 256, 5x5, 2, 2, 2, 2)\r\n  (10): nn.SpatialBatchNormalization\r\n  (11): nn.ReLU\r\n  (12): nn.View(-1)\r\n  (13): nn.Linear(4096 -> 512)\r\n  (14): nn.BatchNormalization\r\n  (15): nn.ReLU\r\n  (16): nn.Linear(512 -> 18)\r\n}\r\n\r\nbut when i test the model ,it occure error below:\r\nInput:           inputX (FloatTensor :3*64*64)\r\nOutput size :18\r\n\r\n(1) \r\nencZ.forward(inputX)\r\n\r\nERROR:\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 74, in <module>\r\n    Z = encZ.forward(inputX)  #  net:forward\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward\r\n    return self.updateOutput(input)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput\r\n    currentOutput = module.updateOutput(currentOutput)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/BatchNormalization.py\", line 100, in updateOutput\r\n    self._checkInputDim(input)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/BatchNormalization.py\", line 79, in _checkInputDim\r\n    'only mini-batch supported ({}D tensor), got {}D tensor instead'.format(self.nDim, input.dim()))\r\nRuntimeError: only mini-batch supported (4D tensor), got 3D tensor instead\r\n\r\n(2)\r\ninputX=Variable(inputX, volatile=True)\r\nencZ.forward(inputX)\r\n\r\nERROR:\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 74, in <module>\r\n    Z = encZ.forward(inputX)  #  net:forward\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward\r\n    return self.updateOutput(input)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput\r\n    currentOutput = module.updateOutput(currentOutput)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/SpatialConvolution.py\", line 96, in updateOutput\r\n    self.padW, self.padH\r\nTypeError: FloatSpatialConvolutionMM_updateOutput received an invalid combination of arguments - got (int, Variable, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, int, int, int, int, int, int), but expected (int state, torch.FloatTensor input, torch.FloatTensor output, torch.FloatTensor weight, [torch.FloatTensor bias or None], torch.FloatTensor finput, torch.FloatTensor fgradInput, int kW, int kH, int dW, int dH, int padW, int padH)\r\n\r\n(3)\r\nencZ.eval()\r\nencZ.forward(inputX)\r\n\r\nERROR:\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 68, in <module>\r\n    encZ.eval()\r\nAttributeError: 'Sequential' object has no attribute 'eval'\r\n\r\n(4)\r\nX = inputX.resize_(1, 3, 64, 64)\r\nencZ.forward(X)\r\n\r\nERROR:\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 74, in <module>\r\n    Z = encZ.forward(X)  #  net:forward\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Module.py\", line 33, in forward\r\n    return self.updateOutput(input)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Sequential.py\", line 36, in updateOutput\r\n    currentOutput = module.updateOutput(currentOutput)\r\n  File \"/usr/local/lib/python2.7/dist-packages/torch/legacy/nn/Linear.py\", line 44, in updateOutput\r\n    assert input.dim() == 2\r\nAssertionError\r\n\r\n\r\nI REALLY don not kown what happen ,could you give me some clues?"}