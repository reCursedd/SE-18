{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6900", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6900/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6900/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6900/events", "html_url": "https://github.com/pytorch/pytorch/issues/6900", "id": 317253927, "node_id": "MDU6SXNzdWUzMTcyNTM5Mjc=", "number": 6900, "title": "Pytorch - ONNX graph creation error (in SummaryWriter add_graph) when using Upsampling bilinear mode", "user": {"login": "mathmanu", "id": 2990503, "node_id": "MDQ6VXNlcjI5OTA1MDM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2990503?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mathmanu", "html_url": "https://github.com/mathmanu", "followers_url": "https://api.github.com/users/mathmanu/followers", "following_url": "https://api.github.com/users/mathmanu/following{/other_user}", "gists_url": "https://api.github.com/users/mathmanu/gists{/gist_id}", "starred_url": "https://api.github.com/users/mathmanu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mathmanu/subscriptions", "organizations_url": "https://api.github.com/users/mathmanu/orgs", "repos_url": "https://api.github.com/users/mathmanu/repos", "events_url": "https://api.github.com/users/mathmanu/events{/privacy}", "received_events_url": "https://api.github.com/users/mathmanu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "SsnL", "id": 5674597, "node_id": "MDQ6VXNlcjU2NzQ1OTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/5674597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SsnL", "html_url": "https://github.com/SsnL", "followers_url": "https://api.github.com/users/SsnL/followers", "following_url": "https://api.github.com/users/SsnL/following{/other_user}", "gists_url": "https://api.github.com/users/SsnL/gists{/gist_id}", "starred_url": "https://api.github.com/users/SsnL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SsnL/subscriptions", "organizations_url": "https://api.github.com/users/SsnL/orgs", "repos_url": "https://api.github.com/users/SsnL/repos", "events_url": "https://api.github.com/users/SsnL/events{/privacy}", "received_events_url": "https://api.github.com/users/SsnL/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "SsnL", "id": 5674597, "node_id": "MDQ6VXNlcjU2NzQ1OTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/5674597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SsnL", "html_url": "https://github.com/SsnL", "followers_url": "https://api.github.com/users/SsnL/followers", "following_url": "https://api.github.com/users/SsnL/following{/other_user}", "gists_url": "https://api.github.com/users/SsnL/gists{/gist_id}", "starred_url": "https://api.github.com/users/SsnL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SsnL/subscriptions", "organizations_url": "https://api.github.com/users/SsnL/orgs", "repos_url": "https://api.github.com/users/SsnL/repos", "events_url": "https://api.github.com/users/SsnL/events{/privacy}", "received_events_url": "https://api.github.com/users/SsnL/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2018-04-24T14:31:18Z", "updated_at": "2018-05-21T10:10:36Z", "closed_at": "2018-05-04T20:38:39Z", "author_association": "NONE", "body_html": "<ul>\n<li>PyTorch</li>\n<li>OS: Ubuntu 14.04</li>\n<li>PyTorch version: (0.4) nightly build 2018.04.18 from conda</li>\n<li>CUDA/cuDNN version: CUDA 8, CUDNN 7</li>\n<li>GPU models and configuration: GTX 1080 Ti</li>\n<li>Versions of any other relevant libraries: tensorboardx 1.0</li>\n</ul>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5674597\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/SsnL\">@SsnL</a>, <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1310570\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/soumith\">@soumith</a> while we are discussing Upsampling, I would like to describe the following error that I get when I try to write an ONNX graph using SummaryWriter's add_graph() function. 'nearest' Upsampling has no issue, but 'bilinear' Upsampling causes this issue.</p>\n<p>/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/nn/functional.py:1762: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.<br>\n\"See the documentation of nn.Upsample for details.\".format(mode))<br>\n=&gt; Train Epoch [1/300]: 2%|\\u258f | 1/62 [00:20&lt;20:41, 20.36s/it, DataTime=7.515 (Avg:7.515), LR=0.001, Loss=11.365 (Avg:11.365), Output=0.014 (Avg:0.014)(mIoU)]/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py:365: UserWarning: ONNX export failed on ATen operator hardtanh because torch.onnx.symbolic.hardtanh does not exist<br>\n.format(op_name, op_name))<br>\nTraceback (most recent call last):<br>\nFile \"train_segmentation.py\", line 93, in<br>\nmain_segmentation.main(cmd)<br>\nFile \"../modules/tools/main_segmentation.py\", line 192, in main<br>\ntrain_loss, train_metric, metric_name = train(args, train_dataset, train_loader, model, optimizer, epoch, train_writer, scheduler.get_lr()[0])<br>\nFile \"../modules/tools/main_segmentation.py\", line 295, in train<br>\ntrain_writer.add_graph(model, input_zero)<br>\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/tensorboardX/writer.py\", line 400, in add_graph<br>\nself.file_writer.add_graph(graph(model, input_to_model, verbose))<br>\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/tensorboardX/graph.py\", line 48, in graph<br>\ntorch.onnx._optimize_trace(trace, False)<br>\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/init.py\", line 30, in _optimize_trace<br>\ntrace.set_graph(utils._optimize_graph(trace.graph(), aten))<br>\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py\", line 95, in _optimize_graph<br>\ngraph = torch._C._jit_pass_onnx(graph, aten)<br>\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/init.py\", line 40, in _run_symbolic_function<br>\nreturn utils._run_symbolic_function(*args, **kwargs)<br>\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py\", line 368, in _run_symbolic_function<br>\nreturn fn(g, *inputs, **attrs)<br>\nTypeError: upsample_bilinear2d() got an unexpected keyword argument 'align_corners' (occurred when translating upsample_bilinear2d)</p>", "body_text": "PyTorch\nOS: Ubuntu 14.04\nPyTorch version: (0.4) nightly build 2018.04.18 from conda\nCUDA/cuDNN version: CUDA 8, CUDNN 7\nGPU models and configuration: GTX 1080 Ti\nVersions of any other relevant libraries: tensorboardx 1.0\n\n@SsnL, @soumith while we are discussing Upsampling, I would like to describe the following error that I get when I try to write an ONNX graph using SummaryWriter's add_graph() function. 'nearest' Upsampling has no issue, but 'bilinear' Upsampling causes this issue.\n/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/nn/functional.py:1762: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.\n\"See the documentation of nn.Upsample for details.\".format(mode))\n=> Train Epoch [1/300]: 2%|\\u258f | 1/62 [00:20<20:41, 20.36s/it, DataTime=7.515 (Avg:7.515), LR=0.001, Loss=11.365 (Avg:11.365), Output=0.014 (Avg:0.014)(mIoU)]/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py:365: UserWarning: ONNX export failed on ATen operator hardtanh because torch.onnx.symbolic.hardtanh does not exist\n.format(op_name, op_name))\nTraceback (most recent call last):\nFile \"train_segmentation.py\", line 93, in\nmain_segmentation.main(cmd)\nFile \"../modules/tools/main_segmentation.py\", line 192, in main\ntrain_loss, train_metric, metric_name = train(args, train_dataset, train_loader, model, optimizer, epoch, train_writer, scheduler.get_lr()[0])\nFile \"../modules/tools/main_segmentation.py\", line 295, in train\ntrain_writer.add_graph(model, input_zero)\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/tensorboardX/writer.py\", line 400, in add_graph\nself.file_writer.add_graph(graph(model, input_to_model, verbose))\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/tensorboardX/graph.py\", line 48, in graph\ntorch.onnx._optimize_trace(trace, False)\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/init.py\", line 30, in _optimize_trace\ntrace.set_graph(utils._optimize_graph(trace.graph(), aten))\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py\", line 95, in _optimize_graph\ngraph = torch._C._jit_pass_onnx(graph, aten)\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/init.py\", line 40, in _run_symbolic_function\nreturn utils._run_symbolic_function(*args, **kwargs)\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py\", line 368, in _run_symbolic_function\nreturn fn(g, *inputs, **attrs)\nTypeError: upsample_bilinear2d() got an unexpected keyword argument 'align_corners' (occurred when translating upsample_bilinear2d)", "body": "- PyTorch\r\n- OS: Ubuntu 14.04\r\n- PyTorch version: (0.4) nightly build 2018.04.18 from conda\r\n- CUDA/cuDNN version: CUDA 8, CUDNN 7\r\n- GPU models and configuration: GTX 1080 Ti\r\n- Versions of any other relevant libraries: tensorboardx 1.0\r\n\r\n@SsnL, @soumith while we are discussing Upsampling, I would like to describe the following error that I get when I try to write an ONNX graph using SummaryWriter's add_graph() function. 'nearest' Upsampling has no issue, but 'bilinear' Upsampling causes this issue.\r\n\r\n/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/nn/functional.py:1762: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.\r\n\"See the documentation of nn.Upsample for details.\".format(mode))\r\n=> Train Epoch [1/300]: 2%|\\u258f | 1/62 [00:20<20:41, 20.36s/it, DataTime=7.515 (Avg:7.515), LR=0.001, Loss=11.365 (Avg:11.365), Output=0.014 (Avg:0.014)(mIoU)]/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py:365: UserWarning: ONNX export failed on ATen operator hardtanh because torch.onnx.symbolic.hardtanh does not exist\r\n.format(op_name, op_name))\r\nTraceback (most recent call last):\r\nFile \"train_segmentation.py\", line 93, in \r\nmain_segmentation.main(cmd)\r\nFile \"../modules/tools/main_segmentation.py\", line 192, in main\r\ntrain_loss, train_metric, metric_name = train(args, train_dataset, train_loader, model, optimizer, epoch, train_writer, scheduler.get_lr()[0])\r\nFile \"../modules/tools/main_segmentation.py\", line 295, in train\r\ntrain_writer.add_graph(model, input_zero)\r\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/tensorboardX/writer.py\", line 400, in add_graph\r\nself.file_writer.add_graph(graph(model, input_to_model, verbose))\r\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/tensorboardX/graph.py\", line 48, in graph\r\ntorch.onnx._optimize_trace(trace, False)\r\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/init.py\", line 30, in _optimize_trace\r\ntrace.set_graph(utils._optimize_graph(trace.graph(), aten))\r\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py\", line 95, in _optimize_graph\r\ngraph = torch._C._jit_pass_onnx(graph, aten)\r\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/init.py\", line 40, in _run_symbolic_function\r\nreturn utils._run_symbolic_function(*args, **kwargs)\r\nFile \"/files/apps/anaconda2/envs/pytorch/lib/python3.5/site-packages/torch/onnx/utils.py\", line 368, in _run_symbolic_function\r\nreturn fn(g, *inputs, **attrs)\r\nTypeError: upsample_bilinear2d() got an unexpected keyword argument 'align_corners' (occurred when translating upsample_bilinear2d)\r\n"}