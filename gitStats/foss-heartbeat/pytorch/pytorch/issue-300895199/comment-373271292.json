{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/373271292", "html_url": "https://github.com/pytorch/pytorch/issues/5452#issuecomment-373271292", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5452", "id": 373271292, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzI3MTI5Mg==", "user": {"login": "Mabinogiysk", "id": 12441989, "node_id": "MDQ6VXNlcjEyNDQxOTg5", "avatar_url": "https://avatars1.githubusercontent.com/u/12441989?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mabinogiysk", "html_url": "https://github.com/Mabinogiysk", "followers_url": "https://api.github.com/users/Mabinogiysk/followers", "following_url": "https://api.github.com/users/Mabinogiysk/following{/other_user}", "gists_url": "https://api.github.com/users/Mabinogiysk/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mabinogiysk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mabinogiysk/subscriptions", "organizations_url": "https://api.github.com/users/Mabinogiysk/orgs", "repos_url": "https://api.github.com/users/Mabinogiysk/repos", "events_url": "https://api.github.com/users/Mabinogiysk/events{/privacy}", "received_events_url": "https://api.github.com/users/Mabinogiysk/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-15T06:10:57Z", "updated_at": "2018-03-15T06:18:38Z", "author_association": "NONE", "body_html": "<p>This is the code:</p>\n<pre><code>import torch\nimport numpy as np\n\n# Three classes\ninputs = np.random.random((1, 3, 10, 10))\nlabel = np.random.randint(0, 3, size=(1, 10, 10))\n\n# Changing some labels' id to great than 3\nlabel[0, 3, 6] = 5\nlabel[0, 3, 8] = 4\nlabel[0, 6, 8] = 6\nlabel[0, 8, 2] = 5\n\nnllloss = torch.nn.NLLLoss2d().cuda()\ninputs = torch.autograd.Variable(torch.from_numpy(inputs).float()).cuda()\nlabel = torch.autograd.Variable(torch.from_numpy(label).long()).cuda()\n\nloss = nllloss(inputs, label)\n</code></pre>\n<p>This code can run without any errors. If I remove <code>.cuda()</code>, there will be some error:</p>\n<pre><code>nllloss = torch.nn.NLLLoss2d()\ninputs = torch.autograd.Variable(torch.from_numpy(inputs).float())\nlabel = torch.autograd.Variable(torch.from_numpy(label).long())\n\nloss = nllloss(inputs, label)\n</code></pre>\n<p>outputs:</p>\n<pre><code>Assertion `cur_target &gt;= 0 &amp;&amp; cur_target &lt; n_classes' failed.  at d:\\pytorch\\pytorch\\torch\\lib\\thnn\\generic/SpatialClassNLLCriterion.c:111\n</code></pre>\n<p>And I hope the message can be more specific. I had been stuck for several days and tried to figure out what cur_target is.</p>", "body_text": "This is the code:\nimport torch\nimport numpy as np\n\n# Three classes\ninputs = np.random.random((1, 3, 10, 10))\nlabel = np.random.randint(0, 3, size=(1, 10, 10))\n\n# Changing some labels' id to great than 3\nlabel[0, 3, 6] = 5\nlabel[0, 3, 8] = 4\nlabel[0, 6, 8] = 6\nlabel[0, 8, 2] = 5\n\nnllloss = torch.nn.NLLLoss2d().cuda()\ninputs = torch.autograd.Variable(torch.from_numpy(inputs).float()).cuda()\nlabel = torch.autograd.Variable(torch.from_numpy(label).long()).cuda()\n\nloss = nllloss(inputs, label)\n\nThis code can run without any errors. If I remove .cuda(), there will be some error:\nnllloss = torch.nn.NLLLoss2d()\ninputs = torch.autograd.Variable(torch.from_numpy(inputs).float())\nlabel = torch.autograd.Variable(torch.from_numpy(label).long())\n\nloss = nllloss(inputs, label)\n\noutputs:\nAssertion `cur_target >= 0 && cur_target < n_classes' failed.  at d:\\pytorch\\pytorch\\torch\\lib\\thnn\\generic/SpatialClassNLLCriterion.c:111\n\nAnd I hope the message can be more specific. I had been stuck for several days and tried to figure out what cur_target is.", "body": "This is the code:\r\n```\r\nimport torch\r\nimport numpy as np\r\n\r\n# Three classes\r\ninputs = np.random.random((1, 3, 10, 10))\r\nlabel = np.random.randint(0, 3, size=(1, 10, 10))\r\n\r\n# Changing some labels' id to great than 3\r\nlabel[0, 3, 6] = 5\r\nlabel[0, 3, 8] = 4\r\nlabel[0, 6, 8] = 6\r\nlabel[0, 8, 2] = 5\r\n\r\nnllloss = torch.nn.NLLLoss2d().cuda()\r\ninputs = torch.autograd.Variable(torch.from_numpy(inputs).float()).cuda()\r\nlabel = torch.autograd.Variable(torch.from_numpy(label).long()).cuda()\r\n\r\nloss = nllloss(inputs, label)\r\n```\r\nThis code can run without any errors. If I remove `.cuda()`, there will be some error:\r\n```\r\nnllloss = torch.nn.NLLLoss2d()\r\ninputs = torch.autograd.Variable(torch.from_numpy(inputs).float())\r\nlabel = torch.autograd.Variable(torch.from_numpy(label).long())\r\n\r\nloss = nllloss(inputs, label)\r\n```\r\noutputs:\r\n```\r\nAssertion `cur_target >= 0 && cur_target < n_classes' failed.  at d:\\pytorch\\pytorch\\torch\\lib\\thnn\\generic/SpatialClassNLLCriterion.c:111\r\n```\r\nAnd I hope the message can be more specific. I had been stuck for several days and tried to figure out what cur_target is."}