{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/421543223", "html_url": "https://github.com/pytorch/pytorch/issues/11327#issuecomment-421543223", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11327", "id": 421543223, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTU0MzIyMw==", "user": {"login": "wangdongxuking61", "id": 9778128, "node_id": "MDQ6VXNlcjk3NzgxMjg=", "avatar_url": "https://avatars1.githubusercontent.com/u/9778128?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangdongxuking61", "html_url": "https://github.com/wangdongxuking61", "followers_url": "https://api.github.com/users/wangdongxuking61/followers", "following_url": "https://api.github.com/users/wangdongxuking61/following{/other_user}", "gists_url": "https://api.github.com/users/wangdongxuking61/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangdongxuking61/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangdongxuking61/subscriptions", "organizations_url": "https://api.github.com/users/wangdongxuking61/orgs", "repos_url": "https://api.github.com/users/wangdongxuking61/repos", "events_url": "https://api.github.com/users/wangdongxuking61/events{/privacy}", "received_events_url": "https://api.github.com/users/wangdongxuking61/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-15T09:11:59Z", "updated_at": "2018-09-15T09:13:27Z", "author_association": "NONE", "body_html": "<blockquote>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9778128\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/wangdongxuking61\">@wangdongxuking61</a> If you could give me a docker image name that can repro the issue, I can try again. In the meantime, I also would suggest a master build. Note that you may need to change a the apex code according to this patch: <a href=\"https://gist.github.com/SsnL/6427cbf04a3c5e765f7de6e0874cfb50\">https://gist.github.com/SsnL/6427cbf04a3c5e765f7de6e0874cfb50</a>, and pytorch's <code>torch/utils/data/distributed.py</code>'s import to <code>import torch.distributed.deprecated as dist</code>.</p>\n</blockquote>\n<p>As i said before, i can't reproduce the <code>shut down on second epoch</code> error.<br>\nBut I can easily reproduce the <code>ConnectionResetError: [Errno 104] Connection reset by peer</code> or <code>EOFError</code> error at the last several iterstions in 1st epoch with :</p>\n<ul>\n<li>python 3.6</li>\n<li>torch0.4.1</li>\n<li>apex/example/imagenet/main.py</li>\n</ul>\n<pre><code>python -m torch.distributed.launch --nproc_per_node=2 main.py --fp16 --arch resnet18 --epochs 90 --workers 2 --batch-size=128\n</code></pre>", "body_text": "@wangdongxuking61 If you could give me a docker image name that can repro the issue, I can try again. In the meantime, I also would suggest a master build. Note that you may need to change a the apex code according to this patch: https://gist.github.com/SsnL/6427cbf04a3c5e765f7de6e0874cfb50, and pytorch's torch/utils/data/distributed.py's import to import torch.distributed.deprecated as dist.\n\nAs i said before, i can't reproduce the shut down on second epoch error.\nBut I can easily reproduce the ConnectionResetError: [Errno 104] Connection reset by peer or EOFError error at the last several iterstions in 1st epoch with :\n\npython 3.6\ntorch0.4.1\napex/example/imagenet/main.py\n\npython -m torch.distributed.launch --nproc_per_node=2 main.py --fp16 --arch resnet18 --epochs 90 --workers 2 --batch-size=128", "body": "> @wangdongxuking61 If you could give me a docker image name that can repro the issue, I can try again. In the meantime, I also would suggest a master build. Note that you may need to change a the apex code according to this patch: https://gist.github.com/SsnL/6427cbf04a3c5e765f7de6e0874cfb50, and pytorch's `torch/utils/data/distributed.py`'s import to `import torch.distributed.deprecated as dist`.\r\n\r\nAs i said before, i can't reproduce the `shut down on second epoch` error.\r\nBut I can easily reproduce the `ConnectionResetError: [Errno 104] Connection reset by peer` or `EOFError` error at the last several iterstions in 1st epoch with :\r\n- python 3.6\r\n- torch0.4.1\r\n- apex/example/imagenet/main.py\r\n```\r\npython -m torch.distributed.launch --nproc_per_node=2 main.py --fp16 --arch resnet18 --epochs 90 --workers 2 --batch-size=128\r\n```"}