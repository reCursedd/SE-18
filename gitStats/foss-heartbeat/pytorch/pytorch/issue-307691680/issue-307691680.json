{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5942", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5942/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5942/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5942/events", "html_url": "https://github.com/pytorch/pytorch/issues/5942", "id": 307691680, "node_id": "MDU6SXNzdWUzMDc2OTE2ODA=", "number": 5942, "title": "CUDNN_STATUS_NOT_INITIALIZED when built from source", "user": {"login": "hitvoice", "id": 13765633, "node_id": "MDQ6VXNlcjEzNzY1NjMz", "avatar_url": "https://avatars1.githubusercontent.com/u/13765633?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hitvoice", "html_url": "https://github.com/hitvoice", "followers_url": "https://api.github.com/users/hitvoice/followers", "following_url": "https://api.github.com/users/hitvoice/following{/other_user}", "gists_url": "https://api.github.com/users/hitvoice/gists{/gist_id}", "starred_url": "https://api.github.com/users/hitvoice/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hitvoice/subscriptions", "organizations_url": "https://api.github.com/users/hitvoice/orgs", "repos_url": "https://api.github.com/users/hitvoice/repos", "events_url": "https://api.github.com/users/hitvoice/events{/privacy}", "received_events_url": "https://api.github.com/users/hitvoice/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-03-22T15:24:08Z", "updated_at": "2018-06-15T11:45:57Z", "closed_at": "2018-03-27T14:02:49Z", "author_association": "NONE", "body_html": "<h3>environment</h3>\n<ul>\n<li>OS: Ubuntu 16.04.3 LTS</li>\n<li>PyTorch version: 0.4.0a0+e9f144b</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Python version: 3.6.2</li>\n<li>CUDA/cuDNN version: V9.0.176/7005</li>\n<li>GPU driver version: 384.81</li>\n<li>GCC version (if compiling from source): gcc version 5.4.0 20160609</li>\n</ul>\n<h3>script</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch.nn <span class=\"pl-k\">as</span> nn\nlstm <span class=\"pl-k\">=</span> nn.LSTM(<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>)\nlstm.cuda()</pre></div>\n<h3>output</h3>\n<pre><code>---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-1-d89616d6776d&gt; in &lt;module&gt;()\n      1 import torch.nn as nn\n      2 lstm = nn.LSTM(3, 3)\n----&gt; 3 lstm.cuda()\n\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py in cuda(self, device)\n    228             Module: self\n    229         \"\"\"\n--&gt; 230         return self._apply(lambda t: t.cuda(device))\n    231 \n    232     def cpu(self):\n\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py in _apply(self, fn)\n     98     def _apply(self, fn):\n     99         ret = super(RNNBase, self)._apply(fn)\n--&gt; 100         self.flatten_parameters()\n    101         return ret\n    102 \n\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py in flatten_parameters(self)\n     91                     weight_arr, weight_stride0,\n     92                     self.input_size, rnn.get_cudnn_mode(self.mode), self.hidden_size, self.num_layers,\n---&gt; 93                     self.batch_first, bool(self.bidirectional))\n     94 \n     95             self._param_buf_size = weight_buf.size(0)\n\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\n</code></pre>\n<p>But the file <code>~/anaconda3/lib/python3.6/site-packages/torch/lib/libcudnn.so.7</code> exists, and</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">from</span> torch.backends <span class=\"pl-k\">import</span> cudnn\n<span class=\"pl-c1\">print</span>(cudnn.version())</pre></div>\n<p>gives \"7005\".</p>", "body_text": "environment\n\nOS: Ubuntu 16.04.3 LTS\nPyTorch version: 0.4.0a0+e9f144b\nHow you installed PyTorch (conda, pip, source): source\nPython version: 3.6.2\nCUDA/cuDNN version: V9.0.176/7005\nGPU driver version: 384.81\nGCC version (if compiling from source): gcc version 5.4.0 20160609\n\nscript\nimport torch.nn as nn\nlstm = nn.LSTM(3, 3)\nlstm.cuda()\noutput\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-1-d89616d6776d> in <module>()\n      1 import torch.nn as nn\n      2 lstm = nn.LSTM(3, 3)\n----> 3 lstm.cuda()\n\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py in cuda(self, device)\n    228             Module: self\n    229         \"\"\"\n--> 230         return self._apply(lambda t: t.cuda(device))\n    231 \n    232     def cpu(self):\n\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py in _apply(self, fn)\n     98     def _apply(self, fn):\n     99         ret = super(RNNBase, self)._apply(fn)\n--> 100         self.flatten_parameters()\n    101         return ret\n    102 \n\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py in flatten_parameters(self)\n     91                     weight_arr, weight_stride0,\n     92                     self.input_size, rnn.get_cudnn_mode(self.mode), self.hidden_size, self.num_layers,\n---> 93                     self.batch_first, bool(self.bidirectional))\n     94 \n     95             self._param_buf_size = weight_buf.size(0)\n\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\n\nBut the file ~/anaconda3/lib/python3.6/site-packages/torch/lib/libcudnn.so.7 exists, and\nfrom torch.backends import cudnn\nprint(cudnn.version())\ngives \"7005\".", "body": "### environment\r\n\r\n- OS: Ubuntu 16.04.3 LTS\r\n- PyTorch version: 0.4.0a0+e9f144b\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Python version: 3.6.2\r\n- CUDA/cuDNN version: V9.0.176/7005\r\n- GPU driver version: 384.81   \r\n- GCC version (if compiling from source): gcc version 5.4.0 20160609\r\n\r\n### script\r\n\r\n```python\r\nimport torch.nn as nn\r\nlstm = nn.LSTM(3, 3)\r\nlstm.cuda()\r\n```\r\n\r\n### output\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-1-d89616d6776d> in <module>()\r\n      1 import torch.nn as nn\r\n      2 lstm = nn.LSTM(3, 3)\r\n----> 3 lstm.cuda()\r\n\r\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py in cuda(self, device)\r\n    228             Module: self\r\n    229         \"\"\"\r\n--> 230         return self._apply(lambda t: t.cuda(device))\r\n    231 \r\n    232     def cpu(self):\r\n\r\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py in _apply(self, fn)\r\n     98     def _apply(self, fn):\r\n     99         ret = super(RNNBase, self)._apply(fn)\r\n--> 100         self.flatten_parameters()\r\n    101         return ret\r\n    102 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py in flatten_parameters(self)\r\n     91                     weight_arr, weight_stride0,\r\n     92                     self.input_size, rnn.get_cudnn_mode(self.mode), self.hidden_size, self.num_layers,\r\n---> 93                     self.batch_first, bool(self.bidirectional))\r\n     94 \r\n     95             self._param_buf_size = weight_buf.size(0)\r\n\r\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\r\n```\r\n\r\nBut the file `~/anaconda3/lib/python3.6/site-packages/torch/lib/libcudnn.so.7` exists, and \r\n```python\r\nfrom torch.backends import cudnn\r\nprint(cudnn.version())\r\n```\r\ngives \"7005\"."}