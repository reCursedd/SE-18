{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/392312962", "html_url": "https://github.com/pytorch/pytorch/issues/2209#issuecomment-392312962", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/2209", "id": 392312962, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjMxMjk2Mg==", "user": {"login": "linrio", "id": 16930748, "node_id": "MDQ6VXNlcjE2OTMwNzQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/16930748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/linrio", "html_url": "https://github.com/linrio", "followers_url": "https://api.github.com/users/linrio/followers", "following_url": "https://api.github.com/users/linrio/following{/other_user}", "gists_url": "https://api.github.com/users/linrio/gists{/gist_id}", "starred_url": "https://api.github.com/users/linrio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/linrio/subscriptions", "organizations_url": "https://api.github.com/users/linrio/orgs", "repos_url": "https://api.github.com/users/linrio/repos", "events_url": "https://api.github.com/users/linrio/events{/privacy}", "received_events_url": "https://api.github.com/users/linrio/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-27T08:00:42Z", "updated_at": "2018-05-27T08:01:10Z", "author_association": "NONE", "body_html": "<p>I have met the same problem by setting the loss function with  <strong>nn.BCELoss()</strong>. It throws following error:</p>\n<pre><code>/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [1,0,0], thread: [128,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [1,0,0], thread: [73,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [3,0,0], thread: [14,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [1,0,0], thread: [221,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [0,0,0], thread: [4,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [11,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [70,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [202,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [179,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [101,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [117,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [2,0,0], thread: [134,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [0,0,0], thread: [167,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor&lt;Dtype, Acctype&gt;::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references&lt;thrust::device_reference&lt;float&gt;, thrust::device_reference&lt;float&gt;, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type&gt;, Dtype = float, Acctype = float]: block: [0,0,0], thread: [137,0,0] Assertion `input &gt;= 0. &amp;&amp; input &lt;= 1.` failed.\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THC/THCCachingHostAllocator.cpp line=257 error=59 : device-side assert triggered\nTraceback (most recent call last):\n  File \"./ncf.py\", line 234, in &lt;module&gt;\n    main()\n  File \"./ncf.py\", line 204, in main\n    loss = criterion(outputs, label)\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/modules/loss.py\", line 433, in forward\n    reduce=self.reduce)\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/functional.py\", line 1483, in binary_cross_entropy\n    return torch._C._nn.binary_cross_entropy(input, target, weight, size_average, reduce)\nRuntimeError: reduce failed to synchronize: device-side assert triggered\nFinish training in 406 seconds\nENDING TIMING RUN AT 2018-05-27 01:04:36 PM\nRESULT,recommendation,1,1122,linlf,2018-05-27 12:45:54 PM\n</code></pre>\n<p>And I replace the <strong>nn.BCELoss()</strong> loss funtion by <strong>nn.BCEWithLogitsLoss()</strong>.<br>\nDone!</p>", "body_text": "I have met the same problem by setting the loss function with  nn.BCELoss(). It throws following error:\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [1,0,0], thread: [128,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [1,0,0], thread: [73,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [3,0,0], thread: [14,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [1,0,0], thread: [221,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [0,0,0], thread: [4,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [11,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [70,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [202,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [179,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [101,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [117,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [134,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [0,0,0], thread: [167,0,0] Assertion `input >= 0. && input <= 1.` failed.\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [0,0,0], thread: [137,0,0] Assertion `input >= 0. && input <= 1.` failed.\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THC/THCCachingHostAllocator.cpp line=257 error=59 : device-side assert triggered\nTraceback (most recent call last):\n  File \"./ncf.py\", line 234, in <module>\n    main()\n  File \"./ncf.py\", line 204, in main\n    loss = criterion(outputs, label)\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/modules/loss.py\", line 433, in forward\n    reduce=self.reduce)\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/functional.py\", line 1483, in binary_cross_entropy\n    return torch._C._nn.binary_cross_entropy(input, target, weight, size_average, reduce)\nRuntimeError: reduce failed to synchronize: device-side assert triggered\nFinish training in 406 seconds\nENDING TIMING RUN AT 2018-05-27 01:04:36 PM\nRESULT,recommendation,1,1122,linlf,2018-05-27 12:45:54 PM\n\nAnd I replace the nn.BCELoss() loss funtion by nn.BCEWithLogitsLoss().\nDone!", "body": "I have met the same problem by setting the loss function with  **nn.BCELoss()**. It throws following error:\r\n```\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [1,0,0], thread: [128,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [1,0,0], thread: [73,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [3,0,0], thread: [14,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [1,0,0], thread: [221,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [0,0,0], thread: [4,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [11,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [70,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [202,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [179,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [101,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [117,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [2,0,0], thread: [134,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [0,0,0], thread: [167,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\n/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THCUNN/BCECriterion.cu:30: Acctype bce_functor<Dtype, Acctype>::operator()(Tuple) [with Tuple = thrust::detail::tuple_of_iterator_references<thrust::device_reference<float>, thrust::device_reference<float>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>, Dtype = float, Acctype = float]: block: [0,0,0], thread: [137,0,0] Assertion `input >= 0. && input <= 1.` failed.\r\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1525909934016/work/aten/src/THC/THCCachingHostAllocator.cpp line=257 error=59 : device-side assert triggered\r\nTraceback (most recent call last):\r\n  File \"./ncf.py\", line 234, in <module>\r\n    main()\r\n  File \"./ncf.py\", line 204, in main\r\n    loss = criterion(outputs, label)\r\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/modules/loss.py\", line 433, in forward\r\n    reduce=self.reduce)\r\n  File \"/home/linlf/anaconda3/envs/venv3/lib/python3.6/site-packages/torch/nn/functional.py\", line 1483, in binary_cross_entropy\r\n    return torch._C._nn.binary_cross_entropy(input, target, weight, size_average, reduce)\r\nRuntimeError: reduce failed to synchronize: device-side assert triggered\r\nFinish training in 406 seconds\r\nENDING TIMING RUN AT 2018-05-27 01:04:36 PM\r\nRESULT,recommendation,1,1122,linlf,2018-05-27 12:45:54 PM\r\n```\r\nAnd I replace the **nn.BCELoss()** loss funtion by **nn.BCEWithLogitsLoss()**. \r\nDone!\r\n\r\n\r\n\r\n\r\n\r\n"}