{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/422128818", "html_url": "https://github.com/pytorch/pytorch/issues/11672#issuecomment-422128818", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11672", "id": 422128818, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjEyODgxOA==", "user": {"login": "bearpelican", "id": 980342, "node_id": "MDQ6VXNlcjk4MDM0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/980342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bearpelican", "html_url": "https://github.com/bearpelican", "followers_url": "https://api.github.com/users/bearpelican/followers", "following_url": "https://api.github.com/users/bearpelican/following{/other_user}", "gists_url": "https://api.github.com/users/bearpelican/gists{/gist_id}", "starred_url": "https://api.github.com/users/bearpelican/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bearpelican/subscriptions", "organizations_url": "https://api.github.com/users/bearpelican/orgs", "repos_url": "https://api.github.com/users/bearpelican/repos", "events_url": "https://api.github.com/users/bearpelican/events{/privacy}", "received_events_url": "https://api.github.com/users/bearpelican/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-17T18:51:40Z", "updated_at": "2018-09-17T18:51:40Z", "author_association": "NONE", "body_html": "<p>Setting <code>mode = CUDNN_BATCHNORM_SPATIAL</code> seems to fix it for my minimal example on a single machine:<br>\n<a href=\"https://gist.github.com/bearpelican/4adcadce7f0687681bc9be2324ebafc8#file-train_c10d_deadlock-py-L73\">https://gist.github.com/bearpelican/4adcadce7f0687681bc9be2324ebafc8#file-train_c10d_deadlock-py-L73</a></p>\n<p>However, when I move to 4 machines, each machine still hangs.<br>\nNot sure why it would make a difference. I'll run gdb on the child threads to see</p>", "body_text": "Setting mode = CUDNN_BATCHNORM_SPATIAL seems to fix it for my minimal example on a single machine:\nhttps://gist.github.com/bearpelican/4adcadce7f0687681bc9be2324ebafc8#file-train_c10d_deadlock-py-L73\nHowever, when I move to 4 machines, each machine still hangs.\nNot sure why it would make a difference. I'll run gdb on the child threads to see", "body": "Setting ```mode = CUDNN_BATCHNORM_SPATIAL``` seems to fix it for my minimal example on a single machine:\r\nhttps://gist.github.com/bearpelican/4adcadce7f0687681bc9be2324ebafc8#file-train_c10d_deadlock-py-L73\r\n\r\nHowever, when I move to 4 machines, each machine still hangs. \r\nNot sure why it would make a difference. I'll run gdb on the child threads to see"}