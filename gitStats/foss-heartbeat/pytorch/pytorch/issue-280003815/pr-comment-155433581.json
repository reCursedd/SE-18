{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/155433581", "pull_request_review_id": 81750717, "id": 155433581, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE1NTQzMzU4MQ==", "diff_hunk": "@@ -4224,11 +4224,13 @@ def test_serialization(self):\n         b += [(t1.storage(), t1.storage(), t2.storage())]\n         b += [a[0].storage()[0:2]]\n         for use_name in (False, True):\n-            with tempfile.NamedTemporaryFile() as f:\n-                handle = f if not use_name else f.name\n-                torch.save(b, handle)\n-                f.seek(0)\n-                c = torch.load(handle)\n+            f = tempfile.NamedTemporaryFile(delete=False)", "path": "test/test_torch.py", "position": null, "original_position": 9, "commit_id": "26b40f576dab9e70dfde71f0345c90a9d03f7d31", "original_commit_id": "4a7dfbd12c77850faa4171235b18b9b1540f3f0d", "user": {"login": "yf225", "id": 4063635, "node_id": "MDQ6VXNlcjQwNjM2MzU=", "avatar_url": "https://avatars0.githubusercontent.com/u/4063635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yf225", "html_url": "https://github.com/yf225", "followers_url": "https://api.github.com/users/yf225/followers", "following_url": "https://api.github.com/users/yf225/following{/other_user}", "gists_url": "https://api.github.com/users/yf225/gists{/gist_id}", "starred_url": "https://api.github.com/users/yf225/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yf225/subscriptions", "organizations_url": "https://api.github.com/users/yf225/orgs", "repos_url": "https://api.github.com/users/yf225/repos", "events_url": "https://api.github.com/users/yf225/events{/privacy}", "received_events_url": "https://api.github.com/users/yf225/received_events", "type": "User", "site_admin": false}, "body": "In this case we are not able to use context manager to manage the lifecycle of the file, because Windows doesn't support opening an already opened file (which we are doing in `torch.save(...)` when only file name is passed to `handle`, see https://github.com/pytorch/pytorch/blob/master/torch/serialization.py#L114)", "created_at": "2017-12-07T05:25:49Z", "updated_at": "2018-11-23T15:37:08Z", "html_url": "https://github.com/pytorch/pytorch/pull/4065#discussion_r155433581", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/4065", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/155433581"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/4065#discussion_r155433581"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/4065"}}, "body_html": "<p>In this case we are not able to use context manager to manage the lifecycle of the file, because Windows doesn't support opening an already opened file (which we are doing in <code>torch.save(...)</code> when only file name is passed to <code>handle</code>, see <a href=\"https://github.com/pytorch/pytorch/blob/master/torch/serialization.py#L114\">https://github.com/pytorch/pytorch/blob/master/torch/serialization.py#L114</a>)</p>", "body_text": "In this case we are not able to use context manager to manage the lifecycle of the file, because Windows doesn't support opening an already opened file (which we are doing in torch.save(...) when only file name is passed to handle, see https://github.com/pytorch/pytorch/blob/master/torch/serialization.py#L114)"}