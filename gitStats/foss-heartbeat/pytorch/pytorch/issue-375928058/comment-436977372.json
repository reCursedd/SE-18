{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/436977372", "html_url": "https://github.com/pytorch/pytorch/issues/13386#issuecomment-436977372", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13386", "id": 436977372, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjk3NzM3Mg==", "user": {"login": "sungbinlim", "id": 22431584, "node_id": "MDQ6VXNlcjIyNDMxNTg0", "avatar_url": "https://avatars1.githubusercontent.com/u/22431584?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sungbinlim", "html_url": "https://github.com/sungbinlim", "followers_url": "https://api.github.com/users/sungbinlim/followers", "following_url": "https://api.github.com/users/sungbinlim/following{/other_user}", "gists_url": "https://api.github.com/users/sungbinlim/gists{/gist_id}", "starred_url": "https://api.github.com/users/sungbinlim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sungbinlim/subscriptions", "organizations_url": "https://api.github.com/users/sungbinlim/orgs", "repos_url": "https://api.github.com/users/sungbinlim/repos", "events_url": "https://api.github.com/users/sungbinlim/events{/privacy}", "received_events_url": "https://api.github.com/users/sungbinlim/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-08T12:26:28Z", "updated_at": "2018-11-08T12:26:28Z", "author_association": "NONE", "body_html": "<p>This problem also occurs for <code>avg_pool1d</code>:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">shape_check</span>(<span class=\"pl-smi\">dim</span>, <span class=\"pl-smi\">width</span>):\n    device_set <span class=\"pl-k\">=</span> [<span class=\"pl-s\"><span class=\"pl-pds\">'</span>cuda:0<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>cpu<span class=\"pl-pds\">'</span></span>]\n    x_ <span class=\"pl-k\">=</span> [torch.rand((<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,dim), <span class=\"pl-v\">device</span><span class=\"pl-k\">=</span>dev) <span class=\"pl-k\">for</span> dev <span class=\"pl-k\">in</span> device_set]\n    y_ <span class=\"pl-k\">=</span> [torch.nn.functional.avg_pool1d(x, width, <span class=\"pl-v\">stride</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">1</span>, <span class=\"pl-v\">padding</span><span class=\"pl-k\">=</span>width<span class=\"pl-k\">//</span><span class=\"pl-c1\">2</span>)[<span class=\"pl-c1\">0</span>,<span class=\"pl-c1\">0</span>] <span class=\"pl-k\">for</span> x <span class=\"pl-k\">in</span> x_]\n    <span class=\"pl-c1\">print</span>(y_[<span class=\"pl-c1\">0</span>].shape, y_[<span class=\"pl-c1\">1</span>].shape)</pre></div>\n<p>Then</p>\n<pre><code>shape_check(100*500*500, 4)\nOut: torch.Size([25000000]) torch.Size([25000001])\n</code></pre>", "body_text": "This problem also occurs for avg_pool1d:\ndef shape_check(dim, width):\n    device_set = ['cuda:0', 'cpu']\n    x_ = [torch.rand((1,1,dim), device=dev) for dev in device_set]\n    y_ = [torch.nn.functional.avg_pool1d(x, width, stride=1, padding=width//2)[0,0] for x in x_]\n    print(y_[0].shape, y_[1].shape)\nThen\nshape_check(100*500*500, 4)\nOut: torch.Size([25000000]) torch.Size([25000001])", "body": "This problem also occurs for `avg_pool1d`:\r\n\r\n```python\r\ndef shape_check(dim, width):\r\n    device_set = ['cuda:0', 'cpu']\r\n    x_ = [torch.rand((1,1,dim), device=dev) for dev in device_set]\r\n    y_ = [torch.nn.functional.avg_pool1d(x, width, stride=1, padding=width//2)[0,0] for x in x_]\r\n    print(y_[0].shape, y_[1].shape)\r\n```\r\nThen \r\n```\r\nshape_check(100*500*500, 4)\r\nOut: torch.Size([25000000]) torch.Size([25000001])\r\n```"}