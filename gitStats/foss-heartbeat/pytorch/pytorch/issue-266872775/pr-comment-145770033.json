{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/145770033", "pull_request_review_id": 70620142, "id": 145770033, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0NTc3MDAzMw==", "diff_hunk": "@@ -12,6 +12,8 @@\n def is_available(tensors):\n     devices = set()\n     for tensor in tensors:\n+        if tensor.is_sparse:\n+            return False", "path": "torch/cuda/nccl.py", "position": 5, "original_position": 5, "commit_id": "2dc9a550198bb9f07e51d3ad5d996aa2ee8f60f9", "original_commit_id": "e323933c5f24a6c53ed68f474c436f84fa37d257", "user": {"login": "SsnL", "id": 5674597, "node_id": "MDQ6VXNlcjU2NzQ1OTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/5674597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SsnL", "html_url": "https://github.com/SsnL", "followers_url": "https://api.github.com/users/SsnL/followers", "following_url": "https://api.github.com/users/SsnL/following{/other_user}", "gists_url": "https://api.github.com/users/SsnL/gists{/gist_id}", "starred_url": "https://api.github.com/users/SsnL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SsnL/subscriptions", "organizations_url": "https://api.github.com/users/SsnL/orgs", "repos_url": "https://api.github.com/users/SsnL/repos", "events_url": "https://api.github.com/users/SsnL/events{/privacy}", "received_events_url": "https://api.github.com/users/SsnL/received_events", "type": "User", "site_admin": false}, "body": "My understanding is that `nccl.is_available` should be true only if NCCL can be applied to all tensors in `tensors`. It is responsibility of the user of this function to separate sparse and dense tensors. \r\n\r\nIn fact, it is currently only used in `broadcast` and `reduce_add`. In both cases, reduced tensors are already either all sparse or all dense.", "created_at": "2017-10-19T17:33:44Z", "updated_at": "2018-11-23T15:35:31Z", "html_url": "https://github.com/pytorch/pytorch/pull/3178#discussion_r145770033", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/3178", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/145770033"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/3178#discussion_r145770033"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/3178"}}, "body_html": "<p>My understanding is that <code>nccl.is_available</code> should be true only if NCCL can be applied to all tensors in <code>tensors</code>. It is responsibility of the user of this function to separate sparse and dense tensors.</p>\n<p>In fact, it is currently only used in <code>broadcast</code> and <code>reduce_add</code>. In both cases, reduced tensors are already either all sparse or all dense.</p>", "body_text": "My understanding is that nccl.is_available should be true only if NCCL can be applied to all tensors in tensors. It is responsibility of the user of this function to separate sparse and dense tensors.\nIn fact, it is currently only used in broadcast and reduce_add. In both cases, reduced tensors are already either all sparse or all dense.", "in_reply_to_id": 145746248}