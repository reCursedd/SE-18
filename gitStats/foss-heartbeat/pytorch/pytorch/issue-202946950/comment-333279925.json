{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/333279925", "html_url": "https://github.com/pytorch/pytorch/issues/580#issuecomment-333279925", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/580", "id": 333279925, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzI3OTkyNQ==", "user": {"login": "YilinLiu97", "id": 26695815, "node_id": "MDQ6VXNlcjI2Njk1ODE1", "avatar_url": "https://avatars2.githubusercontent.com/u/26695815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YilinLiu97", "html_url": "https://github.com/YilinLiu97", "followers_url": "https://api.github.com/users/YilinLiu97/followers", "following_url": "https://api.github.com/users/YilinLiu97/following{/other_user}", "gists_url": "https://api.github.com/users/YilinLiu97/gists{/gist_id}", "starred_url": "https://api.github.com/users/YilinLiu97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YilinLiu97/subscriptions", "organizations_url": "https://api.github.com/users/YilinLiu97/orgs", "repos_url": "https://api.github.com/users/YilinLiu97/repos", "events_url": "https://api.github.com/users/YilinLiu97/events{/privacy}", "received_events_url": "https://api.github.com/users/YilinLiu97/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-30T03:30:04Z", "updated_at": "2017-09-30T03:33:30Z", "author_association": "NONE", "body_html": "<p>Hi all, I think I had similar error even when I have specified the output size:</p>\n<p>File \"/Users/elaine/Desktop/YL-Net/YLNet3D.py\", line 93, in forward<br>\nde1_unpool = self.unpool_1(de_1, indices_3, output_size=size_3) #transfer of indices<br>\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 224, in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)<br>\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/modules/pooling.py\", line 371, in forward<br>\nself.padding, output_size)<br>\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/functional.py\", line 352, in max_unpool3d<br>\nreturn _functions.thnn.MaxUnpool3d.apply(input, indices, output_size, stride, padding)<br>\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/_functions/thnn/pooling.py\", line 241, in forward<br>\nctx.padding[0], ctx.padding[2], ctx.padding[1])</p>\n<p>RuntimeError: found an invalid max index 16321 (output volumes are of size 6x6x6) at /Users/soumith/code/builder/wheel/pytorch-src/torch/lib/THNN/generic/VolumetricMaxUnpooling.c:118</p>\n<p>My code:<br>\nsize_1 = x.size()<br>\nen_1 = self.encoder_1(x)<br>\nen1_maxpool,indices_1 = self.maxpool_1(en_1)</p>\n<pre><code>    size_2 = en1_maxpool.size()\n    en_2 = self.encoder_2(en1_maxpool) \n    en2_maxpool,indices_2 = self.maxpool_2(en_2)\n   \n    size_3 = en2_maxpool.size()\n    en_3 = self.encoder_3(en2_maxpool) \n    en3_maxpool,indices_3 = self.maxpool_3(en_3)\n  \n    de_1 = self.decoder_1(en3_maxpool)\n    de1_unpool = self.unpool_1(de_1, indices_3, output_size=size_3) #transfer of indices\n    merge1_3 = torch.cat((de1_unpool,en_3), 1)\n\n    de_2 = self.decoder_2(merge1_3)\n    de2_unpool = self.unpool_2(de_2, indices_2, output_size=size_2) #transfer of indices\n    merge2_2 = torch.cat((de2_unpool,en_2), 1)\n\n    de_3 = self.decoder_3(merge2_2)\n    de3_unpool = self.unpool_3(de_3, indices_1, output_size=size_1) #transfer of indices\n    merge3_1 = torch.cat((de3_unpool,en_1), 1)\n</code></pre>\n<p>Thanks in advance!!</p>", "body_text": "Hi all, I think I had similar error even when I have specified the output size:\nFile \"/Users/elaine/Desktop/YL-Net/YLNet3D.py\", line 93, in forward\nde1_unpool = self.unpool_1(de_1, indices_3, output_size=size_3) #transfer of indices\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 224, in call\nresult = self.forward(*input, **kwargs)\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/modules/pooling.py\", line 371, in forward\nself.padding, output_size)\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/functional.py\", line 352, in max_unpool3d\nreturn _functions.thnn.MaxUnpool3d.apply(input, indices, output_size, stride, padding)\nFile \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/_functions/thnn/pooling.py\", line 241, in forward\nctx.padding[0], ctx.padding[2], ctx.padding[1])\nRuntimeError: found an invalid max index 16321 (output volumes are of size 6x6x6) at /Users/soumith/code/builder/wheel/pytorch-src/torch/lib/THNN/generic/VolumetricMaxUnpooling.c:118\nMy code:\nsize_1 = x.size()\nen_1 = self.encoder_1(x)\nen1_maxpool,indices_1 = self.maxpool_1(en_1)\n    size_2 = en1_maxpool.size()\n    en_2 = self.encoder_2(en1_maxpool) \n    en2_maxpool,indices_2 = self.maxpool_2(en_2)\n   \n    size_3 = en2_maxpool.size()\n    en_3 = self.encoder_3(en2_maxpool) \n    en3_maxpool,indices_3 = self.maxpool_3(en_3)\n  \n    de_1 = self.decoder_1(en3_maxpool)\n    de1_unpool = self.unpool_1(de_1, indices_3, output_size=size_3) #transfer of indices\n    merge1_3 = torch.cat((de1_unpool,en_3), 1)\n\n    de_2 = self.decoder_2(merge1_3)\n    de2_unpool = self.unpool_2(de_2, indices_2, output_size=size_2) #transfer of indices\n    merge2_2 = torch.cat((de2_unpool,en_2), 1)\n\n    de_3 = self.decoder_3(merge2_2)\n    de3_unpool = self.unpool_3(de_3, indices_1, output_size=size_1) #transfer of indices\n    merge3_1 = torch.cat((de3_unpool,en_1), 1)\n\nThanks in advance!!", "body": "Hi all, I think I had similar error even when I have specified the output size:\r\n\r\n File \"/Users/elaine/Desktop/YL-Net/YLNet3D.py\", line 93, in forward\r\n    de1_unpool = self.unpool_1(de_1, indices_3, output_size=size_3) #transfer of indices\r\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 224, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/modules/pooling.py\", line 371, in forward\r\n    self.padding, output_size)\r\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/functional.py\", line 352, in max_unpool3d\r\n    return _functions.thnn.MaxUnpool3d.apply(input, indices, output_size, stride, padding)\r\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/torch/nn/_functions/thnn/pooling.py\", line 241, in forward\r\n    ctx.padding[0], ctx.padding[2], ctx.padding[1])\r\n\r\nRuntimeError: found an invalid max index 16321 (output volumes are of size 6x6x6) at /Users/soumith/code/builder/wheel/pytorch-src/torch/lib/THNN/generic/VolumetricMaxUnpooling.c:118\r\n\r\nMy code:\r\n         size_1 = x.size()\r\n        en_1 = self.encoder_1(x) \r\n        en1_maxpool,indices_1 = self.maxpool_1(en_1) \r\n      \r\n        size_2 = en1_maxpool.size()\r\n        en_2 = self.encoder_2(en1_maxpool) \r\n        en2_maxpool,indices_2 = self.maxpool_2(en_2)\r\n       \r\n        size_3 = en2_maxpool.size()\r\n        en_3 = self.encoder_3(en2_maxpool) \r\n        en3_maxpool,indices_3 = self.maxpool_3(en_3)\r\n      \r\n        de_1 = self.decoder_1(en3_maxpool)\r\n        de1_unpool = self.unpool_1(de_1, indices_3, output_size=size_3) #transfer of indices\r\n        merge1_3 = torch.cat((de1_unpool,en_3), 1)\r\n\r\n        de_2 = self.decoder_2(merge1_3)\r\n        de2_unpool = self.unpool_2(de_2, indices_2, output_size=size_2) #transfer of indices\r\n        merge2_2 = torch.cat((de2_unpool,en_2), 1)\r\n\r\n        de_3 = self.decoder_3(merge2_2)\r\n        de3_unpool = self.unpool_3(de_3, indices_1, output_size=size_1) #transfer of indices\r\n        merge3_1 = torch.cat((de3_unpool,en_1), 1)\r\n       \r\n        \r\nThanks in advance!!\r\n\r\n\r\n"}