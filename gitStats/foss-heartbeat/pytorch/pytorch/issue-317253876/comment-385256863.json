{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/385256863", "html_url": "https://github.com/pytorch/pytorch/pull/6899#issuecomment-385256863", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/6899", "id": 385256863, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTI1Njg2Mw==", "user": {"login": "fmassa", "id": 9110200, "node_id": "MDQ6VXNlcjkxMTAyMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9110200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmassa", "html_url": "https://github.com/fmassa", "followers_url": "https://api.github.com/users/fmassa/followers", "following_url": "https://api.github.com/users/fmassa/following{/other_user}", "gists_url": "https://api.github.com/users/fmassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmassa/subscriptions", "organizations_url": "https://api.github.com/users/fmassa/orgs", "repos_url": "https://api.github.com/users/fmassa/repos", "events_url": "https://api.github.com/users/fmassa/events{/privacy}", "received_events_url": "https://api.github.com/users/fmassa/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-29T14:51:15Z", "updated_at": "2018-04-29T14:51:15Z", "author_association": "MEMBER", "body_html": "<p>It looks like there are some tests failing</p>\n<pre><code>17:41:49 ======================================================================\n17:41:49 FAIL: test_sparse_default_std (test_nn.TestNNInit)\n17:41:49 ----------------------------------------------------------------------\n17:41:49 Traceback (most recent call last):\n17:41:49   File \"test_nn.py\", line 5124, in test_sparse_default_std\n17:41:49     assert column[column == 0].nelement() &gt;= math.ceil(sparsity * cols)\n17:41:49 AssertionError\n17:41:49 \n17:41:49 ----------------------------------------------------------------------\n</code></pre>\n<p>By <a href=\"https://github.com/pytorch/pytorch/blob/master/test/test_nn.py#L5179\">looking at the failing test</a>, I think that there is a bug in the sparsity check, and it should be <code>math.ceil(sparsity * rows)</code> instead, as in <a href=\"https://github.com/pytorch/pytorch/blob/master/torch/nn/init.py#L363\">the <code>sparse</code> implementation</a></p>\n<p>Could you verify that this is indeed the case, and fix the test?</p>", "body_text": "It looks like there are some tests failing\n17:41:49 ======================================================================\n17:41:49 FAIL: test_sparse_default_std (test_nn.TestNNInit)\n17:41:49 ----------------------------------------------------------------------\n17:41:49 Traceback (most recent call last):\n17:41:49   File \"test_nn.py\", line 5124, in test_sparse_default_std\n17:41:49     assert column[column == 0].nelement() >= math.ceil(sparsity * cols)\n17:41:49 AssertionError\n17:41:49 \n17:41:49 ----------------------------------------------------------------------\n\nBy looking at the failing test, I think that there is a bug in the sparsity check, and it should be math.ceil(sparsity * rows) instead, as in the sparse implementation\nCould you verify that this is indeed the case, and fix the test?", "body": "It looks like there are some tests failing\r\n```\r\n17:41:49 ======================================================================\r\n17:41:49 FAIL: test_sparse_default_std (test_nn.TestNNInit)\r\n17:41:49 ----------------------------------------------------------------------\r\n17:41:49 Traceback (most recent call last):\r\n17:41:49   File \"test_nn.py\", line 5124, in test_sparse_default_std\r\n17:41:49     assert column[column == 0].nelement() >= math.ceil(sparsity * cols)\r\n17:41:49 AssertionError\r\n17:41:49 \r\n17:41:49 ----------------------------------------------------------------------\r\n```\r\n\r\nBy [looking at the failing test](https://github.com/pytorch/pytorch/blob/master/test/test_nn.py#L5179), I think that there is a bug in the sparsity check, and it should be `math.ceil(sparsity * rows)` instead, as in [the `sparse` implementation](https://github.com/pytorch/pytorch/blob/master/torch/nn/init.py#L363)\r\n\r\nCould you verify that this is indeed the case, and fix the test?"}