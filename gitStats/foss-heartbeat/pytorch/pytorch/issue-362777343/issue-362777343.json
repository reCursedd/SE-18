{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11950", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11950/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11950/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11950/events", "html_url": "https://github.com/pytorch/pytorch/issues/11950", "id": 362777343, "node_id": "MDU6SXNzdWUzNjI3NzczNDM=", "number": 11950, "title": "Opencv 4 compatibility", "user": {"login": "achalshah20", "id": 9772589, "node_id": "MDQ6VXNlcjk3NzI1ODk=", "avatar_url": "https://avatars0.githubusercontent.com/u/9772589?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achalshah20", "html_url": "https://github.com/achalshah20", "followers_url": "https://api.github.com/users/achalshah20/followers", "following_url": "https://api.github.com/users/achalshah20/following{/other_user}", "gists_url": "https://api.github.com/users/achalshah20/gists{/gist_id}", "starred_url": "https://api.github.com/users/achalshah20/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achalshah20/subscriptions", "organizations_url": "https://api.github.com/users/achalshah20/orgs", "repos_url": "https://api.github.com/users/achalshah20/repos", "events_url": "https://api.github.com/users/achalshah20/events{/privacy}", "received_events_url": "https://api.github.com/users/achalshah20/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-21T21:17:53Z", "updated_at": "2018-10-26T23:26:43Z", "closed_at": "2018-10-26T23:26:43Z", "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue description</h2>\n<p>Pytorch is not compatible with opencv 4 macros</p>\n<h2>Code example</h2>\n<p>Getting errors related to opencv macros when compile with opencv 4.</p>\n<pre><code>In file included from /home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.cc:1:0:\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h: In member function \u2018bool caffe2::ImageInputOp&lt;Context&gt;::GetImageAndLabelAndInfoFromDBValue(const string&amp;, cv::Mat*, caffe2::ImageInputOp&lt;Context&gt;::PerImageArg&amp;, int, std::mt19937*)\u2019:\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:468:22: error: \u2018CV_LOAD_IMAGE_COLOR\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                      ^~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:468:44: error: \u2018CV_LOAD_IMAGE_GRAYSCALE\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                                            ^~~~~~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:543:22: error: \u2018CV_LOAD_IMAGE_COLOR\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                      ^~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:543:44: error: \u2018CV_LOAD_IMAGE_GRAYSCALE\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                                            ^~~~~~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:684:44: error: \u2018CV_BGR2GRAY\u2019 was not declared in this scope\n     cv::cvtColor(src, *img, (out_c == 1) ? CV_BGR2GRAY : CV_GRAY2BGR);\n                                            ^~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:684:58: error: \u2018CV_GRAY2BGR\u2019 was not declared in this scope\n     cv::cvtColor(src, *img, (out_c == 1) ? CV_BGR2GRAY : CV_GRAY2BGR);\n</code></pre>\n<h2>System Info</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<ul>\n<li>PyTorch or Caffe2:</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): cmake</li>\n<li>OS: linux</li>\n<li>PyTorch version: 0.4</li>\n<li>Python version: 3.6.6</li>\n<li>CUDA/cuDNN version: 10.0/7.3</li>\n<li>GPU models and configuration: nvidia titan x</li>\n<li>GCC version (if compiling from source): 6 (Doesn't work with 7.3 yet)</li>\n<li>CMake version: 3.11</li>\n<li>Versions of any other relevant libraries: N/A</li>\n</ul>\n<p>I have already sent PR a long time back <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"345399107\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/9966\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/9966/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/9966\">#9966</a>. Can someone merge this if looks good?</p>", "body_text": "Issue description\nPytorch is not compatible with opencv 4 macros\nCode example\nGetting errors related to opencv macros when compile with opencv 4.\nIn file included from /home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.cc:1:0:\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h: In member function \u2018bool caffe2::ImageInputOp<Context>::GetImageAndLabelAndInfoFromDBValue(const string&, cv::Mat*, caffe2::ImageInputOp<Context>::PerImageArg&, int, std::mt19937*)\u2019:\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:468:22: error: \u2018CV_LOAD_IMAGE_COLOR\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                      ^~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:468:44: error: \u2018CV_LOAD_IMAGE_GRAYSCALE\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                                            ^~~~~~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:543:22: error: \u2018CV_LOAD_IMAGE_COLOR\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                      ^~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:543:44: error: \u2018CV_LOAD_IMAGE_GRAYSCALE\u2019 was not declared in this scope\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\n                                            ^~~~~~~~~~~~~~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:684:44: error: \u2018CV_BGR2GRAY\u2019 was not declared in this scope\n     cv::cvtColor(src, *img, (out_c == 1) ? CV_BGR2GRAY : CV_GRAY2BGR);\n                                            ^~~~~~~~~~~\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:684:58: error: \u2018CV_GRAY2BGR\u2019 was not declared in this scope\n     cv::cvtColor(src, *img, (out_c == 1) ? CV_BGR2GRAY : CV_GRAY2BGR);\n\nSystem Info\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\n\nPyTorch or Caffe2:\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): cmake\nOS: linux\nPyTorch version: 0.4\nPython version: 3.6.6\nCUDA/cuDNN version: 10.0/7.3\nGPU models and configuration: nvidia titan x\nGCC version (if compiling from source): 6 (Doesn't work with 7.3 yet)\nCMake version: 3.11\nVersions of any other relevant libraries: N/A\n\nI have already sent PR a long time back #9966. Can someone merge this if looks good?", "body": "\r\n## Issue description\r\n\r\nPytorch is not compatible with opencv 4 macros\r\n\r\n## Code example\r\n\r\nGetting errors related to opencv macros when compile with opencv 4.\r\n```\r\nIn file included from /home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.cc:1:0:\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h: In member function \u2018bool caffe2::ImageInputOp<Context>::GetImageAndLabelAndInfoFromDBValue(const string&, cv::Mat*, caffe2::ImageInputOp<Context>::PerImageArg&, int, std::mt19937*)\u2019:\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:468:22: error: \u2018CV_LOAD_IMAGE_COLOR\u2019 was not declared in this scope\r\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\r\n                      ^~~~~~~~~~~~~~~~~~~\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:468:44: error: \u2018CV_LOAD_IMAGE_GRAYSCALE\u2019 was not declared in this scope\r\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\r\n                                            ^~~~~~~~~~~~~~~~~~~~~~~\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:543:22: error: \u2018CV_LOAD_IMAGE_COLOR\u2019 was not declared in this scope\r\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\r\n                      ^~~~~~~~~~~~~~~~~~~\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:543:44: error: \u2018CV_LOAD_IMAGE_GRAYSCALE\u2019 was not declared in this scope\r\n             color_ ? CV_LOAD_IMAGE_COLOR : CV_LOAD_IMAGE_GRAYSCALE);\r\n                                            ^~~~~~~~~~~~~~~~~~~~~~~\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:684:44: error: \u2018CV_BGR2GRAY\u2019 was not declared in this scope\r\n     cv::cvtColor(src, *img, (out_c == 1) ? CV_BGR2GRAY : CV_GRAY2BGR);\r\n                                            ^~~~~~~~~~~\r\n/home/achal/achal/opensource/pytorch/caffe2/image/image_input_op.h:684:58: error: \u2018CV_GRAY2BGR\u2019 was not declared in this scope\r\n     cv::cvtColor(src, *img, (out_c == 1) ? CV_BGR2GRAY : CV_GRAY2BGR);\r\n```\r\n\r\n\r\n## System Info\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n- PyTorch or Caffe2:\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): cmake\r\n- OS: linux\r\n- PyTorch version: 0.4\r\n- Python version: 3.6.6\r\n- CUDA/cuDNN version: 10.0/7.3\r\n- GPU models and configuration: nvidia titan x\r\n- GCC version (if compiling from source): 6 (Doesn't work with 7.3 yet)\r\n- CMake version: 3.11\r\n- Versions of any other relevant libraries: N/A\r\n\r\n\r\nI have already sent PR a long time back https://github.com/pytorch/pytorch/pull/9966. Can someone merge this if looks good? "}