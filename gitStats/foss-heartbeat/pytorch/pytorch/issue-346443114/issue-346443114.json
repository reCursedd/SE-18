{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10109", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10109/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10109/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10109/events", "html_url": "https://github.com/pytorch/pytorch/issues/10109", "id": 346443114, "node_id": "MDU6SXNzdWUzNDY0NDMxMTQ=", "number": 10109, "title": "Quadro m2000m not able to get pytorch working with gpu", "user": {"login": "theja2289", "id": 10782347, "node_id": "MDQ6VXNlcjEwNzgyMzQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/10782347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theja2289", "html_url": "https://github.com/theja2289", "followers_url": "https://api.github.com/users/theja2289/followers", "following_url": "https://api.github.com/users/theja2289/following{/other_user}", "gists_url": "https://api.github.com/users/theja2289/gists{/gist_id}", "starred_url": "https://api.github.com/users/theja2289/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theja2289/subscriptions", "organizations_url": "https://api.github.com/users/theja2289/orgs", "repos_url": "https://api.github.com/users/theja2289/repos", "events_url": "https://api.github.com/users/theja2289/events{/privacy}", "received_events_url": "https://api.github.com/users/theja2289/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-08-01T04:23:56Z", "updated_at": "2018-08-02T16:44:28Z", "closed_at": "2018-08-02T16:44:28Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9998726\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/peterjc123\">@peterjc123</a>  Could you please help me with this, also let me know if I have to compile it from source.</p>\n<p>If you have a question or would like help and support, please ask at our<br>\n<a href=\"https://discuss.pytorch.org/\" rel=\"nofollow\">forums</a>.</p>\n<h2>Issue description</h2>\n<p>I'm not able to get pytorch working with cuda.</p>\n<h2>Code example</h2>\n<p>if torch.cuda.device_count() &gt; 0:<br>\nprint(\"Let's use\", torch.cuda.device_count(), \"GPUs!\")<br>\nelse:<br>\nprint(\"no usable gpus\")</p>\n<p>import torch<br>\na = torch.cuda.FloatTensor([1.])<br>\nprint(a)</p>\n<p>Let's use 1 GPUs!<br>\ntensor([1.], device='cuda:0')</p>\n<p>it works in the above case, but something goes wrong below</p>\n<p>returns: test images, test predicted keypoints, test ground truth keypoints<br>\ntest_images, test_outputs, gt_pts = net_sample_output()</p>\n<p>print out the dimensions of the data to see if they make sense<br>\nprint(test_images.data.size())<br>\nprint(test_outputs.data.size())<br>\nprint(gt_pts.size())</p>\n<p><strong>gives the following error:</strong></p>\n<p>RuntimeError                              Traceback (most recent call last)<br>\n in ()<br>\n1 # call the above function<br>\n2 # returns: test images, test predicted keypoints, test ground truth keypoints<br>\n----&gt; 3 test_images, test_outputs, gt_pts = net_sample_output()<br>\n4<br>\n5 # print out the dimensions of the data to see if they make sense</p>\n<p> in net_sample_output()<br>\n24<br>\n25         # forward pass to get net output<br>\n---&gt; 26         output_pts = net(images)<br>\n27<br>\n28         # reshape to batch_size x 68 x 2 pts</p>\n<p>~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in <strong>call</strong>(self, *input, **kwargs)<br>\n475             result = self._slow_forward(*input, **kwargs)<br>\n476         else:<br>\n--&gt; 477             result = self.forward(*input, **kwargs)<br>\n478         for hook in self._forward_hooks.values():<br>\n479             hook_result = hook(self, input, result)</p>\n<p>~\\udacity\\P1_Facial_Keypoints\\models.py in forward(self, x)<br>\n72         ## Conv layers<br>\n73<br>\n---&gt; 74         x = self.pool(F.elu(self.conv1(x)))<br>\n75         x = self.dropout1(x)<br>\n76         #if log:</p>\n<p>~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in <strong>call</strong>(self, *input, **kwargs)<br>\n475             result = self._slow_forward(*input, **kwargs)<br>\n476         else:<br>\n--&gt; 477             result = self.forward(*input, **kwargs)<br>\n478         for hook in self._forward_hooks.values():<br>\n479             hook_result = hook(self, input, result)</p>\n<p>~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\pooling.py in forward(self, input)<br>\n140         return F.max_pool2d(input, self.kernel_size, self.stride,<br>\n141                             self.padding, self.dilation, self.ceil_mode,<br>\n--&gt; 142                             self.return_indices)<br>\n143<br>\n144</p>\n<p>~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\functional.py in max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode, return_indices)<br>\n394     See :class:<code>~torch.nn.MaxPool2d</code> for details.<br>\n395     \"\"\"<br>\n--&gt; 396     ret = torch._C._nn.max_pool2d_with_indices(input, kernel_size, stride, padding, dilation, ceil_mode)<br>\n397     return ret if return_indices else ret[0]<br>\n398</p>\n<p>RuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\\new-builder_2\\win-wheel\\pytorch\\aten\\src\\thcunn\\generic/SpatialDilatedMaxPooling.cu:152</p>\n<p>Please try to provide a minimal example to repro the bug.<br>\nError messages and stack traces are also helpful.</p>\n<h2>System Info</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<p>C:\\Users\\vpokala\\AppData\\Local\\Continuum\\anaconda3\\Lib\\site-packages<br>\n(base) \u03bb python collect_env.py<br>\nCollecting environment information...<br>\nPyTorch version: 0.4.1<br>\nIs debug build: No<br>\nCUDA used to build PyTorch: 9.0</p>\n<p>OS: Microsoft Windows 7 Professional<br>\nGCC version: Could not collect<br>\nCMake version: Could not collect</p>\n<p>Python version: 3.6<br>\nIs CUDA available: Yes<br>\nCUDA runtime version: 9.0.176<br>\nGPU models and configuration: GPU 0: Quadro M2000M<br>\nNvidia driver version: 385.54<br>\ncuDNN version: Probably one of the following:<br>\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\bin\\cudnn64_7.dll</p>\n<p>Versions of relevant libraries:<br>\n[pip] Could not collect<br>\n[conda] torch                     0.4.1<br>\n[conda] torchvision               0.2.1</p>", "body_text": "@peterjc123  Could you please help me with this, also let me know if I have to compile it from source.\nIf you have a question or would like help and support, please ask at our\nforums.\nIssue description\nI'm not able to get pytorch working with cuda.\nCode example\nif torch.cuda.device_count() > 0:\nprint(\"Let's use\", torch.cuda.device_count(), \"GPUs!\")\nelse:\nprint(\"no usable gpus\")\nimport torch\na = torch.cuda.FloatTensor([1.])\nprint(a)\nLet's use 1 GPUs!\ntensor([1.], device='cuda:0')\nit works in the above case, but something goes wrong below\nreturns: test images, test predicted keypoints, test ground truth keypoints\ntest_images, test_outputs, gt_pts = net_sample_output()\nprint out the dimensions of the data to see if they make sense\nprint(test_images.data.size())\nprint(test_outputs.data.size())\nprint(gt_pts.size())\ngives the following error:\nRuntimeError                              Traceback (most recent call last)\n in ()\n1 # call the above function\n2 # returns: test images, test predicted keypoints, test ground truth keypoints\n----> 3 test_images, test_outputs, gt_pts = net_sample_output()\n4\n5 # print out the dimensions of the data to see if they make sense\n in net_sample_output()\n24\n25         # forward pass to get net output\n---> 26         output_pts = net(images)\n27\n28         # reshape to batch_size x 68 x 2 pts\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in call(self, *input, **kwargs)\n475             result = self._slow_forward(*input, **kwargs)\n476         else:\n--> 477             result = self.forward(*input, **kwargs)\n478         for hook in self._forward_hooks.values():\n479             hook_result = hook(self, input, result)\n~\\udacity\\P1_Facial_Keypoints\\models.py in forward(self, x)\n72         ## Conv layers\n73\n---> 74         x = self.pool(F.elu(self.conv1(x)))\n75         x = self.dropout1(x)\n76         #if log:\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in call(self, *input, **kwargs)\n475             result = self._slow_forward(*input, **kwargs)\n476         else:\n--> 477             result = self.forward(*input, **kwargs)\n478         for hook in self._forward_hooks.values():\n479             hook_result = hook(self, input, result)\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\pooling.py in forward(self, input)\n140         return F.max_pool2d(input, self.kernel_size, self.stride,\n141                             self.padding, self.dilation, self.ceil_mode,\n--> 142                             self.return_indices)\n143\n144\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\functional.py in max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode, return_indices)\n394     See :class:~torch.nn.MaxPool2d for details.\n395     \"\"\"\n--> 396     ret = torch._C._nn.max_pool2d_with_indices(input, kernel_size, stride, padding, dilation, ceil_mode)\n397     return ret if return_indices else ret[0]\n398\nRuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\\new-builder_2\\win-wheel\\pytorch\\aten\\src\\thcunn\\generic/SpatialDilatedMaxPooling.cu:152\nPlease try to provide a minimal example to repro the bug.\nError messages and stack traces are also helpful.\nSystem Info\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\nC:\\Users\\vpokala\\AppData\\Local\\Continuum\\anaconda3\\Lib\\site-packages\n(base) \u03bb python collect_env.py\nCollecting environment information...\nPyTorch version: 0.4.1\nIs debug build: No\nCUDA used to build PyTorch: 9.0\nOS: Microsoft Windows 7 Professional\nGCC version: Could not collect\nCMake version: Could not collect\nPython version: 3.6\nIs CUDA available: Yes\nCUDA runtime version: 9.0.176\nGPU models and configuration: GPU 0: Quadro M2000M\nNvidia driver version: 385.54\ncuDNN version: Probably one of the following:\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\bin\\cudnn64_7.dll\nVersions of relevant libraries:\n[pip] Could not collect\n[conda] torch                     0.4.1\n[conda] torchvision               0.2.1", "body": "@peterjc123  Could you please help me with this, also let me know if I have to compile it from source. \r\n\r\nIf you have a question or would like help and support, please ask at our\r\n[forums](https://discuss.pytorch.org/).\r\n\r\n\r\n## Issue description\r\nI'm not able to get pytorch working with cuda. \r\n\r\n## Code example\r\nif torch.cuda.device_count() > 0:\r\n    print(\"Let's use\", torch.cuda.device_count(), \"GPUs!\")\r\nelse:\r\n    print(\"no usable gpus\")\r\n    \r\nimport torch\r\na = torch.cuda.FloatTensor([1.])\r\nprint(a)\r\n\r\n\r\nLet's use 1 GPUs!\r\ntensor([1.], device='cuda:0')\r\n\r\n\r\nit works in the above case, but something goes wrong below \r\n\r\nreturns: test images, test predicted keypoints, test ground truth keypoints\r\ntest_images, test_outputs, gt_pts = net_sample_output()\r\n\r\nprint out the dimensions of the data to see if they make sense\r\nprint(test_images.data.size())\r\nprint(test_outputs.data.size())\r\nprint(gt_pts.size())\r\n\r\n\r\n**gives the following error:**\r\n\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-10-07f935a80088> in <module>()\r\n      1 # call the above function\r\n      2 # returns: test images, test predicted keypoints, test ground truth keypoints\r\n----> 3 test_images, test_outputs, gt_pts = net_sample_output()\r\n      4 \r\n      5 # print out the dimensions of the data to see if they make sense\r\n\r\n<ipython-input-8-d706d278b7b4> in net_sample_output()\r\n     24 \r\n     25         # forward pass to get net output\r\n---> 26         output_pts = net(images)\r\n     27 \r\n     28         # reshape to batch_size x 68 x 2 pts\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    475             result = self._slow_forward(*input, **kwargs)\r\n    476         else:\r\n--> 477             result = self.forward(*input, **kwargs)\r\n    478         for hook in self._forward_hooks.values():\r\n    479             hook_result = hook(self, input, result)\r\n\r\n~\\udacity\\P1_Facial_Keypoints\\models.py in forward(self, x)\r\n     72         ## Conv layers\r\n     73 \r\n---> 74         x = self.pool(F.elu(self.conv1(x)))\r\n     75         x = self.dropout1(x)\r\n     76         #if log:\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    475             result = self._slow_forward(*input, **kwargs)\r\n    476         else:\r\n--> 477             result = self.forward(*input, **kwargs)\r\n    478         for hook in self._forward_hooks.values():\r\n    479             hook_result = hook(self, input, result)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\pooling.py in forward(self, input)\r\n    140         return F.max_pool2d(input, self.kernel_size, self.stride,\r\n    141                             self.padding, self.dilation, self.ceil_mode,\r\n--> 142                             self.return_indices)\r\n    143 \r\n    144 \r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\torch\\nn\\functional.py in max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode, return_indices)\r\n    394     See :class:`~torch.nn.MaxPool2d` for details.\r\n    395     \"\"\"\r\n--> 396     ret = torch._C._nn.max_pool2d_with_indices(input, kernel_size, stride, padding, dilation, ceil_mode)\r\n    397     return ret if return_indices else ret[0]\r\n    398 \r\n\r\nRuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\\new-builder_2\\win-wheel\\pytorch\\aten\\src\\thcunn\\generic/SpatialDilatedMaxPooling.cu:152\r\n\r\n\r\nPlease try to provide a minimal example to repro the bug.\r\nError messages and stack traces are also helpful.\r\n\r\n## System Info\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n\r\nC:\\Users\\vpokala\\AppData\\Local\\Continuum\\anaconda3\\Lib\\site-packages\r\n(base) \u03bb python collect_env.py\r\nCollecting environment information...\r\nPyTorch version: 0.4.1\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0\r\n\r\nOS: Microsoft Windows 7 Professional\r\nGCC version: Could not collect\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.0.176\r\nGPU models and configuration: GPU 0: Quadro M2000M\r\nNvidia driver version: 385.54\r\ncuDNN version: Probably one of the following:\r\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\bin\\cudnn64_7.dll\r\n\r\nVersions of relevant libraries:\r\n[pip] Could not collect\r\n[conda] torch                     0.4.1<pip>\r\n[conda] torchvision               0.2.1<pip>\r\n"}