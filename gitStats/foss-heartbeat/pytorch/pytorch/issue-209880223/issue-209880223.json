{"url": "https://api.github.com/repos/pytorch/pytorch/issues/838", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/838/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/838/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/838/events", "html_url": "https://github.com/pytorch/pytorch/issues/838", "id": 209880223, "node_id": "MDU6SXNzdWUyMDk4ODAyMjM=", "number": 838, "title": "expose CPU HalfTensor, fix GPU HalfTensor serialization", "user": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}, {"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-02-23T20:50:02Z", "updated_at": "2017-02-28T00:35:48Z", "closed_at": "2017-02-28T00:35:48Z", "author_association": "MEMBER", "body_html": "<p>An issue to track exposing CPU half tensors.<br>\nNote: CPU half tensors don't have math</p>\n<p>cc: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7751273\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ajbrock\">@ajbrock</a></p>\n<p>Right now, calling <code>.cpu()</code> on a <code>torch.cuda.HalfTensor</code> gives an error.</p>\n<pre><code>---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n&lt;ipython-input-8-29bf7ba9ae5b&gt; in &lt;module&gt;()\n----&gt; 1 c.cpu()\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/tensor.pyc in cpu(self)\n     48     def cpu(self):\n     49         \"\"\"Returns a CPU copy of this tensor if it's not already on the CPU\"\"\"\n---&gt; 50         return self.type(getattr(torch, self.__class__.__name__))\n     51\n     52     def double(self):\n\nAttributeError: 'module' object has no attribute 'HalfTensor'\n</code></pre>\n<p>Also, saving <code>torch.cuda.HalfTensor</code> with <code>torch.save</code> gives the error:</p>\n<pre><code>---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n&lt;ipython-input-9-ed138460cf2d&gt; in &lt;module&gt;()\n----&gt; 1 torch.save(c, 'c.pth')\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in save(obj, f, pickle_module, pickle_protocol)\n    121         f = open(f, \"wb\")\n    122     try:\n--&gt; 123         return _save(obj, f, pickle_module, pickle_protocol)\n    124     finally:\n    125         if new_fd:\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in _save(obj, f, pickle_module, pickle_protocol)\n    216         _add_to_tar(pickle_objects, tar, 'pickle')\n    217         _add_to_tar(save_tensors, tar, 'tensors')\n--&gt; 218         _add_to_tar(save_storages, tar, 'storages')\n    219\n    220\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in _add_to_tar(fn, tar_file, name)\n     29 def _add_to_tar(fn, tar_file, name):\n     30     tmp_file = tempfile.NamedTemporaryFile(delete=False)\n---&gt; 31     fn(tmp_file)\n     32     tmp_file.close()\n     33\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in save_storages(f)\n    187         for key, storage in serialized_storages.items():\n    188             location = location_tag(storage)\n--&gt; 189             storage_type = normalize_storage_type(type(storage))\n    190             pickle_module.dump((key, location, storage_type), f,\n    191                     protocol=pickle_protocol)\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in normalize_storage_type(storage_type)\n     97\n     98 def normalize_storage_type(storage_type):\n---&gt; 99     return getattr(torch, storage_type.__name__)\n    100\n    101\n\nAttributeError: 'module' object has no attribute 'HalfStorage'\n</code></pre>", "body_text": "An issue to track exposing CPU half tensors.\nNote: CPU half tensors don't have math\ncc: @ajbrock\nRight now, calling .cpu() on a torch.cuda.HalfTensor gives an error.\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-8-29bf7ba9ae5b> in <module>()\n----> 1 c.cpu()\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/tensor.pyc in cpu(self)\n     48     def cpu(self):\n     49         \"\"\"Returns a CPU copy of this tensor if it's not already on the CPU\"\"\"\n---> 50         return self.type(getattr(torch, self.__class__.__name__))\n     51\n     52     def double(self):\n\nAttributeError: 'module' object has no attribute 'HalfTensor'\n\nAlso, saving torch.cuda.HalfTensor with torch.save gives the error:\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-9-ed138460cf2d> in <module>()\n----> 1 torch.save(c, 'c.pth')\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in save(obj, f, pickle_module, pickle_protocol)\n    121         f = open(f, \"wb\")\n    122     try:\n--> 123         return _save(obj, f, pickle_module, pickle_protocol)\n    124     finally:\n    125         if new_fd:\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in _save(obj, f, pickle_module, pickle_protocol)\n    216         _add_to_tar(pickle_objects, tar, 'pickle')\n    217         _add_to_tar(save_tensors, tar, 'tensors')\n--> 218         _add_to_tar(save_storages, tar, 'storages')\n    219\n    220\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in _add_to_tar(fn, tar_file, name)\n     29 def _add_to_tar(fn, tar_file, name):\n     30     tmp_file = tempfile.NamedTemporaryFile(delete=False)\n---> 31     fn(tmp_file)\n     32     tmp_file.close()\n     33\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in save_storages(f)\n    187         for key, storage in serialized_storages.items():\n    188             location = location_tag(storage)\n--> 189             storage_type = normalize_storage_type(type(storage))\n    190             pickle_module.dump((key, location, storage_type), f,\n    191                     protocol=pickle_protocol)\n\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in normalize_storage_type(storage_type)\n     97\n     98 def normalize_storage_type(storage_type):\n---> 99     return getattr(torch, storage_type.__name__)\n    100\n    101\n\nAttributeError: 'module' object has no attribute 'HalfStorage'", "body": "An issue to track exposing CPU half tensors.\r\nNote: CPU half tensors don't have math\r\n\r\ncc: @ajbrock\r\n\r\nRight now, calling `.cpu()` on a `torch.cuda.HalfTensor` gives an error.\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-8-29bf7ba9ae5b> in <module>()\r\n----> 1 c.cpu()\r\n\r\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/tensor.pyc in cpu(self)\r\n     48     def cpu(self):\r\n     49         \"\"\"Returns a CPU copy of this tensor if it's not already on the CPU\"\"\"\r\n---> 50         return self.type(getattr(torch, self.__class__.__name__))\r\n     51\r\n     52     def double(self):\r\n\r\nAttributeError: 'module' object has no attribute 'HalfTensor'\r\n```\r\n\r\nAlso, saving `torch.cuda.HalfTensor` with `torch.save` gives the error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-9-ed138460cf2d> in <module>()\r\n----> 1 torch.save(c, 'c.pth')\r\n\r\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in save(obj, f, pickle_module, pickle_protocol)\r\n    121         f = open(f, \"wb\")\r\n    122     try:\r\n--> 123         return _save(obj, f, pickle_module, pickle_protocol)\r\n    124     finally:\r\n    125         if new_fd:\r\n\r\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in _save(obj, f, pickle_module, pickle_protocol)\r\n    216         _add_to_tar(pickle_objects, tar, 'pickle')\r\n    217         _add_to_tar(save_tensors, tar, 'tensors')\r\n--> 218         _add_to_tar(save_storages, tar, 'storages')\r\n    219\r\n    220\r\n\r\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in _add_to_tar(fn, tar_file, name)\r\n     29 def _add_to_tar(fn, tar_file, name):\r\n     30     tmp_file = tempfile.NamedTemporaryFile(delete=False)\r\n---> 31     fn(tmp_file)\r\n     32     tmp_file.close()\r\n     33\r\n\r\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in save_storages(f)\r\n    187         for key, storage in serialized_storages.items():\r\n    188             location = location_tag(storage)\r\n--> 189             storage_type = normalize_storage_type(type(storage))\r\n    190             pickle_module.dump((key, location, storage_type), f,\r\n    191                     protocol=pickle_protocol)\r\n\r\n/home/fatbox/miniconda2/lib/python2.7/site-packages/torch/serialization.pyc in normalize_storage_type(storage_type)\r\n     97\r\n     98 def normalize_storage_type(storage_type):\r\n---> 99     return getattr(torch, storage_type.__name__)\r\n    100\r\n    101\r\n\r\nAttributeError: 'module' object has no attribute 'HalfStorage'\r\n```\r\n\r\n\r\n\r\n"}