{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/144695289", "pull_request_review_id": 69393406, "id": 144695289, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0NDY5NTI4OQ==", "diff_hunk": "@@ -203,16 +203,39 @@ def persistent_id(obj):\n def load(f, map_location=None, pickle_module=pickle):\n     \"\"\"Loads an object saved with :func:`torch.save` from a file.\n \n-    torch.load can dynamically remap storages to be loaded on a different device\n-    using the map_location argument. If it's a callable, it will be called with\n-    two arguments: storage and location tag. It's expected to either return a\n-    storage that's been moved to a different location, or None (and the location\n-    will be resolved using the default method). If this argument is a dict it's\n-    expected to be a mapping from location tags used in a file, to location\n-    tags of the current system.\n-\n-    By default the location tags are 'cpu' for host tensors and 'cuda:device_id'\n-    (e.g. 'cuda:2') for cuda tensors. User extensions can register their own\n+    torch.load uses python's normal unpickling facilities but treats storages,\n+    which underlie tensors, specially.  Storages are first deserialized on the\n+    cpu.  Then, by default, torch.load tries to move the storage to the device\n+    it was saved from, raising an exception if this fails because the device\n+    does not exist.  If you serialize a cuda tensor with torch.save, when you\n+    deserialize it with torch.load, it will be created on the device it was\n+    originally on from a storage that has been moved there.\n+\n+    But torch.load can also dynamically remap tensors to be loaded on a\n+    different device using the map_location argument.  To understand how this\n+    works, we have to understand how torch.load knows what device to try to\n+    move each storage to.  It knows this because torch.save saves a location\n+    tag with each storage that says what device it was on.  The builtin\n+    location tags are 'cpu' for host tensors and 'cuda:device_id'\n+    (e.g. 'cuda:2') for cuda tensors.", "path": "torch/serialization.py", "position": null, "original_position": 28, "commit_id": "d8292ee1f90e6e48a0fa00035aae533d28b888c7", "original_commit_id": "c51906a6c58d87a1c55c2fe590e4af1098f87f82", "user": {"login": "greaber", "id": 8763901, "node_id": "MDQ6VXNlcjg3NjM5MDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/8763901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/greaber", "html_url": "https://github.com/greaber", "followers_url": "https://api.github.com/users/greaber/followers", "following_url": "https://api.github.com/users/greaber/following{/other_user}", "gists_url": "https://api.github.com/users/greaber/gists{/gist_id}", "starred_url": "https://api.github.com/users/greaber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/greaber/subscriptions", "organizations_url": "https://api.github.com/users/greaber/orgs", "repos_url": "https://api.github.com/users/greaber/repos", "events_url": "https://api.github.com/users/greaber/events{/privacy}", "received_events_url": "https://api.github.com/users/greaber/received_events", "type": "User", "site_admin": false}, "body": "It seems to me if we just cut the second sentence, then it is strange to suddenly be talking about location tags.  Why are they important.  So, since you don't like the second sentence, I am moving discussion of location tags into the next paragraph, where it can be properly motivated.", "created_at": "2017-10-14T14:35:35Z", "updated_at": "2018-11-23T15:35:17Z", "html_url": "https://github.com/pytorch/pytorch/pull/3118#discussion_r144695289", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/3118", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/144695289"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/3118#discussion_r144695289"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/3118"}}, "body_html": "<p>It seems to me if we just cut the second sentence, then it is strange to suddenly be talking about location tags.  Why are they important.  So, since you don't like the second sentence, I am moving discussion of location tags into the next paragraph, where it can be properly motivated.</p>", "body_text": "It seems to me if we just cut the second sentence, then it is strange to suddenly be talking about location tags.  Why are they important.  So, since you don't like the second sentence, I am moving discussion of location tags into the next paragraph, where it can be properly motivated.", "in_reply_to_id": 144694877}