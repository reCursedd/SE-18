{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7982", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7982/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7982/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7982/events", "html_url": "https://github.com/pytorch/pytorch/issues/7982", "id": 327983722, "node_id": "MDU6SXNzdWUzMjc5ODM3MjI=", "number": 7982, "title": "RuntimeError: invalid argument 2: dimension 0 out of range of 0D tensor ", "user": {"login": "devinbostIL", "id": 19719649, "node_id": "MDQ6VXNlcjE5NzE5NjQ5", "avatar_url": "https://avatars2.githubusercontent.com/u/19719649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devinbostIL", "html_url": "https://github.com/devinbostIL", "followers_url": "https://api.github.com/users/devinbostIL/followers", "following_url": "https://api.github.com/users/devinbostIL/following{/other_user}", "gists_url": "https://api.github.com/users/devinbostIL/gists{/gist_id}", "starred_url": "https://api.github.com/users/devinbostIL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devinbostIL/subscriptions", "organizations_url": "https://api.github.com/users/devinbostIL/orgs", "repos_url": "https://api.github.com/users/devinbostIL/repos", "events_url": "https://api.github.com/users/devinbostIL/events{/privacy}", "received_events_url": "https://api.github.com/users/devinbostIL/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-05-31T03:48:37Z", "updated_at": "2018-05-31T17:48:26Z", "closed_at": "2018-05-31T16:09:09Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>Blows up with error after translate.py ran for a while. When I inspected the output file, I noticed that only some of the lines (maybe ~ 20% of them) had been randomly translated, so many lines were blank. I attempted to re-run translate.py on a smaller input file (about 8000 lines, rather than over 1,000,000 lines), and the output file was completely blank, but I got the same error.</p>\n<p>Interestingly, I did not get this error when I built a model with the same version of PyOpenNMT on a different dataset, but it's possible that something in my conda environment has changed since then.</p>\n<h2>Code example</h2>\n<p><code>(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py&gt;python preprocess.py -train_src C:\\src\\torchevere-offensive-classifier\\training\\character\\train_src.txt -train_tgt C:\\src\\torchevere-offensive-classifier\\training\\character\\train_dst.txt -valid_src C:\\src\\torchevere-offensive-classifier\\training\\character\\val_src.txt -valid_tgt C:\\src\\torchevere-offensive-classifier\\training\\character\\val_dst.txt -save_data data/character/tc-offense-classifier-character_v1 -src_seq_length 5000 -tgt_seq_length 5000</code></p>\n<p><code>(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py&gt;python train.py -data data/character/tc-offense-classifier-character_v1 -save_model tc-offense-classifier-character_v2 -gpuid 0 -layers 3 -learning_rate_decay 0.99 -epochs 100 -rnn_size 500</code></p>\n<p><code>(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py&gt;python translate.py -model C:\\src\\pyopennmt\\OpenNMT-py\\tc-offense-classifier-character_v2_acc_98.54_ppl_1.09_e93.pt -src C:\\src\\torchevere-offensive-classifier\\test.txt -output C:\\src\\torchevere-offensive-classifier\\tc-character_v2_e93.txt</code></p>\n<blockquote>\n<p>Loading model parameters.<br>\naverage src size 4.5279249898083975 7359<br>\nTraceback (most recent call last):<br>\nFile \"translate.py\", line 29, in <br>\nmain(opt)<br>\nFile \"translate.py\", line 18, in main<br>\nopt.batch_size, opt.attn_debug)<br>\nFile \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\translate\\Translator.py\", line 158, in translate<br>\nfor batch in data_iter:<br>\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\iterator.py\", line 151, in <strong>iter</strong><br>\nself.train)<br>\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\batch.py\", line 27, in <strong>init</strong><br>\nsetattr(self, name, field.process(batch, device=device, train=train))<br>\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\field.py\", line 188, in process<br>\ntensor = self.numericalize(padded, device=device, train=train)<br>\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\field.py\", line 308, in numericalize<br>\narr = self.postprocessing(arr, None, train)<br>\nFile \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\io\\TextDataset.py\", line 221, in make_src<br>\nsrc_size = max([t.size(0) for t in data])<br>\nFile \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\io\\TextDataset.py\", line 221, in <br>\nsrc_size = max([t.size(0) for t in data])<br>\nRuntimeError: invalid argument 2: dimension 0 out of range of 0D tensor at c:\\anaconda2\\conda-bld\\pytorch_1519501749874\\work\\torch\\lib\\th\\generic/THTensor.c:24</p>\n</blockquote>\n<h2>System Info</h2>\n<p><code>(pyTorchLanguage) C:\\src\\pyopennmt&gt;python collect_env.py</code></p>\n<blockquote>\n<p>Collecting environment information...<br>\nPyTorch version: 0.3.1.post2<br>\nIs debug build: No<br>\nCUDA used to build PyTorch: 9.0</p>\n<p>OS: Microsoft Windows 10 Pro<br>\nGCC version: (x86_64-posix-seh-rev0, Built by MinGW-W64 project) 5.4.0<br>\nCMake version: version 3.10.3</p>\n<p>Python version: 3.6<br>\nIs CUDA available: Yes<br>\nCUDA runtime version: 7.5.17<br>\nGPU models and configuration: Could not collect<br>\nNvidia driver version: Could not collect<br>\ncuDNN version: Could not collect</p>\n<p>Versions of relevant libraries:<br>\n[pip] Could not collect<br>\n[conda] Could not collect</p>\n</blockquote>\n<blockquote>\n<p>CuDNN is v7.0.<br>\nNvidia driver is v. 397.64.<br>\nGPU model is: Titan Xp<br>\npip 10.0.1 from <code>c:\\anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\pip (python 3.6)</code><br>\nconda 4.5.4</p>\n</blockquote>\n<p>I believe (if I remember correctly) that PyTorch was installed via <code>pip</code> (I don't remember exactly how) after pulling the latest source of PyOpenNMT from Github.</p>\n<p>Any ideas?</p>", "body_text": "Issue description\nBlows up with error after translate.py ran for a while. When I inspected the output file, I noticed that only some of the lines (maybe ~ 20% of them) had been randomly translated, so many lines were blank. I attempted to re-run translate.py on a smaller input file (about 8000 lines, rather than over 1,000,000 lines), and the output file was completely blank, but I got the same error.\nInterestingly, I did not get this error when I built a model with the same version of PyOpenNMT on a different dataset, but it's possible that something in my conda environment has changed since then.\nCode example\n(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py>python preprocess.py -train_src C:\\src\\torchevere-offensive-classifier\\training\\character\\train_src.txt -train_tgt C:\\src\\torchevere-offensive-classifier\\training\\character\\train_dst.txt -valid_src C:\\src\\torchevere-offensive-classifier\\training\\character\\val_src.txt -valid_tgt C:\\src\\torchevere-offensive-classifier\\training\\character\\val_dst.txt -save_data data/character/tc-offense-classifier-character_v1 -src_seq_length 5000 -tgt_seq_length 5000\n(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py>python train.py -data data/character/tc-offense-classifier-character_v1 -save_model tc-offense-classifier-character_v2 -gpuid 0 -layers 3 -learning_rate_decay 0.99 -epochs 100 -rnn_size 500\n(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py>python translate.py -model C:\\src\\pyopennmt\\OpenNMT-py\\tc-offense-classifier-character_v2_acc_98.54_ppl_1.09_e93.pt -src C:\\src\\torchevere-offensive-classifier\\test.txt -output C:\\src\\torchevere-offensive-classifier\\tc-character_v2_e93.txt\n\nLoading model parameters.\naverage src size 4.5279249898083975 7359\nTraceback (most recent call last):\nFile \"translate.py\", line 29, in \nmain(opt)\nFile \"translate.py\", line 18, in main\nopt.batch_size, opt.attn_debug)\nFile \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\translate\\Translator.py\", line 158, in translate\nfor batch in data_iter:\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\iterator.py\", line 151, in iter\nself.train)\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\batch.py\", line 27, in init\nsetattr(self, name, field.process(batch, device=device, train=train))\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\field.py\", line 188, in process\ntensor = self.numericalize(padded, device=device, train=train)\nFile \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\field.py\", line 308, in numericalize\narr = self.postprocessing(arr, None, train)\nFile \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\io\\TextDataset.py\", line 221, in make_src\nsrc_size = max([t.size(0) for t in data])\nFile \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\io\\TextDataset.py\", line 221, in \nsrc_size = max([t.size(0) for t in data])\nRuntimeError: invalid argument 2: dimension 0 out of range of 0D tensor at c:\\anaconda2\\conda-bld\\pytorch_1519501749874\\work\\torch\\lib\\th\\generic/THTensor.c:24\n\nSystem Info\n(pyTorchLanguage) C:\\src\\pyopennmt>python collect_env.py\n\nCollecting environment information...\nPyTorch version: 0.3.1.post2\nIs debug build: No\nCUDA used to build PyTorch: 9.0\nOS: Microsoft Windows 10 Pro\nGCC version: (x86_64-posix-seh-rev0, Built by MinGW-W64 project) 5.4.0\nCMake version: version 3.10.3\nPython version: 3.6\nIs CUDA available: Yes\nCUDA runtime version: 7.5.17\nGPU models and configuration: Could not collect\nNvidia driver version: Could not collect\ncuDNN version: Could not collect\nVersions of relevant libraries:\n[pip] Could not collect\n[conda] Could not collect\n\n\nCuDNN is v7.0.\nNvidia driver is v. 397.64.\nGPU model is: Titan Xp\npip 10.0.1 from c:\\anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\pip (python 3.6)\nconda 4.5.4\n\nI believe (if I remember correctly) that PyTorch was installed via pip (I don't remember exactly how) after pulling the latest source of PyOpenNMT from Github.\nAny ideas?", "body": "## Issue description\r\n\r\nBlows up with error after translate.py ran for a while. When I inspected the output file, I noticed that only some of the lines (maybe ~ 20% of them) had been randomly translated, so many lines were blank. I attempted to re-run translate.py on a smaller input file (about 8000 lines, rather than over 1,000,000 lines), and the output file was completely blank, but I got the same error. \r\n\r\nInterestingly, I did not get this error when I built a model with the same version of PyOpenNMT on a different dataset, but it's possible that something in my conda environment has changed since then.\r\n\r\n## Code example\r\n\r\n`(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py>python preprocess.py -train_src C:\\src\\torchevere-offensive-classifier\\training\\character\\train_src.txt -train_tgt C:\\src\\torchevere-offensive-classifier\\training\\character\\train_dst.txt -valid_src C:\\src\\torchevere-offensive-classifier\\training\\character\\val_src.txt -valid_tgt C:\\src\\torchevere-offensive-classifier\\training\\character\\val_dst.txt -save_data data/character/tc-offense-classifier-character_v1 -src_seq_length 5000 -tgt_seq_length 5000`\r\n\r\n`(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py>python train.py -data data/character/tc-offense-classifier-character_v1 -save_model tc-offense-classifier-character_v2 -gpuid 0 -layers 3 -learning_rate_decay 0.99 -epochs 100 -rnn_size 500`\r\n\r\n`(pyTorchLanguage) C:\\src\\pyopennmt\\OpenNMT-py>python translate.py -model C:\\src\\pyopennmt\\OpenNMT-py\\tc-offense-classifier-character_v2_acc_98.54_ppl_1.09_e93.pt -src C:\\src\\torchevere-offensive-classifier\\test.txt -output C:\\src\\torchevere-offensive-classifier\\tc-character_v2_e93.txt`\r\n\r\n> Loading model parameters.\r\n> average src size 4.5279249898083975 7359\r\n> Traceback (most recent call last):\r\n>   File \"translate.py\", line 29, in <module>\r\n>     main(opt)\r\n>   File \"translate.py\", line 18, in main\r\n>     opt.batch_size, opt.attn_debug)\r\n>   File \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\translate\\Translator.py\", line 158, in translate\r\n>     for batch in data_iter:\r\n>   File \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\iterator.py\", line 151, in __iter__\r\n>     self.train)\r\n>   File \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\batch.py\", line 27, in __init__\r\n>     setattr(self, name, field.process(batch, device=device, train=train))\r\n>   File \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\field.py\", line 188, in process\r\n>     tensor = self.numericalize(padded, device=device, train=train)\r\n>   File \"C:\\Anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\torchtext\\data\\field.py\", line 308, in numericalize\r\n>     arr = self.postprocessing(arr, None, train)\r\n>   File \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\io\\TextDataset.py\", line 221, in make_src\r\n>     src_size = max([t.size(0) for t in data])\r\n>   File \"C:\\src\\pyopennmt\\OpenNMT-py\\onmt\\io\\TextDataset.py\", line 221, in <listcomp>\r\n>     src_size = max([t.size(0) for t in data])\r\n> RuntimeError: invalid argument 2: dimension 0 out of range of 0D tensor at c:\\anaconda2\\conda-bld\\pytorch_1519501749874\\work\\torch\\lib\\th\\generic/THTensor.c:24\r\n\r\n## System Info\r\n`(pyTorchLanguage) C:\\src\\pyopennmt>python collect_env.py`\r\n\r\n> Collecting environment information...\r\n> PyTorch version: 0.3.1.post2\r\n> Is debug build: No\r\n> CUDA used to build PyTorch: 9.0\r\n> \r\n> OS: Microsoft Windows 10 Pro\r\n> GCC version: (x86_64-posix-seh-rev0, Built by MinGW-W64 project) 5.4.0\r\n> CMake version: version 3.10.3\r\n> \r\n> Python version: 3.6\r\n> Is CUDA available: Yes\r\n> CUDA runtime version: 7.5.17\r\n> GPU models and configuration: Could not collect\r\n> Nvidia driver version: Could not collect\r\n> cuDNN version: Could not collect\r\n> \r\n> Versions of relevant libraries:\r\n> [pip] Could not collect\r\n> [conda] Could not collect\r\n\r\n> CuDNN is v7.0.\r\n> Nvidia driver is v. 397.64.\r\n> GPU model is: Titan Xp\r\n> pip 10.0.1 from `c:\\anaconda3\\envs\\pyTorchLanguage\\lib\\site-packages\\pip (python 3.6)`\r\n> conda 4.5.4\r\n\r\nI believe (if I remember correctly) that PyTorch was installed via `pip` (I don't remember exactly how) after pulling the latest source of PyOpenNMT from Github.\r\n\r\n\r\nAny ideas?"}