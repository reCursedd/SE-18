{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/206251302", "pull_request_review_id": 141630121, "id": 206251302, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjI1MTMwMg==", "diff_hunk": "@@ -1777,8 +1777,24 @@ def multilabel_soft_margin_loss(input, target, weight=None, size_average=None,\n     \"\"\"\n     if size_average is not None or reduce is not None:\n         reduction = _Reduction.legacy_get_string(size_average, reduce)\n-    input = torch.sigmoid(input)\n-    return binary_cross_entropy(input, target, weight, None, None, reduction)\n+\n+    loss = - (target * logsigmoid(input) + (1 - target) * logsigmoid(-input))\n+\n+    if weight is not None:\n+        loss = loss * weight\n+\n+    if reduction != 'none':\n+        if reduction == 'sum':\n+            return loss.sum()\n+        else:  # elementwise_mean\n+            return loss.mean()", "path": "torch/nn/functional.py", "position": null, "original_position": 16, "commit_id": "5ae40c448843e915f45bb4a7b649718dbb555527", "original_commit_id": "f77a7b2bbb0c90f9ec9660e093f6a0e2a8579e31", "user": {"login": "weiyangfb", "id": 38509346, "node_id": "MDQ6VXNlcjM4NTA5MzQ2", "avatar_url": "https://avatars1.githubusercontent.com/u/38509346?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiyangfb", "html_url": "https://github.com/weiyangfb", "followers_url": "https://api.github.com/users/weiyangfb/followers", "following_url": "https://api.github.com/users/weiyangfb/following{/other_user}", "gists_url": "https://api.github.com/users/weiyangfb/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiyangfb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiyangfb/subscriptions", "organizations_url": "https://api.github.com/users/weiyangfb/orgs", "repos_url": "https://api.github.com/users/weiyangfb/repos", "events_url": "https://api.github.com/users/weiyangfb/events{/privacy}", "received_events_url": "https://api.github.com/users/weiyangfb/received_events", "type": "User", "site_admin": false}, "body": "The [doc](https://github.com/pytorch/pytorch/blob/bfe2aa093e17c84db863672ad446de064e47dc7e/torch/nn/modules/loss.py#L889-L894) and [test](https://github.com/pytorch/pytorch/blob/9a9a7325c6f6b7f82636b6efdd742c9d1e63584e/test/test_nn.py#L6166-L6176) suggest this should be a global mean. So yeah, the args name is confusing...", "created_at": "2018-07-30T17:10:49Z", "updated_at": "2018-11-23T15:48:22Z", "html_url": "https://github.com/pytorch/pytorch/pull/9965#discussion_r206251302", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/9965", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/206251302"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/9965#discussion_r206251302"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/9965"}}, "body_html": "<p>The <a href=\"https://github.com/pytorch/pytorch/blob/bfe2aa093e17c84db863672ad446de064e47dc7e/torch/nn/modules/loss.py#L889-L894\">doc</a> and <a href=\"https://github.com/pytorch/pytorch/blob/9a9a7325c6f6b7f82636b6efdd742c9d1e63584e/test/test_nn.py#L6166-L6176\">test</a> suggest this should be a global mean. So yeah, the args name is confusing...</p>", "body_text": "The doc and test suggest this should be a global mean. So yeah, the args name is confusing...", "in_reply_to_id": 206224913}