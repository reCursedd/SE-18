{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/436061080", "html_url": "https://github.com/pytorch/pytorch/issues/13566#issuecomment-436061080", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13566", "id": 436061080, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjA2MTA4MA==", "user": {"login": "t-vi", "id": 20787943, "node_id": "MDQ6VXNlcjIwNzg3OTQz", "avatar_url": "https://avatars2.githubusercontent.com/u/20787943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/t-vi", "html_url": "https://github.com/t-vi", "followers_url": "https://api.github.com/users/t-vi/followers", "following_url": "https://api.github.com/users/t-vi/following{/other_user}", "gists_url": "https://api.github.com/users/t-vi/gists{/gist_id}", "starred_url": "https://api.github.com/users/t-vi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/t-vi/subscriptions", "organizations_url": "https://api.github.com/users/t-vi/orgs", "repos_url": "https://api.github.com/users/t-vi/repos", "events_url": "https://api.github.com/users/t-vi/events{/privacy}", "received_events_url": "https://api.github.com/users/t-vi/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-05T22:34:26Z", "updated_at": "2018-11-05T22:34:26Z", "author_association": "CONTRIBUTOR", "body_html": "<p>This seems to be at least partially unrelated to custom ops. The following fails on master:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">import</span> torch.jit\n<span class=\"pl-k\">from</span> typing <span class=\"pl-k\">import</span> List, Tuple\n\n<span class=\"pl-en\">@torch.jit.script</span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">mytest</span>(<span class=\"pl-smi\">x</span>: List[torch.Tensor]):\n    <span class=\"pl-k\">return</span> x[<span class=\"pl-c1\">0</span>] <span class=\"pl-k\">+</span> x[<span class=\"pl-c1\">1</span>]\n\na <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">5</span>)\nb <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">5</span>)\n\n<span class=\"pl-c1\">print</span>(mytest((a, b)))\n<span class=\"pl-c1\">print</span> (mytest.graph_for((a,b)))\n\ntm <span class=\"pl-k\">=</span> torch.jit.trace(mytest,((a, b),)) <span class=\"pl-c\"><span class=\"pl-c\">#</span> fails</span>\n\n<span class=\"pl-c1\">print</span>(tm((a,b)))\n<span class=\"pl-c1\">print</span> (tm.graph_for((a,b)))</pre></div>\n<p>I have a patch that fixes this (but not the variant with <code>List[torch.Tensor]</code> replaced by <code>Tuple[torch.Tensor, torch.Tensor]</code>. Probably needs more work.</p>", "body_text": "This seems to be at least partially unrelated to custom ops. The following fails on master:\nimport torch\nimport torch.jit\nfrom typing import List, Tuple\n\n@torch.jit.script\ndef mytest(x: List[torch.Tensor]):\n    return x[0] + x[1]\n\na = torch.randn(5)\nb = torch.randn(5)\n\nprint(mytest((a, b)))\nprint (mytest.graph_for((a,b)))\n\ntm = torch.jit.trace(mytest,((a, b),)) # fails\n\nprint(tm((a,b)))\nprint (tm.graph_for((a,b)))\nI have a patch that fixes this (but not the variant with List[torch.Tensor] replaced by Tuple[torch.Tensor, torch.Tensor]. Probably needs more work.", "body": "This seems to be at least partially unrelated to custom ops. The following fails on master:\r\n```python\r\nimport torch\r\nimport torch.jit\r\nfrom typing import List, Tuple\r\n\r\n@torch.jit.script\r\ndef mytest(x: List[torch.Tensor]):\r\n    return x[0] + x[1]\r\n\r\na = torch.randn(5)\r\nb = torch.randn(5)\r\n\r\nprint(mytest((a, b)))\r\nprint (mytest.graph_for((a,b)))\r\n\r\ntm = torch.jit.trace(mytest,((a, b),)) # fails\r\n\r\nprint(tm((a,b)))\r\nprint (tm.graph_for((a,b)))\r\n```\r\nI have a patch that fixes this (but not the variant with `List[torch.Tensor]` replaced by `Tuple[torch.Tensor, torch.Tensor]`. Probably needs more work."}