{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3805", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3805/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3805/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3805/events", "html_url": "https://github.com/pytorch/pytorch/issues/3805", "id": 275606888, "node_id": "MDU6SXNzdWUyNzU2MDY4ODg=", "number": 3805, "title": "Problem when I load a state dictionary", "user": {"login": "lyuweiwang", "id": 11783326, "node_id": "MDQ6VXNlcjExNzgzMzI2", "avatar_url": "https://avatars3.githubusercontent.com/u/11783326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lyuweiwang", "html_url": "https://github.com/lyuweiwang", "followers_url": "https://api.github.com/users/lyuweiwang/followers", "following_url": "https://api.github.com/users/lyuweiwang/following{/other_user}", "gists_url": "https://api.github.com/users/lyuweiwang/gists{/gist_id}", "starred_url": "https://api.github.com/users/lyuweiwang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lyuweiwang/subscriptions", "organizations_url": "https://api.github.com/users/lyuweiwang/orgs", "repos_url": "https://api.github.com/users/lyuweiwang/repos", "events_url": "https://api.github.com/users/lyuweiwang/events{/privacy}", "received_events_url": "https://api.github.com/users/lyuweiwang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-11-21T07:07:25Z", "updated_at": "2018-06-20T03:00:58Z", "closed_at": "2017-11-21T10:44:11Z", "author_association": "NONE", "body_html": "<p>Hello,</p>\n<p>It happens when I resume previous training task. When I create my model and use 'model.load_state_dict(checkpoint['state_dict'])', it report the error that 'unexpected key \"module.features.conv0.weight\" in state_dict'.<br>\nHowever it works well when I load the model into GPU by 'net = torch.nn.DataParallel(model, device_ids=[0, 1]); net.cuda()' first, and then use 'net.load_state_dict(checkpoint['state_dict'])'.<br>\nSo could anyone tell me what the problem is?</p>\n<p>Thanks,<br>\nLyuwei</p>", "body_text": "Hello,\nIt happens when I resume previous training task. When I create my model and use 'model.load_state_dict(checkpoint['state_dict'])', it report the error that 'unexpected key \"module.features.conv0.weight\" in state_dict'.\nHowever it works well when I load the model into GPU by 'net = torch.nn.DataParallel(model, device_ids=[0, 1]); net.cuda()' first, and then use 'net.load_state_dict(checkpoint['state_dict'])'.\nSo could anyone tell me what the problem is?\nThanks,\nLyuwei", "body": "Hello,\r\n\r\nIt happens when I resume previous training task. When I create my model and use 'model.load_state_dict(checkpoint['state_dict'])', it report the error that 'unexpected key \"module.features.conv0.weight\" in state_dict'. \r\nHowever it works well when I load the model into GPU by 'net = torch.nn.DataParallel(model, device_ids=[0, 1]); net.cuda()' first, and then use 'net.load_state_dict(checkpoint['state_dict'])'.\r\nSo could anyone tell me what the problem is?\r\n\r\nThanks,\r\nLyuwei "}