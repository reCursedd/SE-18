{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1184", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1184/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1184/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1184/events", "html_url": "https://github.com/pytorch/pytorch/issues/1184", "id": 219365203, "node_id": "MDU6SXNzdWUyMTkzNjUyMDM=", "number": 1184, "title": "[memory regression] autograd still holding on to some buffers even if requires_grad=False", "user": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}, {"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2017-04-04T19:58:41Z", "updated_at": "2017-05-19T11:50:16Z", "closed_at": "2017-05-03T23:04:28Z", "author_association": "MEMBER", "body_html": "<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torchvision\n<span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">from</span> torch.autograd <span class=\"pl-k\">import</span> Variable\n\nresnet <span class=\"pl-k\">=</span> torchvision.models.resnet152(<span class=\"pl-v\">pretrained</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\nresnet <span class=\"pl-k\">=</span> resnet.cuda()\n<span class=\"pl-k\">for</span> param <span class=\"pl-k\">in</span> resnet.parameters():\n    param.requires_grad <span class=\"pl-k\">=</span> <span class=\"pl-c1\">False</span>\nimages <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">128</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">224</span>, <span class=\"pl-c1\">224</span>)\nimages <span class=\"pl-k\">=</span> images.cuda()\noutputs <span class=\"pl-k\">=</span> resnet(Variable(images))</pre></div>\n<p>This is a snippet that has ~2.5GB of memory usage in <code>v0.1.10</code>, but 12GB+ in <code>v0.1.11</code> (and goes OOM)<br>\nThanks to <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15663219\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yunjey\">@yunjey</a> for reporting this.</p>", "body_text": "import torchvision\nimport torch\nfrom torch.autograd import Variable\n\nresnet = torchvision.models.resnet152(pretrained=True)\nresnet = resnet.cuda()\nfor param in resnet.parameters():\n    param.requires_grad = False\nimages = torch.randn(128, 3, 224, 224)\nimages = images.cuda()\noutputs = resnet(Variable(images))\nThis is a snippet that has ~2.5GB of memory usage in v0.1.10, but 12GB+ in v0.1.11 (and goes OOM)\nThanks to @yunjey for reporting this.", "body": "```python\r\nimport torchvision\r\nimport torch\r\nfrom torch.autograd import Variable\r\n\r\nresnet = torchvision.models.resnet152(pretrained=True)\r\nresnet = resnet.cuda()\r\nfor param in resnet.parameters():\r\n    param.requires_grad = False\r\nimages = torch.randn(128, 3, 224, 224)\r\nimages = images.cuda()\r\noutputs = resnet(Variable(images))\r\n```\r\n\r\nThis is a snippet that has ~2.5GB of memory usage in `v0.1.10`, but 12GB+ in `v0.1.11` (and goes OOM)\r\nThanks to @yunjey for reporting this."}