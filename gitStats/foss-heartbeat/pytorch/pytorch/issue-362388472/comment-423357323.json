{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/423357323", "html_url": "https://github.com/pytorch/pytorch/issues/11912#issuecomment-423357323", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11912", "id": 423357323, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzM1NzMyMw==", "user": {"login": "mruberry", "id": 38511765, "node_id": "MDQ6VXNlcjM4NTExNzY1", "avatar_url": "https://avatars3.githubusercontent.com/u/38511765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mruberry", "html_url": "https://github.com/mruberry", "followers_url": "https://api.github.com/users/mruberry/followers", "following_url": "https://api.github.com/users/mruberry/following{/other_user}", "gists_url": "https://api.github.com/users/mruberry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mruberry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mruberry/subscriptions", "organizations_url": "https://api.github.com/users/mruberry/orgs", "repos_url": "https://api.github.com/users/mruberry/repos", "events_url": "https://api.github.com/users/mruberry/events{/privacy}", "received_events_url": "https://api.github.com/users/mruberry/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-20T22:40:33Z", "updated_at": "2018-09-20T22:40:33Z", "author_association": "CONTRIBUTOR", "body_html": "<p>\"I owed you this issue\" sounds so ominous!</p>\n<p>The legacy wrappers do actually use the pool, but I agree it's likely better to not cache the stream upfront and acquire it later.</p>\n<p>If the stream pool has caused a perf hit, then we have some options to consider addressing it:</p>\n<ul>\n<li>Use the high priority option when creating a stream. The high priority stream pool is separate from the low/default priority pool.</li>\n<li>Extend the stream API to allow the creation of a private pool.</li>\n<li>Extend the stream API to allow the creation of streams outside any pool, which are then managed directly by c10d.</li>\n</ul>\n<p>To recap, moving from the legacy to the new wrappers will have no performance impact (aside from avoiding the forwarding from c10d-&gt;THC-&gt;ATen). If pooling has caused a perf hit (unclear?) then we have some options to address it, but these options also require changes in Gloo, and it may be easier to simply make the fix you mention in Gloo, anyway.</p>", "body_text": "\"I owed you this issue\" sounds so ominous!\nThe legacy wrappers do actually use the pool, but I agree it's likely better to not cache the stream upfront and acquire it later.\nIf the stream pool has caused a perf hit, then we have some options to consider addressing it:\n\nUse the high priority option when creating a stream. The high priority stream pool is separate from the low/default priority pool.\nExtend the stream API to allow the creation of a private pool.\nExtend the stream API to allow the creation of streams outside any pool, which are then managed directly by c10d.\n\nTo recap, moving from the legacy to the new wrappers will have no performance impact (aside from avoiding the forwarding from c10d->THC->ATen). If pooling has caused a perf hit (unclear?) then we have some options to address it, but these options also require changes in Gloo, and it may be easier to simply make the fix you mention in Gloo, anyway.", "body": "\"I owed you this issue\" sounds so ominous!\r\n\r\nThe legacy wrappers do actually use the pool, but I agree it's likely better to not cache the stream upfront and acquire it later. \r\n\r\nIf the stream pool has caused a perf hit, then we have some options to consider addressing it:\r\n\r\n- Use the high priority option when creating a stream. The high priority stream pool is separate from the low/default priority pool.\r\n- Extend the stream API to allow the creation of a private pool.\r\n- Extend the stream API to allow the creation of streams outside any pool, which are then managed directly by c10d.\r\n\r\nTo recap, moving from the legacy to the new wrappers will have no performance impact (aside from avoiding the forwarding from c10d->THC->ATen). If pooling has caused a perf hit (unclear?) then we have some options to address it, but these options also require changes in Gloo, and it may be easier to simply make the fix you mention in Gloo, anyway.  "}