{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7092", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7092/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7092/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7092/events", "html_url": "https://github.com/pytorch/pytorch/issues/7092", "id": 318834889, "node_id": "MDU6SXNzdWUzMTg4MzQ4ODk=", "number": 7092, "title": "Multi-GPU autograd error with Pytorch 0.4", "user": {"login": "erogol", "id": 1402048, "node_id": "MDQ6VXNlcjE0MDIwNDg=", "avatar_url": "https://avatars3.githubusercontent.com/u/1402048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erogol", "html_url": "https://github.com/erogol", "followers_url": "https://api.github.com/users/erogol/followers", "following_url": "https://api.github.com/users/erogol/following{/other_user}", "gists_url": "https://api.github.com/users/erogol/gists{/gist_id}", "starred_url": "https://api.github.com/users/erogol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erogol/subscriptions", "organizations_url": "https://api.github.com/users/erogol/orgs", "repos_url": "https://api.github.com/users/erogol/repos", "events_url": "https://api.github.com/users/erogol/events{/privacy}", "received_events_url": "https://api.github.com/users/erogol/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": {"login": "ailzhang", "id": 5248122, "node_id": "MDQ6VXNlcjUyNDgxMjI=", "avatar_url": "https://avatars2.githubusercontent.com/u/5248122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ailzhang", "html_url": "https://github.com/ailzhang", "followers_url": "https://api.github.com/users/ailzhang/followers", "following_url": "https://api.github.com/users/ailzhang/following{/other_user}", "gists_url": "https://api.github.com/users/ailzhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ailzhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ailzhang/subscriptions", "organizations_url": "https://api.github.com/users/ailzhang/orgs", "repos_url": "https://api.github.com/users/ailzhang/repos", "events_url": "https://api.github.com/users/ailzhang/events{/privacy}", "received_events_url": "https://api.github.com/users/ailzhang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ailzhang", "id": 5248122, "node_id": "MDQ6VXNlcjUyNDgxMjI=", "avatar_url": "https://avatars2.githubusercontent.com/u/5248122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ailzhang", "html_url": "https://github.com/ailzhang", "followers_url": "https://api.github.com/users/ailzhang/followers", "following_url": "https://api.github.com/users/ailzhang/following{/other_user}", "gists_url": "https://api.github.com/users/ailzhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ailzhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ailzhang/subscriptions", "organizations_url": "https://api.github.com/users/ailzhang/orgs", "repos_url": "https://api.github.com/users/ailzhang/repos", "events_url": "https://api.github.com/users/ailzhang/events{/privacy}", "received_events_url": "https://api.github.com/users/ailzhang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 34, "created_at": "2018-04-30T09:42:40Z", "updated_at": "2018-09-18T09:02:07Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>After updating pytorch 0.4 I am getting the following error when I try to train my model here: <a href=\"https://github.com/mozilla/TTS\">https://github.com/mozilla/TTS</a> with multi-gpus. I have no idea about what it means unfortunately. A bug or just a problem that I need some feedback on. Thx.</p>\n<pre><code>Traceback (most recent call last):\n  File \"train.py\", line 403, in &lt;module&gt;\n    main(args)\n  File \"train.py\", line 393, in main\n    model, criterion, train_loader, optimizer, epoch)\n  File \"train.py\", line 111, in train\n    model.forward(text_input, mel_spec)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 114, in forward\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 124, in parallel_apply\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py\", line 65, in parallel_apply\n    raise output\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py\", line 41, in _worker\n    output = module(*input, **kwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/projects/TTS/models/tacotron.py\", line 28, in forward\n    encoder_outputs = self.encoder(inputs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/projects/TTS/layers/tacotron.py\", line 205, in forward\n    return self.cbhg(inputs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/projects/TTS/layers/tacotron.py\", line 183, in forward\n    outputs, _ = self.gru(x)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 192, in forward\n    output, hidden = func(input, self.all_weights, hx, batch_sizes)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 323, in forward\n    return func(input, *fargs, **fkwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 287, in forward\n    dropout_ts)\nRuntimeError: torch/csrc/autograd/variable.cpp:115: get_grad_fn: Assertion `output_nr == 0` failed.\n</code></pre>", "body_text": "After updating pytorch 0.4 I am getting the following error when I try to train my model here: https://github.com/mozilla/TTS with multi-gpus. I have no idea about what it means unfortunately. A bug or just a problem that I need some feedback on. Thx.\nTraceback (most recent call last):\n  File \"train.py\", line 403, in <module>\n    main(args)\n  File \"train.py\", line 393, in main\n    model, criterion, train_loader, optimizer, epoch)\n  File \"train.py\", line 111, in train\n    model.forward(text_input, mel_spec)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 114, in forward\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 124, in parallel_apply\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py\", line 65, in parallel_apply\n    raise output\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py\", line 41, in _worker\n    output = module(*input, **kwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/projects/TTS/models/tacotron.py\", line 28, in forward\n    encoder_outputs = self.encoder(inputs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/projects/TTS/layers/tacotron.py\", line 205, in forward\n    return self.cbhg(inputs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/projects/TTS/layers/tacotron.py\", line 183, in forward\n    outputs, _ = self.gru(x)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 192, in forward\n    output, hidden = func(input, self.all_weights, hx, batch_sizes)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 323, in forward\n    return func(input, *fargs, **fkwargs)\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 287, in forward\n    dropout_ts)\nRuntimeError: torch/csrc/autograd/variable.cpp:115: get_grad_fn: Assertion `output_nr == 0` failed.", "body": "After updating pytorch 0.4 I am getting the following error when I try to train my model here: https://github.com/mozilla/TTS with multi-gpus. I have no idea about what it means unfortunately. A bug or just a problem that I need some feedback on. Thx. \r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 403, in <module>\r\n    main(args)\r\n  File \"train.py\", line 393, in main\r\n    model, criterion, train_loader, optimizer, epoch)\r\n  File \"train.py\", line 111, in train\r\n    model.forward(text_input, mel_spec)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 114, in forward\r\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 124, in parallel_apply\r\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py\", line 65, in parallel_apply\r\n    raise output\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py\", line 41, in _worker\r\n    output = module(*input, **kwargs)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/erogol/projects/TTS/models/tacotron.py\", line 28, in forward\r\n    encoder_outputs = self.encoder(inputs)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/erogol/projects/TTS/layers/tacotron.py\", line 205, in forward\r\n    return self.cbhg(inputs)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/erogol/projects/TTS/layers/tacotron.py\", line 183, in forward\r\n    outputs, _ = self.gru(x)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 192, in forward\r\n    output, hidden = func(input, self.all_weights, hx, batch_sizes)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 323, in forward\r\n    return func(input, *fargs, **fkwargs)\r\n  File \"/home/erogol/miniconda3/envs/pytorch4/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 287, in forward\r\n    dropout_ts)\r\nRuntimeError: torch/csrc/autograd/variable.cpp:115: get_grad_fn: Assertion `output_nr == 0` failed.\r\n```"}