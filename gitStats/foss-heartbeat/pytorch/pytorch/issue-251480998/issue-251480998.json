{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2491", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2491/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2491/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2491/events", "html_url": "https://github.com/pytorch/pytorch/issues/2491", "id": 251480998, "node_id": "MDU6SXNzdWUyNTE0ODA5OTg=", "number": 2491, "title": "function expand_as() works incorrectly on latest Pytorch 0.2.0_1", "user": {"login": "Jiankai-Sun", "id": 25477396, "node_id": "MDQ6VXNlcjI1NDc3Mzk2", "avatar_url": "https://avatars2.githubusercontent.com/u/25477396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jiankai-Sun", "html_url": "https://github.com/Jiankai-Sun", "followers_url": "https://api.github.com/users/Jiankai-Sun/followers", "following_url": "https://api.github.com/users/Jiankai-Sun/following{/other_user}", "gists_url": "https://api.github.com/users/Jiankai-Sun/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jiankai-Sun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jiankai-Sun/subscriptions", "organizations_url": "https://api.github.com/users/Jiankai-Sun/orgs", "repos_url": "https://api.github.com/users/Jiankai-Sun/repos", "events_url": "https://api.github.com/users/Jiankai-Sun/events{/privacy}", "received_events_url": "https://api.github.com/users/Jiankai-Sun/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-08-20T10:53:43Z", "updated_at": "2018-07-14T18:31:08Z", "closed_at": "2017-08-21T08:16:38Z", "author_association": "NONE", "body_html": "<p>I think this is a bug for function <code>expand_as()</code> since <code>expand_as()</code> works correctly on <code>pytorch 0.1.2</code> but incorrectly on <code>pytorch '0.2.0_1'</code></p>\n<p>System:<br>\nUbuntu 16.04 64-bit<br>\nPython 2.7<br>\npytorch '0.2.0_1</p>\n<p>A toy example on latest pytorch 0.2.0_1</p>\n<div class=\"highlight highlight-source-python\"><pre>In [<span class=\"pl-c1\">39</span>]: <span class=\"pl-k\">import</span> torch\n\nIn [<span class=\"pl-c1\">40</span>]: <span class=\"pl-k\">import</span> torch.nn <span class=\"pl-k\">as</span> nn\n\nIn [<span class=\"pl-c1\">41</span>]: linear_policy_1 <span class=\"pl-k\">=</span> nn.Linear(<span class=\"pl-c1\">256</span>,<span class=\"pl-c1\">6</span>)\n\nIn [<span class=\"pl-c1\">42</span>]: weights <span class=\"pl-k\">=</span> linear_policy_1.weight.data\n\nIn [<span class=\"pl-c1\">43</span>]: out <span class=\"pl-k\">=</span> torch.randn(weights.size())\n\nIn [<span class=\"pl-c1\">44</span>]: out.pow(<span class=\"pl-c1\">2</span>).sum(<span class=\"pl-c1\">1</span>).expand_as(out)\n<span class=\"pl-ii\">--------------------------------------------------------------------------</span><span class=\"pl-k\">-</span>\n<span class=\"pl-c1\">RuntimeError</span>                              Traceback (most recent call last)\n<span class=\"pl-k\">&lt;</span>ipython<span class=\"pl-k\">-</span><span class=\"pl-c1\">input</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">44</span><span class=\"pl-k\">-</span>b84413eca516<span class=\"pl-k\">&gt;</span> <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>()\n<span class=\"pl-ii\">----</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">1</span> out.pow(<span class=\"pl-c1\">2</span>).sum(<span class=\"pl-c1\">1</span>).expand_as(out)\n\n<span class=\"pl-k\">/</span>home<span class=\"pl-k\">/</span>jack<span class=\"pl-k\">/</span>Applications<span class=\"pl-k\">/</span>pythonEnv<span class=\"pl-k\">/</span>python2<span class=\"pl-k\">/</span>local<span class=\"pl-k\">/</span>lib<span class=\"pl-k\">/</span>python2.7<span class=\"pl-k\">/</span>site<span class=\"pl-k\">-</span>packages<span class=\"pl-k\">/</span>torch<span class=\"pl-k\">/</span>tensor.pyc <span class=\"pl-k\">in</span> expand_as(<span class=\"pl-c1\">self</span>, tensor)\n    <span class=\"pl-c1\">234</span>             <span class=\"pl-c1\">self</span>.expand(tensor.size())\n    <span class=\"pl-c1\">235</span>         <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"</span></span>\n<span class=\"pl-s\">--&gt; 236         return self.expand(tensor.size())</span>\n<span class=\"pl-s\">    237 </span>\n<span class=\"pl-s\">    238     def repeat(self, *sizes):</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">RuntimeError: The expanded size of the tensor (256) must match the existing size (6) at non-singleton dimension 1. at /pytorch/torch/lib/TH/generic/THTensor.c:308</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">In [45]: </span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\"></span></pre></div>", "body_text": "I think this is a bug for function expand_as() since expand_as() works correctly on pytorch 0.1.2 but incorrectly on pytorch '0.2.0_1'\nSystem:\nUbuntu 16.04 64-bit\nPython 2.7\npytorch '0.2.0_1\nA toy example on latest pytorch 0.2.0_1\nIn [39]: import torch\n\nIn [40]: import torch.nn as nn\n\nIn [41]: linear_policy_1 = nn.Linear(256,6)\n\nIn [42]: weights = linear_policy_1.weight.data\n\nIn [43]: out = torch.randn(weights.size())\n\nIn [44]: out.pow(2).sum(1).expand_as(out)\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-44-b84413eca516> in <module>()\n----> 1 out.pow(2).sum(1).expand_as(out)\n\n/home/jack/Applications/pythonEnv/python2/local/lib/python2.7/site-packages/torch/tensor.pyc in expand_as(self, tensor)\n    234             self.expand(tensor.size())\n    235         \"\"\"\n--> 236         return self.expand(tensor.size())\n    237 \n    238     def repeat(self, *sizes):\n\nRuntimeError: The expanded size of the tensor (256) must match the existing size (6) at non-singleton dimension 1. at /pytorch/torch/lib/TH/generic/THTensor.c:308\n\nIn [45]:", "body": "I think this is a bug for function `expand_as()` since `expand_as()` works correctly on `pytorch 0.1.2` but incorrectly on `pytorch '0.2.0_1'`\r\n\r\nSystem:\r\nUbuntu 16.04 64-bit\r\nPython 2.7\r\npytorch '0.2.0_1\r\n\r\nA toy example on latest pytorch 0.2.0_1\r\n```python\r\nIn [39]: import torch\r\n\r\nIn [40]: import torch.nn as nn\r\n\r\nIn [41]: linear_policy_1 = nn.Linear(256,6)\r\n\r\nIn [42]: weights = linear_policy_1.weight.data\r\n\r\nIn [43]: out = torch.randn(weights.size())\r\n\r\nIn [44]: out.pow(2).sum(1).expand_as(out)\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-44-b84413eca516> in <module>()\r\n----> 1 out.pow(2).sum(1).expand_as(out)\r\n\r\n/home/jack/Applications/pythonEnv/python2/local/lib/python2.7/site-packages/torch/tensor.pyc in expand_as(self, tensor)\r\n    234             self.expand(tensor.size())\r\n    235         \"\"\"\r\n--> 236         return self.expand(tensor.size())\r\n    237 \r\n    238     def repeat(self, *sizes):\r\n\r\nRuntimeError: The expanded size of the tensor (256) must match the existing size (6) at non-singleton dimension 1. at /pytorch/torch/lib/TH/generic/THTensor.c:308\r\n\r\nIn [45]: \r\n\r\n\r\n```"}