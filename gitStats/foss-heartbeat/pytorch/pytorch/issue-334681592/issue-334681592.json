{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8769", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8769/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8769/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8769/events", "html_url": "https://github.com/pytorch/pytorch/issues/8769", "id": 334681592, "node_id": "MDU6SXNzdWUzMzQ2ODE1OTI=", "number": 8769, "title": "[JIT] IntList arguments for call are not valid", "user": {"login": "wanchaol", "id": 9443650, "node_id": "MDQ6VXNlcjk0NDM2NTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9443650?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wanchaol", "html_url": "https://github.com/wanchaol", "followers_url": "https://api.github.com/users/wanchaol/followers", "following_url": "https://api.github.com/users/wanchaol/following{/other_user}", "gists_url": "https://api.github.com/users/wanchaol/gists{/gist_id}", "starred_url": "https://api.github.com/users/wanchaol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wanchaol/subscriptions", "organizations_url": "https://api.github.com/users/wanchaol/orgs", "repos_url": "https://api.github.com/users/wanchaol/repos", "events_url": "https://api.github.com/users/wanchaol/events{/privacy}", "received_events_url": "https://api.github.com/users/wanchaol/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-06-21T22:36:36Z", "updated_at": "2018-09-07T23:23:27Z", "closed_at": "2018-09-07T23:23:27Z", "author_association": "CONTRIBUTOR", "body_html": "<p>After PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"334107992\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/8687\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/8687/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/8687\">#8687</a>, we are unable to define something like this:</p>\n<pre><code>def test(input):\n    a = torch.zeros((input.size(0), 50), dtype=torch.double)\n</code></pre>\n<p>The problem is that we are now treating the IntList as a listOfInt, but input.size(0) returns a Dynamic, so it will throw up errors like:</p>\n<pre><code>Traceback (most recent call last):\n  File \"test/test_jit.py\", line 4407, in test_time_sequence_prediction\n    self.checkTrace(Sequence(), (torch.rand(97, 999),), verbose=True)\n  File \"/Users/wanchaol/pytorch/torch/jit/__init__.py\", line 558, in init_then_register\n    self._create_methods(asts, rcbs)\nRuntimeError:\narguments for call are not valid:\n\n  for operator zeros(IntList size, int64_t dtype=&lt;default&gt;, IntList device=&lt;default&gt;, int64_t layout=&lt;default&gt;):\n  expected a value of type Tensor for argument 'size' but found (Tensor, int)\n\n</code></pre>\n<p>Currently we seems not doing the TensorToNum if we are into this case. <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5652049\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zou3519\">@zou3519</a> do you have any suggestions on how this could be fix?</p>", "body_text": "After PR #8687, we are unable to define something like this:\ndef test(input):\n    a = torch.zeros((input.size(0), 50), dtype=torch.double)\n\nThe problem is that we are now treating the IntList as a listOfInt, but input.size(0) returns a Dynamic, so it will throw up errors like:\nTraceback (most recent call last):\n  File \"test/test_jit.py\", line 4407, in test_time_sequence_prediction\n    self.checkTrace(Sequence(), (torch.rand(97, 999),), verbose=True)\n  File \"/Users/wanchaol/pytorch/torch/jit/__init__.py\", line 558, in init_then_register\n    self._create_methods(asts, rcbs)\nRuntimeError:\narguments for call are not valid:\n\n  for operator zeros(IntList size, int64_t dtype=<default>, IntList device=<default>, int64_t layout=<default>):\n  expected a value of type Tensor for argument 'size' but found (Tensor, int)\n\n\nCurrently we seems not doing the TensorToNum if we are into this case. @zou3519 do you have any suggestions on how this could be fix?", "body": "After PR #8687, we are unable to define something like this:\r\n\r\n```\r\ndef test(input):\r\n    a = torch.zeros((input.size(0), 50), dtype=torch.double)\r\n```\r\nThe problem is that we are now treating the IntList as a listOfInt, but input.size(0) returns a Dynamic, so it will throw up errors like:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"test/test_jit.py\", line 4407, in test_time_sequence_prediction\r\n    self.checkTrace(Sequence(), (torch.rand(97, 999),), verbose=True)\r\n  File \"/Users/wanchaol/pytorch/torch/jit/__init__.py\", line 558, in init_then_register\r\n    self._create_methods(asts, rcbs)\r\nRuntimeError:\r\narguments for call are not valid:\r\n\r\n  for operator zeros(IntList size, int64_t dtype=<default>, IntList device=<default>, int64_t layout=<default>):\r\n  expected a value of type Tensor for argument 'size' but found (Tensor, int)\r\n\r\n```\r\n\r\nCurrently we seems not doing the TensorToNum if we are into this case. @zou3519 do you have any suggestions on how this could be fix?\r\n"}