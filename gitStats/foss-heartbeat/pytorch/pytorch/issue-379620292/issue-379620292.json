{"url": "https://api.github.com/repos/pytorch/pytorch/issues/13832", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/13832/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/13832/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/13832/events", "html_url": "https://github.com/pytorch/pytorch/pull/13832", "id": 379620292, "node_id": "MDExOlB1bGxSZXF1ZXN0MjMwMDE3Mjc5", "number": 13832, "title": "Use RNG mutex for randperm on CPU", "user": {"login": "yf225", "id": 4063635, "node_id": "MDQ6VXNlcjQwNjM2MzU=", "avatar_url": "https://avatars0.githubusercontent.com/u/4063635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yf225", "html_url": "https://github.com/yf225", "followers_url": "https://api.github.com/users/yf225/followers", "following_url": "https://api.github.com/users/yf225/following{/other_user}", "gists_url": "https://api.github.com/users/yf225/gists{/gist_id}", "starred_url": "https://api.github.com/users/yf225/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yf225/subscriptions", "organizations_url": "https://api.github.com/users/yf225/orgs", "repos_url": "https://api.github.com/users/yf225/repos", "events_url": "https://api.github.com/users/yf225/events{/privacy}", "received_events_url": "https://api.github.com/users/yf225/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-11-12T04:49:55Z", "updated_at": "2018-11-12T23:29:17Z", "closed_at": "2018-11-12T23:29:17Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/13832", "html_url": "https://github.com/pytorch/pytorch/pull/13832", "diff_url": "https://github.com/pytorch/pytorch/pull/13832.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/13832.patch"}, "body_html": "<p>When we added <code>randperm_cpu</code> and <code>THTensor_(randperm)</code> we forgot to lock the <code>THGenerator</code> mutex before calling <code>THRandom_random</code>, which causes segfault error mentioned in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"376595604\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/facebookresearch/maskrcnn-benchmark/issues/93\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/facebookresearch/maskrcnn-benchmark/pull/93/hovercard?comment_id=435479043&amp;comment_type=issue_comment\" href=\"https://github.com/facebookresearch/maskrcnn-benchmark/pull/93#issuecomment-435479043\">facebookresearch/maskrcnn-benchmark#93 (comment)</a>. This PR fixes the bug.</p>\n<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #1868.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"237626525\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1868\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1868/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1868\">#1868</a>.</p>", "body_text": "When we added randperm_cpu and THTensor_(randperm) we forgot to lock the THGenerator mutex before calling THRandom_random, which causes segfault error mentioned in facebookresearch/maskrcnn-benchmark#93 (comment). This PR fixes the bug.\nCloses #1868.", "body": "When we added `randperm_cpu` and `THTensor_(randperm)` we forgot to lock the `THGenerator` mutex before calling `THRandom_random`, which causes segfault error mentioned in https://github.com/facebookresearch/maskrcnn-benchmark/pull/93#issuecomment-435479043. This PR fixes the bug.\r\n\r\nCloses https://github.com/pytorch/pytorch/issues/1868."}