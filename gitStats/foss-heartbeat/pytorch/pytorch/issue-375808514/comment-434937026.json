{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/434937026", "html_url": "https://github.com/pytorch/pytorch/issues/13372#issuecomment-434937026", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13372", "id": 434937026, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDkzNzAyNg==", "user": {"login": "ZQPei", "id": 27885598, "node_id": "MDQ6VXNlcjI3ODg1NTk4", "avatar_url": "https://avatars2.githubusercontent.com/u/27885598?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ZQPei", "html_url": "https://github.com/ZQPei", "followers_url": "https://api.github.com/users/ZQPei/followers", "following_url": "https://api.github.com/users/ZQPei/following{/other_user}", "gists_url": "https://api.github.com/users/ZQPei/gists{/gist_id}", "starred_url": "https://api.github.com/users/ZQPei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ZQPei/subscriptions", "organizations_url": "https://api.github.com/users/ZQPei/orgs", "repos_url": "https://api.github.com/users/ZQPei/repos", "events_url": "https://api.github.com/users/ZQPei/events{/privacy}", "received_events_url": "https://api.github.com/users/ZQPei/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-01T05:42:52Z", "updated_at": "2018-11-01T05:42:52Z", "author_association": "NONE", "body_html": "<blockquote>\n<p>The errors I get:</p>\n<pre><code>Traceback (most recent call last):\n  File \"detect.py\", line 114, in &lt;module&gt;\n    detect(cfgfile, weightfile, imgfile)\n  File \"detect.py\", line 12, in detect\n    m.load_weights(weightfile)\n  File \"pytorch-yolo3\\darknet.py\", line 334, in load_weights\n    start = load_conv_bn(buf, start, model[0], model[1])\n  File \"pytorch-yolo3\\cfg.py\", line 187, in load_conv_bn\n    conv_model.weight.data.copy_(torch.from_numpy(buf[start:start+num_w])); start = start + num_w\nRuntimeError: The expanded size of the tensor (3) must match the existing size (864) at non-singleton dimension 3\n</code></pre>\n</blockquote>\n<p>Thanks for helping me!</p>\n<p>The problem is because of python and pytorch version.<br>\nYou need change the code a little bit.<br>\nif you use python3, better clone its branch <code>python3</code></p>\n<div class=\"highlight highlight-source-shell\"><pre>git clone -b python3 https://github.com/marvis/pytorch-yolo3.git</pre></div>\n<p>if using pytorch 0.4,then open cfg.py, in line 169 and 187,  <code>conv_model.weight.data.copy_</code><br>\ncomment the original code, and replace them with</p>\n<div class=\"highlight highlight-source-python\"><pre>conv_model.weight.data.copy_(torch.from_numpy(buf[start:start<span class=\"pl-k\">+</span>num_w]).view(conv_model.weight.data.shape)); start <span class=\"pl-k\">=</span> start <span class=\"pl-k\">+</span> num_w</pre></div>\n<p>then it should work.</p>\n<p>It doesnot have to be this code, i just use it to demostrate how slow i run on win server.</p>", "body_text": "The errors I get:\nTraceback (most recent call last):\n  File \"detect.py\", line 114, in <module>\n    detect(cfgfile, weightfile, imgfile)\n  File \"detect.py\", line 12, in detect\n    m.load_weights(weightfile)\n  File \"pytorch-yolo3\\darknet.py\", line 334, in load_weights\n    start = load_conv_bn(buf, start, model[0], model[1])\n  File \"pytorch-yolo3\\cfg.py\", line 187, in load_conv_bn\n    conv_model.weight.data.copy_(torch.from_numpy(buf[start:start+num_w])); start = start + num_w\nRuntimeError: The expanded size of the tensor (3) must match the existing size (864) at non-singleton dimension 3\n\n\nThanks for helping me!\nThe problem is because of python and pytorch version.\nYou need change the code a little bit.\nif you use python3, better clone its branch python3\ngit clone -b python3 https://github.com/marvis/pytorch-yolo3.git\nif using pytorch 0.4,then open cfg.py, in line 169 and 187,  conv_model.weight.data.copy_\ncomment the original code, and replace them with\nconv_model.weight.data.copy_(torch.from_numpy(buf[start:start+num_w]).view(conv_model.weight.data.shape)); start = start + num_w\nthen it should work.\nIt doesnot have to be this code, i just use it to demostrate how slow i run on win server.", "body": "\r\n> The errors I get:\r\n> \r\n> ```\r\n> Traceback (most recent call last):\r\n>   File \"detect.py\", line 114, in <module>\r\n>     detect(cfgfile, weightfile, imgfile)\r\n>   File \"detect.py\", line 12, in detect\r\n>     m.load_weights(weightfile)\r\n>   File \"pytorch-yolo3\\darknet.py\", line 334, in load_weights\r\n>     start = load_conv_bn(buf, start, model[0], model[1])\r\n>   File \"pytorch-yolo3\\cfg.py\", line 187, in load_conv_bn\r\n>     conv_model.weight.data.copy_(torch.from_numpy(buf[start:start+num_w])); start = start + num_w\r\n> RuntimeError: The expanded size of the tensor (3) must match the existing size (864) at non-singleton dimension 3\r\n> ```\r\nThanks for helping me!\r\n\r\nThe problem is because of python and pytorch version.\r\nYou need change the code a little bit.\r\nif you use python3, better clone its branch `python3`\r\n```bash\r\ngit clone -b python3 https://github.com/marvis/pytorch-yolo3.git\r\n```\r\nif using pytorch 0.4,then open cfg.py, in line 169 and 187,  `conv_model.weight.data.copy_`\r\ncomment the original code, and replace them with\r\n```python\r\nconv_model.weight.data.copy_(torch.from_numpy(buf[start:start+num_w]).view(conv_model.weight.data.shape)); start = start + num_w\r\n```\r\n\r\nthen it should work.\r\n\r\nIt doesnot have to be this code, i just use it to demostrate how slow i run on win server.\r\n"}