{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7925", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7925/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7925/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7925/events", "html_url": "https://github.com/pytorch/pytorch/issues/7925", "id": 327433481, "node_id": "MDU6SXNzdWUzMjc0MzM0ODE=", "number": 7925, "title": "[JIT][caffe2][ONNX] Cannot export Dynamic type tensors to ONNX", "user": {"login": "jamesr66a", "id": 4685384, "node_id": "MDQ6VXNlcjQ2ODUzODQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/4685384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamesr66a", "html_url": "https://github.com/jamesr66a", "followers_url": "https://api.github.com/users/jamesr66a/followers", "following_url": "https://api.github.com/users/jamesr66a/following{/other_user}", "gists_url": "https://api.github.com/users/jamesr66a/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamesr66a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamesr66a/subscriptions", "organizations_url": "https://api.github.com/users/jamesr66a/orgs", "repos_url": "https://api.github.com/users/jamesr66a/repos", "events_url": "https://api.github.com/users/jamesr66a/events{/privacy}", "received_events_url": "https://api.github.com/users/jamesr66a/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-05-29T18:19:42Z", "updated_at": "2018-05-29T18:22:33Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>Right now we have this hacky check that if we have a Dynamic tensor, we simply skip the export in the ONNX front-end path: <a href=\"https://github.com/pytorch/pytorch/blob/master/torch/csrc/jit/export.cpp#L162\">https://github.com/pytorch/pytorch/blob/master/torch/csrc/jit/export.cpp#L162</a></p>\n<p>This is because we cannot populate the metadata fields without this information. As a result, we've had to hack up the checker in the caffe2 back-end to support graphs where this info is absent, namely graphs with control flow: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"326338349\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/7832\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/7832/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/7832\">#7832</a></p>\n<p>This flag is clearly marked as <code>UNSAFE</code>, so it should be used with caution. Even if we fix the Dynamic type, we may have to keep this if we define the PyT1.0 serialization format to use ONNX, because it will likely not conform to the ONNX spec</p>", "body_text": "Right now we have this hacky check that if we have a Dynamic tensor, we simply skip the export in the ONNX front-end path: https://github.com/pytorch/pytorch/blob/master/torch/csrc/jit/export.cpp#L162\nThis is because we cannot populate the metadata fields without this information. As a result, we've had to hack up the checker in the caffe2 back-end to support graphs where this info is absent, namely graphs with control flow: #7832\nThis flag is clearly marked as UNSAFE, so it should be used with caution. Even if we fix the Dynamic type, we may have to keep this if we define the PyT1.0 serialization format to use ONNX, because it will likely not conform to the ONNX spec", "body": "Right now we have this hacky check that if we have a Dynamic tensor, we simply skip the export in the ONNX front-end path: https://github.com/pytorch/pytorch/blob/master/torch/csrc/jit/export.cpp#L162\r\n\r\nThis is because we cannot populate the metadata fields without this information. As a result, we've had to hack up the checker in the caffe2 back-end to support graphs where this info is absent, namely graphs with control flow: https://github.com/pytorch/pytorch/pull/7832\r\n\r\nThis flag is clearly marked as `UNSAFE`, so it should be used with caution. Even if we fix the Dynamic type, we may have to keep this if we define the PyT1.0 serialization format to use ONNX, because it will likely not conform to the ONNX spec"}