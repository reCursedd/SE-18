{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/165640537", "pull_request_review_id": 93615527, "id": 165640537, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2NTY0MDUzNw==", "diff_hunk": "@@ -413,88 +427,126 @@ void Graph::lint() const {\n   // - uniques in all_nodes are unique\n   // - every use will occur later in the topsort\n \n-  std::unordered_set<const Value*> in_scope;\n-  std::unordered_set<const Node*> node_in_scope;\n-  std::unordered_set<size_t> seen_uniques;\n-  std::unordered_map<const Node*, int64_t> anticipated_uses;\n-  auto check_value = [&](const Value* v) {\n-    auto b = in_scope.insert(v);\n-    JIT_ASSERT(b.second);  // insertion took place\n-    auto b2 = seen_uniques.insert(v->unique());\n-    JIT_ASSERT(b2.second);  // insertion took place\n-    JIT_ASSERT(v->unique() < next_unique_);\n-\n-    for (auto use : v->uses()) {\n-      JIT_ASSERT(node_in_scope.count(use.user) == 0);\n-      JIT_ASSERT(all_nodes.count(use.user) == 1);\n-      anticipated_uses[use.user]++;  // int default constructs to 0\n+  struct Scope {", "path": "torch/csrc/jit/ir.cpp", "position": null, "original_position": 69, "commit_id": "454f9d893a8df35d53eb040cc0f6e38ce3e4f424", "original_commit_id": "4b55af851f06bb57ee4bf7e5021da7511f516ad7", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "nit: we already have a struct called `Scope` which we use to annotate nodes in the graph. Would be nice to make their names different (probably rename the one used in tracing, since this is closer to what a scope is)", "created_at": "2018-02-02T13:12:08Z", "updated_at": "2018-11-23T15:38:58Z", "html_url": "https://github.com/pytorch/pytorch/pull/5009#discussion_r165640537", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/5009", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/165640537"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/5009#discussion_r165640537"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/5009"}}, "body_html": "<p>nit: we already have a struct called <code>Scope</code> which we use to annotate nodes in the graph. Would be nice to make their names different (probably rename the one used in tracing, since this is closer to what a scope is)</p>", "body_text": "nit: we already have a struct called Scope which we use to annotate nodes in the graph. Would be nice to make their names different (probably rename the one used in tracing, since this is closer to what a scope is)"}