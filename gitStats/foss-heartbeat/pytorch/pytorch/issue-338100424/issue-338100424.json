{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9155", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9155/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9155/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9155/events", "html_url": "https://github.com/pytorch/pytorch/issues/9155", "id": 338100424, "node_id": "MDU6SXNzdWUzMzgxMDA0MjQ=", "number": 9155, "title": "Error in setup.py [fatal error: THC/THCGeneral.hpp: No such file or directory]", "user": {"login": "pjspillai", "id": 691246, "node_id": "MDQ6VXNlcjY5MTI0Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/691246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjspillai", "html_url": "https://github.com/pjspillai", "followers_url": "https://api.github.com/users/pjspillai/followers", "following_url": "https://api.github.com/users/pjspillai/following{/other_user}", "gists_url": "https://api.github.com/users/pjspillai/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjspillai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjspillai/subscriptions", "organizations_url": "https://api.github.com/users/pjspillai/orgs", "repos_url": "https://api.github.com/users/pjspillai/repos", "events_url": "https://api.github.com/users/pjspillai/events{/privacy}", "received_events_url": "https://api.github.com/users/pjspillai/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-07-04T01:19:20Z", "updated_at": "2018-07-05T17:58:14Z", "closed_at": "2018-07-04T22:15:03Z", "author_association": "NONE", "body_html": "<p>Trying to build pytorch from source.</p>\n<p>I ran <code>sudo python setup.py install</code> and got the error displayed below.<br>\nInstalling in conda environment</p>\n<blockquote>\n<p>-- Caffe2: Found protobuf with new-style protobuf targets.<br>\n-- Caffe2: Protobuf version 3.5.0<br>\n-- Found CUDA: /usr/local/cuda (found suitable version \"9.2\", minimum required is \"7.0\")<br>\n-- Caffe2: CUDA detected: 9.2<br>\n-- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc<br>\n-- Caffe2: CUDA toolkit directory: /usr/local/cuda<br>\n-- Caffe2: Header version is: 9.2<br>\n-- Found cuDNN: v7.1.4  (include: /usr/local/cuda/include, library: /usr/local/cuda/lib64/libcudnn.so.7)<br>\n-- Autodetected CUDA architecture(s): 6.1<br>\n-- Added CUDA NVCC flags for: -gencode;arch=compute_61,code=sm_61<br>\n-- Gloo_LIBRARY: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.a<br>\n-- Gloo_NATIVE_LIBRARY: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/lib/libgloo.a<br>\n-- Gloo_INCLUDE_DIR: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/include<br>\n-- MPI_INCLUDE_PATH: /usr/lib/x86_64-linux-gnu/openmpi/include/openmpi;/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi/opal/mca/event/libevent2022/libevent;/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi/opal/mca/event/libevent2022/libevent/include;/usr/lib/x86_64-linux-gnu/openmpi/include<br>\n-- MPI_LIBRARIES: /usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_cxx.so;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi.so<br>\n-- MPIEXEC: /usr/bin/mpiexec<br>\n-- Determining NCCL version from the header file: /usr/include/nccl.h<br>\n-- NCCL_MAJOR_VERSION: 2<br>\n-- Found NCCL (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnccl.so)<br>\n-- NCCL_LIBRARIES: /usr/lib/x86_64-linux-gnu/libnccl.so<br>\n-- NCCL_INCLUDE_DIRS: /usr/include<br>\n-- NCCL Version 2 or higher found, will compile with NCCL distributed backend<br>\n-- Found CUDA: /usr/local/cuda (found version \"9.2\")<br>\n-- Configuring done<br>\n-- Generating done<br>\n-- Build files have been written to: /home/pikachu/sandbox/python/pytorch/torch/lib/build/c10d</p>\n<ul>\n<li>make install -j12<br>\nScanning dependencies of target c10d<br>\n[ 12%] Building CXX object CMakeFiles/c10d.dir/Utils.cpp.o<br>\n[ 12%] Building CXX object CMakeFiles/c10d.dir/TCPStore.cpp.o<br>\n[ 12%] Building CXX object CMakeFiles/c10d.dir/ProcessGroup.cpp.o<br>\n[ 16%] Building CXX object CMakeFiles/c10d.dir/CUDAUtils.cpp.o<br>\n[ 20%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupGloo.cpp.o<br>\n[ 29%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupMPI.cpp.o<br>\n[ 29%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/<strong>### ProcessGroupNCCL.cpp:5:10: fatal error: THC/THCGeneral.hpp: No such file or directory</strong><br>\n#include &lt;THC/THCGeneral.hpp&gt;<br>\n^~~~~~~~~~~~~~~~~~~~<br>\ncompilation terminated.<br>\nCMakeFiles/c10d.dir/build.make:230: recipe for target 'CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o' failed<br>\nmake[2]: *** [CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o] Error 1<br>\nmake[2]: *** Waiting for unfinished jobs....<br>\nIn file included from /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:3:0:<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp: In destructor \u2018c10d::CUDAEvent::~CUDAEvent()\u2019:<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/./private/CUDAUtils.hpp:25:40: warning: throw will always call terminate() [-Wterminate]<br>\nthrow std::runtime_error(ss.str()); <br>\n^<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:36:5: note: in expansion of macro \u2018C10D_CUDA_CHECK\u2019<br>\nC10D_CUDA_CHECK(cudaEventDestroy(event_));<br>\n^~~~~~~~~~~~~~~<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/./private/CUDAUtils.hpp:25:40: note: in C++11 destructors default to noexcept<br>\nthrow std::runtime_error(ss.str()); <br>\n^<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:36:5: note: in expansion of macro \u2018C10D_CUDA_CHECK\u2019<br>\nC10D_CUDA_CHECK(cudaEventDestroy(event_));<br>\n^~~~~~~~~~~~~~~<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp: In member function \u2018c10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&amp;)\u2019:<br>\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp:423:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]<br>\nif (vec.size() != cacheNumAlgorithmEntries_) {<br>\n~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/c10d.dir/all' failed<br>\nmake[1]: *** [CMakeFiles/c10d.dir/all] Error 2<br>\nMakefile:140: recipe for target 'all' failed<br>\nmake: *** [all] Error 2<br>\n<strong>### Failed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack caffe2 nanopb libshm gloo THD c10d'</strong></li>\n</ul>\n</blockquote>", "body_text": "Trying to build pytorch from source.\nI ran sudo python setup.py install and got the error displayed below.\nInstalling in conda environment\n\n-- Caffe2: Found protobuf with new-style protobuf targets.\n-- Caffe2: Protobuf version 3.5.0\n-- Found CUDA: /usr/local/cuda (found suitable version \"9.2\", minimum required is \"7.0\")\n-- Caffe2: CUDA detected: 9.2\n-- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\n-- Caffe2: CUDA toolkit directory: /usr/local/cuda\n-- Caffe2: Header version is: 9.2\n-- Found cuDNN: v7.1.4  (include: /usr/local/cuda/include, library: /usr/local/cuda/lib64/libcudnn.so.7)\n-- Autodetected CUDA architecture(s): 6.1\n-- Added CUDA NVCC flags for: -gencode;arch=compute_61,code=sm_61\n-- Gloo_LIBRARY: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.a\n-- Gloo_NATIVE_LIBRARY: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/lib/libgloo.a\n-- Gloo_INCLUDE_DIR: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/include\n-- MPI_INCLUDE_PATH: /usr/lib/x86_64-linux-gnu/openmpi/include/openmpi;/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi/opal/mca/event/libevent2022/libevent;/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi/opal/mca/event/libevent2022/libevent/include;/usr/lib/x86_64-linux-gnu/openmpi/include\n-- MPI_LIBRARIES: /usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_cxx.so;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi.so\n-- MPIEXEC: /usr/bin/mpiexec\n-- Determining NCCL version from the header file: /usr/include/nccl.h\n-- NCCL_MAJOR_VERSION: 2\n-- Found NCCL (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnccl.so)\n-- NCCL_LIBRARIES: /usr/lib/x86_64-linux-gnu/libnccl.so\n-- NCCL_INCLUDE_DIRS: /usr/include\n-- NCCL Version 2 or higher found, will compile with NCCL distributed backend\n-- Found CUDA: /usr/local/cuda (found version \"9.2\")\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/pikachu/sandbox/python/pytorch/torch/lib/build/c10d\n\nmake install -j12\nScanning dependencies of target c10d\n[ 12%] Building CXX object CMakeFiles/c10d.dir/Utils.cpp.o\n[ 12%] Building CXX object CMakeFiles/c10d.dir/TCPStore.cpp.o\n[ 12%] Building CXX object CMakeFiles/c10d.dir/ProcessGroup.cpp.o\n[ 16%] Building CXX object CMakeFiles/c10d.dir/CUDAUtils.cpp.o\n[ 20%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupGloo.cpp.o\n[ 29%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupMPI.cpp.o\n[ 29%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/### ProcessGroupNCCL.cpp:5:10: fatal error: THC/THCGeneral.hpp: No such file or directory\n#include <THC/THCGeneral.hpp>\n^~~~~~~~~~~~~~~~~~~~\ncompilation terminated.\nCMakeFiles/c10d.dir/build.make:230: recipe for target 'CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o' failed\nmake[2]: *** [CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\nIn file included from /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:3:0:\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp: In destructor \u2018c10d::CUDAEvent::~CUDAEvent()\u2019:\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/./private/CUDAUtils.hpp:25:40: warning: throw will always call terminate() [-Wterminate]\nthrow std::runtime_error(ss.str()); \n^\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:36:5: note: in expansion of macro \u2018C10D_CUDA_CHECK\u2019\nC10D_CUDA_CHECK(cudaEventDestroy(event_));\n^~~~~~~~~~~~~~~\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/./private/CUDAUtils.hpp:25:40: note: in C++11 destructors default to noexcept\nthrow std::runtime_error(ss.str()); \n^\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:36:5: note: in expansion of macro \u2018C10D_CUDA_CHECK\u2019\nC10D_CUDA_CHECK(cudaEventDestroy(event_));\n^~~~~~~~~~~~~~~\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp: In member function \u2018c10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&)\u2019:\n/home/pikachu/sandbox/python/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp:423:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\nif (vec.size() != cacheNumAlgorithmEntries_) {\n~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/c10d.dir/all' failed\nmake[1]: *** [CMakeFiles/c10d.dir/all] Error 2\nMakefile:140: recipe for target 'all' failed\nmake: *** [all] Error 2\n### Failed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack caffe2 nanopb libshm gloo THD c10d'", "body": "Trying to build pytorch from source.\r\n\r\nI ran `sudo python setup.py install` and got the error displayed below.\r\nInstalling in conda environment\r\n\r\n\r\n> -- Caffe2: Found protobuf with new-style protobuf targets.\r\n> -- Caffe2: Protobuf version 3.5.0\r\n> -- Found CUDA: /usr/local/cuda (found suitable version \"9.2\", minimum required is \"7.0\") \r\n> -- Caffe2: CUDA detected: 9.2\r\n> -- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\r\n> -- Caffe2: CUDA toolkit directory: /usr/local/cuda\r\n> -- Caffe2: Header version is: 9.2\r\n> -- Found cuDNN: v7.1.4  (include: /usr/local/cuda/include, library: /usr/local/cuda/lib64/libcudnn.so.7)\r\n> -- Autodetected CUDA architecture(s): 6.1 \r\n> -- Added CUDA NVCC flags for: -gencode;arch=compute_61,code=sm_61\r\n> -- Gloo_LIBRARY: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/lib/libgloo_cuda.a\r\n> -- Gloo_NATIVE_LIBRARY: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/lib/libgloo.a\r\n> -- Gloo_INCLUDE_DIR: /home/pikachu/sandbox/python/pytorch/torch/lib/tmp_install/include\r\n> -- MPI_INCLUDE_PATH: /usr/lib/x86_64-linux-gnu/openmpi/include/openmpi;/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi/opal/mca/event/libevent2022/libevent;/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi/opal/mca/event/libevent2022/libevent/include;/usr/lib/x86_64-linux-gnu/openmpi/include\r\n> -- MPI_LIBRARIES: /usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_cxx.so;/usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi.so\r\n> -- MPIEXEC: /usr/bin/mpiexec\r\n> -- Determining NCCL version from the header file: /usr/include/nccl.h\r\n> -- NCCL_MAJOR_VERSION: 2\r\n> -- Found NCCL (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnccl.so)\r\n> -- NCCL_LIBRARIES: /usr/lib/x86_64-linux-gnu/libnccl.so\r\n> -- NCCL_INCLUDE_DIRS: /usr/include\r\n> -- NCCL Version 2 or higher found, will compile with NCCL distributed backend\r\n> -- Found CUDA: /usr/local/cuda (found version \"9.2\") \r\n> -- Configuring done\r\n> -- Generating done\r\n> -- Build files have been written to: /home/pikachu/sandbox/python/pytorch/torch/lib/build/c10d\r\n> + make install -j12\r\n> Scanning dependencies of target c10d\r\n> [ 12%] Building CXX object CMakeFiles/c10d.dir/Utils.cpp.o\r\n> [ 12%] Building CXX object CMakeFiles/c10d.dir/TCPStore.cpp.o\r\n> [ 12%] Building CXX object CMakeFiles/c10d.dir/ProcessGroup.cpp.o\r\n> [ 16%] Building CXX object CMakeFiles/c10d.dir/CUDAUtils.cpp.o\r\n> [ 20%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupGloo.cpp.o\r\n> [ 29%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupMPI.cpp.o\r\n> [ 29%] Building CXX object CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/**### ProcessGroupNCCL.cpp:5:10: fatal error: THC/THCGeneral.hpp: No such file or directory**\r\n>  #include <THC/THCGeneral.hpp>\r\n>           ^~~~~~~~~~~~~~~~~~~~\r\n> compilation terminated.\r\n> CMakeFiles/c10d.dir/build.make:230: recipe for target 'CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o' failed\r\n> make[2]: *** [CMakeFiles/c10d.dir/ProcessGroupNCCL.cpp.o] Error 1\r\n> make[2]: *** Waiting for unfinished jobs....\r\n> In file included from /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:3:0:\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp: In destructor \u2018c10d::CUDAEvent::~CUDAEvent()\u2019:\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/./private/CUDAUtils.hpp:25:40: warning: throw will always call terminate() [-Wterminate]\r\n>        throw std::runtime_error(ss.str()); \\\r\n>                                         ^\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:36:5: note: in expansion of macro \u2018C10D_CUDA_CHECK\u2019\r\n>      C10D_CUDA_CHECK(cudaEventDestroy(event_));\r\n>      ^~~~~~~~~~~~~~~\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/./private/CUDAUtils.hpp:25:40: note: in C++11 destructors default to noexcept\r\n>        throw std::runtime_error(ss.str()); \\\r\n>                                         ^\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/CUDAUtils.cpp:36:5: note: in expansion of macro \u2018C10D_CUDA_CHECK\u2019\r\n>      C10D_CUDA_CHECK(cudaEventDestroy(event_));\r\n>      ^~~~~~~~~~~~~~~\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp: In member function \u2018c10d::AlgorithmEntry* c10d::ProcessGroupGloo::checkout(const c10d::AlgorithmKey&)\u2019:\r\n> /home/pikachu/sandbox/python/pytorch/torch/lib/c10d/ProcessGroupGloo.cpp:423:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n>    if (vec.size() != cacheNumAlgorithmEntries_) {\r\n>        ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n> CMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/c10d.dir/all' failed\r\n> make[1]: *** [CMakeFiles/c10d.dir/all] Error 2\r\n> Makefile:140: recipe for target 'all' failed\r\n> make: *** [all] Error 2\r\n> **### Failed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack caffe2 nanopb libshm gloo THD c10d'**\r\n> \r\n"}