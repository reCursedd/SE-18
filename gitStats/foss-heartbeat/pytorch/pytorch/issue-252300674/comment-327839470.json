{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/327839470", "html_url": "https://github.com/pytorch/pytorch/issues/2518#issuecomment-327839470", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/2518", "id": 327839470, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNzgzOTQ3MA==", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-07T15:42:31Z", "updated_at": "2017-09-07T15:42:31Z", "author_association": "MEMBER", "body_html": "<p>There's an additional problem that seems to decrease our perf quite severely - dynamic CPU frequency management. The issue is that most work is done in short bursts in two threads (main Python thread and backward worker), and the <code>powersave</code> governor heavily downclocks their cores (~1.7GHz avg vs 2.6GHz)</p>\n<p>With <code>powersave</code> mode, the script takes 16s on a development branch I'm on, but in <code>performance</code> it only takes 10s on my machine. To change CPU frequency governor run this command:</p>\n<div class=\"highlight highlight-source-shell\"><pre>sudo cpupower frequency-set -g <span class=\"pl-k\">&lt;</span>powersave<span class=\"pl-k\">|</span>performance<span class=\"pl-k\">&gt;</span></pre></div>\n<p>I haven't checked how this affects DyNet run times. cc: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=398875\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/neubig\">@neubig</a></p>", "body_text": "There's an additional problem that seems to decrease our perf quite severely - dynamic CPU frequency management. The issue is that most work is done in short bursts in two threads (main Python thread and backward worker), and the powersave governor heavily downclocks their cores (~1.7GHz avg vs 2.6GHz)\nWith powersave mode, the script takes 16s on a development branch I'm on, but in performance it only takes 10s on my machine. To change CPU frequency governor run this command:\nsudo cpupower frequency-set -g <powersave|performance>\nI haven't checked how this affects DyNet run times. cc: @neubig", "body": "There's an additional problem that seems to decrease our perf quite severely - dynamic CPU frequency management. The issue is that most work is done in short bursts in two threads (main Python thread and backward worker), and the `powersave` governor heavily downclocks their cores (~1.7GHz avg vs 2.6GHz)\r\n\r\nWith `powersave` mode, the script takes 16s on a development branch I'm on, but in `performance` it only takes 10s on my machine. To change CPU frequency governor run this command:\r\n```bash\r\nsudo cpupower frequency-set -g <powersave|performance>\r\n```\r\n\r\nI haven't checked how this affects DyNet run times. cc: @neubig"}