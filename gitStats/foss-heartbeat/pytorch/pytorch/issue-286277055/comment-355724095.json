{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/355724095", "html_url": "https://github.com/pytorch/pytorch/issues/4495#issuecomment-355724095", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/4495", "id": 355724095, "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTcyNDA5NQ==", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-06T05:15:12Z", "updated_at": "2018-01-06T05:15:12Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=191033\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/lantiga\">@lantiga</a>, although I was initially not convinced, you nailed it on the head; in fact, this bug was uncovered by hotpatch <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"285898958\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/4471\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/4471/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/4471\">#4471</a> (for <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"286080116\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/4480\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/4480/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/4480\">#4480</a>), which is working around a tracing problem by returning identity, causing setOutputs to go wrong. (We return identity in other places but its occurrence is much more rare.)</p>\n<p>I think the correct way to fix this is to test if <code>output[i]</code> aliases one of the inputs (the passthrough case) and skip the setting if it is. Should be easy!</p>", "body_text": "@lantiga, although I was initially not convinced, you nailed it on the head; in fact, this bug was uncovered by hotpatch #4471 (for #4480), which is working around a tracing problem by returning identity, causing setOutputs to go wrong. (We return identity in other places but its occurrence is much more rare.)\nI think the correct way to fix this is to test if output[i] aliases one of the inputs (the passthrough case) and skip the setting if it is. Should be easy!", "body": "@lantiga, although I was initially not convinced, you nailed it on the head; in fact, this bug was uncovered by hotpatch #4471 (for #4480), which is working around a tracing problem by returning identity, causing setOutputs to go wrong. (We return identity in other places but its occurrence is much more rare.)\r\n\r\nI think the correct way to fix this is to test if `output[i]` aliases one of the inputs (the passthrough case) and skip the setting if it is. Should be easy!"}