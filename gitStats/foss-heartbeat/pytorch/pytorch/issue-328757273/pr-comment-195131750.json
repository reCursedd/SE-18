{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/195131750", "pull_request_review_id": 128436964, "id": 195131750, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NTEzMTc1MA==", "diff_hunk": "@@ -149,50 +151,52 @@ if (FALSE)\n endif()\n \n # ---[ List of libraries to link with\n-if(BUILD_CAFFE2)\n+if (BUILD_CAFFE2)\n   add_library(caffe2_protos STATIC $<TARGET_OBJECTS:Caffe_PROTO> $<TARGET_OBJECTS:Caffe2_PROTO>)\n   add_dependencies(caffe2_protos Caffe_PROTO Caffe2_PROTO)\n-  # If we are going to link protobuf locally inside caffe2 libraries, what we will do is\n-  # to create a helper static library that always contains libprotobuf source files, and\n-  # link the caffe2 related dependent libraries to it.\n-  target_include_directories(caffe2_protos INTERFACE $<INSTALL_INTERFACE:include>)\n-  # Reason for this public dependency is as follows:\n-  # (1) Strictly speaking, we should not expose any Protobuf related functions. We should\n-  #     only use function interfaces wrapped with our own public API, and link protobuf\n-  #     locally.\n-  # (2) However, currently across the Caffe2 codebase, we have extensive use of protobuf\n-  #     functionalities. For example, not only libcaffe2.so uses it, but also other\n-  #     binaries such as python extensions etc. As a result, we will have to have a\n-  #     transitive dependency to libprotobuf.\n-  #\n-  # Good thing is that, if we specify CAFFE2_LINK_LOCAL_PROTOBUF, then we do not need to\n-  # separately deploy protobuf binaries - libcaffe2.so will contain all functionalities\n-  # one needs. One can verify this via ldd.\n-  #\n-  # TODO item in the future includes:\n-  # (1) Enable using lite protobuf\n-  # (2) Properly define public API that do not directly depend on protobuf itself.\n-  # (3) Expose the libprotobuf.a file for dependent libraries to link to.\n-  #\n-  # What it means for users/developers?\n-  # (1) Users: nothing affecting the users, other than the fact that CAFFE2_LINK_LOCAL_PROTOBUF\n-  #     avoids the need to deploy protobuf.\n-  # (2) Developers: if one simply uses core caffe2 functionality without using protobuf,\n-  #     nothing changes. If one has a dependent library that uses protobuf, then one needs to\n-  #     have the right protobuf version as well as linking to libprotobuf.a.\n-  target_link_libraries(caffe2_protos PUBLIC protobuf::libprotobuf)\n+else()\n+  # Do not include caffe2 or caffe protos, but rather have it only be\n+  # a library to attach local protobuf.\n+  add_library(caffe2_protos STATIC utils/dummy.cpp)", "path": "caffe2/CMakeLists.txt", "position": 61, "original_position": 61, "commit_id": "c95a0d05a5f23b1a90c70c20dd01de5d6d39441c", "original_commit_id": "f4fe2c90bbe29b5989ac1798a1d718c22a1112b0", "user": {"login": "Yangqing", "id": 551151, "node_id": "MDQ6VXNlcjU1MTE1MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/551151?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Yangqing", "html_url": "https://github.com/Yangqing", "followers_url": "https://api.github.com/users/Yangqing/followers", "following_url": "https://api.github.com/users/Yangqing/following{/other_user}", "gists_url": "https://api.github.com/users/Yangqing/gists{/gist_id}", "starred_url": "https://api.github.com/users/Yangqing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Yangqing/subscriptions", "organizations_url": "https://api.github.com/users/Yangqing/orgs", "repos_url": "https://api.github.com/users/Yangqing/repos", "events_url": "https://api.github.com/users/Yangqing/events{/privacy}", "received_events_url": "https://api.github.com/users/Yangqing/received_events", "type": "User", "site_admin": false}, "body": "Out of curiosity - is this still needed, or is it a dangling temp test?", "created_at": "2018-06-13T15:33:48Z", "updated_at": "2018-11-23T15:45:26Z", "html_url": "https://github.com/pytorch/pytorch/pull/8073#discussion_r195131750", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/8073", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/195131750"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/8073#discussion_r195131750"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/8073"}}, "body_html": "<p>Out of curiosity - is this still needed, or is it a dangling temp test?</p>", "body_text": "Out of curiosity - is this still needed, or is it a dangling temp test?"}