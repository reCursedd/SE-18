{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6410", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6410/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6410/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6410/events", "html_url": "https://github.com/pytorch/pytorch/pull/6410", "id": 312360739, "node_id": "MDExOlB1bGxSZXF1ZXN0MTgwMTkxNjIx", "number": 6410, "title": "[pytorch] add static linkage support for CuDNN and NCCL", "user": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-04-09T01:08:26Z", "updated_at": "2018-11-23T15:42:03Z", "closed_at": "2018-04-09T02:54:18Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/6410", "html_url": "https://github.com/pytorch/pytorch/pull/6410", "diff_url": "https://github.com/pytorch/pytorch/pull/6410.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/6410.patch"}, "body_html": "<p>Statically linking CuDNN and NCCL2 allows us to <code>nvprune</code> the libraries and include only the architectures that we support. This saves &gt; 100MB in binary size.</p>\n<p>List of changes:</p>\n<ul>\n<li>add flags to look for libnccl_static.a instead of libnccl.so* (also included in gloo and upstreamed, updated submodule)</li>\n<li>add flags to look for libcudnn_static.a instead of libcudnn.so*</li>\n<li>when linking statically, we have to link against <code>libculibos.a</code>. Added an ATen flag for that</li>\n</ul>\n<p>Additional minor changes:</p>\n<ul>\n<li>removed SOVERSION for libATen, in binaries it's being unlinked because of packaging dumbness out of our control</li>\n<li>in <code>setup.py</code>, exclude caffe, caffe2 folders as well from being included in package.</li>\n</ul>", "body_text": "Statically linking CuDNN and NCCL2 allows us to nvprune the libraries and include only the architectures that we support. This saves > 100MB in binary size.\nList of changes:\n\nadd flags to look for libnccl_static.a instead of libnccl.so* (also included in gloo and upstreamed, updated submodule)\nadd flags to look for libcudnn_static.a instead of libcudnn.so*\nwhen linking statically, we have to link against libculibos.a. Added an ATen flag for that\n\nAdditional minor changes:\n\nremoved SOVERSION for libATen, in binaries it's being unlinked because of packaging dumbness out of our control\nin setup.py, exclude caffe, caffe2 folders as well from being included in package.", "body": "Statically linking CuDNN and NCCL2 allows us to `nvprune` the libraries and include only the architectures that we support. This saves > 100MB in binary size.\r\n\r\nList of changes:\r\n- add flags to look for libnccl_static.a instead of libnccl.so* (also included in gloo and upstreamed, updated submodule)\r\n- add flags to look for libcudnn_static.a instead of libcudnn.so*\r\n- when linking statically, we have to link against `libculibos.a`. Added an ATen flag for that\r\n\r\nAdditional minor changes:\r\n- removed SOVERSION for libATen, in binaries it's being unlinked because of packaging dumbness out of our control\r\n- in `setup.py`, exclude caffe, caffe2 folders as well from being included in package."}