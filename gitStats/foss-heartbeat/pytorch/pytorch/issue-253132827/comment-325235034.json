{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/325235034", "html_url": "https://github.com/pytorch/pytorch/issues/2545#issuecomment-325235034", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/2545", "id": 325235034, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTIzNTAzNA==", "user": {"login": "Jiaming-Liu", "id": 16099575, "node_id": "MDQ6VXNlcjE2MDk5NTc1", "avatar_url": "https://avatars3.githubusercontent.com/u/16099575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jiaming-Liu", "html_url": "https://github.com/Jiaming-Liu", "followers_url": "https://api.github.com/users/Jiaming-Liu/followers", "following_url": "https://api.github.com/users/Jiaming-Liu/following{/other_user}", "gists_url": "https://api.github.com/users/Jiaming-Liu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jiaming-Liu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jiaming-Liu/subscriptions", "organizations_url": "https://api.github.com/users/Jiaming-Liu/orgs", "repos_url": "https://api.github.com/users/Jiaming-Liu/repos", "events_url": "https://api.github.com/users/Jiaming-Liu/events{/privacy}", "received_events_url": "https://api.github.com/users/Jiaming-Liu/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-28T00:31:18Z", "updated_at": "2017-08-28T00:31:18Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Another test case:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">from</span> torch.optim.lr_scheduler <span class=\"pl-k\">import</span> ReduceLROnPlateau\nn<span class=\"pl-k\">=</span>torch.nn.Linear(<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>)\nopt <span class=\"pl-k\">=</span> torch.optim.SGD(n.parameters(), <span class=\"pl-v\">lr</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0.1</span>)\nrp <span class=\"pl-k\">=</span> ReduceLROnPlateau(opt, <span class=\"pl-v\">patience</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">2</span>, <span class=\"pl-v\">cooldown</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0</span>)\nmetrics <span class=\"pl-k\">=</span> [<span class=\"pl-c1\">10</span>.,<span class=\"pl-c1\">10</span>.,<span class=\"pl-c1\">10</span>.,<span class=\"pl-c1\">1</span>.,<span class=\"pl-c1\">1</span>.,<span class=\"pl-c1\">1</span>.,<span class=\"pl-c1\">0.1</span>,<span class=\"pl-c1\">0.1</span>,<span class=\"pl-c1\">0.1</span>,<span class=\"pl-c1\">0.1</span>,<span class=\"pl-c1\">0.1</span>]\n<span class=\"pl-k\">for</span> epoch <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">10</span>):\n    <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>---------<span class=\"pl-pds\">'</span></span>)\n    <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>epoch: <span class=\"pl-c1\">%d</span><span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">%</span> epoch)\n    <span class=\"pl-c1\">print</span>(opt.param_groups[<span class=\"pl-c1\">0</span>][<span class=\"pl-s\"><span class=\"pl-pds\">'</span>lr<span class=\"pl-pds\">'</span></span>])\n    <span class=\"pl-c\"><span class=\"pl-c\">#</span> train_one_epoch(...)</span>\n    <span class=\"pl-c\"><span class=\"pl-c\">#</span> metrics = validate(...)</span>\n    <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>metrics: <span class=\"pl-c1\">%f</span><span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">%</span> metrics[epoch])\n    rp.step(<span class=\"pl-v\">metrics</span><span class=\"pl-k\">=</span>metrics[epoch])</pre></div>\n<p>Result:</p>\n<pre><code>---------\nepoch: 0\n0.1\nmetrics: 10.000000\n'UPDATED_BEST'\n---------\nepoch: 1\n0.1\nmetrics: 10.000000\n'WAITING'\n---------\nepoch: 2\n0.1\nmetrics: 10.000000\n'WAITING'\n---------\nepoch: 3\n0.1\nmetrics: 1.000000\n'UPDATED_BEST'\n---------\nepoch: 4\n0.1\nmetrics: 1.000000\n'WAITING'\n---------\nepoch: 5\n0.1\nmetrics: 1.000000\n'WAITING'\n---------\nepoch: 6\n0.1\nmetrics: 0.100000\n'UPDATED_BEST'\n---------\nepoch: 7\n0.1\nmetrics: 0.100000\n'WAITING'\n---------\nepoch: 8\n0.1\nmetrics: 0.100000\n'WAITING'\n---------\nepoch: 9\n0.1\nmetrics: 0.100000\n'REDUCED_LR'\n</code></pre>", "body_text": "Another test case:\nimport torch\nfrom torch.optim.lr_scheduler import ReduceLROnPlateau\nn=torch.nn.Linear(1,1)\nopt = torch.optim.SGD(n.parameters(), lr=0.1)\nrp = ReduceLROnPlateau(opt, patience=2, cooldown=0)\nmetrics = [10.,10.,10.,1.,1.,1.,0.1,0.1,0.1,0.1,0.1]\nfor epoch in range(10):\n    print('---------')\n    print('epoch: %d' % epoch)\n    print(opt.param_groups[0]['lr'])\n    # train_one_epoch(...)\n    # metrics = validate(...)\n    print('metrics: %f' % metrics[epoch])\n    rp.step(metrics=metrics[epoch])\nResult:\n---------\nepoch: 0\n0.1\nmetrics: 10.000000\n'UPDATED_BEST'\n---------\nepoch: 1\n0.1\nmetrics: 10.000000\n'WAITING'\n---------\nepoch: 2\n0.1\nmetrics: 10.000000\n'WAITING'\n---------\nepoch: 3\n0.1\nmetrics: 1.000000\n'UPDATED_BEST'\n---------\nepoch: 4\n0.1\nmetrics: 1.000000\n'WAITING'\n---------\nepoch: 5\n0.1\nmetrics: 1.000000\n'WAITING'\n---------\nepoch: 6\n0.1\nmetrics: 0.100000\n'UPDATED_BEST'\n---------\nepoch: 7\n0.1\nmetrics: 0.100000\n'WAITING'\n---------\nepoch: 8\n0.1\nmetrics: 0.100000\n'WAITING'\n---------\nepoch: 9\n0.1\nmetrics: 0.100000\n'REDUCED_LR'", "body": "Another test case:\r\n``` Python\r\nimport torch\r\nfrom torch.optim.lr_scheduler import ReduceLROnPlateau\r\nn=torch.nn.Linear(1,1)\r\nopt = torch.optim.SGD(n.parameters(), lr=0.1)\r\nrp = ReduceLROnPlateau(opt, patience=2, cooldown=0)\r\nmetrics = [10.,10.,10.,1.,1.,1.,0.1,0.1,0.1,0.1,0.1]\r\nfor epoch in range(10):\r\n    print('---------')\r\n    print('epoch: %d' % epoch)\r\n    print(opt.param_groups[0]['lr'])\r\n    # train_one_epoch(...)\r\n    # metrics = validate(...)\r\n    print('metrics: %f' % metrics[epoch])\r\n    rp.step(metrics=metrics[epoch])\r\n```\r\n\r\nResult:\r\n```\r\n---------\r\nepoch: 0\r\n0.1\r\nmetrics: 10.000000\r\n'UPDATED_BEST'\r\n---------\r\nepoch: 1\r\n0.1\r\nmetrics: 10.000000\r\n'WAITING'\r\n---------\r\nepoch: 2\r\n0.1\r\nmetrics: 10.000000\r\n'WAITING'\r\n---------\r\nepoch: 3\r\n0.1\r\nmetrics: 1.000000\r\n'UPDATED_BEST'\r\n---------\r\nepoch: 4\r\n0.1\r\nmetrics: 1.000000\r\n'WAITING'\r\n---------\r\nepoch: 5\r\n0.1\r\nmetrics: 1.000000\r\n'WAITING'\r\n---------\r\nepoch: 6\r\n0.1\r\nmetrics: 0.100000\r\n'UPDATED_BEST'\r\n---------\r\nepoch: 7\r\n0.1\r\nmetrics: 0.100000\r\n'WAITING'\r\n---------\r\nepoch: 8\r\n0.1\r\nmetrics: 0.100000\r\n'WAITING'\r\n---------\r\nepoch: 9\r\n0.1\r\nmetrics: 0.100000\r\n'REDUCED_LR'\r\n```"}