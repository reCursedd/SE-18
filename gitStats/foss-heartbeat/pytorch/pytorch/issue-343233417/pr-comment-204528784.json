{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/204528784", "pull_request_review_id": 139623205, "id": 204528784, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNDUyODc4NA==", "diff_hunk": "@@ -30,13 +30,26 @@ cmake --version\n pip install -r requirements.txt || true\n \n if [[ \"$BUILD_ENVIRONMENT\" == *rocm* ]]; then\n+  # This is necessary in order to cross compile (or else we'll have missing GPU device).\n   export HCC_AMDGPU_TARGET=gfx900\n+\n+  # These environment variables are not set on CI when we were running as the Jenkins user.\n+  # The HIP Utility scripts require these environment variables to be set in order to run without error.\n   export LANG=C.UTF-8\n   export LC_ALL=C.UTF-8\n+  export PYTORCH_BUILT_WITH_ROCM=1", "path": ".jenkins/pytorch/build.sh", "position": null, "original_position": 11, "commit_id": "970fecb775ae98f7840bf550a849b426323f6b61", "original_commit_id": "a15fe4e22096bda4ae8aec374b49123ff56308b8", "user": {"login": "jithunnair-amd", "id": 37884920, "node_id": "MDQ6VXNlcjM3ODg0OTIw", "avatar_url": "https://avatars1.githubusercontent.com/u/37884920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jithunnair-amd", "html_url": "https://github.com/jithunnair-amd", "followers_url": "https://api.github.com/users/jithunnair-amd/followers", "following_url": "https://api.github.com/users/jithunnair-amd/following{/other_user}", "gists_url": "https://api.github.com/users/jithunnair-amd/gists{/gist_id}", "starred_url": "https://api.github.com/users/jithunnair-amd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jithunnair-amd/subscriptions", "organizations_url": "https://api.github.com/users/jithunnair-amd/orgs", "repos_url": "https://api.github.com/users/jithunnair-amd/repos", "events_url": "https://api.github.com/users/jithunnair-amd/events{/privacy}", "received_events_url": "https://api.github.com/users/jithunnair-amd/received_events", "type": "User", "site_admin": false}, "body": "@ezyang The intention was to set the env variable if we're building with ROCm, so that when we run the unit tests, they know to skip certain unit tests for ROCm. Since $BUILD_ENVIRONMENT is defined in the CI runs, but not in the local runs, this method would allow one to define the PYTORCH_TEST_WITH_ROCM in a local run to replicate the same desired behavior. If you want to move the definition of the define to the test script, what should the condition for it be? ", "created_at": "2018-07-23T19:37:25Z", "updated_at": "2018-11-23T15:47:56Z", "html_url": "https://github.com/pytorch/pytorch/pull/9653#discussion_r204528784", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/9653", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/204528784"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/9653#discussion_r204528784"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/9653"}}, "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=13564\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ezyang\">@ezyang</a> The intention was to set the env variable if we're building with ROCm, so that when we run the unit tests, they know to skip certain unit tests for ROCm. Since $BUILD_ENVIRONMENT is defined in the CI runs, but not in the local runs, this method would allow one to define the PYTORCH_TEST_WITH_ROCM in a local run to replicate the same desired behavior. If you want to move the definition of the define to the test script, what should the condition for it be?</p>", "body_text": "@ezyang The intention was to set the env variable if we're building with ROCm, so that when we run the unit tests, they know to skip certain unit tests for ROCm. Since $BUILD_ENVIRONMENT is defined in the CI runs, but not in the local runs, this method would allow one to define the PYTORCH_TEST_WITH_ROCM in a local run to replicate the same desired behavior. If you want to move the definition of the define to the test script, what should the condition for it be?", "in_reply_to_id": 204434258}