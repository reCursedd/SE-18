{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/232800852", "pull_request_review_id": 174079715, "id": 232800852, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjgwMDg1Mg==", "diff_hunk": "@@ -644,27 +645,78 @@ ConvertedResult OnnxExporter::CreateLrnNodes(\n ConvertedResult OnnxExporter::CreateConcatNodes(\n     const caffe2::OperatorDef& def,\n     const std::unordered_map<std::string, caffe2::TensorShape>& shapes) {\n-  auto result = CommonCaffe2OpToOnnxNodes(def);\n+  caffe2::OperatorDef mdef(def); // The modified def without add_axis\n+  int add_axis = 0;\n+  for (int i = 0; i < mdef.arg_size(); ++i) {\n+    const auto& arg = mdef.arg(i);\n+    if (arg.name() == \"add_axis\") {\n+      add_axis = arg.i();\n+      ArgumentHelper::RemoveArgument(mdef, i);\n+      break;\n+    }\n+  }\n+\n+  auto result = CommonCaffe2OpToOnnxNodes(mdef);\n   auto& nodes = result.first;\n+  nodes.reserve(nodes.size() + 3);\n+  auto& const_tensors = result.second;\n \n   CAFFE_ENFORCE_EQ(nodes.size(), 1);\n   auto& node = nodes.back();\n   bool explicit_axis = false;\n-  for (const auto& a : def.arg()) {\n+  int axis = 1;", "path": "caffe2/onnx/onnx_exporter.cc", "position": null, "original_position": 32, "commit_id": "dfec79410e72a192932edd40fd92f80e40256d6a", "original_commit_id": "87866455984d694382bf011c36f87ccab9cf4014", "user": {"login": "houseroad", "id": 30275821, "node_id": "MDQ6VXNlcjMwMjc1ODIx", "avatar_url": "https://avatars0.githubusercontent.com/u/30275821?v=4", "gravatar_id": "", "url": "https://api.github.com/users/houseroad", "html_url": "https://github.com/houseroad", "followers_url": "https://api.github.com/users/houseroad/followers", "following_url": "https://api.github.com/users/houseroad/following{/other_user}", "gists_url": "https://api.github.com/users/houseroad/gists{/gist_id}", "starred_url": "https://api.github.com/users/houseroad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/houseroad/subscriptions", "organizations_url": "https://api.github.com/users/houseroad/orgs", "repos_url": "https://api.github.com/users/houseroad/repos", "events_url": "https://api.github.com/users/houseroad/events{/privacy}", "received_events_url": "https://api.github.com/users/houseroad/received_events", "type": "User", "site_admin": false}, "body": "I think default value is -1.", "created_at": "2018-11-12T20:27:15Z", "updated_at": "2018-11-23T15:54:40Z", "html_url": "https://github.com/pytorch/pytorch/pull/13798#discussion_r232800852", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/13798", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/232800852"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/13798#discussion_r232800852"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/13798"}}, "body_html": "<p>I think default value is -1.</p>", "body_text": "I think default value is -1."}