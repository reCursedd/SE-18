{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/104179293", "pull_request_review_id": 25001698, "id": 104179293, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDE3OTI5Mw==", "diff_hunk": "@@ -292,10 +294,9 @@ int THPVariable_set_backwards_hooks(THPVariable *self, PyObject *obj)\n   Py_XINCREF(obj);\n   Py_XDECREF(self->backward_hooks);\n   self->backward_hooks = obj;\n+  self->cdata->pre_hooks.clear();\n   if (obj) {\n-    self->cdata->backward_hook.reset(new PyGradHook(obj));\n-  } else {\n-    self->cdata->backward_hook.reset();\n+    self->cdata->pre_hooks.emplace_back(new PyFunctionPreHook(obj, 0));\n   }", "path": "torch/csrc/autograd/python_variable.cpp", "position": null, "original_position": 21, "commit_id": "6336300880349038c5bf6f5dfe3b37864eb39acb", "original_commit_id": "732f464faa2a72534be9a4bfcf848d06cde9e87c", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "it will remove them, but only from the Variable. The content of the field from the Variable doesn't matter, the important field is that vector inside the creator that will still remember the old value.", "created_at": "2017-03-03T15:44:57Z", "updated_at": "2018-11-23T15:32:43Z", "html_url": "https://github.com/pytorch/pytorch/pull/881#discussion_r104179293", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/881", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/104179293"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/881#discussion_r104179293"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/881"}}, "body_html": "<p>it will remove them, but only from the Variable. The content of the field from the Variable doesn't matter, the important field is that vector inside the creator that will still remember the old value.</p>", "body_text": "it will remove them, but only from the Variable. The content of the field from the Variable doesn't matter, the important field is that vector inside the creator that will still remember the old value.", "in_reply_to_id": 104134695}