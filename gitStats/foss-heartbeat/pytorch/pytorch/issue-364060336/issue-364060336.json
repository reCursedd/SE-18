{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12086", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12086/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12086/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12086/events", "html_url": "https://github.com/pytorch/pytorch/issues/12086", "id": 364060336, "node_id": "MDU6SXNzdWUzNjQwNjAzMzY=", "number": 12086, "title": "Caffe2 issues with using Glog without GFlags", "user": {"login": "tblattner", "id": 10550807, "node_id": "MDQ6VXNlcjEwNTUwODA3", "avatar_url": "https://avatars3.githubusercontent.com/u/10550807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tblattner", "html_url": "https://github.com/tblattner", "followers_url": "https://api.github.com/users/tblattner/followers", "following_url": "https://api.github.com/users/tblattner/following{/other_user}", "gists_url": "https://api.github.com/users/tblattner/gists{/gist_id}", "starred_url": "https://api.github.com/users/tblattner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tblattner/subscriptions", "organizations_url": "https://api.github.com/users/tblattner/orgs", "repos_url": "https://api.github.com/users/tblattner/repos", "events_url": "https://api.github.com/users/tblattner/events{/privacy}", "received_events_url": "https://api.github.com/users/tblattner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-26T14:31:27Z", "updated_at": "2018-10-01T17:43:23Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>Trying to compile caffe2 with Glog that is not compiled with GFlags is causing compilation errors.</p>\n<p>Is it required to build Glog with GFlags for Caffe2?</p>\n<p>If I <code>apt install libgoogle-glog-dev</code>, then I do not get the compilation errors. However this will also pull in GFlags.</p>\n<p>Also there does not appear to be a way to specify a custom install location for glog. I tried using <code>glog_DIR</code>, but it had no effect. I did manage to find GLOG_LIBRARY and GLOG_INCLUDE_DIR, which seems to work, but it is not available in the list of available options shown in ccmake.</p>\n<h2>Code example</h2>\n<p>Cmake configuration command:</p>\n<pre><code>cmake \n  -DBUILD_SHARED_LIBS=ON \n  -DCMAKE_BUILD_TYPE:STRING=Release \n  -DUSE_GFLAGS=OFF \n  -DUSE_GLOG=ON \n  -DUSE_LMDB=OFF \n  -DUSE_LEVELDB=OFF \n  -DUSE_NUMA=ON \n  -DUSE_OPENCV=OFF \n  -DBUILD_PYTHON=OFF \n  -DUSE_CUDA=ON \n  -DUSE_CUDNN=ON \n  -DUSE_MPI=OFF \n  -DUSE_NCCL=OFF \n  -DUSE_GLOO=OFF \n  -DUSE_IDEEP=OFF \n  -DUSE_MKLML=OFF \n  -DUSE_MKLDNN=OFF \n  -DGLOG_LIBRARY=/path/to/lib/libglog.so \n  -DGLOG_INCLUDE_DIR=/path/to/glog/include\n</code></pre>\n<p>Glog was installed from source from tag: v0.3.5 from <a href=\"https://github.com/google/glog/tree/v0.3.5\">https://github.com/google/glog/tree/v0.3.5</a></p>\n<p>These are the errors I am getting when compiling:</p>\n<pre><code>caffe2/core/logging.cc:84:12: error: \u2018FLAGS_minloglevel\u2019 is already declared in this scope\n using fLI::FLAGS_minloglevel;\n\ncaffe2/core/logging.cc:85:12: error: \u2018FLAGS_v\u2019 is already declared in this scope\n using fLI::FLAGS_v;\n\ncaffe2/core/logging.cc:86:12: error: \u2018FLAGS_logtostderr\u2019 is already declared in this scope\n using fLB::FLAGS_logtostderr;\n</code></pre>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: Caffe2</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): <code>cmake  -DBUILD_SHARED_LIBS=ON  -DCMAKE_BUILD_TYPE=Release  -DUSE_GFLAGS=OFF  -DUSE_GLOG=ON  -DUSE_LMDB=OFF  -DUSE_LEVELDB=OFF  -DUSE_NUMA=ON  -DUSE_OPENCV=OFF  -DBUILD_PYTHON=OFF  -DUSE_CUDA=ON  -DUSE_CUDNN=ON  -DUSE_MPI=OFF  -DUSE_NCCL=OFF  -DUSE_GLOO=OFF  -DUSE_IDEEP=OFF  -DUSE_MKLML=OFF  -DUSE_MKLDNN=OFF  -DGLOG_LIBRARY=/path/to/lib/libglog.so  -DGLOG_INCLUDE_DIR=/path/to/glog/include</code></li>\n<li>OS: Ubuntu 18.04</li>\n<li>PyTorch version: PYTORCH_COMMIT <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/784d34582828c1ebcb6bd2dfc0b5a4d135c422b9/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/784d34582828c1ebcb6bd2dfc0b5a4d135c422b9\"><tt>784d345</tt></a></li>\n<li>Python version: Python 3.6.5 :: Anaconda, Inc.</li>\n<li>CUDA/cuDNN version: 10.0/7.3.0</li>\n<li>GPU models and configuration: TITAN X (Pascal)</li>\n<li>GCC version (if compiling from source): 7.3.0</li>\n<li>CMake version: 3.12.2</li>\n<li>Versions of any other relevant libraries: Glog from source using v0.3.5</li>\n</ul>\n<p>cmake flags when building Glog:</p>\n<pre><code>    -DCMAKE_INSTALL_PREFIX=${EXTERNAL_INSTALL_LOCATION}\n    -DBUILD_SHARED_LIBS=ON\n    -DCMAKE_BUILD_TYPE=Release\n    -DWITH_GFLAGS=OFF\n</code></pre>", "body_text": "Issue description\nTrying to compile caffe2 with Glog that is not compiled with GFlags is causing compilation errors.\nIs it required to build Glog with GFlags for Caffe2?\nIf I apt install libgoogle-glog-dev, then I do not get the compilation errors. However this will also pull in GFlags.\nAlso there does not appear to be a way to specify a custom install location for glog. I tried using glog_DIR, but it had no effect. I did manage to find GLOG_LIBRARY and GLOG_INCLUDE_DIR, which seems to work, but it is not available in the list of available options shown in ccmake.\nCode example\nCmake configuration command:\ncmake \n  -DBUILD_SHARED_LIBS=ON \n  -DCMAKE_BUILD_TYPE:STRING=Release \n  -DUSE_GFLAGS=OFF \n  -DUSE_GLOG=ON \n  -DUSE_LMDB=OFF \n  -DUSE_LEVELDB=OFF \n  -DUSE_NUMA=ON \n  -DUSE_OPENCV=OFF \n  -DBUILD_PYTHON=OFF \n  -DUSE_CUDA=ON \n  -DUSE_CUDNN=ON \n  -DUSE_MPI=OFF \n  -DUSE_NCCL=OFF \n  -DUSE_GLOO=OFF \n  -DUSE_IDEEP=OFF \n  -DUSE_MKLML=OFF \n  -DUSE_MKLDNN=OFF \n  -DGLOG_LIBRARY=/path/to/lib/libglog.so \n  -DGLOG_INCLUDE_DIR=/path/to/glog/include\n\nGlog was installed from source from tag: v0.3.5 from https://github.com/google/glog/tree/v0.3.5\nThese are the errors I am getting when compiling:\ncaffe2/core/logging.cc:84:12: error: \u2018FLAGS_minloglevel\u2019 is already declared in this scope\n using fLI::FLAGS_minloglevel;\n\ncaffe2/core/logging.cc:85:12: error: \u2018FLAGS_v\u2019 is already declared in this scope\n using fLI::FLAGS_v;\n\ncaffe2/core/logging.cc:86:12: error: \u2018FLAGS_logtostderr\u2019 is already declared in this scope\n using fLB::FLAGS_logtostderr;\n\nSystem Info\n\nPyTorch or Caffe2: Caffe2\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): cmake  -DBUILD_SHARED_LIBS=ON  -DCMAKE_BUILD_TYPE=Release  -DUSE_GFLAGS=OFF  -DUSE_GLOG=ON  -DUSE_LMDB=OFF  -DUSE_LEVELDB=OFF  -DUSE_NUMA=ON  -DUSE_OPENCV=OFF  -DBUILD_PYTHON=OFF  -DUSE_CUDA=ON  -DUSE_CUDNN=ON  -DUSE_MPI=OFF  -DUSE_NCCL=OFF  -DUSE_GLOO=OFF  -DUSE_IDEEP=OFF  -DUSE_MKLML=OFF  -DUSE_MKLDNN=OFF  -DGLOG_LIBRARY=/path/to/lib/libglog.so  -DGLOG_INCLUDE_DIR=/path/to/glog/include\nOS: Ubuntu 18.04\nPyTorch version: PYTORCH_COMMIT 784d345\nPython version: Python 3.6.5 :: Anaconda, Inc.\nCUDA/cuDNN version: 10.0/7.3.0\nGPU models and configuration: TITAN X (Pascal)\nGCC version (if compiling from source): 7.3.0\nCMake version: 3.12.2\nVersions of any other relevant libraries: Glog from source using v0.3.5\n\ncmake flags when building Glog:\n    -DCMAKE_INSTALL_PREFIX=${EXTERNAL_INSTALL_LOCATION}\n    -DBUILD_SHARED_LIBS=ON\n    -DCMAKE_BUILD_TYPE=Release\n    -DWITH_GFLAGS=OFF", "body": "## Issue description\r\n\r\nTrying to compile caffe2 with Glog that is not compiled with GFlags is causing compilation errors.\r\n\r\nIs it required to build Glog with GFlags for Caffe2?\r\n\r\nIf I `apt install libgoogle-glog-dev`, then I do not get the compilation errors. However this will also pull in GFlags.\r\n\r\nAlso there does not appear to be a way to specify a custom install location for glog. I tried using `glog_DIR`, but it had no effect. I did manage to find GLOG_LIBRARY and GLOG_INCLUDE_DIR, which seems to work, but it is not available in the list of available options shown in ccmake.\r\n\r\n## Code example\r\n\r\nCmake configuration command: \r\n```\r\ncmake \r\n  -DBUILD_SHARED_LIBS=ON \r\n  -DCMAKE_BUILD_TYPE:STRING=Release \r\n  -DUSE_GFLAGS=OFF \r\n  -DUSE_GLOG=ON \r\n  -DUSE_LMDB=OFF \r\n  -DUSE_LEVELDB=OFF \r\n  -DUSE_NUMA=ON \r\n  -DUSE_OPENCV=OFF \r\n  -DBUILD_PYTHON=OFF \r\n  -DUSE_CUDA=ON \r\n  -DUSE_CUDNN=ON \r\n  -DUSE_MPI=OFF \r\n  -DUSE_NCCL=OFF \r\n  -DUSE_GLOO=OFF \r\n  -DUSE_IDEEP=OFF \r\n  -DUSE_MKLML=OFF \r\n  -DUSE_MKLDNN=OFF \r\n  -DGLOG_LIBRARY=/path/to/lib/libglog.so \r\n  -DGLOG_INCLUDE_DIR=/path/to/glog/include\r\n```\r\n\r\nGlog was installed from source from tag: v0.3.5 from https://github.com/google/glog/tree/v0.3.5\r\n\r\nThese are the errors I am getting when compiling:\r\n\r\n```\r\ncaffe2/core/logging.cc:84:12: error: \u2018FLAGS_minloglevel\u2019 is already declared in this scope\r\n using fLI::FLAGS_minloglevel;\r\n\r\ncaffe2/core/logging.cc:85:12: error: \u2018FLAGS_v\u2019 is already declared in this scope\r\n using fLI::FLAGS_v;\r\n\r\ncaffe2/core/logging.cc:86:12: error: \u2018FLAGS_logtostderr\u2019 is already declared in this scope\r\n using fLB::FLAGS_logtostderr;\r\n```\r\n\r\n\r\n## System Info\r\n- PyTorch or Caffe2: Caffe2\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): `cmake \r\n  -DBUILD_SHARED_LIBS=ON \r\n  -DCMAKE_BUILD_TYPE=Release \r\n  -DUSE_GFLAGS=OFF \r\n  -DUSE_GLOG=ON \r\n  -DUSE_LMDB=OFF \r\n  -DUSE_LEVELDB=OFF \r\n  -DUSE_NUMA=ON \r\n  -DUSE_OPENCV=OFF \r\n  -DBUILD_PYTHON=OFF \r\n  -DUSE_CUDA=ON \r\n  -DUSE_CUDNN=ON \r\n  -DUSE_MPI=OFF \r\n  -DUSE_NCCL=OFF \r\n  -DUSE_GLOO=OFF \r\n  -DUSE_IDEEP=OFF \r\n  -DUSE_MKLML=OFF \r\n  -DUSE_MKLDNN=OFF \r\n  -DGLOG_LIBRARY=/path/to/lib/libglog.so \r\n  -DGLOG_INCLUDE_DIR=/path/to/glog/include`\r\n- OS: Ubuntu 18.04\r\n- PyTorch version: PYTORCH_COMMIT 784d34582828c1ebcb6bd2dfc0b5a4d135c422b9\r\n- Python version: Python 3.6.5 :: Anaconda, Inc.\r\n- CUDA/cuDNN version: 10.0/7.3.0\r\n- GPU models and configuration: TITAN X (Pascal)\r\n- GCC version (if compiling from source): 7.3.0\r\n- CMake version: 3.12.2\r\n- Versions of any other relevant libraries: Glog from source using v0.3.5\r\n\r\ncmake flags when building Glog:\r\n```\r\n    -DCMAKE_INSTALL_PREFIX=${EXTERNAL_INSTALL_LOCATION}\r\n    -DBUILD_SHARED_LIBS=ON\r\n    -DCMAKE_BUILD_TYPE=Release\r\n    -DWITH_GFLAGS=OFF\r\n```"}