{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12320", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12320/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12320/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12320/events", "html_url": "https://github.com/pytorch/pytorch/issues/12320", "id": 366712912, "node_id": "MDU6SXNzdWUzNjY3MTI5MTI=", "number": 12320, "title": "derivatives.yaml does not update declarations.yaml", "user": {"login": "ohlr", "id": 26937880, "node_id": "MDQ6VXNlcjI2OTM3ODgw", "avatar_url": "https://avatars0.githubusercontent.com/u/26937880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ohlr", "html_url": "https://github.com/ohlr", "followers_url": "https://api.github.com/users/ohlr/followers", "following_url": "https://api.github.com/users/ohlr/following{/other_user}", "gists_url": "https://api.github.com/users/ohlr/gists{/gist_id}", "starred_url": "https://api.github.com/users/ohlr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ohlr/subscriptions", "organizations_url": "https://api.github.com/users/ohlr/orgs", "repos_url": "https://api.github.com/users/ohlr/repos", "events_url": "https://api.github.com/users/ohlr/events{/privacy}", "received_events_url": "https://api.github.com/users/ohlr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-10-04T10:02:06Z", "updated_at": "2018-10-05T07:28:37Z", "closed_at": "2018-10-04T16:23:31Z", "author_association": "CONTRIBUTOR", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p><a href=\"https://github.com/pytorch/pytorch/blob/master/tools/autograd/derivatives.yaml#L982\">derivatives.yaml</a><br>\nhas a declaration of thnn_conv2d_forward().</p>\n<p>However, when changing the declaration, e.g. by adding a new parameter ( ..., Scalar newParam, ...) the generated Declarations.yaml (/build/aten/src/ATen/Declarations.yaml) does not get updated.<br>\nSubsequently, \"aten/src/ATen/TypeDefault.h\" holds the wrong function definition, which leads to a compile error.</p>\n\n<p><a href=\"https://github.com/pytorch/pytorch/blob/master/tools/autograd/derivatives.yaml#L982\">derivatives.yaml</a>:</p>\n<ul>\n<li>name: thnn_conv2d_forward(Tensor self, Tensor weight, IntList kernel_size, Tensor bias, IntList stride, IntList padding, Scalar new Param)</li>\n</ul>\n<h2>Expected behavior</h2>\n<p>Change in the Declarations.yaml file (build folder)</p>\n<ul>\n<li>\n<p>name: thnn_conv2d_forward<br>\nmethod_prefix_derived: ''<br>\narguments:</p>\n<ul>\n<li>dynamic_type: Tensor<br>\nname: self<br>\ntype: const Tensor &amp;</li>\n<li>dynamic_type: Tensor<br>\nname: weight<br>\ntype: const Tensor &amp;</li>\n<li>dynamic_type: IntList<br>\nname: kernel_size<br>\nsize: 2<br>\ntype: IntList</li>\n<li>dynamic_type: Tensor<br>\nis_nullable: true<br>\nname: bias<br>\ntype: const Tensor &amp;</li>\n<li>dynamic_type: IntList<br>\nname: stride<br>\nsize: 2<br>\ntype: IntList</li>\n<li>dynamic_type: IntList<br>\nname: padding<br>\nsize: 2<br>\ntype: IntList<br>\n<strong>- additional parameter is not listed here</strong><br>\nmethod_of:</li>\n<li>Type</li>\n<li>namespace<br>\nmode: NN<br>\nbuffers: []<br>\nreturns:</li>\n<li>dynamic_type: Tensor<br>\nname: output<br>\ntype: Tensor</li>\n<li>dynamic_type: Tensor<br>\nname: finput<br>\ntype: Tensor</li>\n<li>dynamic_type: Tensor<br>\nname: fgrad_input<br>\ntype: Tensor<br>\ninplace: false<br>\nabstract: true<br>\ndevice_guard: true<br>\nwith_gil: false<br>\ndeprecated: false</li>\n</ul>\n</li>\n<li>\n<p>OS (e.g., Linux): Ubuntu 16.04</p>\n</li>\n<li>\n<p>Build command you used (if compiling from source): python setup.py build develop</p>\n</li>\n<li>\n<p>Python version: 3.5.6</p>\n</li>\n<li>\n<p>CUDA/cuDNN version: 9.2</p>\n</li>\n</ul>", "body_text": "\ud83d\udc1b Bug\nderivatives.yaml\nhas a declaration of thnn_conv2d_forward().\nHowever, when changing the declaration, e.g. by adding a new parameter ( ..., Scalar newParam, ...) the generated Declarations.yaml (/build/aten/src/ATen/Declarations.yaml) does not get updated.\nSubsequently, \"aten/src/ATen/TypeDefault.h\" holds the wrong function definition, which leads to a compile error.\n\nderivatives.yaml:\n\nname: thnn_conv2d_forward(Tensor self, Tensor weight, IntList kernel_size, Tensor bias, IntList stride, IntList padding, Scalar new Param)\n\nExpected behavior\nChange in the Declarations.yaml file (build folder)\n\n\nname: thnn_conv2d_forward\nmethod_prefix_derived: ''\narguments:\n\ndynamic_type: Tensor\nname: self\ntype: const Tensor &\ndynamic_type: Tensor\nname: weight\ntype: const Tensor &\ndynamic_type: IntList\nname: kernel_size\nsize: 2\ntype: IntList\ndynamic_type: Tensor\nis_nullable: true\nname: bias\ntype: const Tensor &\ndynamic_type: IntList\nname: stride\nsize: 2\ntype: IntList\ndynamic_type: IntList\nname: padding\nsize: 2\ntype: IntList\n- additional parameter is not listed here\nmethod_of:\nType\nnamespace\nmode: NN\nbuffers: []\nreturns:\ndynamic_type: Tensor\nname: output\ntype: Tensor\ndynamic_type: Tensor\nname: finput\ntype: Tensor\ndynamic_type: Tensor\nname: fgrad_input\ntype: Tensor\ninplace: false\nabstract: true\ndevice_guard: true\nwith_gil: false\ndeprecated: false\n\n\n\nOS (e.g., Linux): Ubuntu 16.04\n\n\nBuild command you used (if compiling from source): python setup.py build develop\n\n\nPython version: 3.5.6\n\n\nCUDA/cuDNN version: 9.2", "body": "## \ud83d\udc1b Bug\r\n[derivatives.yaml](https://github.com/pytorch/pytorch/blob/master/tools/autograd/derivatives.yaml#L982)\r\nhas a declaration of thnn_conv2d_forward().\r\n\r\nHowever, when changing the declaration, e.g. by adding a new parameter ( ..., Scalar newParam, ...) the generated Declarations.yaml (/build/aten/src/ATen/Declarations.yaml) does not get updated.\r\nSubsequently, \"aten/src/ATen/TypeDefault.h\" holds the wrong function definition, which leads to a compile error.\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n[derivatives.yaml](https://github.com/pytorch/pytorch/blob/master/tools/autograd/derivatives.yaml#L982):\r\n- name: thnn_conv2d_forward(Tensor self, Tensor weight, IntList kernel_size, Tensor bias, IntList stride, IntList padding, Scalar new Param)\r\n\r\n\r\n## Expected behavior\r\nChange in the Declarations.yaml file (build folder)\r\n\r\n- name: thnn_conv2d_forward\r\n  method_prefix_derived: ''\r\n  arguments:\r\n  - dynamic_type: Tensor\r\n    name: self\r\n    type: const Tensor &\r\n  - dynamic_type: Tensor\r\n    name: weight\r\n    type: const Tensor &\r\n  - dynamic_type: IntList\r\n    name: kernel_size\r\n    size: 2\r\n    type: IntList\r\n  - dynamic_type: Tensor\r\n    is_nullable: true\r\n    name: bias\r\n    type: const Tensor &\r\n  - dynamic_type: IntList\r\n    name: stride\r\n    size: 2\r\n    type: IntList\r\n  - dynamic_type: IntList\r\n    name: padding\r\n    size: 2\r\n    type: IntList\r\n **- additional parameter is not listed here**\r\n  method_of:\r\n  - Type\r\n  - namespace\r\n  mode: NN\r\n  buffers: []\r\n  returns:\r\n  - dynamic_type: Tensor\r\n    name: output\r\n    type: Tensor\r\n  - dynamic_type: Tensor\r\n    name: finput\r\n    type: Tensor\r\n  - dynamic_type: Tensor\r\n    name: fgrad_input\r\n    type: Tensor\r\n  inplace: false\r\n  abstract: true\r\n  device_guard: true\r\n  with_gil: false\r\n  deprecated: false\r\n\r\n - OS (e.g., Linux): Ubuntu 16.04\r\n - Build command you used (if compiling from source): python setup.py build develop\r\n - Python version: 3.5.6\r\n - CUDA/cuDNN version: 9.2\r\n"}