{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/399090386", "html_url": "https://github.com/pytorch/pytorch/issues/8741#issuecomment-399090386", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8741", "id": 399090386, "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTA5MDM4Ng==", "user": {"login": "vishwakftw", "id": 23639302, "node_id": "MDQ6VXNlcjIzNjM5MzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/23639302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vishwakftw", "html_url": "https://github.com/vishwakftw", "followers_url": "https://api.github.com/users/vishwakftw/followers", "following_url": "https://api.github.com/users/vishwakftw/following{/other_user}", "gists_url": "https://api.github.com/users/vishwakftw/gists{/gist_id}", "starred_url": "https://api.github.com/users/vishwakftw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vishwakftw/subscriptions", "organizations_url": "https://api.github.com/users/vishwakftw/orgs", "repos_url": "https://api.github.com/users/vishwakftw/repos", "events_url": "https://api.github.com/users/vishwakftw/events{/privacy}", "received_events_url": "https://api.github.com/users/vishwakftw/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-21T12:43:28Z", "updated_at": "2018-06-21T12:43:28Z", "author_association": "CONTRIBUTOR", "body_html": "<p>This is because <code>network.parameters()</code> is on the CPU, and <code>optim</code> has based on those parameters. When you do <code>network.to(torch.device('cuda'))</code> the location of the parameters change, and are the same as the ones that <code>optim</code> was instantiated with.</p>\n<p>If you do re-instantiate <code>optim</code>, the optimizer will work correctly.</p>", "body_text": "This is because network.parameters() is on the CPU, and optim has based on those parameters. When you do network.to(torch.device('cuda')) the location of the parameters change, and are the same as the ones that optim was instantiated with.\nIf you do re-instantiate optim, the optimizer will work correctly.", "body": "This is because `network.parameters()` is on the CPU, and `optim` has based on those parameters. When you do `network.to(torch.device('cuda'))` the location of the parameters change, and are the same as the ones that `optim` was instantiated with.\r\n\r\nIf you do re-instantiate `optim`, the optimizer will work correctly."}