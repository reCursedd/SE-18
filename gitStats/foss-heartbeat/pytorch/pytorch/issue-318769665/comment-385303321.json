{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/385303321", "html_url": "https://github.com/pytorch/pytorch/issues/7083#issuecomment-385303321", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/7083", "id": 385303321, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTMwMzMyMQ==", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-30T02:34:34Z", "updated_at": "2018-04-30T02:34:34Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Yeah, it sounds like we're picking up the wrong MKL and not giving you a knob to change which one we pick. You can confirm this if you post the build log, and we can see in the cmake configuration lines which ones it's detecting.</p>\n<p>It doesn't look like setup.py has a knob for setting MKL. <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=79994\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/orionr\">@orionr</a> is working on a refactor that would obsolete the setup.py, so it's probably not worth fixing directly.  You can probably poke it some more by editing <code>./aten/src/TH/cmake/FindMKL.cmake</code></p>\n<blockquote>\n<p>I tried setting the MKLROOT env variable as suggested in this issue, but that didn't work either. Additionally, I tried setting MKLMLROOT=/usr/local/anaconda2 based on line 111 of pytorch/cmake/Modules/FindMKL.cmake where it looks like that's the env variable it looks for:</p>\n</blockquote>\n<p>Wrong MKL find script. You want <code>./aten/src/TH/cmake/FindMKL.cmake</code> (and yes, we are in the process of consolidating these. Repo merge fallout.)</p>", "body_text": "Yeah, it sounds like we're picking up the wrong MKL and not giving you a knob to change which one we pick. You can confirm this if you post the build log, and we can see in the cmake configuration lines which ones it's detecting.\nIt doesn't look like setup.py has a knob for setting MKL. @orionr is working on a refactor that would obsolete the setup.py, so it's probably not worth fixing directly.  You can probably poke it some more by editing ./aten/src/TH/cmake/FindMKL.cmake\n\nI tried setting the MKLROOT env variable as suggested in this issue, but that didn't work either. Additionally, I tried setting MKLMLROOT=/usr/local/anaconda2 based on line 111 of pytorch/cmake/Modules/FindMKL.cmake where it looks like that's the env variable it looks for:\n\nWrong MKL find script. You want ./aten/src/TH/cmake/FindMKL.cmake (and yes, we are in the process of consolidating these. Repo merge fallout.)", "body": "Yeah, it sounds like we're picking up the wrong MKL and not giving you a knob to change which one we pick. You can confirm this if you post the build log, and we can see in the cmake configuration lines which ones it's detecting.\r\n\r\nIt doesn't look like setup.py has a knob for setting MKL. @orionr is working on a refactor that would obsolete the setup.py, so it's probably not worth fixing directly.  You can probably poke it some more by editing `./aten/src/TH/cmake/FindMKL.cmake`\r\n\r\n> I tried setting the MKLROOT env variable as suggested in this issue, but that didn't work either. Additionally, I tried setting MKLMLROOT=/usr/local/anaconda2 based on line 111 of pytorch/cmake/Modules/FindMKL.cmake where it looks like that's the env variable it looks for:\r\n\r\nWrong MKL find script. You want `./aten/src/TH/cmake/FindMKL.cmake` (and yes, we are in the process of consolidating these. Repo merge fallout.)"}