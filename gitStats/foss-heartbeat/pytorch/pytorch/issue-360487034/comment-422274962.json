{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/422274962", "html_url": "https://github.com/pytorch/pytorch/pull/11725#issuecomment-422274962", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11725", "id": 422274962, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjI3NDk2Mg==", "user": {"login": "peterjc123", "id": 9998726, "node_id": "MDQ6VXNlcjk5OTg3MjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/9998726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peterjc123", "html_url": "https://github.com/peterjc123", "followers_url": "https://api.github.com/users/peterjc123/followers", "following_url": "https://api.github.com/users/peterjc123/following{/other_user}", "gists_url": "https://api.github.com/users/peterjc123/gists{/gist_id}", "starred_url": "https://api.github.com/users/peterjc123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peterjc123/subscriptions", "organizations_url": "https://api.github.com/users/peterjc123/orgs", "repos_url": "https://api.github.com/users/peterjc123/repos", "events_url": "https://api.github.com/users/peterjc123/events{/privacy}", "received_events_url": "https://api.github.com/users/peterjc123/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-18T06:47:04Z", "updated_at": "2018-09-18T07:04:56Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6429851\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/goldsborough\">@goldsborough</a> Is reloaded_jit_extension_v1 built twice? When built for the first time, it should be okay from the log. But the second time, it would fail because it is still being used(loaded in python). We could not delete one file under this circumstances.<br>\nPossible solution:</p>\n<ol>\n<li>Unload the DLL (impossible)</li>\n<li>Append hash into filename (hard to load)</li>\n<li>Generate libraries in new directories and use the latest one by appending PATHs or using some sorting method (feasible)</li>\n<li>Skip this test (not good but it is the last way to go)</li>\n</ol>\n<pre><code>17:45:28 Building extension module reloaded_jit_extension...\n17:45:28 Loading extension module reloaded_jit_extension...\n17:45:28 Using C:\\Windows\\TEMP\\torch_extensions as PyTorch extensions root...\n17:45:28 Emitting ninja build file C:\\Windows\\TEMP\\torch_extensions\\reloaded_jit_extension\\build.ninja...\n17:45:28 Building extension module reloaded_jit_extension_v1... (first time: okay)\n17:45:28 Loading extension module reloaded_jit_extension_v1...\n17:45:28 Using C:\\Windows\\TEMP\\torch_extensions as PyTorch extensions root...\n17:45:28 Emitting ninja build file C:\\Windows\\TEMP\\torch_extensions\\reloaded_jit_extension\\build.ninja...\n17:45:28 Building extension module reloaded_jit_extension_v1... (second time: fail)\n17:45:28 Traceback (most recent call last):\n17:45:28   File \"run_test.py\", line 392, in &lt;module&gt;\n17:45:28     main()\n17:45:28   File \"run_test.py\", line 384, in main\n17:45:28     raise RuntimeError(message)\n17:45:28 RuntimeError: test_cpp_extensions failed!\n</code></pre>", "body_text": "@goldsborough Is reloaded_jit_extension_v1 built twice? When built for the first time, it should be okay from the log. But the second time, it would fail because it is still being used(loaded in python). We could not delete one file under this circumstances.\nPossible solution:\n\nUnload the DLL (impossible)\nAppend hash into filename (hard to load)\nGenerate libraries in new directories and use the latest one by appending PATHs or using some sorting method (feasible)\nSkip this test (not good but it is the last way to go)\n\n17:45:28 Building extension module reloaded_jit_extension...\n17:45:28 Loading extension module reloaded_jit_extension...\n17:45:28 Using C:\\Windows\\TEMP\\torch_extensions as PyTorch extensions root...\n17:45:28 Emitting ninja build file C:\\Windows\\TEMP\\torch_extensions\\reloaded_jit_extension\\build.ninja...\n17:45:28 Building extension module reloaded_jit_extension_v1... (first time: okay)\n17:45:28 Loading extension module reloaded_jit_extension_v1...\n17:45:28 Using C:\\Windows\\TEMP\\torch_extensions as PyTorch extensions root...\n17:45:28 Emitting ninja build file C:\\Windows\\TEMP\\torch_extensions\\reloaded_jit_extension\\build.ninja...\n17:45:28 Building extension module reloaded_jit_extension_v1... (second time: fail)\n17:45:28 Traceback (most recent call last):\n17:45:28   File \"run_test.py\", line 392, in <module>\n17:45:28     main()\n17:45:28   File \"run_test.py\", line 384, in main\n17:45:28     raise RuntimeError(message)\n17:45:28 RuntimeError: test_cpp_extensions failed!", "body": "@goldsborough Is reloaded_jit_extension_v1 built twice? When built for the first time, it should be okay from the log. But the second time, it would fail because it is still being used(loaded in python). We could not delete one file under this circumstances. \r\nPossible solution:\r\n1. Unload the DLL (impossible)\r\n2. Append hash into filename (hard to load)\r\n3. Generate libraries in new directories and use the latest one by appending PATHs or using some sorting method (feasible)\r\n4. Skip this test (not good but it is the last way to go)\r\n```\r\n17:45:28 Building extension module reloaded_jit_extension...\r\n17:45:28 Loading extension module reloaded_jit_extension...\r\n17:45:28 Using C:\\Windows\\TEMP\\torch_extensions as PyTorch extensions root...\r\n17:45:28 Emitting ninja build file C:\\Windows\\TEMP\\torch_extensions\\reloaded_jit_extension\\build.ninja...\r\n17:45:28 Building extension module reloaded_jit_extension_v1... (first time: okay)\r\n17:45:28 Loading extension module reloaded_jit_extension_v1...\r\n17:45:28 Using C:\\Windows\\TEMP\\torch_extensions as PyTorch extensions root...\r\n17:45:28 Emitting ninja build file C:\\Windows\\TEMP\\torch_extensions\\reloaded_jit_extension\\build.ninja...\r\n17:45:28 Building extension module reloaded_jit_extension_v1... (second time: fail)\r\n17:45:28 Traceback (most recent call last):\r\n17:45:28   File \"run_test.py\", line 392, in <module>\r\n17:45:28     main()\r\n17:45:28   File \"run_test.py\", line 384, in main\r\n17:45:28     raise RuntimeError(message)\r\n17:45:28 RuntimeError: test_cpp_extensions failed!\r\n```"}