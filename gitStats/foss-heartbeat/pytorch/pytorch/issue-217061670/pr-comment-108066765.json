{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/108066765", "pull_request_review_id": 29074279, "id": 108066765, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwODA2Njc2NQ==", "diff_hunk": "@@ -0,0 +1,26 @@\n+from . import CWrapPlugin\n+from string import Template\n+\n+\n+class WrapDim(CWrapPlugin):\n+\n+    DIM_WRAP_TEMPLATE = Template(\n+        \"\"\"if (${arg_to_wrap} < 0) ${arg_to_wrap} += ${arg_tensor}->nDimension;\"\"\")", "path": "tools/cwrap/plugins/WrapDim.py", "position": null, "original_position": 8, "commit_id": "37d95687c47beab841cd67003de3390414db0dca", "original_commit_id": "3e68f2e15759d496784d24321583ff29f6936159", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "Actually it would be better to do some additional checks. Otherwise people might get some weird error messages, because the values might still be invalid even after shifting them. Just add\r\n```c\r\nTHPUtils_assert(${arg_to_wrap} >= -nDimension && ${arg_to_wrap} < nDimension,\r\n                \"dimension out of range (expected to be in range of [%d, %d], but got %d)\",\r\n                ...)\r\n```", "created_at": "2017-03-26T18:00:17Z", "updated_at": "2018-11-23T15:32:52Z", "html_url": "https://github.com/pytorch/pytorch/pull/1108#discussion_r108066765", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/1108", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/108066765"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/1108#discussion_r108066765"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/1108"}}, "body_html": "<p>Actually it would be better to do some additional checks. Otherwise people might get some weird error messages, because the values might still be invalid even after shifting them. Just add</p>\n<div class=\"highlight highlight-source-c\"><pre><span class=\"pl-en\">THPUtils_assert</span>(${arg_to_wrap} &gt;= -nDimension &amp;&amp; ${arg_to_wrap} &lt; nDimension,\n                <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>dimension out of range (expected to be in range of [<span class=\"pl-c1\">%d</span>, <span class=\"pl-c1\">%d</span>], but got <span class=\"pl-c1\">%d</span>)<span class=\"pl-pds\">\"</span></span>,\n                ...)</pre></div>", "body_text": "Actually it would be better to do some additional checks. Otherwise people might get some weird error messages, because the values might still be invalid even after shifting them. Just add\nTHPUtils_assert(${arg_to_wrap} >= -nDimension && ${arg_to_wrap} < nDimension,\n                \"dimension out of range (expected to be in range of [%d, %d], but got %d)\",\n                ...)"}