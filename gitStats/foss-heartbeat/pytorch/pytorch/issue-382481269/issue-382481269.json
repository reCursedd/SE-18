{"url": "https://api.github.com/repos/pytorch/pytorch/issues/14215", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/14215/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/14215/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/14215/events", "html_url": "https://github.com/pytorch/pytorch/issues/14215", "id": 382481269, "node_id": "MDU6SXNzdWUzODI0ODEyNjk=", "number": 14215, "title": "Building from source error", "user": {"login": "SingL3", "id": 20473466, "node_id": "MDQ6VXNlcjIwNDczNDY2", "avatar_url": "https://avatars1.githubusercontent.com/u/20473466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SingL3", "html_url": "https://github.com/SingL3", "followers_url": "https://api.github.com/users/SingL3/followers", "following_url": "https://api.github.com/users/SingL3/following{/other_user}", "gists_url": "https://api.github.com/users/SingL3/gists{/gist_id}", "starred_url": "https://api.github.com/users/SingL3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SingL3/subscriptions", "organizations_url": "https://api.github.com/users/SingL3/orgs", "repos_url": "https://api.github.com/users/SingL3/repos", "events_url": "https://api.github.com/users/SingL3/events{/privacy}", "received_events_url": "https://api.github.com/users/SingL3/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-11-20T03:10:21Z", "updated_at": "2018-11-21T03:13:46Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>Hello! I am trying to install pytorch from source in conda, and I got these error message:</p>\n<blockquote>\n<p>/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:31:17: error: \u2018ncclInt8\u2019 was not declared in this scope<br>\n{at::kChar, ncclInt8},<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:32:17: error: \u2018ncclUint8\u2019 was not declared in this scope<br>\n{at::kByte, ncclUint8},<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:35:16: error: \u2018ncclInt32\u2019 was not declared in this scope<br>\n{at::kInt, ncclInt32},<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:38:1: error: could not convert \u2018{{at::kChar, }, {at::kByte, }, {at::kFloat, ncclFloat}, {at::kDouble, ncclDouble}, {at::kInt, }, {at::kLong, ncclInt64}, {at::kHalf, ncclHalf}}\u2019 from \u2018\u2019 to \u2018std::unordered_map&lt;at::ScalarType, ncclDataType_t&gt;\u2019<br>\n};<br>\n^<br>\nIn file included from /home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:1:0:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018void thd::DataChannelNccl::_destroyNcclResources(THDGroup)\u2019:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:187:40: error: void value not ignored as it ought to be<br>\nNCCL_CHECK(ncclCommDestroy(comm));<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018thd::NcclResourcePair thd::DataChannelNccl::_getNcclResourcePair(std::vectorat::Tensor&amp;, THDGroup)\u2019:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:295:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupStart());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:302:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupEnd());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allReduce(std::vectorat::Tensor&amp;, THDReduceOp, THDGroup)\u2019:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:417:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupStart());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:432:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupEnd());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allGather(std::vectorat::Tensor&amp;, std::vectorat::Tensor&amp;, THDGroup)\u2019:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:466:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupStart());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:473:27: error: invalid conversion from \u2018void*\u2019 to \u2018int\u2019 [-fpermissive]<br>\noutput[i].data_ptr(),<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:474:23: error: invalid conversion from \u2018int64_t {aka long int}\u2019 to \u2018ncclDataType_t\u2019 [-fpermissive]<br>\ninput[i].numel(),<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:477:15: error: cannot convert \u2018ncclDataType_t\u2019 to \u2018void*\u2019 for argument \u20184\u2019 to \u2018ncclResult_t ncclAllGather(const void*, int, ncclDataType_t, void*, ncclComm_t, cudaStream_t)\u2019<br>\nstream));<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:480:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupEnd());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::reduce(std::vectorat::Tensor&amp;, THDReduceOp, thd::rank_type, THDGroup)\u2019:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:516:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupStart());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:532:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupEnd());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::broadcast(std::vectorat::Tensor&amp;, thd::rank_type, THDGroup)\u2019:<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:568:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupStart());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             <br>\n                          ^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:582:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope<br>\nNCCL_CHECK(ncclGroupEnd());<br>\n^<br>\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019<br>\nncclResult_t error = cmd;                                             \\</p>\n</blockquote>\n<p>I have searched on google. And I find it may be the problem of nccl. I run</p>\n<blockquote>\n<p>export NO_SYSTEM_NCCL=1</p>\n</blockquote>\n<p>but it didn't work.</p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source):conda</li>\n<li>Build command you used (if compiling from source):python setup install</li>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: 1.0.0</li>\n<li>Python version: 3.7.1</li>\n<li>CUDA/cuDNN version: Cuda8 cudnn 7.0.5</li>\n<li>GPU models and configuration: 1080Ti</li>\n<li>GCC version (if compiling from source): gcc 5.3.1</li>\n<li>CMake version: 3.12.2</li>\n</ul>", "body_text": "Issue description\nHello! I am trying to install pytorch from source in conda, and I got these error message:\n\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:31:17: error: \u2018ncclInt8\u2019 was not declared in this scope\n{at::kChar, ncclInt8},\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:32:17: error: \u2018ncclUint8\u2019 was not declared in this scope\n{at::kByte, ncclUint8},\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:35:16: error: \u2018ncclInt32\u2019 was not declared in this scope\n{at::kInt, ncclInt32},\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:38:1: error: could not convert \u2018{{at::kChar, }, {at::kByte, }, {at::kFloat, ncclFloat}, {at::kDouble, ncclDouble}, {at::kInt, }, {at::kLong, ncclInt64}, {at::kHalf, ncclHalf}}\u2019 from \u2018\u2019 to \u2018std::unordered_map<at::ScalarType, ncclDataType_t>\u2019\n};\n^\nIn file included from /home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:1:0:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018void thd::DataChannelNccl::_destroyNcclResources(THDGroup)\u2019:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:187:40: error: void value not ignored as it ought to be\nNCCL_CHECK(ncclCommDestroy(comm));\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018thd::NcclResourcePair thd::DataChannelNccl::_getNcclResourcePair(std::vectorat::Tensor&, THDGroup)\u2019:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:295:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupStart());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:302:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupEnd());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allReduce(std::vectorat::Tensor&, THDReduceOp, THDGroup)\u2019:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:417:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupStart());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:432:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupEnd());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allGather(std::vectorat::Tensor&, std::vectorat::Tensor&, THDGroup)\u2019:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:466:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupStart());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:473:27: error: invalid conversion from \u2018void*\u2019 to \u2018int\u2019 [-fpermissive]\noutput[i].data_ptr(),\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:474:23: error: invalid conversion from \u2018int64_t {aka long int}\u2019 to \u2018ncclDataType_t\u2019 [-fpermissive]\ninput[i].numel(),\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:477:15: error: cannot convert \u2018ncclDataType_t\u2019 to \u2018void*\u2019 for argument \u20184\u2019 to \u2018ncclResult_t ncclAllGather(const void*, int, ncclDataType_t, void*, ncclComm_t, cudaStream_t)\u2019\nstream));\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:480:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupEnd());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::reduce(std::vectorat::Tensor&, THDReduceOp, thd::rank_type, THDGroup)\u2019:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:516:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupStart());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:532:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupEnd());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::broadcast(std::vectorat::Tensor&, thd::rank_type, THDGroup)\u2019:\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:568:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupStart());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \n                          ^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:582:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\nNCCL_CHECK(ncclGroupEnd());\n^\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\nncclResult_t error = cmd;                                             \\\n\nI have searched on google. And I find it may be the problem of nccl. I run\n\nexport NO_SYSTEM_NCCL=1\n\nbut it didn't work.\nSystem Info\n\nPyTorch\nHow you installed PyTorch (conda, pip, source):conda\nBuild command you used (if compiling from source):python setup install\nOS: Ubuntu 16.04\nPyTorch version: 1.0.0\nPython version: 3.7.1\nCUDA/cuDNN version: Cuda8 cudnn 7.0.5\nGPU models and configuration: 1080Ti\nGCC version (if compiling from source): gcc 5.3.1\nCMake version: 3.12.2", "body": "## Issue description\r\nHello! I am trying to install pytorch from source in conda, and I got these error message:\r\n\r\n> /home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:31:17: error: \u2018ncclInt8\u2019 was not declared in this scope\r\n     {at::kChar, ncclInt8},\r\n                 ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:32:17: error: \u2018ncclUint8\u2019 was not declared in this scope\r\n     {at::kByte, ncclUint8},\r\n                 ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:35:16: error: \u2018ncclInt32\u2019 was not declared in this scope\r\n     {at::kInt, ncclInt32},\r\n                ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:38:1: error: could not convert \u2018{{at::kChar, <expression error>}, {at::kByte, <expression error>}, {at::kFloat, ncclFloat}, {at::kDouble, ncclDouble}, {at::kInt, <expression error>}, {at::kLong, ncclInt64}, {at::kHalf, ncclHalf}}\u2019 from \u2018<brace-enclosed initializer list>\u2019 to \u2018std::unordered_map<at::ScalarType, ncclDataType_t>\u2019\r\n };\r\n ^\r\nIn file included from /home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:1:0:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018void thd::DataChannelNccl::_destroyNcclResources(THDGroup)\u2019:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:187:40: error: void value not ignored as it ought to be\r\n         NCCL_CHECK(ncclCommDestroy(comm));\r\n                                        ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018thd::NcclResourcePair thd::DataChannelNccl::_getNcclResourcePair(std::vector<at::Tensor>&, THDGroup)\u2019:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:295:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:302:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allReduce(std::vector<at::Tensor>&, THDReduceOp, THDGroup)\u2019:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:417:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:432:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allGather(std::vector<at::Tensor>&, std::vector<at::Tensor>&, THDGroup)\u2019:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:466:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:473:27: error: invalid conversion from \u2018void*\u2019 to \u2018int\u2019 [-fpermissive]\r\n         output[i].data_ptr(),\r\n                           ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:474:23: error: invalid conversion from \u2018int64_t {aka long int}\u2019 to \u2018ncclDataType_t\u2019 [-fpermissive]\r\n         input[i].numel(),\r\n                       ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:477:15: error: cannot convert \u2018ncclDataType_t\u2019 to \u2018void*\u2019 for argument \u20184\u2019 to \u2018ncclResult_t ncclAllGather(const void*, int, ncclDataType_t, void*, ncclComm_t, cudaStream_t)\u2019\r\n         stream));\r\n               ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:480:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::reduce(std::vector<at::Tensor>&, THDReduceOp, thd::rank_type, THDGroup)\u2019:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:516:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:532:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::broadcast(std::vector<at::Tensor>&, thd::rank_type, THDGroup)\u2019:\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:568:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                          ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:582:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/lin/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:26: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n     ncclResult_t error = cmd;                                             \\\r\n                    \r\nI have searched on google. And I find it may be the problem of nccl. I run \r\n\r\n> export NO_SYSTEM_NCCL=1\r\n\r\nbut it didn't work.\r\n\r\n## System Info\r\n- PyTorch\r\n- How you installed PyTorch (conda, pip, source):conda\r\n- Build command you used (if compiling from source):python setup install\r\n- OS: Ubuntu 16.04\r\n- PyTorch version: 1.0.0\r\n- Python version: 3.7.1\r\n- CUDA/cuDNN version: Cuda8 cudnn 7.0.5\r\n- GPU models and configuration: 1080Ti\r\n- GCC version (if compiling from source): gcc 5.3.1\r\n- CMake version: 3.12.2\r\n\r\n"}