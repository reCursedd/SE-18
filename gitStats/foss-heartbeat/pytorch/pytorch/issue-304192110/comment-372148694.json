{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/372148694", "html_url": "https://github.com/pytorch/pytorch/pull/5699#issuecomment-372148694", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5699", "id": 372148694, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjE0ODY5NA==", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-11T21:00:11Z", "updated_at": "2018-03-11T21:00:11Z", "author_association": "CONTRIBUTOR", "body_html": "<p>CC <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1716488\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/cpuhrsch\">@cpuhrsch</a>, this Xes off:</p>\n<ol>\n<li><em>Eliminate CI provided environment variables.</em> At the moment, our build scripts depend on a few environment variables which are specified by the CI system and passed down to the build. Based on the build scripts, these environment variables are JOB_NAME, PYTHON_VERSION and GCC_VERSION; variables that depend solely on the image being built and the invoked script.<br>\na. <em>Proposal:</em> A recent rewrite of the pytorch-dockerfiles has embedded a new environment variable, BUILD_ENVIRONMENT, which is automatically set when you run the Docker image. This environment variable subsumes JOB_NAME (this variable doesn't specify if you are \u201cbuilding\u201d or \u201ctesting\u201d, but this can easily be inferred from the script that is being invoked.) Make use of this environment variable to compute the other variables.</li>\n</ol>", "body_text": "CC @cpuhrsch, this Xes off:\n\nEliminate CI provided environment variables. At the moment, our build scripts depend on a few environment variables which are specified by the CI system and passed down to the build. Based on the build scripts, these environment variables are JOB_NAME, PYTHON_VERSION and GCC_VERSION; variables that depend solely on the image being built and the invoked script.\na. Proposal: A recent rewrite of the pytorch-dockerfiles has embedded a new environment variable, BUILD_ENVIRONMENT, which is automatically set when you run the Docker image. This environment variable subsumes JOB_NAME (this variable doesn't specify if you are \u201cbuilding\u201d or \u201ctesting\u201d, but this can easily be inferred from the script that is being invoked.) Make use of this environment variable to compute the other variables.", "body": "CC @cpuhrsch, this Xes off:\r\n\r\n1. *Eliminate CI provided environment variables.* At the moment, our build scripts depend on a few environment variables which are specified by the CI system and passed down to the build. Based on the build scripts, these environment variables are JOB_NAME, PYTHON_VERSION and GCC_VERSION; variables that depend solely on the image being built and the invoked script.\r\n    a. *Proposal:* A recent rewrite of the pytorch-dockerfiles has embedded a new environment variable, BUILD_ENVIRONMENT, which is automatically set when you run the Docker image. This environment variable subsumes JOB_NAME (this variable doesn't specify if you are \u201cbuilding\u201d or \u201ctesting\u201d, but this can easily be inferred from the script that is being invoked.) Make use of this environment variable to compute the other variables.\r\n\r\n"}