{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/435262613", "html_url": "https://github.com/pytorch/pytorch/pull/13449#issuecomment-435262613", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13449", "id": 435262613, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTI2MjYxMw==", "user": {"login": "gujinghui", "id": 31264804, "node_id": "MDQ6VXNlcjMxMjY0ODA0", "avatar_url": "https://avatars2.githubusercontent.com/u/31264804?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gujinghui", "html_url": "https://github.com/gujinghui", "followers_url": "https://api.github.com/users/gujinghui/followers", "following_url": "https://api.github.com/users/gujinghui/following{/other_user}", "gists_url": "https://api.github.com/users/gujinghui/gists{/gist_id}", "starred_url": "https://api.github.com/users/gujinghui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gujinghui/subscriptions", "organizations_url": "https://api.github.com/users/gujinghui/orgs", "repos_url": "https://api.github.com/users/gujinghui/repos", "events_url": "https://api.github.com/users/gujinghui/events{/privacy}", "received_events_url": "https://api.github.com/users/gujinghui/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-02T03:47:04Z", "updated_at": "2018-11-02T03:47:04Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1100089\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yinghai\">@yinghai</a></p>\n<p>The motivational of this PR is to enforce mkldnn to use the same omp version of caffe2 framework.<br>\nMeanwhile, do not change other assumptions within mkldnn.</p>\n<p>Previously, the MKL_cmake_included  is set in caffe2 in order to disable omp seeking in mkldnn.<br>\nBut, with such change, mkldnn has no chance to adapt for mkl found by caffe2.<br>\nThen, some building flags of mkl will be not set in mkldnn.<br>\nFor example, USE_MKL, USE_CBLAS, etc.</p>\n<p>In this PR, we enforce set the MKLIOMP5LIB for mkldnn according to caffe2, and tell the mkl root path in MKLROOT for mkldnn. Then, mkldnn is built as expected.</p>", "body_text": "@yinghai\nThe motivational of this PR is to enforce mkldnn to use the same omp version of caffe2 framework.\nMeanwhile, do not change other assumptions within mkldnn.\nPreviously, the MKL_cmake_included  is set in caffe2 in order to disable omp seeking in mkldnn.\nBut, with such change, mkldnn has no chance to adapt for mkl found by caffe2.\nThen, some building flags of mkl will be not set in mkldnn.\nFor example, USE_MKL, USE_CBLAS, etc.\nIn this PR, we enforce set the MKLIOMP5LIB for mkldnn according to caffe2, and tell the mkl root path in MKLROOT for mkldnn. Then, mkldnn is built as expected.", "body": "@yinghai \r\n\r\nThe motivational of this PR is to enforce mkldnn to use the same omp version of caffe2 framework.\r\nMeanwhile, do not change other assumptions within mkldnn.\r\n\r\nPreviously, the MKL_cmake_included  is set in caffe2 in order to disable omp seeking in mkldnn.\r\nBut, with such change, mkldnn has no chance to adapt for mkl found by caffe2.\r\nThen, some building flags of mkl will be not set in mkldnn.\r\nFor example, USE_MKL, USE_CBLAS, etc.\r\n\r\nIn this PR, we enforce set the MKLIOMP5LIB for mkldnn according to caffe2, and tell the mkl root path in MKLROOT for mkldnn. Then, mkldnn is built as expected."}