{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7551", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7551/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7551/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7551/events", "html_url": "https://github.com/pytorch/pytorch/issues/7551", "id": 322848933, "node_id": "MDU6SXNzdWUzMjI4NDg5MzM=", "number": 7551, "title": "torchvison.models.incption_v3 can not works right", "user": {"login": "LaiPiXiong", "id": 15033269, "node_id": "MDQ6VXNlcjE1MDMzMjY5", "avatar_url": "https://avatars2.githubusercontent.com/u/15033269?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LaiPiXiong", "html_url": "https://github.com/LaiPiXiong", "followers_url": "https://api.github.com/users/LaiPiXiong/followers", "following_url": "https://api.github.com/users/LaiPiXiong/following{/other_user}", "gists_url": "https://api.github.com/users/LaiPiXiong/gists{/gist_id}", "starred_url": "https://api.github.com/users/LaiPiXiong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LaiPiXiong/subscriptions", "organizations_url": "https://api.github.com/users/LaiPiXiong/orgs", "repos_url": "https://api.github.com/users/LaiPiXiong/repos", "events_url": "https://api.github.com/users/LaiPiXiong/events{/privacy}", "received_events_url": "https://api.github.com/users/LaiPiXiong/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-14T14:45:26Z", "updated_at": "2018-05-15T02:21:22Z", "closed_at": "2018-05-15T02:21:22Z", "author_association": "NONE", "body_html": "<p>I  define a model as follows:<br>\nmodel = torch.nn.Sequential(*list(inception_v3(pretrained=True).childre())[: -1])<br>\nInput is --&gt; inp = torch.autograd.Variable(torch.FloatTensor(10, 3, 299, 299))<br>\nWhen i out = model(inp) it shows errors as follows:<br>\n in ()<br>\n----&gt; 1 out = model(inp)</p>\n<p>/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in <strong>call</strong>(self, *input, **kwargs)<br>\n323         for hook in self._forward_pre_hooks.values():<br>\n324             hook(self, input)<br>\n--&gt; 325         result = self.forward(*input, **kwargs)<br>\n326         for hook in self._forward_hooks.values():<br>\n327             hook_result = hook(self, input, result)</p>\n<p>/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py in forward(self, input)<br>\n65     def forward(self, input):<br>\n66         for module in self._modules.values():<br>\n---&gt; 67             input = module(input)<br>\n68         return input<br>\n69</p>\n<p>/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in <strong>call</strong>(self, *input, **kwargs)<br>\n323         for hook in self._forward_pre_hooks.values():<br>\n324             hook(self, input)<br>\n--&gt; 325         result = self.forward(*input, **kwargs)<br>\n326         for hook in self._forward_hooks.values():<br>\n327             hook_result = hook(self, input, result)</p>\n<p>/usr/local/lib/python3.5/dist-packages/torchvision/models/inception.py in forward(self, x)<br>\n310         x = x.view(x.size(0), -1)<br>\n311         # 768<br>\n--&gt; 312         x = self.fc(x)<br>\n313         # 1000<br>\n314         return x</p>\n<p>/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in <strong>call</strong>(self, *input, **kwargs)<br>\n323         for hook in self._forward_pre_hooks.values():<br>\n324             hook(self, input)<br>\n--&gt; 325         result = self.forward(*input, **kwargs)<br>\n326         for hook in self._forward_hooks.values():<br>\n327             hook_result = hook(self, input, result)</p>\n<p>/usr/local/lib/python3.5/dist-packages/torch/nn/modules/linear.py in forward(self, input)<br>\n53<br>\n54     def forward(self, input):<br>\n---&gt; 55         return F.linear(input, self.weight, self.bias)<br>\n56<br>\n57     def <strong>repr</strong>(self):</p>\n<p>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py in linear(input, weight, bias)<br>\n833     if input.dim() == 2 and bias is not None:<br>\n834         # fused op is marginally faster<br>\n--&gt; 835         return torch.addmm(bias, input, weight.t())<br>\n836<br>\n837     output = input.matmul(weight.t())</p>\n<p>RuntimeError: size mismatch, m1: [10 x 277248], m2: [768 x 1000] at /pytorch/torch/lib/TH/generic/THTensorMath.c:1416</p>\n<p>How can i get inception_v3 middle result?</p>", "body_text": "I  define a model as follows:\nmodel = torch.nn.Sequential(*list(inception_v3(pretrained=True).childre())[: -1])\nInput is --> inp = torch.autograd.Variable(torch.FloatTensor(10, 3, 299, 299))\nWhen i out = model(inp) it shows errors as follows:\n in ()\n----> 1 out = model(inp)\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in call(self, *input, **kwargs)\n323         for hook in self._forward_pre_hooks.values():\n324             hook(self, input)\n--> 325         result = self.forward(*input, **kwargs)\n326         for hook in self._forward_hooks.values():\n327             hook_result = hook(self, input, result)\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py in forward(self, input)\n65     def forward(self, input):\n66         for module in self._modules.values():\n---> 67             input = module(input)\n68         return input\n69\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in call(self, *input, **kwargs)\n323         for hook in self._forward_pre_hooks.values():\n324             hook(self, input)\n--> 325         result = self.forward(*input, **kwargs)\n326         for hook in self._forward_hooks.values():\n327             hook_result = hook(self, input, result)\n/usr/local/lib/python3.5/dist-packages/torchvision/models/inception.py in forward(self, x)\n310         x = x.view(x.size(0), -1)\n311         # 768\n--> 312         x = self.fc(x)\n313         # 1000\n314         return x\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in call(self, *input, **kwargs)\n323         for hook in self._forward_pre_hooks.values():\n324             hook(self, input)\n--> 325         result = self.forward(*input, **kwargs)\n326         for hook in self._forward_hooks.values():\n327             hook_result = hook(self, input, result)\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/linear.py in forward(self, input)\n53\n54     def forward(self, input):\n---> 55         return F.linear(input, self.weight, self.bias)\n56\n57     def repr(self):\n/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py in linear(input, weight, bias)\n833     if input.dim() == 2 and bias is not None:\n834         # fused op is marginally faster\n--> 835         return torch.addmm(bias, input, weight.t())\n836\n837     output = input.matmul(weight.t())\nRuntimeError: size mismatch, m1: [10 x 277248], m2: [768 x 1000] at /pytorch/torch/lib/TH/generic/THTensorMath.c:1416\nHow can i get inception_v3 middle result?", "body": "I  define a model as follows:\r\n             model = torch.nn.Sequential(*list(inception_v3(pretrained=True).childre())[: -1])\r\nInput is --> inp = torch.autograd.Variable(torch.FloatTensor(10, 3, 299, 299))\r\nWhen i out = model(inp) it shows errors as follows:\r\n<ipython-input-17-1c57ef84e75d> in <module>()\r\n----> 1 out = model(inp)\r\n\r\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    323         for hook in self._forward_pre_hooks.values():\r\n    324             hook(self, input)\r\n--> 325         result = self.forward(*input, **kwargs)\r\n    326         for hook in self._forward_hooks.values():\r\n    327             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py in forward(self, input)\r\n     65     def forward(self, input):\r\n     66         for module in self._modules.values():\r\n---> 67             input = module(input)\r\n     68         return input\r\n     69 \r\n\r\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    323         for hook in self._forward_pre_hooks.values():\r\n    324             hook(self, input)\r\n--> 325         result = self.forward(*input, **kwargs)\r\n    326         for hook in self._forward_hooks.values():\r\n    327             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.5/dist-packages/torchvision/models/inception.py in forward(self, x)\r\n    310         x = x.view(x.size(0), -1)\r\n    311         # 768\r\n--> 312         x = self.fc(x)\r\n    313         # 1000\r\n    314         return x\r\n\r\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    323         for hook in self._forward_pre_hooks.values():\r\n    324             hook(self, input)\r\n--> 325         result = self.forward(*input, **kwargs)\r\n    326         for hook in self._forward_hooks.values():\r\n    327             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.5/dist-packages/torch/nn/modules/linear.py in forward(self, input)\r\n     53 \r\n     54     def forward(self, input):\r\n---> 55         return F.linear(input, self.weight, self.bias)\r\n     56 \r\n     57     def __repr__(self):\r\n\r\n/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py in linear(input, weight, bias)\r\n    833     if input.dim() == 2 and bias is not None:\r\n    834         # fused op is marginally faster\r\n--> 835         return torch.addmm(bias, input, weight.t())\r\n    836 \r\n    837     output = input.matmul(weight.t())\r\n\r\nRuntimeError: size mismatch, m1: [10 x 277248], m2: [768 x 1000] at /pytorch/torch/lib/TH/generic/THTensorMath.c:1416\r\n\r\nHow can i get inception_v3 middle result?\r\n\r\n"}