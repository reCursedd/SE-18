{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6252", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6252/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6252/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6252/events", "html_url": "https://github.com/pytorch/pytorch/pull/6252", "id": 311032517, "node_id": "MDExOlB1bGxSZXF1ZXN0MTc5MjQ1NjUx", "number": 6252, "title": "fix assertion error when input size smaller than number of module_copies", "user": {"login": "ailzhang", "id": 5248122, "node_id": "MDQ6VXNlcjUyNDgxMjI=", "avatar_url": "https://avatars2.githubusercontent.com/u/5248122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ailzhang", "html_url": "https://github.com/ailzhang", "followers_url": "https://api.github.com/users/ailzhang/followers", "following_url": "https://api.github.com/users/ailzhang/following{/other_user}", "gists_url": "https://api.github.com/users/ailzhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ailzhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ailzhang/subscriptions", "organizations_url": "https://api.github.com/users/ailzhang/orgs", "repos_url": "https://api.github.com/users/ailzhang/repos", "events_url": "https://api.github.com/users/ailzhang/events{/privacy}", "received_events_url": "https://api.github.com/users/ailzhang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-04-03T23:25:10Z", "updated_at": "2018-04-04T10:05:35Z", "closed_at": "2018-04-04T10:05:35Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/6252", "html_url": "https://github.com/pytorch/pytorch/pull/6252", "diff_url": "https://github.com/pytorch/pytorch/pull/6252.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/6252.patch"}, "body_html": "<p>This is a fix for <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"302591199\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/5587\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/5587/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/5587\">#5587</a> .<br>\nIn DistributedDataparallel, we get _module_copies in init(), but it's possible that the length of last batch is smaller than the number of GPUs. In this case, the <a href=\"https://github.com/pytorch/pytorch/blob/master/torch/nn/parallel/parallel_apply.py#L24\">assertion error</a> is triggered.<br>\nThe fix has the same behavior as <a href=\"https://github.com/pytorch/pytorch/blob/master/torch/nn/parallel/data_parallel.py#L99\">DataParallel model</a>, however, we cannot change the number of replicas in DDP case, so we put it in parallel_apply instead.</p>", "body_text": "This is a fix for #5587 .\nIn DistributedDataparallel, we get _module_copies in init(), but it's possible that the length of last batch is smaller than the number of GPUs. In this case, the assertion error is triggered.\nThe fix has the same behavior as DataParallel model, however, we cannot change the number of replicas in DDP case, so we put it in parallel_apply instead.", "body": "This is a fix for #5587 . \r\nIn DistributedDataparallel, we get _module_copies in init(), but it's possible that the length of last batch is smaller than the number of GPUs. In this case, the [assertion error](https://github.com/pytorch/pytorch/blob/master/torch/nn/parallel/parallel_apply.py#L24) is triggered.\r\nThe fix has the same behavior as [DataParallel model](https://github.com/pytorch/pytorch/blob/master/torch/nn/parallel/data_parallel.py#L99), however, we cannot change the number of replicas in DDP case, so we put it in parallel_apply instead. "}