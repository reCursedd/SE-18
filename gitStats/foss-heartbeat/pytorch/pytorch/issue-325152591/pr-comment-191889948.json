{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/191889948", "pull_request_review_id": 124552841, "id": 191889948, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MTg4OTk0OA==", "diff_hunk": "@@ -453,14 +453,20 @@ def persistent_load(saved_id):\n             raise RuntimeError(\"Unknown saved id type: %s\" % saved_id[0])\n \n     f_is_real_file = _is_real_file(f)\n-    if f_is_real_file and f.tell() == 0:\n-        # legacy_load requires that f has fileno()\n-        # only if offset is zero we can attempt the legacy tar file loader\n-        try:\n-            return legacy_load(f)\n-        except tarfile.TarError:\n-            # if not a tarfile, reset file offset and proceed\n-            f.seek(0)\n+\n+    try:\n+        if f_is_real_file and f.tell() == 0:\n+            # legacy_load requires that f has fileno()\n+            # only if offset is zero we can attempt the legacy tar file loader\n+            try:\n+                return legacy_load(f)\n+            except tarfile.TarError:\n+                # if not a tarfile, reset file offset and proceed\n+                f.seek(0)\n+    except (io.UnsupportedOperation, AttributeError) as e:\n+        msg = (str(e) + \". You can only torch.load from a file that is seekable. \" +\n+               \"Please pre-load the data into a buffer like io.BytesIO and try to load from it instead.\")\n+        raise type(e)(msg)", "path": "torch/serialization.py", "position": null, "original_position": 25, "commit_id": "8bfa74dd6e54176745fa849b9fee65bd652ed034", "original_commit_id": "08101d0943223cd88980b260ece5cbfe057c957e", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "Getting an `AttributeError` or `UnsupportedOperation` in here doesn't imply that it has been caused by seek in any way. This check has to be improved, or the error message will be highly misleading.", "created_at": "2018-05-30T19:15:05Z", "updated_at": "2018-11-23T15:44:45Z", "html_url": "https://github.com/pytorch/pytorch/pull/7754#discussion_r191889948", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/7754", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/191889948"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/7754#discussion_r191889948"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/7754"}}, "body_html": "<p>Getting an <code>AttributeError</code> or <code>UnsupportedOperation</code> in here doesn't imply that it has been caused by seek in any way. This check has to be improved, or the error message will be highly misleading.</p>", "body_text": "Getting an AttributeError or UnsupportedOperation in here doesn't imply that it has been caused by seek in any way. This check has to be improved, or the error message will be highly misleading."}