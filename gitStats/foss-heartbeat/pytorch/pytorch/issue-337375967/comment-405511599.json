{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/405511599", "html_url": "https://github.com/pytorch/pytorch/issues/9092#issuecomment-405511599", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9092", "id": 405511599, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTUxMTU5OQ==", "user": {"login": "peterjc123", "id": 9998726, "node_id": "MDQ6VXNlcjk5OTg3MjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/9998726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peterjc123", "html_url": "https://github.com/peterjc123", "followers_url": "https://api.github.com/users/peterjc123/followers", "following_url": "https://api.github.com/users/peterjc123/following{/other_user}", "gists_url": "https://api.github.com/users/peterjc123/gists{/gist_id}", "starred_url": "https://api.github.com/users/peterjc123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peterjc123/subscriptions", "organizations_url": "https://api.github.com/users/peterjc123/orgs", "repos_url": "https://api.github.com/users/peterjc123/repos", "events_url": "https://api.github.com/users/peterjc123/events{/privacy}", "received_events_url": "https://api.github.com/users/peterjc123/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-17T09:00:14Z", "updated_at": "2018-07-17T09:03:59Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Actually, a <code>.def</code> file is generated now before linking. After inspecting that file of caffe2_gpu, the number of the exported symbols in CUDA 8 build seems to be nearly 80000. I've also checked the object files under ATen. They're all good and not exporting additional symbols. So, my question is how is the <code>.def</code> file generated? Are we using some flags like <code>WINDOWS_EXPORT_ALL_SYMBOLS</code>?<br>\nUpdate: The problem is caused by the usage of <code>CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS</code>. We should add function export decorations instead of using this flag.<br>\n<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=79994\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/orionr\">@orionr</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a></p>", "body_text": "Actually, a .def file is generated now before linking. After inspecting that file of caffe2_gpu, the number of the exported symbols in CUDA 8 build seems to be nearly 80000. I've also checked the object files under ATen. They're all good and not exporting additional symbols. So, my question is how is the .def file generated? Are we using some flags like WINDOWS_EXPORT_ALL_SYMBOLS?\nUpdate: The problem is caused by the usage of CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS. We should add function export decorations instead of using this flag.\n@orionr @pjh5", "body": "Actually, a `.def` file is generated now before linking. After inspecting that file of caffe2_gpu, the number of the exported symbols in CUDA 8 build seems to be nearly 80000. I've also checked the object files under ATen. They're all good and not exporting additional symbols. So, my question is how is the `.def` file generated? Are we using some flags like `WINDOWS_EXPORT_ALL_SYMBOLS`?\r\nUpdate: The problem is caused by the usage of `CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS`. We should add function export decorations instead of using this flag.\r\n@orionr @pjh5 "}