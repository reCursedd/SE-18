{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/370952804", "html_url": "https://github.com/pytorch/pytorch/pull/4626#issuecomment-370952804", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/4626", "id": 370952804, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk1MjgwNA==", "user": {"login": "CynthiaLu1119", "id": 2591848, "node_id": "MDQ6VXNlcjI1OTE4NDg=", "avatar_url": "https://avatars3.githubusercontent.com/u/2591848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CynthiaLu1119", "html_url": "https://github.com/CynthiaLu1119", "followers_url": "https://api.github.com/users/CynthiaLu1119/followers", "following_url": "https://api.github.com/users/CynthiaLu1119/following{/other_user}", "gists_url": "https://api.github.com/users/CynthiaLu1119/gists{/gist_id}", "starred_url": "https://api.github.com/users/CynthiaLu1119/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CynthiaLu1119/subscriptions", "organizations_url": "https://api.github.com/users/CynthiaLu1119/orgs", "repos_url": "https://api.github.com/users/CynthiaLu1119/repos", "events_url": "https://api.github.com/users/CynthiaLu1119/events{/privacy}", "received_events_url": "https://api.github.com/users/CynthiaLu1119/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-06T22:31:13Z", "updated_at": "2018-03-06T22:31:13Z", "author_association": "NONE", "body_html": "<p>After reading this post, I tried to install pytorch by source and the onnx does work on instanceNorm2D now. Thanks.</p>\n<p>However, I encountered some other problems. I trained some pytorch model using the pytorch version installed through <a href=\"http://pytorch.org/\" rel=\"nofollow\">http://pytorch.org/</a>. I was able to save the trained model as .pth file and load it back in successfully by doing the following:</p>\n<p><code>model = myNet(parameters...) model.load_state_dict(torch.load('xxx.pth'))</code></p>\n<p>However, after I install the latest pytorch from source. The load_state_dict is reporting errors:</p>\n<blockquote>\n<p>File \"/anaconda2/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 528, in load_state_dict<br>\n.format(name))<br>\nKeyError: 'unexpected key \"pre_model.1.running_mean\" in state_dict'</p>\n</blockquote>\n<p>I did the following to check which layer was causing the problem<br>\n<code>model1 = myNet(parameters...)</code><br>\n<code>model2 = torch.load('xxx.pth')</code></p>\n<p><code>for name, param in model2.items():</code><br>\n<code>     print(name)</code></p>\n<p><code>for name, param in model1.state_dict().items():</code><br>\n<code>      print(name)</code></p>\n<p>I found that for the instanceNorm2D layers, model2 contains xxx.running_mean and xxx.running_var, but not model1. Any idea what I should do?</p>", "body_text": "After reading this post, I tried to install pytorch by source and the onnx does work on instanceNorm2D now. Thanks.\nHowever, I encountered some other problems. I trained some pytorch model using the pytorch version installed through http://pytorch.org/. I was able to save the trained model as .pth file and load it back in successfully by doing the following:\nmodel = myNet(parameters...) model.load_state_dict(torch.load('xxx.pth'))\nHowever, after I install the latest pytorch from source. The load_state_dict is reporting errors:\n\nFile \"/anaconda2/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 528, in load_state_dict\n.format(name))\nKeyError: 'unexpected key \"pre_model.1.running_mean\" in state_dict'\n\nI did the following to check which layer was causing the problem\nmodel1 = myNet(parameters...)\nmodel2 = torch.load('xxx.pth')\nfor name, param in model2.items():\n     print(name)\nfor name, param in model1.state_dict().items():\n      print(name)\nI found that for the instanceNorm2D layers, model2 contains xxx.running_mean and xxx.running_var, but not model1. Any idea what I should do?", "body": "After reading this post, I tried to install pytorch by source and the onnx does work on instanceNorm2D now. Thanks.\r\n\r\nHowever, I encountered some other problems. I trained some pytorch model using the pytorch version installed through http://pytorch.org/. I was able to save the trained model as .pth file and load it back in successfully by doing the following:\r\n\r\n`model = myNet(parameters...)\r\nmodel.load_state_dict(torch.load('xxx.pth'))`\r\n\r\nHowever, after I install the latest pytorch from source. The load_state_dict is reporting errors:\r\n\r\n> File \"/anaconda2/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 528, in load_state_dict\r\n    .format(name))\r\nKeyError: 'unexpected key \"pre_model.1.running_mean\" in state_dict'\r\n\r\nI did the following to check which layer was causing the problem\r\n`model1 = myNet(parameters...)`\r\n`model2 = torch.load('xxx.pth')`\r\n\r\n`for name, param in model2.items():`\r\n`     print(name)`\r\n\r\n`for name, param in model1.state_dict().items():`\r\n`      print(name)`\r\n\r\nI found that for the instanceNorm2D layers, model2 contains xxx.running_mean and xxx.running_var, but not model1. Any idea what I should do? \r\n\r\n\r\n\r\n"}