{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/333571266", "html_url": "https://github.com/pytorch/pytorch/issues/2925#issuecomment-333571266", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/2925", "id": 333571266, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzU3MTI2Ng==", "user": {"login": "killeent", "id": 4529377, "node_id": "MDQ6VXNlcjQ1MjkzNzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/4529377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/killeent", "html_url": "https://github.com/killeent", "followers_url": "https://api.github.com/users/killeent/followers", "following_url": "https://api.github.com/users/killeent/following{/other_user}", "gists_url": "https://api.github.com/users/killeent/gists{/gist_id}", "starred_url": "https://api.github.com/users/killeent/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/killeent/subscriptions", "organizations_url": "https://api.github.com/users/killeent/orgs", "repos_url": "https://api.github.com/users/killeent/repos", "events_url": "https://api.github.com/users/killeent/events{/privacy}", "received_events_url": "https://api.github.com/users/killeent/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-02T15:32:27Z", "updated_at": "2017-10-02T15:34:22Z", "author_association": "CONTRIBUTOR", "body_html": "<p>So a couple of things - on PyTorch master (version <code>0.2.0+6216031</code>), indexing <code>xx</code> with <code>indices</code> succeeds.</p>\n<p>The other thing is that when you convert the Tensor to the <code>cuda.LongTensor</code> you are triggering a different type of indexing (<code>index_select</code>) which leads to the failure case you see, because you are passing a <code>3x1</code> matrix to <code>index_select</code> instead of a vector. Indeed:</p>\n<pre><code>indices_tensor = torch.LongTensor(indices)\nx[indices_tensor] # fails with the same error\n</code></pre>\n<p>So its more about the conversion to a Torch Tensor that causes the issue, rather than it being on GPU.</p>", "body_text": "So a couple of things - on PyTorch master (version 0.2.0+6216031), indexing xx with indices succeeds.\nThe other thing is that when you convert the Tensor to the cuda.LongTensor you are triggering a different type of indexing (index_select) which leads to the failure case you see, because you are passing a 3x1 matrix to index_select instead of a vector. Indeed:\nindices_tensor = torch.LongTensor(indices)\nx[indices_tensor] # fails with the same error\n\nSo its more about the conversion to a Torch Tensor that causes the issue, rather than it being on GPU.", "body": "So a couple of things - on PyTorch master (version `0.2.0+6216031`), indexing `xx` with `indices` succeeds.\r\n\r\nThe other thing is that when you convert the Tensor to the `cuda.LongTensor` you are triggering a different type of indexing (`index_select`) which leads to the failure case you see, because you are passing a `3x1` matrix to `index_select` instead of a vector. Indeed:\r\n\r\n```\r\nindices_tensor = torch.LongTensor(indices)\r\nx[indices_tensor] # fails with the same error\r\n```\r\n\r\nSo its more about the conversion to a Torch Tensor that causes the issue, rather than it being on GPU. "}