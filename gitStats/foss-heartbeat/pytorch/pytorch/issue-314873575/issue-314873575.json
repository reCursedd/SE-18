{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6644", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6644/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6644/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6644/events", "html_url": "https://github.com/pytorch/pytorch/issues/6644", "id": 314873575, "node_id": "MDU6SXNzdWUzMTQ4NzM1NzU=", "number": 6644, "title": "[Caffe2] Unable to run ONNX models with Caffe2 backend", "user": {"login": "jeffreyksmithjr", "id": 2244907, "node_id": "MDQ6VXNlcjIyNDQ5MDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/2244907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeffreyksmithjr", "html_url": "https://github.com/jeffreyksmithjr", "followers_url": "https://api.github.com/users/jeffreyksmithjr/followers", "following_url": "https://api.github.com/users/jeffreyksmithjr/following{/other_user}", "gists_url": "https://api.github.com/users/jeffreyksmithjr/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeffreyksmithjr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeffreyksmithjr/subscriptions", "organizations_url": "https://api.github.com/users/jeffreyksmithjr/orgs", "repos_url": "https://api.github.com/users/jeffreyksmithjr/repos", "events_url": "https://api.github.com/users/jeffreyksmithjr/events{/privacy}", "received_events_url": "https://api.github.com/users/jeffreyksmithjr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-17T01:35:40Z", "updated_at": "2018-04-17T03:45:21Z", "closed_at": "2018-04-17T03:45:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I attempted to execute the steps shown in the Caffe2 tutorial entitled Run an ONNX model with Caffe2: <a href=\"https://render.githubusercontent.com/view/ipynb?commit=c04c7d721da9b1fa1dd0fe5d5551086c61877586&amp;enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6f6e6e782f7475746f7269616c732f633034633764373231646139623166613164643066653564353535313038366336313837373538362f7475746f7269616c732f4f6e6e78436166666532496d706f72742e6970796e62&amp;nwo=onnx%2Ftutorials&amp;path=tutorials%2FOnnxCaffe2Import.ipynb&amp;repository_id=110873948&amp;repository_type=Repository#Run-an-ONNX-model-with-Caffe2\" rel=\"nofollow\">https://render.githubusercontent.com/view/ipynb?commit=c04c7d721da9b1fa1dd0fe5d5551086c61877586&amp;enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6f6e6e782f7475746f7269616c732f633034633764373231646139623166613164643066653564353535313038366336313837373538362f7475746f7269616c732f4f6e6e78436166666532496d706f72742e6970796e62&amp;nwo=onnx%2Ftutorials&amp;path=tutorials%2FOnnxCaffe2Import.ipynb&amp;repository_id=110873948&amp;repository_type=Repository#Run-an-ONNX-model-with-Caffe2</a></p>\n<p>With the squeezenet model it throws the error:</p>\n<pre><code>warning: onnx optimizer is unable to parse input model. (The IR version of the ONNX model may be too old.)\n</code></pre>\n<p>So, I also tried every model from the example models repo: <a href=\"https://github.com/onnx/models\">https://github.com/onnx/models</a> and none of them worked. Most of them were learned in CNTK and there appears to be a range of issues with running models learned in CNTK from Caffe2.</p>\n<p>e.g.</p>\n<pre><code>Traceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/backend/base.py\", line 57, in run_model\n    return cls.prepare(model, device, **kwargs).run(inputs)\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/onnx/backend.py\", line 730, in prepare\n    super(Caffe2Backend, cls).prepare(model, device, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/backend/base.py\", line 53, in prepare\n    onnx.checker.check_model(model)\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/checker.py\", line 77, in check_model\n    C.check_model(model.SerializeToString())\nonnx.onnx_cpp2py_export.checker.ValidationError: model with IR version &gt;= 3 must specify opset_import for ONNX\n</code></pre>\n<p>Caffe2 version is 0.8.dev.2018.04.16.<br>\nOS is Debian Stretch.</p>", "body_text": "I attempted to execute the steps shown in the Caffe2 tutorial entitled Run an ONNX model with Caffe2: https://render.githubusercontent.com/view/ipynb?commit=c04c7d721da9b1fa1dd0fe5d5551086c61877586&enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6f6e6e782f7475746f7269616c732f633034633764373231646139623166613164643066653564353535313038366336313837373538362f7475746f7269616c732f4f6e6e78436166666532496d706f72742e6970796e62&nwo=onnx%2Ftutorials&path=tutorials%2FOnnxCaffe2Import.ipynb&repository_id=110873948&repository_type=Repository#Run-an-ONNX-model-with-Caffe2\nWith the squeezenet model it throws the error:\nwarning: onnx optimizer is unable to parse input model. (The IR version of the ONNX model may be too old.)\n\nSo, I also tried every model from the example models repo: https://github.com/onnx/models and none of them worked. Most of them were learned in CNTK and there appears to be a range of issues with running models learned in CNTK from Caffe2.\ne.g.\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/backend/base.py\", line 57, in run_model\n    return cls.prepare(model, device, **kwargs).run(inputs)\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/onnx/backend.py\", line 730, in prepare\n    super(Caffe2Backend, cls).prepare(model, device, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/backend/base.py\", line 53, in prepare\n    onnx.checker.check_model(model)\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/checker.py\", line 77, in check_model\n    C.check_model(model.SerializeToString())\nonnx.onnx_cpp2py_export.checker.ValidationError: model with IR version >= 3 must specify opset_import for ONNX\n\nCaffe2 version is 0.8.dev.2018.04.16.\nOS is Debian Stretch.", "body": "I attempted to execute the steps shown in the Caffe2 tutorial entitled Run an ONNX model with Caffe2: https://render.githubusercontent.com/view/ipynb?commit=c04c7d721da9b1fa1dd0fe5d5551086c61877586&enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6f6e6e782f7475746f7269616c732f633034633764373231646139623166613164643066653564353535313038366336313837373538362f7475746f7269616c732f4f6e6e78436166666532496d706f72742e6970796e62&nwo=onnx%2Ftutorials&path=tutorials%2FOnnxCaffe2Import.ipynb&repository_id=110873948&repository_type=Repository#Run-an-ONNX-model-with-Caffe2\r\n\r\nWith the squeezenet model it throws the error:\r\n```\r\nwarning: onnx optimizer is unable to parse input model. (The IR version of the ONNX model may be too old.)\r\n```\r\n\r\nSo, I also tried every model from the example models repo: https://github.com/onnx/models and none of them worked. Most of them were learned in CNTK and there appears to be a range of issues with running models learned in CNTK from Caffe2.\r\n\r\ne.g.\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/backend/base.py\", line 57, in run_model\r\n    return cls.prepare(model, device, **kwargs).run(inputs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/caffe2/python/onnx/backend.py\", line 730, in prepare\r\n    super(Caffe2Backend, cls).prepare(model, device, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/backend/base.py\", line 53, in prepare\r\n    onnx.checker.check_model(model)\r\n  File \"/usr/local/lib/python2.7/dist-packages/onnx/checker.py\", line 77, in check_model\r\n    C.check_model(model.SerializeToString())\r\nonnx.onnx_cpp2py_export.checker.ValidationError: model with IR version >= 3 must specify opset_import for ONNX\r\n```\r\n\r\nCaffe2 version is 0.8.dev.2018.04.16. \r\nOS is Debian Stretch.\r\n\r\n"}