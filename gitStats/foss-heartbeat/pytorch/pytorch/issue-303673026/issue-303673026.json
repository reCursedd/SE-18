{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5650", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5650/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5650/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5650/events", "html_url": "https://github.com/pytorch/pytorch/issues/5650", "id": 303673026, "node_id": "MDU6SXNzdWUzMDM2NzMwMjY=", "number": 5650, "title": "Handle None gradients in nn.utils.clip_grad_norm", "user": {"login": "monajalal", "id": 1892917, "node_id": "MDQ6VXNlcjE4OTI5MTc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1892917?v=4", "gravatar_id": "", "url": "https://api.github.com/users/monajalal", "html_url": "https://github.com/monajalal", "followers_url": "https://api.github.com/users/monajalal/followers", "following_url": "https://api.github.com/users/monajalal/following{/other_user}", "gists_url": "https://api.github.com/users/monajalal/gists{/gist_id}", "starred_url": "https://api.github.com/users/monajalal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/monajalal/subscriptions", "organizations_url": "https://api.github.com/users/monajalal/orgs", "repos_url": "https://api.github.com/users/monajalal/repos", "events_url": "https://api.github.com/users/monajalal/events{/privacy}", "received_events_url": "https://api.github.com/users/monajalal/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-03-08T23:40:23Z", "updated_at": "2018-03-12T17:34:27Z", "closed_at": "2018-03-12T17:34:27Z", "author_association": "NONE", "body_html": "<p>I get this error:</p>\n<pre><code>python train.py --batch-size 20 --rnn_type GRU --cuda --gpu 1 --lr 0.0001 --mdl RNN --clip_norm 1 --opt Adam\n/scratch/sjn-p2/anaconda/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\nUsing TensorFlow backend.\nThere are 2 CUDA devices\nSetting torch GPU to 1\nUsing device:1 \nStored Environment:['term_len', 'word_index', 'glove', 'max_len', 'train', 'dev', 'test', 'index_word']\nLoaded environment\nCreating Model...\nSetting Pretrained Embeddings\nInitialized GRU model\nStarting training\nNamespace(aggregation='mean', attention_width=5, batch_size=20, clip_norm=1, cuda=True, dataset='Restaurants', dev=1, dropout_prob=0.5, embedding_size=300, epochs=50, eval=1, gpu=1, hidden_layer_size=300, l2_reg=0.0, learn_rate=0.0001, log=1, maxlen=0, mode='term', model_type='RNN', opt='Adam', pretrained=1, rnn_direction='uni', rnn_layers=1, rnn_size=300, rnn_type='GRU', seed=1111, term_model='mean', toy=False, trainable=1)\n/scratch2/debate_tweets/sentiment/pytorch_sentiment_rnn/models/rnn.py:51: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.\n  decoded = self.softmax(decoded)\nTraceback (most recent call last):\n  File \"train.py\", line 343, in &lt;module&gt;\n    exp.train()\n  File \"train.py\", line 326, in train\n    loss = self.train_batch(i)\n  File \"train.py\", line 303, in train_batch\n    coeff = clip_gradient(self.mdl, self.args.clip_norm)\n  File \"train.py\", line 35, in clip_gradient\n    modulenorm = p.grad.data.norm()\nAttributeError: 'NoneType' object has no attribute 'data'\n[jalal@goku pytorch_sentiment_rnn]$ \n\n\n</code></pre>\n<p>for train.py file in <a href=\"https://github.com/vanzytay/pytorch_sentiment_rnn\">https://github.com/vanzytay/pytorch_sentiment_rnn</a> I have followed all the steps in the readme up to here. What do you think should be fixed?</p>\n<p>When submitting a bug report, please include the following information (where relevant):</p>\n<ul>\n<li>OS: CentOS Linux release 7.4.1708 (Core)</li>\n<li>PyTorch version: 0.3.1.post2</li>\n<li>How you installed PyTorch (conda, pip, source): conda install -c pytorch pytorch</li>\n<li>Python version: Python 2.7.14 |Anaconda custom (64-bit)| (default, Dec  7 2017, 17:05:42)</li>\n<li>CUDA/cuDNN version: CUDA Version 8.0.61</li>\n<li>GPU models and configuration: GP102 [GeForce GTX 1080 Ti], driver=nvidia latency=0</li>\n<li>GCC version (if compiling from source): [GCC 7.2.0] on linux2</li>\n</ul>", "body_text": "I get this error:\npython train.py --batch-size 20 --rnn_type GRU --cuda --gpu 1 --lr 0.0001 --mdl RNN --clip_norm 1 --opt Adam\n/scratch/sjn-p2/anaconda/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\nUsing TensorFlow backend.\nThere are 2 CUDA devices\nSetting torch GPU to 1\nUsing device:1 \nStored Environment:['term_len', 'word_index', 'glove', 'max_len', 'train', 'dev', 'test', 'index_word']\nLoaded environment\nCreating Model...\nSetting Pretrained Embeddings\nInitialized GRU model\nStarting training\nNamespace(aggregation='mean', attention_width=5, batch_size=20, clip_norm=1, cuda=True, dataset='Restaurants', dev=1, dropout_prob=0.5, embedding_size=300, epochs=50, eval=1, gpu=1, hidden_layer_size=300, l2_reg=0.0, learn_rate=0.0001, log=1, maxlen=0, mode='term', model_type='RNN', opt='Adam', pretrained=1, rnn_direction='uni', rnn_layers=1, rnn_size=300, rnn_type='GRU', seed=1111, term_model='mean', toy=False, trainable=1)\n/scratch2/debate_tweets/sentiment/pytorch_sentiment_rnn/models/rnn.py:51: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.\n  decoded = self.softmax(decoded)\nTraceback (most recent call last):\n  File \"train.py\", line 343, in <module>\n    exp.train()\n  File \"train.py\", line 326, in train\n    loss = self.train_batch(i)\n  File \"train.py\", line 303, in train_batch\n    coeff = clip_gradient(self.mdl, self.args.clip_norm)\n  File \"train.py\", line 35, in clip_gradient\n    modulenorm = p.grad.data.norm()\nAttributeError: 'NoneType' object has no attribute 'data'\n[jalal@goku pytorch_sentiment_rnn]$ \n\n\n\nfor train.py file in https://github.com/vanzytay/pytorch_sentiment_rnn I have followed all the steps in the readme up to here. What do you think should be fixed?\nWhen submitting a bug report, please include the following information (where relevant):\n\nOS: CentOS Linux release 7.4.1708 (Core)\nPyTorch version: 0.3.1.post2\nHow you installed PyTorch (conda, pip, source): conda install -c pytorch pytorch\nPython version: Python 2.7.14 |Anaconda custom (64-bit)| (default, Dec  7 2017, 17:05:42)\nCUDA/cuDNN version: CUDA Version 8.0.61\nGPU models and configuration: GP102 [GeForce GTX 1080 Ti], driver=nvidia latency=0\nGCC version (if compiling from source): [GCC 7.2.0] on linux2", "body": "I get this error:\r\n\r\n```\r\npython train.py --batch-size 20 --rnn_type GRU --cuda --gpu 1 --lr 0.0001 --mdl RNN --clip_norm 1 --opt Adam\r\n/scratch/sjn-p2/anaconda/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\nUsing TensorFlow backend.\r\nThere are 2 CUDA devices\r\nSetting torch GPU to 1\r\nUsing device:1 \r\nStored Environment:['term_len', 'word_index', 'glove', 'max_len', 'train', 'dev', 'test', 'index_word']\r\nLoaded environment\r\nCreating Model...\r\nSetting Pretrained Embeddings\r\nInitialized GRU model\r\nStarting training\r\nNamespace(aggregation='mean', attention_width=5, batch_size=20, clip_norm=1, cuda=True, dataset='Restaurants', dev=1, dropout_prob=0.5, embedding_size=300, epochs=50, eval=1, gpu=1, hidden_layer_size=300, l2_reg=0.0, learn_rate=0.0001, log=1, maxlen=0, mode='term', model_type='RNN', opt='Adam', pretrained=1, rnn_direction='uni', rnn_layers=1, rnn_size=300, rnn_type='GRU', seed=1111, term_model='mean', toy=False, trainable=1)\r\n/scratch2/debate_tweets/sentiment/pytorch_sentiment_rnn/models/rnn.py:51: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.\r\n  decoded = self.softmax(decoded)\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 343, in <module>\r\n    exp.train()\r\n  File \"train.py\", line 326, in train\r\n    loss = self.train_batch(i)\r\n  File \"train.py\", line 303, in train_batch\r\n    coeff = clip_gradient(self.mdl, self.args.clip_norm)\r\n  File \"train.py\", line 35, in clip_gradient\r\n    modulenorm = p.grad.data.norm()\r\nAttributeError: 'NoneType' object has no attribute 'data'\r\n[jalal@goku pytorch_sentiment_rnn]$ \r\n\r\n\r\n```\r\nfor train.py file in https://github.com/vanzytay/pytorch_sentiment_rnn I have followed all the steps in the readme up to here. What do you think should be fixed?\r\n\r\nWhen submitting a bug report, please include the following information (where relevant):\r\n- OS: CentOS Linux release 7.4.1708 (Core) \r\n- PyTorch version: 0.3.1.post2\r\n- How you installed PyTorch (conda, pip, source): conda install -c pytorch pytorch \r\n- Python version: Python 2.7.14 |Anaconda custom (64-bit)| (default, Dec  7 2017, 17:05:42)\r\n- CUDA/cuDNN version: CUDA Version 8.0.61\r\n- GPU models and configuration: GP102 [GeForce GTX 1080 Ti], driver=nvidia latency=0\r\n- GCC version (if compiling from source): [GCC 7.2.0] on linux2\r\n\r\n\r\n"}