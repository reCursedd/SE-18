{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12233", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12233/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12233/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12233/events", "html_url": "https://github.com/pytorch/pytorch/issues/12233", "id": 365639814, "node_id": "MDU6SXNzdWUzNjU2Mzk4MTQ=", "number": 12233, "title": "result of torch.tensor(float('inf')).cuda().min() is not inf", "user": {"login": "pfrendl", "id": 6968154, "node_id": "MDQ6VXNlcjY5NjgxNTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/6968154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pfrendl", "html_url": "https://github.com/pfrendl", "followers_url": "https://api.github.com/users/pfrendl/followers", "following_url": "https://api.github.com/users/pfrendl/following{/other_user}", "gists_url": "https://api.github.com/users/pfrendl/gists{/gist_id}", "starred_url": "https://api.github.com/users/pfrendl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pfrendl/subscriptions", "organizations_url": "https://api.github.com/users/pfrendl/orgs", "repos_url": "https://api.github.com/users/pfrendl/repos", "events_url": "https://api.github.com/users/pfrendl/events{/privacy}", "received_events_url": "https://api.github.com/users/pfrendl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-01T20:57:03Z", "updated_at": "2018-10-02T03:02:20Z", "closed_at": "2018-10-02T03:02:20Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>min() on cuda tensors maps inf to 340282346638528859811704183484516925440.</p>\n<p>Tensors of arbitrary dimensions seem to display this behavior.</p>\n<p>Because of this, there are cases where inf is not equal to itself on the gpu:</p>\n<pre><code>&gt;&gt;&gt; import torch\n&gt;&gt;&gt; a = torch.tensor(float('inf')).cuda()\n&gt;&gt;&gt; a\ntensor(inf, device='cuda:0')\n&gt;&gt;&gt; a.min()\ntensor(340282346638528859811704183484516925440., device='cuda:0')\n&gt;&gt;&gt; a == a\ntensor(1, device='cuda:0', dtype=torch.uint8)\n&gt;&gt;&gt; a.min() == a\ntensor(0, device='cuda:0', dtype=torch.uint8)\n</code></pre>\n<p>Also, max() fails on -inf:</p>\n<pre><code>&gt;&gt;&gt; torch.tensor(float('-inf')).cuda().max()\ntensor(-340282346638528859811704183484516925440., device='cuda:0')\n</code></pre>\n<h2>To Reproduce</h2>\n<p>Run the following line:<br>\n<code>&gt;&gt;&gt; torch.tensor(float('inf')).cuda().min()</code><br>\nResult:<br>\n<code>tensor(340282346638528859811704183484516925440., device='cuda:0')</code></p>\n<h2>Expected behavior</h2>\n<p>The min() operation should result in inf, just like on the cpu:</p>\n<pre><code>&gt;&gt;&gt; torch.tensor(float('inf')).min()\ntensor(inf)\n</code></pre>\n<p>Casting back works fine:</p>\n<pre><code>&gt;&gt;&gt; torch.tensor(float('inf')).cuda().cpu().min()\ntensor(inf)\n</code></pre>\n<h2>Environment</h2>\n<ul>\n<li>PyTorch Version: 0.4.1</li>\n<li>OS: Windows 10, Ubuntu 16.04</li>\n<li>How you installed PyTorch: conda</li>\n<li>Python version: Python 3.6.4 :: Anaconda custom (64-bit)</li>\n<li>CUDA/cuDNN version: 9.2</li>\n<li>GPU models and configuration: GTX 1080</li>\n</ul>", "body_text": "\ud83d\udc1b Bug\nmin() on cuda tensors maps inf to 340282346638528859811704183484516925440.\nTensors of arbitrary dimensions seem to display this behavior.\nBecause of this, there are cases where inf is not equal to itself on the gpu:\n>>> import torch\n>>> a = torch.tensor(float('inf')).cuda()\n>>> a\ntensor(inf, device='cuda:0')\n>>> a.min()\ntensor(340282346638528859811704183484516925440., device='cuda:0')\n>>> a == a\ntensor(1, device='cuda:0', dtype=torch.uint8)\n>>> a.min() == a\ntensor(0, device='cuda:0', dtype=torch.uint8)\n\nAlso, max() fails on -inf:\n>>> torch.tensor(float('-inf')).cuda().max()\ntensor(-340282346638528859811704183484516925440., device='cuda:0')\n\nTo Reproduce\nRun the following line:\n>>> torch.tensor(float('inf')).cuda().min()\nResult:\ntensor(340282346638528859811704183484516925440., device='cuda:0')\nExpected behavior\nThe min() operation should result in inf, just like on the cpu:\n>>> torch.tensor(float('inf')).min()\ntensor(inf)\n\nCasting back works fine:\n>>> torch.tensor(float('inf')).cuda().cpu().min()\ntensor(inf)\n\nEnvironment\n\nPyTorch Version: 0.4.1\nOS: Windows 10, Ubuntu 16.04\nHow you installed PyTorch: conda\nPython version: Python 3.6.4 :: Anaconda custom (64-bit)\nCUDA/cuDNN version: 9.2\nGPU models and configuration: GTX 1080", "body": "## \ud83d\udc1b Bug\r\n\r\nmin() on cuda tensors maps inf to 340282346638528859811704183484516925440.\r\n\r\nTensors of arbitrary dimensions seem to display this behavior.\r\n\r\nBecause of this, there are cases where inf is not equal to itself on the gpu:\r\n```\r\n>>> import torch\r\n>>> a = torch.tensor(float('inf')).cuda()\r\n>>> a\r\ntensor(inf, device='cuda:0')\r\n>>> a.min()\r\ntensor(340282346638528859811704183484516925440., device='cuda:0')\r\n>>> a == a\r\ntensor(1, device='cuda:0', dtype=torch.uint8)\r\n>>> a.min() == a\r\ntensor(0, device='cuda:0', dtype=torch.uint8)\r\n```\r\n\r\nAlso, max() fails on -inf:\r\n```\r\n>>> torch.tensor(float('-inf')).cuda().max()\r\ntensor(-340282346638528859811704183484516925440., device='cuda:0')\r\n```\r\n\r\n## To Reproduce\r\nRun the following line:\r\n`>>> torch.tensor(float('inf')).cuda().min()`\r\nResult:\r\n`tensor(340282346638528859811704183484516925440., device='cuda:0')`\r\n\r\n## Expected behavior\r\n\r\nThe min() operation should result in inf, just like on the cpu:\r\n```\r\n>>> torch.tensor(float('inf')).min()\r\ntensor(inf)\r\n```\r\n\r\nCasting back works fine:\r\n```\r\n>>> torch.tensor(float('inf')).cuda().cpu().min()\r\ntensor(inf)\r\n```\r\n\r\n## Environment\r\n\r\n - PyTorch Version: 0.4.1\r\n - OS: Windows 10, Ubuntu 16.04\r\n - How you installed PyTorch: conda\r\n - Python version: Python 3.6.4 :: Anaconda custom (64-bit)\r\n - CUDA/cuDNN version: 9.2\r\n - GPU models and configuration: GTX 1080"}