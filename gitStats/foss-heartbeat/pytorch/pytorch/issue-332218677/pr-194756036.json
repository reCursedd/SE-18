{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/8467", "id": 194756036, "node_id": "MDExOlB1bGxSZXF1ZXN0MTk0NzU2MDM2", "html_url": "https://github.com/pytorch/pytorch/pull/8467", "diff_url": "https://github.com/pytorch/pytorch/pull/8467.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/8467.patch", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8467", "number": 8467, "state": "closed", "locked": false, "title": "[Caffe2] Fixing missing PyCObject_Type bug", "user": {"login": "pjh5", "id": 6456020, "node_id": "MDQ6VXNlcjY0NTYwMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/6456020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjh5", "html_url": "https://github.com/pjh5", "followers_url": "https://api.github.com/users/pjh5/followers", "following_url": "https://api.github.com/users/pjh5/following{/other_user}", "gists_url": "https://api.github.com/users/pjh5/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjh5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjh5/subscriptions", "organizations_url": "https://api.github.com/users/pjh5/orgs", "repos_url": "https://api.github.com/users/pjh5/repos", "events_url": "https://api.github.com/users/pjh5/events{/privacy}", "received_events_url": "https://api.github.com/users/pjh5/received_events", "type": "User", "site_admin": false}, "body": "Also includes the changes in #8434 because they both affect cmake/Dependencies.cmake\r\n\r\nThe changes to scripts/build_anaconda.sh were just to make it more consistent with other build scripts and unrelated to the bug.\r\n\r\nThe addition of python 3.5 and 3.6 to find_python and the addition of setuptools to the meta.yaml together seem to fix the problem. Without having python 3.5 and 3.6 as additional python versions, the find_python code sometimes picks up different python installations for the libraries and the executable.  \r\n\r\nWith anaconda3, new environments come completely empty, even without python or setuptools. They will default to the first python version of the first package you install into them. When installing Caffe2 into such brand new environments, using distutils or setuptools will actually use the setuptools present in the root conda environment (since the new conda envs don't come with them), and so the sysconfig.get_python_lib() will actually be for root conda env instead of the activated env. This may not actually affect clean brand new conda caffe2 packages if they are all installed into neat conad envs, but it can cause strange behavior and be really annoying to debug if you don't expect it.", "created_at": "2018-06-14T01:22:14Z", "updated_at": "2018-08-24T16:54:28Z", "closed_at": "2018-06-14T15:08:26Z", "merged_at": "2018-06-14T15:08:26Z", "merge_commit_sha": "e323f0227753cb5b8a4abd821a95c09149720090", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "commits_url": "https://api.github.com/repos/pytorch/pytorch/pulls/8467/commits", "review_comments_url": "https://api.github.com/repos/pytorch/pytorch/pulls/8467/comments", "review_comment_url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8467/comments", "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/797591f9932d4bc3375ce1b6c7d76460d0ff0e68", "head": {"label": "pjh5:nother_conda_fix", "ref": "nother_conda_fix", "sha": "797591f9932d4bc3375ce1b6c7d76460d0ff0e68", "user": {"login": "pjh5", "id": 6456020, "node_id": "MDQ6VXNlcjY0NTYwMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/6456020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjh5", "html_url": "https://github.com/pjh5", "followers_url": "https://api.github.com/users/pjh5/followers", "following_url": "https://api.github.com/users/pjh5/following{/other_user}", "gists_url": "https://api.github.com/users/pjh5/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjh5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjh5/subscriptions", "organizations_url": "https://api.github.com/users/pjh5/orgs", "repos_url": "https://api.github.com/users/pjh5/repos", "events_url": "https://api.github.com/users/pjh5/events{/privacy}", "received_events_url": "https://api.github.com/users/pjh5/received_events", "type": "User", "site_admin": false}, "repo": {"id": 127456178, "node_id": "MDEwOlJlcG9zaXRvcnkxMjc0NTYxNzg=", "name": "pytorch", "full_name": "pjh5/pytorch", "private": false, "owner": {"login": "pjh5", "id": 6456020, "node_id": "MDQ6VXNlcjY0NTYwMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/6456020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjh5", "html_url": "https://github.com/pjh5", "followers_url": "https://api.github.com/users/pjh5/followers", "following_url": "https://api.github.com/users/pjh5/following{/other_user}", "gists_url": "https://api.github.com/users/pjh5/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjh5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjh5/subscriptions", "organizations_url": "https://api.github.com/users/pjh5/orgs", "repos_url": "https://api.github.com/users/pjh5/repos", "events_url": "https://api.github.com/users/pjh5/events{/privacy}", "received_events_url": "https://api.github.com/users/pjh5/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/pjh5/pytorch", "description": "Tensors and Dynamic neural networks in Python  with strong GPU acceleration", "fork": true, "url": "https://api.github.com/repos/pjh5/pytorch", "forks_url": "https://api.github.com/repos/pjh5/pytorch/forks", "keys_url": "https://api.github.com/repos/pjh5/pytorch/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/pjh5/pytorch/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/pjh5/pytorch/teams", "hooks_url": "https://api.github.com/repos/pjh5/pytorch/hooks", "issue_events_url": "https://api.github.com/repos/pjh5/pytorch/issues/events{/number}", "events_url": "https://api.github.com/repos/pjh5/pytorch/events", "assignees_url": "https://api.github.com/repos/pjh5/pytorch/assignees{/user}", "branches_url": "https://api.github.com/repos/pjh5/pytorch/branches{/branch}", "tags_url": "https://api.github.com/repos/pjh5/pytorch/tags", "blobs_url": "https://api.github.com/repos/pjh5/pytorch/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/pjh5/pytorch/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/pjh5/pytorch/git/refs{/sha}", "trees_url": "https://api.github.com/repos/pjh5/pytorch/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/pjh5/pytorch/statuses/{sha}", "languages_url": "https://api.github.com/repos/pjh5/pytorch/languages", "stargazers_url": "https://api.github.com/repos/pjh5/pytorch/stargazers", "contributors_url": "https://api.github.com/repos/pjh5/pytorch/contributors", "subscribers_url": "https://api.github.com/repos/pjh5/pytorch/subscribers", "subscription_url": "https://api.github.com/repos/pjh5/pytorch/subscription", "commits_url": "https://api.github.com/repos/pjh5/pytorch/commits{/sha}", "git_commits_url": "https://api.github.com/repos/pjh5/pytorch/git/commits{/sha}", "comments_url": "https://api.github.com/repos/pjh5/pytorch/comments{/number}", "issue_comment_url": "https://api.github.com/repos/pjh5/pytorch/issues/comments{/number}", "contents_url": "https://api.github.com/repos/pjh5/pytorch/contents/{+path}", "compare_url": "https://api.github.com/repos/pjh5/pytorch/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/pjh5/pytorch/merges", "archive_url": "https://api.github.com/repos/pjh5/pytorch/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/pjh5/pytorch/downloads", "issues_url": "https://api.github.com/repos/pjh5/pytorch/issues{/number}", "pulls_url": "https://api.github.com/repos/pjh5/pytorch/pulls{/number}", "milestones_url": "https://api.github.com/repos/pjh5/pytorch/milestones{/number}", "notifications_url": "https://api.github.com/repos/pjh5/pytorch/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/pjh5/pytorch/labels{/name}", "releases_url": "https://api.github.com/repos/pjh5/pytorch/releases{/id}", "deployments_url": "https://api.github.com/repos/pjh5/pytorch/deployments", "created_at": "2018-03-30T17:41:09Z", "updated_at": "2018-11-19T19:05:31Z", "pushed_at": "2018-11-22T00:46:45Z", "git_url": "git://github.com/pjh5/pytorch.git", "ssh_url": "git@github.com:pjh5/pytorch.git", "clone_url": "https://github.com/pjh5/pytorch.git", "svn_url": "https://github.com/pjh5/pytorch", "homepage": "http://pytorch.org", "size": 86359, "stargazers_count": 0, "watchers_count": 0, "language": "C++", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "forks_count": 0, "mirror_url": null, "archived": false, "open_issues_count": 0, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "pytorch:master", "ref": "master", "sha": "f7585178cdf562c5e28cbbff4853624ae1742379", "user": {"login": "pytorch", "id": 21003710, "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/21003710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytorch", "html_url": "https://github.com/pytorch", "followers_url": "https://api.github.com/users/pytorch/followers", "following_url": "https://api.github.com/users/pytorch/following{/other_user}", "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions", "organizations_url": "https://api.github.com/users/pytorch/orgs", "repos_url": "https://api.github.com/users/pytorch/repos", "events_url": "https://api.github.com/users/pytorch/events{/privacy}", "received_events_url": "https://api.github.com/users/pytorch/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 65600975, "node_id": "MDEwOlJlcG9zaXRvcnk2NTYwMDk3NQ==", "name": "pytorch", "full_name": "pytorch/pytorch", "private": false, "owner": {"login": "pytorch", "id": 21003710, "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/21003710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytorch", "html_url": "https://github.com/pytorch", "followers_url": "https://api.github.com/users/pytorch/followers", "following_url": "https://api.github.com/users/pytorch/following{/other_user}", "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions", "organizations_url": "https://api.github.com/users/pytorch/orgs", "repos_url": "https://api.github.com/users/pytorch/repos", "events_url": "https://api.github.com/users/pytorch/events{/privacy}", "received_events_url": "https://api.github.com/users/pytorch/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/pytorch/pytorch", "description": "Tensors and Dynamic neural networks in Python  with strong GPU acceleration", "fork": false, "url": "https://api.github.com/repos/pytorch/pytorch", "forks_url": "https://api.github.com/repos/pytorch/pytorch/forks", "keys_url": "https://api.github.com/repos/pytorch/pytorch/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/pytorch/pytorch/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/pytorch/pytorch/teams", "hooks_url": "https://api.github.com/repos/pytorch/pytorch/hooks", "issue_events_url": "https://api.github.com/repos/pytorch/pytorch/issues/events{/number}", "events_url": "https://api.github.com/repos/pytorch/pytorch/events", "assignees_url": "https://api.github.com/repos/pytorch/pytorch/assignees{/user}", "branches_url": "https://api.github.com/repos/pytorch/pytorch/branches{/branch}", "tags_url": "https://api.github.com/repos/pytorch/pytorch/tags", "blobs_url": "https://api.github.com/repos/pytorch/pytorch/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/pytorch/pytorch/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/pytorch/pytorch/git/refs{/sha}", "trees_url": "https://api.github.com/repos/pytorch/pytorch/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/{sha}", "languages_url": "https://api.github.com/repos/pytorch/pytorch/languages", "stargazers_url": "https://api.github.com/repos/pytorch/pytorch/stargazers", "contributors_url": "https://api.github.com/repos/pytorch/pytorch/contributors", "subscribers_url": "https://api.github.com/repos/pytorch/pytorch/subscribers", "subscription_url": "https://api.github.com/repos/pytorch/pytorch/subscription", "commits_url": "https://api.github.com/repos/pytorch/pytorch/commits{/sha}", "git_commits_url": "https://api.github.com/repos/pytorch/pytorch/git/commits{/sha}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/comments{/number}", "issue_comment_url": "https://api.github.com/repos/pytorch/pytorch/issues/comments{/number}", "contents_url": "https://api.github.com/repos/pytorch/pytorch/contents/{+path}", "compare_url": "https://api.github.com/repos/pytorch/pytorch/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/pytorch/pytorch/merges", "archive_url": "https://api.github.com/repos/pytorch/pytorch/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/pytorch/pytorch/downloads", "issues_url": "https://api.github.com/repos/pytorch/pytorch/issues{/number}", "pulls_url": "https://api.github.com/repos/pytorch/pytorch/pulls{/number}", "milestones_url": "https://api.github.com/repos/pytorch/pytorch/milestones{/number}", "notifications_url": "https://api.github.com/repos/pytorch/pytorch/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/pytorch/pytorch/labels{/name}", "releases_url": "https://api.github.com/repos/pytorch/pytorch/releases{/id}", "deployments_url": "https://api.github.com/repos/pytorch/pytorch/deployments", "created_at": "2016-08-13T05:26:41Z", "updated_at": "2018-11-24T12:35:43Z", "pushed_at": "2018-11-24T12:42:01Z", "git_url": "git://github.com/pytorch/pytorch.git", "ssh_url": "git@github.com:pytorch/pytorch.git", "clone_url": "https://github.com/pytorch/pytorch.git", "svn_url": "https://github.com/pytorch/pytorch", "homepage": "http://pytorch.org", "size": 89656, "stargazers_count": 21589, "watchers_count": 21589, "language": "C++", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "forks_count": 5153, "mirror_url": null, "archived": false, "open_issues_count": 2196, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "forks": 5153, "open_issues": 2196, "watchers": 21589, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/8467"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/8467"}, "issue": {"href": "https://api.github.com/repos/pytorch/pytorch/issues/8467"}, "comments": {"href": "https://api.github.com/repos/pytorch/pytorch/issues/8467/comments"}, "review_comments": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/8467/comments"}, "review_comment": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/8467/commits"}, "statuses": {"href": "https://api.github.com/repos/pytorch/pytorch/statuses/797591f9932d4bc3375ce1b6c7d76460d0ff0e68"}}, "author_association": "CONTRIBUTOR", "body_html": "<p>Also includes the changes in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"332101420\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/8434\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/8434/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/8434\">#8434</a> because they both affect cmake/Dependencies.cmake</p>\n<p>The changes to scripts/build_anaconda.sh were just to make it more consistent with other build scripts and unrelated to the bug.</p>\n<p>The addition of python 3.5 and 3.6 to find_python and the addition of setuptools to the meta.yaml together seem to fix the problem. Without having python 3.5 and 3.6 as additional python versions, the find_python code sometimes picks up different python installations for the libraries and the executable.</p>\n<p>With anaconda3, new environments come completely empty, even without python or setuptools. They will default to the first python version of the first package you install into them. When installing Caffe2 into such brand new environments, using distutils or setuptools will actually use the setuptools present in the root conda environment (since the new conda envs don't come with them), and so the sysconfig.get_python_lib() will actually be for root conda env instead of the activated env. This may not actually affect clean brand new conda caffe2 packages if they are all installed into neat conad envs, but it can cause strange behavior and be really annoying to debug if you don't expect it.</p>", "body_text": "Also includes the changes in #8434 because they both affect cmake/Dependencies.cmake\nThe changes to scripts/build_anaconda.sh were just to make it more consistent with other build scripts and unrelated to the bug.\nThe addition of python 3.5 and 3.6 to find_python and the addition of setuptools to the meta.yaml together seem to fix the problem. Without having python 3.5 and 3.6 as additional python versions, the find_python code sometimes picks up different python installations for the libraries and the executable.\nWith anaconda3, new environments come completely empty, even without python or setuptools. They will default to the first python version of the first package you install into them. When installing Caffe2 into such brand new environments, using distutils or setuptools will actually use the setuptools present in the root conda environment (since the new conda envs don't come with them), and so the sysconfig.get_python_lib() will actually be for root conda env instead of the activated env. This may not actually affect clean brand new conda caffe2 packages if they are all installed into neat conad envs, but it can cause strange behavior and be really annoying to debug if you don't expect it.", "merged": true, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": {"login": "orionr", "id": 79994, "node_id": "MDQ6VXNlcjc5OTk0", "avatar_url": "https://avatars3.githubusercontent.com/u/79994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/orionr", "html_url": "https://github.com/orionr", "followers_url": "https://api.github.com/users/orionr/followers", "following_url": "https://api.github.com/users/orionr/following{/other_user}", "gists_url": "https://api.github.com/users/orionr/gists{/gist_id}", "starred_url": "https://api.github.com/users/orionr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/orionr/subscriptions", "organizations_url": "https://api.github.com/users/orionr/orgs", "repos_url": "https://api.github.com/users/orionr/repos", "events_url": "https://api.github.com/users/orionr/events{/privacy}", "received_events_url": "https://api.github.com/users/orionr/received_events", "type": "User", "site_admin": false}, "comments": 2, "review_comments": 0, "maintainer_can_modify": false, "commits": 1, "additions": 31, "deletions": 13, "changed_files": 4}