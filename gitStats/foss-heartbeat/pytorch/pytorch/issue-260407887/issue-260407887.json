{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2862", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2862/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2862/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2862/events", "html_url": "https://github.com/pytorch/pytorch/issues/2862", "id": 260407887, "node_id": "MDU6SXNzdWUyNjA0MDc4ODc=", "number": 2862, "title": "Local docker build fails if you haven't initialized submodules", "user": {"login": "cdw", "id": 58636, "node_id": "MDQ6VXNlcjU4NjM2", "avatar_url": "https://avatars0.githubusercontent.com/u/58636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cdw", "html_url": "https://github.com/cdw", "followers_url": "https://api.github.com/users/cdw/followers", "following_url": "https://api.github.com/users/cdw/following{/other_user}", "gists_url": "https://api.github.com/users/cdw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cdw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cdw/subscriptions", "organizations_url": "https://api.github.com/users/cdw/orgs", "repos_url": "https://api.github.com/users/cdw/repos", "events_url": "https://api.github.com/users/cdw/events{/privacy}", "received_events_url": "https://api.github.com/users/cdw/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-09-25T20:40:44Z", "updated_at": "2017-09-25T22:04:55Z", "closed_at": "2017-09-25T22:04:47Z", "author_association": "NONE", "body_html": "<p>To reproduce:</p>\n<ol>\n<li>clone clean copy of master</li>\n<li>run <code>docker build ./</code></li>\n</ol>\n<p>What happens:<br>\nLocal docker build fails on step 12 b/c the build assumes that submodules have been initialized with <code>git submodule update --init</code> and then copied over to the container by the prior <code>COPY . . </code> step.</p>\n<p>To fix:<br>\nInitialize the submodules before initiating the build, or initialize them in the docker container before continuing the build.</p>\n<p>Actual error code:</p>\n<pre><code>Step 9/12 : RUN TORCH_CUDA_ARCH_LIST=\"3.5 5.2 6.0 6.1+PTX\" TORCH_NVCC_FLAGS=\"-Xfatbin -compress-all\"     CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"     pip install -v .\n ---&gt; Running in 4f4eb6920fa9\nProcessing /opt/pytorch\n  Running setup.py (path:/tmp/pip-qyteks6m-build/setup.py) egg_info for package from file:///opt/pytorch\n    Running command python setup.py egg_info\n    Could not find /tmp/pip-qyteks6m-build/torch/lib/gloo/CMakeLists.txt\n    Did you run 'git submodule update --init'?\nCleaning up...\nCommand \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-qyteks6m-build/\nException information:\nTraceback (most recent call last):\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/basecommand.py\", line 215, in main\n    status = self.run(options, args)\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/commands/install.py\", line 335, in run\n    wb.build(autobuilding=True)\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/wheel.py\", line 749, in build\n    self.requirement_set.prepare_files(self.finder)\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 380, in prepare_files\n    ignore_dependencies=self.ignore_dependencies))\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 634, in _prepare_file\n    abstract_dist.prep_for_dist()\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 129, in prep_for_dist\n    self.req_to_install.run_egg_info()\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_install.py\", line 439, in run_egg_info\n    command_desc='python setup.py egg_info')\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/utils/__init__.py\", line 707, in call_subprocess\n    % (command_desc, proc.returncode, cwd))\npip.exceptions.InstallationError: Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-qyteks6m-build/\nLooking up \"https://pypi.python.org/pypi/pip/json\" in the cache\nNo cache entry available\nStarting new HTTPS connection (1): pypi.python.org\n\"GET /pypi/pip/json HTTP/1.1\" 200 72983\nUpdating cache with response from \"https://pypi.python.org/pypi/pip/json\"\nCaching b/c date exists and max-age &gt; 0\nThe command '/bin/sh -c TORCH_CUDA_ARCH_LIST=\"3.5 5.2 6.0 6.1+PTX\" TORCH_NVCC_FLAGS=\"-Xfatbin -compress-all\"     CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"     pip install -v .' returned a non-zero code: 1\n</code></pre>", "body_text": "To reproduce:\n\nclone clean copy of master\nrun docker build ./\n\nWhat happens:\nLocal docker build fails on step 12 b/c the build assumes that submodules have been initialized with git submodule update --init and then copied over to the container by the prior COPY . .  step.\nTo fix:\nInitialize the submodules before initiating the build, or initialize them in the docker container before continuing the build.\nActual error code:\nStep 9/12 : RUN TORCH_CUDA_ARCH_LIST=\"3.5 5.2 6.0 6.1+PTX\" TORCH_NVCC_FLAGS=\"-Xfatbin -compress-all\"     CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"     pip install -v .\n ---> Running in 4f4eb6920fa9\nProcessing /opt/pytorch\n  Running setup.py (path:/tmp/pip-qyteks6m-build/setup.py) egg_info for package from file:///opt/pytorch\n    Running command python setup.py egg_info\n    Could not find /tmp/pip-qyteks6m-build/torch/lib/gloo/CMakeLists.txt\n    Did you run 'git submodule update --init'?\nCleaning up...\nCommand \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-qyteks6m-build/\nException information:\nTraceback (most recent call last):\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/basecommand.py\", line 215, in main\n    status = self.run(options, args)\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/commands/install.py\", line 335, in run\n    wb.build(autobuilding=True)\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/wheel.py\", line 749, in build\n    self.requirement_set.prepare_files(self.finder)\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 380, in prepare_files\n    ignore_dependencies=self.ignore_dependencies))\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 634, in _prepare_file\n    abstract_dist.prep_for_dist()\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 129, in prep_for_dist\n    self.req_to_install.run_egg_info()\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_install.py\", line 439, in run_egg_info\n    command_desc='python setup.py egg_info')\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/utils/__init__.py\", line 707, in call_subprocess\n    % (command_desc, proc.returncode, cwd))\npip.exceptions.InstallationError: Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-qyteks6m-build/\nLooking up \"https://pypi.python.org/pypi/pip/json\" in the cache\nNo cache entry available\nStarting new HTTPS connection (1): pypi.python.org\n\"GET /pypi/pip/json HTTP/1.1\" 200 72983\nUpdating cache with response from \"https://pypi.python.org/pypi/pip/json\"\nCaching b/c date exists and max-age > 0\nThe command '/bin/sh -c TORCH_CUDA_ARCH_LIST=\"3.5 5.2 6.0 6.1+PTX\" TORCH_NVCC_FLAGS=\"-Xfatbin -compress-all\"     CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"     pip install -v .' returned a non-zero code: 1", "body": "To reproduce:\r\n1. clone clean copy of master\r\n2. run `docker build ./`\r\n\r\nWhat happens:\r\nLocal docker build fails on step 12 b/c the build assumes that submodules have been initialized with `git submodule update --init` and then copied over to the container by the prior `COPY . . ` step. \r\n\r\nTo fix:\r\nInitialize the submodules before initiating the build, or initialize them in the docker container before continuing the build. \r\n\r\nActual error code:\r\n```\r\nStep 9/12 : RUN TORCH_CUDA_ARCH_LIST=\"3.5 5.2 6.0 6.1+PTX\" TORCH_NVCC_FLAGS=\"-Xfatbin -compress-all\"     CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"     pip install -v .\r\n ---> Running in 4f4eb6920fa9\r\nProcessing /opt/pytorch\r\n  Running setup.py (path:/tmp/pip-qyteks6m-build/setup.py) egg_info for package from file:///opt/pytorch\r\n    Running command python setup.py egg_info\r\n    Could not find /tmp/pip-qyteks6m-build/torch/lib/gloo/CMakeLists.txt\r\n    Did you run 'git submodule update --init'?\r\nCleaning up...\r\nCommand \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-qyteks6m-build/\r\nException information:\r\nTraceback (most recent call last):\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/basecommand.py\", line 215, in main\r\n    status = self.run(options, args)\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/commands/install.py\", line 335, in run\r\n    wb.build(autobuilding=True)\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/wheel.py\", line 749, in build\r\n    self.requirement_set.prepare_files(self.finder)\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 380, in prepare_files\r\n    ignore_dependencies=self.ignore_dependencies))\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 634, in _prepare_file\r\n    abstract_dist.prep_for_dist()\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_set.py\", line 129, in prep_for_dist\r\n    self.req_to_install.run_egg_info()\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/req/req_install.py\", line 439, in run_egg_info\r\n    command_desc='python setup.py egg_info')\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/pip/utils/__init__.py\", line 707, in call_subprocess\r\n    % (command_desc, proc.returncode, cwd))\r\npip.exceptions.InstallationError: Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-qyteks6m-build/\r\nLooking up \"https://pypi.python.org/pypi/pip/json\" in the cache\r\nNo cache entry available\r\nStarting new HTTPS connection (1): pypi.python.org\r\n\"GET /pypi/pip/json HTTP/1.1\" 200 72983\r\nUpdating cache with response from \"https://pypi.python.org/pypi/pip/json\"\r\nCaching b/c date exists and max-age > 0\r\nThe command '/bin/sh -c TORCH_CUDA_ARCH_LIST=\"3.5 5.2 6.0 6.1+PTX\" TORCH_NVCC_FLAGS=\"-Xfatbin -compress-all\"     CMAKE_PREFIX_PATH=\"$(dirname $(which conda))/../\"     pip install -v .' returned a non-zero code: 1\r\n```"}