{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12256", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12256/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12256/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12256/events", "html_url": "https://github.com/pytorch/pytorch/issues/12256", "id": 365800090, "node_id": "MDU6SXNzdWUzNjU4MDAwOTA=", "number": 12256, "title": "[Conv3D][cudnn] CUDNN_STATUS_NOT_INITIALIZED error when using batch size > 1 with conv layer", "user": {"login": "hm2092", "id": 40290189, "node_id": "MDQ6VXNlcjQwMjkwMTg5", "avatar_url": "https://avatars1.githubusercontent.com/u/40290189?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hm2092", "html_url": "https://github.com/hm2092", "followers_url": "https://api.github.com/users/hm2092/followers", "following_url": "https://api.github.com/users/hm2092/following{/other_user}", "gists_url": "https://api.github.com/users/hm2092/gists{/gist_id}", "starred_url": "https://api.github.com/users/hm2092/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hm2092/subscriptions", "organizations_url": "https://api.github.com/users/hm2092/orgs", "repos_url": "https://api.github.com/users/hm2092/repos", "events_url": "https://api.github.com/users/hm2092/events{/privacy}", "received_events_url": "https://api.github.com/users/hm2092/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-10-02T08:53:30Z", "updated_at": "2018-10-11T07:35:32Z", "closed_at": "2018-10-11T07:35:32Z", "author_association": "NONE", "body_html": "<p>Hello Everyone.</p>\n<p>I ran into RuntimeError: CUDNN_STATUS_NOT_INITIALIZED,  while trying a batch_size &gt; 1 for training(and also validation). My system details are:<br>\nCuda version: 9.0.176<br>\nCudnn version: 7102<br>\nPytorch version: 0.4.0<br>\nGPU: GTX 1080 Ti<br>\nDriver version: 390.77<br>\nOS: Ubuntu 16.04</p>\n<p>I am working with point cloud data and with a batch_size of 1, the training as well as validation loops work fine. This problem arises when I increase the batch size. Detailed traceback is given below for a batch_size of 2:</p>\n<pre><code>&lt;ipython-input-20-8f012bcb5dc5&gt; in forward(self, x)\n      9 \n     10     def forward(self, x):\n---&gt; 11         x = self.conv3d_1(x)\n     12         x = self.conv3d_2(x)\n     13         x = self.conv3d_3(x)\n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\n    489             result = self._slow_forward(*input, **kwargs)\n    490         else:\n--&gt; 491             result = self.forward(*input, **kwargs)\n    492         for hook in self._forward_hooks.values():\n    493             hook_result = hook(self, input, result)\n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/container.py in forward(self, input)\n     89     def forward(self, input):\n     90         for module in self._modules.values():\n---&gt; 91             input = module(input)\n     92         return input\n     93 \n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\n    489             result = self._slow_forward(*input, **kwargs)\n    490         else:\n--&gt; 491             result = self.forward(*input, **kwargs)\n    492         for hook in self._forward_hooks.values():\n    493             hook_result = hook(self, input, result)\n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/conv.py in forward(self, input)\n    419     def forward(self, input):\n    420         return F.conv3d(input, self.weight, self.bias, self.stride,\n--&gt; 421                         self.padding, self.dilation, self.groups)\n    422 \nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\n</code></pre>\n<p>I realized that in this issue (<a href=\"https://discuss.pytorch.org/t/cudnn-status-not-initialized-when-using-cnn/16766/3?u=hm2092\" rel=\"nofollow\">https://discuss.pytorch.org/t/cudnn-status-not-initialized-when-using-cnn/16766/3?u=hm2092</a>) also, the error occured for conv1D layer and in my case, in conv3D layer.<br>\nAny help would be great. Thank you in advance.</p>", "body_text": "Hello Everyone.\nI ran into RuntimeError: CUDNN_STATUS_NOT_INITIALIZED,  while trying a batch_size > 1 for training(and also validation). My system details are:\nCuda version: 9.0.176\nCudnn version: 7102\nPytorch version: 0.4.0\nGPU: GTX 1080 Ti\nDriver version: 390.77\nOS: Ubuntu 16.04\nI am working with point cloud data and with a batch_size of 1, the training as well as validation loops work fine. This problem arises when I increase the batch size. Detailed traceback is given below for a batch_size of 2:\n<ipython-input-20-8f012bcb5dc5> in forward(self, x)\n      9 \n     10     def forward(self, x):\n---> 11         x = self.conv3d_1(x)\n     12         x = self.conv3d_2(x)\n     13         x = self.conv3d_3(x)\n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\n    489             result = self._slow_forward(*input, **kwargs)\n    490         else:\n--> 491             result = self.forward(*input, **kwargs)\n    492         for hook in self._forward_hooks.values():\n    493             hook_result = hook(self, input, result)\n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/container.py in forward(self, input)\n     89     def forward(self, input):\n     90         for module in self._modules.values():\n---> 91             input = module(input)\n     92         return input\n     93 \n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\n    489             result = self._slow_forward(*input, **kwargs)\n    490         else:\n--> 491             result = self.forward(*input, **kwargs)\n    492         for hook in self._forward_hooks.values():\n    493             hook_result = hook(self, input, result)\n\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/conv.py in forward(self, input)\n    419     def forward(self, input):\n    420         return F.conv3d(input, self.weight, self.bias, self.stride,\n--> 421                         self.padding, self.dilation, self.groups)\n    422 \nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\n\nI realized that in this issue (https://discuss.pytorch.org/t/cudnn-status-not-initialized-when-using-cnn/16766/3?u=hm2092) also, the error occured for conv1D layer and in my case, in conv3D layer.\nAny help would be great. Thank you in advance.", "body": "Hello Everyone. \r\n\r\nI ran into RuntimeError: CUDNN_STATUS_NOT_INITIALIZED,  while trying a batch_size > 1 for training(and also validation). My system details are:\r\nCuda version: 9.0.176\r\nCudnn version: 7102\r\nPytorch version: 0.4.0 \r\nGPU: GTX 1080 Ti\r\nDriver version: 390.77\r\nOS: Ubuntu 16.04\r\n\r\nI am working with point cloud data and with a batch_size of 1, the training as well as validation loops work fine. This problem arises when I increase the batch size. Detailed traceback is given below for a batch_size of 2:\r\n\r\n```\r\n<ipython-input-20-8f012bcb5dc5> in forward(self, x)\r\n      9 \r\n     10     def forward(self, x):\r\n---> 11         x = self.conv3d_1(x)\r\n     12         x = self.conv3d_2(x)\r\n     13         x = self.conv3d_3(x)\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    489             result = self._slow_forward(*input, **kwargs)\r\n    490         else:\r\n--> 491             result = self.forward(*input, **kwargs)\r\n    492         for hook in self._forward_hooks.values():\r\n    493             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/container.py in forward(self, input)\r\n     89     def forward(self, input):\r\n     90         for module in self._modules.values():\r\n---> 91             input = module(input)\r\n     92         return input\r\n     93 \r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    489             result = self._slow_forward(*input, **kwargs)\r\n    490         else:\r\n--> 491             result = self.forward(*input, **kwargs)\r\n    492         for hook in self._forward_hooks.values():\r\n    493             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/conv.py in forward(self, input)\r\n    419     def forward(self, input):\r\n    420         return F.conv3d(input, self.weight, self.bias, self.stride,\r\n--> 421                         self.padding, self.dilation, self.groups)\r\n    422 \r\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\r\n```\r\n\r\nI realized that in this issue (https://discuss.pytorch.org/t/cudnn-status-not-initialized-when-using-cnn/16766/3?u=hm2092) also, the error occured for conv1D layer and in my case, in conv3D layer.\r\nAny help would be great. Thank you in advance."}