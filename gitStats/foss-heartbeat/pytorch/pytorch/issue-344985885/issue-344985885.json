{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9899", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9899/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9899/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9899/events", "html_url": "https://github.com/pytorch/pytorch/issues/9899", "id": 344985885, "node_id": "MDU6SXNzdWUzNDQ5ODU4ODU=", "number": 9899, "title": "Segfault when running model in eval mode and using .numpy()", "user": {"login": "kierkegaard13", "id": 1851271, "node_id": "MDQ6VXNlcjE4NTEyNzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/1851271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kierkegaard13", "html_url": "https://github.com/kierkegaard13", "followers_url": "https://api.github.com/users/kierkegaard13/followers", "following_url": "https://api.github.com/users/kierkegaard13/following{/other_user}", "gists_url": "https://api.github.com/users/kierkegaard13/gists{/gist_id}", "starred_url": "https://api.github.com/users/kierkegaard13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kierkegaard13/subscriptions", "organizations_url": "https://api.github.com/users/kierkegaard13/orgs", "repos_url": "https://api.github.com/users/kierkegaard13/repos", "events_url": "https://api.github.com/users/kierkegaard13/events{/privacy}", "received_events_url": "https://api.github.com/users/kierkegaard13/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-26T20:03:02Z", "updated_at": "2018-07-30T17:54:55Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>If you have a question or would like help and support, please ask at our<br>\n<a href=\"https://discuss.pytorch.org/\" rel=\"nofollow\">forums</a>.</p>\n<p>If you are submitting a feature request, please preface the title with [feature request].<br>\nIf you are submitting a bug report, please fill in the following details.</p>\n<h2>Issue description</h2>\n<p>I'm training a model using pytorch and when I try and create predictions using the same model and export the predictions to numpy before returning from my predict function, I get a segfault. This only occurs when running on a cpu (no .cuda). Further, there are 3 solutions that I've identified. I've reproduced this using a cleaned version of the Beijing pollution dataset from the UCI repository:<br>\n<a href=\"https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data#\" rel=\"nofollow\">https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data#</a></p>\n<ol>\n<li>Run on a gpu using .cuda</li>\n<li>Use .numpy after returning predictions from predict function</li>\n<li>Wrap predict call in <code>with torch.no_grad()</code></li>\n</ol>\n<h2>Code example</h2>\n<p>Please try to provide a minimal example to repro the bug.<br>\nError messages and stack traces are also helpful.</p>\n<p>I've included a simple python script with the cleaned beijing data and target csv's.</p>\n<p><a href=\"https://github.com/pytorch/pytorch/files/2233402/btest.zip\">btest.zip</a></p>\n<h2>System Info</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source): conda</li>\n<li>Build command you used (if compiling from source):</li>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: 0.4.0</li>\n<li>Python version: 3.6.5</li>\n<li>CUDA/cuDNN version: 9.1/7.1</li>\n<li>GPU models and configuration: 1 GTX 1080</li>\n<li>GCC version (if compiling from source):</li>\n<li>CMake version:</li>\n<li>Versions of any other relevant libraries:</li>\n</ul>", "body_text": "If you have a question or would like help and support, please ask at our\nforums.\nIf you are submitting a feature request, please preface the title with [feature request].\nIf you are submitting a bug report, please fill in the following details.\nIssue description\nI'm training a model using pytorch and when I try and create predictions using the same model and export the predictions to numpy before returning from my predict function, I get a segfault. This only occurs when running on a cpu (no .cuda). Further, there are 3 solutions that I've identified. I've reproduced this using a cleaned version of the Beijing pollution dataset from the UCI repository:\nhttps://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data#\n\nRun on a gpu using .cuda\nUse .numpy after returning predictions from predict function\nWrap predict call in with torch.no_grad()\n\nCode example\nPlease try to provide a minimal example to repro the bug.\nError messages and stack traces are also helpful.\nI've included a simple python script with the cleaned beijing data and target csv's.\nbtest.zip\nSystem Info\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\n\nPyTorch or Caffe2: PyTorch\nHow you installed PyTorch (conda, pip, source): conda\nBuild command you used (if compiling from source):\nOS: Ubuntu 16.04\nPyTorch version: 0.4.0\nPython version: 3.6.5\nCUDA/cuDNN version: 9.1/7.1\nGPU models and configuration: 1 GTX 1080\nGCC version (if compiling from source):\nCMake version:\nVersions of any other relevant libraries:", "body": "If you have a question or would like help and support, please ask at our\r\n[forums](https://discuss.pytorch.org/).\r\n\r\nIf you are submitting a feature request, please preface the title with [feature request].\r\nIf you are submitting a bug report, please fill in the following details.\r\n\r\n## Issue description\r\nI'm training a model using pytorch and when I try and create predictions using the same model and export the predictions to numpy before returning from my predict function, I get a segfault. This only occurs when running on a cpu (no .cuda). Further, there are 3 solutions that I've identified. I've reproduced this using a cleaned version of the Beijing pollution dataset from the UCI repository:\r\nhttps://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data#\r\n1. Run on a gpu using .cuda\r\n2. Use .numpy after returning predictions from predict function\r\n3. Wrap predict call in `with torch.no_grad()`\r\n\r\n## Code example\r\n\r\nPlease try to provide a minimal example to repro the bug.\r\nError messages and stack traces are also helpful.\r\n\r\nI've included a simple python script with the cleaned beijing data and target csv's.\r\n\r\n[btest.zip](https://github.com/pytorch/pytorch/files/2233402/btest.zip)\r\n\r\n## System Info\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n- PyTorch or Caffe2: PyTorch\r\n- How you installed PyTorch (conda, pip, source): conda\r\n- Build command you used (if compiling from source): \r\n- OS: Ubuntu 16.04\r\n- PyTorch version: 0.4.0\r\n- Python version: 3.6.5\r\n- CUDA/cuDNN version: 9.1/7.1\r\n- GPU models and configuration: 1 GTX 1080\r\n- GCC version (if compiling from source): \r\n- CMake version: \r\n- Versions of any other relevant libraries:\r\n"}