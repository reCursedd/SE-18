{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1841", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1841/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1841/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1841/events", "html_url": "https://github.com/pytorch/pytorch/issues/1841", "id": 236810442, "node_id": "MDU6SXNzdWUyMzY4MTA0NDI=", "number": 1841, "title": "Inconsistent tensor size while loading data using data loader from torch.utils.data .", "user": {"login": "Deepayan137", "id": 21141806, "node_id": "MDQ6VXNlcjIxMTQxODA2", "avatar_url": "https://avatars0.githubusercontent.com/u/21141806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Deepayan137", "html_url": "https://github.com/Deepayan137", "followers_url": "https://api.github.com/users/Deepayan137/followers", "following_url": "https://api.github.com/users/Deepayan137/following{/other_user}", "gists_url": "https://api.github.com/users/Deepayan137/gists{/gist_id}", "starred_url": "https://api.github.com/users/Deepayan137/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Deepayan137/subscriptions", "organizations_url": "https://api.github.com/users/Deepayan137/orgs", "repos_url": "https://api.github.com/users/Deepayan137/repos", "events_url": "https://api.github.com/users/Deepayan137/events{/privacy}", "received_events_url": "https://api.github.com/users/Deepayan137/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-19T08:07:44Z", "updated_at": "2017-06-19T14:05:45Z", "closed_at": "2017-06-19T14:05:41Z", "author_association": "NONE", "body_html": "<p>I am training an OCR using RNN. I am supplying input data as word images of varying dimensions (since each word can be of different lengths) and the size of class labels of each input data is also not consistent. Since each word can have a different number of characters.</p>\n<div class=\"highlight highlight-source-python\"><pre>   tensor_word_dataset <span class=\"pl-k\">=</span> WordImagesDataset(images, truths, <span class=\"pl-v\">transform</span> <span class=\"pl-k\">=</span> ToTensor())\n   dataset_loader <span class=\"pl-k\">=</span> torch.utils.data.DataLoader(tensor_word_dataset,\n                                            <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">16</span>, <span class=\"pl-v\">shuffle</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>,) </pre></div>\n<p>This gives me the error:<br>\n<code>RuntimeError: inconsistent tensor size at /py/conda-bld/pytorch_1493673470840/work/torch/lib/TH/generic/THTensorCopy.c:46 </code></p>\n<p>The image sizes of first 5 input labels and images respectively  are:</p>\n<pre><code> torch.Size([2]) torch.Size([32, 41])\n torch.Size([7]) torch.Size([32, 95])\n torch.Size([2]) torch.Size([32, 38])\n torch.Size([2]) torch.Size([32, 53])\n torch.Size([2]) torch.Size([32, 49])\n torch.Size([6]) torch.Size([32, 55])\n</code></pre>\n<p>Any suggestions as to how should I fix it. I want to shuffle the data and send it in batches instead of supplying them one at a time.</p>", "body_text": "I am training an OCR using RNN. I am supplying input data as word images of varying dimensions (since each word can be of different lengths) and the size of class labels of each input data is also not consistent. Since each word can have a different number of characters.\n   tensor_word_dataset = WordImagesDataset(images, truths, transform = ToTensor())\n   dataset_loader = torch.utils.data.DataLoader(tensor_word_dataset,\n                                            batch_size=16, shuffle=True,) \nThis gives me the error:\nRuntimeError: inconsistent tensor size at /py/conda-bld/pytorch_1493673470840/work/torch/lib/TH/generic/THTensorCopy.c:46 \nThe image sizes of first 5 input labels and images respectively  are:\n torch.Size([2]) torch.Size([32, 41])\n torch.Size([7]) torch.Size([32, 95])\n torch.Size([2]) torch.Size([32, 38])\n torch.Size([2]) torch.Size([32, 53])\n torch.Size([2]) torch.Size([32, 49])\n torch.Size([6]) torch.Size([32, 55])\n\nAny suggestions as to how should I fix it. I want to shuffle the data and send it in batches instead of supplying them one at a time.", "body": "I am training an OCR using RNN. I am supplying input data as word images of varying dimensions (since each word can be of different lengths) and the size of class labels of each input data is also not consistent. Since each word can have a different number of characters.\r\n\r\n```python\r\n   tensor_word_dataset = WordImagesDataset(images, truths, transform = ToTensor())\r\n   dataset_loader = torch.utils.data.DataLoader(tensor_word_dataset,\r\n                                            batch_size=16, shuffle=True,) \r\n```\r\n\r\nThis gives me the error:\r\n`RuntimeError: inconsistent tensor size at /py/conda-bld/pytorch_1493673470840/work/torch/lib/TH/generic/THTensorCopy.c:46\r\n`\r\n\r\nThe image sizes of first 5 input labels and images respectively  are:\r\n```\r\n torch.Size([2]) torch.Size([32, 41])\r\n torch.Size([7]) torch.Size([32, 95])\r\n torch.Size([2]) torch.Size([32, 38])\r\n torch.Size([2]) torch.Size([32, 53])\r\n torch.Size([2]) torch.Size([32, 49])\r\n torch.Size([6]) torch.Size([32, 55])\r\n ```\r\n\r\nAny suggestions as to how should I fix it. I want to shuffle the data and send it in batches instead of supplying them one at a time."}