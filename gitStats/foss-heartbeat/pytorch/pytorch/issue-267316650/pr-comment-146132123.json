{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/146132123", "pull_request_review_id": 71033685, "id": 146132123, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0NjEzMjEyMw==", "diff_hunk": "@@ -654,44 +611,108 @@ def emit_record_trace(env, declaration):\n         combined = nested_dict(local, nested_dict(env, declaration))\n         return RECORD_TRACE.substitute(combined)\n \n-    def process_function(declaration):\n-        if skip_function(declaration['name']):\n-            return\n+    def emit_check_no_requires_grad(tensor_args, args_with_derivatives):\n+        \"\"\"Checks that arguments without derivatives don't require grad\"\"\"\n+        body = []\n+        for arg in tensor_args:\n+            name = arg['name']\n+            if name in args_with_derivatives:\n+                continue\n+            if name == 'output':\n+                # Double-backwards definitions sometimes take in 'input' and\n+                # 'output', but only define the derivative for input.\n+                continue\n+            if arg['dynamic_type'] in {'IndexTensor', 'BoolTensor'}:\n+                continue", "path": "tools/autograd/gen_variable_type.py", "position": 149, "original_position": 149, "commit_id": "dc74aec7ca603a5217702101ec2c35cdeb454590", "original_commit_id": "dc74aec7ca603a5217702101ec2c35cdeb454590", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "You should still check that these don't require grad. We should add checks to Variable constructor (in Python), to make sure people never create index or bool tensors that do", "created_at": "2017-10-22T13:44:22Z", "updated_at": "2018-11-23T15:35:37Z", "html_url": "https://github.com/pytorch/pytorch/pull/3212#discussion_r146132123", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/3212", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/146132123"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/3212#discussion_r146132123"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/3212"}}, "body_html": "<p>You should still check that these don't require grad. We should add checks to Variable constructor (in Python), to make sure people never create index or bool tensors that do</p>", "body_text": "You should still check that these don't require grad. We should add checks to Variable constructor (in Python), to make sure people never create index or bool tensors that do"}