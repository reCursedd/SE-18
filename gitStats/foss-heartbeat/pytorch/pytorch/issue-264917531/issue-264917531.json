{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3086", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3086/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3086/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3086/events", "html_url": "https://github.com/pytorch/pytorch/issues/3086", "id": 264917531, "node_id": "MDU6SXNzdWUyNjQ5MTc1MzE=", "number": 3086, "title": "Docker Build Issue, Conda Installs Wrong CUDA Version", "user": {"login": "magic282", "id": 2285145, "node_id": "MDQ6VXNlcjIyODUxNDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/2285145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magic282", "html_url": "https://github.com/magic282", "followers_url": "https://api.github.com/users/magic282/followers", "following_url": "https://api.github.com/users/magic282/following{/other_user}", "gists_url": "https://api.github.com/users/magic282/gists{/gist_id}", "starred_url": "https://api.github.com/users/magic282/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magic282/subscriptions", "organizations_url": "https://api.github.com/users/magic282/orgs", "repos_url": "https://api.github.com/users/magic282/repos", "events_url": "https://api.github.com/users/magic282/events{/privacy}", "received_events_url": "https://api.github.com/users/magic282/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-10-12T12:11:47Z", "updated_at": "2017-10-12T12:25:57Z", "closed_at": "2017-10-12T12:25:57Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>I want to build a docker with the older version of PyTorch, 0.1.12.</p>\n<p>So I changed the docker file very little:</p>\n<pre><code>FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\n\nRUN echo \"deb http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64 /\" &gt; /etc/apt/sources.list.d/nvidia-ml.list\n\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n         build-essential \\\n         cmake \\\n         git \\\n         curl \\\n         vim \\\n         emacs \\\n         ca-certificates \\\n         libnccl2=2.0.5-2+cuda8.0 \\\n         libnccl-dev=2.0.5-2+cuda8.0 \\\n         libjpeg-dev \\\n         libpng-dev &amp;&amp;\\\n     rm -rf /var/lib/apt/lists/*\n\n\nENV PYTHON_VERSION=3.6.1\nENV INSTALL_PYTORCH_VERSION=0.1.12\n#ENV INSTALL_PYTORCH_VERSION=0.2.0\nRUN curl -o ~/miniconda.sh -O  https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh  &amp;&amp; \\\n     chmod +x ~/miniconda.sh &amp;&amp; \\\n     ~/miniconda.sh -b -p /opt/conda &amp;&amp; \\\n     rm ~/miniconda.sh &amp;&amp; \\\n#     /opt/conda/bin/conda install conda-build &amp;&amp; \\\n     /opt/conda/bin/conda create -y --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION python=$PYTHON_VERSION numpy pyyaml scipy ipython mkl&amp;&amp; \\\n     /opt/conda/bin/conda clean -ya\nENV PATH /opt/conda/envs/pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION/bin:$PATH\nRUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION -c soumith magma-cuda80\nRUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION https://anaconda.org/soumith/pytorch/0.1.12/download/linux-64/pytorch-0.1.12-py361_2cu80.tar.bz2\n\nWORKDIR /workspace\nRUN chmod -R a+w /workspace\n</code></pre>\n<p>I found that if use <code> RUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION -c soumith magma-cuda80 pytorch=$ENV INSTALL_PYTORCH_VERSION</code>,<br>\nconda will make a wrong plan, which will install cuda7.5 version.<br>\nSo I have to specify the download address.</p>\n<p>Any hints for this problem? Thanks.</p>", "body_text": "Hi,\nI want to build a docker with the older version of PyTorch, 0.1.12.\nSo I changed the docker file very little:\nFROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\n\nRUN echo \"deb http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64 /\" > /etc/apt/sources.list.d/nvidia-ml.list\n\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n         build-essential \\\n         cmake \\\n         git \\\n         curl \\\n         vim \\\n         emacs \\\n         ca-certificates \\\n         libnccl2=2.0.5-2+cuda8.0 \\\n         libnccl-dev=2.0.5-2+cuda8.0 \\\n         libjpeg-dev \\\n         libpng-dev &&\\\n     rm -rf /var/lib/apt/lists/*\n\n\nENV PYTHON_VERSION=3.6.1\nENV INSTALL_PYTORCH_VERSION=0.1.12\n#ENV INSTALL_PYTORCH_VERSION=0.2.0\nRUN curl -o ~/miniconda.sh -O  https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh  && \\\n     chmod +x ~/miniconda.sh && \\\n     ~/miniconda.sh -b -p /opt/conda && \\\n     rm ~/miniconda.sh && \\\n#     /opt/conda/bin/conda install conda-build && \\\n     /opt/conda/bin/conda create -y --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION python=$PYTHON_VERSION numpy pyyaml scipy ipython mkl&& \\\n     /opt/conda/bin/conda clean -ya\nENV PATH /opt/conda/envs/pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION/bin:$PATH\nRUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION -c soumith magma-cuda80\nRUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION https://anaconda.org/soumith/pytorch/0.1.12/download/linux-64/pytorch-0.1.12-py361_2cu80.tar.bz2\n\nWORKDIR /workspace\nRUN chmod -R a+w /workspace\n\nI found that if use  RUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION -c soumith magma-cuda80 pytorch=$ENV INSTALL_PYTORCH_VERSION,\nconda will make a wrong plan, which will install cuda7.5 version.\nSo I have to specify the download address.\nAny hints for this problem? Thanks.", "body": "Hi,\r\n\r\nI want to build a docker with the older version of PyTorch, 0.1.12.\r\n\r\nSo I changed the docker file very little:\r\n```\r\nFROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\r\n\r\nRUN echo \"deb http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64 /\" > /etc/apt/sources.list.d/nvidia-ml.list\r\n\r\nRUN apt-get update && apt-get install -y --no-install-recommends \\\r\n         build-essential \\\r\n         cmake \\\r\n         git \\\r\n         curl \\\r\n         vim \\\r\n         emacs \\\r\n         ca-certificates \\\r\n         libnccl2=2.0.5-2+cuda8.0 \\\r\n         libnccl-dev=2.0.5-2+cuda8.0 \\\r\n         libjpeg-dev \\\r\n         libpng-dev &&\\\r\n     rm -rf /var/lib/apt/lists/*\r\n\r\n\r\nENV PYTHON_VERSION=3.6.1\r\nENV INSTALL_PYTORCH_VERSION=0.1.12\r\n#ENV INSTALL_PYTORCH_VERSION=0.2.0\r\nRUN curl -o ~/miniconda.sh -O  https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh  && \\\r\n     chmod +x ~/miniconda.sh && \\\r\n     ~/miniconda.sh -b -p /opt/conda && \\\r\n     rm ~/miniconda.sh && \\\r\n#     /opt/conda/bin/conda install conda-build && \\\r\n     /opt/conda/bin/conda create -y --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION python=$PYTHON_VERSION numpy pyyaml scipy ipython mkl&& \\\r\n     /opt/conda/bin/conda clean -ya\r\nENV PATH /opt/conda/envs/pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION/bin:$PATH\r\nRUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION -c soumith magma-cuda80\r\nRUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION https://anaconda.org/soumith/pytorch/0.1.12/download/linux-64/pytorch-0.1.12-py361_2cu80.tar.bz2\r\n\r\nWORKDIR /workspace\r\nRUN chmod -R a+w /workspace\r\n```\r\n\r\nI found that if use ``` RUN conda install --name pytorch-$INSTALL_PYTORCH_VERSION-py$PYTHON_VERSION -c soumith magma-cuda80 pytorch=$ENV INSTALL_PYTORCH_VERSION```,\r\nconda will make a wrong plan, which will install cuda7.5 version.\r\nSo I have to specify the download address.\r\n\r\nAny hints for this problem? Thanks.\r\n\r\n"}