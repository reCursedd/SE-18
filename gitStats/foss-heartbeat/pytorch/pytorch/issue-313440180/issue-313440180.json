{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6515", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6515/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6515/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6515/events", "html_url": "https://github.com/pytorch/pytorch/issues/6515", "id": 313440180, "node_id": "MDU6SXNzdWUzMTM0NDAxODA=", "number": 6515, "title": "cuda runtime error (48): no kernel image is available for execution on the device", "user": {"login": "SultanovAR", "id": 26094806, "node_id": "MDQ6VXNlcjI2MDk0ODA2", "avatar_url": "https://avatars2.githubusercontent.com/u/26094806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SultanovAR", "html_url": "https://github.com/SultanovAR", "followers_url": "https://api.github.com/users/SultanovAR/followers", "following_url": "https://api.github.com/users/SultanovAR/following{/other_user}", "gists_url": "https://api.github.com/users/SultanovAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/SultanovAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SultanovAR/subscriptions", "organizations_url": "https://api.github.com/users/SultanovAR/orgs", "repos_url": "https://api.github.com/users/SultanovAR/repos", "events_url": "https://api.github.com/users/SultanovAR/events{/privacy}", "received_events_url": "https://api.github.com/users/SultanovAR/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-11T18:36:25Z", "updated_at": "2018-04-11T18:38:03Z", "closed_at": "2018-04-11T18:38:03Z", "author_association": "NONE", "body_html": "<p>Hi, I'm new to pytorch. I took the code from this repository <a href=\"url\">https://github.com/ruotianluo/ImageCaptioning.pytorch</a> and wanted to make captions to the images. Installed \"CUDA\" and when I run the script to create the annotations produces this:</p>\n<pre><code>$ CUDA_LAUNCH_BLOCKING = 1 python eval.py --model model.pth -\n-infos_path infos.pkl --image_folder blah --num_images 1\n/home/azat/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to` np.floating` is deprecated. In the future, it will be treated as `np.float64 == np.dtype (float) .type`.\n  from ._conv import register_converters as _register_converters\n/home/azat/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py:97: UserWarning:\n    Found GPU0 GeForce 820M which is of cuda capability 2.1.\n    PyTorch no longer supports this GPU because it is too old.\n    \n  warnings.warn (old_gpu_warn% (d, name, major, capability [1]))\nDataLoaderRaw loading images from folder: blah\n0\nlisting all images in directory blah\nDataLoaderRaw found 8 images\nTHCudaCheck FAIL file = / pytorch / torch / lib / THC / generic / THCTensorMathPairwise.cu line = 40 error = 48: no kernel image is available for execution on the device\nTraceback (most recent last call last):\n  File \"eval.py\", line 122, in &lt;module&gt;\n    vars (opt))\n  File \"/ home / azat / Programing / Python / techno_atom_neuro / Others Implementation / ImageCaptioning.pytorch-master / eval_utils.py\", line 82, in eval_split\n    data = loader.get_batch (split)\n  File \"/ home / azat / Programing / Python / techno_atom_neuro / Others Implementation / ImageCaptioning.pytorch-master / dataloaderraw.py\", line 112, in get_batch\n    img = Variable (preprocess (img), volatile = True)\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/transforms.py\", line 42, in __call__\n    img = t (img)\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/transforms.py\", line 118, in __call__\n    return F.normalize (tensor, self.mean, self.std)\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/functional.py\", line 161, in normalize\n    t.sub_ (m) .div_ (s)\nRuntimeError: cuda runtime error (48): no kernel image is available for execution on the device at /pytorch/torch/lib/THC/generic/THCTensorMathPairwise.cu:40\n</code></pre>\n<p>So, I want to find out what this error is, hardware or software. And how can I solve this problem. Thanks.</p>\n<p>$ python -c 'import torch; print(torch.cuda.is_available())'<br>\nTrue</p>\n<ul>\n<li>PyTorch</li>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version:<br>\ntorch 0.3.1 pip<br>\ntorchvision 0.2.0 pip</li>\n<li>Python version:<br>\nPython 2.7.14 :: Anaconda custom (64-bit)</li>\n<li>CUDA/cuDNN version:</li>\n</ul>\n<pre><code>$ cat /usr/local/cuda/version.txt\nCUDA Version 9.1.85\n</code></pre>\n<pre><code>$ nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2015 NVIDIA Corporation\nBuilt on Tue_Aug_11_14:27:32_CDT_2015\nCuda compilation tools, release 7.5, V7.5.17\n</code></pre>\n<pre><code>$ nvidia-smi\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 390.48                 Driver Version: 390.48                    |\n|-------------------------------+----------------------+----------------------+\n|   0  GeForce 820M        Off  | 00000000:08:00.0 N/A |                  N/A |\n| N/A   54C    P0    N/A /  N/A |    114MiB /  1985MiB |     N/A      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n</code></pre>", "body_text": "Hi, I'm new to pytorch. I took the code from this repository https://github.com/ruotianluo/ImageCaptioning.pytorch and wanted to make captions to the images. Installed \"CUDA\" and when I run the script to create the annotations produces this:\n$ CUDA_LAUNCH_BLOCKING = 1 python eval.py --model model.pth -\n-infos_path infos.pkl --image_folder blah --num_images 1\n/home/azat/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to` np.floating` is deprecated. In the future, it will be treated as `np.float64 == np.dtype (float) .type`.\n  from ._conv import register_converters as _register_converters\n/home/azat/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py:97: UserWarning:\n    Found GPU0 GeForce 820M which is of cuda capability 2.1.\n    PyTorch no longer supports this GPU because it is too old.\n    \n  warnings.warn (old_gpu_warn% (d, name, major, capability [1]))\nDataLoaderRaw loading images from folder: blah\n0\nlisting all images in directory blah\nDataLoaderRaw found 8 images\nTHCudaCheck FAIL file = / pytorch / torch / lib / THC / generic / THCTensorMathPairwise.cu line = 40 error = 48: no kernel image is available for execution on the device\nTraceback (most recent last call last):\n  File \"eval.py\", line 122, in <module>\n    vars (opt))\n  File \"/ home / azat / Programing / Python / techno_atom_neuro / Others Implementation / ImageCaptioning.pytorch-master / eval_utils.py\", line 82, in eval_split\n    data = loader.get_batch (split)\n  File \"/ home / azat / Programing / Python / techno_atom_neuro / Others Implementation / ImageCaptioning.pytorch-master / dataloaderraw.py\", line 112, in get_batch\n    img = Variable (preprocess (img), volatile = True)\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/transforms.py\", line 42, in __call__\n    img = t (img)\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/transforms.py\", line 118, in __call__\n    return F.normalize (tensor, self.mean, self.std)\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/functional.py\", line 161, in normalize\n    t.sub_ (m) .div_ (s)\nRuntimeError: cuda runtime error (48): no kernel image is available for execution on the device at /pytorch/torch/lib/THC/generic/THCTensorMathPairwise.cu:40\n\nSo, I want to find out what this error is, hardware or software. And how can I solve this problem. Thanks.\n$ python -c 'import torch; print(torch.cuda.is_available())'\nTrue\n\nPyTorch\nOS: Ubuntu 16.04\nPyTorch version:\ntorch 0.3.1 pip\ntorchvision 0.2.0 pip\nPython version:\nPython 2.7.14 :: Anaconda custom (64-bit)\nCUDA/cuDNN version:\n\n$ cat /usr/local/cuda/version.txt\nCUDA Version 9.1.85\n\n$ nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2015 NVIDIA Corporation\nBuilt on Tue_Aug_11_14:27:32_CDT_2015\nCuda compilation tools, release 7.5, V7.5.17\n\n$ nvidia-smi\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 390.48                 Driver Version: 390.48                    |\n|-------------------------------+----------------------+----------------------+\n|   0  GeForce 820M        Off  | 00000000:08:00.0 N/A |                  N/A |\n| N/A   54C    P0    N/A /  N/A |    114MiB /  1985MiB |     N/A      Default |\n+-------------------------------+----------------------+----------------------+", "body": "Hi, I'm new to pytorch. I took the code from this repository [https://github.com/ruotianluo/ImageCaptioning.pytorch](url) and wanted to make captions to the images. Installed \"CUDA\" and when I run the script to create the annotations produces this:\r\n\r\n```\r\n$ CUDA_LAUNCH_BLOCKING = 1 python eval.py --model model.pth -\r\n-infos_path infos.pkl --image_folder blah --num_images 1\r\n/home/azat/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to` np.floating` is deprecated. In the future, it will be treated as `np.float64 == np.dtype (float) .type`.\r\n  from ._conv import register_converters as _register_converters\r\n/home/azat/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py:97: UserWarning:\r\n    Found GPU0 GeForce 820M which is of cuda capability 2.1.\r\n    PyTorch no longer supports this GPU because it is too old.\r\n    \r\n  warnings.warn (old_gpu_warn% (d, name, major, capability [1]))\r\nDataLoaderRaw loading images from folder: blah\r\n0\r\nlisting all images in directory blah\r\nDataLoaderRaw found 8 images\r\nTHCudaCheck FAIL file = / pytorch / torch / lib / THC / generic / THCTensorMathPairwise.cu line = 40 error = 48: no kernel image is available for execution on the device\r\nTraceback (most recent last call last):\r\n  File \"eval.py\", line 122, in <module>\r\n    vars (opt))\r\n  File \"/ home / azat / Programing / Python / techno_atom_neuro / Others Implementation / ImageCaptioning.pytorch-master / eval_utils.py\", line 82, in eval_split\r\n    data = loader.get_batch (split)\r\n  File \"/ home / azat / Programing / Python / techno_atom_neuro / Others Implementation / ImageCaptioning.pytorch-master / dataloaderraw.py\", line 112, in get_batch\r\n    img = Variable (preprocess (img), volatile = True)\r\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/transforms.py\", line 42, in __call__\r\n    img = t (img)\r\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/transforms.py\", line 118, in __call__\r\n    return F.normalize (tensor, self.mean, self.std)\r\n  File \"/home/azat/anaconda2/lib/python2.7/site-packages/torchvision/transforms/functional.py\", line 161, in normalize\r\n    t.sub_ (m) .div_ (s)\r\nRuntimeError: cuda runtime error (48): no kernel image is available for execution on the device at /pytorch/torch/lib/THC/generic/THCTensorMathPairwise.cu:40\r\n```\r\n\r\nSo, I want to find out what this error is, hardware or software. And how can I solve this problem. Thanks.\r\n\r\n$ python -c 'import torch; print(torch.cuda.is_available())'\r\nTrue\r\n\r\n- PyTorch\r\n- OS: Ubuntu 16.04\r\n- PyTorch version:\r\n    torch 0.3.1 pip\r\n    torchvision 0.2.0 pip\r\n- Python version:\r\n    Python 2.7.14 :: Anaconda custom (64-bit)\r\n- CUDA/cuDNN version:\r\n```\r\n$ cat /usr/local/cuda/version.txt\r\nCUDA Version 9.1.85\r\n```\r\n```\r\n$ nvcc --version\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2015 NVIDIA Corporation\r\nBuilt on Tue_Aug_11_14:27:32_CDT_2015\r\nCuda compilation tools, release 7.5, V7.5.17\r\n```\r\n\r\n```\r\n$ nvidia-smi\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 390.48                 Driver Version: 390.48                    |\r\n|-------------------------------+----------------------+----------------------+\r\n|   0  GeForce 820M        Off  | 00000000:08:00.0 N/A |                  N/A |\r\n| N/A   54C    P0    N/A /  N/A |    114MiB /  1985MiB |     N/A      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n```\r\n\r\n"}