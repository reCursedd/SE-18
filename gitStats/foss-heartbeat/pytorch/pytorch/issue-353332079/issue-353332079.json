{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10818", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10818/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10818/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10818/events", "html_url": "https://github.com/pytorch/pytorch/issues/10818", "id": 353332079, "node_id": "MDU6SXNzdWUzNTMzMzIwNzk=", "number": 10818, "title": "[Caffe2] Can't load pretrained model", "user": {"login": "VanDavv", "id": 5244214, "node_id": "MDQ6VXNlcjUyNDQyMTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/5244214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VanDavv", "html_url": "https://github.com/VanDavv", "followers_url": "https://api.github.com/users/VanDavv/followers", "following_url": "https://api.github.com/users/VanDavv/following{/other_user}", "gists_url": "https://api.github.com/users/VanDavv/gists{/gist_id}", "starred_url": "https://api.github.com/users/VanDavv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VanDavv/subscriptions", "organizations_url": "https://api.github.com/users/VanDavv/orgs", "repos_url": "https://api.github.com/users/VanDavv/repos", "events_url": "https://api.github.com/users/VanDavv/events{/privacy}", "received_events_url": "https://api.github.com/users/VanDavv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-23T11:06:29Z", "updated_at": "2018-08-24T20:06:55Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>If you have a question or would like help and support, please ask at our<br>\n<a href=\"https://discuss.pytorch.org/\" rel=\"nofollow\">forums</a>.</p>\n<p>If you are submitting a feature request, please preface the title with [feature request].<br>\nIf you are submitting a bug report, please fill in the following details.</p>\n<h2>Issue description</h2>\n<p>I ran code from (this caffe2 tutorial - \"Loading Pre-Trained Models\")[https://caffe2.ai/docs/tutorial-loading-pre-trained-models.html] and code is failing with error</p>\n<pre><code>---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-14-314dd918183e&gt; in &lt;module&gt;()\n      7 \n      8 # Initialize the predictor from the input protobufs\n----&gt; 9 p = workspace.Predictor(init_net, predict_net)\n     10 \n     11 # Run the net and return prediction\n\n/opt/caffe2/caffe2/python/workspace.py in Predictor(init_net, predict_net)\n    169 \n    170 def Predictor(init_net, predict_net):\n--&gt; 171     return C.Predictor(StringifyProto(init_net), StringifyProto(predict_net))\n    172 \n    173 \n\nRuntimeError: [enforce fail at operator.cc:58] blob != nullptr. op Conv: Encountered a non-existing input blob: data \n</code></pre>\n<p>As i searched the web, I saw that some people add this line before net initialization to prevent this issue from occuring</p>\n<pre><code>workspace.FeedBlob(\"data\", img)\n</code></pre>\n<p>But unfortunatelly, another error pops out</p>\n<pre lang=\"---------------------------------------------------------------------------\"><code>RuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-14-314dd918183e&gt; in &lt;module&gt;()\n      7 \n      8 # Initialize the predictor from the input protobufs\n----&gt; 9 p = workspace.Predictor(init_net, predict_net)\n     10 \n     11 # Run the net and return prediction\n\n/opt/caffe2/caffe2/python/workspace.py in Predictor(init_net, predict_net)\n    169 \n    170 def Predictor(init_net, predict_net):\n--&gt; 171     return C.Predictor(StringifyProto(init_net), StringifyProto(predict_net))\n    172 \n    173 \n\nRuntimeError: [enforce fail at operator.cc:58] blob != nullptr. op Conv: Encountered a non-existing input blob: conv1_w\n</code></pre>\n<p>It's most likely that Caffe2 initialization of <code>squeezenet</code> is corrupt. Any info how to fix this issue would be great.</p>\n<p>I tried downloading <code>.pb</code> files both from amazon and github.</p>\n<h2>Code example</h2>\n<p>Please try to provide a minimal example to repro the bug.<br>\nError messages and stack traces are also helpful.</p>\n<pre lang=\"workspace.FeedBlob(&quot;data&quot;,\" data-meta=\"img)\"><code>with open(INIT_NET, \"rb\") as f:\n    init_net = f.read()\nwith open(PREDICT_NET, \"rb\") as f:\n    predict_net = f.read()\n    \n# Initialize the predictor from the input protobufs\np = workspace.Predictor(init_net, predict_net)\n</code></pre>\n<h2>System Info</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"%60\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<ul>\n<li>PyTorch or Caffe2: 0.8.1</li>\n<li>How you installed PyTorch (conda, pip, source): Docker image of caffe2 from NVCR.io</li>\n<li>OS: Linux 0cf485e1c286 4.15.0-29-generic <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"177075310\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/31\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/31/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/31\">#31</a>-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</li>\n<li>Python version: Python 3.5.2</li>\n<li>CUDA/cuDNN version: V9.0.176</li>\n<li>GPU models and configuration: GeForce GTX 1070</li>\n</ul>", "body_text": "If you have a question or would like help and support, please ask at our\nforums.\nIf you are submitting a feature request, please preface the title with [feature request].\nIf you are submitting a bug report, please fill in the following details.\nIssue description\nI ran code from (this caffe2 tutorial - \"Loading Pre-Trained Models\")[https://caffe2.ai/docs/tutorial-loading-pre-trained-models.html] and code is failing with error\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-14-314dd918183e> in <module>()\n      7 \n      8 # Initialize the predictor from the input protobufs\n----> 9 p = workspace.Predictor(init_net, predict_net)\n     10 \n     11 # Run the net and return prediction\n\n/opt/caffe2/caffe2/python/workspace.py in Predictor(init_net, predict_net)\n    169 \n    170 def Predictor(init_net, predict_net):\n--> 171     return C.Predictor(StringifyProto(init_net), StringifyProto(predict_net))\n    172 \n    173 \n\nRuntimeError: [enforce fail at operator.cc:58] blob != nullptr. op Conv: Encountered a non-existing input blob: data \n\nAs i searched the web, I saw that some people add this line before net initialization to prevent this issue from occuring\nworkspace.FeedBlob(\"data\", img)\n\nBut unfortunatelly, another error pops out\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-14-314dd918183e> in <module>()\n      7 \n      8 # Initialize the predictor from the input protobufs\n----> 9 p = workspace.Predictor(init_net, predict_net)\n     10 \n     11 # Run the net and return prediction\n\n/opt/caffe2/caffe2/python/workspace.py in Predictor(init_net, predict_net)\n    169 \n    170 def Predictor(init_net, predict_net):\n--> 171     return C.Predictor(StringifyProto(init_net), StringifyProto(predict_net))\n    172 \n    173 \n\nRuntimeError: [enforce fail at operator.cc:58] blob != nullptr. op Conv: Encountered a non-existing input blob: conv1_w\n\nIt's most likely that Caffe2 initialization of squeezenet is corrupt. Any info how to fix this issue would be great.\nI tried downloading .pb files both from amazon and github.\nCode example\nPlease try to provide a minimal example to repro the bug.\nError messages and stack traces are also helpful.\nwith open(INIT_NET, \"rb\") as f:\n    init_net = f.read()\nwith open(PREDICT_NET, \"rb\") as f:\n    predict_net = f.read()\n    \n# Initialize the predictor from the input protobufs\np = workspace.Predictor(init_net, predict_net)\n\nSystem Info\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\n\nPyTorch or Caffe2: 0.8.1\nHow you installed PyTorch (conda, pip, source): Docker image of caffe2 from NVCR.io\nOS: Linux 0cf485e1c286 4.15.0-29-generic #31-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\nPython version: Python 3.5.2\nCUDA/cuDNN version: V9.0.176\nGPU models and configuration: GeForce GTX 1070", "body": "If you have a question or would like help and support, please ask at our\r\n[forums](https://discuss.pytorch.org/).\r\n\r\nIf you are submitting a feature request, please preface the title with [feature request].\r\nIf you are submitting a bug report, please fill in the following details.\r\n\r\n## Issue description\r\n\r\nI ran code from (this caffe2 tutorial - \"Loading Pre-Trained Models\")[https://caffe2.ai/docs/tutorial-loading-pre-trained-models.html] and code is failing with error\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-14-314dd918183e> in <module>()\r\n      7 \r\n      8 # Initialize the predictor from the input protobufs\r\n----> 9 p = workspace.Predictor(init_net, predict_net)\r\n     10 \r\n     11 # Run the net and return prediction\r\n\r\n/opt/caffe2/caffe2/python/workspace.py in Predictor(init_net, predict_net)\r\n    169 \r\n    170 def Predictor(init_net, predict_net):\r\n--> 171     return C.Predictor(StringifyProto(init_net), StringifyProto(predict_net))\r\n    172 \r\n    173 \r\n\r\nRuntimeError: [enforce fail at operator.cc:58] blob != nullptr. op Conv: Encountered a non-existing input blob: data \r\n```\r\nAs i searched the web, I saw that some people add this line before net initialization to prevent this issue from occuring\r\n```\r\nworkspace.FeedBlob(\"data\", img)\r\n```\r\n\r\nBut unfortunatelly, another error pops out\r\n```---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-14-314dd918183e> in <module>()\r\n      7 \r\n      8 # Initialize the predictor from the input protobufs\r\n----> 9 p = workspace.Predictor(init_net, predict_net)\r\n     10 \r\n     11 # Run the net and return prediction\r\n\r\n/opt/caffe2/caffe2/python/workspace.py in Predictor(init_net, predict_net)\r\n    169 \r\n    170 def Predictor(init_net, predict_net):\r\n--> 171     return C.Predictor(StringifyProto(init_net), StringifyProto(predict_net))\r\n    172 \r\n    173 \r\n\r\nRuntimeError: [enforce fail at operator.cc:58] blob != nullptr. op Conv: Encountered a non-existing input blob: conv1_w\r\n```\r\n\r\nIt's most likely that Caffe2 initialization of `squeezenet` is corrupt. Any info how to fix this issue would be great.\r\n\r\nI tried downloading `.pb` files both from amazon and github.\r\n\r\n## Code example\r\n\r\nPlease try to provide a minimal example to repro the bug.\r\nError messages and stack traces are also helpful.\r\n\r\n```workspace.FeedBlob(\"data\", img)\r\nwith open(INIT_NET, \"rb\") as f:\r\n    init_net = f.read()\r\nwith open(PREDICT_NET, \"rb\") as f:\r\n    predict_net = f.read()\r\n    \r\n# Initialize the predictor from the input protobufs\r\np = workspace.Predictor(init_net, predict_net)\r\n```\r\n\r\n## System Info\r\nPlease copy and paste the output from our\r\n[environment collection script](`)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n- PyTorch or Caffe2: 0.8.1\r\n- How you installed PyTorch (conda, pip, source): Docker image of caffe2 from NVCR.io\r\n- OS: Linux 0cf485e1c286 4.15.0-29-generic #31-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n- Python version: Python 3.5.2\r\n- CUDA/cuDNN version: V9.0.176\r\n- GPU models and configuration: GeForce GTX 1070"}