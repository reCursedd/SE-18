{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/383848796", "html_url": "https://github.com/pytorch/pytorch/issues/6857#issuecomment-383848796", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/6857", "id": 383848796, "node_id": "MDEyOklzc3VlQ29tbWVudDM4Mzg0ODc5Ng==", "user": {"login": "lironmo", "id": 37513762, "node_id": "MDQ6VXNlcjM3NTEzNzYy", "avatar_url": "https://avatars0.githubusercontent.com/u/37513762?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lironmo", "html_url": "https://github.com/lironmo", "followers_url": "https://api.github.com/users/lironmo/followers", "following_url": "https://api.github.com/users/lironmo/following{/other_user}", "gists_url": "https://api.github.com/users/lironmo/gists{/gist_id}", "starred_url": "https://api.github.com/users/lironmo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lironmo/subscriptions", "organizations_url": "https://api.github.com/users/lironmo/orgs", "repos_url": "https://api.github.com/users/lironmo/repos", "events_url": "https://api.github.com/users/lironmo/events{/privacy}", "received_events_url": "https://api.github.com/users/lironmo/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-24T08:29:50Z", "updated_at": "2018-04-24T08:29:50Z", "author_association": "NONE", "body_html": "<p>Hi i changed the order of the creation and mutation of the \"label\" \"data\" blobs and now i get the following errors:<br>\nterminate called after throwing an instance of 'caffe2::EnforceNotMet'<br>\nwhat():  [enforce fail at net.cc:61] . op Adam: Source for input label_grad is unknown for net train_predict, operator input: \"label\" input: \"label_moment_1\" input: \"label_moment_2\" input: \"label_grad\" input: \"lr\" input: \"iter\" output: \"label\" output: \"label_moment_1\" output: \"label_moment_2\" type: \"Adam\"<br>\n*** Aborted at 1524558114 (unix time) try \"date -d @1524558114\" if you are using GNU date ***</p>\n<p>i added the following:<br>\ntrain_model.predict.net.add_external_input(\"label_grad\");</p>\n<p>and get the following error:<br>\nterminate called after throwing an instance of 'caffe2::EnforceNotMet'<br>\nwhat():  [enforce fail at operator.cc:42] blob != nullptr. op Adam: Encountered a non-existing input blob: label_grad</p>\n<p>why i need to feed this blob as well?</p>\n<p>same code with minor change (using DB input ) work fine:<br>\ntrain_model.AddDatabaseOps(\"train\", model_in, db_paths[0],<br>\ndb_type, batch_size);</p>\n<p>so i am not aware to all the blobs that need to be inserted , my code based on /leonardvandriel/caffe2_cpp_tutorial , and i simply tried to remove the DB input and set the labels and data for each interrelation in order to stream the imaged like in <a href=\"https://caffe2.ai/docs/intro-tutorial.html\" rel=\"nofollow\">https://caffe2.ai/docs/intro-tutorial.html</a> at cpp.</p>\n<p>in regards to the NNPACK (6) , my workaround is to set it only to the convolution op:<br>\nvoid NetUtil::SetConvEngine(const std::string engine) {<br>\nfor (auto &amp;op : *net.mutable_op()) {<br>\nif (\"Conv\" == op.type()) {<br>\nop.set_engine(engine);<br>\n}<br>\n}<br>\n}</p>\n<p>1 +2 - is still open and i will happy for help(simply remove the DB input to stream the images one by one or up to the mini batch - and do backward pass after finish with all the mini batch)</p>", "body_text": "Hi i changed the order of the creation and mutation of the \"label\" \"data\" blobs and now i get the following errors:\nterminate called after throwing an instance of 'caffe2::EnforceNotMet'\nwhat():  [enforce fail at net.cc:61] . op Adam: Source for input label_grad is unknown for net train_predict, operator input: \"label\" input: \"label_moment_1\" input: \"label_moment_2\" input: \"label_grad\" input: \"lr\" input: \"iter\" output: \"label\" output: \"label_moment_1\" output: \"label_moment_2\" type: \"Adam\"\n*** Aborted at 1524558114 (unix time) try \"date -d @1524558114\" if you are using GNU date ***\ni added the following:\ntrain_model.predict.net.add_external_input(\"label_grad\");\nand get the following error:\nterminate called after throwing an instance of 'caffe2::EnforceNotMet'\nwhat():  [enforce fail at operator.cc:42] blob != nullptr. op Adam: Encountered a non-existing input blob: label_grad\nwhy i need to feed this blob as well?\nsame code with minor change (using DB input ) work fine:\ntrain_model.AddDatabaseOps(\"train\", model_in, db_paths[0],\ndb_type, batch_size);\nso i am not aware to all the blobs that need to be inserted , my code based on /leonardvandriel/caffe2_cpp_tutorial , and i simply tried to remove the DB input and set the labels and data for each interrelation in order to stream the imaged like in https://caffe2.ai/docs/intro-tutorial.html at cpp.\nin regards to the NNPACK (6) , my workaround is to set it only to the convolution op:\nvoid NetUtil::SetConvEngine(const std::string engine) {\nfor (auto &op : *net.mutable_op()) {\nif (\"Conv\" == op.type()) {\nop.set_engine(engine);\n}\n}\n}\n1 +2 - is still open and i will happy for help(simply remove the DB input to stream the images one by one or up to the mini batch - and do backward pass after finish with all the mini batch)", "body": "Hi i changed the order of the creation and mutation of the \"label\" \"data\" blobs and now i get the following errors:\r\nterminate called after throwing an instance of 'caffe2::EnforceNotMet'\r\n  what():  [enforce fail at net.cc:61] . op Adam: Source for input label_grad is unknown for net train_predict, operator input: \"label\" input: \"label_moment_1\" input: \"label_moment_2\" input: \"label_grad\" input: \"lr\" input: \"iter\" output: \"label\" output: \"label_moment_1\" output: \"label_moment_2\" type: \"Adam\" \r\n*** Aborted at 1524558114 (unix time) try \"date -d @1524558114\" if you are using GNU date ***\r\n\r\ni added the following:\r\n      train_model.predict.net.add_external_input(\"label_grad\");\r\n\r\nand get the following error:\r\nterminate called after throwing an instance of 'caffe2::EnforceNotMet'\r\n  what():  [enforce fail at operator.cc:42] blob != nullptr. op Adam: Encountered a non-existing input blob: label_grad \r\n\r\nwhy i need to feed this blob as well?\r\n\r\nsame code with minor change (using DB input ) work fine:\r\n      train_model.AddDatabaseOps(\"train\", model_in, db_paths[0],\r\n                                 db_type, batch_size);\r\n\r\nso i am not aware to all the blobs that need to be inserted , my code based on /leonardvandriel/caffe2_cpp_tutorial , and i simply tried to remove the DB input and set the labels and data for each interrelation in order to stream the imaged like in https://caffe2.ai/docs/intro-tutorial.html at cpp.\r\n\r\nin regards to the NNPACK (6) , my workaround is to set it only to the convolution op:\r\n  void NetUtil::SetConvEngine(const std::string engine) {\r\n    for (auto &op : *net.mutable_op()) {\r\n      if (\"Conv\" == op.type()) {\r\n        op.set_engine(engine);\r\n      }\r\n    }\r\n  }\r\n\r\n1 +2 - is still open and i will happy for help(simply remove the DB input to stream the images one by one or up to the mini batch - and do backward pass after finish with all the mini batch)"}