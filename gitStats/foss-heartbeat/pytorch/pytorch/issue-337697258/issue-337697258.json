{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9122", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9122/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9122/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9122/events", "html_url": "https://github.com/pytorch/pytorch/issues/9122", "id": 337697258, "node_id": "MDU6SXNzdWUzMzc2OTcyNTg=", "number": 9122, "title": "[Caffe2 Bug] Error about test_is_hashable with Visual Studio 2017", "user": {"login": "xkszltl", "id": 5203025, "node_id": "MDQ6VXNlcjUyMDMwMjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5203025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xkszltl", "html_url": "https://github.com/xkszltl", "followers_url": "https://api.github.com/users/xkszltl/followers", "following_url": "https://api.github.com/users/xkszltl/following{/other_user}", "gists_url": "https://api.github.com/users/xkszltl/gists{/gist_id}", "starred_url": "https://api.github.com/users/xkszltl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xkszltl/subscriptions", "organizations_url": "https://api.github.com/users/xkszltl/orgs", "repos_url": "https://api.github.com/users/xkszltl/repos", "events_url": "https://api.github.com/users/xkszltl/events{/privacy}", "received_events_url": "https://api.github.com/users/xkszltl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-02T23:36:32Z", "updated_at": "2018-08-19T09:37:56Z", "closed_at": "2018-08-19T09:37:56Z", "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue description</h2>\n<p>Windows related bug.<br>\nLooks like it fails the compilation when doing hash(NotHashable) rather than fall back to false_type</p>\n<pre><code>    30&gt;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\xstddef(377): error C2338: The C++ Standard doesn't provide a hash for this type. (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp) [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\n         ~\\AppData\\Local\\Temp\\pytorch\\caffe2/utils/TypeTraits.h(23): note: see reference to class template instantiation 'std::hash&lt;T&gt;' being compiled\n                 with\n                 [\n                     T=`anonymous-namespace'::test_is_hashable::NotHashable\n                 ] (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp)\n</code></pre>\n<pre><code>       \"~\\AppData\\Local\\Temp\\pytorch\\build\\ALL_BUILD.vcxproj\" (default target) (1) -&gt;\n       \"~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj\" (default target) (25) -&gt;\n       (ClCompile target) -&gt;\n         C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\xstddef(377): error C2338: The C++ Standard doesn't provide a hash for this type. (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp) [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\n         ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp(36): error C2338:  [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\n</code></pre>\n<p>Code related:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/a34211bd790dd900311b3993104cc563bb11ef8e/caffe2/utils/TypeTraits.h#L23\">pytorch/caffe2/utils/TypeTraits.h</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 23\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/a34211bd790dd900311b3993104cc563bb11ef8e\">a34211b</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L23\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"23\"></td>\n          <td id=\"LC23\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">template</span>&lt;<span class=\"pl-k\">class</span> <span class=\"pl-en\">T</span>&gt; <span class=\"pl-k\">struct</span> <span class=\"pl-en\">is_hashable</span>&lt;T, <span class=\"pl-c1\">void_t</span>&lt;decltype(std::hash&lt;T&gt;()(std::declval&lt;T&amp;&gt;()))&gt;&gt; : std::true_type {}; </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/50392cc55444672a4b63b335455040a6ba53ae32/caffe2/utils/TypeTraits_test.cpp#L27-L31\">pytorch/caffe2/utils/TypeTraits_test.cpp</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n        Lines 27 to 31\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/50392cc55444672a4b63b335455040a6ba53ae32\">50392cc</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L27\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"27\"></td>\n          <td id=\"LC27\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">namespace</span> <span class=\"pl-en\">std</span> { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L28\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"28\"></td>\n          <td id=\"LC28\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">     <span class=\"pl-k\">template</span>&lt;&gt; <span class=\"pl-k\">struct</span> <span class=\"pl-en\">hash</span>&lt;test_is_hashable::Hashable&gt; final { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L29\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"29\"></td>\n          <td id=\"LC29\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">         <span class=\"pl-c1\">size_t</span> <span class=\"pl-en\">operator</span>()(<span class=\"pl-k\">const</span> test_is_hashable::Hashable &amp;) { <span class=\"pl-k\">return</span> <span class=\"pl-c1\">0</span>; } </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L30\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"30\"></td>\n          <td id=\"LC30\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">     }; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L31\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"31\"></td>\n          <td id=\"LC31\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: Caffe2</li>\n<li>How you installed Caffe2(conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): cmake</li>\n<li>OS: Win10</li>\n<li>VS version (if compiling from source): 2017.6</li>\n<li>CMake version: 3.11.4</li>\n</ul>", "body_text": "Issue description\nWindows related bug.\nLooks like it fails the compilation when doing hash(NotHashable) rather than fall back to false_type\n    30>C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\xstddef(377): error C2338: The C++ Standard doesn't provide a hash for this type. (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp) [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\n         ~\\AppData\\Local\\Temp\\pytorch\\caffe2/utils/TypeTraits.h(23): note: see reference to class template instantiation 'std::hash<T>' being compiled\n                 with\n                 [\n                     T=`anonymous-namespace'::test_is_hashable::NotHashable\n                 ] (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp)\n\n       \"~\\AppData\\Local\\Temp\\pytorch\\build\\ALL_BUILD.vcxproj\" (default target) (1) ->\n       \"~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj\" (default target) (25) ->\n       (ClCompile target) ->\n         C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\xstddef(377): error C2338: The C++ Standard doesn't provide a hash for this type. (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp) [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\n         ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp(36): error C2338:  [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\n\nCode related:\n\n  \n    \n      pytorch/caffe2/utils/TypeTraits.h\n    \n    \n         Line 23\n      in\n      a34211b\n    \n    \n    \n    \n\n        \n          \n           template<class T> struct is_hashable<T, void_t<decltype(std::hash<T>()(std::declval<T&>()))>> : std::true_type {}; \n        \n    \n  \n\n\n\n  \n    \n      pytorch/caffe2/utils/TypeTraits_test.cpp\n    \n    \n        Lines 27 to 31\n      in\n      50392cc\n    \n    \n    \n    \n\n        \n          \n           namespace std { \n        \n\n        \n          \n               template<> struct hash<test_is_hashable::Hashable> final { \n        \n\n        \n          \n                   size_t operator()(const test_is_hashable::Hashable &) { return 0; } \n        \n\n        \n          \n               }; \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nSystem Info\n\nPyTorch or Caffe2: Caffe2\nHow you installed Caffe2(conda, pip, source): source\nBuild command you used (if compiling from source): cmake\nOS: Win10\nVS version (if compiling from source): 2017.6\nCMake version: 3.11.4", "body": "## Issue description\r\n\r\nWindows related bug.\r\nLooks like it fails the compilation when doing hash(NotHashable) rather than fall back to false_type\r\n\r\n```\r\n    30>C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\xstddef(377): error C2338: The C++ Standard doesn't provide a hash for this type. (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp) [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\r\n         ~\\AppData\\Local\\Temp\\pytorch\\caffe2/utils/TypeTraits.h(23): note: see reference to class template instantiation 'std::hash<T>' being compiled\r\n                 with\r\n                 [\r\n                     T=`anonymous-namespace'::test_is_hashable::NotHashable\r\n                 ] (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp)\r\n```\r\n\r\n```\r\n       \"~\\AppData\\Local\\Temp\\pytorch\\build\\ALL_BUILD.vcxproj\" (default target) (1) ->\r\n       \"~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj\" (default target) (25) ->\r\n       (ClCompile target) ->\r\n         C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include\\xstddef(377): error C2338: The C++ Standard doesn't provide a hash for this type. (compiling source file ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp) [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\r\n         ~\\AppData\\Local\\Temp\\pytorch\\caffe2\\utils\\TypeTraits_test.cpp(36): error C2338:  [~\\AppData\\Local\\Temp\\pytorch\\build\\caffe2\\utils\\c10_utils_cpu_test.vcxproj]\r\n```\r\n\r\nCode related:\r\nhttps://github.com/pytorch/pytorch/blob/a34211bd790dd900311b3993104cc563bb11ef8e/caffe2/utils/TypeTraits.h#L23\r\nhttps://github.com/pytorch/pytorch/blob/50392cc55444672a4b63b335455040a6ba53ae32/caffe2/utils/TypeTraits_test.cpp#L27-L31\r\n\r\n## System Info\r\n\r\n- PyTorch or Caffe2: Caffe2\r\n- How you installed Caffe2(conda, pip, source): source\r\n- Build command you used (if compiling from source): cmake\r\n- OS: Win10\r\n- VS version (if compiling from source): 2017.6\r\n- CMake version: 3.11.4\r\n"}