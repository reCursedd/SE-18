{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/165485620", "pull_request_review_id": 93435045, "id": 165485620, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2NTQ4NTYyMA==", "diff_hunk": "@@ -37,9 +37,24 @@ struct SymbolicVariable {\n       }\n       return out;\n   }\n+  static bool isScalarValue(at::Scalar s, double v) {\n+    if(s.isFloatingPoint()) {\n+      return v == s.toDouble();\n+    } else {\n+      return v == (double) s.toLong();\n+    }\n+  }\n   SymbolicVariable operator*(SymbolicVariable rhs) const {\n     return create(kmul, {*this, rhs})[0].typeLike(*this);\n   }\n+  SymbolicVariable operator*(at::Scalar rhs) const {\n+    if(isScalarValue(rhs, 1))\n+      return *this;", "path": "torch/csrc/jit/symbolic_variable.h", "position": null, "original_position": 16, "commit_id": "50f1371ab9d4af3f9ffba960951d8178b326d11c", "original_commit_id": "b84e313451e285323db29add20e1602d1e51aab8", "user": {"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, "body": "It is less work to put it here, and pretty common  (look at LLVM's builder) to do these cleanups as we see them. Otherwise you wait an unknown amount of time before then cleanup happens, and some other pass may have obscured an optimization that was seen before.", "created_at": "2018-02-01T20:58:42Z", "updated_at": "2018-11-23T15:38:57Z", "html_url": "https://github.com/pytorch/pytorch/pull/4982#discussion_r165485620", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/4982", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/165485620"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/4982#discussion_r165485620"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/4982"}}, "body_html": "<p>It is less work to put it here, and pretty common  (look at LLVM's builder) to do these cleanups as we see them. Otherwise you wait an unknown amount of time before then cleanup happens, and some other pass may have obscured an optimization that was seen before.</p>", "body_text": "It is less work to put it here, and pretty common  (look at LLVM's builder) to do these cleanups as we see them. Otherwise you wait an unknown amount of time before then cleanup happens, and some other pass may have obscured an optimization that was seen before.", "in_reply_to_id": 165429665}