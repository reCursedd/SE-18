{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8707", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8707/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8707/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8707/events", "html_url": "https://github.com/pytorch/pytorch/issues/8707", "id": 334229797, "node_id": "MDU6SXNzdWUzMzQyMjk3OTc=", "number": 8707, "title": "pyHIPIFY hangs if you run it as root", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-06-20T20:05:40Z", "updated_at": "2018-06-20T20:05:40Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>Steps to reproduce:</p>\n<ol>\n<li><code>docker run -it 308535385114.dkr.ecr.us-east-1.amazonaws.com/caffe2/py2-clang3.8-rocmnightly-ubuntu16.04:126</code> (note that you are running as root)</li>\n<li>git clone PyTorch</li>\n<li><code>jenkins/pytorch/build.sh</code></li>\n</ol>\n<p>It hangs at:</p>\n<pre><code>/root/pytorch-1/aten/src/ATen/cpu/tbb/tbb_remote/src/old/concurrent_queue_v\u2502\n2.h                                                                                                   \u2502[#######-------------] 34%\nTraceback (most recent call last):                                                                  \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 946, in &lt;module&gt;                                        \u2502    main()                                                                                            \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 938, in main                                            \u2502    include_dirs=args.include_dirs)                                                                   \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 127, in walk_over_directory                             \u2502\n    preprocessor(filepath, stats)                                                                     \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 473, in preprocessor                                    \u2502\n    output_source = processKernelLaunches(output_source, stats)                                       \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 239, in processKernelLaunches                           \u2502    get_kernel_positions = [k for k in find_kernel_bounds(string)]                                    \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 230, in find_kernel_bounds                              \u2502\n    kernel_end = string.find(\"&gt;&gt;&gt;\", kernel_start) + 3\n</code></pre>\n<p>It works if I am jenkins user (e.g., pass <code>-u jenkins</code> to docker invocation)</p>", "body_text": "Steps to reproduce:\n\ndocker run -it 308535385114.dkr.ecr.us-east-1.amazonaws.com/caffe2/py2-clang3.8-rocmnightly-ubuntu16.04:126 (note that you are running as root)\ngit clone PyTorch\njenkins/pytorch/build.sh\n\nIt hangs at:\n/root/pytorch-1/aten/src/ATen/cpu/tbb/tbb_remote/src/old/concurrent_queue_v\u2502\n2.h                                                                                                   \u2502[#######-------------] 34%\nTraceback (most recent call last):                                                                  \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 946, in <module>                                        \u2502    main()                                                                                            \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 938, in main                                            \u2502    include_dirs=args.include_dirs)                                                                   \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 127, in walk_over_directory                             \u2502\n    preprocessor(filepath, stats)                                                                     \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 473, in preprocessor                                    \u2502\n    output_source = processKernelLaunches(output_source, stats)                                       \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 239, in processKernelLaunches                           \u2502    get_kernel_positions = [k for k in find_kernel_bounds(string)]                                    \u2502\n  File \"/opt/rocm/bin/hipify-python.py\", line 230, in find_kernel_bounds                              \u2502\n    kernel_end = string.find(\">>>\", kernel_start) + 3\n\nIt works if I am jenkins user (e.g., pass -u jenkins to docker invocation)", "body": "Steps to reproduce:\r\n\r\n1. `docker run -it 308535385114.dkr.ecr.us-east-1.amazonaws.com/caffe2/py2-clang3.8-rocmnightly-ubuntu16.04:126` (note that you are running as root)\r\n2. git clone PyTorch\r\n3. `jenkins/pytorch/build.sh`\r\n\r\nIt hangs at:\r\n\r\n```\r\n/root/pytorch-1/aten/src/ATen/cpu/tbb/tbb_remote/src/old/concurrent_queue_v\u2502\r\n2.h                                                                                                   \u2502[#######-------------] 34%\r\nTraceback (most recent call last):                                                                  \u2502\r\n  File \"/opt/rocm/bin/hipify-python.py\", line 946, in <module>                                        \u2502    main()                                                                                            \u2502\r\n  File \"/opt/rocm/bin/hipify-python.py\", line 938, in main                                            \u2502    include_dirs=args.include_dirs)                                                                   \u2502\r\n  File \"/opt/rocm/bin/hipify-python.py\", line 127, in walk_over_directory                             \u2502\r\n    preprocessor(filepath, stats)                                                                     \u2502\r\n  File \"/opt/rocm/bin/hipify-python.py\", line 473, in preprocessor                                    \u2502\r\n    output_source = processKernelLaunches(output_source, stats)                                       \u2502\r\n  File \"/opt/rocm/bin/hipify-python.py\", line 239, in processKernelLaunches                           \u2502    get_kernel_positions = [k for k in find_kernel_bounds(string)]                                    \u2502\r\n  File \"/opt/rocm/bin/hipify-python.py\", line 230, in find_kernel_bounds                              \u2502\r\n    kernel_end = string.find(\">>>\", kernel_start) + 3\r\n```\r\n\r\nIt works if I am jenkins user (e.g., pass `-u jenkins` to docker invocation)"}