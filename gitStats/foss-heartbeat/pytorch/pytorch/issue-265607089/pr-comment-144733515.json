{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/144733515", "pull_request_review_id": 69431159, "id": 144733515, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0NDczMzUxNQ==", "diff_hunk": "@@ -164,57 +166,60 @@ def forward(self, weight, indices, offsets):\n                              \" ({}), but got offsets[-1] of {}\"\n                              .format(indices.size(0), offsets[-1]))\n \n-        self._backend = type2backend[type(weight)]\n-        self._weight_size = weight.size()\n-        self._offset2bag = offsets.new()\n+        ctx._backend = type2backend[type(weight)]\n+        ctx._weight_size = weight.size()\n+        ctx._offset2bag = offsets.new()\n \n-        self.save_for_backward(indices)\n+        ctx.save_for_backward(indices)\n \n         indices = indices.contiguous().view(-1)\n         output = weight.new()\n-        if self.max_norm is not None:\n-            self._renorm(indices, weight)\n+\n+        if ctx.max_norm is not None:\n+            cls._renorm(ctx, indices, weight, max_norm=max_norm, norm_type=norm_type)", "path": "torch/nn/_functions/thnn/sparse.py", "position": 79, "original_position": 79, "commit_id": "66cc25a8a3d856ba795bfd9ca38b2b55e8bad501", "original_commit_id": "e358991109581012a88a47e39b154c50729d1256", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "Hmm it's kind of ugly to put `_renorm` in an autograd function, since it's not differentiated \ud83d\ude15 It's not a blocker for this PR in any way, I'll try to think about a nicer solution", "created_at": "2017-10-15T22:04:43Z", "updated_at": "2018-11-23T15:35:18Z", "html_url": "https://github.com/pytorch/pytorch/pull/3128#discussion_r144733515", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/3128", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/144733515"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/3128#discussion_r144733515"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/3128"}}, "body_html": "<p>Hmm it's kind of ugly to put <code>_renorm</code> in an autograd function, since it's not differentiated <g-emoji class=\"g-emoji\" alias=\"confused\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f615.png\">\ud83d\ude15</g-emoji> It's not a blocker for this PR in any way, I'll try to think about a nicer solution</p>", "body_text": "Hmm it's kind of ugly to put _renorm in an autograd function, since it's not differentiated \ud83d\ude15 It's not a blocker for this PR in any way, I'll try to think about a nicer solution"}