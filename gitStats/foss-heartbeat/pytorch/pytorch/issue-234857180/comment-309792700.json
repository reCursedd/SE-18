{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/309792700", "html_url": "https://github.com/pytorch/pytorch/pull/1762#issuecomment-309792700", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/1762", "id": 309792700, "node_id": "MDEyOklzc3VlQ29tbWVudDMwOTc5MjcwMA==", "user": {"login": "Kaixhin", "id": 991891, "node_id": "MDQ6VXNlcjk5MTg5MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/991891?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kaixhin", "html_url": "https://github.com/Kaixhin", "followers_url": "https://api.github.com/users/Kaixhin/followers", "following_url": "https://api.github.com/users/Kaixhin/following{/other_user}", "gists_url": "https://api.github.com/users/Kaixhin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kaixhin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kaixhin/subscriptions", "organizations_url": "https://api.github.com/users/Kaixhin/orgs", "repos_url": "https://api.github.com/users/Kaixhin/repos", "events_url": "https://api.github.com/users/Kaixhin/events{/privacy}", "received_events_url": "https://api.github.com/users/Kaixhin/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-20T15:18:49Z", "updated_at": "2017-06-20T15:26:18Z", "author_association": "CONTRIBUTOR", "body_html": "<p>What was the rationale behind this? I can't set random seeds in my CPU multiprocessing code because it's trying to set CUDA seeds. This might be more convenient than controlling CUDA seeds manually, but this seems like a bug to me.</p>\n<div class=\"highlight highlight-source-shell\"><pre>  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/ka709/ferry/test.py<span class=\"pl-pds\">\"</span></span>, line 13, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">test</span>\n    torch.manual_seed(args.seed + rank)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/ka709/miniconda3/lib/python3.6/site-packages/torch/__init__.py<span class=\"pl-pds\">\"</span></span>, line 133, <span class=\"pl-k\">in</span> manual_seed\n    torch.cuda.manual_seed_all(seed)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/ka709/miniconda3/lib/python3.6/site-packages/torch/cuda/random.py<span class=\"pl-pds\">\"</span></span>, line 37, <span class=\"pl-k\">in</span> manual_seed_all\n    <span class=\"pl-en\">_lazy_init</span>()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/ka709/miniconda3/lib/python3.6/site-packages/torch/cuda/__init__.py<span class=\"pl-pds\">\"</span></span>, line 83, <span class=\"pl-k\">in</span> _lazy_init\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Cannot re-initialize CUDA in forked subprocess. <span class=\"pl-pds\">\"</span></span> + msg)\nRuntimeError: Cannot re-initialize CUDA <span class=\"pl-k\">in</span> forked subprocess. To use CUDA with multiprocessing, you must use the <span class=\"pl-s\"><span class=\"pl-pds\">'</span>spawn<span class=\"pl-pds\">'</span></span> start method</pre></div>", "body_text": "What was the rationale behind this? I can't set random seeds in my CPU multiprocessing code because it's trying to set CUDA seeds. This might be more convenient than controlling CUDA seeds manually, but this seems like a bug to me.\n  File \"/home/ka709/ferry/test.py\", line 13, in test\n    torch.manual_seed(args.seed + rank)\n  File \"/home/ka709/miniconda3/lib/python3.6/site-packages/torch/__init__.py\", line 133, in manual_seed\n    torch.cuda.manual_seed_all(seed)\n  File \"/home/ka709/miniconda3/lib/python3.6/site-packages/torch/cuda/random.py\", line 37, in manual_seed_all\n    _lazy_init()\n  File \"/home/ka709/miniconda3/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 83, in _lazy_init\n    \"Cannot re-initialize CUDA in forked subprocess. \" + msg)\nRuntimeError: Cannot re-initialize CUDA in forked subprocess. To use CUDA with multiprocessing, you must use the 'spawn' start method", "body": "What was the rationale behind this? I can't set random seeds in my CPU multiprocessing code because it's trying to set CUDA seeds. This might be more convenient than controlling CUDA seeds manually, but this seems like a bug to me.\r\n\r\n```sh\r\n  File \"/home/ka709/ferry/test.py\", line 13, in test\r\n    torch.manual_seed(args.seed + rank)\r\n  File \"/home/ka709/miniconda3/lib/python3.6/site-packages/torch/__init__.py\", line 133, in manual_seed\r\n    torch.cuda.manual_seed_all(seed)\r\n  File \"/home/ka709/miniconda3/lib/python3.6/site-packages/torch/cuda/random.py\", line 37, in manual_seed_all\r\n    _lazy_init()\r\n  File \"/home/ka709/miniconda3/lib/python3.6/site-packages/torch/cuda/__init__.py\", line 83, in _lazy_init\r\n    \"Cannot re-initialize CUDA in forked subprocess. \" + msg)\r\nRuntimeError: Cannot re-initialize CUDA in forked subprocess. To use CUDA with multiprocessing, you must use the 'spawn' start method\r\n```"}