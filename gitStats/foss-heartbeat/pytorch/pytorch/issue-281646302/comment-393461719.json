{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/393461719", "html_url": "https://github.com/pytorch/pytorch/issues/4144#issuecomment-393461719", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/4144", "id": 393461719, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzQ2MTcxOQ==", "user": {"login": "morawi", "id": 36924479, "node_id": "MDQ6VXNlcjM2OTI0NDc5", "avatar_url": "https://avatars3.githubusercontent.com/u/36924479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/morawi", "html_url": "https://github.com/morawi", "followers_url": "https://api.github.com/users/morawi/followers", "following_url": "https://api.github.com/users/morawi/following{/other_user}", "gists_url": "https://api.github.com/users/morawi/gists{/gist_id}", "starred_url": "https://api.github.com/users/morawi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/morawi/subscriptions", "organizations_url": "https://api.github.com/users/morawi/orgs", "repos_url": "https://api.github.com/users/morawi/repos", "events_url": "https://api.github.com/users/morawi/events{/privacy}", "received_events_url": "https://api.github.com/users/morawi/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-31T08:51:44Z", "updated_at": "2018-05-31T09:51:47Z", "author_association": "NONE", "body_html": "<p>Hi, I am having the same problem, caused at the line:<br>\n<code>test_loss += criterion(output, target).item() </code></p>\n<p>*** RuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1524584710464/work/aten/src/THCUNN/SoftMaxCommon.cuh:431</p>\n<p>The problem might be caused by the dataset, but I am not able to pinpoint it. Here is the shape of the data I am using:</p>\n<pre><code>In[23]:test_set.labels\nOut[23]: array([-1, -1, -1, ..., -1, -1, -1])\nIn[24]: len(test_set.labels)\nOut[24]: 100000\nIn[25]:test_set.data.shape\nOut[25]: (100000, 3, 96, 96)\n\n</code></pre>\n<p>Oh, and I am using small batch-size (25):</p>\n<pre><code>In[26]:test_loader.batch_size\nOut[26]:25\n</code></pre>\n<p>The code snippet where the error showed is the following:</p>\n<pre><code>    model.eval()\n    test_loss = 0   \n    with torch.no_grad():\n        for data, target in test_loader:\n            data, target = data.to(device), target.to(device)\n            output = model(data)\n            test_loss += criterion(output, target).item()\n             .\n             .\n</code></pre>\n<p>NB. If I delete/comment this statement <code>test_loss += criterion(output, target).item()</code>, the program runs well.</p>", "body_text": "Hi, I am having the same problem, caused at the line:\ntest_loss += criterion(output, target).item() \n*** RuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1524584710464/work/aten/src/THCUNN/SoftMaxCommon.cuh:431\nThe problem might be caused by the dataset, but I am not able to pinpoint it. Here is the shape of the data I am using:\nIn[23]:test_set.labels\nOut[23]: array([-1, -1, -1, ..., -1, -1, -1])\nIn[24]: len(test_set.labels)\nOut[24]: 100000\nIn[25]:test_set.data.shape\nOut[25]: (100000, 3, 96, 96)\n\n\nOh, and I am using small batch-size (25):\nIn[26]:test_loader.batch_size\nOut[26]:25\n\nThe code snippet where the error showed is the following:\n    model.eval()\n    test_loss = 0   \n    with torch.no_grad():\n        for data, target in test_loader:\n            data, target = data.to(device), target.to(device)\n            output = model(data)\n            test_loss += criterion(output, target).item()\n             .\n             .\n\nNB. If I delete/comment this statement test_loss += criterion(output, target).item(), the program runs well.", "body": "Hi, I am having the same problem, caused at the line:\r\n`test_loss += criterion(output, target).item() `\r\n\r\n*** RuntimeError: cuda runtime error (59) : device-side assert triggered at /opt/conda/conda-bld/pytorch_1524584710464/work/aten/src/THCUNN/SoftMaxCommon.cuh:431\r\n\r\nThe problem might be caused by the dataset, but I am not able to pinpoint it. Here is the shape of the data I am using:\r\n\r\n```\r\nIn[23]:test_set.labels\r\nOut[23]: array([-1, -1, -1, ..., -1, -1, -1])\r\nIn[24]: len(test_set.labels)\r\nOut[24]: 100000\r\nIn[25]:test_set.data.shape\r\nOut[25]: (100000, 3, 96, 96)\r\n\r\n```\r\nOh, and I am using small batch-size (25):\r\n\r\n```\r\nIn[26]:test_loader.batch_size\r\nOut[26]:25\r\n```\r\nThe code snippet where the error showed is the following:\r\n\r\n```\r\n    model.eval()\r\n    test_loss = 0   \r\n    with torch.no_grad():\r\n        for data, target in test_loader:\r\n            data, target = data.to(device), target.to(device)\r\n            output = model(data)\r\n            test_loss += criterion(output, target).item()\r\n             .\r\n             .\r\n```\r\n\r\nNB. If I delete/comment this statement `test_loss += criterion(output, target).item()`, the program runs well. \r\n\r\n\r\n"}