{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8979", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8979/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8979/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8979/events", "html_url": "https://github.com/pytorch/pytorch/issues/8979", "id": 336509540, "node_id": "MDU6SXNzdWUzMzY1MDk1NDA=", "number": 8979, "title": "Check failed: error == cudaSuccess unspecified launch failure [caffe2]", "user": {"login": "LeonJWH", "id": 17867054, "node_id": "MDQ6VXNlcjE3ODY3MDU0", "avatar_url": "https://avatars0.githubusercontent.com/u/17867054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeonJWH", "html_url": "https://github.com/LeonJWH", "followers_url": "https://api.github.com/users/LeonJWH/followers", "following_url": "https://api.github.com/users/LeonJWH/following{/other_user}", "gists_url": "https://api.github.com/users/LeonJWH/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeonJWH/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeonJWH/subscriptions", "organizations_url": "https://api.github.com/users/LeonJWH/orgs", "repos_url": "https://api.github.com/users/LeonJWH/repos", "events_url": "https://api.github.com/users/LeonJWH/events{/privacy}", "received_events_url": "https://api.github.com/users/LeonJWH/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-06-28T07:45:15Z", "updated_at": "2018-07-02T17:55:20Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>When I tried to resume training the maskrcnn using Detectron. The training progress goes well at the begining, but alone with the training continues, the training time for each iter grows progressly, after handreds or thousands of iterations, the training broke down with the cuda error below:</p>\n<blockquote>\n<p>*** Check failure stack trace: ***<br>\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure<br>\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure<br>\n*** Check failure stack trace: ***<br>\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure<br>\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure<br>\n*** Check failure stack trace: ***<br>\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure<br>\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure<br>\nE0628 15:21:28.669669  1907 net_dag.cc:195] Secondary exception from operator chain starting at '' (type 'Add'): caffe2::EnforceNotMet: [enforce fail at context_gpu.h:156] . Encountered CUDA error: unspecified launch failure Error from operator:<br>\ninput: \"gpu_0/mask_fcn_logits_w_grad\" input: \"gpu_1/mask_fcn_logits_w_grad\" output: \"gpu_0/mask_fcn_logits_w_grad\" name: \"\" type: \"Add\" device_option { device_type: 1 cuda_gpu_id: 0 }<br>\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure<br>\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure<br>\n*** Check failure stack trace: ***<br>\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure<br>\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureFF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure<br>\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670533  1907 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure<br>\n*** Check failure stack trace: ***<br>\n*** Check failure stack trace: ***</p>\n</blockquote>\n<p>I googled this error, it seems like something about GPU memory leak, but during training time, GPU memory usage are stable and normal until the progress broke down. I tried to reboot my server but it didn't work, can you help me out with this?</p>\n<p>I checked the context_gpu.h at line 107, the code is:</p>\n<pre><code>~ThreadLocalCUDAObjects() noexcept {\n 99     for (int i = 0; i &lt; CAFFE2_COMPILE_TIME_MAX_GPUS; ++i) {\n100       for (auto&amp; handle : cublas_handles_[i]) {\n101         if (handle) {\n102           CUBLAS_CHECK(cublasDestroy(handle));\n103         }\n104       }\n105       for (auto&amp; stream : cuda_streams_[i]) {\n106         if (stream) {\n107           CUDA_CHECK(cudaStreamDestroy(stream));\n108         }\n109       }\n110       for (auto&amp; handle : cudnn_handles_[i]) {\n111         if (handle) {\n112           CUDNN_CHECK(cudnnDestroy(handle));\n113         }\n114       }\n115     }\n116   }\n</code></pre>", "body_text": "When I tried to resume training the maskrcnn using Detectron. The training progress goes well at the begining, but alone with the training continues, the training time for each iter grows progressly, after handreds or thousands of iterations, the training broke down with the cuda error below:\n\n*** Check failure stack trace: ***\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\n*** Check failure stack trace: ***\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\n*** Check failure stack trace: ***\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\nE0628 15:21:28.669669  1907 net_dag.cc:195] Secondary exception from operator chain starting at '' (type 'Add'): caffe2::EnforceNotMet: [enforce fail at context_gpu.h:156] . Encountered CUDA error: unspecified launch failure Error from operator:\ninput: \"gpu_0/mask_fcn_logits_w_grad\" input: \"gpu_1/mask_fcn_logits_w_grad\" output: \"gpu_0/mask_fcn_logits_w_grad\" name: \"\" type: \"Add\" device_option { device_type: 1 cuda_gpu_id: 0 }\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\n*** Check failure stack trace: ***\nF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureFF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\n28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670533  1907 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\n*** Check failure stack trace: ***\n*** Check failure stack trace: ***\n\nI googled this error, it seems like something about GPU memory leak, but during training time, GPU memory usage are stable and normal until the progress broke down. I tried to reboot my server but it didn't work, can you help me out with this?\nI checked the context_gpu.h at line 107, the code is:\n~ThreadLocalCUDAObjects() noexcept {\n 99     for (int i = 0; i < CAFFE2_COMPILE_TIME_MAX_GPUS; ++i) {\n100       for (auto& handle : cublas_handles_[i]) {\n101         if (handle) {\n102           CUBLAS_CHECK(cublasDestroy(handle));\n103         }\n104       }\n105       for (auto& stream : cuda_streams_[i]) {\n106         if (stream) {\n107           CUDA_CHECK(cudaStreamDestroy(stream));\n108         }\n109       }\n110       for (auto& handle : cudnn_handles_[i]) {\n111         if (handle) {\n112           CUDNN_CHECK(cudnnDestroy(handle));\n113         }\n114       }\n115     }\n116   }", "body": "When I tried to resume training the maskrcnn using Detectron. The training progress goes well at the begining, but alone with the training continues, the training time for each iter grows progressly, after handreds or thousands of iterations, the training broke down with the cuda error below:\r\n\r\n> *** Check failure stack trace: ***\r\n> F0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\r\n> 28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\r\n> *** Check failure stack trace: ***\r\n> F0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\r\n> 28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\r\n> *** Check failure stack trace: ***\r\n> F0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\r\n> 28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\r\n> E0628 15:21:28.669669  1907 net_dag.cc:195] Secondary exception from operator chain starting at '' (type 'Add'): caffe2::EnforceNotMet: [enforce fail at context_gpu.h:156] . Encountered CUDA error: unspecified launch failure Error from operator:\r\n> input: \"gpu_0/mask_fcn_logits_w_grad\" input: \"gpu_1/mask_fcn_logits_w_grad\" output: \"gpu_0/mask_fcn_logits_w_grad\" name: \"\" type: \"Add\" device_option { device_type: 1 cuda_gpu_id: 0 }\r\n> F0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\r\n> 28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\r\n> *** Check failure stack trace: ***\r\n> F0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\r\n> 28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureFF0628 15:21:28.669647  1910 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669657  1911 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1904 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669684  1909 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669703  1914 context_gpu.h:107] C06ck failed: error == cudaSuccess unspecified launch failure\r\n> 28 15:21:28.669694  1906 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.669710  1900 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670411  1912 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670415  1903 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670450  1902 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670488  1913 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failureF0628 15:21:28.670533  1907 context_gpu.h:107] Check failed: error == cudaSuccess unspecified launch failure\r\n> *** Check failure stack trace: ***\r\n> *** Check failure stack trace: ***\r\n\r\nI googled this error, it seems like something about GPU memory leak, but during training time, GPU memory usage are stable and normal until the progress broke down. I tried to reboot my server but it didn't work, can you help me out with this?\r\n\r\nI checked the context_gpu.h at line 107, the code is:\r\n\r\n```\r\n~ThreadLocalCUDAObjects() noexcept {\r\n 99     for (int i = 0; i < CAFFE2_COMPILE_TIME_MAX_GPUS; ++i) {\r\n100       for (auto& handle : cublas_handles_[i]) {\r\n101         if (handle) {\r\n102           CUBLAS_CHECK(cublasDestroy(handle));\r\n103         }\r\n104       }\r\n105       for (auto& stream : cuda_streams_[i]) {\r\n106         if (stream) {\r\n107           CUDA_CHECK(cudaStreamDestroy(stream));\r\n108         }\r\n109       }\r\n110       for (auto& handle : cudnn_handles_[i]) {\r\n111         if (handle) {\r\n112           CUDNN_CHECK(cudnnDestroy(handle));\r\n113         }\r\n114       }\r\n115     }\r\n116   }\r\n```"}