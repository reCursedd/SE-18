{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6451", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6451/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6451/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6451/events", "html_url": "https://github.com/pytorch/pytorch/issues/6451", "id": 312724581, "node_id": "MDU6SXNzdWUzMTI3MjQ1ODE=", "number": 6451, "title": "[PyTorch] Build error (NCCL) on Ubuntu 16.04", "user": {"login": "Lyken17", "id": 7783214, "node_id": "MDQ6VXNlcjc3ODMyMTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/7783214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lyken17", "html_url": "https://github.com/Lyken17", "followers_url": "https://api.github.com/users/Lyken17/followers", "following_url": "https://api.github.com/users/Lyken17/following{/other_user}", "gists_url": "https://api.github.com/users/Lyken17/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lyken17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lyken17/subscriptions", "organizations_url": "https://api.github.com/users/Lyken17/orgs", "repos_url": "https://api.github.com/users/Lyken17/repos", "events_url": "https://api.github.com/users/Lyken17/events{/privacy}", "received_events_url": "https://api.github.com/users/Lyken17/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-04-09T23:39:09Z", "updated_at": "2018-11-11T01:54:28Z", "closed_at": "2018-04-10T02:51:49Z", "author_association": "NONE", "body_html": "<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: 0.4.0 lastest master branch (<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/e83dd716ec5a464040c40a19efd8144138e3ca1e/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/e83dd716ec5a464040c40a19efd8144138e3ca1e\"><tt>e83dd71</tt></a>)</li>\n<li>How you installed PyTorch (conda, pip, source):source</li>\n<li>Python version: Python 3.5.5 :: Anaconda, Inc.</li>\n<li>CUDA/cuDNN version: CUDA 8.0 / CUDNN 7.0.5</li>\n<li>GPU models and configuration: Nvidia GTX 1080ti</li>\n<li>GCC version (if compiling from source): gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9)</li>\n<li>CMake version: cmake version 3.9.4</li>\n<li>Build command you used (if compiling from source): <code>python setup.py build</code></li>\n<li>Versions of any other relevant libraries:</li>\n</ul>\n<div class=\"highlight highlight-source-shell\"><pre>git clone --recursive https://github.com/pytorch/pytorch\n<span class=\"pl-c1\">cd</span> pytorch\npython setup.py install</pre></div>\n<p>Then I get following errors<br>\n<a href=\"https://github.com/pytorch/pytorch/files/1892293/log.txt\">complete_log.txt</a></p>\n<div class=\"highlight highlight-source-shell\"><pre>+ make install -j12\n[  3%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:30:15: error: \u2018ncclInt8\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   {at::kChar, ncclInt8},\n               ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:31:15: error: \u2018ncclUint8\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   {at::kByte, ncclUint8},\n               ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:34:14: error: \u2018ncclInt32\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   {at::kInt, ncclInt32},\n              ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:37:1: error: could not convert \u2018{{at::kChar, <span class=\"pl-k\">&lt;</span>expression error<span class=\"pl-k\">&gt;</span>}, {at::kByte, <span class=\"pl-k\">&lt;</span>expression error<span class=\"pl-k\">&gt;</span>}, {at::kFloat, ncclFloat}, {at::kDouble, ncclDouble}, {at::kInt, <span class=\"pl-k\">&lt;</span>expression error<span class=\"pl-k\">&gt;</span>}, {at::kLong, ncclInt64}, {at::kHalf, ncclHalf}}\u2019 from \u2018<span class=\"pl-k\">&lt;</span>brace-enclosed initializer list<span class=\"pl-k\">&gt;</span>\u2019 to \u2018std::unordered_map<span class=\"pl-k\">&lt;</span>at::ScalarType, ncclDataType_t<span class=\"pl-k\">&gt;</span>\u2019\n }<span class=\"pl-k\">;</span>\n ^\nIn file included from /home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:3:0:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member <span class=\"pl-k\">function</span> <span class=\"pl-en\">\u2018void</span> thd::DataChannelNccl::_destroyNcclResources(THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:196:38: error: void value not ignored as it ought to be\n       NCCL_CHECK(ncclCommDestroy(comm))<span class=\"pl-k\">;</span>\n                                      ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member <span class=\"pl-k\">function</span> <span class=\"pl-en\">\u2018thd::NcclResourcePair</span> thd::DataChannelNccl::_getNcclResourcePair(std::vector<span class=\"pl-k\">&lt;</span>at::Tensor<span class=\"pl-k\">&gt;&amp;</span>, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:315:29: error: \u2018ncclGroupStart\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupStart</span>());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:324:27: error: \u2018ncclGroupEnd\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupEnd</span>());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member <span class=\"pl-k\">function</span> <span class=\"pl-en\">\u2018virtual</span> void thd::DataChannelNccl::allReduce(std::vector<span class=\"pl-k\">&lt;</span>at::Tensor<span class=\"pl-k\">&gt;&amp;</span>, THDReduceOp, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:432:29: error: \u2018ncclGroupStart\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupStart</span>());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:447:27: error: \u2018ncclGroupEnd\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupEnd</span>());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member <span class=\"pl-k\">function</span> <span class=\"pl-en\">\u2018virtual</span> void thd::DataChannelNccl::allGather(std::vector<span class=\"pl-k\">&lt;</span>at::Tensor<span class=\"pl-k\">&gt;&amp;</span>, std::vector<span class=\"pl-k\">&lt;</span>at::Tensor<span class=\"pl-k\">&gt;&amp;</span>, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:483:29: error: \u2018ncclGroupStart\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupStart</span>());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:490:48: error: invalid conversion from \u2018void<span class=\"pl-k\">*</span>\u2019 to \u2018int\u2019 [-fpermissive]\n                              <span class=\"pl-en\">output[i].data_ptr</span>(),\n                                                ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:491:44: error: invalid conversion from \u2018int64_t {aka long int}\u2019 to \u2018ncclDataType_t\u2019 [-fpermissive]\n                              <span class=\"pl-en\">input[i].numel</span>(),\n                                            ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:494:36: error: cannot convert \u2018ncclDataType_t\u2019 to \u2018void<span class=\"pl-k\">*</span>\u2019 <span class=\"pl-k\">for</span> argument \u20184\u2019 to \u2018ncclResult_t ncclAllGather(const void<span class=\"pl-k\">*</span>, int, ncclDataType_t, void<span class=\"pl-k\">*</span>, ncclComm_t, cudaStream_t)\u2019\n                              stream))<span class=\"pl-k\">;</span>\n                                    ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:497:27: error: \u2018ncclGroupEnd\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupEnd</span>());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member <span class=\"pl-k\">function</span> <span class=\"pl-en\">\u2018virtual</span> void thd::DataChannelNccl::reduce(std::vector<span class=\"pl-k\">&lt;</span>at::Tensor<span class=\"pl-k\">&gt;&amp;</span>, THDReduceOp, thd::rank_type, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:535:29: error: \u2018ncclGroupStart\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupStart</span>());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:551:27: error: \u2018ncclGroupEnd\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupEnd</span>());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member <span class=\"pl-k\">function</span> <span class=\"pl-en\">\u2018virtual</span> void thd::DataChannelNccl::broadcast(std::vector<span class=\"pl-k\">&lt;</span>at::Tensor<span class=\"pl-k\">&gt;&amp;</span>, thd::rank_type, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:587:29: error: \u2018ncclGroupStart\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupStart</span>());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:601:27: error: \u2018ncclGroupEnd\u2019 was not declared <span class=\"pl-k\">in</span> this scope\n   <span class=\"pl-en\">NCCL_CHECK(ncclGroupEnd</span>());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: <span class=\"pl-k\">in</span> definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd<span class=\"pl-k\">;</span>                                   \\\n                        ^\nCMakeFiles/THD.dir/build.make:230: recipe <span class=\"pl-k\">for</span> target <span class=\"pl-s\"><span class=\"pl-pds\">'</span>CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o<span class=\"pl-pds\">'</span></span> failed\nmake[2]: <span class=\"pl-k\">***</span> [CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o] Error 1\nCMakeFiles/Makefile2:67: recipe <span class=\"pl-k\">for</span> target <span class=\"pl-s\"><span class=\"pl-pds\">'</span>CMakeFiles/THD.dir/all<span class=\"pl-pds\">'</span></span> failed\nmake[1]: <span class=\"pl-k\">***</span> [CMakeFiles/THD.dir/all] Error 2\nMakefile:129: recipe <span class=\"pl-k\">for</span> target <span class=\"pl-s\"><span class=\"pl-pds\">'</span>all<span class=\"pl-pds\">'</span></span> failed\nmake: <span class=\"pl-k\">***</span> [all] Error 2</pre></div>", "body_text": "PyTorch or Caffe2: PyTorch\nOS: Ubuntu 16.04\nPyTorch version: 0.4.0 lastest master branch (e83dd71)\nHow you installed PyTorch (conda, pip, source):source\nPython version: Python 3.5.5 :: Anaconda, Inc.\nCUDA/cuDNN version: CUDA 8.0 / CUDNN 7.0.5\nGPU models and configuration: Nvidia GTX 1080ti\nGCC version (if compiling from source): gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9)\nCMake version: cmake version 3.9.4\nBuild command you used (if compiling from source): python setup.py build\nVersions of any other relevant libraries:\n\ngit clone --recursive https://github.com/pytorch/pytorch\ncd pytorch\npython setup.py install\nThen I get following errors\ncomplete_log.txt\n+ make install -j12\n[  3%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:30:15: error: \u2018ncclInt8\u2019 was not declared in this scope\n   {at::kChar, ncclInt8},\n               ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:31:15: error: \u2018ncclUint8\u2019 was not declared in this scope\n   {at::kByte, ncclUint8},\n               ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:34:14: error: \u2018ncclInt32\u2019 was not declared in this scope\n   {at::kInt, ncclInt32},\n              ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:37:1: error: could not convert \u2018{{at::kChar, <expression error>}, {at::kByte, <expression error>}, {at::kFloat, ncclFloat}, {at::kDouble, ncclDouble}, {at::kInt, <expression error>}, {at::kLong, ncclInt64}, {at::kHalf, ncclHalf}}\u2019 from \u2018<brace-enclosed initializer list>\u2019 to \u2018std::unordered_map<at::ScalarType, ncclDataType_t>\u2019\n };\n ^\nIn file included from /home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:3:0:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018void thd::DataChannelNccl::_destroyNcclResources(THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:196:38: error: void value not ignored as it ought to be\n       NCCL_CHECK(ncclCommDestroy(comm));\n                                      ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018thd::NcclResourcePair thd::DataChannelNccl::_getNcclResourcePair(std::vector<at::Tensor>&, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:315:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupStart());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:324:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupEnd());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allReduce(std::vector<at::Tensor>&, THDReduceOp, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:432:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupStart());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:447:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupEnd());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allGather(std::vector<at::Tensor>&, std::vector<at::Tensor>&, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:483:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupStart());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:490:48: error: invalid conversion from \u2018void*\u2019 to \u2018int\u2019 [-fpermissive]\n                              output[i].data_ptr(),\n                                                ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:491:44: error: invalid conversion from \u2018int64_t {aka long int}\u2019 to \u2018ncclDataType_t\u2019 [-fpermissive]\n                              input[i].numel(),\n                                            ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:494:36: error: cannot convert \u2018ncclDataType_t\u2019 to \u2018void*\u2019 for argument \u20184\u2019 to \u2018ncclResult_t ncclAllGather(const void*, int, ncclDataType_t, void*, ncclComm_t, cudaStream_t)\u2019\n                              stream));\n                                    ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:497:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupEnd());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::reduce(std::vector<at::Tensor>&, THDReduceOp, thd::rank_type, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:535:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupStart());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:551:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupEnd());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::broadcast(std::vector<at::Tensor>&, thd::rank_type, THDGroup)\u2019:\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:587:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupStart());\n                             ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:601:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\n   NCCL_CHECK(ncclGroupEnd());\n                           ^\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\n   ncclResult_t error = cmd;                                   \\\n                        ^\nCMakeFiles/THD.dir/build.make:230: recipe for target 'CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o' failed\nmake[2]: *** [CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/THD.dir/all' failed\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\nMakefile:129: recipe for target 'all' failed\nmake: *** [all] Error 2", "body": "- PyTorch or Caffe2: PyTorch\r\n- OS: Ubuntu 16.04\r\n- PyTorch version: 0.4.0 lastest master branch (e83dd71)\r\n- How you installed PyTorch (conda, pip, source):source\r\n- Python version: Python 3.5.5 :: Anaconda, Inc.\r\n- CUDA/cuDNN version: CUDA 8.0 / CUDNN 7.0.5\r\n- GPU models and configuration: Nvidia GTX 1080ti\r\n- GCC version (if compiling from source): gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9)\r\n- CMake version: cmake version 3.9.4\r\n- Build command you used (if compiling from source): `python setup.py build`\r\n- Versions of any other relevant libraries:\r\n\r\n```bash\r\ngit clone --recursive https://github.com/pytorch/pytorch\r\ncd pytorch\r\npython setup.py install\r\n```\r\n\r\nThen I get following errors\r\n[complete_log.txt](https://github.com/pytorch/pytorch/files/1892293/log.txt)\r\n\r\n```bash\r\n+ make install -j12\r\n[  3%] Building CXX object CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:30:15: error: \u2018ncclInt8\u2019 was not declared in this scope\r\n   {at::kChar, ncclInt8},\r\n               ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:31:15: error: \u2018ncclUint8\u2019 was not declared in this scope\r\n   {at::kByte, ncclUint8},\r\n               ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:34:14: error: \u2018ncclInt32\u2019 was not declared in this scope\r\n   {at::kInt, ncclInt32},\r\n              ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:37:1: error: could not convert \u2018{{at::kChar, <expression error>}, {at::kByte, <expression error>}, {at::kFloat, ncclFloat}, {at::kDouble, ncclDouble}, {at::kInt, <expression error>}, {at::kLong, ncclInt64}, {at::kHalf, ncclHalf}}\u2019 from \u2018<brace-enclosed initializer list>\u2019 to \u2018std::unordered_map<at::ScalarType, ncclDataType_t>\u2019\r\n };\r\n ^\r\nIn file included from /home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:3:0:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018void thd::DataChannelNccl::_destroyNcclResources(THDGroup)\u2019:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:196:38: error: void value not ignored as it ought to be\r\n       NCCL_CHECK(ncclCommDestroy(comm));\r\n                                      ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018thd::NcclResourcePair thd::DataChannelNccl::_getNcclResourcePair(std::vector<at::Tensor>&, THDGroup)\u2019:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:315:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:324:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allReduce(std::vector<at::Tensor>&, THDReduceOp, THDGroup)\u2019:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:432:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:447:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::allGather(std::vector<at::Tensor>&, std::vector<at::Tensor>&, THDGroup)\u2019:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:483:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:490:48: error: invalid conversion from \u2018void*\u2019 to \u2018int\u2019 [-fpermissive]\r\n                              output[i].data_ptr(),\r\n                                                ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:491:44: error: invalid conversion from \u2018int64_t {aka long int}\u2019 to \u2018ncclDataType_t\u2019 [-fpermissive]\r\n                              input[i].numel(),\r\n                                            ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:494:36: error: cannot convert \u2018ncclDataType_t\u2019 to \u2018void*\u2019 for argument \u20184\u2019 to \u2018ncclResult_t ncclAllGather(const void*, int, ncclDataType_t, void*, ncclComm_t, cudaStream_t)\u2019\r\n                              stream));\r\n                                    ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:497:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::reduce(std::vector<at::Tensor>&, THDReduceOp, thd::rank_type, THDGroup)\u2019:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:535:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:551:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp: In member function \u2018virtual void thd::DataChannelNccl::broadcast(std::vector<at::Tensor>&, thd::rank_type, THDGroup)\u2019:\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:587:29: error: \u2018ncclGroupStart\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupStart());\r\n                             ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.cpp:601:27: error: \u2018ncclGroupEnd\u2019 was not declared in this scope\r\n   NCCL_CHECK(ncclGroupEnd());\r\n                           ^\r\n/home/ligeng/Tools/pytorch/torch/lib/THD/base/data_channels/DataChannelNccl.hpp:16:24: note: in definition of macro \u2018NCCL_CHECK\u2019\r\n   ncclResult_t error = cmd;                                   \\\r\n                        ^\r\nCMakeFiles/THD.dir/build.make:230: recipe for target 'CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o' failed\r\nmake[2]: *** [CMakeFiles/THD.dir/base/data_channels/DataChannelNccl.cpp.o] Error 1\r\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/THD.dir/all' failed\r\nmake[1]: *** [CMakeFiles/THD.dir/all] Error 2\r\nMakefile:129: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\n```\r\n"}