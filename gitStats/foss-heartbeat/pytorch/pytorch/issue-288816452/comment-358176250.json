{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/358176250", "html_url": "https://github.com/pytorch/pytorch/issues/4679#issuecomment-358176250", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/4679", "id": 358176250, "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODE3NjI1MA==", "user": {"login": "Zrachel", "id": 4532062, "node_id": "MDQ6VXNlcjQ1MzIwNjI=", "avatar_url": "https://avatars0.githubusercontent.com/u/4532062?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zrachel", "html_url": "https://github.com/Zrachel", "followers_url": "https://api.github.com/users/Zrachel/followers", "following_url": "https://api.github.com/users/Zrachel/following{/other_user}", "gists_url": "https://api.github.com/users/Zrachel/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zrachel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zrachel/subscriptions", "organizations_url": "https://api.github.com/users/Zrachel/orgs", "repos_url": "https://api.github.com/users/Zrachel/repos", "events_url": "https://api.github.com/users/Zrachel/events{/privacy}", "received_events_url": "https://api.github.com/users/Zrachel/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-17T02:36:27Z", "updated_at": "2018-01-17T09:48:01Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5652049\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zou3519\">@zou3519</a><br>\nThank you, <code>p2pBandwidthLatencyTest</code> meet no hangs.</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=8120856\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/teng-li\">@teng-li</a><br>\nThank you, I re-execute the whole process and update my problem:</p>\n<ol>\n<li>Introducing <code>nccl</code> into compilation will not brings program hanging. (The port was occupied by the hung process, that make me misconceived.) So there is no difference for backend <code>tcp</code> before and after introducing <code>nccl2</code>.</li>\n<li>Backend <code>tcp</code> works well but <code>gloo</code> and <code>nccl</code> still hangs. As for the program <code>reduce_sum.py</code>, <code>tcp</code> backend get the following result:</li>\n</ol>\n<pre><code>Rank  0  has data  2.0\nRank  1  has data  2.0\n</code></pre>\n<p>But only changing the backend to <code>gloo</code> or <code>nccl</code> makes program hang.</p>\n<hr>\n<p>My environment:<br>\nLSB Version:    :core-4.0-amd64:core-4.0-noarch:graphics-4.0-amd64:graphics-4.0-noarch:printing-4.0-amd64:printing-4.0-noarch<br>\nDistributor ID: CentOS<br>\nDescription:    CentOS release 6.3 (Final)<br>\nRelease:        6.3<br>\nCodename:       Final</p>\n<p>I use <code>NCCL 2.0.5 and CUDA 8, O/S agnostic</code> in <a href=\"https://developer.nvidia.com/nccl/nccl-download\" rel=\"nofollow\">https://developer.nvidia.com/nccl/nccl-download</a></p>", "body_text": "@zou3519\nThank you, p2pBandwidthLatencyTest meet no hangs.\n@teng-li\nThank you, I re-execute the whole process and update my problem:\n\nIntroducing nccl into compilation will not brings program hanging. (The port was occupied by the hung process, that make me misconceived.) So there is no difference for backend tcp before and after introducing nccl2.\nBackend tcp works well but gloo and nccl still hangs. As for the program reduce_sum.py, tcp backend get the following result:\n\nRank  0  has data  2.0\nRank  1  has data  2.0\n\nBut only changing the backend to gloo or nccl makes program hang.\n\nMy environment:\nLSB Version:    :core-4.0-amd64:core-4.0-noarch:graphics-4.0-amd64:graphics-4.0-noarch:printing-4.0-amd64:printing-4.0-noarch\nDistributor ID: CentOS\nDescription:    CentOS release 6.3 (Final)\nRelease:        6.3\nCodename:       Final\nI use NCCL 2.0.5 and CUDA 8, O/S agnostic in https://developer.nvidia.com/nccl/nccl-download", "body": "@zou3519 \r\nThank you, `p2pBandwidthLatencyTest` meet no hangs.\r\n\r\n@teng-li \r\nThank you, I re-execute the whole process and update my problem:\r\n   1. Introducing `nccl` into compilation will not brings program hanging. (The port was occupied by the hung process, that make me misconceived.) So there is no difference for backend `tcp` before and after introducing `nccl2`.\r\n   2. Backend `tcp` works well but `gloo` and `nccl` still hangs. As for the program `reduce_sum.py`, `tcp` backend get the following result:\r\n```\r\nRank  0  has data  2.0\r\nRank  1  has data  2.0\r\n```\r\nBut only changing the backend to `gloo` or `nccl` makes program hang.\r\n\r\n\r\n---------------\r\nMy environment:\r\nLSB Version:    :core-4.0-amd64:core-4.0-noarch:graphics-4.0-amd64:graphics-4.0-noarch:printing-4.0-amd64:printing-4.0-noarch\r\nDistributor ID: CentOS\r\nDescription:    CentOS release 6.3 (Final)\r\nRelease:        6.3\r\nCodename:       Final\r\n\r\nI use `NCCL 2.0.5 and CUDA 8, O/S agnostic` in https://developer.nvidia.com/nccl/nccl-download"}