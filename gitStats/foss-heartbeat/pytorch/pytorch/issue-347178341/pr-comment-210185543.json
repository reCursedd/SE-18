{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/210185543", "pull_request_review_id": 146346620, "id": 210185543, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMDE4NTU0Mw==", "diff_hunk": "@@ -555,12 +563,21 @@ std::shared_ptr<SugaredValue> emitBuiltinCall(\n \n   const auto& variants = getAllOperatorsFor(Symbol::aten(name));\n   std::stringstream failure_messages;\n-  for (const std::shared_ptr<Operator>& op : variants) {\n-    if (auto result = tryEmitBuiltin(\n-            op, failure_messages, loc, method, name, inputs, attributes)) {\n-      return result;\n+\n+  //first we try to match the schema without any conversion\n+  //if no schema matches then insert TensorToNum nodes where needed\n+  for(bool convert_tensors_to_nums : {false, true}) {\n+    for (const std::shared_ptr<Operator>& op : variants) {\n+      //clear previous error messages\n+      failure_messages.str(\"\");", "path": "torch/csrc/jit/script/compiler.cpp", "position": null, "original_position": 51, "commit_id": "b9a33edecbfb28f126046d76cb2c17158aaf53a0", "original_commit_id": "ef06dfa8b5dadfbfd66d78515e2919e9c3764e0e", "user": {"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, "body": "Failure messages need to accumulate for _all_ of the options. This changes it to clear after each variant, which will lead to very misleading errors that only report problems for one overload. We should clear the failure_messages between convert_tensors_to_nums loops, not between variants.", "created_at": "2018-08-15T07:02:17Z", "updated_at": "2018-11-23T15:49:23Z", "html_url": "https://github.com/pytorch/pytorch/pull/10180#discussion_r210185543", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/10180", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/210185543"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/10180#discussion_r210185543"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/10180"}}, "body_html": "<p>Failure messages need to accumulate for <em>all</em> of the options. This changes it to clear after each variant, which will lead to very misleading errors that only report problems for one overload. We should clear the failure_messages between convert_tensors_to_nums loops, not between variants.</p>", "body_text": "Failure messages need to accumulate for all of the options. This changes it to clear after each variant, which will lead to very misleading errors that only report problems for one overload. We should clear the failure_messages between convert_tensors_to_nums loops, not between variants."}