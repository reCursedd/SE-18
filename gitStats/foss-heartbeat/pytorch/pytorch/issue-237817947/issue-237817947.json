{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1874", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1874/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1874/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1874/events", "html_url": "https://github.com/pytorch/pytorch/issues/1874", "id": 237817947, "node_id": "MDU6SXNzdWUyMzc4MTc5NDc=", "number": 1874, "title": "perhaps register_buffer and friends should check if the property already exists on the module", "user": {"login": "greaber", "id": 8763901, "node_id": "MDQ6VXNlcjg3NjM5MDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/8763901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/greaber", "html_url": "https://github.com/greaber", "followers_url": "https://api.github.com/users/greaber/followers", "following_url": "https://api.github.com/users/greaber/following{/other_user}", "gists_url": "https://api.github.com/users/greaber/gists{/gist_id}", "starred_url": "https://api.github.com/users/greaber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/greaber/subscriptions", "organizations_url": "https://api.github.com/users/greaber/orgs", "repos_url": "https://api.github.com/users/greaber/repos", "events_url": "https://api.github.com/users/greaber/events{/privacy}", "received_events_url": "https://api.github.com/users/greaber/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}, {"id": 443484050, "node_id": "MDU6TGFiZWw0NDM0ODQwNTA=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/medium%20priority", "name": "medium priority", "color": "fbca04", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-06-22T11:42:45Z", "updated_at": "2017-09-01T18:08:57Z", "closed_at": "2017-09-01T18:08:57Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I was mistakenly trying to register a buffer that was already defined as a model property, something like this (but there could be less trivial cases):</p>\n<pre><code>self.foo = torch.Tensor([0])\nself.register_buffer('foo', self.foo)\n</code></pre>\n<p>I found that if you do this, the model works fine on the CPU, but it breaks when you use the GPU because the buffer is moved but the property isn't.  Perhaps <code>register_buffer</code> and the other registration functions should check if the property is already defined on the model and give an error if it is.</p>", "body_text": "I was mistakenly trying to register a buffer that was already defined as a model property, something like this (but there could be less trivial cases):\nself.foo = torch.Tensor([0])\nself.register_buffer('foo', self.foo)\n\nI found that if you do this, the model works fine on the CPU, but it breaks when you use the GPU because the buffer is moved but the property isn't.  Perhaps register_buffer and the other registration functions should check if the property is already defined on the model and give an error if it is.", "body": "I was mistakenly trying to register a buffer that was already defined as a model property, something like this (but there could be less trivial cases):\r\n```\r\nself.foo = torch.Tensor([0])\r\nself.register_buffer('foo', self.foo)\r\n```\r\nI found that if you do this, the model works fine on the CPU, but it breaks when you use the GPU because the buffer is moved but the property isn't.  Perhaps `register_buffer` and the other registration functions should check if the property is already defined on the model and give an error if it is.\r\n"}