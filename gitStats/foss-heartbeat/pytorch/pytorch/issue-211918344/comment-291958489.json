{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/291958489", "html_url": "https://github.com/pytorch/pytorch/issues/922#issuecomment-291958489", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/922", "id": 291958489, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MTk1ODQ4OQ==", "user": {"login": "gut", "id": 40444, "node_id": "MDQ6VXNlcjQwNDQ0", "avatar_url": "https://avatars3.githubusercontent.com/u/40444?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gut", "html_url": "https://github.com/gut", "followers_url": "https://api.github.com/users/gut/followers", "following_url": "https://api.github.com/users/gut/following{/other_user}", "gists_url": "https://api.github.com/users/gut/gists{/gist_id}", "starred_url": "https://api.github.com/users/gut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gut/subscriptions", "organizations_url": "https://api.github.com/users/gut/orgs", "repos_url": "https://api.github.com/users/gut/repos", "events_url": "https://api.github.com/users/gut/events{/privacy}", "received_events_url": "https://api.github.com/users/gut/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-05T18:47:19Z", "updated_at": "2017-04-05T18:47:28Z", "author_association": "NONE", "body_html": "<p>Ok , I have made some progress...</p>\n<pre><code>$ python test/test_torch.py\n......FF.F...F..............sss......F..F.........s.....terminate called after throwing an instance of 'THException'\n  what():  Invalid index in gather at /home/gut/pytorch/torch/lib/TH/generic/THTensorMath.c:441\nAborted\n</code></pre>\n<p>It turns out the interface changed and the code was not updated. <code>THDoubleVector_muls</code> calls <code>THDoubleVector_muls_VSX</code> with 4 parameters but the interface on <code>torch/lib/TH/vector/VSX.c</code> only declares 3. Somethings goes bad and <code>n</code> is corrupted:</p>\n<pre><code>#1  0x00003fff90178ea0 in THDoubleVector_muls (y=0x20c3f8c0, x=0x20c3d900, c=1000, n=1000) at /home/gut/pytorch/torch/lib/TH/generic/THVectorDispatch.c:171\n171       THVector_(muls_DISPATCHPTR)(y, x, c, n);\n(gdb) down\n#0  THDoubleVector_muls_VSX (y=0x20c3f8c0, x=0x20c3d900, n=70366857724600) at /home/gut/pytorch/torch/lib/TH/vector/VSX.c:412\n</code></pre>\n<p>So I had to apply the first diff referenced on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"211918344\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/922\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/922/hovercard?comment_id=291830986&amp;comment_type=issue_comment\" href=\"https://github.com/pytorch/pytorch/issues/922#issuecomment-291830986\">#922 (comment)</a> and now this one:</p>\n<div class=\"highlight highlight-source-diff\"><pre>index fbc7d61..2cb80a4 100644\n<span class=\"pl-md\">--- i/torch/lib/TH/vector/VSX.c</span>\n<span class=\"pl-mi1\">+++ w/torch/lib/TH/vector/VSX.c</span>\n<span class=\"pl-mdr\">@@ -399,7 +399,7 @@</span> static void THDoubleVector_scale_VSX(double *y, const double c, const ptrdiff_t\n }\n\n\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>static void THDoubleVector_muls_VSX(double *y, const double *x, const ptrdiff_t n)</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>static void THDoubleVector_muls_VSX(double *y, const double *x, const double c, const ptrdiff_t n)</span>\n {\n     ptrdiff_t i;\n</pre></div>", "body_text": "Ok , I have made some progress...\n$ python test/test_torch.py\n......FF.F...F..............sss......F..F.........s.....terminate called after throwing an instance of 'THException'\n  what():  Invalid index in gather at /home/gut/pytorch/torch/lib/TH/generic/THTensorMath.c:441\nAborted\n\nIt turns out the interface changed and the code was not updated. THDoubleVector_muls calls THDoubleVector_muls_VSX with 4 parameters but the interface on torch/lib/TH/vector/VSX.c only declares 3. Somethings goes bad and n is corrupted:\n#1  0x00003fff90178ea0 in THDoubleVector_muls (y=0x20c3f8c0, x=0x20c3d900, c=1000, n=1000) at /home/gut/pytorch/torch/lib/TH/generic/THVectorDispatch.c:171\n171       THVector_(muls_DISPATCHPTR)(y, x, c, n);\n(gdb) down\n#0  THDoubleVector_muls_VSX (y=0x20c3f8c0, x=0x20c3d900, n=70366857724600) at /home/gut/pytorch/torch/lib/TH/vector/VSX.c:412\n\nSo I had to apply the first diff referenced on #922 (comment) and now this one:\nindex fbc7d61..2cb80a4 100644\n--- i/torch/lib/TH/vector/VSX.c\n+++ w/torch/lib/TH/vector/VSX.c\n@@ -399,7 +399,7 @@ static void THDoubleVector_scale_VSX(double *y, const double c, const ptrdiff_t\n }\n\n\n-static void THDoubleVector_muls_VSX(double *y, const double *x, const ptrdiff_t n)\n+static void THDoubleVector_muls_VSX(double *y, const double *x, const double c, const ptrdiff_t n)\n {\n     ptrdiff_t i;", "body": "Ok , I have made some progress...\r\n```\r\n$ python test/test_torch.py\r\n......FF.F...F..............sss......F..F.........s.....terminate called after throwing an instance of 'THException'\r\n  what():  Invalid index in gather at /home/gut/pytorch/torch/lib/TH/generic/THTensorMath.c:441\r\nAborted\r\n```\r\nIt turns out the interface changed and the code was not updated. `THDoubleVector_muls` calls `THDoubleVector_muls_VSX` with 4 parameters but the interface on `torch/lib/TH/vector/VSX.c` only declares 3. Somethings goes bad and `n` is corrupted:\r\n```\r\n#1  0x00003fff90178ea0 in THDoubleVector_muls (y=0x20c3f8c0, x=0x20c3d900, c=1000, n=1000) at /home/gut/pytorch/torch/lib/TH/generic/THVectorDispatch.c:171\r\n171       THVector_(muls_DISPATCHPTR)(y, x, c, n);\r\n(gdb) down\r\n#0  THDoubleVector_muls_VSX (y=0x20c3f8c0, x=0x20c3d900, n=70366857724600) at /home/gut/pytorch/torch/lib/TH/vector/VSX.c:412\r\n```\r\n\r\nSo I had to apply the first diff referenced on https://github.com/pytorch/pytorch/issues/922#issuecomment-291830986 and now this one:\r\n```diff --git i/torch/lib/TH/vector/VSX.c w/torch/lib/TH/vector/VSX.c\r\nindex fbc7d61..2cb80a4 100644\r\n--- i/torch/lib/TH/vector/VSX.c\r\n+++ w/torch/lib/TH/vector/VSX.c\r\n@@ -399,7 +399,7 @@ static void THDoubleVector_scale_VSX(double *y, const double c, const ptrdiff_t\r\n }\r\n\r\n\r\n-static void THDoubleVector_muls_VSX(double *y, const double *x, const ptrdiff_t n)\r\n+static void THDoubleVector_muls_VSX(double *y, const double *x, const double c, const ptrdiff_t n)\r\n {\r\n     ptrdiff_t i;\r\n\r\n```"}