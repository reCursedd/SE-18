{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6559", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6559/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6559/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6559/events", "html_url": "https://github.com/pytorch/pytorch/issues/6559", "id": 313856316, "node_id": "MDU6SXNzdWUzMTM4NTYzMTY=", "number": 6559, "title": "RuntimeError: matrix and matrix when loss.backward()", "user": {"login": "vanangamudi", "id": 1615718, "node_id": "MDQ6VXNlcjE2MTU3MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1615718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vanangamudi", "html_url": "https://github.com/vanangamudi", "followers_url": "https://api.github.com/users/vanangamudi/followers", "following_url": "https://api.github.com/users/vanangamudi/following{/other_user}", "gists_url": "https://api.github.com/users/vanangamudi/gists{/gist_id}", "starred_url": "https://api.github.com/users/vanangamudi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vanangamudi/subscriptions", "organizations_url": "https://api.github.com/users/vanangamudi/orgs", "repos_url": "https://api.github.com/users/vanangamudi/repos", "events_url": "https://api.github.com/users/vanangamudi/events{/privacy}", "received_events_url": "https://api.github.com/users/vanangamudi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-12T19:25:32Z", "updated_at": "2018-04-12T19:26:57Z", "closed_at": "2018-04-12T19:26:34Z", "author_association": "NONE", "body_html": "<p>I am trying to implement <a href=\"https://arxiv.org/pdf/1611.01604.pdf\" rel=\"nofollow\">Dynamic Coattention networks</a><br>\nWhen running the backward() I get this error.  forward() works fine.<br>\nI use pytorch version 0.3.1 and python3.6 and cuda 9.0.<br>\nthe loss function is NLLLoss and you can find the entire repo <a href=\"https://github.com/vanangamudi/dcn_squad\">here</a><br>\ndcn.py is the main file.</p>\n<pre><code>Traceback (most recent call last):\n  File \"dcn.py\", line 443, in experiment\n    if not trainer.train():\n  File \"/home/vanangamudi/projects/dcn/trainer.py\", line 162, in train\n    loss.backward()\n  File \"/home/vanangamudi/env/pytorch35/lib/python3.6/site-packages/torch/autograd/variable.py\", line 167, in backward\n    torch.autograd.backward(self, gradient, retain_graph, create_graph, retain_variables)\n  File \"/home/vanangamudi/env/pytorch35/lib/python3.6/site-packages/torch/autograd/__init__.py\", line 99, in backward\n    variables, grad_variables, retain_graph)\nRuntimeError: matrix and matrix expected at /pytorch/torch/lib/THC/generic/THCTensorMathBlas.cu:241\n</code></pre>\n<p>Steps to reproduce:-</p>\n<ol>\n<li>Clone the repo</li>\n<li>create a dir under the cloned repo named <em>dataset</em></li>\n<li>place the <a href=\"https://rajpurkar.github.io/SQuAD-explorer/dataset/train-v1.1.json\" rel=\"nofollow\">train</a> and <a href=\"https://rajpurkar.github.io/SQuAD-explorer/dataset/dev-v1.1.json\" rel=\"nofollow\">dev</a> json files dataset <a href=\"https://rajpurkar.github.io/SQuAD-explorer/\" rel=\"nofollow\">squad</a></li>\n<li>In dcn.py change set  <code>flush = True</code></li>\n<li>run as <code>&gt;&gt;&gt; python dcn.py \"\" train</code></li>\n</ol>", "body_text": "I am trying to implement Dynamic Coattention networks\nWhen running the backward() I get this error.  forward() works fine.\nI use pytorch version 0.3.1 and python3.6 and cuda 9.0.\nthe loss function is NLLLoss and you can find the entire repo here\ndcn.py is the main file.\nTraceback (most recent call last):\n  File \"dcn.py\", line 443, in experiment\n    if not trainer.train():\n  File \"/home/vanangamudi/projects/dcn/trainer.py\", line 162, in train\n    loss.backward()\n  File \"/home/vanangamudi/env/pytorch35/lib/python3.6/site-packages/torch/autograd/variable.py\", line 167, in backward\n    torch.autograd.backward(self, gradient, retain_graph, create_graph, retain_variables)\n  File \"/home/vanangamudi/env/pytorch35/lib/python3.6/site-packages/torch/autograd/__init__.py\", line 99, in backward\n    variables, grad_variables, retain_graph)\nRuntimeError: matrix and matrix expected at /pytorch/torch/lib/THC/generic/THCTensorMathBlas.cu:241\n\nSteps to reproduce:-\n\nClone the repo\ncreate a dir under the cloned repo named dataset\nplace the train and dev json files dataset squad\nIn dcn.py change set  flush = True\nrun as >>> python dcn.py \"\" train", "body": "I am trying to implement [Dynamic Coattention networks](https://arxiv.org/pdf/1611.01604.pdf)\r\nWhen running the backward() I get this error.  forward() works fine. \r\nI use pytorch version 0.3.1 and python3.6 and cuda 9.0.\r\nthe loss function is NLLLoss and you can find the entire repo [here](https://github.com/vanangamudi/dcn_squad)\r\ndcn.py is the main file.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"dcn.py\", line 443, in experiment\r\n    if not trainer.train():\r\n  File \"/home/vanangamudi/projects/dcn/trainer.py\", line 162, in train\r\n    loss.backward()\r\n  File \"/home/vanangamudi/env/pytorch35/lib/python3.6/site-packages/torch/autograd/variable.py\", line 167, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph, retain_variables)\r\n  File \"/home/vanangamudi/env/pytorch35/lib/python3.6/site-packages/torch/autograd/__init__.py\", line 99, in backward\r\n    variables, grad_variables, retain_graph)\r\nRuntimeError: matrix and matrix expected at /pytorch/torch/lib/THC/generic/THCTensorMathBlas.cu:241\r\n```\r\n\r\nSteps to reproduce:-\r\n\r\n1. Clone the repo\r\n2. create a dir under the cloned repo named _dataset_\r\n3. place the [train](https://rajpurkar.github.io/SQuAD-explorer/dataset/train-v1.1.json) and [dev](https://rajpurkar.github.io/SQuAD-explorer/dataset/dev-v1.1.json) json files dataset [squad](https://rajpurkar.github.io/SQuAD-explorer/)\r\n4. In dcn.py change set  `flush = True`\r\n5. run as `>>> python dcn.py \"\" train`"}