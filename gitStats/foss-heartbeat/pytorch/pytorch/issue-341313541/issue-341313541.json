{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9456", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9456/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9456/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9456/events", "html_url": "https://github.com/pytorch/pytorch/issues/9456", "id": 341313541, "node_id": "MDU6SXNzdWUzNDEzMTM1NDE=", "number": 9456, "title": "Run Error CUDNN_STATUS_NOT_INITIALIZED", "user": {"login": "qimw", "id": 18625505, "node_id": "MDQ6VXNlcjE4NjI1NTA1", "avatar_url": "https://avatars0.githubusercontent.com/u/18625505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qimw", "html_url": "https://github.com/qimw", "followers_url": "https://api.github.com/users/qimw/followers", "following_url": "https://api.github.com/users/qimw/following{/other_user}", "gists_url": "https://api.github.com/users/qimw/gists{/gist_id}", "starred_url": "https://api.github.com/users/qimw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qimw/subscriptions", "organizations_url": "https://api.github.com/users/qimw/orgs", "repos_url": "https://api.github.com/users/qimw/repos", "events_url": "https://api.github.com/users/qimw/events{/privacy}", "received_events_url": "https://api.github.com/users/qimw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-07-15T11:23:14Z", "updated_at": "2018-07-22T07:53:26Z", "closed_at": "2018-07-22T07:53:26Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>I build the caffe2 from source on ubuntu 16,and then run the detectron with<br>\n<code>python2 tools/infer_simple.py \\ --cfg configs/12_2017_baselines/e2e_mask_rcnn_R-101-FPN_2x.yaml \\ --output-dir /tmp/detectron-visualizations \\ --image-ext jpg \\ --wts https://s3-us-west-2.amazonaws.com/detectron/35861858/12_2017_baselines/e2e_mask_rcnn_R-101-FPN_2x.yaml.02_32_51.SgT4y1cO/output/train/coco_2014_train:coco_2014_valminusminival/generalized_rcnn/model_final.pkl \\ demo</code> as <a href=\"https://github.com/facebookresearch/Detectron/blob/master/GETTING_STARTED.md\">this</a>.<br>\nBut It reports that:</p>\n<p><code>Traceback (most recent call last): File \"tools/infer_simple.py\", line 156, in &lt;module&gt; main(args) File \"tools/infer_simple.py\", line 126, in main model, im, None, timers=timers File \"/mnt/workspace/wqm/detection/detectron/detectron/core/test.py\", line 66, in im_detect_all model, im, cfg.TEST.SCALE, cfg.TEST.MAX_SIZE, boxes=box_proposals File \"/mnt/workspace/wqm/detection/detectron/detectron/core/test.py\", line 158, in im_detect_bbox workspace.RunNet(model.net.Proto().name) File \"/mnt/workspace/wqm/caffe2-for-detectron/pytorch/build/caffe2/python/workspace.py\", line 217, in RunNet StringifyNetName(name), num_iter, allow_fail, File \"/mnt/workspace/wqm/caffe2-for-detectron/pytorch/build/caffe2/python/workspace.py\", line 178, in CallWithExceptionIntercept return func(*args, **kwargs) RuntimeError: [enforce fail at context_gpu.h:100] status == CUDNN_STATUS_SUCCESS. 1 vs 0. , Error at: /mnt/workspace/wqm/caffe2-for-detectron/pytorch/caffe2/core/context_gpu.h:100: CUDNN_STATUS_NOT_INITIALIZED E rror from operator:  input: \"gpu_0/data\" input: \"gpu_0/conv1_w\" output: \"gpu_0/conv1\" name: \"\" type: \"Conv\" arg { name: \"kernel\" i: 7 } arg { name: \"exhaustive_search\" i: 0 } arg { name: \"pad\" i: 3 } arg { name: \"order\" s: \"NCHW\" }  arg { name: \"stride\" i: 2 } device_option { device_type: 1 cuda_gpu_id: 0 } engine: \"CUDNN\"</code><br>\nWhen I build the caffe2 it can find the cuda and cudnn:</p>\n<p>89 --   USE_CUDA              : ON<br>\n90 --     CUDA static link    : OFF<br>\n91 --     USE_CUDNN           : ON<br>\n92 --     CUDA version        : 9.1<br>\n93 --     cuDNN version       : 7.1.4<br>\n94 --     CUDA root directory : /usr/local/cuda<br>\n95 --     CUDA library        : /usr/local/cuda/lib64/stubs/libcuda.so<br>\n96 --     cudart library      : /usr/local/cuda/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so<br>\n97 --     cublas library      : /usr/local/cuda/lib64/libcublas.so;/usr/local/cuda/lib64/libcublas_device.a<br>\n98 --     cufft library       : /usr/local/cuda/lib64/libcufft.so<br>\n99 --     curand library      : /usr/local/cuda/lib64/libcurand.so<br>\n100 --     cuDNN library       : /usr/local/cuda/lib64/libcudnn.so<br>\n101 --     nvrtc               : /usr/local/cuda/lib64/libnvrtc.so<br>\n102 --     CUDA include path   : /usr/local/cuda/include<br>\n103 --     NVCC executable     : /usr/local/cuda/bin/nvcc<br>\n104 --     CUDA host compiler  : /usr/bin/cc</p>\n<h2>System Info</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<ul>\n<li>PyTorch or Caffe2:caffe2</li>\n<li>How you installed PyTorch (conda, pip, source):source</li>\n<li>Build command you used (if compiling from source):cmake .. &amp;&amp;make install DESTDIR=path/to/my/caffe2</li>\n<li>OS:ubuntu16</li>\n<li>Python version:2.7</li>\n<li>CUDA/cuDNN version:9.1/7</li>\n<li>GPU:titan x</li>\n<li>GCC version (if compiling from source):5.4.0</li>\n<li>CMake version:3.5.1</li>\n</ul>", "body_text": "Issue description\nI build the caffe2 from source on ubuntu 16,and then run the detectron with\npython2 tools/infer_simple.py \\ --cfg configs/12_2017_baselines/e2e_mask_rcnn_R-101-FPN_2x.yaml \\ --output-dir /tmp/detectron-visualizations \\ --image-ext jpg \\ --wts https://s3-us-west-2.amazonaws.com/detectron/35861858/12_2017_baselines/e2e_mask_rcnn_R-101-FPN_2x.yaml.02_32_51.SgT4y1cO/output/train/coco_2014_train:coco_2014_valminusminival/generalized_rcnn/model_final.pkl \\ demo as this.\nBut It reports that:\nTraceback (most recent call last): File \"tools/infer_simple.py\", line 156, in <module> main(args) File \"tools/infer_simple.py\", line 126, in main model, im, None, timers=timers File \"/mnt/workspace/wqm/detection/detectron/detectron/core/test.py\", line 66, in im_detect_all model, im, cfg.TEST.SCALE, cfg.TEST.MAX_SIZE, boxes=box_proposals File \"/mnt/workspace/wqm/detection/detectron/detectron/core/test.py\", line 158, in im_detect_bbox workspace.RunNet(model.net.Proto().name) File \"/mnt/workspace/wqm/caffe2-for-detectron/pytorch/build/caffe2/python/workspace.py\", line 217, in RunNet StringifyNetName(name), num_iter, allow_fail, File \"/mnt/workspace/wqm/caffe2-for-detectron/pytorch/build/caffe2/python/workspace.py\", line 178, in CallWithExceptionIntercept return func(*args, **kwargs) RuntimeError: [enforce fail at context_gpu.h:100] status == CUDNN_STATUS_SUCCESS. 1 vs 0. , Error at: /mnt/workspace/wqm/caffe2-for-detectron/pytorch/caffe2/core/context_gpu.h:100: CUDNN_STATUS_NOT_INITIALIZED E rror from operator:  input: \"gpu_0/data\" input: \"gpu_0/conv1_w\" output: \"gpu_0/conv1\" name: \"\" type: \"Conv\" arg { name: \"kernel\" i: 7 } arg { name: \"exhaustive_search\" i: 0 } arg { name: \"pad\" i: 3 } arg { name: \"order\" s: \"NCHW\" }  arg { name: \"stride\" i: 2 } device_option { device_type: 1 cuda_gpu_id: 0 } engine: \"CUDNN\"\nWhen I build the caffe2 it can find the cuda and cudnn:\n89 --   USE_CUDA              : ON\n90 --     CUDA static link    : OFF\n91 --     USE_CUDNN           : ON\n92 --     CUDA version        : 9.1\n93 --     cuDNN version       : 7.1.4\n94 --     CUDA root directory : /usr/local/cuda\n95 --     CUDA library        : /usr/local/cuda/lib64/stubs/libcuda.so\n96 --     cudart library      : /usr/local/cuda/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\n97 --     cublas library      : /usr/local/cuda/lib64/libcublas.so;/usr/local/cuda/lib64/libcublas_device.a\n98 --     cufft library       : /usr/local/cuda/lib64/libcufft.so\n99 --     curand library      : /usr/local/cuda/lib64/libcurand.so\n100 --     cuDNN library       : /usr/local/cuda/lib64/libcudnn.so\n101 --     nvrtc               : /usr/local/cuda/lib64/libnvrtc.so\n102 --     CUDA include path   : /usr/local/cuda/include\n103 --     NVCC executable     : /usr/local/cuda/bin/nvcc\n104 --     CUDA host compiler  : /usr/bin/cc\nSystem Info\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\n\nPyTorch or Caffe2:caffe2\nHow you installed PyTorch (conda, pip, source):source\nBuild command you used (if compiling from source):cmake .. &&make install DESTDIR=path/to/my/caffe2\nOS:ubuntu16\nPython version:2.7\nCUDA/cuDNN version:9.1/7\nGPU:titan x\nGCC version (if compiling from source):5.4.0\nCMake version:3.5.1", "body": "\r\n\r\n## Issue description\r\nI build the caffe2 from source on ubuntu 16,and then run the detectron with \r\n`\r\npython2 tools/infer_simple.py \\\r\n    --cfg configs/12_2017_baselines/e2e_mask_rcnn_R-101-FPN_2x.yaml \\\r\n    --output-dir /tmp/detectron-visualizations \\\r\n    --image-ext jpg \\\r\n    --wts https://s3-us-west-2.amazonaws.com/detectron/35861858/12_2017_baselines/e2e_mask_rcnn_R-101-FPN_2x.yaml.02_32_51.SgT4y1cO/output/train/coco_2014_train:coco_2014_valminusminival/generalized_rcnn/model_final.pkl \\\r\n    demo\r\n` as [this](https://github.com/facebookresearch/Detectron/blob/master/GETTING_STARTED.md).\r\nBut It reports that:\r\n\r\n`\r\nTraceback (most recent call last):\r\n  File \"tools/infer_simple.py\", line 156, in <module>\r\n    main(args)\r\n  File \"tools/infer_simple.py\", line 126, in main\r\n    model, im, None, timers=timers\r\n  File \"/mnt/workspace/wqm/detection/detectron/detectron/core/test.py\", line 66, in im_detect_all\r\n    model, im, cfg.TEST.SCALE, cfg.TEST.MAX_SIZE, boxes=box_proposals\r\n  File \"/mnt/workspace/wqm/detection/detectron/detectron/core/test.py\", line 158, in im_detect_bbox\r\n    workspace.RunNet(model.net.Proto().name)\r\n  File \"/mnt/workspace/wqm/caffe2-for-detectron/pytorch/build/caffe2/python/workspace.py\", line 217, in RunNet\r\n    StringifyNetName(name), num_iter, allow_fail,\r\n  File \"/mnt/workspace/wqm/caffe2-for-detectron/pytorch/build/caffe2/python/workspace.py\", line 178, in CallWithExceptionIntercept\r\n    return func(*args, **kwargs)\r\nRuntimeError: [enforce fail at context_gpu.h:100] status == CUDNN_STATUS_SUCCESS. 1 vs 0. , Error at: /mnt/workspace/wqm/caffe2-for-detectron/pytorch/caffe2/core/context_gpu.h:100: CUDNN_STATUS_NOT_INITIALIZED E\r\nrror from operator: \r\ninput: \"gpu_0/data\" input: \"gpu_0/conv1_w\" output: \"gpu_0/conv1\" name: \"\" type: \"Conv\" arg { name: \"kernel\" i: 7 } arg { name: \"exhaustive_search\" i: 0 } arg { name: \"pad\" i: 3 } arg { name: \"order\" s: \"NCHW\" } \r\narg { name: \"stride\" i: 2 } device_option { device_type: 1 cuda_gpu_id: 0 } engine: \"CUDNN\"\r\n`\r\nWhen I build the caffe2 it can find the cuda and cudnn:\r\n\r\n  89 --   USE_CUDA              : ON     \r\n  90 --     CUDA static link    : OFF\r\n  91 --     USE_CUDNN           : ON\r\n  92 --     CUDA version        : 9.1\r\n  93 --     cuDNN version       : 7.1.4\r\n  94 --     CUDA root directory : /usr/local/cuda\r\n  95 --     CUDA library        : /usr/local/cuda/lib64/stubs/libcuda.so\r\n  96 --     cudart library      : /usr/local/cuda/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\r\n  97 --     cublas library      : /usr/local/cuda/lib64/libcublas.so;/usr/local/cuda/lib64/libcublas_device.a\r\n  98 --     cufft library       : /usr/local/cuda/lib64/libcufft.so\r\n  99 --     curand library      : /usr/local/cuda/lib64/libcurand.so\r\n 100 --     cuDNN library       : /usr/local/cuda/lib64/libcudnn.so\r\n 101 --     nvrtc               : /usr/local/cuda/lib64/libnvrtc.so\r\n 102 --     CUDA include path   : /usr/local/cuda/include\r\n 103 --     NVCC executable     : /usr/local/cuda/bin/nvcc\r\n 104 --     CUDA host compiler  : /usr/bin/cc\r\n\r\n\r\n## System Info\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n- PyTorch or Caffe2:caffe2\r\n- How you installed PyTorch (conda, pip, source):source\r\n- Build command you used (if compiling from source):cmake .. &&make install DESTDIR=path/to/my/caffe2\r\n- OS:ubuntu16\r\n- Python version:2.7\r\n- CUDA/cuDNN version:9.1/7\r\n- GPU:titan x\r\n- GCC version (if compiling from source):5.4.0\r\n- CMake version:3.5.1\r\n\r\n"}