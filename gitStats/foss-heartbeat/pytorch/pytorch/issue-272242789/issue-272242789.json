{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3566", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3566/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3566/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3566/events", "html_url": "https://github.com/pytorch/pytorch/pull/3566", "id": 272242789, "node_id": "MDExOlB1bGxSZXF1ZXN0MTUxNDE1NTUz", "number": 3566, "title": "Fix cuda symeig", "user": {"login": "zou3519", "id": 5652049, "node_id": "MDQ6VXNlcjU2NTIwNDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/5652049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zou3519", "html_url": "https://github.com/zou3519", "followers_url": "https://api.github.com/users/zou3519/followers", "following_url": "https://api.github.com/users/zou3519/following{/other_user}", "gists_url": "https://api.github.com/users/zou3519/gists{/gist_id}", "starred_url": "https://api.github.com/users/zou3519/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zou3519/subscriptions", "organizations_url": "https://api.github.com/users/zou3519/orgs", "repos_url": "https://api.github.com/users/zou3519/repos", "events_url": "https://api.github.com/users/zou3519/events{/privacy}", "received_events_url": "https://api.github.com/users/zou3519/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 742585577, "node_id": "MDU6TGFiZWw3NDI1ODU1Nzc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/0.3", "name": "0.3", "color": "d1c41b", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-11-08T15:37:04Z", "updated_at": "2018-11-23T15:36:14Z", "closed_at": "2017-11-09T01:20:15Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/3566", "html_url": "https://github.com/pytorch/pytorch/pull/3566", "diff_url": "https://github.com/pytorch/pytorch/pull/3566.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/3566.patch"}, "body_html": "<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #3563.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"272168564\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3563\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/3563/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/3563\">#3563</a>.</p>\n<p>The bug is that not enough space was being allocated for the workspace, causing some undefined behavior.</p>\n<h3>Test Plan</h3>\n<p>Run the code that previously produced a CUBLAS memory mapping error and assert that it doesn't anymore.</p>\n<pre><code>import torch\n\nsize = 129\nprint('generating random symmetric matrix {0:}x{0:} on gpu'.format(size))\na = torch.randn(size, size)\ncov = torch.mm(a, a.transpose(1,0))\ntcov = torch.Tensor(cov).cuda()\nprint('computing symmetric eigenvectors')\nteigval, teigvec = torch.symeig(tcov, eigenvectors=True)\nprint('first 5 eigenvals')\nprint(teigval[None,:5])\nprint('---')\n</code></pre>\n<p>Added a unit test for symeig. It has a small case (3x3) and a large case (257 x 257). Ran it on pytorch with magma and without magma to test the HAS_MAGMA flag.</p>", "body_text": "Fixes #3563.\nThe bug is that not enough space was being allocated for the workspace, causing some undefined behavior.\nTest Plan\nRun the code that previously produced a CUBLAS memory mapping error and assert that it doesn't anymore.\nimport torch\n\nsize = 129\nprint('generating random symmetric matrix {0:}x{0:} on gpu'.format(size))\na = torch.randn(size, size)\ncov = torch.mm(a, a.transpose(1,0))\ntcov = torch.Tensor(cov).cuda()\nprint('computing symmetric eigenvectors')\nteigval, teigvec = torch.symeig(tcov, eigenvectors=True)\nprint('first 5 eigenvals')\nprint(teigval[None,:5])\nprint('---')\n\nAdded a unit test for symeig. It has a small case (3x3) and a large case (257 x 257). Ran it on pytorch with magma and without magma to test the HAS_MAGMA flag.", "body": "Fixes #3563.\r\n\r\nThe bug is that not enough space was being allocated for the workspace, causing some undefined behavior.\r\n\r\n### Test Plan\r\nRun the code that previously produced a CUBLAS memory mapping error and assert that it doesn't anymore.\r\n```\r\nimport torch\r\n\r\nsize = 129\r\nprint('generating random symmetric matrix {0:}x{0:} on gpu'.format(size))\r\na = torch.randn(size, size)\r\ncov = torch.mm(a, a.transpose(1,0))\r\ntcov = torch.Tensor(cov).cuda()\r\nprint('computing symmetric eigenvectors')\r\nteigval, teigvec = torch.symeig(tcov, eigenvectors=True)\r\nprint('first 5 eigenvals')\r\nprint(teigval[None,:5])\r\nprint('---')\r\n```\r\n\r\nAdded a unit test for symeig. It has a small case (3x3) and a large case (257 x 257). Ran it on pytorch with magma and without magma to test the HAS_MAGMA flag."}