{"url": "https://api.github.com/repos/pytorch/pytorch/issues/686", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/686/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/686/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/686/events", "html_url": "https://github.com/pytorch/pytorch/issues/686", "id": 205435770, "node_id": "MDU6SXNzdWUyMDU0MzU3NzA=", "number": 686, "title": "cuda runtime error (8) : invalid device function - adding cuda tensors", "user": {"login": "YDYordanov", "id": 22559852, "node_id": "MDQ6VXNlcjIyNTU5ODUy", "avatar_url": "https://avatars2.githubusercontent.com/u/22559852?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YDYordanov", "html_url": "https://github.com/YDYordanov", "followers_url": "https://api.github.com/users/YDYordanov/followers", "following_url": "https://api.github.com/users/YDYordanov/following{/other_user}", "gists_url": "https://api.github.com/users/YDYordanov/gists{/gist_id}", "starred_url": "https://api.github.com/users/YDYordanov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YDYordanov/subscriptions", "organizations_url": "https://api.github.com/users/YDYordanov/orgs", "repos_url": "https://api.github.com/users/YDYordanov/repos", "events_url": "https://api.github.com/users/YDYordanov/events{/privacy}", "received_events_url": "https://api.github.com/users/YDYordanov/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2017-02-05T16:31:42Z", "updated_at": "2018-05-07T17:37:54Z", "closed_at": "2017-02-06T06:35:06Z", "author_association": "NONE", "body_html": "<p>Newly installed PyTorch in Conda; CUDA is available, but outputs error on simple cuda tensor addition:</p>\n<pre><code>print(torch.cuda.is_available())\n\nx = torch.rand(5, 3)\ny = torch.rand(5, 3)\nx = x.cuda()\ny = y.cuda()\nx + y\n</code></pre>\n<pre><code>True\n\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-7-91eb0104733f&gt; in &lt;module&gt;()\n      5 x = x.cuda()\n      6 y = y.cuda()\n----&gt; 7 x+y\n\n/home/scratch/root/anaconda3/lib/python3.5/site-packages/torch/tensor.py in __add__(self, other)\n    395     # TODO: add tests for operators\n    396     def __add__(self, other):\n--&gt; 397         return self.add(other)\n    398     __radd__ = __add__\n    399 \n\nRuntimeError: cuda runtime error (8) : invalid device function at /data/users/soumith/miniconda2/conda-bld/pytorch-cuda80-0.1.8_1486040640754/work/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:246\n\n</code></pre>\n<p>About my system: Functioning CUDA 8.0 with GPU NVIDIA GeForce GT 720M</p>", "body_text": "Newly installed PyTorch in Conda; CUDA is available, but outputs error on simple cuda tensor addition:\nprint(torch.cuda.is_available())\n\nx = torch.rand(5, 3)\ny = torch.rand(5, 3)\nx = x.cuda()\ny = y.cuda()\nx + y\n\nTrue\n\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-7-91eb0104733f> in <module>()\n      5 x = x.cuda()\n      6 y = y.cuda()\n----> 7 x+y\n\n/home/scratch/root/anaconda3/lib/python3.5/site-packages/torch/tensor.py in __add__(self, other)\n    395     # TODO: add tests for operators\n    396     def __add__(self, other):\n--> 397         return self.add(other)\n    398     __radd__ = __add__\n    399 \n\nRuntimeError: cuda runtime error (8) : invalid device function at /data/users/soumith/miniconda2/conda-bld/pytorch-cuda80-0.1.8_1486040640754/work/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:246\n\n\nAbout my system: Functioning CUDA 8.0 with GPU NVIDIA GeForce GT 720M", "body": "Newly installed PyTorch in Conda; CUDA is available, but outputs error on simple cuda tensor addition:\r\n\r\n```\r\nprint(torch.cuda.is_available())\r\n\r\nx = torch.rand(5, 3)\r\ny = torch.rand(5, 3)\r\nx = x.cuda()\r\ny = y.cuda()\r\nx + y\r\n```\r\n\r\n\r\n```\r\nTrue\r\n\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-7-91eb0104733f> in <module>()\r\n      5 x = x.cuda()\r\n      6 y = y.cuda()\r\n----> 7 x+y\r\n\r\n/home/scratch/root/anaconda3/lib/python3.5/site-packages/torch/tensor.py in __add__(self, other)\r\n    395     # TODO: add tests for operators\r\n    396     def __add__(self, other):\r\n--> 397         return self.add(other)\r\n    398     __radd__ = __add__\r\n    399 \r\n\r\nRuntimeError: cuda runtime error (8) : invalid device function at /data/users/soumith/miniconda2/conda-bld/pytorch-cuda80-0.1.8_1486040640754/work/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:246\r\n\r\n```\r\n\r\nAbout my system: Functioning CUDA 8.0 with GPU NVIDIA GeForce GT 720M"}