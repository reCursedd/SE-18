{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10117", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10117/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10117/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10117/events", "html_url": "https://github.com/pytorch/pytorch/issues/10117", "id": 346558841, "node_id": "MDU6SXNzdWUzNDY1NTg4NDE=", "number": 10117, "title": "Build fails on Ubuntu 16.04: CTCLoss with CUDNN 6", "user": {"login": "themightyoarfish", "id": 11613312, "node_id": "MDQ6VXNlcjExNjEzMzEy", "avatar_url": "https://avatars0.githubusercontent.com/u/11613312?v=4", "gravatar_id": "", "url": "https://api.github.com/users/themightyoarfish", "html_url": "https://github.com/themightyoarfish", "followers_url": "https://api.github.com/users/themightyoarfish/followers", "following_url": "https://api.github.com/users/themightyoarfish/following{/other_user}", "gists_url": "https://api.github.com/users/themightyoarfish/gists{/gist_id}", "starred_url": "https://api.github.com/users/themightyoarfish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/themightyoarfish/subscriptions", "organizations_url": "https://api.github.com/users/themightyoarfish/orgs", "repos_url": "https://api.github.com/users/themightyoarfish/repos", "events_url": "https://api.github.com/users/themightyoarfish/events{/privacy}", "received_events_url": "https://api.github.com/users/themightyoarfish/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2018-08-01T11:25:08Z", "updated_at": "2018-09-05T08:46:16Z", "closed_at": "2018-08-01T18:31:30Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I have checked out <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/6f6a1f2d638f5f989786e45b5850b8d3ac4b4048/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/6f6a1f2d638f5f989786e45b5850b8d3ac4b4048\"><tt>6f6a1f2</tt></a>. I have a conda env in which all requirements are installed as per <code>Readme.md</code>. Among those are CUDA 8 and CUDNN 6 and Python 3.6.5. I have built previous commits successfully (haven't tried in the past weeks).<br>\nRunning <code>python setup.py install</code> yields</p>\n<pre><code>[\u2026]\n[ 78%] Building CXX object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/ATen/SparseCUDAShortType.cpp.o\n[ 78%] Linking CXX shared library ../lib/libcaffe2_gpu.so\n[ 80%] Built target caffe2_gpu\n[ 80%] Linking CXX executable ../bin/broadcast_test\n[ 80%] Linking CXX executable ../bin/basic\n[ 81%] Linking CXX executable ../bin/atest\n[ 82%] Linking CXX executable ../bin/half_test\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/basic.dir/build.make:98: recipe for target 'bin/basic' failed\nmake[2]: *** [bin/basic] Error 1\nCMakeFiles/Makefile2:943: recipe for target 'caffe2/CMakeFiles/basic.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/basic.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/half_test.dir/build.make:98: recipe for target 'bin/half_test' failed\nmake[2]: *** [bin/half_test] Error 1\nmake[2]: *** [bin/half_test] Error 1\nCMakeFiles/Makefile2:865: recipe for target 'caffe2/CMakeFiles/half_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/half_test.dir/all] Error 2\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference /tohome /`share/cudnnSetConvolutionMathTypesoftware'/\nsources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'collect2: error: ld returned 1 exit status\n\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/broadcast_test.dir/build.make:98: recipe for target 'bin/broadcast_test' failed\nmake[2]: *** [bin/broadcast_test] Error 1\nCMakeFiles/Makefile2:982: recipe for target 'caffe2/CMakeFiles/broadcast_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/broadcast_test.dir/all] Error 2\ncaffe2/CMakeFiles/atest.dir/build.make:98: recipe for target 'bin/atest' failed\nmake[2]: *** [bin/atest] Error 1\nCMakeFiles/Makefile2:904: recipe for target 'caffe2/CMakeFiles/atest.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/atest.dir/all] Error 2\nMakefile:140: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'\n</code></pre>\n<p>I tried running <code>python setup_caffe2.py install</code> first (which is not documented). This changes the errors to</p>\n<pre><code>[\u2026]\n[ 94%] Linking CXX executable ../bin/apply_test\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/integer_divider_test.dir/build.make:464: recipe for target 'bin/integer_divider_test' failed\nmake[2]: *** [bin/integer_divider_test] Error 1\nCMakeFiles/Makefile2:952: recipe for target 'caffe2/CMakeFiles/integer_divider_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/integer_divider_test.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/tbb_init_test.dir/build.make:98: recipe for target 'bin/tbb_init_test' failed\nmake[2]: *** [bin/tbb_init_test] Error 1\nCMakeFiles/Makefile2:991: recipe for target 'caffe2/CMakeFiles/tbb_init_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/tbb_init_test.dir/all] Error 2\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/cudnn_test.dir/build.make:100: recipe for target 'bin/cudnn_test' failed\nmake[2]: *** [bin/cudnn_test] Error 1\nCMakeFiles/Makefile2:1030: recipe for target 'caffe2/CMakeFiles/cudnn_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/cudnn_test.dir/all] Error 2\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/apply_test.dir/build.make:100: recipe for target 'bin/apply_test' failed\nmake[2]: *** [bin/apply_test] Error 1\nCMakeFiles/Makefile2:913: recipe for target 'caffe2/CMakeFiles/apply_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/apply_test.dir/all] Error 2\nMakefile:140: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'\n</code></pre>", "body_text": "I have checked out 6f6a1f2. I have a conda env in which all requirements are installed as per Readme.md. Among those are CUDA 8 and CUDNN 6 and Python 3.6.5. I have built previous commits successfully (haven't tried in the past weeks).\nRunning python setup.py install yields\n[\u2026]\n[ 78%] Building CXX object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/ATen/SparseCUDAShortType.cpp.o\n[ 78%] Linking CXX shared library ../lib/libcaffe2_gpu.so\n[ 80%] Built target caffe2_gpu\n[ 80%] Linking CXX executable ../bin/broadcast_test\n[ 80%] Linking CXX executable ../bin/basic\n[ 81%] Linking CXX executable ../bin/atest\n[ 82%] Linking CXX executable ../bin/half_test\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/basic.dir/build.make:98: recipe for target 'bin/basic' failed\nmake[2]: *** [bin/basic] Error 1\nCMakeFiles/Makefile2:943: recipe for target 'caffe2/CMakeFiles/basic.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/basic.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/half_test.dir/build.make:98: recipe for target 'bin/half_test' failed\nmake[2]: *** [bin/half_test] Error 1\nmake[2]: *** [bin/half_test] Error 1\nCMakeFiles/Makefile2:865: recipe for target 'caffe2/CMakeFiles/half_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/half_test.dir/all] Error 2\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference /tohome /`share/cudnnSetConvolutionMathTypesoftware'/\nsources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'collect2: error: ld returned 1 exit status\n\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/broadcast_test.dir/build.make:98: recipe for target 'bin/broadcast_test' failed\nmake[2]: *** [bin/broadcast_test] Error 1\nCMakeFiles/Makefile2:982: recipe for target 'caffe2/CMakeFiles/broadcast_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/broadcast_test.dir/all] Error 2\ncaffe2/CMakeFiles/atest.dir/build.make:98: recipe for target 'bin/atest' failed\nmake[2]: *** [bin/atest] Error 1\nCMakeFiles/Makefile2:904: recipe for target 'caffe2/CMakeFiles/atest.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/atest.dir/all] Error 2\nMakefile:140: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'\n\nI tried running python setup_caffe2.py install first (which is not documented). This changes the errors to\n[\u2026]\n[ 94%] Linking CXX executable ../bin/apply_test\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/integer_divider_test.dir/build.make:464: recipe for target 'bin/integer_divider_test' failed\nmake[2]: *** [bin/integer_divider_test] Error 1\nCMakeFiles/Makefile2:952: recipe for target 'caffe2/CMakeFiles/integer_divider_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/integer_divider_test.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/tbb_init_test.dir/build.make:98: recipe for target 'bin/tbb_init_test' failed\nmake[2]: *** [bin/tbb_init_test] Error 1\nCMakeFiles/Makefile2:991: recipe for target 'caffe2/CMakeFiles/tbb_init_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/tbb_init_test.dir/all] Error 2\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/cudnn_test.dir/build.make:100: recipe for target 'bin/cudnn_test' failed\nmake[2]: *** [bin/cudnn_test] Error 1\nCMakeFiles/Makefile2:1030: recipe for target 'caffe2/CMakeFiles/cudnn_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/cudnn_test.dir/all] Error 2\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\ncollect2: error: ld returned 1 exit status\ncaffe2/CMakeFiles/apply_test.dir/build.make:100: recipe for target 'bin/apply_test' failed\nmake[2]: *** [bin/apply_test] Error 1\nCMakeFiles/Makefile2:913: recipe for target 'caffe2/CMakeFiles/apply_test.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/apply_test.dir/all] Error 2\nMakefile:140: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'", "body": "I have checked out 6f6a1f2d638f5f989786e45b5850b8d3ac4b4048. I have a conda env in which all requirements are installed as per `Readme.md`. Among those are CUDA 8 and CUDNN 6 and Python 3.6.5. I have built previous commits successfully (haven't tried in the past weeks).\r\nRunning `python setup.py install` yields\r\n```\r\n[\u2026]\r\n[ 78%] Building CXX object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/ATen/SparseCUDAShortType.cpp.o\r\n[ 78%] Linking CXX shared library ../lib/libcaffe2_gpu.so\r\n[ 80%] Built target caffe2_gpu\r\n[ 80%] Linking CXX executable ../bin/broadcast_test\r\n[ 80%] Linking CXX executable ../bin/basic\r\n[ 81%] Linking CXX executable ../bin/atest\r\n[ 82%] Linking CXX executable ../bin/half_test\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/basic.dir/build.make:98: recipe for target 'bin/basic' failed\r\nmake[2]: *** [bin/basic] Error 1\r\nCMakeFiles/Makefile2:943: recipe for target 'caffe2/CMakeFiles/basic.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/basic.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/half_test.dir/build.make:98: recipe for target 'bin/half_test' failed\r\nmake[2]: *** [bin/half_test] Error 1\r\nmake[2]: *** [bin/half_test] Error 1\r\nCMakeFiles/Makefile2:865: recipe for target 'caffe2/CMakeFiles/half_test.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/half_test.dir/all] Error 2\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference /tohome /`share/cudnnSetConvolutionMathTypesoftware'/\r\nsources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnDestroyCTCLossDescriptor'collect2: error: ld returned 1 exit status\r\n\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCreateCTCLossDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnGetCTCLossWorkspaceSize'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnCTCLoss'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/broadcast_test.dir/build.make:98: recipe for target 'bin/broadcast_test' failed\r\nmake[2]: *** [bin/broadcast_test] Error 1\r\nCMakeFiles/Makefile2:982: recipe for target 'caffe2/CMakeFiles/broadcast_test.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/broadcast_test.dir/all] Error 2\r\ncaffe2/CMakeFiles/atest.dir/build.make:98: recipe for target 'bin/atest' failed\r\nmake[2]: *** [bin/atest] Error 1\r\nCMakeFiles/Makefile2:904: recipe for target 'caffe2/CMakeFiles/atest.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/atest.dir/all] Error 2\r\nMakefile:140: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'\r\n```\r\n\r\nI tried running `python setup_caffe2.py install` first (which is not documented). This changes the errors to\r\n```\r\n[\u2026]\r\n[ 94%] Linking CXX executable ../bin/apply_test\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/integer_divider_test.dir/build.make:464: recipe for target 'bin/integer_divider_test' failed\r\nmake[2]: *** [bin/integer_divider_test] Error 1\r\nCMakeFiles/Makefile2:952: recipe for target 'caffe2/CMakeFiles/integer_divider_test.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/integer_divider_test.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/tbb_init_test.dir/build.make:98: recipe for target 'bin/tbb_init_test' failed\r\nmake[2]: *** [bin/tbb_init_test] Error 1\r\nCMakeFiles/Makefile2:991: recipe for target 'caffe2/CMakeFiles/tbb_init_test.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/tbb_init_test.dir/all] Error 2\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/cudnn_test.dir/build.make:100: recipe for target 'bin/cudnn_test' failed\r\nmake[2]: *** [bin/cudnn_test] Error 1\r\nCMakeFiles/Makefile2:1030: recipe for target 'caffe2/CMakeFiles/cudnn_test.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/cudnn_test.dir/all] Error 2\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnRestoreDropoutDescriptor'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionGroupCount'\r\n/home/share/software/sources/pytorch/build/lib/libcaffe2_gpu.so: undefined reference to `cudnnSetConvolutionMathType'\r\ncollect2: error: ld returned 1 exit status\r\ncaffe2/CMakeFiles/apply_test.dir/build.make:100: recipe for target 'bin/apply_test' failed\r\nmake[2]: *** [bin/apply_test] Error 1\r\nCMakeFiles/Makefile2:913: recipe for target 'caffe2/CMakeFiles/apply_test.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/apply_test.dir/all] Error 2\r\nMakefile:140: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn nccl caffe2 nanopb libshm gloo THD c10d'\r\n```\r\n"}