{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1608", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1608/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1608/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1608/events", "html_url": "https://github.com/pytorch/pytorch/issues/1608", "id": 230302889, "node_id": "MDU6SXNzdWUyMzAzMDI4ODk=", "number": 1608, "title": "torch.cuda.device not working but torch.cuda.set_device works", "user": {"login": "SelvamArul", "id": 7311434, "node_id": "MDQ6VXNlcjczMTE0MzQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/7311434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SelvamArul", "html_url": "https://github.com/SelvamArul", "followers_url": "https://api.github.com/users/SelvamArul/followers", "following_url": "https://api.github.com/users/SelvamArul/following{/other_user}", "gists_url": "https://api.github.com/users/SelvamArul/gists{/gist_id}", "starred_url": "https://api.github.com/users/SelvamArul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SelvamArul/subscriptions", "organizations_url": "https://api.github.com/users/SelvamArul/orgs", "repos_url": "https://api.github.com/users/SelvamArul/repos", "events_url": "https://api.github.com/users/SelvamArul/events{/privacy}", "received_events_url": "https://api.github.com/users/SelvamArul/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-05-22T07:08:48Z", "updated_at": "2018-07-26T09:06:00Z", "closed_at": "2017-05-22T07:40:42Z", "author_association": "NONE", "body_html": "<p>I have four GPU cards:</p>\n<pre><code>import torch as th\n\nprint ('Available devices ', th.cuda.device_count())\nprint ('Current cuda device ', th.cuda.current_device())\n</code></pre>\n<pre><code>Available devices  4\nCurrent cuda device  0\n</code></pre>\n<p>When I use <code>torch.cuda.device</code> to set GPU device, the current device remains the same. Whereas when I use <code>torch.cuda.set_device</code> ,  it works:</p>\n<pre><code>for i in range(1,4):\n    print ('set device (th.cuda.device)--&gt;{}'.format(i))\n    th.cuda.device(i)\n    print ('Current cuda device ' ,th.cuda.current_device())\n\n    print ('set device (th.cuda.set_device)--&gt;{}'.format(i))\n    th.cuda.set_device(i)\n    print ('Current cuda device ' ,th.cuda.current_device())\n    print ('--------------------')\n</code></pre>\n<pre><code>set device (th.cuda.device)--&gt;1\nCurrent cuda device  0\nset device (th.cuda.set_device)--&gt;1\nCurrent cuda device  1\n--------------------\nset device (th.cuda.device)--&gt;2\nCurrent cuda device  1\nset device (th.cuda.set_device)--&gt;2\nCurrent cuda device  2\n--------------------\nset device (th.cuda.device)--&gt;3\nCurrent cuda device  2\nset device (th.cuda.set_device)--&gt;3\nCurrent cuda device  3\n--------------------\n</code></pre>", "body_text": "I have four GPU cards:\nimport torch as th\n\nprint ('Available devices ', th.cuda.device_count())\nprint ('Current cuda device ', th.cuda.current_device())\n\nAvailable devices  4\nCurrent cuda device  0\n\nWhen I use torch.cuda.device to set GPU device, the current device remains the same. Whereas when I use torch.cuda.set_device ,  it works:\nfor i in range(1,4):\n    print ('set device (th.cuda.device)-->{}'.format(i))\n    th.cuda.device(i)\n    print ('Current cuda device ' ,th.cuda.current_device())\n\n    print ('set device (th.cuda.set_device)-->{}'.format(i))\n    th.cuda.set_device(i)\n    print ('Current cuda device ' ,th.cuda.current_device())\n    print ('--------------------')\n\nset device (th.cuda.device)-->1\nCurrent cuda device  0\nset device (th.cuda.set_device)-->1\nCurrent cuda device  1\n--------------------\nset device (th.cuda.device)-->2\nCurrent cuda device  1\nset device (th.cuda.set_device)-->2\nCurrent cuda device  2\n--------------------\nset device (th.cuda.device)-->3\nCurrent cuda device  2\nset device (th.cuda.set_device)-->3\nCurrent cuda device  3\n--------------------", "body": "I have four GPU cards:\r\n```\r\nimport torch as th\r\n\r\nprint ('Available devices ', th.cuda.device_count())\r\nprint ('Current cuda device ', th.cuda.current_device())\r\n```\r\n\r\n\r\n```\r\nAvailable devices  4\r\nCurrent cuda device  0\r\n```\r\n\r\n\r\nWhen I use `torch.cuda.device` to set GPU device, the current device remains the same. Whereas when I use `torch.cuda.set_device` ,  it works:\r\n\r\n```\r\nfor i in range(1,4):\r\n    print ('set device (th.cuda.device)-->{}'.format(i))\r\n    th.cuda.device(i)\r\n    print ('Current cuda device ' ,th.cuda.current_device())\r\n\r\n    print ('set device (th.cuda.set_device)-->{}'.format(i))\r\n    th.cuda.set_device(i)\r\n    print ('Current cuda device ' ,th.cuda.current_device())\r\n    print ('--------------------')\r\n```\r\n\r\n\r\n```\r\nset device (th.cuda.device)-->1\r\nCurrent cuda device  0\r\nset device (th.cuda.set_device)-->1\r\nCurrent cuda device  1\r\n--------------------\r\nset device (th.cuda.device)-->2\r\nCurrent cuda device  1\r\nset device (th.cuda.set_device)-->2\r\nCurrent cuda device  2\r\n--------------------\r\nset device (th.cuda.device)-->3\r\nCurrent cuda device  2\r\nset device (th.cuda.set_device)-->3\r\nCurrent cuda device  3\r\n--------------------\r\n```\r\n"}