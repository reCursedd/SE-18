{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2773", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2773/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2773/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2773/events", "html_url": "https://github.com/pytorch/pytorch/issues/2773", "id": 258442490, "node_id": "MDU6SXNzdWUyNTg0NDI0OTA=", "number": 2773, "title": "How to load a saved a model then keep training it?", "user": {"login": "ankanch", "id": 3401944, "node_id": "MDQ6VXNlcjM0MDE5NDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/3401944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ankanch", "html_url": "https://github.com/ankanch", "followers_url": "https://api.github.com/users/ankanch/followers", "following_url": "https://api.github.com/users/ankanch/following{/other_user}", "gists_url": "https://api.github.com/users/ankanch/gists{/gist_id}", "starred_url": "https://api.github.com/users/ankanch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ankanch/subscriptions", "organizations_url": "https://api.github.com/users/ankanch/orgs", "repos_url": "https://api.github.com/users/ankanch/repos", "events_url": "https://api.github.com/users/ankanch/events{/privacy}", "received_events_url": "https://api.github.com/users/ankanch/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-09-18T11:09:19Z", "updated_at": "2017-09-19T05:12:51Z", "closed_at": "2017-09-18T14:34:57Z", "author_association": "NONE", "body_html": "<p>I have saved my model via <code>torch.save(cnn4mnist, 'cnn4mnist.pt')</code>, and load it by <code>model = torch.load('cnn4mnist.pt')</code>. Now I want to keep training it . There for I write code like this ::</p>\n<pre><code>model = torch.load('cnn4mnist.pt')\ncriterion = nn.MSELoss()\noptimizer = optim.SGD(model, lr=0.01)\nprint(model)\nbatch_size = 300\ncross_vaild = 0.2\n\nepoches = 5\nfor i in range(epoches):\n......\n</code></pre>\n<p>The error <code>TypeError: 'CNN4MNIST' object is not iterable</code> occured. And I find it was caused by this line <code>optimizer = optim.SGD(model, lr=0.01)</code>, my question is how do I get the optimizer of the trained model, or how can I assign a new optimizer to <code>model</code>?</p>", "body_text": "I have saved my model via torch.save(cnn4mnist, 'cnn4mnist.pt'), and load it by model = torch.load('cnn4mnist.pt'). Now I want to keep training it . There for I write code like this ::\nmodel = torch.load('cnn4mnist.pt')\ncriterion = nn.MSELoss()\noptimizer = optim.SGD(model, lr=0.01)\nprint(model)\nbatch_size = 300\ncross_vaild = 0.2\n\nepoches = 5\nfor i in range(epoches):\n......\n\nThe error TypeError: 'CNN4MNIST' object is not iterable occured. And I find it was caused by this line optimizer = optim.SGD(model, lr=0.01), my question is how do I get the optimizer of the trained model, or how can I assign a new optimizer to model?", "body": "I have saved my model via `torch.save(cnn4mnist, 'cnn4mnist.pt')`, and load it by `model = torch.load('cnn4mnist.pt')`. Now I want to keep training it . There for I write code like this ::\r\n\r\n```\r\nmodel = torch.load('cnn4mnist.pt')\r\ncriterion = nn.MSELoss()\r\noptimizer = optim.SGD(model, lr=0.01)\r\nprint(model)\r\nbatch_size = 300\r\ncross_vaild = 0.2\r\n\r\nepoches = 5\r\nfor i in range(epoches):\r\n......\r\n```\r\n\r\nThe error `TypeError: 'CNN4MNIST' object is not iterable` occured. And I find it was caused by this line `optimizer = optim.SGD(model, lr=0.01)`, my question is how do I get the optimizer of the trained model, or how can I assign a new optimizer to `model`?"}