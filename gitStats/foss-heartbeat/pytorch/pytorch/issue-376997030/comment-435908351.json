{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/435908351", "html_url": "https://github.com/pytorch/pytorch/pull/13529#issuecomment-435908351", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13529", "id": 435908351, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTkwODM1MQ==", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-05T15:07:49Z", "updated_at": "2018-11-05T15:07:49Z", "author_association": "CONTRIBUTOR", "body_html": "<blockquote>\n<p>I'm not ready to move Half yet (since it has a dependency on CUDA and HIP).</p>\n</blockquote>\n<p>Not quite.</p>\n<p>The dependency here is quite special:</p>\n<pre><code>#ifdef __CUDACC__\n#include &lt;cuda_fp16.h&gt;\n#endif\n\n#ifdef __HIPCC__\n#include &lt;hip/hip_fp16.h&gt;\n#endif\n</code></pre>\n<p>These ifdefs are not toggling on \"build with CUDA support\" or not. What they are doing is saying, \"If you compile this header with the CUDA nvcc compiler, please also include the header here.\" So there is no build-time dependency on CUDA; it's purely levied on any downstream user who includes this header from a 'cu' file. You should just move half instead of doing this patch.</p>", "body_text": "I'm not ready to move Half yet (since it has a dependency on CUDA and HIP).\n\nNot quite.\nThe dependency here is quite special:\n#ifdef __CUDACC__\n#include <cuda_fp16.h>\n#endif\n\n#ifdef __HIPCC__\n#include <hip/hip_fp16.h>\n#endif\n\nThese ifdefs are not toggling on \"build with CUDA support\" or not. What they are doing is saying, \"If you compile this header with the CUDA nvcc compiler, please also include the header here.\" So there is no build-time dependency on CUDA; it's purely levied on any downstream user who includes this header from a 'cu' file. You should just move half instead of doing this patch.", "body": "> I'm not ready to move Half yet (since it has a dependency on CUDA and HIP).\r\n\r\nNot quite.\r\n\r\nThe dependency here is quite special:\r\n\r\n```\r\n#ifdef __CUDACC__\r\n#include <cuda_fp16.h>\r\n#endif\r\n\r\n#ifdef __HIPCC__\r\n#include <hip/hip_fp16.h>\r\n#endif\r\n```\r\n\r\nThese ifdefs are not toggling on \"build with CUDA support\" or not. What they are doing is saying, \"If you compile this header with the CUDA nvcc compiler, please also include the header here.\" So there is no build-time dependency on CUDA; it's purely levied on any downstream user who includes this header from a 'cu' file. You should just move half instead of doing this patch."}