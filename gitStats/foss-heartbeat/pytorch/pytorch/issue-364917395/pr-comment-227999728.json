{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/227999728", "pull_request_review_id": 168167900, "id": 227999728, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNzk5OTcyOA==", "diff_hunk": "@@ -1,32 +1,115 @@\n # - Try to find MKLDNN\n #\n # The following variables are optionally searched for defaults\n-#  MKLDNN_ROOT_DIR:            Base directory where all MKLDNN components are found\n+#  MKL_FOUND             : set to true if a library implementing the CBLAS interface is found\n+#  USE_MKLDNN\n #\n # The following are set after configuration is done:\n-#  MKLDNN_FOUND\n-#  MKLDNN_INCLUDE_DIRS\n-#  MKLDNN_LIBRARIES\n-#  MKLDNN_LIBRARY_DIRS\n+#  MKLDNN_FOUND          : set to true if mkl-dnn is found.\n+#  MKLDNN_INCLUDE_DIR    : path to mkl-dnn include dir.\n+#  MKLDNN_LIBRARIES      : list of libraries for mkl-dnn\n \n-include(FindPackageHandleStandardArgs)\n+IF (NOT MKLDNN_FOUND)\n \n-set(MKLDNN_ROOT_DIR \"\" CACHE PATH \"Folder contains Intel MKLDNN\")\n+SET(MKLDNN_LIBRARIES)\n+SET(MKLDNN_INCLUDE_DIR)\n \n-find_path(MKLDNN_INCLUDE_DIR mkldnn.h\n-    HINTS ${MKLDNN_ROOT_DIR}\n-    PATH_SUFFIXES include)\n+IF (NOT USE_MKLDNN)\n+  RETURN()\n+ENDIF(NOT USE_MKLDNN)\n \n-find_library(MKLDNN_LIBRARY mkldnn\n-    HINTS ${MKLDNN_LIB_DIR} ${MKLDNN_ROOT_DIR}\n-    PATH_SUFFIXES lib lib64)\n+IF(MSVC)\n+  MESSAGE(STATUS \"MKL-DNN needs omp 3+ which is not supported in MSVC so far\")\n+  RETURN()\n+ENDIF(MSVC)\n \n-find_package_handle_standard_args(\n-    MKLDNN DEFAULT_MSG MKLDNN_INCLUDE_DIR MKLDNN_LIBRARY)\n+SET(IDEEP_ROOT \"${PROJECT_SOURCE_DIR}/third_party/ideep\")\n+SET(MKLDNN_ROOT \"${IDEEP_ROOT}/mkl-dnn\")\n \n-if(MKLDNN_FOUND)\n-  set(MKLDNN_INCLUDE_DIRS ${MKLDNN_INCLUDE_DIR})\n-  set(MKLDNN_LIBRARIES ${MKLDNN_LIBRARY})\n-  message(STATUS \"Found MKLDNN      (include: ${MKLDNN_INCLUDE_DIR}, library: ${MKLDNN_LIBRARY})\")\n-  mark_as_advanced(MKLDNN_ROOT_DIR MKLDNN_LIBRARY MKLDNN_INCLUDE_DIR)\n-endif()\n+FIND_PACKAGE(BLAS)\n+FIND_PATH(IDEEP_INCLUDE_DIR ideep.hpp PATHS ${IDEEP_ROOT} PATH_SUFFIXES include)\n+FIND_PATH(MKLDNN_INCLUDE_DIR mkldnn.hpp mkldnn.h PATHS ${MKLDNN_ROOT} PATH_SUFFIXES include)\n+IF (NOT MKLDNN_INCLUDE_DIR)\n+  EXECUTE_PROCESS(COMMAND git submodule update --init mkl-dnn WORKING_DIRECTORY ${IDEEP_ROOT})", "path": "cmake/Modules/FindMKLDNN.cmake", "position": null, "original_position": 54, "commit_id": "45f15fda0f37dee7a956627c3e3c9f53a00bd73c", "original_commit_id": "b4a30e8fcd941c6f7835537b07398e093d85a7c9", "user": {"login": "orionr", "id": 79994, "node_id": "MDQ6VXNlcjc5OTk0", "avatar_url": "https://avatars3.githubusercontent.com/u/79994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/orionr", "html_url": "https://github.com/orionr", "followers_url": "https://api.github.com/users/orionr/followers", "following_url": "https://api.github.com/users/orionr/following{/other_user}", "gists_url": "https://api.github.com/users/orionr/gists{/gist_id}", "starred_url": "https://api.github.com/users/orionr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/orionr/subscriptions", "organizations_url": "https://api.github.com/users/orionr/orgs", "repos_url": "https://api.github.com/users/orionr/repos", "events_url": "https://api.github.com/users/orionr/events{/privacy}", "received_events_url": "https://api.github.com/users/orionr/received_events", "type": "User", "site_admin": false}, "body": "Would this have any problem on Windows?", "created_at": "2018-10-25T00:08:02Z", "updated_at": "2018-11-23T15:53:32Z", "html_url": "https://github.com/pytorch/pytorch/pull/12170#discussion_r227999728", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/12170", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/227999728"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/12170#discussion_r227999728"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/12170"}}, "body_html": "<p>Would this have any problem on Windows?</p>", "body_text": "Would this have any problem on Windows?"}