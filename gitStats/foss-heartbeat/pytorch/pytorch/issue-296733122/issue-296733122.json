{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5212", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5212/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5212/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5212/events", "html_url": "https://github.com/pytorch/pytorch/issues/5212", "id": 296733122, "node_id": "MDU6SXNzdWUyOTY3MzMxMjI=", "number": 5212, "title": "Weird error message in torch.split_size_or_sections", "user": {"login": "Diego999", "id": 1092464, "node_id": "MDQ6VXNlcjEwOTI0NjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1092464?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Diego999", "html_url": "https://github.com/Diego999", "followers_url": "https://api.github.com/users/Diego999/followers", "following_url": "https://api.github.com/users/Diego999/following{/other_user}", "gists_url": "https://api.github.com/users/Diego999/gists{/gist_id}", "starred_url": "https://api.github.com/users/Diego999/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Diego999/subscriptions", "organizations_url": "https://api.github.com/users/Diego999/orgs", "repos_url": "https://api.github.com/users/Diego999/repos", "events_url": "https://api.github.com/users/Diego999/events{/privacy}", "received_events_url": "https://api.github.com/users/Diego999/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-02-13T13:16:40Z", "updated_at": "2018-03-14T09:33:37Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>Hi everyone,</p>\n<p>I wanted to use the new function torch.split with a list of integer.</p>\n<p>I have a input vector of dim X (let's say 100) and a list of integer where the sum is less or equal (Y &lt;= X). If Y &lt;= X, an error is raised saying \"Sum of split sizes exceeds tensor dim\", which is not the case.</p>\n<p>`<br>\ndef split(tensor, split_size_or_sections, dim=0):</p>\n<pre><code>if dim &lt; 0:\n    dim += tensor.dim()\ndim_size = tensor.size(dim)\nif isinstance(split_size_or_sections, int):\n    split_size = split_size_or_sections\n    num_splits = (dim_size + split_size - 1) // split_size\n    last_split_size = split_size - (split_size * num_splits - dim_size)\n\n    def get_split_size(i):\n        return split_size if i &lt; num_splits - 1 else last_split_size\n    return tuple(tensor.narrow(int(dim), int(i * split_size), int(get_split_size(i))) for i\n                 in range(0, num_splits))\n\nelse:\n    if dim_size != sum(split_size_or_sections):\n        raise ValueError(\"Sum of split sizes exceeds tensor dim\")\n    split_indices = [0] + split_size_or_sections\n    split_indices = torch.cumsum(torch.Tensor(split_indices), dim=0)\n\n    return tuple(\n        tensor.narrow(int(dim), int(start), int(length))\n        for start, length in zip(split_indices, split_size_or_sections))\n</code></pre>\n<p>`</p>\n<p>In this case, either we should have if dim_size &lt;= sum(split_size_or_sections), either we should split the tensor is chuncks where the sum is lower than dim_size.</p>\n<p>OS: Mac OS X<br>\nPyTorch version: From source (<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/pytorch/pytorch/commit/2b2d56d8460d335daf5aa79774442a111d424f90/hovercard\" href=\"https://github.com/pytorch/pytorch/commit/2b2d56d8460d335daf5aa79774442a111d424f90\"><tt>2b2d56d</tt></a>)<br>\nHow you installed PyTorch (conda, pip, source): pip<br>\nPython version: 3.6</p>", "body_text": "Hi everyone,\nI wanted to use the new function torch.split with a list of integer.\nI have a input vector of dim X (let's say 100) and a list of integer where the sum is less or equal (Y <= X). If Y <= X, an error is raised saying \"Sum of split sizes exceeds tensor dim\", which is not the case.\n`\ndef split(tensor, split_size_or_sections, dim=0):\nif dim < 0:\n    dim += tensor.dim()\ndim_size = tensor.size(dim)\nif isinstance(split_size_or_sections, int):\n    split_size = split_size_or_sections\n    num_splits = (dim_size + split_size - 1) // split_size\n    last_split_size = split_size - (split_size * num_splits - dim_size)\n\n    def get_split_size(i):\n        return split_size if i < num_splits - 1 else last_split_size\n    return tuple(tensor.narrow(int(dim), int(i * split_size), int(get_split_size(i))) for i\n                 in range(0, num_splits))\n\nelse:\n    if dim_size != sum(split_size_or_sections):\n        raise ValueError(\"Sum of split sizes exceeds tensor dim\")\n    split_indices = [0] + split_size_or_sections\n    split_indices = torch.cumsum(torch.Tensor(split_indices), dim=0)\n\n    return tuple(\n        tensor.narrow(int(dim), int(start), int(length))\n        for start, length in zip(split_indices, split_size_or_sections))\n\n`\nIn this case, either we should have if dim_size <= sum(split_size_or_sections), either we should split the tensor is chuncks where the sum is lower than dim_size.\nOS: Mac OS X\nPyTorch version: From source (2b2d56d)\nHow you installed PyTorch (conda, pip, source): pip\nPython version: 3.6", "body": "Hi everyone,\r\n\r\nI wanted to use the new function torch.split with a list of integer.\r\n\r\nI have a input vector of dim X (let's say 100) and a list of integer where the sum is less or equal (Y <= X). If Y <= X, an error is raised saying \"Sum of split sizes exceeds tensor dim\", which is not the case.\r\n\r\n`\r\ndef split(tensor, split_size_or_sections, dim=0):\r\n\r\n    if dim < 0:\r\n        dim += tensor.dim()\r\n    dim_size = tensor.size(dim)\r\n    if isinstance(split_size_or_sections, int):\r\n        split_size = split_size_or_sections\r\n        num_splits = (dim_size + split_size - 1) // split_size\r\n        last_split_size = split_size - (split_size * num_splits - dim_size)\r\n\r\n        def get_split_size(i):\r\n            return split_size if i < num_splits - 1 else last_split_size\r\n        return tuple(tensor.narrow(int(dim), int(i * split_size), int(get_split_size(i))) for i\r\n                     in range(0, num_splits))\r\n\r\n    else:\r\n        if dim_size != sum(split_size_or_sections):\r\n            raise ValueError(\"Sum of split sizes exceeds tensor dim\")\r\n        split_indices = [0] + split_size_or_sections\r\n        split_indices = torch.cumsum(torch.Tensor(split_indices), dim=0)\r\n\r\n        return tuple(\r\n            tensor.narrow(int(dim), int(start), int(length))\r\n            for start, length in zip(split_indices, split_size_or_sections))\r\n`\r\n\r\nIn this case, either we should have if dim_size <= sum(split_size_or_sections), either we should split the tensor is chuncks where the sum is lower than dim_size.\r\n\r\n\r\nOS: Mac OS X\r\nPyTorch version: From source (https://github.com/pytorch/pytorch/commit/2b2d56d8460d335daf5aa79774442a111d424f90)\r\nHow you installed PyTorch (conda, pip, source): pip\r\nPython version: 3.6"}