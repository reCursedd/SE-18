{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/310397437", "html_url": "https://github.com/pytorch/pytorch/issues/973#issuecomment-310397437", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/973", "id": 310397437, "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDM5NzQzNw==", "user": {"login": "soumith", "id": 1310570, "node_id": "MDQ6VXNlcjEzMTA1NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1310570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumith", "html_url": "https://github.com/soumith", "followers_url": "https://api.github.com/users/soumith/followers", "following_url": "https://api.github.com/users/soumith/following{/other_user}", "gists_url": "https://api.github.com/users/soumith/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumith/subscriptions", "organizations_url": "https://api.github.com/users/soumith/orgs", "repos_url": "https://api.github.com/users/soumith/repos", "events_url": "https://api.github.com/users/soumith/events{/privacy}", "received_events_url": "https://api.github.com/users/soumith/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-22T14:29:48Z", "updated_at": "2017-06-22T14:30:11Z", "author_association": "MEMBER", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=11032892\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/francoisfleuret\">@francoisfleuret</a> reports this issue:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">import</span> torch.multiprocessing <span class=\"pl-k\">as</span> multiprocessing\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">create_one</span>(<span class=\"pl-smi\">batch_size</span>):\n    <span class=\"pl-k\">return</span> torch.ByteTensor(batch_size, <span class=\"pl-c1\">128</span>, <span class=\"pl-c1\">128</span>)\n\npool <span class=\"pl-k\">=</span> torch.multiprocessing.Pool(torch.multiprocessing.cpu_count())\ndata <span class=\"pl-k\">=</span> pool.map(create_one, torch.LongTensor(<span class=\"pl-c1\">1000</span>).fill_(<span class=\"pl-c1\">100</span>))</pre></div>\n<p>This gives the dreaded:</p>\n<pre><code>RuntimeError: received 0 items of ancdata\n</code></pre>\n<p>The only workaround I found is to initialize:</p>\n<pre><code>pool = torch.multiprocessing.Pool(torch.multiprocessing.cpu_count(), maxtasksperchild=1)\n</code></pre>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4583066\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/apaszke\">@apaszke</a> any insights?</p>", "body_text": "@francoisfleuret reports this issue:\nimport torch\nimport torch.multiprocessing as multiprocessing\n\ndef create_one(batch_size):\n    return torch.ByteTensor(batch_size, 128, 128)\n\npool = torch.multiprocessing.Pool(torch.multiprocessing.cpu_count())\ndata = pool.map(create_one, torch.LongTensor(1000).fill_(100))\nThis gives the dreaded:\nRuntimeError: received 0 items of ancdata\n\nThe only workaround I found is to initialize:\npool = torch.multiprocessing.Pool(torch.multiprocessing.cpu_count(), maxtasksperchild=1)\n\n@apaszke any insights?", "body": "@francoisfleuret reports this issue:\r\n\r\n```python\r\nimport torch\r\nimport torch.multiprocessing as multiprocessing\r\n\r\ndef create_one(batch_size):\r\n    return torch.ByteTensor(batch_size, 128, 128)\r\n\r\npool = torch.multiprocessing.Pool(torch.multiprocessing.cpu_count())\r\ndata = pool.map(create_one, torch.LongTensor(1000).fill_(100))\r\n```\r\n\r\nThis gives the dreaded:\r\n```\r\nRuntimeError: received 0 items of ancdata\r\n```\r\n\r\nThe only workaround I found is to initialize:\r\n```\r\npool = torch.multiprocessing.Pool(torch.multiprocessing.cpu_count(), maxtasksperchild=1)\r\n```\r\n\r\n@apaszke any insights?"}