{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6610", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6610/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6610/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6610/events", "html_url": "https://github.com/pytorch/pytorch/issues/6610", "id": 314388439, "node_id": "MDU6SXNzdWUzMTQzODg0Mzk=", "number": 6610, "title": "[pytorch] nan, After Big Numbers", "user": {"login": "sherif7810", "id": 37023248, "node_id": "MDQ6VXNlcjM3MDIzMjQ4", "avatar_url": "https://avatars0.githubusercontent.com/u/37023248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sherif7810", "html_url": "https://github.com/sherif7810", "followers_url": "https://api.github.com/users/sherif7810/followers", "following_url": "https://api.github.com/users/sherif7810/following{/other_user}", "gists_url": "https://api.github.com/users/sherif7810/gists{/gist_id}", "starred_url": "https://api.github.com/users/sherif7810/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sherif7810/subscriptions", "organizations_url": "https://api.github.com/users/sherif7810/orgs", "repos_url": "https://api.github.com/users/sherif7810/repos", "events_url": "https://api.github.com/users/sherif7810/events{/privacy}", "received_events_url": "https://api.github.com/users/sherif7810/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-04-15T05:58:10Z", "updated_at": "2018-04-15T19:44:44Z", "closed_at": "2018-04-15T09:42:40Z", "author_association": "NONE", "body_html": "<p>Hi, I made a kernel for Titanic in Kaggle <a href=\"https://www.kaggle.com/sherif924/first-kernel\" rel=\"nofollow\">there</a>.</p>\n<p>The output of the model's <code>forward</code> function'd have been nan, if <code>x</code> was returned before <code>if</code>. I found that I get nan, after <code>self.fc1(x)</code>.<br>\nIt may be, because some numbers in the input vector are large.</p>\n<p>I tried using <code>torch.DoubleTensor</code> for <code>train</code> and <code>label</code> then I got:<br>\n<code>Traceback (most recent call last): File \"main.py\", line 56, in &lt;module&gt; out = model(train) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/module.py\", line 357, in __call__ result = self.forward(*input, **kwargs) File \"main.py\", line 30, in forward x = self.tanh(self.fc1(x)) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/module.py\", line 357, in __call__ result = self.forward(*input, **kwargs) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/linear.py\", line 55, in forward return F.linear(input, self.weight, self.bias) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/functional.py\", line 837, in linear output = input.matmul(weight.t()) File \"/usr/local/lib64/python3.6/site-packages/torch/autograd/variable.py\", line 386, in matmul return torch.matmul(self, other) File \"/usr/local/lib64/python3.6/site-packages/torch/functional.py\", line 169, in matmul return torch.mm(tensor1.unsqueeze(0), tensor2).squeeze_(0) RuntimeError: Expected object of type Variable[torch.DoubleTensor] but found type Variable[torch.FloatTensor] for argument #1 'mat2'</code></p>\n<ul>\n<li>PyTorch or Caffe2: PyTorch.</li>\n<li>OS: Linux (64-bit Fedora 27 with Gnome).</li>\n<li>PyTorch version: 0.3.1</li>\n<li>How you installed PyTorch (conda, pip, source): pip3.</li>\n<li>Python version: 3.6.5.</li>\n<li>I use CPU (No CUDA).</li>\n</ul>", "body_text": "Hi, I made a kernel for Titanic in Kaggle there.\nThe output of the model's forward function'd have been nan, if x was returned before if. I found that I get nan, after self.fc1(x).\nIt may be, because some numbers in the input vector are large.\nI tried using torch.DoubleTensor for train and label then I got:\nTraceback (most recent call last): File \"main.py\", line 56, in <module> out = model(train) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/module.py\", line 357, in __call__ result = self.forward(*input, **kwargs) File \"main.py\", line 30, in forward x = self.tanh(self.fc1(x)) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/module.py\", line 357, in __call__ result = self.forward(*input, **kwargs) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/linear.py\", line 55, in forward return F.linear(input, self.weight, self.bias) File \"/usr/local/lib64/python3.6/site-packages/torch/nn/functional.py\", line 837, in linear output = input.matmul(weight.t()) File \"/usr/local/lib64/python3.6/site-packages/torch/autograd/variable.py\", line 386, in matmul return torch.matmul(self, other) File \"/usr/local/lib64/python3.6/site-packages/torch/functional.py\", line 169, in matmul return torch.mm(tensor1.unsqueeze(0), tensor2).squeeze_(0) RuntimeError: Expected object of type Variable[torch.DoubleTensor] but found type Variable[torch.FloatTensor] for argument #1 'mat2'\n\nPyTorch or Caffe2: PyTorch.\nOS: Linux (64-bit Fedora 27 with Gnome).\nPyTorch version: 0.3.1\nHow you installed PyTorch (conda, pip, source): pip3.\nPython version: 3.6.5.\nI use CPU (No CUDA).", "body": "Hi, I made a kernel for Titanic in Kaggle [there](https://www.kaggle.com/sherif924/first-kernel).\r\n\r\nThe output of the model's `forward` function'd have been nan, if `x` was returned before `if`. I found that I get nan, after `self.fc1(x)`.\r\nIt may be, because some numbers in the input vector are large.\r\n\r\nI tried using `torch.DoubleTensor` for `train` and `label` then I got:\r\n`Traceback (most recent call last):\r\n  File \"main.py\", line 56, in <module>\r\n    out = model(train)\r\n  File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/module.py\", line 357, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"main.py\", line 30, in forward\r\n    x = self.tanh(self.fc1(x))\r\n  File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/module.py\", line 357, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib64/python3.6/site-packages/torch/nn/modules/linear.py\", line 55, in forward\r\n    return F.linear(input, self.weight, self.bias)\r\n  File \"/usr/local/lib64/python3.6/site-packages/torch/nn/functional.py\", line 837, in linear\r\n    output = input.matmul(weight.t())\r\n  File \"/usr/local/lib64/python3.6/site-packages/torch/autograd/variable.py\", line 386, in matmul\r\n    return torch.matmul(self, other)\r\n  File \"/usr/local/lib64/python3.6/site-packages/torch/functional.py\", line 169, in matmul\r\n    return torch.mm(tensor1.unsqueeze(0), tensor2).squeeze_(0)\r\nRuntimeError: Expected object of type Variable[torch.DoubleTensor] but found type Variable[torch.FloatTensor] for argument #1 'mat2'`\r\n\r\n- PyTorch or Caffe2: PyTorch.\r\n- OS: Linux (64-bit Fedora 27 with Gnome).\r\n- PyTorch version: 0.3.1\r\n- How you installed PyTorch (conda, pip, source): pip3.\r\n- Python version: 3.6.5.\r\n- I use CPU (No CUDA)."}