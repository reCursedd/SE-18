{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/435157475", "html_url": "https://github.com/pytorch/pytorch/pull/13303#issuecomment-435157475", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13303", "id": 435157475, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTE1NzQ3NQ==", "user": {"login": "kleisauke", "id": 12746591, "node_id": "MDQ6VXNlcjEyNzQ2NTkx", "avatar_url": "https://avatars3.githubusercontent.com/u/12746591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kleisauke", "html_url": "https://github.com/kleisauke", "followers_url": "https://api.github.com/users/kleisauke/followers", "following_url": "https://api.github.com/users/kleisauke/following{/other_user}", "gists_url": "https://api.github.com/users/kleisauke/gists{/gist_id}", "starred_url": "https://api.github.com/users/kleisauke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kleisauke/subscriptions", "organizations_url": "https://api.github.com/users/kleisauke/orgs", "repos_url": "https://api.github.com/users/kleisauke/repos", "events_url": "https://api.github.com/users/kleisauke/events{/privacy}", "received_events_url": "https://api.github.com/users/kleisauke/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-01T19:27:37Z", "updated_at": "2018-11-01T19:27:37Z", "author_association": "NONE", "body_html": "<blockquote>\n<p>what's your build command? do you have full build log?</p>\n</blockquote>\n<p>Build log: <a href=\"https://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-build-log\">https://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-build-log</a><br>\nBuild flags: <a href=\"https://github.com/kleisauke/pytorch-mkldnn-issue/blob/master/third_party/pytorch/CMakeLists.txt#L5-L29\">https://github.com/kleisauke/pytorch-mkldnn-issue/blob/master/third_party/pytorch/CMakeLists.txt#L5-L29</a><br>\nReproduction repo: <a href=\"https://github.com/kleisauke/pytorch-mkldnn-issue\">https://github.com/kleisauke/pytorch-mkldnn-issue</a></p>\n<p>From the build log I see <code>libmkldnn.so</code> is correctly installed:</p>\n<div class=\"highlight highlight-source-shell\"><pre>-- Set runtime path of <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/libmkldnn.so.0.14.0<span class=\"pl-pds\">\"</span></span> to <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib<span class=\"pl-pds\">\"</span></span></pre></div>\n<p>However it looks like the wrong library is appended to <code>INTERFACE_LINK_LIBRARIES</code> in the generated CMake Caffe2 target file <code>/usr/local/share/cmake/Caffe2/Caffe2Targets.cmake</code> (which causes this linkage error):<br>\n<a href=\"https://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-caffe2targets-cmake-L67\">https://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-caffe2targets-cmake-L67</a></p>", "body_text": "what's your build command? do you have full build log?\n\nBuild log: https://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-build-log\nBuild flags: https://github.com/kleisauke/pytorch-mkldnn-issue/blob/master/third_party/pytorch/CMakeLists.txt#L5-L29\nReproduction repo: https://github.com/kleisauke/pytorch-mkldnn-issue\nFrom the build log I see libmkldnn.so is correctly installed:\n-- Set runtime path of \"/usr/local/lib/libmkldnn.so.0.14.0\" to \"/usr/local/lib\"\nHowever it looks like the wrong library is appended to INTERFACE_LINK_LIBRARIES in the generated CMake Caffe2 target file /usr/local/share/cmake/Caffe2/Caffe2Targets.cmake (which causes this linkage error):\nhttps://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-caffe2targets-cmake-L67", "body": "> what's your build command? do you have full build log?\r\n\r\nBuild log: https://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-build-log\r\nBuild flags: https://github.com/kleisauke/pytorch-mkldnn-issue/blob/master/third_party/pytorch/CMakeLists.txt#L5-L29\r\nReproduction repo: https://github.com/kleisauke/pytorch-mkldnn-issue\r\n\r\nFrom the build log I see `libmkldnn.so` is correctly installed:\r\n```bash\r\n-- Set runtime path of \"/usr/local/lib/libmkldnn.so.0.14.0\" to \"/usr/local/lib\"\r\n```\r\n\r\nHowever it looks like the wrong library is appended to `INTERFACE_LINK_LIBRARIES` in the generated CMake Caffe2 target file `/usr/local/share/cmake/Caffe2/Caffe2Targets.cmake` (which causes this linkage error):\r\nhttps://gist.github.com/kleisauke/00df397ffea14b353fbdf125a01fe150#file-caffe2targets-cmake-L67"}