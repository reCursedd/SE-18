{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/181246404", "pull_request_review_id": 111827097, "id": 181246404, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4MTI0NjQwNA==", "diff_hunk": "@@ -381,6 +381,8 @@ static inline Tensor & sparse_transpose_(Tensor & self, int64_t dim0, int64_t di\n   std::vector<int64_t> sizes(self.sizes());\n   std::swap(sizes[dim0], sizes[dim1]);\n \n+  self._uncoalesce_();", "path": "aten/src/ATen/native/TensorShape.cpp", "position": 4, "original_position": 4, "commit_id": "4855d2f3eb875b994d9efb2004b6258f8dee61e0", "original_commit_id": "358d3416df470f680bf7d361a0cb859ba77167af", "user": {"login": "kose-y", "id": 8198142, "node_id": "MDQ6VXNlcjgxOTgxNDI=", "avatar_url": "https://avatars0.githubusercontent.com/u/8198142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kose-y", "html_url": "https://github.com/kose-y", "followers_url": "https://api.github.com/users/kose-y/followers", "following_url": "https://api.github.com/users/kose-y/following{/other_user}", "gists_url": "https://api.github.com/users/kose-y/gists{/gist_id}", "starred_url": "https://api.github.com/users/kose-y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kose-y/subscriptions", "organizations_url": "https://api.github.com/users/kose-y/orgs", "repos_url": "https://api.github.com/users/kose-y/repos", "events_url": "https://api.github.com/users/kose-y/events{/privacy}", "received_events_url": "https://api.github.com/users/kose-y/received_events", "type": "User", "site_admin": false}, "body": "We __should__ mark it as uncoalesced here. Transposition of COO matrix breaks the sorted order in `indices`, so if it is kept marked coalesced, it results in incorrect behavior of matrix multiplication.  If we don't do this, the same thing as in #6219 happens. (I will add a check regarding this)", "created_at": "2018-04-12T22:59:31Z", "updated_at": "2018-11-23T15:42:23Z", "html_url": "https://github.com/pytorch/pytorch/pull/6225#discussion_r181246404", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/6225", "author_association": "NONE", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/181246404"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/6225#discussion_r181246404"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/6225"}}, "body_html": "<p>We <strong>should</strong> mark it as uncoalesced here. Transposition of COO matrix breaks the sorted order in <code>indices</code>, so if it is kept marked coalesced, it results in incorrect behavior of matrix multiplication.  If we don't do this, the same thing as in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"310709745\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/6219\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/6219/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/6219\">#6219</a> happens. (I will add a check regarding this)</p>", "body_text": "We should mark it as uncoalesced here. Transposition of COO matrix breaks the sorted order in indices, so if it is kept marked coalesced, it results in incorrect behavior of matrix multiplication.  If we don't do this, the same thing as in #6219 happens. (I will add a check regarding this)", "in_reply_to_id": 180971298}