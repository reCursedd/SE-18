{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/404217138", "html_url": "https://github.com/pytorch/pytorch/issues/9181#issuecomment-404217138", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9181", "id": 404217138, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNDIxNzEzOA==", "user": {"login": "Rahul-Venugopal", "id": 30955455, "node_id": "MDQ6VXNlcjMwOTU1NDU1", "avatar_url": "https://avatars1.githubusercontent.com/u/30955455?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rahul-Venugopal", "html_url": "https://github.com/Rahul-Venugopal", "followers_url": "https://api.github.com/users/Rahul-Venugopal/followers", "following_url": "https://api.github.com/users/Rahul-Venugopal/following{/other_user}", "gists_url": "https://api.github.com/users/Rahul-Venugopal/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rahul-Venugopal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rahul-Venugopal/subscriptions", "organizations_url": "https://api.github.com/users/Rahul-Venugopal/orgs", "repos_url": "https://api.github.com/users/Rahul-Venugopal/repos", "events_url": "https://api.github.com/users/Rahul-Venugopal/events{/privacy}", "received_events_url": "https://api.github.com/users/Rahul-Venugopal/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-11T15:43:59Z", "updated_at": "2018-07-11T15:54:21Z", "author_association": "NONE", "body_html": "<p>Thanks for helping <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a></p>\n<p>Okay I will describe steps I followed to install . (</p>\n<ol>\n<li>Created a virtual enviornment &lt;detectron_1&gt; using following command :<br>\n<code>virtualenv venvs/detectron_1</code></li>\n</ol>\n<p>2)Activated the environment $detectron_1  by going to bin directory &lt;/venvs/detectron_1/bin&gt; and using command :<br>\nrv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/bin$ <code>source activate</code></p>\n<h3>Installing</h3>\n<p>Now started to install Caffe2 following instructions from :<br>\n<a href=\"url\">https://caffe2.ai/docs/getting-started.html?platform=ubuntu&amp;configuration=compile</a></p>\n<p>Here i have a question !!! (PS : <strong>I name questions as Q1 , Q2 etc..</strong> , so that if anyone can answer mentioning the question number it will be easier)</p>\n<p><strong>Q1)</strong> In the above mentioned link it uses <code>sudo apt-get update</code>  and <code>sudo apt-get install -y --no-install-recommends \\build-essential</code>  . <strong>Since I am in a virtual environment , should I change anything</strong> ?</p>\n<p><strong>Now I am inside virtual environment &lt;detectron_1&gt;</strong> :</p>\n<h3>Installing caffe2 following the instructions :</h3>\n<ol start=\"3\">\n<li>\n<p>Executed  :   <code>sudo apt-get update</code></p>\n</li>\n<li>\n<p>Executed :  <code>sudo apt-get install -y --no-install-recommends \\ build-essential \\ cmake \\ git \\ libgoogle-glog-dev \\ libgtest-dev \\ libiomp-dev \\ libleveldb-dev \\ liblmdb-dev \\ libopencv-dev \\ libopenmpi-dev \\ libsnappy-dev \\ libprotobuf-dev \\ openmpi-bin \\ openmpi-doc \\ protobuf-compiler \\ python-dev \\ python-pip          </code></p>\n</li>\n<li>\n<p>Executed :</p>\n<pre lang=\"pip\" data-meta=\"install \\\"><code>  future \\\nnumpy \\\nprotobuf ```\n\n\n\n</code></pre>\n</li>\n</ol>\n<p>(PS : As per instructions it is <strong>sudo</strong>  , since I am inside a virtual environment , I ran <strong>without sudo</strong> .<br>\nPlease correct me if I am wrong )</p>\n<p>I checked inside  /home/rv/venvs/detectron_1/lib/python2.7/site-packages and all the packages are installed .</p>\n<ol start=\"6\">\n<li>Again as per the instructions , I executed  :</li>\n</ol>\n<p><code>sudo apt-get install -y --no-install-recommends libgflags-dev</code></p>\n<p><strong>Q2: Should I modify this command to execute inside a virtual environment ?</strong></p>\n<p>Now am inside directory /venvs/detectron_1</p>\n<p><strong><code>(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1$</code></strong></p>\n<h3>Clone and Build</h3>\n<ol start=\"7\">\n<li></li>\n</ol>\n<p><strong>Executed</strong> : <code>git clone --recursive https://github.com/pytorch/pytorch.git &amp;&amp; cd pytorch</code><br>\ncloned pytorch directory inside virtual environment</p>\n<ol start=\"8\">\n<li>\n<p>Executed : <code>git submodule update --init </code></p>\n</li>\n<li>\n<p>Executed : <code>mkdir build &amp;&amp; cd build</code></p>\n</li>\n<li>\n<p>executed : <code>cmake ..</code></p>\n</li>\n</ol>\n<p><strong>And output of cmake is as follows</strong> :</p>\n<p><code>(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/pytorch/build$ cmake ..</code></p>\n<p>-- The CXX compiler identification is GNU 5.4.0<br>\n-- The C compiler identification is GNU 5.4.0<br>\n-- Check for working CXX compiler: /usr/bin/c++<br>\n-- Check for working CXX compiler: /usr/bin/c++ -- works<br>\n-- Detecting CXX compiler ABI info<br>\n-- Detecting CXX compiler ABI info - done<br>\n-- Detecting CXX compile features<br>\n-- Detecting CXX compile features - done<br>\n-- Check for working C compiler: /usr/bin/cc<br>\n-- Check for working C compiler: /usr/bin/cc -- works<br>\n-- Detecting C compiler ABI info<br>\n-- Detecting C compiler ABI info - done<br>\n-- Detecting C compile features<br>\n-- Detecting C compile features - done<br>\n-- Not forcing any particular BLAS to be found<br>\n-- Build type not set - defaulting to Release<br>\n-- Performing Test CAFFE2_LONG_IS_INT32_OR_64<br>\n-- Performing Test CAFFE2_LONG_IS_INT32_OR_64 - Success<br>\n-- Does not need to define long separately.<br>\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED<br>\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED - Success<br>\n-- std::exception_ptr is supported.<br>\n-- Performing Test CAFFE2_IS_NUMA_AVAILABLE<br>\n-- Performing Test CAFFE2_IS_NUMA_AVAILABLE - Success<br>\n-- NUMA is available<br>\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING<br>\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING - Success<br>\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS<br>\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS - Success<br>\n-- Current compiler supports avx2 extention. Will build perfkernels.<br>\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY<br>\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY - Success<br>\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY<br>\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY - Success<br>\n-- Building using own protobuf under third_party per request.<br>\n-- Use custom protobuf build.<br>\n-- Looking for pthread.h<br>\n-- Looking for pthread.h - found<br>\n-- Looking for pthread_create<br>\n-- Looking for pthread_create - not found<br>\n-- Looking for pthread_create in pthreads<br>\n-- Looking for pthread_create in pthreads - not found<br>\n-- Looking for pthread_create in pthread<br>\n-- Looking for pthread_create in pthread - found<br>\n-- Found Threads: TRUE<br>\n-- Caffe2 protobuf include directory: $&lt;BUILD_INTERFACE:/home/rv/venvs/detectron_1/pytorch/third_party/protobuf/src&gt;$&lt;INSTALL_INTERFACE:include&gt;<br>\n-- Found Git: /usr/bin/git (found version \"2.7.4\")<br>\n-- The BLAS backend of choice:Eigen<br>\n-- Brace yourself, we are building NNPACK<br>\n-- The ASM compiler identification is GNU<br>\n-- Found assembler: /usr/bin/cc<br>\n-- Found PythonInterp: /home/rv/venvs/detectron_1/bin/python (found version \"2.7.12\")<br>\n-- Check if compiler accepts -pthread<br>\n-- Check if compiler accepts -pthread - yes<br>\n-- Caffe2: Cannot find gflags automatically. Using legacy find.<br>\n-- Found gflags: /usr/include<br>\n-- Caffe2: Found gflags  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libgflags.so)<br>\n-- Caffe2: Cannot find glog automatically. Using legacy find.<br>\n-- Found glog: /usr/include<br>\n-- Caffe2: Found glog (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libglog.so)<br>\n-- Found LMDB: /usr/include<br>\n-- Found lmdb    (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/liblmdb.so)<br>\n-- Found LevelDB: /usr/include<br>\n-- Found LevelDB (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libleveldb.so)<br>\n-- Found Snappy: /usr/include<br>\n-- Found Snappy  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libsnappy.so)<br>\n-- Found Numa: /usr/include<br>\n-- Found Numa  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnuma.so)<br>\n-- OpenCV found (/usr/share/OpenCV)<br>\n-- Found system Eigen at /usr/include/eigen3<br>\n-- Found PythonInterp: /home/rv/venvs/detectron_1/bin/python (found suitable version \"2.7.12\", minimum required is \"2.7\")<br>\n-- Found PythonLibs: /usr/lib/x86_64-linux-gnu/libpython2.7.so (found suitable version \"2.7.12\", minimum required is \"2.7\")<br>\n-- Found NumPy: /home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/numpy/core/include (found version \"1.14.5\")<br>\n-- NumPy ver. 1.14.5 found (include: /home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/numpy/core/include)<br>\n-- Could NOT find pybind11 (missing:  pybind11_INCLUDE_DIR)<br>\n-- Found MPI_C: /usr/lib/openmpi/lib/libmpi.so<br>\n-- Found MPI_CXX: /usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so<br>\n-- MPI support found<br>\n-- MPI compile flags:<br>\n-- MPI include path: /usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/include/usr/lib/openmpi/include/usr/lib/openmpi/include/openmpi<br>\n-- MPI LINK flags path:  -Wl,-rpath  -Wl,/usr/lib/openmpi/lib  -Wl,--enable-new-dtags<br>\n-- MPI libraries: /usr/lib/openmpi/lib/libmpi_cxx.so/usr/lib/openmpi/lib/libmpi.so<br>\nCMake Warning at cmake/Dependencies.cmake:396 (message):<br>\nOpenMPI found, but it is not built with CUDA support.<br>\nCall Stack (most recent call first):<br>\nCMakeLists.txt:187 (include)</p>\n<p>-- Found CUDA: /usr/local/cuda (found suitable version \"9.0\", minimum required is \"7.0\")<br>\n-- Caffe2: CUDA detected: 9.0<br>\n-- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc<br>\n-- Caffe2: CUDA toolkit directory: /usr/local/cuda<br>\n-- Caffe2: Header version is: 9.0<br>\n-- Found CUDNN: /usr/include<br>\n-- Found cuDNN: v7.1.4  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libcudnn.so)<br>\n-- Autodetected CUDA architecture(s): 5.0<br>\n-- Added CUDA NVCC flags for: -gencode;arch=compute_50,code=sm_50<br>\n-- <strong>Could NOT find NCCL (missing:  NCCL_INCLUDE_DIRS NCCL_LIBRARIES)<br>\n-- Could NOT find CUB (missing:  CUB_INCLUDE_DIR)<br>\n-- Could NOT find Gloo (missing:  Gloo_INCLUDE_DIR Gloo_LIBRARY)</strong><br>\n-- MPI include path: /usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/include/usr/lib/openmpi/include/usr/lib/openmpi/include/openmpi<br>\n-- MPI libraries: /usr/lib/openmpi/lib/libmpi_cxx.so/usr/lib/openmpi/lib/libmpi.so<br>\n-- CUDA detected: 9.0<br>\n-- Found libcuda: /usr/local/cuda-9.0/lib64/stubs/libcuda.so<br>\n-- Found libnvrtc: /usr/local/cuda-9.0/lib64/libnvrtc.so<br>\n-- Could NOT find NCCL (missing:  NCCL_INCLUDE_DIR NCCL_LIBRARY)<br>\nCMake Warning at third_party/gloo/cmake/Dependencies.cmake:62 (message):<br>\nNot compiling with NCCL support.  Suppress this warning with<br>\n-DUSE_NCCL=OFF.<br>\nCall Stack (most recent call first):<br>\nthird_party/gloo/CMakeLists.txt:56 (include)</p>\n<p>CMake Warning at cmake/Dependencies.cmake:623 (message):<br>\nmobile opengl is only used in android or ios builds.<br>\nCall Stack (most recent call first):<br>\nCMakeLists.txt:187 (include)</p>\n<p>CMake Warning at cmake/Dependencies.cmake:699 (message):<br>\nMetal is only used in ios builds.<br>\nCall Stack (most recent call first):<br>\nCMakeLists.txt:187 (include)</p>\n<p>-- GCC 5.4.0: Adding gcc and gcc_s libs to link line<br>\n-- Include NCCL operators<br>\n-- Excluding ideep operators as we are not using ideep<br>\n-- Including image processing operators<br>\n-- Excluding video processing operators due to no opencv<br>\n-- Excluding mkl operators as we are not using mkl<br>\n-- Include Observer library<br>\n-- Using lib/python2.7/site-packages as python relative installation path<br>\n-- Automatically generating missing <strong>init</strong>.py files.<br>\nCMake Warning at CMakeLists.txt:353 (message):<br>\nGenerated cmake files are only fully tested if one builds with system glog,<br>\ngflags, and protobuf.  Other settings may generate files that are not well<br>\ntested.</p>\n<p>--</p>\n<h3>-- ******** Summary ********</h3>\n<h2>-- General:<br>\n--   CMake version         : 3.5.1<br>\n--   CMake command         : /usr/bin/cmake<br>\n--   Git version           : v0.1.11-9260-g04a7fc1<br>\n--   System                : Linux<br>\n--   C++ compiler          : /usr/bin/c++<br>\n--   C++ compiler version  : 5.4.0<br>\n--   BLAS                  : Eigen<br>\n--   CXX flags             :  -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_c2 -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-aliasing -Wno-error=deprecated-declarations<br>\n--   Build type            : Release<br>\n--   Compile definitions   :<br>\n--   CMAKE_PREFIX_PATH     :<br>\n--   CMAKE_INSTALL_PREFIX  : /usr/local</h2>\n<p>--   BUILD_CAFFE2          : ON<br>\n--   BUILD_ATEN            : OFF<br>\n--   BUILD_BINARY          : ON<br>\n--   BUILD_CUSTOM_PROTOBUF : ON<br>\n--     Link local protobuf : ON<br>\n--   BUILD_DOCS            : OFF<br>\n--   BUILD_PYTHON          : ON<br>\n--     Python version      : 2.7.12<br>\n--     Python executable   : /home/rv/venvs/detectron_1/bin/python<br>\n--     Python includes     : /home/rv/venvs/detectron_1/include/python2.7<br>\n--     Python site-packages: lib/python2.7/site-packages<br>\n--   BUILD_SHARED_LIBS     : ON<br>\n--   BUILD_TEST            : OFF<br>\n--   USE_ASAN              : OFF<br>\n--   USE_ATEN              : OFF<br>\n--   USE_CUDA              : ON<br>\n--     CUDA static link    : OFF<br>\n--     USE_CUDNN           : ON<br>\n--     CUDA version        : 9.0<br>\n--     cuDNN version       : 7.1.4<br>\n--     CUDA root directory : /usr/local/cuda<br>\n--     CUDA library        : /usr/local/cuda-9.0/lib64/stubs/libcuda.so<br>\n--     cudart library      : /usr/local/cuda/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so<br>\n--     cublas library      : /usr/local/cuda/lib64/libcublas.so;/usr/local/cuda/lib64/libcublas_device.a<br>\n--     cufft library       : /usr/local/cuda/lib64/libcufft.so<br>\n--     curand library      : /usr/local/cuda/lib64/libcurand.so<br>\n--     cuDNN library       : /usr/lib/x86_64-linux-gnu/libcudnn.so<br>\n--     nvrtc               : /usr/local/cuda-9.0/lib64/libnvrtc.so<br>\n--     CUDA include path   : /usr/local/cuda/include<br>\n--     NVCC executable     : /usr/local/cuda/bin/nvcc<br>\n--     CUDA host compiler  : /usr/bin/cc<br>\n--     USE_TENSORRT        : OFF<br>\n--   USE_ROCM              : OFF<br>\n--   USE_EIGEN_FOR_BLAS    : ON<br>\n--   USE_FFMPEG            : OFF<br>\n--   USE_GFLAGS            : ON<br>\n--   USE_GLOG              : ON<br>\n--   USE_GLOO              : ON<br>\n--     USE_GLOO_IBVERBS    : OFF<br>\n--   USE_LEVELDB           : ON<br>\n--     LevelDB version     : 1.18<br>\n--     Snappy version      : 1.1.3<br>\n--   USE_LITE_PROTO        : OFF<br>\n--   USE_LMDB              : ON<br>\n--     LMDB version        : 0.9.17<br>\n--   USE_METAL             : OFF<br>\n--   USE_MKL               :<br>\n--   USE_MOBILE_OPENGL     : OFF<br>\n--   USE_MPI               : ON<br>\n--   USE_NCCL              : ON<br>\n--     USE_SYSTEM_NCCL     : OFF<br>\n--   USE_NERVANA_GPU       : OFF<br>\n--   USE_NNPACK            : ON<br>\n--   USE_OBSERVERS         : ON<br>\n--   USE_OPENCL            : OFF<br>\n--   USE_OPENCV            : ON<br>\n--     OpenCV version      : 3.3.1<br>\n--   USE_OPENMP            : OFF<br>\n--   USE_PROF              : OFF<br>\n--   USE_REDIS             : OFF<br>\n--   USE_ROCKSDB           : OFF<br>\n--   USE_ZMQ               : OFF<br>\n--   Public Dependencies  : Threads::Threads;gflags;glog::glog<br>\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/liblmdb.so;/usr/lib/x86_64-linux-gnu/libleveldb.so;/usr/lib/x86_64-linux-gnu/libsnappy.so;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;opencv_imgcodecs;opencv_videoio;opencv_video;/usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so;gloo;onnxifi_loader;gcc_s;gcc;dl<br>\n-- Configuring done<br>\n-- Generating done<br>\n-- Build files have been written to: /home/rv/venvs/detectron_1/pytorch/build</p>\n<p><strong>Q3</strong> : Some directories are NOT FOUND ( which has been converted into bold text in cmkae outpu above) . Is it something to be worried ?</p>\n<p>Now went back to the directory pytorch using</p>\n<p><code>cd /home/rv/venvs/detectron_1/pytorch</code></p>\n<p><strong>### <strong>Build</strong>  using  <code>FULL_CAFFE2=1 python setup.py install</code></strong></p>\n<ol start=\"11\">\n<li>\n<p>executed : <code>FULL_CAFFE2=1 python setup.py install</code><br>\n(as <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a>  suggested to build Caffe2 along with Pytorch )</p>\n<pre><code>        **error** : RuntimeError: Missing build dependency: Unable to `import yaml`.\n                        RuntimeError: Missing build dependency: Unable to `import typing`.\n</code></pre>\n</li>\n<li>\n<p>executed :<code> pip install pyyaml</code><br>\n<code>pip install typing</code></p>\n</li>\n<li>\n<p>executed : <code>FULL_CAFFE2=1 python setup.py install</code></p>\n<p><strong>Error :</strong><br>\n[ 64%] Linking CXX shared library ../lib/libcaffe2.so<br>\n[ 64%] Built target caffe2<br>\nScanning dependencies of target caffe2_pybind11_state<br>\nScanning dependencies of target caffe2_observers<br>\n[ 64%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o<br>\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/<strong>/aten/src/THC/caffe2_gpu_generated_THCBlas.cu.o<br>\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/</strong>/aten/src/THC/caffe2_gpu_generated_THCReduceApplyUtils.cu.o<br>\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/<strong>/aten/src/THC/caffe2_gpu_generated_THCSleep.cu.o<br>\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/</strong>/aten/src/THC/caffe2_gpu_generated_THCStorageCopy.cu.o<br>\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorage.cu.o<br>\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/net_observer_reporter_print.cc.o<br>\n[ 65%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state.cc.o<br>\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,<br>\nfrom /usr/local/cuda/include/cuda_runtime.h:115,<br>\nfrom :0:<br>\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"\" is not valid in preprocessor expressions<br>\n#define <strong>CUDACC_VER</strong> \"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"<br>\n^<br>\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018<strong>CUDACC_VER</strong>\u2019<br>\n#if defined(<strong>CUDACC_VER</strong>) &amp;&amp;  <strong>CUDACC_VER</strong> &gt;= 70500 &amp;&amp; __cplusplus &gt; 199711L<br>\n^<br>\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):<br>\nError generating<br>\n/home/rv/venvs/detectron_1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o</p>\n</li>\n</ol>\n<p>caffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed<br>\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1<br>\nmake[2]: *** Waiting for unfinished jobs....<br>\n[ 65%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state_dlpack.cc.o<br>\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o<br>\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o<br>\n[ 65%] Linking CXX shared library ../../lib/libcaffe2_observers.so<br>\n[ 65%] Built target caffe2_observers<br>\nCMakeFiles/Makefile2:2104: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed<br>\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2<br>\nmake[1]: *** Waiting for unfinished jobs....<br>\n[ 65%] Linking CXX shared module python/caffe2_pybind11_state.so<br>\n[ 65%] Built target caffe2_pybind11_state<br>\nMakefile:138: recipe for target 'all' failed<br>\nmake: *** [all] Error 2<br>\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --full-caffe2 nccl caffe2 nanopb libshm gloo THD c10d'</p>\n<p>**Q4 **  What is the difference between  <strong>setup.py</strong> and <strong>setup_caffe2.py</strong> ?</p>\n<h3><strong>Build</strong> using <code>python setup_caffe2.py install</code></h3>\n<ol start=\"14\">\n<li>\n<p>executed : <code>python setup_caffe2.py install</code></p>\n<p><strong>Error :</strong></p>\n<p>[ 77%] Linking CXX static library ../../lib/libcaffe2_observers.a<br>\n[ 77%] Built target caffe2_observers<br>\nLinking   libnccl.so.1.3.5                    &gt; /home/rv/venvs/detectron_1/pytorch/third_party/nccl/build/lib/libnccl.so.1.3.5<br>\nArchiving libnccl_static.a                    &gt; /home/rv/venvs/detectron_1/pytorch/third_party/nccl/build/lib/libnccl_static.a<br>\n[ 77%] No install step for 'nccl_external'<br>\n[ 77%] Completed 'nccl_external'<br>\n[ 77%] Built target nccl_external<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/sgd/caffe2_gpu_generated_adagrad_op_gpu.cu.o<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/core/caffe2_gpu_generated_context_gpu.cu.o<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/core/caffe2_gpu_generated_THCCachingAllocator.cu.o<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/image/caffe2_gpu_generated_transform_gpu.cu.o<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o<br>\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_boolean_unmask_ops.cu.o<br>\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,<br>\nfrom /usr/local/cuda/include/cuda_runtime.h:115,<br>\nfrom :0:<br>\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"\" is not valid in preprocessor expressions<br>\n#define <strong>CUDACC_VER</strong> \"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"<br>\n^<br>\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018<strong>CUDACC_VER</strong>\u2019<br>\n#if defined(<strong>CUDACC_VER</strong>) &amp;&amp;  <strong>CUDACC_VER</strong> &gt;= 70500 &amp;&amp; __cplusplus &gt; 199711L<br>\n^<br>\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,<br>\nfrom /usr/local/cuda/include/cuda_runtime.h:115,<br>\nfrom :0:<br>\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"\" is not valid in preprocessor expressions<br>\n#define <strong>CUDACC_VER</strong> \"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"<br>\n^<br>\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018<strong>CUDACC_VER</strong>\u2019<br>\n#if defined(<strong>CUDACC_VER</strong>) &amp;&amp;  <strong>CUDACC_VER</strong> &gt;= 70500 &amp;&amp; __cplusplus &gt; 199711L<br>\n^<br>\nCMake Error at caffe2_gpu_generated_logit_op.cu.o.Release.cmake:219 (message):<br>\nError generating<br>\n/home/rv/venvs/detectron_1/pytorch/.setuptools-cmake-build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_logit_op.cu.o</p>\n</li>\n</ol>\n<p>caffe2/CMakeFiles/caffe2_gpu.dir/build.make:98: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o' failed<br>\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o] Error 1<br>\nmake[2]: *** Waiting for unfinished jobs....<br>\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):<br>\nError generating<br>\n/home/rv/venvs/detectron_1/pytorch/.setuptools-cmake-build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o</p>\n<p>caffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed<br>\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1<br>\nCMakeFiles/Makefile2:1469: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed<br>\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2<br>\nmake[1]: *** Waiting for unfinished jobs....<br>\n[ 77%] Linking CXX shared module python/caffe2_pybind11_state.so<br>\n[ 77%] Built target caffe2_pybind11_state<br>\nMakefile:138: recipe for target 'all' failed<br>\nmake: *** [all] Error 2<br>\nTraceback (most recent call last):<br>\nFile \"setup_caffe2.py\", line 271, in <br>\n'convert-onnx-to-caffe2 = caffe2.python.onnx.bin.conversion:onnx_to_caffe2',<br>\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/<strong>init</strong>.py\", line 131, in setup<br>\nreturn distutils.core.setup(**attrs)<br>\nFile \"/usr/lib/python2.7/distutils/core.py\", line 151, in setup<br>\ndist.run_commands()<br>\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 953, in run_commands<br>\nself.run_command(cmd)<br>\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command<br>\ncmd_obj.run()<br>\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install.py\", line 67, in run<br>\nself.do_egg_install()<br>\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install.py\", line 109, in do_egg_install<br>\nself.run_command('bdist_egg')<br>\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command<br>\nself.distribution.run_command(command)<br>\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command<br>\ncmd_obj.run()<br>\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/bdist_egg.py\", line 172, in run<br>\ncmd = self.call_command('install_lib', warn_dir=0)<br>\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/bdist_egg.py\", line 158, in call_command<br>\nself.run_command(cmdname)<br>\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command<br>\nself.distribution.run_command(command)<br>\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command<br>\ncmd_obj.run()<br>\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install_lib.py\", line 11, in run<br>\nself.build()<br>\nFile \"/usr/lib/python2.7/distutils/command/install_lib.py\", line 109, in build<br>\nself.run_command('build_py')<br>\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command<br>\nself.distribution.run_command(command)<br>\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command<br>\ncmd_obj.run()<br>\nFile \"setup_caffe2.py\", line 163, in run<br>\nself.run_command('cmake_build')<br>\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command<br>\nself.distribution.run_command(command)<br>\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command<br>\ncmd_obj.run()<br>\nFile \"setup_caffe2.py\", line 157, in run<br>\nsubprocess.check_call(build_args)<br>\nFile \"/usr/lib/python2.7/subprocess.py\", line 541, in check_call<br>\nraise CalledProcessError(retcode, cmd)<br>\nsubprocess.CalledProcessError: Command '[u'/usr/bin/make', u'-j', '8']' returned non-zero exit status 2</p>\n<p><strong>### build using  <code>make install </code></strong></p>\n<p>15 )  Changed to directory build :<code> cd build</code><br>\n(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/pytorch/build$</p>\n<ol start=\"16\">\n<li>\n<p>executed : make install</p>\n<pre><code> **Error :**   \n</code></pre>\n</li>\n</ol>\n<p>Linking CXX shared module python/caffe2_pybind11_state.so<br>\n[ 62%] Built target caffe2_pybind11_state<br>\n[ 62%] Built target python_copy_files<br>\n[ 62%] Built target ATEN_CUDA_FILES_GEN_TARGET<br>\n[ 62%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o<br>\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,<br>\nfrom /usr/local/cuda/include/cuda_runtime.h:115,<br>\nfrom :0:<br>\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"\" is not valid in preprocessor expressions<br>\n#define <strong>CUDACC_VER</strong> \"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"<br>\n^<br>\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018<strong>CUDACC_VER</strong>\u2019<br>\n#if defined(<strong>CUDACC_VER</strong>) &amp;&amp;  <strong>CUDACC_VER</strong> &gt;= 70500 &amp;&amp; __cplusplus &gt; 199711L<br>\n^<br>\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):<br>\nError generating<br>\n/home/rv/venvs/detectron_1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o</p>\n<p>caffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed<br>\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1<br>\nCMakeFiles/Makefile2:2104: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed<br>\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2<br>\nMakefile:138: recipe for target 'all' failed<br>\nmake: *** [all] Error 2</p>\n<h3>Outputs asked by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a></h3>\n<p>(PS : My virtual environment is <strong>detectron_1</strong> and i created it inside directory  <strong>/home/rv/venvs/</strong>  )</p>\n<ol>\n<li>\n<p>(detectron_1) rv@rv-HP-ZBook-15-G3:~$ <code>which python</code><br>\n/home/rv/venvs/detectron_1/bin/python</p>\n</li>\n<li>\n<p>(detectron_1) rv@rv-HP-ZBook-15-G3:<del>$ <code> which pip</code><br>\n/home/rv/venvs/detectron_1/bin/pip<br>\n3)(detectron_1) rv@rv-HP-ZBook-15-G3:</del>$  <code>python --version</code><br>\nPython 2.7.1<br>\n4)(detectron_1) rv@rv-HP-ZBook-15-G3:<del>$  <code>pip freeze | grep distutils</code><br>\n(detectron_1) rv@rv-HP-ZBook-15-G3:</del>$<br>\n(PS: No output inside virtual enviornment. In usual terminal I am getting output)</p>\n</li>\n<li>\n<p>(detectron_1) rv@rv-HP-ZBook-15-G3:~$ <code>which nvcc</code><br>\n/usr/local/cuda-9.0/bin/nvcc</p>\n</li>\n<li>\n<p>(detectron_1) rv@rv-HP-ZBook-15-G3:~$ <code>nvcc --version</code><br>\nnvcc: NVIDIA (R) Cuda compiler driver<br>\nCopyright (c) 2005-2017 NVIDIA Corporation<br>\nBuilt on Sun_Nov_19_03:10:15_CST_2017<br>\nCuda compilation tools, release 9.0, V9.0.252</p>\n</li>\n</ol>\n<p>7)(detectron_1) rv@rv-HP-ZBook-15-G3:<del>$ gcc -v<br>\nUsing built-in specs.<br>\nCOLLECT_GCC=gcc<br>\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper<br>\nTarget: x86_64-linux-gnu<br>\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu1</del>16.04.9' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu<br>\nThread model: posix<br>\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9)</p>\n<p>Please let me know if any relevant information I am missing.</p>\n<h3>Setting PYTHONPATH and LD_LIBRARY_PATH</h3>\n<h3><strong>Q5</strong></h3>\n<p>In many issues I have found about setting up enviornment variables. Should I set the build directory in PYTHONPATH ?</p>\n<p>Thanks in advance</p>", "body_text": "Thanks for helping @pjh5\nOkay I will describe steps I followed to install . (\n\nCreated a virtual enviornment <detectron_1> using following command :\nvirtualenv venvs/detectron_1\n\n2)Activated the environment $detectron_1  by going to bin directory </venvs/detectron_1/bin> and using command :\nrv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/bin$ source activate\nInstalling\nNow started to install Caffe2 following instructions from :\nhttps://caffe2.ai/docs/getting-started.html?platform=ubuntu&configuration=compile\nHere i have a question !!! (PS : I name questions as Q1 , Q2 etc.. , so that if anyone can answer mentioning the question number it will be easier)\nQ1) In the above mentioned link it uses sudo apt-get update  and sudo apt-get install -y --no-install-recommends \\build-essential  . Since I am in a virtual environment , should I change anything ?\nNow I am inside virtual environment <detectron_1> :\nInstalling caffe2 following the instructions :\n\n\nExecuted  :   sudo apt-get update\n\n\nExecuted :  sudo apt-get install -y --no-install-recommends \\ build-essential \\ cmake \\ git \\ libgoogle-glog-dev \\ libgtest-dev \\ libiomp-dev \\ libleveldb-dev \\ liblmdb-dev \\ libopencv-dev \\ libopenmpi-dev \\ libsnappy-dev \\ libprotobuf-dev \\ openmpi-bin \\ openmpi-doc \\ protobuf-compiler \\ python-dev \\ python-pip          \n\n\nExecuted :\n  future \\\nnumpy \\\nprotobuf ```\n\n\n\n\n\n\n(PS : As per instructions it is sudo  , since I am inside a virtual environment , I ran without sudo .\nPlease correct me if I am wrong )\nI checked inside  /home/rv/venvs/detectron_1/lib/python2.7/site-packages and all the packages are installed .\n\nAgain as per the instructions , I executed  :\n\nsudo apt-get install -y --no-install-recommends libgflags-dev\nQ2: Should I modify this command to execute inside a virtual environment ?\nNow am inside directory /venvs/detectron_1\n(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1$\nClone and Build\n\n\n\nExecuted : git clone --recursive https://github.com/pytorch/pytorch.git && cd pytorch\ncloned pytorch directory inside virtual environment\n\n\nExecuted : git submodule update --init \n\n\nExecuted : mkdir build && cd build\n\n\nexecuted : cmake ..\n\n\nAnd output of cmake is as follows :\n(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/pytorch/build$ cmake ..\n-- The CXX compiler identification is GNU 5.4.0\n-- The C compiler identification is GNU 5.4.0\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Not forcing any particular BLAS to be found\n-- Build type not set - defaulting to Release\n-- Performing Test CAFFE2_LONG_IS_INT32_OR_64\n-- Performing Test CAFFE2_LONG_IS_INT32_OR_64 - Success\n-- Does not need to define long separately.\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED - Success\n-- std::exception_ptr is supported.\n-- Performing Test CAFFE2_IS_NUMA_AVAILABLE\n-- Performing Test CAFFE2_IS_NUMA_AVAILABLE - Success\n-- NUMA is available\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING - Success\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS - Success\n-- Current compiler supports avx2 extention. Will build perfkernels.\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY - Success\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY - Success\n-- Building using own protobuf under third_party per request.\n-- Use custom protobuf build.\n-- Looking for pthread.h\n-- Looking for pthread.h - found\n-- Looking for pthread_create\n-- Looking for pthread_create - not found\n-- Looking for pthread_create in pthreads\n-- Looking for pthread_create in pthreads - not found\n-- Looking for pthread_create in pthread\n-- Looking for pthread_create in pthread - found\n-- Found Threads: TRUE\n-- Caffe2 protobuf include directory: $<BUILD_INTERFACE:/home/rv/venvs/detectron_1/pytorch/third_party/protobuf/src>$<INSTALL_INTERFACE:include>\n-- Found Git: /usr/bin/git (found version \"2.7.4\")\n-- The BLAS backend of choice:Eigen\n-- Brace yourself, we are building NNPACK\n-- The ASM compiler identification is GNU\n-- Found assembler: /usr/bin/cc\n-- Found PythonInterp: /home/rv/venvs/detectron_1/bin/python (found version \"2.7.12\")\n-- Check if compiler accepts -pthread\n-- Check if compiler accepts -pthread - yes\n-- Caffe2: Cannot find gflags automatically. Using legacy find.\n-- Found gflags: /usr/include\n-- Caffe2: Found gflags  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libgflags.so)\n-- Caffe2: Cannot find glog automatically. Using legacy find.\n-- Found glog: /usr/include\n-- Caffe2: Found glog (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libglog.so)\n-- Found LMDB: /usr/include\n-- Found lmdb    (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/liblmdb.so)\n-- Found LevelDB: /usr/include\n-- Found LevelDB (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libleveldb.so)\n-- Found Snappy: /usr/include\n-- Found Snappy  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libsnappy.so)\n-- Found Numa: /usr/include\n-- Found Numa  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnuma.so)\n-- OpenCV found (/usr/share/OpenCV)\n-- Found system Eigen at /usr/include/eigen3\n-- Found PythonInterp: /home/rv/venvs/detectron_1/bin/python (found suitable version \"2.7.12\", minimum required is \"2.7\")\n-- Found PythonLibs: /usr/lib/x86_64-linux-gnu/libpython2.7.so (found suitable version \"2.7.12\", minimum required is \"2.7\")\n-- Found NumPy: /home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/numpy/core/include (found version \"1.14.5\")\n-- NumPy ver. 1.14.5 found (include: /home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/numpy/core/include)\n-- Could NOT find pybind11 (missing:  pybind11_INCLUDE_DIR)\n-- Found MPI_C: /usr/lib/openmpi/lib/libmpi.so\n-- Found MPI_CXX: /usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so\n-- MPI support found\n-- MPI compile flags:\n-- MPI include path: /usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/include/usr/lib/openmpi/include/usr/lib/openmpi/include/openmpi\n-- MPI LINK flags path:  -Wl,-rpath  -Wl,/usr/lib/openmpi/lib  -Wl,--enable-new-dtags\n-- MPI libraries: /usr/lib/openmpi/lib/libmpi_cxx.so/usr/lib/openmpi/lib/libmpi.so\nCMake Warning at cmake/Dependencies.cmake:396 (message):\nOpenMPI found, but it is not built with CUDA support.\nCall Stack (most recent call first):\nCMakeLists.txt:187 (include)\n-- Found CUDA: /usr/local/cuda (found suitable version \"9.0\", minimum required is \"7.0\")\n-- Caffe2: CUDA detected: 9.0\n-- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\n-- Caffe2: CUDA toolkit directory: /usr/local/cuda\n-- Caffe2: Header version is: 9.0\n-- Found CUDNN: /usr/include\n-- Found cuDNN: v7.1.4  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libcudnn.so)\n-- Autodetected CUDA architecture(s): 5.0\n-- Added CUDA NVCC flags for: -gencode;arch=compute_50,code=sm_50\n-- Could NOT find NCCL (missing:  NCCL_INCLUDE_DIRS NCCL_LIBRARIES)\n-- Could NOT find CUB (missing:  CUB_INCLUDE_DIR)\n-- Could NOT find Gloo (missing:  Gloo_INCLUDE_DIR Gloo_LIBRARY)\n-- MPI include path: /usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/include/usr/lib/openmpi/include/usr/lib/openmpi/include/openmpi\n-- MPI libraries: /usr/lib/openmpi/lib/libmpi_cxx.so/usr/lib/openmpi/lib/libmpi.so\n-- CUDA detected: 9.0\n-- Found libcuda: /usr/local/cuda-9.0/lib64/stubs/libcuda.so\n-- Found libnvrtc: /usr/local/cuda-9.0/lib64/libnvrtc.so\n-- Could NOT find NCCL (missing:  NCCL_INCLUDE_DIR NCCL_LIBRARY)\nCMake Warning at third_party/gloo/cmake/Dependencies.cmake:62 (message):\nNot compiling with NCCL support.  Suppress this warning with\n-DUSE_NCCL=OFF.\nCall Stack (most recent call first):\nthird_party/gloo/CMakeLists.txt:56 (include)\nCMake Warning at cmake/Dependencies.cmake:623 (message):\nmobile opengl is only used in android or ios builds.\nCall Stack (most recent call first):\nCMakeLists.txt:187 (include)\nCMake Warning at cmake/Dependencies.cmake:699 (message):\nMetal is only used in ios builds.\nCall Stack (most recent call first):\nCMakeLists.txt:187 (include)\n-- GCC 5.4.0: Adding gcc and gcc_s libs to link line\n-- Include NCCL operators\n-- Excluding ideep operators as we are not using ideep\n-- Including image processing operators\n-- Excluding video processing operators due to no opencv\n-- Excluding mkl operators as we are not using mkl\n-- Include Observer library\n-- Using lib/python2.7/site-packages as python relative installation path\n-- Automatically generating missing init.py files.\nCMake Warning at CMakeLists.txt:353 (message):\nGenerated cmake files are only fully tested if one builds with system glog,\ngflags, and protobuf.  Other settings may generate files that are not well\ntested.\n--\n-- ******** Summary ********\n-- General:\n--   CMake version         : 3.5.1\n--   CMake command         : /usr/bin/cmake\n--   Git version           : v0.1.11-9260-g04a7fc1\n--   System                : Linux\n--   C++ compiler          : /usr/bin/c++\n--   C++ compiler version  : 5.4.0\n--   BLAS                  : Eigen\n--   CXX flags             :  -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_c2 -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-aliasing -Wno-error=deprecated-declarations\n--   Build type            : Release\n--   Compile definitions   :\n--   CMAKE_PREFIX_PATH     :\n--   CMAKE_INSTALL_PREFIX  : /usr/local\n--   BUILD_CAFFE2          : ON\n--   BUILD_ATEN            : OFF\n--   BUILD_BINARY          : ON\n--   BUILD_CUSTOM_PROTOBUF : ON\n--     Link local protobuf : ON\n--   BUILD_DOCS            : OFF\n--   BUILD_PYTHON          : ON\n--     Python version      : 2.7.12\n--     Python executable   : /home/rv/venvs/detectron_1/bin/python\n--     Python includes     : /home/rv/venvs/detectron_1/include/python2.7\n--     Python site-packages: lib/python2.7/site-packages\n--   BUILD_SHARED_LIBS     : ON\n--   BUILD_TEST            : OFF\n--   USE_ASAN              : OFF\n--   USE_ATEN              : OFF\n--   USE_CUDA              : ON\n--     CUDA static link    : OFF\n--     USE_CUDNN           : ON\n--     CUDA version        : 9.0\n--     cuDNN version       : 7.1.4\n--     CUDA root directory : /usr/local/cuda\n--     CUDA library        : /usr/local/cuda-9.0/lib64/stubs/libcuda.so\n--     cudart library      : /usr/local/cuda/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\n--     cublas library      : /usr/local/cuda/lib64/libcublas.so;/usr/local/cuda/lib64/libcublas_device.a\n--     cufft library       : /usr/local/cuda/lib64/libcufft.so\n--     curand library      : /usr/local/cuda/lib64/libcurand.so\n--     cuDNN library       : /usr/lib/x86_64-linux-gnu/libcudnn.so\n--     nvrtc               : /usr/local/cuda-9.0/lib64/libnvrtc.so\n--     CUDA include path   : /usr/local/cuda/include\n--     NVCC executable     : /usr/local/cuda/bin/nvcc\n--     CUDA host compiler  : /usr/bin/cc\n--     USE_TENSORRT        : OFF\n--   USE_ROCM              : OFF\n--   USE_EIGEN_FOR_BLAS    : ON\n--   USE_FFMPEG            : OFF\n--   USE_GFLAGS            : ON\n--   USE_GLOG              : ON\n--   USE_GLOO              : ON\n--     USE_GLOO_IBVERBS    : OFF\n--   USE_LEVELDB           : ON\n--     LevelDB version     : 1.18\n--     Snappy version      : 1.1.3\n--   USE_LITE_PROTO        : OFF\n--   USE_LMDB              : ON\n--     LMDB version        : 0.9.17\n--   USE_METAL             : OFF\n--   USE_MKL               :\n--   USE_MOBILE_OPENGL     : OFF\n--   USE_MPI               : ON\n--   USE_NCCL              : ON\n--     USE_SYSTEM_NCCL     : OFF\n--   USE_NERVANA_GPU       : OFF\n--   USE_NNPACK            : ON\n--   USE_OBSERVERS         : ON\n--   USE_OPENCL            : OFF\n--   USE_OPENCV            : ON\n--     OpenCV version      : 3.3.1\n--   USE_OPENMP            : OFF\n--   USE_PROF              : OFF\n--   USE_REDIS             : OFF\n--   USE_ROCKSDB           : OFF\n--   USE_ZMQ               : OFF\n--   Public Dependencies  : Threads::Threads;gflags;glog::glog\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/liblmdb.so;/usr/lib/x86_64-linux-gnu/libleveldb.so;/usr/lib/x86_64-linux-gnu/libsnappy.so;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;opencv_imgcodecs;opencv_videoio;opencv_video;/usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so;gloo;onnxifi_loader;gcc_s;gcc;dl\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/rv/venvs/detectron_1/pytorch/build\nQ3 : Some directories are NOT FOUND ( which has been converted into bold text in cmkae outpu above) . Is it something to be worried ?\nNow went back to the directory pytorch using\ncd /home/rv/venvs/detectron_1/pytorch\n### Build  using  FULL_CAFFE2=1 python setup.py install\n\n\nexecuted : FULL_CAFFE2=1 python setup.py install\n(as @pjh5  suggested to build Caffe2 along with Pytorch )\n        **error** : RuntimeError: Missing build dependency: Unable to `import yaml`.\n                        RuntimeError: Missing build dependency: Unable to `import typing`.\n\n\n\nexecuted : pip install pyyaml\npip install typing\n\n\nexecuted : FULL_CAFFE2=1 python setup.py install\nError :\n[ 64%] Linking CXX shared library ../lib/libcaffe2.so\n[ 64%] Built target caffe2\nScanning dependencies of target caffe2_pybind11_state\nScanning dependencies of target caffe2_observers\n[ 64%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir//aten/src/THC/caffe2_gpu_generated_THCBlas.cu.o\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir//aten/src/THC/caffe2_gpu_generated_THCReduceApplyUtils.cu.o\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir//aten/src/THC/caffe2_gpu_generated_THCSleep.cu.o\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir//aten/src/THC/caffe2_gpu_generated_THCStorageCopy.cu.o\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorage.cu.o\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/net_observer_reporter_print.cc.o\n[ 65%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state.cc.o\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\nfrom /usr/local/cuda/include/cuda_runtime.h:115,\nfrom :0:\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\" is not valid in preprocessor expressions\n#define CUDACC_VER \"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\n^\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018CUDACC_VER\u2019\n#if defined(CUDACC_VER) &&  CUDACC_VER >= 70500 && __cplusplus > 199711L\n^\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\nError generating\n/home/rv/venvs/detectron_1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\n\n\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\n[ 65%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state_dlpack.cc.o\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o\n[ 65%] Linking CXX shared library ../../lib/libcaffe2_observers.so\n[ 65%] Built target caffe2_observers\nCMakeFiles/Makefile2:2104: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n[ 65%] Linking CXX shared module python/caffe2_pybind11_state.so\n[ 65%] Built target caffe2_pybind11_state\nMakefile:138: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --full-caffe2 nccl caffe2 nanopb libshm gloo THD c10d'\n**Q4 **  What is the difference between  setup.py and setup_caffe2.py ?\nBuild using python setup_caffe2.py install\n\n\nexecuted : python setup_caffe2.py install\nError :\n[ 77%] Linking CXX static library ../../lib/libcaffe2_observers.a\n[ 77%] Built target caffe2_observers\nLinking   libnccl.so.1.3.5                    > /home/rv/venvs/detectron_1/pytorch/third_party/nccl/build/lib/libnccl.so.1.3.5\nArchiving libnccl_static.a                    > /home/rv/venvs/detectron_1/pytorch/third_party/nccl/build/lib/libnccl_static.a\n[ 77%] No install step for 'nccl_external'\n[ 77%] Completed 'nccl_external'\n[ 77%] Built target nccl_external\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/sgd/caffe2_gpu_generated_adagrad_op_gpu.cu.o\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/core/caffe2_gpu_generated_context_gpu.cu.o\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/core/caffe2_gpu_generated_THCCachingAllocator.cu.o\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/image/caffe2_gpu_generated_transform_gpu.cu.o\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_boolean_unmask_ops.cu.o\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\nfrom /usr/local/cuda/include/cuda_runtime.h:115,\nfrom :0:\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\" is not valid in preprocessor expressions\n#define CUDACC_VER \"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\n^\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018CUDACC_VER\u2019\n#if defined(CUDACC_VER) &&  CUDACC_VER >= 70500 && __cplusplus > 199711L\n^\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\nfrom /usr/local/cuda/include/cuda_runtime.h:115,\nfrom :0:\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\" is not valid in preprocessor expressions\n#define CUDACC_VER \"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\n^\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018CUDACC_VER\u2019\n#if defined(CUDACC_VER) &&  CUDACC_VER >= 70500 && __cplusplus > 199711L\n^\nCMake Error at caffe2_gpu_generated_logit_op.cu.o.Release.cmake:219 (message):\nError generating\n/home/rv/venvs/detectron_1/pytorch/.setuptools-cmake-build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_logit_op.cu.o\n\n\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:98: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o' failed\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\nError generating\n/home/rv/venvs/detectron_1/pytorch/.setuptools-cmake-build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\nCMakeFiles/Makefile2:1469: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n[ 77%] Linking CXX shared module python/caffe2_pybind11_state.so\n[ 77%] Built target caffe2_pybind11_state\nMakefile:138: recipe for target 'all' failed\nmake: *** [all] Error 2\nTraceback (most recent call last):\nFile \"setup_caffe2.py\", line 271, in \n'convert-onnx-to-caffe2 = caffe2.python.onnx.bin.conversion:onnx_to_caffe2',\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/init.py\", line 131, in setup\nreturn distutils.core.setup(**attrs)\nFile \"/usr/lib/python2.7/distutils/core.py\", line 151, in setup\ndist.run_commands()\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 953, in run_commands\nself.run_command(cmd)\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\ncmd_obj.run()\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install.py\", line 67, in run\nself.do_egg_install()\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install.py\", line 109, in do_egg_install\nself.run_command('bdist_egg')\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\nself.distribution.run_command(command)\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\ncmd_obj.run()\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/bdist_egg.py\", line 172, in run\ncmd = self.call_command('install_lib', warn_dir=0)\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/bdist_egg.py\", line 158, in call_command\nself.run_command(cmdname)\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\nself.distribution.run_command(command)\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\ncmd_obj.run()\nFile \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install_lib.py\", line 11, in run\nself.build()\nFile \"/usr/lib/python2.7/distutils/command/install_lib.py\", line 109, in build\nself.run_command('build_py')\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\nself.distribution.run_command(command)\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\ncmd_obj.run()\nFile \"setup_caffe2.py\", line 163, in run\nself.run_command('cmake_build')\nFile \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\nself.distribution.run_command(command)\nFile \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\ncmd_obj.run()\nFile \"setup_caffe2.py\", line 157, in run\nsubprocess.check_call(build_args)\nFile \"/usr/lib/python2.7/subprocess.py\", line 541, in check_call\nraise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '[u'/usr/bin/make', u'-j', '8']' returned non-zero exit status 2\n### build using  make install \n15 )  Changed to directory build : cd build\n(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/pytorch/build$\n\n\nexecuted : make install\n **Error :**   \n\n\n\nLinking CXX shared module python/caffe2_pybind11_state.so\n[ 62%] Built target caffe2_pybind11_state\n[ 62%] Built target python_copy_files\n[ 62%] Built target ATEN_CUDA_FILES_GEN_TARGET\n[ 62%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\nfrom /usr/local/cuda/include/cuda_runtime.h:115,\nfrom :0:\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\" is not valid in preprocessor expressions\n#define CUDACC_VER \"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\n^\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018CUDACC_VER\u2019\n#if defined(CUDACC_VER) &&  CUDACC_VER >= 70500 && __cplusplus > 199711L\n^\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\nError generating\n/home/rv/venvs/detectron_1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\nCMakeFiles/Makefile2:2104: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\nMakefile:138: recipe for target 'all' failed\nmake: *** [all] Error 2\nOutputs asked by @pjh5\n(PS : My virtual environment is detectron_1 and i created it inside directory  /home/rv/venvs/  )\n\n\n(detectron_1) rv@rv-HP-ZBook-15-G3:~$ which python\n/home/rv/venvs/detectron_1/bin/python\n\n\n(detectron_1) rv@rv-HP-ZBook-15-G3:$  which pip\n/home/rv/venvs/detectron_1/bin/pip\n3)(detectron_1) rv@rv-HP-ZBook-15-G3:$  python --version\nPython 2.7.1\n4)(detectron_1) rv@rv-HP-ZBook-15-G3:$  pip freeze | grep distutils\n(detectron_1) rv@rv-HP-ZBook-15-G3:$\n(PS: No output inside virtual enviornment. In usual terminal I am getting output)\n\n\n(detectron_1) rv@rv-HP-ZBook-15-G3:~$ which nvcc\n/usr/local/cuda-9.0/bin/nvcc\n\n\n(detectron_1) rv@rv-HP-ZBook-15-G3:~$ nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2017 NVIDIA Corporation\nBuilt on Sun_Nov_19_03:10:15_CST_2017\nCuda compilation tools, release 9.0, V9.0.252\n\n\n7)(detectron_1) rv@rv-HP-ZBook-15-G3:$ gcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu116.04.9' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9)\nPlease let me know if any relevant information I am missing.\nSetting PYTHONPATH and LD_LIBRARY_PATH\nQ5\nIn many issues I have found about setting up enviornment variables. Should I set the build directory in PYTHONPATH ?\nThanks in advance", "body": "Thanks for helping @pjh5 \r\n\r\nOkay I will describe steps I followed to install . ( \r\n\r\n1) Created a virtual enviornment <detectron_1> using following command : \r\n `virtualenv venvs/detectron_1`\r\n\r\n2)Activated the environment $detectron_1  by going to bin directory </venvs/detectron_1/bin> and using command : \r\n   rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/bin$ `source activate`\r\n\r\n\r\n### Installing \r\n\r\nNow started to install Caffe2 following instructions from : \r\n[https://caffe2.ai/docs/getting-started.html?platform=ubuntu&configuration=compile](url)\r\n\r\nHere i have a question !!! (PS : **I name questions as Q1 , Q2 etc..** , so that if anyone can answer mentioning the question number it will be easier) \r\n\r\n**Q1)** In the above mentioned link it uses `sudo apt-get update`  and `sudo apt-get install -y --no-install-recommends \\build-essential`  . **Since I am in a virtual environment , should I change anything** ?  \r\n\r\n**Now I am inside virtual environment <detectron_1>** :\r\n### Installing caffe2 following the instructions : \r\n\r\n3) Executed  :   `sudo apt-get update`\r\n\r\n4) Executed :  `sudo apt-get install -y --no-install-recommends \\\r\n      build-essential \\\r\n      cmake \\\r\n      git \\\r\n      libgoogle-glog-dev \\\r\n      libgtest-dev \\\r\n      libiomp-dev \\\r\n      libleveldb-dev \\\r\n      liblmdb-dev \\\r\n      libopencv-dev \\\r\n      libopenmpi-dev \\\r\n      libsnappy-dev \\\r\n      libprotobuf-dev \\\r\n      openmpi-bin \\\r\n      openmpi-doc \\\r\n      protobuf-compiler \\\r\n      python-dev \\\r\n      python-pip          `\r\n\r\n5) Executed : \r\n      ``` pip install \\\r\n        future \\\r\n      numpy \\\r\n      protobuf ```\r\n\r\n\r\n\r\n(PS : As per instructions it is **sudo**  , since I am inside a virtual environment , I ran **without sudo** .\r\nPlease correct me if I am wrong )\r\n\r\nI checked inside  /home/rv/venvs/detectron_1/lib/python2.7/site-packages and all the packages are installed .\r\n\r\n6) Again as per the instructions , I executed  : \r\n   \r\n`sudo apt-get install -y --no-install-recommends libgflags-dev`\r\n\r\n**Q2: Should I modify this command to execute inside a virtual environment ?** \r\n\r\n\r\n\r\nNow am inside directory /venvs/detectron_1\r\n\r\n**`(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1$`**\r\n\r\n### Clone and Build\r\n\r\n7)\r\n\r\n**Executed** : `git clone --recursive https://github.com/pytorch/pytorch.git && cd pytorch`\r\n    cloned pytorch directory inside virtual environment \r\n\r\n8)   Executed : `git submodule update --init `\r\n\r\n9) Executed : `mkdir build && cd build`\r\n\r\n10) executed : `cmake ..`\r\n \r\n**And output of cmake is as follows** : \r\n\r\n  `(detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/pytorch/build$ cmake ..`\r\n\r\n-- The CXX compiler identification is GNU 5.4.0\r\n-- The C compiler identification is GNU 5.4.0\r\n-- Check for working CXX compiler: /usr/bin/c++\r\n-- Check for working CXX compiler: /usr/bin/c++ -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Check for working C compiler: /usr/bin/cc\r\n-- Check for working C compiler: /usr/bin/cc -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Not forcing any particular BLAS to be found\r\n-- Build type not set - defaulting to Release\r\n-- Performing Test CAFFE2_LONG_IS_INT32_OR_64\r\n-- Performing Test CAFFE2_LONG_IS_INT32_OR_64 - Success\r\n-- Does not need to define long separately.\r\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED\r\n-- Performing Test CAFFE2_EXCEPTION_PTR_SUPPORTED - Success\r\n-- std::exception_ptr is supported.\r\n-- Performing Test CAFFE2_IS_NUMA_AVAILABLE\r\n-- Performing Test CAFFE2_IS_NUMA_AVAILABLE - Success\r\n-- NUMA is available\r\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING\r\n-- Performing Test CAFFE2_NEED_TO_TURN_OFF_DEPRECATION_WARNING - Success\r\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS\r\n-- Performing Test CAFFE2_COMPILER_SUPPORTS_AVX2_EXTENSIONS - Success\r\n-- Current compiler supports avx2 extention. Will build perfkernels.\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_VISIBILITY - Success\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY\r\n-- Performing Test COMPILER_SUPPORTS_HIDDEN_INLINE_VISIBILITY - Success\r\n-- Building using own protobuf under third_party per request.\r\n-- Use custom protobuf build.\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - found\r\n-- Looking for pthread_create\r\n-- Looking for pthread_create - not found\r\n-- Looking for pthread_create in pthreads\r\n-- Looking for pthread_create in pthreads - not found\r\n-- Looking for pthread_create in pthread\r\n-- Looking for pthread_create in pthread - found\r\n-- Found Threads: TRUE  \r\n-- Caffe2 protobuf include directory: $<BUILD_INTERFACE:/home/rv/venvs/detectron_1/pytorch/third_party/protobuf/src>$<INSTALL_INTERFACE:include>\r\n-- Found Git: /usr/bin/git (found version \"2.7.4\") \r\n-- The BLAS backend of choice:Eigen\r\n-- Brace yourself, we are building NNPACK\r\n-- The ASM compiler identification is GNU\r\n-- Found assembler: /usr/bin/cc\r\n-- Found PythonInterp: /home/rv/venvs/detectron_1/bin/python (found version \"2.7.12\") \r\n-- Check if compiler accepts -pthread\r\n-- Check if compiler accepts -pthread - yes\r\n-- Caffe2: Cannot find gflags automatically. Using legacy find.\r\n-- Found gflags: /usr/include  \r\n-- Caffe2: Found gflags  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libgflags.so)\r\n-- Caffe2: Cannot find glog automatically. Using legacy find.\r\n-- Found glog: /usr/include  \r\n-- Caffe2: Found glog (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libglog.so)\r\n-- Found LMDB: /usr/include  \r\n-- Found lmdb    (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/liblmdb.so)\r\n-- Found LevelDB: /usr/include  \r\n-- Found LevelDB (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libleveldb.so)\r\n-- Found Snappy: /usr/include  \r\n-- Found Snappy  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libsnappy.so)\r\n-- Found Numa: /usr/include  \r\n-- Found Numa  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnuma.so)\r\n-- OpenCV found (/usr/share/OpenCV)\r\n-- Found system Eigen at /usr/include/eigen3\r\n-- Found PythonInterp: /home/rv/venvs/detectron_1/bin/python (found suitable version \"2.7.12\", minimum required is \"2.7\") \r\n-- Found PythonLibs: /usr/lib/x86_64-linux-gnu/libpython2.7.so (found suitable version \"2.7.12\", minimum required is \"2.7\") \r\n-- Found NumPy: /home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/numpy/core/include (found version \"1.14.5\") \r\n-- NumPy ver. 1.14.5 found (include: /home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/numpy/core/include)\r\n-- Could NOT find pybind11 (missing:  pybind11_INCLUDE_DIR) \r\n-- Found MPI_C: /usr/lib/openmpi/lib/libmpi.so  \r\n-- Found MPI_CXX: /usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so  \r\n-- MPI support found\r\n-- MPI compile flags: \r\n-- MPI include path: /usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/include/usr/lib/openmpi/include/usr/lib/openmpi/include/openmpi\r\n-- MPI LINK flags path:  -Wl,-rpath  -Wl,/usr/lib/openmpi/lib  -Wl,--enable-new-dtags\r\n-- MPI libraries: /usr/lib/openmpi/lib/libmpi_cxx.so/usr/lib/openmpi/lib/libmpi.so\r\nCMake Warning at cmake/Dependencies.cmake:396 (message):\r\n  OpenMPI found, but it is not built with CUDA support.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:187 (include)\r\n\r\n\r\n-- Found CUDA: /usr/local/cuda (found suitable version \"9.0\", minimum required is \"7.0\") \r\n-- Caffe2: CUDA detected: 9.0\r\n-- Caffe2: CUDA nvcc is: /usr/local/cuda/bin/nvcc\r\n-- Caffe2: CUDA toolkit directory: /usr/local/cuda\r\n-- Caffe2: Header version is: 9.0\r\n-- Found CUDNN: /usr/include  \r\n-- Found cuDNN: v7.1.4  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libcudnn.so)\r\n-- Autodetected CUDA architecture(s): 5.0 \r\n-- Added CUDA NVCC flags for: -gencode;arch=compute_50,code=sm_50\r\n-- **Could NOT find NCCL (missing:  NCCL_INCLUDE_DIRS NCCL_LIBRARIES) \r\n-- Could NOT find CUB (missing:  CUB_INCLUDE_DIR) \r\n-- Could NOT find Gloo (missing:  Gloo_INCLUDE_DIR Gloo_LIBRARY)** \r\n-- MPI include path: /usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/usr/lib/openmpi/include/openmpi/opal/mca/event/libevent2021/libevent/include/usr/lib/openmpi/include/usr/lib/openmpi/include/openmpi\r\n-- MPI libraries: /usr/lib/openmpi/lib/libmpi_cxx.so/usr/lib/openmpi/lib/libmpi.so\r\n-- CUDA detected: 9.0\r\n-- Found libcuda: /usr/local/cuda-9.0/lib64/stubs/libcuda.so\r\n-- Found libnvrtc: /usr/local/cuda-9.0/lib64/libnvrtc.so\r\n-- Could NOT find NCCL (missing:  NCCL_INCLUDE_DIR NCCL_LIBRARY) \r\nCMake Warning at third_party/gloo/cmake/Dependencies.cmake:62 (message):\r\n  Not compiling with NCCL support.  Suppress this warning with\r\n  -DUSE_NCCL=OFF.\r\nCall Stack (most recent call first):\r\n  third_party/gloo/CMakeLists.txt:56 (include)\r\n\r\n\r\nCMake Warning at cmake/Dependencies.cmake:623 (message):\r\n  mobile opengl is only used in android or ios builds.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:187 (include)\r\n\r\n\r\nCMake Warning at cmake/Dependencies.cmake:699 (message):\r\n  Metal is only used in ios builds.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:187 (include)\r\n\r\n\r\n-- GCC 5.4.0: Adding gcc and gcc_s libs to link line\r\n-- Include NCCL operators\r\n-- Excluding ideep operators as we are not using ideep\r\n-- Including image processing operators\r\n-- Excluding video processing operators due to no opencv\r\n-- Excluding mkl operators as we are not using mkl\r\n-- Include Observer library\r\n-- Using lib/python2.7/site-packages as python relative installation path\r\n-- Automatically generating missing __init__.py files.\r\nCMake Warning at CMakeLists.txt:353 (message):\r\n  Generated cmake files are only fully tested if one builds with system glog,\r\n  gflags, and protobuf.  Other settings may generate files that are not well\r\n  tested.\r\n\r\n\r\n-- \r\n### -- ******** Summary ********\r\n-- General:\r\n--   CMake version         : 3.5.1\r\n--   CMake command         : /usr/bin/cmake\r\n--   Git version           : v0.1.11-9260-g04a7fc1\r\n--   System                : Linux\r\n--   C++ compiler          : /usr/bin/c++\r\n--   C++ compiler version  : 5.4.0\r\n--   BLAS                  : Eigen\r\n--   CXX flags             :  -fvisibility-inlines-hidden -DONNX_NAMESPACE=onnx_c2 -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-aliasing -Wno-error=deprecated-declarations\r\n--   Build type            : Release\r\n--   Compile definitions   : \r\n--   CMAKE_PREFIX_PATH     : \r\n--   CMAKE_INSTALL_PREFIX  : /usr/local\r\n-- \r\n--   BUILD_CAFFE2          : ON\r\n--   BUILD_ATEN            : OFF\r\n--   BUILD_BINARY          : ON\r\n--   BUILD_CUSTOM_PROTOBUF : ON\r\n--     Link local protobuf : ON\r\n--   BUILD_DOCS            : OFF\r\n--   BUILD_PYTHON          : ON\r\n--     Python version      : 2.7.12\r\n--     Python executable   : /home/rv/venvs/detectron_1/bin/python\r\n--     Python includes     : /home/rv/venvs/detectron_1/include/python2.7\r\n--     Python site-packages: lib/python2.7/site-packages\r\n--   BUILD_SHARED_LIBS     : ON\r\n--   BUILD_TEST            : OFF\r\n--   USE_ASAN              : OFF\r\n--   USE_ATEN              : OFF\r\n--   USE_CUDA              : ON\r\n--     CUDA static link    : OFF\r\n--     USE_CUDNN           : ON\r\n--     CUDA version        : 9.0\r\n--     cuDNN version       : 7.1.4\r\n--     CUDA root directory : /usr/local/cuda\r\n--     CUDA library        : /usr/local/cuda-9.0/lib64/stubs/libcuda.so\r\n--     cudart library      : /usr/local/cuda/lib64/libcudart_static.a;-pthread;dl;/usr/lib/x86_64-linux-gnu/librt.so\r\n--     cublas library      : /usr/local/cuda/lib64/libcublas.so;/usr/local/cuda/lib64/libcublas_device.a\r\n--     cufft library       : /usr/local/cuda/lib64/libcufft.so\r\n--     curand library      : /usr/local/cuda/lib64/libcurand.so\r\n--     cuDNN library       : /usr/lib/x86_64-linux-gnu/libcudnn.so\r\n--     nvrtc               : /usr/local/cuda-9.0/lib64/libnvrtc.so\r\n--     CUDA include path   : /usr/local/cuda/include\r\n--     NVCC executable     : /usr/local/cuda/bin/nvcc\r\n--     CUDA host compiler  : /usr/bin/cc\r\n--     USE_TENSORRT        : OFF\r\n--   USE_ROCM              : OFF\r\n--   USE_EIGEN_FOR_BLAS    : ON\r\n--   USE_FFMPEG            : OFF\r\n--   USE_GFLAGS            : ON\r\n--   USE_GLOG              : ON\r\n--   USE_GLOO              : ON\r\n--     USE_GLOO_IBVERBS    : OFF\r\n--   USE_LEVELDB           : ON\r\n--     LevelDB version     : 1.18\r\n--     Snappy version      : 1.1.3\r\n--   USE_LITE_PROTO        : OFF\r\n--   USE_LMDB              : ON\r\n--     LMDB version        : 0.9.17\r\n--   USE_METAL             : OFF\r\n--   USE_MKL               : \r\n--   USE_MOBILE_OPENGL     : OFF\r\n--   USE_MPI               : ON\r\n--   USE_NCCL              : ON\r\n--     USE_SYSTEM_NCCL     : OFF\r\n--   USE_NERVANA_GPU       : OFF\r\n--   USE_NNPACK            : ON\r\n--   USE_OBSERVERS         : ON\r\n--   USE_OPENCL            : OFF\r\n--   USE_OPENCV            : ON\r\n--     OpenCV version      : 3.3.1\r\n--   USE_OPENMP            : OFF\r\n--   USE_PROF              : OFF\r\n--   USE_REDIS             : OFF\r\n--   USE_ROCKSDB           : OFF\r\n--   USE_ZMQ               : OFF\r\n--   Public Dependencies  : Threads::Threads;gflags;glog::glog\r\n--   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/liblmdb.so;/usr/lib/x86_64-linux-gnu/libleveldb.so;/usr/lib/x86_64-linux-gnu/libsnappy.so;/usr/lib/x86_64-linux-gnu/libnuma.so;opencv_core;opencv_highgui;opencv_imgproc;opencv_imgcodecs;opencv_videoio;opencv_video;/usr/lib/openmpi/lib/libmpi_cxx.so;/usr/lib/openmpi/lib/libmpi.so;gloo;onnxifi_loader;gcc_s;gcc;dl\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /home/rv/venvs/detectron_1/pytorch/build\r\n\r\n\r\n**Q3** : Some directories are NOT FOUND ( which has been converted into bold text in cmkae outpu above) . Is it something to be worried ? \r\n\r\n\r\nNow went back to the directory pytorch using \r\n\r\n`cd /home/rv/venvs/detectron_1/pytorch`\r\n\r\n**### **Build**  using  `FULL_CAFFE2=1 python setup.py install`** \r\n\r\n11) executed : `FULL_CAFFE2=1 python setup.py install` \r\n                                     (as @pjh5  suggested to build Caffe2 along with Pytorch )\r\n\r\n                **error** : RuntimeError: Missing build dependency: Unable to `import yaml`.\r\n                                RuntimeError: Missing build dependency: Unable to `import typing`.\r\n\r\n12) executed :` pip install pyyaml`\r\n                         `pip install typing`\r\n                          \r\n\r\n13)  executed : `FULL_CAFFE2=1 python setup.py install` \r\n\r\n      **Error :**\r\n [ 64%] Linking CXX shared library ../lib/libcaffe2.so\r\n[ 64%] Built target caffe2\r\nScanning dependencies of target caffe2_pybind11_state\r\nScanning dependencies of target caffe2_observers\r\n[ 64%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o\r\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCBlas.cu.o\r\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCReduceApplyUtils.cu.o\r\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCSleep.cu.o\r\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorageCopy.cu.o\r\n[ 65%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/__/aten/src/THC/caffe2_gpu_generated_THCStorage.cu.o\r\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/net_observer_reporter_print.cc.o\r\n[ 65%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state.cc.o\r\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\r\n                 from /usr/local/cuda/include/cuda_runtime.h:115,\r\n                 from <command-line>:0:\r\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\" is not valid in preprocessor expressions\r\n #define __CUDACC_VER__ \"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\r\n                        ^\r\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018__CUDACC_VER__\u2019\r\n #if defined(__CUDACC_VER__) &&  __CUDACC_VER__ >= 70500 && __cplusplus > 199711L\r\n                                 ^\r\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /home/rv/venvs/detectron_1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\r\n\r\n\r\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\n[ 65%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state_dlpack.cc.o\r\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o\r\n[ 65%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o\r\n[ 65%] Linking CXX shared library ../../lib/libcaffe2_observers.so\r\n[ 65%] Built target caffe2_observers\r\nCMakeFiles/Makefile2:2104: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n[ 65%] Linking CXX shared module python/caffe2_pybind11_state.so\r\n[ 65%] Built target caffe2_pybind11_state\r\nMakefile:138: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --full-caffe2 nccl caffe2 nanopb libshm gloo THD c10d'\r\n\r\n\r\n**Q4 **  What is the difference between  **setup.py** and **setup_caffe2.py** ? \r\n\r\n\r\n### **Build** using `python setup_caffe2.py install`\r\n\r\n\r\n14) executed : `python setup_caffe2.py install` \r\n\r\n     **Error :** \r\n\r\n       [ 77%] Linking CXX static library ../../lib/libcaffe2_observers.a\r\n[ 77%] Built target caffe2_observers\r\nLinking   libnccl.so.1.3.5                    > /home/rv/venvs/detectron_1/pytorch/third_party/nccl/build/lib/libnccl.so.1.3.5\r\nArchiving libnccl_static.a                    > /home/rv/venvs/detectron_1/pytorch/third_party/nccl/build/lib/libnccl_static.a\r\n[ 77%] No install step for 'nccl_external'\r\n[ 77%] Completed 'nccl_external'\r\n[ 77%] Built target nccl_external\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/sgd/caffe2_gpu_generated_adagrad_op_gpu.cu.o\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/core/caffe2_gpu_generated_context_gpu.cu.o\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/core/caffe2_gpu_generated_THCCachingAllocator.cu.o\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/image/caffe2_gpu_generated_transform_gpu.cu.o\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o\r\n[ 77%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_boolean_unmask_ops.cu.o\r\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\r\n                 from /usr/local/cuda/include/cuda_runtime.h:115,\r\n                 from <command-line>:0:\r\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\" is not valid in preprocessor expressions\r\n #define __CUDACC_VER__ \"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\r\n                        ^\r\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018__CUDACC_VER__\u2019\r\n #if defined(__CUDACC_VER__) &&  __CUDACC_VER__ >= 70500 && __cplusplus > 199711L\r\n                                 ^\r\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\r\n                 from /usr/local/cuda/include/cuda_runtime.h:115,\r\n                 from <command-line>:0:\r\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\" is not valid in preprocessor expressions\r\n #define __CUDACC_VER__ \"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\r\n                        ^\r\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018__CUDACC_VER__\u2019\r\n #if defined(__CUDACC_VER__) &&  __CUDACC_VER__ >= 70500 && __cplusplus > 199711L\r\n                                 ^\r\nCMake Error at caffe2_gpu_generated_logit_op.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /home/rv/venvs/detectron_1/pytorch/.setuptools-cmake-build/caffe2/CMakeFiles/caffe2_gpu.dir/operators/./caffe2_gpu_generated_logit_op.cu.o\r\n\r\n\r\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:98: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o' failed\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/operators/caffe2_gpu_generated_logit_op.cu.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /home/rv/venvs/detectron_1/pytorch/.setuptools-cmake-build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\r\n\r\n\r\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\r\nCMakeFiles/Makefile2:1469: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n[ 77%] Linking CXX shared module python/caffe2_pybind11_state.so\r\n[ 77%] Built target caffe2_pybind11_state\r\nMakefile:138: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\nTraceback (most recent call last):\r\n  File \"setup_caffe2.py\", line 271, in <module>\r\n    'convert-onnx-to-caffe2 = caffe2.python.onnx.bin.conversion:onnx_to_caffe2',\r\n  File \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/__init__.py\", line 131, in setup\r\n    return distutils.core.setup(**attrs)\r\n  File \"/usr/lib/python2.7/distutils/core.py\", line 151, in setup\r\n    dist.run_commands()\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 953, in run_commands\r\n    self.run_command(cmd)\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install.py\", line 67, in run\r\n    self.do_egg_install()\r\n  File \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install.py\", line 109, in do_egg_install\r\n    self.run_command('bdist_egg')\r\n  File \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\r\n    self.distribution.run_command(command)\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/bdist_egg.py\", line 172, in run\r\n    cmd = self.call_command('install_lib', warn_dir=0)\r\n  File \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/bdist_egg.py\", line 158, in call_command\r\n    self.run_command(cmdname)\r\n  File \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\r\n    self.distribution.run_command(command)\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"/home/rv/venvs/detectron_1/local/lib/python2.7/site-packages/setuptools/command/install_lib.py\", line 11, in run\r\n    self.build()\r\n  File \"/usr/lib/python2.7/distutils/command/install_lib.py\", line 109, in build\r\n    self.run_command('build_py')\r\n  File \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\r\n    self.distribution.run_command(command)\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"setup_caffe2.py\", line 163, in run\r\n    self.run_command('cmake_build')\r\n  File \"/usr/lib/python2.7/distutils/cmd.py\", line 326, in run_command\r\n    self.distribution.run_command(command)\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"setup_caffe2.py\", line 157, in run\r\n    subprocess.check_call(build_args)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 541, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command '[u'/usr/bin/make', u'-j', '8']' returned non-zero exit status 2\r\n\r\n\r\n\r\n\r\n\r\n\r\n**### build using  `make install `**  \r\n\r\n\r\n15 )  Changed to directory build :` cd build`\r\n         (detectron_1) rv@rv-HP-ZBook-15-G3:~/venvs/detectron_1/pytorch/build$\r\n\r\n16)  executed : make install\r\n \r\n          **Error :**   \r\n\r\n Linking CXX shared module python/caffe2_pybind11_state.so\r\n[ 62%] Built target caffe2_pybind11_state\r\n[ 62%] Built target python_copy_files\r\n[ 62%] Built target ATEN_CUDA_FILES_GEN_TARGET\r\n[ 62%] Building NVCC (Device) object caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o\r\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\r\n                 from /usr/local/cuda/include/cuda_runtime.h:115,\r\n                 from <command-line>:0:\r\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\" is not valid in preprocessor expressions\r\n #define __CUDACC_VER__ \"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\r\n                        ^\r\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018__CUDACC_VER__\u2019\r\n #if defined(__CUDACC_VER__) &&  __CUDACC_VER__ >= 70500 && __cplusplus > 199711L\r\n                                 ^\r\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /home/rv/venvs/detectron_1/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\r\n\r\n\r\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\r\nCMakeFiles/Makefile2:2104: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\r\nMakefile:138: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\n\r\n       \r\n\r\n\r\n\r\n\r\n\r\n\r\n### Outputs asked by @pjh5 \r\n\r\n   (PS : My virtual environment is **detectron_1** and i created it inside directory  **/home/rv/venvs/**  )\r\n\r\n1)  (detectron_1) rv@rv-HP-ZBook-15-G3:~$ `which python`\r\n      /home/rv/venvs/detectron_1/bin/python\r\n2) (detectron_1) rv@rv-HP-ZBook-15-G3:~$ ` which pip`\r\n         /home/rv/venvs/detectron_1/bin/pip\r\n3)(detectron_1) rv@rv-HP-ZBook-15-G3:~$  `python --version`\r\n        Python 2.7.1\r\n4)(detectron_1) rv@rv-HP-ZBook-15-G3:~$  `pip freeze | grep distutils`\r\n    (detectron_1) rv@rv-HP-ZBook-15-G3:~$\r\n        (PS: No output inside virtual enviornment. In usual terminal I am getting output)\r\n\r\n5) (detectron_1) rv@rv-HP-ZBook-15-G3:~$ `which nvcc`\r\n/usr/local/cuda-9.0/bin/nvcc\r\n\r\n6) (detectron_1) rv@rv-HP-ZBook-15-G3:~$ `nvcc --version`\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2017 NVIDIA Corporation\r\nBuilt on Sun_Nov_19_03:10:15_CST_2017\r\nCuda compilation tools, release 9.0, V9.0.252\r\n\r\n7)(detectron_1) rv@rv-HP-ZBook-15-G3:~$ gcc -v\r\nUsing built-in specs.\r\nCOLLECT_GCC=gcc\r\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper\r\nTarget: x86_64-linux-gnu\r\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu1~16.04.9' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\r\nThread model: posix\r\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9) \r\n\r\n\r\n\r\n\r\n\r\nPlease let me know if any relevant information I am missing.\r\n\r\n### Setting PYTHONPATH and LD_LIBRARY_PATH\r\n\r\n### **Q5**\r\nIn many issues I have found about setting up enviornment variables. Should I set the build directory in PYTHONPATH ? \r\n\r\n\r\n\r\nThanks in advance\r\n\r\n"}