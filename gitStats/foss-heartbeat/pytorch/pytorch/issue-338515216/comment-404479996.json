{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/404479996", "html_url": "https://github.com/pytorch/pytorch/issues/9181#issuecomment-404479996", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9181", "id": 404479996, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNDQ3OTk5Ng==", "user": {"login": "Rahul-Venugopal", "id": 30955455, "node_id": "MDQ6VXNlcjMwOTU1NDU1", "avatar_url": "https://avatars1.githubusercontent.com/u/30955455?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rahul-Venugopal", "html_url": "https://github.com/Rahul-Venugopal", "followers_url": "https://api.github.com/users/Rahul-Venugopal/followers", "following_url": "https://api.github.com/users/Rahul-Venugopal/following{/other_user}", "gists_url": "https://api.github.com/users/Rahul-Venugopal/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rahul-Venugopal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rahul-Venugopal/subscriptions", "organizations_url": "https://api.github.com/users/Rahul-Venugopal/orgs", "repos_url": "https://api.github.com/users/Rahul-Venugopal/repos", "events_url": "https://api.github.com/users/Rahul-Venugopal/events{/privacy}", "received_events_url": "https://api.github.com/users/Rahul-Venugopal/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-12T11:24:26Z", "updated_at": "2018-07-12T11:24:26Z", "author_association": "NONE", "body_html": "<p>Thank you <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a>  so much for explaining this and you really helped me to clarify many confusions I had in general. Since I am  a beginner to this , I am not sure about those things.</p>\n<p>So now I have created another virtual environment and  tried to run <code>python setup.py install </code><strong>(DID NOT run<code> cmake ..</code></strong>).  Now everything is fine and build is complete .<br>\n<strong>But</strong><br>\n<strong>I cannot import caffe2</strong> from python</p>\n<p>Q1) As <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6456020\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/pjh5\">@pjh5</a>  said</p>\n<blockquote>\n<p>setup.py can install both Pytorch and Caffe2</p>\n</blockquote>\n<p>, then why <code>python setup.py install </code> does not build with Caffe2  ?<br>\n( PS : I see torch created inside /home/rv/venvs/detectron_2/lib/python2.7/site-packages , but Caffe2 is NOT created inside site-packages)</p>\n<h3>I created a new virtual environment and tried to build using <code>FULL_CAFFE2=1 python setup.py install </code></h3>\n<p>ran :  <code>FULL_CAFFE2=1 python setup.py install</code><br>\nand I am getting following error (<strong>PS : DID NOT ran cmake ..</strong> )</p>\n<h3><strong>Error</strong></h3>\n<p>In file included from /usr/local/cuda/include/common_functions.h:50:0,<br>\nfrom /usr/local/cuda/include/cuda_runtime.h:115,<br>\nfrom :0:<br>\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"\" is not valid in preprocessor expressions<br>\n#define <strong>CUDACC_VER</strong> \"<strong>CUDACC_VER</strong> is no longer supported.  Use <strong>CUDACC_VER_MAJOR</strong>, <strong>CUDACC_VER_MINOR</strong>, and <strong>CUDACC_VER_BUILD</strong> instead.\"<br>\n^<br>\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018<strong>CUDACC_VER</strong>\u2019<br>\n#if defined(<strong>CUDACC_VER</strong>) &amp;&amp;  <strong>CUDACC_VER</strong> &gt;= 70500 &amp;&amp; __cplusplus &gt; 199711L<br>\n^<br>\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):<br>\nError generating<br>\n/home/rv/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o</p>\n<p>caffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed<br>\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1<br>\nmake[2]: *** Waiting for unfinished jobs....<br>\n[ 66%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state_dlpack.cc.o<br>\n[ 66%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o<br>\n[ 66%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o<br>\n[ 66%] Linking CXX shared library ../../lib/libcaffe2_observers.so<br>\n[ 66%] Built target caffe2_observers<br>\nCMakeFiles/Makefile2:1827: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed<br>\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2<br>\nmake[1]: *** Waiting for unfinished jobs....<br>\n[ 66%] Linking CXX shared module python/caffe2_pybind11_state.so<br>\n[ 66%] Built target caffe2_pybind11_state<br>\nMakefile:138: recipe for target 'all' failed<br>\nmake: *** [all] Error 2<br>\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --full-caffe2 nccl caffe2 nanopb libshm gloo THD c10d'</p>\n<p>Thanks in advance for any help.</p>", "body_text": "Thank you @pjh5  so much for explaining this and you really helped me to clarify many confusions I had in general. Since I am  a beginner to this , I am not sure about those things.\nSo now I have created another virtual environment and  tried to run python setup.py install (DID NOT run cmake ..).  Now everything is fine and build is complete .\nBut\nI cannot import caffe2 from python\nQ1) As @pjh5  said\n\nsetup.py can install both Pytorch and Caffe2\n\n, then why python setup.py install  does not build with Caffe2  ?\n( PS : I see torch created inside /home/rv/venvs/detectron_2/lib/python2.7/site-packages , but Caffe2 is NOT created inside site-packages)\nI created a new virtual environment and tried to build using FULL_CAFFE2=1 python setup.py install \nran :  FULL_CAFFE2=1 python setup.py install\nand I am getting following error (PS : DID NOT ran cmake .. )\nError\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\nfrom /usr/local/cuda/include/cuda_runtime.h:115,\nfrom :0:\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\" is not valid in preprocessor expressions\n#define CUDACC_VER \"CUDACC_VER is no longer supported.  Use CUDACC_VER_MAJOR, CUDACC_VER_MINOR, and CUDACC_VER_BUILD instead.\"\n^\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018CUDACC_VER\u2019\n#if defined(CUDACC_VER) &&  CUDACC_VER >= 70500 && __cplusplus > 199711L\n^\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\nError generating\n/home/rv/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\n[ 66%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state_dlpack.cc.o\n[ 66%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o\n[ 66%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o\n[ 66%] Linking CXX shared library ../../lib/libcaffe2_observers.so\n[ 66%] Built target caffe2_observers\nCMakeFiles/Makefile2:1827: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\nmake[1]: *** Waiting for unfinished jobs....\n[ 66%] Linking CXX shared module python/caffe2_pybind11_state.so\n[ 66%] Built target caffe2_pybind11_state\nMakefile:138: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --full-caffe2 nccl caffe2 nanopb libshm gloo THD c10d'\nThanks in advance for any help.", "body": "Thank you @pjh5  so much for explaining this and you really helped me to clarify many confusions I had in general. Since I am  a beginner to this , I am not sure about those things.\r\n\r\nSo now I have created another virtual environment and  tried to run `python setup.py install `**(DID NOT run` cmake ..`**).  Now everything is fine and build is complete .  \r\n**But**\r\n **I cannot import caffe2** from python \r\n\r\nQ1) As @pjh5  said \r\n\r\n> setup.py can install both Pytorch and Caffe2 \r\n\r\n, then why `python setup.py install ` does not build with Caffe2  ? \r\n( PS : I see torch created inside /home/rv/venvs/detectron_2/lib/python2.7/site-packages , but Caffe2 is NOT created inside site-packages) \r\n\r\n### I created a new virtual environment and tried to build using `FULL_CAFFE2=1 python setup.py install ` \r\n\r\nran :  `FULL_CAFFE2=1 python setup.py install`  \r\n and I am getting following error (**PS : DID NOT ran cmake ..** )\r\n\r\n### **Error**\r\n\r\nIn file included from /usr/local/cuda/include/common_functions.h:50:0,\r\n                 from /usr/local/cuda/include/cuda_runtime.h:115,\r\n                 from <command-line>:0:\r\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\" is not valid in preprocessor expressions\r\n #define __CUDACC_VER__ \"__CUDACC_VER__ is no longer supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD__ instead.\"\r\n                        ^\r\n/usr/include/eigen3/Eigen/src/Core/util/Macros.h:364:33: note: in expansion of macro \u2018__CUDACC_VER__\u2019\r\n #if defined(__CUDACC_VER__) &&  __CUDACC_VER__ >= 70500 && __cplusplus > 199711L\r\n                                 ^\r\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:219 (message):\r\n  Error generating\r\n  /home/rv/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_generated_math_gpu.cu.o\r\n\r\n\r\ncaffe2/CMakeFiles/caffe2_gpu.dir/build.make:63: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o' failed\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/utils/caffe2_gpu_generated_math_gpu.cu.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\n[ 66%] Building CXX object caffe2/CMakeFiles/caffe2_pybind11_state.dir/python/pybind_state_dlpack.cc.o\r\n[ 66%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/observer_config.cc.o\r\n[ 66%] Building CXX object modules/observers/CMakeFiles/caffe2_observers.dir/perf_observer.cc.o\r\n[ 66%] Linking CXX shared library ../../lib/libcaffe2_observers.so\r\n[ 66%] Built target caffe2_observers\r\nCMakeFiles/Makefile2:1827: recipe for target 'caffe2/CMakeFiles/caffe2_gpu.dir/all' failed\r\nmake[1]: *** [caffe2/CMakeFiles/caffe2_gpu.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n[ 66%] Linking CXX shared module python/caffe2_pybind11_state.so\r\n[ 66%] Built target caffe2_pybind11_state\r\nMakefile:138: recipe for target 'all' failed\r\nmake: *** [all] Error 2\r\nFailed to run 'bash tools/build_pytorch_libs.sh --use-cuda --use-nnpack --full-caffe2 nccl caffe2 nanopb libshm gloo THD c10d'\r\n\r\n\r\nThanks in advance for any help.\r\n"}