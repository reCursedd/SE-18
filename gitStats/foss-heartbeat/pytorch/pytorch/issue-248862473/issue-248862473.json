{"url": "https://api.github.com/repos/pytorch/pytorch/issues/2348", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/2348/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/2348/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/2348/events", "html_url": "https://github.com/pytorch/pytorch/issues/2348", "id": 248862473, "node_id": "MDU6SXNzdWUyNDg4NjI0NzM=", "number": 2348, "title": "Segfault when using together with Pandas", "user": {"login": "maciejkula", "id": 2392579, "node_id": "MDQ6VXNlcjIzOTI1Nzk=", "avatar_url": "https://avatars1.githubusercontent.com/u/2392579?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maciejkula", "html_url": "https://github.com/maciejkula", "followers_url": "https://api.github.com/users/maciejkula/followers", "following_url": "https://api.github.com/users/maciejkula/following{/other_user}", "gists_url": "https://api.github.com/users/maciejkula/gists{/gist_id}", "starred_url": "https://api.github.com/users/maciejkula/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maciejkula/subscriptions", "organizations_url": "https://api.github.com/users/maciejkula/orgs", "repos_url": "https://api.github.com/users/maciejkula/repos", "events_url": "https://api.github.com/users/maciejkula/events{/privacy}", "received_events_url": "https://api.github.com/users/maciejkula/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-08-08T22:15:47Z", "updated_at": "2017-09-01T04:30:10Z", "closed_at": "2017-09-01T04:30:10Z", "author_association": "CONTRIBUTOR", "body_html": "<p>When both PyTorch and Pandas are imported, calling <code>loss.backward()</code> results in a segfault. The issue was originally reported by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7435500\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/EthanRosenthal\">@EthanRosenthal</a> <a href=\"https://github.com/maciejkula/spotlight/issues/42\" data-hovercard-type=\"issue\" data-hovercard-url=\"/maciejkula/spotlight/issues/42/hovercard\">here</a></p>\n<p>It looks like calling <code>PyThreadState_GET()</code> returns a null pointer here: <a href=\"https://github.com/python/cpython/blob/5fd33b5926eb8c9352bf5718369b4a8d72c4bb44/Python/errors.c#L28\">https://github.com/python/cpython/blob/5fd33b5926eb8c9352bf5718369b4a8d72c4bb44/Python/errors.c#L28</a></p>\n<p>Examining in GDB:</p>\n<pre><code>(gdb) down\n#0  PyErr_Restore (type=0x0, value=&lt;optimised out&gt;, traceback=0x0) at Python/errors.c:42\n42      Python/errors.c: No such file or directory.\n(gdb) info locals\ntstate = 0x0\noldtype = &lt;optimised out&gt;\noldvalue = &lt;optimised out&gt;\noldtraceback = &lt;optimised out&gt;\n(gdb) tstate\nUndefined command: \"tstate\".  Try \"help\".\n(gdb) p tstate\n</code></pre>\n<p>I suspect it's both PyTorch and Pandas doing threading magic and somehow getting in each other's way.</p>\n<p>I haven't yet been able to provide a minimal example that triggers this behaviour and does not use my package; it's likely that I'm doing something odd that causes this.</p>\n<p>More documentation here: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"248710366\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/maciejkula/spotlight/issues/42\" data-hovercard-type=\"issue\" data-hovercard-url=\"/maciejkula/spotlight/issues/42/hovercard\" href=\"https://github.com/maciejkula/spotlight/issues/42\">maciejkula/spotlight#42</a><br>\nPossibly related issues: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"223308953\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1318\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1318/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1318\">#1318</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"237626525\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1868\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1868/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1868\">#1868</a>.</p>\n<p>Python version: 3.6<br>\nPyTorch version: v0.2.0<br>\nPandas version: 0.20.1</p>", "body_text": "When both PyTorch and Pandas are imported, calling loss.backward() results in a segfault. The issue was originally reported by @EthanRosenthal here\nIt looks like calling PyThreadState_GET() returns a null pointer here: https://github.com/python/cpython/blob/5fd33b5926eb8c9352bf5718369b4a8d72c4bb44/Python/errors.c#L28\nExamining in GDB:\n(gdb) down\n#0  PyErr_Restore (type=0x0, value=<optimised out>, traceback=0x0) at Python/errors.c:42\n42      Python/errors.c: No such file or directory.\n(gdb) info locals\ntstate = 0x0\noldtype = <optimised out>\noldvalue = <optimised out>\noldtraceback = <optimised out>\n(gdb) tstate\nUndefined command: \"tstate\".  Try \"help\".\n(gdb) p tstate\n\nI suspect it's both PyTorch and Pandas doing threading magic and somehow getting in each other's way.\nI haven't yet been able to provide a minimal example that triggers this behaviour and does not use my package; it's likely that I'm doing something odd that causes this.\nMore documentation here: maciejkula/spotlight#42\nPossibly related issues: #1318 and #1868.\nPython version: 3.6\nPyTorch version: v0.2.0\nPandas version: 0.20.1", "body": "When both PyTorch and Pandas are imported, calling `loss.backward()` results in a segfault. The issue was originally reported by @EthanRosenthal [here](https://github.com/maciejkula/spotlight/issues/42)\r\n\r\nIt looks like calling `PyThreadState_GET()` returns a null pointer here: https://github.com/python/cpython/blob/5fd33b5926eb8c9352bf5718369b4a8d72c4bb44/Python/errors.c#L28\r\n\r\nExamining in GDB:\r\n```\r\n(gdb) down\r\n#0  PyErr_Restore (type=0x0, value=<optimised out>, traceback=0x0) at Python/errors.c:42\r\n42      Python/errors.c: No such file or directory.\r\n(gdb) info locals\r\ntstate = 0x0\r\noldtype = <optimised out>\r\noldvalue = <optimised out>\r\noldtraceback = <optimised out>\r\n(gdb) tstate\r\nUndefined command: \"tstate\".  Try \"help\".\r\n(gdb) p tstate\r\n```\r\nI suspect it's both PyTorch and Pandas doing threading magic and somehow getting in each other's way. \r\n\r\nI haven't yet been able to provide a minimal example that triggers this behaviour and does not use my package; it's likely that I'm doing something odd that causes this.\r\n\r\nMore documentation here: https://github.com/maciejkula/spotlight/issues/42\r\nPossibly related issues: https://github.com/pytorch/pytorch/issues/1318 and https://github.com/pytorch/pytorch/issues/1868.\r\n\r\nPython version: 3.6\r\nPyTorch version: v0.2.0\r\nPandas version: 0.20.1"}