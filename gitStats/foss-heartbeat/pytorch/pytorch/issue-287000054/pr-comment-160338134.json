{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/160338134", "pull_request_review_id": 87435492, "id": 160338134, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MDMzODEzNA==", "diff_hunk": "@@ -215,7 +230,8 @@ def _check_sampler_sampler(self, torch_dist, ref_dist, message, multivariate=Fal\n             axis /= np.linalg.norm(axis)\n             torch_samples = np.dot(torch_samples, axis)\n             ref_samples = np.dot(ref_samples, axis)\n-        samples = [(x, +1) for x in torch_samples] + [(x, -1) for x in ref_samples]\n+\tsamples = [(x, +1) for x in torch_samples] + [(x, -1) for x in ref_samples]\n+        shuffle(samples) # necessary to prevent stable sort from making uneven bins for discrete", "path": "test/test_distributions.py", "position": null, "original_position": 50, "commit_id": "db8fcff8305b83a485ce4ef561bc6afee5b64ac2", "original_commit_id": "3d390526ca7f3aeee6acaa1bfb69c8d5a525b15d", "user": {"login": "rachtsingh", "id": 1606892, "node_id": "MDQ6VXNlcjE2MDY4OTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1606892?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rachtsingh", "html_url": "https://github.com/rachtsingh", "followers_url": "https://api.github.com/users/rachtsingh/followers", "following_url": "https://api.github.com/users/rachtsingh/following{/other_user}", "gists_url": "https://api.github.com/users/rachtsingh/gists{/gist_id}", "starred_url": "https://api.github.com/users/rachtsingh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rachtsingh/subscriptions", "organizations_url": "https://api.github.com/users/rachtsingh/orgs", "repos_url": "https://api.github.com/users/rachtsingh/repos", "events_url": "https://api.github.com/users/rachtsingh/events{/privacy}", "received_events_url": "https://api.github.com/users/rachtsingh/received_events", "type": "User", "site_admin": false}, "body": "As a quick explanation: if a discrete distribution has a small support, than the bins can be uneven because the above line just concats the lists, and so one bin can have all the same values as the next, but be filled with samples from different distributions. This shuffle is a quick way to prevent this from happening, and is the right way to do this test.", "created_at": "2018-01-09T08:00:54Z", "updated_at": "2018-11-23T15:37:57Z", "html_url": "https://github.com/pytorch/pytorch/pull/4556#discussion_r160338134", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/4556", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/160338134"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/4556#discussion_r160338134"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/4556"}}, "body_html": "<p>As a quick explanation: if a discrete distribution has a small support, than the bins can be uneven because the above line just concats the lists, and so one bin can have all the same values as the next, but be filled with samples from different distributions. This shuffle is a quick way to prevent this from happening, and is the right way to do this test.</p>", "body_text": "As a quick explanation: if a discrete distribution has a small support, than the bins can be uneven because the above line just concats the lists, and so one bin can have all the same values as the next, but be filled with samples from different distributions. This shuffle is a quick way to prevent this from happening, and is the right way to do this test."}