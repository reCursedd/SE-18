{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/187678798", "pull_request_review_id": 119513829, "id": 187678798, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NzY3ODc5OA==", "diff_hunk": "@@ -139,7 +139,17 @@ vector<float> SimpleNet::TEST_Benchmark(\n           if (schema && schema->HasCostInferenceFunction()) {\n             vector<TensorShape> shapes = op->InputTensorShapes();\n \n-            OpSchema::Cost cost = schema->InferCost(op->debug_def(), shapes);\n+            auto all_good_shapes = std::accumulate(\n+                shapes.begin(),\n+                shapes.end(),\n+                true,\n+                [](bool acc, const TensorShape& shape) {\n+                  return acc && !shape.unknown_shape();\n+                });\n+            OpSchema::Cost cost;\n+            if (all_good_shapes) {\n+              cost = schema->InferCost(op->debug_def(), shapes);\n+            }\n \n             flops_per_op.emplace_back(cost.flops);", "path": "caffe2/core/net_simple.cc", "position": 17, "original_position": 17, "commit_id": "77477c71692872b57e8eae5bebf525b99ed90690", "original_commit_id": "5627ea80f4666d656389d364c34f9e441d9e44e5", "user": {"login": "BIT-silence", "id": 3357667, "node_id": "MDQ6VXNlcjMzNTc2Njc=", "avatar_url": "https://avatars0.githubusercontent.com/u/3357667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BIT-silence", "html_url": "https://github.com/BIT-silence", "followers_url": "https://api.github.com/users/BIT-silence/followers", "following_url": "https://api.github.com/users/BIT-silence/following{/other_user}", "gists_url": "https://api.github.com/users/BIT-silence/gists{/gist_id}", "starred_url": "https://api.github.com/users/BIT-silence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BIT-silence/subscriptions", "organizations_url": "https://api.github.com/users/BIT-silence/orgs", "repos_url": "https://api.github.com/users/BIT-silence/repos", "events_url": "https://api.github.com/users/BIT-silence/events{/privacy}", "received_events_url": "https://api.github.com/users/BIT-silence/received_events", "type": "User", "site_admin": false}, "body": "What will happen if all_good_shapes = false here?", "created_at": "2018-05-11T17:22:02Z", "updated_at": "2018-11-23T15:43:57Z", "html_url": "https://github.com/pytorch/pytorch/pull/7503#discussion_r187678798", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/7503", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/187678798"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/7503#discussion_r187678798"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/7503"}}, "body_html": "<p>What will happen if all_good_shapes = false here?</p>", "body_text": "What will happen if all_good_shapes = false here?"}