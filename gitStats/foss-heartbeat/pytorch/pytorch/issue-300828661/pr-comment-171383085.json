{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/171383085", "pull_request_review_id": 100226200, "id": 171383085, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTM4MzA4NQ==", "diff_hunk": "@@ -459,16 +459,33 @@ def trace(*args, **kwargs):\n     return lambda func: torch._C.GraphExecutor(func, args, kwargs.pop('optimize', True))\n \n \n+def createResolutionCallback(frame_id=2):\n+    frame = inspect.stack()[frame_id][0]\n+\n+    def env(key):\n+        if key not in frame.f_locals:\n+            try:\n+                return frame.f_globals[key]\n+            except KeyError:\n+                return None\n+        else:\n+            return frame.f_locals[key]", "path": "torch/jit/__init__.py", "position": null, "original_position": 14, "commit_id": "7b960c17637717b61803232353e71d8c33ab1dd5", "original_commit_id": "0087e81bf953a39e9917132e7218b138a8d3234e", "user": {"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, "body": "If f_locals doesn't contain the lexical environment, then we have an issue. The problem is that the frame stack is the _dynamic_ environment, not the _lexical_ environment. You do not want to resolve variables using the _dynamic_ environment, you get LISP-style variable shadowing problems.", "created_at": "2018-02-28T20:58:32Z", "updated_at": "2018-11-23T15:40:09Z", "html_url": "https://github.com/pytorch/pytorch/pull/5445#discussion_r171383085", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/5445", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/171383085"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/5445#discussion_r171383085"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/5445"}}, "body_html": "<p>If f_locals doesn't contain the lexical environment, then we have an issue. The problem is that the frame stack is the <em>dynamic</em> environment, not the <em>lexical</em> environment. You do not want to resolve variables using the <em>dynamic</em> environment, you get LISP-style variable shadowing problems.</p>", "body_text": "If f_locals doesn't contain the lexical environment, then we have an issue. The problem is that the frame stack is the dynamic environment, not the lexical environment. You do not want to resolve variables using the dynamic environment, you get LISP-style variable shadowing problems.", "in_reply_to_id": 171186971}