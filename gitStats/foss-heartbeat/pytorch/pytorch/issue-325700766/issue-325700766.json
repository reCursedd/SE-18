{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7790", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7790/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7790/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7790/events", "html_url": "https://github.com/pytorch/pytorch/issues/7790", "id": 325700766, "node_id": "MDU6SXNzdWUzMjU3MDA3NjY=", "number": 7790, "title": "Compiling C/C++ extension receive undefined symbol: _ZTIN5torch8autograd8Variable4ImplE on importing into python.", "user": {"login": "kevinj22", "id": 20320568, "node_id": "MDQ6VXNlcjIwMzIwNTY4", "avatar_url": "https://avatars1.githubusercontent.com/u/20320568?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevinj22", "html_url": "https://github.com/kevinj22", "followers_url": "https://api.github.com/users/kevinj22/followers", "following_url": "https://api.github.com/users/kevinj22/following{/other_user}", "gists_url": "https://api.github.com/users/kevinj22/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevinj22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevinj22/subscriptions", "organizations_url": "https://api.github.com/users/kevinj22/orgs", "repos_url": "https://api.github.com/users/kevinj22/repos", "events_url": "https://api.github.com/users/kevinj22/events{/privacy}", "received_events_url": "https://api.github.com/users/kevinj22/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-23T13:17:04Z", "updated_at": "2018-05-23T15:31:22Z", "closed_at": "2018-05-23T15:31:22Z", "author_association": "NONE", "body_html": "<p>Hello,</p>\n<p>I am attempting to compile a C/C++ extension using the ATen library. It compiles fine with the following setup.py file:</p>\n<pre><code>import setuptools\nimport torch\nimport torch.utils.cpp_extension\nfrom torch.utils.cpp_extension import BuildExtension\n\next_modules = [setuptools.Extension(\n        name='Aten_Example',\n        sources=['Aten_Example.cpp'],\n        include_dirs= ['/usr/local/lib/python3.6/site-packages/torch/lib/include', '/usr/local/lib/python3.6/site-packages/torch/lib/include/TH', '/usr/local/lib/python3.6/site-packages/torch/lib/include/THC','/usr/local/include/python3.6m/pybind11/','/usr/local/include/python3.6m/'],\n        extra_compile_args=['-std=c++11'],\n        language='c++')]\n\nsetuptools.setup(\n        name='Aten_Example',\n        ext_modules=ext_modules,\n        cmdclass={'build_ext' : BuildExtension}\n)\n</code></pre>\n<p>The C++ code is the following:</p>\n<pre><code>#include &lt;torch/torch.h&gt;\n#include &lt;iostream&gt;\n\nat::Tensor d_sigmoid(at::Tensor z)\n{\n\tauto s = at::sigmoid(z);\n\treturn (1-s) * s;\n}\n\nPYBIND11_MODULE(TORCH_EXTENSION_NAME,m)\n{\n\tm.def(\"d_sigmoid\", &amp;d_sigmoid,\"Derivative of Sigmoid\");\n}\n</code></pre>\n<p>When imported into python I receive the following error:</p>\n<p>ImportError: /usr/local/lib/python3.6/site-packages/Aten_Example-0.0.0-py3.6-linux-x86_64.egg/Aten_Example.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZTIN5torch8autograd8Variable4ImplE</p>\n<p>I'm not sure how to fix this. From what I've read I assume I need to add some library links to the compiler?</p>", "body_text": "Hello,\nI am attempting to compile a C/C++ extension using the ATen library. It compiles fine with the following setup.py file:\nimport setuptools\nimport torch\nimport torch.utils.cpp_extension\nfrom torch.utils.cpp_extension import BuildExtension\n\next_modules = [setuptools.Extension(\n        name='Aten_Example',\n        sources=['Aten_Example.cpp'],\n        include_dirs= ['/usr/local/lib/python3.6/site-packages/torch/lib/include', '/usr/local/lib/python3.6/site-packages/torch/lib/include/TH', '/usr/local/lib/python3.6/site-packages/torch/lib/include/THC','/usr/local/include/python3.6m/pybind11/','/usr/local/include/python3.6m/'],\n        extra_compile_args=['-std=c++11'],\n        language='c++')]\n\nsetuptools.setup(\n        name='Aten_Example',\n        ext_modules=ext_modules,\n        cmdclass={'build_ext' : BuildExtension}\n)\n\nThe C++ code is the following:\n#include <torch/torch.h>\n#include <iostream>\n\nat::Tensor d_sigmoid(at::Tensor z)\n{\n\tauto s = at::sigmoid(z);\n\treturn (1-s) * s;\n}\n\nPYBIND11_MODULE(TORCH_EXTENSION_NAME,m)\n{\n\tm.def(\"d_sigmoid\", &d_sigmoid,\"Derivative of Sigmoid\");\n}\n\nWhen imported into python I receive the following error:\nImportError: /usr/local/lib/python3.6/site-packages/Aten_Example-0.0.0-py3.6-linux-x86_64.egg/Aten_Example.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZTIN5torch8autograd8Variable4ImplE\nI'm not sure how to fix this. From what I've read I assume I need to add some library links to the compiler?", "body": "Hello,\r\n\r\nI am attempting to compile a C/C++ extension using the ATen library. It compiles fine with the following setup.py file:\r\n\r\n```\r\nimport setuptools\r\nimport torch\r\nimport torch.utils.cpp_extension\r\nfrom torch.utils.cpp_extension import BuildExtension\r\n\r\next_modules = [setuptools.Extension(\r\n        name='Aten_Example',\r\n        sources=['Aten_Example.cpp'],\r\n        include_dirs= ['/usr/local/lib/python3.6/site-packages/torch/lib/include', '/usr/local/lib/python3.6/site-packages/torch/lib/include/TH', '/usr/local/lib/python3.6/site-packages/torch/lib/include/THC','/usr/local/include/python3.6m/pybind11/','/usr/local/include/python3.6m/'],\r\n        extra_compile_args=['-std=c++11'],\r\n        language='c++')]\r\n\r\nsetuptools.setup(\r\n        name='Aten_Example',\r\n        ext_modules=ext_modules,\r\n        cmdclass={'build_ext' : BuildExtension}\r\n)\r\n```\r\n\r\nThe C++ code is the following: \r\n\r\n```\r\n#include <torch/torch.h>\r\n#include <iostream>\r\n\r\nat::Tensor d_sigmoid(at::Tensor z)\r\n{\r\n\tauto s = at::sigmoid(z);\r\n\treturn (1-s) * s;\r\n}\r\n\r\nPYBIND11_MODULE(TORCH_EXTENSION_NAME,m)\r\n{\r\n\tm.def(\"d_sigmoid\", &d_sigmoid,\"Derivative of Sigmoid\");\r\n}\r\n```\r\n\r\nWhen imported into python I receive the following error:\r\n\r\nImportError: /usr/local/lib/python3.6/site-packages/Aten_Example-0.0.0-py3.6-linux-x86_64.egg/Aten_Example.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZTIN5torch8autograd8Variable4ImplE\r\n\r\nI'm not sure how to fix this. From what I've read I assume I need to add some library links to the compiler? "}