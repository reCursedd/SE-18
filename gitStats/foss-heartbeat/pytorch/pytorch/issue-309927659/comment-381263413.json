{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/381263413", "html_url": "https://github.com/pytorch/pytorch/pull/6119#issuecomment-381263413", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/6119", "id": 381263413, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTI2MzQxMw==", "user": {"login": "cpuhrsch", "id": 1716488, "node_id": "MDQ6VXNlcjE3MTY0ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1716488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cpuhrsch", "html_url": "https://github.com/cpuhrsch", "followers_url": "https://api.github.com/users/cpuhrsch/followers", "following_url": "https://api.github.com/users/cpuhrsch/following{/other_user}", "gists_url": "https://api.github.com/users/cpuhrsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/cpuhrsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cpuhrsch/subscriptions", "organizations_url": "https://api.github.com/users/cpuhrsch/orgs", "repos_url": "https://api.github.com/users/cpuhrsch/repos", "events_url": "https://api.github.com/users/cpuhrsch/events{/privacy}", "received_events_url": "https://api.github.com/users/cpuhrsch/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-13T21:20:14Z", "updated_at": "2018-04-13T22:25:53Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The numbers are now pretty competitive with the TH macro. The next step is to add basic parallelization to match the multi-core behavior, land it and then get back to the drawing board to think about how to best incorporate vectorization when possible.</p>\n<p>I still haven't been able to figure out why SmallVector is not the same speed as an array. I wrote <a href=\"https://paste.fedoraproject.org/paste/V8iu6dbDsMGKUFQsqZVIGw\" rel=\"nofollow\">these scripts</a> to compare several versions and see if I can match them to the performance of a plain array, but it hasn't happened yet.</p>\n<p>Single-core perf:</p>\n<pre><code>This branch\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.13 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.74 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.88 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.76 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:  11.39 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   3.25 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   8.25 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   6.08 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.34 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.04 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.99 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.40 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.33 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.15 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   4.04 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.44 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.49 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.24 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.03 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.06 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   3.35 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.56 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   7.40 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   5.46 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.84 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.63 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.37 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.20 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   2.01 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.71 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   3.75 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.94 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.78 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.40 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.43 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.10 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   3.49 type: torch.DoubleTensor   dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   3.01 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   5.17 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.65 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   2.20 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.94 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.75 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.48 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   2.35 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.01 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   2.62 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.82 type: torch.DoubleTensor   dim: 5\n\n     162101.650864      task-clock (msec)         #    0.998 CPUs utilized          \n             2,178      context-switches          #    0.013 K/sec                  \n                 1      cpu-migrations            #    0.000 K/sec                  \n           117,926      page-faults               #    0.727 K/sec                  \n   356,582,699,239      cycles                    #    2.200 GHz                    \n   &lt;not supported&gt;      stalled-cycles-frontend  \n   &lt;not supported&gt;      stalled-cycles-backend   \n   389,257,710,459      instructions              #    1.09  insns per cycle        \n    61,828,694,436      branches                  #  381.419 M/sec                  \n     3,169,103,623      branch-misses             #    5.13% of all branches        \n\n     162.393568323 seconds time elapsed\n\n\nMaster\n\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.02 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.68 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   4.00 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.84 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:  11.23 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   3.21 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   8.12 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   7.18 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   1.94 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.73 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.56 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.06 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   1.97 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.84 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.57 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.05 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.17 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.01 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.06 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   3.21 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.49 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   7.27 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   7.26 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.52 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.09 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.00 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.68 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.51 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   3.32 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.67 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.57 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.33 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.37 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.07 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   3.32 type: torch.DoubleTensor   dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.93 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   5.22 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.75 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.81 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.64 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.53 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.29 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.97 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.77 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   2.22 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.65 type: torch.DoubleTensor   dim: 5\n\n     156085.008924      task-clock (msec)         #    0.999 CPUs utilized          \n             1,726      context-switches          #    0.011 K/sec                  \n                 1      cpu-migrations            #    0.000 K/sec                  \n           106,200      page-faults               #    0.680 K/sec                  \n   343,347,705,701      cycles                    #    2.200 GHz                    \n   &lt;not supported&gt;      stalled-cycles-frontend  \n   &lt;not supported&gt;      stalled-cycles-backend   \n   368,092,561,864      instructions              #    1.07  insns per cycle        \n    60,536,112,276      branches                  #  387.841 M/sec                  \n     3,170,959,169      branch-misses             #    5.24% of all branches        \n\n     156.315070362 seconds time elapsed\n\n</code></pre>", "body_text": "The numbers are now pretty competitive with the TH macro. The next step is to add basic parallelization to match the multi-core behavior, land it and then get back to the drawing board to think about how to best incorporate vectorization when possible.\nI still haven't been able to figure out why SmallVector is not the same speed as an array. I wrote these scripts to compare several versions and see if I can match them to the performance of a plain array, but it hasn't happened yet.\nSingle-core perf:\nThis branch\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.13 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.74 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.88 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.76 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:  11.39 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   3.25 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   8.25 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   6.08 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.34 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.04 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.99 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.40 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.33 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.15 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   4.04 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.44 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.49 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.24 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.03 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.06 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   3.35 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.56 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   7.40 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   5.46 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.84 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.63 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.37 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.20 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   2.01 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.71 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   3.75 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.94 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.78 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.40 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.43 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.10 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   3.49 type: torch.DoubleTensor   dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   3.01 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   5.17 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.65 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   2.20 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.94 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.75 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.48 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   2.35 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.01 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   2.62 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.82 type: torch.DoubleTensor   dim: 5\n\n     162101.650864      task-clock (msec)         #    0.998 CPUs utilized          \n             2,178      context-switches          #    0.013 K/sec                  \n                 1      cpu-migrations            #    0.000 K/sec                  \n           117,926      page-faults               #    0.727 K/sec                  \n   356,582,699,239      cycles                    #    2.200 GHz                    \n   <not supported>      stalled-cycles-frontend  \n   <not supported>      stalled-cycles-backend   \n   389,257,710,459      instructions              #    1.09  insns per cycle        \n    61,828,694,436      branches                  #  381.419 M/sec                  \n     3,169,103,623      branch-misses             #    5.13% of all branches        \n\n     162.393568323 seconds time elapsed\n\n\nMaster\n\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.02 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.68 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   4.00 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.84 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:  11.23 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   3.21 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   8.12 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   7.18 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   1.94 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.73 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.56 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.06 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   1.97 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.84 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.57 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.05 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.17 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.01 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.06 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   3.21 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.49 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   7.27 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   7.26 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.52 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.09 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.00 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.68 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.51 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   3.32 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.67 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.57 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.33 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.37 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.07 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   3.32 type: torch.DoubleTensor   dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.93 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   5.22 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.75 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.81 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.64 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.53 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.29 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.97 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.77 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   2.22 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.65 type: torch.DoubleTensor   dim: 5\n\n     156085.008924      task-clock (msec)         #    0.999 CPUs utilized          \n             1,726      context-switches          #    0.011 K/sec                  \n                 1      cpu-migrations            #    0.000 K/sec                  \n           106,200      page-faults               #    0.680 K/sec                  \n   343,347,705,701      cycles                    #    2.200 GHz                    \n   <not supported>      stalled-cycles-frontend  \n   <not supported>      stalled-cycles-backend   \n   368,092,561,864      instructions              #    1.07  insns per cycle        \n    60,536,112,276      branches                  #  387.841 M/sec                  \n     3,170,959,169      branch-misses             #    5.24% of all branches        \n\n     156.315070362 seconds time elapsed", "body": "The numbers are now pretty competitive with the TH macro. The next step is to add basic parallelization to match the multi-core behavior, land it and then get back to the drawing board to think about how to best incorporate vectorization when possible.\r\n\r\nI still haven't been able to figure out why SmallVector is not the same speed as an array. I wrote [these scripts](https://paste.fedoraproject.org/paste/V8iu6dbDsMGKUFQsqZVIGw) to compare several versions and see if I can match them to the performance of a plain array, but it hasn't happened yet.\r\n\r\nSingle-core perf:\r\n\r\n```\r\nThis branch\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.13 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.74 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.88 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.76 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:  11.39 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   3.25 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   8.25 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   6.08 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.34 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.04 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.99 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.40 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.33 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.15 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   4.04 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.44 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.49 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.24 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.03 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.06 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   3.35 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.56 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   7.40 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   5.46 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.84 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.63 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.37 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.20 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   2.01 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.71 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   3.75 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.94 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.78 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.40 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.43 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.10 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   3.49 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   3.01 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   5.17 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.65 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   2.20 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.94 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.75 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.48 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   2.35 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.01 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   2.62 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.82 type: torch.DoubleTensor   dim: 5\r\n\r\n     162101.650864      task-clock (msec)         #    0.998 CPUs utilized          \r\n             2,178      context-switches          #    0.013 K/sec                  \r\n                 1      cpu-migrations            #    0.000 K/sec                  \r\n           117,926      page-faults               #    0.727 K/sec                  \r\n   356,582,699,239      cycles                    #    2.200 GHz                    \r\n   <not supported>      stalled-cycles-frontend  \r\n   <not supported>      stalled-cycles-backend   \r\n   389,257,710,459      instructions              #    1.09  insns per cycle        \r\n    61,828,694,436      branches                  #  381.419 M/sec                  \r\n     3,169,103,623      branch-misses             #    5.13% of all branches        \r\n\r\n     162.393568323 seconds time elapsed\r\n\r\n\r\nMaster\r\n\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   2.02 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.68 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   4.00 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.84 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:  11.23 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   3.21 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   8.12 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   7.18 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   1.94 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.73 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.56 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.06 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 46, 2116)              numel: 97336     elapsed:   1.97 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.84 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 99, 9801)             numel: 970299    elapsed:   3.57 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.05 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.17 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.01 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.06 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   3.21 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.49 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   7.27 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   7.26 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.52 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   2.09 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.00 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 17, 289)         numel: 83521     elapsed:   1.68 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.51 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 31, 961)       numel: 923521    elapsed:   3.32 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.67 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.57 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.33 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.37 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.07 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   3.32 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.93 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   5.22 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.75 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.81 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.64 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   1.53 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.29 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 10, 100) numel: 100000    elapsed:   1.97 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.77 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 15, 225) numel: 759375    elapsed:   2.22 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.65 type: torch.DoubleTensor   dim: 5\r\n\r\n     156085.008924      task-clock (msec)         #    0.999 CPUs utilized          \r\n             1,726      context-switches          #    0.011 K/sec                  \r\n                 1      cpu-migrations            #    0.000 K/sec                  \r\n           106,200      page-faults               #    0.680 K/sec                  \r\n   343,347,705,701      cycles                    #    2.200 GHz                    \r\n   <not supported>      stalled-cycles-frontend  \r\n   <not supported>      stalled-cycles-backend   \r\n   368,092,561,864      instructions              #    1.07  insns per cycle        \r\n    60,536,112,276      branches                  #  387.841 M/sec                  \r\n     3,170,959,169      branch-misses             #    5.24% of all branches        \r\n\r\n     156.315070362 seconds time elapsed\r\n\r\n"}