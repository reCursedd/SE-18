{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/380943889", "html_url": "https://github.com/pytorch/pytorch/pull/6119#issuecomment-380943889", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/6119", "id": 380943889, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDk0Mzg4OQ==", "user": {"login": "cpuhrsch", "id": 1716488, "node_id": "MDQ6VXNlcjE3MTY0ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1716488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cpuhrsch", "html_url": "https://github.com/cpuhrsch", "followers_url": "https://api.github.com/users/cpuhrsch/followers", "following_url": "https://api.github.com/users/cpuhrsch/following{/other_user}", "gists_url": "https://api.github.com/users/cpuhrsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/cpuhrsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cpuhrsch/subscriptions", "organizations_url": "https://api.github.com/users/cpuhrsch/orgs", "repos_url": "https://api.github.com/users/cpuhrsch/repos", "events_url": "https://api.github.com/users/cpuhrsch/events{/privacy}", "received_events_url": "https://api.github.com/users/cpuhrsch/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-12T21:04:33Z", "updated_at": "2018-04-12T21:13:26Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I've added \"collapsing dimensions\" and a version of the iterator that uses stack allocated memory. I've not been able to match or exceed the performance of this custom version using SmallVector. Since we're planning to use that class throughout ATen it'll be worth figuring that out. At this point I'm not that sure anymore what might be missing here to get that extra last bit of perf. I'll spend some more time benchmarking. It tried using a single \"memory\" array instead of three separate ones, but that hasn't helped either.</p>\n<p>The new single-core timings are</p>\n<pre><code>This branch\n\n(base) [14:58:27: cpuhrsch@devfair0129 benchmarks]$ perf stat taskset -c 0 /private/home/cpuhrsch/miniconda2/bin/python unary_comp.py\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.79 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.89 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:  11.27 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   6.38 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.25 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.73 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.36 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.74 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.26 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.08 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.76 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   5.68 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.77 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.39 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.87 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   3.27 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.47 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.13 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   3.26 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.82 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.11 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.61 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.23 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.99 type: torch.DoubleTensor   dim: 5\n\nMaster\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.68 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.77 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:  11.16 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   7.14 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.74 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   2.98 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.87 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.01 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.17 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.02 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.48 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   6.92 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   1.95 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.51 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.66 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.33 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.06 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.92 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.73 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.63 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.30 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.78 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.64 type: torch.DoubleTensor   dim: 5\n</code></pre>\n<p>Using the <a href=\"https://paste.fedoraproject.org/paste/Z0DEg-CHuzVaxG8peWQviw\" rel=\"nofollow\">this script</a>.</p>", "body_text": "I've added \"collapsing dimensions\" and a version of the iterator that uses stack allocated memory. I've not been able to match or exceed the performance of this custom version using SmallVector. Since we're planning to use that class throughout ATen it'll be worth figuring that out. At this point I'm not that sure anymore what might be missing here to get that extra last bit of perf. I'll spend some more time benchmarking. It tried using a single \"memory\" array instead of three separate ones, but that hasn't helped either.\nThe new single-core timings are\nThis branch\n\n(base) [14:58:27: cpuhrsch@devfair0129 benchmarks]$ perf stat taskset -c 0 /private/home/cpuhrsch/miniconda2/bin/python unary_comp.py\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.79 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.89 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:  11.27 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   6.38 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.25 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.73 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.36 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.74 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.26 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.08 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.76 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   5.68 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.77 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.39 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.87 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   3.27 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.47 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.13 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   3.26 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.82 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.11 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.61 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.23 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.99 type: torch.DoubleTensor   dim: 5\n\nMaster\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.68 type: torch.FloatTensor    dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.77 type: torch.FloatTensor    dim: 3\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:  11.16 type: torch.DoubleTensor   dim: 3\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   7.14 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.74 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   2.98 type: torch.FloatTensor    dim: 3\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.87 type: torch.DoubleTensor   dim: 3\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.01 type: torch.DoubleTensor   dim: 3\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.17 type: torch.FloatTensor    dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.02 type: torch.FloatTensor    dim: 4\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.48 type: torch.DoubleTensor   dim: 4\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   6.92 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   1.95 type: torch.FloatTensor    dim: 4\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.51 type: torch.DoubleTensor   dim: 4\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.66 type: torch.DoubleTensor   dim: 4\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.33 type: torch.FloatTensor    dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.06 type: torch.FloatTensor    dim: 5\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.92 type: torch.DoubleTensor   dim: 5\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.73 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.63 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.30 type: torch.FloatTensor    dim: 5\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.78 type: torch.DoubleTensor   dim: 5\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.64 type: torch.DoubleTensor   dim: 5\n\nUsing the this script.", "body": "I've added \"collapsing dimensions\" and a version of the iterator that uses stack allocated memory. I've not been able to match or exceed the performance of this custom version using SmallVector. Since we're planning to use that class throughout ATen it'll be worth figuring that out. At this point I'm not that sure anymore what might be missing here to get that extra last bit of perf. I'll spend some more time benchmarking. It tried using a single \"memory\" array instead of three separate ones, but that hasn't helped either.\r\n\r\nThe new single-core timings are\r\n\r\n```\r\nThis branch\r\n\r\n(base) [14:58:27: cpuhrsch@devfair0129 benchmarks]$ perf stat taskset -c 0 /private/home/cpuhrsch/miniconda2/bin/python unary_comp.py\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.79 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.89 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:  11.27 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   6.38 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.25 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.73 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   2.36 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.74 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.26 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.08 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.76 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   5.68 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.77 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.39 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.87 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   3.27 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.47 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.13 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   3.26 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.82 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.11 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.61 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.23 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.99 type: torch.DoubleTensor   dim: 5\r\n\r\nMaster\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.68 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.77 type: torch.FloatTensor    dim: 3\r\nsin   size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:  11.16 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   7.14 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.74 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   2.98 type: torch.FloatTensor    dim: 3\r\nsqrt  size: 10^2   count: 1000   size: [46, 46, 46]         stride: (97336, 2116, 46)              numel: 97336     elapsed:   1.87 type: torch.DoubleTensor   dim: 3\r\nsqrt  size: 10^3   count: 100    size: [99, 99, 99]         stride: (970299, 9801, 99)             numel: 970299    elapsed:   3.01 type: torch.DoubleTensor   dim: 3\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.17 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.02 type: torch.FloatTensor    dim: 4\r\nsin   size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   2.48 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   6.92 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.37 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   1.95 type: torch.FloatTensor    dim: 4\r\nsqrt  size: 10^2   count: 1000   size: [17, 17, 17, 17]     stride: (83521, 4913, 289, 17)         numel: 83521     elapsed:   1.51 type: torch.DoubleTensor   dim: 4\r\nsqrt  size: 10^3   count: 100    size: [31, 31, 31, 31]     stride: (923521, 29791, 961, 31)       numel: 923521    elapsed:   2.66 type: torch.DoubleTensor   dim: 4\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.33 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.06 type: torch.FloatTensor    dim: 5\r\nsin   size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   2.92 type: torch.DoubleTensor   dim: 5\r\nsin   size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   2.73 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.63 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.30 type: torch.FloatTensor    dim: 5\r\nsqrt  size: 10^2   count: 1000   size: [10, 10, 10, 10, 10] stride: (100000, 10000, 1000, 100, 10) numel: 100000    elapsed:   1.78 type: torch.DoubleTensor   dim: 5\r\nsqrt  size: 10^3   count: 100    size: [15, 15, 15, 15, 15] stride: (759375, 50625, 3375, 225, 15) numel: 759375    elapsed:   1.64 type: torch.DoubleTensor   dim: 5\r\n```\r\n\r\nUsing the [this script](https://paste.fedoraproject.org/paste/Z0DEg-CHuzVaxG8peWQviw)."}