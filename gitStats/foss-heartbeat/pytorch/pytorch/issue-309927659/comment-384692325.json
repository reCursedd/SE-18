{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/384692325", "html_url": "https://github.com/pytorch/pytorch/pull/6119#issuecomment-384692325", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/6119", "id": 384692325, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDY5MjMyNQ==", "user": {"login": "cpuhrsch", "id": 1716488, "node_id": "MDQ6VXNlcjE3MTY0ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1716488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cpuhrsch", "html_url": "https://github.com/cpuhrsch", "followers_url": "https://api.github.com/users/cpuhrsch/followers", "following_url": "https://api.github.com/users/cpuhrsch/following{/other_user}", "gists_url": "https://api.github.com/users/cpuhrsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/cpuhrsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cpuhrsch/subscriptions", "organizations_url": "https://api.github.com/users/cpuhrsch/orgs", "repos_url": "https://api.github.com/users/cpuhrsch/repos", "events_url": "https://api.github.com/users/cpuhrsch/events{/privacy}", "received_events_url": "https://api.github.com/users/cpuhrsch/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-26T15:51:02Z", "updated_at": "2018-04-26T15:51:02Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9998726\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/peterjc123\">@peterjc123</a> I tried running this on a dev machine and still get errors related to being unable to link all the other things within the CPUApplyUtils (i.e. the struct etc.), so I removed all the AT_API additions.</p>\n<p>Now I'm getting</p>\n<pre><code>[1/2] Linking CXX executable src\\ATen\\test\\apply_utils_test.exe\nFAILED: src/ATen/test/apply_utils_test.exe\ncmd.exe /C \"cd . &amp;&amp; \"C:\\Program Files\\CMake\\bin\\cmake.exe\" -E vs_link_exe --intdir=src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir --manifests  -- C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1\n.255\\bin\\Hostx86\\x64\\link.exe /nologo src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir\\apply_utils_test.cpp.obj  /out:src\\ATen\\test\\apply_utils_test.exe /implib:src\\ATen\\test\\apply_utils_test.lib /pdb:sr\nc\\ATen\\test\\apply_utils_test.pdb /version:0.0  /machine:x64 /LIBPATH:C:/Users/Administrator/cpuhrsch/pytorch/torch/lib/tmp_install/lib /INCREMENTAL:NO /subsystem:console  src\\ATen\\ATen.lib src\\ATen\\cp\nu\\tbb\\tbb_static.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\n\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_\nintel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib confu-deps\\cpuinfo\\cpuinfo.lib kernel32.lib user32.lib gdi3\n2.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib &amp;&amp; cd .\"\nLINK: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir\\apply_utils_test.cpp.obj /out:src\\ATen\\test\\ap\nply_utils_test.exe /implib:src\\ATen\\test\\apply_utils_test.lib /pdb:src\\ATen\\test\\apply_utils_test.pdb /version:0.0 /machine:x64 /LIBPATH:C:/Users/Administrator/cpuhrsch/pytorch/torch/lib/tmp_install/l\nib /INCREMENTAL:NO /subsystem:console src\\ATen\\ATen.lib src\\ATen\\cpu\\tbb\\tbb_static.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\l\nib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_\nintel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp\n5md.lib confu-deps\\cpuinfo\\cpuinfo.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:src\\ATen\\test\\apply_\nutils_test.exe.manifest\" failed (exit code 1120) with the following output:\napply_utils_test.cpp.obj : error LNK2019: unresolved external symbol \"void __cdecl at::internal::init_tbb_num_threads(void)\" (?init_tbb_num_threads@internal@at@@YAXXZ) referenced in function \"bool __c\ndecl at::_apply_preamble(class at::ArrayRef&lt;struct at::Tensor&gt;)\" (?_apply_preamble@at@@YA_NV?$ArrayRef@UTensor@at@@@1@@Z)\napply_utils_test.cpp.obj : error LNK2019: unresolved external symbol \"void __cdecl at::checkBackend(char const *,class at::ArrayRef&lt;struct at::Tensor&gt;,enum at::Backend)\" (?checkBackend@at@@YAXPEBDV?$A\nrrayRef@UTensor@at@@@1@W4Backend@1@@Z) referenced in function \"bool __cdecl at::_apply_preamble(class at::ArrayRef&lt;struct at::Tensor&gt;)\" (?_apply_preamble@at@@YA_NV?$ArrayRef@UTensor@at@@@1@@Z)\nsrc\\ATen\\test\\apply_utils_test.exe : fatal error LNK1120: 2 unresolved externals\nninja: build stopped: subcommand failed.\n\n(base) C:\\Users\\Administrator\\cpuhrsch\\pytorch\\aten\\build&gt;IF NOT 1 == 0 exit 1\n</code></pre>", "body_text": "@peterjc123 I tried running this on a dev machine and still get errors related to being unable to link all the other things within the CPUApplyUtils (i.e. the struct etc.), so I removed all the AT_API additions.\nNow I'm getting\n[1/2] Linking CXX executable src\\ATen\\test\\apply_utils_test.exe\nFAILED: src/ATen/test/apply_utils_test.exe\ncmd.exe /C \"cd . && \"C:\\Program Files\\CMake\\bin\\cmake.exe\" -E vs_link_exe --intdir=src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir --manifests  -- C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1\n.255\\bin\\Hostx86\\x64\\link.exe /nologo src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir\\apply_utils_test.cpp.obj  /out:src\\ATen\\test\\apply_utils_test.exe /implib:src\\ATen\\test\\apply_utils_test.lib /pdb:sr\nc\\ATen\\test\\apply_utils_test.pdb /version:0.0  /machine:x64 /LIBPATH:C:/Users/Administrator/cpuhrsch/pytorch/torch/lib/tmp_install/lib /INCREMENTAL:NO /subsystem:console  src\\ATen\\ATen.lib src\\ATen\\cp\nu\\tbb\\tbb_static.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\n\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_\nintel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib confu-deps\\cpuinfo\\cpuinfo.lib kernel32.lib user32.lib gdi3\n2.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib && cd .\"\nLINK: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir\\apply_utils_test.cpp.obj /out:src\\ATen\\test\\ap\nply_utils_test.exe /implib:src\\ATen\\test\\apply_utils_test.lib /pdb:src\\ATen\\test\\apply_utils_test.pdb /version:0.0 /machine:x64 /LIBPATH:C:/Users/Administrator/cpuhrsch/pytorch/torch/lib/tmp_install/l\nib /INCREMENTAL:NO /subsystem:console src\\ATen\\ATen.lib src\\ATen\\cpu\\tbb\\tbb_static.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\l\nib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_\nintel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp\n5md.lib confu-deps\\cpuinfo\\cpuinfo.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:src\\ATen\\test\\apply_\nutils_test.exe.manifest\" failed (exit code 1120) with the following output:\napply_utils_test.cpp.obj : error LNK2019: unresolved external symbol \"void __cdecl at::internal::init_tbb_num_threads(void)\" (?init_tbb_num_threads@internal@at@@YAXXZ) referenced in function \"bool __c\ndecl at::_apply_preamble(class at::ArrayRef<struct at::Tensor>)\" (?_apply_preamble@at@@YA_NV?$ArrayRef@UTensor@at@@@1@@Z)\napply_utils_test.cpp.obj : error LNK2019: unresolved external symbol \"void __cdecl at::checkBackend(char const *,class at::ArrayRef<struct at::Tensor>,enum at::Backend)\" (?checkBackend@at@@YAXPEBDV?$A\nrrayRef@UTensor@at@@@1@W4Backend@1@@Z) referenced in function \"bool __cdecl at::_apply_preamble(class at::ArrayRef<struct at::Tensor>)\" (?_apply_preamble@at@@YA_NV?$ArrayRef@UTensor@at@@@1@@Z)\nsrc\\ATen\\test\\apply_utils_test.exe : fatal error LNK1120: 2 unresolved externals\nninja: build stopped: subcommand failed.\n\n(base) C:\\Users\\Administrator\\cpuhrsch\\pytorch\\aten\\build>IF NOT 1 == 0 exit 1", "body": "@peterjc123 I tried running this on a dev machine and still get errors related to being unable to link all the other things within the CPUApplyUtils (i.e. the struct etc.), so I removed all the AT_API additions.\r\n\r\nNow I'm getting\r\n\r\n```\r\n[1/2] Linking CXX executable src\\ATen\\test\\apply_utils_test.exe\r\nFAILED: src/ATen/test/apply_utils_test.exe\r\ncmd.exe /C \"cd . && \"C:\\Program Files\\CMake\\bin\\cmake.exe\" -E vs_link_exe --intdir=src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir --manifests  -- C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1\r\n.255\\bin\\Hostx86\\x64\\link.exe /nologo src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir\\apply_utils_test.cpp.obj  /out:src\\ATen\\test\\apply_utils_test.exe /implib:src\\ATen\\test\\apply_utils_test.lib /pdb:sr\r\nc\\ATen\\test\\apply_utils_test.pdb /version:0.0  /machine:x64 /LIBPATH:C:/Users/Administrator/cpuhrsch/pytorch/torch/lib/tmp_install/lib /INCREMENTAL:NO /subsystem:console  src\\ATen\\ATen.lib src\\ATen\\cp\r\nu\\tbb\\tbb_static.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\r\n\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_\r\nintel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib confu-deps\\cpuinfo\\cpuinfo.lib kernel32.lib user32.lib gdi3\r\n2.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib && cd .\"\r\nLINK: command \"C:\\PROGRA~2\\MIB055~1\\2017\\COMMUN~1\\VC\\Tools\\MSVC\\1411~1.255\\bin\\Hostx86\\x64\\link.exe /nologo src\\ATen\\test\\CMakeFiles\\apply_utils_test.dir\\apply_utils_test.cpp.obj /out:src\\ATen\\test\\ap\r\nply_utils_test.exe /implib:src\\ATen\\test\\apply_utils_test.lib /pdb:src\\ATen\\test\\apply_utils_test.pdb /version:0.0 /machine:x64 /LIBPATH:C:/Users/Administrator/cpuhrsch/pytorch/torch/lib/tmp_install/l\r\nib /INCREMENTAL:NO /subsystem:console src\\ATen\\ATen.lib src\\ATen\\cpu\\tbb\\tbb_static.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\l\r\nib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp5md.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_\r\nintel_lp64.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_intel_thread.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\mkl_core.lib C:\\Users\\Administrator\\cpuhrsch\\pytorch\\mkl\\lib\\libiomp\r\n5md.lib confu-deps\\cpuinfo\\cpuinfo.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:src\\ATen\\test\\apply_\r\nutils_test.exe.manifest\" failed (exit code 1120) with the following output:\r\napply_utils_test.cpp.obj : error LNK2019: unresolved external symbol \"void __cdecl at::internal::init_tbb_num_threads(void)\" (?init_tbb_num_threads@internal@at@@YAXXZ) referenced in function \"bool __c\r\ndecl at::_apply_preamble(class at::ArrayRef<struct at::Tensor>)\" (?_apply_preamble@at@@YA_NV?$ArrayRef@UTensor@at@@@1@@Z)\r\napply_utils_test.cpp.obj : error LNK2019: unresolved external symbol \"void __cdecl at::checkBackend(char const *,class at::ArrayRef<struct at::Tensor>,enum at::Backend)\" (?checkBackend@at@@YAXPEBDV?$A\r\nrrayRef@UTensor@at@@@1@W4Backend@1@@Z) referenced in function \"bool __cdecl at::_apply_preamble(class at::ArrayRef<struct at::Tensor>)\" (?_apply_preamble@at@@YA_NV?$ArrayRef@UTensor@at@@@1@@Z)\r\nsrc\\ATen\\test\\apply_utils_test.exe : fatal error LNK1120: 2 unresolved externals\r\nninja: build stopped: subcommand failed.\r\n\r\n(base) C:\\Users\\Administrator\\cpuhrsch\\pytorch\\aten\\build>IF NOT 1 == 0 exit 1\r\n```"}