{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6608", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6608/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6608/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6608/events", "html_url": "https://github.com/pytorch/pytorch/pull/6608", "id": 314383316, "node_id": "MDExOlB1bGxSZXF1ZXN0MTgxNjc5Mzk5", "number": 6608, "title": "[JIT][script][ONNX] ScriptModule ONNX export + ONNX export for control flow nodes", "user": {"login": "jamesr66a", "id": 4685384, "node_id": "MDQ6VXNlcjQ2ODUzODQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/4685384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamesr66a", "html_url": "https://github.com/jamesr66a", "followers_url": "https://api.github.com/users/jamesr66a/followers", "following_url": "https://api.github.com/users/jamesr66a/following{/other_user}", "gists_url": "https://api.github.com/users/jamesr66a/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamesr66a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamesr66a/subscriptions", "organizations_url": "https://api.github.com/users/jamesr66a/orgs", "repos_url": "https://api.github.com/users/jamesr66a/repos", "events_url": "https://api.github.com/users/jamesr66a/events{/privacy}", "received_events_url": "https://api.github.com/users/jamesr66a/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-15T03:56:06Z", "updated_at": "2018-11-23T15:42:54Z", "closed_at": "2018-04-20T06:45:04Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/6608", "html_url": "https://github.com/pytorch/pytorch/pull/6608", "diff_url": "https://github.com/pytorch/pytorch/pull/6608.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/6608.patch"}, "body_html": "<p>This PR implements export for control flow nodes to ONNX. It makes several changes:</p>\n<ul>\n<li>The ONNX export pass now operates on <code>Block</code>s rather than <code>Graph</code>s, and recursively descends through these for control flow operators.\n<ul>\n<li>The environment map for this translation phase is now passed by value recursively to allow for resolution of values in lexical scope</li>\n</ul>\n</li>\n<li><code>ExportGraph</code> takes the <code>Blocks</code> on each control flow operator and emits them each as a <code>GraphProto</code>. The supporting machinery for doing so has been changed (similarly, <code>encodeGraph</code> is now implemented in terms of a new <code>encodeBlock</code> function, and this export is done recursively)</li>\n</ul>\n<p>TODO: we need <code>onnx-fb-universe</code> tests to test both this PR and the prior PR</p>", "body_text": "This PR implements export for control flow nodes to ONNX. It makes several changes:\n\nThe ONNX export pass now operates on Blocks rather than Graphs, and recursively descends through these for control flow operators.\n\nThe environment map for this translation phase is now passed by value recursively to allow for resolution of values in lexical scope\n\n\nExportGraph takes the Blocks on each control flow operator and emits them each as a GraphProto. The supporting machinery for doing so has been changed (similarly, encodeGraph is now implemented in terms of a new encodeBlock function, and this export is done recursively)\n\nTODO: we need onnx-fb-universe tests to test both this PR and the prior PR", "body": "This PR implements export for control flow nodes to ONNX. It makes several changes:\r\n\r\n* The ONNX export pass now operates on `Block`s rather than `Graph`s, and recursively descends through these for control flow operators.\r\n  * The environment map for this translation phase is now passed by value recursively to allow for resolution of values in lexical scope\r\n* `ExportGraph` takes the `Blocks` on each control flow operator and emits them each as a `GraphProto`. The supporting machinery for doing so has been changed (similarly, `encodeGraph` is now implemented in terms of a new `encodeBlock` function, and this export is done recursively)\r\n\r\nTODO: we need `onnx-fb-universe` tests to test both this PR and the prior PR"}