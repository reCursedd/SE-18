{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8242", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8242/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8242/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8242/events", "html_url": "https://github.com/pytorch/pytorch/issues/8242", "id": 330335273, "node_id": "MDU6SXNzdWUzMzAzMzUyNzM=", "number": 8242, "title": "Different behavior of LSTM and LSTMCell implementation ", "user": {"login": "DeepInEvil", "id": 13822074, "node_id": "MDQ6VXNlcjEzODIyMDc0", "avatar_url": "https://avatars1.githubusercontent.com/u/13822074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DeepInEvil", "html_url": "https://github.com/DeepInEvil", "followers_url": "https://api.github.com/users/DeepInEvil/followers", "following_url": "https://api.github.com/users/DeepInEvil/following{/other_user}", "gists_url": "https://api.github.com/users/DeepInEvil/gists{/gist_id}", "starred_url": "https://api.github.com/users/DeepInEvil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DeepInEvil/subscriptions", "organizations_url": "https://api.github.com/users/DeepInEvil/orgs", "repos_url": "https://api.github.com/users/DeepInEvil/repos", "events_url": "https://api.github.com/users/DeepInEvil/events{/privacy}", "received_events_url": "https://api.github.com/users/DeepInEvil/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443484050, "node_id": "MDU6TGFiZWw0NDM0ODQwNTA=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/medium%20priority", "name": "medium priority", "color": "fbca04", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-06-07T15:55:01Z", "updated_at": "2018-11-09T20:20:53Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>I was testing the difference between LSTM and LSTMCell implementations, ideally for same input they should have same outputs, but the outputs are different, looks like something fishy is going on.</p>\n<p>The numbers are different that's still okay, but the problem is I am getting very different performances(accuracy and other metrics, not O(t)) while testing these two models.<br>\nCan you please check the issue?</p>\n<h2>Code example</h2>\n<p>import torch<br>\nfrom torch import nn<br>\nfrom torch.autograd import Variable<br>\nprint torch.<strong>version</strong><br>\ntorch.manual_seed(666)<br>\nrnn = nn.LSTM(10, 20, 1)<br>\ninput = Variable(torch.randn(5, 3, 10))<br>\nh0 = Variable(torch.zeros(1, 3, 20))<br>\nc0 = Variable(torch.zeros(1, 3, 20))<br>\noutput, (hn, cn) = rnn(input, (h0, c0))</p>\n<p>print (\"From LSTM\")<br>\nprint hn[0]</p>\n<p>rnncell = nn.LSTMCell(10, 20)<br>\nhx = Variable(torch.zeros(3, 20))<br>\ncx = Variable(torch.zeros(3, 20))<br>\nout = []<br>\nfor i in range(5):<br>\nhx, cx = rnncell(input[i], (hx, cx))<br>\nout.append(hx)</p>\n<p>print (\"from LSTM Cell\")<br>\nprint hx</p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: pytorch</li>\n<li>How you installed PyTorch (conda, pip, source): pip</li>\n<li>Build command you used (if compiling from source):</li>\n<li>OS: ubuntu</li>\n<li>PyTorch version: 0.3.1</li>\n<li>Python version: 2.7.12</li>\n<li>CUDA/cuDNN version: NA</li>\n<li>GPU models and configuration: NA</li>\n<li>GCC version (if compiling from source):</li>\n<li>CMake version: NA</li>\n<li>Versions of any other relevant libraries:</li>\n</ul>", "body_text": "Issue description\nI was testing the difference between LSTM and LSTMCell implementations, ideally for same input they should have same outputs, but the outputs are different, looks like something fishy is going on.\nThe numbers are different that's still okay, but the problem is I am getting very different performances(accuracy and other metrics, not O(t)) while testing these two models.\nCan you please check the issue?\nCode example\nimport torch\nfrom torch import nn\nfrom torch.autograd import Variable\nprint torch.version\ntorch.manual_seed(666)\nrnn = nn.LSTM(10, 20, 1)\ninput = Variable(torch.randn(5, 3, 10))\nh0 = Variable(torch.zeros(1, 3, 20))\nc0 = Variable(torch.zeros(1, 3, 20))\noutput, (hn, cn) = rnn(input, (h0, c0))\nprint (\"From LSTM\")\nprint hn[0]\nrnncell = nn.LSTMCell(10, 20)\nhx = Variable(torch.zeros(3, 20))\ncx = Variable(torch.zeros(3, 20))\nout = []\nfor i in range(5):\nhx, cx = rnncell(input[i], (hx, cx))\nout.append(hx)\nprint (\"from LSTM Cell\")\nprint hx\nSystem Info\n\nPyTorch or Caffe2: pytorch\nHow you installed PyTorch (conda, pip, source): pip\nBuild command you used (if compiling from source):\nOS: ubuntu\nPyTorch version: 0.3.1\nPython version: 2.7.12\nCUDA/cuDNN version: NA\nGPU models and configuration: NA\nGCC version (if compiling from source):\nCMake version: NA\nVersions of any other relevant libraries:", "body": "## Issue description\r\nI was testing the difference between LSTM and LSTMCell implementations, ideally for same input they should have same outputs, but the outputs are different, looks like something fishy is going on.\r\n\r\nThe numbers are different that's still okay, but the problem is I am getting very different performances(accuracy and other metrics, not O(t)) while testing these two models.\r\nCan you please check the issue?\r\n\r\n## Code example\r\nimport torch\r\nfrom torch import nn\r\nfrom torch.autograd import Variable\r\nprint torch.__version__\r\ntorch.manual_seed(666)\r\nrnn = nn.LSTM(10, 20, 1)\r\ninput = Variable(torch.randn(5, 3, 10))\r\nh0 = Variable(torch.zeros(1, 3, 20))\r\nc0 = Variable(torch.zeros(1, 3, 20))\r\noutput, (hn, cn) = rnn(input, (h0, c0))\r\n\r\nprint (\"From LSTM\")\r\nprint hn[0]\r\n\r\nrnncell = nn.LSTMCell(10, 20)\r\nhx = Variable(torch.zeros(3, 20))\r\ncx = Variable(torch.zeros(3, 20))\r\nout = []\r\nfor i in range(5):\r\n           hx, cx = rnncell(input[i], (hx, cx))\r\n           out.append(hx)\r\n\r\nprint (\"from LSTM Cell\")\r\nprint hx\r\n## System Info\r\n\r\n- PyTorch or Caffe2: pytorch\r\n- How you installed PyTorch (conda, pip, source): pip\r\n- Build command you used (if compiling from source):\r\n- OS: ubuntu\r\n- PyTorch version: 0.3.1 \r\n- Python version: 2.7.12\r\n- CUDA/cuDNN version: NA\r\n- GPU models and configuration: NA\r\n- GCC version (if compiling from source):\r\n- CMake version: NA\r\n- Versions of any other relevant libraries:\r\n"}