{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1202", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1202/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1202/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1202/events", "html_url": "https://github.com/pytorch/pytorch/issues/1202", "id": 219925525, "node_id": "MDU6SXNzdWUyMTk5MjU1MjU=", "number": 1202, "title": "Update pytorch.Trainer iterations correctly", "user": {"login": "komarov-k", "id": 13410688, "node_id": "MDQ6VXNlcjEzNDEwNjg4", "avatar_url": "https://avatars1.githubusercontent.com/u/13410688?v=4", "gravatar_id": "", "url": "https://api.github.com/users/komarov-k", "html_url": "https://github.com/komarov-k", "followers_url": "https://api.github.com/users/komarov-k/followers", "following_url": "https://api.github.com/users/komarov-k/following{/other_user}", "gists_url": "https://api.github.com/users/komarov-k/gists{/gist_id}", "starred_url": "https://api.github.com/users/komarov-k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/komarov-k/subscriptions", "organizations_url": "https://api.github.com/users/komarov-k/orgs", "repos_url": "https://api.github.com/users/komarov-k/repos", "events_url": "https://api.github.com/users/komarov-k/events{/privacy}", "received_events_url": "https://api.github.com/users/komarov-k/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-06T14:51:45Z", "updated_at": "2017-04-06T15:48:50Z", "closed_at": "2017-04-06T15:48:50Z", "author_association": "NONE", "body_html": "<p>In pytorch.Trainer.train, the last line should be <code>self.iterations = i</code> instead of <code>self.iterations += i</code>. The iterations should go from 1 to N during first epoch, then N+1 to 2N in second epoch, and so on. Currently, <code>self.iterations</code> is updated with progressively increasing values at the end of each epoch. For illustration purposes, consider the following two code snippets:</p>\n<div class=\"highlight highlight-source-python\"><pre>data <span class=\"pl-k\">=</span> [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>]\niterations <span class=\"pl-k\">=</span> <span class=\"pl-c1\">3</span>\nepochs <span class=\"pl-k\">=</span> <span class=\"pl-c1\">3</span>\n<span class=\"pl-k\">for</span> _ <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">0</span>, epochs):\n    <span class=\"pl-k\">for</span> i, item <span class=\"pl-k\">in</span> <span class=\"pl-c1\">enumerate</span>(items, iterations <span class=\"pl-k\">+</span> <span class=\"pl-c1\">1</span>):\n        <span class=\"pl-c1\">print</span> i\n    iterations <span class=\"pl-k\">+=</span> i</pre></div>\n<p>Output:</p>\n<pre><code>1\n2\n3\n4\n5\n6\n10\n11\n12\n</code></pre>\n<div class=\"highlight highlight-source-python\"><pre>data <span class=\"pl-k\">=</span> [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>]\niterations <span class=\"pl-k\">=</span> <span class=\"pl-c1\">3</span>\nepochs <span class=\"pl-k\">=</span> <span class=\"pl-c1\">3</span>\n<span class=\"pl-k\">for</span> _ <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">0</span>, epochs):\n    <span class=\"pl-k\">for</span> i, item <span class=\"pl-k\">in</span> <span class=\"pl-c1\">enumerate</span>(items, iterations <span class=\"pl-k\">+</span> <span class=\"pl-c1\">1</span>):\n        <span class=\"pl-c1\">print</span> i\n    iterations <span class=\"pl-k\">=</span> i</pre></div>\n<p>Output:</p>\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n</code></pre>\n<p>Here the first snippet shows the bug that is currently present in Trainer, while the second one shows how to fix it.</p>", "body_text": "In pytorch.Trainer.train, the last line should be self.iterations = i instead of self.iterations += i. The iterations should go from 1 to N during first epoch, then N+1 to 2N in second epoch, and so on. Currently, self.iterations is updated with progressively increasing values at the end of each epoch. For illustration purposes, consider the following two code snippets:\ndata = [1, 2, 3]\niterations = 3\nepochs = 3\nfor _ in range(0, epochs):\n    for i, item in enumerate(items, iterations + 1):\n        print i\n    iterations += i\nOutput:\n1\n2\n3\n4\n5\n6\n10\n11\n12\n\ndata = [1, 2, 3]\niterations = 3\nepochs = 3\nfor _ in range(0, epochs):\n    for i, item in enumerate(items, iterations + 1):\n        print i\n    iterations = i\nOutput:\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\nHere the first snippet shows the bug that is currently present in Trainer, while the second one shows how to fix it.", "body": "In pytorch.Trainer.train, the last line should be ```self.iterations = i``` instead of ```self.iterations += i```. The iterations should go from 1 to N during first epoch, then N+1 to 2N in second epoch, and so on. Currently, ```self.iterations``` is updated with progressively increasing values at the end of each epoch. For illustration purposes, consider the following two code snippets:\r\n\r\n```python\r\ndata = [1, 2, 3]\r\niterations = 3\r\nepochs = 3\r\nfor _ in range(0, epochs):\r\n    for i, item in enumerate(items, iterations + 1):\r\n        print i\r\n    iterations += i\r\n```\r\n\r\nOutput:\r\n```\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n10\r\n11\r\n12\r\n```\r\n\r\n```python\r\ndata = [1, 2, 3]\r\niterations = 3\r\nepochs = 3\r\nfor _ in range(0, epochs):\r\n    for i, item in enumerate(items, iterations + 1):\r\n        print i\r\n    iterations = i\r\n```\r\n\r\nOutput:\r\n\r\n```\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n```\r\n\r\nHere the first snippet shows the bug that is currently present in Trainer, while the second one shows how to fix it.\r\n"}