{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/232404186", "pull_request_review_id": 173602893, "id": 232404186, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQwNDE4Ng==", "diff_hunk": "@@ -467,32 +460,37 @@ class ModuleEncoder: public EncoderBase {\n                       const TypePtr& type,\n                       const std::string& name);\n \n-  PyTorchStreamWriter stream_writer_;\n+  PyTorchStreamWriter* stream_writer_;\n   // Used to deduplicate tensor storages\n-  std::unordered_map<const void*, uint64_t> storage_dedup_map_;\n+  std::unordered_map<const void*, uint64_t>* storage_dedup_map_;\n \n   // Used to keep track of Parameter names so Methods can refer to them\n-  std::unordered_map<at::Tensor*, std::string> parameter_map_;\n+  std::unordered_map<at::Tensor*, std::string>* parameter_map_;\n \n   // Used to create sequential dummy names for node types\n   size_t type_counter_ = 0;\n };\n \n-ModuleEncoder::ModuleEncoder(\n-    const script::Module &module,\n-    std::ostream& out)\n-    : EncoderBase(onnx_torch::OperatorExportTypes::RAW, false),\n-      stream_writer_(&out) {\n-  model_proto_.set_doc_string(\"THIS PROTO IS NOT STANDARD ONNX\");\n-  EncodeModule(model_proto_.mutable_graph(), module);\n+MethodEncoder::MethodEncoder(script::Method& method,\n+    onnx::NodeProto* node_proto,", "path": "torch/csrc/jit/export.cpp", "position": null, "original_position": 74, "commit_id": "e186c1feb925618f88a7471a9b0d6b51ed454a08", "original_commit_id": "ed6ab9b76f080f9c8643a5e84bd4de1a820d77f6", "user": {"login": "dzhulgakov", "id": 17890620, "node_id": "MDQ6VXNlcjE3ODkwNjIw", "avatar_url": "https://avatars2.githubusercontent.com/u/17890620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dzhulgakov", "html_url": "https://github.com/dzhulgakov", "followers_url": "https://api.github.com/users/dzhulgakov/followers", "following_url": "https://api.github.com/users/dzhulgakov/following{/other_user}", "gists_url": "https://api.github.com/users/dzhulgakov/gists{/gist_id}", "starred_url": "https://api.github.com/users/dzhulgakov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dzhulgakov/subscriptions", "organizations_url": "https://api.github.com/users/dzhulgakov/orgs", "repos_url": "https://api.github.com/users/dzhulgakov/repos", "events_url": "https://api.github.com/users/dzhulgakov/events{/privacy}", "received_events_url": "https://api.github.com/users/dzhulgakov/received_events", "type": "User", "site_admin": false}, "body": "wait, why do you still have NodeProto here?", "created_at": "2018-11-09T21:50:12Z", "updated_at": "2018-11-23T15:54:36Z", "html_url": "https://github.com/pytorch/pytorch/pull/13736#discussion_r232404186", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/13736", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/232404186"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/13736#discussion_r232404186"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/13736"}}, "body_html": "<p>wait, why do you still have NodeProto here?</p>", "body_text": "wait, why do you still have NodeProto here?"}