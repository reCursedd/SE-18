{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/231930858", "pull_request_review_id": 173010848, "id": 231930858, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTkzMDg1OA==", "diff_hunk": "@@ -239,23 +238,23 @@ class TensorFeeder : public BlobFeederBase {\n             \"instead of unicode strings.\");\n         break;\n       default:\n+        tensor = caffe2::empty(\n+            dims, at::TensorOptions(dtype).device(Context::GetDeviceType()));\n         context.CopyBytesFromCPU(\n-            tensor->numel() * meta.itemsize(),\n+            tensor.numel() * dtype.itemsize(),\n             static_cast<void*>(PyArray_DATA(array)),\n-            tensor->raw_mutable_data(meta));\n+            tensor.raw_mutable_data());\n     }\n     context.FinishDeviceComputation();\n #else\n     CAFFE_THROW(\"Caffe2 compiled without NumPy support.\");\n #endif // USE_NUMPY\n+    return tensor;\n   }\n \n   virtual void\n   Feed(const DeviceOption& option, PyArrayObject* original_array, Blob* blob) {\n-    FeedTensor(\n-        option,\n-        original_array,\n-        BlobGetMutableTensor(blob, Context::GetDeviceType()));\n+    blob->Reset<Tensor>(new Tensor(FeedTensor(option, original_array)));", "path": "caffe2/python/pybind_state.h", "position": 93, "original_position": 93, "commit_id": "355e973634076c5e98bcbe63c60f4bf09ddfd34d", "original_commit_id": "9d286c86640c81d2e9aa51bb72add8fddb76ce30", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "body": "Would be nice to get rid of the `new Tensor` here sooner than later.", "created_at": "2018-11-08T15:20:54Z", "updated_at": "2018-11-23T15:54:31Z", "html_url": "https://github.com/pytorch/pytorch/pull/13641#discussion_r231930858", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/13641", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/231930858"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/13641#discussion_r231930858"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/13641"}}, "body_html": "<p>Would be nice to get rid of the <code>new Tensor</code> here sooner than later.</p>", "body_text": "Would be nice to get rid of the new Tensor here sooner than later."}