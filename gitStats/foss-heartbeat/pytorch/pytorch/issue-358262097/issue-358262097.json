{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11419", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11419/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11419/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11419/events", "html_url": "https://github.com/pytorch/pytorch/issues/11419", "id": 358262097, "node_id": "MDU6SXNzdWUzNTgyNjIwOTc=", "number": 11419, "title": "pybind/GIL-related hang with Python 3.7 when resolving `torch.` in script", "user": {"login": "jekbradbury", "id": 11729078, "node_id": "MDQ6VXNlcjExNzI5MDc4", "avatar_url": "https://avatars2.githubusercontent.com/u/11729078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jekbradbury", "html_url": "https://github.com/jekbradbury", "followers_url": "https://api.github.com/users/jekbradbury/followers", "following_url": "https://api.github.com/users/jekbradbury/following{/other_user}", "gists_url": "https://api.github.com/users/jekbradbury/gists{/gist_id}", "starred_url": "https://api.github.com/users/jekbradbury/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jekbradbury/subscriptions", "organizations_url": "https://api.github.com/users/jekbradbury/orgs", "repos_url": "https://api.github.com/users/jekbradbury/repos", "events_url": "https://api.github.com/users/jekbradbury/events{/privacy}", "received_events_url": "https://api.github.com/users/jekbradbury/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1002715609, "node_id": "MDU6TGFiZWwxMDAyNzE1NjA5", "url": "https://api.github.com/repos/pytorch/pytorch/labels/blocker", "name": "blocker", "color": "b60205", "default": false}, {"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}, {"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "jamesr66a", "id": 4685384, "node_id": "MDQ6VXNlcjQ2ODUzODQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/4685384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamesr66a", "html_url": "https://github.com/jamesr66a", "followers_url": "https://api.github.com/users/jamesr66a/followers", "following_url": "https://api.github.com/users/jamesr66a/following{/other_user}", "gists_url": "https://api.github.com/users/jamesr66a/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamesr66a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamesr66a/subscriptions", "organizations_url": "https://api.github.com/users/jamesr66a/orgs", "repos_url": "https://api.github.com/users/jamesr66a/repos", "events_url": "https://api.github.com/users/jamesr66a/events{/privacy}", "received_events_url": "https://api.github.com/users/jamesr66a/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jamesr66a", "id": 4685384, "node_id": "MDQ6VXNlcjQ2ODUzODQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/4685384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamesr66a", "html_url": "https://github.com/jamesr66a", "followers_url": "https://api.github.com/users/jamesr66a/followers", "following_url": "https://api.github.com/users/jamesr66a/following{/other_user}", "gists_url": "https://api.github.com/users/jamesr66a/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamesr66a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamesr66a/subscriptions", "organizations_url": "https://api.github.com/users/jamesr66a/orgs", "repos_url": "https://api.github.com/users/jamesr66a/repos", "events_url": "https://api.github.com/users/jamesr66a/events{/privacy}", "received_events_url": "https://api.github.com/users/jamesr66a/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-08T04:07:12Z", "updated_at": "2018-09-11T19:41:02Z", "closed_at": "2018-09-11T19:41:02Z", "author_association": "CONTRIBUTOR", "body_html": "<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): <code>MACOSX_DEPLOYMENT_TARGET=10.9 NO_CUDA=1 DEBUG=1 CC=clang CXX=clang++ python setup.py build_deps develop</code></li>\n<li>OS: macOS 10.13.6</li>\n<li>PyTorch version: 0.5.0a0+c9843bd (master from today)</li>\n<li>Python version: 3.7.0 (issue not present with 3.6.6)</li>\n<li>CUDA/cuDNN version: N/A</li>\n<li>GPU models and configuration: N/A</li>\n<li>GCC version (if compiling from source): Apple Clang 9.1.0</li>\n<li>CMake version: 3.12.0</li>\n<li>Versions of any other relevant libraries:</li>\n</ul>\n<p>This hangs:</p>\n<pre><code>$ cat mwe.py \nimport torch\n@torch.jit.script\ndef f(x):\n    return torch.tanh(x)\n$ python mwe.py\n\n</code></pre>\n<p>This is the LLDB backtrace:</p>\n<pre><code>  * frame #0: 0x00007fff773e8a16 libsystem_kernel.dylib`__psynch_cvwait + 10\n    frame #1: 0x00007fff775b1589 libsystem_pthread.dylib`_pthread_cond_wait + 732\n    frame #2: 0x000000010015ff01 python`take_gil + 417\n    frame #3: 0x0000000100160246 python`PyEval_AcquireThread + 22\n    frame #4: 0x000000011026543c _C.cpython-37m-darwin.so`pybind11::gil_scoped_acquire::gil_scoped_acquire(this=0x00007ffeefbf6f90) at pybind11.h:1781\n    frame #5: 0x0000000110265355 _C.cpython-37m-darwin.so`pybind11::gil_scoped_acquire::gil_scoped_acquire(this=0x00007ffeefbf6f90) at pybind11.h:1756\n    frame #6: 0x00000001109efcaf _C.cpython-37m-darwin.so`pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(this=0x000000011b51e008, args=\"torch\")::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)::operator()(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;) const at functional.h:58\n    frame #7: 0x00000001109efc34 _C.cpython-37m-darwin.so`pybind11::function std::__1::__invoke_void_return_wrapper&lt;pybind11::function&gt;::__call&lt;pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt;(pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;&amp;&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;&amp;&amp;) [inlined] decltype(__f=0x000000011b51e008, __args=\"\")&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;&gt;(fp)(std::__1::forward&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt;(fp0))) std::__1::__invoke&lt;pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt;(pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;&amp;&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;&amp;&amp;) at type_traits:4323\n    frame #8: 0x00000001109efb5f _C.cpython-37m-darwin.so`pybind11::function std::__1::__invoke_void_return_wrapper&lt;pybind11::function&gt;::__call&lt;pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (__args=0x000000011b51e008, __args=\"\")&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt;(pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&amp;&amp;&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;&amp;&amp;) at __functional_base:318\n    frame #9: 0x00000001109ef970 _C.cpython-37m-darwin.so`std::__1::__function::__func&lt;pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;), std::__1::allocator&lt;pybind11::detail::type_caster&lt;std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, void&gt;::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;::operator(this=0x000000011b51e000, __arg=\"\")(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;&amp;&amp;) at functional:1562\n    frame #10: 0x00000001109e5d94 _C.cpython-37m-darwin.so`std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;::operator(this=0x000000011b51e000, __arg=\"\")(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;) const at functional:1921\n    frame #11: 0x00000001109e5ab9 _C.cpython-37m-darwin.so`torch::jit::script::pythonResolver(this=0x000000011b5202b0, name=\"torch\", m=0x000000011b520c10, loc=0x00007ffeefbf81a0)&gt;)::$_0::operator()(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;) const at init.cpp:367\n    frame #12: 0x00000001109e5a3a _C.cpython-37m-darwin.so`std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; std::__1::__invoke_void_return_wrapper&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; &gt;::__call&lt;torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;&gt;(torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0&amp;&amp;&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;&amp;&amp;, torch::jit::script::Method&amp;&amp;&amp;, torch::jit::SourceRange const&amp;&amp;&amp;) [inlined] decltype(__f=0x000000011b5202b0, __args=\"torch\", __args=0x000000011b520c10, __args=0x00007ffeefbf81a0)&gt;)::$_0&amp;&gt;(fp)(std::__1::forward&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;&gt;(fp0))) std::__1::__invoke&lt;torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;&gt;(torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0&amp;&amp;&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;&amp;&amp;, torch::jit::script::Method&amp;&amp;&amp;, torch::jit::SourceRange const&amp;&amp;&amp;) at type_traits:4323\n    frame #13: 0x00000001109e59fe _C.cpython-37m-darwin.so`std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; std::__1::__invoke_void_return_wrapper&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; &gt;::__call&lt;torch::jit::script::pythonResolver(__args=0x000000011b5202b0, __args=\"torch\", __args=0x000000011b520c10, __args=0x00007ffeefbf81a0)&gt;)::$_0&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;&gt;(torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0&amp;&amp;&amp;, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;&amp;&amp;, torch::jit::script::Method&amp;&amp;&amp;, torch::jit::SourceRange const&amp;&amp;&amp;) at __functional_base:318\n    frame #14: 0x00000001109e5670 _C.cpython-37m-darwin.so`std::__1::__function::__func&lt;torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0, std::__1::allocator&lt;torch::jit::script::pythonResolver(std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;)::$_0&gt;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;::operator(this=0x000000011b5202a0, __arg=\"torch\", __arg=0x000000011b520c10, __arg=0x00007ffeefbf81a0)(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;) at functional:1562\n    frame #15: 0x0000000118fa2a0f libtorch.dylib`std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;::operator(this=0x000000011b5202a0, __arg=\"torch\", __arg=0x000000011b520c10, __arg=0x00007ffeefbf81a0)(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;) const at functional:1921\n    frame #16: 0x0000000118fa0fe3 libtorch.dylib`torch::jit::script::Environment::getSugaredVar(this=0x000000011b5202f8, ident=\"torch\", range=SourceRange @ 0x00007ffeefbf81a0, required=true) at compiler.cpp:316\n    frame #17: 0x0000000118fb5dd4 libtorch.dylib`torch::jit::script::Environment::getSugaredVar(this=0x000000011b5202f8, ident=0x00007ffeefbf8470, required=true) at compiler.cpp:306\n    frame #18: 0x0000000118f9ab96 libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8700, n_binders=1) at compiler.cpp:1444\n    frame #19: 0x0000000118f9ac92 libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf88b8, n_binders=1) at compiler.cpp:1447\n    frame #20: 0x0000000118fb6c5f libtorch.dylib`torch::jit::script::to_ir::emitApplyExpr(this=0x00007ffeefbfb2f0, callee=Expr @ 0x00007ffeefbf89f8, inputs=size=1, attributes=ArrayRef&lt;torch::jit::NamedValue&gt; @ 0x00007ffeefbf88e8, n_binders=1) at compiler.cpp:1418\n    frame #21: 0x0000000118f9b21f libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8c90, n_binders=1) at compiler.cpp:1460\n    frame #22: 0x0000000118f9c671 libtorch.dylib`torch::jit::script::to_ir::emitExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8d78) at compiler.cpp:1423\n    frame #23: 0x0000000118fb9109 libtorch.dylib`torch::jit::script::to_ir::getNamedValues(this=0x00007ffeefbfb2f0, trees=&lt;unavailable&gt;, maybe_unpack=true) at compiler.cpp:1381\n    frame #24: 0x0000000118fd1fe0 libtorch.dylib`torch::jit::script::to_ir::getValues(this=0x00007ffeefbfb2f0, trees=&lt;unavailable&gt;, maybe_unpack=true) at compiler.cpp:1395\n    frame #25: 0x0000000118f8d384 libtorch.dylib`torch::jit::script::to_ir::getValues(this=0x00007ffeefbfb2f0, trees=&lt;unavailable&gt;, maybe_unpack=true) at compiler.cpp:1400\n    frame #26: 0x0000000118f8954e libtorch.dylib`torch::jit::script::to_ir::to_ir(this=0x00007ffeefbfb2f0, def=Def @ 0x00007ffeefbfb2e0, function_table=size=1, resolver=0x000000011b5202a0, self=nullptr, method=0x000000011b520c10)&gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;, torch::jit::script::Method&amp;) at compiler.cpp:791\n    frame #27: 0x0000000118f8743d libtorch.dylib`torch::jit::script::to_ir::to_ir(this=0x00007ffeefbfb2f0, def=&lt;unavailable&gt;, function_table=size=1, resolver=0x000000011b5202a0, self=&lt;unavailable&gt;, method=0x000000011b520c10)&gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;, torch::jit::script::Method&amp;) at compiler.cpp:737\n    frame #28: 0x0000000118f8739e libtorch.dylib`torch::jit::script::defineMethodsInModule(this=0x000000011b520fa0, method=0x000000011b520c10)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4::operator()(torch::jit::script::Method&amp;) const at compiler.cpp:1823\n    frame #29: 0x0000000118f8727d libtorch.dylib`void std::__1::__invoke_void_return_wrapper&lt;void&gt;::__call&lt;torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;, torch::jit::script::Method&amp;&gt;(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;&amp;&amp;, torch::jit::script::Method&amp;&amp;&amp;) [inlined] decltype(__f=0x000000011b520fa0, __args=0x000000011b520c10)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;&gt;(fp)(std::__1::forward&lt;torch::jit::script::Method&amp;&gt;(fp0))) std::__1::__invoke&lt;torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;, torch::jit::script::Method&amp;&gt;(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;&amp;&amp;, torch::jit::script::Method&amp;&amp;&amp;) at type_traits:4323\n    frame #30: 0x0000000118f87260 libtorch.dylib`void std::__1::__invoke_void_return_wrapper&lt;void&gt;::__call&lt;torch::jit::script::defineMethodsInModule(__args=0x000000011b520fa0, __args=0x000000011b520c10)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;, torch::jit::script::Method&amp;&gt;(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&amp;&amp;&amp;, torch::jit::script::Method&amp;&amp;&amp;) at __functional_base:349\n    frame #31: 0x0000000118f86e79 libtorch.dylib`std::__1::__function::__func&lt;torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4, std::__1::allocator&lt;torch::jit::script::defineMethodsInModule(torch::jit::script::Module&amp;, std::__1::vector&lt;torch::jit::script::Def, std::__1::allocator&lt;torch::jit::script::Def&gt; &gt; const&amp;, std::__1::vector&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;)::$_4&gt;, void (torch::jit::script::Method&amp;)&gt;::operator(this=0x000000011b520f90, __arg=0x000000011b520c10)(torch::jit::script::Method&amp;) at functional:1562\n    frame #32: 0x0000000110a59e0e _C.cpython-37m-darwin.so`std::__1::function&lt;void (torch::jit::script::Method&amp;)&gt;::operator(this=0x000000011b520f90, __arg=0x000000011b520c10)(torch::jit::script::Method&amp;) const at functional:1921\n    frame #33: 0x000000011900a2b2 libtorch.dylib`torch::jit::script::Method::ensure_defined(this=0x000000011b520c10) at module.cpp:69\n    frame #34: 0x0000000118f489d7 libtorch.dylib`torch::jit::script::defineMethodsInModule(m=0x00007ffeefbfca18, definitions=size=1, resolvers=size=1, self=nullptr)&gt;, std::__1::allocator&lt;std::__1::function&lt;std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt; (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;)&gt; &gt; &gt; const&amp;, std::__1::shared_ptr&lt;torch::jit::script::SugaredValue&gt;) at compiler.cpp:1836\n    frame #35: 0x0000000118f5051c libtorch.dylib`torch::jit::script::compileFunction(def=Def @ 0x00007ffeefbfcd80, resolver=0x000000011a6ce950)&gt; const&amp;) at compiler.cpp:1958\n    frame #36: 0x0000000110a13e2a _C.cpython-37m-darwin.so`torch::jit::script::initJitScriptBindings(this=0x000000011a6b67e8, def=0x000000011a6d5160, rcb=0x000000011a6d0410)::$_21::operator()(torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;) const at init.cpp:534\n    frame #37: 0x0000000110a13d39 _C.cpython-37m-darwin.so`std::__1::shared_ptr&lt;torch::jit::Graph&gt; pybind11::detail::argument_loader&lt;torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (this=0x00007ffeefbfcff0, f=0x000000011a6b67e8, (null)=index_sequence&lt;0, 1&gt; @ 0x00007ffeefbfce80, (null)=0x00007ffeefbfcf20)&gt; &gt;::call_impl&lt;std::__1::shared_ptr&lt;torch::jit::Graph&gt;, torch::jit::script::initJitScriptBindings(_object*)::$_21&amp;, 0ul, 1ul, pybind11::detail::void_type&gt;(torch::jit::script::initJitScriptBindings(_object*)::$_21&amp;&amp;&amp;, pybind11::detail::index_sequence&lt;0ul, 1ul&gt;, pybind11::detail::void_type&amp;&amp;) at cast.h:1866\n    frame #38: 0x0000000110a13768 _C.cpython-37m-darwin.so`std::__1::enable_if&lt;!(std::is_void&lt;std::__1::shared_ptr&lt;torch::jit::Graph&gt; &gt;::value), std::__1::shared_ptr&lt;torch::jit::Graph&gt; &gt;::type pybind11::detail::argument_loader&lt;torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (this=0x00007ffeefbfcff0, f=0x000000011a6b67e8)&gt; &gt;::call&lt;std::__1::shared_ptr&lt;torch::jit::Graph&gt;, pybind11::detail::void_type, torch::jit::script::initJitScriptBindings(_object*)::$_21&amp;&gt;(torch::jit::script::initJitScriptBindings(_object*)::$_21&amp;&amp;&amp;) at cast.h:1843\n    frame #39: 0x0000000110a135da _C.cpython-37m-darwin.so`void pybind11::cpp_function::initialize&lt;torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr&lt;torch::jit::Graph&gt;, torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, pybind11::name, pybind11::scope, pybind11::sibling&gt;(this=0x0000000110a134a0, call=0x00007ffeefbfd978)::$_21&amp;&amp;, std::__1::shared_ptr&lt;torch::jit::Graph&gt; (*)(torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;), pybind11::name const&amp;, pybind11::scope const&amp;, pybind11::sibling const&amp;)::'lambda'(pybind11::detail::function_call&amp;)::operator()(pybind11::detail::function_call&amp;) const at pybind11.h:155\n    frame #40: 0x0000000110a134b8 _C.cpython-37m-darwin.so`void pybind11::cpp_function::initialize&lt;torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr&lt;torch::jit::Graph&gt;, torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;, pybind11::name, pybind11::scope, pybind11::sibling&gt;(call=0x00007ffeefbfd978)::$_21&amp;&amp;, std::__1::shared_ptr&lt;torch::jit::Graph&gt; (*)(torch::jit::script::Def const&amp;, std::__1::function&lt;pybind11::function (std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;)&gt;), pybind11::name const&amp;, pybind11::scope const&amp;, pybind11::sibling const&amp;)::'lambda'(pybind11::detail::function_call&amp;)::__invoke(pybind11::detail::function_call&amp;) at pybind11.h:132\n    frame #41: 0x0000000110277ed7 _C.cpython-37m-darwin.so`pybind11::cpp_function::dispatcher(self=0x000000011a374e70, args_in=0x000000011b4b5288, kwargs_in=0x0000000000000000) at pybind11.h:619\n    frame #42: 0x000000010002ec48 python`_PyMethodDef_RawFastCallKeywords + 392\n    frame #43: 0x000000010016f2b1 python`call_function + 257\n    frame #44: 0x000000010016cf99 python`_PyEval_EvalFrameDefault + 45705\n    frame #45: 0x0000000100160a42 python`_PyEval_EvalCodeWithName + 418\n    frame #46: 0x000000010002ea73 python`_PyFunction_FastCallKeywords + 195\n    frame #47: 0x000000010016f265 python`call_function + 181\n    frame #48: 0x000000010016cf99 python`_PyEval_EvalFrameDefault + 45705\n    frame #49: 0x0000000100160a42 python`_PyEval_EvalCodeWithName + 418\n    frame #50: 0x00000001001c49a0 python`PyRun_FileExFlags + 256\n    frame #51: 0x00000001001c4104 python`PyRun_SimpleFileExFlags + 388\n    frame #52: 0x00000001001efedc python`pymain_main + 9148\n    frame #53: 0x0000000100000ece python`main + 142\n    frame #54: 0x00007fff77298015 libdyld.dylib`start + 1\n</code></pre>\n<p>The symbol being resolved is <code>torch</code>:</p>\n<pre><code>frame #11: 0x0000000112e71ab9 _C.cpython-37m-darwin.so`torch::jit::script::pythonResolver(this=0x0000000101aecf40, name=\"torch\", m=0x000000011c8a52f0, loc=0x00007ffeefbf6360)&gt;)::$_0::operator()(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; const&amp;, torch::jit::script::Method&amp;, torch::jit::SourceRange const&amp;) const at init.cpp:367\n   364 \t             Method&amp; m,\n   365 \t             const SourceRange&amp; loc) -&gt; std::shared_ptr&lt;SugaredValue&gt; {\n   366 \t    AutoGIL ag;\n-&gt; 367 \t    py::object obj = rcb(name);\n   368 \t    if (obj.is(py::none())) {\n   369 \t      return nullptr;\n   370 \t    }\n(lldb) p rcb\n(torch::jit::script::ResolutionCallback) $0 = 0x0000000101aca650\n(lldb) p name\n(std::__1::string) $1 = \"torch\"\n</code></pre>\n<p>and script works fine with e.g. <code>a + b</code>. I get the same issue when I build from a commit before <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"353650353\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/10847\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/10847/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/10847\">#10847</a>, but <code>mwe.py</code> works fine if I rebuild with Python 3.6.6.</p>", "body_text": "PyTorch or Caffe2: PyTorch\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): MACOSX_DEPLOYMENT_TARGET=10.9 NO_CUDA=1 DEBUG=1 CC=clang CXX=clang++ python setup.py build_deps develop\nOS: macOS 10.13.6\nPyTorch version: 0.5.0a0+c9843bd (master from today)\nPython version: 3.7.0 (issue not present with 3.6.6)\nCUDA/cuDNN version: N/A\nGPU models and configuration: N/A\nGCC version (if compiling from source): Apple Clang 9.1.0\nCMake version: 3.12.0\nVersions of any other relevant libraries:\n\nThis hangs:\n$ cat mwe.py \nimport torch\n@torch.jit.script\ndef f(x):\n    return torch.tanh(x)\n$ python mwe.py\n\n\nThis is the LLDB backtrace:\n  * frame #0: 0x00007fff773e8a16 libsystem_kernel.dylib`__psynch_cvwait + 10\n    frame #1: 0x00007fff775b1589 libsystem_pthread.dylib`_pthread_cond_wait + 732\n    frame #2: 0x000000010015ff01 python`take_gil + 417\n    frame #3: 0x0000000100160246 python`PyEval_AcquireThread + 22\n    frame #4: 0x000000011026543c _C.cpython-37m-darwin.so`pybind11::gil_scoped_acquire::gil_scoped_acquire(this=0x00007ffeefbf6f90) at pybind11.h:1781\n    frame #5: 0x0000000110265355 _C.cpython-37m-darwin.so`pybind11::gil_scoped_acquire::gil_scoped_acquire(this=0x00007ffeefbf6f90) at pybind11.h:1756\n    frame #6: 0x00000001109efcaf _C.cpython-37m-darwin.so`pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(this=0x000000011b51e008, args=\"torch\")::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >) const at functional.h:58\n    frame #7: 0x00000001109efc34 _C.cpython-37m-darwin.so`pybind11::function std::__1::__invoke_void_return_wrapper<pybind11::function>::__call<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) [inlined] decltype(__f=0x000000011b51e008, __args=\"\")>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&>(fp)(std::__1::forward<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(fp0))) std::__1::__invoke<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) at type_traits:4323\n    frame #8: 0x00000001109efb5f _C.cpython-37m-darwin.so`pybind11::function std::__1::__invoke_void_return_wrapper<pybind11::function>::__call<pybind11::detail::type_caster<std::__1::function<pybind11::function (__args=0x000000011b51e008, __args=\"\")>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) at __functional_base:318\n    frame #9: 0x00000001109ef970 _C.cpython-37m-darwin.so`std::__1::__function::__func<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >), std::__1::allocator<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>::operator(this=0x000000011b51e000, __arg=\"\")(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) at functional:1562\n    frame #10: 0x00000001109e5d94 _C.cpython-37m-darwin.so`std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>::operator(this=0x000000011b51e000, __arg=\"\")(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >) const at functional:1921\n    frame #11: 0x00000001109e5ab9 _C.cpython-37m-darwin.so`torch::jit::script::pythonResolver(this=0x000000011b5202b0, name=\"torch\", m=0x000000011b520c10, loc=0x00007ffeefbf81a0)>)::$_0::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) const at init.cpp:367\n    frame #12: 0x00000001109e5a3a _C.cpython-37m-darwin.so`std::__1::shared_ptr<torch::jit::script::SugaredValue> std::__1::__invoke_void_return_wrapper<std::__1::shared_ptr<torch::jit::script::SugaredValue> >::__call<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&&&, torch::jit::script::Method&&&, torch::jit::SourceRange const&&&) [inlined] decltype(__f=0x000000011b5202b0, __args=\"torch\", __args=0x000000011b520c10, __args=0x00007ffeefbf81a0)>)::$_0&>(fp)(std::__1::forward<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(fp0))) std::__1::__invoke<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&&&, torch::jit::script::Method&&&, torch::jit::SourceRange const&&&) at type_traits:4323\n    frame #13: 0x00000001109e59fe _C.cpython-37m-darwin.so`std::__1::shared_ptr<torch::jit::script::SugaredValue> std::__1::__invoke_void_return_wrapper<std::__1::shared_ptr<torch::jit::script::SugaredValue> >::__call<torch::jit::script::pythonResolver(__args=0x000000011b5202b0, __args=\"torch\", __args=0x000000011b520c10, __args=0x00007ffeefbf81a0)>)::$_0&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&&&, torch::jit::script::Method&&&, torch::jit::SourceRange const&&&) at __functional_base:318\n    frame #14: 0x00000001109e5670 _C.cpython-37m-darwin.so`std::__1::__function::__func<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0, std::__1::allocator<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0>, std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>::operator(this=0x000000011b5202a0, __arg=\"torch\", __arg=0x000000011b520c10, __arg=0x00007ffeefbf81a0)(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) at functional:1562\n    frame #15: 0x0000000118fa2a0f libtorch.dylib`std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>::operator(this=0x000000011b5202a0, __arg=\"torch\", __arg=0x000000011b520c10, __arg=0x00007ffeefbf81a0)(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) const at functional:1921\n    frame #16: 0x0000000118fa0fe3 libtorch.dylib`torch::jit::script::Environment::getSugaredVar(this=0x000000011b5202f8, ident=\"torch\", range=SourceRange @ 0x00007ffeefbf81a0, required=true) at compiler.cpp:316\n    frame #17: 0x0000000118fb5dd4 libtorch.dylib`torch::jit::script::Environment::getSugaredVar(this=0x000000011b5202f8, ident=0x00007ffeefbf8470, required=true) at compiler.cpp:306\n    frame #18: 0x0000000118f9ab96 libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8700, n_binders=1) at compiler.cpp:1444\n    frame #19: 0x0000000118f9ac92 libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf88b8, n_binders=1) at compiler.cpp:1447\n    frame #20: 0x0000000118fb6c5f libtorch.dylib`torch::jit::script::to_ir::emitApplyExpr(this=0x00007ffeefbfb2f0, callee=Expr @ 0x00007ffeefbf89f8, inputs=size=1, attributes=ArrayRef<torch::jit::NamedValue> @ 0x00007ffeefbf88e8, n_binders=1) at compiler.cpp:1418\n    frame #21: 0x0000000118f9b21f libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8c90, n_binders=1) at compiler.cpp:1460\n    frame #22: 0x0000000118f9c671 libtorch.dylib`torch::jit::script::to_ir::emitExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8d78) at compiler.cpp:1423\n    frame #23: 0x0000000118fb9109 libtorch.dylib`torch::jit::script::to_ir::getNamedValues(this=0x00007ffeefbfb2f0, trees=<unavailable>, maybe_unpack=true) at compiler.cpp:1381\n    frame #24: 0x0000000118fd1fe0 libtorch.dylib`torch::jit::script::to_ir::getValues(this=0x00007ffeefbfb2f0, trees=<unavailable>, maybe_unpack=true) at compiler.cpp:1395\n    frame #25: 0x0000000118f8d384 libtorch.dylib`torch::jit::script::to_ir::getValues(this=0x00007ffeefbfb2f0, trees=<unavailable>, maybe_unpack=true) at compiler.cpp:1400\n    frame #26: 0x0000000118f8954e libtorch.dylib`torch::jit::script::to_ir::to_ir(this=0x00007ffeefbfb2f0, def=Def @ 0x00007ffeefbfb2e0, function_table=size=1, resolver=0x000000011b5202a0, self=nullptr, method=0x000000011b520c10)> const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>, torch::jit::script::Method&) at compiler.cpp:791\n    frame #27: 0x0000000118f8743d libtorch.dylib`torch::jit::script::to_ir::to_ir(this=0x00007ffeefbfb2f0, def=<unavailable>, function_table=size=1, resolver=0x000000011b5202a0, self=<unavailable>, method=0x000000011b520c10)> const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>, torch::jit::script::Method&) at compiler.cpp:737\n    frame #28: 0x0000000118f8739e libtorch.dylib`torch::jit::script::defineMethodsInModule(this=0x000000011b520fa0, method=0x000000011b520c10)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4::operator()(torch::jit::script::Method&) const at compiler.cpp:1823\n    frame #29: 0x0000000118f8727d libtorch.dylib`void std::__1::__invoke_void_return_wrapper<void>::__call<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&, torch::jit::script::Method&>(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&&&, torch::jit::script::Method&&&) [inlined] decltype(__f=0x000000011b520fa0, __args=0x000000011b520c10)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&>(fp)(std::__1::forward<torch::jit::script::Method&>(fp0))) std::__1::__invoke<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&, torch::jit::script::Method&>(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&&&, torch::jit::script::Method&&&) at type_traits:4323\n    frame #30: 0x0000000118f87260 libtorch.dylib`void std::__1::__invoke_void_return_wrapper<void>::__call<torch::jit::script::defineMethodsInModule(__args=0x000000011b520fa0, __args=0x000000011b520c10)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&, torch::jit::script::Method&>(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&&&, torch::jit::script::Method&&&) at __functional_base:349\n    frame #31: 0x0000000118f86e79 libtorch.dylib`std::__1::__function::__func<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4, std::__1::allocator<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4>, void (torch::jit::script::Method&)>::operator(this=0x000000011b520f90, __arg=0x000000011b520c10)(torch::jit::script::Method&) at functional:1562\n    frame #32: 0x0000000110a59e0e _C.cpython-37m-darwin.so`std::__1::function<void (torch::jit::script::Method&)>::operator(this=0x000000011b520f90, __arg=0x000000011b520c10)(torch::jit::script::Method&) const at functional:1921\n    frame #33: 0x000000011900a2b2 libtorch.dylib`torch::jit::script::Method::ensure_defined(this=0x000000011b520c10) at module.cpp:69\n    frame #34: 0x0000000118f489d7 libtorch.dylib`torch::jit::script::defineMethodsInModule(m=0x00007ffeefbfca18, definitions=size=1, resolvers=size=1, self=nullptr)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>) at compiler.cpp:1836\n    frame #35: 0x0000000118f5051c libtorch.dylib`torch::jit::script::compileFunction(def=Def @ 0x00007ffeefbfcd80, resolver=0x000000011a6ce950)> const&) at compiler.cpp:1958\n    frame #36: 0x0000000110a13e2a _C.cpython-37m-darwin.so`torch::jit::script::initJitScriptBindings(this=0x000000011a6b67e8, def=0x000000011a6d5160, rcb=0x000000011a6d0410)::$_21::operator()(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>) const at init.cpp:534\n    frame #37: 0x0000000110a13d39 _C.cpython-37m-darwin.so`std::__1::shared_ptr<torch::jit::Graph> pybind11::detail::argument_loader<torch::jit::script::Def const&, std::__1::function<pybind11::function (this=0x00007ffeefbfcff0, f=0x000000011a6b67e8, (null)=index_sequence<0, 1> @ 0x00007ffeefbfce80, (null)=0x00007ffeefbfcf20)> >::call_impl<std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::initJitScriptBindings(_object*)::$_21&, 0ul, 1ul, pybind11::detail::void_type>(torch::jit::script::initJitScriptBindings(_object*)::$_21&&&, pybind11::detail::index_sequence<0ul, 1ul>, pybind11::detail::void_type&&) at cast.h:1866\n    frame #38: 0x0000000110a13768 _C.cpython-37m-darwin.so`std::__1::enable_if<!(std::is_void<std::__1::shared_ptr<torch::jit::Graph> >::value), std::__1::shared_ptr<torch::jit::Graph> >::type pybind11::detail::argument_loader<torch::jit::script::Def const&, std::__1::function<pybind11::function (this=0x00007ffeefbfcff0, f=0x000000011a6b67e8)> >::call<std::__1::shared_ptr<torch::jit::Graph>, pybind11::detail::void_type, torch::jit::script::initJitScriptBindings(_object*)::$_21&>(torch::jit::script::initJitScriptBindings(_object*)::$_21&&&) at cast.h:1843\n    frame #39: 0x0000000110a135da _C.cpython-37m-darwin.so`void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::name, pybind11::scope, pybind11::sibling>(this=0x0000000110a134a0, call=0x00007ffeefbfd978)::$_21&&, std::__1::shared_ptr<torch::jit::Graph> (*)(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::'lambda'(pybind11::detail::function_call&)::operator()(pybind11::detail::function_call&) const at pybind11.h:155\n    frame #40: 0x0000000110a134b8 _C.cpython-37m-darwin.so`void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::name, pybind11::scope, pybind11::sibling>(call=0x00007ffeefbfd978)::$_21&&, std::__1::shared_ptr<torch::jit::Graph> (*)(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::'lambda'(pybind11::detail::function_call&)::__invoke(pybind11::detail::function_call&) at pybind11.h:132\n    frame #41: 0x0000000110277ed7 _C.cpython-37m-darwin.so`pybind11::cpp_function::dispatcher(self=0x000000011a374e70, args_in=0x000000011b4b5288, kwargs_in=0x0000000000000000) at pybind11.h:619\n    frame #42: 0x000000010002ec48 python`_PyMethodDef_RawFastCallKeywords + 392\n    frame #43: 0x000000010016f2b1 python`call_function + 257\n    frame #44: 0x000000010016cf99 python`_PyEval_EvalFrameDefault + 45705\n    frame #45: 0x0000000100160a42 python`_PyEval_EvalCodeWithName + 418\n    frame #46: 0x000000010002ea73 python`_PyFunction_FastCallKeywords + 195\n    frame #47: 0x000000010016f265 python`call_function + 181\n    frame #48: 0x000000010016cf99 python`_PyEval_EvalFrameDefault + 45705\n    frame #49: 0x0000000100160a42 python`_PyEval_EvalCodeWithName + 418\n    frame #50: 0x00000001001c49a0 python`PyRun_FileExFlags + 256\n    frame #51: 0x00000001001c4104 python`PyRun_SimpleFileExFlags + 388\n    frame #52: 0x00000001001efedc python`pymain_main + 9148\n    frame #53: 0x0000000100000ece python`main + 142\n    frame #54: 0x00007fff77298015 libdyld.dylib`start + 1\n\nThe symbol being resolved is torch:\nframe #11: 0x0000000112e71ab9 _C.cpython-37m-darwin.so`torch::jit::script::pythonResolver(this=0x0000000101aecf40, name=\"torch\", m=0x000000011c8a52f0, loc=0x00007ffeefbf6360)>)::$_0::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) const at init.cpp:367\n   364 \t             Method& m,\n   365 \t             const SourceRange& loc) -> std::shared_ptr<SugaredValue> {\n   366 \t    AutoGIL ag;\n-> 367 \t    py::object obj = rcb(name);\n   368 \t    if (obj.is(py::none())) {\n   369 \t      return nullptr;\n   370 \t    }\n(lldb) p rcb\n(torch::jit::script::ResolutionCallback) $0 = 0x0000000101aca650\n(lldb) p name\n(std::__1::string) $1 = \"torch\"\n\nand script works fine with e.g. a + b. I get the same issue when I build from a commit before #10847, but mwe.py works fine if I rebuild with Python 3.6.6.", "body": "- PyTorch or Caffe2: PyTorch\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): `MACOSX_DEPLOYMENT_TARGET=10.9 NO_CUDA=1 DEBUG=1 CC=clang CXX=clang++ python setup.py build_deps develop`\r\n- OS: macOS 10.13.6\r\n- PyTorch version: 0.5.0a0+c9843bd (master from today)\r\n- Python version: 3.7.0 (issue not present with 3.6.6)\r\n- CUDA/cuDNN version: N/A\r\n- GPU models and configuration: N/A\r\n- GCC version (if compiling from source): Apple Clang 9.1.0\r\n- CMake version: 3.12.0\r\n- Versions of any other relevant libraries:\r\n\r\nThis hangs:\r\n```\r\n$ cat mwe.py \r\nimport torch\r\n@torch.jit.script\r\ndef f(x):\r\n    return torch.tanh(x)\r\n$ python mwe.py\r\n\r\n```\r\nThis is the LLDB backtrace:\r\n```\r\n  * frame #0: 0x00007fff773e8a16 libsystem_kernel.dylib`__psynch_cvwait + 10\r\n    frame #1: 0x00007fff775b1589 libsystem_pthread.dylib`_pthread_cond_wait + 732\r\n    frame #2: 0x000000010015ff01 python`take_gil + 417\r\n    frame #3: 0x0000000100160246 python`PyEval_AcquireThread + 22\r\n    frame #4: 0x000000011026543c _C.cpython-37m-darwin.so`pybind11::gil_scoped_acquire::gil_scoped_acquire(this=0x00007ffeefbf6f90) at pybind11.h:1781\r\n    frame #5: 0x0000000110265355 _C.cpython-37m-darwin.so`pybind11::gil_scoped_acquire::gil_scoped_acquire(this=0x00007ffeefbf6f90) at pybind11.h:1756\r\n    frame #6: 0x00000001109efcaf _C.cpython-37m-darwin.so`pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(this=0x000000011b51e008, args=\"torch\")::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >) const at functional.h:58\r\n    frame #7: 0x00000001109efc34 _C.cpython-37m-darwin.so`pybind11::function std::__1::__invoke_void_return_wrapper<pybind11::function>::__call<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) [inlined] decltype(__f=0x000000011b51e008, __args=\"\")>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&>(fp)(std::__1::forward<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(fp0))) std::__1::__invoke<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) at type_traits:4323\r\n    frame #8: 0x00000001109efb5f _C.cpython-37m-darwin.so`pybind11::function std::__1::__invoke_void_return_wrapper<pybind11::function>::__call<pybind11::detail::type_caster<std::__1::function<pybind11::function (__args=0x000000011b51e008, __args=\"\")>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) at __functional_base:318\r\n    frame #9: 0x00000001109ef970 _C.cpython-37m-darwin.so`std::__1::__function::__func<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >), std::__1::allocator<pybind11::detail::type_caster<std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, void>::load(pybind11::handle, bool)::'lambda'(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>::operator(this=0x000000011b51e000, __arg=\"\")(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&&) at functional:1562\r\n    frame #10: 0x00000001109e5d94 _C.cpython-37m-darwin.so`std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>::operator(this=0x000000011b51e000, __arg=\"\")(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >) const at functional:1921\r\n    frame #11: 0x00000001109e5ab9 _C.cpython-37m-darwin.so`torch::jit::script::pythonResolver(this=0x000000011b5202b0, name=\"torch\", m=0x000000011b520c10, loc=0x00007ffeefbf81a0)>)::$_0::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) const at init.cpp:367\r\n    frame #12: 0x00000001109e5a3a _C.cpython-37m-darwin.so`std::__1::shared_ptr<torch::jit::script::SugaredValue> std::__1::__invoke_void_return_wrapper<std::__1::shared_ptr<torch::jit::script::SugaredValue> >::__call<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&&&, torch::jit::script::Method&&&, torch::jit::SourceRange const&&&) [inlined] decltype(__f=0x000000011b5202b0, __args=\"torch\", __args=0x000000011b520c10, __args=0x00007ffeefbf81a0)>)::$_0&>(fp)(std::__1::forward<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(fp0))) std::__1::__invoke<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&&&, torch::jit::script::Method&&&, torch::jit::SourceRange const&&&) at type_traits:4323\r\n    frame #13: 0x00000001109e59fe _C.cpython-37m-darwin.so`std::__1::shared_ptr<torch::jit::script::SugaredValue> std::__1::__invoke_void_return_wrapper<std::__1::shared_ptr<torch::jit::script::SugaredValue> >::__call<torch::jit::script::pythonResolver(__args=0x000000011b5202b0, __args=\"torch\", __args=0x000000011b520c10, __args=0x00007ffeefbf81a0)>)::$_0&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&>(torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0&&&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&&&, torch::jit::script::Method&&&, torch::jit::SourceRange const&&&) at __functional_base:318\r\n    frame #14: 0x00000001109e5670 _C.cpython-37m-darwin.so`std::__1::__function::__func<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0, std::__1::allocator<torch::jit::script::pythonResolver(std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>)::$_0>, std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>::operator(this=0x000000011b5202a0, __arg=\"torch\", __arg=0x000000011b520c10, __arg=0x00007ffeefbf81a0)(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) at functional:1562\r\n    frame #15: 0x0000000118fa2a0f libtorch.dylib`std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>::operator(this=0x000000011b5202a0, __arg=\"torch\", __arg=0x000000011b520c10, __arg=0x00007ffeefbf81a0)(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) const at functional:1921\r\n    frame #16: 0x0000000118fa0fe3 libtorch.dylib`torch::jit::script::Environment::getSugaredVar(this=0x000000011b5202f8, ident=\"torch\", range=SourceRange @ 0x00007ffeefbf81a0, required=true) at compiler.cpp:316\r\n    frame #17: 0x0000000118fb5dd4 libtorch.dylib`torch::jit::script::Environment::getSugaredVar(this=0x000000011b5202f8, ident=0x00007ffeefbf8470, required=true) at compiler.cpp:306\r\n    frame #18: 0x0000000118f9ab96 libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8700, n_binders=1) at compiler.cpp:1444\r\n    frame #19: 0x0000000118f9ac92 libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf88b8, n_binders=1) at compiler.cpp:1447\r\n    frame #20: 0x0000000118fb6c5f libtorch.dylib`torch::jit::script::to_ir::emitApplyExpr(this=0x00007ffeefbfb2f0, callee=Expr @ 0x00007ffeefbf89f8, inputs=size=1, attributes=ArrayRef<torch::jit::NamedValue> @ 0x00007ffeefbf88e8, n_binders=1) at compiler.cpp:1418\r\n    frame #21: 0x0000000118f9b21f libtorch.dylib`torch::jit::script::to_ir::emitSugaredExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8c90, n_binders=1) at compiler.cpp:1460\r\n    frame #22: 0x0000000118f9c671 libtorch.dylib`torch::jit::script::to_ir::emitExpr(this=0x00007ffeefbfb2f0, tree=Expr @ 0x00007ffeefbf8d78) at compiler.cpp:1423\r\n    frame #23: 0x0000000118fb9109 libtorch.dylib`torch::jit::script::to_ir::getNamedValues(this=0x00007ffeefbfb2f0, trees=<unavailable>, maybe_unpack=true) at compiler.cpp:1381\r\n    frame #24: 0x0000000118fd1fe0 libtorch.dylib`torch::jit::script::to_ir::getValues(this=0x00007ffeefbfb2f0, trees=<unavailable>, maybe_unpack=true) at compiler.cpp:1395\r\n    frame #25: 0x0000000118f8d384 libtorch.dylib`torch::jit::script::to_ir::getValues(this=0x00007ffeefbfb2f0, trees=<unavailable>, maybe_unpack=true) at compiler.cpp:1400\r\n    frame #26: 0x0000000118f8954e libtorch.dylib`torch::jit::script::to_ir::to_ir(this=0x00007ffeefbfb2f0, def=Def @ 0x00007ffeefbfb2e0, function_table=size=1, resolver=0x000000011b5202a0, self=nullptr, method=0x000000011b520c10)> const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>, torch::jit::script::Method&) at compiler.cpp:791\r\n    frame #27: 0x0000000118f8743d libtorch.dylib`torch::jit::script::to_ir::to_ir(this=0x00007ffeefbfb2f0, def=<unavailable>, function_table=size=1, resolver=0x000000011b5202a0, self=<unavailable>, method=0x000000011b520c10)> const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>, torch::jit::script::Method&) at compiler.cpp:737\r\n    frame #28: 0x0000000118f8739e libtorch.dylib`torch::jit::script::defineMethodsInModule(this=0x000000011b520fa0, method=0x000000011b520c10)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4::operator()(torch::jit::script::Method&) const at compiler.cpp:1823\r\n    frame #29: 0x0000000118f8727d libtorch.dylib`void std::__1::__invoke_void_return_wrapper<void>::__call<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&, torch::jit::script::Method&>(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&&&, torch::jit::script::Method&&&) [inlined] decltype(__f=0x000000011b520fa0, __args=0x000000011b520c10)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&>(fp)(std::__1::forward<torch::jit::script::Method&>(fp0))) std::__1::__invoke<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&, torch::jit::script::Method&>(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&&&, torch::jit::script::Method&&&) at type_traits:4323\r\n    frame #30: 0x0000000118f87260 libtorch.dylib`void std::__1::__invoke_void_return_wrapper<void>::__call<torch::jit::script::defineMethodsInModule(__args=0x000000011b520fa0, __args=0x000000011b520c10)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&, torch::jit::script::Method&>(torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4&&&, torch::jit::script::Method&&&) at __functional_base:349\r\n    frame #31: 0x0000000118f86e79 libtorch.dylib`std::__1::__function::__func<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4, std::__1::allocator<torch::jit::script::defineMethodsInModule(torch::jit::script::Module&, std::__1::vector<torch::jit::script::Def, std::__1::allocator<torch::jit::script::Def> > const&, std::__1::vector<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>)::$_4>, void (torch::jit::script::Method&)>::operator(this=0x000000011b520f90, __arg=0x000000011b520c10)(torch::jit::script::Method&) at functional:1562\r\n    frame #32: 0x0000000110a59e0e _C.cpython-37m-darwin.so`std::__1::function<void (torch::jit::script::Method&)>::operator(this=0x000000011b520f90, __arg=0x000000011b520c10)(torch::jit::script::Method&) const at functional:1921\r\n    frame #33: 0x000000011900a2b2 libtorch.dylib`torch::jit::script::Method::ensure_defined(this=0x000000011b520c10) at module.cpp:69\r\n    frame #34: 0x0000000118f489d7 libtorch.dylib`torch::jit::script::defineMethodsInModule(m=0x00007ffeefbfca18, definitions=size=1, resolvers=size=1, self=nullptr)>, std::__1::allocator<std::__1::function<std::__1::shared_ptr<torch::jit::script::SugaredValue> (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&)> > > const&, std::__1::shared_ptr<torch::jit::script::SugaredValue>) at compiler.cpp:1836\r\n    frame #35: 0x0000000118f5051c libtorch.dylib`torch::jit::script::compileFunction(def=Def @ 0x00007ffeefbfcd80, resolver=0x000000011a6ce950)> const&) at compiler.cpp:1958\r\n    frame #36: 0x0000000110a13e2a _C.cpython-37m-darwin.so`torch::jit::script::initJitScriptBindings(this=0x000000011a6b67e8, def=0x000000011a6d5160, rcb=0x000000011a6d0410)::$_21::operator()(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>) const at init.cpp:534\r\n    frame #37: 0x0000000110a13d39 _C.cpython-37m-darwin.so`std::__1::shared_ptr<torch::jit::Graph> pybind11::detail::argument_loader<torch::jit::script::Def const&, std::__1::function<pybind11::function (this=0x00007ffeefbfcff0, f=0x000000011a6b67e8, (null)=index_sequence<0, 1> @ 0x00007ffeefbfce80, (null)=0x00007ffeefbfcf20)> >::call_impl<std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::initJitScriptBindings(_object*)::$_21&, 0ul, 1ul, pybind11::detail::void_type>(torch::jit::script::initJitScriptBindings(_object*)::$_21&&&, pybind11::detail::index_sequence<0ul, 1ul>, pybind11::detail::void_type&&) at cast.h:1866\r\n    frame #38: 0x0000000110a13768 _C.cpython-37m-darwin.so`std::__1::enable_if<!(std::is_void<std::__1::shared_ptr<torch::jit::Graph> >::value), std::__1::shared_ptr<torch::jit::Graph> >::type pybind11::detail::argument_loader<torch::jit::script::Def const&, std::__1::function<pybind11::function (this=0x00007ffeefbfcff0, f=0x000000011a6b67e8)> >::call<std::__1::shared_ptr<torch::jit::Graph>, pybind11::detail::void_type, torch::jit::script::initJitScriptBindings(_object*)::$_21&>(torch::jit::script::initJitScriptBindings(_object*)::$_21&&&) at cast.h:1843\r\n    frame #39: 0x0000000110a135da _C.cpython-37m-darwin.so`void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::name, pybind11::scope, pybind11::sibling>(this=0x0000000110a134a0, call=0x00007ffeefbfd978)::$_21&&, std::__1::shared_ptr<torch::jit::Graph> (*)(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::'lambda'(pybind11::detail::function_call&)::operator()(pybind11::detail::function_call&) const at pybind11.h:155\r\n    frame #40: 0x0000000110a134b8 _C.cpython-37m-darwin.so`void pybind11::cpp_function::initialize<torch::jit::script::initJitScriptBindings(_object*)::$_21, std::__1::shared_ptr<torch::jit::Graph>, torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>, pybind11::name, pybind11::scope, pybind11::sibling>(call=0x00007ffeefbfd978)::$_21&&, std::__1::shared_ptr<torch::jit::Graph> (*)(torch::jit::script::Def const&, std::__1::function<pybind11::function (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >)>), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::'lambda'(pybind11::detail::function_call&)::__invoke(pybind11::detail::function_call&) at pybind11.h:132\r\n    frame #41: 0x0000000110277ed7 _C.cpython-37m-darwin.so`pybind11::cpp_function::dispatcher(self=0x000000011a374e70, args_in=0x000000011b4b5288, kwargs_in=0x0000000000000000) at pybind11.h:619\r\n    frame #42: 0x000000010002ec48 python`_PyMethodDef_RawFastCallKeywords + 392\r\n    frame #43: 0x000000010016f2b1 python`call_function + 257\r\n    frame #44: 0x000000010016cf99 python`_PyEval_EvalFrameDefault + 45705\r\n    frame #45: 0x0000000100160a42 python`_PyEval_EvalCodeWithName + 418\r\n    frame #46: 0x000000010002ea73 python`_PyFunction_FastCallKeywords + 195\r\n    frame #47: 0x000000010016f265 python`call_function + 181\r\n    frame #48: 0x000000010016cf99 python`_PyEval_EvalFrameDefault + 45705\r\n    frame #49: 0x0000000100160a42 python`_PyEval_EvalCodeWithName + 418\r\n    frame #50: 0x00000001001c49a0 python`PyRun_FileExFlags + 256\r\n    frame #51: 0x00000001001c4104 python`PyRun_SimpleFileExFlags + 388\r\n    frame #52: 0x00000001001efedc python`pymain_main + 9148\r\n    frame #53: 0x0000000100000ece python`main + 142\r\n    frame #54: 0x00007fff77298015 libdyld.dylib`start + 1\r\n```\r\nThe symbol being resolved is `torch`:\r\n```\r\nframe #11: 0x0000000112e71ab9 _C.cpython-37m-darwin.so`torch::jit::script::pythonResolver(this=0x0000000101aecf40, name=\"torch\", m=0x000000011c8a52f0, loc=0x00007ffeefbf6360)>)::$_0::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, torch::jit::script::Method&, torch::jit::SourceRange const&) const at init.cpp:367\r\n   364 \t             Method& m,\r\n   365 \t             const SourceRange& loc) -> std::shared_ptr<SugaredValue> {\r\n   366 \t    AutoGIL ag;\r\n-> 367 \t    py::object obj = rcb(name);\r\n   368 \t    if (obj.is(py::none())) {\r\n   369 \t      return nullptr;\r\n   370 \t    }\r\n(lldb) p rcb\r\n(torch::jit::script::ResolutionCallback) $0 = 0x0000000101aca650\r\n(lldb) p name\r\n(std::__1::string) $1 = \"torch\"\r\n```\r\nand script works fine with e.g. `a + b`. I get the same issue when I build from a commit before #10847, but `mwe.py` works fine if I rebuild with Python 3.6.6."}