{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9384", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9384/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9384/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9384/events", "html_url": "https://github.com/pytorch/pytorch/issues/9384", "id": 340668298, "node_id": "MDU6SXNzdWUzNDA2NjgyOTg=", "number": 9384, "title": "[pytorch] Intel MKL ERROR when doing torch.eig on a CUDA tensor", "user": {"login": "vadimkantorov", "id": 1041752, "node_id": "MDQ6VXNlcjEwNDE3NTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1041752?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vadimkantorov", "html_url": "https://github.com/vadimkantorov", "followers_url": "https://api.github.com/users/vadimkantorov/followers", "following_url": "https://api.github.com/users/vadimkantorov/following{/other_user}", "gists_url": "https://api.github.com/users/vadimkantorov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vadimkantorov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vadimkantorov/subscriptions", "organizations_url": "https://api.github.com/users/vadimkantorov/orgs", "repos_url": "https://api.github.com/users/vadimkantorov/repos", "events_url": "https://api.github.com/users/vadimkantorov/events{/privacy}", "received_events_url": "https://api.github.com/users/vadimkantorov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-07-12T14:41:21Z", "updated_at": "2018-07-25T23:46:29Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><a href=\"https://github.com/pytorch/pytorch/files/2189021/S.pt7.gz\">S.pt7.gz</a></p>\n<p>What does this error mean and why is MKL involved in computing eigendecomposition of a CUDA tensor (the result tensor is also on CUDA)?</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch, gzip\na <span class=\"pl-k\">=</span> torch.load(gzip.open(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>S.pt7.gz<span class=\"pl-pds\">'</span></span>))\n\n<span class=\"pl-c1\">print</span>(a.device)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> cuda:0</span>\n\na.eig()\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>Intel MKL ERROR: Parameter 2 was incorrect on entry to SGEHD2.</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>(tensor([[ 1.0000,  0.0000],</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>        [ 0.5825,  0.0000],</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>        [ 0.1131,  0.0000],</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>        ...,</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>        [ 0.0000,  0.0000],</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>        [ 0.0000, -0.0000],</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>        [ 0.0000,  0.0000]], device='cuda:0'), tensor([], device='cuda:0'))</span></pre></div>", "body_text": "S.pt7.gz\nWhat does this error mean and why is MKL involved in computing eigendecomposition of a CUDA tensor (the result tensor is also on CUDA)?\nimport torch, gzip\na = torch.load(gzip.open('S.pt7.gz'))\n\nprint(a.device)\n# cuda:0\n\na.eig()\n#Intel MKL ERROR: Parameter 2 was incorrect on entry to SGEHD2.\n\n#(tensor([[ 1.0000,  0.0000],\n#        [ 0.5825,  0.0000],\n#        [ 0.1131,  0.0000],\n#        ...,\n#        [ 0.0000,  0.0000],\n#        [ 0.0000, -0.0000],\n#        [ 0.0000,  0.0000]], device='cuda:0'), tensor([], device='cuda:0'))", "body": "[S.pt7.gz](https://github.com/pytorch/pytorch/files/2189021/S.pt7.gz)\r\n\r\nWhat does this error mean and why is MKL involved in computing eigendecomposition of a CUDA tensor (the result tensor is also on CUDA)?\r\n\r\n```python\r\nimport torch, gzip\r\na = torch.load(gzip.open('S.pt7.gz'))\r\n\r\nprint(a.device)\r\n# cuda:0\r\n\r\na.eig()\r\n#Intel MKL ERROR: Parameter 2 was incorrect on entry to SGEHD2.\r\n\r\n#(tensor([[ 1.0000,  0.0000],\r\n#        [ 0.5825,  0.0000],\r\n#        [ 0.1131,  0.0000],\r\n#        ...,\r\n#        [ 0.0000,  0.0000],\r\n#        [ 0.0000, -0.0000],\r\n#        [ 0.0000,  0.0000]], device='cuda:0'), tensor([], device='cuda:0'))\r\n```\r\n\r\n\r\n"}