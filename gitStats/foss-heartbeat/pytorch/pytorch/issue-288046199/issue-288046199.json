{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4632", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4632/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4632/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4632/events", "html_url": "https://github.com/pytorch/pytorch/issues/4632", "id": 288046199, "node_id": "MDU6SXNzdWUyODgwNDYxOTk=", "number": 4632, "title": "CUDNN_STATUS_INTERNAL_ERROR when training with conv3d", "user": {"login": "yunkaili", "id": 11498218, "node_id": "MDQ6VXNlcjExNDk4MjE4", "avatar_url": "https://avatars2.githubusercontent.com/u/11498218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yunkaili", "html_url": "https://github.com/yunkaili", "followers_url": "https://api.github.com/users/yunkaili/followers", "following_url": "https://api.github.com/users/yunkaili/following{/other_user}", "gists_url": "https://api.github.com/users/yunkaili/gists{/gist_id}", "starred_url": "https://api.github.com/users/yunkaili/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yunkaili/subscriptions", "organizations_url": "https://api.github.com/users/yunkaili/orgs", "repos_url": "https://api.github.com/users/yunkaili/repos", "events_url": "https://api.github.com/users/yunkaili/events{/privacy}", "received_events_url": "https://api.github.com/users/yunkaili/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 806617721, "node_id": "MDU6TGFiZWw4MDY2MTc3MjE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/cudnn", "name": "cudnn", "color": "fbca04", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-01-12T08:47:38Z", "updated_at": "2018-08-10T16:24:33Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>i am trying to do a training with inflated 3d network</p>\n<p>replacing the model with different one will not casue error.<br>\nsetting up torch.backends.cudnn.enabled to False also fixes the problem, which is quite inefficiency.</p>\n<p>here are some info about the enviroment cudnn version 7003, pytorch 0.3</p>\n<p>i tried with different version of pytorch and cudnn, nothing helps<br>\nremoving .nv does not help neither.<br>\ngpu and drivers are checked, and nothing seems wrong</p>\n<p>model codes:<br>\n<a href=\"https://gist.github.com/yunkaili/297cfc8765269e4d677f7e4bfc7cc064\">https://gist.github.com/yunkaili/297cfc8765269e4d677f7e4bfc7cc064</a></p>\n<p>belows are some error info</p>\n<pre><code>Traceback (most recent call last):\n  File \"main.py\", line 316, in &lt;module&gt;\n    main()\n  File \"main.py\", line 123, in main\n    train(train_loader, model, criterion, optimizer, epoch)\n  File \"main.py\", line 171, in train\n    output = model(input_var)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/data_parallel.py\", line 68, in forward\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/data_parallel.py\", line 78, in parallel_apply\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/parallel_apply.py\", line 67, in parallel_apply\n    raise output\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/parallel_apply.py\", line 42, in _worker\n    output = module(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/liyunkai/i3d_base_model2/models.py\", line 134, in forward\n    base_out = self.base_model(input.view((-1, sample_len, cfg.TRAIN.FRAMES_IN_SNIPPET) + input.size()[-2:]))\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/liyunkai/i3d_base_model2/i3d_model.py\", line 163, in forward\n    x = self.layer4(x)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py\", line 67, in forward\n    input = module(input)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/liyunkai/i3d_base_model2/i3d_model.py\", line 86, in forward\n    out = self.conv3(out)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/conv.py\", line 383, in forward\n    self.padding, self.dilation, self.groups)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 126, in conv3d\n    return f(input, weight, bias)\nRuntimeError: CUDNN_STATUS_INTERNAL_ERROR\n\n^CException ignored in: &lt;module 'threading' from '/usr/lib/python3.5/threading.py'&gt;\nTraceback (most recent call last):\n  File \"/usr/lib/python3.5/threading.py\", line 1288, in _shutdown\n    t.join()\n  File \"/usr/lib/python3.5/threading.py\", line 1054, in join\n    self._wait_for_tstate_lock()\n  File \"/usr/lib/python3.5/threading.py\", line 1070, in _wait_for_tstate_lock\n    elif lock.acquire(block, timeout):\nKeyboardInterrupt\n^CError in atexit._run_exitfuncs:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 3208, in atexit_operations\n    self.reset(new_session=False)\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 1205, in reset\n    self.displayhook.flush()\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/displayhook.py\", line 306, in flush\n    gc.collect()\nKeyboardInterrupt\n^CError in atexit._run_exitfuncs:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 3208, in atexit_operations\n    self.reset(new_session=False)\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 1205, in reset\n    self.displayhook.flush()\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/displayhook.py\", line 306, in flush\n    gc.collect()\nKeyboardInterrupt\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/generic/THCStorage.c line=184 error=77 : an illegal memory access was encountered\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  cuda runtime error (77) : an illegal memory access was encountered at /pytorch/torch/lib/THC/generic/THCStorage.c:184\n</code></pre>", "body_text": "i am trying to do a training with inflated 3d network\nreplacing the model with different one will not casue error.\nsetting up torch.backends.cudnn.enabled to False also fixes the problem, which is quite inefficiency.\nhere are some info about the enviroment cudnn version 7003, pytorch 0.3\ni tried with different version of pytorch and cudnn, nothing helps\nremoving .nv does not help neither.\ngpu and drivers are checked, and nothing seems wrong\nmodel codes:\nhttps://gist.github.com/yunkaili/297cfc8765269e4d677f7e4bfc7cc064\nbelows are some error info\nTraceback (most recent call last):\n  File \"main.py\", line 316, in <module>\n    main()\n  File \"main.py\", line 123, in main\n    train(train_loader, model, criterion, optimizer, epoch)\n  File \"main.py\", line 171, in train\n    output = model(input_var)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/data_parallel.py\", line 68, in forward\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/data_parallel.py\", line 78, in parallel_apply\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/parallel_apply.py\", line 67, in parallel_apply\n    raise output\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/parallel_apply.py\", line 42, in _worker\n    output = module(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/liyunkai/i3d_base_model2/models.py\", line 134, in forward\n    base_out = self.base_model(input.view((-1, sample_len, cfg.TRAIN.FRAMES_IN_SNIPPET) + input.size()[-2:]))\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/liyunkai/i3d_base_model2/i3d_model.py\", line 163, in forward\n    x = self.layer4(x)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py\", line 67, in forward\n    input = module(input)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/liyunkai/i3d_base_model2/i3d_model.py\", line 86, in forward\n    out = self.conv3(out)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/conv.py\", line 383, in forward\n    self.padding, self.dilation, self.groups)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 126, in conv3d\n    return f(input, weight, bias)\nRuntimeError: CUDNN_STATUS_INTERNAL_ERROR\n\n^CException ignored in: <module 'threading' from '/usr/lib/python3.5/threading.py'>\nTraceback (most recent call last):\n  File \"/usr/lib/python3.5/threading.py\", line 1288, in _shutdown\n    t.join()\n  File \"/usr/lib/python3.5/threading.py\", line 1054, in join\n    self._wait_for_tstate_lock()\n  File \"/usr/lib/python3.5/threading.py\", line 1070, in _wait_for_tstate_lock\n    elif lock.acquire(block, timeout):\nKeyboardInterrupt\n^CError in atexit._run_exitfuncs:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 3208, in atexit_operations\n    self.reset(new_session=False)\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 1205, in reset\n    self.displayhook.flush()\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/displayhook.py\", line 306, in flush\n    gc.collect()\nKeyboardInterrupt\n^CError in atexit._run_exitfuncs:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 3208, in atexit_operations\n    self.reset(new_session=False)\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 1205, in reset\n    self.displayhook.flush()\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/displayhook.py\", line 306, in flush\n    gc.collect()\nKeyboardInterrupt\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/generic/THCStorage.c line=184 error=77 : an illegal memory access was encountered\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  cuda runtime error (77) : an illegal memory access was encountered at /pytorch/torch/lib/THC/generic/THCStorage.c:184", "body": "i am trying to do a training with inflated 3d network\r\n\r\nreplacing the model with different one will not casue error. \r\nsetting up torch.backends.cudnn.enabled to False also fixes the problem, which is quite inefficiency.\r\n\r\nhere are some info about the enviroment cudnn version 7003, pytorch 0.3\r\n\r\ni tried with different version of pytorch and cudnn, nothing helps\r\nremoving .nv does not help neither.\r\ngpu and drivers are checked, and nothing seems wrong\r\n\r\nmodel codes:\r\nhttps://gist.github.com/yunkaili/297cfc8765269e4d677f7e4bfc7cc064\r\n\r\nbelows are some error info\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 316, in <module>\r\n    main()\r\n  File \"main.py\", line 123, in main\r\n    train(train_loader, model, criterion, optimizer, epoch)\r\n  File \"main.py\", line 171, in train\r\n    output = model(input_var)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/data_parallel.py\", line 68, in forward\r\n    outputs = self.parallel_apply(replicas, inputs, kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/data_parallel.py\", line 78, in parallel_apply\r\n    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/parallel_apply.py\", line 67, in parallel_apply\r\n    raise output\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/parallel/parallel_apply.py\", line 42, in _worker\r\n    output = module(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/liyunkai/i3d_base_model2/models.py\", line 134, in forward\r\n    base_out = self.base_model(input.view((-1, sample_len, cfg.TRAIN.FRAMES_IN_SNIPPET) + input.size()[-2:]))\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/liyunkai/i3d_base_model2/i3d_model.py\", line 163, in forward\r\n    x = self.layer4(x)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/container.py\", line 67, in forward\r\n    input = module(input)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/liyunkai/i3d_base_model2/i3d_model.py\", line 86, in forward\r\n    out = self.conv3(out)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 325, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/conv.py\", line 383, in forward\r\n    self.padding, self.dilation, self.groups)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 126, in conv3d\r\n    return f(input, weight, bias)\r\nRuntimeError: CUDNN_STATUS_INTERNAL_ERROR\r\n\r\n^CException ignored in: <module 'threading' from '/usr/lib/python3.5/threading.py'>\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.5/threading.py\", line 1288, in _shutdown\r\n    t.join()\r\n  File \"/usr/lib/python3.5/threading.py\", line 1054, in join\r\n    self._wait_for_tstate_lock()\r\n  File \"/usr/lib/python3.5/threading.py\", line 1070, in _wait_for_tstate_lock\r\n    elif lock.acquire(block, timeout):\r\nKeyboardInterrupt\r\n^CError in atexit._run_exitfuncs:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 3208, in atexit_operations\r\n    self.reset(new_session=False)\r\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 1205, in reset\r\n    self.displayhook.flush()\r\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/displayhook.py\", line 306, in flush\r\n    gc.collect()\r\nKeyboardInterrupt\r\n^CError in atexit._run_exitfuncs:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 3208, in atexit_operations\r\n    self.reset(new_session=False)\r\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/interactiveshell.py\", line 1205, in reset\r\n    self.displayhook.flush()\r\n  File \"/usr/local/lib/python3.5/dist-packages/IPython/core/displayhook.py\", line 306, in flush\r\n    gc.collect()\r\nKeyboardInterrupt\r\nTHCudaCheck FAIL file=/pytorch/torch/lib/THC/generic/THCStorage.c line=184 error=77 : an illegal memory access was encountered\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  cuda runtime error (77) : an illegal memory access was encountered at /pytorch/torch/lib/THC/generic/THCStorage.c:184\r\n```"}