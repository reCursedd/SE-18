{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/431344442", "html_url": "https://github.com/pytorch/pytorch/issues/872#issuecomment-431344442", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/872", "id": 431344442, "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTM0NDQ0Mg==", "user": {"login": "SelvamArul", "id": 7311434, "node_id": "MDQ6VXNlcjczMTE0MzQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/7311434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SelvamArul", "html_url": "https://github.com/SelvamArul", "followers_url": "https://api.github.com/users/SelvamArul/followers", "following_url": "https://api.github.com/users/SelvamArul/following{/other_user}", "gists_url": "https://api.github.com/users/SelvamArul/gists{/gist_id}", "starred_url": "https://api.github.com/users/SelvamArul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SelvamArul/subscriptions", "organizations_url": "https://api.github.com/users/SelvamArul/orgs", "repos_url": "https://api.github.com/users/SelvamArul/repos", "events_url": "https://api.github.com/users/SelvamArul/events{/privacy}", "received_events_url": "https://api.github.com/users/SelvamArul/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-19T12:20:36Z", "updated_at": "2018-10-19T12:20:36Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=2241436\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/shivangbaveja\">@shivangbaveja</a> You can remove (<a href=\"https://www.w3schools.com/python/ref_dictionary_pop.asp\" rel=\"nofollow\">pop</a>) the key-value pairs corresponding to the last linear layer in the pretrained model state dict after loading. e.g:</p>\n<pre><code> pretrained_dict = th.load(...)\n model_dict = model.state_dict()\n # remove the keys corresponing to the linear layer in the pretrained_dict\n pretrained_dict.pop(fc.weight)\n pretrained_dict.pop(fc.bias)\n # now update the model dict with pretrained dict\n model_dict.update(pretrained_dict)\n</code></pre>", "body_text": "@shivangbaveja You can remove (pop) the key-value pairs corresponding to the last linear layer in the pretrained model state dict after loading. e.g:\n pretrained_dict = th.load(...)\n model_dict = model.state_dict()\n # remove the keys corresponing to the linear layer in the pretrained_dict\n pretrained_dict.pop(fc.weight)\n pretrained_dict.pop(fc.bias)\n # now update the model dict with pretrained dict\n model_dict.update(pretrained_dict)", "body": "@shivangbaveja You can remove ([pop](https://www.w3schools.com/python/ref_dictionary_pop.asp)) the key-value pairs corresponding to the last linear layer in the pretrained model state dict after loading. e.g:\r\n\r\n     pretrained_dict = th.load(...)\r\n     model_dict = model.state_dict()\r\n     # remove the keys corresponing to the linear layer in the pretrained_dict\r\n     pretrained_dict.pop(fc.weight)\r\n     pretrained_dict.pop(fc.bias)\r\n     # now update the model dict with pretrained dict\r\n     model_dict.update(pretrained_dict)"}