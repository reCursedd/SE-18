{"url": "https://api.github.com/repos/pytorch/pytorch/issues/14200", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/14200/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/14200/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/14200/events", "html_url": "https://github.com/pytorch/pytorch/issues/14200", "id": 382394339, "node_id": "MDU6SXNzdWUzODIzOTQzMzk=", "number": 14200, "title": "Failed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'", "user": {"login": "eddie1030", "id": 40951658, "node_id": "MDQ6VXNlcjQwOTUxNjU4", "avatar_url": "https://avatars0.githubusercontent.com/u/40951658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddie1030", "html_url": "https://github.com/eddie1030", "followers_url": "https://api.github.com/users/eddie1030/followers", "following_url": "https://api.github.com/users/eddie1030/following{/other_user}", "gists_url": "https://api.github.com/users/eddie1030/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddie1030/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddie1030/subscriptions", "organizations_url": "https://api.github.com/users/eddie1030/orgs", "repos_url": "https://api.github.com/users/eddie1030/repos", "events_url": "https://api.github.com/users/eddie1030/events{/privacy}", "received_events_url": "https://api.github.com/users/eddie1030/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-19T21:11:15Z", "updated_at": "2018-11-21T10:19:07Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>I've scanned through the other issues and saw similar ones, yet I saw my environment slightly differs so i decided to open a separate report. Feel free to disagree.</p>\n<p>After trying to build pytorch inside a virtualenv, I ran into this error:</p>\n<p><code>Makefile:138: recipe for target 'all' failed</code><br>\n<code>make: *** [all] Error 2</code><br>\n<code>Failed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'</code></p>\n<h2>To Reproduce</h2>\n<p>Steps to reproduce the behavior:</p>\n<p><code>git clone --recursive https://github.com/pytorch/pytorch</code><br>\n<code>cd pytorch</code><br>\n<code>python setup.py install</code></p>\n\n<h2>Expected behavior</h2>\n<p>A compilation success</p>\n<h2>Environment</h2>\n<p>Please copy and paste the output from our<br>\n<a href=\"https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\" rel=\"nofollow\">environment collection script</a><br>\n(or fill out the checklist below manually).</p>\n<p>You can get the script and run it with:</p>\n<pre><code>wget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n</code></pre>\n<ul>\n<li>PyTorch Version (e.g., 1.0): <a href=\"https://github.com/pytorch/pytorch\">https://github.com/pytorch/pytorch</a> , master</li>\n<li>OS (e.g., Linux): Raspbian stretch 4.14.34-v7+ armv7l GNU/Linux</li>\n<li>How you installed PyTorch (<code>conda</code>, <code>pip</code>, source): source</li>\n<li>Build command you used (if compiling from source): see above</li>\n<li>Python version: Python 2.7.13</li>\n<li>CUDA/cuDNN version: NA</li>\n<li>GPU models and configuration: NA</li>\n<li>Any other relevant information: NA</li>\n</ul>\n<h2>Additional context</h2>\n<p>The ouput from where it started going south;</p>\n<pre><code>(...) Scanning dependencies of target ATEN_CPU_FILES_GEN_TARGET                                                                                                                                                                                                                                                                                                                                    \n[ 12%] Generating ../aten/src/ATen/CPUByteType.cpp, ../aten/src/ATen/CPUByteType.h, ../aten/src/ATen/CPUCharType.cpp, ../aten/src/ATen/CPUCharType.h, ../aten/src/ATen/CPUCopy.cpp, ../aten/src/ATen/CPUDoubleType.cpp, ../aten/src/ATen/CPUDoubleType.h, ../aten/src/ATen/CPUFloatType.cpp, ../aten/src/ATen/CPUFloatType.h, ../aten/src/ATen/CPUGenerator.h, ../aten/src/ATen/CPUHalfType.cpp, ../aten/src/ATen/CPUHalfType.h, ../aten/src/ATen/CPUIntType.cpp, ../aten/src/ATen/CPUIntType.h, ../aten/src/ATen/CPULongType.cpp, ../aten/src/ATen/CPULongType.h, ../aten/src/ATen/CPUShortType.cpp, ../aten/src/ATen/CPUShortType.h, ../aten/src/ATen/Declarations.yaml, ../aten/src/ATen/Functions.h, ../aten/src/ATen/NativeFunctions.h, ../aten/src/ATen/RegisterCPU.cpp, ../aten/src/ATen/RegisterCPU.h, ../aten/src/ATen/SparseCPUByteType.cpp, ../aten/src/ATen/SparseCPUByteType.h, ../aten/src/ATen/SparseCPUCharType.cpp, ../aten/src/ATen/SparseCPUCharType.h, ../aten/src/ATen/SparseCPUDoubleType.cpp, ../aten/src/ATen/SparseCPUDoubleType.h, ../aten/src/ATen/SparseCPUFloatType.cpp, ../aten/src/ATen/SparseCPUFloatType.h, ../aten/src/ATen/SparseCPUIntType.cpp, ../aten/src/ATen/SparseCPUIntType.h, ../aten/src/ATen/SparseCPULongType.cpp, ../aten/src/ATen/SparseCPULongType.h, ../aten/src/ATen/SparseCPUShortType.cpp, ../aten/src/ATen/SparseCPUShortType.h, ../aten/src/ATen/TypeDefault.cpp, ../aten/src/ATen/TypeDefault.h, ../aten/src/ATen/TypeExtendedInterface.h, ../aten/src/ATen/CUDAByteType.cpp, ../aten/src/ATen/CUDAByteType.h, ../aten/src/ATen/CUDACharType.cpp, ../aten/src/ATen/CUDACharType.h, ../aten/src/ATen/CUDACopy.cpp, ../aten/src/ATen/CUDADoubleType.cpp, ../aten/src/ATen/CUDADoubleType.h, ../aten/src/ATen/CUDAFloatType.cpp, ../aten/src/ATen/CUDAFloatType.h, ../aten/src/ATen/CUDAGenerator.h, ../aten/src/ATen/CUDAHalfType.cpp, ../aten/src/ATen/CUDAHalfType.h, ../aten/src/ATen/CUDAIntType.cpp, ../aten/src/ATen/CUDAIntType.h, ../aten/src/ATen/CUDALongType.cpp, ../aten/src/ATen/CUDALongType.h, ../aten/src/ATen/CUDAShortType.cpp, ../aten/src/ATen/CUDAShortType.h, ../aten/src/ATen/RegisterCUDA.cpp, ../aten/src/ATen/RegisterCUDA.h, ../aten/src/ATen/SparseCUDAByteType.cpp, ../aten/src/ATen/SparseCUDAByteType.h, ../aten/src/ATen/SparseCUDACharType.cpp, ../aten/src/ATen/SparseCUDACharType.h, ../aten/src/ATen/SparseCUDADoubleType.cpp, ../aten/src/ATen/SparseCUDADoubleType.h, ../aten/src/ATen/SparseCUDAFloatType.cpp, ../aten/src/ATen/SparseCUDAFloatType.h, ../aten/src/ATen/SparseCUDAIntType.cpp, ../aten/src/ATen/SparseCUDAIntType.h, ../aten/src/ATen/SparseCUDALongType.cpp, ../aten/src/ATen/SparseCUDALongType.h, ../aten/src/ATen/SparseCUDAShortType.cpp, ../aten/src/ATen/SparseCUDAShortType.h                                                                                                                                                                                                                                                                                                                                                                      \n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o                                                                                                                                                                                                                                                                              \nScanning dependencies of target mkalias                                                                                                                                                                                                                                                                                                                                                      \nScanning dependencies of target mkrename                                                                                                                                                                                                                                                                                                                                                     \n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkalias.dir/mkalias.c.o                                                                                                                                                                                                                                                                                                                   \n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkrename.dir/mkrename.c.o                                                                                                                                                                                                                                                                                                                 \n[ 12%] Linking C executable ../../bin/mkalias                                                                                                                                                                                                                                                                                                                                                \n[ 12%] Linking C executable ../../bin/mkrename                                                                                                                                                                                                                                                                                                                                               \n[ 12%] Built target mkalias                                                                                                                                                                                                                                                                                                                                                                  \n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o                                                                                                                                                                                                                                                                                      \n[ 12%] Built target mkrename                                                                                                                                                                                                                                                                                                                                                                 \n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o                                                                                                                                                                                                                                                                                 \nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/batch_normalization.cpp:21:                                                                                                                                                                                                                                                                                  \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count &gt;= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \n        ^                                                                                                                                                                                                                                                                                                                                                                                    \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \n #   define CP(pw) do { if (v &gt;= (1ull &lt;&lt; pw)) { v &gt;&gt;= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:62: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o' failed                                                                                                                                                                                                           \nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o] Error 1                                                                                                                                                                                                                                                                                  \nmake[2]: *** Waiting for unfinished jobs....                                                                                                                                                                                                                                                                                                                                                 \nScanning dependencies of target python_copy_files                                                                                                                                                                                                                                                                                                                                            \nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/convolution.cpp:21:                                                                                                                                                                                                                                                                                          \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count &gt;= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \n        ^                                                                                                                                                                                                                                                                                                                                                                                    \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \n #   define CP(pw) do { if (v &gt;= (1ull &lt;&lt; pw)) { v &gt;&gt;= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/convolution_relu.cpp:21:                                                                                                                                                                                                                                                                                     \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count &gt;= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \n        ^                                                                                                                                                                                                                                                                                                                                                                                    \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \n #   define CP(pw) do { if (v &gt;= (1ull &lt;&lt; pw)) { v &gt;&gt;= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:110: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o' failed                                                                                                                                                                                                             \nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o] Error 1                                                                                                                                                                                                                                                                                     \nScanning dependencies of target mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                              \n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkmasked_gnuabi.dir/mkmasked_gnuabi.c.o                                                                                                                                                                                                                                                                                                   \n[ 12%] Linking C executable ../../bin/mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                        \ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:86: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o' failed                                                                                                                                                                                                                   \nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o] Error 1                                                                                                                                                                                                                                                                                          \nCMakeFiles/Makefile2:1263: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/all' failed                                                                                                                                                                                                                                                                                \nmake[1]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/all] Error 2                                                                                                                                                                                                                                                                                                               \nmake[1]: *** Waiting for unfinished jobs....                                                                                                                                                                                                                                                                                                                                                 \n[ 12%] Built target mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                                          \n[ 12%] Built target python_copy_files                                                                                                                                                                                                                                                                                                                                                        \n[ 12%] Built target ATEN_CPU_FILES_GEN_TARGET                                                                                                                                                                                                                                                                                                                                                \nMakefile:138: recipe for target 'all' failed                                                                                                                                                                                                                                                                                                                                                 \nmake: *** [all] Error 2                                                                                                                                                                                                                                                                                                                                                                      \nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'     \n</code></pre>\n<hr>\n<p>Hopefully this report can be helpful, and ideas on how to work around be would much appreaciated :).</p>", "body_text": "\ud83d\udc1b Bug\nI've scanned through the other issues and saw similar ones, yet I saw my environment slightly differs so i decided to open a separate report. Feel free to disagree.\nAfter trying to build pytorch inside a virtualenv, I ran into this error:\nMakefile:138: recipe for target 'all' failed\nmake: *** [all] Error 2\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'\nTo Reproduce\nSteps to reproduce the behavior:\ngit clone --recursive https://github.com/pytorch/pytorch\ncd pytorch\npython setup.py install\n\nExpected behavior\nA compilation success\nEnvironment\nPlease copy and paste the output from our\nenvironment collection script\n(or fill out the checklist below manually).\nYou can get the script and run it with:\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\n# For security purposes, please check the contents of collect_env.py before running it.\npython collect_env.py\n\n\nPyTorch Version (e.g., 1.0): https://github.com/pytorch/pytorch , master\nOS (e.g., Linux): Raspbian stretch 4.14.34-v7+ armv7l GNU/Linux\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): see above\nPython version: Python 2.7.13\nCUDA/cuDNN version: NA\nGPU models and configuration: NA\nAny other relevant information: NA\n\nAdditional context\nThe ouput from where it started going south;\n(...) Scanning dependencies of target ATEN_CPU_FILES_GEN_TARGET                                                                                                                                                                                                                                                                                                                                    \n[ 12%] Generating ../aten/src/ATen/CPUByteType.cpp, ../aten/src/ATen/CPUByteType.h, ../aten/src/ATen/CPUCharType.cpp, ../aten/src/ATen/CPUCharType.h, ../aten/src/ATen/CPUCopy.cpp, ../aten/src/ATen/CPUDoubleType.cpp, ../aten/src/ATen/CPUDoubleType.h, ../aten/src/ATen/CPUFloatType.cpp, ../aten/src/ATen/CPUFloatType.h, ../aten/src/ATen/CPUGenerator.h, ../aten/src/ATen/CPUHalfType.cpp, ../aten/src/ATen/CPUHalfType.h, ../aten/src/ATen/CPUIntType.cpp, ../aten/src/ATen/CPUIntType.h, ../aten/src/ATen/CPULongType.cpp, ../aten/src/ATen/CPULongType.h, ../aten/src/ATen/CPUShortType.cpp, ../aten/src/ATen/CPUShortType.h, ../aten/src/ATen/Declarations.yaml, ../aten/src/ATen/Functions.h, ../aten/src/ATen/NativeFunctions.h, ../aten/src/ATen/RegisterCPU.cpp, ../aten/src/ATen/RegisterCPU.h, ../aten/src/ATen/SparseCPUByteType.cpp, ../aten/src/ATen/SparseCPUByteType.h, ../aten/src/ATen/SparseCPUCharType.cpp, ../aten/src/ATen/SparseCPUCharType.h, ../aten/src/ATen/SparseCPUDoubleType.cpp, ../aten/src/ATen/SparseCPUDoubleType.h, ../aten/src/ATen/SparseCPUFloatType.cpp, ../aten/src/ATen/SparseCPUFloatType.h, ../aten/src/ATen/SparseCPUIntType.cpp, ../aten/src/ATen/SparseCPUIntType.h, ../aten/src/ATen/SparseCPULongType.cpp, ../aten/src/ATen/SparseCPULongType.h, ../aten/src/ATen/SparseCPUShortType.cpp, ../aten/src/ATen/SparseCPUShortType.h, ../aten/src/ATen/TypeDefault.cpp, ../aten/src/ATen/TypeDefault.h, ../aten/src/ATen/TypeExtendedInterface.h, ../aten/src/ATen/CUDAByteType.cpp, ../aten/src/ATen/CUDAByteType.h, ../aten/src/ATen/CUDACharType.cpp, ../aten/src/ATen/CUDACharType.h, ../aten/src/ATen/CUDACopy.cpp, ../aten/src/ATen/CUDADoubleType.cpp, ../aten/src/ATen/CUDADoubleType.h, ../aten/src/ATen/CUDAFloatType.cpp, ../aten/src/ATen/CUDAFloatType.h, ../aten/src/ATen/CUDAGenerator.h, ../aten/src/ATen/CUDAHalfType.cpp, ../aten/src/ATen/CUDAHalfType.h, ../aten/src/ATen/CUDAIntType.cpp, ../aten/src/ATen/CUDAIntType.h, ../aten/src/ATen/CUDALongType.cpp, ../aten/src/ATen/CUDALongType.h, ../aten/src/ATen/CUDAShortType.cpp, ../aten/src/ATen/CUDAShortType.h, ../aten/src/ATen/RegisterCUDA.cpp, ../aten/src/ATen/RegisterCUDA.h, ../aten/src/ATen/SparseCUDAByteType.cpp, ../aten/src/ATen/SparseCUDAByteType.h, ../aten/src/ATen/SparseCUDACharType.cpp, ../aten/src/ATen/SparseCUDACharType.h, ../aten/src/ATen/SparseCUDADoubleType.cpp, ../aten/src/ATen/SparseCUDADoubleType.h, ../aten/src/ATen/SparseCUDAFloatType.cpp, ../aten/src/ATen/SparseCUDAFloatType.h, ../aten/src/ATen/SparseCUDAIntType.cpp, ../aten/src/ATen/SparseCUDAIntType.h, ../aten/src/ATen/SparseCUDALongType.cpp, ../aten/src/ATen/SparseCUDALongType.h, ../aten/src/ATen/SparseCUDAShortType.cpp, ../aten/src/ATen/SparseCUDAShortType.h                                                                                                                                                                                                                                                                                                                                                                      \n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o                                                                                                                                                                                                                                                                              \nScanning dependencies of target mkalias                                                                                                                                                                                                                                                                                                                                                      \nScanning dependencies of target mkrename                                                                                                                                                                                                                                                                                                                                                     \n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkalias.dir/mkalias.c.o                                                                                                                                                                                                                                                                                                                   \n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkrename.dir/mkrename.c.o                                                                                                                                                                                                                                                                                                                 \n[ 12%] Linking C executable ../../bin/mkalias                                                                                                                                                                                                                                                                                                                                                \n[ 12%] Linking C executable ../../bin/mkrename                                                                                                                                                                                                                                                                                                                                               \n[ 12%] Built target mkalias                                                                                                                                                                                                                                                                                                                                                                  \n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o                                                                                                                                                                                                                                                                                      \n[ 12%] Built target mkrename                                                                                                                                                                                                                                                                                                                                                                 \n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o                                                                                                                                                                                                                                                                                 \nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/batch_normalization.cpp:21:                                                                                                                                                                                                                                                                                  \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count >= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \n        ^                                                                                                                                                                                                                                                                                                                                                                                    \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \n #   define CP(pw) do { if (v >= (1ull << pw)) { v >>= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:62: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o' failed                                                                                                                                                                                                           \nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o] Error 1                                                                                                                                                                                                                                                                                  \nmake[2]: *** Waiting for unfinished jobs....                                                                                                                                                                                                                                                                                                                                                 \nScanning dependencies of target python_copy_files                                                                                                                                                                                                                                                                                                                                            \nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/convolution.cpp:21:                                                                                                                                                                                                                                                                                          \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count >= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \n        ^                                                                                                                                                                                                                                                                                                                                                                                    \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \n #   define CP(pw) do { if (v >= (1ull << pw)) { v >>= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/convolution_relu.cpp:21:                                                                                                                                                                                                                                                                                     \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count >= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \n        ^                                                                                                                                                                                                                                                                                                                                                                                    \n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \n #   define CP(pw) do { if (v >= (1ull << pw)) { v >>= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:110: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o' failed                                                                                                                                                                                                             \nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o] Error 1                                                                                                                                                                                                                                                                                     \nScanning dependencies of target mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                              \n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkmasked_gnuabi.dir/mkmasked_gnuabi.c.o                                                                                                                                                                                                                                                                                                   \n[ 12%] Linking C executable ../../bin/mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                        \ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:86: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o' failed                                                                                                                                                                                                                   \nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o] Error 1                                                                                                                                                                                                                                                                                          \nCMakeFiles/Makefile2:1263: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/all' failed                                                                                                                                                                                                                                                                                \nmake[1]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/all] Error 2                                                                                                                                                                                                                                                                                                               \nmake[1]: *** Waiting for unfinished jobs....                                                                                                                                                                                                                                                                                                                                                 \n[ 12%] Built target mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                                          \n[ 12%] Built target python_copy_files                                                                                                                                                                                                                                                                                                                                                        \n[ 12%] Built target ATEN_CPU_FILES_GEN_TARGET                                                                                                                                                                                                                                                                                                                                                \nMakefile:138: recipe for target 'all' failed                                                                                                                                                                                                                                                                                                                                                 \nmake: *** [all] Error 2                                                                                                                                                                                                                                                                                                                                                                      \nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'     \n\n\nHopefully this report can be helpful, and ideas on how to work around be would much appreaciated :).", "body": "## \ud83d\udc1b Bug\r\n\r\nI've scanned through the other issues and saw similar ones, yet I saw my environment slightly differs so i decided to open a separate report. Feel free to disagree.\r\n\r\nAfter trying to build pytorch inside a virtualenv, I ran into this error:\r\n\r\n`Makefile:138: recipe for target 'all' failed`\r\n`make: *** [all] Error 2`\r\n`Failed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'`\r\n\r\n## To Reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\n`git clone --recursive https://github.com/pytorch/pytorch`\r\n`cd pytorch`\r\n`python setup.py install`\r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well -->\r\n\r\n## Expected behavior\r\n\r\nA compilation success\r\n\r\n## Environment\r\n\r\nPlease copy and paste the output from our\r\n[environment collection script](https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py)\r\n(or fill out the checklist below manually).\r\n\r\nYou can get the script and run it with:\r\n```\r\nwget https://raw.githubusercontent.com/pytorch/pytorch/master/torch/utils/collect_env.py\r\n# For security purposes, please check the contents of collect_env.py before running it.\r\npython collect_env.py\r\n```\r\n\r\n - PyTorch Version (e.g., 1.0): https://github.com/pytorch/pytorch , master\r\n - OS (e.g., Linux): Raspbian stretch 4.14.34-v7+ armv7l GNU/Linux\r\n - How you installed PyTorch (`conda`, `pip`, source): source\r\n - Build command you used (if compiling from source): see above\r\n - Python version: Python 2.7.13\r\n - CUDA/cuDNN version: NA\r\n - GPU models and configuration: NA\r\n - Any other relevant information: NA\r\n\r\n## Additional context\r\n\r\nThe ouput from where it started going south;\r\n```\r\n(...) Scanning dependencies of target ATEN_CPU_FILES_GEN_TARGET                                                                                                                                                                                                                                                                                                                                    \r\n[ 12%] Generating ../aten/src/ATen/CPUByteType.cpp, ../aten/src/ATen/CPUByteType.h, ../aten/src/ATen/CPUCharType.cpp, ../aten/src/ATen/CPUCharType.h, ../aten/src/ATen/CPUCopy.cpp, ../aten/src/ATen/CPUDoubleType.cpp, ../aten/src/ATen/CPUDoubleType.h, ../aten/src/ATen/CPUFloatType.cpp, ../aten/src/ATen/CPUFloatType.h, ../aten/src/ATen/CPUGenerator.h, ../aten/src/ATen/CPUHalfType.cpp, ../aten/src/ATen/CPUHalfType.h, ../aten/src/ATen/CPUIntType.cpp, ../aten/src/ATen/CPUIntType.h, ../aten/src/ATen/CPULongType.cpp, ../aten/src/ATen/CPULongType.h, ../aten/src/ATen/CPUShortType.cpp, ../aten/src/ATen/CPUShortType.h, ../aten/src/ATen/Declarations.yaml, ../aten/src/ATen/Functions.h, ../aten/src/ATen/NativeFunctions.h, ../aten/src/ATen/RegisterCPU.cpp, ../aten/src/ATen/RegisterCPU.h, ../aten/src/ATen/SparseCPUByteType.cpp, ../aten/src/ATen/SparseCPUByteType.h, ../aten/src/ATen/SparseCPUCharType.cpp, ../aten/src/ATen/SparseCPUCharType.h, ../aten/src/ATen/SparseCPUDoubleType.cpp, ../aten/src/ATen/SparseCPUDoubleType.h, ../aten/src/ATen/SparseCPUFloatType.cpp, ../aten/src/ATen/SparseCPUFloatType.h, ../aten/src/ATen/SparseCPUIntType.cpp, ../aten/src/ATen/SparseCPUIntType.h, ../aten/src/ATen/SparseCPULongType.cpp, ../aten/src/ATen/SparseCPULongType.h, ../aten/src/ATen/SparseCPUShortType.cpp, ../aten/src/ATen/SparseCPUShortType.h, ../aten/src/ATen/TypeDefault.cpp, ../aten/src/ATen/TypeDefault.h, ../aten/src/ATen/TypeExtendedInterface.h, ../aten/src/ATen/CUDAByteType.cpp, ../aten/src/ATen/CUDAByteType.h, ../aten/src/ATen/CUDACharType.cpp, ../aten/src/ATen/CUDACharType.h, ../aten/src/ATen/CUDACopy.cpp, ../aten/src/ATen/CUDADoubleType.cpp, ../aten/src/ATen/CUDADoubleType.h, ../aten/src/ATen/CUDAFloatType.cpp, ../aten/src/ATen/CUDAFloatType.h, ../aten/src/ATen/CUDAGenerator.h, ../aten/src/ATen/CUDAHalfType.cpp, ../aten/src/ATen/CUDAHalfType.h, ../aten/src/ATen/CUDAIntType.cpp, ../aten/src/ATen/CUDAIntType.h, ../aten/src/ATen/CUDALongType.cpp, ../aten/src/ATen/CUDALongType.h, ../aten/src/ATen/CUDAShortType.cpp, ../aten/src/ATen/CUDAShortType.h, ../aten/src/ATen/RegisterCUDA.cpp, ../aten/src/ATen/RegisterCUDA.h, ../aten/src/ATen/SparseCUDAByteType.cpp, ../aten/src/ATen/SparseCUDAByteType.h, ../aten/src/ATen/SparseCUDACharType.cpp, ../aten/src/ATen/SparseCUDACharType.h, ../aten/src/ATen/SparseCUDADoubleType.cpp, ../aten/src/ATen/SparseCUDADoubleType.h, ../aten/src/ATen/SparseCUDAFloatType.cpp, ../aten/src/ATen/SparseCUDAFloatType.h, ../aten/src/ATen/SparseCUDAIntType.cpp, ../aten/src/ATen/SparseCUDAIntType.h, ../aten/src/ATen/SparseCUDALongType.cpp, ../aten/src/ATen/SparseCUDALongType.h, ../aten/src/ATen/SparseCUDAShortType.cpp, ../aten/src/ATen/SparseCUDAShortType.h                                                                                                                                                                                                                                                                                                                                                                      \r\n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o                                                                                                                                                                                                                                                                              \r\nScanning dependencies of target mkalias                                                                                                                                                                                                                                                                                                                                                      \r\nScanning dependencies of target mkrename                                                                                                                                                                                                                                                                                                                                                     \r\n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkalias.dir/mkalias.c.o                                                                                                                                                                                                                                                                                                                   \r\n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkrename.dir/mkrename.c.o                                                                                                                                                                                                                                                                                                                 \r\n[ 12%] Linking C executable ../../bin/mkalias                                                                                                                                                                                                                                                                                                                                                \r\n[ 12%] Linking C executable ../../bin/mkrename                                                                                                                                                                                                                                                                                                                                               \r\n[ 12%] Built target mkalias                                                                                                                                                                                                                                                                                                                                                                  \r\n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o                                                                                                                                                                                                                                                                                      \r\n[ 12%] Built target mkrename                                                                                                                                                                                                                                                                                                                                                                 \r\n[ 12%] Building CXX object third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o                                                                                                                                                                                                                                                                                 \r\nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \r\n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/batch_normalization.cpp:21:                                                                                                                                                                                                                                                                                  \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count >= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \r\n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \r\n        ^                                                                                                                                                                                                                                                                                                                                                                                    \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \r\n #   define CP(pw) do { if (v >= (1ull << pw)) { v >>= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \r\n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \r\ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \r\nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:62: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o' failed                                                                                                                                                                                                           \r\nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/batch_normalization.cpp.o] Error 1                                                                                                                                                                                                                                                                                  \r\nmake[2]: *** Waiting for unfinished jobs....                                                                                                                                                                                                                                                                                                                                                 \r\nScanning dependencies of target python_copy_files                                                                                                                                                                                                                                                                                                                                            \r\nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \r\n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/convolution.cpp:21:                                                                                                                                                                                                                                                                                          \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count >= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \r\n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \r\n        ^                                                                                                                                                                                                                                                                                                                                                                                    \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \r\n #   define CP(pw) do { if (v >= (1ull << pw)) { v >>= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \r\n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \r\nIn file included from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/type_helpers.hpp:29:0,                                                                                                                                                                                                                                                                                       \r\n                 from /home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/convolution_relu.cpp:21:                                                                                                                                                                                                                                                                                     \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp: In function ?int mkldnn::impl::math::ilog2q(size_t)?:                                                                                                                                                                                                                                                              \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:84:8: error: right shift count >= width of type [-Werror=shift-count-overflow]                                                                                                                                                                                                                                      \r\n     CP(32); CP(16); CP(8); CP(4); CP(2); CP(1);                                                                                                                                                                                                                                                                                                                                             \r\n        ^                                                                                                                                                                                                                                                                                                                                                                                    \r\n/home/w/mpdj/pytorch/third_party/ideep/mkl-dnn/src/common/math_utils.hpp:83:55: note: in definition of macro ?CP?                                                                                                                                                                                                                                                                            \r\n #   define CP(pw) do { if (v >= (1ull << pw)) { v >>= pw; p += pw; } } while(0)                                                                                                                                                                                                                                                                                                             \r\n                                                       ^~                                                                                                                                                                                                                                                                                                                                    \r\ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \r\nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:110: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o' failed                                                                                                                                                                                                             \r\nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution_relu.cpp.o] Error 1                                                                                                                                                                                                                                                                                     \r\nScanning dependencies of target mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                              \r\n[ 12%] Building C object sleef/src/libm/CMakeFiles/mkmasked_gnuabi.dir/mkmasked_gnuabi.c.o                                                                                                                                                                                                                                                                                                   \r\n[ 12%] Linking C executable ../../bin/mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                        \r\ncc1plus: all warnings being treated as errors                                                                                                                                                                                                                                                                                                                                                \r\nthird_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/build.make:86: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o' failed                                                                                                                                                                                                                   \r\nmake[2]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/common/convolution.cpp.o] Error 1                                                                                                                                                                                                                                                                                          \r\nCMakeFiles/Makefile2:1263: recipe for target 'third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/all' failed                                                                                                                                                                                                                                                                                \r\nmake[1]: *** [third_party/ideep/mkl-dnn/src/CMakeFiles/mkldnn.dir/all] Error 2                                                                                                                                                                                                                                                                                                               \r\nmake[1]: *** Waiting for unfinished jobs....                                                                                                                                                                                                                                                                                                                                                 \r\n[ 12%] Built target mkmasked_gnuabi                                                                                                                                                                                                                                                                                                                                                          \r\n[ 12%] Built target python_copy_files                                                                                                                                                                                                                                                                                                                                                        \r\n[ 12%] Built target ATEN_CPU_FILES_GEN_TARGET                                                                                                                                                                                                                                                                                                                                                \r\nMakefile:138: recipe for target 'all' failed                                                                                                                                                                                                                                                                                                                                                 \r\nmake: *** [all] Error 2                                                                                                                                                                                                                                                                                                                                                                      \r\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-nnpack --use-mkldnn --use-qnnpack caffe2'     \r\n```\r\n---\r\n\r\nHopefully this report can be helpful, and ideas on how to work around be would much appreaciated :).\r\n"}