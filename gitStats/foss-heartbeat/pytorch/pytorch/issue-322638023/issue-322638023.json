{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7541", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7541/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7541/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7541/events", "html_url": "https://github.com/pytorch/pytorch/issues/7541", "id": 322638023, "node_id": "MDU6SXNzdWUzMjI2MzgwMjM=", "number": 7541, "title": "[Bug] Dilated max-pooling fails due to padding check", "user": {"login": "ShayanPersonal", "id": 10247130, "node_id": "MDQ6VXNlcjEwMjQ3MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/10247130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ShayanPersonal", "html_url": "https://github.com/ShayanPersonal", "followers_url": "https://api.github.com/users/ShayanPersonal/followers", "following_url": "https://api.github.com/users/ShayanPersonal/following{/other_user}", "gists_url": "https://api.github.com/users/ShayanPersonal/gists{/gist_id}", "starred_url": "https://api.github.com/users/ShayanPersonal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ShayanPersonal/subscriptions", "organizations_url": "https://api.github.com/users/ShayanPersonal/orgs", "repos_url": "https://api.github.com/users/ShayanPersonal/repos", "events_url": "https://api.github.com/users/ShayanPersonal/events{/privacy}", "received_events_url": "https://api.github.com/users/ShayanPersonal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-05-13T23:51:03Z", "updated_at": "2018-05-14T18:58:32Z", "closed_at": null, "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>Dilated max-pooling should work even when the amount of padding is greater than half the kernel size, because dilation imitates larger kernels and there shouldn't be any risk of the -inf issue discussed in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"268632848\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3298\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/3298/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/3298\">#3298</a>.</p>\n<h2>Code example</h2>\n<blockquote>\n<blockquote>\n<blockquote>\n<p>import torch<br>\npool = torch.nn.MaxPool2d(kernel_size=3, stride=2, padding=2, dilation=10)<br>\nx = torch.Tensor(1, 1, 1000, 1000)<br>\npool(x)<br>\nTraceback (most recent call last):<br>\nFile \"\", line 1, in <br>\nFile \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)<br>\nFile \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/modules/pooling.py\", line 142, in forward<br>\nself.return_indices)<br>\nFile \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/functional.py\", line 360, in max_pool2d<br>\nret = torch._C._nn.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)<br>\nRuntimeError: invalid argument 2: pad should be smaller than half of kernel size, but got padW = 2, padH = 2, kW = 3, kH = 3 at /opt/conda/conda-bld/pytorch_1524590031827/work/aten/src/THNN/generic/SpatialDilatedMaxPooling.c:35</p>\n</blockquote>\n</blockquote>\n</blockquote>\n<h2>System Info</h2>\n<p>Pytorch 0.4 installed with conda on Ubuntu 18.04.</p>", "body_text": "Issue description\nDilated max-pooling should work even when the amount of padding is greater than half the kernel size, because dilation imitates larger kernels and there shouldn't be any risk of the -inf issue discussed in #3298.\nCode example\n\n\n\nimport torch\npool = torch.nn.MaxPool2d(kernel_size=3, stride=2, padding=2, dilation=10)\nx = torch.Tensor(1, 1, 1000, 1000)\npool(x)\nTraceback (most recent call last):\nFile \"\", line 1, in \nFile \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in call\nresult = self.forward(*input, **kwargs)\nFile \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/modules/pooling.py\", line 142, in forward\nself.return_indices)\nFile \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/functional.py\", line 360, in max_pool2d\nret = torch._C._nn.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)\nRuntimeError: invalid argument 2: pad should be smaller than half of kernel size, but got padW = 2, padH = 2, kW = 3, kH = 3 at /opt/conda/conda-bld/pytorch_1524590031827/work/aten/src/THNN/generic/SpatialDilatedMaxPooling.c:35\n\n\n\nSystem Info\nPytorch 0.4 installed with conda on Ubuntu 18.04.", "body": "## Issue description\r\nDilated max-pooling should work even when the amount of padding is greater than half the kernel size, because dilation imitates larger kernels and there shouldn't be any risk of the -inf issue discussed in #3298. \r\n\r\n## Code example\r\n\r\n>>> import torch\r\n>>> pool = torch.nn.MaxPool2d(kernel_size=3, stride=2, padding=2, dilation=10)\r\n>>> x = torch.Tensor(1, 1, 1000, 1000)\r\n>>> pool(x)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 491, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/modules/pooling.py\", line 142, in forward\r\n    self.return_indices)\r\n  File \"/home/m/anaconda3/lib/python3.6/site-packages/torch/nn/functional.py\", line 360, in max_pool2d\r\n    ret = torch._C._nn.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)\r\nRuntimeError: invalid argument 2: pad should be smaller than half of kernel size, but got padW = 2, padH = 2, kW = 3, kH = 3 at /opt/conda/conda-bld/pytorch_1524590031827/work/aten/src/THNN/generic/SpatialDilatedMaxPooling.c:35\r\n\r\n## System Info\r\nPytorch 0.4 installed with conda on Ubuntu 18.04."}