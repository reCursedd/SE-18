{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/1716", "id": 123883263, "node_id": "MDExOlB1bGxSZXF1ZXN0MTIzODgzMjYz", "html_url": "https://github.com/pytorch/pytorch/pull/1716", "diff_url": "https://github.com/pytorch/pytorch/pull/1716.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/1716.patch", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/1716", "number": 1716, "state": "open", "locked": false, "title": "[WIP] Batched sparse QR factorizations and solves with cusolver", "user": {"login": "bamos", "id": 707462, "node_id": "MDQ6VXNlcjcwNzQ2Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/707462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bamos", "html_url": "https://github.com/bamos", "followers_url": "https://api.github.com/users/bamos/followers", "following_url": "https://api.github.com/users/bamos/following{/other_user}", "gists_url": "https://api.github.com/users/bamos/gists{/gist_id}", "starred_url": "https://api.github.com/users/bamos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bamos/subscriptions", "organizations_url": "https://api.github.com/users/bamos/orgs", "repos_url": "https://api.github.com/users/bamos/repos", "events_url": "https://api.github.com/users/bamos/events{/privacy}", "received_events_url": "https://api.github.com/users/bamos/received_events", "type": "User", "site_admin": false}, "body": "This PR is connected to issue #1178.\r\n\r\nThis is still a little hacky and a WIP but I'm sending it in to get a conversation started and move this towards something mergable. I am currently using this with the sparse solvers I have in qpth and it's working well: https://github.com/locuslab/qpth/blob/master/qpth/solvers/pdipm/spbatch.py\r\n\r\nI think that batched sparse tensor operations with the same sparsity pattern will come up frequently to take advantage of GPU parallelism and I sent in this discussion a while ago about handling this case: https://discuss.pytorch.org/t/3d-sparse-batch-tensors-with-the-same-sparsity-pattern/2806\r\n\r\nWe could move this broader conversation back to that thread. I could add some transpose operations to my code here and use hybrid sparse tensors as @ezyang mentioned. However for simplicity and because I'm not sure what you all prefer, I've implemented this to **not** do that and I'm **not** using the sparse tensor wrapper and am just passing the appropriate tensors around. What are your opinions on how I should modify this function and interface?", "created_at": "2017-06-04T16:23:01Z", "updated_at": "2018-11-23T15:33:51Z", "closed_at": null, "merged_at": null, "merge_commit_sha": "aa938eba0460b575f4ae53acd7fe6e2321816279", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "commits_url": "https://api.github.com/repos/pytorch/pytorch/pulls/1716/commits", "review_comments_url": "https://api.github.com/repos/pytorch/pytorch/pulls/1716/comments", "review_comment_url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1716/comments", "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/522c5607e472d320ac47e8475201f6e0497bd67f", "head": {"label": "locuslab:sparse_qr", "ref": "sparse_qr", "sha": "522c5607e472d320ac47e8475201f6e0497bd67f", "user": {"login": "locuslab", "id": 16084741, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE2MDg0NzQx", "avatar_url": "https://avatars2.githubusercontent.com/u/16084741?v=4", "gravatar_id": "", "url": "https://api.github.com/users/locuslab", "html_url": "https://github.com/locuslab", "followers_url": "https://api.github.com/users/locuslab/followers", "following_url": "https://api.github.com/users/locuslab/following{/other_user}", "gists_url": "https://api.github.com/users/locuslab/gists{/gist_id}", "starred_url": "https://api.github.com/users/locuslab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/locuslab/subscriptions", "organizations_url": "https://api.github.com/users/locuslab/orgs", "repos_url": "https://api.github.com/users/locuslab/repos", "events_url": "https://api.github.com/users/locuslab/events{/privacy}", "received_events_url": "https://api.github.com/users/locuslab/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 91094305, "node_id": "MDEwOlJlcG9zaXRvcnk5MTA5NDMwNQ==", "name": "pytorch", "full_name": "locuslab/pytorch", "private": false, "owner": {"login": "locuslab", "id": 16084741, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE2MDg0NzQx", "avatar_url": "https://avatars2.githubusercontent.com/u/16084741?v=4", "gravatar_id": "", "url": "https://api.github.com/users/locuslab", "html_url": "https://github.com/locuslab", "followers_url": "https://api.github.com/users/locuslab/followers", "following_url": "https://api.github.com/users/locuslab/following{/other_user}", "gists_url": "https://api.github.com/users/locuslab/gists{/gist_id}", "starred_url": "https://api.github.com/users/locuslab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/locuslab/subscriptions", "organizations_url": "https://api.github.com/users/locuslab/orgs", "repos_url": "https://api.github.com/users/locuslab/repos", "events_url": "https://api.github.com/users/locuslab/events{/privacy}", "received_events_url": "https://api.github.com/users/locuslab/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/locuslab/pytorch", "description": "Tensors and Dynamic neural networks in Python  with strong GPU acceleration", "fork": true, "url": "https://api.github.com/repos/locuslab/pytorch", "forks_url": "https://api.github.com/repos/locuslab/pytorch/forks", "keys_url": "https://api.github.com/repos/locuslab/pytorch/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/locuslab/pytorch/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/locuslab/pytorch/teams", "hooks_url": "https://api.github.com/repos/locuslab/pytorch/hooks", "issue_events_url": "https://api.github.com/repos/locuslab/pytorch/issues/events{/number}", "events_url": "https://api.github.com/repos/locuslab/pytorch/events", "assignees_url": "https://api.github.com/repos/locuslab/pytorch/assignees{/user}", "branches_url": "https://api.github.com/repos/locuslab/pytorch/branches{/branch}", "tags_url": "https://api.github.com/repos/locuslab/pytorch/tags", "blobs_url": "https://api.github.com/repos/locuslab/pytorch/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/locuslab/pytorch/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/locuslab/pytorch/git/refs{/sha}", "trees_url": "https://api.github.com/repos/locuslab/pytorch/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/locuslab/pytorch/statuses/{sha}", "languages_url": "https://api.github.com/repos/locuslab/pytorch/languages", "stargazers_url": "https://api.github.com/repos/locuslab/pytorch/stargazers", "contributors_url": "https://api.github.com/repos/locuslab/pytorch/contributors", "subscribers_url": "https://api.github.com/repos/locuslab/pytorch/subscribers", "subscription_url": "https://api.github.com/repos/locuslab/pytorch/subscription", "commits_url": "https://api.github.com/repos/locuslab/pytorch/commits{/sha}", "git_commits_url": "https://api.github.com/repos/locuslab/pytorch/git/commits{/sha}", "comments_url": "https://api.github.com/repos/locuslab/pytorch/comments{/number}", "issue_comment_url": "https://api.github.com/repos/locuslab/pytorch/issues/comments{/number}", "contents_url": "https://api.github.com/repos/locuslab/pytorch/contents/{+path}", "compare_url": "https://api.github.com/repos/locuslab/pytorch/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/locuslab/pytorch/merges", "archive_url": "https://api.github.com/repos/locuslab/pytorch/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/locuslab/pytorch/downloads", "issues_url": "https://api.github.com/repos/locuslab/pytorch/issues{/number}", "pulls_url": "https://api.github.com/repos/locuslab/pytorch/pulls{/number}", "milestones_url": "https://api.github.com/repos/locuslab/pytorch/milestones{/number}", "notifications_url": "https://api.github.com/repos/locuslab/pytorch/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/locuslab/pytorch/labels{/name}", "releases_url": "https://api.github.com/repos/locuslab/pytorch/releases{/id}", "deployments_url": "https://api.github.com/repos/locuslab/pytorch/deployments", "created_at": "2017-05-12T13:28:56Z", "updated_at": "2017-05-12T13:29:00Z", "pushed_at": "2017-07-21T13:14:02Z", "git_url": "git://github.com/locuslab/pytorch.git", "ssh_url": "git@github.com:locuslab/pytorch.git", "clone_url": "https://github.com/locuslab/pytorch.git", "svn_url": "https://github.com/locuslab/pytorch", "homepage": "http://pytorch.org", "size": 12661, "stargazers_count": 0, "watchers_count": 0, "language": "Python", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "forks_count": 0, "mirror_url": null, "archived": false, "open_issues_count": 0, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "pytorch:master", "ref": "master", "sha": "f9d002d9f7c5f9ec1a5f097887b9120a4b0160f1", "user": {"login": "pytorch", "id": 21003710, "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/21003710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytorch", "html_url": "https://github.com/pytorch", "followers_url": "https://api.github.com/users/pytorch/followers", "following_url": "https://api.github.com/users/pytorch/following{/other_user}", "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions", "organizations_url": "https://api.github.com/users/pytorch/orgs", "repos_url": "https://api.github.com/users/pytorch/repos", "events_url": "https://api.github.com/users/pytorch/events{/privacy}", "received_events_url": "https://api.github.com/users/pytorch/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 65600975, "node_id": "MDEwOlJlcG9zaXRvcnk2NTYwMDk3NQ==", "name": "pytorch", "full_name": "pytorch/pytorch", "private": false, "owner": {"login": "pytorch", "id": 21003710, "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxMDAzNzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/21003710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytorch", "html_url": "https://github.com/pytorch", "followers_url": "https://api.github.com/users/pytorch/followers", "following_url": "https://api.github.com/users/pytorch/following{/other_user}", "gists_url": "https://api.github.com/users/pytorch/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytorch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytorch/subscriptions", "organizations_url": "https://api.github.com/users/pytorch/orgs", "repos_url": "https://api.github.com/users/pytorch/repos", "events_url": "https://api.github.com/users/pytorch/events{/privacy}", "received_events_url": "https://api.github.com/users/pytorch/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/pytorch/pytorch", "description": "Tensors and Dynamic neural networks in Python  with strong GPU acceleration", "fork": false, "url": "https://api.github.com/repos/pytorch/pytorch", "forks_url": "https://api.github.com/repos/pytorch/pytorch/forks", "keys_url": "https://api.github.com/repos/pytorch/pytorch/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/pytorch/pytorch/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/pytorch/pytorch/teams", "hooks_url": "https://api.github.com/repos/pytorch/pytorch/hooks", "issue_events_url": "https://api.github.com/repos/pytorch/pytorch/issues/events{/number}", "events_url": "https://api.github.com/repos/pytorch/pytorch/events", "assignees_url": "https://api.github.com/repos/pytorch/pytorch/assignees{/user}", "branches_url": "https://api.github.com/repos/pytorch/pytorch/branches{/branch}", "tags_url": "https://api.github.com/repos/pytorch/pytorch/tags", "blobs_url": "https://api.github.com/repos/pytorch/pytorch/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/pytorch/pytorch/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/pytorch/pytorch/git/refs{/sha}", "trees_url": "https://api.github.com/repos/pytorch/pytorch/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/pytorch/pytorch/statuses/{sha}", "languages_url": "https://api.github.com/repos/pytorch/pytorch/languages", "stargazers_url": "https://api.github.com/repos/pytorch/pytorch/stargazers", "contributors_url": "https://api.github.com/repos/pytorch/pytorch/contributors", "subscribers_url": "https://api.github.com/repos/pytorch/pytorch/subscribers", "subscription_url": "https://api.github.com/repos/pytorch/pytorch/subscription", "commits_url": "https://api.github.com/repos/pytorch/pytorch/commits{/sha}", "git_commits_url": "https://api.github.com/repos/pytorch/pytorch/git/commits{/sha}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/comments{/number}", "issue_comment_url": "https://api.github.com/repos/pytorch/pytorch/issues/comments{/number}", "contents_url": "https://api.github.com/repos/pytorch/pytorch/contents/{+path}", "compare_url": "https://api.github.com/repos/pytorch/pytorch/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/pytorch/pytorch/merges", "archive_url": "https://api.github.com/repos/pytorch/pytorch/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/pytorch/pytorch/downloads", "issues_url": "https://api.github.com/repos/pytorch/pytorch/issues{/number}", "pulls_url": "https://api.github.com/repos/pytorch/pytorch/pulls{/number}", "milestones_url": "https://api.github.com/repos/pytorch/pytorch/milestones{/number}", "notifications_url": "https://api.github.com/repos/pytorch/pytorch/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/pytorch/pytorch/labels{/name}", "releases_url": "https://api.github.com/repos/pytorch/pytorch/releases{/id}", "deployments_url": "https://api.github.com/repos/pytorch/pytorch/deployments", "created_at": "2016-08-13T05:26:41Z", "updated_at": "2018-11-24T14:27:35Z", "pushed_at": "2018-11-24T12:42:01Z", "git_url": "git://github.com/pytorch/pytorch.git", "ssh_url": "git@github.com:pytorch/pytorch.git", "clone_url": "https://github.com/pytorch/pytorch.git", "svn_url": "https://github.com/pytorch/pytorch", "homepage": "http://pytorch.org", "size": 89656, "stargazers_count": 21591, "watchers_count": 21591, "language": "C++", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "forks_count": 5154, "mirror_url": null, "archived": false, "open_issues_count": 2196, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "forks": 5154, "open_issues": 2196, "watchers": 21591, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/1716"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/1716"}, "issue": {"href": "https://api.github.com/repos/pytorch/pytorch/issues/1716"}, "comments": {"href": "https://api.github.com/repos/pytorch/pytorch/issues/1716/comments"}, "review_comments": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/1716/comments"}, "review_comment": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/1716/commits"}, "statuses": {"href": "https://api.github.com/repos/pytorch/pytorch/statuses/522c5607e472d320ac47e8475201f6e0497bd67f"}}, "author_association": "CONTRIBUTOR", "body_html": "<p>This PR is connected to issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"218963108\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1178\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1178/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1178\">#1178</a>.</p>\n<p>This is still a little hacky and a WIP but I'm sending it in to get a conversation started and move this towards something mergable. I am currently using this with the sparse solvers I have in qpth and it's working well: <a href=\"https://github.com/locuslab/qpth/blob/master/qpth/solvers/pdipm/spbatch.py\">https://github.com/locuslab/qpth/blob/master/qpth/solvers/pdipm/spbatch.py</a></p>\n<p>I think that batched sparse tensor operations with the same sparsity pattern will come up frequently to take advantage of GPU parallelism and I sent in this discussion a while ago about handling this case: <a href=\"https://discuss.pytorch.org/t/3d-sparse-batch-tensors-with-the-same-sparsity-pattern/2806\" rel=\"nofollow\">https://discuss.pytorch.org/t/3d-sparse-batch-tensors-with-the-same-sparsity-pattern/2806</a></p>\n<p>We could move this broader conversation back to that thread. I could add some transpose operations to my code here and use hybrid sparse tensors as <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=13564\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ezyang\">@ezyang</a> mentioned. However for simplicity and because I'm not sure what you all prefer, I've implemented this to <strong>not</strong> do that and I'm <strong>not</strong> using the sparse tensor wrapper and am just passing the appropriate tensors around. What are your opinions on how I should modify this function and interface?</p>", "body_text": "This PR is connected to issue #1178.\nThis is still a little hacky and a WIP but I'm sending it in to get a conversation started and move this towards something mergable. I am currently using this with the sparse solvers I have in qpth and it's working well: https://github.com/locuslab/qpth/blob/master/qpth/solvers/pdipm/spbatch.py\nI think that batched sparse tensor operations with the same sparsity pattern will come up frequently to take advantage of GPU parallelism and I sent in this discussion a while ago about handling this case: https://discuss.pytorch.org/t/3d-sparse-batch-tensors-with-the-same-sparsity-pattern/2806\nWe could move this broader conversation back to that thread. I could add some transpose operations to my code here and use hybrid sparse tensors as @ezyang mentioned. However for simplicity and because I'm not sure what you all prefer, I've implemented this to not do that and I'm not using the sparse tensor wrapper and am just passing the appropriate tensors around. What are your opinions on how I should modify this function and interface?", "merged": false, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": null, "comments": 10, "review_comments": 9, "maintainer_can_modify": true, "commits": 5, "additions": 144, "deletions": 2, "changed_files": 8}