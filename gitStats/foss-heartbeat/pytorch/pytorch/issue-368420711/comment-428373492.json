{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/428373492", "html_url": "https://github.com/pytorch/pytorch/issues/12506#issuecomment-428373492", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/12506", "id": 428373492, "node_id": "MDEyOklzc3VlQ29tbWVudDQyODM3MzQ5Mg==", "user": {"login": "zeryx", "id": 1892175, "node_id": "MDQ6VXNlcjE4OTIxNzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1892175?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zeryx", "html_url": "https://github.com/zeryx", "followers_url": "https://api.github.com/users/zeryx/followers", "following_url": "https://api.github.com/users/zeryx/following{/other_user}", "gists_url": "https://api.github.com/users/zeryx/gists{/gist_id}", "starred_url": "https://api.github.com/users/zeryx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zeryx/subscriptions", "organizations_url": "https://api.github.com/users/zeryx/orgs", "repos_url": "https://api.github.com/users/zeryx/repos", "events_url": "https://api.github.com/users/zeryx/events{/privacy}", "received_events_url": "https://api.github.com/users/zeryx/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-09T22:22:00Z", "updated_at": "2018-10-09T22:22:39Z", "author_association": "NONE", "body_html": "<p>Here is my current minimal project, I followed the tutorial and generated some random input that does work for my example - however I can't reason a way to take a local image file, and load it into a tensor using libtorch.</p>\n<div class=\"highlight highlight-source-c++\"><pre>#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;</span>torch/script.h<span class=\"pl-pds\">&gt;</span></span>\n#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;</span>iostream<span class=\"pl-pds\">&gt;</span></span>\n#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;</span>memory<span class=\"pl-pds\">&gt;</span></span>\n\n<span class=\"pl-k\">int</span> <span class=\"pl-en\">main</span>() {\n    std::string model_path = <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/somefile.pl<span class=\"pl-pds\">\"</span></span>;\n    std::string image_path = <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/some_image.jpg<span class=\"pl-pds\">\"</span></span> #How would I load <span class=\"pl-c1\">this</span> into an input tensor <span class=\"pl-k\">for</span> processing?\n    std::ifstream <span class=\"pl-smi\">is</span> (model_path, std::ifstream::binary);\n    std::shared_ptr&lt;torch::jit::script::Module&gt; module = <span class=\"pl-c1\">torch::jit::load</span>(is);\n    std::vector&lt;torch::jit::IValue&gt; inputs;\n    inputs.<span class=\"pl-c1\">emplace_back</span>(<span class=\"pl-c1\">torch::rand</span>({<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1266</span>, <span class=\"pl-c1\">1900</span>}));\n    torch::jit::IValue result = module-&gt;<span class=\"pl-c1\">forward</span>(inputs);\n    at::Tensor printable = result.<span class=\"pl-c1\">toTensor</span>();\n    std::cout &lt;&lt; printable &lt;&lt; std::endl;\n}</pre></div>", "body_text": "Here is my current minimal project, I followed the tutorial and generated some random input that does work for my example - however I can't reason a way to take a local image file, and load it into a tensor using libtorch.\n#include <torch/script.h>\n#include <iostream>\n#include <memory>\n\nint main() {\n    std::string model_path = \"/tmp/somefile.pl\";\n    std::string image_path = \"/tmp/some_image.jpg\" #How would I load this into an input tensor for processing?\n    std::ifstream is (model_path, std::ifstream::binary);\n    std::shared_ptr<torch::jit::script::Module> module = torch::jit::load(is);\n    std::vector<torch::jit::IValue> inputs;\n    inputs.emplace_back(torch::rand({1, 3, 1266, 1900}));\n    torch::jit::IValue result = module->forward(inputs);\n    at::Tensor printable = result.toTensor();\n    std::cout << printable << std::endl;\n}", "body": "Here is my current minimal project, I followed the tutorial and generated some random input that does work for my example - however I can't reason a way to take a local image file, and load it into a tensor using libtorch.\r\n\r\n```cpp\r\n#include <torch/script.h>\r\n#include <iostream>\r\n#include <memory>\r\n\r\nint main() {\r\n    std::string model_path = \"/tmp/somefile.pl\";\r\n    std::string image_path = \"/tmp/some_image.jpg\" #How would I load this into an input tensor for processing?\r\n    std::ifstream is (model_path, std::ifstream::binary);\r\n    std::shared_ptr<torch::jit::script::Module> module = torch::jit::load(is);\r\n    std::vector<torch::jit::IValue> inputs;\r\n    inputs.emplace_back(torch::rand({1, 3, 1266, 1900}));\r\n    torch::jit::IValue result = module->forward(inputs);\r\n    at::Tensor printable = result.toTensor();\r\n    std::cout << printable << std::endl;\r\n}\r\n```"}