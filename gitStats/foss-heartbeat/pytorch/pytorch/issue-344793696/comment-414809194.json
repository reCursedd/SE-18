{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/414809194", "html_url": "https://github.com/pytorch/pytorch/issues/9873#issuecomment-414809194", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9873", "id": 414809194, "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDgwOTE5NA==", "user": {"login": "berkinmalkoc", "id": 31172908, "node_id": "MDQ6VXNlcjMxMTcyOTA4", "avatar_url": "https://avatars0.githubusercontent.com/u/31172908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/berkinmalkoc", "html_url": "https://github.com/berkinmalkoc", "followers_url": "https://api.github.com/users/berkinmalkoc/followers", "following_url": "https://api.github.com/users/berkinmalkoc/following{/other_user}", "gists_url": "https://api.github.com/users/berkinmalkoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/berkinmalkoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/berkinmalkoc/subscriptions", "organizations_url": "https://api.github.com/users/berkinmalkoc/orgs", "repos_url": "https://api.github.com/users/berkinmalkoc/repos", "events_url": "https://api.github.com/users/berkinmalkoc/events{/privacy}", "received_events_url": "https://api.github.com/users/berkinmalkoc/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-21T20:22:57Z", "updated_at": "2018-08-28T20:24:40Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=10665923\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zhangchenkai\">@zhangchenkai</a> and <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1199593\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/simonm3\">@simonm3</a>, if you compile from source as per the instructions (<a href=\"https://github.com/pytorch/pytorch#from-source\">https://github.com/pytorch/pytorch#from-source</a>) and hence work in a conda environment, un-installing intel-openmp (installed in the process as a dependency) and using openmp instead</p>\n<pre><code># Install all the dependencies and then:\nconda remove --force intel-openmp\nconda install -c intel openmp\n# Install pytorch and then:\nconda remove --force openmp\n</code></pre>\n<p>in the environment seems to let the <code>python setup.py install</code> successfully finish and to enable setting the number of threads using the environmental variables mentioned by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1310570\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/soumith\">@soumith</a> (i.e., you see <code>$OMP_NUM_THREADS</code> cores being utilized in <code>htop</code>).</p>\n<p>Btw, I am on <code>Ubuntu 16.04</code> and used <code>gcc</code> for compiling PyTorch. I dont know the exact effect of the installation steps above but may be you need to prevent <code>openmp</code> from interfering with <code>gcc</code>'s.</p>", "body_text": "@zhangchenkai and @simonm3, if you compile from source as per the instructions (https://github.com/pytorch/pytorch#from-source) and hence work in a conda environment, un-installing intel-openmp (installed in the process as a dependency) and using openmp instead\n# Install all the dependencies and then:\nconda remove --force intel-openmp\nconda install -c intel openmp\n# Install pytorch and then:\nconda remove --force openmp\n\nin the environment seems to let the python setup.py install successfully finish and to enable setting the number of threads using the environmental variables mentioned by @soumith (i.e., you see $OMP_NUM_THREADS cores being utilized in htop).\nBtw, I am on Ubuntu 16.04 and used gcc for compiling PyTorch. I dont know the exact effect of the installation steps above but may be you need to prevent openmp from interfering with gcc's.", "body": "@zhangchenkai and @simonm3, if you compile from source as per the instructions (https://github.com/pytorch/pytorch#from-source) and hence work in a conda environment, un-installing intel-openmp (installed in the process as a dependency) and using openmp instead\r\n\r\n```\r\n# Install all the dependencies and then:\r\nconda remove --force intel-openmp\r\nconda install -c intel openmp\r\n# Install pytorch and then:\r\nconda remove --force openmp\r\n```\r\nin the environment seems to let the `python setup.py install` successfully finish and to enable setting the number of threads using the environmental variables mentioned by @soumith (i.e., you see `$OMP_NUM_THREADS` cores being utilized in `htop`).\r\n\r\nBtw, I am on `Ubuntu 16.04` and used `gcc` for compiling PyTorch. I dont know the exact effect of the installation steps above but may be you need to prevent `openmp` from interfering with `gcc`'s."}