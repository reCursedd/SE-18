{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/416876719", "html_url": "https://github.com/pytorch/pytorch/issues/9873#issuecomment-416876719", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/9873", "id": 416876719, "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjg3NjcxOQ==", "user": {"login": "simonm3", "id": 1199593, "node_id": "MDQ6VXNlcjExOTk1OTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/1199593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simonm3", "html_url": "https://github.com/simonm3", "followers_url": "https://api.github.com/users/simonm3/followers", "following_url": "https://api.github.com/users/simonm3/following{/other_user}", "gists_url": "https://api.github.com/users/simonm3/gists{/gist_id}", "starred_url": "https://api.github.com/users/simonm3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simonm3/subscriptions", "organizations_url": "https://api.github.com/users/simonm3/orgs", "repos_url": "https://api.github.com/users/simonm3/repos", "events_url": "https://api.github.com/users/simonm3/events{/privacy}", "received_events_url": "https://api.github.com/users/simonm3/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-29T08:51:36Z", "updated_at": "2018-08-29T10:52:27Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=31172908\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/berkinmalkoc\">@berkinmalkoc</a> For me setting OMP_NUM_THREADS/MKL_NUM_THREADS before starting python does change the number of threads shown in htop. I note that if I set it to 9 htop shows 10 threads; and 36 shows 37 threads. If I set above 36 then it shows 37 despite there being 72 vcpus. I guess there is one main thread added.</p>\n<p>htop shows the 37 as 100% utilised. Previously I have been using \"mpstat -P ALL\". This shows cpu utilisation starting low (maybe it uses an average over a period) but over time increasing across all 72 vcpus. Not sure what they are showing exactly.</p>\n<p>No difference in timing whatever values of OMP_NUM_THREADS/MKL_NUM_THREADS.</p>", "body_text": "@berkinmalkoc For me setting OMP_NUM_THREADS/MKL_NUM_THREADS before starting python does change the number of threads shown in htop. I note that if I set it to 9 htop shows 10 threads; and 36 shows 37 threads. If I set above 36 then it shows 37 despite there being 72 vcpus. I guess there is one main thread added.\nhtop shows the 37 as 100% utilised. Previously I have been using \"mpstat -P ALL\". This shows cpu utilisation starting low (maybe it uses an average over a period) but over time increasing across all 72 vcpus. Not sure what they are showing exactly.\nNo difference in timing whatever values of OMP_NUM_THREADS/MKL_NUM_THREADS.", "body": "@berkinmalkoc For me setting OMP_NUM_THREADS/MKL_NUM_THREADS before starting python does change the number of threads shown in htop. I note that if I set it to 9 htop shows 10 threads; and 36 shows 37 threads. If I set above 36 then it shows 37 despite there being 72 vcpus. I guess there is one main thread added. \r\n\r\nhtop shows the 37 as 100% utilised. Previously I have been using \"mpstat -P ALL\". This shows cpu utilisation starting low (maybe it uses an average over a period) but over time increasing across all 72 vcpus. Not sure what they are showing exactly.\r\n\r\nNo difference in timing whatever values of OMP_NUM_THREADS/MKL_NUM_THREADS."}