{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7426", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7426/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7426/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7426/events", "html_url": "https://github.com/pytorch/pytorch/issues/7426", "id": 321641145, "node_id": "MDU6SXNzdWUzMjE2NDExNDU=", "number": 7426, "title": "Caffe2 install failure", "user": {"login": "tarlen5", "id": 6472638, "node_id": "MDQ6VXNlcjY0NzI2Mzg=", "avatar_url": "https://avatars3.githubusercontent.com/u/6472638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tarlen5", "html_url": "https://github.com/tarlen5", "followers_url": "https://api.github.com/users/tarlen5/followers", "following_url": "https://api.github.com/users/tarlen5/following{/other_user}", "gists_url": "https://api.github.com/users/tarlen5/gists{/gist_id}", "starred_url": "https://api.github.com/users/tarlen5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tarlen5/subscriptions", "organizations_url": "https://api.github.com/users/tarlen5/orgs", "repos_url": "https://api.github.com/users/tarlen5/repos", "events_url": "https://api.github.com/users/tarlen5/events{/privacy}", "received_events_url": "https://api.github.com/users/tarlen5/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-09T16:32:17Z", "updated_at": "2018-08-17T14:22:08Z", "closed_at": "2018-05-09T19:34:41Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>I'm getting a build/compilation error when I try to install caffe2 on Ubuntu 16.04, with CUDA v9.1. This looks to me like it's some sort of cuda error, but I can't for the life of me figure out what's going wrong, because the errors appear to be coming from the cuda header files, like this:</p>\n<pre><code>/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no\nlonger supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD_\n_ instead.\"\" is not valid in preprocessor expressions\n</code></pre>\n<p>Then it tells me cmake error:</p>\n<pre><code>CMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:215 (message):\n  Error generating\n  /home/ubuntu/local/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_gen\nerated_math_gpu.cu.o\n</code></pre>\n<p>See below screenshots for full output errors.</p>\n<h2>Code example</h2>\n<p>I'm simply trying to build caffe2 from source, using anaconda, following <a href=\"https://caffe2.ai/docs/getting-started.html?platform=mac&amp;configuration=compile#custom-anaconda-install\" rel=\"nofollow\">these instructions</a>:</p>\n<p><code>cmake -DCMAKE_PREFIX_PATH=~/anaconda2/envs/caffe2/ -DCMAKE_INSTALL_PREFIX=~/anaconda/envs/caffe2 ..</code></p>\n<p><code>make install</code></p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: caffe2</li>\n<li>How you installed PyTorch (conda, pip, source): Following instructions from <a href=\"https://caffe2.ai/docs/getting-started.html?platform=mac&amp;configuration=compile#custom-anaconda-install\" rel=\"nofollow\">here</a> to install caffe2 on my system with anaconda python in a clean environment.</li>\n<li>Build command you used (if compiling from source):</li>\n</ul>\n<p><code>cmake -DCMAKE_PREFIX_PATH=~/anaconda2/envs/caffe2/ -DCMAKE_INSTALL_PREFIX=~/anaconda/envs/caffe2 ..</code></p>\n<p><code>make install</code></p>\n<ul>\n<li>OS: ubuntu 16.04</li>\n<li>PyTorch version: none</li>\n<li>Python version: 2.7.15 (anaconda)</li>\n<li>CUDA/cuDNN version: cuda version 9.1, cuDNN version 7.0.5</li>\n<li>GPU models and configuration: Tesla M60 (on AWS EC2)</li>\n<li>GCC version (if compiling from source): 5.4.0</li>\n<li>CMake version: 3.5.1</li>\n<li>Versions of any other relevant libraries: not sure?</li>\n</ul>\n<p>I ran the cmake command and outputted the information to this log file:<br>\n<a href=\"https://github.com/pytorch/pytorch/files/1988638/cmake.log\">cmake.log</a></p>\n<p>Here is the complete error output from the <code>make install</code>  command:</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/6472638/39826882-06dd6810-536b-11e8-9983-c4ba66fe8641.png\"><img src=\"https://user-images.githubusercontent.com/6472638/39826882-06dd6810-536b-11e8-9983-c4ba66fe8641.png\" alt=\"screen shot 2018-05-09 at 9 25 06 am\" style=\"max-width:100%;\"></a></p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/6472638/39826886-0c0d32b6-536b-11e8-946d-70cd60a4a774.png\"><img src=\"https://user-images.githubusercontent.com/6472638/39826886-0c0d32b6-536b-11e8-946d-70cd60a4a774.png\" alt=\"screen shot 2018-05-09 at 9 25 48 am\" style=\"max-width:100%;\"></a></p>", "body_text": "Issue description\nI'm getting a build/compilation error when I try to install caffe2 on Ubuntu 16.04, with CUDA v9.1. This looks to me like it's some sort of cuda error, but I can't for the life of me figure out what's going wrong, because the errors appear to be coming from the cuda header files, like this:\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no\nlonger supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD_\n_ instead.\"\" is not valid in preprocessor expressions\n\nThen it tells me cmake error:\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:215 (message):\n  Error generating\n  /home/ubuntu/local/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_gen\nerated_math_gpu.cu.o\n\nSee below screenshots for full output errors.\nCode example\nI'm simply trying to build caffe2 from source, using anaconda, following these instructions:\ncmake -DCMAKE_PREFIX_PATH=~/anaconda2/envs/caffe2/ -DCMAKE_INSTALL_PREFIX=~/anaconda/envs/caffe2 ..\nmake install\nSystem Info\n\nPyTorch or Caffe2: caffe2\nHow you installed PyTorch (conda, pip, source): Following instructions from here to install caffe2 on my system with anaconda python in a clean environment.\nBuild command you used (if compiling from source):\n\ncmake -DCMAKE_PREFIX_PATH=~/anaconda2/envs/caffe2/ -DCMAKE_INSTALL_PREFIX=~/anaconda/envs/caffe2 ..\nmake install\n\nOS: ubuntu 16.04\nPyTorch version: none\nPython version: 2.7.15 (anaconda)\nCUDA/cuDNN version: cuda version 9.1, cuDNN version 7.0.5\nGPU models and configuration: Tesla M60 (on AWS EC2)\nGCC version (if compiling from source): 5.4.0\nCMake version: 3.5.1\nVersions of any other relevant libraries: not sure?\n\nI ran the cmake command and outputted the information to this log file:\ncmake.log\nHere is the complete error output from the make install  command:", "body": "## Issue description\r\n\r\nI'm getting a build/compilation error when I try to install caffe2 on Ubuntu 16.04, with CUDA v9.1. This looks to me like it's some sort of cuda error, but I can't for the life of me figure out what's going wrong, because the errors appear to be coming from the cuda header files, like this:\r\n\r\n```\r\n/usr/local/cuda/include/crt/common_functions.h:64:24: error: token \"\"__CUDACC_VER__ is no\r\nlonger supported.  Use __CUDACC_VER_MAJOR__, __CUDACC_VER_MINOR__, and __CUDACC_VER_BUILD_\r\n_ instead.\"\" is not valid in preprocessor expressions\r\n```\r\nThen it tells me cmake error:\r\n\r\n```\r\nCMake Error at caffe2_gpu_generated_math_gpu.cu.o.Release.cmake:215 (message):\r\n  Error generating\r\n  /home/ubuntu/local/pytorch/build/caffe2/CMakeFiles/caffe2_gpu.dir/utils/./caffe2_gpu_gen\r\nerated_math_gpu.cu.o\r\n```\r\n\r\nSee below screenshots for full output errors.\r\n\r\n## Code example\r\n\r\nI'm simply trying to build caffe2 from source, using anaconda, following [these instructions](https://caffe2.ai/docs/getting-started.html?platform=mac&configuration=compile#custom-anaconda-install): \r\n\r\n`cmake -DCMAKE_PREFIX_PATH=~/anaconda2/envs/caffe2/ -DCMAKE_INSTALL_PREFIX=~/anaconda/envs/caffe2 ..`\r\n\r\n`make install`\r\n\r\n## System Info\r\n\r\n- PyTorch or Caffe2: caffe2\r\n- How you installed PyTorch (conda, pip, source): Following instructions from [here](https://caffe2.ai/docs/getting-started.html?platform=mac&configuration=compile#custom-anaconda-install) to install caffe2 on my system with anaconda python in a clean environment.\r\n- Build command you used (if compiling from source): \r\n\r\n`cmake -DCMAKE_PREFIX_PATH=~/anaconda2/envs/caffe2/ -DCMAKE_INSTALL_PREFIX=~/anaconda/envs/caffe2 ..`\r\n\r\n`make install`\r\n\r\n- OS: ubuntu 16.04\r\n- PyTorch version: none\r\n- Python version: 2.7.15 (anaconda)\r\n- CUDA/cuDNN version: cuda version 9.1, cuDNN version 7.0.5\r\n- GPU models and configuration: Tesla M60 (on AWS EC2)\r\n- GCC version (if compiling from source): 5.4.0\r\n- CMake version: 3.5.1\r\n- Versions of any other relevant libraries: not sure?\r\n\r\nI ran the cmake command and outputted the information to this log file:\r\n[cmake.log](https://github.com/pytorch/pytorch/files/1988638/cmake.log)\r\n\r\nHere is the complete error output from the `make install`  command:\r\n\r\n![screen shot 2018-05-09 at 9 25 06 am](https://user-images.githubusercontent.com/6472638/39826882-06dd6810-536b-11e8-9983-c4ba66fe8641.png)\r\n\r\n![screen shot 2018-05-09 at 9 25 48 am](https://user-images.githubusercontent.com/6472638/39826886-0c0d32b6-536b-11e8-946d-70cd60a4a774.png)\r\n"}