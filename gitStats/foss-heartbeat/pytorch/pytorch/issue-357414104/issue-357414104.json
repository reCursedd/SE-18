{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11298", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11298/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11298/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11298/events", "html_url": "https://github.com/pytorch/pytorch/pull/11298", "id": 357414104, "node_id": "MDExOlB1bGxSZXF1ZXN0MjEzNDM1NjM2", "number": 11298, "title": "defer resolution of mkl to a cmake wrapper library", "user": {"login": "anderspapitto", "id": 1388690, "node_id": "MDQ6VXNlcjEzODg2OTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/1388690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anderspapitto", "html_url": "https://github.com/anderspapitto", "followers_url": "https://api.github.com/users/anderspapitto/followers", "following_url": "https://api.github.com/users/anderspapitto/following{/other_user}", "gists_url": "https://api.github.com/users/anderspapitto/gists{/gist_id}", "starred_url": "https://api.github.com/users/anderspapitto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anderspapitto/subscriptions", "organizations_url": "https://api.github.com/users/anderspapitto/orgs", "repos_url": "https://api.github.com/users/anderspapitto/repos", "events_url": "https://api.github.com/users/anderspapitto/events{/privacy}", "received_events_url": "https://api.github.com/users/anderspapitto/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-05T21:38:03Z", "updated_at": "2018-09-06T16:43:21Z", "closed_at": "2018-09-06T16:11:53Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/11298", "html_url": "https://github.com/pytorch/pytorch/pull/11298", "diff_url": "https://github.com/pytorch/pytorch/pull/11298.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/11298.patch"}, "body_html": "<p>this is a fix that's needed for building extensions with a<br>\npre-packaged pytorch. Consider the scenario where</p>\n<p>(1) pytorch is compiled and packaged on machine A<br>\n(2) the package is downloaded and installed on machine B<br>\n(3) an extension is compiled on machine B, using the downloaded package</p>\n<p>Before this patch, stage (1) would embed absolute paths to the system<br>\ninstallation of mkl into the generated Caffe2Config.cmake, leading to<br>\nfailures in stage (3) if mkl was not at the same location on B as on<br>\nA. After this patch, only a reference to the wrapper library is<br>\nembedded, which is re-resolved on machine B.</p>\n<p>We are already using a similar approach for cuda.</p>\n<p>Testing: built a package on jenkins, downloaded locally and compiled an extension. Works with this patch, fails without.</p>", "body_text": "this is a fix that's needed for building extensions with a\npre-packaged pytorch. Consider the scenario where\n(1) pytorch is compiled and packaged on machine A\n(2) the package is downloaded and installed on machine B\n(3) an extension is compiled on machine B, using the downloaded package\nBefore this patch, stage (1) would embed absolute paths to the system\ninstallation of mkl into the generated Caffe2Config.cmake, leading to\nfailures in stage (3) if mkl was not at the same location on B as on\nA. After this patch, only a reference to the wrapper library is\nembedded, which is re-resolved on machine B.\nWe are already using a similar approach for cuda.\nTesting: built a package on jenkins, downloaded locally and compiled an extension. Works with this patch, fails without.", "body": "this is a fix that's needed for building extensions with a\r\npre-packaged pytorch. Consider the scenario where\r\n\r\n(1) pytorch is compiled and packaged on machine A\r\n(2) the package is downloaded and installed on machine B\r\n(3) an extension is compiled on machine B, using the downloaded package\r\n\r\nBefore this patch, stage (1) would embed absolute paths to the system\r\ninstallation of mkl into the generated Caffe2Config.cmake, leading to\r\nfailures in stage (3) if mkl was not at the same location on B as on\r\nA. After this patch, only a reference to the wrapper library is\r\nembedded, which is re-resolved on machine B.\r\n\r\nWe are already using a similar approach for cuda.\r\n\r\nTesting: built a package on jenkins, downloaded locally and compiled an extension. Works with this patch, fails without."}