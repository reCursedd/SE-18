{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5561", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5561/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5561/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5561/events", "html_url": "https://github.com/pytorch/pytorch/issues/5561", "id": 302149664, "node_id": "MDU6SXNzdWUzMDIxNDk2NjQ=", "number": 5561, "title": "Device-side Assert in `THCReduceAll.cuh:339`", "user": {"login": "angusturner", "id": 18481607, "node_id": "MDQ6VXNlcjE4NDgxNjA3", "avatar_url": "https://avatars0.githubusercontent.com/u/18481607?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angusturner", "html_url": "https://github.com/angusturner", "followers_url": "https://api.github.com/users/angusturner/followers", "following_url": "https://api.github.com/users/angusturner/following{/other_user}", "gists_url": "https://api.github.com/users/angusturner/gists{/gist_id}", "starred_url": "https://api.github.com/users/angusturner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angusturner/subscriptions", "organizations_url": "https://api.github.com/users/angusturner/orgs", "repos_url": "https://api.github.com/users/angusturner/repos", "events_url": "https://api.github.com/users/angusturner/events{/privacy}", "received_events_url": "https://api.github.com/users/angusturner/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-05T02:09:48Z", "updated_at": "2018-03-05T10:01:44Z", "closed_at": "2018-03-05T10:01:44Z", "author_association": "NONE", "body_html": "<p>Since upgrading to master, I am receiving the following error while trying to compute token-wise accuracy in a language model:</p>\n<pre><code>[with IndexType = unsigned int, Real = float, Dims = 3]: block: [14,0,0], thread: [222,0,0] Assertion `indexValue &gt;= 0 &amp;&amp; indexValue &lt; tensor.sizes[dim]` failed.\n/home/user/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/THCTensorScatterGather.cu:176: void THCudaTensor_scatterFillKernel(TensorInfo&lt;Real, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, Real, int, IndexType) [with IndexType = unsigned int, Real = float, Dims = 3]: block: [14,0,0], thread: [223,0,0] Assertion `indexValue &gt;= 0 &amp;&amp; indexValue &lt; tensor.sizes[dim]` failed.\nTHCudaCheck FAIL file=/home/panda/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/generated/../THCReduceAll.cuh line=339 error=59 : device-side assert triggered\n\nTraceback (most recent call last):\n  File \"train_model.py\", line 138, in &lt;module&gt;\n    train_model(config)\n  File \"train_model.py\", line 106, in train_model\n    loss_score, _ = worker.test(test_loader)\n  File \"/home/user/src/worker.py\", line 275, in test\n    accuracy = self.get_top_n(pred, targ, n=1)\n  File \"/home/user/src/abs_worker.py\", line 268, in get_top_n\n    nb_correct = (one_hot * n_hot).sum()\nRuntimeError: cuda runtime error (59) : device-side assert triggered at /home/user/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/generated/../THCReduceAll.cuh:339\n</code></pre>\n<p><code>one_hot</code> and <code>n_hot</code> are both <code>(batch, num_classes, length)</code> of type <code>Variable(torch.FloatTensor)</code>. This error has cropped up in an otherwise stable code-base after upgrading from PyTorch v0.3.0.</p>\n<p>System details:<br>\nOS: Ubuntu 16.0.4<br>\nPyTorch version: 0.4.0a0+55c64e5<br>\nHow you installed PyTorch (conda, pip, source): source<br>\nPython version: Python 3.6.1<br>\nCUDA/cuDNN version: CUDA release 9.0, V9.0.176 / CUDNN 7005<br>\nGPU models and configuration: 4x Nvidia M60<br>\nGCC version (if compiling from source): GCC 4.4.7</p>", "body_text": "Since upgrading to master, I am receiving the following error while trying to compute token-wise accuracy in a language model:\n[with IndexType = unsigned int, Real = float, Dims = 3]: block: [14,0,0], thread: [222,0,0] Assertion `indexValue >= 0 && indexValue < tensor.sizes[dim]` failed.\n/home/user/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/THCTensorScatterGather.cu:176: void THCudaTensor_scatterFillKernel(TensorInfo<Real, IndexType>, TensorInfo<long, IndexType>, Real, int, IndexType) [with IndexType = unsigned int, Real = float, Dims = 3]: block: [14,0,0], thread: [223,0,0] Assertion `indexValue >= 0 && indexValue < tensor.sizes[dim]` failed.\nTHCudaCheck FAIL file=/home/panda/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/generated/../THCReduceAll.cuh line=339 error=59 : device-side assert triggered\n\nTraceback (most recent call last):\n  File \"train_model.py\", line 138, in <module>\n    train_model(config)\n  File \"train_model.py\", line 106, in train_model\n    loss_score, _ = worker.test(test_loader)\n  File \"/home/user/src/worker.py\", line 275, in test\n    accuracy = self.get_top_n(pred, targ, n=1)\n  File \"/home/user/src/abs_worker.py\", line 268, in get_top_n\n    nb_correct = (one_hot * n_hot).sum()\nRuntimeError: cuda runtime error (59) : device-side assert triggered at /home/user/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/generated/../THCReduceAll.cuh:339\n\none_hot and n_hot are both (batch, num_classes, length) of type Variable(torch.FloatTensor). This error has cropped up in an otherwise stable code-base after upgrading from PyTorch v0.3.0.\nSystem details:\nOS: Ubuntu 16.0.4\nPyTorch version: 0.4.0a0+55c64e5\nHow you installed PyTorch (conda, pip, source): source\nPython version: Python 3.6.1\nCUDA/cuDNN version: CUDA release 9.0, V9.0.176 / CUDNN 7005\nGPU models and configuration: 4x Nvidia M60\nGCC version (if compiling from source): GCC 4.4.7", "body": "Since upgrading to master, I am receiving the following error while trying to compute token-wise accuracy in a language model:\r\n\r\n```\r\n[with IndexType = unsigned int, Real = float, Dims = 3]: block: [14,0,0], thread: [222,0,0] Assertion `indexValue >= 0 && indexValue < tensor.sizes[dim]` failed.\r\n/home/user/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/THCTensorScatterGather.cu:176: void THCudaTensor_scatterFillKernel(TensorInfo<Real, IndexType>, TensorInfo<long, IndexType>, Real, int, IndexType) [with IndexType = unsigned int, Real = float, Dims = 3]: block: [14,0,0], thread: [223,0,0] Assertion `indexValue >= 0 && indexValue < tensor.sizes[dim]` failed.\r\nTHCudaCheck FAIL file=/home/panda/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/generated/../THCReduceAll.cuh line=339 error=59 : device-side assert triggered\r\n\r\nTraceback (most recent call last):\r\n  File \"train_model.py\", line 138, in <module>\r\n    train_model(config)\r\n  File \"train_model.py\", line 106, in train_model\r\n    loss_score, _ = worker.test(test_loader)\r\n  File \"/home/user/src/worker.py\", line 275, in test\r\n    accuracy = self.get_top_n(pred, targ, n=1)\r\n  File \"/home/user/src/abs_worker.py\", line 268, in get_top_n\r\n    nb_correct = (one_hot * n_hot).sum()\r\nRuntimeError: cuda runtime error (59) : device-side assert triggered at /home/user/cuda-ubuntu-16.04-ec2/pytorch/aten/src/THC/generated/../THCReduceAll.cuh:339\r\n```\r\n\r\n`one_hot` and `n_hot` are both `(batch, num_classes, length)` of type `Variable(torch.FloatTensor)`. This error has cropped up in an otherwise stable code-base after upgrading from PyTorch v0.3.0.\r\n\r\nSystem details:\r\nOS: Ubuntu 16.0.4\r\nPyTorch version: 0.4.0a0+55c64e5\r\nHow you installed PyTorch (conda, pip, source): source\r\nPython version: Python 3.6.1\r\nCUDA/cuDNN version: CUDA release 9.0, V9.0.176 / CUDNN 7005\r\nGPU models and configuration: 4x Nvidia M60\r\nGCC version (if compiling from source): GCC 4.4.7"}