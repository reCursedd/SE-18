{"url": "https://api.github.com/repos/pytorch/pytorch/issues/818", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/818/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/818/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/818/events", "html_url": "https://github.com/pytorch/pytorch/issues/818", "id": 209382507, "node_id": "MDU6SXNzdWUyMDkzODI1MDc=", "number": 818, "title": "torch.mul does not reshape its output gradient", "user": {"login": "bpiwowar", "id": 423314, "node_id": "MDQ6VXNlcjQyMzMxNA==", "avatar_url": "https://avatars0.githubusercontent.com/u/423314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bpiwowar", "html_url": "https://github.com/bpiwowar", "followers_url": "https://api.github.com/users/bpiwowar/followers", "following_url": "https://api.github.com/users/bpiwowar/following{/other_user}", "gists_url": "https://api.github.com/users/bpiwowar/gists{/gist_id}", "starred_url": "https://api.github.com/users/bpiwowar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bpiwowar/subscriptions", "organizations_url": "https://api.github.com/users/bpiwowar/orgs", "repos_url": "https://api.github.com/users/bpiwowar/repos", "events_url": "https://api.github.com/users/bpiwowar/events{/privacy}", "received_events_url": "https://api.github.com/users/bpiwowar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}, {"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-02-22T08:21:41Z", "updated_at": "2017-02-26T19:36:39Z", "closed_at": "2017-02-26T19:36:39Z", "author_association": "NONE", "body_html": "<p>I think that there is a problem with torch.mul that does not reshape correctly its output gradient. In the code below, the first backward works, but the second does not.</p>\n<pre><code>import torch\nfrom torch.autograd import Variable\nfrom torch.nn import Linear\n\na = Variable(torch.randn(5, 12), requires_grad=True)\nb = Variable(torch.randn(5), requires_grad=True)\n\nl = torch.nn.Linear(12, 1)\n\n# Works\nc = (l.forward(a) * b).sum()\nc.backward()\n\n# RuntimeError: matrices expected, got 1D, 2D tensors at .../torch/lib/TH/generic/THTensorMath.c:857\nc = (b * l.forward(a)).sum()\nc.backward()\n</code></pre>", "body_text": "I think that there is a problem with torch.mul that does not reshape correctly its output gradient. In the code below, the first backward works, but the second does not.\nimport torch\nfrom torch.autograd import Variable\nfrom torch.nn import Linear\n\na = Variable(torch.randn(5, 12), requires_grad=True)\nb = Variable(torch.randn(5), requires_grad=True)\n\nl = torch.nn.Linear(12, 1)\n\n# Works\nc = (l.forward(a) * b).sum()\nc.backward()\n\n# RuntimeError: matrices expected, got 1D, 2D tensors at .../torch/lib/TH/generic/THTensorMath.c:857\nc = (b * l.forward(a)).sum()\nc.backward()", "body": "I think that there is a problem with torch.mul that does not reshape correctly its output gradient. In the code below, the first backward works, but the second does not.\r\n\r\n```\r\nimport torch\r\nfrom torch.autograd import Variable\r\nfrom torch.nn import Linear\r\n\r\na = Variable(torch.randn(5, 12), requires_grad=True)\r\nb = Variable(torch.randn(5), requires_grad=True)\r\n\r\nl = torch.nn.Linear(12, 1)\r\n\r\n# Works\r\nc = (l.forward(a) * b).sum()\r\nc.backward()\r\n\r\n# RuntimeError: matrices expected, got 1D, 2D tensors at .../torch/lib/TH/generic/THTensorMath.c:857\r\nc = (b * l.forward(a)).sum()\r\nc.backward()\r\n```"}