{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8686", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8686/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8686/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8686/events", "html_url": "https://github.com/pytorch/pytorch/issues/8686", "id": 334068807, "node_id": "MDU6SXNzdWUzMzQwNjg4MDc=", "number": 8686, "title": "Split (with sizes) doesn't work with 0 sizes", "user": {"login": "fmassa", "id": 9110200, "node_id": "MDQ6VXNlcjkxMTAyMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9110200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmassa", "html_url": "https://github.com/fmassa", "followers_url": "https://api.github.com/users/fmassa/followers", "following_url": "https://api.github.com/users/fmassa/following{/other_user}", "gists_url": "https://api.github.com/users/fmassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmassa/subscriptions", "organizations_url": "https://api.github.com/users/fmassa/orgs", "repos_url": "https://api.github.com/users/fmassa/repos", "events_url": "https://api.github.com/users/fmassa/events{/privacy}", "received_events_url": "https://api.github.com/users/fmassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}], "state": "closed", "locked": false, "assignee": {"login": "gchanan", "id": 3768583, "node_id": "MDQ6VXNlcjM3Njg1ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/3768583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gchanan", "html_url": "https://github.com/gchanan", "followers_url": "https://api.github.com/users/gchanan/followers", "following_url": "https://api.github.com/users/gchanan/following{/other_user}", "gists_url": "https://api.github.com/users/gchanan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gchanan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gchanan/subscriptions", "organizations_url": "https://api.github.com/users/gchanan/orgs", "repos_url": "https://api.github.com/users/gchanan/repos", "events_url": "https://api.github.com/users/gchanan/events{/privacy}", "received_events_url": "https://api.github.com/users/gchanan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gchanan", "id": 3768583, "node_id": "MDQ6VXNlcjM3Njg1ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/3768583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gchanan", "html_url": "https://github.com/gchanan", "followers_url": "https://api.github.com/users/gchanan/followers", "following_url": "https://api.github.com/users/gchanan/following{/other_user}", "gists_url": "https://api.github.com/users/gchanan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gchanan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gchanan/subscriptions", "organizations_url": "https://api.github.com/users/gchanan/orgs", "repos_url": "https://api.github.com/users/gchanan/repos", "events_url": "https://api.github.com/users/gchanan/events{/privacy}", "received_events_url": "https://api.github.com/users/gchanan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2018-06-20T13:08:04Z", "updated_at": "2018-08-16T14:52:29Z", "closed_at": "2018-08-16T14:52:28Z", "author_association": "MEMBER", "body_html": "<p>I'd expect that once we specify the sizes of the split, as long as they sum to the number of elements, they should work. But once we have zero in some of the split sizes, this doesn't hold anymore.</p>\n<p>The following snippet illustrates the problem</p>\n<div class=\"highlight highlight-source-python\"><pre>a <span class=\"pl-k\">=</span> torch.rand(<span class=\"pl-c1\">10</span>)\n<span class=\"pl-c1\">print</span>(a.split([<span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">5</span>]))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> works</span>\n\n<span class=\"pl-c1\">print</span>(a.split([<span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">0</span>])  <span class=\"pl-c\"><span class=\"pl-c\">#</span> fails with</span>\n<span class=\"pl-c1\">RuntimeError</span>: split_with_sizes expects split_sizes to <span class=\"pl-c1\">sum</span> exactly to <span class=\"pl-c1\">10</span> (<span class=\"pl-c1\">input</span> tensor<span class=\"pl-s\"><span class=\"pl-pds\">'</span>s size at dimension 0), but got split_sizes=[5, 5, 0, 0]<span class=\"pl-ii\"></span></span>\n\n<span class=\"pl-c1\">print</span>(a.split([<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">5</span>])  <span class=\"pl-c\"><span class=\"pl-c\">#</span> fails with</span>\n<span class=\"pl-c1\">RuntimeError</span>: length out of <span class=\"pl-c1\">range</span></pre></div>\n<p>The first error happens because of <a href=\"https://github.com/pytorch/pytorch/blob/master/aten/src/ATen/native/TensorShape.cpp#L366\">this early break</a>, and the second error because <code>narrow</code> doesn't support <code>len=0</code> yet (but I believe support for this is coming very soon).</p>\n<p>I'm using PyTorch <code>'0.5.0a0+db5bc71'</code></p>", "body_text": "I'd expect that once we specify the sizes of the split, as long as they sum to the number of elements, they should work. But once we have zero in some of the split sizes, this doesn't hold anymore.\nThe following snippet illustrates the problem\na = torch.rand(10)\nprint(a.split([5, 5]))  # works\n\nprint(a.split([5, 5, 0])  # fails with\nRuntimeError: split_with_sizes expects split_sizes to sum exactly to 10 (input tensor's size at dimension 0), but got split_sizes=[5, 5, 0, 0]\n\nprint(a.split([0, 5, 5])  # fails with\nRuntimeError: length out of range\nThe first error happens because of this early break, and the second error because narrow doesn't support len=0 yet (but I believe support for this is coming very soon).\nI'm using PyTorch '0.5.0a0+db5bc71'", "body": "I'd expect that once we specify the sizes of the split, as long as they sum to the number of elements, they should work. But once we have zero in some of the split sizes, this doesn't hold anymore.\r\n\r\nThe following snippet illustrates the problem\r\n```python\r\na = torch.rand(10)\r\nprint(a.split([5, 5]))  # works\r\n\r\nprint(a.split([5, 5, 0])  # fails with\r\nRuntimeError: split_with_sizes expects split_sizes to sum exactly to 10 (input tensor's size at dimension 0), but got split_sizes=[5, 5, 0, 0]\r\n\r\nprint(a.split([0, 5, 5])  # fails with\r\nRuntimeError: length out of range\r\n```\r\n\r\nThe first error happens because of [this early break](https://github.com/pytorch/pytorch/blob/master/aten/src/ATen/native/TensorShape.cpp#L366), and the second error because `narrow` doesn't support `len=0` yet (but I believe support for this is coming very soon).\r\n\r\nI'm using PyTorch `'0.5.0a0+db5bc71'`"}