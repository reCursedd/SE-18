{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9649", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9649/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9649/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9649/events", "html_url": "https://github.com/pytorch/pytorch/issues/9649", "id": 343214944, "node_id": "MDU6SXNzdWUzNDMyMTQ5NDQ=", "number": 9649, "title": "Unable to load nngraph-built Lua Torch models in PyTorch, even with unknown_classes=True flag", "user": {"login": "Amir-Arsalan", "id": 6061721, "node_id": "MDQ6VXNlcjYwNjE3MjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/6061721?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amir-Arsalan", "html_url": "https://github.com/Amir-Arsalan", "followers_url": "https://api.github.com/users/Amir-Arsalan/followers", "following_url": "https://api.github.com/users/Amir-Arsalan/following{/other_user}", "gists_url": "https://api.github.com/users/Amir-Arsalan/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amir-Arsalan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amir-Arsalan/subscriptions", "organizations_url": "https://api.github.com/users/Amir-Arsalan/orgs", "repos_url": "https://api.github.com/users/Amir-Arsalan/repos", "events_url": "https://api.github.com/users/Amir-Arsalan/events{/privacy}", "received_events_url": "https://api.github.com/users/Amir-Arsalan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-07-20T19:00:15Z", "updated_at": "2018-10-15T01:46:08Z", "closed_at": "2018-07-20T19:05:38Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I am trying to convert/load a model I built and trained some time ago using Lua Torch's nngraph in PyTorch but I get the following error:</p>\n<p><code>torch.utils.serialization.read_lua_file.T7ReaderException: don't know how to deserialize Lua class nn.gModule. If you want to ignore this error and load this object as a dict, specify unknown_classes=True in reader's constructor</code></p>\n<p>So I made an instance of the <code>T7Reader</code> class and set <code>unknown_classes=True</code> and called the <code>.read()</code> function but I get the following error:</p>\n<pre><code>with open('trainedModel/model.t7', 'rb') as f:\n     reader = torch.utils.serialization.read_lua_file.T7Reader(f, unknown_classes=True)\n     model = reader.read()\n\n\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 3, in &lt;module&gt;\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 546, in read_object\n    return reader_registry[cls_name](self, version)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 243, in read_nn_class\n    attributes = reader.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 571, in read_table\n    k = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 571, in read_table\n    k = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 591, in read\n    return self.read_function()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 532, in read_function\n    upvalues = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 579, in read\n    typeidx = self.read_int()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 475, in read_int\n    return self._read('i')\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 466, in _read\n    result = struct.unpack(fmt, self.f.read(sz))\nstruct.error: unpack requires a bytes object of length 4\n</code></pre>\n<p>Why am I not able to load the model and get these errors? Does PyTorch support importing Lua Torch models built by nngraph?</p>", "body_text": "I am trying to convert/load a model I built and trained some time ago using Lua Torch's nngraph in PyTorch but I get the following error:\ntorch.utils.serialization.read_lua_file.T7ReaderException: don't know how to deserialize Lua class nn.gModule. If you want to ignore this error and load this object as a dict, specify unknown_classes=True in reader's constructor\nSo I made an instance of the T7Reader class and set unknown_classes=True and called the .read() function but I get the following error:\nwith open('trainedModel/model.t7', 'rb') as f:\n     reader = torch.utils.serialization.read_lua_file.T7Reader(f, unknown_classes=True)\n     model = reader.read()\n\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 3, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 546, in read_object\n    return reader_registry[cls_name](self, version)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 243, in read_nn_class\n    attributes = reader.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 571, in read_table\n    k = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\n    return self.read_object()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\n    return TorchObject(cls_name, self.read())\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\n    v = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\n    return self.read_table()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 571, in read_table\n    k = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 591, in read\n    return self.read_function()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\n    result = fn(self, *args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 532, in read_function\n    upvalues = self.read()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 579, in read\n    typeidx = self.read_int()\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 475, in read_int\n    return self._read('i')\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 466, in _read\n    result = struct.unpack(fmt, self.f.read(sz))\nstruct.error: unpack requires a bytes object of length 4\n\nWhy am I not able to load the model and get these errors? Does PyTorch support importing Lua Torch models built by nngraph?", "body": "I am trying to convert/load a model I built and trained some time ago using Lua Torch's nngraph in PyTorch but I get the following error:\r\n\r\n`torch.utils.serialization.read_lua_file.T7ReaderException: don't know how to deserialize Lua class nn.gModule. If you want to ignore this error and load this object as a dict, specify unknown_classes=True in reader's constructor`\r\n\r\nSo I made an instance of the `T7Reader` class and set `unknown_classes=True` and called the `.read()` function but I get the following error:\r\n\r\n```\r\nwith open('trainedModel/model.t7', 'rb') as f:\r\n     reader = torch.utils.serialization.read_lua_file.T7Reader(f, unknown_classes=True)\r\n     model = reader.read()\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 3, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\r\n    return self.read_object()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 546, in read_object\r\n    return reader_registry[cls_name](self, version)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 243, in read_nn_class\r\n    attributes = reader.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\r\n    return self.read_object()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\r\n    return TorchObject(cls_name, self.read())\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\r\n    return self.read_object()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\r\n    return TorchObject(cls_name, self.read())\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\r\n    return self.read_object()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\r\n    return TorchObject(cls_name, self.read())\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\r\n    return self.read_object()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\r\n    return TorchObject(cls_name, self.read())\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 571, in read_table\r\n    k = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 593, in read\r\n    return self.read_object()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 548, in read_object\r\n    return TorchObject(cls_name, self.read())\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 572, in read_table\r\n    v = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 595, in read\r\n    return self.read_table()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 571, in read_table\r\n    k = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 591, in read\r\n    return self.read_function()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 523, in wrapper\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 532, in read_function\r\n    upvalues = self.read()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 579, in read\r\n    typeidx = self.read_int()\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 475, in read_int\r\n    return self._read('i')\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/utils/serialization/read_lua_file.py\", line 466, in _read\r\n    result = struct.unpack(fmt, self.f.read(sz))\r\nstruct.error: unpack requires a bytes object of length 4\r\n```\r\n\r\nWhy am I not able to load the model and get these errors? Does PyTorch support importing Lua Torch models built by nngraph?"}