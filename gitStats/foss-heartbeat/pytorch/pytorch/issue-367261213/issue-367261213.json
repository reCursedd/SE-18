{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12373", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12373/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12373/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12373/events", "html_url": "https://github.com/pytorch/pytorch/issues/12373", "id": 367261213, "node_id": "MDU6SXNzdWUzNjcyNjEyMTM=", "number": 12373, "title": "Bug in torch.distributions.Beta", "user": {"login": "kulalexey", "id": 1076215, "node_id": "MDQ6VXNlcjEwNzYyMTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1076215?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kulalexey", "html_url": "https://github.com/kulalexey", "followers_url": "https://api.github.com/users/kulalexey/followers", "following_url": "https://api.github.com/users/kulalexey/following{/other_user}", "gists_url": "https://api.github.com/users/kulalexey/gists{/gist_id}", "starred_url": "https://api.github.com/users/kulalexey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kulalexey/subscriptions", "organizations_url": "https://api.github.com/users/kulalexey/orgs", "repos_url": "https://api.github.com/users/kulalexey/repos", "events_url": "https://api.github.com/users/kulalexey/events{/privacy}", "received_events_url": "https://api.github.com/users/kulalexey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 819357941, "node_id": "MDU6TGFiZWw4MTkzNTc5NDE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/distributions", "name": "distributions", "color": "39d651", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-05T15:29:45Z", "updated_at": "2018-10-17T18:35:16Z", "closed_at": "2018-10-17T18:35:16Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>For some alpha and beta parameters Beta distribution generates wrong samples (and sometime crash kernel)</p>\n<h2>To Reproduce</h2>\n<p>Following code generate samples with wrong distribution (cpu only). Sometimes generate 'nan's. Sometimes kernel die.</p>\n<pre><code>distr = torch.distributions.Beta(torch.tensor([1], dtype=torch.float32, device=torch.device('cpu')), torch.tensor([1], dtype=torch.float32, device=torch.device('cpu')))\ndata = distr.sample((100,))\n</code></pre>\n<p>alpha=beta=1e-2 generates samples with wrong distribution on both cpu and gpu.</p>\n<p>Following code often crash kernel:</p>\n<pre><code>distr = torch.distributions.Beta(torch.tensor([72], dtype=torch.float32, device=torch.device('cpu')), torch.tensor([15], dtype=torch.float32, device=torch.device('cpu')))\ndata = distr.sample((1000000,))\n</code></pre>\n<p>jupyter notebook with demonstration: <a href=\"https://gist.github.com/kulalexey/c12fea55a22a553ec8f2de7d369dae0f#file-beta-bug-ipynb\">https://gist.github.com/kulalexey/c12fea55a22a553ec8f2de7d369dae0f#file-beta-bug-ipynb</a></p>\n<h2>Expected behavior</h2>\n<p>For example for alpha=beta=1 distribution is a straight line</p>\n<h2>Environment</h2>\n<ul>\n<li>PyTorch Version (e.g., 1.0): 0.4.1</li>\n<li>OS (e.g., Linux): Windows-10-10.0.17134-SP0</li>\n<li>How you installed PyTorch (<code>conda</code>, <code>pip</code>, source): conda</li>\n<li>Build command you used (if compiling from source): install compiled binaries</li>\n<li>Python version: 3.6.1</li>\n<li>CUDA/cuDNN version: 9.0 / 7005</li>\n<li>GPU models and configuration: Titan V</li>\n<li>Any other relevant information:</li>\n</ul>", "body_text": "\ud83d\udc1b Bug\nFor some alpha and beta parameters Beta distribution generates wrong samples (and sometime crash kernel)\nTo Reproduce\nFollowing code generate samples with wrong distribution (cpu only). Sometimes generate 'nan's. Sometimes kernel die.\ndistr = torch.distributions.Beta(torch.tensor([1], dtype=torch.float32, device=torch.device('cpu')), torch.tensor([1], dtype=torch.float32, device=torch.device('cpu')))\ndata = distr.sample((100,))\n\nalpha=beta=1e-2 generates samples with wrong distribution on both cpu and gpu.\nFollowing code often crash kernel:\ndistr = torch.distributions.Beta(torch.tensor([72], dtype=torch.float32, device=torch.device('cpu')), torch.tensor([15], dtype=torch.float32, device=torch.device('cpu')))\ndata = distr.sample((1000000,))\n\njupyter notebook with demonstration: https://gist.github.com/kulalexey/c12fea55a22a553ec8f2de7d369dae0f#file-beta-bug-ipynb\nExpected behavior\nFor example for alpha=beta=1 distribution is a straight line\nEnvironment\n\nPyTorch Version (e.g., 1.0): 0.4.1\nOS (e.g., Linux): Windows-10-10.0.17134-SP0\nHow you installed PyTorch (conda, pip, source): conda\nBuild command you used (if compiling from source): install compiled binaries\nPython version: 3.6.1\nCUDA/cuDNN version: 9.0 / 7005\nGPU models and configuration: Titan V\nAny other relevant information:", "body": "## \ud83d\udc1b Bug\r\n\r\nFor some alpha and beta parameters Beta distribution generates wrong samples (and sometime crash kernel)\r\n\r\n## To Reproduce\r\n\r\nFollowing code generate samples with wrong distribution (cpu only). Sometimes generate 'nan's. Sometimes kernel die.\r\n```\r\ndistr = torch.distributions.Beta(torch.tensor([1], dtype=torch.float32, device=torch.device('cpu')), torch.tensor([1], dtype=torch.float32, device=torch.device('cpu')))\r\ndata = distr.sample((100,))\r\n```\r\n\r\nalpha=beta=1e-2 generates samples with wrong distribution on both cpu and gpu.\r\n\r\nFollowing code often crash kernel:\r\n```\r\ndistr = torch.distributions.Beta(torch.tensor([72], dtype=torch.float32, device=torch.device('cpu')), torch.tensor([15], dtype=torch.float32, device=torch.device('cpu')))\r\ndata = distr.sample((1000000,))\r\n```\r\n\r\njupyter notebook with demonstration: https://gist.github.com/kulalexey/c12fea55a22a553ec8f2de7d369dae0f#file-beta-bug-ipynb\r\n\r\n## Expected behavior\r\nFor example for alpha=beta=1 distribution is a straight line\r\n\r\n## Environment\r\n\r\n - PyTorch Version (e.g., 1.0): 0.4.1\r\n - OS (e.g., Linux): Windows-10-10.0.17134-SP0\r\n - How you installed PyTorch (`conda`, `pip`, source): conda\r\n - Build command you used (if compiling from source): install compiled binaries\r\n - Python version: 3.6.1\r\n - CUDA/cuDNN version: 9.0 / 7005\r\n - GPU models and configuration: Titan V\r\n - Any other relevant information:"}