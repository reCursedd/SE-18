{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11942", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11942/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11942/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11942/events", "html_url": "https://github.com/pytorch/pytorch/pull/11942", "id": 362718277, "node_id": "MDExOlB1bGxSZXF1ZXN0MjE3MzU4MTI2", "number": 11942, "title": "Use -O1 for sleef build in Debug mode", "user": {"login": "jamesr66a", "id": 4685384, "node_id": "MDQ6VXNlcjQ2ODUzODQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/4685384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamesr66a", "html_url": "https://github.com/jamesr66a", "followers_url": "https://api.github.com/users/jamesr66a/followers", "following_url": "https://api.github.com/users/jamesr66a/following{/other_user}", "gists_url": "https://api.github.com/users/jamesr66a/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamesr66a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamesr66a/subscriptions", "organizations_url": "https://api.github.com/users/jamesr66a/orgs", "repos_url": "https://api.github.com/users/jamesr66a/repos", "events_url": "https://api.github.com/users/jamesr66a/events{/privacy}", "received_events_url": "https://api.github.com/users/jamesr66a/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-21T17:58:20Z", "updated_at": "2018-09-21T20:26:17Z", "closed_at": "2018-09-21T20:26:17Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/pytorch/pytorch/pulls/11942", "html_url": "https://github.com/pytorch/pytorch/pull/11942", "diff_url": "https://github.com/pytorch/pytorch/pull/11942.diff", "patch_url": "https://github.com/pytorch/pytorch/pull/11942.patch"}, "body_html": "<p><code>-O0</code> is problematic for compiling sleef kernels since they consist of a bunch of vector intrinsics. In <code>-O0</code>, the compiler spills <em>every</em> intermediate value to the stack. In one example (TestEndToEndHybridFrontendModels.test_snli in test_jit.py) the function <code>Sleef_tanhf8_u10avx2</code> would spill 30kB of AVX registers onto the stack and run two orders of magnitude slower than in opt mode, causing the test to take minutes rather than seconds. I've verified that this behavior is not present with <code>-O1</code></p>", "body_text": "-O0 is problematic for compiling sleef kernels since they consist of a bunch of vector intrinsics. In -O0, the compiler spills every intermediate value to the stack. In one example (TestEndToEndHybridFrontendModels.test_snli in test_jit.py) the function Sleef_tanhf8_u10avx2 would spill 30kB of AVX registers onto the stack and run two orders of magnitude slower than in opt mode, causing the test to take minutes rather than seconds. I've verified that this behavior is not present with -O1", "body": "`-O0` is problematic for compiling sleef kernels since they consist of a bunch of vector intrinsics. In `-O0`, the compiler spills *every* intermediate value to the stack. In one example (TestEndToEndHybridFrontendModels.test_snli in test_jit.py) the function `Sleef_tanhf8_u10avx2` would spill 30kB of AVX registers onto the stack and run two orders of magnitude slower than in opt mode, causing the test to take minutes rather than seconds. I've verified that this behavior is not present with `-O1`"}