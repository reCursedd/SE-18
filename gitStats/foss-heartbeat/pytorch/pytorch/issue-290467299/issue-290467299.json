{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4778", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4778/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4778/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4778/events", "html_url": "https://github.com/pytorch/pytorch/issues/4778", "id": 290467299, "node_id": "MDU6SXNzdWUyOTA0NjcyOTk=", "number": 4778, "title": "squeeze on 1x1 tensor causes error in gradients while view(-1) doesn't", "user": {"login": "stefdoerr", "id": 7935362, "node_id": "MDQ6VXNlcjc5MzUzNjI=", "avatar_url": "https://avatars3.githubusercontent.com/u/7935362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefdoerr", "html_url": "https://github.com/stefdoerr", "followers_url": "https://api.github.com/users/stefdoerr/followers", "following_url": "https://api.github.com/users/stefdoerr/following{/other_user}", "gists_url": "https://api.github.com/users/stefdoerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefdoerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefdoerr/subscriptions", "organizations_url": "https://api.github.com/users/stefdoerr/orgs", "repos_url": "https://api.github.com/users/stefdoerr/repos", "events_url": "https://api.github.com/users/stefdoerr/events{/privacy}", "received_events_url": "https://api.github.com/users/stefdoerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-01-22T13:35:29Z", "updated_at": "2018-01-22T22:04:16Z", "closed_at": "2018-01-22T21:36:03Z", "author_association": "NONE", "body_html": "<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">from</span> torch.autograd <span class=\"pl-k\">import</span> grad, Variable\n\nw <span class=\"pl-k\">=</span> Variable(torch.ones([<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1</span>])).cuda()\nxyz <span class=\"pl-k\">=</span> Variable(torch.FloatTensor([[<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">1.3</span>, <span class=\"pl-c1\">2</span>], ]), <span class=\"pl-v\">requires_grad</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>).cuda()\nres <span class=\"pl-k\">=</span> torch.matmul(xyz, w)\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Works</span>\ntorch.autograd.grad(res.view(<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>), xyz, torch.ones_like(res.squeeze()), <span class=\"pl-v\">retain_graph</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Doesn't</span>\ntorch.autograd.grad(res.squeeze(), xyz, torch.ones_like(res.squeeze()), <span class=\"pl-v\">retain_graph</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)</pre></div>", "body_text": "import torch\nfrom torch.autograd import grad, Variable\n\nw = Variable(torch.ones([3, 1])).cuda()\nxyz = Variable(torch.FloatTensor([[0, 1.3, 2], ]), requires_grad=True).cuda()\nres = torch.matmul(xyz, w)\n\n# Works\ntorch.autograd.grad(res.view(-1), xyz, torch.ones_like(res.squeeze()), retain_graph=True)\n# Doesn't\ntorch.autograd.grad(res.squeeze(), xyz, torch.ones_like(res.squeeze()), retain_graph=True)", "body": "```python\r\nimport torch\r\nfrom torch.autograd import grad, Variable\r\n\r\nw = Variable(torch.ones([3, 1])).cuda()\r\nxyz = Variable(torch.FloatTensor([[0, 1.3, 2], ]), requires_grad=True).cuda()\r\nres = torch.matmul(xyz, w)\r\n\r\n# Works\r\ntorch.autograd.grad(res.view(-1), xyz, torch.ones_like(res.squeeze()), retain_graph=True)\r\n# Doesn't\r\ntorch.autograd.grad(res.squeeze(), xyz, torch.ones_like(res.squeeze()), retain_graph=True)\r\n```"}