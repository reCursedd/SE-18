{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/315475592", "html_url": "https://github.com/pytorch/pytorch/issues/524#issuecomment-315475592", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/524", "id": 315475592, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNTQ3NTU5Mg==", "user": {"login": "fjaragones", "id": 22979710, "node_id": "MDQ6VXNlcjIyOTc5NzEw", "avatar_url": "https://avatars1.githubusercontent.com/u/22979710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fjaragones", "html_url": "https://github.com/fjaragones", "followers_url": "https://api.github.com/users/fjaragones/followers", "following_url": "https://api.github.com/users/fjaragones/following{/other_user}", "gists_url": "https://api.github.com/users/fjaragones/gists{/gist_id}", "starred_url": "https://api.github.com/users/fjaragones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fjaragones/subscriptions", "organizations_url": "https://api.github.com/users/fjaragones/orgs", "repos_url": "https://api.github.com/users/fjaragones/repos", "events_url": "https://api.github.com/users/fjaragones/events{/privacy}", "received_events_url": "https://api.github.com/users/fjaragones/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-14T21:45:52Z", "updated_at": "2017-07-14T21:47:51Z", "author_association": "NONE", "body_html": "<p>Had the same error when running the code in fresh built Docker image (compiling from source).<br>\nGeForce GTX 950M<br>\ngpu is detected inside container, but pytorch example code produces error when working with cuda</p>\n<pre><code>\n$ nvidia-docker run --rm -ti --ipc=host ptbare\n\nroot@9f82cba71dad:/workspace# source activate pytorch-py35\n(pytorch-py35) root@9f82cba71dad:/workspace# python\nPython 3.5.2 |Continuum Analytics, Inc.| (default, Jul  2 2016, 17:53:06) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; from __future__ import print_function\n&gt;&gt;&gt; import torch\n&gt;&gt;&gt; if torch.cuda.is_available():\n...   print(\"OK\")\n... \nOK\n&gt;&gt;&gt; \n&gt;&gt;&gt; x = torch.rand(5, 3)\n&gt;&gt;&gt; y = torch.rand(5, 3)\n&gt;&gt;&gt; x+y\n\n 0.7594  0.4101  0.0759\n 1.0612  0.4475  0.1293\n 1.1452  1.2344  0.8142\n 1.7445  1.1804  1.2515\n 1.5162  1.5922  1.3437\n[torch.FloatTensor of size 5x3]\n\n&gt;&gt;&gt; x = x.cuda()\n&gt;&gt;&gt; y = y.cuda()\n&gt;&gt;&gt; x+y\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py\", line 293, in __add__\n    return self.add(other)\nRuntimeError: cuda runtime error (8) : invalid device function at /tmp/pip-on0rh4dz-build/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:247\n&gt;&gt;&gt; x\n\n 0.5495  0.0533  0.0517\n 0.9988  0.1758  0.0185\n 0.5467  0.3758  0.3547\n 0.8154  0.2422  0.4138\n 0.8291  0.7782  0.4513\n[torch.cuda.FloatTensor of size 5x3 (GPU 0)]\n\n&gt;&gt;&gt; y\n\n 0.2099  0.3569  0.0242\n 0.0624  0.2717  0.1108\n 0.5985  0.8586  0.4595\n 0.9291  0.9382  0.8377\n 0.6871  0.8140  0.8924\n[torch.cuda.FloatTensor of size 5x3 (GPU 0)]\n</code></pre>", "body_text": "Had the same error when running the code in fresh built Docker image (compiling from source).\nGeForce GTX 950M\ngpu is detected inside container, but pytorch example code produces error when working with cuda\n\n$ nvidia-docker run --rm -ti --ipc=host ptbare\n\nroot@9f82cba71dad:/workspace# source activate pytorch-py35\n(pytorch-py35) root@9f82cba71dad:/workspace# python\nPython 3.5.2 |Continuum Analytics, Inc.| (default, Jul  2 2016, 17:53:06) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> from __future__ import print_function\n>>> import torch\n>>> if torch.cuda.is_available():\n...   print(\"OK\")\n... \nOK\n>>> \n>>> x = torch.rand(5, 3)\n>>> y = torch.rand(5, 3)\n>>> x+y\n\n 0.7594  0.4101  0.0759\n 1.0612  0.4475  0.1293\n 1.1452  1.2344  0.8142\n 1.7445  1.1804  1.2515\n 1.5162  1.5922  1.3437\n[torch.FloatTensor of size 5x3]\n\n>>> x = x.cuda()\n>>> y = y.cuda()\n>>> x+y\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py\", line 293, in __add__\n    return self.add(other)\nRuntimeError: cuda runtime error (8) : invalid device function at /tmp/pip-on0rh4dz-build/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:247\n>>> x\n\n 0.5495  0.0533  0.0517\n 0.9988  0.1758  0.0185\n 0.5467  0.3758  0.3547\n 0.8154  0.2422  0.4138\n 0.8291  0.7782  0.4513\n[torch.cuda.FloatTensor of size 5x3 (GPU 0)]\n\n>>> y\n\n 0.2099  0.3569  0.0242\n 0.0624  0.2717  0.1108\n 0.5985  0.8586  0.4595\n 0.9291  0.9382  0.8377\n 0.6871  0.8140  0.8924\n[torch.cuda.FloatTensor of size 5x3 (GPU 0)]", "body": "Had the same error when running the code in fresh built Docker image (compiling from source).\r\nGeForce GTX 950M\r\ngpu is detected inside container, but pytorch example code produces error when working with cuda\r\n\r\n```\r\n\r\n$ nvidia-docker run --rm -ti --ipc=host ptbare\r\n\r\nroot@9f82cba71dad:/workspace# source activate pytorch-py35\r\n(pytorch-py35) root@9f82cba71dad:/workspace# python\r\nPython 3.5.2 |Continuum Analytics, Inc.| (default, Jul  2 2016, 17:53:06) \r\n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from __future__ import print_function\r\n>>> import torch\r\n>>> if torch.cuda.is_available():\r\n...   print(\"OK\")\r\n... \r\nOK\r\n>>> \r\n>>> x = torch.rand(5, 3)\r\n>>> y = torch.rand(5, 3)\r\n>>> x+y\r\n\r\n 0.7594  0.4101  0.0759\r\n 1.0612  0.4475  0.1293\r\n 1.1452  1.2344  0.8142\r\n 1.7445  1.1804  1.2515\r\n 1.5162  1.5922  1.3437\r\n[torch.FloatTensor of size 5x3]\r\n\r\n>>> x = x.cuda()\r\n>>> y = y.cuda()\r\n>>> x+y\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/opt/conda/envs/pytorch-py35/lib/python3.5/site-packages/torch/tensor.py\", line 293, in __add__\r\n    return self.add(other)\r\nRuntimeError: cuda runtime error (8) : invalid device function at /tmp/pip-on0rh4dz-build/torch/lib/THC/generated/../generic/THCTensorMathPointwise.cu:247\r\n>>> x\r\n\r\n 0.5495  0.0533  0.0517\r\n 0.9988  0.1758  0.0185\r\n 0.5467  0.3758  0.3547\r\n 0.8154  0.2422  0.4138\r\n 0.8291  0.7782  0.4513\r\n[torch.cuda.FloatTensor of size 5x3 (GPU 0)]\r\n\r\n>>> y\r\n\r\n 0.2099  0.3569  0.0242\r\n 0.0624  0.2717  0.1108\r\n 0.5985  0.8586  0.4595\r\n 0.9291  0.9382  0.8377\r\n 0.6871  0.8140  0.8924\r\n[torch.cuda.FloatTensor of size 5x3 (GPU 0)]\r\n```"}