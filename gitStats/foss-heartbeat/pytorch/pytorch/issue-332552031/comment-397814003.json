{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/397814003", "html_url": "https://github.com/pytorch/pytorch/issues/8508#issuecomment-397814003", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8508", "id": 397814003, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzgxNDAwMw==", "user": {"login": "vishwakftw", "id": 23639302, "node_id": "MDQ6VXNlcjIzNjM5MzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/23639302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vishwakftw", "html_url": "https://github.com/vishwakftw", "followers_url": "https://api.github.com/users/vishwakftw/followers", "following_url": "https://api.github.com/users/vishwakftw/following{/other_user}", "gists_url": "https://api.github.com/users/vishwakftw/gists{/gist_id}", "starred_url": "https://api.github.com/users/vishwakftw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vishwakftw/subscriptions", "organizations_url": "https://api.github.com/users/vishwakftw/orgs", "repos_url": "https://api.github.com/users/vishwakftw/repos", "events_url": "https://api.github.com/users/vishwakftw/events{/privacy}", "received_events_url": "https://api.github.com/users/vishwakftw/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-16T14:00:49Z", "updated_at": "2018-06-16T14:00:49Z", "author_association": "CONTRIBUTOR", "body_html": "<p>There needs to be two changes in the code:</p>\n<ol>\n<li>\n<p><code>bvec.size(-1)</code> to <code>bmat.size(-1)</code> in<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4/torch/distributions/multivariate_normal.py#L32\">pytorch/torch/distributions/multivariate_normal.py</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 32\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4\">302408e</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L32\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"32\"></td>\n          <td id=\"LC32\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> n <span class=\"pl-k\">=</span> bvec.size(<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>) </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n</li>\n<li>\n<p><code>*shape</code> to <code>shape</code> in<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4/torch/distributions/multivariate_normal.py#L173\">pytorch/torch/distributions/multivariate_normal.py</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 173\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4\">302408e</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L173\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"173\"></td>\n          <td id=\"LC173\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> eps <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.loc.new(<span class=\"pl-k\">*</span>shape).normal_() </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n</li>\n</ol>\n<p>The sample function works fine. The distributions test suite passes as well.</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> m <span class=\"pl-k\">=</span> torch.distributions.MultivariateNormal(torch.tensor(<span class=\"pl-c1\">0.1</span>), torch.tensor(<span class=\"pl-c1\">0.5</span>) <span class=\"pl-k\">*</span> torch.eye(<span class=\"pl-c1\">1</span>))\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> m.sample()\ntensor([<span class=\"pl-k\">-</span><span class=\"pl-c1\">0.2011</span>])</pre></div>", "body_text": "There needs to be two changes in the code:\n\n\nbvec.size(-1) to bmat.size(-1) in\n\n  \n    \n      pytorch/torch/distributions/multivariate_normal.py\n    \n    \n         Line 32\n      in\n      302408e\n    \n    \n    \n    \n\n        \n          \n           n = bvec.size(-1) \n        \n    \n  \n\n\n\n\n*shape to shape in\n\n  \n    \n      pytorch/torch/distributions/multivariate_normal.py\n    \n    \n         Line 173\n      in\n      302408e\n    \n    \n    \n    \n\n        \n          \n           eps = self.loc.new(*shape).normal_() \n        \n    \n  \n\n\n\n\nThe sample function works fine. The distributions test suite passes as well.\n>>> import torch\n>>> m = torch.distributions.MultivariateNormal(torch.tensor(0.1), torch.tensor(0.5) * torch.eye(1))\n>>> m.sample()\ntensor([-0.2011])", "body": "There needs to be two changes in the code:\r\n1. `bvec.size(-1)` to `bmat.size(-1)` in\r\nhttps://github.com/pytorch/pytorch/blob/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4/torch/distributions/multivariate_normal.py#L32\r\n\r\n2. `*shape` to `shape` in\r\nhttps://github.com/pytorch/pytorch/blob/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4/torch/distributions/multivariate_normal.py#L173\r\n\r\nThe sample function works fine. The distributions test suite passes as well.\r\n\r\n```python\r\n>>> import torch\r\n>>> m = torch.distributions.MultivariateNormal(torch.tensor(0.1), torch.tensor(0.5) * torch.eye(1))\r\n>>> m.sample()\r\ntensor([-0.2011])\r\n```"}