{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/397480134", "html_url": "https://github.com/pytorch/pytorch/issues/8508#issuecomment-397480134", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8508", "id": 397480134, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzQ4MDEzNA==", "user": {"login": "vishwakftw", "id": 23639302, "node_id": "MDQ6VXNlcjIzNjM5MzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/23639302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vishwakftw", "html_url": "https://github.com/vishwakftw", "followers_url": "https://api.github.com/users/vishwakftw/followers", "following_url": "https://api.github.com/users/vishwakftw/following{/other_user}", "gists_url": "https://api.github.com/users/vishwakftw/gists{/gist_id}", "starred_url": "https://api.github.com/users/vishwakftw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vishwakftw/subscriptions", "organizations_url": "https://api.github.com/users/vishwakftw/orgs", "repos_url": "https://api.github.com/users/vishwakftw/repos", "events_url": "https://api.github.com/users/vishwakftw/events{/privacy}", "received_events_url": "https://api.github.com/users/vishwakftw/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-15T00:42:50Z", "updated_at": "2018-06-15T00:45:40Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The error occurs due to the <code>_batch_mv</code> in the <code>rsample</code> method. When <code>loc</code> is a scalar, the <code>eps</code> is <code>tensor([])</code>, which seems to be causing an issue.</p>\n<p><div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/pytorch/pytorch/blob/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4/torch/distributions/multivariate_normal.py#L171-L174\">pytorch/torch/distributions/multivariate_normal.py</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n        Lines 171 to 174\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/pytorch/pytorch/commit/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4\">302408e</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L171\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"171\"></td>\n          <td id=\"LC171\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">rsample</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>, <span class=\"pl-smi\">sample_shape</span><span class=\"pl-k\">=</span>torch.Size()): </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L172\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"172\"></td>\n          <td id=\"LC172\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">     shape <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._extended_shape(sample_shape) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L173\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"173\"></td>\n          <td id=\"LC173\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">     eps <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.loc.new(<span class=\"pl-k\">*</span>shape).normal_() </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L174\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"174\"></td>\n          <td id=\"LC174\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>.loc <span class=\"pl-k\">+</span> _batch_mv(<span class=\"pl-c1\">self</span>.scale_tril, eps) </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p>cc: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=648532\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fritzo\">@fritzo</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4583066\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/apaszke\">@apaszke</a></p>", "body_text": "The error occurs due to the _batch_mv in the rsample method. When loc is a scalar, the eps is tensor([]), which seems to be causing an issue.\n\n  \n    \n      pytorch/torch/distributions/multivariate_normal.py\n    \n    \n        Lines 171 to 174\n      in\n      302408e\n    \n    \n    \n    \n\n        \n          \n           def rsample(self, sample_shape=torch.Size()): \n        \n\n        \n          \n               shape = self._extended_shape(sample_shape) \n        \n\n        \n          \n               eps = self.loc.new(*shape).normal_() \n        \n\n        \n          \n               return self.loc + _batch_mv(self.scale_tril, eps) \n        \n    \n  \n\n\ncc: @fritzo @apaszke", "body": "The error occurs due to the `_batch_mv` in the `rsample` method. When `loc` is a scalar, the `eps` is `tensor([])`, which seems to be causing an issue.\r\n\r\nhttps://github.com/pytorch/pytorch/blob/302408e6c225bdd0fe9c6af9108c95d10dfb6ce4/torch/distributions/multivariate_normal.py#L171-L174\r\n\r\ncc: @fritzo @apaszke "}