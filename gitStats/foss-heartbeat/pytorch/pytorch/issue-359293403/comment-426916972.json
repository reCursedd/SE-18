{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/426916972", "html_url": "https://github.com/pytorch/pytorch/pull/11563#issuecomment-426916972", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11563", "id": 426916972, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjkxNjk3Mg==", "user": {"login": "JerryShih", "id": 5842681, "node_id": "MDQ6VXNlcjU4NDI2ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5842681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JerryShih", "html_url": "https://github.com/JerryShih", "followers_url": "https://api.github.com/users/JerryShih/followers", "following_url": "https://api.github.com/users/JerryShih/following{/other_user}", "gists_url": "https://api.github.com/users/JerryShih/gists{/gist_id}", "starred_url": "https://api.github.com/users/JerryShih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JerryShih/subscriptions", "organizations_url": "https://api.github.com/users/JerryShih/orgs", "repos_url": "https://api.github.com/users/JerryShih/repos", "events_url": "https://api.github.com/users/JerryShih/events{/privacy}", "received_events_url": "https://api.github.com/users/JerryShih/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-04T07:41:09Z", "updated_at": "2018-10-04T07:41:09Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=13564\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ezyang\">@ezyang</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4063635\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yf225\">@yf225</a><br>\nFinally, I know the reason why pytorch-linux-xenial-py3-clang5-asan test is failed.<br>\nThe openmp library link pthread implicitly. And our gtest needs the pthread library. So, we might need to add the pthread in our gtest linking list.</p>\n<p>I try something like:<br>\ntarget_link_libraries(c10_utils_hip_test gtest_main ${CMAKE_THREAD_LIBS_INIT})<br>\nBut it's still not work for pytorch-linux-xenial-py3-clang5-asan which uses clang-5.0 and asan build flag. The \"CMAKE_THREAD_LIBS_INIT\" is empty in this case.<br>\nI could add the pthread explicitly for these gtests, but I will have another build failed for windows platform which doesn't have the libpthread.lib.</p>\n<p>Any suggestion for this problem?</p>", "body_text": "@ezyang @yf225\nFinally, I know the reason why pytorch-linux-xenial-py3-clang5-asan test is failed.\nThe openmp library link pthread implicitly. And our gtest needs the pthread library. So, we might need to add the pthread in our gtest linking list.\nI try something like:\ntarget_link_libraries(c10_utils_hip_test gtest_main ${CMAKE_THREAD_LIBS_INIT})\nBut it's still not work for pytorch-linux-xenial-py3-clang5-asan which uses clang-5.0 and asan build flag. The \"CMAKE_THREAD_LIBS_INIT\" is empty in this case.\nI could add the pthread explicitly for these gtests, but I will have another build failed for windows platform which doesn't have the libpthread.lib.\nAny suggestion for this problem?", "body": "@ezyang @yf225 \r\nFinally, I know the reason why pytorch-linux-xenial-py3-clang5-asan test is failed.\r\nThe openmp library link pthread implicitly. And our gtest needs the pthread library. So, we might need to add the pthread in our gtest linking list.\r\n\r\nI try something like:\r\ntarget_link_libraries(c10_utils_hip_test gtest_main ${CMAKE_THREAD_LIBS_INIT})\r\nBut it's still not work for pytorch-linux-xenial-py3-clang5-asan which uses clang-5.0 and asan build flag. The \"CMAKE_THREAD_LIBS_INIT\" is empty in this case.\r\nI could add the pthread explicitly for these gtests, but I will have another build failed for windows platform which doesn't have the libpthread.lib.\r\n\r\nAny suggestion for this problem?"}