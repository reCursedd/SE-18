{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5853", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5853/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5853/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5853/events", "html_url": "https://github.com/pytorch/pytorch/issues/5853", "id": 306174692, "node_id": "MDU6SXNzdWUzMDYxNzQ2OTI=", "number": 5853, "title": "[BUG] PyTorch does not support creating FP16 arrays from numpy.", "user": {"login": "ddkang", "id": 1894961, "node_id": "MDQ6VXNlcjE4OTQ5NjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/1894961?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ddkang", "html_url": "https://github.com/ddkang", "followers_url": "https://api.github.com/users/ddkang/followers", "following_url": "https://api.github.com/users/ddkang/following{/other_user}", "gists_url": "https://api.github.com/users/ddkang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ddkang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ddkang/subscriptions", "organizations_url": "https://api.github.com/users/ddkang/orgs", "repos_url": "https://api.github.com/users/ddkang/repos", "events_url": "https://api.github.com/users/ddkang/events{/privacy}", "received_events_url": "https://api.github.com/users/ddkang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-17T17:30:54Z", "updated_at": "2018-05-14T19:40:06Z", "closed_at": null, "author_association": "NONE", "body_html": "<ul>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: 0.3</li>\n<li>How you installed PyTorch (conda, pip, source): pip</li>\n<li>Python version: 3.5</li>\n<li>CUDA/cuDNN version: 9.0, 7.0.5</li>\n<li>GPU models and configuration: P100</li>\n<li>GCC version (if compiling from source): N/A, installed via pip</li>\n</ul>\n<p>I'm in a setting where my bottleneck is transferring data to the GPU, so I would like to send the data as FP16. However, the following script fails:</p>\n<pre><code>import numpy as np\nimport torch\n\ndata = np.zeros(100, dtype=np.float16)\ninp = torch.from_numpy(data)\ninp.cuda(async=True)\n</code></pre>\n<p>with the error <code>RuntimeError: can't convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8.</code></p>\n<p>RuntimeError: can't convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8.</p>", "body_text": "OS: Ubuntu 16.04\nPyTorch version: 0.3\nHow you installed PyTorch (conda, pip, source): pip\nPython version: 3.5\nCUDA/cuDNN version: 9.0, 7.0.5\nGPU models and configuration: P100\nGCC version (if compiling from source): N/A, installed via pip\n\nI'm in a setting where my bottleneck is transferring data to the GPU, so I would like to send the data as FP16. However, the following script fails:\nimport numpy as np\nimport torch\n\ndata = np.zeros(100, dtype=np.float16)\ninp = torch.from_numpy(data)\ninp.cuda(async=True)\n\nwith the error RuntimeError: can't convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8.\nRuntimeError: can't convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8.", "body": "- OS: Ubuntu 16.04\r\n- PyTorch version: 0.3\r\n- How you installed PyTorch (conda, pip, source): pip\r\n- Python version: 3.5\r\n- CUDA/cuDNN version: 9.0, 7.0.5\r\n- GPU models and configuration: P100\r\n- GCC version (if compiling from source): N/A, installed via pip\r\n\r\nI'm in a setting where my bottleneck is transferring data to the GPU, so I would like to send the data as FP16. However, the following script fails:\r\n```\r\nimport numpy as np\r\nimport torch\r\n\r\ndata = np.zeros(100, dtype=np.float16)\r\ninp = torch.from_numpy(data)\r\ninp.cuda(async=True)\r\n```\r\nwith the error `RuntimeError: can't convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8.`\r\n\r\nRuntimeError: can't convert a given np.ndarray to a tensor - it has an invalid type. The only supported types are: double, float, int64, int32, and uint8."}