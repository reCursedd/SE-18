{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/377593589", "html_url": "https://github.com/pytorch/pytorch/pull/4921#issuecomment-377593589", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/4921", "id": 377593589, "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzU5MzU4OQ==", "user": {"login": "teng-li", "id": 8120856, "node_id": "MDQ6VXNlcjgxMjA4NTY=", "avatar_url": "https://avatars2.githubusercontent.com/u/8120856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teng-li", "html_url": "https://github.com/teng-li", "followers_url": "https://api.github.com/users/teng-li/followers", "following_url": "https://api.github.com/users/teng-li/following{/other_user}", "gists_url": "https://api.github.com/users/teng-li/gists{/gist_id}", "starred_url": "https://api.github.com/users/teng-li/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teng-li/subscriptions", "organizations_url": "https://api.github.com/users/teng-li/orgs", "repos_url": "https://api.github.com/users/teng-li/repos", "events_url": "https://api.github.com/users/teng-li/events{/privacy}", "received_events_url": "https://api.github.com/users/teng-li/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-30T18:42:37Z", "updated_at": "2018-03-30T18:42:46Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7364402\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/cyang49\">@cyang49</a>  Yeah,  <code>CUDA_VISIBLE_DEVICES</code> is incompatible with CUDA IPCs, since each process only sees its own GPU, hence cannot even see others to use GPU Direct P2P. So please make sure that all processes that will use NCCL can see all the devices. Like Adam said, you can control which GPU the process is operating on by either using <code>torch.cuda.set_device()</code> or <code>with torch.cuda.device()</code></p>", "body_text": "@cyang49  Yeah,  CUDA_VISIBLE_DEVICES is incompatible with CUDA IPCs, since each process only sees its own GPU, hence cannot even see others to use GPU Direct P2P. So please make sure that all processes that will use NCCL can see all the devices. Like Adam said, you can control which GPU the process is operating on by either using torch.cuda.set_device() or with torch.cuda.device()", "body": "@cyang49  Yeah,  `CUDA_VISIBLE_DEVICES` is incompatible with CUDA IPCs, since each process only sees its own GPU, hence cannot even see others to use GPU Direct P2P. So please make sure that all processes that will use NCCL can see all the devices. Like Adam said, you can control which GPU the process is operating on by either using `torch.cuda.set_device()` or `with torch.cuda.device()`"}