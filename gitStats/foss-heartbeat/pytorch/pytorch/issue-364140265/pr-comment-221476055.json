{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/221476055", "pull_request_review_id": 160131216, "id": 221476055, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ3NjA1NQ==", "diff_hunk": "@@ -132,54 +130,54 @@ struct CAFFE2_API TensorOptions {\n   }\n \n   /// Returns the device of the `TensorOptions`.\n-  const Device& device() const noexcept {\n-    return device_;\n-  }\n+  Device device() const noexcept;\n+\n+  optional<Device> device_opt() const noexcept { return device_; }\n \n   /// Returns the device index of the `TensorOptions`.\n   int32_t device_index() const noexcept {\n-    return device_.index();\n+    return device().index();\n   }\n \n   /// Returns the dtype of the `TensorOptions`.\n-  ScalarType dtype() const noexcept {\n-    return dtype_;\n-  }\n+  ScalarType dtype() const noexcept;\n+\n+  optional<ScalarType> dtype_opt() const noexcept { return dtype_; }\n \n   /// Returns the layout of the `TensorOptions`.\n-  Layout layout() const noexcept {\n-    return layout_;\n-  }\n+  Layout layout() const noexcept;", "path": "aten/src/ATen/core/TensorOptions.h", "position": null, "original_position": 63, "commit_id": "21981725ed9e3cdaeb2381af8519c613e55f3641", "original_commit_id": "f9b439b6ecb9c8d1e4a1fa86ef700469b87356ec", "user": {"login": "goldsborough", "id": 6429851, "node_id": "MDQ6VXNlcjY0Mjk4NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6429851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldsborough", "html_url": "https://github.com/goldsborough", "followers_url": "https://api.github.com/users/goldsborough/followers", "following_url": "https://api.github.com/users/goldsborough/following{/other_user}", "gists_url": "https://api.github.com/users/goldsborough/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldsborough/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldsborough/subscriptions", "organizations_url": "https://api.github.com/users/goldsborough/orgs", "repos_url": "https://api.github.com/users/goldsborough/repos", "events_url": "https://api.github.com/users/goldsborough/events{/privacy}", "received_events_url": "https://api.github.com/users/goldsborough/received_events", "type": "User", "site_admin": false}, "body": "I remember when I wrote this it was super high pri to have everything inline. People pushed back on me putting these methods in the .cpp file to fix the nvcc bug you're fixing. Just be aware of this. Also CC @colesbury ", "created_at": "2018-09-30T22:30:23Z", "updated_at": "2018-11-23T15:52:11Z", "html_url": "https://github.com/pytorch/pytorch/pull/12103#discussion_r221476055", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/12103", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/221476055"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/12103#discussion_r221476055"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/12103"}}, "body_html": "<p>I remember when I wrote this it was super high pri to have everything inline. People pushed back on me putting these methods in the .cpp file to fix the nvcc bug you're fixing. Just be aware of this. Also CC <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=655866\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/colesbury\">@colesbury</a></p>", "body_text": "I remember when I wrote this it was super high pri to have everything inline. People pushed back on me putting these methods in the .cpp file to fix the nvcc bug you're fixing. Just be aware of this. Also CC @colesbury"}