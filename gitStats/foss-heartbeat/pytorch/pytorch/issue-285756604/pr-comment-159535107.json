{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/159535107", "pull_request_review_id": 86500293, "id": 159535107, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE1OTUzNTEwNw==", "diff_hunk": "@@ -854,6 +856,22 @@ def test_cuda(self, test_case):\n                 for cpu_d_p, gpu_d_p in zip(cpu_param[1], gpu_param[1]):\n                     test_case.assertEqual(cpu_d_p, gpu_d_p, 2e-4)\n \n+            # Run double-backwards on CPU and GPU and compare results\n+            # TODO: BatchNorm double-backwards is currently broken, see\n+            # #4422; remove this when it is fixed.\n+            if self.check_gradgrad and not self.get_name().startswith('test_BatchNorm'):", "path": "test/common_nn.py", "position": null, "original_position": 23, "commit_id": "68f722716e809f358ee758bfce46249a1200ced1", "original_commit_id": "3514b4969e5a5cb5373846c99320d494037091fa", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "body": "So... would you like me to do this \"correctly\" or \"easily\"? It's not correct to put `check_gradgrad=False` in the batchnorm tests because that also disables the CPU double backward tests and those are passing on HEAD. So the correct thing is to add another variable to control this but then I decided it was too much work and added a special case (which I promise to remove...)", "created_at": "2018-01-03T21:41:39Z", "updated_at": "2018-11-23T15:37:49Z", "html_url": "https://github.com/pytorch/pytorch/pull/4460#discussion_r159535107", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/4460", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/159535107"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/4460#discussion_r159535107"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/4460"}}, "body_html": "<p>So... would you like me to do this \"correctly\" or \"easily\"? It's not correct to put <code>check_gradgrad=False</code> in the batchnorm tests because that also disables the CPU double backward tests and those are passing on HEAD. So the correct thing is to add another variable to control this but then I decided it was too much work and added a special case (which I promise to remove...)</p>", "body_text": "So... would you like me to do this \"correctly\" or \"easily\"? It's not correct to put check_gradgrad=False in the batchnorm tests because that also disables the CPU double backward tests and those are passing on HEAD. So the correct thing is to add another variable to control this but then I decided it was too much work and added a special case (which I promise to remove...)", "in_reply_to_id": 159523232}