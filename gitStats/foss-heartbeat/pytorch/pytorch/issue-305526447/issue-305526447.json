{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5808", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5808/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5808/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5808/events", "html_url": "https://github.com/pytorch/pytorch/issues/5808", "id": 305526447, "node_id": "MDU6SXNzdWUzMDU1MjY0NDc=", "number": 5808, "title": "Misleading message: \"RuntimeError: Input type (Variable) and weight type (Variable) should be the same\"", "user": {"login": "PiotrCzapla", "id": 340180, "node_id": "MDQ6VXNlcjM0MDE4MA==", "avatar_url": "https://avatars1.githubusercontent.com/u/340180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PiotrCzapla", "html_url": "https://github.com/PiotrCzapla", "followers_url": "https://api.github.com/users/PiotrCzapla/followers", "following_url": "https://api.github.com/users/PiotrCzapla/following{/other_user}", "gists_url": "https://api.github.com/users/PiotrCzapla/gists{/gist_id}", "starred_url": "https://api.github.com/users/PiotrCzapla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PiotrCzapla/subscriptions", "organizations_url": "https://api.github.com/users/PiotrCzapla/orgs", "repos_url": "https://api.github.com/users/PiotrCzapla/repos", "events_url": "https://api.github.com/users/PiotrCzapla/events{/privacy}", "received_events_url": "https://api.github.com/users/PiotrCzapla/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-03-15T12:11:14Z", "updated_at": "2018-03-15T19:44:07Z", "closed_at": "2018-03-15T19:44:07Z", "author_association": "NONE", "body_html": "<p>It took me quite a while to figure out what this message means (it was my very first model):</p>\n<pre><code>RuntimeError: Input type (Variable) and weight type (Variable) should be the same\n</code></pre>\n<p>It appears when input variable is on GPU and weight is on CPU.  Here is a minimal code to replicate the error:</p>\n<pre><code>filters = torch.randn(8,4,3,3)\ninputs = torch.randn(1,4,5,5)\nF.conv2d(inputs.cuda(), filters, padding=1)\n</code></pre>\n<p>If one removes .cuda() everything starts to work fine.</p>\n<p>I wasn't able to find anything on google when I searched for the phrase above so I've thought It make sense to report it as an issue so that next person may have more luck. I'm leaving it open in case you want to improve the message, but I will understand if you close it. Either way is ok and should help other newbies.</p>\n<p>Environment details:</p>\n<ul>\n<li>PyTorch version: 0.4.0a0+cdd0feb,</li>\n<li>CUDA/cuDNN version: I've used .Dockerfile to compile it</li>\n</ul>", "body_text": "It took me quite a while to figure out what this message means (it was my very first model):\nRuntimeError: Input type (Variable) and weight type (Variable) should be the same\n\nIt appears when input variable is on GPU and weight is on CPU.  Here is a minimal code to replicate the error:\nfilters = torch.randn(8,4,3,3)\ninputs = torch.randn(1,4,5,5)\nF.conv2d(inputs.cuda(), filters, padding=1)\n\nIf one removes .cuda() everything starts to work fine.\nI wasn't able to find anything on google when I searched for the phrase above so I've thought It make sense to report it as an issue so that next person may have more luck. I'm leaving it open in case you want to improve the message, but I will understand if you close it. Either way is ok and should help other newbies.\nEnvironment details:\n\nPyTorch version: 0.4.0a0+cdd0feb,\nCUDA/cuDNN version: I've used .Dockerfile to compile it", "body": "It took me quite a while to figure out what this message means (it was my very first model):\r\n```\r\nRuntimeError: Input type (Variable) and weight type (Variable) should be the same\r\n```\r\nIt appears when input variable is on GPU and weight is on CPU.  Here is a minimal code to replicate the error:\r\n```\r\nfilters = torch.randn(8,4,3,3)\r\ninputs = torch.randn(1,4,5,5)\r\nF.conv2d(inputs.cuda(), filters, padding=1)\r\n```\r\nIf one removes .cuda() everything starts to work fine. \r\n\r\n\r\nI wasn't able to find anything on google when I searched for the phrase above so I've thought It make sense to report it as an issue so that next person may have more luck. I'm leaving it open in case you want to improve the message, but I will understand if you close it. Either way is ok and should help other newbies.\r\n\r\nEnvironment details:\r\n- PyTorch version: 0.4.0a0+cdd0feb,\r\n- CUDA/cuDNN version: I've used .Dockerfile to compile it"}