{"url": "https://api.github.com/repos/pytorch/pytorch/issues/4969", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/4969/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/4969/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/4969/events", "html_url": "https://github.com/pytorch/pytorch/issues/4969", "id": 293310047, "node_id": "MDU6SXNzdWUyOTMzMTAwNDc=", "number": 4969, "title": "Segmentation fault when loading data ", "user": {"login": "xuanqing94", "id": 8935605, "node_id": "MDQ6VXNlcjg5MzU2MDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8935605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xuanqing94", "html_url": "https://github.com/xuanqing94", "followers_url": "https://api.github.com/users/xuanqing94/followers", "following_url": "https://api.github.com/users/xuanqing94/following{/other_user}", "gists_url": "https://api.github.com/users/xuanqing94/gists{/gist_id}", "starred_url": "https://api.github.com/users/xuanqing94/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xuanqing94/subscriptions", "organizations_url": "https://api.github.com/users/xuanqing94/orgs", "repos_url": "https://api.github.com/users/xuanqing94/repos", "events_url": "https://api.github.com/users/xuanqing94/events{/privacy}", "received_events_url": "https://api.github.com/users/xuanqing94/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2018-01-31T21:01:43Z", "updated_at": "2018-10-03T23:01:48Z", "closed_at": "2018-01-31T23:21:54Z", "author_association": "NONE", "body_html": "<ul>\n<li>\n<p>OS: Ubuntu 16.04</p>\n</li>\n<li>\n<p>PyTorch version: source code@master</p>\n</li>\n<li>\n<p>How you installed PyTorch (conda, pip, source): source</p>\n</li>\n<li>\n<p>Python version: Python3.6@conda</p>\n</li>\n<li>\n<p>CUDA/cuDNN version: 9.0</p>\n</li>\n<li>\n<p>GPU models and configuration: 4x1080Ti</p>\n</li>\n<li>\n<p>GCC version (if compiling from source): gcc5.4</p>\n</li>\n<li>\n<p>A script to reproduce the bug. Please try to provide as minimal of a test case as possible.<br>\ndataloader(..., numworkers=2)<br>\nthen iterate over dataset</p>\n</li>\n<li>\n<p>Error messages and/or stack traces of the bug<br>\nFiles already downloaded and verified<br>\nFiles already downloaded and verified<br>\nERROR: Unexpected segmentation fault encountered in worker.<br>\nERROR: Unexpected segmentation fault encountered in worker.<br>\nTraceback (most recent call last):<br>\nFile \"./main.py\", line 445, in <br>\nmain()<br>\nFile \"./main.py\", line 426, in main<br>\ntrain_TR(dataloader, dataloader_test, net, loss_f, opt.lr, opt.radius, opt.max_inner, opt.epoch)<br>\nFile \"./main.py\", line 214, in train_TR<br>\nfor x, y in data_iter:<br>\nFile \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 275, in <strong>next</strong><br>\nidx, batch = self._get_batch()<br>\nFile \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 254, in _get_batch<br>\nreturn self.data_queue.get()<br>\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/queues.py\", line 335, in get<br>\nres = self._reader.recv_bytes()<br>\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 216, in recv_bytes<br>\nbuf = self._recv_bytes(maxlength)<br>\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 407, in _recv_bytes<br>\nbuf = self._recv(4)<br>\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 379, in _recv<br>\nchunk = read(handle, remaining)<br>\nFile \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 175, in handler<br>\n_error_if_any_worker_fails()<br>\nRuntimeError: DataLoader worker (pid 21010) is killed by signal: Segmentation fault.</p>\n</li>\n<li>\n<p>Context around what you are trying to do<br>\nNothing special, just loading data. When I set numworkers=0, then it works fine. I guess it is triggered by interprocess communication.</p>\n</li>\n</ul>", "body_text": "OS: Ubuntu 16.04\n\n\nPyTorch version: source code@master\n\n\nHow you installed PyTorch (conda, pip, source): source\n\n\nPython version: Python3.6@conda\n\n\nCUDA/cuDNN version: 9.0\n\n\nGPU models and configuration: 4x1080Ti\n\n\nGCC version (if compiling from source): gcc5.4\n\n\nA script to reproduce the bug. Please try to provide as minimal of a test case as possible.\ndataloader(..., numworkers=2)\nthen iterate over dataset\n\n\nError messages and/or stack traces of the bug\nFiles already downloaded and verified\nFiles already downloaded and verified\nERROR: Unexpected segmentation fault encountered in worker.\nERROR: Unexpected segmentation fault encountered in worker.\nTraceback (most recent call last):\nFile \"./main.py\", line 445, in \nmain()\nFile \"./main.py\", line 426, in main\ntrain_TR(dataloader, dataloader_test, net, loss_f, opt.lr, opt.radius, opt.max_inner, opt.epoch)\nFile \"./main.py\", line 214, in train_TR\nfor x, y in data_iter:\nFile \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 275, in next\nidx, batch = self._get_batch()\nFile \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 254, in _get_batch\nreturn self.data_queue.get()\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/queues.py\", line 335, in get\nres = self._reader.recv_bytes()\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 216, in recv_bytes\nbuf = self._recv_bytes(maxlength)\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 407, in _recv_bytes\nbuf = self._recv(4)\nFile \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 379, in _recv\nchunk = read(handle, remaining)\nFile \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 175, in handler\n_error_if_any_worker_fails()\nRuntimeError: DataLoader worker (pid 21010) is killed by signal: Segmentation fault.\n\n\nContext around what you are trying to do\nNothing special, just loading data. When I set numworkers=0, then it works fine. I guess it is triggered by interprocess communication.", "body": "- OS: Ubuntu 16.04\r\n- PyTorch version: source code@master\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Python version: Python3.6@conda\r\n- CUDA/cuDNN version: 9.0\r\n- GPU models and configuration: 4x1080Ti\r\n- GCC version (if compiling from source): gcc5.4\r\n\r\n- A script to reproduce the bug. Please try to provide as minimal of a test case as possible.\r\ndataloader(..., numworkers=2)\r\nthen iterate over dataset\r\n- Error messages and/or stack traces of the bug\r\nFiles already downloaded and verified\r\nFiles already downloaded and verified\r\nERROR: Unexpected segmentation fault encountered in worker.\r\nERROR: Unexpected segmentation fault encountered in worker.\r\nTraceback (most recent call last):\r\n  File \"./main.py\", line 445, in <module>\r\n    main()\r\n  File \"./main.py\", line 426, in main\r\n    train_TR(dataloader, dataloader_test, net, loss_f, opt.lr, opt.radius, opt.max_inner, opt.epoch)\r\n  File \"./main.py\", line 214, in train_TR\r\n    for x, y in data_iter:\r\n  File \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 275, in __next__\r\n    idx, batch = self._get_batch()\r\n  File \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 254, in _get_batch\r\n    return self.data_queue.get()\r\n  File \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/queues.py\", line 335, in get\r\n    res = self._reader.recv_bytes()\r\n  File \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 216, in recv_bytes\r\n    buf = self._recv_bytes(maxlength)\r\n  File \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 407, in _recv_bytes\r\n    buf = self._recv(4)\r\n  File \"/home/luinx/miniconda3/lib/python3.6/multiprocessing/connection.py\", line 379, in _recv\r\n    chunk = read(handle, remaining)\r\n  File \"/home/luinx/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 175, in handler\r\n    _error_if_any_worker_fails()\r\nRuntimeError: DataLoader worker (pid 21010) is killed by signal: Segmentation fault.\r\n\r\n- Context around what you are trying to do\r\nNothing special, just loading data. When I set numworkers=0, then it works fine. I guess it is triggered by interprocess communication.\r\n"}