{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5990", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5990/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5990/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5990/events", "html_url": "https://github.com/pytorch/pytorch/issues/5990", "id": 308327803, "node_id": "MDU6SXNzdWUzMDgzMjc4MDM=", "number": 5990, "title": "nn.Bilinear without bias broken", "user": {"login": "kdavis-mozilla", "id": 12054740, "node_id": "MDQ6VXNlcjEyMDU0NzQw", "avatar_url": "https://avatars3.githubusercontent.com/u/12054740?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kdavis-mozilla", "html_url": "https://github.com/kdavis-mozilla", "followers_url": "https://api.github.com/users/kdavis-mozilla/followers", "following_url": "https://api.github.com/users/kdavis-mozilla/following{/other_user}", "gists_url": "https://api.github.com/users/kdavis-mozilla/gists{/gist_id}", "starred_url": "https://api.github.com/users/kdavis-mozilla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kdavis-mozilla/subscriptions", "organizations_url": "https://api.github.com/users/kdavis-mozilla/orgs", "repos_url": "https://api.github.com/users/kdavis-mozilla/repos", "events_url": "https://api.github.com/users/kdavis-mozilla/events{/privacy}", "received_events_url": "https://api.github.com/users/kdavis-mozilla/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-25T07:04:35Z", "updated_at": "2018-03-27T21:05:05Z", "closed_at": "2018-03-27T21:05:05Z", "author_association": "NONE", "body_html": "<h2><strong>System Information</strong></h2>\n<ul>\n<li>OS: OS X 10.13.3</li>\n<li>PyTorch version: 0.4.0a0+f6274a4</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Python version: 3.6.4 (default, Jan  6 2018, 11:51:15)</li>\n<li>CUDA/cuDNN version: NA (On CPU)</li>\n<li>GPU models and configuration: NA (On CPU)</li>\n<li>GCC version (if compiling from source): Apple LLVM version 9.0.0 (clang-900.0.39.2)</li>\n</ul>\n<h2><strong>Issue Information</strong></h2>\n<p>I am trying to use <code>nn.Bilinear</code> without a bias, but doing so yields an error.</p>\n<p>To reproduce the error run</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">import</span> torch.nn <span class=\"pl-k\">as</span> nn\n\nm <span class=\"pl-k\">=</span> nn.Bilinear(<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">30</span>, <span class=\"pl-c1\">40</span>, <span class=\"pl-v\">bias</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">False</span>)\ninput1 <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">128</span>, <span class=\"pl-c1\">20</span>)\ninput2 <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">128</span>, <span class=\"pl-c1\">30</span>)\noutput <span class=\"pl-k\">=</span> m(input1, input2)</pre></div>\n<p>This yields the error</p>\n<div class=\"highlight highlight-source-shell\"><pre>(virtualenv) Kellys-MacBook-Pro:sprachspiel kdavis$ python test.py \nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>test.py<span class=\"pl-pds\">\"</span></span>, line 7, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    output = m(input1, input2)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/modules/module.py<span class=\"pl-pds\">\"</span></span>, line 371, <span class=\"pl-k\">in</span> __call__\n    result = self.forward(<span class=\"pl-k\">*</span>input, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/modules/linear.py<span class=\"pl-pds\">\"</span></span>, line 116, <span class=\"pl-k\">in</span> forward\n    <span class=\"pl-k\">return</span> F.bilinear(input1, input2, self.weight, self.bias)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line 1004, <span class=\"pl-k\">in</span> bilinear\n    <span class=\"pl-k\">return</span> torch._C._VariableFunctions.bilinear(input1, input2, weight, bias)\nRuntimeError: <span class=\"pl-en\">dim</span>() called on undefined Tensor</pre></div>\n<p>However, running</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch\n<span class=\"pl-k\">import</span> torch.nn <span class=\"pl-k\">as</span> nn\n\nm <span class=\"pl-k\">=</span> nn.Bilinear(<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">30</span>, <span class=\"pl-c1\">40</span>, <span class=\"pl-v\">bias</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\ninput1 <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">128</span>, <span class=\"pl-c1\">20</span>)\ninput2 <span class=\"pl-k\">=</span> torch.randn(<span class=\"pl-c1\">128</span>, <span class=\"pl-c1\">30</span>)\noutput <span class=\"pl-k\">=</span> m(input1, input2)</pre></div>\n<p>works fine.</p>", "body_text": "System Information\n\nOS: OS X 10.13.3\nPyTorch version: 0.4.0a0+f6274a4\nHow you installed PyTorch (conda, pip, source): source\nPython version: 3.6.4 (default, Jan  6 2018, 11:51:15)\nCUDA/cuDNN version: NA (On CPU)\nGPU models and configuration: NA (On CPU)\nGCC version (if compiling from source): Apple LLVM version 9.0.0 (clang-900.0.39.2)\n\nIssue Information\nI am trying to use nn.Bilinear without a bias, but doing so yields an error.\nTo reproduce the error run\nimport torch\nimport torch.nn as nn\n\nm = nn.Bilinear(20, 30, 40, bias=False)\ninput1 = torch.randn(128, 20)\ninput2 = torch.randn(128, 30)\noutput = m(input1, input2)\nThis yields the error\n(virtualenv) Kellys-MacBook-Pro:sprachspiel kdavis$ python test.py \nTraceback (most recent call last):\n  File \"test.py\", line 7, in <module>\n    output = m(input1, input2)\n  File \"/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 371, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/modules/linear.py\", line 116, in forward\n    return F.bilinear(input1, input2, self.weight, self.bias)\n  File \"/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/functional.py\", line 1004, in bilinear\n    return torch._C._VariableFunctions.bilinear(input1, input2, weight, bias)\nRuntimeError: dim() called on undefined Tensor\nHowever, running\nimport torch\nimport torch.nn as nn\n\nm = nn.Bilinear(20, 30, 40, bias=True)\ninput1 = torch.randn(128, 20)\ninput2 = torch.randn(128, 30)\noutput = m(input1, input2)\nworks fine.", "body": "**System Information**\r\n------\r\n\r\n- OS: OS X 10.13.3\r\n- PyTorch version: 0.4.0a0+f6274a4\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Python version: 3.6.4 (default, Jan  6 2018, 11:51:15)\r\n- CUDA/cuDNN version: NA (On CPU)\r\n- GPU models and configuration: NA (On CPU)\r\n- GCC version (if compiling from source): Apple LLVM version 9.0.0 (clang-900.0.39.2)\r\n\r\n\r\n**Issue Information**\r\n------\r\n\r\nI am trying to use `nn.Bilinear` without a bias, but doing so yields an error.\r\n\r\nTo reproduce the error run\r\n```python\r\nimport torch\r\nimport torch.nn as nn\r\n\r\nm = nn.Bilinear(20, 30, 40, bias=False)\r\ninput1 = torch.randn(128, 20)\r\ninput2 = torch.randn(128, 30)\r\noutput = m(input1, input2)\r\n```\r\n\r\nThis yields the error\r\n```bash\r\n(virtualenv) Kellys-MacBook-Pro:sprachspiel kdavis$ python test.py \r\nTraceback (most recent call last):\r\n  File \"test.py\", line 7, in <module>\r\n    output = m(input1, input2)\r\n  File \"/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 371, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/modules/linear.py\", line 116, in forward\r\n    return F.bilinear(input1, input2, self.weight, self.bias)\r\n  File \"/Users/kdavis/Code/mozilla/sprachspiel/virtualenv/lib/python3.6/site-packages/torch/nn/functional.py\", line 1004, in bilinear\r\n    return torch._C._VariableFunctions.bilinear(input1, input2, weight, bias)\r\nRuntimeError: dim() called on undefined Tensor\r\n```\r\n\r\nHowever, running \r\n```python\r\nimport torch\r\nimport torch.nn as nn\r\n\r\nm = nn.Bilinear(20, 30, 40, bias=True)\r\ninput1 = torch.randn(128, 20)\r\ninput2 = torch.randn(128, 30)\r\noutput = m(input1, input2)\r\n```\r\n\r\nworks fine.\r\n"}