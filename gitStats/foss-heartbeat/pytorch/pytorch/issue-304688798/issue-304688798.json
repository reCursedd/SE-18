{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5735", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5735/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5735/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5735/events", "html_url": "https://github.com/pytorch/pytorch/issues/5735", "id": 304688798, "node_id": "MDU6SXNzdWUzMDQ2ODg3OTg=", "number": 5735, "title": "Multi-GPU causes runtime error (element 0 of variables does not require grad <...>)", "user": {"login": "inoryy", "id": 195271, "node_id": "MDQ6VXNlcjE5NTI3MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/195271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inoryy", "html_url": "https://github.com/inoryy", "followers_url": "https://api.github.com/users/inoryy/followers", "following_url": "https://api.github.com/users/inoryy/following{/other_user}", "gists_url": "https://api.github.com/users/inoryy/gists{/gist_id}", "starred_url": "https://api.github.com/users/inoryy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inoryy/subscriptions", "organizations_url": "https://api.github.com/users/inoryy/orgs", "repos_url": "https://api.github.com/users/inoryy/repos", "events_url": "https://api.github.com/users/inoryy/events{/privacy}", "received_events_url": "https://api.github.com/users/inoryy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2018-03-13T09:36:38Z", "updated_at": "2018-03-28T18:50:35Z", "closed_at": "2018-03-19T22:21:21Z", "author_association": "NONE", "body_html": "<p>Whenever I attempt to run the code in multi-gpu setup I immediately get this error:</p>\n<p><code>RuntimeError: element 0 of variables does not require grad and does not have a grad_fn</code></p>\n<p>The error happens when I initiate <code>loss.backward()</code> and it's only specific to multi-gpu setup, as the code works fine on either GPU alone. Here's a snippet for context:</p>\n<div class=\"highlight highlight-source-python\"><pre>inputs <span class=\"pl-k\">=</span> Variable(inputs).cuda()\nmodel(inputs, labels)\nloss <span class=\"pl-k\">=</span> model.loss(inputs, labels)\nloss.backward() <span class=\"pl-c\"><span class=\"pl-c\">#</span> &lt;--- error here</span>\noptimizer.step()\noptimizer.zero_grad()</pre></div>\n<p>Environment details:</p>\n<ul>\n<li>OS: Ubuntu 17.10</li>\n<li>PyTorch version:  0.4.0a0+15cc24a</li>\n<li>How you installed PyTorch: source</li>\n<li>Python version: 3.6.4</li>\n<li>CUDA/cuDNN version: 9.0 / 7.0.5</li>\n<li>GPU models and configuration: 2x 1080 Ti (same model)</li>\n<li>GCC version: 4.8.5</li>\n</ul>", "body_text": "Whenever I attempt to run the code in multi-gpu setup I immediately get this error:\nRuntimeError: element 0 of variables does not require grad and does not have a grad_fn\nThe error happens when I initiate loss.backward() and it's only specific to multi-gpu setup, as the code works fine on either GPU alone. Here's a snippet for context:\ninputs = Variable(inputs).cuda()\nmodel(inputs, labels)\nloss = model.loss(inputs, labels)\nloss.backward() # <--- error here\noptimizer.step()\noptimizer.zero_grad()\nEnvironment details:\n\nOS: Ubuntu 17.10\nPyTorch version:  0.4.0a0+15cc24a\nHow you installed PyTorch: source\nPython version: 3.6.4\nCUDA/cuDNN version: 9.0 / 7.0.5\nGPU models and configuration: 2x 1080 Ti (same model)\nGCC version: 4.8.5", "body": "Whenever I attempt to run the code in multi-gpu setup I immediately get this error:  \r\n\r\n`RuntimeError: element 0 of variables does not require grad and does not have a grad_fn`  \r\n\r\n The error happens when I initiate `loss.backward()` and it's only specific to multi-gpu setup, as the code works fine on either GPU alone. Here's a snippet for context:\r\n\r\n```python\r\ninputs = Variable(inputs).cuda()\r\nmodel(inputs, labels)\r\nloss = model.loss(inputs, labels)\r\nloss.backward() # <--- error here\r\noptimizer.step()\r\noptimizer.zero_grad()\r\n```\r\n\r\nEnvironment details:\r\n\r\n- OS: Ubuntu 17.10\r\n- PyTorch version:  0.4.0a0+15cc24a\r\n- How you installed PyTorch: source\r\n- Python version: 3.6.4\r\n- CUDA/cuDNN version: 9.0 / 7.0.5\r\n- GPU models and configuration: 2x 1080 Ti (same model)\r\n- GCC version: 4.8.5\r\n\r\n"}