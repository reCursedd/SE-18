{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/420097967", "html_url": "https://github.com/pytorch/pytorch/issues/11157#issuecomment-420097967", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/11157", "id": 420097967, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDA5Nzk2Nw==", "user": {"login": "fritzo", "id": 648532, "node_id": "MDQ6VXNlcjY0ODUzMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/648532?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fritzo", "html_url": "https://github.com/fritzo", "followers_url": "https://api.github.com/users/fritzo/followers", "following_url": "https://api.github.com/users/fritzo/following{/other_user}", "gists_url": "https://api.github.com/users/fritzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/fritzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fritzo/subscriptions", "organizations_url": "https://api.github.com/users/fritzo/orgs", "repos_url": "https://api.github.com/users/fritzo/repos", "events_url": "https://api.github.com/users/fritzo/events{/privacy}", "received_events_url": "https://api.github.com/users/fritzo/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-10T23:47:25Z", "updated_at": "2018-09-10T23:47:47Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4583066\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/apaszke\">@apaszke</a> after setting <code>check_trace=False</code> the jitted function dies with a schema error</p>\n<div class=\"highlight highlight-source-python\"><pre>    <span class=\"pl-k\">def</span> <span class=\"pl-en\">forward</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>, <span class=\"pl-k\">*</span><span class=\"pl-smi\">args</span>, <span class=\"pl-k\">**</span><span class=\"pl-smi\">kwargs</span>):\n<span class=\"pl-k\">&gt;</span>       <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._get_method(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>forward<span class=\"pl-pds\">'</span></span>)(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\nE       <span class=\"pl-c1\">RuntimeError</span>:\nE\nE       Schema <span class=\"pl-k\">not</span> found <span class=\"pl-k\">for</span> node. File a bug report.\nE       Node: <span class=\"pl-k\">%</span><span class=\"pl-c1\">4</span> : Dynamic <span class=\"pl-k\">=</span> aten::einsum(<span class=\"pl-k\">%</span><span class=\"pl-c1\">2</span>, <span class=\"pl-k\">%</span><span class=\"pl-c1\">3</span>)\nE\nE       Input types:string, Dynamic[]\nE       candidates were:\nE       :\nE       <span class=\"pl-k\">/</span>Users<span class=\"pl-k\">/</span>fritzobermeyer<span class=\"pl-k\">/</span>pytorch<span class=\"pl-k\">-</span>dev<span class=\"pl-k\">/</span>torch<span class=\"pl-k\">/</span>functional.py(<span class=\"pl-c1\">240</span>): einsum\nE       <span class=\"pl-k\">/</span>Users<span class=\"pl-k\">/</span>fritzobermeyer<span class=\"pl-k\">/</span>pytorch<span class=\"pl-k\">-</span>dev<span class=\"pl-k\">/</span>test<span class=\"pl-k\">/</span>test_jit_einsum.py(<span class=\"pl-c1\">9</span>): fn</pre></div>\n<p>Here is my my code and test: <a href=\"https://github.com/probtorch/pytorch/pull/151/files\">https://github.com/probtorch/pytorch/pull/151/files</a><br>\nHere is the full error:</p>\n<details>\n```\n$ pytest -v test/test_jit_einsum.py\n======================================================= test session starts ========================================================\nplatform darwin -- Python 2.7.14, pytest-3.7.1, py-1.5.2, pluggy-0.7.1 -- /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/python\ncachedir: .pytest_cache\nbenchmark: 3.1.1 (defaults: timer=time.time disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /Users/fritzobermeyer/pytorch-dev, inifile:\nplugins: xdist-1.20.1, forked-0.2, benchmark-3.1.1, nbval-0.7\ncollected 1 item\n<p>test/test_jit_einsum.py::TestEinsum::test_jit FAILED                                                                         [100%]</p>\n<p>============================================================= FAILURES =============================================================<br>\n_______________________________________________________ TestEinsum.test_jit ________________________________________________________</p>\n<p>self = &lt;test_jit_einsum.TestEinsum testMethod=test_jit&gt;</p>\n<pre><code>def test_jit(self):\n\n    def fn(x, y):\n        return torch.einsum('i,j-&gt;ij', x, y)\n\n    jit_fn = torch.jit.trace(fn, (torch.ones(2), torch.ones(3)), check_trace=False)\n\n    x = torch.randn(2)\n    y = torch.randn(3)\n    expected = fn(x, y)\n</code></pre>\n<blockquote>\n<pre><code>  actual = jit_fn(x, y)\n</code></pre>\n</blockquote>\n<p>test/test_jit_einsum.py:16:</p>\n<hr>\n<p>torch/nn/modules/module.py:477: in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)</p>\n<hr>\n<p>self = fn(), args = (tensor([0.0461, 0.4024]), tensor([-1.0115,  0.2167, -0.6123])), kwargs = {}</p>\n<pre><code>def forward(self, *args, **kwargs):\n</code></pre>\n<blockquote>\n<pre><code>  return self._get_method('forward')(*args, **kwargs)\n</code></pre>\n</blockquote>\n<p>E       RuntimeError:<br>\nE<br>\nE       Schema not found for node. File a bug report.<br>\nE       Node: %4 : Dynamic = aten::einsum(%2, %3)<br>\nE<br>\nE       Input types:string, Dynamic[]<br>\nE       candidates were:<br>\nE       :<br>\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum<br>\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn<br>\nE       /Users/fritzobermeyer/pytorch-dev/torch/jit/<strong>init</strong>.py(501): trace<br>\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(11): test_jit<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(329): run<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(393): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/unittest.py(184): runtest<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(111): pytest_runtest_call<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(183): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(201): <strong>init</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(185): call_runtest_hook<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(161): call_and_report<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(81): runtestprotocol<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(66): pytest_runtest_protocol<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(236): pytest_runtestloop<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(215): _main<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(178): wrap_session<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(208): pytest_cmdline_main<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/config/<strong>init</strong>.py(64): main<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/pytest(11): <br>\nE       :<br>\nE       operation failed shape propagation:<br>\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum<br>\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn<br>\nE       /Users/fritzobermeyer/pytorch-dev/torch/jit/<strong>init</strong>.py(501): trace<br>\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(11): test_jit<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(329): run<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(393): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/unittest.py(184): runtest<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(111): pytest_runtest_call<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(183): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(201): <strong>init</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(185): call_runtest_hook<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(161): call_and_report<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(81): runtestprotocol<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(66): pytest_runtest_protocol<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(236): pytest_runtestloop<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(215): _main<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(178): wrap_session<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(208): pytest_cmdline_main<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): <strong>call</strong><br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/config/<strong>init</strong>.py(64): main<br>\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/pytest(11): </p>\n<p>torch/jit/<strong>init</strong>.py:1074: RuntimeError<br>\n===================================================== 1 failed in 0.55 seconds =====================================================</p>\n<pre><code>&lt;/details&gt;\n</code></pre></details>", "body_text": "@apaszke after setting check_trace=False the jitted function dies with a schema error\n    def forward(self, *args, **kwargs):\n>       return self._get_method('forward')(*args, **kwargs)\nE       RuntimeError:\nE\nE       Schema not found for node. File a bug report.\nE       Node: %4 : Dynamic = aten::einsum(%2, %3)\nE\nE       Input types:string, Dynamic[]\nE       candidates were:\nE       :\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn\nHere is my my code and test: https://github.com/probtorch/pytorch/pull/151/files\nHere is the full error:\n\n```\n$ pytest -v test/test_jit_einsum.py\n======================================================= test session starts ========================================================\nplatform darwin -- Python 2.7.14, pytest-3.7.1, py-1.5.2, pluggy-0.7.1 -- /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/python\ncachedir: .pytest_cache\nbenchmark: 3.1.1 (defaults: timer=time.time disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /Users/fritzobermeyer/pytorch-dev, inifile:\nplugins: xdist-1.20.1, forked-0.2, benchmark-3.1.1, nbval-0.7\ncollected 1 item\ntest/test_jit_einsum.py::TestEinsum::test_jit FAILED                                                                         [100%]\n============================================================= FAILURES =============================================================\n_______________________________________________________ TestEinsum.test_jit ________________________________________________________\nself = <test_jit_einsum.TestEinsum testMethod=test_jit>\ndef test_jit(self):\n\n    def fn(x, y):\n        return torch.einsum('i,j->ij', x, y)\n\n    jit_fn = torch.jit.trace(fn, (torch.ones(2), torch.ones(3)), check_trace=False)\n\n    x = torch.randn(2)\n    y = torch.randn(3)\n    expected = fn(x, y)\n\n\n  actual = jit_fn(x, y)\n\n\ntest/test_jit_einsum.py:16:\n\ntorch/nn/modules/module.py:477: in call\nresult = self.forward(*input, **kwargs)\n\nself = fn(), args = (tensor([0.0461, 0.4024]), tensor([-1.0115,  0.2167, -0.6123])), kwargs = {}\ndef forward(self, *args, **kwargs):\n\n\n  return self._get_method('forward')(*args, **kwargs)\n\n\nE       RuntimeError:\nE\nE       Schema not found for node. File a bug report.\nE       Node: %4 : Dynamic = aten::einsum(%2, %3)\nE\nE       Input types:string, Dynamic[]\nE       candidates were:\nE       :\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn\nE       /Users/fritzobermeyer/pytorch-dev/torch/jit/init.py(501): trace\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(11): test_jit\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(329): run\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(393): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/unittest.py(184): runtest\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(111): pytest_runtest_call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(183): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(201): init\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(185): call_runtest_hook\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(161): call_and_report\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(81): runtestprotocol\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(66): pytest_runtest_protocol\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(236): pytest_runtestloop\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(215): _main\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(178): wrap_session\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(208): pytest_cmdline_main\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/config/init.py(64): main\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/pytest(11): \nE       :\nE       operation failed shape propagation:\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn\nE       /Users/fritzobermeyer/pytorch-dev/torch/jit/init.py(501): trace\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(11): test_jit\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(329): run\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(393): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/unittest.py(184): runtest\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(111): pytest_runtest_call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(183): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(201): init\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(185): call_runtest_hook\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(161): call_and_report\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(81): runtestprotocol\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(66): pytest_runtest_protocol\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(236): pytest_runtestloop\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(215): _main\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(178): wrap_session\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(208): pytest_cmdline_main\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): \nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): call\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/config/init.py(64): main\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/pytest(11): \ntorch/jit/init.py:1074: RuntimeError\n===================================================== 1 failed in 0.55 seconds =====================================================\n</details>", "body": "@apaszke after setting `check_trace=False` the jitted function dies with a schema error\r\n```py\r\n    def forward(self, *args, **kwargs):\r\n>       return self._get_method('forward')(*args, **kwargs)\r\nE       RuntimeError:\r\nE\r\nE       Schema not found for node. File a bug report.\r\nE       Node: %4 : Dynamic = aten::einsum(%2, %3)\r\nE\r\nE       Input types:string, Dynamic[]\r\nE       candidates were:\r\nE       :\r\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum\r\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn\r\n```\r\nHere is my my code and test: https://github.com/probtorch/pytorch/pull/151/files\r\nHere is the full error:\r\n<details>\r\n```\r\n$ pytest -v test/test_jit_einsum.py\r\n======================================================= test session starts ========================================================\r\nplatform darwin -- Python 2.7.14, pytest-3.7.1, py-1.5.2, pluggy-0.7.1 -- /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/python\r\ncachedir: .pytest_cache\r\nbenchmark: 3.1.1 (defaults: timer=time.time disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\r\nrootdir: /Users/fritzobermeyer/pytorch-dev, inifile:\r\nplugins: xdist-1.20.1, forked-0.2, benchmark-3.1.1, nbval-0.7\r\ncollected 1 item\r\n\r\ntest/test_jit_einsum.py::TestEinsum::test_jit FAILED                                                                         [100%]\r\n\r\n============================================================= FAILURES =============================================================\r\n_______________________________________________________ TestEinsum.test_jit ________________________________________________________\r\n\r\nself = <test_jit_einsum.TestEinsum testMethod=test_jit>\r\n\r\n    def test_jit(self):\r\n\r\n        def fn(x, y):\r\n            return torch.einsum('i,j->ij', x, y)\r\n\r\n        jit_fn = torch.jit.trace(fn, (torch.ones(2), torch.ones(3)), check_trace=False)\r\n\r\n        x = torch.randn(2)\r\n        y = torch.randn(3)\r\n        expected = fn(x, y)\r\n>       actual = jit_fn(x, y)\r\n\r\ntest/test_jit_einsum.py:16:\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\ntorch/nn/modules/module.py:477: in __call__\r\n    result = self.forward(*input, **kwargs)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\nself = fn(), args = (tensor([0.0461, 0.4024]), tensor([-1.0115,  0.2167, -0.6123])), kwargs = {}\r\n\r\n    def forward(self, *args, **kwargs):\r\n>       return self._get_method('forward')(*args, **kwargs)\r\nE       RuntimeError:\r\nE\r\nE       Schema not found for node. File a bug report.\r\nE       Node: %4 : Dynamic = aten::einsum(%2, %3)\r\nE\r\nE       Input types:string, Dynamic[]\r\nE       candidates were:\r\nE       :\r\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum\r\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn\r\nE       /Users/fritzobermeyer/pytorch-dev/torch/jit/__init__.py(501): trace\r\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(11): test_jit\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(329): run\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(393): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/unittest.py(184): runtest\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(111): pytest_runtest_call\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(183): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(201): __init__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(185): call_runtest_hook\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(161): call_and_report\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(81): runtestprotocol\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(66): pytest_runtest_protocol\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(236): pytest_runtestloop\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(215): _main\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(178): wrap_session\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(208): pytest_cmdline_main\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/config/__init__.py(64): main\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/pytest(11): <module>\r\nE       :\r\nE       operation failed shape propagation:\r\nE       /Users/fritzobermeyer/pytorch-dev/torch/functional.py(240): einsum\r\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(9): fn\r\nE       /Users/fritzobermeyer/pytorch-dev/torch/jit/__init__.py(501): trace\r\nE       /Users/fritzobermeyer/pytorch-dev/test/test_jit_einsum.py(11): test_jit\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(329): run\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/unittest/case.py(393): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/unittest.py(184): runtest\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(111): pytest_runtest_call\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(183): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(201): __init__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(185): call_runtest_hook\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(161): call_and_report\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(81): runtestprotocol\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/runner.py(66): pytest_runtest_protocol\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(236): pytest_runtestloop\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(215): _main\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(178): wrap_session\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/main.py(208): pytest_cmdline_main\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/callers.py(180): _multicall\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(61): <lambda>\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/manager.py(67): _hookexec\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/pluggy/hooks.py(258): __call__\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/lib/python2.7/site-packages/_pytest/config/__init__.py(64): main\r\nE       /Users/fritzobermeyer/miniconda2/envs/pytorch-dev/bin/pytest(11): <module>\r\n\r\ntorch/jit/__init__.py:1074: RuntimeError\r\n===================================================== 1 failed in 0.55 seconds =====================================================\r\n```\r\n</details>"}