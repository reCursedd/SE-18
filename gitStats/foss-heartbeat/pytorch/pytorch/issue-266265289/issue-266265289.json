{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3153", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3153/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3153/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3153/events", "html_url": "https://github.com/pytorch/pytorch/issues/3153", "id": 266265289, "node_id": "MDU6SXNzdWUyNjYyNjUyODk=", "number": 3153, "title": "torch.cuda.manual_seed() assertion error without CUDA", "user": {"login": "christoph-conrads", "id": 22275833, "node_id": "MDQ6VXNlcjIyMjc1ODMz", "avatar_url": "https://avatars3.githubusercontent.com/u/22275833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/christoph-conrads", "html_url": "https://github.com/christoph-conrads", "followers_url": "https://api.github.com/users/christoph-conrads/followers", "following_url": "https://api.github.com/users/christoph-conrads/following{/other_user}", "gists_url": "https://api.github.com/users/christoph-conrads/gists{/gist_id}", "starred_url": "https://api.github.com/users/christoph-conrads/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/christoph-conrads/subscriptions", "organizations_url": "https://api.github.com/users/christoph-conrads/orgs", "repos_url": "https://api.github.com/users/christoph-conrads/repos", "events_url": "https://api.github.com/users/christoph-conrads/events{/privacy}", "received_events_url": "https://api.github.com/users/christoph-conrads/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-10-17T20:22:17Z", "updated_at": "2017-10-17T21:08:31Z", "closed_at": "2017-10-17T20:35:26Z", "author_association": "NONE", "body_html": "<p>According to the <a href=\"https://github.com/pytorch/pytorch/blob/6647475bc2ba906c452a21e3857571d4de6ecadc/torch/cuda/random.py#L62-L64\">PyTorch CUDA documentation</a>, <code>torch.cuda.manual_seed(seed)</code> and <code>torch.cuda.manual_seed_all(seed)</code> can be called even when CUDA is unavailable yet the following MWE stops with an assertion error on my computer without GPU:</p>\n<p>Code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"><span class=\"pl-c\">#</span>!/usr/bin/python</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> -*- coding: utf-8 -*-</span>\n\n<span class=\"pl-k\">from</span> <span class=\"pl-c1\">__future__</span> <span class=\"pl-k\">import</span> print_function\n<span class=\"pl-k\">import</span> torch.cuda\n\n<span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>CUDA available?<span class=\"pl-pds\">'</span></span>, torch.cuda.is_available())\n\ntorch.cuda.manual_seed(<span class=\"pl-c1\">1</span>)</pre></div>\n<p>Output:</p>\n<pre><code>christoph:/tmp$ python seed-crash.py \nCUDA available? False\nTraceback (most recent call last):\n  File \"seed-crash.py\", line 9, in &lt;module&gt;\n    torch.cuda.manual_seed(1)\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/random.py\", line 27, in manual_seed\n    _lazy_init()\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py\", line 84, in _lazy_init\n    _check_driver()\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py\", line 58, in _check_driver\n    http://www.nvidia.com/Download/index.aspx\"\"\")\nAssertionError: \nFound no NVIDIA driver on your system. Please check that you\nhave an NVIDIA GPU and installed a driver from\nhttp://www.nvidia.com/Download/index.aspx\n</code></pre>\n<p>I am using PyTorch py27ha262b23_4cu75 for Conda 4.3.29.</p>", "body_text": "According to the PyTorch CUDA documentation, torch.cuda.manual_seed(seed) and torch.cuda.manual_seed_all(seed) can be called even when CUDA is unavailable yet the following MWE stops with an assertion error on my computer without GPU:\nCode:\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\n\nfrom __future__ import print_function\nimport torch.cuda\n\nprint('CUDA available?', torch.cuda.is_available())\n\ntorch.cuda.manual_seed(1)\nOutput:\nchristoph:/tmp$ python seed-crash.py \nCUDA available? False\nTraceback (most recent call last):\n  File \"seed-crash.py\", line 9, in <module>\n    torch.cuda.manual_seed(1)\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/random.py\", line 27, in manual_seed\n    _lazy_init()\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py\", line 84, in _lazy_init\n    _check_driver()\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py\", line 58, in _check_driver\n    http://www.nvidia.com/Download/index.aspx\"\"\")\nAssertionError: \nFound no NVIDIA driver on your system. Please check that you\nhave an NVIDIA GPU and installed a driver from\nhttp://www.nvidia.com/Download/index.aspx\n\nI am using PyTorch py27ha262b23_4cu75 for Conda 4.3.29.", "body": "According to the [PyTorch CUDA documentation](https://github.com/pytorch/pytorch/blob/6647475bc2ba906c452a21e3857571d4de6ecadc/torch/cuda/random.py#L62-L64), `torch.cuda.manual_seed(seed)` and `torch.cuda.manual_seed_all(seed)` can be called even when CUDA is unavailable yet the following MWE stops with an assertion error on my computer without GPU:\r\n\r\nCode:\r\n```python\r\n#!/usr/bin/python\r\n# -*- coding: utf-8 -*-\r\n\r\nfrom __future__ import print_function\r\nimport torch.cuda\r\n\r\nprint('CUDA available?', torch.cuda.is_available())\r\n\r\ntorch.cuda.manual_seed(1)\r\n```\r\n\r\nOutput:\r\n```\r\nchristoph:/tmp$ python seed-crash.py \r\nCUDA available? False\r\nTraceback (most recent call last):\r\n  File \"seed-crash.py\", line 9, in <module>\r\n    torch.cuda.manual_seed(1)\r\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/random.py\", line 27, in manual_seed\r\n    _lazy_init()\r\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py\", line 84, in _lazy_init\r\n    _check_driver()\r\n  File \"/home/christoph/anaconda2/lib/python2.7/site-packages/torch/cuda/__init__.py\", line 58, in _check_driver\r\n    http://www.nvidia.com/Download/index.aspx\"\"\")\r\nAssertionError: \r\nFound no NVIDIA driver on your system. Please check that you\r\nhave an NVIDIA GPU and installed a driver from\r\nhttp://www.nvidia.com/Download/index.aspx\r\n```\r\n\r\nI am using PyTorch py27ha262b23_4cu75 for Conda 4.3.29."}