{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11056", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11056/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11056/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11056/events", "html_url": "https://github.com/pytorch/pytorch/issues/11056", "id": 355393977, "node_id": "MDU6SXNzdWUzNTUzOTM5Nzc=", "number": 11056, "title": "Impossible to build caffe2/pytorch (master/v0.4.1)", "user": {"login": "Luo-Liang", "id": 1490925, "node_id": "MDQ6VXNlcjE0OTA5MjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/1490925?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Luo-Liang", "html_url": "https://github.com/Luo-Liang", "followers_url": "https://api.github.com/users/Luo-Liang/followers", "following_url": "https://api.github.com/users/Luo-Liang/following{/other_user}", "gists_url": "https://api.github.com/users/Luo-Liang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Luo-Liang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Luo-Liang/subscriptions", "organizations_url": "https://api.github.com/users/Luo-Liang/orgs", "repos_url": "https://api.github.com/users/Luo-Liang/repos", "events_url": "https://api.github.com/users/Luo-Liang/events{/privacy}", "received_events_url": "https://api.github.com/users/Luo-Liang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-30T01:53:43Z", "updated_at": "2018-08-30T04:22:24Z", "closed_at": "2018-08-30T04:22:24Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>Cannot build caffe2/torch with<br>\nFULL_CAFFE2=1 python setup.py install</p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: both</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): FULL_CAFFE2=1 python setup.py install</li>\n<li>OS: Ubuntu 18.10 Cosmic Cuttlefish</li>\n<li>PyTorch version: -</li>\n<li>Python version: 3.6</li>\n<li>CUDA/cuDNN version: 9.2</li>\n<li>GPU models and configuration: Tesla M60</li>\n<li>GCC version (if compiling from source): gcc (Ubuntu 6.4.0-20ubuntu1) 6.4.0 20180814</li>\n<li>CMake version: cmake version 3.12.1</li>\n<li>Versions of any other relevant libraries: no</li>\n</ul>\n<p>The problem is I have to use 18.10 Ubuntu.<br>\nI cannot use CUDA 9.1/9.0 because Caffe2 force me to use &gt; GCC5 on Ubuntu &gt; 17.04, but CUDA requires gcc &lt;=5.</p>\n<p>Now I have CUDA 9.2 and Ubuntu 18.10</p>\n<h3>Now if I compile with GCC8,</h3>\n<h4>I get this from master branch:</h4>\n<p>/home/ubuntu/pytorch/caffe2/onnx/onnxifi_init.cc:14:64: error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019<br>\nonnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &amp;core);</p>\n<h4>If I compile branch v0.4.1, I get:</h4>\n<p>/usr/local/cuda/include/crt/host_config.h:119:2: error: #error -- unsupported GNU version! gcc versions later than 7 are not supported!</p>\n<h3>If I try GCC7,</h3>\n<h4>I get this from master branch:</h4>\n<p>error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019 for argument \u20183\u2019 to \u2018int onnxifi_load(uint32_t, const char*, const char*, onnxifi_library*)\u2019<br>\nonnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &amp;core);</p>\n<h4>I get this from v0.4.1 branch:</h4>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"<br>\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here</p>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: \"WITH_FD\" has already been declared in the current scope</p>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(35): error: invalid redeclaration of type name \"THMapAllocator\"<br>\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(35): here</p>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(85): error: invalid redeclaration of type name \"THRefcountedMapAllocatorArgCheck\"<br>\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(85): here</p>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(89): error: invalid redeclaration of type name \"THRefcountedMapAllocator\"<br>\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(89): here</p>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"<br>\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here</p>\n<h3>If I try GCC6,</h3>\n<h4>I get this from master branch:</h4>\n<p>/home/ubuntu/pytorch/caffe2/onnx/onnxifi_init.cc:14:69: error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019 for argument \u20183\u2019 to \u2018int onnxifi_load(uint32_t, const char*, const char*, onnxifi_library*)\u2019<br>\nonnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &amp;core);</p>\n<h4>I get this from v0.4.1 branch:</h4>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"<br>\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here</p>\n<p>/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: \"WITH_FD\" has already been declared in the current scope</p>\n<p>Please advice. This experience is very exhausting and disappointing.</p>", "body_text": "Issue description\nCannot build caffe2/torch with\nFULL_CAFFE2=1 python setup.py install\nSystem Info\n\nPyTorch or Caffe2: both\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): FULL_CAFFE2=1 python setup.py install\nOS: Ubuntu 18.10 Cosmic Cuttlefish\nPyTorch version: -\nPython version: 3.6\nCUDA/cuDNN version: 9.2\nGPU models and configuration: Tesla M60\nGCC version (if compiling from source): gcc (Ubuntu 6.4.0-20ubuntu1) 6.4.0 20180814\nCMake version: cmake version 3.12.1\nVersions of any other relevant libraries: no\n\nThe problem is I have to use 18.10 Ubuntu.\nI cannot use CUDA 9.1/9.0 because Caffe2 force me to use > GCC5 on Ubuntu > 17.04, but CUDA requires gcc <=5.\nNow I have CUDA 9.2 and Ubuntu 18.10\nNow if I compile with GCC8,\nI get this from master branch:\n/home/ubuntu/pytorch/caffe2/onnx/onnxifi_init.cc:14:64: error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019\nonnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &core);\nIf I compile branch v0.4.1, I get:\n/usr/local/cuda/include/crt/host_config.h:119:2: error: #error -- unsupported GNU version! gcc versions later than 7 are not supported!\nIf I try GCC7,\nI get this from master branch:\nerror: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019 for argument \u20183\u2019 to \u2018int onnxifi_load(uint32_t, const char*, const char*, onnxifi_library*)\u2019\nonnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &core);\nI get this from v0.4.1 branch:\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: \"WITH_FD\" has already been declared in the current scope\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(35): error: invalid redeclaration of type name \"THMapAllocator\"\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(35): here\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(85): error: invalid redeclaration of type name \"THRefcountedMapAllocatorArgCheck\"\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(85): here\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(89): error: invalid redeclaration of type name \"THRefcountedMapAllocator\"\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(89): here\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here\nIf I try GCC6,\nI get this from master branch:\n/home/ubuntu/pytorch/caffe2/onnx/onnxifi_init.cc:14:69: error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019 for argument \u20183\u2019 to \u2018int onnxifi_load(uint32_t, const char*, const char*, onnxifi_library*)\u2019\nonnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &core);\nI get this from v0.4.1 branch:\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: \"WITH_FD\" has already been declared in the current scope\nPlease advice. This experience is very exhausting and disappointing.", "body": "## Issue description\r\n\r\nCannot build caffe2/torch with\r\nFULL_CAFFE2=1 python setup.py install\r\n\r\n## System Info\r\n\r\n- PyTorch or Caffe2: both\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): FULL_CAFFE2=1 python setup.py install\r\n- OS: Ubuntu 18.10 Cosmic Cuttlefish\r\n- PyTorch version: - \r\n- Python version: 3.6\r\n- CUDA/cuDNN version: 9.2\r\n- GPU models and configuration: Tesla M60\r\n- GCC version (if compiling from source): gcc (Ubuntu 6.4.0-20ubuntu1) 6.4.0 20180814\r\n- CMake version: cmake version 3.12.1\r\n- Versions of any other relevant libraries: no\r\n\r\nThe problem is I have to use 18.10 Ubuntu. \r\nI cannot use CUDA 9.1/9.0 because Caffe2 force me to use > GCC5 on Ubuntu > 17.04, but CUDA requires gcc <=5.\r\n\r\nNow I have CUDA 9.2 and Ubuntu 18.10\r\n\r\n### Now if I compile with GCC8, \r\n#### I get this from master branch:\r\n\r\n/home/ubuntu/pytorch/caffe2/onnx/onnxifi_init.cc:14:64: error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019\r\n         onnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &core);\r\n\r\n#### If I compile branch v0.4.1, I get:\r\n\r\n/usr/local/cuda/include/crt/host_config.h:119:2: error: #error -- unsupported GNU version! gcc versions later than 7 are not supported!\r\n\r\n### If I try GCC7, \r\n#### I get this from master branch:\r\n error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019 for argument \u20183\u2019 to \u2018int onnxifi_load(uint32_t, const char*, const char*, onnxifi_library*)\u2019\r\n         onnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &core);\r\n\r\n\r\n#### I get this from v0.4.1 branch:\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"\r\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here\r\n\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: \"WITH_FD\" has already been declared in the current scope\r\n\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(35): error: invalid redeclaration of type name \"THMapAllocator\"\r\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(35): here\r\n\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(85): error: invalid redeclaration of type name \"THRefcountedMapAllocatorArgCheck\"\r\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(85): here\r\n\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(89): error: invalid redeclaration of type name \"THRefcountedMapAllocator\"\r\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(89): here\r\n\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"\r\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here\r\n\r\n### If I try GCC6, \r\n#### I get this from master branch:\r\n/home/ubuntu/pytorch/caffe2/onnx/onnxifi_init.cc:14:69: error: cannot convert \u2018onnxifi_library*\u2019 to \u2018const char*\u2019 for argument \u20183\u2019 to \u2018int onnxifi_load(uint32_t, const char*, const char*, onnxifi_library*)\u2019\r\n         onnxifi_load(ONNXIFI_LOADER_FLAG_VERSION_1_0, nullptr, &core);\r\n\r\n#### I get this from v0.4.1 branch:\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: invalid redefinition of enum \"WithFd\"\r\n/home/ubuntu/pytorch/aten/src/TH/THAllocator.h(33): here\r\n\r\n/home/ubuntu/pytorch/torch/lib/tmp_install/include/TH/THAllocator.h(33): error: \"WITH_FD\" has already been declared in the current scope\r\n\r\n\r\nPlease advice. This experience is very exhausting and disappointing.\r\n\r\n\r\n"}