{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1963", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1963/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1963/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1963/events", "html_url": "https://github.com/pytorch/pytorch/issues/1963", "id": 239991615, "node_id": "MDU6SXNzdWUyMzk5OTE2MTU=", "number": 1963, "title": "Potential Memory Leak in expand_as", "user": {"login": "zihangdai", "id": 3943442, "node_id": "MDQ6VXNlcjM5NDM0NDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/3943442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zihangdai", "html_url": "https://github.com/zihangdai", "followers_url": "https://api.github.com/users/zihangdai/followers", "following_url": "https://api.github.com/users/zihangdai/following{/other_user}", "gists_url": "https://api.github.com/users/zihangdai/gists{/gist_id}", "starred_url": "https://api.github.com/users/zihangdai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zihangdai/subscriptions", "organizations_url": "https://api.github.com/users/zihangdai/orgs", "repos_url": "https://api.github.com/users/zihangdai/repos", "events_url": "https://api.github.com/users/zihangdai/events{/privacy}", "received_events_url": "https://api.github.com/users/zihangdai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 424131847, "node_id": "MDU6TGFiZWw0MjQxMzE4NDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/bug", "name": "bug", "color": "b60205", "default": true}, {"id": 443484135, "node_id": "MDU6TGFiZWw0NDM0ODQxMzU=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/high%20priority", "name": "high priority", "color": "F22613", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-07-02T06:07:54Z", "updated_at": "2017-07-10T22:53:35Z", "closed_at": "2017-07-10T22:46:07Z", "author_association": "NONE", "body_html": "<p>I think I encountered a memory leak situation potentially due to <code>expand_as</code>. I create a <a href=\"https://gist.github.com/zihangdai/5d4b6fa96ce1366f5bc7268fee0d4e9f\">gist</a> to reproduce my observations.</p>\n<p>Basically, for three different (meaningless) models, once the <code>expand_as</code> function is used, the memory usage will keep increasing.</p>\n<p>To run the code, <code>python mem_leak_expand.py --run_expand --model_type [0,1,2]</code> where the <code>--run_expand</code> flag controls whether <code>expand_as</code> is used. Please run it long enough.</p>\n<p>I'm on Ubuntu 14.04 with python3.6. I tried two versions of pytorch, 0.1.12_2 and 0.1.12+da0fad8.</p>\n<p><strong>Side Note</strong>: Even without using <code>expand_as</code>, the memory usauge can also increase for a while, but it will finally stablize at a level. What's more, when <code>Conv2d</code> (i.e. <code>--model_type [1,2]</code>) is used, it can take very long before the memory usage stablizes. I'm not sure whether this is a problem or not.</p>", "body_text": "I think I encountered a memory leak situation potentially due to expand_as. I create a gist to reproduce my observations.\nBasically, for three different (meaningless) models, once the expand_as function is used, the memory usage will keep increasing.\nTo run the code, python mem_leak_expand.py --run_expand --model_type [0,1,2] where the --run_expand flag controls whether expand_as is used. Please run it long enough.\nI'm on Ubuntu 14.04 with python3.6. I tried two versions of pytorch, 0.1.12_2 and 0.1.12+da0fad8.\nSide Note: Even without using expand_as, the memory usauge can also increase for a while, but it will finally stablize at a level. What's more, when Conv2d (i.e. --model_type [1,2]) is used, it can take very long before the memory usage stablizes. I'm not sure whether this is a problem or not.", "body": "I think I encountered a memory leak situation potentially due to `expand_as`. I create a [gist](https://gist.github.com/zihangdai/5d4b6fa96ce1366f5bc7268fee0d4e9f) to reproduce my observations.\r\n\r\nBasically, for three different (meaningless) models, once the `expand_as` function is used, the memory usage will keep increasing. \r\n\r\nTo run the code, `python mem_leak_expand.py --run_expand --model_type [0,1,2]` where the `--run_expand` flag controls whether `expand_as` is used. Please run it long enough. \r\n\r\nI'm on Ubuntu 14.04 with python3.6. I tried two versions of pytorch, 0.1.12_2 and 0.1.12+da0fad8. \r\n\r\n**Side Note**: Even without using `expand_as`, the memory usauge can also increase for a while, but it will finally stablize at a level. What's more, when `Conv2d` (i.e. `--model_type [1,2]`) is used, it can take very long before the memory usage stablizes. I'm not sure whether this is a problem or not.\r\n"}