{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/291015875", "html_url": "https://github.com/pytorch/pytorch/issues/1171#issuecomment-291015875", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/1171", "id": 291015875, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MTAxNTg3NQ==", "user": {"login": "robintibor", "id": 1178948, "node_id": "MDQ6VXNlcjExNzg5NDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1178948?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robintibor", "html_url": "https://github.com/robintibor", "followers_url": "https://api.github.com/users/robintibor/followers", "following_url": "https://api.github.com/users/robintibor/following{/other_user}", "gists_url": "https://api.github.com/users/robintibor/gists{/gist_id}", "starred_url": "https://api.github.com/users/robintibor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robintibor/subscriptions", "organizations_url": "https://api.github.com/users/robintibor/orgs", "repos_url": "https://api.github.com/users/robintibor/repos", "events_url": "https://api.github.com/users/robintibor/events{/privacy}", "received_events_url": "https://api.github.com/users/robintibor/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-02T21:18:33Z", "updated_at": "2017-04-04T08:16:17Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1310570\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/soumith\">@soumith</a> Thanks for the hint, unfortunately this does not seem to solve the problem. Actually I had done the opposite, installed pytorch for cuda 7.5 but we already have cuda 8.0 installed (<em>Update from later edit: I apparently never did that :))</em>. I now uninstalled pytorch and reinstalled everything for cuda 8.0, however still end up with the same error message. However, as <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15841449\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ngimel\">@ngimel</a> hinted, theano and pytorch seem to be using different cudnn versions. So is there anything I could try to further diagnose the problem?</p>\n<pre><code>$ nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2016 NVIDIA Corporation\nBuilt on Wed_May__4_21:01:56_CDT_2016\nCuda compilation tools, release 8.0, V8.0.26\n</code></pre>\n<pre><code>$ python3.5 pytorch_cudnn.py \nFiles already downloaded and verified\nFiles already downloaded and verified\nCudnn version: 6020\nTraceback (most recent call last):\n  File \"pytorch_cudnn.py\", line 72, in &lt;module&gt;\n    outputs = net(inputs)\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"pytorch_cudnn.py\", line 39, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/conv.py\", line 237, in forward\n    self.padding, self.dilation, self.groups)\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/functional.py\", line 39, in conv2d\n    return f(input, weight, bias)\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\n</code></pre>\n<pre><code>$ python3.5 -c 'from theano.sandbox.cuda import dnn_version; print(dnn_version())'\nWARNING (theano.sandbox.cuda): The cuda backend is deprecated and will be removed in the next release (v0.10). Please switch to the gpuarray backend. You can get more information about how to switch at this URL:\nhttps://github.com/Theano/Theano/wiki/Converting-to-the-new-gpu-back-end%28gpuarray%29\n\nUsing gpu device 0: GeForce GTX TITAN Black (CNMeM is disabled, cuDNN 5005)\n(5005, 5005)\n</code></pre>\n<p>(I usually use an older version of theano (0.8.2) with python2.7 in case that matters)</p>\n<p>For reinstalling, these were my uninstallation and installation instructions (a bit complicated due to some proxy stuff):</p>\n<pre><code>$ pip3.5 uninstall torch\n$ rm ~/.local/lib/python3.5/site-packages/torchvision-0.1.8-py3.5.egg\n</code></pre>\n<pre><code>$ wget http://download.pytorch.org/whl/cu80/torch-0.1.11.post5-cp35-cp35m-linux_x86_64.whl\n$ pip3.5 install torch-0.1.11.post5-cp35-cp35m-linux_x86_64.whl --user\n$ git clone https://github.com/pytorch/vision.git\n$ cd vision\n$ python3.5 setup.py install --user\n</code></pre>\n<p>There were no error messages during these installations.</p>", "body_text": "@soumith Thanks for the hint, unfortunately this does not seem to solve the problem. Actually I had done the opposite, installed pytorch for cuda 7.5 but we already have cuda 8.0 installed (Update from later edit: I apparently never did that :)). I now uninstalled pytorch and reinstalled everything for cuda 8.0, however still end up with the same error message. However, as @ngimel hinted, theano and pytorch seem to be using different cudnn versions. So is there anything I could try to further diagnose the problem?\n$ nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2016 NVIDIA Corporation\nBuilt on Wed_May__4_21:01:56_CDT_2016\nCuda compilation tools, release 8.0, V8.0.26\n\n$ python3.5 pytorch_cudnn.py \nFiles already downloaded and verified\nFiles already downloaded and verified\nCudnn version: 6020\nTraceback (most recent call last):\n  File \"pytorch_cudnn.py\", line 72, in <module>\n    outputs = net(inputs)\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"pytorch_cudnn.py\", line 39, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/conv.py\", line 237, in forward\n    self.padding, self.dilation, self.groups)\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/functional.py\", line 39, in conv2d\n    return f(input, weight, bias)\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\n\n$ python3.5 -c 'from theano.sandbox.cuda import dnn_version; print(dnn_version())'\nWARNING (theano.sandbox.cuda): The cuda backend is deprecated and will be removed in the next release (v0.10). Please switch to the gpuarray backend. You can get more information about how to switch at this URL:\nhttps://github.com/Theano/Theano/wiki/Converting-to-the-new-gpu-back-end%28gpuarray%29\n\nUsing gpu device 0: GeForce GTX TITAN Black (CNMeM is disabled, cuDNN 5005)\n(5005, 5005)\n\n(I usually use an older version of theano (0.8.2) with python2.7 in case that matters)\nFor reinstalling, these were my uninstallation and installation instructions (a bit complicated due to some proxy stuff):\n$ pip3.5 uninstall torch\n$ rm ~/.local/lib/python3.5/site-packages/torchvision-0.1.8-py3.5.egg\n\n$ wget http://download.pytorch.org/whl/cu80/torch-0.1.11.post5-cp35-cp35m-linux_x86_64.whl\n$ pip3.5 install torch-0.1.11.post5-cp35-cp35m-linux_x86_64.whl --user\n$ git clone https://github.com/pytorch/vision.git\n$ cd vision\n$ python3.5 setup.py install --user\n\nThere were no error messages during these installations.", "body": "@soumith Thanks for the hint, unfortunately this does not seem to solve the problem. Actually I had done the opposite, installed pytorch for cuda 7.5 but we already have cuda 8.0 installed (_Update from later edit: I apparently never did that :))_. I now uninstalled pytorch and reinstalled everything for cuda 8.0, however still end up with the same error message. However, as @ngimel hinted, theano and pytorch seem to be using different cudnn versions. So is there anything I could try to further diagnose the problem?\r\n\r\n```\r\n$ nvcc --version\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2016 NVIDIA Corporation\r\nBuilt on Wed_May__4_21:01:56_CDT_2016\r\nCuda compilation tools, release 8.0, V8.0.26\r\n```\r\n\r\n```\r\n$ python3.5 pytorch_cudnn.py \r\nFiles already downloaded and verified\r\nFiles already downloaded and verified\r\nCudnn version: 6020\r\nTraceback (most recent call last):\r\n  File \"pytorch_cudnn.py\", line 72, in <module>\r\n    outputs = net(inputs)\r\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"pytorch_cudnn.py\", line 39, in forward\r\n    x = self.pool(F.relu(self.conv1(x)))\r\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/modules/conv.py\", line 237, in forward\r\n    self.padding, self.dilation, self.groups)\r\n  File \"/home/schirrmr/.local/lib/python3.5/site-packages/torch/nn/functional.py\", line 39, in conv2d\r\n    return f(input, weight, bias)\r\nRuntimeError: CUDNN_STATUS_NOT_INITIALIZED\r\n```\r\n\r\n```\r\n$ python3.5 -c 'from theano.sandbox.cuda import dnn_version; print(dnn_version())'\r\nWARNING (theano.sandbox.cuda): The cuda backend is deprecated and will be removed in the next release (v0.10). Please switch to the gpuarray backend. You can get more information about how to switch at this URL:\r\nhttps://github.com/Theano/Theano/wiki/Converting-to-the-new-gpu-back-end%28gpuarray%29\r\n\r\nUsing gpu device 0: GeForce GTX TITAN Black (CNMeM is disabled, cuDNN 5005)\r\n(5005, 5005)\r\n```\r\n(I usually use an older version of theano (0.8.2) with python2.7 in case that matters)\r\n\r\nFor reinstalling, these were my uninstallation and installation instructions (a bit complicated due to some proxy stuff):\r\n\r\n```\r\n$ pip3.5 uninstall torch\r\n$ rm ~/.local/lib/python3.5/site-packages/torchvision-0.1.8-py3.5.egg\r\n```\r\n\r\n```\r\n$ wget http://download.pytorch.org/whl/cu80/torch-0.1.11.post5-cp35-cp35m-linux_x86_64.whl\r\n$ pip3.5 install torch-0.1.11.post5-cp35-cp35m-linux_x86_64.whl --user\r\n$ git clone https://github.com/pytorch/vision.git\r\n$ cd vision\r\n$ python3.5 setup.py install --user\r\n```\r\n\r\nThere were no error messages during these installations.\r\n"}