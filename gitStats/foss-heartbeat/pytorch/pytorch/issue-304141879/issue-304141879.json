{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5696", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5696/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5696/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5696/events", "html_url": "https://github.com/pytorch/pytorch/issues/5696", "id": 304141879, "node_id": "MDU6SXNzdWUzMDQxNDE4Nzk=", "number": 5696, "title": "Incorrect error message when using nn.functional.convNd() and nn.functional.conv_transposeNd()", "user": {"login": "vishwakftw", "id": 23639302, "node_id": "MDQ6VXNlcjIzNjM5MzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/23639302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vishwakftw", "html_url": "https://github.com/vishwakftw", "followers_url": "https://api.github.com/users/vishwakftw/followers", "following_url": "https://api.github.com/users/vishwakftw/following{/other_user}", "gists_url": "https://api.github.com/users/vishwakftw/gists{/gist_id}", "starred_url": "https://api.github.com/users/vishwakftw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vishwakftw/subscriptions", "organizations_url": "https://api.github.com/users/vishwakftw/orgs", "repos_url": "https://api.github.com/users/vishwakftw/repos", "events_url": "https://api.github.com/users/vishwakftw/events{/privacy}", "received_events_url": "https://api.github.com/users/vishwakftw/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-11T09:00:12Z", "updated_at": "2018-03-12T07:47:29Z", "closed_at": "2018-03-12T07:47:29Z", "author_association": "CONTRIBUTOR", "body_html": "<ul>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: 0.3.0.post4</li>\n<li>How you installed PyTorch (conda, pip, source): pip</li>\n<li>Python version: 3.5.2</li>\n<li>CUDA/cuDNN version: CUDA 8</li>\n</ul>\n<p>The below script produces an incorrect error message (<code>torch.nn.functional.convNd</code>)</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">input</span> <span class=\"pl-k\">=</span> torch.autograd.Variable(torch.randn(<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>))\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> weight <span class=\"pl-k\">=</span> torch.autograd.Variable(torch.randn(<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">7</span>))\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.nn.functional.conv3d(<span class=\"pl-c1\">input</span>, weight)\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">126</span>, <span class=\"pl-k\">in</span> conv3d\n    <span class=\"pl-k\">return</span> f(<span class=\"pl-c1\">input</span>, weight, bias)\n<span class=\"pl-c1\">RuntimeError</span>: Expected <span class=\"pl-c1\">5</span><span class=\"pl-k\">-</span>dimensional <span class=\"pl-c1\">input</span> <span class=\"pl-k\">for</span> <span class=\"pl-c1\">5</span><span class=\"pl-k\">-</span>dimensional weight [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">7</span>], but got <span class=\"pl-c1\">input</span> of size [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>] instead\n\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.nn.functional.conv2d(<span class=\"pl-c1\">input</span>[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>], weight[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>])\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">90</span>, <span class=\"pl-k\">in</span> conv2d\n    <span class=\"pl-k\">return</span> f(<span class=\"pl-c1\">input</span>, weight, bias)\n<span class=\"pl-c1\">RuntimeError</span>: Expected <span class=\"pl-c1\">4</span><span class=\"pl-k\">-</span>dimensional <span class=\"pl-c1\">input</span> <span class=\"pl-k\">for</span> <span class=\"pl-c1\">4</span><span class=\"pl-k\">-</span>dimensional weight [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">4</span>], but got <span class=\"pl-c1\">input</span> of size [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>] instead\n\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.nn.functional.conv1d(<span class=\"pl-c1\">input</span>[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>], weight[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>])\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">54</span>, <span class=\"pl-k\">in</span> conv1d\n    <span class=\"pl-k\">return</span> f(<span class=\"pl-c1\">input</span>, weight, bias)\n<span class=\"pl-c1\">RuntimeError</span>: Expected <span class=\"pl-c1\">3</span><span class=\"pl-k\">-</span>dimensional <span class=\"pl-c1\">input</span> <span class=\"pl-k\">for</span> <span class=\"pl-c1\">3</span><span class=\"pl-k\">-</span>dimensional weight [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>], but got <span class=\"pl-c1\">input</span> of size [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>] instead</pre></div>\n<p>The below script produces an incorrect error message (<code>torch.nn.functional.conv_transposeNd</code>)</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">input</span> <span class=\"pl-k\">=</span> torch.autograd.Variable(torch.randn(<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>))\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> weight <span class=\"pl-k\">=</span> torch.autograd.Variable(torch.randn(<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">12</span>))\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.nn.functional.conv_transpose3d(<span class=\"pl-c1\">input</span>, weight)\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">224</span>, <span class=\"pl-k\">in</span> conv_transpose3d\n    <span class=\"pl-k\">return</span> f(<span class=\"pl-c1\">input</span>, weight, bias)\n<span class=\"pl-c1\">RuntimeError</span>: Expected <span class=\"pl-c1\">5</span><span class=\"pl-k\">-</span>dimensional <span class=\"pl-c1\">input</span> <span class=\"pl-k\">for</span> <span class=\"pl-c1\">5</span><span class=\"pl-k\">-</span>dimensional weight [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">12</span>], but got <span class=\"pl-c1\">input</span> of size [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>] instead\n\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.nn.functional.conv_transpose2d(<span class=\"pl-c1\">input</span>[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>], weight[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>])\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">192</span>, <span class=\"pl-k\">in</span> conv_transpose2d\n    <span class=\"pl-k\">return</span> f(<span class=\"pl-c1\">input</span>, weight, bias)\n<span class=\"pl-c1\">RuntimeError</span>: Expected <span class=\"pl-c1\">4</span><span class=\"pl-k\">-</span>dimensional <span class=\"pl-c1\">input</span> <span class=\"pl-k\">for</span> <span class=\"pl-c1\">4</span><span class=\"pl-k\">-</span>dimensional weight [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">2</span>], but got <span class=\"pl-c1\">input</span> of size [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>, <span class=\"pl-c1\">28</span>] instead\n\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.nn.functional.conv_transpose1d(<span class=\"pl-c1\">input</span>[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>], weight[<span class=\"pl-c1\">...</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>])\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">159</span>, <span class=\"pl-k\">in</span> conv_transpose1d\n    <span class=\"pl-k\">return</span> f(<span class=\"pl-c1\">input</span>, weight, bias)\n<span class=\"pl-c1\">RuntimeError</span>: Expected <span class=\"pl-c1\">3</span><span class=\"pl-k\">-</span>dimensional <span class=\"pl-c1\">input</span> <span class=\"pl-k\">for</span> <span class=\"pl-c1\">3</span><span class=\"pl-k\">-</span>dimensional weight [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">10</span>], but got <span class=\"pl-c1\">input</span> of size [<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">28</span>] instead</pre></div>", "body_text": "OS: Ubuntu 16.04\nPyTorch version: 0.3.0.post4\nHow you installed PyTorch (conda, pip, source): pip\nPython version: 3.5.2\nCUDA/cuDNN version: CUDA 8\n\nThe below script produces an incorrect error message (torch.nn.functional.convNd)\n>>> input = torch.autograd.Variable(torch.randn(10, 3, 28, 28, 28))\n>>> weight = torch.autograd.Variable(torch.randn(20, 3, 4, 7))\n>>> torch.nn.functional.conv3d(input, weight)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 126, in conv3d\n    return f(input, weight, bias)\nRuntimeError: Expected 5-dimensional input for 5-dimensional weight [10, 3, 4, 7], but got input of size [10, 3, 28, 28, 28] instead\n\n>>> torch.nn.functional.conv2d(input[..., -1], weight[..., -1])\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 90, in conv2d\n    return f(input, weight, bias)\nRuntimeError: Expected 4-dimensional input for 4-dimensional weight [10, 3, 4], but got input of size [10, 3, 28, 28] instead\n\n>>> torch.nn.functional.conv1d(input[..., -1, -1], weight[..., -1, -1])\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 54, in conv1d\n    return f(input, weight, bias)\nRuntimeError: Expected 3-dimensional input for 3-dimensional weight [10, 3], but got input of size [10, 3, 28] instead\nThe below script produces an incorrect error message (torch.nn.functional.conv_transposeNd)\n>>> input = torch.autograd.Variable(torch.randn(10, 3, 28, 28, 28))\n>>> weight = torch.autograd.Variable(torch.randn(3, 10, 2, 12))\n>>> torch.nn.functional.conv_transpose3d(input, weight)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 224, in conv_transpose3d\n    return f(input, weight, bias)\nRuntimeError: Expected 5-dimensional input for 5-dimensional weight [3, 10, 2, 12], but got input of size [10, 3, 28, 28, 28] instead\n\n>>> torch.nn.functional.conv_transpose2d(input[..., -1], weight[..., -1])\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 192, in conv_transpose2d\n    return f(input, weight, bias)\nRuntimeError: Expected 4-dimensional input for 4-dimensional weight [3, 10, 2], but got input of size [10, 3, 28, 28] instead\n\n>>> torch.nn.functional.conv_transpose1d(input[..., -1, -1], weight[..., -1, -1])\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 159, in conv_transpose1d\n    return f(input, weight, bias)\nRuntimeError: Expected 3-dimensional input for 3-dimensional weight [3, 10], but got input of size [10, 3, 28] instead", "body": "- OS: Ubuntu 16.04\r\n- PyTorch version: 0.3.0.post4\r\n- How you installed PyTorch (conda, pip, source): pip\r\n- Python version: 3.5.2\r\n- CUDA/cuDNN version: CUDA 8\r\n\r\nThe below script produces an incorrect error message (`torch.nn.functional.convNd`)\r\n```python\r\n>>> input = torch.autograd.Variable(torch.randn(10, 3, 28, 28, 28))\r\n>>> weight = torch.autograd.Variable(torch.randn(20, 3, 4, 7))\r\n>>> torch.nn.functional.conv3d(input, weight)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 126, in conv3d\r\n    return f(input, weight, bias)\r\nRuntimeError: Expected 5-dimensional input for 5-dimensional weight [10, 3, 4, 7], but got input of size [10, 3, 28, 28, 28] instead\r\n\r\n>>> torch.nn.functional.conv2d(input[..., -1], weight[..., -1])\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 90, in conv2d\r\n    return f(input, weight, bias)\r\nRuntimeError: Expected 4-dimensional input for 4-dimensional weight [10, 3, 4], but got input of size [10, 3, 28, 28] instead\r\n\r\n>>> torch.nn.functional.conv1d(input[..., -1, -1], weight[..., -1, -1])\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 54, in conv1d\r\n    return f(input, weight, bias)\r\nRuntimeError: Expected 3-dimensional input for 3-dimensional weight [10, 3], but got input of size [10, 3, 28] instead\r\n```\r\n\r\nThe below script produces an incorrect error message (`torch.nn.functional.conv_transposeNd`)\r\n```python\r\n>>> input = torch.autograd.Variable(torch.randn(10, 3, 28, 28, 28))\r\n>>> weight = torch.autograd.Variable(torch.randn(3, 10, 2, 12))\r\n>>> torch.nn.functional.conv_transpose3d(input, weight)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 224, in conv_transpose3d\r\n    return f(input, weight, bias)\r\nRuntimeError: Expected 5-dimensional input for 5-dimensional weight [3, 10, 2, 12], but got input of size [10, 3, 28, 28, 28] instead\r\n\r\n>>> torch.nn.functional.conv_transpose2d(input[..., -1], weight[..., -1])\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 192, in conv_transpose2d\r\n    return f(input, weight, bias)\r\nRuntimeError: Expected 4-dimensional input for 4-dimensional weight [3, 10, 2], but got input of size [10, 3, 28, 28] instead\r\n\r\n>>> torch.nn.functional.conv_transpose1d(input[..., -1, -1], weight[..., -1, -1])\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/functional.py\", line 159, in conv_transpose1d\r\n    return f(input, weight, bias)\r\nRuntimeError: Expected 3-dimensional input for 3-dimensional weight [3, 10], but got input of size [10, 3, 28] instead\r\n```"}