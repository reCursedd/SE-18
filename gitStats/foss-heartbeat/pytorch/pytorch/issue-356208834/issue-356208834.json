{"url": "https://api.github.com/repos/pytorch/pytorch/issues/11172", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/11172/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/11172/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/11172/events", "html_url": "https://github.com/pytorch/pytorch/issues/11172", "id": 356208834, "node_id": "MDU6SXNzdWUzNTYyMDg4MzQ=", "number": 11172, "title": "Unable to pickle.dump `torch.dtype` objects when invoked by `python -m`", "user": {"login": "zasdfgbnm", "id": 1032377, "node_id": "MDQ6VXNlcjEwMzIzNzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1032377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zasdfgbnm", "html_url": "https://github.com/zasdfgbnm", "followers_url": "https://api.github.com/users/zasdfgbnm/followers", "following_url": "https://api.github.com/users/zasdfgbnm/following{/other_user}", "gists_url": "https://api.github.com/users/zasdfgbnm/gists{/gist_id}", "starred_url": "https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zasdfgbnm/subscriptions", "organizations_url": "https://api.github.com/users/zasdfgbnm/orgs", "repos_url": "https://api.github.com/users/zasdfgbnm/repos", "events_url": "https://api.github.com/users/zasdfgbnm/events{/privacy}", "received_events_url": "https://api.github.com/users/zasdfgbnm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-09-01T15:00:56Z", "updated_at": "2018-11-13T05:19:42Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue description</h2>\n<p>I have a very simple python package:</p>\n<pre><code>test_pickle/\n\u251c\u2500\u2500 __init__.py\n\u2514\u2500\u2500 test.py\n</code></pre>\n<p>Where the <code>__init__.py</code> has only one line:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch</pre></div>\n<p>And the <code>test.py</code> just <code>pickle.dump</code> the <code>torch.float32</code></p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> pickle\n<span class=\"pl-k\">import</span> torch\n\n<span class=\"pl-k\">if</span> <span class=\"pl-c1\">__name__</span> <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>__main__<span class=\"pl-pds\">'</span></span>:\n    <span class=\"pl-k\">with</span> <span class=\"pl-c1\">open</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>test<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>wb<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> f:\n        pickle.dump(torch.float32, f)\n    <span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>pickle success<span class=\"pl-pds\">'</span></span>)</pre></div>\n<p>When run by <code>python test_pickle/test.py</code>, everything works normally and I successfully get a print <code>pickle success</code>. But when run by <code>python -m test_pickle.test</code>, I get an error message:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/usr/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib/python3.7/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/home/gaoxiang/tmp/test_pickle/test.py\", line 6, in &lt;module&gt;\n    pickle.dump(torch.float32, f)\nTypeError: __reduce_ex__() takes exactly one argument (0 given)\n</code></pre>\n<p>I have no idea on what cause this problem, but it seems very strange...</p>\n<h2>System Info</h2>\n<pre><code>Collecting environment information...\nPyTorch version: 0.5.0a0+a24163a\nIs debug build: No\nCUDA used to build PyTorch: 9.2.148\n\nOS: Arch Linux\nGCC version: (GCC) 8.2.0\nCMake version: version 3.12.1\n\nPython version: 3.7\nIs CUDA available: Yes\nCUDA runtime version: 9.2.148\nGPU models and configuration: \nGPU 0: GeForce GTX 1080\nGPU 1: GeForce GT 710\n\nNvidia driver version: 396.54\ncuDNN version: Could not collect\n\nVersions of relevant libraries:\n[pip] Could not collect\n[conda] Could not collect\n</code></pre>", "body_text": "Issue description\nI have a very simple python package:\ntest_pickle/\n\u251c\u2500\u2500 __init__.py\n\u2514\u2500\u2500 test.py\n\nWhere the __init__.py has only one line:\nimport torch\nAnd the test.py just pickle.dump the torch.float32\nimport pickle\nimport torch\n\nif __name__ == '__main__':\n    with open('test', 'wb') as f:\n        pickle.dump(torch.float32, f)\n    print('pickle success')\nWhen run by python test_pickle/test.py, everything works normally and I successfully get a print pickle success. But when run by python -m test_pickle.test, I get an error message:\nTraceback (most recent call last):\n  File \"/usr/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib/python3.7/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/home/gaoxiang/tmp/test_pickle/test.py\", line 6, in <module>\n    pickle.dump(torch.float32, f)\nTypeError: __reduce_ex__() takes exactly one argument (0 given)\n\nI have no idea on what cause this problem, but it seems very strange...\nSystem Info\nCollecting environment information...\nPyTorch version: 0.5.0a0+a24163a\nIs debug build: No\nCUDA used to build PyTorch: 9.2.148\n\nOS: Arch Linux\nGCC version: (GCC) 8.2.0\nCMake version: version 3.12.1\n\nPython version: 3.7\nIs CUDA available: Yes\nCUDA runtime version: 9.2.148\nGPU models and configuration: \nGPU 0: GeForce GTX 1080\nGPU 1: GeForce GT 710\n\nNvidia driver version: 396.54\ncuDNN version: Could not collect\n\nVersions of relevant libraries:\n[pip] Could not collect\n[conda] Could not collect", "body": "## Issue description\r\n\r\nI have a very simple python package:\r\n```\r\ntest_pickle/\r\n\u251c\u2500\u2500 __init__.py\r\n\u2514\u2500\u2500 test.py\r\n```\r\n\r\nWhere the `__init__.py` has only one line:\r\n```python\r\nimport torch\r\n```\r\nAnd the `test.py` just `pickle.dump` the `torch.float32`\r\n\r\n```python\r\nimport pickle\r\nimport torch\r\n\r\nif __name__ == '__main__':\r\n    with open('test', 'wb') as f:\r\n        pickle.dump(torch.float32, f)\r\n    print('pickle success')\r\n```\r\n\r\nWhen run by `python test_pickle/test.py`, everything works normally and I successfully get a print `pickle success`. But when run by `python -m test_pickle.test`, I get an error message:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.7/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/gaoxiang/tmp/test_pickle/test.py\", line 6, in <module>\r\n    pickle.dump(torch.float32, f)\r\nTypeError: __reduce_ex__() takes exactly one argument (0 given)\r\n```\r\n\r\nI have no idea on what cause this problem, but it seems very strange...\r\n\r\n## System Info\r\n```\r\nCollecting environment information...\r\nPyTorch version: 0.5.0a0+a24163a\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.2.148\r\n\r\nOS: Arch Linux\r\nGCC version: (GCC) 8.2.0\r\nCMake version: version 3.12.1\r\n\r\nPython version: 3.7\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.2.148\r\nGPU models and configuration: \r\nGPU 0: GeForce GTX 1080\r\nGPU 1: GeForce GT 710\r\n\r\nNvidia driver version: 396.54\r\ncuDNN version: Could not collect\r\n\r\nVersions of relevant libraries:\r\n[pip] Could not collect\r\n[conda] Could not collect\r\n```"}