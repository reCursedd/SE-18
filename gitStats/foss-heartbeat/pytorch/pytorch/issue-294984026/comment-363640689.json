{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/363640689", "html_url": "https://github.com/pytorch/pytorch/issues/5096#issuecomment-363640689", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5096", "id": 363640689, "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzY0MDY4OQ==", "user": {"login": "MlWoo", "id": 20226293, "node_id": "MDQ6VXNlcjIwMjI2Mjkz", "avatar_url": "https://avatars2.githubusercontent.com/u/20226293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MlWoo", "html_url": "https://github.com/MlWoo", "followers_url": "https://api.github.com/users/MlWoo/followers", "following_url": "https://api.github.com/users/MlWoo/following{/other_user}", "gists_url": "https://api.github.com/users/MlWoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/MlWoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MlWoo/subscriptions", "organizations_url": "https://api.github.com/users/MlWoo/orgs", "repos_url": "https://api.github.com/users/MlWoo/repos", "events_url": "https://api.github.com/users/MlWoo/events{/privacy}", "received_events_url": "https://api.github.com/users/MlWoo/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-07T02:59:59Z", "updated_at": "2018-02-08T06:40:28Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Taking <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"291045359\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/4824\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/4824/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/4824\">#4824</a> as an example, in the THNN module (specifical location maybe should be discussed), the machine will try to get the env variables from the code below:</p>\n<div class=\"highlight highlight-source-c\"><pre><span class=\"pl-k\">int</span> THNN_FORCE_OPENMP = <span class=\"pl-c1\">0</span>;\n<span class=\"pl-k\">char</span>* evar = getenv(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>THNN_FORCE_OPENMP<span class=\"pl-pds\">\"</span></span>);\n<span class=\"pl-k\">if</span> (evar != <span class=\"pl-c1\">NULL</span> &amp;&amp; strncmp(evar, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-c1\">2</span>) == <span class=\"pl-c1\">0</span>)\n    THNN_FORCE_OPENMP = <span class=\"pl-c1\">1</span>;</pre></div>\n<p>In VolumetricConvolutionMM.c file, the machine will use the variable like that:</p>\n<div class=\"highlight highlight-source-c\"><pre>#<span class=\"pl-k\">ifdef</span> _OPENMP\n    <span class=\"pl-k\">int</span> use_openmp = (THNN_FORCE_OPENMP) || (T &gt; CONV3D_OMP_THRESHOLD);\n    #<span class=\"pl-k\">pragma</span> omp parallel for if (use_openmp) private(t)\n#<span class=\"pl-k\">endif</span></pre></div>", "body_text": "Taking #4824 as an example, in the THNN module (specifical location maybe should be discussed), the machine will try to get the env variables from the code below:\nint THNN_FORCE_OPENMP = 0;\nchar* evar = getenv(\"THNN_FORCE_OPENMP\");\nif (evar != NULL && strncmp(evar, \"1\", 2) == 0)\n    THNN_FORCE_OPENMP = 1;\nIn VolumetricConvolutionMM.c file, the machine will use the variable like that:\n#ifdef _OPENMP\n    int use_openmp = (THNN_FORCE_OPENMP) || (T > CONV3D_OMP_THRESHOLD);\n    #pragma omp parallel for if (use_openmp) private(t)\n#endif", "body": "Taking #4824 as an example, in the THNN module (specifical location maybe should be discussed), the machine will try to get the env variables from the code below:\r\n```c\r\nint THNN_FORCE_OPENMP = 0;\r\nchar* evar = getenv(\"THNN_FORCE_OPENMP\");\r\nif (evar != NULL && strncmp(evar, \"1\", 2) == 0)\r\n    THNN_FORCE_OPENMP = 1;\r\n```\r\nIn VolumetricConvolutionMM.c file, the machine will use the variable like that:\r\n```c\r\n#ifdef _OPENMP\r\n    int use_openmp = (THNN_FORCE_OPENMP) || (T > CONV3D_OMP_THRESHOLD);\r\n    #pragma omp parallel for if (use_openmp) private(t)\r\n#endif\r\n```"}