{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/372492860", "html_url": "https://github.com/pytorch/pytorch/issues/5712#issuecomment-372492860", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5712", "id": 372492860, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjQ5Mjg2MA==", "user": {"login": "ashahba", "id": 12436063, "node_id": "MDQ6VXNlcjEyNDM2MDYz", "avatar_url": "https://avatars3.githubusercontent.com/u/12436063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ashahba", "html_url": "https://github.com/ashahba", "followers_url": "https://api.github.com/users/ashahba/followers", "following_url": "https://api.github.com/users/ashahba/following{/other_user}", "gists_url": "https://api.github.com/users/ashahba/gists{/gist_id}", "starred_url": "https://api.github.com/users/ashahba/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ashahba/subscriptions", "organizations_url": "https://api.github.com/users/ashahba/orgs", "repos_url": "https://api.github.com/users/ashahba/repos", "events_url": "https://api.github.com/users/ashahba/events{/privacy}", "received_events_url": "https://api.github.com/users/ashahba/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-12T23:11:12Z", "updated_at": "2018-03-12T23:12:53Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=8314343\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/s1113950\">@s1113950</a> your setup should be fine the only thing is you may need to pass <code>--build-arg NO_PROXY=$NO_PROXY</code>  and <code>--build-arg no_proxy=$no_proxy</code> info as well.<br>\nI was able to build both <code>master</code> and also <code>v0.3.1</code> behind corporate proxy although it took a bit long.</p>\n<pre><code>Successfully installed pillow-5.0.0 torchvision-0.2.0\nCleaning up...\n ---&gt; 63dce00d2bad\nRemoving intermediate container 02743c0ec397\nStep 13 : WORKDIR /workspace\n ---&gt; Running in f1e33c97eaa3\n ---&gt; 0ffa74b39fa5\nRemoving intermediate container f1e33c97eaa3\nStep 14 : RUN chmod -R a+w /workspace\n ---&gt; Running in 32c626887f44\n ---&gt; 3e6422c72b8f\nRemoving intermediate container 32c626887f44\nSuccessfully built 3e6422c72b8f\n$ docker images\nREPOSITORY          TAG                            IMAGE ID            CREATED              SIZE\npytorch             0.3.1                          3e6422c72b8f        About a minute ago   4.416 GB\n&lt;none&gt;              &lt;none&gt;                         85cab9281f05        28 minutes ago       3.648 GB\npytorch             latest                         074671e67a8e        43 minutes ago       5.174 GB\nnvidia/cuda         9.0-cudnn7-devel-ubuntu16.04   3ada27a3ae03        3 days ago           2.864 GB\nnvidia/cuda         8.0-cudnn6-devel-ubuntu16.04   547cf50ecba4        3 days ago           1.97 GB\n</code></pre>\n<p>Also since for <code>v1.3.0</code> and possibly older versions <code>/opt/conda/bin</code> is not added to <code>PATH</code> calls to <code>conda</code> fail. So in order to build <code>v0.3.1</code> I had to make a small change:</p>\n<pre><code>$ git diff\ndiff --git a/Dockerfile b/Dockerfile\nindex cba8b33..b95f612 100644\n--- a/Dockerfile\n+++ b/Dockerfile\n@@ -24,7 +24,7 @@ RUN curl -o ~/miniconda.sh -O  https://repo.continuum.io/miniconda/Miniconda3-la\n #     /opt/conda/bin/conda install conda-build &amp;&amp; \\\n      /opt/conda/bin/conda create -y --name pytorch-py$PYTHON_VERSION python=$PYTHON_VERSION numpy pyyaml scipy ipython mkl&amp;&amp; \\\n      /opt/conda/bin/conda clean -ya \n-ENV PATH /opt/conda/envs/pytorch-py$PYTHON_VERSION/bin:$PATH\n+ENV PATH /opt/conda/bin:/opt/conda/envs/pytorch-py$PYTHON_VERSION/bin:$PATH\n RUN conda install --name pytorch-py$PYTHON_VERSION -c soumith magma-cuda80\n # This must be done before pip so that requirements.txt is available\n WORKDIR /opt/pytorch\n</code></pre>", "body_text": "@s1113950 your setup should be fine the only thing is you may need to pass --build-arg NO_PROXY=$NO_PROXY  and --build-arg no_proxy=$no_proxy info as well.\nI was able to build both master and also v0.3.1 behind corporate proxy although it took a bit long.\nSuccessfully installed pillow-5.0.0 torchvision-0.2.0\nCleaning up...\n ---> 63dce00d2bad\nRemoving intermediate container 02743c0ec397\nStep 13 : WORKDIR /workspace\n ---> Running in f1e33c97eaa3\n ---> 0ffa74b39fa5\nRemoving intermediate container f1e33c97eaa3\nStep 14 : RUN chmod -R a+w /workspace\n ---> Running in 32c626887f44\n ---> 3e6422c72b8f\nRemoving intermediate container 32c626887f44\nSuccessfully built 3e6422c72b8f\n$ docker images\nREPOSITORY          TAG                            IMAGE ID            CREATED              SIZE\npytorch             0.3.1                          3e6422c72b8f        About a minute ago   4.416 GB\n<none>              <none>                         85cab9281f05        28 minutes ago       3.648 GB\npytorch             latest                         074671e67a8e        43 minutes ago       5.174 GB\nnvidia/cuda         9.0-cudnn7-devel-ubuntu16.04   3ada27a3ae03        3 days ago           2.864 GB\nnvidia/cuda         8.0-cudnn6-devel-ubuntu16.04   547cf50ecba4        3 days ago           1.97 GB\n\nAlso since for v1.3.0 and possibly older versions /opt/conda/bin is not added to PATH calls to conda fail. So in order to build v0.3.1 I had to make a small change:\n$ git diff\ndiff --git a/Dockerfile b/Dockerfile\nindex cba8b33..b95f612 100644\n--- a/Dockerfile\n+++ b/Dockerfile\n@@ -24,7 +24,7 @@ RUN curl -o ~/miniconda.sh -O  https://repo.continuum.io/miniconda/Miniconda3-la\n #     /opt/conda/bin/conda install conda-build && \\\n      /opt/conda/bin/conda create -y --name pytorch-py$PYTHON_VERSION python=$PYTHON_VERSION numpy pyyaml scipy ipython mkl&& \\\n      /opt/conda/bin/conda clean -ya \n-ENV PATH /opt/conda/envs/pytorch-py$PYTHON_VERSION/bin:$PATH\n+ENV PATH /opt/conda/bin:/opt/conda/envs/pytorch-py$PYTHON_VERSION/bin:$PATH\n RUN conda install --name pytorch-py$PYTHON_VERSION -c soumith magma-cuda80\n # This must be done before pip so that requirements.txt is available\n WORKDIR /opt/pytorch", "body": "@s1113950 your setup should be fine the only thing is you may need to pass `--build-arg NO_PROXY=$NO_PROXY`  and `--build-arg no_proxy=$no_proxy` info as well.\r\nI was able to build both `master` and also `v0.3.1` behind corporate proxy although it took a bit long.\r\n\r\n```\r\nSuccessfully installed pillow-5.0.0 torchvision-0.2.0\r\nCleaning up...\r\n ---> 63dce00d2bad\r\nRemoving intermediate container 02743c0ec397\r\nStep 13 : WORKDIR /workspace\r\n ---> Running in f1e33c97eaa3\r\n ---> 0ffa74b39fa5\r\nRemoving intermediate container f1e33c97eaa3\r\nStep 14 : RUN chmod -R a+w /workspace\r\n ---> Running in 32c626887f44\r\n ---> 3e6422c72b8f\r\nRemoving intermediate container 32c626887f44\r\nSuccessfully built 3e6422c72b8f\r\n$ docker images\r\nREPOSITORY          TAG                            IMAGE ID            CREATED              SIZE\r\npytorch             0.3.1                          3e6422c72b8f        About a minute ago   4.416 GB\r\n<none>              <none>                         85cab9281f05        28 minutes ago       3.648 GB\r\npytorch             latest                         074671e67a8e        43 minutes ago       5.174 GB\r\nnvidia/cuda         9.0-cudnn7-devel-ubuntu16.04   3ada27a3ae03        3 days ago           2.864 GB\r\nnvidia/cuda         8.0-cudnn6-devel-ubuntu16.04   547cf50ecba4        3 days ago           1.97 GB\r\n```\r\n\r\nAlso since for `v1.3.0` and possibly older versions `/opt/conda/bin` is not added to `PATH` calls to `conda` fail. So in order to build `v0.3.1` I had to make a small change:\r\n```\r\n$ git diff\r\ndiff --git a/Dockerfile b/Dockerfile\r\nindex cba8b33..b95f612 100644\r\n--- a/Dockerfile\r\n+++ b/Dockerfile\r\n@@ -24,7 +24,7 @@ RUN curl -o ~/miniconda.sh -O  https://repo.continuum.io/miniconda/Miniconda3-la\r\n #     /opt/conda/bin/conda install conda-build && \\\r\n      /opt/conda/bin/conda create -y --name pytorch-py$PYTHON_VERSION python=$PYTHON_VERSION numpy pyyaml scipy ipython mkl&& \\\r\n      /opt/conda/bin/conda clean -ya \r\n-ENV PATH /opt/conda/envs/pytorch-py$PYTHON_VERSION/bin:$PATH\r\n+ENV PATH /opt/conda/bin:/opt/conda/envs/pytorch-py$PYTHON_VERSION/bin:$PATH\r\n RUN conda install --name pytorch-py$PYTHON_VERSION -c soumith magma-cuda80\r\n # This must be done before pip so that requirements.txt is available\r\n WORKDIR /opt/pytorch\r\n```\r\n"}