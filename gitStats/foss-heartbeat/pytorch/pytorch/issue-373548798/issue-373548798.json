{"url": "https://api.github.com/repos/pytorch/pytorch/issues/13052", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/13052/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/13052/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/13052/events", "html_url": "https://github.com/pytorch/pytorch/issues/13052", "id": 373548798, "node_id": "MDU6SXNzdWUzNzM1NDg3OTg=", "number": 13052, "title": "Tensor type mismatch, caller expects elements to be int, while tensor contains float", "user": {"login": "II-Matto", "id": 2261229, "node_id": "MDQ6VXNlcjIyNjEyMjk=", "avatar_url": "https://avatars0.githubusercontent.com/u/2261229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/II-Matto", "html_url": "https://github.com/II-Matto", "followers_url": "https://api.github.com/users/II-Matto/followers", "following_url": "https://api.github.com/users/II-Matto/following{/other_user}", "gists_url": "https://api.github.com/users/II-Matto/gists{/gist_id}", "starred_url": "https://api.github.com/users/II-Matto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/II-Matto/subscriptions", "organizations_url": "https://api.github.com/users/II-Matto/orgs", "repos_url": "https://api.github.com/users/II-Matto/repos", "events_url": "https://api.github.com/users/II-Matto/events{/privacy}", "received_events_url": "https://api.github.com/users/II-Matto/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-24T15:42:03Z", "updated_at": "2018-10-24T15:59:00Z", "closed_at": "2018-10-24T15:59:00Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>I create a network, which uses <code>LabelCrossEntropy</code> operator. Error messages are reported, which asks me to \"report a bug to Pytorch\". See below for detailed error messages.</p>\n<h2>To Reproduce</h2>\n<p>The error messages are as follows. The key point is: \"<strong>Tensor type mismatch, caller expects elements to be int, while tensor contains float</strong>\". What could be the possible reasons?</p>\n<pre><code>[E net_async_base.cc:422] storage_.IsType&lt;T&gt;() ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1540197075786/work/aten/src/ATen/core/TensorImpl.h:278, please report a bug to PyTorch. Tensor type mismatch, caller expects elements to be int, while tensor contains float. Error from operator: \ninput: \"gpu_0/input_blob_1\" input: \"gpu_0/input_blob_2\" output: \"gpu_0/output_blob\" name: \"\" type: \"LabelCrossEntropy\" device_option { device_type: 1 device_id: 0 } (data at /opt/conda/conda-bld/pytorch-nightly_1540197075786/work/aten/src/ATen/core/TensorImpl.h:278)\nframe #0: caffe2::LabelCrossEntropyOp&lt;float, caffe2::CUDAContext&gt;::RunOnDevice() + 0x39b (0x7fc05897b00b in /home/&lt;user&gt;/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2_gpu.so)\nframe #1: &lt;unknown function&gt; + 0x142ef95 (0x7fc057411f95 in /home/&lt;user&gt;/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2_gpu.so)\nframe #2: caffe2::AsyncNetBase::run(int, int) + 0x16e (0x7fc07e39dcbe in /home/&lt;user&gt;/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\nframe #3: &lt;unknown function&gt; + 0x123d432 (0x7fc07e3ad432 in /home/&lt;user&gt;/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\nframe #4: &lt;unknown function&gt; + 0x1230d0b (0x7fc07e3a0d0b in /home/&lt;user&gt;/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\nframe #5: &lt;unknown function&gt; + 0xafc5c (0x7fc091f90c5c in /home/&lt;user&gt;/lib/anaconda2/lib/python2.7/site-packages/../../libstdc++.so.6)\nframe #6: &lt;unknown function&gt; + 0x76ba (0x7fc0a05996ba in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #7: clone + 0x6d (0x7fc09fbbf41d in /lib/x86_64-linux-gnu/libc.so.6)\n,  op LabelCrossEntropy\n</code></pre>\n<h2>Expected behavior</h2>\n<p>No errors should be reported, as I used the <code>LabelCrossEntropy</code> operator in other networks before without encountering any errors, though the PyTorch/Caffe2 version is different.</p>\n<h2>Environment</h2>\n<ul>\n<li>PyTorch Version (e.g., 1.0): <strong>pytorch-nightly-1.0.0.dev20181022-py2.7_cuda8.0.61_cudnn7.1.2_0.tar.bz2</strong></li>\n<li>OS (e.g., Linux): <strong>Ubuntu 14.04</strong></li>\n<li>How you installed PyTorch (<code>conda</code>, <code>pip</code>, source): <strong>conda</strong></li>\n<li>Build command you used (if compiling from source):</li>\n<li>Python version: <strong>Python 2.7.15 :: Anaconda, Inc.</strong></li>\n<li>CUDA/cuDNN version: <strong>8.0/cudnn-8.0-linux-x64-v7</strong></li>\n<li>GPU models and configuration: <strong>(Titan Xp)</strong></li>\n<li>Any other relevant information:</li>\n</ul>\n<h2>Additional context</h2>\n<p>(None)</p>", "body_text": "\ud83d\udc1b Bug\nI create a network, which uses LabelCrossEntropy operator. Error messages are reported, which asks me to \"report a bug to Pytorch\". See below for detailed error messages.\nTo Reproduce\nThe error messages are as follows. The key point is: \"Tensor type mismatch, caller expects elements to be int, while tensor contains float\". What could be the possible reasons?\n[E net_async_base.cc:422] storage_.IsType<T>() ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1540197075786/work/aten/src/ATen/core/TensorImpl.h:278, please report a bug to PyTorch. Tensor type mismatch, caller expects elements to be int, while tensor contains float. Error from operator: \ninput: \"gpu_0/input_blob_1\" input: \"gpu_0/input_blob_2\" output: \"gpu_0/output_blob\" name: \"\" type: \"LabelCrossEntropy\" device_option { device_type: 1 device_id: 0 } (data at /opt/conda/conda-bld/pytorch-nightly_1540197075786/work/aten/src/ATen/core/TensorImpl.h:278)\nframe #0: caffe2::LabelCrossEntropyOp<float, caffe2::CUDAContext>::RunOnDevice() + 0x39b (0x7fc05897b00b in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2_gpu.so)\nframe #1: <unknown function> + 0x142ef95 (0x7fc057411f95 in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2_gpu.so)\nframe #2: caffe2::AsyncNetBase::run(int, int) + 0x16e (0x7fc07e39dcbe in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\nframe #3: <unknown function> + 0x123d432 (0x7fc07e3ad432 in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\nframe #4: <unknown function> + 0x1230d0b (0x7fc07e3a0d0b in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\nframe #5: <unknown function> + 0xafc5c (0x7fc091f90c5c in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/../../libstdc++.so.6)\nframe #6: <unknown function> + 0x76ba (0x7fc0a05996ba in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #7: clone + 0x6d (0x7fc09fbbf41d in /lib/x86_64-linux-gnu/libc.so.6)\n,  op LabelCrossEntropy\n\nExpected behavior\nNo errors should be reported, as I used the LabelCrossEntropy operator in other networks before without encountering any errors, though the PyTorch/Caffe2 version is different.\nEnvironment\n\nPyTorch Version (e.g., 1.0): pytorch-nightly-1.0.0.dev20181022-py2.7_cuda8.0.61_cudnn7.1.2_0.tar.bz2\nOS (e.g., Linux): Ubuntu 14.04\nHow you installed PyTorch (conda, pip, source): conda\nBuild command you used (if compiling from source):\nPython version: Python 2.7.15 :: Anaconda, Inc.\nCUDA/cuDNN version: 8.0/cudnn-8.0-linux-x64-v7\nGPU models and configuration: (Titan Xp)\nAny other relevant information:\n\nAdditional context\n(None)", "body": "## \ud83d\udc1b Bug\r\n\r\nI create a network, which uses `LabelCrossEntropy` operator. Error messages are reported, which asks me to \"report a bug to Pytorch\". See below for detailed error messages.\r\n\r\n## To Reproduce\r\n\r\nThe error messages are as follows. The key point is: \"**Tensor type mismatch, caller expects elements to be int, while tensor contains float**\". What could be the possible reasons?\r\n```\r\n[E net_async_base.cc:422] storage_.IsType<T>() ASSERT FAILED at /opt/conda/conda-bld/pytorch-nightly_1540197075786/work/aten/src/ATen/core/TensorImpl.h:278, please report a bug to PyTorch. Tensor type mismatch, caller expects elements to be int, while tensor contains float. Error from operator: \r\ninput: \"gpu_0/input_blob_1\" input: \"gpu_0/input_blob_2\" output: \"gpu_0/output_blob\" name: \"\" type: \"LabelCrossEntropy\" device_option { device_type: 1 device_id: 0 } (data at /opt/conda/conda-bld/pytorch-nightly_1540197075786/work/aten/src/ATen/core/TensorImpl.h:278)\r\nframe #0: caffe2::LabelCrossEntropyOp<float, caffe2::CUDAContext>::RunOnDevice() + 0x39b (0x7fc05897b00b in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2_gpu.so)\r\nframe #1: <unknown function> + 0x142ef95 (0x7fc057411f95 in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2_gpu.so)\r\nframe #2: caffe2::AsyncNetBase::run(int, int) + 0x16e (0x7fc07e39dcbe in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\r\nframe #3: <unknown function> + 0x123d432 (0x7fc07e3ad432 in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\r\nframe #4: <unknown function> + 0x1230d0b (0x7fc07e3a0d0b in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/caffe2/python/../../torch/lib/libcaffe2.so)\r\nframe #5: <unknown function> + 0xafc5c (0x7fc091f90c5c in /home/<user>/lib/anaconda2/lib/python2.7/site-packages/../../libstdc++.so.6)\r\nframe #6: <unknown function> + 0x76ba (0x7fc0a05996ba in /lib/x86_64-linux-gnu/libpthread.so.0)\r\nframe #7: clone + 0x6d (0x7fc09fbbf41d in /lib/x86_64-linux-gnu/libc.so.6)\r\n,  op LabelCrossEntropy\r\n```\r\n\r\n## Expected behavior\r\n\r\nNo errors should be reported, as I used the `LabelCrossEntropy` operator in other networks before without encountering any errors, though the PyTorch/Caffe2 version is different.\r\n\r\n## Environment\r\n\r\n - PyTorch Version (e.g., 1.0): **pytorch-nightly-1.0.0.dev20181022-py2.7_cuda8.0.61_cudnn7.1.2_0.tar.bz2**\r\n - OS (e.g., Linux): **Ubuntu 14.04**\r\n - How you installed PyTorch (`conda`, `pip`, source): **conda**\r\n - Build command you used (if compiling from source):\r\n - Python version: **Python 2.7.15 :: Anaconda, Inc.**\r\n - CUDA/cuDNN version: **8.0/cudnn-8.0-linux-x64-v7**\r\n - GPU models and configuration: **(Titan Xp)**\r\n - Any other relevant information:\r\n\r\n## Additional context\r\n\r\n(None)\r\n"}