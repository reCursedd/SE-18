{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3513", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3513/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3513/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3513/events", "html_url": "https://github.com/pytorch/pytorch/issues/3513", "id": 271597921, "node_id": "MDU6SXNzdWUyNzE1OTc5MjE=", "number": 3513, "title": "Unable to convert Numpy array to Tensor after keras.sequence.pad_sequences()", "user": {"login": "aleSuglia", "id": 1479733, "node_id": "MDQ6VXNlcjE0Nzk3MzM=", "avatar_url": "https://avatars3.githubusercontent.com/u/1479733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aleSuglia", "html_url": "https://github.com/aleSuglia", "followers_url": "https://api.github.com/users/aleSuglia/followers", "following_url": "https://api.github.com/users/aleSuglia/following{/other_user}", "gists_url": "https://api.github.com/users/aleSuglia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aleSuglia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aleSuglia/subscriptions", "organizations_url": "https://api.github.com/users/aleSuglia/orgs", "repos_url": "https://api.github.com/users/aleSuglia/repos", "events_url": "https://api.github.com/users/aleSuglia/events{/privacy}", "received_events_url": "https://api.github.com/users/aleSuglia/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-11-06T19:48:43Z", "updated_at": "2017-12-01T22:12:26Z", "closed_at": "2017-12-01T22:12:26Z", "author_association": "NONE", "body_html": "<p>Hello,</p>\n<p>I'm using the <code>pad_sequences</code> function that is present in the Keras library in order to get back a padded numpy array. If you try to transform the resulting array in a LongTensor it will fail.</p>\n<pre><code>In [42]: x\nOut[42]: [[1, 2], [1, 2, 3, 4], [2, 3, 4]]\n\nIn [43]: a = keras.preprocessing.sequence.pad_sequences(x, padding=\"post\", maxle\n    ...: n=4)\n\nIn [44]: a\nOut[44]:\narray([[1, 2, 0, 0],\n       [1, 2, 3, 4],\n       [2, 3, 4, 0]], dtype=int32)\n\nIn [45]: torch.LongTensor(a)\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-45-25df5cb2e023&gt; in &lt;module&gt;()\n----&gt; 1 torch.LongTensor(a)\n\nRuntimeError: tried to construct a tensor from a nested int sequence, but found an item of type numpy.int32 at index (0, 0)\n</code></pre>\n<p>If you transform the array in a list again the code works. Is it a bug?</p>\n<p>I am using the version '0.2.0_3' of PyTorch on a MacOS High Sierra.</p>\n<p>Cheers,<br>\nAlessandro</p>", "body_text": "Hello,\nI'm using the pad_sequences function that is present in the Keras library in order to get back a padded numpy array. If you try to transform the resulting array in a LongTensor it will fail.\nIn [42]: x\nOut[42]: [[1, 2], [1, 2, 3, 4], [2, 3, 4]]\n\nIn [43]: a = keras.preprocessing.sequence.pad_sequences(x, padding=\"post\", maxle\n    ...: n=4)\n\nIn [44]: a\nOut[44]:\narray([[1, 2, 0, 0],\n       [1, 2, 3, 4],\n       [2, 3, 4, 0]], dtype=int32)\n\nIn [45]: torch.LongTensor(a)\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-45-25df5cb2e023> in <module>()\n----> 1 torch.LongTensor(a)\n\nRuntimeError: tried to construct a tensor from a nested int sequence, but found an item of type numpy.int32 at index (0, 0)\n\nIf you transform the array in a list again the code works. Is it a bug?\nI am using the version '0.2.0_3' of PyTorch on a MacOS High Sierra.\nCheers,\nAlessandro", "body": "Hello,\r\n\r\nI'm using the ``pad_sequences`` function that is present in the Keras library in order to get back a padded numpy array. If you try to transform the resulting array in a LongTensor it will fail. \r\n\r\n```\r\nIn [42]: x\r\nOut[42]: [[1, 2], [1, 2, 3, 4], [2, 3, 4]]\r\n\r\nIn [43]: a = keras.preprocessing.sequence.pad_sequences(x, padding=\"post\", maxle\r\n    ...: n=4)\r\n\r\nIn [44]: a\r\nOut[44]:\r\narray([[1, 2, 0, 0],\r\n       [1, 2, 3, 4],\r\n       [2, 3, 4, 0]], dtype=int32)\r\n\r\nIn [45]: torch.LongTensor(a)\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-45-25df5cb2e023> in <module>()\r\n----> 1 torch.LongTensor(a)\r\n\r\nRuntimeError: tried to construct a tensor from a nested int sequence, but found an item of type numpy.int32 at index (0, 0)\r\n```\r\n\r\nIf you transform the array in a list again the code works. Is it a bug?\r\n\r\nI am using the version '0.2.0_3' of PyTorch on a MacOS High Sierra.\r\n\r\nCheers,\r\nAlessandro"}