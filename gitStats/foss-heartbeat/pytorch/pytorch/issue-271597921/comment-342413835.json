{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/342413835", "html_url": "https://github.com/pytorch/pytorch/issues/3513#issuecomment-342413835", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/3513", "id": 342413835, "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjQxMzgzNQ==", "user": {"login": "bheinzerling", "id": 4348795, "node_id": "MDQ6VXNlcjQzNDg3OTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/4348795?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bheinzerling", "html_url": "https://github.com/bheinzerling", "followers_url": "https://api.github.com/users/bheinzerling/followers", "following_url": "https://api.github.com/users/bheinzerling/following{/other_user}", "gists_url": "https://api.github.com/users/bheinzerling/gists{/gist_id}", "starred_url": "https://api.github.com/users/bheinzerling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bheinzerling/subscriptions", "organizations_url": "https://api.github.com/users/bheinzerling/orgs", "repos_url": "https://api.github.com/users/bheinzerling/repos", "events_url": "https://api.github.com/users/bheinzerling/events{/privacy}", "received_events_url": "https://api.github.com/users/bheinzerling/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-07T08:45:52Z", "updated_at": "2017-11-07T08:52:42Z", "author_association": "CONTRIBUTOR", "body_html": "<p>This is not caused by <code>pad_sequences</code>. The culprit is the numpy array dtype:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.LongTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>int32<span class=\"pl-pds\">\"</span></span>))\n<span class=\"pl-c1\">RuntimeError</span>: tried to construct a tensor <span class=\"pl-k\">from</span> a <span class=\"pl-c1\">int</span> sequence, but found an item of <span class=\"pl-c1\">type</span> numpy.int32 at index (<span class=\"pl-c1\">0</span>)\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.LongTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>int64<span class=\"pl-pds\">\"</span></span>))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> works</span></pre></div>\n<p>Neither of these work in torch.cuda, btw:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.cuda.LongTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>int32<span class=\"pl-pds\">\"</span></span>))\n<span class=\"pl-c1\">RuntimeError</span>: tried to construct a tensor <span class=\"pl-k\">from</span> a <span class=\"pl-c1\">int</span> sequence, but found an item of <span class=\"pl-c1\">type</span> numpy.int32 at index (<span class=\"pl-c1\">0</span>)\n<span class=\"pl-k\">&gt;&gt;</span><span class=\"pl-k\">&gt;</span> torch.cuda.LongTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>int64<span class=\"pl-pds\">\"</span></span>)\n<span class=\"pl-c1\">RuntimeError</span>: tried to construct a tensor <span class=\"pl-k\">from</span> a <span class=\"pl-c1\">int</span> sequence, but found an item of <span class=\"pl-c1\">type</span> numpy.int64 at index (<span class=\"pl-c1\">0</span>)</pre></div>\n<p>With float it looks like this on my system:</p>\n<div class=\"highlight highlight-source-python\"><pre>torch.FloatTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>float64<span class=\"pl-pds\">\"</span></span>))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> works</span>\ntorch.FloatTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>float32<span class=\"pl-pds\">\"</span></span>))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> works</span>\ntorch.cuda.FloatTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>float32<span class=\"pl-pds\">\"</span></span>))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> exception</span>\ntorch.cuda.FloatTensor(np.arange(<span class=\"pl-c1\">10</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>float64<span class=\"pl-pds\">\"</span></span>))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> works</span></pre></div>\n<p>Calling <code>tolist()</code> on the numpy array or <code>torch.from_numpy</code> works in all cases.</p>\n<p>Edit: I'm still on 0.2.0_2. This should be fixed in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"250670683\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/2461\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/pytorch/pytorch/pull/2461/hovercard\" href=\"https://github.com/pytorch/pytorch/pull/2461\">#2461</a>.</p>", "body_text": "This is not caused by pad_sequences. The culprit is the numpy array dtype:\n>>> torch.LongTensor(np.arange(10, dtype=\"int32\"))\nRuntimeError: tried to construct a tensor from a int sequence, but found an item of type numpy.int32 at index (0)\n>>> torch.LongTensor(np.arange(10, dtype=\"int64\"))  # works\nNeither of these work in torch.cuda, btw:\n>>> torch.cuda.LongTensor(np.arange(10, dtype=\"int32\"))\nRuntimeError: tried to construct a tensor from a int sequence, but found an item of type numpy.int32 at index (0)\n>>> torch.cuda.LongTensor(np.arange(10, dtype=\"int64\")\nRuntimeError: tried to construct a tensor from a int sequence, but found an item of type numpy.int64 at index (0)\nWith float it looks like this on my system:\ntorch.FloatTensor(np.arange(10, dtype=\"float64\"))  # works\ntorch.FloatTensor(np.arange(10, dtype=\"float32\"))  # works\ntorch.cuda.FloatTensor(np.arange(10, dtype=\"float32\"))  # exception\ntorch.cuda.FloatTensor(np.arange(10, dtype=\"float64\"))  # works\nCalling tolist() on the numpy array or torch.from_numpy works in all cases.\nEdit: I'm still on 0.2.0_2. This should be fixed in #2461.", "body": "This is not caused by `pad_sequences`. The culprit is the numpy array dtype:\r\n\r\n```Python\r\n>>> torch.LongTensor(np.arange(10, dtype=\"int32\"))\r\nRuntimeError: tried to construct a tensor from a int sequence, but found an item of type numpy.int32 at index (0)\r\n>>> torch.LongTensor(np.arange(10, dtype=\"int64\"))  # works\r\n```\r\n\r\nNeither of these work in torch.cuda, btw:\r\n\r\n```Python\r\n>>> torch.cuda.LongTensor(np.arange(10, dtype=\"int32\"))\r\nRuntimeError: tried to construct a tensor from a int sequence, but found an item of type numpy.int32 at index (0)\r\n>>> torch.cuda.LongTensor(np.arange(10, dtype=\"int64\")\r\nRuntimeError: tried to construct a tensor from a int sequence, but found an item of type numpy.int64 at index (0)\r\n```\r\n\r\nWith float it looks like this on my system:\r\n```Python\r\ntorch.FloatTensor(np.arange(10, dtype=\"float64\"))  # works\r\ntorch.FloatTensor(np.arange(10, dtype=\"float32\"))  # works\r\ntorch.cuda.FloatTensor(np.arange(10, dtype=\"float32\"))  # exception\r\ntorch.cuda.FloatTensor(np.arange(10, dtype=\"float64\"))  # works\r\n```\r\n\r\nCalling `tolist()` on the numpy array or `torch.from_numpy` works in all cases.\r\n\r\nEdit: I'm still on 0.2.0_2. This should be fixed in #2461."}