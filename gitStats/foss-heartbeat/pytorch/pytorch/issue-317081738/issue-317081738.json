{"url": "https://api.github.com/repos/pytorch/pytorch/issues/6893", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/6893/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/6893/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/6893/events", "html_url": "https://github.com/pytorch/pytorch/issues/6893", "id": 317081738, "node_id": "MDU6SXNzdWUzMTcwODE3Mzg=", "number": 6893, "title": "Possible bug in DataLoader returning list", "user": {"login": "vinsis", "id": 6437295, "node_id": "MDQ6VXNlcjY0MzcyOTU=", "avatar_url": "https://avatars3.githubusercontent.com/u/6437295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vinsis", "html_url": "https://github.com/vinsis", "followers_url": "https://api.github.com/users/vinsis/followers", "following_url": "https://api.github.com/users/vinsis/following{/other_user}", "gists_url": "https://api.github.com/users/vinsis/gists{/gist_id}", "starred_url": "https://api.github.com/users/vinsis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vinsis/subscriptions", "organizations_url": "https://api.github.com/users/vinsis/orgs", "repos_url": "https://api.github.com/users/vinsis/repos", "events_url": "https://api.github.com/users/vinsis/events{/privacy}", "received_events_url": "https://api.github.com/users/vinsis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-24T06:06:03Z", "updated_at": "2018-04-24T08:02:36Z", "closed_at": "2018-04-24T08:00:36Z", "author_association": "NONE", "body_html": "<p>A loader class that is supposed to return a list object apparently tampers with the object. Here's an example:</p>\n<pre><code>from torch.utils.data import Dataset, DataLoader\nimport numpy as np\n\nsents = ['This is a sentence.', 'Yet another sentence.', 'Worry not, another sequence of words is here']\na = []\nfor sent in sents:\n    words = sent.strip().split(' ')\n    a.append(words)\n</code></pre>\n<p><code>a</code> now is:</p>\n<p><code>[['This', 'is', 'a', 'sentence.'], ['Yet', 'another', 'sentence.'], ['Worry', 'not,', 'another', 'sequence', 'of', 'words', 'is', 'here']]</code></p>\n<p>Then I proceed to create a loader class:</p>\n<pre><code>class Loader(Dataset):\n    def __init__(self):\n        self.n = len(a)\n        \n    def __getitem__(self, index):\n        return a[index]\n    \n    def __len__(self):\n        return self.n\n</code></pre>\n<p>Now I define a loader:</p>\n<pre><code>loader = DataLoader(Loader(), batch_size=1)\ni = iter(loader)\nprint(i.next())\n</code></pre>\n<h4>What I expect:</h4>\n<p><code>['This', 'is', 'a', 'sentence.']</code></p>\n<h4>What I get:</h4>\n<p><code>[('This',), ('is',), ('a',), ('sentence.',)]</code></p>\n<p>Is this on purpose (I doubt) or a bug?</p>", "body_text": "A loader class that is supposed to return a list object apparently tampers with the object. Here's an example:\nfrom torch.utils.data import Dataset, DataLoader\nimport numpy as np\n\nsents = ['This is a sentence.', 'Yet another sentence.', 'Worry not, another sequence of words is here']\na = []\nfor sent in sents:\n    words = sent.strip().split(' ')\n    a.append(words)\n\na now is:\n[['This', 'is', 'a', 'sentence.'], ['Yet', 'another', 'sentence.'], ['Worry', 'not,', 'another', 'sequence', 'of', 'words', 'is', 'here']]\nThen I proceed to create a loader class:\nclass Loader(Dataset):\n    def __init__(self):\n        self.n = len(a)\n        \n    def __getitem__(self, index):\n        return a[index]\n    \n    def __len__(self):\n        return self.n\n\nNow I define a loader:\nloader = DataLoader(Loader(), batch_size=1)\ni = iter(loader)\nprint(i.next())\n\nWhat I expect:\n['This', 'is', 'a', 'sentence.']\nWhat I get:\n[('This',), ('is',), ('a',), ('sentence.',)]\nIs this on purpose (I doubt) or a bug?", "body": "A loader class that is supposed to return a list object apparently tampers with the object. Here's an example:\r\n\r\n```\r\nfrom torch.utils.data import Dataset, DataLoader\r\nimport numpy as np\r\n\r\nsents = ['This is a sentence.', 'Yet another sentence.', 'Worry not, another sequence of words is here']\r\na = []\r\nfor sent in sents:\r\n    words = sent.strip().split(' ')\r\n    a.append(words)\r\n```\r\n`a` now is:\r\n\r\n`[['This', 'is', 'a', 'sentence.'], ['Yet', 'another', 'sentence.'], ['Worry', 'not,', 'another', 'sequence', 'of', 'words', 'is', 'here']]`\r\n\r\nThen I proceed to create a loader class:\r\n\r\n```\r\nclass Loader(Dataset):\r\n    def __init__(self):\r\n        self.n = len(a)\r\n        \r\n    def __getitem__(self, index):\r\n        return a[index]\r\n    \r\n    def __len__(self):\r\n        return self.n\r\n```\r\n\r\nNow I define a loader:\r\n```\r\nloader = DataLoader(Loader(), batch_size=1)\r\ni = iter(loader)\r\nprint(i.next())\r\n```\r\n\r\n#### What I expect:\r\n`['This', 'is', 'a', 'sentence.']`\r\n\r\n#### What I get:\r\n`[('This',), ('is',), ('a',), ('sentence.',)]`\r\n\r\nIs this on purpose (I doubt) or a bug?"}