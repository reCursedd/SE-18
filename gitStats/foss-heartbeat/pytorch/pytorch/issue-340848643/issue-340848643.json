{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9412", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9412/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9412/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9412/events", "html_url": "https://github.com/pytorch/pytorch/issues/9412", "id": 340848643, "node_id": "MDU6SXNzdWUzNDA4NDg2NDM=", "number": 9412, "title": "grad_fn of sparse tensor not displayed correctly", "user": {"login": "weiyangfb", "id": 38509346, "node_id": "MDQ6VXNlcjM4NTA5MzQ2", "avatar_url": "https://avatars1.githubusercontent.com/u/38509346?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiyangfb", "html_url": "https://github.com/weiyangfb", "followers_url": "https://api.github.com/users/weiyangfb/followers", "following_url": "https://api.github.com/users/weiyangfb/following{/other_user}", "gists_url": "https://api.github.com/users/weiyangfb/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiyangfb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiyangfb/subscriptions", "organizations_url": "https://api.github.com/users/weiyangfb/orgs", "repos_url": "https://api.github.com/users/weiyangfb/repos", "events_url": "https://api.github.com/users/weiyangfb/events{/privacy}", "received_events_url": "https://api.github.com/users/weiyangfb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-13T01:16:17Z", "updated_at": "2018-09-06T02:42:20Z", "closed_at": "2018-09-06T02:42:20Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The grad_fn are shown as Error when print a sparse tensor that requires_grad</p>\n<pre><code>a = torch.sparse.FloatTensor(\n    torch.LongTensor([[0, 0, 1],\n                      [0, 1, 1]]),\n    torch.FloatTensor([2, 3, 4]),\n    torch.Size([2, 2])).requires_grad_()\n\nb = torch.sparse.FloatTensor(\n    torch.LongTensor([[0, 0, 1],\n                      [0, 1, 1]]),\n    torch.FloatTensor([1, 1, 1]),\n    torch.Size([2, 2])).requires_grad_()\n\nd = a.mul(b)\nd.backward(a)\n\nprint(d.grad_fn) # &lt;SNativeMulBackward object at 0x7efc103176d0&gt;\nprint(d._indices().grad_fn) # &lt;Error object at 0x7efc10317a50&gt;\nprint(d._values().grad_fn)  # &lt;Error object at 0x7efc103176d0&gt; \n\n\n\nprint(d)\n----------\ntorch.sparse.FloatTensor of size (2,2) with indices:\ntensor([[0, 0, 1],\n        [0, 1, 1]], grad_fn=&lt;Error&gt;)\nand values:\ntensor([2., 3., 4.], grad_fn=&lt;Error&gt;)\n\n\n\nprint(d.to_dense())\n-------------------\ntensor([[2., 3.],\n        [0., 4.]], grad_fn=&lt;Error&gt;)\n</code></pre>\n<p>Related codes are <a href=\"https://github.com/pytorch/pytorch/blob/2ead3b0e54c0e53d3ab20c0b87a4aea873f6172d/torch/_tensor_str.py#L223-L227\">here</a>. How should I fix this? cc <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=655866\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/colesbury\">@colesbury</a></p>\n<p>EDIT: <code>print(d.to_dense())</code> is legit since there is not grad_fn defined for <code>to_dense</code>, <code>print(d._indices().grad_fn)</code> and <code>print(d._values().grad_fn)</code> are probably legit too since their grad_fn are not defined.</p>", "body_text": "The grad_fn are shown as Error when print a sparse tensor that requires_grad\na = torch.sparse.FloatTensor(\n    torch.LongTensor([[0, 0, 1],\n                      [0, 1, 1]]),\n    torch.FloatTensor([2, 3, 4]),\n    torch.Size([2, 2])).requires_grad_()\n\nb = torch.sparse.FloatTensor(\n    torch.LongTensor([[0, 0, 1],\n                      [0, 1, 1]]),\n    torch.FloatTensor([1, 1, 1]),\n    torch.Size([2, 2])).requires_grad_()\n\nd = a.mul(b)\nd.backward(a)\n\nprint(d.grad_fn) # <SNativeMulBackward object at 0x7efc103176d0>\nprint(d._indices().grad_fn) # <Error object at 0x7efc10317a50>\nprint(d._values().grad_fn)  # <Error object at 0x7efc103176d0> \n\n\n\nprint(d)\n----------\ntorch.sparse.FloatTensor of size (2,2) with indices:\ntensor([[0, 0, 1],\n        [0, 1, 1]], grad_fn=<Error>)\nand values:\ntensor([2., 3., 4.], grad_fn=<Error>)\n\n\n\nprint(d.to_dense())\n-------------------\ntensor([[2., 3.],\n        [0., 4.]], grad_fn=<Error>)\n\nRelated codes are here. How should I fix this? cc @colesbury\nEDIT: print(d.to_dense()) is legit since there is not grad_fn defined for to_dense, print(d._indices().grad_fn) and print(d._values().grad_fn) are probably legit too since their grad_fn are not defined.", "body": "The grad_fn are shown as Error when print a sparse tensor that requires_grad\r\n```\r\na = torch.sparse.FloatTensor(\r\n    torch.LongTensor([[0, 0, 1],\r\n                      [0, 1, 1]]),\r\n    torch.FloatTensor([2, 3, 4]),\r\n    torch.Size([2, 2])).requires_grad_()\r\n\r\nb = torch.sparse.FloatTensor(\r\n    torch.LongTensor([[0, 0, 1],\r\n                      [0, 1, 1]]),\r\n    torch.FloatTensor([1, 1, 1]),\r\n    torch.Size([2, 2])).requires_grad_()\r\n\r\nd = a.mul(b)\r\nd.backward(a)\r\n\r\nprint(d.grad_fn) # <SNativeMulBackward object at 0x7efc103176d0>\r\nprint(d._indices().grad_fn) # <Error object at 0x7efc10317a50>\r\nprint(d._values().grad_fn)  # <Error object at 0x7efc103176d0> \r\n\r\n\r\n\r\nprint(d)\r\n----------\r\ntorch.sparse.FloatTensor of size (2,2) with indices:\r\ntensor([[0, 0, 1],\r\n        [0, 1, 1]], grad_fn=<Error>)\r\nand values:\r\ntensor([2., 3., 4.], grad_fn=<Error>)\r\n\r\n\r\n\r\nprint(d.to_dense())\r\n-------------------\r\ntensor([[2., 3.],\r\n        [0., 4.]], grad_fn=<Error>)\r\n```\r\n\r\nRelated codes are [here](https://github.com/pytorch/pytorch/blob/2ead3b0e54c0e53d3ab20c0b87a4aea873f6172d/torch/_tensor_str.py#L223-L227). How should I fix this? cc @colesbury \r\n\r\nEDIT: `print(d.to_dense())` is legit since there is not grad_fn defined for `to_dense`, `print(d._indices().grad_fn)` and `print(d._values().grad_fn)` are probably legit too since their grad_fn are not defined."}