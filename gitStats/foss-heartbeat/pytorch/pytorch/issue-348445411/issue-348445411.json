{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10322", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10322/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10322/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10322/events", "html_url": "https://github.com/pytorch/pytorch/issues/10322", "id": 348445411, "node_id": "MDU6SXNzdWUzNDg0NDU0MTE=", "number": 10322, "title": "RecurrentNetworkParallelTest.test_equiv_recurrent intermittently fails", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-07T18:54:32Z", "updated_at": "2018-11-05T17:16:56Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<pre><code>16:25:19 =================================== FAILURES ===================================\n16:25:19 ______________ RecurrentNetworkParallelTest.test_equiv_recurrent _______________\n16:25:19 \n16:25:19 self = &lt;caffe2.python.data_parallel_model_test.RecurrentNetworkParallelTest testMethod=test_equiv_recurrent&gt;\n16:25:19 \n16:25:19     def test_equiv_recurrent(self):\n16:25:19         '''\n16:25:19             Test that the model produces exactly same results given\n16:25:19             total batchsize, independent of number of GPUs/CPUs.\n16:25:19             '''\n16:25:19         for gpu in [True, False]:\n16:25:19             if gpu and not workspace.has_gpu_support:\n16:25:19                 continue\n16:25:19             result_2gpus = self.run_model([0, 1], gpu)\n16:25:19             result_1gpus = self.run_model([0], gpu)\n16:25:19     \n16:25:19             self.assertTrue(np.allclose(result_1gpus, result_2gpus))\n16:25:19     \n16:25:19             if not gpu or workspace.NumCudaDevices() &gt;= 4:\n16:25:19 &gt;               result_4gpus = self.run_model(list(range(4)), gpu)\n16:25:19 \n16:25:19 lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py:584: \n16:25:19 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n16:25:19 lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py:566: in run_model\n16:25:19     workspace.RunNet(model.net.Proto().name)\n16:25:19 lib/python2.7/dist-packages/caffe2/python/workspace.py:219: in RunNet\n16:25:19     StringifyNetName(name), num_iter, allow_fail,\n16:25:19 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n16:25:19 \n16:25:19 func = &lt;built-in method run_net of PyCapsule object at 0x7f9819397660&gt;\n16:25:19 op_id_fetcher = &lt;bound method Workspace._last_failed_op_net_position of &lt;caffe2.python.caffe2_pybind11_state.Workspace object at 0x7f9821ee3030&gt;&gt;\n16:25:19 net_name = 'recurrent_test[0, 1, 2, 3]'\n16:25:19 args = ('recurrent_test[0, 1, 2, 3]', 1, False), kwargs = {}, op_id = 11\n16:25:19 net_tracebacks = {0: [('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/helpers/fc.py', 54, '_FC_or_packed_FC'), ('/usr/loc.../usr/lib/python2.7/unittest/case.py', 329, 'run'), ('/usr/lib/python2.7/unittest/case.py', 393, '__call__'), ...], ...}\n16:25:19 tb = [('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/recurrent.py', 278, 'recurrent_net'), ('/usr/local/caff...'), ('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py', 532, 'run_model'), ...]\n16:25:19 line = ('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/recurrent.py', 278, 'recurrent_net')\n16:25:19 \n16:25:19     def CallWithExceptionIntercept(func, op_id_fetcher, net_name, *args, **kwargs):\n16:25:19         try:\n16:25:19 &gt;           return func(*args, **kwargs)\n16:25:19 E           IndexError: map::at\n16:25:19 \n16:25:19 lib/python2.7/dist-packages/caffe2/python/workspace.py:180: IndexError\n</code></pre>\n<p>Sample log: <a href=\"https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-test/11362//console\" rel=\"nofollow\">https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-test/11362//console</a></p>", "body_text": "16:25:19 =================================== FAILURES ===================================\n16:25:19 ______________ RecurrentNetworkParallelTest.test_equiv_recurrent _______________\n16:25:19 \n16:25:19 self = <caffe2.python.data_parallel_model_test.RecurrentNetworkParallelTest testMethod=test_equiv_recurrent>\n16:25:19 \n16:25:19     def test_equiv_recurrent(self):\n16:25:19         '''\n16:25:19             Test that the model produces exactly same results given\n16:25:19             total batchsize, independent of number of GPUs/CPUs.\n16:25:19             '''\n16:25:19         for gpu in [True, False]:\n16:25:19             if gpu and not workspace.has_gpu_support:\n16:25:19                 continue\n16:25:19             result_2gpus = self.run_model([0, 1], gpu)\n16:25:19             result_1gpus = self.run_model([0], gpu)\n16:25:19     \n16:25:19             self.assertTrue(np.allclose(result_1gpus, result_2gpus))\n16:25:19     \n16:25:19             if not gpu or workspace.NumCudaDevices() >= 4:\n16:25:19 >               result_4gpus = self.run_model(list(range(4)), gpu)\n16:25:19 \n16:25:19 lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py:584: \n16:25:19 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n16:25:19 lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py:566: in run_model\n16:25:19     workspace.RunNet(model.net.Proto().name)\n16:25:19 lib/python2.7/dist-packages/caffe2/python/workspace.py:219: in RunNet\n16:25:19     StringifyNetName(name), num_iter, allow_fail,\n16:25:19 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n16:25:19 \n16:25:19 func = <built-in method run_net of PyCapsule object at 0x7f9819397660>\n16:25:19 op_id_fetcher = <bound method Workspace._last_failed_op_net_position of <caffe2.python.caffe2_pybind11_state.Workspace object at 0x7f9821ee3030>>\n16:25:19 net_name = 'recurrent_test[0, 1, 2, 3]'\n16:25:19 args = ('recurrent_test[0, 1, 2, 3]', 1, False), kwargs = {}, op_id = 11\n16:25:19 net_tracebacks = {0: [('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/helpers/fc.py', 54, '_FC_or_packed_FC'), ('/usr/loc.../usr/lib/python2.7/unittest/case.py', 329, 'run'), ('/usr/lib/python2.7/unittest/case.py', 393, '__call__'), ...], ...}\n16:25:19 tb = [('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/recurrent.py', 278, 'recurrent_net'), ('/usr/local/caff...'), ('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py', 532, 'run_model'), ...]\n16:25:19 line = ('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/recurrent.py', 278, 'recurrent_net')\n16:25:19 \n16:25:19     def CallWithExceptionIntercept(func, op_id_fetcher, net_name, *args, **kwargs):\n16:25:19         try:\n16:25:19 >           return func(*args, **kwargs)\n16:25:19 E           IndexError: map::at\n16:25:19 \n16:25:19 lib/python2.7/dist-packages/caffe2/python/workspace.py:180: IndexError\n\nSample log: https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-test/11362//console", "body": "```\r\n16:25:19 =================================== FAILURES ===================================\r\n16:25:19 ______________ RecurrentNetworkParallelTest.test_equiv_recurrent _______________\r\n16:25:19 \r\n16:25:19 self = <caffe2.python.data_parallel_model_test.RecurrentNetworkParallelTest testMethod=test_equiv_recurrent>\r\n16:25:19 \r\n16:25:19     def test_equiv_recurrent(self):\r\n16:25:19         '''\r\n16:25:19             Test that the model produces exactly same results given\r\n16:25:19             total batchsize, independent of number of GPUs/CPUs.\r\n16:25:19             '''\r\n16:25:19         for gpu in [True, False]:\r\n16:25:19             if gpu and not workspace.has_gpu_support:\r\n16:25:19                 continue\r\n16:25:19             result_2gpus = self.run_model([0, 1], gpu)\r\n16:25:19             result_1gpus = self.run_model([0], gpu)\r\n16:25:19     \r\n16:25:19             self.assertTrue(np.allclose(result_1gpus, result_2gpus))\r\n16:25:19     \r\n16:25:19             if not gpu or workspace.NumCudaDevices() >= 4:\r\n16:25:19 >               result_4gpus = self.run_model(list(range(4)), gpu)\r\n16:25:19 \r\n16:25:19 lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py:584: \r\n16:25:19 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n16:25:19 lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py:566: in run_model\r\n16:25:19     workspace.RunNet(model.net.Proto().name)\r\n16:25:19 lib/python2.7/dist-packages/caffe2/python/workspace.py:219: in RunNet\r\n16:25:19     StringifyNetName(name), num_iter, allow_fail,\r\n16:25:19 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n16:25:19 \r\n16:25:19 func = <built-in method run_net of PyCapsule object at 0x7f9819397660>\r\n16:25:19 op_id_fetcher = <bound method Workspace._last_failed_op_net_position of <caffe2.python.caffe2_pybind11_state.Workspace object at 0x7f9821ee3030>>\r\n16:25:19 net_name = 'recurrent_test[0, 1, 2, 3]'\r\n16:25:19 args = ('recurrent_test[0, 1, 2, 3]', 1, False), kwargs = {}, op_id = 11\r\n16:25:19 net_tracebacks = {0: [('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/helpers/fc.py', 54, '_FC_or_packed_FC'), ('/usr/loc.../usr/lib/python2.7/unittest/case.py', 329, 'run'), ('/usr/lib/python2.7/unittest/case.py', 393, '__call__'), ...], ...}\r\n16:25:19 tb = [('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/recurrent.py', 278, 'recurrent_net'), ('/usr/local/caff...'), ('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/data_parallel_model_test.py', 532, 'run_model'), ...]\r\n16:25:19 line = ('/usr/local/caffe2/lib/python2.7/dist-packages/caffe2/python/recurrent.py', 278, 'recurrent_net')\r\n16:25:19 \r\n16:25:19     def CallWithExceptionIntercept(func, op_id_fetcher, net_name, *args, **kwargs):\r\n16:25:19         try:\r\n16:25:19 >           return func(*args, **kwargs)\r\n16:25:19 E           IndexError: map::at\r\n16:25:19 \r\n16:25:19 lib/python2.7/dist-packages/caffe2/python/workspace.py:180: IndexError\r\n```\r\n\r\nSample log: https://ci.pytorch.org/jenkins/job/caffe2-builds/job/py2-mkl-ubuntu16.04-test/11362//console"}