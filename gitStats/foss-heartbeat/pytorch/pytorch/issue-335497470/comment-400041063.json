{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/400041063", "html_url": "https://github.com/pytorch/pytorch/issues/8853#issuecomment-400041063", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/8853", "id": 400041063, "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDA0MTA2Mw==", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-25T17:59:15Z", "updated_at": "2018-06-25T17:59:15Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Also:</p>\n<ul>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"228531657\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/1550\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/1550/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/1550\">#1550</a></li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"266403375\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/pytorch/pytorch/issues/3158\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pytorch/pytorch/issues/3158/hovercard\" href=\"https://github.com/pytorch/pytorch/issues/3158\">#3158</a></li>\n</ul>\n<p>Also Wojciej has been posting about these recently. He'd like some variant of this script to work:</p>\n<pre><code># sparse matrix (e.g. weights)\nindices = torch.LongTensor([[0,2], [1,0], [1,2]])\nindices = indices.transpose(1,0).contiguous()\nvalues = torch.FloatTensor(int(indices.view(-1).size(0)/2)).uniform_(-1,1)\nt = torch.sparse.FloatTensor(indices, values, torch.Size([10,10])).cuda()\n\n# sparse vector (e.g. activations)\nv = torch.sparse.FloatTensor(\n    torch.LongTensor([[0], [1], [2]]).transpose(1,0), \n    torch.FloatTensor([3,4,5]),\n    torch.Size([10])\n).cuda()\n\n# works fine\nprint(F.linear(v.to_dense(), t.to_dense()))\n\n# RuntimeError: numel is not implemented for type torch.cuda.sparse.FloatTensor\n# print(F.linear(v, t.to_dense()))\n\n# RuntimeError: numel is not implemented for type torch.cuda.sparse.FloatTensor\n# print(F.linear(v, t)\n\n# RuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.cuda.sparse.FloatTensor for argument #2 'mat2'\n# print(F.linear(v.to_dense(), t))\n</code></pre>", "body_text": "Also:\n\n#1550\n#3158\n\nAlso Wojciej has been posting about these recently. He'd like some variant of this script to work:\n# sparse matrix (e.g. weights)\nindices = torch.LongTensor([[0,2], [1,0], [1,2]])\nindices = indices.transpose(1,0).contiguous()\nvalues = torch.FloatTensor(int(indices.view(-1).size(0)/2)).uniform_(-1,1)\nt = torch.sparse.FloatTensor(indices, values, torch.Size([10,10])).cuda()\n\n# sparse vector (e.g. activations)\nv = torch.sparse.FloatTensor(\n    torch.LongTensor([[0], [1], [2]]).transpose(1,0), \n    torch.FloatTensor([3,4,5]),\n    torch.Size([10])\n).cuda()\n\n# works fine\nprint(F.linear(v.to_dense(), t.to_dense()))\n\n# RuntimeError: numel is not implemented for type torch.cuda.sparse.FloatTensor\n# print(F.linear(v, t.to_dense()))\n\n# RuntimeError: numel is not implemented for type torch.cuda.sparse.FloatTensor\n# print(F.linear(v, t)\n\n# RuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.cuda.sparse.FloatTensor for argument #2 'mat2'\n# print(F.linear(v.to_dense(), t))", "body": "Also:\r\n- https://github.com/pytorch/pytorch/issues/1550\r\n- https://github.com/pytorch/pytorch/issues/3158\r\n\r\nAlso Wojciej has been posting about these recently. He'd like some variant of this script to work:\r\n\r\n```\r\n# sparse matrix (e.g. weights)\r\nindices = torch.LongTensor([[0,2], [1,0], [1,2]])\r\nindices = indices.transpose(1,0).contiguous()\r\nvalues = torch.FloatTensor(int(indices.view(-1).size(0)/2)).uniform_(-1,1)\r\nt = torch.sparse.FloatTensor(indices, values, torch.Size([10,10])).cuda()\r\n\r\n# sparse vector (e.g. activations)\r\nv = torch.sparse.FloatTensor(\r\n    torch.LongTensor([[0], [1], [2]]).transpose(1,0), \r\n    torch.FloatTensor([3,4,5]),\r\n    torch.Size([10])\r\n).cuda()\r\n\r\n# works fine\r\nprint(F.linear(v.to_dense(), t.to_dense()))\r\n\r\n# RuntimeError: numel is not implemented for type torch.cuda.sparse.FloatTensor\r\n# print(F.linear(v, t.to_dense()))\r\n\r\n# RuntimeError: numel is not implemented for type torch.cuda.sparse.FloatTensor\r\n# print(F.linear(v, t)\r\n\r\n# RuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.cuda.sparse.FloatTensor for argument #2 'mat2'\r\n# print(F.linear(v.to_dense(), t))\r\n```"}