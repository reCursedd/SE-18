{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/334310943", "html_url": "https://github.com/pytorch/pytorch/issues/2972#issuecomment-334310943", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/2972", "id": 334310943, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNDMxMDk0Mw==", "user": {"login": "svenstaro", "id": 1664, "node_id": "MDQ6VXNlcjE2NjQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/svenstaro", "html_url": "https://github.com/svenstaro", "followers_url": "https://api.github.com/users/svenstaro/followers", "following_url": "https://api.github.com/users/svenstaro/following{/other_user}", "gists_url": "https://api.github.com/users/svenstaro/gists{/gist_id}", "starred_url": "https://api.github.com/users/svenstaro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/svenstaro/subscriptions", "organizations_url": "https://api.github.com/users/svenstaro/orgs", "repos_url": "https://api.github.com/users/svenstaro/repos", "events_url": "https://api.github.com/users/svenstaro/events{/privacy}", "received_events_url": "https://api.github.com/users/svenstaro/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-04T22:44:41Z", "updated_at": "2017-10-04T22:44:41Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I compile with this line:</p>\n<pre><code>  CC=gcc-6 \\\n  CXX=g++-6 \\\n  CFLAGS=\"${CFLAGS/-fno-plt/}\" \\\n  CXXFLAGS=\"${CFLAGS/-fno-plt/}\" \\\n  WITH_CUDA=1 \\\n  CUDA_HOME=/opt/cuda \\\n  WITH_CUDNN=1 \\\n  CUDNN_LIB_DIR=/opt/cuda/lib64 \\\n  CUDNN_INCLUDE_DIR=/opt/cuda/include \\\n  TORCH_NVCC_FLAGS=\"-D__CUDA_NO_HALF_OPERATORS__\" \\\n  python setup.py build --verbose\n</code></pre>\n<p>and now I get this result:</p>\n<pre><code>Grabbing  src/nccl.h                          &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/include/nccl.h\nCompiling src/libwrap.cu                      &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/libwrap.o\nCompiling src/core.cu                         &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/core.o\nCompiling src/all_gather.cu                   &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_gather.o\nCompiling src/all_reduce.cu                   &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_reduce.o\nCompiling src/broadcast.cu                    &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/broadcast.o\nCompiling src/reduce.cu                       &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce.o\nCompiling src/reduce_scatter.cu               &gt; /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce_scatter.o\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\n6 errors detected in the compilation of \"/tmp/tmpxft_000048d4_00000000-11_all_gather.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_gather.o] Error 1\nmake[3]: *** Waiting for unfinished jobs....\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\n6 errors detected in the compilation of \"/tmp/tmpxft_00004908_00000000-11_broadcast.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/broadcast.o] Error 1\n6 errors detected in the compilation of \"/tmp/tmpxft_000048ee_00000000-11_all_reduce.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_reduce.o] Error 1\n6 errors detected in the compilation of \"/tmp/tmpxft_00004923_00000000-11_reduce.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce.o] Error 1\n6 errors detected in the compilation of \"/tmp/tmpxft_00004935_00000000-11_reduce_scatter.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce_scatter.o] Error 1\nptxas warning : Too big maxrregcount value specified 96, will be ignored\nptxas warning : Too big maxrregcount value specified 96, will be ignored\nmake[2]: *** [CMakeFiles/nccl.dir/build.make:61: lib/libnccl.so] Error 2\nmake[1]: *** [CMakeFiles/Makefile2:68: CMakeFiles/nccl.dir/all] Error 2\nmake: *** [Makefile:130: all] Error 2\n</code></pre>", "body_text": "I compile with this line:\n  CC=gcc-6 \\\n  CXX=g++-6 \\\n  CFLAGS=\"${CFLAGS/-fno-plt/}\" \\\n  CXXFLAGS=\"${CFLAGS/-fno-plt/}\" \\\n  WITH_CUDA=1 \\\n  CUDA_HOME=/opt/cuda \\\n  WITH_CUDNN=1 \\\n  CUDNN_LIB_DIR=/opt/cuda/lib64 \\\n  CUDNN_INCLUDE_DIR=/opt/cuda/include \\\n  TORCH_NVCC_FLAGS=\"-D__CUDA_NO_HALF_OPERATORS__\" \\\n  python setup.py build --verbose\n\nand now I get this result:\nGrabbing  src/nccl.h                          > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/include/nccl.h\nCompiling src/libwrap.cu                      > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/libwrap.o\nCompiling src/core.cu                         > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/core.o\nCompiling src/all_gather.cu                   > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_gather.o\nCompiling src/all_reduce.cu                   > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_reduce.o\nCompiling src/broadcast.cu                    > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/broadcast.o\nCompiling src/reduce.cu                       > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce.o\nCompiling src/reduce_scatter.cu               > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce_scatter.o\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\n6 errors detected in the compilation of \"/tmp/tmpxft_000048d4_00000000-11_all_gather.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_gather.o] Error 1\nmake[3]: *** Waiting for unfinished jobs....\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\n\n6 errors detected in the compilation of \"/tmp/tmpxft_00004908_00000000-11_broadcast.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/broadcast.o] Error 1\n6 errors detected in the compilation of \"/tmp/tmpxft_000048ee_00000000-11_all_reduce.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_reduce.o] Error 1\n6 errors detected in the compilation of \"/tmp/tmpxft_00004923_00000000-11_reduce.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce.o] Error 1\n6 errors detected in the compilation of \"/tmp/tmpxft_00004935_00000000-11_reduce_scatter.compute_61.cpp1.ii\".\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce_scatter.o] Error 1\nptxas warning : Too big maxrregcount value specified 96, will be ignored\nptxas warning : Too big maxrregcount value specified 96, will be ignored\nmake[2]: *** [CMakeFiles/nccl.dir/build.make:61: lib/libnccl.so] Error 2\nmake[1]: *** [CMakeFiles/Makefile2:68: CMakeFiles/nccl.dir/all] Error 2\nmake: *** [Makefile:130: all] Error 2", "body": "I compile with this line:\r\n\r\n```\r\n  CC=gcc-6 \\\r\n  CXX=g++-6 \\\r\n  CFLAGS=\"${CFLAGS/-fno-plt/}\" \\\r\n  CXXFLAGS=\"${CFLAGS/-fno-plt/}\" \\\r\n  WITH_CUDA=1 \\\r\n  CUDA_HOME=/opt/cuda \\\r\n  WITH_CUDNN=1 \\\r\n  CUDNN_LIB_DIR=/opt/cuda/lib64 \\\r\n  CUDNN_INCLUDE_DIR=/opt/cuda/include \\\r\n  TORCH_NVCC_FLAGS=\"-D__CUDA_NO_HALF_OPERATORS__\" \\\r\n  python setup.py build --verbose\r\n```\r\n\r\nand now I get this result:\r\n\r\n```\r\nGrabbing  src/nccl.h                          > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/include/nccl.h\r\nCompiling src/libwrap.cu                      > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/libwrap.o\r\nCompiling src/core.cu                         > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/core.o\r\nCompiling src/all_gather.cu                   > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_gather.o\r\nCompiling src/all_reduce.cu                   > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_reduce.o\r\nCompiling src/broadcast.cu                    > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/broadcast.o\r\nCompiling src/reduce.cu                       > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce.o\r\nCompiling src/reduce_scatter.cu               > /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce_scatter.o\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\n6 errors detected in the compilation of \"/tmp/tmpxft_000048d4_00000000-11_all_gather.compute_61.cpp1.ii\".\r\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_gather.o] Error 1\r\nmake[3]: *** Waiting for unfinished jobs....\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(42): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/common_kernel.h(55): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\nsrc/copy_kernel.h(28): error: class \"__half\" has no member \"x\"\r\n\r\n6 errors detected in the compilation of \"/tmp/tmpxft_00004908_00000000-11_broadcast.compute_61.cpp1.ii\".\r\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/broadcast.o] Error 1\r\n6 errors detected in the compilation of \"/tmp/tmpxft_000048ee_00000000-11_all_reduce.compute_61.cpp1.ii\".\r\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/all_reduce.o] Error 1\r\n6 errors detected in the compilation of \"/tmp/tmpxft_00004923_00000000-11_reduce.compute_61.cpp1.ii\".\r\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce.o] Error 1\r\n6 errors detected in the compilation of \"/tmp/tmpxft_00004935_00000000-11_reduce_scatter.compute_61.cpp1.ii\".\r\nmake[3]: *** [Makefile:123: /build/python-pytorch/src/pytorch-0.2.0-py2-cuda/torch/lib/build/nccl/obj/reduce_scatter.o] Error 1\r\nptxas warning : Too big maxrregcount value specified 96, will be ignored\r\nptxas warning : Too big maxrregcount value specified 96, will be ignored\r\nmake[2]: *** [CMakeFiles/nccl.dir/build.make:61: lib/libnccl.so] Error 2\r\nmake[1]: *** [CMakeFiles/Makefile2:68: CMakeFiles/nccl.dir/all] Error 2\r\nmake: *** [Makefile:130: all] Error 2\r\n```"}