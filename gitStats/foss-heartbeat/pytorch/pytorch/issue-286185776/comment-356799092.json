{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/356799092", "html_url": "https://github.com/pytorch/pytorch/pull/4493#issuecomment-356799092", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/4493", "id": 356799092, "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njc5OTA5Mg==", "user": {"login": "yongjik", "id": 31876421, "node_id": "MDQ6VXNlcjMxODc2NDIx", "avatar_url": "https://avatars2.githubusercontent.com/u/31876421?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongjik", "html_url": "https://github.com/yongjik", "followers_url": "https://api.github.com/users/yongjik/followers", "following_url": "https://api.github.com/users/yongjik/following{/other_user}", "gists_url": "https://api.github.com/users/yongjik/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongjik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongjik/subscriptions", "organizations_url": "https://api.github.com/users/yongjik/orgs", "repos_url": "https://api.github.com/users/yongjik/repos", "events_url": "https://api.github.com/users/yongjik/events{/privacy}", "received_events_url": "https://api.github.com/users/yongjik/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-11T01:54:12Z", "updated_at": "2018-01-11T01:54:12Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi, sorry for the delay, but I have run some experiments and here's the result: <a href=\"https://github.com/yongjik/pt_test/tree/master/results/index_select\">https://github.com/yongjik/pt_test/tree/master/results/index_select</a></p>\n<p>Here's some highlights.</p>\n<p>Among the 81869 configurations I ran some index operations, kernel execution time changed by:</p>\n<pre><code>  =========================\n  BAD   &gt; 20%        :     6\n  Bad   10 .. 20%    :    15\n  bad   5 .. 10%     :    34\n        -5 .. 5%     : 79785\n  good  -10 .. -5%   :   744\n  Good  -20 .. -10%  :   482\n  GOOD  -50% .. -20% :   472\n  BEST  &lt; -50%       :   331\n</code></pre>\n<p>Moreover, all six BAD cases (execution time increased by up to 21%) belong to the weird <code>index_fill_</code> I mentioned in my first comment above.  It's possible that I'm missing some cases: after all, I created all these tests by going through permutations, so there's a lot of \"variations of the same theme\".  However, the trend seems quite positive to me.</p>\n<p>A realistic example is in line 84354 of <a href=\"https://raw.githubusercontent.com/yongjik/pt_test/master/results/index_select/SCORES.txt\" rel=\"nofollow\">https://raw.githubusercontent.com/yongjik/pt_test/master/results/index_select/SCORES.txt</a></p>\n<p>(Sorry for the data dump.  I wasn't planning to show it to anyone, so the format is rather ugly.  You might want to download the file and open it in some editor.)</p>\n<p>Here, we have source tensor of (512, 255) and dest tensor of (512, 256), applying index operations on columns.  Everything I can throw at it shows 9-15% improvement.  See the first link above for more examples.  (Some large tensors show up to 13x improvement.)</p>", "body_text": "Hi, sorry for the delay, but I have run some experiments and here's the result: https://github.com/yongjik/pt_test/tree/master/results/index_select\nHere's some highlights.\nAmong the 81869 configurations I ran some index operations, kernel execution time changed by:\n  =========================\n  BAD   > 20%        :     6\n  Bad   10 .. 20%    :    15\n  bad   5 .. 10%     :    34\n        -5 .. 5%     : 79785\n  good  -10 .. -5%   :   744\n  Good  -20 .. -10%  :   482\n  GOOD  -50% .. -20% :   472\n  BEST  < -50%       :   331\n\nMoreover, all six BAD cases (execution time increased by up to 21%) belong to the weird index_fill_ I mentioned in my first comment above.  It's possible that I'm missing some cases: after all, I created all these tests by going through permutations, so there's a lot of \"variations of the same theme\".  However, the trend seems quite positive to me.\nA realistic example is in line 84354 of https://raw.githubusercontent.com/yongjik/pt_test/master/results/index_select/SCORES.txt\n(Sorry for the data dump.  I wasn't planning to show it to anyone, so the format is rather ugly.  You might want to download the file and open it in some editor.)\nHere, we have source tensor of (512, 255) and dest tensor of (512, 256), applying index operations on columns.  Everything I can throw at it shows 9-15% improvement.  See the first link above for more examples.  (Some large tensors show up to 13x improvement.)", "body": "Hi, sorry for the delay, but I have run some experiments and here's the result: https://github.com/yongjik/pt_test/tree/master/results/index_select\r\n\r\nHere's some highlights.\r\n\r\nAmong the 81869 configurations I ran some index operations, kernel execution time changed by:\r\n\r\n      =========================\r\n      BAD   > 20%        :     6\r\n      Bad   10 .. 20%    :    15\r\n      bad   5 .. 10%     :    34\r\n            -5 .. 5%     : 79785\r\n      good  -10 .. -5%   :   744\r\n      Good  -20 .. -10%  :   482\r\n      GOOD  -50% .. -20% :   472\r\n      BEST  < -50%       :   331\r\n\r\nMoreover, all six BAD cases (execution time increased by up to 21%) belong to the weird `index_fill_` I mentioned in my first comment above.  It's possible that I'm missing some cases: after all, I created all these tests by going through permutations, so there's a lot of \"variations of the same theme\".  However, the trend seems quite positive to me.\r\n\r\nA realistic example is in line 84354 of https://raw.githubusercontent.com/yongjik/pt_test/master/results/index_select/SCORES.txt\r\n\r\n(Sorry for the data dump.  I wasn't planning to show it to anyone, so the format is rather ugly.  You might want to download the file and open it in some editor.)\r\n\r\nHere, we have source tensor of (512, 255) and dest tensor of (512, 256), applying index operations on columns.  Everything I can throw at it shows 9-15% improvement.  See the first link above for more examples.  (Some large tensors show up to 13x improvement.)\r\n"}