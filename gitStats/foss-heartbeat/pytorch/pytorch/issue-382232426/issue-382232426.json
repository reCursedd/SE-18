{"url": "https://api.github.com/repos/pytorch/pytorch/issues/14188", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/14188/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/14188/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/14188/events", "html_url": "https://github.com/pytorch/pytorch/issues/14188", "id": 382232426, "node_id": "MDU6SXNzdWUzODIyMzI0MjY=", "number": 14188, "title": "[C++ Extensions] Accepted compilers doesn't handle Python 2", "user": {"login": "fmassa", "id": 9110200, "node_id": "MDQ6VXNlcjkxMTAyMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9110200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmassa", "html_url": "https://github.com/fmassa", "followers_url": "https://api.github.com/users/fmassa/followers", "following_url": "https://api.github.com/users/fmassa/following{/other_user}", "gists_url": "https://api.github.com/users/fmassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmassa/subscriptions", "organizations_url": "https://api.github.com/users/fmassa/orgs", "repos_url": "https://api.github.com/users/fmassa/repos", "events_url": "https://api.github.com/users/fmassa/events{/privacy}", "received_events_url": "https://api.github.com/users/fmassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 884152160, "node_id": "MDU6TGFiZWw4ODQxNTIxNjA=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/cpp-extensions", "name": "cpp-extensions", "color": "1c689e", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-19T14:11:57Z", "updated_at": "2018-11-19T14:14:46Z", "closed_at": null, "author_association": "MEMBER", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>The result of <a href=\"https://stackoverflow.com/questions/10415942/python-sys-platform-linux2-but-not-linux3\" rel=\"nofollow\">sys.platform in python 2 and python &lt; 3.3</a> used to return <code>linux2</code> or <code>linux3</code> depending on the version of python.<br>\nIn <a href=\"https://github.com/pytorch/pytorch/blob/5b1b8682a303379e8f52c282399540750e0b8200/torch/utils/cpp_extension.py#L138\">ACCEPTED_COMPILERS_FOR_PLATFORM</a>, we currently <a href=\"https://github.com/pytorch/pytorch/blob/5b1b8682a303379e8f52c282399540750e0b8200/torch/utils/cpp_extension.py#L87\">hard-code <code>linux</code></a>, which breaks when using Python 2 with errors such as</p>\n<pre><code>check_compiler_abi_compatibility(compiler)\nFile \"/home/deep/anaconda2/lib/python2.7/site-packages/torch/utils/cpp_extension.py\", line 160, in check_compiler_abi_compatibility\nif not check_compiler_ok_for_platform(compiler):\nFile \"/home/deep/anaconda2/lib/python2.7/site-packages/torch/utils/cpp_extension.py\", line 138, in check_compiler_ok_for_platform\naccepted_compilers = ACCEPTED_COMPILERS_FOR_PLATFORM[sys.platform]\nKeyError: 'linux2'\n</code></pre>\n<p>see <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"382083885\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/facebookresearch/maskrcnn-benchmark/issues/174\" data-hovercard-type=\"issue\" data-hovercard-url=\"/facebookresearch/maskrcnn-benchmark/issues/174/hovercard\" href=\"https://github.com/facebookresearch/maskrcnn-benchmark/issues/174\">facebookresearch/maskrcnn-benchmark#174</a> for an example where this broke.</p>\n<p>cc <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6429851\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/goldsborough\">@goldsborough</a></p>", "body_text": "\ud83d\udc1b Bug\nThe result of sys.platform in python 2 and python < 3.3 used to return linux2 or linux3 depending on the version of python.\nIn ACCEPTED_COMPILERS_FOR_PLATFORM, we currently hard-code linux, which breaks when using Python 2 with errors such as\ncheck_compiler_abi_compatibility(compiler)\nFile \"/home/deep/anaconda2/lib/python2.7/site-packages/torch/utils/cpp_extension.py\", line 160, in check_compiler_abi_compatibility\nif not check_compiler_ok_for_platform(compiler):\nFile \"/home/deep/anaconda2/lib/python2.7/site-packages/torch/utils/cpp_extension.py\", line 138, in check_compiler_ok_for_platform\naccepted_compilers = ACCEPTED_COMPILERS_FOR_PLATFORM[sys.platform]\nKeyError: 'linux2'\n\nsee facebookresearch/maskrcnn-benchmark#174 for an example where this broke.\ncc @goldsborough", "body": "## \ud83d\udc1b Bug\r\n\r\nThe result of [sys.platform in python 2 and python < 3.3](https://stackoverflow.com/questions/10415942/python-sys-platform-linux2-but-not-linux3) used to return `linux2` or `linux3` depending on the version of python.\r\nIn [ACCEPTED_COMPILERS_FOR_PLATFORM](https://github.com/pytorch/pytorch/blob/5b1b8682a303379e8f52c282399540750e0b8200/torch/utils/cpp_extension.py#L138), we currently [hard-code `linux`](https://github.com/pytorch/pytorch/blob/5b1b8682a303379e8f52c282399540750e0b8200/torch/utils/cpp_extension.py#L87), which breaks when using Python 2 with errors such as \r\n```\r\ncheck_compiler_abi_compatibility(compiler)\r\nFile \"/home/deep/anaconda2/lib/python2.7/site-packages/torch/utils/cpp_extension.py\", line 160, in check_compiler_abi_compatibility\r\nif not check_compiler_ok_for_platform(compiler):\r\nFile \"/home/deep/anaconda2/lib/python2.7/site-packages/torch/utils/cpp_extension.py\", line 138, in check_compiler_ok_for_platform\r\naccepted_compilers = ACCEPTED_COMPILERS_FOR_PLATFORM[sys.platform]\r\nKeyError: 'linux2'\r\n```\r\nsee https://github.com/facebookresearch/maskrcnn-benchmark/issues/174 for an example where this broke.\r\n\r\ncc @goldsborough "}