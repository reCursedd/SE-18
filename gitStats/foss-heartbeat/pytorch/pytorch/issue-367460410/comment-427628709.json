{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/427628709", "html_url": "https://github.com/pytorch/pytorch/issues/12419#issuecomment-427628709", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/12419", "id": 427628709, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzYyODcwOQ==", "user": {"login": "zl535320706", "id": 24400111, "node_id": "MDQ6VXNlcjI0NDAwMTEx", "avatar_url": "https://avatars2.githubusercontent.com/u/24400111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zl535320706", "html_url": "https://github.com/zl535320706", "followers_url": "https://api.github.com/users/zl535320706/followers", "following_url": "https://api.github.com/users/zl535320706/following{/other_user}", "gists_url": "https://api.github.com/users/zl535320706/gists{/gist_id}", "starred_url": "https://api.github.com/users/zl535320706/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zl535320706/subscriptions", "organizations_url": "https://api.github.com/users/zl535320706/orgs", "repos_url": "https://api.github.com/users/zl535320706/repos", "events_url": "https://api.github.com/users/zl535320706/events{/privacy}", "received_events_url": "https://api.github.com/users/zl535320706/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-07T06:09:28Z", "updated_at": "2018-10-08T05:05:45Z", "author_association": "NONE", "body_html": "<blockquote>\n<p>You got unlucky and cloned a broken commit. If you pull master and try again it should be fixed.</p>\n</blockquote>\n<p>I have the same problem, and I try again, but got the same errors.</p>\n<p>system info<br>\nOS: ubuntu 14.04<br>\nPython version: 3.6.6<br>\nCUDA/cuDNN version: 9.0<br>\nGPU models and configuration: Nvidia k40</p>\n<pre><code>[895/2308] Running gen_proto.py on onnx/onnx.in.proto\nProcessing /home/zhangli/pytorch/third_party/onnx/onnx/onnx.in.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto3\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx.pb.h\ngenerating /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_pb.py\n[900/2308] Running gen_proto.py on onnx/onnx-operators.in.proto\nProcessing /home/zhangli/pytorch/third_party/onnx/onnx/onnx-operators.in.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto3\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators.pb.h\ngenerating /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_operators_pb.py\n[1105/2308] Building CXX object caffe2/C.../src/ATen/native/mkl/LinearAlgebra.cpp.\nFAILED: caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o \n/usr/bin/c++  -DCPUINFO_SUPPORTED_PLATFORM=1 -DHAVE_MALLOC_USABLE_SIZE=1 -DHAVE_MMAP=1 -DHAVE_SHM_OPEN=1 -DHAVE_SHM_UNLINK=1 -DMAGMA_V2 -DNNP_CONVOLUTION_ONLY=0 -DNNP_INFERENCE_ONLY=0 -DONNX_NAMESPACE=onnx_torch -DTH_BLAS_MKL -DUSE_GCC_ATOMICS=1 -D_FILE_OFFSET_BITS=64 -Dcaffe2_EXPORTS -I../aten/src -I. -I../ -I../third_party/protobuf/src -I../cmake/../third_party/benchmark/include -Icaffe2/contrib/aten -I../third_party/onnx -Ithird_party/onnx -Icaffe2/aten/src/TH -I../aten/src/TH -Icaffe2/aten/src -Iaten/src -I../aten/src/THNN -I../aten/src/THCUNN -I../aten/../third_party/catch/single_include -Icaffe2/aten/src/ATen -I../aten/src/ATen/.. -I../caffe2/core/nomnigraph/include -I/home/zhangli/cuda-9.0/include -I../c10/.. -I../third_party/NNPACK/include -I../third_party/pthreadpool/include -I../third_party/cpuinfo/include -isystem third_party/gloo -isystem ../cmake/../third_party/gloo -isystem /opt/intel/mkl/include -isystem ../cmake/../third_party/googletest/googletest/include -isystem ../cmake/../third_party/eigen -isystem /home/zhangli/anaconda3/envs/pytorch/include/python3.6m -isystem /home/zhangli/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/core/include -isystem ../cmake/../third_party/pybind11/include -isystem /usr/lib/openmpi/include/openmpi -isystem /usr/lib/openmpi/include -isystem ../cmake/../third_party/cub -isystem /home/zhangli/anaconda3/envs/pytorch/include -isystem include -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -Wno-unused-but-set-variable -Wno-maybe-uninitialized -DHAVE_AVX_CPU_DEFINITION -O3  -fPIC   -DCUDA_HAS_FP16=1 -DHAVE_GCC_GET_CPUID -DUSE_SSE2 -DUSE_SSE4_1 -DUSE_SSE4_2 -DUSE_SSE3 -DUSE_AVX -DTH_HAVE_THREAD -fvisibility=hidden -DCAFFE2_BUILD_MAIN_LIB -O2 -std=gnu++11 -MD -MT caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o -MF caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o.d -o caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o -c ../aten/src/ATen/native/mkl/LinearAlgebra.cpp\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp: In function \u2018void at::native::gemm_batched(CBLAS_TRANSPOSE, CBLAS_TRANSPOSE, int, int, int, int, float, const float**, const float**, float, float**)\u2019:\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp:43:53: error: \u2018cblas_sgemm_batch\u2019 was not declared in this scope\n     A, &amp;lda, B, &amp;ldb, &amp;beta, C, &amp;ldc, 1, &amp;batch_size);\n                                                     ^\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp: In function \u2018void at::native::gemm_batched(CBLAS_TRANSPOSE, CBLAS_TRANSPOSE, int, int, int, int, double, const double**, const double**, double, double**)\u2019:\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp:54:53: error: \u2018cblas_dgemm_batch\u2019 was not declared in this scope\n     A, &amp;lda, B, &amp;ldb, &amp;beta, C, &amp;ldc, 1, &amp;batch_size);\n                                                     ^\n[1128/2308] Building CXX object caffe2/C...ten/src/ATen/core/register_symbols.cpp.\nninja: build stopped: subcommand failed.\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn caffe2 libshm gloo c10d THD'\n</code></pre>", "body_text": "You got unlucky and cloned a broken commit. If you pull master and try again it should be fixed.\n\nI have the same problem, and I try again, but got the same errors.\nsystem info\nOS: ubuntu 14.04\nPython version: 3.6.6\nCUDA/cuDNN version: 9.0\nGPU models and configuration: Nvidia k40\n[895/2308] Running gen_proto.py on onnx/onnx.in.proto\nProcessing /home/zhangli/pytorch/third_party/onnx/onnx/onnx.in.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto3\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx.pb.h\ngenerating /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_pb.py\n[900/2308] Running gen_proto.py on onnx/onnx-operators.in.proto\nProcessing /home/zhangli/pytorch/third_party/onnx/onnx/onnx-operators.in.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto3\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators.pb.h\ngenerating /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_operators_pb.py\n[1105/2308] Building CXX object caffe2/C.../src/ATen/native/mkl/LinearAlgebra.cpp.\nFAILED: caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o \n/usr/bin/c++  -DCPUINFO_SUPPORTED_PLATFORM=1 -DHAVE_MALLOC_USABLE_SIZE=1 -DHAVE_MMAP=1 -DHAVE_SHM_OPEN=1 -DHAVE_SHM_UNLINK=1 -DMAGMA_V2 -DNNP_CONVOLUTION_ONLY=0 -DNNP_INFERENCE_ONLY=0 -DONNX_NAMESPACE=onnx_torch -DTH_BLAS_MKL -DUSE_GCC_ATOMICS=1 -D_FILE_OFFSET_BITS=64 -Dcaffe2_EXPORTS -I../aten/src -I. -I../ -I../third_party/protobuf/src -I../cmake/../third_party/benchmark/include -Icaffe2/contrib/aten -I../third_party/onnx -Ithird_party/onnx -Icaffe2/aten/src/TH -I../aten/src/TH -Icaffe2/aten/src -Iaten/src -I../aten/src/THNN -I../aten/src/THCUNN -I../aten/../third_party/catch/single_include -Icaffe2/aten/src/ATen -I../aten/src/ATen/.. -I../caffe2/core/nomnigraph/include -I/home/zhangli/cuda-9.0/include -I../c10/.. -I../third_party/NNPACK/include -I../third_party/pthreadpool/include -I../third_party/cpuinfo/include -isystem third_party/gloo -isystem ../cmake/../third_party/gloo -isystem /opt/intel/mkl/include -isystem ../cmake/../third_party/googletest/googletest/include -isystem ../cmake/../third_party/eigen -isystem /home/zhangli/anaconda3/envs/pytorch/include/python3.6m -isystem /home/zhangli/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/core/include -isystem ../cmake/../third_party/pybind11/include -isystem /usr/lib/openmpi/include/openmpi -isystem /usr/lib/openmpi/include -isystem ../cmake/../third_party/cub -isystem /home/zhangli/anaconda3/envs/pytorch/include -isystem include -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -Wno-unused-but-set-variable -Wno-maybe-uninitialized -DHAVE_AVX_CPU_DEFINITION -O3  -fPIC   -DCUDA_HAS_FP16=1 -DHAVE_GCC_GET_CPUID -DUSE_SSE2 -DUSE_SSE4_1 -DUSE_SSE4_2 -DUSE_SSE3 -DUSE_AVX -DTH_HAVE_THREAD -fvisibility=hidden -DCAFFE2_BUILD_MAIN_LIB -O2 -std=gnu++11 -MD -MT caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o -MF caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o.d -o caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o -c ../aten/src/ATen/native/mkl/LinearAlgebra.cpp\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp: In function \u2018void at::native::gemm_batched(CBLAS_TRANSPOSE, CBLAS_TRANSPOSE, int, int, int, int, float, const float**, const float**, float, float**)\u2019:\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp:43:53: error: \u2018cblas_sgemm_batch\u2019 was not declared in this scope\n     A, &lda, B, &ldb, &beta, C, &ldc, 1, &batch_size);\n                                                     ^\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp: In function \u2018void at::native::gemm_batched(CBLAS_TRANSPOSE, CBLAS_TRANSPOSE, int, int, int, int, double, const double**, const double**, double, double**)\u2019:\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp:54:53: error: \u2018cblas_dgemm_batch\u2019 was not declared in this scope\n     A, &lda, B, &ldb, &beta, C, &ldc, 1, &batch_size);\n                                                     ^\n[1128/2308] Building CXX object caffe2/C...ten/src/ATen/core/register_symbols.cpp.\nninja: build stopped: subcommand failed.\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn caffe2 libshm gloo c10d THD'", "body": "> You got unlucky and cloned a broken commit. If you pull master and try again it should be fixed.\r\n\r\nI have the same problem, and I try again, but got the same errors.\r\n\r\nsystem info\r\nOS: ubuntu 14.04\r\nPython version: 3.6.6\r\nCUDA/cuDNN version: 9.0\r\nGPU models and configuration: Nvidia k40\r\n\r\n\r\n```\r\n[895/2308] Running gen_proto.py on onnx/onnx.in.proto\r\nProcessing /home/zhangli/pytorch/third_party/onnx/onnx/onnx.in.proto\r\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto\r\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_onnx_torch.proto3\r\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx.pb.h\r\ngenerating /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_pb.py\r\n[900/2308] Running gen_proto.py on onnx/onnx-operators.in.proto\r\nProcessing /home/zhangli/pytorch/third_party/onnx/onnx/onnx-operators.in.proto\r\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto\r\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators_onnx_torch.proto3\r\nWriting /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx-operators.pb.h\r\ngenerating /home/zhangli/pytorch/build/third_party/onnx/onnx/onnx_operators_pb.py\r\n[1105/2308] Building CXX object caffe2/C.../src/ATen/native/mkl/LinearAlgebra.cpp.\r\nFAILED: caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o \r\n/usr/bin/c++  -DCPUINFO_SUPPORTED_PLATFORM=1 -DHAVE_MALLOC_USABLE_SIZE=1 -DHAVE_MMAP=1 -DHAVE_SHM_OPEN=1 -DHAVE_SHM_UNLINK=1 -DMAGMA_V2 -DNNP_CONVOLUTION_ONLY=0 -DNNP_INFERENCE_ONLY=0 -DONNX_NAMESPACE=onnx_torch -DTH_BLAS_MKL -DUSE_GCC_ATOMICS=1 -D_FILE_OFFSET_BITS=64 -Dcaffe2_EXPORTS -I../aten/src -I. -I../ -I../third_party/protobuf/src -I../cmake/../third_party/benchmark/include -Icaffe2/contrib/aten -I../third_party/onnx -Ithird_party/onnx -Icaffe2/aten/src/TH -I../aten/src/TH -Icaffe2/aten/src -Iaten/src -I../aten/src/THNN -I../aten/src/THCUNN -I../aten/../third_party/catch/single_include -Icaffe2/aten/src/ATen -I../aten/src/ATen/.. -I../caffe2/core/nomnigraph/include -I/home/zhangli/cuda-9.0/include -I../c10/.. -I../third_party/NNPACK/include -I../third_party/pthreadpool/include -I../third_party/cpuinfo/include -isystem third_party/gloo -isystem ../cmake/../third_party/gloo -isystem /opt/intel/mkl/include -isystem ../cmake/../third_party/googletest/googletest/include -isystem ../cmake/../third_party/eigen -isystem /home/zhangli/anaconda3/envs/pytorch/include/python3.6m -isystem /home/zhangli/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/core/include -isystem ../cmake/../third_party/pybind11/include -isystem /usr/lib/openmpi/include/openmpi -isystem /usr/lib/openmpi/include -isystem ../cmake/../third_party/cub -isystem /home/zhangli/anaconda3/envs/pytorch/include -isystem include -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -Wno-unused-but-set-variable -Wno-maybe-uninitialized -DHAVE_AVX_CPU_DEFINITION -O3  -fPIC   -DCUDA_HAS_FP16=1 -DHAVE_GCC_GET_CPUID -DUSE_SSE2 -DUSE_SSE4_1 -DUSE_SSE4_2 -DUSE_SSE3 -DUSE_AVX -DTH_HAVE_THREAD -fvisibility=hidden -DCAFFE2_BUILD_MAIN_LIB -O2 -std=gnu++11 -MD -MT caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o -MF caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o.d -o caffe2/CMakeFiles/caffe2.dir/__/aten/src/ATen/native/mkl/LinearAlgebra.cpp.o -c ../aten/src/ATen/native/mkl/LinearAlgebra.cpp\r\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp: In function \u2018void at::native::gemm_batched(CBLAS_TRANSPOSE, CBLAS_TRANSPOSE, int, int, int, int, float, const float**, const float**, float, float**)\u2019:\r\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp:43:53: error: \u2018cblas_sgemm_batch\u2019 was not declared in this scope\r\n     A, &lda, B, &ldb, &beta, C, &ldc, 1, &batch_size);\r\n                                                     ^\r\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp: In function \u2018void at::native::gemm_batched(CBLAS_TRANSPOSE, CBLAS_TRANSPOSE, int, int, int, int, double, const double**, const double**, double, double**)\u2019:\r\n../aten/src/ATen/native/mkl/LinearAlgebra.cpp:54:53: error: \u2018cblas_dgemm_batch\u2019 was not declared in this scope\r\n     A, &lda, B, &ldb, &beta, C, &ldc, 1, &batch_size);\r\n                                                     ^\r\n[1128/2308] Building CXX object caffe2/C...ten/src/ATen/core/register_symbols.cpp.\r\nninja: build stopped: subcommand failed.\r\nFailed to run 'bash ../tools/build_pytorch_libs.sh --use-cuda --use-nnpack --use-mkldnn caffe2 libshm gloo c10d THD'\r\n```"}