{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/371672340", "html_url": "https://github.com/pytorch/pytorch/pull/5394#issuecomment-371672340", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5394", "id": 371672340, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTY3MjM0MA==", "user": {"login": "li-roy", "id": 8813817, "node_id": "MDQ6VXNlcjg4MTM4MTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/8813817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/li-roy", "html_url": "https://github.com/li-roy", "followers_url": "https://api.github.com/users/li-roy/followers", "following_url": "https://api.github.com/users/li-roy/following{/other_user}", "gists_url": "https://api.github.com/users/li-roy/gists{/gist_id}", "starred_url": "https://api.github.com/users/li-roy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/li-roy/subscriptions", "organizations_url": "https://api.github.com/users/li-roy/orgs", "repos_url": "https://api.github.com/users/li-roy/repos", "events_url": "https://api.github.com/users/li-roy/events{/privacy}", "received_events_url": "https://api.github.com/users/li-roy/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-09T00:28:17Z", "updated_at": "2018-03-09T00:28:17Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4583066\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/apaszke\">@apaszke</a> I think you mean <code>&lt;</code> if <code>floor(x) != x</code> and <code>&lt;=</code> otherwise? In any case that doesn't quite work because casting truncates towards 0. Thanks for the suggestion though, it gave me a very similar idea.</p>\n<p>If <code>floor(x) != x</code>:</p>\n<ul>\n<li>for ge, use <code>ceil(x)</code> instead of <code>x</code></li>\n<li>for le, use <code>floor(x)</code> instead of <code>x</code></li>\n<li>for eq, just fill with <code>0</code></li>\n<li>for ne, just fill with <code>1</code></li>\n</ul>\n<p>Ran the same benchmark script and it gives results that look more like master: <a href=\"https://gist.github.com/li-roy/164a2be5c341abccad8b534b2dce099e\">https://gist.github.com/li-roy/164a2be5c341abccad8b534b2dce099e</a></p>", "body_text": "@apaszke I think you mean < if floor(x) != x and <= otherwise? In any case that doesn't quite work because casting truncates towards 0. Thanks for the suggestion though, it gave me a very similar idea.\nIf floor(x) != x:\n\nfor ge, use ceil(x) instead of x\nfor le, use floor(x) instead of x\nfor eq, just fill with 0\nfor ne, just fill with 1\n\nRan the same benchmark script and it gives results that look more like master: https://gist.github.com/li-roy/164a2be5c341abccad8b534b2dce099e", "body": "@apaszke I think you mean `<` if `floor(x) != x` and `<=` otherwise? In any case that doesn't quite work because casting truncates towards 0. Thanks for the suggestion though, it gave me a very similar idea.\r\n\r\nIf `floor(x) != x`:\r\n- for ge, use `ceil(x)` instead of `x`\r\n- for le, use `floor(x)` instead of `x`\r\n- for eq, just fill with `0`\r\n- for ne, just fill with `1`\r\n\r\nRan the same benchmark script and it gives results that look more like master: https://gist.github.com/li-roy/164a2be5c341abccad8b534b2dce099e"}