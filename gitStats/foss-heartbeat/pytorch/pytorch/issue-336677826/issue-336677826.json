{"url": "https://api.github.com/repos/pytorch/pytorch/issues/8987", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/8987/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/8987/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/8987/events", "html_url": "https://github.com/pytorch/pytorch/issues/8987", "id": 336677826, "node_id": "MDU6SXNzdWUzMzY2Nzc4MjY=", "number": 8987, "title": "undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'", "user": {"login": "StatML", "id": 3596431, "node_id": "MDQ6VXNlcjM1OTY0MzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/3596431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/StatML", "html_url": "https://github.com/StatML", "followers_url": "https://api.github.com/users/StatML/followers", "following_url": "https://api.github.com/users/StatML/following{/other_user}", "gists_url": "https://api.github.com/users/StatML/gists{/gist_id}", "starred_url": "https://api.github.com/users/StatML/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/StatML/subscriptions", "organizations_url": "https://api.github.com/users/StatML/orgs", "repos_url": "https://api.github.com/users/StatML/repos", "events_url": "https://api.github.com/users/StatML/events{/privacy}", "received_events_url": "https://api.github.com/users/StatML/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2018-06-28T15:46:11Z", "updated_at": "2018-07-24T05:20:29Z", "closed_at": "2018-07-24T05:20:29Z", "author_association": "NONE", "body_html": "<p>Hi, I met the following issue when build pytorch from source. I can build caffe2 successfully by using <code>python3 setup_caffe2.py install</code>, but can not build pytorch by using <code>python3 setup.py install</code>. Does anyone know how to solve it? Thanks!</p>\n<h2>Issue description</h2>\n<p>Failed to run 'bash tools/build_pytorch_libs.sh --use-nnpack caffe2 nanopb libshm gloo THD'</p>\n<h2>Code example</h2>\n<p><code>python3 setup.py install</code></p>\n<h2>System Info</h2>\n<ul>\n<li>PyTorch or Caffe2: PyTorch</li>\n<li>How you installed PyTorch (conda, pip, source): source</li>\n<li>Build command you used (if compiling from source): <code>python3 setup.py install</code></li>\n<li>OS: Ubuntu 16.04</li>\n<li>PyTorch version: source code cloned from the master branch</li>\n<li>Python version: 3.5.2</li>\n<li>CUDA/cuDNN version: N/A</li>\n<li>GPU models and configuration: N/A</li>\n<li>GCC version (if compiling from source): 5.4</li>\n<li>CMake version: 3.11.0</li>\n<li>Versions of any other relevant libraries:</li>\n</ul>\n<pre><code>&gt; xxx@yyy:~/Project/svn-store/PyTorch/pytorch-git$ sudo tools/build_pytorch_libs.sh  --use-nnpack caffe2 nanopb libshm gloo THD\n&gt; + USE_CUDA=0\n&gt; + USE_ROCM=0\n&gt; + USE_NNPACK=0\n&gt; + USE_MKLDNN=0\n&gt; + USE_GLOO_IBVERBS=0\n&gt; + USE_DISTRIBUTED_MW=0\n&gt; + FULL_CAFFE2=0\n&gt; + [[ 6 -gt 0 ]]\n&gt; + case \"$1\" in\n&gt; + USE_NNPACK=1\n&gt; + shift\n&gt; + [[ 5 -gt 0 ]]\n&gt; + case \"$1\" in\n&gt; + break\n&gt; + CMAKE_INSTALL='make install'\n&gt; + USER_CFLAGS=\n&gt; + USER_LDFLAGS=\n&gt; + [[ -n '' ]]\n&gt; + [[ -n '' ]]\n&gt; + [[ -n '' ]]\n&gt; ++ dirname tools/build_pytorch_libs.sh\n&gt; + cd tools/..\n&gt; +++ pwd\n&gt; ++ printf '%q\\n' /home/xxx/Project/svn-store/PyTorch/pytorch-git\n&gt; + PWD=/home/xxx/Project/svn-store/PyTorch/pytorch-git\n&gt; + BASE_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git\n&gt; + TORCH_LIB_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib\n&gt; + INSTALL_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\n&gt; + THIRD_PARTY_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/third_party\n&gt; + CMAKE_VERSION=cmake\n&gt; + C_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\"'\n&gt; + C_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n&gt; + LDFLAGS='-L\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/lib\" '\n&gt; + LD_POSTFIX=.so\n&gt; ++ uname\n&gt; + [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n&gt; + LDFLAGS='-L\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\n&gt; + CPP_FLAGS=' -std=c++11 '\n&gt; + GLOO_FLAGS=\n&gt; + THD_FLAGS=\n&gt; + NCCL_ROOT_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\n&gt; + [[ 0 -eq 1 ]]\n&gt; + [[ 0 -eq 1 ]]\n&gt; + [[ 0 -eq 1 ]]\n&gt; + CWRAP_FILES='/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/ATen/Declarations.cwrap;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/THNN/generic/THNN.h;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/THCUNN/generic/THCUNN.h;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/ATen/nn.yaml'\n&gt; + CUDA_NVCC_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n&gt; + [[ -z '' ]]\n&gt; + CUDA_DEVICE_DEBUG=0\n&gt; + '[' -z '' ']'\n&gt; ++ getconf _NPROCESSORS_ONLN\n&gt; + NUM_JOBS=4\n&gt; + BUILD_TYPE=Release\n&gt; + [[ -n '' ]]\n&gt; + [[ -n '' ]]\n&gt; + echo 'Building in Release mode'\n&gt; Building in Release mode\n&gt; + mkdir -p torch/lib/tmp_install\n&gt; + for arg in '\"$@\"'\n&gt; + [[ caffe2 == \\n\\c\\c\\l ]]\n&gt; + [[ caffe2 == \\g\\l\\o\\o ]]\n&gt; + [[ caffe2 == \\c\\a\\f\\f\\e\\2 ]]\n&gt; + pushd /home/xxx/Project/svn-store/PyTorch/pytorch-git\n&gt; ~/Project/svn-store/PyTorch/pytorch-git ~/Project/svn-store/PyTorch/pytorch-git\n&gt; + build_caffe2\n&gt; + mkdir -p build\n&gt; + pushd build\n&gt; ~/Project/svn-store/PyTorch/pytorch-git/build ~/Project/svn-store/PyTorch/pytorch-git ~/Project/svn-store/PyTorch/pytorch-git\n&gt; + cmake .. -DCMAKE_BUILD_TYPE=Release -DBUILD_CAFFE2=0 -DBUILD_ATEN=ON -DBUILD_PYTHON=0 -DBUILD_BINARY=OFF -DBUILD_SHARED_LIBS=ON -DONNX_NAMESPACE= -DUSE_CUDA=0 -DUSE_ROCM=0 -DUSE_NNPACK=1 -DCUDNN_INCLUDE_DIR= -DCUDNN_LIB_DIR= -DCUDNN_LIBRARY= -DUSE_MKLDNN=0 -DMKLDNN_INCLUDE_DIR= -DMKLDNN_LIB_DIR= -DMKLDNN_LIBRARY= -DCMAKE_INSTALL_PREFIX=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_C_FLAGS= -DCMAKE_CXX_FLAGS= -DCMAKE_EXE_LINKER_FLAGS= -DCMAKE_SHARED_LINKER_FLAGS=\n&gt; -- Does not need to define long separately.\n&gt; -- std::exception_ptr is supported.\n&gt; -- NUMA is available\n&gt; -- Current compiler supports avx2 extention. Will build perfkernels.\n&gt; -- Building using own protobuf under third_party per request.\n&gt; -- Use custom protobuf build.\n&gt; -- Caffe2 protobuf include directory: $&lt;BUILD_INTERFACE:/home/xxx/Project/svn-store/PyTorch/pytorch-git/third_party/protobuf/src&gt;$&lt;INSTALL_INTERFACE:include&gt;\n&gt; -- The BLAS backend of choice:Eigen\n&gt; -- Brace yourself, we are building NNPACK\n&gt; -- Found Numa  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnuma.so)\n&gt; -- Found system Eigen at /usr/local/include/eigen3\n&gt; -- Found gcc &gt;=5 and CUDA &lt;= 7.5, adding workaround C++ flags\n&gt; -- Could not find CUDA with FP16 support, compiling without torch.CudaHalfTensor\n&gt; -- Removing -DNDEBUG from compile flags\n&gt; -- Compiling with OpenMP support\n&gt; -- MAGMA not found. Compiling without MAGMA support\n&gt; -- Could not find hardware support for NEON on this machine.\n&gt; -- No OMAP3 processor on this machine.\n&gt; -- No OMAP4 processor on this machine.\n&gt; -- SSE2 Found\n&gt; -- SSE3 Found\n&gt; -- AVX Found\n&gt; -- AVX2 Found\n&gt; -- Atomics: using GCC intrinsics\n&gt; -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel_lp64: not found\n&gt; -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_intel: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf_lp64: not found\n&gt; -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - pthread - m - dl]\n&gt; --   Library mkl_gf: not found\n&gt; -- Checking for [mkl - guide - pthread - m]\n&gt; --   Library mkl: not found\n&gt; -- MKL library not found\n&gt; -- Checking for [openblas]\n&gt; --   Library openblas: /usr/lib/libopenblas.so\n&gt; -- Found a library with BLAS API (open).\n&gt; -- Found a library with LAPACK API. (open)\n&gt; disabling CUDA because NOT USE_CUDA is set\n&gt; -- CuDNN not found. Compiling without CuDNN support\n&gt; -- Could NOT find MKLDNN (missing: MKLDNN_INCLUDE_DIR MKLDNN_LIBRARY) \n&gt; -- MKLDNN not found. Compiling without MKLDNN support\n&gt; -- GCC 5.4.0: Adding gcc and gcc_s libs to link line\n&gt; disabling CUDA because USE_CUDA is set false\n&gt; -- Configuring build for SLEEF-v3.2\n&gt;    Target system: Linux-4.8.0-52-generic\n&gt;    Target processor: x86_64\n&gt;    Host system: Linux-4.8.0-52-generic\n&gt;    Host processor: x86_64\n&gt;    Detected C compiler: GNU @ /usr/bin/cc\n&gt; -- Using option `-Wall -Wno-unused -Wno-attributes -Wno-unused-result -Wno-psabi -ffp-contract=off -fno-math-errno -fno-trapping-math` to compile libsleef\n&gt; -- Building shared libs : OFF\n&gt; -- MPFR : /usr/lib/x86_64-linux-gnu/libmpfr.so\n&gt; -- MPFR header file in /usr/include\n&gt; -- GMP : /usr/lib/x86_64-linux-gnu/libgmp.so\n&gt; -- RUNNING_ON_TRAVIS : 0\n&gt; -- COMPILER_SUPPORTS_OPENMP : 1\n&gt; CMake Warning at CMakeLists.txt:341 (message):\n&gt;   Generated cmake files are only fully tested if one builds with system glog,\n&gt;   gflags, and protobuf.  Other settings may generate files that are not well\n&gt;   tested.\n&gt; \n&gt; \n&gt; -- \n&gt; -- ******** Summary ********\n&gt; -- General:\n&gt; --   CMake version         : 3.11.0-rc3\n&gt; --   CMake command         : /home/xxx/Downloads/software-tools/cmake-3.11.0-rc3-Linux-x86_64/bin/cmake\n&gt; --   Git version           : \n&gt; --   System                : Linux\n&gt; --   C++ compiler          : /usr/bin/c++\n&gt; --   C++ compiler version  : 5.4.0\n&gt; --   BLAS                  : Eigen\n&gt; --   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -DONNX_NAMESPACE= -D_FORCE_INLINES -D_MWAITXINTRIN_H_INCLUDED -D__STRICT_ANSI__ -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-error=deprecated-declarations\n&gt; --   Build type            : Release\n&gt; --   Compile definitions   : USE_GCC_ATOMICS=1;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\n&gt; --   CMAKE_PREFIX_PATH     : \n&gt; --   CMAKE_INSTALL_PREFIX  : /home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\n&gt; -- \n&gt; --   BUILD_CAFFE2          : 0\n&gt; --   BUILD_ATEN            : ON\n&gt; --   BUILD_BINARY          : OFF\n&gt; --   BUILD_CUSTOM_PROTOBUF : ON\n&gt; --     Link local protobuf : ON\n&gt; --   BUILD_PYTHON          : 0\n&gt; --   BUILD_SHARED_LIBS     : ON\n&gt; --   BUILD_TEST            : OFF\n&gt; --   USE_ASAN              : OFF\n&gt; --   USE_ATEN              : OFF\n&gt; --   USE_CUDA              : 0\n&gt; --   USE_ROCM              : OFF\n&gt; --   USE_EIGEN_FOR_BLAS    : ON\n&gt; --   USE_FFMPEG            : OFF\n&gt; --   USE_GFLAGS            : OFF\n&gt; --   USE_GLOG              : OFF\n&gt; --   USE_GLOO              : OFF\n&gt; --   USE_LEVELDB           : OFF\n&gt; --   USE_LITE_PROTO        : OFF\n&gt; --   USE_LMDB              : OFF\n&gt; --   USE_METAL             : OFF\n&gt; --   USE_MKL               : \n&gt; --   USE_MOBILE_OPENGL     : OFF\n&gt; --   USE_MPI               : OFF\n&gt; --   USE_NCCL              : OFF\n&gt; --   USE_NERVANA_GPU       : OFF\n&gt; --   USE_NNPACK            : 1\n&gt; --   USE_OBSERVERS         : ON\n&gt; --   USE_OPENCL            : OFF\n&gt; --   USE_OPENCV            : OFF\n&gt; --   USE_OPENMP            : OFF\n&gt; --   USE_PROF              : OFF\n&gt; --   USE_REDIS             : OFF\n&gt; --   USE_ROCKSDB           : OFF\n&gt; --   USE_ZMQ               : OFF\n&gt; --   USE_DISTRIBUTED       : OFF\n&gt; --   Public Dependencies  : \n&gt; --   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/libnuma.so;rt;gcc_s;gcc;dl\n&gt; -- Configuring done\n&gt; -- Generating done\n&gt; -- Build files have been written to: /home/xxx/Project/svn-store/PyTorch/pytorch-git/build\n&gt; + make install -j4\n&gt; [  1%] Built target js_embed\n&gt; [  5%] Built target cpuinfo\n&gt; [  6%] Built target pthreadpool\n&gt; [ 12%] Built target libprotobuf-lite\n&gt; [ 12%] Built target onnxifi_loader\n&gt; [ 12%] Built target c10\n&gt; [ 12%] Built target common\n&gt; [ 13%] Built target mkrename\n&gt; [ 13%] Built target mkdisp\n&gt; [ 13%] Built target mkmasked_gnuabi\n&gt; [ 13%] Built target mkrename_gnuabi\n&gt; [ 13%] Built target ATEN_CPU_FILES_GEN_TARGET\n&gt; [ 13%] Built target arraymap\n&gt; [ 14%] Built target mkalias\n&gt; [ 19%] Built target nnpack\n&gt; [ 19%] Built target renameAVX.h_generated\n&gt; [ 20%] Built target nnpack_reference_layers\n&gt; [ 20%] Built target renamedsp128.h_generated\n&gt; [ 21%] Built target headers\n&gt; [ 21%] Built target dispsse.c_generated\n&gt; [ 21%] Built target renamedsp256.h_generated\n&gt; [ 36%] Built target libprotobuf\n&gt; [ 36%] Built target dispavx.c_generated\n&gt; [ 36%] Built target renameSSE2.h_generated\n&gt; [ 37%] Built target renameFMA4.h_generated\n&gt; [ 37%] Built target renameAVX2.h_generated\n&gt; [ 37%] Built target renameAVX2128.h_generated\n&gt; [ 37%] Built target renameSSE4.h_generated\n&gt; [ 37%] Built target caffe2_protos\n&gt; [ 38%] Built target sleefavx\n&gt; [ 38%] Built target dispsse_obj\n&gt; [ 39%] Built target dispavx_obj\n&gt; [ 40%] Built target sleefsse2\n&gt; [ 40%] Built target sleeffma4\n&gt; [ 40%] Built target sleefavx2\n&gt; [ 41%] Built target sleefavx2128\n&gt; [ 42%] Built target sleefsse4\n&gt; [ 43%] Built target sleef\n&gt; [ 61%] Built target libprotoc\n&gt; [ 61%] Built target protoc\n&gt; [ 62%] Built target gen_onnx_proto\n&gt; [ 64%] Built target onnx_proto\n&gt; [ 69%] Built target onnx\n&gt; [ 93%] Built target caffe2\n&gt; [ 94%] Linking CXX executable ../bin/wrapdim_test\n&gt; [ 94%] Linking CXX executable ../bin/apply_utils_test\n&gt; [ 94%] Linking CXX executable ../bin/dlconvertor_test\n&gt; [ 94%] Linking CXX executable ../bin/scalar_test\n&gt; /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n&gt; /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n&gt; collect2: error: ld returned 1 exit status\n&gt; collect2: error: ld returned 1 exit status\n&gt; caffe2/CMakeFiles/wrapdim_test.dir/build.make:84: recipe for target 'bin/wrapdim_test' failed\n&gt; make[2]: *** [bin/wrapdim_test] Error 1\n&gt; CMakeFiles/Makefile2:1086: recipe for target 'caffe2/CMakeFiles/wrapdim_test.dir/all' failed\n&gt; make[1]: *** [caffe2/CMakeFiles/wrapdim_test.dir/all] Error 2\n&gt; make[1]: *** Waiting for unfinished jobs....\n&gt; caffe2/CMakeFiles/dlconvertor_test.dir/build.make:84: recipe for target 'bin/dlconvertor_test' failed\n&gt; make[2]: *** [bin/dlconvertor_test] Error 1\n&gt; CMakeFiles/Makefile2:1011: recipe for target 'caffe2/CMakeFiles/dlconvertor_test.dir/all' failed\n&gt; make[1]: *** [caffe2/CMakeFiles/dlconvertor_test.dir/all] Error 2\n&gt; /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n&gt; /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n&gt; collect2: error: ld returned 1 exit status\n&gt; collect2: error: ld returned 1 exit status\n&gt; caffe2/CMakeFiles/apply_utils_test.dir/build.make:84: recipe for target 'bin/apply_utils_test' failed\n&gt; make[2]: *** [bin/apply_utils_test] Error 1\n&gt; caffe2/CMakeFiles/scalar_test.dir/build.make:84: recipe for target 'bin/scalar_test' failed\n&gt; CMakeFiles/Makefile2:897: recipe for target 'caffe2/CMakeFiles/apply_utils_test.dir/all' failed\n&gt; make[1]: *** [caffe2/CMakeFiles/apply_utils_test.dir/all] Error 2\n&gt; make[2]: *** [bin/scalar_test] Error 1\n&gt; CMakeFiles/Makefile2:1124: recipe for target 'caffe2/CMakeFiles/scalar_test.dir/all' failed\n&gt; make[1]: *** [caffe2/CMakeFiles/scalar_test.dir/all] Error 2\n&gt; Makefile:140: recipe for target 'all' failed\n&gt; make: *** [all] Error 2\n&gt; \n</code></pre>", "body_text": "Hi, I met the following issue when build pytorch from source. I can build caffe2 successfully by using python3 setup_caffe2.py install, but can not build pytorch by using python3 setup.py install. Does anyone know how to solve it? Thanks!\nIssue description\nFailed to run 'bash tools/build_pytorch_libs.sh --use-nnpack caffe2 nanopb libshm gloo THD'\nCode example\npython3 setup.py install\nSystem Info\n\nPyTorch or Caffe2: PyTorch\nHow you installed PyTorch (conda, pip, source): source\nBuild command you used (if compiling from source): python3 setup.py install\nOS: Ubuntu 16.04\nPyTorch version: source code cloned from the master branch\nPython version: 3.5.2\nCUDA/cuDNN version: N/A\nGPU models and configuration: N/A\nGCC version (if compiling from source): 5.4\nCMake version: 3.11.0\nVersions of any other relevant libraries:\n\n> xxx@yyy:~/Project/svn-store/PyTorch/pytorch-git$ sudo tools/build_pytorch_libs.sh  --use-nnpack caffe2 nanopb libshm gloo THD\n> + USE_CUDA=0\n> + USE_ROCM=0\n> + USE_NNPACK=0\n> + USE_MKLDNN=0\n> + USE_GLOO_IBVERBS=0\n> + USE_DISTRIBUTED_MW=0\n> + FULL_CAFFE2=0\n> + [[ 6 -gt 0 ]]\n> + case \"$1\" in\n> + USE_NNPACK=1\n> + shift\n> + [[ 5 -gt 0 ]]\n> + case \"$1\" in\n> + break\n> + CMAKE_INSTALL='make install'\n> + USER_CFLAGS=\n> + USER_LDFLAGS=\n> + [[ -n '' ]]\n> + [[ -n '' ]]\n> + [[ -n '' ]]\n> ++ dirname tools/build_pytorch_libs.sh\n> + cd tools/..\n> +++ pwd\n> ++ printf '%q\\n' /home/xxx/Project/svn-store/PyTorch/pytorch-git\n> + PWD=/home/xxx/Project/svn-store/PyTorch/pytorch-git\n> + BASE_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git\n> + TORCH_LIB_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib\n> + INSTALL_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\n> + THIRD_PARTY_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/third_party\n> + CMAKE_VERSION=cmake\n> + C_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\"'\n> + C_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n> + LDFLAGS='-L\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/lib\" '\n> + LD_POSTFIX=.so\n> ++ uname\n> + [[ Linux == \\D\\a\\r\\w\\i\\n ]]\n> + LDFLAGS='-L\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\n> + CPP_FLAGS=' -std=c++11 '\n> + GLOO_FLAGS=\n> + THD_FLAGS=\n> + NCCL_ROOT_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\n> + [[ 0 -eq 1 ]]\n> + [[ 0 -eq 1 ]]\n> + [[ 0 -eq 1 ]]\n> + CWRAP_FILES='/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/ATen/Declarations.cwrap;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/THNN/generic/THNN.h;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/THCUNN/generic/THCUNN.h;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/ATen/nn.yaml'\n> + CUDA_NVCC_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\n> + [[ -z '' ]]\n> + CUDA_DEVICE_DEBUG=0\n> + '[' -z '' ']'\n> ++ getconf _NPROCESSORS_ONLN\n> + NUM_JOBS=4\n> + BUILD_TYPE=Release\n> + [[ -n '' ]]\n> + [[ -n '' ]]\n> + echo 'Building in Release mode'\n> Building in Release mode\n> + mkdir -p torch/lib/tmp_install\n> + for arg in '\"$@\"'\n> + [[ caffe2 == \\n\\c\\c\\l ]]\n> + [[ caffe2 == \\g\\l\\o\\o ]]\n> + [[ caffe2 == \\c\\a\\f\\f\\e\\2 ]]\n> + pushd /home/xxx/Project/svn-store/PyTorch/pytorch-git\n> ~/Project/svn-store/PyTorch/pytorch-git ~/Project/svn-store/PyTorch/pytorch-git\n> + build_caffe2\n> + mkdir -p build\n> + pushd build\n> ~/Project/svn-store/PyTorch/pytorch-git/build ~/Project/svn-store/PyTorch/pytorch-git ~/Project/svn-store/PyTorch/pytorch-git\n> + cmake .. -DCMAKE_BUILD_TYPE=Release -DBUILD_CAFFE2=0 -DBUILD_ATEN=ON -DBUILD_PYTHON=0 -DBUILD_BINARY=OFF -DBUILD_SHARED_LIBS=ON -DONNX_NAMESPACE= -DUSE_CUDA=0 -DUSE_ROCM=0 -DUSE_NNPACK=1 -DCUDNN_INCLUDE_DIR= -DCUDNN_LIB_DIR= -DCUDNN_LIBRARY= -DUSE_MKLDNN=0 -DMKLDNN_INCLUDE_DIR= -DMKLDNN_LIB_DIR= -DMKLDNN_LIBRARY= -DCMAKE_INSTALL_PREFIX=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_C_FLAGS= -DCMAKE_CXX_FLAGS= -DCMAKE_EXE_LINKER_FLAGS= -DCMAKE_SHARED_LINKER_FLAGS=\n> -- Does not need to define long separately.\n> -- std::exception_ptr is supported.\n> -- NUMA is available\n> -- Current compiler supports avx2 extention. Will build perfkernels.\n> -- Building using own protobuf under third_party per request.\n> -- Use custom protobuf build.\n> -- Caffe2 protobuf include directory: $<BUILD_INTERFACE:/home/xxx/Project/svn-store/PyTorch/pytorch-git/third_party/protobuf/src>$<INSTALL_INTERFACE:include>\n> -- The BLAS backend of choice:Eigen\n> -- Brace yourself, we are building NNPACK\n> -- Found Numa  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnuma.so)\n> -- Found system Eigen at /usr/local/include/eigen3\n> -- Found gcc >=5 and CUDA <= 7.5, adding workaround C++ flags\n> -- Could not find CUDA with FP16 support, compiling without torch.CudaHalfTensor\n> -- Removing -DNDEBUG from compile flags\n> -- Compiling with OpenMP support\n> -- MAGMA not found. Compiling without MAGMA support\n> -- Could not find hardware support for NEON on this machine.\n> -- No OMAP3 processor on this machine.\n> -- No OMAP4 processor on this machine.\n> -- SSE2 Found\n> -- SSE3 Found\n> -- AVX Found\n> -- AVX2 Found\n> -- Atomics: using GCC intrinsics\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel_lp64: not found\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_intel: not found\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf_lp64: not found\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - pthread - m - dl]\n> --   Library mkl_gf: not found\n> -- Checking for [mkl - guide - pthread - m]\n> --   Library mkl: not found\n> -- MKL library not found\n> -- Checking for [openblas]\n> --   Library openblas: /usr/lib/libopenblas.so\n> -- Found a library with BLAS API (open).\n> -- Found a library with LAPACK API. (open)\n> disabling CUDA because NOT USE_CUDA is set\n> -- CuDNN not found. Compiling without CuDNN support\n> -- Could NOT find MKLDNN (missing: MKLDNN_INCLUDE_DIR MKLDNN_LIBRARY) \n> -- MKLDNN not found. Compiling without MKLDNN support\n> -- GCC 5.4.0: Adding gcc and gcc_s libs to link line\n> disabling CUDA because USE_CUDA is set false\n> -- Configuring build for SLEEF-v3.2\n>    Target system: Linux-4.8.0-52-generic\n>    Target processor: x86_64\n>    Host system: Linux-4.8.0-52-generic\n>    Host processor: x86_64\n>    Detected C compiler: GNU @ /usr/bin/cc\n> -- Using option `-Wall -Wno-unused -Wno-attributes -Wno-unused-result -Wno-psabi -ffp-contract=off -fno-math-errno -fno-trapping-math` to compile libsleef\n> -- Building shared libs : OFF\n> -- MPFR : /usr/lib/x86_64-linux-gnu/libmpfr.so\n> -- MPFR header file in /usr/include\n> -- GMP : /usr/lib/x86_64-linux-gnu/libgmp.so\n> -- RUNNING_ON_TRAVIS : 0\n> -- COMPILER_SUPPORTS_OPENMP : 1\n> CMake Warning at CMakeLists.txt:341 (message):\n>   Generated cmake files are only fully tested if one builds with system glog,\n>   gflags, and protobuf.  Other settings may generate files that are not well\n>   tested.\n> \n> \n> -- \n> -- ******** Summary ********\n> -- General:\n> --   CMake version         : 3.11.0-rc3\n> --   CMake command         : /home/xxx/Downloads/software-tools/cmake-3.11.0-rc3-Linux-x86_64/bin/cmake\n> --   Git version           : \n> --   System                : Linux\n> --   C++ compiler          : /usr/bin/c++\n> --   C++ compiler version  : 5.4.0\n> --   BLAS                  : Eigen\n> --   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -DONNX_NAMESPACE= -D_FORCE_INLINES -D_MWAITXINTRIN_H_INCLUDED -D__STRICT_ANSI__ -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-error=deprecated-declarations\n> --   Build type            : Release\n> --   Compile definitions   : USE_GCC_ATOMICS=1;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\n> --   CMAKE_PREFIX_PATH     : \n> --   CMAKE_INSTALL_PREFIX  : /home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\n> -- \n> --   BUILD_CAFFE2          : 0\n> --   BUILD_ATEN            : ON\n> --   BUILD_BINARY          : OFF\n> --   BUILD_CUSTOM_PROTOBUF : ON\n> --     Link local protobuf : ON\n> --   BUILD_PYTHON          : 0\n> --   BUILD_SHARED_LIBS     : ON\n> --   BUILD_TEST            : OFF\n> --   USE_ASAN              : OFF\n> --   USE_ATEN              : OFF\n> --   USE_CUDA              : 0\n> --   USE_ROCM              : OFF\n> --   USE_EIGEN_FOR_BLAS    : ON\n> --   USE_FFMPEG            : OFF\n> --   USE_GFLAGS            : OFF\n> --   USE_GLOG              : OFF\n> --   USE_GLOO              : OFF\n> --   USE_LEVELDB           : OFF\n> --   USE_LITE_PROTO        : OFF\n> --   USE_LMDB              : OFF\n> --   USE_METAL             : OFF\n> --   USE_MKL               : \n> --   USE_MOBILE_OPENGL     : OFF\n> --   USE_MPI               : OFF\n> --   USE_NCCL              : OFF\n> --   USE_NERVANA_GPU       : OFF\n> --   USE_NNPACK            : 1\n> --   USE_OBSERVERS         : ON\n> --   USE_OPENCL            : OFF\n> --   USE_OPENCV            : OFF\n> --   USE_OPENMP            : OFF\n> --   USE_PROF              : OFF\n> --   USE_REDIS             : OFF\n> --   USE_ROCKSDB           : OFF\n> --   USE_ZMQ               : OFF\n> --   USE_DISTRIBUTED       : OFF\n> --   Public Dependencies  : \n> --   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/libnuma.so;rt;gcc_s;gcc;dl\n> -- Configuring done\n> -- Generating done\n> -- Build files have been written to: /home/xxx/Project/svn-store/PyTorch/pytorch-git/build\n> + make install -j4\n> [  1%] Built target js_embed\n> [  5%] Built target cpuinfo\n> [  6%] Built target pthreadpool\n> [ 12%] Built target libprotobuf-lite\n> [ 12%] Built target onnxifi_loader\n> [ 12%] Built target c10\n> [ 12%] Built target common\n> [ 13%] Built target mkrename\n> [ 13%] Built target mkdisp\n> [ 13%] Built target mkmasked_gnuabi\n> [ 13%] Built target mkrename_gnuabi\n> [ 13%] Built target ATEN_CPU_FILES_GEN_TARGET\n> [ 13%] Built target arraymap\n> [ 14%] Built target mkalias\n> [ 19%] Built target nnpack\n> [ 19%] Built target renameAVX.h_generated\n> [ 20%] Built target nnpack_reference_layers\n> [ 20%] Built target renamedsp128.h_generated\n> [ 21%] Built target headers\n> [ 21%] Built target dispsse.c_generated\n> [ 21%] Built target renamedsp256.h_generated\n> [ 36%] Built target libprotobuf\n> [ 36%] Built target dispavx.c_generated\n> [ 36%] Built target renameSSE2.h_generated\n> [ 37%] Built target renameFMA4.h_generated\n> [ 37%] Built target renameAVX2.h_generated\n> [ 37%] Built target renameAVX2128.h_generated\n> [ 37%] Built target renameSSE4.h_generated\n> [ 37%] Built target caffe2_protos\n> [ 38%] Built target sleefavx\n> [ 38%] Built target dispsse_obj\n> [ 39%] Built target dispavx_obj\n> [ 40%] Built target sleefsse2\n> [ 40%] Built target sleeffma4\n> [ 40%] Built target sleefavx2\n> [ 41%] Built target sleefavx2128\n> [ 42%] Built target sleefsse4\n> [ 43%] Built target sleef\n> [ 61%] Built target libprotoc\n> [ 61%] Built target protoc\n> [ 62%] Built target gen_onnx_proto\n> [ 64%] Built target onnx_proto\n> [ 69%] Built target onnx\n> [ 93%] Built target caffe2\n> [ 94%] Linking CXX executable ../bin/wrapdim_test\n> [ 94%] Linking CXX executable ../bin/apply_utils_test\n> [ 94%] Linking CXX executable ../bin/dlconvertor_test\n> [ 94%] Linking CXX executable ../bin/scalar_test\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n> collect2: error: ld returned 1 exit status\n> collect2: error: ld returned 1 exit status\n> caffe2/CMakeFiles/wrapdim_test.dir/build.make:84: recipe for target 'bin/wrapdim_test' failed\n> make[2]: *** [bin/wrapdim_test] Error 1\n> CMakeFiles/Makefile2:1086: recipe for target 'caffe2/CMakeFiles/wrapdim_test.dir/all' failed\n> make[1]: *** [caffe2/CMakeFiles/wrapdim_test.dir/all] Error 2\n> make[1]: *** Waiting for unfinished jobs....\n> caffe2/CMakeFiles/dlconvertor_test.dir/build.make:84: recipe for target 'bin/dlconvertor_test' failed\n> make[2]: *** [bin/dlconvertor_test] Error 1\n> CMakeFiles/Makefile2:1011: recipe for target 'caffe2/CMakeFiles/dlconvertor_test.dir/all' failed\n> make[1]: *** [caffe2/CMakeFiles/dlconvertor_test.dir/all] Error 2\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\n> collect2: error: ld returned 1 exit status\n> collect2: error: ld returned 1 exit status\n> caffe2/CMakeFiles/apply_utils_test.dir/build.make:84: recipe for target 'bin/apply_utils_test' failed\n> make[2]: *** [bin/apply_utils_test] Error 1\n> caffe2/CMakeFiles/scalar_test.dir/build.make:84: recipe for target 'bin/scalar_test' failed\n> CMakeFiles/Makefile2:897: recipe for target 'caffe2/CMakeFiles/apply_utils_test.dir/all' failed\n> make[1]: *** [caffe2/CMakeFiles/apply_utils_test.dir/all] Error 2\n> make[2]: *** [bin/scalar_test] Error 1\n> CMakeFiles/Makefile2:1124: recipe for target 'caffe2/CMakeFiles/scalar_test.dir/all' failed\n> make[1]: *** [caffe2/CMakeFiles/scalar_test.dir/all] Error 2\n> Makefile:140: recipe for target 'all' failed\n> make: *** [all] Error 2\n>", "body": "Hi, I met the following issue when build pytorch from source. I can build caffe2 successfully by using `python3 setup_caffe2.py install`, but can not build pytorch by using `python3 setup.py install`. Does anyone know how to solve it? Thanks!\r\n\r\n## Issue description\r\n\r\nFailed to run 'bash tools/build_pytorch_libs.sh --use-nnpack caffe2 nanopb libshm gloo THD'\r\n\r\n## Code example\r\n\r\n`python3 setup.py install`\r\n\r\n## System Info\r\n- PyTorch or Caffe2: PyTorch\r\n- How you installed PyTorch (conda, pip, source): source\r\n- Build command you used (if compiling from source): `python3 setup.py install`\r\n- OS: Ubuntu 16.04\r\n- PyTorch version: source code cloned from the master branch\r\n- Python version: 3.5.2\r\n- CUDA/cuDNN version: N/A\r\n- GPU models and configuration: N/A\r\n- GCC version (if compiling from source): 5.4\r\n- CMake version: 3.11.0\r\n- Versions of any other relevant libraries:\r\n\r\n```\r\n> xxx@yyy:~/Project/svn-store/PyTorch/pytorch-git$ sudo tools/build_pytorch_libs.sh  --use-nnpack caffe2 nanopb libshm gloo THD\r\n> + USE_CUDA=0\r\n> + USE_ROCM=0\r\n> + USE_NNPACK=0\r\n> + USE_MKLDNN=0\r\n> + USE_GLOO_IBVERBS=0\r\n> + USE_DISTRIBUTED_MW=0\r\n> + FULL_CAFFE2=0\r\n> + [[ 6 -gt 0 ]]\r\n> + case \"$1\" in\r\n> + USE_NNPACK=1\r\n> + shift\r\n> + [[ 5 -gt 0 ]]\r\n> + case \"$1\" in\r\n> + break\r\n> + CMAKE_INSTALL='make install'\r\n> + USER_CFLAGS=\r\n> + USER_LDFLAGS=\r\n> + [[ -n '' ]]\r\n> + [[ -n '' ]]\r\n> + [[ -n '' ]]\r\n> ++ dirname tools/build_pytorch_libs.sh\r\n> + cd tools/..\r\n> +++ pwd\r\n> ++ printf '%q\\n' /home/xxx/Project/svn-store/PyTorch/pytorch-git\r\n> + PWD=/home/xxx/Project/svn-store/PyTorch/pytorch-git\r\n> + BASE_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git\r\n> + TORCH_LIB_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib\r\n> + INSTALL_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\r\n> + THIRD_PARTY_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/third_party\r\n> + CMAKE_VERSION=cmake\r\n> + C_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\"'\r\n> + C_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\r\n> + LDFLAGS='-L\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/lib\" '\r\n> + LD_POSTFIX=.so\r\n> ++ uname\r\n> + [[ Linux == \\D\\a\\r\\w\\i\\n ]]\r\n> + LDFLAGS='-L\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/lib\"  -Wl,-rpath,$ORIGIN'\r\n> + CPP_FLAGS=' -std=c++11 '\r\n> + GLOO_FLAGS=\r\n> + THD_FLAGS=\r\n> + NCCL_ROOT_DIR=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\r\n> + [[ 0 -eq 1 ]]\r\n> + [[ 0 -eq 1 ]]\r\n> + [[ 0 -eq 1 ]]\r\n> + CWRAP_FILES='/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/ATen/Declarations.cwrap;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/THNN/generic/THNN.h;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/THCUNN/generic/THCUNN.h;/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/ATen/nn.yaml'\r\n> + CUDA_NVCC_FLAGS=' -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/TH\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THC\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THS\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCS\"   -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THNN\" -I\"/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install/include/THCUNN\" -DOMPI_SKIP_MPICXX=1'\r\n> + [[ -z '' ]]\r\n> + CUDA_DEVICE_DEBUG=0\r\n> + '[' -z '' ']'\r\n> ++ getconf _NPROCESSORS_ONLN\r\n> + NUM_JOBS=4\r\n> + BUILD_TYPE=Release\r\n> + [[ -n '' ]]\r\n> + [[ -n '' ]]\r\n> + echo 'Building in Release mode'\r\n> Building in Release mode\r\n> + mkdir -p torch/lib/tmp_install\r\n> + for arg in '\"$@\"'\r\n> + [[ caffe2 == \\n\\c\\c\\l ]]\r\n> + [[ caffe2 == \\g\\l\\o\\o ]]\r\n> + [[ caffe2 == \\c\\a\\f\\f\\e\\2 ]]\r\n> + pushd /home/xxx/Project/svn-store/PyTorch/pytorch-git\r\n> ~/Project/svn-store/PyTorch/pytorch-git ~/Project/svn-store/PyTorch/pytorch-git\r\n> + build_caffe2\r\n> + mkdir -p build\r\n> + pushd build\r\n> ~/Project/svn-store/PyTorch/pytorch-git/build ~/Project/svn-store/PyTorch/pytorch-git ~/Project/svn-store/PyTorch/pytorch-git\r\n> + cmake .. -DCMAKE_BUILD_TYPE=Release -DBUILD_CAFFE2=0 -DBUILD_ATEN=ON -DBUILD_PYTHON=0 -DBUILD_BINARY=OFF -DBUILD_SHARED_LIBS=ON -DONNX_NAMESPACE= -DUSE_CUDA=0 -DUSE_ROCM=0 -DUSE_NNPACK=1 -DCUDNN_INCLUDE_DIR= -DCUDNN_LIB_DIR= -DCUDNN_LIBRARY= -DUSE_MKLDNN=0 -DMKLDNN_INCLUDE_DIR= -DMKLDNN_LIB_DIR= -DMKLDNN_LIBRARY= -DCMAKE_INSTALL_PREFIX=/home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_C_FLAGS= -DCMAKE_CXX_FLAGS= -DCMAKE_EXE_LINKER_FLAGS= -DCMAKE_SHARED_LINKER_FLAGS=\r\n> -- Does not need to define long separately.\r\n> -- std::exception_ptr is supported.\r\n> -- NUMA is available\r\n> -- Current compiler supports avx2 extention. Will build perfkernels.\r\n> -- Building using own protobuf under third_party per request.\r\n> -- Use custom protobuf build.\r\n> -- Caffe2 protobuf include directory: $<BUILD_INTERFACE:/home/xxx/Project/svn-store/PyTorch/pytorch-git/third_party/protobuf/src>$<INSTALL_INTERFACE:include>\r\n> -- The BLAS backend of choice:Eigen\r\n> -- Brace yourself, we are building NNPACK\r\n> -- Found Numa  (include: /usr/include, library: /usr/lib/x86_64-linux-gnu/libnuma.so)\r\n> -- Found system Eigen at /usr/local/include/eigen3\r\n> -- Found gcc >=5 and CUDA <= 7.5, adding workaround C++ flags\r\n> -- Could not find CUDA with FP16 support, compiling without torch.CudaHalfTensor\r\n> -- Removing -DNDEBUG from compile flags\r\n> -- Compiling with OpenMP support\r\n> -- MAGMA not found. Compiling without MAGMA support\r\n> -- Could not find hardware support for NEON on this machine.\r\n> -- No OMAP3 processor on this machine.\r\n> -- No OMAP4 processor on this machine.\r\n> -- SSE2 Found\r\n> -- SSE3 Found\r\n> -- AVX Found\r\n> -- AVX2 Found\r\n> -- Atomics: using GCC intrinsics\r\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_sequential - mkl_core - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - gomp - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - iomp5 - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel_lp64: not found\r\n> -- Checking for [mkl_intel - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_intel - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_intel: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf_lp64 - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf_lp64: not found\r\n> -- Checking for [mkl_gf - mkl_gnu_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl_gf - mkl_intel_thread - mkl_core - pthread - m - dl]\r\n> --   Library mkl_gf: not found\r\n> -- Checking for [mkl - guide - pthread - m]\r\n> --   Library mkl: not found\r\n> -- MKL library not found\r\n> -- Checking for [openblas]\r\n> --   Library openblas: /usr/lib/libopenblas.so\r\n> -- Found a library with BLAS API (open).\r\n> -- Found a library with LAPACK API. (open)\r\n> disabling CUDA because NOT USE_CUDA is set\r\n> -- CuDNN not found. Compiling without CuDNN support\r\n> -- Could NOT find MKLDNN (missing: MKLDNN_INCLUDE_DIR MKLDNN_LIBRARY) \r\n> -- MKLDNN not found. Compiling without MKLDNN support\r\n> -- GCC 5.4.0: Adding gcc and gcc_s libs to link line\r\n> disabling CUDA because USE_CUDA is set false\r\n> -- Configuring build for SLEEF-v3.2\r\n>    Target system: Linux-4.8.0-52-generic\r\n>    Target processor: x86_64\r\n>    Host system: Linux-4.8.0-52-generic\r\n>    Host processor: x86_64\r\n>    Detected C compiler: GNU @ /usr/bin/cc\r\n> -- Using option `-Wall -Wno-unused -Wno-attributes -Wno-unused-result -Wno-psabi -ffp-contract=off -fno-math-errno -fno-trapping-math` to compile libsleef\r\n> -- Building shared libs : OFF\r\n> -- MPFR : /usr/lib/x86_64-linux-gnu/libmpfr.so\r\n> -- MPFR header file in /usr/include\r\n> -- GMP : /usr/lib/x86_64-linux-gnu/libgmp.so\r\n> -- RUNNING_ON_TRAVIS : 0\r\n> -- COMPILER_SUPPORTS_OPENMP : 1\r\n> CMake Warning at CMakeLists.txt:341 (message):\r\n>   Generated cmake files are only fully tested if one builds with system glog,\r\n>   gflags, and protobuf.  Other settings may generate files that are not well\r\n>   tested.\r\n> \r\n> \r\n> -- \r\n> -- ******** Summary ********\r\n> -- General:\r\n> --   CMake version         : 3.11.0-rc3\r\n> --   CMake command         : /home/xxx/Downloads/software-tools/cmake-3.11.0-rc3-Linux-x86_64/bin/cmake\r\n> --   Git version           : \r\n> --   System                : Linux\r\n> --   C++ compiler          : /usr/bin/c++\r\n> --   C++ compiler version  : 5.4.0\r\n> --   BLAS                  : Eigen\r\n> --   CXX flags             : -msse3 -msse4.1 -msse4.2   --std=c++11  -fvisibility-inlines-hidden -DONNX_NAMESPACE= -D_FORCE_INLINES -D_MWAITXINTRIN_H_INCLUDED -D__STRICT_ANSI__ -fopenmp -O2 -fPIC -Wno-narrowing -Wall -Wextra -Wno-missing-field-initializers -Wno-type-limits -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-error=deprecated-declarations\r\n> --   Build type            : Release\r\n> --   Compile definitions   : USE_GCC_ATOMICS=1;HAVE_MMAP=1;_FILE_OFFSET_BITS=64;HAVE_SHM_OPEN=1;HAVE_SHM_UNLINK=1;HAVE_MALLOC_USABLE_SIZE=1\r\n> --   CMAKE_PREFIX_PATH     : \r\n> --   CMAKE_INSTALL_PREFIX  : /home/xxx/Project/svn-store/PyTorch/pytorch-git/torch/lib/tmp_install\r\n> -- \r\n> --   BUILD_CAFFE2          : 0\r\n> --   BUILD_ATEN            : ON\r\n> --   BUILD_BINARY          : OFF\r\n> --   BUILD_CUSTOM_PROTOBUF : ON\r\n> --     Link local protobuf : ON\r\n> --   BUILD_PYTHON          : 0\r\n> --   BUILD_SHARED_LIBS     : ON\r\n> --   BUILD_TEST            : OFF\r\n> --   USE_ASAN              : OFF\r\n> --   USE_ATEN              : OFF\r\n> --   USE_CUDA              : 0\r\n> --   USE_ROCM              : OFF\r\n> --   USE_EIGEN_FOR_BLAS    : ON\r\n> --   USE_FFMPEG            : OFF\r\n> --   USE_GFLAGS            : OFF\r\n> --   USE_GLOG              : OFF\r\n> --   USE_GLOO              : OFF\r\n> --   USE_LEVELDB           : OFF\r\n> --   USE_LITE_PROTO        : OFF\r\n> --   USE_LMDB              : OFF\r\n> --   USE_METAL             : OFF\r\n> --   USE_MKL               : \r\n> --   USE_MOBILE_OPENGL     : OFF\r\n> --   USE_MPI               : OFF\r\n> --   USE_NCCL              : OFF\r\n> --   USE_NERVANA_GPU       : OFF\r\n> --   USE_NNPACK            : 1\r\n> --   USE_OBSERVERS         : ON\r\n> --   USE_OPENCL            : OFF\r\n> --   USE_OPENCV            : OFF\r\n> --   USE_OPENMP            : OFF\r\n> --   USE_PROF              : OFF\r\n> --   USE_REDIS             : OFF\r\n> --   USE_ROCKSDB           : OFF\r\n> --   USE_ZMQ               : OFF\r\n> --   USE_DISTRIBUTED       : OFF\r\n> --   Public Dependencies  : \r\n> --   Private Dependencies : nnpack;cpuinfo;/usr/lib/x86_64-linux-gnu/libnuma.so;rt;gcc_s;gcc;dl\r\n> -- Configuring done\r\n> -- Generating done\r\n> -- Build files have been written to: /home/xxx/Project/svn-store/PyTorch/pytorch-git/build\r\n> + make install -j4\r\n> [  1%] Built target js_embed\r\n> [  5%] Built target cpuinfo\r\n> [  6%] Built target pthreadpool\r\n> [ 12%] Built target libprotobuf-lite\r\n> [ 12%] Built target onnxifi_loader\r\n> [ 12%] Built target c10\r\n> [ 12%] Built target common\r\n> [ 13%] Built target mkrename\r\n> [ 13%] Built target mkdisp\r\n> [ 13%] Built target mkmasked_gnuabi\r\n> [ 13%] Built target mkrename_gnuabi\r\n> [ 13%] Built target ATEN_CPU_FILES_GEN_TARGET\r\n> [ 13%] Built target arraymap\r\n> [ 14%] Built target mkalias\r\n> [ 19%] Built target nnpack\r\n> [ 19%] Built target renameAVX.h_generated\r\n> [ 20%] Built target nnpack_reference_layers\r\n> [ 20%] Built target renamedsp128.h_generated\r\n> [ 21%] Built target headers\r\n> [ 21%] Built target dispsse.c_generated\r\n> [ 21%] Built target renamedsp256.h_generated\r\n> [ 36%] Built target libprotobuf\r\n> [ 36%] Built target dispavx.c_generated\r\n> [ 36%] Built target renameSSE2.h_generated\r\n> [ 37%] Built target renameFMA4.h_generated\r\n> [ 37%] Built target renameAVX2.h_generated\r\n> [ 37%] Built target renameAVX2128.h_generated\r\n> [ 37%] Built target renameSSE4.h_generated\r\n> [ 37%] Built target caffe2_protos\r\n> [ 38%] Built target sleefavx\r\n> [ 38%] Built target dispsse_obj\r\n> [ 39%] Built target dispavx_obj\r\n> [ 40%] Built target sleefsse2\r\n> [ 40%] Built target sleeffma4\r\n> [ 40%] Built target sleefavx2\r\n> [ 41%] Built target sleefavx2128\r\n> [ 42%] Built target sleefsse4\r\n> [ 43%] Built target sleef\r\n> [ 61%] Built target libprotoc\r\n> [ 61%] Built target protoc\r\n> [ 62%] Built target gen_onnx_proto\r\n> [ 64%] Built target onnx_proto\r\n> [ 69%] Built target onnx\r\n> [ 93%] Built target caffe2\r\n> [ 94%] Linking CXX executable ../bin/wrapdim_test\r\n> [ 94%] Linking CXX executable ../bin/apply_utils_test\r\n> [ 94%] Linking CXX executable ../bin/dlconvertor_test\r\n> [ 94%] Linking CXX executable ../bin/scalar_test\r\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\r\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\r\n> collect2: error: ld returned 1 exit status\r\n> collect2: error: ld returned 1 exit status\r\n> caffe2/CMakeFiles/wrapdim_test.dir/build.make:84: recipe for target 'bin/wrapdim_test' failed\r\n> make[2]: *** [bin/wrapdim_test] Error 1\r\n> CMakeFiles/Makefile2:1086: recipe for target 'caffe2/CMakeFiles/wrapdim_test.dir/all' failed\r\n> make[1]: *** [caffe2/CMakeFiles/wrapdim_test.dir/all] Error 2\r\n> make[1]: *** Waiting for unfinished jobs....\r\n> caffe2/CMakeFiles/dlconvertor_test.dir/build.make:84: recipe for target 'bin/dlconvertor_test' failed\r\n> make[2]: *** [bin/dlconvertor_test] Error 1\r\n> CMakeFiles/Makefile2:1011: recipe for target 'caffe2/CMakeFiles/dlconvertor_test.dir/all' failed\r\n> make[1]: *** [caffe2/CMakeFiles/dlconvertor_test.dir/all] Error 2\r\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\r\n> /home/xxx/Project/svn-store/PyTorch/pytorch-git/build/lib/libcaffe2.so: undefined reference to `onnx::GetEmptyStringAlreadyInited[abi:cxx11]()'\r\n> collect2: error: ld returned 1 exit status\r\n> collect2: error: ld returned 1 exit status\r\n> caffe2/CMakeFiles/apply_utils_test.dir/build.make:84: recipe for target 'bin/apply_utils_test' failed\r\n> make[2]: *** [bin/apply_utils_test] Error 1\r\n> caffe2/CMakeFiles/scalar_test.dir/build.make:84: recipe for target 'bin/scalar_test' failed\r\n> CMakeFiles/Makefile2:897: recipe for target 'caffe2/CMakeFiles/apply_utils_test.dir/all' failed\r\n> make[1]: *** [caffe2/CMakeFiles/apply_utils_test.dir/all] Error 2\r\n> make[2]: *** [bin/scalar_test] Error 1\r\n> CMakeFiles/Makefile2:1124: recipe for target 'caffe2/CMakeFiles/scalar_test.dir/all' failed\r\n> make[1]: *** [caffe2/CMakeFiles/scalar_test.dir/all] Error 2\r\n> Makefile:140: recipe for target 'all' failed\r\n> make: *** [all] Error 2\r\n> \r\n```"}