{"url": "https://api.github.com/repos/pytorch/pytorch/issues/12284", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/12284/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/12284/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/12284/events", "html_url": "https://github.com/pytorch/pytorch/issues/12284", "id": 366336908, "node_id": "MDU6SXNzdWUzNjYzMzY5MDg=", "number": 12284, "title": "capi OutputArchive file size grow for cuda tensor.", "user": {"login": "Strasser-Pablo", "id": 1110541, "node_id": "MDQ6VXNlcjExMTA1NDE=", "avatar_url": "https://avatars3.githubusercontent.com/u/1110541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Strasser-Pablo", "html_url": "https://github.com/Strasser-Pablo", "followers_url": "https://api.github.com/users/Strasser-Pablo/followers", "following_url": "https://api.github.com/users/Strasser-Pablo/following{/other_user}", "gists_url": "https://api.github.com/users/Strasser-Pablo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Strasser-Pablo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Strasser-Pablo/subscriptions", "organizations_url": "https://api.github.com/users/Strasser-Pablo/orgs", "repos_url": "https://api.github.com/users/Strasser-Pablo/repos", "events_url": "https://api.github.com/users/Strasser-Pablo/events{/privacy}", "received_events_url": "https://api.github.com/users/Strasser-Pablo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "goldsborough", "id": 6429851, "node_id": "MDQ6VXNlcjY0Mjk4NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6429851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldsborough", "html_url": "https://github.com/goldsborough", "followers_url": "https://api.github.com/users/goldsborough/followers", "following_url": "https://api.github.com/users/goldsborough/following{/other_user}", "gists_url": "https://api.github.com/users/goldsborough/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldsborough/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldsborough/subscriptions", "organizations_url": "https://api.github.com/users/goldsborough/orgs", "repos_url": "https://api.github.com/users/goldsborough/repos", "events_url": "https://api.github.com/users/goldsborough/events{/privacy}", "received_events_url": "https://api.github.com/users/goldsborough/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "goldsborough", "id": 6429851, "node_id": "MDQ6VXNlcjY0Mjk4NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6429851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldsborough", "html_url": "https://github.com/goldsborough", "followers_url": "https://api.github.com/users/goldsborough/followers", "following_url": "https://api.github.com/users/goldsborough/following{/other_user}", "gists_url": "https://api.github.com/users/goldsborough/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldsborough/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldsborough/subscriptions", "organizations_url": "https://api.github.com/users/goldsborough/orgs", "repos_url": "https://api.github.com/users/goldsborough/repos", "events_url": "https://api.github.com/users/goldsborough/events{/privacy}", "received_events_url": "https://api.github.com/users/goldsborough/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-10-03T13:23:27Z", "updated_at": "2018-10-06T02:35:35Z", "closed_at": "2018-10-06T02:35:35Z", "author_association": "NONE", "body_html": "<h2><g-emoji class=\"g-emoji\" alias=\"bug\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f41b.png\">\ud83d\udc1b</g-emoji> Bug</h2>\n<p>When saving to file the same tensor. The file size grow.</p>\n<h2>To Reproduce</h2>\n<p>Steps to reproduce the behavior:</p>\n<p>The following c++ code has the problem:</p>\n<p><code>  auto ten=torch::autograd::make_variable(at::zeros({20,20},at::kCUDA)); for(int i=0;i&lt;10;++i) { torch::serialize::OutputArchive OA; OA.write(\"tensor\",ten); save_to_file(OA,std::string(\"Cuda\")+std::to_string(i)); }</code></p>\n<p>The size of the produced files are:<br>\n8.0K    Cuda0<br>\n28K     Cuda1<br>\n104K    Cuda2<br>\n404K    Cuda3<br>\n1.6M    Cuda4<br>\n6.3M    Cuda5<br>\n26M     Cuda6<br>\n101M    Cuda7<br>\n401M    Cuda8<br>\n1.6G    Cuda9</p>\n<h2>Expected behavior</h2>\n<p>I expect the same behaviour than cpu:<br>\n4.0K    Cuda0<br>\n4.0K    Cuda1<br>\n4.0K    Cuda2<br>\n4.0K    Cuda3<br>\n4.0K    Cuda4<br>\n4.0K    Cuda5<br>\n4.0K    Cuda6<br>\n4.0K    Cuda7<br>\n4.0K    Cuda8<br>\n4.0K    Cuda9</p>\n<h2>Environment</h2>\n<p>Inside a custom made container giving as result for the environment script:<br>\nCollecting environment information...<br>\nPyTorch version: 1.0.0a0<br>\nIs debug build: No<br>\nCUDA used to build PyTorch: 9.0.176</p>\n<p>OS: Ubuntu 16.04.5 LTS<br>\nGCC version: (GCC) 8.2.0<br>\nCMake version: version 3.12.0</p>\n<p>Python version: 3.5<br>\nIs CUDA available: Yes<br>\nCUDA runtime version: 9.0.176<br>\nGPU models and configuration: GPU 0: GeForce GTX 1070<br>\nNvidia driver version: 396.54<br>\ncuDNN version: Probably one of the following:<br>\n/usr/lib/x86_64-linux-gnu/libcudnn.so.7.3.0<br>\n/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a</p>", "body_text": "\ud83d\udc1b Bug\nWhen saving to file the same tensor. The file size grow.\nTo Reproduce\nSteps to reproduce the behavior:\nThe following c++ code has the problem:\n  auto ten=torch::autograd::make_variable(at::zeros({20,20},at::kCUDA)); for(int i=0;i<10;++i) { torch::serialize::OutputArchive OA; OA.write(\"tensor\",ten); save_to_file(OA,std::string(\"Cuda\")+std::to_string(i)); }\nThe size of the produced files are:\n8.0K    Cuda0\n28K     Cuda1\n104K    Cuda2\n404K    Cuda3\n1.6M    Cuda4\n6.3M    Cuda5\n26M     Cuda6\n101M    Cuda7\n401M    Cuda8\n1.6G    Cuda9\nExpected behavior\nI expect the same behaviour than cpu:\n4.0K    Cuda0\n4.0K    Cuda1\n4.0K    Cuda2\n4.0K    Cuda3\n4.0K    Cuda4\n4.0K    Cuda5\n4.0K    Cuda6\n4.0K    Cuda7\n4.0K    Cuda8\n4.0K    Cuda9\nEnvironment\nInside a custom made container giving as result for the environment script:\nCollecting environment information...\nPyTorch version: 1.0.0a0\nIs debug build: No\nCUDA used to build PyTorch: 9.0.176\nOS: Ubuntu 16.04.5 LTS\nGCC version: (GCC) 8.2.0\nCMake version: version 3.12.0\nPython version: 3.5\nIs CUDA available: Yes\nCUDA runtime version: 9.0.176\nGPU models and configuration: GPU 0: GeForce GTX 1070\nNvidia driver version: 396.54\ncuDNN version: Probably one of the following:\n/usr/lib/x86_64-linux-gnu/libcudnn.so.7.3.0\n/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a", "body": "## \ud83d\udc1b Bug\r\n\r\nWhen saving to file the same tensor. The file size grow.\r\n\r\n## To Reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\nThe following c++ code has the problem:\r\n\r\n`  auto ten=torch::autograd::make_variable(at::zeros({20,20},at::kCUDA));\r\n    for(int i=0;i<10;++i)\r\n    {\r\n        torch::serialize::OutputArchive OA;\r\n        OA.write(\"tensor\",ten);\r\n        save_to_file(OA,std::string(\"Cuda\")+std::to_string(i));\r\n    }`\r\n\r\nThe size of the produced files are:\r\n8.0K    Cuda0\r\n28K     Cuda1\r\n104K    Cuda2\r\n404K    Cuda3\r\n1.6M    Cuda4\r\n6.3M    Cuda5\r\n26M     Cuda6\r\n101M    Cuda7\r\n401M    Cuda8\r\n1.6G    Cuda9\r\n\r\n## Expected behavior\r\nI expect the same behaviour than cpu:\r\n4.0K    Cuda0\r\n4.0K    Cuda1\r\n4.0K    Cuda2\r\n4.0K    Cuda3\r\n4.0K    Cuda4\r\n4.0K    Cuda5\r\n4.0K    Cuda6\r\n4.0K    Cuda7\r\n4.0K    Cuda8\r\n4.0K    Cuda9\r\n\r\n## Environment\r\n\r\nInside a custom made container giving as result for the environment script:\r\nCollecting environment information...\r\nPyTorch version: 1.0.0a0\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0.176\r\n\r\nOS: Ubuntu 16.04.5 LTS\r\nGCC version: (GCC) 8.2.0\r\nCMake version: version 3.12.0\r\n\r\nPython version: 3.5\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.0.176\r\nGPU models and configuration: GPU 0: GeForce GTX 1070\r\nNvidia driver version: 396.54\r\ncuDNN version: Probably one of the following:\r\n/usr/lib/x86_64-linux-gnu/libcudnn.so.7.3.0\r\n/usr/lib/x86_64-linux-gnu/libcudnn_static_v7.a\r\n"}