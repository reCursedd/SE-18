{"url": "https://api.github.com/repos/pytorch/pytorch/issues/7958", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/7958/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/7958/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/7958/events", "html_url": "https://github.com/pytorch/pytorch/issues/7958", "id": 327866745, "node_id": "MDU6SXNzdWUzMjc4NjY3NDU=", "number": 7958, "title": "[JIT][script] can't compile torch.split", "user": {"login": "zou3519", "id": 5652049, "node_id": "MDQ6VXNlcjU2NTIwNDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/5652049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zou3519", "html_url": "https://github.com/zou3519", "followers_url": "https://api.github.com/users/zou3519/followers", "following_url": "https://api.github.com/users/zou3519/following{/other_user}", "gists_url": "https://api.github.com/users/zou3519/gists{/gist_id}", "starred_url": "https://api.github.com/users/zou3519/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zou3519/subscriptions", "organizations_url": "https://api.github.com/users/zou3519/orgs", "repos_url": "https://api.github.com/users/zou3519/repos", "events_url": "https://api.github.com/users/zou3519/events{/privacy}", "received_events_url": "https://api.github.com/users/zou3519/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 679953983, "node_id": "MDU6TGFiZWw2Nzk5NTM5ODM=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/jit", "name": "jit", "color": "c5def5", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-30T19:25:40Z", "updated_at": "2018-10-29T10:29:26Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>It appears to be confused about its outputs.</p>\n<p>Example 1: (split should return a tuple)</p>\n<pre><code>In [14]: import torch\n    ...:\n    ...: @torch.jit.script\n    ...: def split_two(tensor):\n    ...:     a, b, c = torch.split(tensor, 2, dim=1)\n    ...:     return a, b, c\n    ...:\n    ...: x = torch.randn(3, 6)\n    ...: y = torch.randn(3, 6)\n    ...: split_two(x + y)\n    ...:\n    ...:\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n&lt;ipython-input-14-81d869f28dc9&gt; in &lt;module&gt;()\n      1 import torch\n      2\n----&gt; 3 @torch.jit.script\n      4 def split_two(tensor):\n      5     a, b, c = torch.split(tensor, 2, dim=1)\n\n~/pytorch/pytorch/torch/jit/__init__.py in script(fn, _frames_up)\n    369\n    370 def script(fn, _frames_up=0):\n--&gt; 371     graph = _script_graph(fn, _frames_up=_frames_up + 1)\n    372     return torch._C.GraphExecutor(graph, True)\n    373\n\n~/pytorch/pytorch/torch/jit/__init__.py in _script_graph(fn, _frames_up)\n    365     rcb = createResolutionCallback(_frames_up + 1)\n    366     ast = get_jit_ast(fn)\n--&gt; 367     return _jit_script_compile(ast, rcb)\n    368\n    369\n\nRuntimeError:\nTensor cannot be used as a tuple:\n@torch.jit.script\ndef split_two(tensor):\n    a, b, c = torch.split(tensor, 2, dim=1)\n              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ &lt;--- HERE\n    return a, b, c\n</code></pre>\n<p>Example 2:</p>\n<pre><code>\u2502\n\u2502In [15]: @torch.jit.script\n\u2502    ...: def split_two_again(tensor):\n\u2502    ...:     return torch.split(tensor, 2, dim=1)\n\u2502    ...:\n\u2502    ...: x = torch.randn(3, 6)\n\u2502    ...: split_two_again(x)\n\u2502    ...:\n\u2502---------------------------------------------------------------------------\n\u2502RuntimeError                              Traceback (most recent call last)\n\u2502&lt;ipython-input-15-d6175dc119bf&gt; in &lt;module&gt;()\n\u2502      4\n\u2502      5 x = torch.randn(3, 6)\n\u2502----&gt; 6 split_two_again(x)\n\u2502\n\u2502RuntimeError:\n\u2502torch/csrc/jit/passes/shape_analysis.cpp:103: PropagateShapeOnNodeByRunningIt: Assertion `stack.size\n\u2502() == node-&gt;outputs().size()` failed.:\n\u2502operation failed shape propagation:\n\u2502@torch.jit.script\n\u2502def split_two_again(tensor):\n\u2502    return torch.split(tensor, 2, dim=1)\n\u2502           ~~~~~~~~~~~ &lt;--- HERE\n\u2502\n</code></pre>", "body_text": "It appears to be confused about its outputs.\nExample 1: (split should return a tuple)\nIn [14]: import torch\n    ...:\n    ...: @torch.jit.script\n    ...: def split_two(tensor):\n    ...:     a, b, c = torch.split(tensor, 2, dim=1)\n    ...:     return a, b, c\n    ...:\n    ...: x = torch.randn(3, 6)\n    ...: y = torch.randn(3, 6)\n    ...: split_two(x + y)\n    ...:\n    ...:\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-14-81d869f28dc9> in <module>()\n      1 import torch\n      2\n----> 3 @torch.jit.script\n      4 def split_two(tensor):\n      5     a, b, c = torch.split(tensor, 2, dim=1)\n\n~/pytorch/pytorch/torch/jit/__init__.py in script(fn, _frames_up)\n    369\n    370 def script(fn, _frames_up=0):\n--> 371     graph = _script_graph(fn, _frames_up=_frames_up + 1)\n    372     return torch._C.GraphExecutor(graph, True)\n    373\n\n~/pytorch/pytorch/torch/jit/__init__.py in _script_graph(fn, _frames_up)\n    365     rcb = createResolutionCallback(_frames_up + 1)\n    366     ast = get_jit_ast(fn)\n--> 367     return _jit_script_compile(ast, rcb)\n    368\n    369\n\nRuntimeError:\nTensor cannot be used as a tuple:\n@torch.jit.script\ndef split_two(tensor):\n    a, b, c = torch.split(tensor, 2, dim=1)\n              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <--- HERE\n    return a, b, c\n\nExample 2:\n\u2502\n\u2502In [15]: @torch.jit.script\n\u2502    ...: def split_two_again(tensor):\n\u2502    ...:     return torch.split(tensor, 2, dim=1)\n\u2502    ...:\n\u2502    ...: x = torch.randn(3, 6)\n\u2502    ...: split_two_again(x)\n\u2502    ...:\n\u2502---------------------------------------------------------------------------\n\u2502RuntimeError                              Traceback (most recent call last)\n\u2502<ipython-input-15-d6175dc119bf> in <module>()\n\u2502      4\n\u2502      5 x = torch.randn(3, 6)\n\u2502----> 6 split_two_again(x)\n\u2502\n\u2502RuntimeError:\n\u2502torch/csrc/jit/passes/shape_analysis.cpp:103: PropagateShapeOnNodeByRunningIt: Assertion `stack.size\n\u2502() == node->outputs().size()` failed.:\n\u2502operation failed shape propagation:\n\u2502@torch.jit.script\n\u2502def split_two_again(tensor):\n\u2502    return torch.split(tensor, 2, dim=1)\n\u2502           ~~~~~~~~~~~ <--- HERE\n\u2502", "body": "It appears to be confused about its outputs.\r\n\r\nExample 1: (split should return a tuple)\r\n```\r\nIn [14]: import torch\r\n    ...:\r\n    ...: @torch.jit.script\r\n    ...: def split_two(tensor):\r\n    ...:     a, b, c = torch.split(tensor, 2, dim=1)\r\n    ...:     return a, b, c\r\n    ...:\r\n    ...: x = torch.randn(3, 6)\r\n    ...: y = torch.randn(3, 6)\r\n    ...: split_two(x + y)\r\n    ...:\r\n    ...:\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-14-81d869f28dc9> in <module>()\r\n      1 import torch\r\n      2\r\n----> 3 @torch.jit.script\r\n      4 def split_two(tensor):\r\n      5     a, b, c = torch.split(tensor, 2, dim=1)\r\n\r\n~/pytorch/pytorch/torch/jit/__init__.py in script(fn, _frames_up)\r\n    369\r\n    370 def script(fn, _frames_up=0):\r\n--> 371     graph = _script_graph(fn, _frames_up=_frames_up + 1)\r\n    372     return torch._C.GraphExecutor(graph, True)\r\n    373\r\n\r\n~/pytorch/pytorch/torch/jit/__init__.py in _script_graph(fn, _frames_up)\r\n    365     rcb = createResolutionCallback(_frames_up + 1)\r\n    366     ast = get_jit_ast(fn)\r\n--> 367     return _jit_script_compile(ast, rcb)\r\n    368\r\n    369\r\n\r\nRuntimeError:\r\nTensor cannot be used as a tuple:\r\n@torch.jit.script\r\ndef split_two(tensor):\r\n    a, b, c = torch.split(tensor, 2, dim=1)\r\n              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <--- HERE\r\n    return a, b, c\r\n```\r\n\r\nExample 2:\r\n```\r\n\u2502\r\n\u2502In [15]: @torch.jit.script\r\n\u2502    ...: def split_two_again(tensor):\r\n\u2502    ...:     return torch.split(tensor, 2, dim=1)\r\n\u2502    ...:\r\n\u2502    ...: x = torch.randn(3, 6)\r\n\u2502    ...: split_two_again(x)\r\n\u2502    ...:\r\n\u2502---------------------------------------------------------------------------\r\n\u2502RuntimeError                              Traceback (most recent call last)\r\n\u2502<ipython-input-15-d6175dc119bf> in <module>()\r\n\u2502      4\r\n\u2502      5 x = torch.randn(3, 6)\r\n\u2502----> 6 split_two_again(x)\r\n\u2502\r\n\u2502RuntimeError:\r\n\u2502torch/csrc/jit/passes/shape_analysis.cpp:103: PropagateShapeOnNodeByRunningIt: Assertion `stack.size\r\n\u2502() == node->outputs().size()` failed.:\r\n\u2502operation failed shape propagation:\r\n\u2502@torch.jit.script\r\n\u2502def split_two_again(tensor):\r\n\u2502    return torch.split(tensor, 2, dim=1)\r\n\u2502           ~~~~~~~~~~~ <--- HERE\r\n\u2502\r\n```"}