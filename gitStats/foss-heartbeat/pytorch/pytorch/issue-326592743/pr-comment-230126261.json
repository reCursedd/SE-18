{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/230126261", "pull_request_review_id": 170791392, "id": 230126261, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDEyNjI2MQ==", "diff_hunk": "@@ -21,9 +27,34 @@ def assertSameOutputs(self, outputs1, outputs2, decimal=7):\n             self.assertEqual(o1.dtype, o2.dtype)\n             np.testing.assert_almost_equal(o1, o2, decimal=decimal)\n \n-    def add_test_case(name, test_func):\n+    def add_test_case(self, name, test_func):\n         if not name.startswith('test_'):\n             raise ValueError('Test name must start with test_: {}'.format(name))\n         if hasattr(self, name):\n             raise ValueError('Duplicated test name: {}'.format(name))\n         setattr(self, name, test_func)\n+\n+\n+class DownloadingTestCase(TestCase):\n+\n+    def _download(self, model):\n+        model_dir = self._model_dir(model)\n+        assert not os.path.exists(model_dir)\n+        os.makedirs(model_dir)\n+        for f in ['predict_net.pb', 'init_net.pb', 'value_info.json']:\n+            url = getURLFromName(model, f)\n+            dest = os.path.join(model_dir, f)\n+            try:\n+                try:\n+                    downloadFromURLToFile(url, dest,\n+                                          show_progress=False)\n+                except TypeError:\n+                    # show_progress not supported prior to\n+                    # Caffe2 78c014e752a374d905ecfb465d44fa16e02a28f1\n+                    # (Sep 17, 2017)\n+                    downloadFromURLToFile(url, dest)\n+            except Exception as e:\n+                print(\"Abort: {reason}\".format(reason=e))\n+                print(\"Cleaning up...\")\n+                deleteDirectory(model_dir)\n+                exit(1)", "path": "caffe2/python/onnx/tests/test_utils.py", "position": null, "original_position": 55, "commit_id": "9ec296301749f562077dd49cff752f1e8b1a8069", "original_commit_id": "c2fa010cf137d725a9abd83acec87da469821827", "user": {"login": "tomdz", "id": 107155, "node_id": "MDQ6VXNlcjEwNzE1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/107155?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tomdz", "html_url": "https://github.com/tomdz", "followers_url": "https://api.github.com/users/tomdz/followers", "following_url": "https://api.github.com/users/tomdz/following{/other_user}", "gists_url": "https://api.github.com/users/tomdz/gists{/gist_id}", "starred_url": "https://api.github.com/users/tomdz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tomdz/subscriptions", "organizations_url": "https://api.github.com/users/tomdz/orgs", "repos_url": "https://api.github.com/users/tomdz/repos", "events_url": "https://api.github.com/users/tomdz/events{/privacy}", "received_events_url": "https://api.github.com/users/tomdz/received_events", "type": "User", "site_admin": false}, "body": "Probably better to raise an `AssertionError` or similar.", "created_at": "2018-11-01T17:25:40Z", "updated_at": "2018-11-23T15:54:00Z", "html_url": "https://github.com/pytorch/pytorch/pull/7847#discussion_r230126261", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/7847", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/230126261"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/7847#discussion_r230126261"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/7847"}}, "body_html": "<p>Probably better to raise an <code>AssertionError</code> or similar.</p>", "body_text": "Probably better to raise an AssertionError or similar."}