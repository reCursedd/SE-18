{"url": "https://api.github.com/repos/pytorch/pytorch/issues/1998", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/1998/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/1998/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/1998/events", "html_url": "https://github.com/pytorch/pytorch/issues/1998", "id": 241152714, "node_id": "MDU6SXNzdWUyNDExNTI3MTQ=", "number": 1998, "title": "Program runs fine on Mac but not on Linux (both CPU and GPU problems)", "user": {"login": "salman1993", "id": 7154255, "node_id": "MDQ6VXNlcjcxNTQyNTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/7154255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/salman1993", "html_url": "https://github.com/salman1993", "followers_url": "https://api.github.com/users/salman1993/followers", "following_url": "https://api.github.com/users/salman1993/following{/other_user}", "gists_url": "https://api.github.com/users/salman1993/gists{/gist_id}", "starred_url": "https://api.github.com/users/salman1993/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/salman1993/subscriptions", "organizations_url": "https://api.github.com/users/salman1993/orgs", "repos_url": "https://api.github.com/users/salman1993/repos", "events_url": "https://api.github.com/users/salman1993/events{/privacy}", "received_events_url": "https://api.github.com/users/salman1993/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-07-07T04:12:29Z", "updated_at": "2017-07-07T13:28:07Z", "closed_at": "2017-07-07T13:28:07Z", "author_association": "NONE", "body_html": "<p>Here is the link to my repo:<br>\n<a href=\"https://github.com/salman1993/simple-qa-on-kb/tree/master/clean/relation_prediction\">https://github.com/salman1993/simple-qa-on-kb/tree/master/clean/relation_prediction</a></p>\n<p>The model code is very similar to the SNLI model example. The dataset may need to be downloaded - did not test out that part of the code.<br>\nLink to the dataset - <a href=\"https://www.dropbox.com/s/tohrsllcfy7rch4/SimpleQuestions_v2.tgz\" rel=\"nofollow\">https://www.dropbox.com/s/tohrsllcfy7rch4/SimpleQuestions_v2.tgz</a></p>\n<p>I run this code on my Mac and it is running fine. However, the code fails on Linux, both on CPU and GPU. I am running PyTorch version - '0.1.12_2'<br>\nYou can run the code with:</p>\n<pre><code>python train.py \npython train.py --cuda\n</code></pre>\n<p>This is the error I get on CPU:</p>\n<pre><code>$ python train.py\nWARNING: You have CUDA but not using it.\nroot path for relation dataset: ../data\nNamespace(batch_size=2, birnn=True, clip_gradient=0.5, cuda=False, d_embed=300, d_hidden=400, d_out=1838, data_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/data_cache', dev_every=1, dropout_prob=0.3, epochs=40, fix_emb=True, gpu=-1, log_every=1, lr=1e-05, n_cells=4, n_embed=74820, n_layers=2, patience=10, resume_snapshot='', save_every=100, save_path='saved_checkpoints', seed=1111, test=False, vector_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/vector_cache/input_vectors.pt', word_vectors='glove.42B')\n  Time Epoch Iteration Progress    (%Epoch)   Loss   Dev/Loss     Accuracy  Dev/Accuracy\nTraceback (most recent call last):\n  File \"train.py\", line 100, in &lt;module&gt;\n    answer = model(batch)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 50, in forward\n    question_embed = self.embed(batch.question)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/sparse.py\", line 94, in forward\n    )(input, self.weight)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/thnn/sparse.py\", line 53, in forward\n    output = torch.index_select(weight, 0, indices.view(-1))\nRuntimeError: index out of range at /py/conda-bld/pytorch_1493680494901/work/torch/lib/TH/generic/THTensorMath.c:273\n</code></pre>\n<p>On the GPU, the error is different:</p>\n<pre><code>$ python train.py --cuda\nroot path for relation dataset: ../data\nNamespace(batch_size=2, birnn=True, clip_gradient=0.5, cuda=True, d_embed=300, d_hidden=400, d_out=1838, data_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/data_cache', dev_every=1, dropout_prob=0.3, epochs=40, fix_emb=True, gpu=0, log_every=1, lr=1e-05, n_cells=4, n_embed=74820, n_layers=2, patience=10, resume_snapshot='', save_every=100, save_path='saved_checkpoints', seed=1111, test=False, vector_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/vector_cache/input_vectors.pt', word_vectors='glove.42B')\n  Time Epoch Iteration Progress    (%Epoch)   Loss   Dev/Loss     Accuracy  Dev/Accuracy\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [64,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [65,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [66,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [67,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [68,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [69,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [70,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;T, IndexType&gt;, TensorInfo&lt;long, IndexType&gt;, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [71,0,0] Assertion `srcIndex &lt; srcSelectDimSize` failed.\nTraceback (most recent call last):\n  File \"train.py\", line 100, in &lt;module&gt;\n    answer = model(batch)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 54, in forward\n    question_encoded = self.encoder(question_embed)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 20, in forward\n    outputs, (ht, ct) = self.rnn(inputs, (h0, c0))\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 91, in forward\n    output, hidden = func(input, self.all_weights, hx)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 343, in forward\n    return func(input, *fargs, **fkwargs)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/autograd/function.py\", line 202, in _do_forward\n    flat_output = super(NestedIOFunction, self)._do_forward(*flat_input)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/autograd/function.py\", line 224, in forward\n    result = self.forward_extended(*nested_tensors)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 285, in forward_extended\n    cudnn.rnn.forward(self, input, hx, weight, output, hy)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/rnn.py\", line 190, in forward\n    handle = cudnn.get_handle()\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 262, in get_handle\n    handle = CuDNNHandle()\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 81, in __init__\n    check_error(lib.cudnnCreate(ctypes.byref(ptr)))\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 249, in check_error\n    raise CuDNNError(status)\ntorch.backends.cudnn.CuDNNError: 4: b'CUDNN_STATUS_INTERNAL_ERROR'\nException ignored in: &lt;bound method CuDNNHandle.__del__ of &lt;torch.backends.cudnn.CuDNNHandle object at 0x7f540b0b8550&gt;&gt;\nTraceback (most recent call last):\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 85, in __del__\n    check_error(lib.cudnnDestroy(self))\nctypes.ArgumentError: argument 1: &lt;class 'TypeError'&gt;: Don't know how to convert parameter 1\n</code></pre>\n<p>I tried uninstalling PyTorch and reinstalling it as well but did not work.</p>", "body_text": "Here is the link to my repo:\nhttps://github.com/salman1993/simple-qa-on-kb/tree/master/clean/relation_prediction\nThe model code is very similar to the SNLI model example. The dataset may need to be downloaded - did not test out that part of the code.\nLink to the dataset - https://www.dropbox.com/s/tohrsllcfy7rch4/SimpleQuestions_v2.tgz\nI run this code on my Mac and it is running fine. However, the code fails on Linux, both on CPU and GPU. I am running PyTorch version - '0.1.12_2'\nYou can run the code with:\npython train.py \npython train.py --cuda\n\nThis is the error I get on CPU:\n$ python train.py\nWARNING: You have CUDA but not using it.\nroot path for relation dataset: ../data\nNamespace(batch_size=2, birnn=True, clip_gradient=0.5, cuda=False, d_embed=300, d_hidden=400, d_out=1838, data_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/data_cache', dev_every=1, dropout_prob=0.3, epochs=40, fix_emb=True, gpu=-1, log_every=1, lr=1e-05, n_cells=4, n_embed=74820, n_layers=2, patience=10, resume_snapshot='', save_every=100, save_path='saved_checkpoints', seed=1111, test=False, vector_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/vector_cache/input_vectors.pt', word_vectors='glove.42B')\n  Time Epoch Iteration Progress    (%Epoch)   Loss   Dev/Loss     Accuracy  Dev/Accuracy\nTraceback (most recent call last):\n  File \"train.py\", line 100, in <module>\n    answer = model(batch)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 50, in forward\n    question_embed = self.embed(batch.question)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/sparse.py\", line 94, in forward\n    )(input, self.weight)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/thnn/sparse.py\", line 53, in forward\n    output = torch.index_select(weight, 0, indices.view(-1))\nRuntimeError: index out of range at /py/conda-bld/pytorch_1493680494901/work/torch/lib/TH/generic/THTensorMath.c:273\n\nOn the GPU, the error is different:\n$ python train.py --cuda\nroot path for relation dataset: ../data\nNamespace(batch_size=2, birnn=True, clip_gradient=0.5, cuda=True, d_embed=300, d_hidden=400, d_out=1838, data_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/data_cache', dev_every=1, dropout_prob=0.3, epochs=40, fix_emb=True, gpu=0, log_every=1, lr=1e-05, n_cells=4, n_embed=74820, n_layers=2, patience=10, resume_snapshot='', save_every=100, save_path='saved_checkpoints', seed=1111, test=False, vector_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/vector_cache/input_vectors.pt', word_vectors='glove.42B')\n  Time Epoch Iteration Progress    (%Epoch)   Loss   Dev/Loss     Accuracy  Dev/Accuracy\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [64,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [65,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [66,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [67,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [68,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [69,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [70,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [71,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\nTraceback (most recent call last):\n  File \"train.py\", line 100, in <module>\n    answer = model(batch)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 54, in forward\n    question_encoded = self.encoder(question_embed)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 20, in forward\n    outputs, (ht, ct) = self.rnn(inputs, (h0, c0))\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\n    result = self.forward(*input, **kwargs)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 91, in forward\n    output, hidden = func(input, self.all_weights, hx)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 343, in forward\n    return func(input, *fargs, **fkwargs)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/autograd/function.py\", line 202, in _do_forward\n    flat_output = super(NestedIOFunction, self)._do_forward(*flat_input)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/autograd/function.py\", line 224, in forward\n    result = self.forward_extended(*nested_tensors)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 285, in forward_extended\n    cudnn.rnn.forward(self, input, hx, weight, output, hy)\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/rnn.py\", line 190, in forward\n    handle = cudnn.get_handle()\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 262, in get_handle\n    handle = CuDNNHandle()\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 81, in __init__\n    check_error(lib.cudnnCreate(ctypes.byref(ptr)))\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 249, in check_error\n    raise CuDNNError(status)\ntorch.backends.cudnn.CuDNNError: 4: b'CUDNN_STATUS_INTERNAL_ERROR'\nException ignored in: <bound method CuDNNHandle.__del__ of <torch.backends.cudnn.CuDNNHandle object at 0x7f540b0b8550>>\nTraceback (most recent call last):\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 85, in __del__\n    check_error(lib.cudnnDestroy(self))\nctypes.ArgumentError: argument 1: <class 'TypeError'>: Don't know how to convert parameter 1\n\nI tried uninstalling PyTorch and reinstalling it as well but did not work.", "body": "Here is the link to my repo:\r\nhttps://github.com/salman1993/simple-qa-on-kb/tree/master/clean/relation_prediction\r\n\r\nThe model code is very similar to the SNLI model example. The dataset may need to be downloaded - did not test out that part of the code.\r\nLink to the dataset - https://www.dropbox.com/s/tohrsllcfy7rch4/SimpleQuestions_v2.tgz\r\n\r\nI run this code on my Mac and it is running fine. However, the code fails on Linux, both on CPU and GPU. I am running PyTorch version - '0.1.12_2'\r\nYou can run the code with:\r\n```\r\npython train.py \r\npython train.py --cuda\r\n```\r\n\r\nThis is the error I get on CPU:\r\n```\r\n$ python train.py\r\nWARNING: You have CUDA but not using it.\r\nroot path for relation dataset: ../data\r\nNamespace(batch_size=2, birnn=True, clip_gradient=0.5, cuda=False, d_embed=300, d_hidden=400, d_out=1838, data_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/data_cache', dev_every=1, dropout_prob=0.3, epochs=40, fix_emb=True, gpu=-1, log_every=1, lr=1e-05, n_cells=4, n_embed=74820, n_layers=2, patience=10, resume_snapshot='', save_every=100, save_path='saved_checkpoints', seed=1111, test=False, vector_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/vector_cache/input_vectors.pt', word_vectors='glove.42B')\r\n  Time Epoch Iteration Progress    (%Epoch)   Loss   Dev/Loss     Accuracy  Dev/Accuracy\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 100, in <module>\r\n    answer = model(batch)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 50, in forward\r\n    question_embed = self.embed(batch.question)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/sparse.py\", line 94, in forward\r\n    )(input, self.weight)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/thnn/sparse.py\", line 53, in forward\r\n    output = torch.index_select(weight, 0, indices.view(-1))\r\nRuntimeError: index out of range at /py/conda-bld/pytorch_1493680494901/work/torch/lib/TH/generic/THTensorMath.c:273\r\n```\r\n\r\nOn the GPU, the error is different:\r\n```\r\n$ python train.py --cuda\r\nroot path for relation dataset: ../data\r\nNamespace(batch_size=2, birnn=True, clip_gradient=0.5, cuda=True, d_embed=300, d_hidden=400, d_out=1838, data_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/data_cache', dev_every=1, dropout_prob=0.3, epochs=40, fix_emb=True, gpu=0, log_every=1, lr=1e-05, n_cells=4, n_embed=74820, n_layers=2, patience=10, resume_snapshot='', save_every=100, save_path='saved_checkpoints', seed=1111, test=False, vector_cache='/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/vector_cache/input_vectors.pt', word_vectors='glove.42B')\r\n  Time Epoch Iteration Progress    (%Epoch)   Loss   Dev/Loss     Accuracy  Dev/Accuracy\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [64,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [65,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [66,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [67,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [68,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [69,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [70,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/py/conda-bld/pytorch_1493680494901/work/torch/lib/THC/THCTensorIndex.cu:321: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2]: block: [51,0,0], thread: [71,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 100, in <module>\r\n    answer = model(batch)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 54, in forward\r\n    question_encoded = self.encoder(question_embed)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/u/s43mohammed/dev/simple-qa-on-kb/clean/relation_prediction/model.py\", line 20, in forward\r\n    outputs, (ht, ct) = self.rnn(inputs, (h0, c0))\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 206, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 91, in forward\r\n    output, hidden = func(input, self.all_weights, hx)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 343, in forward\r\n    return func(input, *fargs, **fkwargs)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/autograd/function.py\", line 202, in _do_forward\r\n    flat_output = super(NestedIOFunction, self)._do_forward(*flat_input)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/autograd/function.py\", line 224, in forward\r\n    result = self.forward_extended(*nested_tensors)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/nn/_functions/rnn.py\", line 285, in forward_extended\r\n    cudnn.rnn.forward(self, input, hx, weight, output, hy)\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/rnn.py\", line 190, in forward\r\n    handle = cudnn.get_handle()\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 262, in get_handle\r\n    handle = CuDNNHandle()\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 81, in __init__\r\n    check_error(lib.cudnnCreate(ctypes.byref(ptr)))\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 249, in check_error\r\n    raise CuDNNError(status)\r\ntorch.backends.cudnn.CuDNNError: 4: b'CUDNN_STATUS_INTERNAL_ERROR'\r\nException ignored in: <bound method CuDNNHandle.__del__ of <torch.backends.cudnn.CuDNNHandle object at 0x7f540b0b8550>>\r\nTraceback (most recent call last):\r\n  File \"/u5/s43mohammed/anaconda3/lib/python3.6/site-packages/torch/backends/cudnn/__init__.py\", line 85, in __del__\r\n    check_error(lib.cudnnDestroy(self))\r\nctypes.ArgumentError: argument 1: <class 'TypeError'>: Don't know how to convert parameter 1\r\n```\r\n\r\nI tried uninstalling PyTorch and reinstalling it as well but did not work. "}