{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/219987708", "pull_request_review_id": 158291448, "id": 219987708, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTk4NzcwOA==", "diff_hunk": "@@ -121,17 +156,43 @@ struct VISIBILITY_HIDDEN PythonValue : public SugaredValue {\n \n     // Release the function object so we can wrap it in a PythonOp\n     py::object func = self;\n-    std::string cconv(inputs.size(), 'd');\n-    Node* new_node = m.graph()->insertNode(m.graph()->createPythonOp(\n-      THPObjectPtr(func.release().ptr()), cconv, {}));\n+", "path": "torch/csrc/jit/script/init.cpp", "position": null, "original_position": 63, "commit_id": "d356b035e17caebb2c5677087164bc339641fa7e", "original_commit_id": "e0f50ab8a3b44ebebe7679499e3bd0691e7ba7a2", "user": {"login": "zdevito", "id": 370202, "node_id": "MDQ6VXNlcjM3MDIwMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/370202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zdevito", "html_url": "https://github.com/zdevito", "followers_url": "https://api.github.com/users/zdevito/followers", "following_url": "https://api.github.com/users/zdevito/following{/other_user}", "gists_url": "https://api.github.com/users/zdevito/gists{/gist_id}", "starred_url": "https://api.github.com/users/zdevito/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zdevito/subscriptions", "organizations_url": "https://api.github.com/users/zdevito/orgs", "repos_url": "https://api.github.com/users/zdevito/repos", "events_url": "https://api.github.com/users/zdevito/events{/privacy}", "received_events_url": "https://api.github.com/users/zdevito/received_events", "type": "User", "site_admin": false}, "body": "Take a look at how torch.jit.script functions are handled in `toSugaredValue` (insert some debugging code if you want to trace how it works). In particular, they are treated as ModuleValues. Weak script should be treated the same way. In `toSugaredValue` if you find a weak script function, convert it to a ScriptModule (and cache the script module). There does not need to be any code changes for the calling a function path.", "created_at": "2018-09-24T21:01:13Z", "updated_at": "2018-11-23T15:51:50Z", "html_url": "https://github.com/pytorch/pytorch/pull/11963#discussion_r219987708", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/11963", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/219987708"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/11963#discussion_r219987708"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/11963"}}, "body_html": "<p>Take a look at how torch.jit.script functions are handled in <code>toSugaredValue</code> (insert some debugging code if you want to trace how it works). In particular, they are treated as ModuleValues. Weak script should be treated the same way. In <code>toSugaredValue</code> if you find a weak script function, convert it to a ScriptModule (and cache the script module). There does not need to be any code changes for the calling a function path.</p>", "body_text": "Take a look at how torch.jit.script functions are handled in toSugaredValue (insert some debugging code if you want to trace how it works). In particular, they are treated as ModuleValues. Weak script should be treated the same way. In toSugaredValue if you find a weak script function, convert it to a ScriptModule (and cache the script module). There does not need to be any code changes for the calling a function path."}