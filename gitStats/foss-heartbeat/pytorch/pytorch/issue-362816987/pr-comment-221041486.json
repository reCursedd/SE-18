{"url": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/221041486", "pull_request_review_id": 159595690, "id": 221041486, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTA0MTQ4Ng==", "diff_hunk": "@@ -316,6 +316,17 @@ std::shared_ptr<SugaredValue> toSugaredValue(\n   } else if (py::isinstance<py::module>(obj)) {\n     return std::make_shared<PythonModuleValue>(obj);\n   }\n+\n+  bool is_weak = py::hasattr(obj, \"_jit_is_weak_script\") &&\n+      py::cast<bool>(py::getattr(obj, \"_jit_is_weak_script\"));\n+\n+  if (is_weak) {\n+    auto compiled_fn =\n+        py::module::import(\"torch.jit\").attr(\"script\")(obj, true, 0, true);", "path": "torch/csrc/jit/script/init.cpp", "position": null, "original_position": 10, "commit_id": "d356b035e17caebb2c5677087164bc339641fa7e", "original_commit_id": "9bf1d156d51f3d71e43654bb2441b26727afe7f3", "user": {"login": "apaszke", "id": 4583066, "node_id": "MDQ6VXNlcjQ1ODMwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4583066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apaszke", "html_url": "https://github.com/apaszke", "followers_url": "https://api.github.com/users/apaszke/followers", "following_url": "https://api.github.com/users/apaszke/following{/other_user}", "gists_url": "https://api.github.com/users/apaszke/gists{/gist_id}", "starred_url": "https://api.github.com/users/apaszke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apaszke/subscriptions", "organizations_url": "https://api.github.com/users/apaszke/orgs", "repos_url": "https://api.github.com/users/apaszke/repos", "events_url": "https://api.github.com/users/apaszke/events{/privacy}", "received_events_url": "https://api.github.com/users/apaszke/received_events", "type": "User", "site_admin": false}, "body": "Hmm shouldn't we compile weak script functions when they are first decorated? Will the Python value lookup work if they will close over some values from their outer scope? Can you try adding that to the test?", "created_at": "2018-09-27T19:03:09Z", "updated_at": "2018-11-23T15:52:06Z", "html_url": "https://github.com/pytorch/pytorch/pull/11963#discussion_r221041486", "pull_request_url": "https://api.github.com/repos/pytorch/pytorch/pulls/11963", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/comments/221041486"}, "html": {"href": "https://github.com/pytorch/pytorch/pull/11963#discussion_r221041486"}, "pull_request": {"href": "https://api.github.com/repos/pytorch/pytorch/pulls/11963"}}, "body_html": "<p>Hmm shouldn't we compile weak script functions when they are first decorated? Will the Python value lookup work if they will close over some values from their outer scope? Can you try adding that to the test?</p>", "body_text": "Hmm shouldn't we compile weak script functions when they are first decorated? Will the Python value lookup work if they will close over some values from their outer scope? Can you try adding that to the test?"}