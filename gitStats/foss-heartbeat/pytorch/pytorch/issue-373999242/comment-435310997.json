{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/435310997", "html_url": "https://github.com/pytorch/pytorch/issues/13123#issuecomment-435310997", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13123", "id": 435310997, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTMxMDk5Nw==", "user": {"login": "remi-r-mp", "id": 43028738, "node_id": "MDQ6VXNlcjQzMDI4NzM4", "avatar_url": "https://avatars0.githubusercontent.com/u/43028738?v=4", "gravatar_id": "", "url": "https://api.github.com/users/remi-r-mp", "html_url": "https://github.com/remi-r-mp", "followers_url": "https://api.github.com/users/remi-r-mp/followers", "following_url": "https://api.github.com/users/remi-r-mp/following{/other_user}", "gists_url": "https://api.github.com/users/remi-r-mp/gists{/gist_id}", "starred_url": "https://api.github.com/users/remi-r-mp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/remi-r-mp/subscriptions", "organizations_url": "https://api.github.com/users/remi-r-mp/orgs", "repos_url": "https://api.github.com/users/remi-r-mp/repos", "events_url": "https://api.github.com/users/remi-r-mp/events{/privacy}", "received_events_url": "https://api.github.com/users/remi-r-mp/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-02T08:49:28Z", "updated_at": "2018-11-02T08:49:28Z", "author_association": "NONE", "body_html": "<p>I've made some code to reproduce the error:</p>\n<pre><code>import dotenv\nimport django\ndotenv.load_dotenv()\ndjango.setup()\n\nimport torch\nimport torch.nn as nn\n\n\nclass Network(nn.Module):\n    def __init__(self):\n        super(Network, self).__init__()\n        self.linear = nn.Linear(4, 1)\n\n    def forward(self, x):\n        x = self.linear(x)\n        return x\n\n\ninputs_tensor = torch.rand(10, 4)\ntargets_tensor = torch.rand(10, 1)\n\nnet = Network()\ncriterion = nn.MSELoss()\noptimizer = torch.optim.SGD(net.parameters(), lr=0.0001)\n\noptimizer.zero_grad()\noutputs = net(inputs_tensor)\nloss = criterion(outputs, targets_tensor)\n\nloss.backward()\noptimizer.step()\n\n</code></pre>\n<p>It seems that django is somehow interfering, causing the bug... (when you comment it out it does work, though I need a django connection to fetch data from the database (not used in this example))</p>", "body_text": "I've made some code to reproduce the error:\nimport dotenv\nimport django\ndotenv.load_dotenv()\ndjango.setup()\n\nimport torch\nimport torch.nn as nn\n\n\nclass Network(nn.Module):\n    def __init__(self):\n        super(Network, self).__init__()\n        self.linear = nn.Linear(4, 1)\n\n    def forward(self, x):\n        x = self.linear(x)\n        return x\n\n\ninputs_tensor = torch.rand(10, 4)\ntargets_tensor = torch.rand(10, 1)\n\nnet = Network()\ncriterion = nn.MSELoss()\noptimizer = torch.optim.SGD(net.parameters(), lr=0.0001)\n\noptimizer.zero_grad()\noutputs = net(inputs_tensor)\nloss = criterion(outputs, targets_tensor)\n\nloss.backward()\noptimizer.step()\n\n\nIt seems that django is somehow interfering, causing the bug... (when you comment it out it does work, though I need a django connection to fetch data from the database (not used in this example))", "body": "I've made some code to reproduce the error:\r\n\r\n```\r\nimport dotenv\r\nimport django\r\ndotenv.load_dotenv()\r\ndjango.setup()\r\n\r\nimport torch\r\nimport torch.nn as nn\r\n\r\n\r\nclass Network(nn.Module):\r\n    def __init__(self):\r\n        super(Network, self).__init__()\r\n        self.linear = nn.Linear(4, 1)\r\n\r\n    def forward(self, x):\r\n        x = self.linear(x)\r\n        return x\r\n\r\n\r\ninputs_tensor = torch.rand(10, 4)\r\ntargets_tensor = torch.rand(10, 1)\r\n\r\nnet = Network()\r\ncriterion = nn.MSELoss()\r\noptimizer = torch.optim.SGD(net.parameters(), lr=0.0001)\r\n\r\noptimizer.zero_grad()\r\noutputs = net(inputs_tensor)\r\nloss = criterion(outputs, targets_tensor)\r\n\r\nloss.backward()\r\noptimizer.step()\r\n\r\n```\r\nIt seems that django is somehow interfering, causing the bug... (when you comment it out it does work, though I need a django connection to fetch data from the database (not used in this example))"}