{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/435562099", "html_url": "https://github.com/pytorch/pytorch/issues/13276#issuecomment-435562099", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/13276", "id": 435562099, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTU2MjA5OQ==", "user": {"login": "vishwakftw", "id": 23639302, "node_id": "MDQ6VXNlcjIzNjM5MzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/23639302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vishwakftw", "html_url": "https://github.com/vishwakftw", "followers_url": "https://api.github.com/users/vishwakftw/followers", "following_url": "https://api.github.com/users/vishwakftw/following{/other_user}", "gists_url": "https://api.github.com/users/vishwakftw/gists{/gist_id}", "starred_url": "https://api.github.com/users/vishwakftw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vishwakftw/subscriptions", "organizations_url": "https://api.github.com/users/vishwakftw/orgs", "repos_url": "https://api.github.com/users/vishwakftw/repos", "events_url": "https://api.github.com/users/vishwakftw/events{/privacy}", "received_events_url": "https://api.github.com/users/vishwakftw/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-03T05:29:18Z", "updated_at": "2018-11-03T05:29:18Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I have confirmed that it is a MAGMA library issue. I did this by installing MAGMA from scratch and running the test pertaining to <code>getri</code> (<code>testing_(s)dgetri_batched.cpp</code>) with batch size 65536 and matrix dim 2. This is the result:</p>\n<pre><code>% MAGMA 2.3.0  compiled for CUDA capability &gt;= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:51:57 2018\n% Usage: ./testing/testing_dgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65536     2     ---   (  ---  )      0.02 (  59.16)   9.01e+15   failed\n</code></pre>\n<p>Whereas, for a batch size of 65535 (256 * 256 - 1):</p>\n<pre><code>% MAGMA 2.3.0  compiled for CUDA capability &gt;= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:55:07 2018\n% Usage: ./testing/testing_dgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65535     2     ---   (  ---  )      0.01 (  81.19)   1.14e-16   ok\n</code></pre>\n<p>Analogous results were found for single precision.</p>\n<pre><code>% MAGMA 2.3.0  compiled for CUDA capability &gt;= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:57:57 2018\n% Usage: ./testing/testing_sgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65536     2     ---   (  ---  )      0.04 (  31.38)   1.68e+07   failed\n</code></pre>\n<pre><code>% MAGMA 2.3.0  compiled for CUDA capability &gt;= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:57:49 2018\n% Usage: ./testing/testing_sgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65535     2     ---   (  ---  )      0.02 (  44.71)   6.15e-08   ok\n</code></pre>", "body_text": "I have confirmed that it is a MAGMA library issue. I did this by installing MAGMA from scratch and running the test pertaining to getri (testing_(s)dgetri_batched.cpp) with batch size 65536 and matrix dim 2. This is the result:\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:51:57 2018\n% Usage: ./testing/testing_dgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65536     2     ---   (  ---  )      0.02 (  59.16)   9.01e+15   failed\n\nWhereas, for a batch size of 65535 (256 * 256 - 1):\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:55:07 2018\n% Usage: ./testing/testing_dgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65535     2     ---   (  ---  )      0.01 (  81.19)   1.14e-16   ok\n\nAnalogous results were found for single precision.\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:57:57 2018\n% Usage: ./testing/testing_sgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65536     2     ---   (  ---  )      0.04 (  31.38)   1.68e+07   failed\n\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\n% Sat Nov  3 10:57:49 2018\n% Usage: ./testing/testing_sgetri_batched [options] [-h|--help]\n\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\n%===============================================================================\n     65535     2     ---   (  ---  )      0.02 (  44.71)   6.15e-08   ok", "body": "I have confirmed that it is a MAGMA library issue. I did this by installing MAGMA from scratch and running the test pertaining to `getri` (`testing_(s)dgetri_batched.cpp`) with batch size 65536 and matrix dim 2. This is the result:\r\n```\r\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\r\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \r\n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% Sat Nov  3 10:51:57 2018\r\n% Usage: ./testing/testing_dgetri_batched [options] [-h|--help]\r\n\r\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\r\n%===============================================================================\r\n     65536     2     ---   (  ---  )      0.02 (  59.16)   9.01e+15   failed\r\n```\r\n\r\nWhereas, for a batch size of 65535 (256 * 256 - 1):\r\n```\r\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\r\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \r\n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% Sat Nov  3 10:55:07 2018\r\n% Usage: ./testing/testing_dgetri_batched [options] [-h|--help]\r\n\r\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\r\n%===============================================================================\r\n     65535     2     ---   (  ---  )      0.01 (  81.19)   1.14e-16   ok\r\n```\r\n\r\nAnalogous results were found for single precision.\r\n```\r\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\r\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \r\n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% Sat Nov  3 10:57:57 2018\r\n% Usage: ./testing/testing_sgetri_batched [options] [-h|--help]\r\n\r\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\r\n%===============================================================================\r\n     65536     2     ---   (  ---  )      0.04 (  31.38)   1.68e+07   failed\r\n```\r\n\r\n```\r\n% MAGMA 2.3.0  compiled for CUDA capability >= 6.0, 32-bit magma_int_t, 64-bit pointer.\r\n% CUDA runtime 8000, driver 9010. OpenMP threads 40. \r\n% device 0: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 1: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 2: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% device 3: GeForce GTX 1080 Ti, 1582.0 MHz clock, 11178.5 MiB memory, capability 6.1\r\n% Sat Nov  3 10:57:49 2018\r\n% Usage: ./testing/testing_sgetri_batched [options] [-h|--help]\r\n\r\n% batchCount   N    CPU Gflop/s (ms)    GPU Gflop/s (ms)   ||I - A*A^{-1}||_1 / (N*cond(A))\r\n%===============================================================================\r\n     65535     2     ---   (  ---  )      0.02 (  44.71)   6.15e-08   ok\r\n```"}