{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/373248864", "html_url": "https://github.com/pytorch/pytorch/issues/5667#issuecomment-373248864", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/5667", "id": 373248864, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzI0ODg2NA==", "user": {"login": "leomao", "id": 1811303, "node_id": "MDQ6VXNlcjE4MTEzMDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/1811303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leomao", "html_url": "https://github.com/leomao", "followers_url": "https://api.github.com/users/leomao/followers", "following_url": "https://api.github.com/users/leomao/following{/other_user}", "gists_url": "https://api.github.com/users/leomao/gists{/gist_id}", "starred_url": "https://api.github.com/users/leomao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leomao/subscriptions", "organizations_url": "https://api.github.com/users/leomao/orgs", "repos_url": "https://api.github.com/users/leomao/repos", "events_url": "https://api.github.com/users/leomao/events{/privacy}", "received_events_url": "https://api.github.com/users/leomao/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-15T03:25:12Z", "updated_at": "2018-03-15T03:29:13Z", "author_association": "NONE", "body_html": "<p>I have encountered the same issue too.<br>\nThe version is pytorch 0.3.1 built from source with nccl 2.1.4, cuda 9.1.85 and cudnn 7.1.1.</p>\n<p>Executing</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> torch.nn <span class=\"pl-k\">as</span> nn\nl <span class=\"pl-k\">=</span> nn.LSTM(<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">10</span>).cuda()</pre></div>\n<p>will get following error:</p>\n<pre><code>Traceback (most recent call last):\n  File \"lstm_test.py\", line 3, in &lt;module&gt;\n    l = nn.LSTM(10, 10).cuda()\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 216, in cuda\n    return self._apply(lambda t: t.cuda(device))\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 123, in _apply\n    self.flatten_parameters()\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 111, in flatten_parameters\n    params = rnn.get_parameters(fn, handle, fn.weight_buf)\n  File \"/usr/lib/python3.6/site-packages/torch/backends/cudnn/rnn.py\", line 165, in get_parameters\n    assert filter_dim_a.prod() == filter_dim_a[0]\nAssertionError\n</code></pre>\n<p>This issue may be related to the transition from cudnn 7.0 to cudnn 7.1...</p>", "body_text": "I have encountered the same issue too.\nThe version is pytorch 0.3.1 built from source with nccl 2.1.4, cuda 9.1.85 and cudnn 7.1.1.\nExecuting\nimport torch.nn as nn\nl = nn.LSTM(10, 10).cuda()\nwill get following error:\nTraceback (most recent call last):\n  File \"lstm_test.py\", line 3, in <module>\n    l = nn.LSTM(10, 10).cuda()\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 216, in cuda\n    return self._apply(lambda t: t.cuda(device))\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 123, in _apply\n    self.flatten_parameters()\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 111, in flatten_parameters\n    params = rnn.get_parameters(fn, handle, fn.weight_buf)\n  File \"/usr/lib/python3.6/site-packages/torch/backends/cudnn/rnn.py\", line 165, in get_parameters\n    assert filter_dim_a.prod() == filter_dim_a[0]\nAssertionError\n\nThis issue may be related to the transition from cudnn 7.0 to cudnn 7.1...", "body": "I have encountered the same issue too.\r\nThe version is pytorch 0.3.1 built from source with nccl 2.1.4, cuda 9.1.85 and cudnn 7.1.1.\r\n\r\nExecuting\r\n```python\r\nimport torch.nn as nn\r\nl = nn.LSTM(10, 10).cuda()\r\n```\r\nwill get following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"lstm_test.py\", line 3, in <module>\r\n    l = nn.LSTM(10, 10).cuda()\r\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 216, in cuda\r\n    return self._apply(lambda t: t.cuda(device))\r\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 123, in _apply\r\n    self.flatten_parameters()\r\n  File \"/usr/lib/python3.6/site-packages/torch/nn/modules/rnn.py\", line 111, in flatten_parameters\r\n    params = rnn.get_parameters(fn, handle, fn.weight_buf)\r\n  File \"/usr/lib/python3.6/site-packages/torch/backends/cudnn/rnn.py\", line 165, in get_parameters\r\n    assert filter_dim_a.prod() == filter_dim_a[0]\r\nAssertionError\r\n```\r\n\r\nThis issue may be related to the transition from cudnn 7.0 to cudnn 7.1..."}