{"url": "https://api.github.com/repos/pytorch/pytorch/issues/3670", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/3670/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/3670/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/3670/events", "html_url": "https://github.com/pytorch/pytorch/issues/3670", "id": 273513267, "node_id": "MDU6SXNzdWUyNzM1MTMyNjc=", "number": 3670, "title": "Error in nll_loss - multi-target not supported", "user": {"login": "Mickey-Livesgood", "id": 31745473, "node_id": "MDQ6VXNlcjMxNzQ1NDcz", "avatar_url": "https://avatars2.githubusercontent.com/u/31745473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mickey-Livesgood", "html_url": "https://github.com/Mickey-Livesgood", "followers_url": "https://api.github.com/users/Mickey-Livesgood/followers", "following_url": "https://api.github.com/users/Mickey-Livesgood/following{/other_user}", "gists_url": "https://api.github.com/users/Mickey-Livesgood/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mickey-Livesgood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mickey-Livesgood/subscriptions", "organizations_url": "https://api.github.com/users/Mickey-Livesgood/orgs", "repos_url": "https://api.github.com/users/Mickey-Livesgood/repos", "events_url": "https://api.github.com/users/Mickey-Livesgood/events{/privacy}", "received_events_url": "https://api.github.com/users/Mickey-Livesgood/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-11-13T17:29:09Z", "updated_at": "2017-11-13T19:27:21Z", "closed_at": "2017-11-13T19:27:21Z", "author_association": "NONE", "body_html": "<p>I'm having some trouble with my CrossEntropyLoss:<br>\nI have a small ConvNet with 7 classes. I'm using <code>nn.CrossEntropyLoss(size_average=False)</code> as my criterion for the loss function.<br>\nHowever, when I run the code, I'm having errors when I try to compute the loss:</p>\n<pre><code>\n  File \"C:/***/classifier_ce.py\", line 166, in &lt;module&gt;\n    loss = criterion(y_pred,labels) # compute the loss\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 224, in __call__\n    result = self.forward(*input, **kwargs)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\loss.py\", line 482, in forward\n    self.ignore_index)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 746, in cross_entropy\n    return nll_loss(log_softmax(input), target, weight, size_average, ignore_index)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 672, in nll_loss\n    return _functions.thnn.NLLLoss.apply(input, target, weight, size_average, ignore_index)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\_functions\\thnn\\auto.py\", line 47, in forward\n    output, *ctx.additional_args)\n\nRuntimeError: multi-target not supported at d:\\projects\\pytorch\\torch\\lib\\thnn\\generic/ClassNLLCriterion.c:22\n</code></pre>\n<p>I've looked in the following issue (after solving a problem where the target tensor was a FloatTensor and changed it to a LongTensor): <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"103251591\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/torch/cutorch/issues/227\" data-hovercard-type=\"issue\" data-hovercard-url=\"/torch/cutorch/issues/227/hovercard\" href=\"https://github.com/torch/cutorch/issues/227\">torch/cutorch#227</a></p>\n<p>So I've changed my labels, to be a 1x1 LongTensor with a number raging from 0&lt;= x &lt;=6 (I have 7 classes).</p>\n<p>I'm using a trainloader, and I try to train my model with 32-batch.<br>\nI expected the labels (after the error was raised), and indeed the label that is passed to the criterion is a 32x1 LongTensor, which follows the guidlines from the issue above. However, the problem still happening.</p>\n<p>Would love some help on this issue, thanks!</p>", "body_text": "I'm having some trouble with my CrossEntropyLoss:\nI have a small ConvNet with 7 classes. I'm using nn.CrossEntropyLoss(size_average=False) as my criterion for the loss function.\nHowever, when I run the code, I'm having errors when I try to compute the loss:\n\n  File \"C:/***/classifier_ce.py\", line 166, in <module>\n    loss = criterion(y_pred,labels) # compute the loss\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 224, in __call__\n    result = self.forward(*input, **kwargs)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\loss.py\", line 482, in forward\n    self.ignore_index)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 746, in cross_entropy\n    return nll_loss(log_softmax(input), target, weight, size_average, ignore_index)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 672, in nll_loss\n    return _functions.thnn.NLLLoss.apply(input, target, weight, size_average, ignore_index)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\_functions\\thnn\\auto.py\", line 47, in forward\n    output, *ctx.additional_args)\n\nRuntimeError: multi-target not supported at d:\\projects\\pytorch\\torch\\lib\\thnn\\generic/ClassNLLCriterion.c:22\n\nI've looked in the following issue (after solving a problem where the target tensor was a FloatTensor and changed it to a LongTensor): torch/cutorch#227\nSo I've changed my labels, to be a 1x1 LongTensor with a number raging from 0<= x <=6 (I have 7 classes).\nI'm using a trainloader, and I try to train my model with 32-batch.\nI expected the labels (after the error was raised), and indeed the label that is passed to the criterion is a 32x1 LongTensor, which follows the guidlines from the issue above. However, the problem still happening.\nWould love some help on this issue, thanks!", "body": "I'm having some trouble with my CrossEntropyLoss:\r\nI have a small ConvNet with 7 classes. I'm using `nn.CrossEntropyLoss(size_average=False)` as my criterion for the loss function.\r\nHowever, when I run the code, I'm having errors when I try to compute the loss:\r\n\r\n```\r\n\r\n  File \"C:/***/classifier_ce.py\", line 166, in <module>\r\n    loss = criterion(y_pred,labels) # compute the loss\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 224, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\loss.py\", line 482, in forward\r\n    self.ignore_index)\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 746, in cross_entropy\r\n    return nll_loss(log_softmax(input), target, weight, size_average, ignore_index)\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 672, in nll_loss\r\n    return _functions.thnn.NLLLoss.apply(input, target, weight, size_average, ignore_index)\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\_functions\\thnn\\auto.py\", line 47, in forward\r\n    output, *ctx.additional_args)\r\n\r\nRuntimeError: multi-target not supported at d:\\projects\\pytorch\\torch\\lib\\thnn\\generic/ClassNLLCriterion.c:22\r\n```\r\n\r\nI've looked in the following issue (after solving a problem where the target tensor was a FloatTensor and changed it to a LongTensor): https://github.com/torch/cutorch/issues/227\r\n\r\nSo I've changed my labels, to be a 1x1 LongTensor with a number raging from 0<= x <=6 (I have 7 classes).\r\n\r\nI'm using a trainloader, and I try to train my model with 32-batch.\r\nI expected the labels (after the error was raised), and indeed the label that is passed to the criterion is a 32x1 LongTensor, which follows the guidlines from the issue above. However, the problem still happening.\r\n\r\nWould love some help on this issue, thanks!"}