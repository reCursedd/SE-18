{"url": "https://api.github.com/repos/pytorch/pytorch/issues/9990", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/9990/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/9990/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/9990/events", "html_url": "https://github.com/pytorch/pytorch/issues/9990", "id": 345541779, "node_id": "MDU6SXNzdWUzNDU1NDE3Nzk=", "number": 9990, "title": "Build fails in caffe2 git master with OpenCL ON", "user": {"login": "dbermond", "id": 16004942, "node_id": "MDQ6VXNlcjE2MDA0OTQy", "avatar_url": "https://avatars3.githubusercontent.com/u/16004942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbermond", "html_url": "https://github.com/dbermond", "followers_url": "https://api.github.com/users/dbermond/followers", "following_url": "https://api.github.com/users/dbermond/following{/other_user}", "gists_url": "https://api.github.com/users/dbermond/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbermond/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbermond/subscriptions", "organizations_url": "https://api.github.com/users/dbermond/orgs", "repos_url": "https://api.github.com/users/dbermond/repos", "events_url": "https://api.github.com/users/dbermond/events{/privacy}", "received_events_url": "https://api.github.com/users/dbermond/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 890282107, "node_id": "MDU6TGFiZWw4OTAyODIxMDc=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/caffe2", "name": "caffe2", "color": "210aa8", "default": false}, {"id": 443483881, "node_id": "MDU6TGFiZWw0NDM0ODM4ODE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/todo", "name": "todo", "color": "c2e0c6", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-07-29T15:59:42Z", "updated_at": "2018-09-24T19:32:50Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>I'm getting the following compile error when trying to build caffe2 git master:</p>\n<pre><code>[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o\nIn file included from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/registry.h:21,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/flags.h:23,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/logging.h:10,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/allocator.h:6,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/context.h:9,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.h:4,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:1:\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:18: error: \u2018caffe2::Tensor\u2019 is not a template\n CAFFE_KNOWN_TYPE(Tensor&lt;OpenCLContext&gt;);\n                  ^~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:28: note: in definition of macro \u2018CAFFE_KNOWN_TYPE\u2019\n   CaffeTypeId TypeMeta::Id&lt;T&gt;() {                                                  \\\n                            ^\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:15: error: redefinition of \u2018static caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]\u2019\n   CaffeTypeId TypeMeta::Id&lt;T&gt;() {                                                  \\\n               ^~~~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:1: note: in expansion of macro \u2018CAFFE_KNOWN_TYPE\u2019\n CAFFE_KNOWN_TYPE(Tensor&lt;OpenCLContext&gt;);\n ^~~~~~~~~~~~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:425:22: note: \u2018static caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]\u2019 previously declared here\n   inline CaffeTypeId TypeMeta::Id&lt;T&gt;() {  \\\n                      ^~~~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:446:1: note: in expansion of macro \u2018CAFFE_DECLARE_KNOWN_TYPE\u2019\n CAFFE_DECLARE_KNOWN_TYPE(1, Tensor);\n ^~~~~~~~~~~~~~~~~~~~~~~~\nmake[2]: *** [caffe2/CMakeFiles/caffe2.dir/build.make:362: caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o] Error 1\nmake[1]: *** [CMakeFiles/Makefile2:1737: caffe2/CMakeFiles/caffe2.dir/all] Error 2\nmake: *** [Makefile:141: all] Error 2\n</code></pre>\n<ul>\n<li>\n<p>Cmake command and output: <a href=\"https://bpaste.net/show/f14fd917039e\" rel=\"nofollow\">https://bpaste.net/show/f14fd917039e</a></p>\n</li>\n<li>\n<p>Caffe2 from pytorch stable release v0.4.1 builds fine with the same cmake options as above (OpenCL ON).</p>\n</li>\n<li>\n<p>Caffe2 git master builds fine when using the same cmake options as above and switching OpenCL to <code>-DUSE_OPENCL:BOOL='OFF'</code>.</p>\n</li>\n<li>\n<p>The error seems be <strong>not</strong> related to the gcc version used. The same error occurs with gcc8, gcc7 and gcc5.4.</p>\n</li>\n</ul>\n<p><strong>System Information:</strong><br>\n<strong>OS:</strong> Arch Linux x86_64<br>\n<strong>Compiler:</strong> gcc 8.1.1 (as mentioned, the same error also occurs with gcc7 and gcc5.4)<br>\n<strong>Caffe2:</strong> git master<br>\n<strong>OpenCL headers:</strong> 2.2.20170516</p>", "body_text": "I'm getting the following compile error when trying to build caffe2 git master:\n[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o\nIn file included from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/registry.h:21,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/flags.h:23,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/logging.h:10,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/allocator.h:6,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/context.h:9,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.h:4,\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:1:\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:18: error: \u2018caffe2::Tensor\u2019 is not a template\n CAFFE_KNOWN_TYPE(Tensor<OpenCLContext>);\n                  ^~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:28: note: in definition of macro \u2018CAFFE_KNOWN_TYPE\u2019\n   CaffeTypeId TypeMeta::Id<T>() {                                                  \\\n                            ^\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:15: error: redefinition of \u2018static caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]\u2019\n   CaffeTypeId TypeMeta::Id<T>() {                                                  \\\n               ^~~~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:1: note: in expansion of macro \u2018CAFFE_KNOWN_TYPE\u2019\n CAFFE_KNOWN_TYPE(Tensor<OpenCLContext>);\n ^~~~~~~~~~~~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:425:22: note: \u2018static caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]\u2019 previously declared here\n   inline CaffeTypeId TypeMeta::Id<T>() {  \\\n                      ^~~~~~~~\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:446:1: note: in expansion of macro \u2018CAFFE_DECLARE_KNOWN_TYPE\u2019\n CAFFE_DECLARE_KNOWN_TYPE(1, Tensor);\n ^~~~~~~~~~~~~~~~~~~~~~~~\nmake[2]: *** [caffe2/CMakeFiles/caffe2.dir/build.make:362: caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o] Error 1\nmake[1]: *** [CMakeFiles/Makefile2:1737: caffe2/CMakeFiles/caffe2.dir/all] Error 2\nmake: *** [Makefile:141: all] Error 2\n\n\n\nCmake command and output: https://bpaste.net/show/f14fd917039e\n\n\nCaffe2 from pytorch stable release v0.4.1 builds fine with the same cmake options as above (OpenCL ON).\n\n\nCaffe2 git master builds fine when using the same cmake options as above and switching OpenCL to -DUSE_OPENCL:BOOL='OFF'.\n\n\nThe error seems be not related to the gcc version used. The same error occurs with gcc8, gcc7 and gcc5.4.\n\n\nSystem Information:\nOS: Arch Linux x86_64\nCompiler: gcc 8.1.1 (as mentioned, the same error also occurs with gcc7 and gcc5.4)\nCaffe2: git master\nOpenCL headers: 2.2.20170516", "body": "I'm getting the following compile error when trying to build caffe2 git master:\r\n```\r\n[ 52%] Building CXX object caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o\r\nIn file included from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/registry.h:21,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/flags.h:23,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/logging.h:10,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/allocator.h:6,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/context.h:9,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.h:4,\r\n                 from /storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:1:\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:18: error: \u2018caffe2::Tensor\u2019 is not a template\r\n CAFFE_KNOWN_TYPE(Tensor<OpenCLContext>);\r\n                  ^~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:28: note: in definition of macro \u2018CAFFE_KNOWN_TYPE\u2019\r\n   CaffeTypeId TypeMeta::Id<T>() {                                                  \\\r\n                            ^\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:403:15: error: redefinition of \u2018static caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]\u2019\r\n   CaffeTypeId TypeMeta::Id<T>() {                                                  \\\r\n               ^~~~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/contrib/opencl/context.cc:10:1: note: in expansion of macro \u2018CAFFE_KNOWN_TYPE\u2019\r\n CAFFE_KNOWN_TYPE(Tensor<OpenCLContext>);\r\n ^~~~~~~~~~~~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:425:22: note: \u2018static caffe2::CaffeTypeId caffe2::TypeMeta::Id() [with T = caffe2::Tensor]\u2019 previously declared here\r\n   inline CaffeTypeId TypeMeta::Id<T>() {  \\\r\n                      ^~~~~~~~\r\n/storage/linux/abs/caffe2-cpu-git/src/pytorch-git/caffe2/core/typeid.h:446:1: note: in expansion of macro \u2018CAFFE_DECLARE_KNOWN_TYPE\u2019\r\n CAFFE_DECLARE_KNOWN_TYPE(1, Tensor);\r\n ^~~~~~~~~~~~~~~~~~~~~~~~\r\nmake[2]: *** [caffe2/CMakeFiles/caffe2.dir/build.make:362: caffe2/CMakeFiles/caffe2.dir/contrib/opencl/context.cc.o] Error 1\r\nmake[1]: *** [CMakeFiles/Makefile2:1737: caffe2/CMakeFiles/caffe2.dir/all] Error 2\r\nmake: *** [Makefile:141: all] Error 2\r\n```\r\n\r\n- Cmake command and output: [https://bpaste.net/show/f14fd917039e](https://bpaste.net/show/f14fd917039e)\r\n\r\n- Caffe2 from pytorch stable release v0.4.1 builds fine with the same cmake options as above (OpenCL ON).\r\n\r\n- Caffe2 git master builds fine when using the same cmake options as above and switching OpenCL to `-DUSE_OPENCL:BOOL='OFF'`.\r\n\r\n- The error seems be **not** related to the gcc version used. The same error occurs with gcc8, gcc7 and gcc5.4.\r\n\r\n**System Information:**\r\n**OS:** Arch Linux x86_64\r\n**Compiler:** gcc 8.1.1 (as mentioned, the same error also occurs with gcc7 and gcc5.4)\r\n**Caffe2:** git master\r\n**OpenCL headers:** 2.2.20170516"}