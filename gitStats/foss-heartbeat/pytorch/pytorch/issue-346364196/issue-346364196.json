{"url": "https://api.github.com/repos/pytorch/pytorch/issues/10094", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/10094/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/10094/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/10094/events", "html_url": "https://github.com/pytorch/pytorch/issues/10094", "id": 346364196, "node_id": "MDU6SXNzdWUzNDYzNjQxOTY=", "number": 10094, "title": "windows pytorch 0.4.1 error=48 : no kernel image is available for execution on the device", "user": {"login": "gongliyu", "id": 7122320, "node_id": "MDQ6VXNlcjcxMjIzMjA=", "avatar_url": "https://avatars3.githubusercontent.com/u/7122320?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gongliyu", "html_url": "https://github.com/gongliyu", "followers_url": "https://api.github.com/users/gongliyu/followers", "following_url": "https://api.github.com/users/gongliyu/following{/other_user}", "gists_url": "https://api.github.com/users/gongliyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/gongliyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gongliyu/subscriptions", "organizations_url": "https://api.github.com/users/gongliyu/orgs", "repos_url": "https://api.github.com/users/gongliyu/repos", "events_url": "https://api.github.com/users/gongliyu/events{/privacy}", "received_events_url": "https://api.github.com/users/gongliyu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-31T21:25:29Z", "updated_at": "2018-08-02T16:44:35Z", "closed_at": "2018-08-02T16:44:35Z", "author_association": "NONE", "body_html": "<h2>Issue description</h2>\n<p>After I updated windows pytorch from 0.4.0 to 0.4.1,  one of my network code throws an error. I tried to downgrade back to 0.4.0. The code works well on 0.4.0.</p>\n<p>The error messages are shown below:<br>\nTHCudaCheck FAIL file=c:\\programdata\\miniconda3\\conda-bld\\pytorch_1532505617613\\work\\aten\\src\\thc\\generic/THCTensorMathPairwise.cu line=102 error=48 : no kernel image is available for execution on the device<br>\nTraceback (most recent call last):<br>\nFile \"classification.py\", line 173, in <br>\nlogits = model(X, edges)<br>\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)<br>\nFile \"classification.py\", line 119, in forward<br>\nnet = self.hidden_layers(nodes, edges)<br>\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)<br>\nFile \"D:\\experiment\\citation\\models.py\", line 34, in forward<br>\nnet = torch.cat([x(net, edges) for x in self.layers[i]], dim=1)<br>\nFile \"D:\\experiment\\citation\\models.py\", line 34, in <br>\nnet = torch.cat([x(net, edges) for x in self.layers[i]], dim=1)<br>\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in <strong>call</strong><br>\nresult = self.forward(*input, **kwargs)<br>\nFile \"D:\\experiment\\citation\\nn.py\", line 35, in forward<br>\nnodes = F.dropout(nodes, self.feature_dropout, self.training)<br>\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 595, in dropout<br>\nreturn <em>functions.dropout.Dropout.apply(input, p, training, inplace)<br>\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn_functions\\dropout.py\", line 40, in forward<br>\nctx.noise.bernoulli</em>(1 - ctx.p).div_(1 - ctx.p)<br>\nRuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\\programdata\\miniconda3\\conda-bld\\pytorch_1532505617613\\work\\aten\\src\\thc\\generic/THCTensorMathPairwise.cu:102</p>\n<h2>System Info</h2>\n<p>PyTorch version: 0.4.1<br>\nIs debug build: No<br>\nCUDA used to build PyTorch: 9.0</p>\n<p>OS: Microsoft Windows 10 Home<br>\nGCC version: Could not collect<br>\nCMake version: Could not collect</p>\n<p>Python version: 3.6<br>\nIs CUDA available: Yes<br>\nCUDA runtime version: 9.0.176<br>\nGPU models and configuration: GPU 0: Quadro M520<br>\nNvidia driver version: 385.54<br>\ncuDNN version: Probably one of the following:<br>\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\bin\\cudnn64_7.dll</p>\n<p>Versions of relevant libraries:<br>\n[pip] numpy (1.14.1)<br>\n[pip] numpydoc (0.7.0)<br>\n[pip] torch (0.4.1)<br>\n[conda] pytorch                   0.4.1           py36_cuda90_cudnn7he774522_1    pytorch</p>", "body_text": "Issue description\nAfter I updated windows pytorch from 0.4.0 to 0.4.1,  one of my network code throws an error. I tried to downgrade back to 0.4.0. The code works well on 0.4.0.\nThe error messages are shown below:\nTHCudaCheck FAIL file=c:\\programdata\\miniconda3\\conda-bld\\pytorch_1532505617613\\work\\aten\\src\\thc\\generic/THCTensorMathPairwise.cu line=102 error=48 : no kernel image is available for execution on the device\nTraceback (most recent call last):\nFile \"classification.py\", line 173, in \nlogits = model(X, edges)\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in call\nresult = self.forward(*input, **kwargs)\nFile \"classification.py\", line 119, in forward\nnet = self.hidden_layers(nodes, edges)\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in call\nresult = self.forward(*input, **kwargs)\nFile \"D:\\experiment\\citation\\models.py\", line 34, in forward\nnet = torch.cat([x(net, edges) for x in self.layers[i]], dim=1)\nFile \"D:\\experiment\\citation\\models.py\", line 34, in \nnet = torch.cat([x(net, edges) for x in self.layers[i]], dim=1)\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in call\nresult = self.forward(*input, **kwargs)\nFile \"D:\\experiment\\citation\\nn.py\", line 35, in forward\nnodes = F.dropout(nodes, self.feature_dropout, self.training)\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 595, in dropout\nreturn functions.dropout.Dropout.apply(input, p, training, inplace)\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn_functions\\dropout.py\", line 40, in forward\nctx.noise.bernoulli(1 - ctx.p).div_(1 - ctx.p)\nRuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\\programdata\\miniconda3\\conda-bld\\pytorch_1532505617613\\work\\aten\\src\\thc\\generic/THCTensorMathPairwise.cu:102\nSystem Info\nPyTorch version: 0.4.1\nIs debug build: No\nCUDA used to build PyTorch: 9.0\nOS: Microsoft Windows 10 Home\nGCC version: Could not collect\nCMake version: Could not collect\nPython version: 3.6\nIs CUDA available: Yes\nCUDA runtime version: 9.0.176\nGPU models and configuration: GPU 0: Quadro M520\nNvidia driver version: 385.54\ncuDNN version: Probably one of the following:\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\bin\\cudnn64_7.dll\nVersions of relevant libraries:\n[pip] numpy (1.14.1)\n[pip] numpydoc (0.7.0)\n[pip] torch (0.4.1)\n[conda] pytorch                   0.4.1           py36_cuda90_cudnn7he774522_1    pytorch", "body": "## Issue description\r\nAfter I updated windows pytorch from 0.4.0 to 0.4.1,  one of my network code throws an error. I tried to downgrade back to 0.4.0. The code works well on 0.4.0.\r\n\r\nThe error messages are shown below:\r\nTHCudaCheck FAIL file=c:\\programdata\\miniconda3\\conda-bld\\pytorch_1532505617613\\work\\aten\\src\\thc\\generic/THCTensorMathPairwise.cu line=102 error=48 : no kernel image is available for execution on the device\r\nTraceback (most recent call last):\r\n  File \"classification.py\", line 173, in <module>\r\n    logits = model(X, edges)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"classification.py\", line 119, in forward\r\n    net = self.hidden_layers(nodes, edges)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:\\experiment\\citation\\models.py\", line 34, in forward\r\n    net = torch.cat([x(net, edges) for x in self.layers[i]], dim=1)\r\n  File \"D:\\experiment\\citation\\models.py\", line 34, in <listcomp>\r\n    net = torch.cat([x(net, edges) for x in self.layers[i]], dim=1)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:\\experiment\\citation\\nn.py\", line 35, in forward\r\n    nodes = F.dropout(nodes, self.feature_dropout, self.training)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 595, in dropout\r\n    return _functions.dropout.Dropout.apply(input, p, training, inplace)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\nn\\_functions\\dropout.py\", line 40, in forward\r\n    ctx.noise.bernoulli_(1 - ctx.p).div_(1 - ctx.p)\r\nRuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\\programdata\\miniconda3\\conda-bld\\pytorch_1532505617613\\work\\aten\\src\\thc\\generic/THCTensorMathPairwise.cu:102\r\n\r\n\r\n## System Info\r\nPyTorch version: 0.4.1\r\nIs debug build: No\r\nCUDA used to build PyTorch: 9.0\r\n\r\nOS: Microsoft Windows 10 Home\r\nGCC version: Could not collect\r\nCMake version: Could not collect\r\n\r\nPython version: 3.6\r\nIs CUDA available: Yes\r\nCUDA runtime version: 9.0.176\r\nGPU models and configuration: GPU 0: Quadro M520\r\nNvidia driver version: 385.54\r\ncuDNN version: Probably one of the following:\r\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\bin\\cudnn64_7.dll\r\n\r\nVersions of relevant libraries:\r\n[pip] numpy (1.14.1)\r\n[pip] numpydoc (0.7.0)\r\n[pip] torch (0.4.1)\r\n[conda] pytorch                   0.4.1           py36_cuda90_cudnn7he774522_1    pytorch\r\n\r\n"}