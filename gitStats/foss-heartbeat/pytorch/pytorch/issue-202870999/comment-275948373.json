{"url": "https://api.github.com/repos/pytorch/pytorch/issues/comments/275948373", "html_url": "https://github.com/pytorch/pytorch/issues/571#issuecomment-275948373", "issue_url": "https://api.github.com/repos/pytorch/pytorch/issues/571", "id": 275948373, "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTk0ODM3Mw==", "user": {"login": "goodmansasha", "id": 4193801, "node_id": "MDQ6VXNlcjQxOTM4MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/4193801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goodmansasha", "html_url": "https://github.com/goodmansasha", "followers_url": "https://api.github.com/users/goodmansasha/followers", "following_url": "https://api.github.com/users/goodmansasha/following{/other_user}", "gists_url": "https://api.github.com/users/goodmansasha/gists{/gist_id}", "starred_url": "https://api.github.com/users/goodmansasha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goodmansasha/subscriptions", "organizations_url": "https://api.github.com/users/goodmansasha/orgs", "repos_url": "https://api.github.com/users/goodmansasha/repos", "events_url": "https://api.github.com/users/goodmansasha/events{/privacy}", "received_events_url": "https://api.github.com/users/goodmansasha/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-29T21:39:10Z", "updated_at": "2017-01-29T21:56:16Z", "author_association": "NONE", "body_html": "<p>With torch (0.1.6.post22 and 0.1.7.post2), the sparse embeddings in cuda cause an index_select error in python3, but work fine on the cpu. The internal function expected an integer named dim but wasn't happy:</p>\n<p><code>Traceback (most recent call last): File \"&lt;stdin&gt;\", line 10, in &lt;module&gt; File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 210, in __call__ result = self.forward(*input, **kwargs) File \"&lt;stdin&gt;\", line 14, in forward File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 210, in __call__ result = self.forward(*input, **kwargs) File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/sparse.py\", line 92, in forward )(input, self.weight) File \"/usr/local/lib/python3.5/dist-packages/torch/nn/_functions/thnn/sparse.py\", line 62, in forward output = torch.index_select(weight, 0, indices.view(-1)) TypeError: torch.index_select received an invalid combination of arguments - got (torch.cuda.FloatTensor, int, torch.LongTensor), but expected (torch.cuda.FloatTensor source, int dim, torch.cuda.LongTensor index) </code></p>\n<p>Note that other toy examples work fine on cuda here, and it's just this model that breaks so far after switching to model.cuda(), see attached.<br>\n<a href=\"https://github.com/pytorch/pytorch/files/737820/embedding.txt\">embedding.txt</a></p>", "body_text": "With torch (0.1.6.post22 and 0.1.7.post2), the sparse embeddings in cuda cause an index_select error in python3, but work fine on the cpu. The internal function expected an integer named dim but wasn't happy:\nTraceback (most recent call last): File \"<stdin>\", line 10, in <module> File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 210, in __call__ result = self.forward(*input, **kwargs) File \"<stdin>\", line 14, in forward File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 210, in __call__ result = self.forward(*input, **kwargs) File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/sparse.py\", line 92, in forward )(input, self.weight) File \"/usr/local/lib/python3.5/dist-packages/torch/nn/_functions/thnn/sparse.py\", line 62, in forward output = torch.index_select(weight, 0, indices.view(-1)) TypeError: torch.index_select received an invalid combination of arguments - got (torch.cuda.FloatTensor, int, torch.LongTensor), but expected (torch.cuda.FloatTensor source, int dim, torch.cuda.LongTensor index) \nNote that other toy examples work fine on cuda here, and it's just this model that breaks so far after switching to model.cuda(), see attached.\nembedding.txt", "body": "With torch (0.1.6.post22 and 0.1.7.post2), the sparse embeddings in cuda cause an index_select error in python3, but work fine on the cpu. The internal function expected an integer named dim but wasn't happy:\r\n\r\n`Traceback (most recent call last):\r\n  File \"<stdin>\", line 10, in <module>\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 210, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"<stdin>\", line 14, in forward\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/module.py\", line 210, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/modules/sparse.py\", line 92, in forward\r\n    )(input, self.weight)\r\n  File \"/usr/local/lib/python3.5/dist-packages/torch/nn/_functions/thnn/sparse.py\", line 62, in forward\r\n    output = torch.index_select(weight, 0, indices.view(-1))\r\nTypeError: torch.index_select received an invalid combination of arguments - got (torch.cuda.FloatTensor, int, torch.LongTensor), but expected (torch.cuda.FloatTensor source, int dim, torch.cuda.LongTensor index)\r\n`\r\n\r\nNote that other toy examples work fine on cuda here, and it's just this model that breaks so far after switching to model.cuda(), see attached.\r\n[embedding.txt](https://github.com/pytorch/pytorch/files/737820/embedding.txt)\r\n\r\n"}