{"url": "https://api.github.com/repos/pytorch/pytorch/issues/5227", "repository_url": "https://api.github.com/repos/pytorch/pytorch", "labels_url": "https://api.github.com/repos/pytorch/pytorch/issues/5227/labels{/name}", "comments_url": "https://api.github.com/repos/pytorch/pytorch/issues/5227/comments", "events_url": "https://api.github.com/repos/pytorch/pytorch/issues/5227/events", "html_url": "https://github.com/pytorch/pytorch/issues/5227", "id": 296925812, "node_id": "MDU6SXNzdWUyOTY5MjU4MTI=", "number": 5227, "title": "Documentation code for sampling from categorical distribution throws an error on master", "user": {"login": "christinaheinze", "id": 10484979, "node_id": "MDQ6VXNlcjEwNDg0OTc5", "avatar_url": "https://avatars1.githubusercontent.com/u/10484979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/christinaheinze", "html_url": "https://github.com/christinaheinze", "followers_url": "https://api.github.com/users/christinaheinze/followers", "following_url": "https://api.github.com/users/christinaheinze/following{/other_user}", "gists_url": "https://api.github.com/users/christinaheinze/gists{/gist_id}", "starred_url": "https://api.github.com/users/christinaheinze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/christinaheinze/subscriptions", "organizations_url": "https://api.github.com/users/christinaheinze/orgs", "repos_url": "https://api.github.com/users/christinaheinze/repos", "events_url": "https://api.github.com/users/christinaheinze/events{/privacy}", "received_events_url": "https://api.github.com/users/christinaheinze/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 819357941, "node_id": "MDU6TGFiZWw4MTkzNTc5NDE=", "url": "https://api.github.com/repos/pytorch/pytorch/labels/distributions", "name": "distributions", "color": "39d651", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-02-13T23:39:39Z", "updated_at": "2018-07-06T20:47:31Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>the following code from the documentation of the categorical distribution (<a href=\"http://pytorch.org/docs/master/distributions.html#categorical\" rel=\"nofollow\">http://pytorch.org/docs/master/distributions.html#categorical</a>) throws an error on master:</p>\n<pre><code>import torch\nimport torch.distributions as dis\nm = dis.Categorical(torch.Tensor([ 0.25, 0.25, 0.25, 0.25 ]))\nm.sample()\n</code></pre>\n<p>yields</p>\n<pre><code>Traceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/Users/heinzedeml/anaconda3/lib/python3.6/site-packages/torch/distributions/categorical.py\", line 97, in sample\n    return sample_2d.contiguous().view(sample_shape)\nRuntimeError: invalid argument 2: size '[]' is invalid for input with 1 elements at /Users/heinzedeml/Documents/code/pytorch/aten/src/TH/THStorage.c:41\n</code></pre>\n<p>Calling <code>m.sample(sample_shape = torch.Size([1]))</code> instead works.</p>\n<p>I am using:</p>\n<p>OS: macOS High Sierra<br>\nPyTorch version: 0.4.0a0+f96f3c3<br>\nHow you installed PyTorch (conda, pip, source): source<br>\nPython version: Python 3.6.3 |Anaconda custom (64-bit)| (default, Oct 6 2017, 12:04:38)<br>\nCUDA/cuDNN version: --<br>\nGPU models and configuration: --<br>\nGCC version (if compiling from source): GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)] on darwin</p>\n<p>Thanks!</p>", "body_text": "Hi,\nthe following code from the documentation of the categorical distribution (http://pytorch.org/docs/master/distributions.html#categorical) throws an error on master:\nimport torch\nimport torch.distributions as dis\nm = dis.Categorical(torch.Tensor([ 0.25, 0.25, 0.25, 0.25 ]))\nm.sample()\n\nyields\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/Users/heinzedeml/anaconda3/lib/python3.6/site-packages/torch/distributions/categorical.py\", line 97, in sample\n    return sample_2d.contiguous().view(sample_shape)\nRuntimeError: invalid argument 2: size '[]' is invalid for input with 1 elements at /Users/heinzedeml/Documents/code/pytorch/aten/src/TH/THStorage.c:41\n\nCalling m.sample(sample_shape = torch.Size([1])) instead works.\nI am using:\nOS: macOS High Sierra\nPyTorch version: 0.4.0a0+f96f3c3\nHow you installed PyTorch (conda, pip, source): source\nPython version: Python 3.6.3 |Anaconda custom (64-bit)| (default, Oct 6 2017, 12:04:38)\nCUDA/cuDNN version: --\nGPU models and configuration: --\nGCC version (if compiling from source): GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)] on darwin\nThanks!", "body": "Hi, \r\n\r\nthe following code from the documentation of the categorical distribution (http://pytorch.org/docs/master/distributions.html#categorical) throws an error on master:\r\n\r\n```\r\nimport torch\r\nimport torch.distributions as dis\r\nm = dis.Categorical(torch.Tensor([ 0.25, 0.25, 0.25, 0.25 ]))\r\nm.sample()\r\n```\r\nyields\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/heinzedeml/anaconda3/lib/python3.6/site-packages/torch/distributions/categorical.py\", line 97, in sample\r\n    return sample_2d.contiguous().view(sample_shape)\r\nRuntimeError: invalid argument 2: size '[]' is invalid for input with 1 elements at /Users/heinzedeml/Documents/code/pytorch/aten/src/TH/THStorage.c:41\r\n```\r\n\r\nCalling `m.sample(sample_shape = torch.Size([1]))` instead works. \r\n\r\nI am using:\r\n\r\nOS: macOS High Sierra\r\nPyTorch version: 0.4.0a0+f96f3c3\r\nHow you installed PyTorch (conda, pip, source): source\r\nPython version: Python 3.6.3 |Anaconda custom (64-bit)| (default, Oct 6 2017, 12:04:38)\r\nCUDA/cuDNN version: --\r\nGPU models and configuration: --\r\nGCC version (if compiling from source): GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)] on darwin\r\n\r\nThanks!"}