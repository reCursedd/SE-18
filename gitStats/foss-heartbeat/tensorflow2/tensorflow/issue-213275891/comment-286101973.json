{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/286101973", "html_url": "https://github.com/tensorflow/tensorflow/issues/8268#issuecomment-286101973", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8268", "id": 286101973, "node_id": "MDEyOklzc3VlQ29tbWVudDI4NjEwMTk3Mw==", "user": {"login": "MudeLin", "id": 5322311, "node_id": "MDQ6VXNlcjUzMjIzMTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/5322311?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MudeLin", "html_url": "https://github.com/MudeLin", "followers_url": "https://api.github.com/users/MudeLin/followers", "following_url": "https://api.github.com/users/MudeLin/following{/other_user}", "gists_url": "https://api.github.com/users/MudeLin/gists{/gist_id}", "starred_url": "https://api.github.com/users/MudeLin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MudeLin/subscriptions", "organizations_url": "https://api.github.com/users/MudeLin/orgs", "repos_url": "https://api.github.com/users/MudeLin/repos", "events_url": "https://api.github.com/users/MudeLin/events{/privacy}", "received_events_url": "https://api.github.com/users/MudeLin/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-13T13:09:06Z", "updated_at": "2017-03-13T13:09:06Z", "author_association": "NONE", "body_html": "<p>Hello, <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=20085789\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/satok16\">@satok16</a> , thanks for contributing the hexagon HVX code to tensorflow.</p>\n<p>I follow the tensorflow official quantization process, <a href=\"https://www.tensorflow.org/performance/quantization\" rel=\"nofollow\">https://www.tensorflow.org/performance/quantization</a>, to quantize the inception v3 model, however, it failed the test cases of hexagon graph execution, which is showed bellow. But it did pass the test cases if changed the model to <a href=\"https://storage.googleapis.com/download.tensorflow.org/models/tensorflow_inception_v3_stripped_optimized_quantized.pb\" rel=\"nofollow\">https://storage.googleapis.com/download.tensorflow.org/models/tensorflow_inception_v3_stripped_optimized_quantized.pb</a>.</p>\n<p>[ RUN      ] GraphTransferer.RunInceptionV3OnHexagonExampleWithHexagonWrapper<br>\nnative : hexagon_graph_execution_test.cc:450 Run inception v3 on hexagon with hexagon controller<br>\nnative : hexagon_graph_execution_test.cc:88 Hexagon controller version is 90<br>\ncan't determine number of CPU cores: assuming 4<br>\ncan't determine number of CPU cores: assuming 4<br>\ntensorflow/core/kernels/hexagon/hexagon_graph_execution_test.cc:466: Failure<br>\nValue of: status.ok()<br>\nActual: false<br>\nExpected: true<br>\nInvalid argument: No OpKernel was registered to support Op 'DecodeJpeg' with these attrs.  Registered devices: [CPU], Registered kernels:<br>\n</p>\n<pre><code> [[Node: DecodeJpeg = DecodeJpeg[acceptable_fraction=1, channels=3, dct_method=\"\", fancy_upscaling=true, ratio=1, try_recover_truncated=false](DecodeJpeg/contents)]]\n</code></pre>\n<p>[  FAILED  ] GraphTransferer.RunInceptionV3OnHexagonExampleWithHexagonWrapper (331 ms)<br>\n[ RUN      ] GraphTransferer.RunInceptionV3OnHexagonExampleWithTfRuntime<br>\nnative : hexagon_graph_execution_test.cc:531 Fuse and run inception v3 on hexagon with tf runtime<br>\nnative : hexagon_graph_execution_test.cc:88 Hexagon controller version is 90<br>\nnative : hexagon_graph_execution_test.cc:138 Read /data/local/tmp/img_299x299.bmp, size = 269156bytes<br>\nnative : hexagon_graph_execution_test.cc:144 header size = 54<br>\nnative : hexagon_graph_execution_test.cc:146 image size = 40<br>\nnative : hexagon_graph_execution_test.cc:148 width = 299<br>\nnative : hexagon_graph_execution_test.cc:150 height = -299<br>\nnative : hexagon_graph_execution_test.cc:543 Ioading image finished.<br>\nnative : hexagon_graph_execution_test.cc:550 Build fused graph<br>\nnative : graph_transfer_utils.cc:96 Check failed: status.ok()<br>\nAborted</p>\n<p>I wonder how to quantize my model so that it will meet your hexagon code. It seems tensorflow has updated the code to quantize the model.</p>", "body_text": "Hello, @satok16 , thanks for contributing the hexagon HVX code to tensorflow.\nI follow the tensorflow official quantization process, https://www.tensorflow.org/performance/quantization, to quantize the inception v3 model, however, it failed the test cases of hexagon graph execution, which is showed bellow. But it did pass the test cases if changed the model to https://storage.googleapis.com/download.tensorflow.org/models/tensorflow_inception_v3_stripped_optimized_quantized.pb.\n[ RUN      ] GraphTransferer.RunInceptionV3OnHexagonExampleWithHexagonWrapper\nnative : hexagon_graph_execution_test.cc:450 Run inception v3 on hexagon with hexagon controller\nnative : hexagon_graph_execution_test.cc:88 Hexagon controller version is 90\ncan't determine number of CPU cores: assuming 4\ncan't determine number of CPU cores: assuming 4\ntensorflow/core/kernels/hexagon/hexagon_graph_execution_test.cc:466: Failure\nValue of: status.ok()\nActual: false\nExpected: true\nInvalid argument: No OpKernel was registered to support Op 'DecodeJpeg' with these attrs.  Registered devices: [CPU], Registered kernels:\n\n [[Node: DecodeJpeg = DecodeJpeg[acceptable_fraction=1, channels=3, dct_method=\"\", fancy_upscaling=true, ratio=1, try_recover_truncated=false](DecodeJpeg/contents)]]\n\n[  FAILED  ] GraphTransferer.RunInceptionV3OnHexagonExampleWithHexagonWrapper (331 ms)\n[ RUN      ] GraphTransferer.RunInceptionV3OnHexagonExampleWithTfRuntime\nnative : hexagon_graph_execution_test.cc:531 Fuse and run inception v3 on hexagon with tf runtime\nnative : hexagon_graph_execution_test.cc:88 Hexagon controller version is 90\nnative : hexagon_graph_execution_test.cc:138 Read /data/local/tmp/img_299x299.bmp, size = 269156bytes\nnative : hexagon_graph_execution_test.cc:144 header size = 54\nnative : hexagon_graph_execution_test.cc:146 image size = 40\nnative : hexagon_graph_execution_test.cc:148 width = 299\nnative : hexagon_graph_execution_test.cc:150 height = -299\nnative : hexagon_graph_execution_test.cc:543 Ioading image finished.\nnative : hexagon_graph_execution_test.cc:550 Build fused graph\nnative : graph_transfer_utils.cc:96 Check failed: status.ok()\nAborted\nI wonder how to quantize my model so that it will meet your hexagon code. It seems tensorflow has updated the code to quantize the model.", "body": "Hello, @satok16 , thanks for contributing the hexagon HVX code to tensorflow.\r\n  \r\nI follow the tensorflow official quantization process, https://www.tensorflow.org/performance/quantization, to quantize the inception v3 model, however, it failed the test cases of hexagon graph execution, which is showed bellow. But it did pass the test cases if changed the model to https://storage.googleapis.com/download.tensorflow.org/models/tensorflow_inception_v3_stripped_optimized_quantized.pb.\r\n\r\n[ RUN      ] GraphTransferer.RunInceptionV3OnHexagonExampleWithHexagonWrapper\r\nnative : hexagon_graph_execution_test.cc:450 Run inception v3 on hexagon with hexagon controller\r\nnative : hexagon_graph_execution_test.cc:88 Hexagon controller version is 90\r\ncan't determine number of CPU cores: assuming 4\r\ncan't determine number of CPU cores: assuming 4\r\ntensorflow/core/kernels/hexagon/hexagon_graph_execution_test.cc:466: Failure\r\nValue of: status.ok()\r\n  Actual: false\r\nExpected: true\r\nInvalid argument: No OpKernel was registered to support Op 'DecodeJpeg' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[Node: DecodeJpeg = DecodeJpeg[acceptable_fraction=1, channels=3, dct_method=\"\", fancy_upscaling=true, ratio=1, try_recover_truncated=false](DecodeJpeg/contents)]]\r\n\r\n[  FAILED  ] GraphTransferer.RunInceptionV3OnHexagonExampleWithHexagonWrapper (331 ms)\r\n[ RUN      ] GraphTransferer.RunInceptionV3OnHexagonExampleWithTfRuntime\r\nnative : hexagon_graph_execution_test.cc:531 Fuse and run inception v3 on hexagon with tf runtime\r\nnative : hexagon_graph_execution_test.cc:88 Hexagon controller version is 90\r\nnative : hexagon_graph_execution_test.cc:138 Read /data/local/tmp/img_299x299.bmp, size = 269156bytes\r\nnative : hexagon_graph_execution_test.cc:144 header size = 54\r\nnative : hexagon_graph_execution_test.cc:146 image size = 40\r\nnative : hexagon_graph_execution_test.cc:148 width = 299\r\nnative : hexagon_graph_execution_test.cc:150 height = -299\r\nnative : hexagon_graph_execution_test.cc:543 Ioading image finished.\r\nnative : hexagon_graph_execution_test.cc:550 Build fused graph\r\nnative : graph_transfer_utils.cc:96 Check failed: status.ok() \r\nAborted \r\n\r\nI wonder how to quantize my model so that it will meet your hexagon code. It seems tensorflow has updated the code to quantize the model.\r\n"}