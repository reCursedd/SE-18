{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14155", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14155/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14155/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14155/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14155", "id": 270344680, "node_id": "MDU6SXNzdWUyNzAzNDQ2ODA=", "number": 14155, "title": "time to restore saved model increases over time ", "user": {"login": "abieler", "id": 7083141, "node_id": "MDQ6VXNlcjcwODMxNDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/7083141?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abieler", "html_url": "https://github.com/abieler", "followers_url": "https://api.github.com/users/abieler/followers", "following_url": "https://api.github.com/users/abieler/following{/other_user}", "gists_url": "https://api.github.com/users/abieler/gists{/gist_id}", "starred_url": "https://api.github.com/users/abieler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abieler/subscriptions", "organizations_url": "https://api.github.com/users/abieler/orgs", "repos_url": "https://api.github.com/users/abieler/repos", "events_url": "https://api.github.com/users/abieler/events{/privacy}", "received_events_url": "https://api.github.com/users/abieler/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-11-01T15:22:41Z", "updated_at": "2017-11-01T19:04:35Z", "closed_at": "2017-11-01T17:23:14Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>Manjaro Linux</li>\n<li>TensorFlow installed with pip:</li>\n<li>TensorFlow version: v1.3.0-rc2-20-g0787eee 1.3.0:</li>\n<li>Python version: 3.6.2</li>\n<li>CUDA/cuDNN version: 8.0.61-3 / 7.0.3-1</li>\n<li>GPU model and memory: GeForce GTX 1080 (8 GB)</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Executing the code below in a loop slows down linearly with<br>\nnumber of iteration as can be seen in the figures below.<br>\n(The use case being a long running app where different models<br>\nare loaded (multiple times) depending on user inputs)</p>\n<div class=\"highlight highlight-source-python\"><pre>gpu_options <span class=\"pl-k\">=</span> tf.GPUOptions(<span class=\"pl-v\">per_process_gpu_memory_fraction</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0.25</span>)\nconfig <span class=\"pl-k\">=</span> tf.ConfigProto(<span class=\"pl-v\">gpu_options</span><span class=\"pl-k\">=</span>gpu_options)\n\n<span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>config) <span class=\"pl-k\">as</span> sess:\n    saver <span class=\"pl-k\">=</span> tf.train.import_meta_graph(modelname)\n    saver.restore(sess, tf.train.latest_checkpoint(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>./<span class=\"pl-pds\">\"</span></span>))</pre></div>\n<h3>Source code / logs</h3>\n<p>Reproducible code and plots of the time increase can be found here:<br>\n<a href=\"url\">https://www.dropbox.com/s/rgbqp9z3m5vnr9d/test.zip?dl=1</a></p>\n<p>To reproduce do the following from withing the extracted zip archive:</p>\n<pre><code>python train_model.py\npython test_a.py\n</code></pre>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/7083141/32281142-4b2c3eec-bf1e-11e7-85f0-5da5af5e4135.png\"><img src=\"https://user-images.githubusercontent.com/7083141/32281142-4b2c3eec-bf1e-11e7-85f0-5da5af5e4135.png\" alt=\"import_metagraph\" style=\"max-width:100%;\"></a></p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/7083141/32281147-4f1244d4-bf1e-11e7-8126-28eb01df3c8a.png\"><img src=\"https://user-images.githubusercontent.com/7083141/32281147-4f1244d4-bf1e-11e7-8126-28eb01df3c8a.png\" alt=\"saver_restore\" style=\"max-width:100%;\"></a></p>", "body_text": "System information\n\nManjaro Linux\nTensorFlow installed with pip:\nTensorFlow version: v1.3.0-rc2-20-g0787eee 1.3.0:\nPython version: 3.6.2\nCUDA/cuDNN version: 8.0.61-3 / 7.0.3-1\nGPU model and memory: GeForce GTX 1080 (8 GB)\n\nDescribe the problem\nExecuting the code below in a loop slows down linearly with\nnumber of iteration as can be seen in the figures below.\n(The use case being a long running app where different models\nare loaded (multiple times) depending on user inputs)\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.25)\nconfig = tf.ConfigProto(gpu_options=gpu_options)\n\nwith tf.Session(config=config) as sess:\n    saver = tf.train.import_meta_graph(modelname)\n    saver.restore(sess, tf.train.latest_checkpoint(\"./\"))\nSource code / logs\nReproducible code and plots of the time increase can be found here:\nhttps://www.dropbox.com/s/rgbqp9z3m5vnr9d/test.zip?dl=1\nTo reproduce do the following from withing the extracted zip archive:\npython train_model.py\npython test_a.py", "body": "### System information\r\n- Manjaro Linux\r\n- TensorFlow installed with pip:\r\n- TensorFlow version: v1.3.0-rc2-20-g0787eee 1.3.0:\r\n- Python version: 3.6.2 \r\n- CUDA/cuDNN version: 8.0.61-3 / 7.0.3-1\r\n- GPU model and memory: GeForce GTX 1080 (8 GB)\r\n\r\n\r\n### Describe the problem\r\nExecuting the code below in a loop slows down linearly with\r\nnumber of iteration as can be seen in the figures below.\r\n(The use case being a long running app where different models\r\nare loaded (multiple times) depending on user inputs) \r\n\r\n```python\r\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.25)\r\nconfig = tf.ConfigProto(gpu_options=gpu_options)\r\n\r\nwith tf.Session(config=config) as sess:\r\n    saver = tf.train.import_meta_graph(modelname)\r\n    saver.restore(sess, tf.train.latest_checkpoint(\"./\"))\r\n```\r\n\r\n### Source code / logs\r\nReproducible code and plots of the time increase can be found here:\r\n[https://www.dropbox.com/s/rgbqp9z3m5vnr9d/test.zip?dl=1](url)\r\n\r\nTo reproduce do the following from withing the extracted zip archive:\r\n```\r\npython train_model.py\r\npython test_a.py\r\n```\r\n\r\n![import_metagraph](https://user-images.githubusercontent.com/7083141/32281142-4b2c3eec-bf1e-11e7-85f0-5da5af5e4135.png)\r\n\r\n![saver_restore](https://user-images.githubusercontent.com/7083141/32281147-4f1244d4-bf1e-11e7-8126-28eb01df3c8a.png)"}