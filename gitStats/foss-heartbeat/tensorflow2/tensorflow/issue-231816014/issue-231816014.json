{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10253", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10253/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10253/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10253/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10253", "id": 231816014, "node_id": "MDU6SXNzdWUyMzE4MTYwMTQ=", "number": 10253, "title": "label_keys type error on DNNCLassifier Tensorflow", "user": {"login": "atimofte29", "id": 16147454, "node_id": "MDQ6VXNlcjE2MTQ3NDU0", "avatar_url": "https://avatars3.githubusercontent.com/u/16147454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/atimofte29", "html_url": "https://github.com/atimofte29", "followers_url": "https://api.github.com/users/atimofte29/followers", "following_url": "https://api.github.com/users/atimofte29/following{/other_user}", "gists_url": "https://api.github.com/users/atimofte29/gists{/gist_id}", "starred_url": "https://api.github.com/users/atimofte29/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/atimofte29/subscriptions", "organizations_url": "https://api.github.com/users/atimofte29/orgs", "repos_url": "https://api.github.com/users/atimofte29/repos", "events_url": "https://api.github.com/users/atimofte29/events{/privacy}", "received_events_url": "https://api.github.com/users/atimofte29/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-05-27T17:24:44Z", "updated_at": "2017-05-28T10:03:52Z", "closed_at": "2017-05-28T00:00:36Z", "author_association": "NONE", "body_html": "<p>I got the following error when I tried to embed an array of label_keys of type string into a DNNClassifier. At the first attempt I folowed the official documentation for instantiating a DNNClassifier.</p>\n<p><code>Traceback (most recent call last): File \"embedding_model_probe.py\", line 118, in &lt;module&gt; m.fit(input_fn=train_input_fn, steps=200) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 281, in new_func return func(*args, **kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 430, in fit loss = self._train_model(input_fn=input_fn, hooks=hooks) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 927, in _train_model model_fn_ops = self._get_train_ops(features, labels) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1132, in _get_train_ops return self._call_model_fn(features, labels, model_fn_lib.ModeKeys.TRAIN) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1103, in _call_model_fn model_fn_results = self._model_fn(features, labels, **kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn.py\", line 180, in _dnn_model_fn logits=logits) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 1004, in create_model_fn_ops labels = self._transform_labels(mode=mode, labels=labels) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 1033, in _transform_labels \"label_ids\": table.lookup(labels_tensor), File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/lookup/lookup_ops.py\", line 179, in lookup (self._key_dtype, keys.dtype)) TypeError: Signature mismatch. Keys must be dtype &lt;dtype: 'string'&gt;, got &lt;dtype: 'int64'&gt;. </code></p>\n<p>Here is the \"guilty\" piece of my code:</p>\n<p><code> label_keys_values = [\"satan\", \"ipsweep\", \"nmap\", \"portsweep\"]   </code><br>\n<code>  m = tf.contrib.learn.DNNClassifier(model_dir=model_dir, feature_columns=deep_columns, n_classes=4, hidden_units=[12, 4], label_keys=label_keys_values)</code><br>\n<code>  m.fit(input_fn=train_input_fn, steps=200)</code></p>\n<p>On the other hand, if I make the <code>label_key_values</code> column a <code>numpy.array</code><br>\n<code>label_keys_values = np.array([\"satan\", \"ipsweep\", \"nmap\", \"portsweep\"], dtype='string')</code></p>\n<p>I will get the following error:</p>\n<p><code>Traceback (most recent call last): File \"embedding_model_probe.py\", line 116, in label_keys=label_keys_values) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn.py\", line 337, in init label_keys=label_keys), File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 331, in multi_class_head label_keys=label_keys) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 986, in init if label_keys and len(label_keys) != n_classes: ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></p>", "body_text": "I got the following error when I tried to embed an array of label_keys of type string into a DNNClassifier. At the first attempt I folowed the official documentation for instantiating a DNNClassifier.\nTraceback (most recent call last): File \"embedding_model_probe.py\", line 118, in <module> m.fit(input_fn=train_input_fn, steps=200) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 281, in new_func return func(*args, **kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 430, in fit loss = self._train_model(input_fn=input_fn, hooks=hooks) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 927, in _train_model model_fn_ops = self._get_train_ops(features, labels) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1132, in _get_train_ops return self._call_model_fn(features, labels, model_fn_lib.ModeKeys.TRAIN) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1103, in _call_model_fn model_fn_results = self._model_fn(features, labels, **kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn.py\", line 180, in _dnn_model_fn logits=logits) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 1004, in create_model_fn_ops labels = self._transform_labels(mode=mode, labels=labels) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 1033, in _transform_labels \"label_ids\": table.lookup(labels_tensor), File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/lookup/lookup_ops.py\", line 179, in lookup (self._key_dtype, keys.dtype)) TypeError: Signature mismatch. Keys must be dtype <dtype: 'string'>, got <dtype: 'int64'>. \nHere is the \"guilty\" piece of my code:\n label_keys_values = [\"satan\", \"ipsweep\", \"nmap\", \"portsweep\"]   \n  m = tf.contrib.learn.DNNClassifier(model_dir=model_dir, feature_columns=deep_columns, n_classes=4, hidden_units=[12, 4], label_keys=label_keys_values)\n  m.fit(input_fn=train_input_fn, steps=200)\nOn the other hand, if I make the label_key_values column a numpy.array\nlabel_keys_values = np.array([\"satan\", \"ipsweep\", \"nmap\", \"portsweep\"], dtype='string')\nI will get the following error:\nTraceback (most recent call last): File \"embedding_model_probe.py\", line 116, in label_keys=label_keys_values) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn.py\", line 337, in init label_keys=label_keys), File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 331, in multi_class_head label_keys=label_keys) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 986, in init if label_keys and len(label_keys) != n_classes: ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()", "body": "I got the following error when I tried to embed an array of label_keys of type string into a DNNClassifier. At the first attempt I folowed the official documentation for instantiating a DNNClassifier.\r\n\r\n`Traceback (most recent call last):\r\n  File \"embedding_model_probe.py\", line 118, in <module>\r\n    m.fit(input_fn=train_input_fn, steps=200)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 281, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 430, in fit\r\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 927, in _train_model\r\n    model_fn_ops = self._get_train_ops(features, labels)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1132, in _get_train_ops\r\n    return self._call_model_fn(features, labels, model_fn_lib.ModeKeys.TRAIN)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1103, in _call_model_fn\r\n    model_fn_results = self._model_fn(features, labels, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn.py\", line 180, in _dnn_model_fn\r\n    logits=logits)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 1004, in create_model_fn_ops\r\n    labels = self._transform_labels(mode=mode, labels=labels)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 1033, in _transform_labels\r\n    \"label_ids\": table.lookup(labels_tensor),\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/lookup/lookup_ops.py\", line 179, in lookup\r\n    (self._key_dtype, keys.dtype))\r\nTypeError: Signature mismatch. Keys must be dtype <dtype: 'string'>, got <dtype: 'int64'>.\r\n`\r\n\r\nHere is the \"guilty\" piece of my code:\r\n\r\n`  label_keys_values = [\"satan\", \"ipsweep\", \"nmap\", \"portsweep\"]    `\r\n`  m = tf.contrib.learn.DNNClassifier(model_dir=model_dir,\r\n\t                    feature_columns=deep_columns,\r\n\t                    n_classes=4,\r\n\t                   hidden_units=[12, 4],\r\n\t                   label_keys=label_keys_values)`\r\n`  m.fit(input_fn=train_input_fn, steps=200)`\r\n\r\nOn the other hand, if I make the `label_key_values` column a `numpy.array`\r\n`label_keys_values = np.array([\"satan\", \"ipsweep\", \"nmap\", \"portsweep\"], dtype='string')`\r\n\r\nI will get the following error:\r\n\r\n`Traceback (most recent call last): File \"embedding_model_probe.py\", line 116, in label_keys=label_keys_values) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn.py\", line 337, in init label_keys=label_keys), File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 331, in multi_class_head label_keys=label_keys) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/head.py\", line 986, in init if label_keys and len(label_keys) != n_classes: ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()`\r\n\r\n\r\n"}