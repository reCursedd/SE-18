{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/146067773", "pull_request_review_id": 70967293, "id": 146067773, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0NjA2Nzc3Mw==", "diff_hunk": "@@ -1050,22 +1050,44 @@ Status ReductionShape(InferenceContext* c) {\n   }\n \n   const int32 input_rank = c->Rank(input);\n-  std::set<int32> true_indices;\n-  auto reduction_indices = reduction_indices_t->flat<int32>();\n-  for (int i = 0; i < reduction_indices_t->NumElements(); ++i) {\n-    int32 reduction_index = reduction_indices(i);\n-    if (reduction_index < -input_rank || reduction_index >= input_rank) {\n-      return errors::InvalidArgument(\"Invalid reduction dimension \",\n-                                     reduction_index, \" for input with \",\n-                                     input_rank, \" dimensions.\");\n-    }\n+  std::set<int64> true_indices;\n+  if (reduction_indices_t->dtype() == DataType::DT_INT32) {\n+    auto reduction_indices = reduction_indices_t->flat<int32>();", "path": "tensorflow/core/framework/common_shape_fns.cc", "position": null, "original_position": 15, "commit_id": "0680aa821990e6a27a7911247a6d8f575a680e11", "original_commit_id": "bd6a03fa8768902fa8fb0539e5a676dfbbdc3452", "user": {"login": "vrv", "id": 463737, "node_id": "MDQ6VXNlcjQ2MzczNw==", "avatar_url": "https://avatars0.githubusercontent.com/u/463737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vrv", "html_url": "https://github.com/vrv", "followers_url": "https://api.github.com/users/vrv/followers", "following_url": "https://api.github.com/users/vrv/following{/other_user}", "gists_url": "https://api.github.com/users/vrv/gists{/gist_id}", "starred_url": "https://api.github.com/users/vrv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vrv/subscriptions", "organizations_url": "https://api.github.com/users/vrv/orgs", "repos_url": "https://api.github.com/users/vrv/repos", "events_url": "https://api.github.com/users/vrv/events{/privacy}", "received_events_url": "https://api.github.com/users/vrv/received_events", "type": "User", "site_admin": false}, "body": "Can we pull this out into a little helper function templated on the index type and call it like:\r\n\r\nif (...type == DT_INT32) {\r\n  helper_function<int32>(...);\r\n} else if (...type == DT_INT64) {\r\n  helper_function<int64>(...);\r\n} else {\r\n  invalid...\r\n}", "created_at": "2017-10-20T21:12:19Z", "updated_at": "2017-10-20T21:36:14Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/13863#discussion_r146067773", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13863", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/146067773"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/13863#discussion_r146067773"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13863"}}, "body_html": "<p>Can we pull this out into a little helper function templated on the index type and call it like:</p>\n<p>if (...type == DT_INT32) {<br>\nhelper_function(...);<br>\n} else if (...type == DT_INT64) {<br>\nhelper_function(...);<br>\n} else {<br>\ninvalid...<br>\n}</p>", "body_text": "Can we pull this out into a little helper function templated on the index type and call it like:\nif (...type == DT_INT32) {\nhelper_function(...);\n} else if (...type == DT_INT64) {\nhelper_function(...);\n} else {\ninvalid...\n}"}