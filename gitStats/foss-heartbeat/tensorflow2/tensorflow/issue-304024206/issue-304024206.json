{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17607", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17607/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17607/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17607/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/17607", "id": 304024206, "node_id": "MDExOlB1bGxSZXF1ZXN0MTc0MTQxODk2", "number": 17607, "title": "Fix inconsistency of eq for TensorShape", "user": {"login": "yongtang", "id": 6932348, "node_id": "MDQ6VXNlcjY5MzIzNDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6932348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongtang", "html_url": "https://github.com/yongtang", "followers_url": "https://api.github.com/users/yongtang/followers", "following_url": "https://api.github.com/users/yongtang/following{/other_user}", "gists_url": "https://api.github.com/users/yongtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongtang/subscriptions", "organizations_url": "https://api.github.com/users/yongtang/orgs", "repos_url": "https://api.github.com/users/yongtang/repos", "events_url": "https://api.github.com/users/yongtang/events{/privacy}", "received_events_url": "https://api.github.com/users/yongtang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "fef2c0", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2018-03-10T00:48:52Z", "updated_at": "2018-08-23T15:04:21Z", "closed_at": "2018-08-23T15:03:57Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17607", "html_url": "https://github.com/tensorflow/tensorflow/pull/17607", "diff_url": "https://github.com/tensorflow/tensorflow/pull/17607.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/17607.patch"}, "body_html": "<p>This fix tries to address the inconsistency of eq for TensorShape.</p>\n<p>For TensorShape, the dimension of Dimension(None) should be considered not equal to Dimension(None). However, if the same Dimension(None) is reused, the behavior changes. For example,</p>\n<pre><code>$ python\nPython 2.7.12 (default, Dec  4 2017, 14:50:18)\n[GCC 5.4.0 20160609] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import tensorflow as tf\n&gt;&gt;&gt; tf.TensorShape([None]) == tf.TensorShape([None])\nFalse\n&gt;&gt;&gt; tf.TensorShape([tf.Dimension(None)]) == tf.TensorShape([tf.Dimension(None)])\nFalse\n&gt;&gt;&gt; dim = tf.Dimension(None)\n&gt;&gt;&gt; tf.TensorShape([dim]) == tf.TensorShape([dim])\nTrue\n&gt;&gt;&gt;\n</code></pre>\n<p>The issue was that when dims is passed to the constructor of TensorShape through <code>as_dimension</code>, the dimension is directly assigned. This fix changes the implementaion of <code>as_dimension</code> so that a copy is always performs. In this way, Dimensions in TensorShape will always have the differnet id so an <code>__eq__</code> op will always be performed.</p>\n<p>This fix <span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #17593.\">fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"303893595\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/17593\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/17593/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/17593\">#17593</a>.</p>\n<p>Signed-off-by: Yong Tang <a href=\"mailto:yong.tang.github@outlook.com\">yong.tang.github@outlook.com</a></p>", "body_text": "This fix tries to address the inconsistency of eq for TensorShape.\nFor TensorShape, the dimension of Dimension(None) should be considered not equal to Dimension(None). However, if the same Dimension(None) is reused, the behavior changes. For example,\n$ python\nPython 2.7.12 (default, Dec  4 2017, 14:50:18)\n[GCC 5.4.0 20160609] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import tensorflow as tf\n>>> tf.TensorShape([None]) == tf.TensorShape([None])\nFalse\n>>> tf.TensorShape([tf.Dimension(None)]) == tf.TensorShape([tf.Dimension(None)])\nFalse\n>>> dim = tf.Dimension(None)\n>>> tf.TensorShape([dim]) == tf.TensorShape([dim])\nTrue\n>>>\n\nThe issue was that when dims is passed to the constructor of TensorShape through as_dimension, the dimension is directly assigned. This fix changes the implementaion of as_dimension so that a copy is always performs. In this way, Dimensions in TensorShape will always have the differnet id so an __eq__ op will always be performed.\nThis fix fixes #17593.\nSigned-off-by: Yong Tang yong.tang.github@outlook.com", "body": "\r\nThis fix tries to address the inconsistency of eq for TensorShape.\r\n\r\nFor TensorShape, the dimension of Dimension(None) should be considered not equal to Dimension(None). However, if the same Dimension(None) is reused, the behavior changes. For example,\r\n```\r\n$ python\r\nPython 2.7.12 (default, Dec  4 2017, 14:50:18)\r\n[GCC 5.4.0 20160609] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import tensorflow as tf\r\n>>> tf.TensorShape([None]) == tf.TensorShape([None])\r\nFalse\r\n>>> tf.TensorShape([tf.Dimension(None)]) == tf.TensorShape([tf.Dimension(None)])\r\nFalse\r\n>>> dim = tf.Dimension(None)\r\n>>> tf.TensorShape([dim]) == tf.TensorShape([dim])\r\nTrue\r\n>>>\r\n```\r\n\r\nThe issue was that when dims is passed to the constructor of TensorShape through `as_dimension`, the dimension is directly assigned. This fix changes the implementaion of `as_dimension` so that a copy is always performs. In this way, Dimensions in TensorShape will always have the differnet id so an `__eq__` op will always be performed.\r\n\r\nThis fix fixes #17593.\r\n\r\nSigned-off-by: Yong Tang <yong.tang.github@outlook.com>"}