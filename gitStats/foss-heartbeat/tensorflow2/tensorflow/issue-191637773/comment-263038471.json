{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/263038471", "html_url": "https://github.com/tensorflow/tensorflow/issues/5847#issuecomment-263038471", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5847", "id": 263038471, "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzAzODQ3MQ==", "user": {"login": "kkjh0723", "id": 10104262, "node_id": "MDQ6VXNlcjEwMTA0MjYy", "avatar_url": "https://avatars3.githubusercontent.com/u/10104262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkjh0723", "html_url": "https://github.com/kkjh0723", "followers_url": "https://api.github.com/users/kkjh0723/followers", "following_url": "https://api.github.com/users/kkjh0723/following{/other_user}", "gists_url": "https://api.github.com/users/kkjh0723/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkjh0723/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkjh0723/subscriptions", "organizations_url": "https://api.github.com/users/kkjh0723/orgs", "repos_url": "https://api.github.com/users/kkjh0723/repos", "events_url": "https://api.github.com/users/kkjh0723/events{/privacy}", "received_events_url": "https://api.github.com/users/kkjh0723/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-26T01:55:38Z", "updated_at": "2016-11-26T01:55:38Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=11547801\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/prb12\">@prb12</a> I changed the code as below as you suggested,</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\n\nconfig = tf.ConfigProto(log_device_placement=True)\n\nwith tf.device('/gpu:0'):\n    embd_mat = np.linspace(1,10,10).reshape([10,1])*np.array([1,2,3]).reshape([1,3])\n    idx = np.linspace(0,19,20)\n    \n    embd_in = tf.placeholder(tf.float32,[10,3])\n    idx_in = tf.placeholder(tf.int32,[20])\n\n    output = tf.nn.embedding_lookup(embd_in,idx_in)\n\nwith tf.Session(config=config) as sess:\n    sess.run(tf.initialize_all_variables())\n\n    embd_out = sess.run(output,feed_dict={embd_in:embd_mat, idx_in:idx})\n\n    print embd_out \n</code></pre>\n<p>and the output is,</p>\n<pre><code>init: (NoOp): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] init: (NoOp)/job:localhost/replica:0/task:0/gpu:0\nembedding_lookup: (Gather): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] embedding_lookup: (Gather)/job:localhost/replica:0/task:0/gpu:0\nPlaceholder_1: (Placeholder): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] Placeholder_1: (Placeholder)/job:localhost/replica:0/task:0/gpu:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/gpu:0\n[[  1.   2.   3.]\n [  2.   4.   6.]\n [  3.   6.   9.]\n [  4.   8.  12.]\n [  5.  10.  15.]\n [  6.  12.  18.]\n [  7.  14.  21.]\n [  8.  16.  24.]\n [  9.  18.  27.]\n [ 10.  20.  30.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]]\n</code></pre>", "body_text": "@prb12 I changed the code as below as you suggested,\nimport tensorflow as tf\nimport numpy as np\n\nconfig = tf.ConfigProto(log_device_placement=True)\n\nwith tf.device('/gpu:0'):\n    embd_mat = np.linspace(1,10,10).reshape([10,1])*np.array([1,2,3]).reshape([1,3])\n    idx = np.linspace(0,19,20)\n    \n    embd_in = tf.placeholder(tf.float32,[10,3])\n    idx_in = tf.placeholder(tf.int32,[20])\n\n    output = tf.nn.embedding_lookup(embd_in,idx_in)\n\nwith tf.Session(config=config) as sess:\n    sess.run(tf.initialize_all_variables())\n\n    embd_out = sess.run(output,feed_dict={embd_in:embd_mat, idx_in:idx})\n\n    print embd_out \n\nand the output is,\ninit: (NoOp): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] init: (NoOp)/job:localhost/replica:0/task:0/gpu:0\nembedding_lookup: (Gather): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] embedding_lookup: (Gather)/job:localhost/replica:0/task:0/gpu:0\nPlaceholder_1: (Placeholder): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] Placeholder_1: (Placeholder)/job:localhost/replica:0/task:0/gpu:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/gpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:827] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/gpu:0\n[[  1.   2.   3.]\n [  2.   4.   6.]\n [  3.   6.   9.]\n [  4.   8.  12.]\n [  5.  10.  15.]\n [  6.  12.  18.]\n [  7.  14.  21.]\n [  8.  16.  24.]\n [  9.  18.  27.]\n [ 10.  20.  30.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]\n [  0.   0.   0.]]", "body": "@prb12 I changed the code as below as you suggested,\r\n\r\n    import tensorflow as tf\r\n    import numpy as np\r\n    \r\n    config = tf.ConfigProto(log_device_placement=True)\r\n    \r\n    with tf.device('/gpu:0'):\r\n        embd_mat = np.linspace(1,10,10).reshape([10,1])*np.array([1,2,3]).reshape([1,3])\r\n        idx = np.linspace(0,19,20)\r\n        \r\n        embd_in = tf.placeholder(tf.float32,[10,3])\r\n        idx_in = tf.placeholder(tf.int32,[20])\r\n    \r\n        output = tf.nn.embedding_lookup(embd_in,idx_in)\r\n    \r\n    with tf.Session(config=config) as sess:\r\n        sess.run(tf.initialize_all_variables())\r\n    \r\n        embd_out = sess.run(output,feed_dict={embd_in:embd_mat, idx_in:idx})\r\n    \r\n        print embd_out \r\n\r\nand the output is,\r\n\r\n    init: (NoOp): /job:localhost/replica:0/task:0/gpu:0\r\n    I tensorflow/core/common_runtime/simple_placer.cc:827] init: (NoOp)/job:localhost/replica:0/task:0/gpu:0\r\n    embedding_lookup: (Gather): /job:localhost/replica:0/task:0/gpu:0\r\n    I tensorflow/core/common_runtime/simple_placer.cc:827] embedding_lookup: (Gather)/job:localhost/replica:0/task:0/gpu:0\r\n    Placeholder_1: (Placeholder): /job:localhost/replica:0/task:0/gpu:0\r\n    I tensorflow/core/common_runtime/simple_placer.cc:827] Placeholder_1: (Placeholder)/job:localhost/replica:0/task:0/gpu:0\r\n    Placeholder: (Placeholder): /job:localhost/replica:0/task:0/gpu:0\r\n    I tensorflow/core/common_runtime/simple_placer.cc:827] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/gpu:0\r\n    [[  1.   2.   3.]\r\n     [  2.   4.   6.]\r\n     [  3.   6.   9.]\r\n     [  4.   8.  12.]\r\n     [  5.  10.  15.]\r\n     [  6.  12.  18.]\r\n     [  7.  14.  21.]\r\n     [  8.  16.  24.]\r\n     [  9.  18.  27.]\r\n     [ 10.  20.  30.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]\r\n     [  0.   0.   0.]]\r\n    "}