{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20823", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20823/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20823/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20823/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20823", "id": 341368634, "node_id": "MDU6SXNzdWUzNDEzNjg2MzQ=", "number": 20823, "title": "Grappler warning and segfault", "user": {"login": "megagosha", "id": 26932173, "node_id": "MDQ6VXNlcjI2OTMyMTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/26932173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/megagosha", "html_url": "https://github.com/megagosha", "followers_url": "https://api.github.com/users/megagosha/followers", "following_url": "https://api.github.com/users/megagosha/following{/other_user}", "gists_url": "https://api.github.com/users/megagosha/gists{/gist_id}", "starred_url": "https://api.github.com/users/megagosha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/megagosha/subscriptions", "organizations_url": "https://api.github.com/users/megagosha/orgs", "repos_url": "https://api.github.com/users/megagosha/repos", "events_url": "https://api.github.com/users/megagosha/events{/privacy}", "received_events_url": "https://api.github.com/users/megagosha/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-07-16T01:19:35Z", "updated_at": "2018-07-31T14:15:18Z", "closed_at": "2018-07-31T14:15:17Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code</strong>: I used this TensorFlow <a href=\"https://gist.github.com/Willian-Zhang/a3bd10da2d8b343875f3862b2a62eb3b\">patch</a>.</li>\n<li><strong>OS Platform and Distribution</strong>: macOS 10.13.6 and 10.13.5 before</li>\n<li><strong>TensorFlow installed from</strong>: Source</li>\n<li><strong>TensorFlow version</strong>: ('v1.8.0-0-g93bc2e2072', '1.8.0')</li>\n<li><strong>Python</strong>: 2.7</li>\n<li><strong>Bazel version</strong>: 0.13.1</li>\n<li><strong>GCC/Compiler</strong>: from Xcode 9.2</li>\n<li><strong>CUDA/cuDNN</strong>: 9.1/7.0.5</li>\n<li><strong>GPU model and memory</strong>: NVIDIA 1080 8.00GiB</li>\n<li><strong>Exact command to reproduce</strong>: Cifar 10 training from examples</li>\n</ul>\n<p>Hardware:<br>\nMacBook Pro 13,3 eGPU 1080<br>\nNVIDIA Web Driver 387.10.10.10.40.105<br>\nCUDA Driver 396.148<br>\nCUDA 9.1 Toolkit<br>\ncuDNN 7.0.5<br>\nPython 2.7<br>\nNCCL 2.1.15<br>\nXcode 9.2</p>\n<p>import tensorflow as tf<br>\ntf.test.is_gpu_available():<br>\n<code>tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:859] OS X does not support NUMA - returning NUMA node zero tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:  name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7335 pciBusID: 0000:46:00.0 totalMemory: 8.00GiB freeMemory: 2.32GiB tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0 tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix: tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0  tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N  tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:0 with 2025 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:46:00.0, compute capability: 6.1) True</code></p>\n<p>When I try to run something I get this error messages with segfault in the end:</p>\n<p><code>Filling queue with 20000 CIFAR images before starting to train. This will take a few minutes. tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:859] OS X does not support NUMA - returning NUMA node zero tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:  name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7335 pciBusID: 0000:46:00.0 totalMemory: 8.00GiB freeMemory: 3.39GiB tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0 tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix: tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0  tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N  tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3118 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:46:00.0, compute capability: 6.1) E tensorflow/core/grappler/clusters/utils.cc:127] Not found: TF GPU device with id 0 was not registered Segmentation fault: 11</code></p>\n<p>In other program I tried to reduce per_process_gpu_memory_fraction and batch size so it crashed after first batch with the same error code. I have seen people encounter same grappler warning without segfault.</p>\n<p>Any idea how to resolve this? Any help appreciated!! Thank you!</p>", "body_text": "System information\n\nHave I written custom code: I used this TensorFlow patch.\nOS Platform and Distribution: macOS 10.13.6 and 10.13.5 before\nTensorFlow installed from: Source\nTensorFlow version: ('v1.8.0-0-g93bc2e2072', '1.8.0')\nPython: 2.7\nBazel version: 0.13.1\nGCC/Compiler: from Xcode 9.2\nCUDA/cuDNN: 9.1/7.0.5\nGPU model and memory: NVIDIA 1080 8.00GiB\nExact command to reproduce: Cifar 10 training from examples\n\nHardware:\nMacBook Pro 13,3 eGPU 1080\nNVIDIA Web Driver 387.10.10.10.40.105\nCUDA Driver 396.148\nCUDA 9.1 Toolkit\ncuDNN 7.0.5\nPython 2.7\nNCCL 2.1.15\nXcode 9.2\nimport tensorflow as tf\ntf.test.is_gpu_available():\ntensorflow/stream_executor/cuda/cuda_gpu_executor.cc:859] OS X does not support NUMA - returning NUMA node zero tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:  name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7335 pciBusID: 0000:46:00.0 totalMemory: 8.00GiB freeMemory: 2.32GiB tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0 tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix: tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0  tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N  tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:0 with 2025 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:46:00.0, compute capability: 6.1) True\nWhen I try to run something I get this error messages with segfault in the end:\nFilling queue with 20000 CIFAR images before starting to train. This will take a few minutes. tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:859] OS X does not support NUMA - returning NUMA node zero tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:  name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7335 pciBusID: 0000:46:00.0 totalMemory: 8.00GiB freeMemory: 3.39GiB tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0 tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix: tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0  tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N  tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3118 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:46:00.0, compute capability: 6.1) E tensorflow/core/grappler/clusters/utils.cc:127] Not found: TF GPU device with id 0 was not registered Segmentation fault: 11\nIn other program I tried to reduce per_process_gpu_memory_fraction and batch size so it crashed after first batch with the same error code. I have seen people encounter same grappler warning without segfault.\nAny idea how to resolve this? Any help appreciated!! Thank you!", "body": "### System information\r\n- **Have I written custom code**: I used this TensorFlow [patch](https://gist.github.com/Willian-Zhang/a3bd10da2d8b343875f3862b2a62eb3b).\r\n- **OS Platform and Distribution**: macOS 10.13.6 and 10.13.5 before\r\n- **TensorFlow installed from**: Source\r\n- **TensorFlow version**: ('v1.8.0-0-g93bc2e2072', '1.8.0')\r\n- **Python**: 2.7\r\n- **Bazel version**: 0.13.1\r\n- **GCC/Compiler**: from Xcode 9.2\r\n- **CUDA/cuDNN**: 9.1/7.0.5\r\n- **GPU model and memory**: NVIDIA 1080 8.00GiB\r\n- **Exact command to reproduce**: Cifar 10 training from examples\r\n\r\n\r\nHardware: \r\nMacBook Pro 13,3 eGPU 1080\r\nNVIDIA Web Driver 387.10.10.10.40.105 \r\nCUDA Driver 396.148 \r\nCUDA 9.1 Toolkit \r\ncuDNN 7.0.5 \r\nPython 2.7 \r\nNCCL 2.1.15 \r\nXcode 9.2\r\n\r\nimport tensorflow as tf\r\ntf.test.is_gpu_available():\r\n`tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:859] OS X does not support NUMA - returning NUMA node zero\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: \r\nname: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7335\r\npciBusID: 0000:46:00.0\r\ntotalMemory: 8.00GiB freeMemory: 2.32GiB\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 \r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N \r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:0 with 2025 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:46:00.0, compute capability: 6.1)\r\nTrue`\r\n\r\nWhen I try to run something I get this error messages with segfault in the end:\r\n\r\n`Filling queue with 20000 CIFAR images before starting to train. This will take a few minutes.\r\ntensorflow/stream_executor/cuda/cuda_gpu_executor.cc:859] OS X does not support NUMA - returning NUMA node zero\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: \r\nname: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7335\r\npciBusID: 0000:46:00.0\r\ntotalMemory: 8.00GiB freeMemory: 3.39GiB\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 \r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N \r\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3118 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:46:00.0, compute capability: 6.1)\r\nE tensorflow/core/grappler/clusters/utils.cc:127] Not found: TF GPU device with id 0 was not registered\r\nSegmentation fault: 11`\r\n\r\nIn other program I tried to reduce per_process_gpu_memory_fraction and batch size so it crashed after first batch with the same error code. I have seen people encounter same grappler warning without segfault. \r\n\r\nAny idea how to resolve this? Any help appreciated!! Thank you!"}