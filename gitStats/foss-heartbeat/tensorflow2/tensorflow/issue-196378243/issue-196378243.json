{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6396", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6396/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6396/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6396/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6396", "id": 196378243, "node_id": "MDU6SXNzdWUxOTYzNzgyNDM=", "number": 6396, "title": "Cmake static library build issue", "user": {"login": "shakith", "id": 2685014, "node_id": "MDQ6VXNlcjI2ODUwMTQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2685014?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shakith", "html_url": "https://github.com/shakith", "followers_url": "https://api.github.com/users/shakith/followers", "following_url": "https://api.github.com/users/shakith/following{/other_user}", "gists_url": "https://api.github.com/users/shakith/gists{/gist_id}", "starred_url": "https://api.github.com/users/shakith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shakith/subscriptions", "organizations_url": "https://api.github.com/users/shakith/orgs", "repos_url": "https://api.github.com/users/shakith/repos", "events_url": "https://api.github.com/users/shakith/events{/privacy}", "received_events_url": "https://api.github.com/users/shakith/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-12-19T10:23:41Z", "updated_at": "2017-05-17T12:27:18Z", "closed_at": "2016-12-19T19:10:43Z", "author_association": "NONE", "body_html": "<p>Hi all,</p>\n<p>I have successfully build tensorflow in windows/visual studio using the <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/cmake\">cmake project</a>.</p>\n<p>Now due to large build time of tensorflow, I am building the tensorflow as libraries (static library) and trying to use them in an application (tf_label_image_example). However, I get the following runtime error at the points of calling env constructor in the SessionOptions at the following source code:<br>\n<code>session-&gt;reset(tensorflow::NewSession(tensorflow::SessionOptions()));.</code><br>\nError is: <code>No session factory registered for the given session options: {target: \"\" config: } Registered factories are {}.</code></p>\n<p>It is similar to <a href=\"https://github.com/tensorflow/tensorflow/issues/3308\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3308/hovercard\">this error</a> in makefiles and MAC os where the compiler is stripping the multiple defined symbols. I tried to add visual studio equivalent of this compiler options (/FORCE:MULTIPLE and /WHOLEARCHIVE) to build of tf_core_lib.lib . however, the compiler options are not applicable to static libraries. Alternative option to is make a DLL, however, that would require modification of all functions with __declspec(dllexport).<br>\nIs there a better solution?</p>\n<p>The tf_label_image_example application contains main.cc and the following additional lib dependencies:<br>\ntf_core_cpu.lib<br>\ntf_core_framework.lib<br>\ntf_core_kernels.lib<br>\ntf_cc_framework.lib<br>\ntf_cc_ops.lib<br>\ntf_core_ops.lib<br>\ntf_stream_executor.lib<br>\ntf_core_direct_session.lib<br>\ntf_core_lib.lib</p>\n<p>Thanks in advance.</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"165520105\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3308\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3308/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3308\">#3308</a></p>\n<h3>Environment info</h3>\n<p>Operating System: Win 10</p>\n<p>Installed version of CUDA and cuDNN:  Cuda 8<br>\nThe same configuration <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/cmake#known-good-configurations\">here </a>is used.</p>", "body_text": "Hi all,\nI have successfully build tensorflow in windows/visual studio using the cmake project.\nNow due to large build time of tensorflow, I am building the tensorflow as libraries (static library) and trying to use them in an application (tf_label_image_example). However, I get the following runtime error at the points of calling env constructor in the SessionOptions at the following source code:\nsession->reset(tensorflow::NewSession(tensorflow::SessionOptions()));.\nError is: No session factory registered for the given session options: {target: \"\" config: } Registered factories are {}.\nIt is similar to this error in makefiles and MAC os where the compiler is stripping the multiple defined symbols. I tried to add visual studio equivalent of this compiler options (/FORCE:MULTIPLE and /WHOLEARCHIVE) to build of tf_core_lib.lib . however, the compiler options are not applicable to static libraries. Alternative option to is make a DLL, however, that would require modification of all functions with __declspec(dllexport).\nIs there a better solution?\nThe tf_label_image_example application contains main.cc and the following additional lib dependencies:\ntf_core_cpu.lib\ntf_core_framework.lib\ntf_core_kernels.lib\ntf_cc_framework.lib\ntf_cc_ops.lib\ntf_core_ops.lib\ntf_stream_executor.lib\ntf_core_direct_session.lib\ntf_core_lib.lib\nThanks in advance.\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n#3308\nEnvironment info\nOperating System: Win 10\nInstalled version of CUDA and cuDNN:  Cuda 8\nThe same configuration here is used.", "body": "Hi all,\r\n\r\nI have successfully build tensorflow in windows/visual studio using the [cmake project](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/cmake). \r\n\r\nNow due to large build time of tensorflow, I am building the tensorflow as libraries (static library) and trying to use them in an application (tf_label_image_example). However, I get the following runtime error at the points of calling env constructor in the SessionOptions at the following source code:\r\n`session->reset(tensorflow::NewSession(tensorflow::SessionOptions()));.`\r\nError is: `No session factory registered for the given session options: {target: \"\" config: } Registered factories are {}.`\r\n\r\nIt is similar to [this error](https://github.com/tensorflow/tensorflow/issues/3308) in makefiles and MAC os where the compiler is stripping the multiple defined symbols. I tried to add visual studio equivalent of this compiler options (/FORCE:MULTIPLE and /WHOLEARCHIVE) to build of tf_core_lib.lib . however, the compiler options are not applicable to static libraries. Alternative option to is make a DLL, however, that would require modification of all functions with __declspec(dllexport).\r\nIs there a better solution?\r\n\r\nThe tf_label_image_example application contains main.cc and the following additional lib dependencies:\r\ntf_core_cpu.lib\r\ntf_core_framework.lib\r\ntf_core_kernels.lib\r\ntf_cc_framework.lib\r\ntf_cc_ops.lib\r\ntf_core_ops.lib\r\ntf_stream_executor.lib\r\ntf_core_direct_session.lib\r\ntf_core_lib.lib\r\n \r\nThanks in advance.\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nhttps://github.com/tensorflow/tensorflow/issues/3308\r\n\r\n### Environment info\r\nOperating System: Win 10\r\n\r\nInstalled version of CUDA and cuDNN:  Cuda 8\r\nThe same configuration [here ](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/cmake#known-good-configurations)is used."}