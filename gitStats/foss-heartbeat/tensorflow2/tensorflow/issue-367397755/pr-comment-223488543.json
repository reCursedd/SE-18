{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/223488543", "pull_request_review_id": 162590849, "id": 223488543, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMzQ4ODU0Mw==", "diff_hunk": "@@ -351,15 +368,23 @@ class MklDnnConvUtil {\n \n     // Output batch is same as input batch.\n     int out_batch = GetTensorDim(input_shape, data_format_, 'N');\n-\n-    // Output depth is same as last dimension for filter.\n-    int out_depth = filter_shape.dim_size(isConv2D ? 3 : 4);\n+    int out_depth;\n+    \n+    // TODO add support for 3-D Depthwise\n+\n+    // Output depth is same as last dimension for filters for regular \n+    // convolutions. For depthwise it is in_depth*channel_muliplier \n+    if (is_Depthwise) {\n+      out_depth = (filter_shape.dim_size(2)*filter_shape.dim_size(3));", "path": "tensorflow/core/kernels/mkl_conv_ops.h", "position": null, "original_position": 123, "commit_id": "6457987ba81af02eee61283e321a2e6184fb5419", "original_commit_id": "95101fc48725b70a596274537b00d961c28bca59", "user": {"login": "penpornk", "id": 38085909, "node_id": "MDQ6VXNlcjM4MDg1OTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/38085909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/penpornk", "html_url": "https://github.com/penpornk", "followers_url": "https://api.github.com/users/penpornk/followers", "following_url": "https://api.github.com/users/penpornk/following{/other_user}", "gists_url": "https://api.github.com/users/penpornk/gists{/gist_id}", "starred_url": "https://api.github.com/users/penpornk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/penpornk/subscriptions", "organizations_url": "https://api.github.com/users/penpornk/orgs", "repos_url": "https://api.github.com/users/penpornk/repos", "events_url": "https://api.github.com/users/penpornk/events{/privacy}", "received_events_url": "https://api.github.com/users/penpornk/received_events", "type": "User", "site_admin": false}, "body": "For future PRs, what do you think about adding an enum (for TF format indices) or getter functions? For example, `filter_shape.dim_size(TFFilterDims::in_depth)` or `GetInDepthFromTFFormat(filter_shape)`. It will be more readable and flexible for future changes.", "created_at": "2018-10-08T20:31:32Z", "updated_at": "2018-11-23T23:05:06Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/22785#discussion_r223488543", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22785", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/223488543"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/22785#discussion_r223488543"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22785"}}, "body_html": "<p>For future PRs, what do you think about adding an enum (for TF format indices) or getter functions? For example, <code>filter_shape.dim_size(TFFilterDims::in_depth)</code> or <code>GetInDepthFromTFFormat(filter_shape)</code>. It will be more readable and flexible for future changes.</p>", "body_text": "For future PRs, what do you think about adding an enum (for TF format indices) or getter functions? For example, filter_shape.dim_size(TFFilterDims::in_depth) or GetInDepthFromTFFormat(filter_shape). It will be more readable and flexible for future changes."}