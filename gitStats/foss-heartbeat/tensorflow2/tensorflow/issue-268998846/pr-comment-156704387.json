{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/156704387", "pull_request_review_id": 83225446, "id": 156704387, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE1NjcwNDM4Nw==", "diff_hunk": "@@ -39,8 +39,19 @@ if (NOT WIN32)\n   # Threads: defines CMAKE_THREAD_LIBS_INIT and adds -pthread compile option\n   # for targets that link ${CMAKE_THREAD_LIBS_INIT}.\n   find_package (Threads)\n+\n+  option(tensorflow_PATH_STATIC_LIB \"Additional library search path for libcudnn_static.a, libnccl_static.a, libculibos.a\" /usr/local/cuda/lib64/)", "path": "tensorflow/contrib/cmake/CMakeLists.txt", "position": 5, "original_position": 5, "commit_id": "486ad315f70d1a17769fdc4cf89634e7db9a4ebd", "original_commit_id": "bd593e0210cc88aca87ac589e04e9eb9a39c4b83", "user": {"login": "headupinclouds", "id": 554720, "node_id": "MDQ6VXNlcjU1NDcyMA==", "avatar_url": "https://avatars3.githubusercontent.com/u/554720?v=4", "gravatar_id": "", "url": "https://api.github.com/users/headupinclouds", "html_url": "https://github.com/headupinclouds", "followers_url": "https://api.github.com/users/headupinclouds/followers", "following_url": "https://api.github.com/users/headupinclouds/following{/other_user}", "gists_url": "https://api.github.com/users/headupinclouds/gists{/gist_id}", "starred_url": "https://api.github.com/users/headupinclouds/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/headupinclouds/subscriptions", "organizations_url": "https://api.github.com/users/headupinclouds/orgs", "repos_url": "https://api.github.com/users/headupinclouds/repos", "events_url": "https://api.github.com/users/headupinclouds/events{/privacy}", "received_events_url": "https://api.github.com/users/headupinclouds/received_events", "type": "User", "site_admin": false}, "body": "@mrry : I'm trying to extend this update to finish CMake + OSX testing w/ (NVIDIA) GPU.   I had started with CUDA 8.0 and cuDNN 6.0, but given recent activity here, it seems better to target master w/ CUDA 9.0 + cuDNN 7.0.  Since this is closely related, It seemed better to keep related discussion in this thread, but I can create a new issue if preferred.   The OS X CUDA installation does not come with `nccl` (see `find` output below for contents).  NVIDIA has a (login based) `nccl` download for v2.0, but it only has Linux libraries.  I see three other options to support OS X + GPU Builds:\r\n\r\n1. https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/nccl (build from bundled source v1.3.5)\r\n2. https://github.com/nvidia/nccl (build from source v1.?)\r\n3. add `option(tensroflow_USE_NCCL \"Use NCCL lib\" ON)` and update code\r\n\r\nShall I add the bundled `nccl` (v1.3.5?) files to the CMake build?.  I see notes about migrating to v2.0 in commit comments, which seems to be closed source.  If that's the case, then it may be best to try to make any internal tensorflow `nccl` operations optional in order to support single GPU configurations to start with. \r\n\r\n`find /Developer/NVIDIA/CUDA-9.0/lib -name \"*.a\"`\r\n```\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcublas_device.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcublas_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcudadevrt.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcudart_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcufft_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcufftw_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libculibos.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcurand_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcusolver_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libcusparse_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppc_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppial_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppicc_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppicom_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppidei_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppif_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppig_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppim_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppist_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppisu_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnppitc_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnpps_static.a\r\n/Developer/NVIDIA/CUDA-9.0/lib/libnvgraph_static.a\r\n```\r\n\r\n[UPDATE: I will repost this as a separate issue for tracking.]", "created_at": "2017-12-13T16:11:15Z", "updated_at": "2017-12-15T12:16:19Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/14016#discussion_r156704387", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/14016", "author_association": "NONE", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/156704387"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/14016#discussion_r156704387"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/14016"}}, "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a> : I'm trying to extend this update to finish CMake + OSX testing w/ (NVIDIA) GPU.   I had started with CUDA 8.0 and cuDNN 6.0, but given recent activity here, it seems better to target master w/ CUDA 9.0 + cuDNN 7.0.  Since this is closely related, It seemed better to keep related discussion in this thread, but I can create a new issue if preferred.   The OS X CUDA installation does not come with <code>nccl</code> (see <code>find</code> output below for contents).  NVIDIA has a (login based) <code>nccl</code> download for v2.0, but it only has Linux libraries.  I see three other options to support OS X + GPU Builds:</p>\n<ol>\n<li><a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/nccl\">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/nccl</a> (build from bundled source v1.3.5)</li>\n<li><a href=\"https://github.com/nvidia/nccl\">https://github.com/nvidia/nccl</a> (build from source v1.?)</li>\n<li>add <code>option(tensroflow_USE_NCCL \"Use NCCL lib\" ON)</code> and update code</li>\n</ol>\n<p>Shall I add the bundled <code>nccl</code> (v1.3.5?) files to the CMake build?.  I see notes about migrating to v2.0 in commit comments, which seems to be closed source.  If that's the case, then it may be best to try to make any internal tensorflow <code>nccl</code> operations optional in order to support single GPU configurations to start with.</p>\n<p><code>find /Developer/NVIDIA/CUDA-9.0/lib -name \"*.a\"</code></p>\n<pre><code>/Developer/NVIDIA/CUDA-9.0/lib/libcublas_device.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcublas_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcudadevrt.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcudart_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcufft_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcufftw_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libculibos.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcurand_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcusolver_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcusparse_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppc_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppial_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppicc_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppicom_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppidei_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppif_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppig_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppim_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppist_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppisu_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppitc_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnpps_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnvgraph_static.a\n</code></pre>\n<p>[UPDATE: I will repost this as a separate issue for tracking.]</p>", "body_text": "@mrry : I'm trying to extend this update to finish CMake + OSX testing w/ (NVIDIA) GPU.   I had started with CUDA 8.0 and cuDNN 6.0, but given recent activity here, it seems better to target master w/ CUDA 9.0 + cuDNN 7.0.  Since this is closely related, It seemed better to keep related discussion in this thread, but I can create a new issue if preferred.   The OS X CUDA installation does not come with nccl (see find output below for contents).  NVIDIA has a (login based) nccl download for v2.0, but it only has Linux libraries.  I see three other options to support OS X + GPU Builds:\n\nhttps://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/nccl (build from bundled source v1.3.5)\nhttps://github.com/nvidia/nccl (build from source v1.?)\nadd option(tensroflow_USE_NCCL \"Use NCCL lib\" ON) and update code\n\nShall I add the bundled nccl (v1.3.5?) files to the CMake build?.  I see notes about migrating to v2.0 in commit comments, which seems to be closed source.  If that's the case, then it may be best to try to make any internal tensorflow nccl operations optional in order to support single GPU configurations to start with.\nfind /Developer/NVIDIA/CUDA-9.0/lib -name \"*.a\"\n/Developer/NVIDIA/CUDA-9.0/lib/libcublas_device.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcublas_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcudadevrt.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcudart_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcufft_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcufftw_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libculibos.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcurand_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcusolver_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libcusparse_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppc_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppial_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppicc_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppicom_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppidei_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppif_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppig_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppim_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppist_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppisu_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnppitc_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnpps_static.a\n/Developer/NVIDIA/CUDA-9.0/lib/libnvgraph_static.a\n\n[UPDATE: I will repost this as a separate issue for tracking.]", "in_reply_to_id": 148305380}