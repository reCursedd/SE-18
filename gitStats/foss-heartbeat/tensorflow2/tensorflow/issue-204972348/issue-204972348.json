{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7224", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7224/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7224/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7224/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7224", "id": 204972348, "node_id": "MDU6SXNzdWUyMDQ5NzIzNDg=", "number": 7224, "title": "dropout does not take in dynamic shape", "user": {"login": "hycis", "id": 3508361, "node_id": "MDQ6VXNlcjM1MDgzNjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/3508361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hycis", "html_url": "https://github.com/hycis", "followers_url": "https://api.github.com/users/hycis/followers", "following_url": "https://api.github.com/users/hycis/following{/other_user}", "gists_url": "https://api.github.com/users/hycis/gists{/gist_id}", "starred_url": "https://api.github.com/users/hycis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hycis/subscriptions", "organizations_url": "https://api.github.com/users/hycis/orgs", "repos_url": "https://api.github.com/users/hycis/repos", "events_url": "https://api.github.com/users/hycis/events{/privacy}", "received_events_url": "https://api.github.com/users/hycis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-02-02T19:30:22Z", "updated_at": "2017-02-07T15:13:43Z", "closed_at": "2017-02-06T16:48:32Z", "author_association": "NONE", "body_html": "<p>I realize dropout <code>noise_shape</code> does not allow dynamic shape which becomes useless in batch processing whereby the batchsize can varies</p>\n<div class=\"highlight highlight-source-python\"><pre>X <span class=\"pl-k\">=</span> tf.placeholder(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>float<span class=\"pl-pds\">'</span></span>, [<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">10</span>])\ntf.dropout(X, <span class=\"pl-v\">keep_prob</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0.5</span>, <span class=\"pl-v\">noise_shape</span><span class=\"pl-k\">=</span>[<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">1</span>]) </pre></div>\n<p>throws Exception. Whereby it requires dimension to be &gt;= 0</p>\n<p>however if we pass noise_shape as the shape of X which is dynamic, dropout can understand the shape.</p>\n<div class=\"highlight highlight-source-python\"><pre>tf.dropout(X, <span class=\"pl-v\">keep_prob</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0.5</span>, <span class=\"pl-v\">noise_shape</span><span class=\"pl-k\">=</span>tf.shape(X))</pre></div>\n<p>Therefore there is inconsistency in noise_shape inputs. How do we give dynamic shapes to <code>noise_shape</code> such as <code>noise_shape=[-1, 5, 1]</code> where the batchsize dimension can be variable just like how <code>tf.reshape</code> works</p>\n<div class=\"highlight highlight-source-python\"><pre>tf.reshape(X, [<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">1</span>])</pre></div>", "body_text": "I realize dropout noise_shape does not allow dynamic shape which becomes useless in batch processing whereby the batchsize can varies\nX = tf.placeholder('float', [None, 5, 10])\ntf.dropout(X, keep_prob=0.5, noise_shape=[-1, 5, 1]) \nthrows Exception. Whereby it requires dimension to be >= 0\nhowever if we pass noise_shape as the shape of X which is dynamic, dropout can understand the shape.\ntf.dropout(X, keep_prob=0.5, noise_shape=tf.shape(X))\nTherefore there is inconsistency in noise_shape inputs. How do we give dynamic shapes to noise_shape such as noise_shape=[-1, 5, 1] where the batchsize dimension can be variable just like how tf.reshape works\ntf.reshape(X, [-1, 5, 1])", "body": "I realize dropout `noise_shape` does not allow dynamic shape which becomes useless in batch processing whereby the batchsize can varies\r\n```python\r\nX = tf.placeholder('float', [None, 5, 10])\r\ntf.dropout(X, keep_prob=0.5, noise_shape=[-1, 5, 1]) \r\n```\r\nthrows Exception. Whereby it requires dimension to be >= 0\r\n\r\nhowever if we pass noise_shape as the shape of X which is dynamic, dropout can understand the shape.\r\n```python\r\ntf.dropout(X, keep_prob=0.5, noise_shape=tf.shape(X))\r\n```\r\nTherefore there is inconsistency in noise_shape inputs. How do we give dynamic shapes to `noise_shape` such as `noise_shape=[-1, 5, 1]` where the batchsize dimension can be variable just like how `tf.reshape` works\r\n\r\n```python\r\ntf.reshape(X, [-1, 5, 1])\r\n```"}