{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15263", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15263/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15263/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15263/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15263", "id": 280928657, "node_id": "MDU6SXNzdWUyODA5Mjg2NTc=", "number": 15263, "title": "Cannot parse tensor from proto: dtype: DT_INT32 when using tf.extract_image_patches and tf.reshape", "user": {"login": "talhadar", "id": 11799983, "node_id": "MDQ6VXNlcjExNzk5OTgz", "avatar_url": "https://avatars0.githubusercontent.com/u/11799983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talhadar", "html_url": "https://github.com/talhadar", "followers_url": "https://api.github.com/users/talhadar/followers", "following_url": "https://api.github.com/users/talhadar/following{/other_user}", "gists_url": "https://api.github.com/users/talhadar/gists{/gist_id}", "starred_url": "https://api.github.com/users/talhadar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talhadar/subscriptions", "organizations_url": "https://api.github.com/users/talhadar/orgs", "repos_url": "https://api.github.com/users/talhadar/repos", "events_url": "https://api.github.com/users/talhadar/events{/privacy}", "received_events_url": "https://api.github.com/users/talhadar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-12-11T08:16:17Z", "updated_at": "2017-12-11T19:09:39Z", "closed_at": "2017-12-11T19:09:39Z", "author_association": "NONE", "body_html": "<p>Hi,<br>\nI'm experiencing a problem when using TensorFlow to extract image patches and then reshape the output. I'm using TensorFlow 1.3.0, what am i doing wrong?</p>\n<p>That's my code:</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\nc = 3\nh = 1024\np = 32\n\nimage = tf.random_normal([h,h,c])\npatch_size = [1,p,p,1]\npatches = tf.extract_image_patches([image],\n   patch_size, patch_size, [1, 1, 1, 1], 'VALID')\npatches = tf.reshape(patches, [h, p, p, c])\n\nsess = tf.Session()\nI,P,R_n = sess.run([image,patches])\nprint(I.shape)\nprint(P.shape)\n</code></pre>\n<p>The error i'm getting is this:</p>\n<pre><code>---------------------------------------------------------------------------\nInvalidArgumentError                      Traceback (most recent call last)\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\n   1326     try:\n-&gt; 1327       return fn(*args)\n   1328     except errors.OpError as e:\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(session, feed_dict, fetch_list, target_list, options, run_metadata)\n   1305                                    feed_dict, fetch_list, target_list,\n-&gt; 1306                                    status, run_metadata)\n   1307 \n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\contextlib.py in __exit__(self, type, value, traceback)\n     65             try:\n---&gt; 66                 next(self.gen)\n     67             except StopIteration:\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\n    465           compat.as_text(pywrap_tensorflow.TF_Message(status)),\n--&gt; 466           pywrap_tensorflow.TF_GetCode(status))\n    467   finally:\n\nInvalidArgumentError: Cannot parse tensor from proto: dtype: DT_INT32\ntensor_shape {\n  dim {\n    size: 3\n  }\n}\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\n\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor&lt;type: int32 shape: [3] values: 1024 1024 3&gt;, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\n\nDuring handling of the above exception, another exception occurred:\n\nInvalidArgumentError                      Traceback (most recent call last)\n&lt;ipython-input-159-454594e78931&gt; in &lt;module&gt;()\n     12 \n     13 sess = tf.Session()\n---&gt; 14 I,P,R_n = sess.run([image,patches])\n     15 print(I.shape)\n     16 print(P.shape)\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\n    893     try:\n    894       result = self._run(None, fetches, feed_dict, options_ptr,\n--&gt; 895                          run_metadata_ptr)\n    896       if run_metadata:\n    897         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\n   1122     if final_fetches or final_targets or (handle and feed_dict_tensor):\n   1123       results = self._do_run(handle, final_targets, final_fetches,\n-&gt; 1124                              feed_dict_tensor, options, run_metadata)\n   1125     else:\n   1126       results = []\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n   1319     if handle is None:\n   1320       return self._do_call(_run_fn, self._session, feeds, fetches, targets,\n-&gt; 1321                            options, run_metadata)\n   1322     else:\n   1323       return self._do_call(_prun_fn, self._session, handle, feeds, fetches)\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\n   1338         except KeyError:\n   1339           pass\n-&gt; 1340       raise type(e)(node_def, op, message)\n   1341 \n   1342   def _extend_graph(self):\n\nInvalidArgumentError: Cannot parse tensor from proto: dtype: DT_INT32\ntensor_shape {\n  dim {\n    size: 3\n  }\n}\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\n\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor&lt;type: int32 shape: [3] values: 1024 1024 3&gt;, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\n\nCaused by op 'random_normal_21/shape', defined at:\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\__main__.py\", line 3, in &lt;module&gt;\n    app.launch_new_instance()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance\n    app.start()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 477, in start\n    ioloop.IOLoop.instance().start()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\ioloop.py\", line 177, in start\n    super(ZMQIOLoop, self).start()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\ioloop.py\", line 888, in start\n    handler_func(fd_obj, events)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\stack_context.py\", line 277, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 440, in _handle_events\n    self._handle_recv()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 472, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 414, in _run_callback\n    callback(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\stack_context.py\", line 277, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 283, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 235, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 399, in execute_request\n    user_expressions, allow_stdin)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 196, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 533, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2698, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2802, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2862, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"&lt;ipython-input-159-454594e78931&gt;\", line 7, in &lt;module&gt;\n    image = tf.random_normal([h,h,c])\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\ops\\random_ops.py\", line 71, in random_normal\n    shape_tensor = _ShapeTensor(shape)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\ops\\random_ops.py\", line 42, in _ShapeTensor\n    return ops.convert_to_tensor(shape, dtype=dtype, name=\"shape\")\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 611, in convert_to_tensor\n    as_ref=False)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 676, in internal_convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 121, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 106, in constant\n    attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): Cannot parse tensor from proto: dtype: DT_INT32\ntensor_shape {\n  dim {\n    size: 3\n  }\n}\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\n\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor&lt;type: int32 shape: [3] values: 1024 1024 3&gt;, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\n</code></pre>", "body_text": "Hi,\nI'm experiencing a problem when using TensorFlow to extract image patches and then reshape the output. I'm using TensorFlow 1.3.0, what am i doing wrong?\nThat's my code:\nimport tensorflow as tf\nimport numpy as np\nc = 3\nh = 1024\np = 32\n\nimage = tf.random_normal([h,h,c])\npatch_size = [1,p,p,1]\npatches = tf.extract_image_patches([image],\n   patch_size, patch_size, [1, 1, 1, 1], 'VALID')\npatches = tf.reshape(patches, [h, p, p, c])\n\nsess = tf.Session()\nI,P,R_n = sess.run([image,patches])\nprint(I.shape)\nprint(P.shape)\n\nThe error i'm getting is this:\n---------------------------------------------------------------------------\nInvalidArgumentError                      Traceback (most recent call last)\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\n   1326     try:\n-> 1327       return fn(*args)\n   1328     except errors.OpError as e:\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(session, feed_dict, fetch_list, target_list, options, run_metadata)\n   1305                                    feed_dict, fetch_list, target_list,\n-> 1306                                    status, run_metadata)\n   1307 \n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\contextlib.py in __exit__(self, type, value, traceback)\n     65             try:\n---> 66                 next(self.gen)\n     67             except StopIteration:\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\n    465           compat.as_text(pywrap_tensorflow.TF_Message(status)),\n--> 466           pywrap_tensorflow.TF_GetCode(status))\n    467   finally:\n\nInvalidArgumentError: Cannot parse tensor from proto: dtype: DT_INT32\ntensor_shape {\n  dim {\n    size: 3\n  }\n}\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\n\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor<type: int32 shape: [3] values: 1024 1024 3>, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\n\nDuring handling of the above exception, another exception occurred:\n\nInvalidArgumentError                      Traceback (most recent call last)\n<ipython-input-159-454594e78931> in <module>()\n     12 \n     13 sess = tf.Session()\n---> 14 I,P,R_n = sess.run([image,patches])\n     15 print(I.shape)\n     16 print(P.shape)\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\n    893     try:\n    894       result = self._run(None, fetches, feed_dict, options_ptr,\n--> 895                          run_metadata_ptr)\n    896       if run_metadata:\n    897         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\n   1122     if final_fetches or final_targets or (handle and feed_dict_tensor):\n   1123       results = self._do_run(handle, final_targets, final_fetches,\n-> 1124                              feed_dict_tensor, options, run_metadata)\n   1125     else:\n   1126       results = []\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n   1319     if handle is None:\n   1320       return self._do_call(_run_fn, self._session, feeds, fetches, targets,\n-> 1321                            options, run_metadata)\n   1322     else:\n   1323       return self._do_call(_prun_fn, self._session, handle, feeds, fetches)\n\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\n   1338         except KeyError:\n   1339           pass\n-> 1340       raise type(e)(node_def, op, message)\n   1341 \n   1342   def _extend_graph(self):\n\nInvalidArgumentError: Cannot parse tensor from proto: dtype: DT_INT32\ntensor_shape {\n  dim {\n    size: 3\n  }\n}\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\n\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor<type: int32 shape: [3] values: 1024 1024 3>, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\n\nCaused by op 'random_normal_21/shape', defined at:\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\__main__.py\", line 3, in <module>\n    app.launch_new_instance()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance\n    app.start()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 477, in start\n    ioloop.IOLoop.instance().start()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\ioloop.py\", line 177, in start\n    super(ZMQIOLoop, self).start()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\ioloop.py\", line 888, in start\n    handler_func(fd_obj, events)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\stack_context.py\", line 277, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 440, in _handle_events\n    self._handle_recv()\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 472, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 414, in _run_callback\n    callback(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\stack_context.py\", line 277, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 283, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 235, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 399, in execute_request\n    user_expressions, allow_stdin)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 196, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 533, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2698, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2802, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2862, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-159-454594e78931>\", line 7, in <module>\n    image = tf.random_normal([h,h,c])\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\ops\\random_ops.py\", line 71, in random_normal\n    shape_tensor = _ShapeTensor(shape)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\ops\\random_ops.py\", line 42, in _ShapeTensor\n    return ops.convert_to_tensor(shape, dtype=dtype, name=\"shape\")\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 611, in convert_to_tensor\n    as_ref=False)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 676, in internal_convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 121, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 106, in constant\n    attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): Cannot parse tensor from proto: dtype: DT_INT32\ntensor_shape {\n  dim {\n    size: 3\n  }\n}\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\n\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor<type: int32 shape: [3] values: 1024 1024 3>, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]", "body": "Hi,\r\nI'm experiencing a problem when using TensorFlow to extract image patches and then reshape the output. I'm using TensorFlow 1.3.0, what am i doing wrong?\r\n\r\nThat's my code:\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\nc = 3\r\nh = 1024\r\np = 32\r\n\r\nimage = tf.random_normal([h,h,c])\r\npatch_size = [1,p,p,1]\r\npatches = tf.extract_image_patches([image],\r\n   patch_size, patch_size, [1, 1, 1, 1], 'VALID')\r\npatches = tf.reshape(patches, [h, p, p, c])\r\n\r\nsess = tf.Session()\r\nI,P,R_n = sess.run([image,patches])\r\nprint(I.shape)\r\nprint(P.shape)\r\n```\r\n\r\nThe error i'm getting is this:\r\n```\r\n---------------------------------------------------------------------------\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1326     try:\r\n-> 1327       return fn(*args)\r\n   1328     except errors.OpError as e:\r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(session, feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1305                                    feed_dict, fetch_list, target_list,\r\n-> 1306                                    status, run_metadata)\r\n   1307 \r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\contextlib.py in __exit__(self, type, value, traceback)\r\n     65             try:\r\n---> 66                 next(self.gen)\r\n     67             except StopIteration:\r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\r\n    465           compat.as_text(pywrap_tensorflow.TF_Message(status)),\r\n--> 466           pywrap_tensorflow.TF_GetCode(status))\r\n    467   finally:\r\n\r\nInvalidArgumentError: Cannot parse tensor from proto: dtype: DT_INT32\r\ntensor_shape {\r\n  dim {\r\n    size: 3\r\n  }\r\n}\r\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\r\n\r\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor<type: int32 shape: [3] values: 1024 1024 3>, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n<ipython-input-159-454594e78931> in <module>()\r\n     12 \r\n     13 sess = tf.Session()\r\n---> 14 I,P,R_n = sess.run([image,patches])\r\n     15 print(I.shape)\r\n     16 print(P.shape)\r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    893     try:\r\n    894       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 895                          run_metadata_ptr)\r\n    896       if run_metadata:\r\n    897         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1122     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1123       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1124                              feed_dict_tensor, options, run_metadata)\r\n   1125     else:\r\n   1126       results = []\r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1319     if handle is None:\r\n   1320       return self._do_call(_run_fn, self._session, feeds, fetches, targets,\r\n-> 1321                            options, run_metadata)\r\n   1322     else:\r\n   1323       return self._do_call(_prun_fn, self._session, handle, feeds, fetches)\r\n\r\n~\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1338         except KeyError:\r\n   1339           pass\r\n-> 1340       raise type(e)(node_def, op, message)\r\n   1341 \r\n   1342   def _extend_graph(self):\r\n\r\nInvalidArgumentError: Cannot parse tensor from proto: dtype: DT_INT32\r\ntensor_shape {\r\n  dim {\r\n    size: 3\r\n  }\r\n}\r\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\r\n\r\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor<type: int32 shape: [3] values: 1024 1024 3>, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n\r\nCaused by op 'random_normal_21/shape', defined at:\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\__main__.py\", line 3, in <module>\r\n    app.launch_new_instance()\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 477, in start\r\n    ioloop.IOLoop.instance().start()\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\ioloop.py\", line 177, in start\r\n    super(ZMQIOLoop, self).start()\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\ioloop.py\", line 888, in start\r\n    handler_func(fd_obj, events)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 440, in _handle_events\r\n    self._handle_recv()\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 472, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 414, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tornado\\stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 235, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 196, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 533, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2698, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2802, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2862, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-159-454594e78931>\", line 7, in <module>\r\n    image = tf.random_normal([h,h,c])\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\ops\\random_ops.py\", line 71, in random_normal\r\n    shape_tensor = _ShapeTensor(shape)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\ops\\random_ops.py\", line 42, in _ShapeTensor\r\n    return ops.convert_to_tensor(shape, dtype=dtype, name=\"shape\")\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 611, in convert_to_tensor\r\n    as_ref=False)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 676, in internal_convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 121, in _constant_tensor_conversion_function\r\n    return constant(v, dtype=dtype, name=name)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py\", line 106, in constant\r\n    attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"C:\\Users\\koko\\AppData\\Local\\conda\\conda\\envs\\tf\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): Cannot parse tensor from proto: dtype: DT_INT32\r\ntensor_shape {\r\n  dim {\r\n    size: 3\r\n  }\r\n}\r\ntensor_content: \"\\000\\004\\000\\000\\000\\004\\000\\000\\003\\000\\000\\000\"\r\n\r\n\t [[Node: random_normal_21/shape = Const[dtype=DT_INT32, value=Tensor<type: int32 shape: [3] values: 1024 1024 3>, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n```"}