{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/335400829", "html_url": "https://github.com/tensorflow/tensorflow/pull/11878#issuecomment-335400829", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11878", "id": 335400829, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTQwMDgyOQ==", "user": {"login": "hzhangxyz", "id": 11623447, "node_id": "MDQ6VXNlcjExNjIzNDQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/11623447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hzhangxyz", "html_url": "https://github.com/hzhangxyz", "followers_url": "https://api.github.com/users/hzhangxyz/followers", "following_url": "https://api.github.com/users/hzhangxyz/following{/other_user}", "gists_url": "https://api.github.com/users/hzhangxyz/gists{/gist_id}", "starred_url": "https://api.github.com/users/hzhangxyz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hzhangxyz/subscriptions", "organizations_url": "https://api.github.com/users/hzhangxyz/orgs", "repos_url": "https://api.github.com/users/hzhangxyz/repos", "events_url": "https://api.github.com/users/hzhangxyz/events{/privacy}", "received_events_url": "https://api.github.com/users/hzhangxyz/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-10T08:32:37Z", "updated_at": "2017-10-10T08:33:56Z", "author_association": "NONE", "body_html": "<p>I don't know why in my PC, SVD on GPU is slower than SVD on CPU... version r1.4(<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/4196d6d1ca60af920e95b7a98f5bb2fa2f3f58af/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/4196d6d1ca60af920e95b7a98f5bb2fa2f3f58af\"><tt>4196d6d</tt></a>)</p>\n<p>file main.py</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\nimport sys\n\nD = 1024\ndA = np.random.normal(size=(D,D))\n\ndev = \"/gpu:0\" if len(sys.argv)==1 else \"/cpu:0\"\n\nwith tf.device(dev):\n    A = tf.placeholder(shape=(D,D),dtype=tf.float32)\n    S, U, V = tf.svd(A)\n\nconfig = tf.ConfigProto()\nconfig.log_device_placement = True\nconfig.graph_options.optimizer_options.global_jit_level=tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\n\nfor _ in xrange(10):\n    dS, dU, dV = sess.run((S, U, V), feed_dict={A:dA})\n</code></pre>\n<h2>run on GPU</h2>\n<p><code>time python main.py</code></p>\n<pre><code>2017-10-10 16:28:49.047703: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:28:49.048176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:28:49.048205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:28:49.064960: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067234: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:GPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067302: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.074053: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x488e860\npython main.py  27.50s user 2.30s system 100% cpu 29.658 total\n</code></pre>\n<h2>run on CPU</h2>\n<p><code>time python main.py -</code></p>\n<pre><code>2017-10-10 16:29:53.252138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:29:53.252572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:29:53.252600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:29:53.269242: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271505: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:CPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271544: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:CPU:0\npython main.py -  34.33s user 10.68s system 621% cpu 7.241 total\n</code></pre>", "body_text": "I don't know why in my PC, SVD on GPU is slower than SVD on CPU... version r1.4(4196d6d)\nfile main.py\nimport tensorflow as tf\nimport numpy as np\nimport sys\n\nD = 1024\ndA = np.random.normal(size=(D,D))\n\ndev = \"/gpu:0\" if len(sys.argv)==1 else \"/cpu:0\"\n\nwith tf.device(dev):\n    A = tf.placeholder(shape=(D,D),dtype=tf.float32)\n    S, U, V = tf.svd(A)\n\nconfig = tf.ConfigProto()\nconfig.log_device_placement = True\nconfig.graph_options.optimizer_options.global_jit_level=tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\n\nfor _ in xrange(10):\n    dS, dU, dV = sess.run((S, U, V), feed_dict={A:dA})\n\nrun on GPU\ntime python main.py\n2017-10-10 16:28:49.047703: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:28:49.048176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:28:49.048205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:28:49.064960: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067234: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:GPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067302: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.074053: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x488e860\npython main.py  27.50s user 2.30s system 100% cpu 29.658 total\n\nrun on CPU\ntime python main.py -\n2017-10-10 16:29:53.252138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:29:53.252572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:29:53.252600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:29:53.269242: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271505: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:CPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271544: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:CPU:0\npython main.py -  34.33s user 10.68s system 621% cpu 7.241 total", "body": "I don't know why in my PC, SVD on GPU is slower than SVD on CPU... version r1.4(4196d6d)\r\n\r\nfile main.py\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\nimport sys\r\n\r\nD = 1024\r\ndA = np.random.normal(size=(D,D))\r\n\r\ndev = \"/gpu:0\" if len(sys.argv)==1 else \"/cpu:0\"\r\n\r\nwith tf.device(dev):\r\n    A = tf.placeholder(shape=(D,D),dtype=tf.float32)\r\n    S, U, V = tf.svd(A)\r\n\r\nconfig = tf.ConfigProto()\r\nconfig.log_device_placement = True\r\nconfig.graph_options.optimizer_options.global_jit_level=tf.OptimizerOptions.ON_1\r\nsess = tf.Session(config=config)\r\n\r\nfor _ in xrange(10):\r\n    dS, dU, dV = sess.run((S, U, V), feed_dict={A:dA})\r\n```\r\n\r\n## run on GPU\r\n`time python main.py`\r\n```\r\n2017-10-10 16:28:49.047703: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2017-10-10 16:28:49.048176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2017-10-10 16:28:49.048205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n2017-10-10 16:28:49.064960: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n\r\nSvd: (Svd): /job:localhost/replica:0/task:0/device:GPU:0\r\n2017-10-10 16:28:49.067234: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:GPU:0\r\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:GPU:0\r\n2017-10-10 16:28:49.067302: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:GPU:0\r\n2017-10-10 16:28:49.074053: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x488e860\r\npython main.py  27.50s user 2.30s system 100% cpu 29.658 total\r\n```\r\n\r\n## run on CPU\r\n`time python main.py -`\r\n```\r\n2017-10-10 16:29:53.252138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2017-10-10 16:29:53.252572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2017-10-10 16:29:53.252600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n2017-10-10 16:29:53.269242: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n\r\nSvd: (Svd): /job:localhost/replica:0/task:0/device:CPU:0\r\n2017-10-10 16:29:53.271505: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:CPU:0\r\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:CPU:0\r\n2017-10-10 16:29:53.271544: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:CPU:0\r\npython main.py -  34.33s user 10.68s system 621% cpu 7.241 total\r\n```"}