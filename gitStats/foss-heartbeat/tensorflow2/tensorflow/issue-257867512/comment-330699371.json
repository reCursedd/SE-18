{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/330699371", "html_url": "https://github.com/tensorflow/tensorflow/issues/13050#issuecomment-330699371", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13050", "id": 330699371, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDY5OTM3MQ==", "user": {"login": "tfboyd", "id": 23486130, "node_id": "MDQ6VXNlcjIzNDg2MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/23486130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfboyd", "html_url": "https://github.com/tfboyd", "followers_url": "https://api.github.com/users/tfboyd/followers", "following_url": "https://api.github.com/users/tfboyd/following{/other_user}", "gists_url": "https://api.github.com/users/tfboyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfboyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfboyd/subscriptions", "organizations_url": "https://api.github.com/users/tfboyd/orgs", "repos_url": "https://api.github.com/users/tfboyd/repos", "events_url": "https://api.github.com/users/tfboyd/events{/privacy}", "received_events_url": "https://api.github.com/users/tfboyd/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-19T23:11:05Z", "updated_at": "2017-09-19T23:11:05Z", "author_association": "MEMBER", "body_html": "<p>cl/169317026  (my tracking purposes)</p>\n<p>Sorry about that and here are the updated numbers.  I also had some slightly newer numbers for inception3.  No real difference as a glance but I reran the numbers and did not update the document before I published.  Thank you for understanding.  It might take a little bit to update the site but you have the numbers here for now.  Sorry about the tables we have a slightly different Mark Down engine for the website.</p>\n<h4>Inference InceptionV3</h4>\n<p><strong>Environment</strong></p>\n<ul>\n<li>Instance Type: AWS EC2 m4.xlarge</li>\n<li>CPU: Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz (Broadwell)</li>\n<li>Dataset: ImageNet</li>\n<li>TensorFlow Version: 1.2.0 RC2</li>\n<li>Test Script: <a href=\"https://github.com/tensorflow/benchmarks/blob/mkl_experiment/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py\">tf_cnn_benchmarks.py</a></li>\n</ul>\n<p><strong>Batch Size: 1</strong></p>\n<p>Command executed for the MKL test:</p>\n<div class=\"highlight highlight-source-shell\"><pre>python tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=inception3 --data_format=NCHW \\\n--batch_size=1 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<span class=\"pl-k\">&lt;</span>path to ImageNet TFRecords<span class=\"pl-k\">&gt;</span></pre></div>\n<p>| Optimization | Data Format | Images/Sec   | Intra threads | Inter Threads |<br>\n:              :             : (step time)  :               :               :<br>\n| ------------ | ----------- | ------------ | ------------- | ------------- |<br>\n| AVX2         | NHWC        | 7.0 (142ms)  | 4             | 0             |<br>\n| MKL          | NCHW        | 6.6 (152ms)  | 4             | 1             |<br>\n| AVX          | NHWC        | 5.0 (202ms)  | 4             | 0             |<br>\n| SSE3         | NHWC        | 2.8 (361ms)  | 4             | 0             |</p>\n<p><strong>Batch Size: 32</strong></p>\n<p>Command executed for the MKL test:</p>\n<div class=\"highlight highlight-source-shell\"><pre>python tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=inception3 --data_format=NCHW \\\n--batch_size=32 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<span class=\"pl-k\">&lt;</span>path to ImageNet TFRecords<span class=\"pl-k\">&gt;</span></pre></div>\n<p>| Optimization | Data Format | Images/Sec    | Intra threads | Inter Threads |<br>\n:              :             : (step time)   :               :               :<br>\n| ------------ | ----------- | ------------- | ------------- | ------------- |<br>\n| MKL          | NCHW        | 10.3          | 4             | 1             |<br>\n:              :             : (3,104ms)     :               :               :<br>\n| AVX2         | NHWC        | 7.5 (4,255ms) | 4             | 0             |<br>\n| AVX          | NHWC        | 5.1 (6,275ms) | 4             | 0             |<br>\n| SSE3         | NHWC        | 2.8 (11,428ms)| 4             | 0             |</p>\n<h4>Inference ResNet-50</h4>\n<p><strong>Environment</strong></p>\n<ul>\n<li>Instance Type: AWS EC2 m4.xlarge</li>\n<li>CPU: Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz (Broadwell)</li>\n<li>Dataset: ImageNet</li>\n<li>TensorFlow Version: 1.2.0 RC2</li>\n<li>Test Script: <a href=\"https://github.com/tensorflow/benchmarks/blob/mkl_experiment/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py\">tf_cnn_benchmarks.py</a></li>\n</ul>\n<p><strong>Batch Size: 1</strong></p>\n<p>Command executed for the MKL test:</p>\n<div class=\"highlight highlight-source-shell\"><pre>python tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\n--batch_size=1 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<span class=\"pl-k\">&lt;</span>path to ImageNet TFRecords<span class=\"pl-k\">&gt;</span></pre></div>\n<p>| Optimization | Data Format | Images/Sec   | Intra threads | Inter Threads |<br>\n:              :             : (step time)  :               :               :<br>\n| ------------ | ----------- | ------------ | ------------- | ------------- |<br>\n| AVX2         | NHWC        | 8.8 (113ms)  | 4             | 0             |<br>\n| MKL          | NCHW        | 8.5 (120ms)  | 4             | 1             |<br>\n| AVX          | NHWC        | 6.4 (157ms)  | 4             | 0             |<br>\n| SSE3         | NHWC        | 3.7 (270ms)  | 4             | 0             |</p>\n<p><strong>Batch Size: 32</strong></p>\n<p>Command executed for the MKL test:</p>\n<div class=\"highlight highlight-source-shell\"><pre>python tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\n--batch_size=32 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<span class=\"pl-k\">&lt;</span>path to ImageNet TFRecords<span class=\"pl-k\">&gt;</span></pre></div>\n<p>| Optimization | Data Format | Images/Sec    | Intra threads | Inter Threads |<br>\n:              :             : (step time)   :               :               :<br>\n| ------------ | ----------- | ------------- | ------------- | ------------- |<br>\n| MKL          | NCHW        | 12.4          | 4             | 1             |<br>\n:              :             : (2,590ms)     :               :               :<br>\n| AVX2         | NHWC        | 10.4 (3,079ms)| 4             | 0             |<br>\n| AVX          | NHWC        | 7.3 (4,4416ms)| 4             | 0             |<br>\n| SSE3         | NHWC        | 4.0 (8,054ms) | 4             | 0             |</p>", "body_text": "cl/169317026  (my tracking purposes)\nSorry about that and here are the updated numbers.  I also had some slightly newer numbers for inception3.  No real difference as a glance but I reran the numbers and did not update the document before I published.  Thank you for understanding.  It might take a little bit to update the site but you have the numbers here for now.  Sorry about the tables we have a slightly different Mark Down engine for the website.\nInference InceptionV3\nEnvironment\n\nInstance Type: AWS EC2 m4.xlarge\nCPU: Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz (Broadwell)\nDataset: ImageNet\nTensorFlow Version: 1.2.0 RC2\nTest Script: tf_cnn_benchmarks.py\n\nBatch Size: 1\nCommand executed for the MKL test:\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=inception3 --data_format=NCHW \\\n--batch_size=1 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<path to ImageNet TFRecords>\n| Optimization | Data Format | Images/Sec   | Intra threads | Inter Threads |\n:              :             : (step time)  :               :               :\n| ------------ | ----------- | ------------ | ------------- | ------------- |\n| AVX2         | NHWC        | 7.0 (142ms)  | 4             | 0             |\n| MKL          | NCHW        | 6.6 (152ms)  | 4             | 1             |\n| AVX          | NHWC        | 5.0 (202ms)  | 4             | 0             |\n| SSE3         | NHWC        | 2.8 (361ms)  | 4             | 0             |\nBatch Size: 32\nCommand executed for the MKL test:\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=inception3 --data_format=NCHW \\\n--batch_size=32 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<path to ImageNet TFRecords>\n| Optimization | Data Format | Images/Sec    | Intra threads | Inter Threads |\n:              :             : (step time)   :               :               :\n| ------------ | ----------- | ------------- | ------------- | ------------- |\n| MKL          | NCHW        | 10.3          | 4             | 1             |\n:              :             : (3,104ms)     :               :               :\n| AVX2         | NHWC        | 7.5 (4,255ms) | 4             | 0             |\n| AVX          | NHWC        | 5.1 (6,275ms) | 4             | 0             |\n| SSE3         | NHWC        | 2.8 (11,428ms)| 4             | 0             |\nInference ResNet-50\nEnvironment\n\nInstance Type: AWS EC2 m4.xlarge\nCPU: Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz (Broadwell)\nDataset: ImageNet\nTensorFlow Version: 1.2.0 RC2\nTest Script: tf_cnn_benchmarks.py\n\nBatch Size: 1\nCommand executed for the MKL test:\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\n--batch_size=1 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<path to ImageNet TFRecords>\n| Optimization | Data Format | Images/Sec   | Intra threads | Inter Threads |\n:              :             : (step time)  :               :               :\n| ------------ | ----------- | ------------ | ------------- | ------------- |\n| AVX2         | NHWC        | 8.8 (113ms)  | 4             | 0             |\n| MKL          | NCHW        | 8.5 (120ms)  | 4             | 1             |\n| AVX          | NHWC        | 6.4 (157ms)  | 4             | 0             |\n| SSE3         | NHWC        | 3.7 (270ms)  | 4             | 0             |\nBatch Size: 32\nCommand executed for the MKL test:\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\n--kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\n--batch_size=32 --num_inter_threads=1 --num_intra_threads=4 \\\n--data_dir=<path to ImageNet TFRecords>\n| Optimization | Data Format | Images/Sec    | Intra threads | Inter Threads |\n:              :             : (step time)   :               :               :\n| ------------ | ----------- | ------------- | ------------- | ------------- |\n| MKL          | NCHW        | 12.4          | 4             | 1             |\n:              :             : (2,590ms)     :               :               :\n| AVX2         | NHWC        | 10.4 (3,079ms)| 4             | 0             |\n| AVX          | NHWC        | 7.3 (4,4416ms)| 4             | 0             |\n| SSE3         | NHWC        | 4.0 (8,054ms) | 4             | 0             |", "body": "cl/169317026  (my tracking purposes)\r\n\r\nSorry about that and here are the updated numbers.  I also had some slightly newer numbers for inception3.  No real difference as a glance but I reran the numbers and did not update the document before I published.  Thank you for understanding.  It might take a little bit to update the site but you have the numbers here for now.  Sorry about the tables we have a slightly different Mark Down engine for the website.  \r\n\r\n#### Inference InceptionV3\r\n\r\n**Environment**\r\n\r\n*   Instance Type: AWS EC2 m4.xlarge\r\n*   CPU: Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz (Broadwell)\r\n*   Dataset: ImageNet\r\n*   TensorFlow Version: 1.2.0 RC2\r\n*   Test Script: [tf_cnn_benchmarks.py](https://github.com/tensorflow/benchmarks/blob/mkl_experiment/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py)\r\n\r\n**Batch Size: 1**\r\n\r\nCommand executed for the MKL test:\r\n\r\n```bash\r\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\r\n--kmp_blocktime=0 --nodistortions --model=inception3 --data_format=NCHW \\\r\n--batch_size=1 --num_inter_threads=1 --num_intra_threads=4 \\\r\n--data_dir=<path to ImageNet TFRecords>\r\n```\r\n\r\n| Optimization | Data Format | Images/Sec   | Intra threads | Inter Threads |\r\n:              :             : (step time)  :               :               :\r\n| ------------ | ----------- | ------------ | ------------- | ------------- |\r\n| AVX2         | NHWC        | 7.0 (142ms)  | 4             | 0             |\r\n| MKL          | NCHW        | 6.6 (152ms)  | 4             | 1             |\r\n| AVX          | NHWC        | 5.0 (202ms)  | 4             | 0             |\r\n| SSE3         | NHWC        | 2.8 (361ms)  | 4             | 0             |\r\n\r\n**Batch Size: 32**\r\n\r\nCommand executed for the MKL test:\r\n\r\n```bash\r\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\r\n--kmp_blocktime=0 --nodistortions --model=inception3 --data_format=NCHW \\\r\n--batch_size=32 --num_inter_threads=1 --num_intra_threads=4 \\\r\n--data_dir=<path to ImageNet TFRecords>\r\n```\r\n\r\n| Optimization | Data Format | Images/Sec    | Intra threads | Inter Threads |\r\n:              :             : (step time)   :               :               :\r\n| ------------ | ----------- | ------------- | ------------- | ------------- |\r\n| MKL          | NCHW        | 10.3          | 4             | 1             |\r\n:              :             : (3,104ms)     :               :               :\r\n| AVX2         | NHWC        | 7.5 (4,255ms) | 4             | 0             |\r\n| AVX          | NHWC        | 5.1 (6,275ms) | 4             | 0             |\r\n| SSE3         | NHWC        | 2.8 (11,428ms)| 4             | 0             |\r\n\r\n#### Inference ResNet-50\r\n\r\n**Environment**\r\n\r\n*   Instance Type: AWS EC2 m4.xlarge\r\n*   CPU: Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz (Broadwell)\r\n*   Dataset: ImageNet\r\n*   TensorFlow Version: 1.2.0 RC2\r\n*   Test Script: [tf_cnn_benchmarks.py](https://github.com/tensorflow/benchmarks/blob/mkl_experiment/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py)\r\n\r\n**Batch Size: 1**\r\n\r\nCommand executed for the MKL test:\r\n\r\n```bash\r\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\r\n--kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\r\n--batch_size=1 --num_inter_threads=1 --num_intra_threads=4 \\\r\n--data_dir=<path to ImageNet TFRecords>\r\n```\r\n\r\n| Optimization | Data Format | Images/Sec   | Intra threads | Inter Threads |\r\n:              :             : (step time)  :               :               :\r\n| ------------ | ----------- | ------------ | ------------- | ------------- |\r\n| AVX2         | NHWC        | 8.8 (113ms)  | 4             | 0             |\r\n| MKL          | NCHW        | 8.5 (120ms)  | 4             | 1             |\r\n| AVX          | NHWC        | 6.4 (157ms)  | 4             | 0             |\r\n| SSE3         | NHWC        | 3.7 (270ms)  | 4             | 0             |\r\n\r\n**Batch Size: 32**\r\n\r\nCommand executed for the MKL test:\r\n\r\n```bash\r\npython tf_cnn_benchmarks.py --forward_only=True --device=cpu --mkl=True \\\r\n--kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\r\n--batch_size=32 --num_inter_threads=1 --num_intra_threads=4 \\\r\n--data_dir=<path to ImageNet TFRecords>\r\n```\r\n\r\n| Optimization | Data Format | Images/Sec    | Intra threads | Inter Threads |\r\n:              :             : (step time)   :               :               :\r\n| ------------ | ----------- | ------------- | ------------- | ------------- |\r\n| MKL          | NCHW        | 12.4          | 4             | 1             |\r\n:              :             : (2,590ms)     :               :               :\r\n| AVX2         | NHWC        | 10.4 (3,079ms)| 4             | 0             |\r\n| AVX          | NHWC        | 7.3 (4,4416ms)| 4             | 0             |\r\n| SSE3         | NHWC        | 4.0 (8,054ms) | 4             | 0             |\r\n"}