{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20590", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20590/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20590/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20590/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20590", "id": 338935131, "node_id": "MDU6SXNzdWUzMzg5MzUxMzE=", "number": 20590, "title": "Profiler: Check Failed tf_start", "user": {"login": "sleighsoft", "id": 9438971, "node_id": "MDQ6VXNlcjk0Mzg5NzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/9438971?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sleighsoft", "html_url": "https://github.com/sleighsoft", "followers_url": "https://api.github.com/users/sleighsoft/followers", "following_url": "https://api.github.com/users/sleighsoft/following{/other_user}", "gists_url": "https://api.github.com/users/sleighsoft/gists{/gist_id}", "starred_url": "https://api.github.com/users/sleighsoft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sleighsoft/subscriptions", "organizations_url": "https://api.github.com/users/sleighsoft/orgs", "repos_url": "https://api.github.com/users/sleighsoft/repos", "events_url": "https://api.github.com/users/sleighsoft/events{/privacy}", "received_events_url": "https://api.github.com/users/sleighsoft/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "angersson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angersson", "html_url": "https://github.com/angersson", "followers_url": "https://api.github.com/users/angersson/followers", "following_url": "https://api.github.com/users/angersson/following{/other_user}", "gists_url": "https://api.github.com/users/angersson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angersson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angersson/subscriptions", "organizations_url": "https://api.github.com/users/angersson/orgs", "repos_url": "https://api.github.com/users/angersson/repos", "events_url": "https://api.github.com/users/angersson/events{/privacy}", "received_events_url": "https://api.github.com/users/angersson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angersson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angersson", "html_url": "https://github.com/angersson", "followers_url": "https://api.github.com/users/angersson/followers", "following_url": "https://api.github.com/users/angersson/following{/other_user}", "gists_url": "https://api.github.com/users/angersson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angersson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angersson/subscriptions", "organizations_url": "https://api.github.com/users/angersson/orgs", "repos_url": "https://api.github.com/users/angersson/repos", "events_url": "https://api.github.com/users/angersson/events{/privacy}", "received_events_url": "https://api.github.com/users/angersson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-07-06T13:15:08Z", "updated_at": "2018-07-09T21:11:21Z", "closed_at": "2018-07-09T20:41:09Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Archlinux</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: pip tf-nightly</li>\n<li><strong>TensorFlow version (use command below)</strong>: v1.8.0-3463-g39ea5a7044 1.10.0-dev20180620</li>\n<li><strong>Python version</strong>: 3.6.5</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I am trying do some profiling as described here:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/profiler/g3doc/python_api.md\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/profiler/g3doc/python_api.md</a></p>\n<p>Session setup code</p>\n<div class=\"highlight highlight-source-python\"><pre>run_meta <span class=\"pl-k\">=</span> tf.RunMetadata()\nbuilder <span class=\"pl-k\">=</span> tf.profiler.ProfileOptionBuilder\n    opts <span class=\"pl-k\">=</span> builder(builder.time_and_memory()).order_by(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>micros<span class=\"pl-pds\">'</span></span>).build()\n    opts2 <span class=\"pl-k\">=</span> tf.profiler.ProfileOptionBuilder.trainable_variables_parameter()\n    <span class=\"pl-k\">with</span> tf.contrib.tfprof.ProfileContext(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>.tmp/trace<span class=\"pl-pds\">'</span></span>,\n                                      <span class=\"pl-v\">trace_steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">2</span>),\n                                      <span class=\"pl-v\">dump_steps</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">2</span>]) <span class=\"pl-k\">as</span> pctx:\n      pctx.add_auto_profiling(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>op<span class=\"pl-pds\">'</span></span>, opts, [<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">1</span>])\n      pctx.add_auto_profiling(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>scope<span class=\"pl-pds\">'</span></span>, opts2, [<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">1</span>])\n      <span class=\"pl-c1\">self</span>._session <span class=\"pl-k\">=</span> tf.Session(\n          <span class=\"pl-v\">target</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">graph</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._graph,\n          <span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>session_util.config_proto(\n              session_settings[<span class=\"pl-s\"><span class=\"pl-pds\">'</span>config_proto<span class=\"pl-pds\">'</span></span>],\n              session_settings[<span class=\"pl-s\"><span class=\"pl-pds\">'</span>gpu_options<span class=\"pl-pds\">'</span></span>]))\n    <span class=\"pl-c1\">self</span>.pctx <span class=\"pl-k\">=</span> pctx</pre></div>\n<p>Then at a different point in my code I do</p>\n<div class=\"highlight highlight-source-python\"><pre>loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._session.run(fetches, <span class=\"pl-c1\">...</span>, run_meta)</pre></div>\n<p>This works for the first step, but at the second step it throws <code>F tensorflow/core/profiler/internal/print_model_analysis.cc:125] Check failed: tf_stat</code></p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Archlinux\nTensorFlow installed from (source or binary): pip tf-nightly\nTensorFlow version (use command below): v1.8.0-3463-g39ea5a7044 1.10.0-dev20180620\nPython version: 3.6.5\n\nDescribe the problem\nI am trying do some profiling as described here:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/profiler/g3doc/python_api.md\nSession setup code\nrun_meta = tf.RunMetadata()\nbuilder = tf.profiler.ProfileOptionBuilder\n    opts = builder(builder.time_and_memory()).order_by('micros').build()\n    opts2 = tf.profiler.ProfileOptionBuilder.trainable_variables_parameter()\n    with tf.contrib.tfprof.ProfileContext('.tmp/trace',\n                                      trace_steps=range(0, 2),\n                                      dump_steps=[2]) as pctx:\n      pctx.add_auto_profiling('op', opts, [0, 1])\n      pctx.add_auto_profiling('scope', opts2, [0, 1])\n      self._session = tf.Session(\n          target='', graph=self._graph,\n          config=session_util.config_proto(\n              session_settings['config_proto'],\n              session_settings['gpu_options']))\n    self.pctx = pctx\nThen at a different point in my code I do\nloss = self._session.run(fetches, ..., run_meta)\nThis works for the first step, but at the second step it throws F tensorflow/core/profiler/internal/print_model_analysis.cc:125] Check failed: tf_stat", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Archlinux\r\n- **TensorFlow installed from (source or binary)**: pip tf-nightly\r\n- **TensorFlow version (use command below)**: v1.8.0-3463-g39ea5a7044 1.10.0-dev20180620\r\n- **Python version**: 3.6.5\r\n\r\n### Describe the problem\r\nI am trying do some profiling as described here:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/profiler/g3doc/python_api.md\r\n\r\nSession setup code\r\n```python\r\nrun_meta = tf.RunMetadata()\r\nbuilder = tf.profiler.ProfileOptionBuilder\r\n    opts = builder(builder.time_and_memory()).order_by('micros').build()\r\n    opts2 = tf.profiler.ProfileOptionBuilder.trainable_variables_parameter()\r\n    with tf.contrib.tfprof.ProfileContext('.tmp/trace',\r\n                                      trace_steps=range(0, 2),\r\n                                      dump_steps=[2]) as pctx:\r\n      pctx.add_auto_profiling('op', opts, [0, 1])\r\n      pctx.add_auto_profiling('scope', opts2, [0, 1])\r\n      self._session = tf.Session(\r\n          target='', graph=self._graph,\r\n          config=session_util.config_proto(\r\n              session_settings['config_proto'],\r\n              session_settings['gpu_options']))\r\n    self.pctx = pctx\r\n```\r\n\r\nThen at a different point in my code I do\r\n```python\r\nloss = self._session.run(fetches, ..., run_meta)\r\n```\r\n\r\nThis works for the first step, but at the second step it throws `F tensorflow/core/profiler/internal/print_model_analysis.cc:125] Check failed: tf_stat`"}