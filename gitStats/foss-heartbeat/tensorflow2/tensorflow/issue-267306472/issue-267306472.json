{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13868", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13868/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13868/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13868/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13868", "id": 267306472, "node_id": "MDU6SXNzdWUyNjczMDY0NzI=", "number": 13868, "title": "speech_commands svdf model does not work in android demo app.", "user": {"login": "icetortoise", "id": 670354, "node_id": "MDQ6VXNlcjY3MDM1NA==", "avatar_url": "https://avatars3.githubusercontent.com/u/670354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/icetortoise", "html_url": "https://github.com/icetortoise", "followers_url": "https://api.github.com/users/icetortoise/followers", "following_url": "https://api.github.com/users/icetortoise/following{/other_user}", "gists_url": "https://api.github.com/users/icetortoise/gists{/gist_id}", "starred_url": "https://api.github.com/users/icetortoise/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/icetortoise/subscriptions", "organizations_url": "https://api.github.com/users/icetortoise/orgs", "repos_url": "https://api.github.com/users/icetortoise/repos", "events_url": "https://api.github.com/users/icetortoise/events{/privacy}", "received_events_url": "https://api.github.com/users/icetortoise/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2017-10-20T21:12:26Z", "updated_at": "2018-09-28T21:26:14Z", "closed_at": "2018-09-28T21:26:14Z", "author_association": "NONE", "body_html": "<p>== cat /etc/issue ===============================================<br>\nMac OS X 10.12.6</p>\n<p>== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nApple LLVM version 9.0.0 (clang-900.0.37)<br>\nTarget: x86_64-apple-darwin16.7.0<br>\nThread model: posix<br>\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</p>\n<p>== uname -a =====================================================</p>\n<p>== check pips ===================================================<br>\nnumpy (1.13.3)<br>\nprotobuf (3.4.0)<br>\ntensorflow (1.3.0)<br>\ntensorflow-tensorboard (0.4.0rc1)</p>\n<p>== check for virtualenv =========================================<br>\nTrue</p>\n<p>== tensorflow import ============================================<br>\ntf.VERSION = 1.3.0<br>\ntf.GIT_VERSION = v1.3.0-rc1-3261-g934662e7b<br>\ntf.COMPILER_VERSION = v1.3.0-rc1-3261-g934662e7b<br>\nSanity check: array([1], dtype=int32)</p>\n<p>== env ==========================================================<br>\nLD_LIBRARY_PATH is unset<br>\nDYLD_LIBRARY_PATH is unset</p>\n<p>== nvidia-smi ===================================================<br>\n/var/tmp/collect.sh: line 105: nvidia-smi: command not found</p>\n<p>== cuda libs  ===================================================</p>\n<h3>Describe the problem</h3>\n<p>under tensorflow/examples/speech_commands, there are three models for speech commands. The<br>\ndefault one(conv) and low-latency-conv works when I install them to android demo app(tensorflow/examples/android).</p>\n<p>low-latency-svdf does not work in the android app, it works on pc though.</p>\n<p>If i copy the svdf model into the app, app crashes when startup reporting model file error like this:</p>\n<p><code>Not a valid TensorFlow Graph serialization: Value for attr 'T' of int64 is not in the list of allowed values: float, int32, qint8, quint8, qint32 ; NodeDef: count_nonzero/Sum = Sum[T=DT_INT64, Tidx=DT_INT32, keep_dims=false](count_nonzero/ToInt64, count_nonzero/Const); Op&lt;name=Sum; signature=input:T, reduction_indices:Tidx -&gt; output:T; attr=keep_dims:bool,default=false; attr=T:type,allowed=[DT_FLOAT, DT_INT32, DT_QINT8, DT_QUINT8, DT_QINT32]; attr=Tidx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]&gt;</code></p>\n<h3>Source code / logs</h3>\n<blockquote>\n<p>10-20 17:08:30.889 23598-23598/org.tensorflow.demo.svdf D/AndroidRuntime: Shutting down VM<br>\n10-20 17:08:30.894 23598-23598/org.tensorflow.demo.svdf E/AndroidRuntime: FATAL EXCEPTION: main<br>\nProcess: org.tensorflow.demo.svdf, PID: 23598<br>\njava.lang.RuntimeException: Unable to start activity ComponentInfo{org.tensorflow.demo.svdf/org.tensorflow.demo.SpeechActivity}: java.lang.RuntimeException: Failed to load model from 'file:///android_asset/marvin_sheila_ll_svdf_graph.pb'<br>\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2817)<br>\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)<br>\nat android.app.ActivityThread.-wrap11(Unknown Source:0)<br>\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)<br>\nat android.os.Handler.dispatchMessage(Handler.java:105)<br>\nat android.os.Looper.loop(Looper.java:164)<br>\nat android.app.ActivityThread.main(ActivityThread.java:6541)<br>\nat java.lang.reflect.Method.invoke(Native Method)<br>\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)<br>\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)<br>\nCaused by: java.lang.RuntimeException: Failed to load model from 'file:///android_asset/marvin_sheila_ll_svdf_graph.pb'<br>\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.(TensorFlowInferenceInterface.java:113)<br>\nat org.tensorflow.demo.SpeechActivity.onCreate(SpeechActivity.java:151)<br>\nat android.app.Activity.performCreate(Activity.java:6975)<br>\nat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1213)<br>\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2770)<br>\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)\u00a0<br>\nat android.app.ActivityThread.-wrap11(Unknown Source:0)\u00a0<br>\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)\u00a0<br>\nat android.os.Handler.dispatchMessage(Handler.java:105)\u00a0<br>\nat android.os.Looper.loop(Looper.java:164)\u00a0<br>\nat android.app.ActivityThread.main(ActivityThread.java:6541)\u00a0<br>\nat java.lang.reflect.Method.invoke(Native Method)\u00a0<br>\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\u00a0<br>\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\u00a0<br>\nCaused by: java.io.IOException: Not a valid TensorFlow Graph serialization: Value for attr 'T' of int64 is not in the list of allowed values: float, int32, qint8, quint8, qint32<br>\n; NodeDef: count_nonzero/Sum = Sum[T=DT_INT64, Tidx=DT_INT32, keep_dims=false](count_nonzero/ToInt64, count_nonzero/Const); Op&lt;name=Sum; signature=input:T, reduction_indices:Tidx -&gt; output:T; attr=keep_dims:bool,default=false; attr=T:type,allowed=[DT_FLOAT, DT_INT32, DT_QINT8, DT_QUINT8, DT_QINT32]; attr=Tidx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]&gt;<br>\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.loadGraph(TensorFlowInferenceInterface.java:535)<br>\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.(TensorFlowInferenceInterface.java:105)<br>\n... 13 more</p>\n</blockquote>", "body_text": "== cat /etc/issue ===============================================\nMac OS X 10.12.6\n== are we in docker =============================================\nNo\n== compiler =====================================================\nApple LLVM version 9.0.0 (clang-900.0.37)\nTarget: x86_64-apple-darwin16.7.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n== uname -a =====================================================\n== check pips ===================================================\nnumpy (1.13.3)\nprotobuf (3.4.0)\ntensorflow (1.3.0)\ntensorflow-tensorboard (0.4.0rc1)\n== check for virtualenv =========================================\nTrue\n== tensorflow import ============================================\ntf.VERSION = 1.3.0\ntf.GIT_VERSION = v1.3.0-rc1-3261-g934662e7b\ntf.COMPILER_VERSION = v1.3.0-rc1-3261-g934662e7b\nSanity check: array([1], dtype=int32)\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n== nvidia-smi ===================================================\n/var/tmp/collect.sh: line 105: nvidia-smi: command not found\n== cuda libs  ===================================================\nDescribe the problem\nunder tensorflow/examples/speech_commands, there are three models for speech commands. The\ndefault one(conv) and low-latency-conv works when I install them to android demo app(tensorflow/examples/android).\nlow-latency-svdf does not work in the android app, it works on pc though.\nIf i copy the svdf model into the app, app crashes when startup reporting model file error like this:\nNot a valid TensorFlow Graph serialization: Value for attr 'T' of int64 is not in the list of allowed values: float, int32, qint8, quint8, qint32 ; NodeDef: count_nonzero/Sum = Sum[T=DT_INT64, Tidx=DT_INT32, keep_dims=false](count_nonzero/ToInt64, count_nonzero/Const); Op<name=Sum; signature=input:T, reduction_indices:Tidx -> output:T; attr=keep_dims:bool,default=false; attr=T:type,allowed=[DT_FLOAT, DT_INT32, DT_QINT8, DT_QUINT8, DT_QINT32]; attr=Tidx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]>\nSource code / logs\n\n10-20 17:08:30.889 23598-23598/org.tensorflow.demo.svdf D/AndroidRuntime: Shutting down VM\n10-20 17:08:30.894 23598-23598/org.tensorflow.demo.svdf E/AndroidRuntime: FATAL EXCEPTION: main\nProcess: org.tensorflow.demo.svdf, PID: 23598\njava.lang.RuntimeException: Unable to start activity ComponentInfo{org.tensorflow.demo.svdf/org.tensorflow.demo.SpeechActivity}: java.lang.RuntimeException: Failed to load model from 'file:///android_asset/marvin_sheila_ll_svdf_graph.pb'\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2817)\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)\nat android.app.ActivityThread.-wrap11(Unknown Source:0)\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)\nat android.os.Handler.dispatchMessage(Handler.java:105)\nat android.os.Looper.loop(Looper.java:164)\nat android.app.ActivityThread.main(ActivityThread.java:6541)\nat java.lang.reflect.Method.invoke(Native Method)\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\nCaused by: java.lang.RuntimeException: Failed to load model from 'file:///android_asset/marvin_sheila_ll_svdf_graph.pb'\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.(TensorFlowInferenceInterface.java:113)\nat org.tensorflow.demo.SpeechActivity.onCreate(SpeechActivity.java:151)\nat android.app.Activity.performCreate(Activity.java:6975)\nat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1213)\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2770)\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)\u00a0\nat android.app.ActivityThread.-wrap11(Unknown Source:0)\u00a0\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)\u00a0\nat android.os.Handler.dispatchMessage(Handler.java:105)\u00a0\nat android.os.Looper.loop(Looper.java:164)\u00a0\nat android.app.ActivityThread.main(ActivityThread.java:6541)\u00a0\nat java.lang.reflect.Method.invoke(Native Method)\u00a0\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\u00a0\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\u00a0\nCaused by: java.io.IOException: Not a valid TensorFlow Graph serialization: Value for attr 'T' of int64 is not in the list of allowed values: float, int32, qint8, quint8, qint32\n; NodeDef: count_nonzero/Sum = Sum[T=DT_INT64, Tidx=DT_INT32, keep_dims=false](count_nonzero/ToInt64, count_nonzero/Const); Op<name=Sum; signature=input:T, reduction_indices:Tidx -> output:T; attr=keep_dims:bool,default=false; attr=T:type,allowed=[DT_FLOAT, DT_INT32, DT_QINT8, DT_QUINT8, DT_QINT32]; attr=Tidx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]>\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.loadGraph(TensorFlowInferenceInterface.java:535)\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.(TensorFlowInferenceInterface.java:105)\n... 13 more", "body": "== cat /etc/issue ===============================================\r\nMac OS X 10.12.6\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nApple LLVM version 9.0.0 (clang-900.0.37)\r\nTarget: x86_64-apple-darwin16.7.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n\r\n== uname -a =====================================================\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.3)\r\nprotobuf (3.4.0)\r\ntensorflow (1.3.0)\r\ntensorflow-tensorboard (0.4.0rc1)\r\n\r\n== check for virtualenv =========================================\r\nTrue\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.3.0\r\ntf.GIT_VERSION = v1.3.0-rc1-3261-g934662e7b\r\ntf.COMPILER_VERSION = v1.3.0-rc1-3261-g934662e7b\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n/var/tmp/collect.sh: line 105: nvidia-smi: command not found\r\n\r\n== cuda libs  ===================================================\r\n\r\n\r\n### Describe the problem\r\nunder tensorflow/examples/speech_commands, there are three models for speech commands. The \r\ndefault one(conv) and low-latency-conv works when I install them to android demo app(tensorflow/examples/android). \r\n\r\nlow-latency-svdf does not work in the android app, it works on pc though.\r\n\r\nIf i copy the svdf model into the app, app crashes when startup reporting model file error like this:\r\n\r\n`Not a valid TensorFlow Graph serialization: Value for attr 'T' of int64 is not in the list of allowed values: float, int32, qint8, quint8, qint32\r\n; NodeDef: count_nonzero/Sum = Sum[T=DT_INT64, Tidx=DT_INT32, keep_dims=false](count_nonzero/ToInt64, count_nonzero/Const); Op<name=Sum; signature=input:T, reduction_indices:Tidx -> output:T; attr=keep_dims:bool,default=false; attr=T:type,allowed=[DT_FLOAT, DT_INT32, DT_QINT8, DT_QUINT8, DT_QINT32]; attr=Tidx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]>`\r\n\r\n### Source code / logs\r\n\r\n> 10-20 17:08:30.889 23598-23598/org.tensorflow.demo.svdf D/AndroidRuntime: Shutting down VM\r\n10-20 17:08:30.894 23598-23598/org.tensorflow.demo.svdf E/AndroidRuntime: FATAL EXCEPTION: main\r\n                                                                          Process: org.tensorflow.demo.svdf, PID: 23598\r\n                                                                          java.lang.RuntimeException: Unable to start activity ComponentInfo{org.tensorflow.demo.svdf/org.tensorflow.demo.SpeechActivity}: java.lang.RuntimeException: Failed to load model from 'file:///android_asset/marvin_sheila_ll_svdf_graph.pb'\r\n                                                                              at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2817)\r\n                                                                              at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)\r\n                                                                              at android.app.ActivityThread.-wrap11(Unknown Source:0)\r\n                                                                              at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)\r\n                                                                              at android.os.Handler.dispatchMessage(Handler.java:105)\r\n                                                                              at android.os.Looper.loop(Looper.java:164)\r\n                                                                              at android.app.ActivityThread.main(ActivityThread.java:6541)\r\n                                                                              at java.lang.reflect.Method.invoke(Native Method)\r\n                                                                              at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\r\n                                                                              at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\r\n                                                                           Caused by: java.lang.RuntimeException: Failed to load model from 'file:///android_asset/marvin_sheila_ll_svdf_graph.pb'\r\n                                                                              at org.tensorflow.contrib.android.TensorFlowInferenceInterface.<init>(TensorFlowInferenceInterface.java:113)\r\n                                                                              at org.tensorflow.demo.SpeechActivity.onCreate(SpeechActivity.java:151)\r\n                                                                              at android.app.Activity.performCreate(Activity.java:6975)\r\n                                                                              at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1213)\r\n                                                                              at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2770)\r\n                                                                              at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)\u00a0\r\n                                                                              at android.app.ActivityThread.-wrap11(Unknown Source:0)\u00a0\r\n                                                                              at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)\u00a0\r\n                                                                              at android.os.Handler.dispatchMessage(Handler.java:105)\u00a0\r\n                                                                              at android.os.Looper.loop(Looper.java:164)\u00a0\r\n                                                                              at android.app.ActivityThread.main(ActivityThread.java:6541)\u00a0\r\n                                                                              at java.lang.reflect.Method.invoke(Native Method)\u00a0\r\n                                                                              at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\u00a0\r\n                                                                              at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\u00a0\r\n                                                                           Caused by: java.io.IOException: Not a valid TensorFlow Graph serialization: Value for attr 'T' of int64 is not in the list of allowed values: float, int32, qint8, quint8, qint32\r\n                                                                          \t; NodeDef: count_nonzero/Sum = Sum[T=DT_INT64, Tidx=DT_INT32, keep_dims=false](count_nonzero/ToInt64, count_nonzero/Const); Op<name=Sum; signature=input:T, reduction_indices:Tidx -> output:T; attr=keep_dims:bool,default=false; attr=T:type,allowed=[DT_FLOAT, DT_INT32, DT_QINT8, DT_QUINT8, DT_QINT32]; attr=Tidx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]>\r\n                                                                              at org.tensorflow.contrib.android.TensorFlowInferenceInterface.loadGraph(TensorFlowInferenceInterface.java:535)\r\n                                                                              at org.tensorflow.contrib.android.TensorFlowInferenceInterface.<init>(TensorFlowInferenceInterface.java:105)\r\n                                                                              \t... 13 more\r\n"}