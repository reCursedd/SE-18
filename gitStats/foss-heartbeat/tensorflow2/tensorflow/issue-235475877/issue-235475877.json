{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10669", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10669/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10669/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10669/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10669", "id": 235475877, "node_id": "MDU6SXNzdWUyMzU0NzU4Nzc=", "number": 10669, "title": "Running session using c++ api is significantly slower than using python", "user": {"login": "July-Morning", "id": 26812149, "node_id": "MDQ6VXNlcjI2ODEyMTQ5", "avatar_url": "https://avatars1.githubusercontent.com/u/26812149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/July-Morning", "html_url": "https://github.com/July-Morning", "followers_url": "https://api.github.com/users/July-Morning/followers", "following_url": "https://api.github.com/users/July-Morning/following{/other_user}", "gists_url": "https://api.github.com/users/July-Morning/gists{/gist_id}", "starred_url": "https://api.github.com/users/July-Morning/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/July-Morning/subscriptions", "organizations_url": "https://api.github.com/users/July-Morning/orgs", "repos_url": "https://api.github.com/users/July-Morning/repos", "events_url": "https://api.github.com/users/July-Morning/events{/privacy}", "received_events_url": "https://api.github.com/users/July-Morning/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 43, "created_at": "2017-06-13T08:32:48Z", "updated_at": "2018-06-12T06:49:33Z", "closed_at": "2017-08-23T11:35:10Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>OS Platform and Distribution</strong>: Linux 13.1 (Bottle)</li>\n<li><strong>TensorFlow installed from</strong>: source</li>\n<li><strong>TensorFlow version</strong>: 1.1.0 (git version: v1.1.0-1-g10ec24a, compiler version: v1.1.0-1-g10ec24a)</li>\n<li><strong>Compiler</strong>: c++ (SUSE Linux) 4.8.1 20130909 [gcc-4_8-branch revision 202388]</li>\n<li><strong>Bazel version</strong>: 0.4.5</li>\n<li><strong>Packages</strong>: numpy (1.11.3), numpydoc (0.6.0), protobuf (3.1.0)</li>\n</ul>\n<p>No docker, no virtual environment.<br>\nAll tests were done using CPU only.<br>\nAll optimization flags are set, no warnings are shown.<br>\ntcmalloc is also used.<br>\nBatching also helps to increase the performance both for c++ and python, but the gap stays the same.</p>\n<h3>Describe the problem</h3>\n<p>I have written a simple benchmark based on official Deep MNIST example (<a href=\"https://www.tensorflow.org/get_started/mnist/pros\" rel=\"nofollow\">https://www.tensorflow.org/get_started/mnist/pros</a>). I create a simple convolutional net, train it on MNIST (number of training steps is small as we are interested in speed, not accuracy), freeze the graph and load it to c++. Then I do tests using python and using c++ and measure average time that it takes to run a tensorflow session. My tests show that running session in python takes ~2ms, while doing the same using c++ api is slower: ~3ms.<br>\nThe code of the benchmark can be found here:<br>\n<a href=\"https://github.com/July-Morning/MNIST_convnet_tensorflow\">https://github.com/July-Morning/MNIST_convnet_tensorflow</a><br>\nIt should also be mentioned that the same tests were done for the multilayer perceptron. In that case c++ api was significantly (~7-10x times) faster than python just as was expected.</p>", "body_text": "System information\n\nOS Platform and Distribution: Linux 13.1 (Bottle)\nTensorFlow installed from: source\nTensorFlow version: 1.1.0 (git version: v1.1.0-1-g10ec24a, compiler version: v1.1.0-1-g10ec24a)\nCompiler: c++ (SUSE Linux) 4.8.1 20130909 [gcc-4_8-branch revision 202388]\nBazel version: 0.4.5\nPackages: numpy (1.11.3), numpydoc (0.6.0), protobuf (3.1.0)\n\nNo docker, no virtual environment.\nAll tests were done using CPU only.\nAll optimization flags are set, no warnings are shown.\ntcmalloc is also used.\nBatching also helps to increase the performance both for c++ and python, but the gap stays the same.\nDescribe the problem\nI have written a simple benchmark based on official Deep MNIST example (https://www.tensorflow.org/get_started/mnist/pros). I create a simple convolutional net, train it on MNIST (number of training steps is small as we are interested in speed, not accuracy), freeze the graph and load it to c++. Then I do tests using python and using c++ and measure average time that it takes to run a tensorflow session. My tests show that running session in python takes ~2ms, while doing the same using c++ api is slower: ~3ms.\nThe code of the benchmark can be found here:\nhttps://github.com/July-Morning/MNIST_convnet_tensorflow\nIt should also be mentioned that the same tests were done for the multilayer perceptron. In that case c++ api was significantly (~7-10x times) faster than python just as was expected.", "body": "### System information\r\n- **OS Platform and Distribution**: Linux 13.1 (Bottle)\r\n- **TensorFlow installed from**: source\r\n- **TensorFlow version**: 1.1.0 (git version: v1.1.0-1-g10ec24a, compiler version: v1.1.0-1-g10ec24a)\r\n- **Compiler**: c++ (SUSE Linux) 4.8.1 20130909 [gcc-4_8-branch revision 202388]\r\n- **Bazel version**: 0.4.5\r\n- **Packages**: numpy (1.11.3), numpydoc (0.6.0), protobuf (3.1.0)\r\n\r\nNo docker, no virtual environment.\r\nAll tests were done using CPU only. \r\nAll optimization flags are set, no warnings are shown.\r\ntcmalloc is also used.\r\nBatching also helps to increase the performance both for c++ and python, but the gap stays the same.\r\n\r\n### Describe the problem\r\nI have written a simple benchmark based on official Deep MNIST example (https://www.tensorflow.org/get_started/mnist/pros). I create a simple convolutional net, train it on MNIST (number of training steps is small as we are interested in speed, not accuracy), freeze the graph and load it to c++. Then I do tests using python and using c++ and measure average time that it takes to run a tensorflow session. My tests show that running session in python takes ~2ms, while doing the same using c++ api is slower: ~3ms.\r\nThe code of the benchmark can be found here:\r\nhttps://github.com/July-Morning/MNIST_convnet_tensorflow\r\nIt should also be mentioned that the same tests were done for the multilayer perceptron. In that case c++ api was significantly (~7-10x times) faster than python just as was expected."}