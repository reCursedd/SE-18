{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19564", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19564/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19564/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19564/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19564", "id": 326692818, "node_id": "MDU6SXNzdWUzMjY2OTI4MTg=", "number": 19564, "title": "Building TF from the source: compilation error with enabling AVX512 (Eigen/src/Core/arch/AVX512/PacketMath.h)", "user": {"login": "peng2007", "id": 13994637, "node_id": "MDQ6VXNlcjEzOTk0NjM3", "avatar_url": "https://avatars1.githubusercontent.com/u/13994637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peng2007", "html_url": "https://github.com/peng2007", "followers_url": "https://api.github.com/users/peng2007/followers", "following_url": "https://api.github.com/users/peng2007/following{/other_user}", "gists_url": "https://api.github.com/users/peng2007/gists{/gist_id}", "starred_url": "https://api.github.com/users/peng2007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peng2007/subscriptions", "organizations_url": "https://api.github.com/users/peng2007/orgs", "repos_url": "https://api.github.com/users/peng2007/repos", "events_url": "https://api.github.com/users/peng2007/events{/privacy}", "received_events_url": "https://api.github.com/users/peng2007/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "jart", "id": 49262, "node_id": "MDQ6VXNlcjQ5MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/49262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jart", "html_url": "https://github.com/jart", "followers_url": "https://api.github.com/users/jart/followers", "following_url": "https://api.github.com/users/jart/following{/other_user}", "gists_url": "https://api.github.com/users/jart/gists{/gist_id}", "starred_url": "https://api.github.com/users/jart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jart/subscriptions", "organizations_url": "https://api.github.com/users/jart/orgs", "repos_url": "https://api.github.com/users/jart/repos", "events_url": "https://api.github.com/users/jart/events{/privacy}", "received_events_url": "https://api.github.com/users/jart/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jart", "id": 49262, "node_id": "MDQ6VXNlcjQ5MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/49262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jart", "html_url": "https://github.com/jart", "followers_url": "https://api.github.com/users/jart/followers", "following_url": "https://api.github.com/users/jart/following{/other_user}", "gists_url": "https://api.github.com/users/jart/gists{/gist_id}", "starred_url": "https://api.github.com/users/jart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jart/subscriptions", "organizations_url": "https://api.github.com/users/jart/orgs", "repos_url": "https://api.github.com/users/jart/repos", "events_url": "https://api.github.com/users/jart/events{/privacy}", "received_events_url": "https://api.github.com/users/jart/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-05-26T00:03:48Z", "updated_at": "2018-11-14T19:19:18Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nNo.</li>\n</ul>\n<p>-**OS Platform and Distribution<br>\nLinux Ubuntu 16.04:</p>\n<p>-**CPU info<br>\nIntel(R) Xeon(R) Gold 5118 CPU</p>\n<p>-**TensorFlow master branch commit-id:<br>\ncommit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/38926b8a0fa89bef74085be0e321c13e739795d4/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/38926b8a0fa89bef74085be0e321c13e739795d4\"><tt>38926b8</tt></a><br>\nMerge: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/00aa1d357d4f25dbf5580836cf5cd13f2d85819e/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/00aa1d357d4f25dbf5580836cf5cd13f2d85819e\"><tt>00aa1d3</tt></a> <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/2457cae17047dc35479e02fd937d842bc691cecb/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/2457cae17047dc35479e02fd937d842bc691cecb\"><tt>2457cae</tt></a></p>\n<ul>\n<li>\n<p><strong>Python version</strong>:<br>\npython2.7</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>:<br>\nBuild label: 0.12.0</p>\n</li>\n<li>\n<p><strong>GCC/Compiler version (if compiling from source)</strong>:<br>\ngcc version 6.4.0 20180424 (Ubuntu 6.4.0-17ubuntu1~16.04)</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:<br>\nCUDA 9. 2 / cuDNN 7.1</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\nNVIDIA Quadro P2000, 5G DDR Mem.</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:</p>\n</li>\n</ul>\n<p>bazel build --jobs 48 --config=mkl -c opt --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-mavx512f --copt=-mavx512pf --copt=-mavx512cd --copt=-mavx512er --copt=\"-DEIGEN_USE_VML\" --copt \"-DEIGEN_ENABLE_AVX512\" --copt \"-DEIGEN_ENABLE_AVX2\" //tensorflow/tools/pip_package:build_pip_package</p>\n<p>ERROR: tensorflow/tensorflow/core/kernels/BUILD:3446:1: C++ compilation of rule '//tensorflow/core/kernels:bincount_op' failed (Exit 1)<br>\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:400:0,<br>\nfrom external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,<br>\nfrom ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,<br>\nfrom ./tensorflow/core/kernels/bincount_op.h:19,<br>\nfrom tensorflow/core/kernels/bincount_op.cc:20:<br>\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h: In function 'typename Eigen::internal::unpacket_traits::type Eigen::internal::predux(const Packet&amp;) [with Packet = __vector(16) float]':<br>\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:866:1: error: unrecognizable insn:<br>\n}<br>\n^<br>\n(insn 12 11 13 2 (set (mem/c:V4SF (plus:DI (reg/f:DI 82 virtual-stack-vars)<br>\n(const_int -320 [0xfffffffffffffec0])) [5 lane0+0 S16 A128])<br>\n(vec_merge:V4SF (vec_select:V4SF (reg:V16SF 87 [ _4 ])<br>\n(parallel [<br>\n(const_int 0 [0])<br>\n(const_int 1 [0x1])<br>\n(const_int 2 [0x2])<br>\n(const_int 3 [0x3])<br>\n]))<br>\n(reg:V4SF 102 [ D.798038 ])<br>\n(reg:QI 105))) external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:857 -1<br>\n(nil))<br>\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:866:1: internal compiler error: in extract_insn, at recog.c:2287<br>\nPlease submit a full bug report,</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNo.\n\n-**OS Platform and Distribution\nLinux Ubuntu 16.04:\n-**CPU info\nIntel(R) Xeon(R) Gold 5118 CPU\n-**TensorFlow master branch commit-id:\ncommit 38926b8\nMerge: 00aa1d3 2457cae\n\n\nPython version:\npython2.7\n\n\nBazel version (if compiling from source):\nBuild label: 0.12.0\n\n\nGCC/Compiler version (if compiling from source):\ngcc version 6.4.0 20180424 (Ubuntu 6.4.0-17ubuntu1~16.04)\n\n\nCUDA/cuDNN version:\nCUDA 9. 2 / cuDNN 7.1\n\n\nGPU model and memory:\nNVIDIA Quadro P2000, 5G DDR Mem.\n\n\nExact command to reproduce:\n\n\nbazel build --jobs 48 --config=mkl -c opt --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-mavx512f --copt=-mavx512pf --copt=-mavx512cd --copt=-mavx512er --copt=\"-DEIGEN_USE_VML\" --copt \"-DEIGEN_ENABLE_AVX512\" --copt \"-DEIGEN_ENABLE_AVX2\" //tensorflow/tools/pip_package:build_pip_package\nERROR: tensorflow/tensorflow/core/kernels/BUILD:3446:1: C++ compilation of rule '//tensorflow/core/kernels:bincount_op' failed (Exit 1)\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:400:0,\nfrom external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,\nfrom ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,\nfrom ./tensorflow/core/kernels/bincount_op.h:19,\nfrom tensorflow/core/kernels/bincount_op.cc:20:\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h: In function 'typename Eigen::internal::unpacket_traits::type Eigen::internal::predux(const Packet&) [with Packet = __vector(16) float]':\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:866:1: error: unrecognizable insn:\n}\n^\n(insn 12 11 13 2 (set (mem/c:V4SF (plus:DI (reg/f:DI 82 virtual-stack-vars)\n(const_int -320 [0xfffffffffffffec0])) [5 lane0+0 S16 A128])\n(vec_merge:V4SF (vec_select:V4SF (reg:V16SF 87 [ _4 ])\n(parallel [\n(const_int 0 [0])\n(const_int 1 [0x1])\n(const_int 2 [0x2])\n(const_int 3 [0x3])\n]))\n(reg:V4SF 102 [ D.798038 ])\n(reg:QI 105))) external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:857 -1\n(nil))\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:866:1: internal compiler error: in extract_insn, at recog.c:2287\nPlease submit a full bug report,", "body": "### System information\r\n\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo.\r\n\r\n-**OS Platform and Distribution \r\nLinux Ubuntu 16.04:\r\n\r\n-**CPU info\r\nIntel(R) Xeon(R) Gold 5118 CPU\r\n\r\n-**TensorFlow master branch commit-id:\r\ncommit 38926b8a0fa89bef74085be0e321c13e739795d4\r\nMerge: 00aa1d3 2457cae\r\n\r\n- **Python version**: \r\npython2.7\r\n\r\n- **Bazel version (if compiling from source)**:\r\nBuild label: 0.12.0\r\n\r\n- **GCC/Compiler version (if compiling from source)**:\r\ngcc version 6.4.0 20180424 (Ubuntu 6.4.0-17ubuntu1~16.04)\r\n\r\n- **CUDA/cuDNN version**:\r\nCUDA 9. 2 / cuDNN 7.1\r\n\r\n- **GPU model and memory**:\r\nNVIDIA Quadro P2000, 5G DDR Mem.\r\n\r\n- **Exact command to reproduce**:\r\n\r\nbazel build --jobs 48 --config=mkl -c opt --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-mavx512f --copt=-mavx512pf --copt=-mavx512cd --copt=-mavx512er --copt=\"-DEIGEN_USE_VML\" --copt \"-DEIGEN_ENABLE_AVX512\" --copt \"-DEIGEN_ENABLE_AVX2\" //tensorflow/tools/pip_package:build_pip_package\r\n\r\n\r\n\r\nERROR: tensorflow/tensorflow/core/kernels/BUILD:3446:1: C++ compilation of rule '//tensorflow/core/kernels:bincount_op' failed (Exit 1)\r\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:400:0,\r\n                 from external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,\r\n                 from ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,\r\n                 from ./tensorflow/core/kernels/bincount_op.h:19,\r\n                 from tensorflow/core/kernels/bincount_op.cc:20:\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h: In function 'typename Eigen::internal::unpacket_traits<T>::type Eigen::internal::predux(const Packet&) [with Packet = __vector(16) float]':\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:866:1: error: unrecognizable insn:\r\n }\r\n ^\r\n(insn 12 11 13 2 (set (mem/c:V4SF (plus:DI (reg/f:DI 82 virtual-stack-vars)\r\n                (const_int -320 [0xfffffffffffffec0])) [5 lane0+0 S16 A128])\r\n        (vec_merge:V4SF (vec_select:V4SF (reg:V16SF 87 [ _4 ])\r\n                (parallel [\r\n                        (const_int 0 [0])\r\n                        (const_int 1 [0x1])\r\n                        (const_int 2 [0x2])\r\n                        (const_int 3 [0x3])\r\n                    ]))\r\n            (reg:V4SF 102 [ D.798038 ])\r\n            (reg:QI 105))) external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:857 -1\r\n     (nil))\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/AVX512/PacketMath.h:866:1: internal compiler error: in extract_insn, at recog.c:2287\r\nPlease submit a full bug report,\r\n"}