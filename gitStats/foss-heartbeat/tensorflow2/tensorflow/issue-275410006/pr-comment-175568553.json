{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/175568553", "pull_request_review_id": 105119536, "id": 175568553, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3NTU2ODU1Mw==", "diff_hunk": "@@ -47,6 +48,38 @@ Status SoftmaxGrad(const Scope& scope, const Operation& op,\n }\n REGISTER_GRADIENT_OP(\"Softmax\", SoftmaxGrad);\n \n+Status SoftmaxCrossEntropyWithLogitsGrad(const Scope& scope,\n+                                          const Operation& op,\n+                                          const std::vector<Output>&\n+                                          grad_inputs,\n+                                          std::vector<Output>* grad_outputs) {\n+  // Softmax gradient with cross entropy logits function\n+  // We multiply the backprop for cost with the gradients - op.output[1]\n+  // There is no gradient for labels\n+\n+  auto softmaxGrad = op.output(1);\n+  auto gradLoss = grad_inputs[0];\n+  auto gradGrad = grad_inputs[1];\n+\n+  auto tempGrad = Mul(scope, gradLoss, softmaxGrad);\n+\n+  // TODO: Check if this sufficient, need a check for null ?\n+  if (gradGrad.op().output_type(0) != 0) {\n+\t  auto logits = op.input(0);\n+\t  auto softmax = ops::Softmax(scope, logits);\n+\t  auto prod = ops::MatMul(scope, gradGrad, softmax);\n+\t  auto squeezeProd = ops::Squeeze(scope, prod);\n+\t  auto fProd = Sub(scope, gradGrad, squeezeProd);\n+\t  auto grad = Add(scope, tempGrad, fProd);\n+\t  grad_outputs->push_back(grad);\n+\t  grad_outputs->push_back(NoGradient());", "path": "tensorflow/cc/gradients/nn_grad.cc", "position": null, "original_position": 36, "commit_id": "4d98d2b592b7990968be33e10064d06ca35f40c9", "original_commit_id": "ace35ecca311c15724584b80b2cf0a35cbfd7eb6", "user": {"login": "pbanavara", "id": 600054, "node_id": "MDQ6VXNlcjYwMDA1NA==", "avatar_url": "https://avatars3.githubusercontent.com/u/600054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pbanavara", "html_url": "https://github.com/pbanavara", "followers_url": "https://api.github.com/users/pbanavara/followers", "following_url": "https://api.github.com/users/pbanavara/following{/other_user}", "gists_url": "https://api.github.com/users/pbanavara/gists{/gist_id}", "starred_url": "https://api.github.com/users/pbanavara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pbanavara/subscriptions", "organizations_url": "https://api.github.com/users/pbanavara/orgs", "repos_url": "https://api.github.com/users/pbanavara/repos", "events_url": "https://api.github.com/users/pbanavara/events{/privacy}", "received_events_url": "https://api.github.com/users/pbanavara/received_events", "type": "User", "site_admin": false}, "body": "Cool. Yeah I saw these as well, but couldn't understand or make out what these tests were accomplishing. So, I'm in some sort of limbo now. I'll see how to resolve this.If I'm not able to, I'll cancel the PR. Perhaps more knowledgable people can pick up and work on this. I really feel bad for stalling this PR for more than 6 months. ", "created_at": "2018-03-19T20:08:55Z", "updated_at": "2018-07-12T20:46:26Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/14727#discussion_r175568553", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/14727", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/175568553"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/14727#discussion_r175568553"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/14727"}}, "body_html": "<p>Cool. Yeah I saw these as well, but couldn't understand or make out what these tests were accomplishing. So, I'm in some sort of limbo now. I'll see how to resolve this.If I'm not able to, I'll cancel the PR. Perhaps more knowledgable people can pick up and work on this. I really feel bad for stalling this PR for more than 6 months.</p>", "body_text": "Cool. Yeah I saw these as well, but couldn't understand or make out what these tests were accomplishing. So, I'm in some sort of limbo now. I'll see how to resolve this.If I'm not able to, I'll cancel the PR. Perhaps more knowledgable people can pick up and work on this. I really feel bad for stalling this PR for more than 6 months.", "in_reply_to_id": 170222650}