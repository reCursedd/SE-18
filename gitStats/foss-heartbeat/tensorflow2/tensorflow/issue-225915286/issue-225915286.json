{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9620", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9620/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9620/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9620/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9620", "id": 225915286, "node_id": "MDU6SXNzdWUyMjU5MTUyODY=", "number": 9620, "title": "inception/imagenet_distributed_train running is faild", "user": {"login": "bkovalev", "id": 22419555, "node_id": "MDQ6VXNlcjIyNDE5NTU1", "avatar_url": "https://avatars0.githubusercontent.com/u/22419555?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bkovalev", "html_url": "https://github.com/bkovalev", "followers_url": "https://api.github.com/users/bkovalev/followers", "following_url": "https://api.github.com/users/bkovalev/following{/other_user}", "gists_url": "https://api.github.com/users/bkovalev/gists{/gist_id}", "starred_url": "https://api.github.com/users/bkovalev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bkovalev/subscriptions", "organizations_url": "https://api.github.com/users/bkovalev/orgs", "repos_url": "https://api.github.com/users/bkovalev/repos", "events_url": "https://api.github.com/users/bkovalev/events{/privacy}", "received_events_url": "https://api.github.com/users/bkovalev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-05-03T08:32:04Z", "updated_at": "2017-10-07T01:01:29Z", "closed_at": "2017-10-07T01:01:14Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Not - Use last TF master and last Models</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:   Ubuntu 16.04</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>: from source ( dramatically less compilation number of files, less in 100 files.)</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>: 'v1.1.0-rc2-607-g550df41', '1.1.0-rc2'</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>: 0.4.5</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>: 8.0, 6</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>: Nvidia P100 PCI - 16 GB</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:<br>\nOn ps - bazel-bin/inception/imagenet_distributed_train --job_name='ps' --task_id=0 --ps_hosts='11.11.11.31:2222' --worker_hosts='11.11.11.41:2222,11.11.11.41:2223'</p>\n</li>\n</ul>\n<p>All good</p>\n<p>INFO:tensorflow:PS hosts are: ['11.11.11.31:2222']<br>\nINFO:tensorflow:Worker hosts are: ['11.11.11.41:2222', '11.11.11.41:2223']<br>\n2017-05-03 11:12:54.447399: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; localhost:2222}<br>\n2017-05-03 11:12:54.447459: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; 11.11.11.41:2222, 1 -&gt; 11.11.11.41:2223}<br>\n2017-05-03 11:12:54.456646: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:296] Started server with target: grpc://localhost:2222</p>\n<h3>Describe the problem</h3>\n<p>On Worker</p>\n<p>CUDA_VISIBLE_DEVICES='1' bazel-bin/inception/imagenet_distributed_train --batch_size=128 --job_name='worker' --ps_hosts='11.11.11.31:2222' --worker_hosts='11.11.11.41:2222,11.11.11.41:2223' --data_dir=/data/imagenet_data/ --train_dir=/data/imagenet_train/ --task_id=1</p>\n<p>It's failed with<br>\nINFO:tensorflow:PS hosts are: ['11.11.11.31:2222']<br>\nINFO:tensorflow:Worker hosts are: ['11.11.11.41:2222', '11.11.11.41:2223']<br>\n2017-05-03 11:24:17.640127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; 11.11.11.31:2222}<br>\n2017-05-03 11:24:17.640169: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; 11.11.11.41:2222, 1 -&gt; localhost:2223}<br>\n2017-05-03 11:24:17.648767: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:296] Started server with target: grpc://localhost:2223<br>\nTraceback (most recent call last):<br>\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/imagenet_distributed_train.py\", line 66, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/imagenet_distributed_train.py\", line 62, in main<br>\ninception_distributed_train.train(server.target, dataset, cluster_spec)<br>\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/inception_distributed_train.py\", line 157, in train<br>\ninception.loss(logits, labels)<br>\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/inception_model.py\", line 128, in loss<br>\nweight=1.0)<br>\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/slim/losses.py\", line 166, in cross_entropy_loss<br>\ncross_entropy = tf.contrib.nn.deprecated_flipped_softmax_cross_entropy_with_logits(<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/lazy_loader.py\", line 53, in <strong>getattr</strong><br>\nmodule = self._load()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load<br>\nmodule = importlib.import_module(self.<strong>name</strong>)<br>\nFile \"/usr/lib/python2.7/importlib/<strong>init</strong>.py\", line 37, in import_module<br>\n<strong>import</strong>(name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/<strong>init</strong>.py\", line 34, in <br>\nfrom tensorflow.contrib import image<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/<strong>init</strong>.py\", line 39, in <br>\nfrom tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py\", line 26, in <br>\n\"_single_image_random_dot_stereograms.so\"))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/util/loader.py\", line 55, in load_op_library<br>\nret = load_library.load_op_library(path)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/load_library.py\", line 64, in load_op_library<br>\nNone, None, error_msg, error_code)<br>\ntensorflow.python.framework.errors_impl.NotFoundError: /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/_single_image_random_dot_stereograms.so: undefined symbol: _ZN6google8protobuf8internal10LogMessageC1ENS0_8LogLevelEPKci</p>\n<p>Thanks,</p>\n<p>Boris</p>", "body_text": "System information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Not - Use last TF master and last Models\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):   Ubuntu 16.04\n\n\nTensorFlow installed from (source or binary): from source ( dramatically less compilation number of files, less in 100 files.)\n\n\nTensorFlow version (use command below): 'v1.1.0-rc2-607-g550df41', '1.1.0-rc2'\n\n\nBazel version (if compiling from source): 0.4.5\n\n\nCUDA/cuDNN version: 8.0, 6\n\n\nGPU model and memory: Nvidia P100 PCI - 16 GB\n\n\nExact command to reproduce:\nOn ps - bazel-bin/inception/imagenet_distributed_train --job_name='ps' --task_id=0 --ps_hosts='11.11.11.31:2222' --worker_hosts='11.11.11.41:2222,11.11.11.41:2223'\n\n\nAll good\nINFO:tensorflow:PS hosts are: ['11.11.11.31:2222']\nINFO:tensorflow:Worker hosts are: ['11.11.11.41:2222', '11.11.11.41:2223']\n2017-05-03 11:12:54.447399: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2222}\n2017-05-03 11:12:54.447459: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> 11.11.11.41:2222, 1 -> 11.11.11.41:2223}\n2017-05-03 11:12:54.456646: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:296] Started server with target: grpc://localhost:2222\nDescribe the problem\nOn Worker\nCUDA_VISIBLE_DEVICES='1' bazel-bin/inception/imagenet_distributed_train --batch_size=128 --job_name='worker' --ps_hosts='11.11.11.31:2222' --worker_hosts='11.11.11.41:2222,11.11.11.41:2223' --data_dir=/data/imagenet_data/ --train_dir=/data/imagenet_train/ --task_id=1\nIt's failed with\nINFO:tensorflow:PS hosts are: ['11.11.11.31:2222']\nINFO:tensorflow:Worker hosts are: ['11.11.11.41:2222', '11.11.11.41:2223']\n2017-05-03 11:24:17.640127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> 11.11.11.31:2222}\n2017-05-03 11:24:17.640169: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> 11.11.11.41:2222, 1 -> localhost:2223}\n2017-05-03 11:24:17.648767: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:296] Started server with target: grpc://localhost:2223\nTraceback (most recent call last):\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/imagenet_distributed_train.py\", line 66, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/imagenet_distributed_train.py\", line 62, in main\ninception_distributed_train.train(server.target, dataset, cluster_spec)\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/inception_distributed_train.py\", line 157, in train\ninception.loss(logits, labels)\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/inception_model.py\", line 128, in loss\nweight=1.0)\nFile \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/slim/losses.py\", line 166, in cross_entropy_loss\ncross_entropy = tf.contrib.nn.deprecated_flipped_softmax_cross_entropy_with_logits(\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/lazy_loader.py\", line 53, in getattr\nmodule = self._load()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\nmodule = importlib.import_module(self.name)\nFile \"/usr/lib/python2.7/importlib/init.py\", line 37, in import_module\nimport(name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/init.py\", line 34, in \nfrom tensorflow.contrib import image\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/init.py\", line 39, in \nfrom tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py\", line 26, in \n\"_single_image_random_dot_stereograms.so\"))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/util/loader.py\", line 55, in load_op_library\nret = load_library.load_op_library(path)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/load_library.py\", line 64, in load_op_library\nNone, None, error_msg, error_code)\ntensorflow.python.framework.errors_impl.NotFoundError: /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/_single_image_random_dot_stereograms.so: undefined symbol: _ZN6google8protobuf8internal10LogMessageC1ENS0_8LogLevelEPKci\nThanks,\nBoris", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Not - Use last TF master and last Models\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:   Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: from source ( dramatically less compilation number of files, less in 100 files.)\r\n- **TensorFlow version (use command below)**: 'v1.1.0-rc2-607-g550df41', '1.1.0-rc2' \r\n\r\n- **Bazel version (if compiling from source)**: 0.4.5\r\n- **CUDA/cuDNN version**: 8.0, 6\r\n- **GPU model and memory**: Nvidia P100 PCI - 16 GB\r\n- **Exact command to reproduce**:\r\nOn ps - bazel-bin/inception/imagenet_distributed_train --job_name='ps' --task_id=0 --ps_hosts='11.11.11.31:2222' --worker_hosts='11.11.11.41:2222,11.11.11.41:2223'\r\n\r\nAll good \r\n\r\nINFO:tensorflow:PS hosts are: ['11.11.11.31:2222']\r\nINFO:tensorflow:Worker hosts are: ['11.11.11.41:2222', '11.11.11.41:2223']\r\n2017-05-03 11:12:54.447399: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2222}\r\n2017-05-03 11:12:54.447459: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> 11.11.11.41:2222, 1 -> 11.11.11.41:2223}\r\n2017-05-03 11:12:54.456646: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:296] Started server with target: grpc://localhost:2222\r\n\r\n### Describe the problem\r\n\r\nOn Worker \r\n\r\nCUDA_VISIBLE_DEVICES='1' bazel-bin/inception/imagenet_distributed_train --batch_size=128 --job_name='worker' --ps_hosts='11.11.11.31:2222' --worker_hosts='11.11.11.41:2222,11.11.11.41:2223' --data_dir=/data/imagenet_data/ --train_dir=/data/imagenet_train/ --task_id=1\r\n\r\nIt's failed with\r\n INFO:tensorflow:PS hosts are: ['11.11.11.31:2222']                                                                \r\nINFO:tensorflow:Worker hosts are: ['11.11.11.41:2222', '11.11.11.41:2223']                                        \r\n2017-05-03 11:24:17.640127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> 11.11.11.31:2222}                                                                        \r\n2017-05-03 11:24:17.640169: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> 11.11.11.41:2222, 1 -> localhost:2223}                                               \r\n2017-05-03 11:24:17.648767: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:296] Started server with target: grpc://localhost:2223                                                                                     \r\nTraceback (most recent call last):                                                                                \r\n  File \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/imagenet_distributed_train.py\", line 66, in <module>                                                                     \r\n    tf.app.run()                                                                                                  \r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run                \r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))                                                            \r\n  File \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/imagenet_distributed_train.py\", line 62, in main\r\n    inception_distributed_train.train(server.target, dataset, cluster_spec)\r\n  File \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/inception_distributed_train.py\", line 157, in train\r\n    inception.loss(logits, labels)\r\n  File \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/inception_model.py\", line 128, in loss\r\n    weight=1.0)\r\n  File \"/root/models/inception/bazel-bin/inception/imagenet_distributed_train.runfiles/inception/inception/slim/losses.py\", line 166, in cross_entropy_loss\r\n    cross_entropy = tf.contrib.nn.deprecated_flipped_softmax_cross_entropy_with_logits(\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/lazy_loader.py\", line 53, in __getattr__\r\n    module = self._load()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\r\n    module = importlib.import_module(self.__name__)\r\n  File \"/usr/lib/python2.7/importlib/__init__.py\", line 37, in import_module\r\n    __import__(name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/__init__.py\", line 34, in <module>\r\n    from tensorflow.contrib import image\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/__init__.py\", line 39, in <module>\r\n    from tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py\", line 26, in <module>\r\n    \"_single_image_random_dot_stereograms.so\"))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/util/loader.py\", line 55, in load_op_library\r\n    ret = load_library.load_op_library(path)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/load_library.py\", line 64, in load_op_library\r\n    None, None, error_msg, error_code)\r\ntensorflow.python.framework.errors_impl.NotFoundError: /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/_single_image_random_dot_stereograms.so: undefined symbol: _ZN6google8protobuf8internal10LogMessageC1ENS0_8LogLevelEPKci\r\n\r\nThanks,\r\n\r\nBoris\r\n\r\n\r\n\r\n\r\n\r\n"}