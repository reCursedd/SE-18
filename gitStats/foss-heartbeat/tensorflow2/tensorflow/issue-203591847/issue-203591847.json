{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7108", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7108/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7108/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7108/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7108", "id": 203591847, "node_id": "MDU6SXNzdWUyMDM1OTE4NDc=", "number": 7108, "title": "Tensorflow freezes on iOS during Session::Run", "user": {"login": "vahidk", "id": 145408, "node_id": "MDQ6VXNlcjE0NTQwOA==", "avatar_url": "https://avatars3.githubusercontent.com/u/145408?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vahidk", "html_url": "https://github.com/vahidk", "followers_url": "https://api.github.com/users/vahidk/followers", "following_url": "https://api.github.com/users/vahidk/following{/other_user}", "gists_url": "https://api.github.com/users/vahidk/gists{/gist_id}", "starred_url": "https://api.github.com/users/vahidk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vahidk/subscriptions", "organizations_url": "https://api.github.com/users/vahidk/orgs", "repos_url": "https://api.github.com/users/vahidk/repos", "events_url": "https://api.github.com/users/vahidk/events{/privacy}", "received_events_url": "https://api.github.com/users/vahidk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 29, "created_at": "2017-01-27T09:39:30Z", "updated_at": "2018-04-10T22:39:48Z", "closed_at": "2018-04-10T22:39:48Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Tensorflow hangs on iOS during Session::Run. I have a deep LSTM model that requires running session.run many times. The program occasionally hangs after running a few sessions without consuming any cpu. Tensorflow seems to get stuck at DirectSession::WaitForNotification.</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"151269940\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/2121\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2121/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/2121\">#2121</a><br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"159687812\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/2788\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2788/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/2788\">#2788</a></p>\n<h3>Environment info</h3>\n<p>Operating System: iOS</p>\n<p>git rev-parse HEAD:  <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/e60e72435f0dfebe6424ab4c525523486006d47a/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/e60e72435f0dfebe6424ab4c525523486006d47a\"><tt>e60e724</tt></a></p>\n<p>Build label: 0.2.3<br>\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar<br>\nBuild time: Tue May 17 14:22:21 2016 (1463494941)<br>\nBuild timestamp: 1463494941<br>\nBuild timestamp as int: 1463494941</p>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<pre><code>std::vector&lt;tensorflow::Tensor&gt; outputs;\nfor (int t = 0; t &lt; count; ++t) {        \n    std::vector&lt;std::pair&lt;std::string, tensorflow::Tensor&gt;&gt; feed =....\n    auto status = g_session-&gt;Run(feed, out_layer_names, {}, &amp;outputs);\n    if (!status.ok()) {\n        LOG(ERROR) &lt;&lt; status.ToString();\n        return @\"Internal Error!\";\n    }\n    ....\n}\n</code></pre>\n<h3>Logs or other output that would be helpful</h3>\n<p>This is a stack trace of all of the threads when the program freezes:</p>\n<ul>\n<li>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: tid = 0x206350, 0x0000000183256e1c libsystem_kernel.dylib<code>__psynch_cvwait + 8, queue = 'com.apple.main-thread', stop reason = signal SIGSTOP frame #0: 0x0000000183256e1c libsystem_kernel.dylib</code>__psynch_cvwait + 8<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: 0x000000018331c9c0 libsystem_pthread.dylib<code>_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylib</code>std::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&amp;) + 56<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115896656\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3\">#3</a>: 0x00000001000ef6fc App<code>tensorflow::DirectSession::WaitForNotification(tensorflow::Notification*, long long) + 176 frame #4: 0x00000001000eb1cc App</code>tensorflow::DirectSession::WaitForNotification(tensorflow::DirectSession::RunState*, tensorflow::CancellationManager*, long long) + 48<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115910900\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5\">#5</a>: 0x00000001000e91b8 App`tensorflow::DirectSession::Run(tensorflow::RunOptions const&amp;, std::__1::vector&lt;std::__1::pair&lt;std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt;, tensorflow::Tensor&gt;, std::__1::allocator&lt;std::__1::pair&lt;std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt;, tensorflow::Tensor&gt; &gt; &gt; const&amp;, std::__1::vector&lt;std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt;, std::__1::allocator&lt;std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt; &gt; &gt; const&amp;, std::__1::vector&lt;std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt;, std::__1::allocator&lt;std::__1::basic_string&lt;char, std::__1::char_traits, std::__1::allocator &gt; &gt; &gt; const&amp;, std::__1::vector&lt;tensorflow::Tensor, std::__1::allocatortensorflow::Tensor &gt;<em>, tensorflow::RunMetadata</em>) + 1868</p>\n<ul>\n<li>frame <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115911735\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/6\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/6/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/6\">#6</a>: 0x00000001000e8a40 App<code>tensorflow::DirectSession::Run(std::__1::vector&lt;std::__1::pair&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;, tensorflow::Tensor&gt;, std::__1::allocator&lt;std::__1::pair&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;, tensorflow::Tensor&gt; &gt; &gt; const&amp;, std::__1::vector&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;, std::__1::allocator&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt; &gt; const&amp;, std::__1::vector&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;, std::__1::allocator&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt; &gt; const&amp;, std::__1::vector&lt;tensorflow::Tensor, std::__1::allocator&lt;tensorflow::Tensor&gt; &gt;*) + 112 frame #7: 0x000000010052e01c App</code>tensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&amp;) + 6028<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914495\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/8\">#8</a>: 0x000000010053c138 App<code>main + 24316 frame #9: 0x0000000100535f00 App</code>tensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&amp;) + 38512<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914766\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10\">#10</a>: 0x0000000100535794 App<code>tensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&amp;) + 36612 frame #11: 0x000000018a173d30 UIKit</code>-[UIApplication sendAction:to:from:forEvent:] + 96<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115915395\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12\">#12</a>: 0x000000018a2e7880 UIKit<code>-[UIBarButtonItem(UIInternal) _sendAction:withEvent:] + 168 frame #13: 0x000000018a173d30 UIKit</code>-[UIApplication sendAction:to:from:forEvent:] + 96<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115918464\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/14\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/14/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/14\">#14</a>: 0x000000018a173cb0 UIKit<code>-[UIControl sendAction:to:forEvent:] + 80 frame #15: 0x000000018a15e128 UIKit</code>-[UIControl _sendActionsForEvents:withEvent:] + 452<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115925923\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/16\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/16/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/16\">#16</a>: 0x000000018a15e290 UIKit<code>-[UIControl _sendActionsForEvents:withEvent:] + 812 frame #17: 0x000000018a17359c UIKit</code>-[UIControl touchesEnded:withEvent:] + 584<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115926208\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/18\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/18/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/18\">#18</a>: 0x000000018a1730c4 UIKit<code>-[UIWindow _sendTouchesForEvent:] + 2484 frame #19: 0x000000018a16e328 UIKit</code>-[UIWindow sendEvent:] + 2988<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115927762\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/20\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/20/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/20\">#20</a>: 0x000000018a13eda0 UIKit<code>-[UIApplication sendEvent:] + 340 frame #21: 0x000000018a92875c UIKit</code>__dispatchPreprocessedEventFromEventQueue + 2736<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115928097\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/22\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/22/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/22\">#22</a>: 0x000000018a922130 UIKit<code>__handleEventQueue + 784 frame #23: 0x0000000184236b5c CoreFoundation</code><strong>CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION</strong> + 24<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115932607\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/24\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/24/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/24\">#24</a>: 0x00000001842364a4 CoreFoundation<code>__CFRunLoopDoSources0 + 524 frame #25: 0x00000001842340a4 CoreFoundation</code>__CFRunLoopRun + 804<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115939021\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/26\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/26/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/26\">#26</a>: 0x00000001841622b8 CoreFoundation<code>CFRunLoopRunSpecific + 444 frame #27: 0x0000000185c16198 GraphicsServices</code>GSEventRunModal + 180<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115943357\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/28\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/28/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/28\">#28</a>: 0x000000018a1a97fc UIKit<code>-[UIApplication _run] + 684 frame #29: 0x000000018a1a4534 UIKit</code>UIApplicationMain + 208<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115944373\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/30\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/30/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/30\">#30</a>: 0x00000001005362b4 App<code>main + 120 frame #31: 0x00000001831455b8 libdyld.dylib</code>start + 4</li>\n</ul>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115898449\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/4\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/4/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/4\">#4</a>: tid = 0x206397, 0x000000018331ad88 libsystem_pthread.dylib<code>start_wqthread frame #0: 0x000000018331ad88 libsystem_pthread.dylib</code>start_wqthread</p>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914495\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/8\">#8</a>: tid = 0x20639b, 0x0000000183239188 libsystem_kernel.dylib<code>mach_msg_trap + 8, name = 'com.apple.uikit.eventfetch-thread' frame #0: 0x0000000183239188 libsystem_kernel.dylib</code>mach_msg_trap + 8<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: 0x0000000183238ff8 libsystem_kernel.dylib<code>mach_msg + 72 frame #2: 0x00000001842365d0 CoreFoundation</code>__CFRunLoopServiceMachPort + 192<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115896656\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3\">#3</a>: 0x00000001842341ec CoreFoundation<code>__CFRunLoopRun + 1132 frame #4: 0x00000001841622b8 CoreFoundation</code>CFRunLoopRunSpecific + 444<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115910900\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5\">#5</a>: 0x0000000184c9f26c Foundation<code>-[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 304 frame #6: 0x0000000184cbfdd0 Foundation</code>-[NSRunLoop(NSRunLoop) runUntilDate:] + 96<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115912111\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7\">#7</a>: 0x000000018ab1dc38 UIKit<code>-[UIEventFetcher threadMain] + 136 frame #8: 0x0000000184d9ce68 Foundation</code><strong>NSThread__start</strong> + 1024<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914691\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9\">#9</a>: 0x000000018331d850 libsystem_pthread.dylib<code>_pthread_body + 240 frame #10: 0x000000018331d760 libsystem_pthread.dylib</code>_pthread_start + 284<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914813\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/11\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/11/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/11\">#11</a>: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4</p>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914691\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9\">#9</a>: tid = 0x2063c0, 0x0000000183256e1c libsystem_kernel.dylib<code>__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib</code>__psynch_cvwait + 8<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: 0x000000018331c9c0 libsystem_pthread.dylib<code>_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylib</code>std::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&amp;) + 56<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115896656\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3\">#3</a>: 0x000000010019535c App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115910900\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5\">#5</a>: 0x00000001001949dc App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115912111\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7\">#7</a>: 0x00000001001a5828 App<code>void* std::__1::__thread_proxy&lt;std::__1::tuple&lt;std::__1::function&lt;void ()&gt; &gt; &gt;(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib</code>_pthread_body + 240<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914691\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9\">#9</a>: 0x000000018331d760 libsystem_pthread.dylib<code>_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylib</code>thread_start + 4</p>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914766\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10\">#10</a>: tid = 0x2063c1, 0x0000000183256e1c libsystem_kernel.dylib<code>__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib</code>__psynch_cvwait + 8<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: 0x000000018331c9c0 libsystem_pthread.dylib<code>_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylib</code>std::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&amp;) + 56<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115896656\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3\">#3</a>: 0x000000010019535c App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115910900\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5\">#5</a>: 0x00000001001949dc App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115912111\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7\">#7</a>: 0x00000001001a5828 App<code>void* std::__1::__thread_proxy&lt;std::__1::tuple&lt;std::__1::function&lt;void ()&gt; &gt; &gt;(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib</code>_pthread_body + 240<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914691\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9\">#9</a>: 0x000000018331d760 libsystem_pthread.dylib<code>_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylib</code>thread_start + 4</p>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914813\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/11\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/11/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/11\">#11</a>: tid = 0x2063c2, 0x0000000183256e1c libsystem_kernel.dylib<code>__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib</code>__psynch_cvwait + 8<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: 0x000000018331c9c0 libsystem_pthread.dylib<code>_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylib</code>std::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&amp;) + 56<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115896656\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3\">#3</a>: 0x000000010019535c App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115910900\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5\">#5</a>: 0x00000001001949dc App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115912111\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7\">#7</a>: 0x00000001001a5828 App<code>void* std::__1::__thread_proxy&lt;std::__1::tuple&lt;std::__1::function&lt;void ()&gt; &gt; &gt;(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib</code>_pthread_body + 240<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914691\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9\">#9</a>: 0x000000018331d760 libsystem_pthread.dylib<code>_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylib</code>thread_start + 4</p>\n<p>thread <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115915395\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12\">#12</a>: tid = 0x2063c3, 0x0000000183256e1c libsystem_kernel.dylib<code>__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib</code>__psynch_cvwait + 8<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a>: 0x000000018331c9c0 libsystem_pthread.dylib<code>_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylib</code>std::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&amp;) + 56<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115896656\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3\">#3</a>: 0x000000010019535c App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115910900\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5\">#5</a>: 0x00000001001949dc App<code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 App</code>tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115912111\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7\">#7</a>: 0x00000001001a5828 App<code>void* std::__1::__thread_proxy&lt;std::__1::tuple&lt;std::__1::function&lt;void ()&gt; &gt; &gt;(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib</code>_pthread_body + 240<br>\nframe <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115914691\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9\">#9</a>: 0x000000018331d760 libsystem_pthread.dylib<code>_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylib</code>thread_start + 4</p>\n</li>\n</ul>", "body_text": "Tensorflow hangs on iOS during Session::Run. I have a deep LSTM model that requires running session.run many times. The program occasionally hangs after running a few sessions without consuming any cpu. Tensorflow seems to get stuck at DirectSession::WaitForNotification.\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n#2121\n#2788\nEnvironment info\nOperating System: iOS\ngit rev-parse HEAD:  e60e724\nBuild label: 0.2.3\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Tue May 17 14:22:21 2016 (1463494941)\nBuild timestamp: 1463494941\nBuild timestamp as int: 1463494941\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nstd::vector<tensorflow::Tensor> outputs;\nfor (int t = 0; t < count; ++t) {        \n    std::vector<std::pair<std::string, tensorflow::Tensor>> feed =....\n    auto status = g_session->Run(feed, out_layer_names, {}, &outputs);\n    if (!status.ok()) {\n        LOG(ERROR) << status.ToString();\n        return @\"Internal Error!\";\n    }\n    ....\n}\n\nLogs or other output that would be helpful\nThis is a stack trace of all of the threads when the program freezes:\n\n\nthread #1: tid = 0x206350, 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8, queue = 'com.apple.main-thread', stop reason = signal SIGSTOP frame #0: 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8\nframe #1: 0x000000018331c9c0 libsystem_pthread.dylib_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylibstd::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&) + 56\nframe #3: 0x00000001000ef6fc Apptensorflow::DirectSession::WaitForNotification(tensorflow::Notification*, long long) + 176 frame #4: 0x00000001000eb1cc Apptensorflow::DirectSession::WaitForNotification(tensorflow::DirectSession::RunState*, tensorflow::CancellationManager*, long long) + 48\nframe #5: 0x00000001000e91b8 App`tensorflow::DirectSession::Run(tensorflow::RunOptions const&, std::__1::vector<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits, std::__1::allocator >, tensorflow::Tensor>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits, std::__1::allocator >, tensorflow::Tensor> > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits, std::__1::allocator >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits, std::__1::allocator > > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits, std::__1::allocator >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits, std::__1::allocator > > > const&, std::__1::vector<tensorflow::Tensor, std::__1::allocatortensorflow::Tensor >, tensorflow::RunMetadata) + 1868\n\nframe #6: 0x00000001000e8a40 Apptensorflow::DirectSession::Run(std::__1::vector<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, tensorflow::Tensor>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, tensorflow::Tensor> > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::vector<tensorflow::Tensor, std::__1::allocator<tensorflow::Tensor> >*) + 112 frame #7: 0x000000010052e01c Apptensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&) + 6028\nframe #8: 0x000000010053c138 Appmain + 24316 frame #9: 0x0000000100535f00 Apptensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&) + 38512\nframe #10: 0x0000000100535794 Apptensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&) + 36612 frame #11: 0x000000018a173d30 UIKit-[UIApplication sendAction:to:from:forEvent:] + 96\nframe #12: 0x000000018a2e7880 UIKit-[UIBarButtonItem(UIInternal) _sendAction:withEvent:] + 168 frame #13: 0x000000018a173d30 UIKit-[UIApplication sendAction:to:from:forEvent:] + 96\nframe #14: 0x000000018a173cb0 UIKit-[UIControl sendAction:to:forEvent:] + 80 frame #15: 0x000000018a15e128 UIKit-[UIControl _sendActionsForEvents:withEvent:] + 452\nframe #16: 0x000000018a15e290 UIKit-[UIControl _sendActionsForEvents:withEvent:] + 812 frame #17: 0x000000018a17359c UIKit-[UIControl touchesEnded:withEvent:] + 584\nframe #18: 0x000000018a1730c4 UIKit-[UIWindow _sendTouchesForEvent:] + 2484 frame #19: 0x000000018a16e328 UIKit-[UIWindow sendEvent:] + 2988\nframe #20: 0x000000018a13eda0 UIKit-[UIApplication sendEvent:] + 340 frame #21: 0x000000018a92875c UIKit__dispatchPreprocessedEventFromEventQueue + 2736\nframe #22: 0x000000018a922130 UIKit__handleEventQueue + 784 frame #23: 0x0000000184236b5c CoreFoundationCFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION + 24\nframe #24: 0x00000001842364a4 CoreFoundation__CFRunLoopDoSources0 + 524 frame #25: 0x00000001842340a4 CoreFoundation__CFRunLoopRun + 804\nframe #26: 0x00000001841622b8 CoreFoundationCFRunLoopRunSpecific + 444 frame #27: 0x0000000185c16198 GraphicsServicesGSEventRunModal + 180\nframe #28: 0x000000018a1a97fc UIKit-[UIApplication _run] + 684 frame #29: 0x000000018a1a4534 UIKitUIApplicationMain + 208\nframe #30: 0x00000001005362b4 Appmain + 120 frame #31: 0x00000001831455b8 libdyld.dylibstart + 4\n\nthread #4: tid = 0x206397, 0x000000018331ad88 libsystem_pthread.dylibstart_wqthread frame #0: 0x000000018331ad88 libsystem_pthread.dylibstart_wqthread\nthread #8: tid = 0x20639b, 0x0000000183239188 libsystem_kernel.dylibmach_msg_trap + 8, name = 'com.apple.uikit.eventfetch-thread' frame #0: 0x0000000183239188 libsystem_kernel.dylibmach_msg_trap + 8\nframe #1: 0x0000000183238ff8 libsystem_kernel.dylibmach_msg + 72 frame #2: 0x00000001842365d0 CoreFoundation__CFRunLoopServiceMachPort + 192\nframe #3: 0x00000001842341ec CoreFoundation__CFRunLoopRun + 1132 frame #4: 0x00000001841622b8 CoreFoundationCFRunLoopRunSpecific + 444\nframe #5: 0x0000000184c9f26c Foundation-[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 304 frame #6: 0x0000000184cbfdd0 Foundation-[NSRunLoop(NSRunLoop) runUntilDate:] + 96\nframe #7: 0x000000018ab1dc38 UIKit-[UIEventFetcher threadMain] + 136 frame #8: 0x0000000184d9ce68 FoundationNSThread__start + 1024\nframe #9: 0x000000018331d850 libsystem_pthread.dylib_pthread_body + 240 frame #10: 0x000000018331d760 libsystem_pthread.dylib_pthread_start + 284\nframe #11: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4\nthread #9: tid = 0x2063c0, 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8\nframe #1: 0x000000018331c9c0 libsystem_pthread.dylib_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylibstd::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&) + 56\nframe #3: 0x000000010019535c Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\nframe #5: 0x00000001001949dc Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\nframe #7: 0x00000001001a5828 Appvoid* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib_pthread_body + 240\nframe #9: 0x000000018331d760 libsystem_pthread.dylib_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylibthread_start + 4\nthread #10: tid = 0x2063c1, 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8\nframe #1: 0x000000018331c9c0 libsystem_pthread.dylib_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylibstd::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&) + 56\nframe #3: 0x000000010019535c Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\nframe #5: 0x00000001001949dc Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\nframe #7: 0x00000001001a5828 Appvoid* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib_pthread_body + 240\nframe #9: 0x000000018331d760 libsystem_pthread.dylib_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylibthread_start + 4\nthread #11: tid = 0x2063c2, 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8\nframe #1: 0x000000018331c9c0 libsystem_pthread.dylib_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylibstd::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&) + 56\nframe #3: 0x000000010019535c Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\nframe #5: 0x00000001001949dc Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\nframe #7: 0x00000001001a5828 Appvoid* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib_pthread_body + 240\nframe #9: 0x000000018331d760 libsystem_pthread.dylib_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylibthread_start + 4\nthread #12: tid = 0x2063c3, 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8 frame #0: 0x0000000183256e1c libsystem_kernel.dylib__psynch_cvwait + 8\nframe #1: 0x000000018331c9c0 libsystem_pthread.dylib_pthread_cond_wait + 640 frame #2: 0x0000000182c453ec libc++.1.dylibstd::__1::condition_variable::wait(std::__1::unique_lockstd::__1::mutex&) + 56\nframe #3: 0x000000010019535c Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 6296 frame #4: 0x0000000100194e40 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\nframe #5: 0x00000001001949dc Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3864 frame #6: 0x00000001001946e4 Apptensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\nframe #7: 0x00000001001a5828 Appvoid* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100 frame #8: 0x000000018331d850 libsystem_pthread.dylib_pthread_body + 240\nframe #9: 0x000000018331d760 libsystem_pthread.dylib_pthread_start + 284 frame #10: 0x000000018331ad94 libsystem_pthread.dylibthread_start + 4", "body": "Tensorflow hangs on iOS during Session::Run. I have a deep LSTM model that requires running session.run many times. The program occasionally hangs after running a few sessions without consuming any cpu. Tensorflow seems to get stuck at DirectSession::WaitForNotification.\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\n\r\nhttps://github.com/tensorflow/tensorflow/issues/2121\r\nhttps://github.com/tensorflow/tensorflow/issues/2788\r\n\r\n### Environment info\r\nOperating System: iOS\r\n\r\ngit rev-parse HEAD:  e60e72435f0dfebe6424ab4c525523486006d47a\r\n\r\nBuild label: 0.2.3\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Tue May 17 14:22:21 2016 (1463494941)\r\nBuild timestamp: 1463494941\r\nBuild timestamp as int: 1463494941\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n\r\n    std::vector<tensorflow::Tensor> outputs;\r\n    for (int t = 0; t < count; ++t) {        \r\n        std::vector<std::pair<std::string, tensorflow::Tensor>> feed =....\r\n        auto status = g_session->Run(feed, out_layer_names, {}, &outputs);\r\n        if (!status.ok()) {\r\n            LOG(ERROR) << status.ToString();\r\n            return @\"Internal Error!\";\r\n        }\r\n        ....\r\n    }\r\n\r\n### Logs or other output that would be helpful\r\n\r\nThis is a stack trace of all of the threads when the program freezes:\r\n\r\n* thread #1: tid = 0x206350, 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8, queue = 'com.apple.main-thread', stop reason = signal SIGSTOP\r\n    frame #0: 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #1: 0x000000018331c9c0 libsystem_pthread.dylib`_pthread_cond_wait + 640\r\n    frame #2: 0x0000000182c453ec libc++.1.dylib`std::__1::condition_variable::wait(std::__1::unique_lock<std::__1::mutex>&) + 56\r\n    frame #3: 0x00000001000ef6fc App`tensorflow::DirectSession::WaitForNotification(tensorflow::Notification*, long long) + 176\r\n    frame #4: 0x00000001000eb1cc App`tensorflow::DirectSession::WaitForNotification(tensorflow::DirectSession::RunState*, tensorflow::CancellationManager*, long long) + 48\r\n    frame #5: 0x00000001000e91b8 App`tensorflow::DirectSession::Run(tensorflow::RunOptions const&, std::__1::vector<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, tensorflow::Tensor>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, tensorflow::Tensor> > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::vector<tensorflow::Tensor, std::__1::allocator<tensorflow::Tensor> >*, tensorflow::RunMetadata*) + 1868\r\n  * frame #6: 0x00000001000e8a40 App`tensorflow::DirectSession::Run(std::__1::vector<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, tensorflow::Tensor>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, tensorflow::Tensor> > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::vector<tensorflow::Tensor, std::__1::allocator<tensorflow::Tensor> >*) + 112\r\n    frame #7: 0x000000010052e01c App`tensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&) + 6028\r\n    frame #8: 0x000000010053c138 App`main + 24316\r\n    frame #9: 0x0000000100535f00 App`tensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&) + 38512\r\n    frame #10: 0x0000000100535794 App`tensorflow::internal::AppendProtoDebugString(tensorflow::strings::ProtoTextOutput*, tensorflow::Feature const&) + 36612\r\n    frame #11: 0x000000018a173d30 UIKit`-[UIApplication sendAction:to:from:forEvent:] + 96\r\n    frame #12: 0x000000018a2e7880 UIKit`-[UIBarButtonItem(UIInternal) _sendAction:withEvent:] + 168\r\n    frame #13: 0x000000018a173d30 UIKit`-[UIApplication sendAction:to:from:forEvent:] + 96\r\n    frame #14: 0x000000018a173cb0 UIKit`-[UIControl sendAction:to:forEvent:] + 80\r\n    frame #15: 0x000000018a15e128 UIKit`-[UIControl _sendActionsForEvents:withEvent:] + 452\r\n    frame #16: 0x000000018a15e290 UIKit`-[UIControl _sendActionsForEvents:withEvent:] + 812\r\n    frame #17: 0x000000018a17359c UIKit`-[UIControl touchesEnded:withEvent:] + 584\r\n    frame #18: 0x000000018a1730c4 UIKit`-[UIWindow _sendTouchesForEvent:] + 2484\r\n    frame #19: 0x000000018a16e328 UIKit`-[UIWindow sendEvent:] + 2988\r\n    frame #20: 0x000000018a13eda0 UIKit`-[UIApplication sendEvent:] + 340\r\n    frame #21: 0x000000018a92875c UIKit`__dispatchPreprocessedEventFromEventQueue + 2736\r\n    frame #22: 0x000000018a922130 UIKit`__handleEventQueue + 784\r\n    frame #23: 0x0000000184236b5c CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 24\r\n    frame #24: 0x00000001842364a4 CoreFoundation`__CFRunLoopDoSources0 + 524\r\n    frame #25: 0x00000001842340a4 CoreFoundation`__CFRunLoopRun + 804\r\n    frame #26: 0x00000001841622b8 CoreFoundation`CFRunLoopRunSpecific + 444\r\n    frame #27: 0x0000000185c16198 GraphicsServices`GSEventRunModal + 180\r\n    frame #28: 0x000000018a1a97fc UIKit`-[UIApplication _run] + 684\r\n    frame #29: 0x000000018a1a4534 UIKit`UIApplicationMain + 208\r\n    frame #30: 0x00000001005362b4 App`main + 120\r\n    frame #31: 0x00000001831455b8 libdyld.dylib`start + 4\r\n\r\n  thread #4: tid = 0x206397, 0x000000018331ad88 libsystem_pthread.dylib`start_wqthread\r\n    frame #0: 0x000000018331ad88 libsystem_pthread.dylib`start_wqthread\r\n\r\n  thread #8: tid = 0x20639b, 0x0000000183239188 libsystem_kernel.dylib`mach_msg_trap + 8, name = 'com.apple.uikit.eventfetch-thread'\r\n    frame #0: 0x0000000183239188 libsystem_kernel.dylib`mach_msg_trap + 8\r\n    frame #1: 0x0000000183238ff8 libsystem_kernel.dylib`mach_msg + 72\r\n    frame #2: 0x00000001842365d0 CoreFoundation`__CFRunLoopServiceMachPort + 192\r\n    frame #3: 0x00000001842341ec CoreFoundation`__CFRunLoopRun + 1132\r\n    frame #4: 0x00000001841622b8 CoreFoundation`CFRunLoopRunSpecific + 444\r\n    frame #5: 0x0000000184c9f26c Foundation`-[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 304\r\n    frame #6: 0x0000000184cbfdd0 Foundation`-[NSRunLoop(NSRunLoop) runUntilDate:] + 96\r\n    frame #7: 0x000000018ab1dc38 UIKit`-[UIEventFetcher threadMain] + 136\r\n    frame #8: 0x0000000184d9ce68 Foundation`__NSThread__start__ + 1024\r\n    frame #9: 0x000000018331d850 libsystem_pthread.dylib`_pthread_body + 240\r\n    frame #10: 0x000000018331d760 libsystem_pthread.dylib`_pthread_start + 284\r\n    frame #11: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4\r\n\r\n  thread #9: tid = 0x2063c0, 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #0: 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #1: 0x000000018331c9c0 libsystem_pthread.dylib`_pthread_cond_wait + 640\r\n    frame #2: 0x0000000182c453ec libc++.1.dylib`std::__1::condition_variable::wait(std::__1::unique_lock<std::__1::mutex>&) + 56\r\n    frame #3: 0x000000010019535c App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296\r\n    frame #4: 0x0000000100194e40 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\r\n    frame #5: 0x00000001001949dc App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864\r\n    frame #6: 0x00000001001946e4 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\r\n    frame #7: 0x00000001001a5828 App`void* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100\r\n    frame #8: 0x000000018331d850 libsystem_pthread.dylib`_pthread_body + 240\r\n    frame #9: 0x000000018331d760 libsystem_pthread.dylib`_pthread_start + 284\r\n    frame #10: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4\r\n\r\n  thread #10: tid = 0x2063c1, 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #0: 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #1: 0x000000018331c9c0 libsystem_pthread.dylib`_pthread_cond_wait + 640\r\n    frame #2: 0x0000000182c453ec libc++.1.dylib`std::__1::condition_variable::wait(std::__1::unique_lock<std::__1::mutex>&) + 56\r\n    frame #3: 0x000000010019535c App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296\r\n    frame #4: 0x0000000100194e40 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\r\n    frame #5: 0x00000001001949dc App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864\r\n    frame #6: 0x00000001001946e4 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\r\n    frame #7: 0x00000001001a5828 App`void* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100\r\n    frame #8: 0x000000018331d850 libsystem_pthread.dylib`_pthread_body + 240\r\n    frame #9: 0x000000018331d760 libsystem_pthread.dylib`_pthread_start + 284\r\n    frame #10: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4\r\n\r\n  thread #11: tid = 0x2063c2, 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #0: 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #1: 0x000000018331c9c0 libsystem_pthread.dylib`_pthread_cond_wait + 640\r\n    frame #2: 0x0000000182c453ec libc++.1.dylib`std::__1::condition_variable::wait(std::__1::unique_lock<std::__1::mutex>&) + 56\r\n    frame #3: 0x000000010019535c App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296\r\n    frame #4: 0x0000000100194e40 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\r\n    frame #5: 0x00000001001949dc App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864\r\n    frame #6: 0x00000001001946e4 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\r\n    frame #7: 0x00000001001a5828 App`void* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100\r\n    frame #8: 0x000000018331d850 libsystem_pthread.dylib`_pthread_body + 240\r\n    frame #9: 0x000000018331d760 libsystem_pthread.dylib`_pthread_start + 284\r\n    frame #10: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4\r\n\r\n  thread #12: tid = 0x2063c3, 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #0: 0x0000000183256e1c libsystem_kernel.dylib`__psynch_cvwait + 8\r\n    frame #1: 0x000000018331c9c0 libsystem_pthread.dylib`_pthread_cond_wait + 640\r\n    frame #2: 0x0000000182c453ec libc++.1.dylib`std::__1::condition_variable::wait(std::__1::unique_lock<std::__1::mutex>&) + 56\r\n    frame #3: 0x000000010019535c App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 6296\r\n    frame #4: 0x0000000100194e40 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 4988\r\n    frame #5: 0x00000001001949dc App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3864\r\n    frame #6: 0x00000001001946e4 App`tensorflow::thread::ThreadPool::CurrentThreadId() const + 3104\r\n    frame #7: 0x00000001001a5828 App`void* std::__1::__thread_proxy<std::__1::tuple<std::__1::function<void ()> > >(void*) + 100\r\n    frame #8: 0x000000018331d850 libsystem_pthread.dylib`_pthread_body + 240\r\n    frame #9: 0x000000018331d760 libsystem_pthread.dylib`_pthread_start + 284\r\n    frame #10: 0x000000018331ad94 libsystem_pthread.dylib`thread_start + 4\r\n\r\n"}