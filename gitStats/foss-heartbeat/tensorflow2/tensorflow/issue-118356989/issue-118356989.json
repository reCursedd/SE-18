{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/333", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/333/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/333/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/333/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/333", "id": 118356989, "node_id": "MDU6SXNzdWUxMTgzNTY5ODk=", "number": 333, "title": "Issue with _create_slots: var_list[0].device empty", "user": {"login": "malleus17", "id": 7720104, "node_id": "MDQ6VXNlcjc3MjAxMDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/7720104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malleus17", "html_url": "https://github.com/malleus17", "followers_url": "https://api.github.com/users/malleus17/followers", "following_url": "https://api.github.com/users/malleus17/following{/other_user}", "gists_url": "https://api.github.com/users/malleus17/gists{/gist_id}", "starred_url": "https://api.github.com/users/malleus17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malleus17/subscriptions", "organizations_url": "https://api.github.com/users/malleus17/orgs", "repos_url": "https://api.github.com/users/malleus17/repos", "events_url": "https://api.github.com/users/malleus17/events{/privacy}", "received_events_url": "https://api.github.com/users/malleus17/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "touts", "id": 15698149, "node_id": "MDQ6VXNlcjE1Njk4MTQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/15698149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touts", "html_url": "https://github.com/touts", "followers_url": "https://api.github.com/users/touts/followers", "following_url": "https://api.github.com/users/touts/following{/other_user}", "gists_url": "https://api.github.com/users/touts/gists{/gist_id}", "starred_url": "https://api.github.com/users/touts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touts/subscriptions", "organizations_url": "https://api.github.com/users/touts/orgs", "repos_url": "https://api.github.com/users/touts/repos", "events_url": "https://api.github.com/users/touts/events{/privacy}", "received_events_url": "https://api.github.com/users/touts/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "touts", "id": 15698149, "node_id": "MDQ6VXNlcjE1Njk4MTQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/15698149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touts", "html_url": "https://github.com/touts", "followers_url": "https://api.github.com/users/touts/followers", "following_url": "https://api.github.com/users/touts/following{/other_user}", "gists_url": "https://api.github.com/users/touts/gists{/gist_id}", "starred_url": "https://api.github.com/users/touts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touts/subscriptions", "organizations_url": "https://api.github.com/users/touts/orgs", "repos_url": "https://api.github.com/users/touts/repos", "events_url": "https://api.github.com/users/touts/events{/privacy}", "received_events_url": "https://api.github.com/users/touts/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2015-11-23T10:48:45Z", "updated_at": "2015-12-23T19:33:29Z", "closed_at": "2015-12-23T19:33:29Z", "author_association": "NONE", "body_html": "<p>I have problem running</p>\n<pre><code>loss = crossentropy(activation, y)\ntrain_loss = tf.train.AdamOptimizer(learning_rate=0.01).minimize(loss)\n</code></pre>\n<p>with crossentropy defined in another file as a simple function that return</p>\n<pre><code>def crossentropy(activation, y)\n    return tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(activation, y))\n</code></pre>\n<p>I got this error:</p>\n<pre><code>Traceback (most recent call last):\n  File \"test/test.py\", line 66, in &lt;module&gt;\n    train_loss = tf.train.AdamOptimizer(learning_rate=0.01).minimize(loss) # Adam Optimizer\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/optimizer.py\", line 167, in minimize\n    name=name)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/optimizer.py\", line 245, in apply_gradients\n    self._create_slots([v for g, v in grads_and_vars if g is not None])\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/adam.py\", line 87, in _create_slots\n    with ops.device(var_list[0].device):\nIndexError: list index out of range\n</code></pre>\n<p>But this is working: (only call function from another file is not)</p>\n<pre><code>loss = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(activation, y))\ntrain_loss  = self.optimizer(learning_rate=0.01).minimize(loss)\n</code></pre>\n<p>It seemed I can't define that expression outside the main thread, I also tried using same graph as default graph, but it doesn't seem to work either. I think this is an issue with graph building.<br>\nIf you ever ran into this problem, thanks for helping!</p>", "body_text": "I have problem running\nloss = crossentropy(activation, y)\ntrain_loss = tf.train.AdamOptimizer(learning_rate=0.01).minimize(loss)\n\nwith crossentropy defined in another file as a simple function that return\ndef crossentropy(activation, y)\n    return tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(activation, y))\n\nI got this error:\nTraceback (most recent call last):\n  File \"test/test.py\", line 66, in <module>\n    train_loss = tf.train.AdamOptimizer(learning_rate=0.01).minimize(loss) # Adam Optimizer\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/optimizer.py\", line 167, in minimize\n    name=name)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/optimizer.py\", line 245, in apply_gradients\n    self._create_slots([v for g, v in grads_and_vars if g is not None])\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/adam.py\", line 87, in _create_slots\n    with ops.device(var_list[0].device):\nIndexError: list index out of range\n\nBut this is working: (only call function from another file is not)\nloss = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(activation, y))\ntrain_loss  = self.optimizer(learning_rate=0.01).minimize(loss)\n\nIt seemed I can't define that expression outside the main thread, I also tried using same graph as default graph, but it doesn't seem to work either. I think this is an issue with graph building.\nIf you ever ran into this problem, thanks for helping!", "body": "I have problem running \n\n```\nloss = crossentropy(activation, y)\ntrain_loss = tf.train.AdamOptimizer(learning_rate=0.01).minimize(loss)\n```\n\nwith crossentropy defined in another file as a simple function that return \n\n```\ndef crossentropy(activation, y)\n    return tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(activation, y))\n```\n\nI got this error:\n\n```\nTraceback (most recent call last):\n  File \"test/test.py\", line 66, in <module>\n    train_loss = tf.train.AdamOptimizer(learning_rate=0.01).minimize(loss) # Adam Optimizer\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/optimizer.py\", line 167, in minimize\n    name=name)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/optimizer.py\", line 245, in apply_gradients\n    self._create_slots([v for g, v in grads_and_vars if g is not None])\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/adam.py\", line 87, in _create_slots\n    with ops.device(var_list[0].device):\nIndexError: list index out of range\n```\n\nBut this is working: (only call function from another file is not)\n\n```\nloss = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(activation, y))\ntrain_loss  = self.optimizer(learning_rate=0.01).minimize(loss)\n```\n\nIt seemed I can't define that expression outside the main thread, I also tried using same graph as default graph, but it doesn't seem to work either. I think this is an issue with graph building.\nIf you ever ran into this problem, thanks for helping!\n"}