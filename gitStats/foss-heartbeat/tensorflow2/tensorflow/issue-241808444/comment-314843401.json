{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/314843401", "html_url": "https://github.com/tensorflow/tensorflow/issues/11416#issuecomment-314843401", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11416", "id": 314843401, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDg0MzQwMQ==", "user": {"login": "on-the-run", "id": 5404419, "node_id": "MDQ6VXNlcjU0MDQ0MTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5404419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/on-the-run", "html_url": "https://github.com/on-the-run", "followers_url": "https://api.github.com/users/on-the-run/followers", "following_url": "https://api.github.com/users/on-the-run/following{/other_user}", "gists_url": "https://api.github.com/users/on-the-run/gists{/gist_id}", "starred_url": "https://api.github.com/users/on-the-run/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/on-the-run/subscriptions", "organizations_url": "https://api.github.com/users/on-the-run/orgs", "repos_url": "https://api.github.com/users/on-the-run/repos", "events_url": "https://api.github.com/users/on-the-run/events{/privacy}", "received_events_url": "https://api.github.com/users/on-the-run/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-12T17:41:32Z", "updated_at": "2017-07-12T17:41:32Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=12075848\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/junshi15\">@junshi15</a>, some updates about (2) and (3). I am attaching new logs, which give more information on RDMA related events, but fewer lines. In this case, both workers hang.<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1142795/ps.txt\">ps.txt</a><br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1142797/worker0.txt\">worker0.txt</a><br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1142798/worker1.txt\">worker1.txt</a></p>\n<p>For (2), I believe the message is not received by PS, but don't know why. In the logs you can find the buffers are correctly paired.</p>\n<p>For (3), I don't think there is a hashing collision, since not even one tensor had been successfully sent yet in the logs attached.</p>\n<p>Could you shed some light on the following questions?<br>\n(1) Which part of the code send the <code>RDMA_MESSAGE_ACK</code>? Why did I see <code>RDMA_MESSAGE_ACK</code> received in <code>rx_message_buffer</code>?<br>\n(2) What will happen if all the outstanding <code>SendNextItem()</code> end up with doing nothing (which seems to be the case shown in the logs)?<br>\n(3) At line 87 and 88 of <a href=\"https://github.com/tensorflow/tensorflow/files/1142795/ps.txt\">ps.txt</a>, PS received a <code>RDMA_MESSAGE_ACK</code> from worker 1. This doesn't make sense since PS had never sent any message to worker 1, nor worker 1 had received any message from PS.</p>", "body_text": "@junshi15, some updates about (2) and (3). I am attaching new logs, which give more information on RDMA related events, but fewer lines. In this case, both workers hang.\nps.txt\nworker0.txt\nworker1.txt\nFor (2), I believe the message is not received by PS, but don't know why. In the logs you can find the buffers are correctly paired.\nFor (3), I don't think there is a hashing collision, since not even one tensor had been successfully sent yet in the logs attached.\nCould you shed some light on the following questions?\n(1) Which part of the code send the RDMA_MESSAGE_ACK? Why did I see RDMA_MESSAGE_ACK received in rx_message_buffer?\n(2) What will happen if all the outstanding SendNextItem() end up with doing nothing (which seems to be the case shown in the logs)?\n(3) At line 87 and 88 of ps.txt, PS received a RDMA_MESSAGE_ACK from worker 1. This doesn't make sense since PS had never sent any message to worker 1, nor worker 1 had received any message from PS.", "body": "@junshi15, some updates about (2) and (3). I am attaching new logs, which give more information on RDMA related events, but fewer lines. In this case, both workers hang.\r\n[ps.txt](https://github.com/tensorflow/tensorflow/files/1142795/ps.txt)\r\n[worker0.txt](https://github.com/tensorflow/tensorflow/files/1142797/worker0.txt)\r\n[worker1.txt](https://github.com/tensorflow/tensorflow/files/1142798/worker1.txt)\r\n\r\nFor (2), I believe the message is not received by PS, but don't know why. In the logs you can find the buffers are correctly paired.\r\n\r\nFor (3), I don't think there is a hashing collision, since not even one tensor had been successfully sent yet in the logs attached.\r\n\r\nCould you shed some light on the following questions? \r\n(1) Which part of the code send the `RDMA_MESSAGE_ACK`? Why did I see `RDMA_MESSAGE_ACK` received in `rx_message_buffer`? \r\n(2) What will happen if all the outstanding `SendNextItem()` end up with doing nothing (which seems to be the case shown in the logs)?  \r\n(3) At line 87 and 88 of [ps.txt](https://github.com/tensorflow/tensorflow/files/1142795/ps.txt), PS received a `RDMA_MESSAGE_ACK` from worker 1. This doesn't make sense since PS had never sent any message to worker 1, nor worker 1 had received any message from PS."}