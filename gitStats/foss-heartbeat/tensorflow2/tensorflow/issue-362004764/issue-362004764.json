{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22400", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22400/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22400/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22400/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22400", "id": 362004764, "node_id": "MDU6SXNzdWUzNjIwMDQ3NjQ=", "number": 22400, "title": "[tensorflow ppc64le] Building tensorflow from source fails on power8 architecture machine", "user": {"login": "ghltshubh", "id": 16928813, "node_id": "MDQ6VXNlcjE2OTI4ODEz", "avatar_url": "https://avatars3.githubusercontent.com/u/16928813?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghltshubh", "html_url": "https://github.com/ghltshubh", "followers_url": "https://api.github.com/users/ghltshubh/followers", "following_url": "https://api.github.com/users/ghltshubh/following{/other_user}", "gists_url": "https://api.github.com/users/ghltshubh/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghltshubh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghltshubh/subscriptions", "organizations_url": "https://api.github.com/users/ghltshubh/orgs", "repos_url": "https://api.github.com/users/ghltshubh/repos", "events_url": "https://api.github.com/users/ghltshubh/events{/privacy}", "received_events_url": "https://api.github.com/users/ghltshubh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 35, "created_at": "2018-09-20T03:28:19Z", "updated_at": "2018-10-09T02:07:38Z", "closed_at": "2018-10-08T16:43:17Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Red Hat Enterprise Linux Server 7.4 (Maipo)</li>\n<li><strong>Mobile devices</strong>: N/A</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>:</li>\n<li><strong>Python version</strong>: 3.5.6</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.14.0</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 5.4.0 (tried with 4.8.x as well)</li>\n<li><strong>CUDA/cuDNN version</strong>: 8.0/ 7.1.4</li>\n<li><strong>GPU model and memory</strong>: NVIDIA P100</li>\n<li><strong>Exact command to reproduce</strong>: bazel build //tensorflow/tools/pip_package:build_pip_package</li>\n</ul>\n<p><strong>Output of the tf_collect_env.sh</strong></p>\n<p>== cat /etc/issue ===============================================<br>\nLinux summitdev-login1 3.10.0-693.21.1.el7.ppc64le <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP Fri Feb 23 14:02:56 EST 2018 ppc64le ppc64le ppc64le GNU/Linux<br>\nVERSION=\"7.4 (Maipo)\"<br>\nVERSION_ID=\"7.4\"<br>\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.4<br>\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.4\"</p>\n<p>== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nc++ (GCC) 5.4.0<br>\nCopyright (C) 2015 Free Software Foundation, Inc.<br>\nThis is free software; see the source for copying conditions.  There is NO<br>\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n<p>== uname -a =====================================================<br>\nLinux summitdev-login1 3.10.0-693.21.1.el7.ppc64le <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP Fri Feb 23 14:02:56 EST 2018 ppc64le ppc64le ppc64le GNU/Linux</p>\n<p>== check pips ===================================================<br>\nnumpy      1.15.1</p>\n<p>== check for virtualenv =========================================<br>\nFalse    <strong>(this is not true I created an environment and ran this script from inside that env)</strong></p>\n<p>== tensorflow import ============================================</p>\n<p>== env ==========================================================<br>\nLD_LIBRARY_PATH /autofs/nccs-svm1_sw/summitdev/.swci/1-compute/opt/spack/20180406/linux-rhel7-ppc64le/gcc-5.4.0/spectrum-mpi-10.2.0.0-20180110-6keaqyzn74d6t7ilr5wcmd4ovxjkxue7/lib:/sw/summitdev/gcc/5.4.0new/lib64:/sw/summitdev/cuda/8.0.61-1/lib64:/autofs/nccs-svm1_home/shubhankar/magma_install/lib:/autofs/nccs-svm1_home1/shubhankar/magma_install/lib:/autofs/nccs-svm1_home/shubhankar/magma_install/lib:/autofs/nccs-svm1_home1/shubhankar/magma_install/lib:/opt/ibm/spectrumcomputing/lsf/10.1/linux3.10-glibc2.17-ppc64le-csm/lib:/autofs/nccs-svm1_home1/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home1/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu:/sw/summitdev/cuda/8.0.61-1/extras/CUPTI/lib64:/autofs/nccs-svm1_home1/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home1/shubhankar/pytorch/build/lib:/sw/summitdev/cuda/9.0.69/extras/CUPTI/lib64<br>\nDYLD_LIBRARY_PATH is unset</p>\n<p>== nvidia-smi ===================================================<br>\nWed Sep 19 23:25:19 2018<br>\n+-----------------------------------------------------------------------------+<br>\n| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |<br>\n|-------------------------------+----------------------+----------------------+<br>\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |<br>\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |<br>\n|===============================+======================+======================|<br>\n|   0  Tesla P100-SXM2...  Off  | 00000002:01:00.0 Off |                    0 |<br>\n| N/A   32C    P0    29W / 300W |     18MiB / 16280MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   1  Tesla P100-SXM2...  Off  | 00000003:01:00.0 Off |                    0 |<br>\n| N/A   28C    P0    30W / 300W |     18MiB / 16280MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   2  Tesla P100-SXM2...  Off  | 00000006:01:00.0 Off |                    0 |<br>\n| N/A   32C    P0    28W / 300W |     18MiB / 16280MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   3  Tesla P100-SXM2...  Off  | 00000007:01:00.0 Off |                    0 |<br>\n| N/A   29C    P0    30W / 300W |     18MiB / 16280MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+</p>\n<p>+-----------------------------------------------------------------------------+<br>\n| Processes:                                                       GPU Memory |<br>\n|  GPU       PID   Type   Process name                             Usage      |<br>\n|=============================================================================|<br>\n|  No running processes found                                                 |<br>\n+-----------------------------------------------------------------------------+</p>\n<p>== cuda libs  ===================================================</p>\n<h3>Describe the problem</h3>\n<p>Building tensorflow from source fails on power architecture machine. I am following the instructions given <a href=\"https://developer.ibm.com/tutorials/install-tensorflow-on-power/\" rel=\"nofollow\">here</a></p>\n<h3>Source code / logs</h3>\n<pre><code>WARNING: Output base '/autofs/nccs-svm1_home1/shubhankar/.cache/bazel/_bazel_shubhankar/e74c0b81a4afde0b86e7c039eda6fc5e' is on NFS. This may lead to surprising failures and undetermined behavior.\nERROR: Skipping '//tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1166\n        _create_local_cuda_repository(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 995, in _create_local_cuda_repository\n        _get_cuda_config(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 750, in _get_cuda_config\n        _cudnn_version(repository_ctx, cudnn_install_base..., ...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 464, in _cudnn_version\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 707, in _find_cudnn_header_dir\n        auto_configure_fail((\"Cannot find cudnn.h under %s\" ...))\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 210, in auto_configure_fail\n        fail((\"\\n%sCuda Configuration Error:%...)))\n\nCuda Configuration Error: Cannot find cudnn.h under /autofs/nccs-svm1_home1/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu\nWARNING: Target pattern parsing failed.\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1166\n        _create_local_cuda_repository(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 995, in _create_local_cuda_repository\n        _get_cuda_config(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 750, in _get_cuda_config\n        _cudnn_version(repository_ctx, cudnn_install_base..., ...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 464, in _cudnn_version\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 707, in _find_cudnn_header_dir\n        auto_configure_fail((\"Cannot find cudnn.h under %s\" ...))\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 210, in auto_configure_fail\n        fail((\"\\n%sCuda Configuration Error:%...)))\n\nCuda Configuration Error: Cannot find cudnn.h under /autofs/nccs-svm1_home1/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu\nINFO: Elapsed time: 0.197s\nFAILED: Build did NOT complete successfully (0 packages loaded)\n    currently loading: tensorflow/tools/pip_package\n</code></pre>\n<p><strong>NOTE:</strong> Don't have sudo access and can't modify /usr/local/* but have all dependencies installed.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Red Hat Enterprise Linux Server 7.4 (Maipo)\nMobile devices: N/A\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below):\nPython version: 3.5.6\nBazel version (if compiling from source): 0.14.0\nGCC/Compiler version (if compiling from source): 5.4.0 (tried with 4.8.x as well)\nCUDA/cuDNN version: 8.0/ 7.1.4\nGPU model and memory: NVIDIA P100\nExact command to reproduce: bazel build //tensorflow/tools/pip_package:build_pip_package\n\nOutput of the tf_collect_env.sh\n== cat /etc/issue ===============================================\nLinux summitdev-login1 3.10.0-693.21.1.el7.ppc64le #1 SMP Fri Feb 23 14:02:56 EST 2018 ppc64le ppc64le ppc64le GNU/Linux\nVERSION=\"7.4 (Maipo)\"\nVERSION_ID=\"7.4\"\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.4\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.4\"\n== are we in docker =============================================\nNo\n== compiler =====================================================\nc++ (GCC) 5.4.0\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n== uname -a =====================================================\nLinux summitdev-login1 3.10.0-693.21.1.el7.ppc64le #1 SMP Fri Feb 23 14:02:56 EST 2018 ppc64le ppc64le ppc64le GNU/Linux\n== check pips ===================================================\nnumpy      1.15.1\n== check for virtualenv =========================================\nFalse    (this is not true I created an environment and ran this script from inside that env)\n== tensorflow import ============================================\n== env ==========================================================\nLD_LIBRARY_PATH /autofs/nccs-svm1_sw/summitdev/.swci/1-compute/opt/spack/20180406/linux-rhel7-ppc64le/gcc-5.4.0/spectrum-mpi-10.2.0.0-20180110-6keaqyzn74d6t7ilr5wcmd4ovxjkxue7/lib:/sw/summitdev/gcc/5.4.0new/lib64:/sw/summitdev/cuda/8.0.61-1/lib64:/autofs/nccs-svm1_home/shubhankar/magma_install/lib:/autofs/nccs-svm1_home1/shubhankar/magma_install/lib:/autofs/nccs-svm1_home/shubhankar/magma_install/lib:/autofs/nccs-svm1_home1/shubhankar/magma_install/lib:/opt/ibm/spectrumcomputing/lsf/10.1/linux3.10-glibc2.17-ppc64le-csm/lib:/autofs/nccs-svm1_home1/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home1/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu:/sw/summitdev/cuda/8.0.61-1/extras/CUPTI/lib64:/autofs/nccs-svm1_home1/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home1/shubhankar/pytorch/build/lib:/sw/summitdev/cuda/9.0.69/extras/CUPTI/lib64\nDYLD_LIBRARY_PATH is unset\n== nvidia-smi ===================================================\nWed Sep 19 23:25:19 2018\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  Tesla P100-SXM2...  Off  | 00000002:01:00.0 Off |                    0 |\n| N/A   32C    P0    29W / 300W |     18MiB / 16280MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   1  Tesla P100-SXM2...  Off  | 00000003:01:00.0 Off |                    0 |\n| N/A   28C    P0    30W / 300W |     18MiB / 16280MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   2  Tesla P100-SXM2...  Off  | 00000006:01:00.0 Off |                    0 |\n| N/A   32C    P0    28W / 300W |     18MiB / 16280MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   3  Tesla P100-SXM2...  Off  | 00000007:01:00.0 Off |                    0 |\n| N/A   29C    P0    30W / 300W |     18MiB / 16280MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n== cuda libs  ===================================================\nDescribe the problem\nBuilding tensorflow from source fails on power architecture machine. I am following the instructions given here\nSource code / logs\nWARNING: Output base '/autofs/nccs-svm1_home1/shubhankar/.cache/bazel/_bazel_shubhankar/e74c0b81a4afde0b86e7c039eda6fc5e' is on NFS. This may lead to surprising failures and undetermined behavior.\nERROR: Skipping '//tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1166\n        _create_local_cuda_repository(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 995, in _create_local_cuda_repository\n        _get_cuda_config(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 750, in _get_cuda_config\n        _cudnn_version(repository_ctx, cudnn_install_base..., ...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 464, in _cudnn_version\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 707, in _find_cudnn_header_dir\n        auto_configure_fail((\"Cannot find cudnn.h under %s\" ...))\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 210, in auto_configure_fail\n        fail((\"\\n%sCuda Configuration Error:%...)))\n\nCuda Configuration Error: Cannot find cudnn.h under /autofs/nccs-svm1_home1/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu\nWARNING: Target pattern parsing failed.\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1166\n        _create_local_cuda_repository(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 995, in _create_local_cuda_repository\n        _get_cuda_config(repository_ctx)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 750, in _get_cuda_config\n        _cudnn_version(repository_ctx, cudnn_install_base..., ...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 464, in _cudnn_version\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 707, in _find_cudnn_header_dir\n        auto_configure_fail((\"Cannot find cudnn.h under %s\" ...))\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 210, in auto_configure_fail\n        fail((\"\\n%sCuda Configuration Error:%...)))\n\nCuda Configuration Error: Cannot find cudnn.h under /autofs/nccs-svm1_home1/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu\nINFO: Elapsed time: 0.197s\nFAILED: Build did NOT complete successfully (0 packages loaded)\n    currently loading: tensorflow/tools/pip_package\n\nNOTE: Don't have sudo access and can't modify /usr/local/* but have all dependencies installed.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Red Hat Enterprise Linux Server 7.4 (Maipo)\r\n- **Mobile devices**: N/A\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: \r\n- **Python version**: 3.5.6\r\n- **Bazel version (if compiling from source)**: 0.14.0\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0 (tried with 4.8.x as well)\r\n- **CUDA/cuDNN version**: 8.0/ 7.1.4\r\n- **GPU model and memory**: NVIDIA P100\r\n- **Exact command to reproduce**: bazel build //tensorflow/tools/pip_package:build_pip_package\r\n\r\n**Output of the tf_collect_env.sh**\r\n\r\n== cat /etc/issue ===============================================\r\nLinux summitdev-login1 3.10.0-693.21.1.el7.ppc64le #1 SMP Fri Feb 23 14:02:56 EST 2018 ppc64le ppc64le ppc64le GNU/Linux\r\nVERSION=\"7.4 (Maipo)\"\r\nVERSION_ID=\"7.4\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.4\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.4\"\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 5.4.0\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux summitdev-login1 3.10.0-693.21.1.el7.ppc64le #1 SMP Fri Feb 23 14:02:56 EST 2018 ppc64le ppc64le ppc64le GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy      1.15.1   \r\n\r\n== check for virtualenv =========================================\r\nFalse    **(this is not true I created an environment and ran this script from inside that env)**\r\n\r\n== tensorflow import ============================================\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /autofs/nccs-svm1_sw/summitdev/.swci/1-compute/opt/spack/20180406/linux-rhel7-ppc64le/gcc-5.4.0/spectrum-mpi-10.2.0.0-20180110-6keaqyzn74d6t7ilr5wcmd4ovxjkxue7/lib:/sw/summitdev/gcc/5.4.0new/lib64:/sw/summitdev/cuda/8.0.61-1/lib64:/autofs/nccs-svm1_home/shubhankar/magma_install/lib:/autofs/nccs-svm1_home1/shubhankar/magma_install/lib:/autofs/nccs-svm1_home/shubhankar/magma_install/lib:/autofs/nccs-svm1_home1/shubhankar/magma_install/lib:/opt/ibm/spectrumcomputing/lsf/10.1/linux3.10-glibc2.17-ppc64le-csm/lib:/autofs/nccs-svm1_home1/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home1/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu:/sw/summitdev/cuda/8.0.61-1/extras/CUPTI/lib64:/autofs/nccs-svm1_home1/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/miniconda3/envs/pytorch/lib:/autofs/nccs-svm1_home/shubhankar/pytorch/build/lib:/autofs/nccs-svm1_home1/shubhankar/pytorch/build/lib:/sw/summitdev/cuda/9.0.69/extras/CUPTI/lib64\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nWed Sep 19 23:25:19 2018       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla P100-SXM2...  Off  | 00000002:01:00.0 Off |                    0 |\r\n| N/A   32C    P0    29W / 300W |     18MiB / 16280MiB |      0%   E. Process |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  Tesla P100-SXM2...  Off  | 00000003:01:00.0 Off |                    0 |\r\n| N/A   28C    P0    30W / 300W |     18MiB / 16280MiB |      0%   E. Process |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  Tesla P100-SXM2...  Off  | 00000006:01:00.0 Off |                    0 |\r\n| N/A   32C    P0    28W / 300W |     18MiB / 16280MiB |      0%   E. Process |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  Tesla P100-SXM2...  Off  | 00000007:01:00.0 Off |                    0 |\r\n| N/A   29C    P0    30W / 300W |     18MiB / 16280MiB |      0%   E. Process |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n\r\n### Describe the problem\r\nBuilding tensorflow from source fails on power architecture machine. I am following the instructions given [here](https://developer.ibm.com/tutorials/install-tensorflow-on-power/)\r\n\r\n### Source code / logs\r\n```\r\nWARNING: Output base '/autofs/nccs-svm1_home1/shubhankar/.cache/bazel/_bazel_shubhankar/e74c0b81a4afde0b86e7c039eda6fc5e' is on NFS. This may lead to surprising failures and undetermined behavior.\r\nERROR: Skipping '//tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1166\r\n        _create_local_cuda_repository(repository_ctx)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 995, in _create_local_cuda_repository\r\n        _get_cuda_config(repository_ctx)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 750, in _get_cuda_config\r\n        _cudnn_version(repository_ctx, cudnn_install_base..., ...)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 464, in _cudnn_version\r\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 707, in _find_cudnn_header_dir\r\n        auto_configure_fail((\"Cannot find cudnn.h under %s\" ...))\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 210, in auto_configure_fail\r\n        fail((\"\\n%sCuda Configuration Error:%...)))\r\n\r\nCuda Configuration Error: Cannot find cudnn.h under /autofs/nccs-svm1_home1/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu\r\nWARNING: Target pattern parsing failed.\r\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1166\r\n        _create_local_cuda_repository(repository_ctx)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 995, in _create_local_cuda_repository\r\n        _get_cuda_config(repository_ctx)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 750, in _get_cuda_config\r\n        _cudnn_version(repository_ctx, cudnn_install_base..., ...)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 464, in _cudnn_version\r\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 707, in _find_cudnn_header_dir\r\n        auto_configure_fail((\"Cannot find cudnn.h under %s\" ...))\r\n    File \"/autofs/nccs-svm1_home1/shubhankar/tensorflow/third_party/gpus/cuda_configure.bzl\", line 210, in auto_configure_fail\r\n        fail((\"\\n%sCuda Configuration Error:%...)))\r\n\r\nCuda Configuration Error: Cannot find cudnn.h under /autofs/nccs-svm1_home1/shubhankar/libcudnn7_7.0.3.11-1+cuda8.0_ppc64el/lib/powerpc64le-linux-gnu\r\nINFO: Elapsed time: 0.197s\r\nFAILED: Build did NOT complete successfully (0 packages loaded)\r\n    currently loading: tensorflow/tools/pip_package\r\n```\r\n\r\n\r\n**NOTE:** Don't have sudo access and can't modify /usr/local/* but have all dependencies installed."}