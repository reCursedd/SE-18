{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21347", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21347/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21347/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21347/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21347", "id": 347164220, "node_id": "MDU6SXNzdWUzNDcxNjQyMjA=", "number": 21347, "title": "Boosted Trees Regressor - incompatible tensor shapes", "user": {"login": "jessiejc23", "id": 15609433, "node_id": "MDQ6VXNlcjE1NjA5NDMz", "avatar_url": "https://avatars0.githubusercontent.com/u/15609433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jessiejc23", "html_url": "https://github.com/jessiejc23", "followers_url": "https://api.github.com/users/jessiejc23/followers", "following_url": "https://api.github.com/users/jessiejc23/following{/other_user}", "gists_url": "https://api.github.com/users/jessiejc23/gists{/gist_id}", "starred_url": "https://api.github.com/users/jessiejc23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jessiejc23/subscriptions", "organizations_url": "https://api.github.com/users/jessiejc23/orgs", "repos_url": "https://api.github.com/users/jessiejc23/repos", "events_url": "https://api.github.com/users/jessiejc23/events{/privacy}", "received_events_url": "https://api.github.com/users/jessiejc23/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "nataliaponomareva", "id": 4313109, "node_id": "MDQ6VXNlcjQzMTMxMDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4313109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nataliaponomareva", "html_url": "https://github.com/nataliaponomareva", "followers_url": "https://api.github.com/users/nataliaponomareva/followers", "following_url": "https://api.github.com/users/nataliaponomareva/following{/other_user}", "gists_url": "https://api.github.com/users/nataliaponomareva/gists{/gist_id}", "starred_url": "https://api.github.com/users/nataliaponomareva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nataliaponomareva/subscriptions", "organizations_url": "https://api.github.com/users/nataliaponomareva/orgs", "repos_url": "https://api.github.com/users/nataliaponomareva/repos", "events_url": "https://api.github.com/users/nataliaponomareva/events{/privacy}", "received_events_url": "https://api.github.com/users/nataliaponomareva/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nataliaponomareva", "id": 4313109, "node_id": "MDQ6VXNlcjQzMTMxMDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4313109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nataliaponomareva", "html_url": "https://github.com/nataliaponomareva", "followers_url": "https://api.github.com/users/nataliaponomareva/followers", "following_url": "https://api.github.com/users/nataliaponomareva/following{/other_user}", "gists_url": "https://api.github.com/users/nataliaponomareva/gists{/gist_id}", "starred_url": "https://api.github.com/users/nataliaponomareva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nataliaponomareva/subscriptions", "organizations_url": "https://api.github.com/users/nataliaponomareva/orgs", "repos_url": "https://api.github.com/users/nataliaponomareva/repos", "events_url": "https://api.github.com/users/nataliaponomareva/events{/privacy}", "received_events_url": "https://api.github.com/users/nataliaponomareva/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2018-08-02T20:33:33Z", "updated_at": "2018-08-23T15:25:52Z", "closed_at": "2018-08-23T15:25:51Z", "author_association": "NONE", "body_html": "<p>Hi, I used the boosted trees regressor estimator and it gave results on the first run. Cleared my checkpoints  to rerun the model but the program then gave the following value error. Think that this may be a bug because the value error was not raised during my first run, and I am not sure how to fix this error.</p>\n<pre><code>Traceback (most recent call last):\n  File \"main.py\", line 191, in &lt;module&gt;\ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\n  File \"main.py\", line 170, in main\nexperiment.train_and_evaluate()\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 671, in train_and_evaluate\nself.train(delay_secs=0)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 389, in train\nsaving_listeners=self._saving_listeners)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 881, in _call_train\nsaving_listeners=saving_listeners)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\nloss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1119, in _train_model\nreturn self._train_model_default(input_fn, hooks, saving_listeners)\n File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1132, in _train_model_default\nfeatures, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1107, in _call_model_fn\nmodel_fn_results = self._model_fn(features=features, **kwargs)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 929, in _model_fn\nn_batches_per_layer, config)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 650, in _bt_model_fn\nlogits=logits)\nFile \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/head.py\", line 239, in create_estimator_spec\nregularization_losses))\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/head.py\", line 1506, in _create_tpu_estimator_spec\ntrain_op = train_op_fn(regularized_training_loss)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 611, in _train_op_fn\narray_ops.stack(stats_summaries, axis=0), stamp_token)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/ops/data_flow_ops.py\", line 1286, in apply_grad\ngrad.get_shape().assert_is_compatible_with(self._shape)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py\", line 847, in assert_is_compatible_with\nraise ValueError(\"Shapes %s and %s are incompatible\" % (self, other))\nValueError: Shapes (0,) and (0, 63, 2, 2) are incompatible\n</code></pre>\n<p>For reference, these are my feature columns.</p>\n<pre><code>a = tf.feature_column.categorical_column_with_hash_bucket(\"a\", hash_bucket_size=1000)\nb = tf.feature_column.numeric_column(\"b\")\nb_bucket = tf.feature_column.bucketized_column(b,  boundaries=np.arange(0,2644,100).tolist())\nc= tf.feature_column.numeric_column(\"c\")\nc_bucket = tf.feature_column.bucketized_column(c,  boundaries=np.arange(0,210,10).tolist())\nd = tf.feature_column.numeric_column(\"d\")\nd_bucket = tf.feature_column.bucketized_column(d,  boundaries=np.arange(0,245,10).tolist())\ne = tf.feature_column.categorical_column_with_vocabulary_list(key=\"e\", vocabulary_list =[\"l\", \"m\", \"h\"])\ncolumns = [a, b_bucket, c_bucket, d_bucket, e]\nfeature_columns = [tf.feature_column.indicator_column(x) for x in columns]\n</code></pre>", "body_text": "Hi, I used the boosted trees regressor estimator and it gave results on the first run. Cleared my checkpoints  to rerun the model but the program then gave the following value error. Think that this may be a bug because the value error was not raised during my first run, and I am not sure how to fix this error.\nTraceback (most recent call last):\n  File \"main.py\", line 191, in <module>\ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\n  File \"main.py\", line 170, in main\nexperiment.train_and_evaluate()\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 671, in train_and_evaluate\nself.train(delay_secs=0)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 389, in train\nsaving_listeners=self._saving_listeners)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 881, in _call_train\nsaving_listeners=saving_listeners)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\nloss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1119, in _train_model\nreturn self._train_model_default(input_fn, hooks, saving_listeners)\n File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1132, in _train_model_default\nfeatures, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1107, in _call_model_fn\nmodel_fn_results = self._model_fn(features=features, **kwargs)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 929, in _model_fn\nn_batches_per_layer, config)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 650, in _bt_model_fn\nlogits=logits)\nFile \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/head.py\", line 239, in create_estimator_spec\nregularization_losses))\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/head.py\", line 1506, in _create_tpu_estimator_spec\ntrain_op = train_op_fn(regularized_training_loss)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 611, in _train_op_fn\narray_ops.stack(stats_summaries, axis=0), stamp_token)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/ops/data_flow_ops.py\", line 1286, in apply_grad\ngrad.get_shape().assert_is_compatible_with(self._shape)\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py\", line 847, in assert_is_compatible_with\nraise ValueError(\"Shapes %s and %s are incompatible\" % (self, other))\nValueError: Shapes (0,) and (0, 63, 2, 2) are incompatible\n\nFor reference, these are my feature columns.\na = tf.feature_column.categorical_column_with_hash_bucket(\"a\", hash_bucket_size=1000)\nb = tf.feature_column.numeric_column(\"b\")\nb_bucket = tf.feature_column.bucketized_column(b,  boundaries=np.arange(0,2644,100).tolist())\nc= tf.feature_column.numeric_column(\"c\")\nc_bucket = tf.feature_column.bucketized_column(c,  boundaries=np.arange(0,210,10).tolist())\nd = tf.feature_column.numeric_column(\"d\")\nd_bucket = tf.feature_column.bucketized_column(d,  boundaries=np.arange(0,245,10).tolist())\ne = tf.feature_column.categorical_column_with_vocabulary_list(key=\"e\", vocabulary_list =[\"l\", \"m\", \"h\"])\ncolumns = [a, b_bucket, c_bucket, d_bucket, e]\nfeature_columns = [tf.feature_column.indicator_column(x) for x in columns]", "body": "Hi, I used the boosted trees regressor estimator and it gave results on the first run. Cleared my checkpoints  to rerun the model but the program then gave the following value error. Think that this may be a bug because the value error was not raised during my first run, and I am not sure how to fix this error.\r\n\r\n````\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 191, in <module>\r\ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n_sys.exit(main(argv))\r\n  File \"main.py\", line 170, in main\r\nexperiment.train_and_evaluate()\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 671, in train_and_evaluate\r\nself.train(delay_secs=0)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 389, in train\r\nsaving_listeners=self._saving_listeners)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 881, in _call_train\r\nsaving_listeners=saving_listeners)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\r\nloss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1119, in _train_model\r\nreturn self._train_model_default(input_fn, hooks, saving_listeners)\r\n File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1132, in _train_model_default\r\nfeatures, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1107, in _call_model_fn\r\nmodel_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 929, in _model_fn\r\nn_batches_per_layer, config)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 650, in _bt_model_fn\r\nlogits=logits)\r\nFile \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/head.py\", line 239, in create_estimator_spec\r\nregularization_losses))\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/head.py\", line 1506, in _create_tpu_estimator_spec\r\ntrain_op = train_op_fn(regularized_training_loss)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/estimator/canned/boosted_trees.py\", line 611, in _train_op_fn\r\narray_ops.stack(stats_summaries, axis=0), stamp_token)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/ops/data_flow_ops.py\", line 1286, in apply_grad\r\ngrad.get_shape().assert_is_compatible_with(self._shape)\r\n  File \"/.../.../.local/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py\", line 847, in assert_is_compatible_with\r\nraise ValueError(\"Shapes %s and %s are incompatible\" % (self, other))\r\nValueError: Shapes (0,) and (0, 63, 2, 2) are incompatible\r\n````\r\n\r\nFor reference, these are my feature columns.\r\n\r\n```\r\na = tf.feature_column.categorical_column_with_hash_bucket(\"a\", hash_bucket_size=1000)\r\nb = tf.feature_column.numeric_column(\"b\")\r\nb_bucket = tf.feature_column.bucketized_column(b,  boundaries=np.arange(0,2644,100).tolist())\r\nc= tf.feature_column.numeric_column(\"c\")\r\nc_bucket = tf.feature_column.bucketized_column(c,  boundaries=np.arange(0,210,10).tolist())\r\nd = tf.feature_column.numeric_column(\"d\")\r\nd_bucket = tf.feature_column.bucketized_column(d,  boundaries=np.arange(0,245,10).tolist())\r\ne = tf.feature_column.categorical_column_with_vocabulary_list(key=\"e\", vocabulary_list =[\"l\", \"m\", \"h\"])\r\ncolumns = [a, b_bucket, c_bucket, d_bucket, e]\r\nfeature_columns = [tf.feature_column.indicator_column(x) for x in columns]\r\n```"}