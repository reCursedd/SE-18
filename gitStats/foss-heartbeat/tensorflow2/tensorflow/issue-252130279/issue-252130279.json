{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12508", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12508/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12508/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12508/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12508", "id": 252130279, "node_id": "MDU6SXNzdWUyNTIxMzAyNzk=", "number": 12508, "title": "DNNClassifier estimator cannot be exported", "user": {"login": "mvsusp", "id": 142074, "node_id": "MDQ6VXNlcjE0MjA3NA==", "avatar_url": "https://avatars0.githubusercontent.com/u/142074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mvsusp", "html_url": "https://github.com/mvsusp", "followers_url": "https://api.github.com/users/mvsusp/followers", "following_url": "https://api.github.com/users/mvsusp/following{/other_user}", "gists_url": "https://api.github.com/users/mvsusp/gists{/gist_id}", "starred_url": "https://api.github.com/users/mvsusp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mvsusp/subscriptions", "organizations_url": "https://api.github.com/users/mvsusp/orgs", "repos_url": "https://api.github.com/users/mvsusp/repos", "events_url": "https://api.github.com/users/mvsusp/events{/privacy}", "received_events_url": "https://api.github.com/users/mvsusp/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 25, "created_at": "2017-08-23T01:02:07Z", "updated_at": "2018-07-15T09:24:56Z", "closed_at": "2017-08-28T03:32:15Z", "author_association": "NONE", "body_html": "<p>Please go to Stack Overflow for help and support:</p>\n<p><a href=\"https://stackoverflow.com/questions/tagged/tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/tagged/tensorflow</a></p>\n<p>If you open a GitHub issue, here is our policy:</p>\n<ol>\n<li>It must be a bug or a feature request.</li>\n<li>The form below must be filled out.</li>\n<li>It shouldn't be a TensorBoard issue. Those go <a href=\"https://github.com/tensorflow/tensorboard/issues\">here</a>.</li>\n</ol>\n<p><strong>Here's why we have that policy</strong>: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.</p>\n<hr>\n<h3>System information</h3>\n<ul>\n<li><strong>tensorflow/tensorflow:latest container</strong></li>\n<li><strong>ubuntu linux</strong></li>\n<li><strong>installed from pip</strong></li>\n<li><strong>TensorFlow version 'v1.2.0-5-g435cdfc', '1.2.1'</strong>:</li>\n<li><strong>Python 2.7</strong>:</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n</ul>\n<h3>Exact command to reproduce</h3>\n<div class=\"highlight highlight-source-python\"><pre>classifier <span class=\"pl-k\">=</span> DNNClassifier(<span class=\"pl-v\">feature_columns</span><span class=\"pl-k\">=</span>feature_columns,\n                         <span class=\"pl-v\">hidden_units</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">10</span>],\n                         <span class=\"pl-v\">n_classes</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">3</span>,\n                         <span class=\"pl-v\">model_dir</span><span class=\"pl-k\">=</span>model_path)\n\nclassifier.export_savedmodel(<span class=\"pl-c1\">MODEL_PATH</span>, script.serving_input_receiver_fn)</pre></div>\n<h3>Describe the problem</h3>\n<p>Trying to export the model DNNClassifier throws the exception:</p>\n<div class=\"highlight highlight-source-shell\"><pre>Exception during training: A default input_alternative must be provided.\n Traceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>algo.py<span class=\"pl-pds\">\"</span></span>, line 78, <span class=\"pl-k\">in</span> train\n    nn.export_savedmodel(MODEL_PATH, script.serving_input_receiver_fn, default_output_alternative_key=None)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py<span class=\"pl-pds\">\"</span></span>, line 1280, <span class=\"pl-k\">in</span> export_savedmodel\n    actual_default_output_alternative_key)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/utils/saved_model_export_utils.py<span class=\"pl-pds\">\"</span></span>, line 259, <span class=\"pl-k\">in</span> build_all_signature_defs\n    raise ValueError(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>A default input_alternative must be provided.<span class=\"pl-pds\">'</span></span>)</pre></div>\n<p>The problem happens because DNNClassifier constructor creates a head with name <code>None</code>: <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/estimators/dnn.py#L365\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/estimators/dnn.py#L365</a></p>", "body_text": "Please go to Stack Overflow for help and support:\nhttps://stackoverflow.com/questions/tagged/tensorflow\nIf you open a GitHub issue, here is our policy:\n\nIt must be a bug or a feature request.\nThe form below must be filled out.\nIt shouldn't be a TensorBoard issue. Those go here.\n\nHere's why we have that policy: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\n\nSystem information\n\ntensorflow/tensorflow:latest container\nubuntu linux\ninstalled from pip\nTensorFlow version 'v1.2.0-5-g435cdfc', '1.2.1':\nPython 2.7:\nBazel version (if compiling from source):\n\nExact command to reproduce\nclassifier = DNNClassifier(feature_columns=feature_columns,\n                         hidden_units=[10, 20, 10],\n                         n_classes=3,\n                         model_dir=model_path)\n\nclassifier.export_savedmodel(MODEL_PATH, script.serving_input_receiver_fn)\nDescribe the problem\nTrying to export the model DNNClassifier throws the exception:\nException during training: A default input_alternative must be provided.\n Traceback (most recent call last):\n  File \"algo.py\", line 78, in train\n    nn.export_savedmodel(MODEL_PATH, script.serving_input_receiver_fn, default_output_alternative_key=None)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1280, in export_savedmodel\n    actual_default_output_alternative_key)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/utils/saved_model_export_utils.py\", line 259, in build_all_signature_defs\n    raise ValueError('A default input_alternative must be provided.')\nThe problem happens because DNNClassifier constructor creates a head with name None: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/estimators/dnn.py#L365", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug or a feature request.\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **tensorflow/tensorflow:latest container**\r\n- **ubuntu linux**\r\n- **installed from pip**\r\n- **TensorFlow version 'v1.2.0-5-g435cdfc', '1.2.1'**:\r\n- **Python 2.7**: \r\n- **Bazel version (if compiling from source)**:\r\n\r\n### Exact command to reproduce\r\n```python\r\nclassifier = DNNClassifier(feature_columns=feature_columns,\r\n                         hidden_units=[10, 20, 10],\r\n                         n_classes=3,\r\n                         model_dir=model_path)\r\n\r\nclassifier.export_savedmodel(MODEL_PATH, script.serving_input_receiver_fn)\r\n```\r\n### Describe the problem\r\nTrying to export the model DNNClassifier throws the exception:\r\n```bash\r\nException during training: A default input_alternative must be provided.\r\n Traceback (most recent call last):\r\n  File \"algo.py\", line 78, in train\r\n    nn.export_savedmodel(MODEL_PATH, script.serving_input_receiver_fn, default_output_alternative_key=None)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1280, in export_savedmodel\r\n    actual_default_output_alternative_key)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/utils/saved_model_export_utils.py\", line 259, in build_all_signature_defs\r\n    raise ValueError('A default input_alternative must be provided.')\r\n```\r\nThe problem happens because DNNClassifier constructor creates a head with name `None`: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/estimators/dnn.py#L365\r\n\r\n"}