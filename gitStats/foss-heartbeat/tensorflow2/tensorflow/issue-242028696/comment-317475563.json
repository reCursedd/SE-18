{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/317475563", "html_url": "https://github.com/tensorflow/tensorflow/issues/11431#issuecomment-317475563", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11431", "id": 317475563, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNzQ3NTU2Mw==", "user": {"login": "frreiss", "id": 12436991, "node_id": "MDQ6VXNlcjEyNDM2OTkx", "avatar_url": "https://avatars1.githubusercontent.com/u/12436991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frreiss", "html_url": "https://github.com/frreiss", "followers_url": "https://api.github.com/users/frreiss/followers", "following_url": "https://api.github.com/users/frreiss/following{/other_user}", "gists_url": "https://api.github.com/users/frreiss/gists{/gist_id}", "starred_url": "https://api.github.com/users/frreiss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frreiss/subscriptions", "organizations_url": "https://api.github.com/users/frreiss/orgs", "repos_url": "https://api.github.com/users/frreiss/repos", "events_url": "https://api.github.com/users/frreiss/events{/privacy}", "received_events_url": "https://api.github.com/users/frreiss/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-24T16:20:35Z", "updated_at": "2017-07-24T16:20:35Z", "author_association": "CONTRIBUTOR", "body_html": "<p>IIRC the size of an <code>int</code> on POWER is 64 bits. Perhaps the assignment at line 94 (<code>out-&gt;scalar&lt;int32&gt;()() = rank;</code>) is writing 8 bytes into the Tensor instead of 4? What happens if you change the type of <code>rank</code> from <code>int</code> to <code>int32_t</code>?<br>\nSource code for <code>Tensor::scalar()</code> is at <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/tensor.h?utf8=%E2%9C%93#L641-L645\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/tensor.h?utf8=%E2%9C%93#L641-L645</a> .<br>\nThat function is a thin veneer over <code>TensorMap::operator()</code>, which is defined at <a href=\"https://bitbucket.org/eigen/eigen/src/8d1ccfd9c5a0bf1a662bd0fe35858f4e527d2bac/unsupported/Eigen/CXX11/src/Tensor/TensorMap.h?at=default&amp;fileviewer=file-view-default#TensorMap.h-221:226\" rel=\"nofollow\">https://bitbucket.org/eigen/eigen/src/8d1ccfd9c5a0bf1a662bd0fe35858f4e527d2bac/unsupported/Eigen/CXX11/src/Tensor/TensorMap.h?at=default&amp;fileviewer=file-view-default#TensorMap.h-221:226</a></p>", "body_text": "IIRC the size of an int on POWER is 64 bits. Perhaps the assignment at line 94 (out->scalar<int32>()() = rank;) is writing 8 bytes into the Tensor instead of 4? What happens if you change the type of rank from int to int32_t?\nSource code for Tensor::scalar() is at https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/tensor.h?utf8=%E2%9C%93#L641-L645 .\nThat function is a thin veneer over TensorMap::operator(), which is defined at https://bitbucket.org/eigen/eigen/src/8d1ccfd9c5a0bf1a662bd0fe35858f4e527d2bac/unsupported/Eigen/CXX11/src/Tensor/TensorMap.h?at=default&fileviewer=file-view-default#TensorMap.h-221:226", "body": "IIRC the size of an `int` on POWER is 64 bits. Perhaps the assignment at line 94 (`out->scalar<int32>()() = rank;`) is writing 8 bytes into the Tensor instead of 4? What happens if you change the type of `rank` from `int` to `int32_t`?\r\nSource code for `Tensor::scalar()` is at https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/tensor.h?utf8=%E2%9C%93#L641-L645 .\r\nThat function is a thin veneer over `TensorMap::operator()`, which is defined at https://bitbucket.org/eigen/eigen/src/8d1ccfd9c5a0bf1a662bd0fe35858f4e527d2bac/unsupported/Eigen/CXX11/src/Tensor/TensorMap.h?at=default&fileviewer=file-view-default#TensorMap.h-221:226"}