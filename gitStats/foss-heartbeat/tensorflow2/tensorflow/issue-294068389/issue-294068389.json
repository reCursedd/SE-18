{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16716", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16716/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16716/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16716/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16716", "id": 294068389, "node_id": "MDU6SXNzdWUyOTQwNjgzODk=", "number": 16716, "title": "Linker Tools Error encountered when use StepStats", "user": {"login": "raymondxyang", "id": 30183166, "node_id": "MDQ6VXNlcjMwMTgzMTY2", "avatar_url": "https://avatars0.githubusercontent.com/u/30183166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raymondxyang", "html_url": "https://github.com/raymondxyang", "followers_url": "https://api.github.com/users/raymondxyang/followers", "following_url": "https://api.github.com/users/raymondxyang/following{/other_user}", "gists_url": "https://api.github.com/users/raymondxyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/raymondxyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raymondxyang/subscriptions", "organizations_url": "https://api.github.com/users/raymondxyang/orgs", "repos_url": "https://api.github.com/users/raymondxyang/repos", "events_url": "https://api.github.com/users/raymondxyang/events{/privacy}", "received_events_url": "https://api.github.com/users/raymondxyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-03T01:07:58Z", "updated_at": "2018-02-03T01:39:35Z", "closed_at": "2018-02-03T01:39:35Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nYes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nWindows 10.0.16299</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nsource</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\n1.5 release</li>\n<li><strong>Python version</strong>:<br>\n3.5.3</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A</li>\n<li><strong>GPU model and memory</strong>: N/A</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Encounter link error when build the program (source code attached). Build went through well with TF 1.4 release</p>\n<p>Error\tLNK2001\tunresolved external symbol \"class tensorflow::StepStatsDefaultTypeInternal tensorflow::<em>StepStats_default_instance</em>\" (?<em>StepStats_default_instance</em><a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/tensorflow/hovercard\" href=\"https://github.com/tensorflow\">@tensorflow</a>@@3VStepStatsDefaultTypeInternal@1@A)\tReprBug\tc:\\Users\\xx\\documents\\visual studio 2015\\Projects\\ReprBug\\ReprBug\\Source.obj</p>\n<h3>Source code / logs</h3>\n<div class=\"highlight highlight-source-c++\"><pre>#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>tensorflow/cc/saved_model/tag_constants.h<span class=\"pl-pds\">\"</span></span>\n#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>tensorflow/core/public/session_options.h<span class=\"pl-pds\">\"</span></span>\n#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>tensorflow/core/util/stat_summarizer.h<span class=\"pl-pds\">\"</span></span>\n#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>tensorflow/contrib/session_bundle/bundle_shim.h<span class=\"pl-pds\">\"</span></span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-en\">SynchronizedStatSummarizer</span>\n{\n<span class=\"pl-k\">public:</span>\n\t<span class=\"pl-en\">SynchronizedStatSummarizer</span>(<span class=\"pl-k\">const</span> tensorflow::StatSummarizerOptions&amp; options)\n\t\t: m_statSummarizer{ options }, m_mutex{}\n\t{\n\t}\n\n\t<span class=\"pl-k\">void</span> <span class=\"pl-en\">AddStepStats</span>(<span class=\"pl-k\">const</span> tensorflow::StepStats&amp; stepStats)\n\t{\n\t\tstd::lock_guard&lt;std::mutex&gt; guard{ m_mutex };\n\t\tm_statSummarizer.<span class=\"pl-c1\">ProcessStepStats</span>(stepStats);\n\t}\n\n<span class=\"pl-k\">private:</span>\n\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> The TF stat summarizer.</span>\n\ttensorflow::StatSummarizer m_statSummarizer;\n\n\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> Synchronizes access to m_statSummarizer.</span>\n\t<span class=\"pl-k\">mutable</span> std::mutex m_mutex;\n};\n\n<span class=\"pl-k\">int</span> <span class=\"pl-en\">main</span>() {\n\n\ttensorflow::SessionOptions sessionOptions;\n\ttensorflow::RunOptions runOptions{};\n\ttensorflow::ConfigProto&amp; config = sessionOptions.<span class=\"pl-smi\">config</span>;\n\t\n\tstd::unique_ptr&lt;tensorflow::SavedModelBundle&gt; <span class=\"pl-c1\">m_bundle</span> (<span class=\"pl-k\">new</span> <span class=\"pl-c1\">tensorflow::SavedModelBundle</span>());\n\n\t<span class=\"pl-k\">const</span> std::string path = <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>somepath<span class=\"pl-pds\">\"</span></span>;\n\ttensorflow::Status status = <span class=\"pl-c1\">tensorflow::serving::LoadSessionBundleOrSavedModelBundle</span>(\n\t\tsessionOptions, runOptions, path, { tensorflow::<span class=\"pl-c1\">kSavedModelTagServe</span> }, m_bundle.<span class=\"pl-c1\">get</span>());\n\n\tstd::vector&lt;std::pair&lt;std::string, tensorflow::Tensor&gt;&gt; modifiedInputs;\n\tstd::vector&lt;std::string&gt; modifiedOutputNames;\n\tstd::vector&lt;tensorflow::Tensor&gt; tensorOutputs;\n\ttensorflow::RunMetadata runMetadata{};\n\n\ttensorflow::Status run_status = m_bundle-&gt;<span class=\"pl-smi\">session</span>-&gt;<span class=\"pl-c1\">Run</span>(\n\t\trunOptions, modifiedInputs, modifiedOutputNames, {}, &amp;tensorOutputs, &amp;runMetadata);\n\n\tstd::unique_ptr&lt;SynchronizedStatSummarizer&gt; m_runTracingStats;\n\n\t<span class=\"pl-k\">if</span> (run_status.<span class=\"pl-c1\">ok</span>())\n\t{\n\t\tm_runTracingStats-&gt;<span class=\"pl-c1\">AddStepStats</span>(runMetadata.<span class=\"pl-c1\">step_stats</span>());\n\t}\n\n}</pre></div>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nWindows 10.0.16299\nTensorFlow installed from (source or binary):\nsource\nTensorFlow version (use command below):\n1.5 release\nPython version:\n3.5.3\nBazel version (if compiling from source):\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce:\n\nDescribe the problem\nEncounter link error when build the program (source code attached). Build went through well with TF 1.4 release\nError\tLNK2001\tunresolved external symbol \"class tensorflow::StepStatsDefaultTypeInternal tensorflow::StepStats_default_instance\" (?StepStats_default_instance@tensorflow@@3VStepStatsDefaultTypeInternal@1@A)\tReprBug\tc:\\Users\\xx\\documents\\visual studio 2015\\Projects\\ReprBug\\ReprBug\\Source.obj\nSource code / logs\n#include \"tensorflow/cc/saved_model/tag_constants.h\"\n#include \"tensorflow/core/public/session_options.h\"\n#include \"tensorflow/core/util/stat_summarizer.h\"\n#include \"tensorflow/contrib/session_bundle/bundle_shim.h\"\n\nclass SynchronizedStatSummarizer\n{\npublic:\n\tSynchronizedStatSummarizer(const tensorflow::StatSummarizerOptions& options)\n\t\t: m_statSummarizer{ options }, m_mutex{}\n\t{\n\t}\n\n\tvoid AddStepStats(const tensorflow::StepStats& stepStats)\n\t{\n\t\tstd::lock_guard<std::mutex> guard{ m_mutex };\n\t\tm_statSummarizer.ProcessStepStats(stepStats);\n\t}\n\nprivate:\n\t// The TF stat summarizer.\n\ttensorflow::StatSummarizer m_statSummarizer;\n\n\t// Synchronizes access to m_statSummarizer.\n\tmutable std::mutex m_mutex;\n};\n\nint main() {\n\n\ttensorflow::SessionOptions sessionOptions;\n\ttensorflow::RunOptions runOptions{};\n\ttensorflow::ConfigProto& config = sessionOptions.config;\n\t\n\tstd::unique_ptr<tensorflow::SavedModelBundle> m_bundle (new tensorflow::SavedModelBundle());\n\n\tconst std::string path = \"somepath\";\n\ttensorflow::Status status = tensorflow::serving::LoadSessionBundleOrSavedModelBundle(\n\t\tsessionOptions, runOptions, path, { tensorflow::kSavedModelTagServe }, m_bundle.get());\n\n\tstd::vector<std::pair<std::string, tensorflow::Tensor>> modifiedInputs;\n\tstd::vector<std::string> modifiedOutputNames;\n\tstd::vector<tensorflow::Tensor> tensorOutputs;\n\ttensorflow::RunMetadata runMetadata{};\n\n\ttensorflow::Status run_status = m_bundle->session->Run(\n\t\trunOptions, modifiedInputs, modifiedOutputNames, {}, &tensorOutputs, &runMetadata);\n\n\tstd::unique_ptr<SynchronizedStatSummarizer> m_runTracingStats;\n\n\tif (run_status.ok())\n\t{\n\t\tm_runTracingStats->AddStepStats(runMetadata.step_stats());\n\t}\n\n}", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows 10.0.16299\r\n- **TensorFlow installed from (source or binary)**:\r\nsource\r\n- **TensorFlow version (use command below)**:\r\n1.5 release\r\n- **Python version**: \r\n3.5.3\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: \r\n\r\n\r\n\r\n### Describe the problem\r\n\r\nEncounter link error when build the program (source code attached). Build went through well with TF 1.4 release \r\n\r\nError\tLNK2001\tunresolved external symbol \"class tensorflow::StepStatsDefaultTypeInternal tensorflow::_StepStats_default_instance_\" (?_StepStats_default_instance_@tensorflow@@3VStepStatsDefaultTypeInternal@1@A)\tReprBug\tc:\\Users\\xx\\documents\\visual studio 2015\\Projects\\ReprBug\\ReprBug\\Source.obj\r\n\r\n\r\n### Source code / logs\r\n\r\n```cpp \r\n#include \"tensorflow/cc/saved_model/tag_constants.h\"\r\n#include \"tensorflow/core/public/session_options.h\"\r\n#include \"tensorflow/core/util/stat_summarizer.h\"\r\n#include \"tensorflow/contrib/session_bundle/bundle_shim.h\"\r\n\r\nclass SynchronizedStatSummarizer\r\n{\r\npublic:\r\n\tSynchronizedStatSummarizer(const tensorflow::StatSummarizerOptions& options)\r\n\t\t: m_statSummarizer{ options }, m_mutex{}\r\n\t{\r\n\t}\r\n\r\n\tvoid AddStepStats(const tensorflow::StepStats& stepStats)\r\n\t{\r\n\t\tstd::lock_guard<std::mutex> guard{ m_mutex };\r\n\t\tm_statSummarizer.ProcessStepStats(stepStats);\r\n\t}\r\n\r\nprivate:\r\n\t// The TF stat summarizer.\r\n\ttensorflow::StatSummarizer m_statSummarizer;\r\n\r\n\t// Synchronizes access to m_statSummarizer.\r\n\tmutable std::mutex m_mutex;\r\n};\r\n\r\nint main() {\r\n\r\n\ttensorflow::SessionOptions sessionOptions;\r\n\ttensorflow::RunOptions runOptions{};\r\n\ttensorflow::ConfigProto& config = sessionOptions.config;\r\n\t\r\n\tstd::unique_ptr<tensorflow::SavedModelBundle> m_bundle (new tensorflow::SavedModelBundle());\r\n\r\n\tconst std::string path = \"somepath\";\r\n\ttensorflow::Status status = tensorflow::serving::LoadSessionBundleOrSavedModelBundle(\r\n\t\tsessionOptions, runOptions, path, { tensorflow::kSavedModelTagServe }, m_bundle.get());\r\n\r\n\tstd::vector<std::pair<std::string, tensorflow::Tensor>> modifiedInputs;\r\n\tstd::vector<std::string> modifiedOutputNames;\r\n\tstd::vector<tensorflow::Tensor> tensorOutputs;\r\n\ttensorflow::RunMetadata runMetadata{};\r\n\r\n\ttensorflow::Status run_status = m_bundle->session->Run(\r\n\t\trunOptions, modifiedInputs, modifiedOutputNames, {}, &tensorOutputs, &runMetadata);\r\n\r\n\tstd::unique_ptr<SynchronizedStatSummarizer> m_runTracingStats;\r\n\r\n\tif (run_status.ok())\r\n\t{\r\n\t\tm_runTracingStats->AddStepStats(runMetadata.step_stats());\r\n\t}\r\n\r\n}\r\n```"}