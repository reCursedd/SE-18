{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/327614324", "html_url": "https://github.com/tensorflow/tensorflow/issues/12817#issuecomment-327614324", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12817", "id": 327614324, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNzYxNDMyNA==", "user": {"login": "quaeler", "id": 22581048, "node_id": "MDQ6VXNlcjIyNTgxMDQ4", "avatar_url": "https://avatars3.githubusercontent.com/u/22581048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quaeler", "html_url": "https://github.com/quaeler", "followers_url": "https://api.github.com/users/quaeler/followers", "following_url": "https://api.github.com/users/quaeler/following{/other_user}", "gists_url": "https://api.github.com/users/quaeler/gists{/gist_id}", "starred_url": "https://api.github.com/users/quaeler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quaeler/subscriptions", "organizations_url": "https://api.github.com/users/quaeler/orgs", "repos_url": "https://api.github.com/users/quaeler/repos", "events_url": "https://api.github.com/users/quaeler/events{/privacy}", "received_events_url": "https://api.github.com/users/quaeler/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-06T21:13:22Z", "updated_at": "2017-09-06T21:16:10Z", "author_association": "CONTRIBUTOR", "body_html": "<p>We <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/lmdb_reader_op.cc#L39\">do currently open it in read-only mode</a>, but <a href=\"http://www.lmdb.tech/doc/group__mdb.html#ga32a193c6bf4d7d5c5d579e71f22e9340\" rel=\"nofollow\">the documentation for the LMDB API</a> states WRT read-only mode:</p>\n<pre><code>MDB_RDONLY Open the environment in read-only mode. No write operations\nwill be allowed. LMDB will still modify the lock file - except on\nread-only filesystems, where LMDB does not use locks.\n</code></pre>\n<p>If we also specified the <code>MDB_NOLOCK</code> flag on the open (<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=20959853\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/drpngx\">@drpngx</a>,) perhaps this problem would go away; i'm unaware of other ramifications of not locking on the read-only read.</p>", "body_text": "We do currently open it in read-only mode, but the documentation for the LMDB API states WRT read-only mode:\nMDB_RDONLY Open the environment in read-only mode. No write operations\nwill be allowed. LMDB will still modify the lock file - except on\nread-only filesystems, where LMDB does not use locks.\n\nIf we also specified the MDB_NOLOCK flag on the open (@drpngx,) perhaps this problem would go away; i'm unaware of other ramifications of not locking on the read-only read.", "body": "We [do currently open it in read-only mode](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/lmdb_reader_op.cc#L39), but [the documentation for the LMDB API](http://www.lmdb.tech/doc/group__mdb.html#ga32a193c6bf4d7d5c5d579e71f22e9340) states WRT read-only mode:\r\n```\r\nMDB_RDONLY Open the environment in read-only mode. No write operations\r\nwill be allowed. LMDB will still modify the lock file - except on\r\nread-only filesystems, where LMDB does not use locks.\r\n```\r\n\r\nIf we also specified the `MDB_NOLOCK` flag on the open (@drpngx,) perhaps this problem would go away; i'm unaware of other ramifications of not locking on the read-only read."}