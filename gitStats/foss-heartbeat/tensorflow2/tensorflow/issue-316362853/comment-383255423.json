{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/383255423", "html_url": "https://github.com/tensorflow/tensorflow/issues/18739#issuecomment-383255423", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18739", "id": 383255423, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzI1NTQyMw==", "user": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-21T00:54:19Z", "updated_at": "2018-04-21T00:54:19Z", "author_association": "MEMBER", "body_html": "<p>Unfortunately Bazel does not yet allow transitive dependencies on shared objects (cc_binary with linkshared). So that dependency gets stripped out, leading to undefined symbols.</p>\n<p>A workaround is to use <code>tf_cc_binary</code> (<a href=\"https://github.com/tensorflow/tensorflow/blob/a3aa84f28c09b86e4961632d0e2581d06bb4a47e/tensorflow/core/profiler/BUILD#L9\">example</a>), which will add <a href=\"https://github.com/tensorflow/tensorflow/blob/a3aa84f28c09b86e4961632d0e2581d06bb4a47e/tensorflow/BUILD#L423\">//tensorflow:libtensorflow_framework.so</a> to your <code>srcs</code> and add some rpaths. It should work with TF as an external repository, but let me know if it doesn't :)</p>", "body_text": "Unfortunately Bazel does not yet allow transitive dependencies on shared objects (cc_binary with linkshared). So that dependency gets stripped out, leading to undefined symbols.\nA workaround is to use tf_cc_binary (example), which will add //tensorflow:libtensorflow_framework.so to your srcs and add some rpaths. It should work with TF as an external repository, but let me know if it doesn't :)", "body": "Unfortunately Bazel does not yet allow transitive dependencies on shared objects (cc_binary with linkshared). So that dependency gets stripped out, leading to undefined symbols.\r\n\r\nA workaround is to use `tf_cc_binary` ([example](https://github.com/tensorflow/tensorflow/blob/a3aa84f28c09b86e4961632d0e2581d06bb4a47e/tensorflow/core/profiler/BUILD#L9)), which will add [//tensorflow:libtensorflow_framework.so](https://github.com/tensorflow/tensorflow/blob/a3aa84f28c09b86e4961632d0e2581d06bb4a47e/tensorflow/BUILD#L423) to your `srcs` and add some rpaths. It should work with TF as an external repository, but let me know if it doesn't :)"}