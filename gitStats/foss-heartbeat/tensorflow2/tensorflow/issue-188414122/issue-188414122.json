{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5511", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5511/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5511/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5511/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5511", "id": 188414122, "node_id": "MDU6SXNzdWUxODg0MTQxMjI=", "number": 5511, "title": "Build a static library", "user": {"login": "jefby", "id": 3838512, "node_id": "MDQ6VXNlcjM4Mzg1MTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/3838512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jefby", "html_url": "https://github.com/jefby", "followers_url": "https://api.github.com/users/jefby/followers", "following_url": "https://api.github.com/users/jefby/following{/other_user}", "gists_url": "https://api.github.com/users/jefby/gists{/gist_id}", "starred_url": "https://api.github.com/users/jefby/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jefby/subscriptions", "organizations_url": "https://api.github.com/users/jefby/orgs", "repos_url": "https://api.github.com/users/jefby/repos", "events_url": "https://api.github.com/users/jefby/events{/privacy}", "received_events_url": "https://api.github.com/users/jefby/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-11-10T03:49:47Z", "updated_at": "2018-01-04T22:06:39Z", "closed_at": "2016-11-18T08:38:40Z", "author_association": "NONE", "body_html": "<p>Is there a way to ask the build system bazel to build a static library that one can link a program written using the C++ API against? My apologies for this simple question, but I am very unfamiliar with this build system. I try to add some code to tensorflow/tensorflow/BUILD</p>\n<pre><code>cc_binary(\n    name = \"libtensorflow_gpu.a\",\n    linkstatic = 1,\n    linkshared = 0,\n    deps = [\n        \"//tensorflow/c:c_api\",\n        \"//tensorflow/core:tensorflow\",\n    ],\n)\n</code></pre>\n<p>but it failed, it will show these log</p>\n<blockquote>\n<p>ERROR: /gruntdata/jefby/alicpp/external/tensorflowserving/tensorflowserving-50129ec0b407e5778282ee8d7610a9494cfcf6b2/tensorflow/tensorflow/BUILD:209:1: Linking of rule '//tensorflow:libtensorflow_gpu.a' failed: gcc failed: error executing command /usr/bin/gcc -o bazel-out/local-opt/bin/tensorflow/libtensorflow_gpu.a -pthread -Wl,-no-as-needed -B/usr/bin -B/usr/bin -pass-exit-codes '-Wl,--build-id=md5' '-Wl,--hash-style=gnu' -Wl,--gc-sections ... (remaining 1 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.<br>\n/usr/lib/gcc/x86_64-unknown-linux-gnu/4.9.2/../../../../lib64/crt1.o: In function <code>_start': (.text+0x20): undefined reference to </code>main'<br>\ncollect2: error: ld returned 1 exit status<br>\nTarget //tensorflow:libtensorflow_gpu.a failed to build</p>\n</blockquote>", "body_text": "Is there a way to ask the build system bazel to build a static library that one can link a program written using the C++ API against? My apologies for this simple question, but I am very unfamiliar with this build system. I try to add some code to tensorflow/tensorflow/BUILD\ncc_binary(\n    name = \"libtensorflow_gpu.a\",\n    linkstatic = 1,\n    linkshared = 0,\n    deps = [\n        \"//tensorflow/c:c_api\",\n        \"//tensorflow/core:tensorflow\",\n    ],\n)\n\nbut it failed, it will show these log\n\nERROR: /gruntdata/jefby/alicpp/external/tensorflowserving/tensorflowserving-50129ec0b407e5778282ee8d7610a9494cfcf6b2/tensorflow/tensorflow/BUILD:209:1: Linking of rule '//tensorflow:libtensorflow_gpu.a' failed: gcc failed: error executing command /usr/bin/gcc -o bazel-out/local-opt/bin/tensorflow/libtensorflow_gpu.a -pthread -Wl,-no-as-needed -B/usr/bin -B/usr/bin -pass-exit-codes '-Wl,--build-id=md5' '-Wl,--hash-style=gnu' -Wl,--gc-sections ... (remaining 1 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\n/usr/lib/gcc/x86_64-unknown-linux-gnu/4.9.2/../../../../lib64/crt1.o: In function _start': (.text+0x20): undefined reference to main'\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow:libtensorflow_gpu.a failed to build", "body": "Is there a way to ask the build system bazel to build a static library that one can link a program written using the C++ API against? My apologies for this simple question, but I am very unfamiliar with this build system. I try to add some code to tensorflow/tensorflow/BUILD\r\n\r\n```\r\ncc_binary(\r\n    name = \"libtensorflow_gpu.a\",\r\n    linkstatic = 1,\r\n    linkshared = 0,\r\n    deps = [\r\n        \"//tensorflow/c:c_api\",\r\n        \"//tensorflow/core:tensorflow\",\r\n    ],\r\n)\r\n```\r\n\r\nbut it failed, it will show these log\r\n\r\n\r\n>ERROR: /gruntdata/jefby/alicpp/external/tensorflowserving/tensorflowserving-50129ec0b407e5778282ee8d7610a9494cfcf6b2/tensorflow/tensorflow/BUILD:209:1: Linking of rule '//tensorflow:libtensorflow_gpu.a' failed: gcc failed: error executing command /usr/bin/gcc -o bazel-out/local-opt/bin/tensorflow/libtensorflow_gpu.a -pthread -Wl,-no-as-needed -B/usr/bin -B/usr/bin -pass-exit-codes '-Wl,--build-id=md5' '-Wl,--hash-style=gnu' -Wl,--gc-sections ... (remaining 1 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\r\n/usr/lib/gcc/x86_64-unknown-linux-gnu/4.9.2/../../../../lib64/crt1.o: In function `_start':\r\n(.text+0x20): undefined reference to `main'\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow:libtensorflow_gpu.a failed to build\r\n\r\n\r\n\r\n"}