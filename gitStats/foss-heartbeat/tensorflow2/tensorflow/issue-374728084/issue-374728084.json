{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23325", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23325/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23325/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23325/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23325", "id": 374728084, "node_id": "MDU6SXNzdWUzNzQ3MjgwODQ=", "number": 23325, "title": "tf.contrib.image.dense_image_warp to support dynamic shape tensor input", "user": {"login": "zldrobit", "id": 3896992, "node_id": "MDQ6VXNlcjM4OTY5OTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/3896992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zldrobit", "html_url": "https://github.com/zldrobit", "followers_url": "https://api.github.com/users/zldrobit/followers", "following_url": "https://api.github.com/users/zldrobit/following{/other_user}", "gists_url": "https://api.github.com/users/zldrobit/gists{/gist_id}", "starred_url": "https://api.github.com/users/zldrobit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zldrobit/subscriptions", "organizations_url": "https://api.github.com/users/zldrobit/orgs", "repos_url": "https://api.github.com/users/zldrobit/repos", "events_url": "https://api.github.com/users/zldrobit/events{/privacy}", "received_events_url": "https://api.github.com/users/zldrobit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, {"login": "harshini-gadige", "id": 42781361, "node_id": "MDQ6VXNlcjQyNzgxMzYx", "avatar_url": "https://avatars1.githubusercontent.com/u/42781361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshini-gadige", "html_url": "https://github.com/harshini-gadige", "followers_url": "https://api.github.com/users/harshini-gadige/followers", "following_url": "https://api.github.com/users/harshini-gadige/following{/other_user}", "gists_url": "https://api.github.com/users/harshini-gadige/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshini-gadige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshini-gadige/subscriptions", "organizations_url": "https://api.github.com/users/harshini-gadige/orgs", "repos_url": "https://api.github.com/users/harshini-gadige/repos", "events_url": "https://api.github.com/users/harshini-gadige/events{/privacy}", "received_events_url": "https://api.github.com/users/harshini-gadige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-10-28T07:58:06Z", "updated_at": "2018-11-16T17:31:39Z", "closed_at": "2018-11-16T13:51:51Z", "author_association": "CONTRIBUTOR", "body_html": "<p><em>Please make sure that this is a feature request. As per our <a href=\"https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md\">GitHub Policy</a>, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em></p>\n<p><strong>System information</strong></p>\n<ul>\n<li>TensorFlow version (you are using): 1.11.0</li>\n<li>Are you willing to contribute it (Yes/No): Yes</li>\n</ul>\n<p><strong>Describe the feature and the current behavior/state.</strong><br>\nI used optical flow to warp images with TF function tf.contrib.image.dense_image_warp . However, the current version  does not support dynamic shapes.</p>\n<p><strong>Will this change the current api? How?</strong><br>\nNo.</p>\n<p><strong>Who will benefit with this feature?</strong><br>\nPeople use this function to warp images.</p>\n<p><strong>Any Other info.</strong><br>\nThe source code of dense_image_warp:</p>\n<hr>\n<pre><code>  with ops.name_scope(name):\n    batch_size, height, width, channels = image.get_shape().as_list()\n    # The flow is defined on the image grid. Turn the flow into a list of query\n    # points in the grid space.\n    grid_x, grid_y = array_ops.meshgrid(\n        math_ops.range(width), math_ops.range(height))\n    stacked_grid = math_ops.cast(\n        array_ops.stack([grid_y, grid_x], axis=2), flow.dtype)\n    batched_grid = array_ops.expand_dims(stacked_grid, axis=0)\n    query_points_on_grid = batched_grid - flow\n    query_points_flattened = array_ops.reshape(query_points_on_grid,\n                                               [batch_size, height * width, 2])\n    # Compute values at the query points, then reshape the result back to the\n    # image grid.\n    interpolated = _interpolate_bilinear(image, query_points_flattened)\n    interpolated = array_ops.reshape(interpolated,\n                                     [batch_size, height, width, channels])\n    return interpolated\n</code></pre>\n<hr>\n<p>I think changing<br>\n<code>batch_size, height, width, channels = image.get_shape().as_list()</code><br>\nto<br>\n<code>batch_size, height, width, channels = tf.shape(image).as_list()</code><br>\nmight be sufficient.</p>", "body_text": "Please make sure that this is a feature request. As per our GitHub Policy, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template\nSystem information\n\nTensorFlow version (you are using): 1.11.0\nAre you willing to contribute it (Yes/No): Yes\n\nDescribe the feature and the current behavior/state.\nI used optical flow to warp images with TF function tf.contrib.image.dense_image_warp . However, the current version  does not support dynamic shapes.\nWill this change the current api? How?\nNo.\nWho will benefit with this feature?\nPeople use this function to warp images.\nAny Other info.\nThe source code of dense_image_warp:\n\n  with ops.name_scope(name):\n    batch_size, height, width, channels = image.get_shape().as_list()\n    # The flow is defined on the image grid. Turn the flow into a list of query\n    # points in the grid space.\n    grid_x, grid_y = array_ops.meshgrid(\n        math_ops.range(width), math_ops.range(height))\n    stacked_grid = math_ops.cast(\n        array_ops.stack([grid_y, grid_x], axis=2), flow.dtype)\n    batched_grid = array_ops.expand_dims(stacked_grid, axis=0)\n    query_points_on_grid = batched_grid - flow\n    query_points_flattened = array_ops.reshape(query_points_on_grid,\n                                               [batch_size, height * width, 2])\n    # Compute values at the query points, then reshape the result back to the\n    # image grid.\n    interpolated = _interpolate_bilinear(image, query_points_flattened)\n    interpolated = array_ops.reshape(interpolated,\n                                     [batch_size, height, width, channels])\n    return interpolated\n\n\nI think changing\nbatch_size, height, width, channels = image.get_shape().as_list()\nto\nbatch_size, height, width, channels = tf.shape(image).as_list()\nmight be sufficient.", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 1.11.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nI used optical flow to warp images with TF function tf.contrib.image.dense_image_warp . However, the current version  does not support dynamic shapes. \r\n\r\n**Will this change the current api? How?**\r\nNo.\r\n\r\n**Who will benefit with this feature?**\r\nPeople use this function to warp images.\r\n\r\n**Any Other info.**\r\nThe source code of dense_image_warp:\r\n***********\r\n```\r\n  with ops.name_scope(name):\r\n    batch_size, height, width, channels = image.get_shape().as_list()\r\n    # The flow is defined on the image grid. Turn the flow into a list of query\r\n    # points in the grid space.\r\n    grid_x, grid_y = array_ops.meshgrid(\r\n        math_ops.range(width), math_ops.range(height))\r\n    stacked_grid = math_ops.cast(\r\n        array_ops.stack([grid_y, grid_x], axis=2), flow.dtype)\r\n    batched_grid = array_ops.expand_dims(stacked_grid, axis=0)\r\n    query_points_on_grid = batched_grid - flow\r\n    query_points_flattened = array_ops.reshape(query_points_on_grid,\r\n                                               [batch_size, height * width, 2])\r\n    # Compute values at the query points, then reshape the result back to the\r\n    # image grid.\r\n    interpolated = _interpolate_bilinear(image, query_points_flattened)\r\n    interpolated = array_ops.reshape(interpolated,\r\n                                     [batch_size, height, width, channels])\r\n    return interpolated\r\n```\r\n\r\n*************\r\nI think changing \r\n`batch_size, height, width, channels = image.get_shape().as_list()`\r\nto\r\n`batch_size, height, width, channels = tf.shape(image).as_list()`\r\nmight be sufficient."}