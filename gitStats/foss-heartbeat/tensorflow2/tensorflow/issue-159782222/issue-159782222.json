{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2807", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2807/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2807/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2807/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2807", "id": 159782222, "node_id": "MDU6SXNzdWUxNTk3ODIyMjI=", "number": 2807, "title": "Slow quantized graph", "user": {"login": "changyun79", "id": 19846701, "node_id": "MDQ6VXNlcjE5ODQ2NzAx", "avatar_url": "https://avatars3.githubusercontent.com/u/19846701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/changyun79", "html_url": "https://github.com/changyun79", "followers_url": "https://api.github.com/users/changyun79/followers", "following_url": "https://api.github.com/users/changyun79/following{/other_user}", "gists_url": "https://api.github.com/users/changyun79/gists{/gist_id}", "starred_url": "https://api.github.com/users/changyun79/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/changyun79/subscriptions", "organizations_url": "https://api.github.com/users/changyun79/orgs", "repos_url": "https://api.github.com/users/changyun79/repos", "events_url": "https://api.github.com/users/changyun79/events{/privacy}", "received_events_url": "https://api.github.com/users/changyun79/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 38, "created_at": "2016-06-11T16:50:02Z", "updated_at": "2018-01-29T22:29:02Z", "closed_at": "2018-01-29T22:29:02Z", "author_association": "NONE", "body_html": "<ol>\n<li>\n<p>On Ubuntu 15.10 with CUDA 7.5, cuDNN 7.0, tensorflow-0.9.0rc0, ran \"tensorflow/examples/label_image/\" application by taking inception-v3 graph and roughly measure the elapsed time.</p>\n</li>\n<li>\n<p>Then take \"tensorflow/contrib/quantization/tools:quantize_graph\" to quant inception-v3, rebuilt application by giving</p>\n<pre><code>\"//tensorflow/contrib/quantization:cc_ops\",\n\"//tensorflow/contrib/quantization/kernels:quantized_ops\",\n</code></pre>\n</li>\n</ol>\n<p>into \"tensorflow/examples/label_image/BUILD\" and redo the same classification and measure the time.</p>\n<p>Before/After quantization, elapsed time were 6 seconds vs. 17 seconds, i.e. quantization doubled the inference time?</p>\n<p>The results looks ok as below so I think I was running it correctly.<br>\nBefore</p>\n<ul>\n<li>military uniform (866): 0.647299</li>\n<li>suit (794): 0.0477195</li>\n<li>academic gown (896): 0.0232407</li>\n<li>bow tie (817): 0.0157355</li>\n<li>bolo tie (940): 0.0145023</li>\n</ul>\n<p>After</p>\n<ul>\n<li>military uniform (866): 0.703474</li>\n<li>suit (794): 0.0248454</li>\n<li>bow tie (817): 0.0171362</li>\n<li>bolo tie (940): 0.0171362</li>\n<li>academic gown (896): 0.0164432</li>\n</ul>\n<p>My tensor flow was built as CPU only. Have also tried to enable GPU while the timing didn't change. Do we know what the expected performance would be?</p>", "body_text": "On Ubuntu 15.10 with CUDA 7.5, cuDNN 7.0, tensorflow-0.9.0rc0, ran \"tensorflow/examples/label_image/\" application by taking inception-v3 graph and roughly measure the elapsed time.\n\n\nThen take \"tensorflow/contrib/quantization/tools:quantize_graph\" to quant inception-v3, rebuilt application by giving\n\"//tensorflow/contrib/quantization:cc_ops\",\n\"//tensorflow/contrib/quantization/kernels:quantized_ops\",\n\n\n\ninto \"tensorflow/examples/label_image/BUILD\" and redo the same classification and measure the time.\nBefore/After quantization, elapsed time were 6 seconds vs. 17 seconds, i.e. quantization doubled the inference time?\nThe results looks ok as below so I think I was running it correctly.\nBefore\n\nmilitary uniform (866): 0.647299\nsuit (794): 0.0477195\nacademic gown (896): 0.0232407\nbow tie (817): 0.0157355\nbolo tie (940): 0.0145023\n\nAfter\n\nmilitary uniform (866): 0.703474\nsuit (794): 0.0248454\nbow tie (817): 0.0171362\nbolo tie (940): 0.0171362\nacademic gown (896): 0.0164432\n\nMy tensor flow was built as CPU only. Have also tried to enable GPU while the timing didn't change. Do we know what the expected performance would be?", "body": "1. On Ubuntu 15.10 with CUDA 7.5, cuDNN 7.0, tensorflow-0.9.0rc0, ran \"tensorflow/examples/label_image/\" application by taking inception-v3 graph and roughly measure the elapsed time. \n2. Then take \"tensorflow/contrib/quantization/tools:quantize_graph\" to quant inception-v3, rebuilt application by giving \n   \n   ```\n   \"//tensorflow/contrib/quantization:cc_ops\",\n   \"//tensorflow/contrib/quantization/kernels:quantized_ops\",\n   ```\n\ninto \"tensorflow/examples/label_image/BUILD\" and redo the same classification and measure the time. \n\nBefore/After quantization, elapsed time were 6 seconds vs. 17 seconds, i.e. quantization doubled the inference time? \n\nThe results looks ok as below so I think I was running it correctly. \nBefore\n- military uniform (866): 0.647299\n- suit (794): 0.0477195\n- academic gown (896): 0.0232407\n- bow tie (817): 0.0157355\n- bolo tie (940): 0.0145023\n\nAfter\n- military uniform (866): 0.703474\n- suit (794): 0.0248454\n- bow tie (817): 0.0171362\n- bolo tie (940): 0.0171362\n- academic gown (896): 0.0164432\n\nMy tensor flow was built as CPU only. Have also tried to enable GPU while the timing didn't change. Do we know what the expected performance would be? \n"}