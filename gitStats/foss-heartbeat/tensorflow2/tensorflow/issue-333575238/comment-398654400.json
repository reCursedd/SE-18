{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/398654400", "html_url": "https://github.com/tensorflow/tensorflow/issues/20116#issuecomment-398654400", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20116", "id": 398654400, "node_id": "MDEyOklzc3VlQ29tbWVudDM5ODY1NDQwMA==", "user": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-20T07:38:32Z", "updated_at": "2018-06-20T07:38:32Z", "author_association": "MEMBER", "body_html": "<p><code>tf.contrib.eager.gradients_function</code> can only differentiate through TensorFlow operations.<br>\nSo it can't differentiate through <code>math.pow</code> but it can through <code>tf.pow</code>. Could you elaborate on which version of TensorFlow you're using? I tried the following on TensorFlow 1.8 and it seems to be correct:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\ntf.enable_eager_execution()\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">dp1_f1</span>(<span class=\"pl-smi\">x</span>):\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">64</span><span class=\"pl-k\">*</span>x<span class=\"pl-k\">*</span>(<span class=\"pl-c1\">1</span><span class=\"pl-k\">-</span>x)<span class=\"pl-k\">*</span>(tf.pow((<span class=\"pl-c1\">1</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">2</span><span class=\"pl-k\">*</span>x),<span class=\"pl-c1\">2</span>) )<span class=\"pl-k\">*</span>tf.pow((<span class=\"pl-c1\">1</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">8</span><span class=\"pl-k\">*</span>x<span class=\"pl-k\">+</span><span class=\"pl-c1\">8</span><span class=\"pl-k\">*</span>x<span class=\"pl-k\">*</span>x), <span class=\"pl-c1\">2</span>)\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">dp_numeric_diff</span>(<span class=\"pl-smi\">x</span>):\n    delta_x <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0.0001</span>\n    <span class=\"pl-k\">return</span> (dp1_f1(x<span class=\"pl-k\">+</span>delta_x)<span class=\"pl-k\">-</span>dp1_f1(x))<span class=\"pl-k\">/</span>delta_x\n\ngrad <span class=\"pl-k\">=</span> tf.contrib.eager.gradients_function(dp1_f1)\n\n<span class=\"pl-c1\">print</span>(dp_numeric_diff(<span class=\"pl-c1\">3.0</span>).numpy()) <span class=\"pl-c\"><span class=\"pl-c\">#</span> Prints -75300000.0</span>\n<span class=\"pl-c1\">print</span>(grad(<span class=\"pl-c1\">3.0</span>)[<span class=\"pl-c1\">0</span>].numpy())         <span class=\"pl-c\"><span class=\"pl-c\">#</span> Prints -75279680.0</span></pre></div>", "body_text": "tf.contrib.eager.gradients_function can only differentiate through TensorFlow operations.\nSo it can't differentiate through math.pow but it can through tf.pow. Could you elaborate on which version of TensorFlow you're using? I tried the following on TensorFlow 1.8 and it seems to be correct:\nimport tensorflow as tf\ntf.enable_eager_execution()\n\ndef dp1_f1(x):\n    return 64*x*(1-x)*(tf.pow((1-2*x),2) )*tf.pow((1-8*x+8*x*x), 2)\n\ndef dp_numeric_diff(x):\n    delta_x = 0.0001\n    return (dp1_f1(x+delta_x)-dp1_f1(x))/delta_x\n\ngrad = tf.contrib.eager.gradients_function(dp1_f1)\n\nprint(dp_numeric_diff(3.0).numpy()) # Prints -75300000.0\nprint(grad(3.0)[0].numpy())         # Prints -75279680.0", "body": "`tf.contrib.eager.gradients_function` can only differentiate through TensorFlow operations.\r\nSo it can't differentiate through `math.pow` but it can through `tf.pow`. Could you elaborate on which version of TensorFlow you're using? I tried the following on TensorFlow 1.8 and it seems to be correct:\r\n\r\n```python\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\n\r\ndef dp1_f1(x):\r\n    return 64*x*(1-x)*(tf.pow((1-2*x),2) )*tf.pow((1-8*x+8*x*x), 2)\r\n\r\ndef dp_numeric_diff(x):\r\n    delta_x = 0.0001\r\n    return (dp1_f1(x+delta_x)-dp1_f1(x))/delta_x\r\n\r\ngrad = tf.contrib.eager.gradients_function(dp1_f1)\r\n\r\nprint(dp_numeric_diff(3.0).numpy()) # Prints -75300000.0\r\nprint(grad(3.0)[0].numpy())         # Prints -75279680.0\r\n```"}