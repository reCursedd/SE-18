{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/412517484", "html_url": "https://github.com/tensorflow/tensorflow/pull/21202#issuecomment-412517484", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21202", "id": 412517484, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMjUxNzQ4NA==", "user": {"login": "Hong-Xiang", "id": 11002856, "node_id": "MDQ6VXNlcjExMDAyODU2", "avatar_url": "https://avatars2.githubusercontent.com/u/11002856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hong-Xiang", "html_url": "https://github.com/Hong-Xiang", "followers_url": "https://api.github.com/users/Hong-Xiang/followers", "following_url": "https://api.github.com/users/Hong-Xiang/following{/other_user}", "gists_url": "https://api.github.com/users/Hong-Xiang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hong-Xiang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hong-Xiang/subscriptions", "organizations_url": "https://api.github.com/users/Hong-Xiang/orgs", "repos_url": "https://api.github.com/users/Hong-Xiang/repos", "events_url": "https://api.github.com/users/Hong-Xiang/events{/privacy}", "received_events_url": "https://api.github.com/users/Hong-Xiang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-13T13:27:20Z", "updated_at": "2018-08-13T14:46:03Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16018\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/asimshankar\">@asimshankar</a> I'm trying to change SWIG interface to fix the problem as you suggested. However I got the following error:</p>\n<pre><code>ERROR: \n(cache directory)/external/protobuf_archive/BUILD:659:1: C++ compilation of rule '@protobuf_archive//:python/google/protobuf/pyext/_message.so' failed (Exit 1)\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc: In function \u2018bool google::protobuf::python::descriptor::_GetItemByKey(google::protobuf::python::PyContainer*, PyObject*, const void**)\u2019:\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:69:45: error: invalid conversion from \u2018const char*\u2019 to \u2018char*\u2019 [-fpermissive]\n        ((*(charpp) = PyUnicode_AsUTF8AndSize(ob, (sizep))) == NULL? -1: 0): \\\n                                             ^\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:172:13: note: in expansion of macro \u2018PyString_AsStringAndSize\u2019\n         if (PyString_AsStringAndSize(key, &amp;name, &amp;name_size) &lt; 0) {\n             ^\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:69:45: error: invalid conversion from \u2018const char*\u2019 to \u2018char*\u2019 [-fpermissive]\n        ((*(charpp) = PyUnicode_AsUTF8AndSize(ob, (sizep))) == NULL? -1: 0): \\\n                                             ^\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:189:13: note: in expansion of macro \u2018PyString_AsStringAndSize\u2019\n         if (PyString_AsStringAndSize(key, &amp;camelcase_name, &amp;name_size) &lt; 0) {\n             ^\nAt global scope:\ncc1plus: warning: unrecognized command line option \u2018-Wno-writable-strings\u2019\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\n</code></pre>\n<p>It seems that <code>const_cast</code> problem still exists, and I just can't find file named <code>descriptor_containers.cc</code>. It seems this is caused by protobuf, can we solve this only modifying source of tensorflow?</p>\n<p><a href=\"https://github.com/google/protobuf/pull/4862\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/protocolbuffers/protobuf/pull/4862/hovercard\">Fix of protobuf</a></p>", "body_text": "@asimshankar I'm trying to change SWIG interface to fix the problem as you suggested. However I got the following error:\nERROR: \n(cache directory)/external/protobuf_archive/BUILD:659:1: C++ compilation of rule '@protobuf_archive//:python/google/protobuf/pyext/_message.so' failed (Exit 1)\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc: In function \u2018bool google::protobuf::python::descriptor::_GetItemByKey(google::protobuf::python::PyContainer*, PyObject*, const void**)\u2019:\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:69:45: error: invalid conversion from \u2018const char*\u2019 to \u2018char*\u2019 [-fpermissive]\n        ((*(charpp) = PyUnicode_AsUTF8AndSize(ob, (sizep))) == NULL? -1: 0): \\\n                                             ^\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:172:13: note: in expansion of macro \u2018PyString_AsStringAndSize\u2019\n         if (PyString_AsStringAndSize(key, &name, &name_size) < 0) {\n             ^\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:69:45: error: invalid conversion from \u2018const char*\u2019 to \u2018char*\u2019 [-fpermissive]\n        ((*(charpp) = PyUnicode_AsUTF8AndSize(ob, (sizep))) == NULL? -1: 0): \\\n                                             ^\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:189:13: note: in expansion of macro \u2018PyString_AsStringAndSize\u2019\n         if (PyString_AsStringAndSize(key, &camelcase_name, &name_size) < 0) {\n             ^\nAt global scope:\ncc1plus: warning: unrecognized command line option \u2018-Wno-writable-strings\u2019\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\n\nIt seems that const_cast problem still exists, and I just can't find file named descriptor_containers.cc. It seems this is caused by protobuf, can we solve this only modifying source of tensorflow?\nFix of protobuf", "body": "@asimshankar I'm trying to change SWIG interface to fix the problem as you suggested. However I got the following error:\r\n```\r\nERROR: \r\n(cache directory)/external/protobuf_archive/BUILD:659:1: C++ compilation of rule '@protobuf_archive//:python/google/protobuf/pyext/_message.so' failed (Exit 1)\r\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc: In function \u2018bool google::protobuf::python::descriptor::_GetItemByKey(google::protobuf::python::PyContainer*, PyObject*, const void**)\u2019:\r\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:69:45: error: invalid conversion from \u2018const char*\u2019 to \u2018char*\u2019 [-fpermissive]\r\n        ((*(charpp) = PyUnicode_AsUTF8AndSize(ob, (sizep))) == NULL? -1: 0): \\\r\n                                             ^\r\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:172:13: note: in expansion of macro \u2018PyString_AsStringAndSize\u2019\r\n         if (PyString_AsStringAndSize(key, &name, &name_size) < 0) {\r\n             ^\r\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:69:45: error: invalid conversion from \u2018const char*\u2019 to \u2018char*\u2019 [-fpermissive]\r\n        ((*(charpp) = PyUnicode_AsUTF8AndSize(ob, (sizep))) == NULL? -1: 0): \\\r\n                                             ^\r\nexternal/protobuf_archive/python/google/protobuf/pyext/descriptor_containers.cc:189:13: note: in expansion of macro \u2018PyString_AsStringAndSize\u2019\r\n         if (PyString_AsStringAndSize(key, &camelcase_name, &name_size) < 0) {\r\n             ^\r\nAt global scope:\r\ncc1plus: warning: unrecognized command line option \u2018-Wno-writable-strings\u2019\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\n```\r\n\r\nIt seems that `const_cast` problem still exists, and I just can't find file named `descriptor_containers.cc`. It seems this is caused by protobuf, can we solve this only modifying source of tensorflow?\r\n\r\n[Fix of protobuf](https://github.com/google/protobuf/pull/4862)"}