{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/330145559", "html_url": "https://github.com/tensorflow/tensorflow/issues/11471#issuecomment-330145559", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11471", "id": 330145559, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDE0NTU1OQ==", "user": {"login": "yehenrytian", "id": 4379480, "node_id": "MDQ6VXNlcjQzNzk0ODA=", "avatar_url": "https://avatars2.githubusercontent.com/u/4379480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yehenrytian", "html_url": "https://github.com/yehenrytian", "followers_url": "https://api.github.com/users/yehenrytian/followers", "following_url": "https://api.github.com/users/yehenrytian/following{/other_user}", "gists_url": "https://api.github.com/users/yehenrytian/gists{/gist_id}", "starred_url": "https://api.github.com/users/yehenrytian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yehenrytian/subscriptions", "organizations_url": "https://api.github.com/users/yehenrytian/orgs", "repos_url": "https://api.github.com/users/yehenrytian/repos", "events_url": "https://api.github.com/users/yehenrytian/events{/privacy}", "received_events_url": "https://api.github.com/users/yehenrytian/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-18T07:25:35Z", "updated_at": "2017-09-18T07:25:35Z", "author_association": "NONE", "body_html": "<p>I got the similar (or the same) error when turning on XLA jit for the WDL example: <a href=\"https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/examples/learn/wide_n_deep_tutorial.py\">https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/examples/learn/wide_n_deep_tutorial.py</a></p>\n<pre><code>LLVM ERROR: Cannot select: t24: i16,ch = AtomicCmpSwap&lt;Volatile LDST1[%fusion.1.typed27(addrspace=1)]&gt; t0, t11, t2, t21\n\n  t11: i64,ch = CopyFromReg t0, Register:i64 %vreg1\n    t10: i64 = Register %vreg1\n  t2: i16,ch = CopyFromReg t0, Register:i16 %vreg18\n    t1: i16 = Register %vreg18\n  t21: i16 = and t2, t7\n    t2: i16,ch = CopyFromReg t0, Register:i16 %vreg18\n      t1: i16 = Register %vreg18\n    t7: i16 = AssertZext t5, ValueType:ch:i1\n      t5: i16,ch = CopyFromReg t0, Register:i16 %vreg14\n        t4: i16 = Register %vreg14\nIn function: _fusion_1__1\n</code></pre>\n<p>I tried to use a newer stable version of LLVM in: <code>workspace.bzl</code>:</p>\n<pre><code>temp_workaround_http_archive(\n      name = \"llvm\",\n      urls = [\n          \"https://github.com/llvm-mirror/llvm/archive/stable.tar.gz\",\n      ],\n      sha256 = \"5491bd0608ca59b94d5fe0a9892494fac263c9e1bd6ab2d4f4dc0e495e29670e\", \n      strip_prefix = \"llvm-stable\",\n      build_file = str(Label(\"//third_party/llvm:llvm.BUILD\")),\n      repository = tf_repo_name,\n  )\n</code></pre>\n<p>But the problem still exist, I am wondering if there is something wrong in the <code>LLVM IR emitter</code> of the XLA code?</p>", "body_text": "I got the similar (or the same) error when turning on XLA jit for the WDL example: https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/examples/learn/wide_n_deep_tutorial.py\nLLVM ERROR: Cannot select: t24: i16,ch = AtomicCmpSwap<Volatile LDST1[%fusion.1.typed27(addrspace=1)]> t0, t11, t2, t21\n\n  t11: i64,ch = CopyFromReg t0, Register:i64 %vreg1\n    t10: i64 = Register %vreg1\n  t2: i16,ch = CopyFromReg t0, Register:i16 %vreg18\n    t1: i16 = Register %vreg18\n  t21: i16 = and t2, t7\n    t2: i16,ch = CopyFromReg t0, Register:i16 %vreg18\n      t1: i16 = Register %vreg18\n    t7: i16 = AssertZext t5, ValueType:ch:i1\n      t5: i16,ch = CopyFromReg t0, Register:i16 %vreg14\n        t4: i16 = Register %vreg14\nIn function: _fusion_1__1\n\nI tried to use a newer stable version of LLVM in: workspace.bzl:\ntemp_workaround_http_archive(\n      name = \"llvm\",\n      urls = [\n          \"https://github.com/llvm-mirror/llvm/archive/stable.tar.gz\",\n      ],\n      sha256 = \"5491bd0608ca59b94d5fe0a9892494fac263c9e1bd6ab2d4f4dc0e495e29670e\", \n      strip_prefix = \"llvm-stable\",\n      build_file = str(Label(\"//third_party/llvm:llvm.BUILD\")),\n      repository = tf_repo_name,\n  )\n\nBut the problem still exist, I am wondering if there is something wrong in the LLVM IR emitter of the XLA code?", "body": "I got the similar (or the same) error when turning on XLA jit for the WDL example: [https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/examples/learn/wide_n_deep_tutorial.py](https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/examples/learn/wide_n_deep_tutorial.py)\r\n\r\n```\r\nLLVM ERROR: Cannot select: t24: i16,ch = AtomicCmpSwap<Volatile LDST1[%fusion.1.typed27(addrspace=1)]> t0, t11, t2, t21\r\n\r\n  t11: i64,ch = CopyFromReg t0, Register:i64 %vreg1\r\n    t10: i64 = Register %vreg1\r\n  t2: i16,ch = CopyFromReg t0, Register:i16 %vreg18\r\n    t1: i16 = Register %vreg18\r\n  t21: i16 = and t2, t7\r\n    t2: i16,ch = CopyFromReg t0, Register:i16 %vreg18\r\n      t1: i16 = Register %vreg18\r\n    t7: i16 = AssertZext t5, ValueType:ch:i1\r\n      t5: i16,ch = CopyFromReg t0, Register:i16 %vreg14\r\n        t4: i16 = Register %vreg14\r\nIn function: _fusion_1__1\r\n```\r\nI tried to use a newer stable version of LLVM in: `workspace.bzl`:\r\n```\r\ntemp_workaround_http_archive(\r\n      name = \"llvm\",\r\n      urls = [\r\n          \"https://github.com/llvm-mirror/llvm/archive/stable.tar.gz\",\r\n      ],\r\n      sha256 = \"5491bd0608ca59b94d5fe0a9892494fac263c9e1bd6ab2d4f4dc0e495e29670e\", \r\n      strip_prefix = \"llvm-stable\",\r\n      build_file = str(Label(\"//third_party/llvm:llvm.BUILD\")),\r\n      repository = tf_repo_name,\r\n  )\r\n```\r\nBut the problem still exist, I am wondering if there is something wrong in the `LLVM IR emitter` of the XLA code?"}