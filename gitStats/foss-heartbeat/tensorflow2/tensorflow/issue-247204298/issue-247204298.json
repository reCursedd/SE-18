{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11950", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11950/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11950/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11950/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11950", "id": 247204298, "node_id": "MDU6SXNzdWUyNDcyMDQyOTg=", "number": 11950, "title": "Issues with tensordot and axes is list of ints", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-08-01T21:17:03Z", "updated_at": "2017-08-07T22:50:28Z", "closed_at": "2017-08-07T22:50:28Z", "author_association": "CONTRIBUTOR", "body_html": "<pre><code>== cat /etc/issue ===============================================\nLinux node014-jupyter-20170708-132328 4.4.0-1022-aws #31-Ubuntu SMP Tue Jun 27 11:27:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\nVERSION_ID=\"16.04\"\nVERSION_CODENAME=xenial\n\n== are we in docker =============================================\nYes\n\n== compiler =====================================================\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\n== uname -a =====================================================\nLinux node014-jupyter-20170708-132328 4.4.0-1022-aws #31-Ubuntu SMP Tue Jun 27 11:27:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.13.0)\nprotobuf (3.2.0)\ntensorflow-gpu (1.2.1)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.2.1\ntf.GIT_VERSION = v1.2.0-5-g435cdfc\ntf.COMPILER_VERSION = v1.2.0-5-g435cdfc\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH /usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nTue Aug  1 17:13:34 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.66                 Driver Version: 375.66                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  Tesla K80           Off  | 0000:00:1E.0     Off |                    0 |\n| N/A   59C    P0    67W / 149W |      0MiB / 11439MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\n</code></pre>\n<h3>Describe the problem</h3>\n<p><code>np.tensordot</code> works for a given set of settings but <code>tf.tensordot</code> does not.</p>\n<h3>Source code / logs</h3>\n<p>This works:</p>\n<div class=\"highlight highlight-source-python\"><pre>np.tensordot(np.ones((<span class=\"pl-c1\">3</span>,<span class=\"pl-c1\">3</span>)), np.array([<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1</span>])[<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">None</span>], <span class=\"pl-v\">axes</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>])</pre></div>\n<p>but this does not:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n    sess.run(\n         tf.tensordot(tf.ones((<span class=\"pl-c1\">3</span>,<span class=\"pl-c1\">3</span>), <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32), tf.constant([<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1</span>], <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32)[<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">None</span>], <span class=\"pl-v\">axes</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>])\n    )</pre></div>\n<p>I get:</p>\n<pre lang=\"py3tb\"><code>TypeError                                 Traceback (most recent call last)\n&lt;ipython-input-1-e93670defe29&gt; in &lt;module&gt;()\n      2 with tf.Session() as sess:\n      3     sess.run(\n----&gt; 4         tf.tensordot(tf.ones((3,3), dtype=tf.float32), tf.constant([2, 3, 1], dtype=tf.float32)[None, None], axes=[1, 2])\n      5     )\n\n~/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py in tensordot(a, b, axes, name)\n   2415     a = ops.convert_to_tensor(a, name=\"a\")\n   2416     b = ops.convert_to_tensor(b, name=\"b\")\n-&gt; 2417     a_axes, b_axes = _tensordot_axes(a, axes)\n   2418     a_reshape, a_free_dims, a_free_dims_static = _tensordot_reshape(a, a_axes)\n   2419     b_reshape, b_free_dims, b_free_dims_static = _tensordot_reshape(b, b_axes,\n\n~/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py in _tensordot_axes(a, axes)\n   2403       a_axes = axes[0]\n   2404       b_axes = axes[1]\n-&gt; 2405       if len(a_axes) != len(b_axes):\n   2406         raise ValueError(\n   2407             \"Different number of contraction axes 'a' and 'b', %s != %s.\",\n\nTypeError: object of type 'int' has no len()\n</code></pre>", "body_text": "== cat /etc/issue ===============================================\nLinux node014-jupyter-20170708-132328 4.4.0-1022-aws #31-Ubuntu SMP Tue Jun 27 11:27:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\nVERSION_ID=\"16.04\"\nVERSION_CODENAME=xenial\n\n== are we in docker =============================================\nYes\n\n== compiler =====================================================\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\n== uname -a =====================================================\nLinux node014-jupyter-20170708-132328 4.4.0-1022-aws #31-Ubuntu SMP Tue Jun 27 11:27:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.13.0)\nprotobuf (3.2.0)\ntensorflow-gpu (1.2.1)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.2.1\ntf.GIT_VERSION = v1.2.0-5-g435cdfc\ntf.COMPILER_VERSION = v1.2.0-5-g435cdfc\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH /usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nTue Aug  1 17:13:34 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.66                 Driver Version: 375.66                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  Tesla K80           Off  | 0000:00:1E.0     Off |                    0 |\n| N/A   59C    P0    67W / 149W |      0MiB / 11439MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\n\nDescribe the problem\nnp.tensordot works for a given set of settings but tf.tensordot does not.\nSource code / logs\nThis works:\nnp.tensordot(np.ones((3,3)), np.array([2, 3, 1])[None, None], axes=[1, 2])\nbut this does not:\nwith tf.Session() as sess:\n    sess.run(\n         tf.tensordot(tf.ones((3,3), dtype=tf.float32), tf.constant([2, 3, 1], dtype=tf.float32)[None, None], axes=[1, 2])\n    )\nI get:\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-e93670defe29> in <module>()\n      2 with tf.Session() as sess:\n      3     sess.run(\n----> 4         tf.tensordot(tf.ones((3,3), dtype=tf.float32), tf.constant([2, 3, 1], dtype=tf.float32)[None, None], axes=[1, 2])\n      5     )\n\n~/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py in tensordot(a, b, axes, name)\n   2415     a = ops.convert_to_tensor(a, name=\"a\")\n   2416     b = ops.convert_to_tensor(b, name=\"b\")\n-> 2417     a_axes, b_axes = _tensordot_axes(a, axes)\n   2418     a_reshape, a_free_dims, a_free_dims_static = _tensordot_reshape(a, a_axes)\n   2419     b_reshape, b_free_dims, b_free_dims_static = _tensordot_reshape(b, b_axes,\n\n~/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py in _tensordot_axes(a, axes)\n   2403       a_axes = axes[0]\n   2404       b_axes = axes[1]\n-> 2405       if len(a_axes) != len(b_axes):\n   2406         raise ValueError(\n   2407             \"Different number of contraction axes 'a' and 'b', %s != %s.\",\n\nTypeError: object of type 'int' has no len()", "body": "```\r\n== cat /etc/issue ===============================================\r\nLinux node014-jupyter-20170708-132328 4.4.0-1022-aws #31-Ubuntu SMP Tue Jun 27 11:27:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nYes\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux node014-jupyter-20170708-132328 4.4.0-1022-aws #31-Ubuntu SMP Tue Jun 27 11:27:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.0)\r\nprotobuf (3.2.0)\r\ntensorflow-gpu (1.2.1)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.2.1\r\ntf.GIT_VERSION = v1.2.0-5-g435cdfc\r\ntf.COMPILER_VERSION = v1.2.0-5-g435cdfc\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nTue Aug  1 17:13:34 2017\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.66                 Driver Version: 375.66                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla K80           Off  | 0000:00:1E.0     Off |                    0 |\r\n| N/A   59C    P0    67W / 149W |      0MiB / 11439MiB |      0%   E. Process |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID  Type  Process name                               Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\r\n```\r\n### Describe the problem\r\n`np.tensordot` works for a given set of settings but `tf.tensordot` does not.\r\n\r\n### Source code / logs\r\nThis works:\r\n```python\r\nnp.tensordot(np.ones((3,3)), np.array([2, 3, 1])[None, None], axes=[1, 2])\r\n```\r\nbut this does not:\r\n```python\r\nwith tf.Session() as sess:\r\n    sess.run(\r\n         tf.tensordot(tf.ones((3,3), dtype=tf.float32), tf.constant([2, 3, 1], dtype=tf.float32)[None, None], axes=[1, 2])\r\n    )\r\n```\r\nI get:\r\n```py3tb\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-1-e93670defe29> in <module>()\r\n      2 with tf.Session() as sess:\r\n      3     sess.run(\r\n----> 4         tf.tensordot(tf.ones((3,3), dtype=tf.float32), tf.constant([2, 3, 1], dtype=tf.float32)[None, None], axes=[1, 2])\r\n      5     )\r\n\r\n~/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py in tensordot(a, b, axes, name)\r\n   2415     a = ops.convert_to_tensor(a, name=\"a\")\r\n   2416     b = ops.convert_to_tensor(b, name=\"b\")\r\n-> 2417     a_axes, b_axes = _tensordot_axes(a, axes)\r\n   2418     a_reshape, a_free_dims, a_free_dims_static = _tensordot_reshape(a, a_axes)\r\n   2419     b_reshape, b_free_dims, b_free_dims_static = _tensordot_reshape(b, b_axes,\r\n\r\n~/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py in _tensordot_axes(a, axes)\r\n   2403       a_axes = axes[0]\r\n   2404       b_axes = axes[1]\r\n-> 2405       if len(a_axes) != len(b_axes):\r\n   2406         raise ValueError(\r\n   2407             \"Different number of contraction axes 'a' and 'b', %s != %s.\",\r\n\r\nTypeError: object of type 'int' has no len()\r\n```"}