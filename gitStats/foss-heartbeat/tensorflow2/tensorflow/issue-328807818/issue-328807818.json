{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19718", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19718/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19718/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19718/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19718", "id": 328807818, "node_id": "MDU6SXNzdWUzMjg4MDc4MTg=", "number": 19718, "title": "the gradient function returned by tfe.implicit_value_and_gradients() doesn't support keyword argument", "user": {"login": "DHZS", "id": 10752166, "node_id": "MDQ6VXNlcjEwNzUyMTY2", "avatar_url": "https://avatars1.githubusercontent.com/u/10752166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DHZS", "html_url": "https://github.com/DHZS", "followers_url": "https://api.github.com/users/DHZS/followers", "following_url": "https://api.github.com/users/DHZS/following{/other_user}", "gists_url": "https://api.github.com/users/DHZS/gists{/gist_id}", "starred_url": "https://api.github.com/users/DHZS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DHZS/subscriptions", "organizations_url": "https://api.github.com/users/DHZS/orgs", "repos_url": "https://api.github.com/users/DHZS/repos", "events_url": "https://api.github.com/users/DHZS/events{/privacy}", "received_events_url": "https://api.github.com/users/DHZS/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-06-03T07:46:55Z", "updated_at": "2018-06-21T19:03:15Z", "closed_at": "2018-06-21T19:03:15Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nNo</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nWindows 10</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nBinary</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\nv1.8.0</li>\n<li><strong>Python version</strong>:<br>\nPython 3.6.4</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\nNo</li>\n<li><strong>GPU model and memory</strong>:<br>\nNo</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When using eager mode, I found that the gradient function returned by <code>tfe.implicit_value_and_gradients()</code> doesn't support keyword argument.</p>\n<h3>Source code / logs</h3>\n<p>My code like this</p>\n<div class=\"highlight highlight-source-python\"><pre>grad_fn <span class=\"pl-k\">=</span> tfe.implicit_gradients(<span class=\"pl-c1\">MLP</span>)\ngrads_and_vars <span class=\"pl-k\">=</span> grad_fn(data, label, <span class=\"pl-v\">is_training</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)</pre></div>\n<p>And I got the error</p>\n<blockquote>\n<p>Traceback (most recent call last):<br>\nFile \"xxx.py\", line 91, in <br>\ngrads_and_vars = grad_fn(data, label, is_training=True)<br>\nFile \"xxx\\anaconda3\\lib\\site-packages\\tensorflow\\python\\eager\\backprop.py\", line 289, in grad_fn<br>\nreturn implicit_val_and_grad(f)(*args, **kwds)[1]<br>\nTypeError: grad_fn() got an unexpected keyword argument 'is_training'</p>\n</blockquote>\n<p>When I remove the keyword \"is_training\", like this</p>\n<pre><code>grads_and_vars = grad_fn(data, label, True)\n</code></pre>\n<p>Then the code has no problem.</p>\n<p>The bug can be fixed by modifying \u2019xxx\\Lib\\site-packages\\tensorflow\\python\\eager\\backprop.py\u2018 and adding <code>**kwds</code> in function <code>implicit_val_and_grad(f)</code><br>\nthe modified code like this</p>\n<div class=\"highlight highlight-source-python\"><pre>  <span class=\"pl-k\">def</span> <span class=\"pl-en\">grad_fn</span>(<span class=\"pl-k\">*</span><span class=\"pl-smi\">args</span>, <span class=\"pl-k\">**</span><span class=\"pl-smi\">kwds</span>):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"</span>Computes the gradient of the wrapped function.<span class=\"pl-pds\">\"\"\"</span></span>\n    this_tape <span class=\"pl-k\">=</span> tape.push_new_tape()\n    <span class=\"pl-k\">try</span>:\n      end_node <span class=\"pl-k\">=</span> f(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwds)\n  <span class=\"pl-c1\">...</span></pre></div>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNo\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nWindows 10\nTensorFlow installed from (source or binary):\nBinary\nTensorFlow version (use command below):\nv1.8.0\nPython version:\nPython 3.6.4\nBazel version (if compiling from source):\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version:\nNo\nGPU model and memory:\nNo\nExact command to reproduce:\n\nDescribe the problem\nWhen using eager mode, I found that the gradient function returned by tfe.implicit_value_and_gradients() doesn't support keyword argument.\nSource code / logs\nMy code like this\ngrad_fn = tfe.implicit_gradients(MLP)\ngrads_and_vars = grad_fn(data, label, is_training=True)\nAnd I got the error\n\nTraceback (most recent call last):\nFile \"xxx.py\", line 91, in \ngrads_and_vars = grad_fn(data, label, is_training=True)\nFile \"xxx\\anaconda3\\lib\\site-packages\\tensorflow\\python\\eager\\backprop.py\", line 289, in grad_fn\nreturn implicit_val_and_grad(f)(*args, **kwds)[1]\nTypeError: grad_fn() got an unexpected keyword argument 'is_training'\n\nWhen I remove the keyword \"is_training\", like this\ngrads_and_vars = grad_fn(data, label, True)\n\nThen the code has no problem.\nThe bug can be fixed by modifying \u2019xxx\\Lib\\site-packages\\tensorflow\\python\\eager\\backprop.py\u2018 and adding **kwds in function implicit_val_and_grad(f)\nthe modified code like this\n  def grad_fn(*args, **kwds):\n    \"\"\"Computes the gradient of the wrapped function.\"\"\"\n    this_tape = tape.push_new_tape()\n    try:\n      end_node = f(*args, **kwds)\n  ...", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows 10\r\n- **TensorFlow installed from (source or binary)**:\r\nBinary\r\n- **TensorFlow version (use command below)**:\r\nv1.8.0\r\n- **Python version**: \r\nPython 3.6.4\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\nNo\r\n- **GPU model and memory**:\r\nNo\r\n- **Exact command to reproduce**:\r\n\r\n\r\n### Describe the problem\r\nWhen using eager mode, I found that the gradient function returned by `tfe.implicit_value_and_gradients()` doesn't support keyword argument.\r\n\r\n\r\n### Source code / logs\r\nMy code like this\r\n```python\r\ngrad_fn = tfe.implicit_gradients(MLP)\r\ngrads_and_vars = grad_fn(data, label, is_training=True)\r\n```\r\n\r\nAnd I got the error\r\n>Traceback (most recent call last):\r\n  File \"xxx.py\", line 91, in <module>\r\n    grads_and_vars = grad_fn(data, label, is_training=True)\r\n  File \"xxx\\anaconda3\\lib\\site-packages\\tensorflow\\python\\eager\\backprop.py\", line 289, in grad_fn\r\n    return implicit_val_and_grad(f)(*args, **kwds)[1]\r\nTypeError: grad_fn() got an unexpected keyword argument 'is_training'\r\n\r\nWhen I remove the keyword \"is_training\", like this\r\n```\r\ngrads_and_vars = grad_fn(data, label, True)\r\n```\r\nThen the code has no problem. \r\n\r\nThe bug can be fixed by modifying \u2019xxx\\Lib\\site-packages\\tensorflow\\python\\eager\\backprop.py\u2018 and adding `**kwds` in function `implicit_val_and_grad(f)`\r\nthe modified code like this\r\n```python\r\n  def grad_fn(*args, **kwds):\r\n    \"\"\"Computes the gradient of the wrapped function.\"\"\"\r\n    this_tape = tape.push_new_tape()\r\n    try:\r\n      end_node = f(*args, **kwds)\r\n  ...\r\n```\r\n\r\n\r\n"}