{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20660", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20660/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20660/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20660/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20660", "id": 339711509, "node_id": "MDU6SXNzdWUzMzk3MTE1MDk=", "number": 20660, "title": "Attempting to use uninitialized value Variable", "user": {"login": "qianlnk", "id": 9543166, "node_id": "MDQ6VXNlcjk1NDMxNjY=", "avatar_url": "https://avatars0.githubusercontent.com/u/9543166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qianlnk", "html_url": "https://github.com/qianlnk", "followers_url": "https://api.github.com/users/qianlnk/followers", "following_url": "https://api.github.com/users/qianlnk/following{/other_user}", "gists_url": "https://api.github.com/users/qianlnk/gists{/gist_id}", "starred_url": "https://api.github.com/users/qianlnk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qianlnk/subscriptions", "organizations_url": "https://api.github.com/users/qianlnk/orgs", "repos_url": "https://api.github.com/users/qianlnk/repos", "events_url": "https://api.github.com/users/qianlnk/events{/privacy}", "received_events_url": "https://api.github.com/users/qianlnk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-07-10T06:37:45Z", "updated_at": "2018-07-11T02:51:22Z", "closed_at": "2018-07-11T02:51:22Z", "author_association": "NONE", "body_html": "<p>Hi all,</p>\n<p>I had Import a graph with go:</p>\n<div class=\"highlight highlight-source-go\"><pre>\t\t\t<span class=\"pl-smi\">bmodel</span> <span class=\"pl-k\">:=</span> res.<span class=\"pl-c1\">GetBytes</span>(<span class=\"pl-c1\">0</span>)\n\n\t\t\t<span class=\"pl-smi\">graph</span> <span class=\"pl-k\">:=</span> tf.<span class=\"pl-c1\">NewGraph</span>()\n\t\t\t<span class=\"pl-k\">if</span> <span class=\"pl-smi\">err</span> <span class=\"pl-k\">:=</span> graph.<span class=\"pl-c1\">Import</span>(bmodel, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>); err != <span class=\"pl-c1\">nil</span> {\n\t\t\t\tlog.<span class=\"pl-c1\">Error</span>(err)\n\t\t\t\t<span class=\"pl-k\">continue</span>\n\t\t\t}\n\n\t\t\t<span class=\"pl-smi\">sess</span>, <span class=\"pl-smi\">err</span> <span class=\"pl-k\">:=</span> tf.<span class=\"pl-c1\">NewSession</span>(graph, <span class=\"pl-c1\">nil</span>)\n\t\t\t<span class=\"pl-k\">if</span> err != <span class=\"pl-c1\">nil</span> {\n\t\t\t\tlog.<span class=\"pl-c1\">Error</span>(err)\n\t\t\t\t<span class=\"pl-k\">continue</span>\n\t\t\t}\n\n\t\t\tp.<span class=\"pl-smi\">model</span> = &amp;tf.<span class=\"pl-smi\">SavedModel</span>{\n\t\t\t\t<span class=\"pl-v\">Graph</span>:   graph,\n\t\t\t\t<span class=\"pl-v\">Session</span>: sess,\n\t\t\t}</pre></div>\n<p>use the model:</p>\n<div class=\"highlight highlight-source-go\"><pre>\t<span class=\"pl-smi\">output</span> <span class=\"pl-k\">:=</span> tf.<span class=\"pl-smi\">Output</span>{\n\t\t<span class=\"pl-v\">Op</span>:    p.<span class=\"pl-smi\">model</span>.<span class=\"pl-smi\">Graph</span>.<span class=\"pl-c1\">Operation</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>input<span class=\"pl-pds\">\"</span></span>),\n\t\t<span class=\"pl-v\">Index</span>: <span class=\"pl-c1\">0</span>,\n\t}\n\t<span class=\"pl-smi\">target</span>, <span class=\"pl-smi\">err</span> <span class=\"pl-k\">:=</span> tf.<span class=\"pl-c1\">NewTensor</span>([][]<span class=\"pl-k\">float32</span>{})\n\n\t<span class=\"pl-k\">if</span> err != <span class=\"pl-c1\">nil</span> {\n\t\tlog.<span class=\"pl-c1\">Error</span>(err)\n\t\t<span class=\"pl-k\">return</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>accept<span class=\"pl-pds\">\"</span></span>, err\n\t}\n\n\t<span class=\"pl-smi\">tensor</span>, <span class=\"pl-smi\">err</span> <span class=\"pl-k\">:=</span> tf.<span class=\"pl-c1\">NewTensor</span>([][]<span class=\"pl-k\">float32</span>{preData})\n\t<span class=\"pl-k\">if</span> err != <span class=\"pl-c1\">nil</span> {\n\t\tlog.<span class=\"pl-c1\">Error</span>(err)\n\t\t<span class=\"pl-k\">return</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>accept<span class=\"pl-pds\">\"</span></span>, err\n\t}\n\n\t<span class=\"pl-smi\">feeds</span> <span class=\"pl-k\">:=</span> <span class=\"pl-k\">map</span>[tf.<span class=\"pl-smi\">Output</span>]*tf.<span class=\"pl-smi\">Tensor</span>{\n\t\toutput: tensor,\n\t\tp.<span class=\"pl-smi\">model</span>.<span class=\"pl-smi\">Graph</span>.<span class=\"pl-c1\">Operation</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>target<span class=\"pl-pds\">\"</span></span>).<span class=\"pl-c1\">Output</span>(<span class=\"pl-c1\">0</span>): target,\n\t}\n\n\t<span class=\"pl-smi\">fetches</span> <span class=\"pl-k\">:=</span> []tf.<span class=\"pl-smi\">Output</span>{\n\t\t{\n\t\t\tOp:    p.<span class=\"pl-smi\">model</span>.<span class=\"pl-smi\">Graph</span>.<span class=\"pl-c1\">Operation</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>infer<span class=\"pl-pds\">\"</span></span>),\n\t\t\tIndex: <span class=\"pl-c1\">0</span>,\n\t\t},\n\t}\n\n\t<span class=\"pl-smi\">result</span>, <span class=\"pl-smi\">err</span> <span class=\"pl-k\">:=</span> p.<span class=\"pl-smi\">model</span>.<span class=\"pl-smi\">Session</span>.<span class=\"pl-c1\">Run</span>(\n\t\tfeeds,\n\t\tfetches,\n\t\t<span class=\"pl-c1\">nil</span>,\n\t)</pre></div>\n<p>but get error:</p>\n<div class=\"highlight highlight-source-shell\"><pre>2018-07-10 14:36:41 ERROR (shield-ai-engine/predict.go:188):20187 Attempting to use uninitialized value Variable_3\n\t [[Node: Variable_3/read <span class=\"pl-k\">=</span> Identity[T<span class=\"pl-k\">=</span>DT_FLOAT, _device<span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:CPU:0<span class=\"pl-pds\">\"</span></span>](Variable_3)]]</pre></div>\n<p>It haven't init in NewSession? how to initialize variable?</p>\n<p>env:</p>\n<p>OS: mac 10.11.6<br>\npython version: python2.7<br>\ntensorflow install base on <a href=\"https://www.tensorflow.org/install/install_go\" rel=\"nofollow\">https://www.tensorflow.org/install/install_go</a><br>\ntensorflow-go version: v1.9.0-rc2<br>\ngo version: go1.9.2 darwin/amd64</p>", "body_text": "Hi all,\nI had Import a graph with go:\n\t\t\tbmodel := res.GetBytes(0)\n\n\t\t\tgraph := tf.NewGraph()\n\t\t\tif err := graph.Import(bmodel, \"\"); err != nil {\n\t\t\t\tlog.Error(err)\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tsess, err := tf.NewSession(graph, nil)\n\t\t\tif err != nil {\n\t\t\t\tlog.Error(err)\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tp.model = &tf.SavedModel{\n\t\t\t\tGraph:   graph,\n\t\t\t\tSession: sess,\n\t\t\t}\nuse the model:\n\toutput := tf.Output{\n\t\tOp:    p.model.Graph.Operation(\"input\"),\n\t\tIndex: 0,\n\t}\n\ttarget, err := tf.NewTensor([][]float32{})\n\n\tif err != nil {\n\t\tlog.Error(err)\n\t\treturn \"accept\", err\n\t}\n\n\ttensor, err := tf.NewTensor([][]float32{preData})\n\tif err != nil {\n\t\tlog.Error(err)\n\t\treturn \"accept\", err\n\t}\n\n\tfeeds := map[tf.Output]*tf.Tensor{\n\t\toutput: tensor,\n\t\tp.model.Graph.Operation(\"target\").Output(0): target,\n\t}\n\n\tfetches := []tf.Output{\n\t\t{\n\t\t\tOp:    p.model.Graph.Operation(\"infer\"),\n\t\t\tIndex: 0,\n\t\t},\n\t}\n\n\tresult, err := p.model.Session.Run(\n\t\tfeeds,\n\t\tfetches,\n\t\tnil,\n\t)\nbut get error:\n2018-07-10 14:36:41 ERROR (shield-ai-engine/predict.go:188):20187 Attempting to use uninitialized value Variable_3\n\t [[Node: Variable_3/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](Variable_3)]]\nIt haven't init in NewSession? how to initialize variable?\nenv:\nOS: mac 10.11.6\npython version: python2.7\ntensorflow install base on https://www.tensorflow.org/install/install_go\ntensorflow-go version: v1.9.0-rc2\ngo version: go1.9.2 darwin/amd64", "body": "Hi all,\r\n\r\nI had Import a graph with go:\r\n\r\n```go\r\n\t\t\tbmodel := res.GetBytes(0)\r\n\r\n\t\t\tgraph := tf.NewGraph()\r\n\t\t\tif err := graph.Import(bmodel, \"\"); err != nil {\r\n\t\t\t\tlog.Error(err)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tsess, err := tf.NewSession(graph, nil)\r\n\t\t\tif err != nil {\r\n\t\t\t\tlog.Error(err)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tp.model = &tf.SavedModel{\r\n\t\t\t\tGraph:   graph,\r\n\t\t\t\tSession: sess,\r\n\t\t\t}\r\n```\r\n\r\nuse the model:\r\n\r\n```go\r\n\toutput := tf.Output{\r\n\t\tOp:    p.model.Graph.Operation(\"input\"),\r\n\t\tIndex: 0,\r\n\t}\r\n\ttarget, err := tf.NewTensor([][]float32{})\r\n\r\n\tif err != nil {\r\n\t\tlog.Error(err)\r\n\t\treturn \"accept\", err\r\n\t}\r\n\r\n\ttensor, err := tf.NewTensor([][]float32{preData})\r\n\tif err != nil {\r\n\t\tlog.Error(err)\r\n\t\treturn \"accept\", err\r\n\t}\r\n\r\n\tfeeds := map[tf.Output]*tf.Tensor{\r\n\t\toutput: tensor,\r\n\t\tp.model.Graph.Operation(\"target\").Output(0): target,\r\n\t}\r\n\r\n\tfetches := []tf.Output{\r\n\t\t{\r\n\t\t\tOp:    p.model.Graph.Operation(\"infer\"),\r\n\t\t\tIndex: 0,\r\n\t\t},\r\n\t}\r\n\r\n\tresult, err := p.model.Session.Run(\r\n\t\tfeeds,\r\n\t\tfetches,\r\n\t\tnil,\r\n\t)\r\n```\r\n\r\nbut get error: \r\n\r\n```sh\r\n2018-07-10 14:36:41 ERROR (shield-ai-engine/predict.go:188):20187 Attempting to use uninitialized value Variable_3\r\n\t [[Node: Variable_3/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](Variable_3)]]\r\n```\r\nIt haven't init in NewSession? how to initialize variable?\r\n\r\nenv:\r\n\r\nOS: mac 10.11.6\r\npython version: python2.7\r\ntensorflow install base on https://www.tensorflow.org/install/install_go\r\ntensorflow-go version: v1.9.0-rc2\r\ngo version: go1.9.2 darwin/amd64"}