{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/390822938", "html_url": "https://github.com/tensorflow/tensorflow/issues/19260#issuecomment-390822938", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19260", "id": 390822938, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDgyMjkzOA==", "user": {"login": "rryan", "id": 26527, "node_id": "MDQ6VXNlcjI2NTI3", "avatar_url": "https://avatars3.githubusercontent.com/u/26527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rryan", "html_url": "https://github.com/rryan", "followers_url": "https://api.github.com/users/rryan/followers", "following_url": "https://api.github.com/users/rryan/following{/other_user}", "gists_url": "https://api.github.com/users/rryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rryan/subscriptions", "organizations_url": "https://api.github.com/users/rryan/orgs", "repos_url": "https://api.github.com/users/rryan/repos", "events_url": "https://api.github.com/users/rryan/events{/privacy}", "received_events_url": "https://api.github.com/users/rryan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-22T00:12:47Z", "updated_at": "2018-05-22T00:12:47Z", "author_association": "MEMBER", "body_html": "<blockquote>\n<p>int axis = op-&gt;axis;<br>\nif (axis &lt; 0) {<br>\n// Handle negative axis<br>\naxis += stacked_shape-&gt;dims().size() + 1;<br>\n}<br>\ni<br>\nIsn't the second one wrong?</p>\n</blockquote>\n<p>It confused me too but I think it's ok:</p>\n<ul>\n<li><code>tf.stack(x, axis=0)</code> -&gt; <code>[len(x), d0, ..., dn]</code></li>\n<li><code>tf.stack(x, axis=1)</code> -&gt; <code>[d0, len(x), ..., dn]</code></li>\n<li><code>tf.stack(x, axis=rank(x))</code> -&gt; <code>[d0, ..., dn, len(x)]</code></li>\n<li><code>tf.stack(x, axis=-1)</code> -&gt; <code>[d0, ..., dn, len(x)]</code></li>\n</ul>\n<p>So for <code>axis=-1</code>,  the code computes <code>axis = rank(shape) + axis + 1</code> -&gt; <code>rank(shape) + -1 + 1</code> -&gt; <code>rank(shape)</code>, which is the same as the <code>tf.stack(x, axis=rank(x))</code> case.</p>", "body_text": "int axis = op->axis;\nif (axis < 0) {\n// Handle negative axis\naxis += stacked_shape->dims().size() + 1;\n}\ni\nIsn't the second one wrong?\n\nIt confused me too but I think it's ok:\n\ntf.stack(x, axis=0) -> [len(x), d0, ..., dn]\ntf.stack(x, axis=1) -> [d0, len(x), ..., dn]\ntf.stack(x, axis=rank(x)) -> [d0, ..., dn, len(x)]\ntf.stack(x, axis=-1) -> [d0, ..., dn, len(x)]\n\nSo for axis=-1,  the code computes axis = rank(shape) + axis + 1 -> rank(shape) + -1 + 1 -> rank(shape), which is the same as the tf.stack(x, axis=rank(x)) case.", "body": "> int axis = op->axis;\r\n> if (axis < 0) {\r\n>   // Handle negative axis\r\n>   axis += stacked_shape->dims().size() + 1;\r\n> }\r\n> i\r\n> Isn't the second one wrong?\r\n\r\nIt confused me too but I think it's ok:\r\n \r\n* `tf.stack(x, axis=0)` -> `[len(x), d0, ..., dn]`\r\n* `tf.stack(x, axis=1)` -> `[d0, len(x), ..., dn]`\r\n* `tf.stack(x, axis=rank(x))` -> `[d0, ..., dn, len(x)]`\r\n* `tf.stack(x, axis=-1)` -> `[d0, ..., dn, len(x)]`\r\n\r\nSo for `axis=-1`,  the code computes `axis = rank(shape) + axis + 1` -> `rank(shape) + -1 + 1` -> `rank(shape)`, which is the same as the `tf.stack(x, axis=rank(x))` case.\r\n\r\n"}