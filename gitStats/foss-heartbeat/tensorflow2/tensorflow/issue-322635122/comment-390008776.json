{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/390008776", "html_url": "https://github.com/tensorflow/tensorflow/issues/19260#issuecomment-390008776", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19260", "id": 390008776, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDAwODc3Ng==", "user": {"login": "Androbin", "id": 16437156, "node_id": "MDQ6VXNlcjE2NDM3MTU2", "avatar_url": "https://avatars1.githubusercontent.com/u/16437156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Androbin", "html_url": "https://github.com/Androbin", "followers_url": "https://api.github.com/users/Androbin/followers", "following_url": "https://api.github.com/users/Androbin/following{/other_user}", "gists_url": "https://api.github.com/users/Androbin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Androbin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Androbin/subscriptions", "organizations_url": "https://api.github.com/users/Androbin/orgs", "repos_url": "https://api.github.com/users/Androbin/repos", "events_url": "https://api.github.com/users/Androbin/events{/privacy}", "received_events_url": "https://api.github.com/users/Androbin/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-17T20:56:33Z", "updated_at": "2018-05-19T19:02:43Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I've attached the full source above. For convenience, here are the important snippets.</p>\n<p>Model:</p>\n<pre><code>import tensorflow as tf\nimport tensorflow.contrib.signal as signal\n\nx = tf.placeholder(tf.float32, [None, 9152], name=\"x\")\ny = tf.placeholder(tf.int64, [None], name=\"y\")\n\nv = tf.Variable(1.)\n\nmagspec = signal.stft(x, frame_length, frame_step, num_frames, None)\nmagspec = tf.abs(magspec) * v\n\nfeatures = tf.expand_dims(magspec, 3)\n\ny_conv = tf.identity(features, name=\"y_conv\")\n</code></pre>\n<p>Freezing:</p>\n<pre><code>bazel-bin/tensorflow/python/tools/freeze_graph \\\n  --input_graph=model.pb \\\n  --input_checkpoint=model.ckpt \\\n  --output_graph=frozen_model.pb \\\n  --output_node_names=y_conv\n</code></pre>\n<p>TOCO tool:</p>\n<pre><code>bazel-bin/tensorflow/contrib/lite/toco/toco \\\n  --input_file=frozen_model.pb \\\n  --input_format=TENSORFLOW_GRAPHDEF \\\n  --output_format=TFLITE \\\n  --output_file=model.tflite \\\n  --inference_type=FLOAT \\\n  --input_type=FLOAT \\\n  --input_arrays=x \\\n  --output_arrays=y_conv \\\n  --input_shapes=1,9152\n</code></pre>\n<p>Error message:<br>\n2018-05-14 00:42:56.816500: F <a href=\"https://github.com/tensorflow/tensorflow/blob/1f03f829285ca0fbd47a99350e9f5d99aa10e9b9/tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc#L1305\">tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:1305</a>] Check failed: dim_size &gt; 0 (-1 vs. 0)Output size for an axis must be greater than 0. Axis 0 computes to size -1 for StridedSlice op with output \"stft/frame/strided_slice\".</p>", "body_text": "I've attached the full source above. For convenience, here are the important snippets.\nModel:\nimport tensorflow as tf\nimport tensorflow.contrib.signal as signal\n\nx = tf.placeholder(tf.float32, [None, 9152], name=\"x\")\ny = tf.placeholder(tf.int64, [None], name=\"y\")\n\nv = tf.Variable(1.)\n\nmagspec = signal.stft(x, frame_length, frame_step, num_frames, None)\nmagspec = tf.abs(magspec) * v\n\nfeatures = tf.expand_dims(magspec, 3)\n\ny_conv = tf.identity(features, name=\"y_conv\")\n\nFreezing:\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n  --input_graph=model.pb \\\n  --input_checkpoint=model.ckpt \\\n  --output_graph=frozen_model.pb \\\n  --output_node_names=y_conv\n\nTOCO tool:\nbazel-bin/tensorflow/contrib/lite/toco/toco \\\n  --input_file=frozen_model.pb \\\n  --input_format=TENSORFLOW_GRAPHDEF \\\n  --output_format=TFLITE \\\n  --output_file=model.tflite \\\n  --inference_type=FLOAT \\\n  --input_type=FLOAT \\\n  --input_arrays=x \\\n  --output_arrays=y_conv \\\n  --input_shapes=1,9152\n\nError message:\n2018-05-14 00:42:56.816500: F tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:1305] Check failed: dim_size > 0 (-1 vs. 0)Output size for an axis must be greater than 0. Axis 0 computes to size -1 for StridedSlice op with output \"stft/frame/strided_slice\".", "body": "I've attached the full source above. For convenience, here are the important snippets.\r\n\r\nModel:\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.signal as signal\r\n\r\nx = tf.placeholder(tf.float32, [None, 9152], name=\"x\")\r\ny = tf.placeholder(tf.int64, [None], name=\"y\")\r\n\r\nv = tf.Variable(1.)\r\n\r\nmagspec = signal.stft(x, frame_length, frame_step, num_frames, None)\r\nmagspec = tf.abs(magspec) * v\r\n\r\nfeatures = tf.expand_dims(magspec, 3)\r\n\r\ny_conv = tf.identity(features, name=\"y_conv\")\r\n```\r\nFreezing:\r\n```\r\nbazel-bin/tensorflow/python/tools/freeze_graph \\\r\n  --input_graph=model.pb \\\r\n  --input_checkpoint=model.ckpt \\\r\n  --output_graph=frozen_model.pb \\\r\n  --output_node_names=y_conv\r\n```\r\nTOCO tool:\r\n```\r\nbazel-bin/tensorflow/contrib/lite/toco/toco \\\r\n  --input_file=frozen_model.pb \\\r\n  --input_format=TENSORFLOW_GRAPHDEF \\\r\n  --output_format=TFLITE \\\r\n  --output_file=model.tflite \\\r\n  --inference_type=FLOAT \\\r\n  --input_type=FLOAT \\\r\n  --input_arrays=x \\\r\n  --output_arrays=y_conv \\\r\n  --input_shapes=1,9152\r\n```\r\n\r\nError message:\r\n2018-05-14 00:42:56.816500: F [tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:1305](https://github.com/tensorflow/tensorflow/blob/1f03f829285ca0fbd47a99350e9f5d99aa10e9b9/tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc#L1305)] Check failed: dim_size > 0 (-1 vs. 0)Output size for an axis must be greater than 0. Axis 0 computes to size -1 for StridedSlice op with output \"stft/frame/strided_slice\"."}