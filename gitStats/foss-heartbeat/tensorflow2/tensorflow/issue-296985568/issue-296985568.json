{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17001", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17001/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17001/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17001/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/17001", "id": 296985568, "node_id": "MDU6SXNzdWUyOTY5ODU1Njg=", "number": 17001, "title": "Minor issue with TF Lite building natively on aarch64", "user": {"login": "mgkbeer", "id": 36466983, "node_id": "MDQ6VXNlcjM2NDY2OTgz", "avatar_url": "https://avatars2.githubusercontent.com/u/36466983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgkbeer", "html_url": "https://github.com/mgkbeer", "followers_url": "https://api.github.com/users/mgkbeer/followers", "following_url": "https://api.github.com/users/mgkbeer/following{/other_user}", "gists_url": "https://api.github.com/users/mgkbeer/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgkbeer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgkbeer/subscriptions", "organizations_url": "https://api.github.com/users/mgkbeer/orgs", "repos_url": "https://api.github.com/users/mgkbeer/repos", "events_url": "https://api.github.com/users/mgkbeer/events{/privacy}", "received_events_url": "https://api.github.com/users/mgkbeer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "fef2c0", "default": false}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-02-14T06:03:26Z", "updated_at": "2018-05-26T18:37:20Z", "closed_at": "2018-05-26T18:37:20Z", "author_association": "NONE", "body_html": "<p>Linux qds101 4.4.65 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP PREEMPT Mon Sep 18 13:34:00 CDT 2017 aarch64 aarch64 aarch64 GNU/Linux<br>\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"<br>\nVERSION_ID=\"16.04\"<br>\nVERSION_CODENAME=xenial</p>\n<p>== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nc++ (Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609</p>\n<p>== uname -a =====================================================<br>\nLinux qds101 4.4.65 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP PREEMPT Mon Sep 18 13:34:00 CDT 2017 aarch64 aarch64 aarch64 GNU/Linux</p>\n<p>== check pips ===================================================<br>\nnumpy (1.13.3)<br>\nprotobuf (3.4.0)<br>\ntensorflow (1.3.0)<br>\ntensorflow-tensorboard (0.1.5)</p>\n<p>== check for virtualenv =========================================<br>\nFalse</p>\n<p>== tensorflow import ============================================<br>\ntf.VERSION = 1.3.0<br>\ntf.GIT_VERSION = v1.3.0-rc1-1607-gbe4e5ef<br>\ntf.COMPILER_VERSION = v1.3.0-rc1-1607-gbe4e5ef</p>\n<h3>Describe the problem</h3>\n<p>When I try to compile TF Lite example on my aarch64 machine, i get an error from gcc.<br>\nThe problem, i think, is that kernels/internal/BUILD file does not support aarch64 properly:<br>\nNEON_FLAGS_IF_APPLICABLE = select({<br>\n\":arm\": [<br>\n\"-O3\",<br>\n\"-mfpu=neon\",<br>\n\"-mfloat-abi=softfp\",</p>\n<p>But for aarch64 gcc those options do not exist (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html#AArch64-Options\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html#AArch64-Options</a>). If I remove those two options, compilation is successful.</p>\n<h3>Source code / logs</h3>\n<p>user@qds101:~/ml/tf_lite/tensorflow$ bazel build --verbose_failures --config opt  --cxxopt=-std=c++11 --config monolithic  //tensorflow/contrib/lite/examples/label_image:label_image<br>\nWARNING: /home/user/.cache/bazel/<em>bazel_user/5b7d3a270696b210c6b4e035929a0ce1/external/protobuf_archive/WORKSPACE:1: Workspace name in /home/user/.cache/bazel/<em>bazel_user/5b7d3a270696b210c6b4e035929a0ce1/external/protobuf_archive/WORKSPACE (@com_google_protobuf) does not match the name given in the repository's definition (@protobuf_archive); this will cause a build error in future versions<br>\nINFO: Analysed target //tensorflow/contrib/lite/examples/label_image:label_image (1 packages loaded).<br>\nINFO: Found 1 target...<br>\nERROR: /home/user/ml/tf_lite/tensorflow/tensorflow/contrib/lite/kernels/internal/BUILD:308:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1): gcc failed: error executing command<br>\n(cd /home/user/.cache/bazel/<em>bazel_user/5b7d3a270696b210c6b4e035929a0ce1/execroot/org_tensorflow &amp;&amp; <br>\nexec env - <br>\nPATH=/home/user/bin:/home/user/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games <br>\nPWD=/proc/self/cwd <br>\nPYTHON_BIN_PATH=/usr/bin/python <br>\nPYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages <br>\nTF_NEED_CUDA=0 <br>\nTF_NEED_OPENCL_SYCL=0 <br>\n/usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK '-march=native' '-std=c++0x' '-std=c++11' -MD -MF bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/<em>objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.d '-frandom-seed=bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/<em>objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.o' -iquote . -iquote bazel-out/arm-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/arm-opt/genfiles/external/bazel_tools -iquote external/arm_neon_2_x86_sse -iquote bazel-out/arm-opt/genfiles/external/arm_neon_2_x86_sse -iquote external/gemmlowp -iquote bazel-out/arm-opt/genfiles/external/gemmlowp -isystem external/bazel_tools/tools/cpp/gcc3 -O3 '-mfpu=neon' '-mfloat-abi=softfp' -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE</em></em>=\"redacted\"' '-D__TIMESTAMP</em></em>=\"redacted\"' '-D__TIME</em>_=\"redacted\"' -c tensorflow/contrib/lite/kernels/internal/tensor_utils.cc -o bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.o)<br>\ngcc: error: unrecognized command line option '-mfpu=neon'<br>\ngcc: error: unrecognized command line option '-mfloat-abi=softfp'<br>\nTarget //tensorflow/contrib/lite/examples/label_image:label_image failed to build<br>\nINFO: Elapsed time: 1.052s, Critical Path: 0.03s<br>\nFAILED: Build did NOT complete successfully</p>", "body_text": "Linux qds101 4.4.65 #1 SMP PREEMPT Mon Sep 18 13:34:00 CDT 2017 aarch64 aarch64 aarch64 GNU/Linux\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\nVERSION_ID=\"16.04\"\nVERSION_CODENAME=xenial\n== are we in docker =============================================\nNo\n== compiler =====================================================\nc++ (Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\n== uname -a =====================================================\nLinux qds101 4.4.65 #1 SMP PREEMPT Mon Sep 18 13:34:00 CDT 2017 aarch64 aarch64 aarch64 GNU/Linux\n== check pips ===================================================\nnumpy (1.13.3)\nprotobuf (3.4.0)\ntensorflow (1.3.0)\ntensorflow-tensorboard (0.1.5)\n== check for virtualenv =========================================\nFalse\n== tensorflow import ============================================\ntf.VERSION = 1.3.0\ntf.GIT_VERSION = v1.3.0-rc1-1607-gbe4e5ef\ntf.COMPILER_VERSION = v1.3.0-rc1-1607-gbe4e5ef\nDescribe the problem\nWhen I try to compile TF Lite example on my aarch64 machine, i get an error from gcc.\nThe problem, i think, is that kernels/internal/BUILD file does not support aarch64 properly:\nNEON_FLAGS_IF_APPLICABLE = select({\n\":arm\": [\n\"-O3\",\n\"-mfpu=neon\",\n\"-mfloat-abi=softfp\",\nBut for aarch64 gcc those options do not exist (https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html#AArch64-Options). If I remove those two options, compilation is successful.\nSource code / logs\nuser@qds101:~/ml/tf_lite/tensorflow$ bazel build --verbose_failures --config opt  --cxxopt=-std=c++11 --config monolithic  //tensorflow/contrib/lite/examples/label_image:label_image\nWARNING: /home/user/.cache/bazel/bazel_user/5b7d3a270696b210c6b4e035929a0ce1/external/protobuf_archive/WORKSPACE:1: Workspace name in /home/user/.cache/bazel/bazel_user/5b7d3a270696b210c6b4e035929a0ce1/external/protobuf_archive/WORKSPACE (@com_google_protobuf) does not match the name given in the repository's definition (@protobuf_archive); this will cause a build error in future versions\nINFO: Analysed target //tensorflow/contrib/lite/examples/label_image:label_image (1 packages loaded).\nINFO: Found 1 target...\nERROR: /home/user/ml/tf_lite/tensorflow/tensorflow/contrib/lite/kernels/internal/BUILD:308:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1): gcc failed: error executing command\n(cd /home/user/.cache/bazel/bazel_user/5b7d3a270696b210c6b4e035929a0ce1/execroot/org_tensorflow && \nexec env - \nPATH=/home/user/bin:/home/user/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games \nPWD=/proc/self/cwd \nPYTHON_BIN_PATH=/usr/bin/python \nPYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \nTF_NEED_CUDA=0 \nTF_NEED_OPENCL_SYCL=0 \n/usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK '-march=native' '-std=c++0x' '-std=c++11' -MD -MF bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.d '-frandom-seed=bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.o' -iquote . -iquote bazel-out/arm-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/arm-opt/genfiles/external/bazel_tools -iquote external/arm_neon_2_x86_sse -iquote bazel-out/arm-opt/genfiles/external/arm_neon_2_x86_sse -iquote external/gemmlowp -iquote bazel-out/arm-opt/genfiles/external/gemmlowp -isystem external/bazel_tools/tools/cpp/gcc3 -O3 '-mfpu=neon' '-mfloat-abi=softfp' -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE=\"redacted\"' '-D__TIMESTAMP=\"redacted\"' '-D__TIME_=\"redacted\"' -c tensorflow/contrib/lite/kernels/internal/tensor_utils.cc -o bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.o)\ngcc: error: unrecognized command line option '-mfpu=neon'\ngcc: error: unrecognized command line option '-mfloat-abi=softfp'\nTarget //tensorflow/contrib/lite/examples/label_image:label_image failed to build\nINFO: Elapsed time: 1.052s, Critical Path: 0.03s\nFAILED: Build did NOT complete successfully", "body": "Linux qds101 4.4.65 #1 SMP PREEMPT Mon Sep 18 13:34:00 CDT 2017 aarch64 aarch64 aarch64 GNU/Linux\r\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\r\n\r\n\r\n== uname -a =====================================================\r\nLinux qds101 4.4.65 #1 SMP PREEMPT Mon Sep 18 13:34:00 CDT 2017 aarch64 aarch64 aarch64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.3)\r\nprotobuf (3.4.0)\r\ntensorflow (1.3.0)\r\ntensorflow-tensorboard (0.1.5)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.3.0\r\ntf.GIT_VERSION = v1.3.0-rc1-1607-gbe4e5ef\r\ntf.COMPILER_VERSION = v1.3.0-rc1-1607-gbe4e5ef\r\n\r\n### Describe the problem\r\nWhen I try to compile TF Lite example on my aarch64 machine, i get an error from gcc. \r\nThe problem, i think, is that kernels/internal/BUILD file does not support aarch64 properly:\r\nNEON_FLAGS_IF_APPLICABLE = select({\r\n    \":arm\": [\r\n        \"-O3\",\r\n        \"-mfpu=neon\",\r\n        \"-mfloat-abi=softfp\",\r\n\r\nBut for aarch64 gcc those options do not exist (https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html#AArch64-Options). If I remove those two options, compilation is successful.\r\n\r\n### Source code / logs\r\nuser@qds101:~/ml/tf_lite/tensorflow$ bazel build --verbose_failures --config opt  --cxxopt=-std=c++11 --config monolithic  //tensorflow/contrib/lite/examples/label_image:label_image \r\nWARNING: /home/user/.cache/bazel/_bazel_user/5b7d3a270696b210c6b4e035929a0ce1/external/protobuf_archive/WORKSPACE:1: Workspace name in /home/user/.cache/bazel/_bazel_user/5b7d3a270696b210c6b4e035929a0ce1/external/protobuf_archive/WORKSPACE (@com_google_protobuf) does not match the name given in the repository's definition (@protobuf_archive); this will cause a build error in future versions\r\nINFO: Analysed target //tensorflow/contrib/lite/examples/label_image:label_image (1 packages loaded).\r\nINFO: Found 1 target...\r\nERROR: /home/user/ml/tf_lite/tensorflow/tensorflow/contrib/lite/kernels/internal/BUILD:308:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1): gcc failed: error executing command \r\n  (cd /home/user/.cache/bazel/_bazel_user/5b7d3a270696b210c6b4e035929a0ce1/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    PATH=/home/user/bin:/home/user/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/usr/bin/python \\\r\n    PYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \\\r\n    TF_NEED_CUDA=0 \\\r\n    TF_NEED_OPENCL_SYCL=0 \\\r\n  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK '-march=native' '-std=c++0x' '-std=c++11' -MD -MF bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.d '-frandom-seed=bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.o' -iquote . -iquote bazel-out/arm-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/arm-opt/genfiles/external/bazel_tools -iquote external/arm_neon_2_x86_sse -iquote bazel-out/arm-opt/genfiles/external/arm_neon_2_x86_sse -iquote external/gemmlowp -iquote bazel-out/arm-opt/genfiles/external/gemmlowp -isystem external/bazel_tools/tools/cpp/gcc3 -O3 '-mfpu=neon' '-mfloat-abi=softfp' -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/contrib/lite/kernels/internal/tensor_utils.cc -o bazel-out/arm-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensorflow/contrib/lite/kernels/internal/tensor_utils.o)\r\ngcc: error: unrecognized command line option '-mfpu=neon'\r\ngcc: error: unrecognized command line option '-mfloat-abi=softfp'\r\nTarget //tensorflow/contrib/lite/examples/label_image:label_image failed to build\r\nINFO: Elapsed time: 1.052s, Critical Path: 0.03s\r\nFAILED: Build did NOT complete successfully\r\n"}