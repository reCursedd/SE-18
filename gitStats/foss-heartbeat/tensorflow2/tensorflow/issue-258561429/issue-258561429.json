{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13130", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13130/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13130/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13130/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13130", "id": 258561429, "node_id": "MDU6SXNzdWUyNTg1NjE0Mjk=", "number": 13130, "title": "Build fails at patch command - different line endings", "user": {"login": "9k37", "id": 32044227, "node_id": "MDQ6VXNlcjMyMDQ0MjI3", "avatar_url": "https://avatars1.githubusercontent.com/u/32044227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/9k37", "html_url": "https://github.com/9k37", "followers_url": "https://api.github.com/users/9k37/followers", "following_url": "https://api.github.com/users/9k37/following{/other_user}", "gists_url": "https://api.github.com/users/9k37/gists{/gist_id}", "starred_url": "https://api.github.com/users/9k37/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/9k37/subscriptions", "organizations_url": "https://api.github.com/users/9k37/orgs", "repos_url": "https://api.github.com/users/9k37/repos", "events_url": "https://api.github.com/users/9k37/events{/privacy}", "received_events_url": "https://api.github.com/users/9k37/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-09-18T17:37:17Z", "updated_at": "2017-10-15T05:52:17Z", "closed_at": "2017-10-15T05:52:17Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nNo</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nWindows 8.1 64bit</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nI'm trying to build from source to use CPU optimizations</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\n1.3 cloned from master</li>\n<li><strong>Python version</strong>:<br>\n3.6.1</li>\n<li><strong>Bazel version (if compiling from source)</strong>:<br>\n0.5.4</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\nCPU only</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I'm trying to build TensorFlow from source to use CPU optimizations. I was getting <code>patch</code> error exactly as in <a href=\"https://github.com/tensorflow/tensorflow/issues/10435\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10435/hovercard\">Issue #10435</a> so I used the <a href=\"https://github.com/tensorflow/tensorflow/issues/10435#issuecomment-306422472\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10435/hovercard\">recommended solution</a> by adding <code>--binary</code> to <code>patch</code> call at <em>workspace.bzl</em> function <code>_apply_patch()</code>. The <em>tensorflow/core</em> is now loaded, bur I get another error with <em>tensorflow/contrib/session_bundle</em> - see log.</p>\n<h3>Source code / logs</h3>\n<pre><code>$ ./configure\nYou have bazel 0.5.4 installed.\nFound possible Python library paths:\n  D:\\anaconda\\lib\\site-packages\nPlease input the desired Python library path to use.  Default is [D:\\anaconda\\lib\\site-packages]\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\nNo XLA JIT support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with GDR support? [y/N]: n\nNo GDR support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with VERBS support? [y/N]: n\nNo VERBS support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with CUDA support? [y/N]: n\nNo CUDA support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with MPI support? [y/N]: n\nNo MPI support will be enabled for TensorFlow.\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native]:\nAdd \"--config=mkl\" to your bazel command to build with MKL support.\nPlease note that MKL on MacOS or windows is still not supported.\nIf you would like to use a local MKL instead of downloading, please set the environment variable \"TF_MKL_ROOT\" every time before build.\nConfiguration finished\n\n$ ./bazel build --config=opt --cpu=x64_windows_msvc --host_cpu=x64_windows_msvc --copt=-w --host_copt=-w //tensorflow/tools/pip_package:build_pip_package\n.............\n____Loading package: tensorflow/tools/pip_package\n____Loading package: @bazel_tools//tools/cpp\n____Loading package: @bazel_tools//tools/jdk\n____Loading package: @local_config_xcode//\n____Loading package: @local_config_cc//\n____Loading package: @local_jdk//\n____Loading complete.  Analyzing...\n____Loading package: @bazel_tools//tools/launcher\n____Loading package: tensorflow/contrib/nn\n____Loading package: tensorflow/python/tools\n____Loading package: tensorflow/python/eager\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,500,767 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,866,533 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,351,924 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,602,866 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,223,337 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,589,997 bytes\nERROR: D:/tensorflow/tensorflow/tools/pip_package/BUILD:70:1: error loading package 'tensorflow/contrib/session_bundle': Encountered error while reading extension file 'protobuf.bzl': no such package '@protobuf_archive//': Traceback (most recent call last):\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 123\n                _apply_patch(repo_ctx, repo_ctx.attr.patch_file)\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 114, in _apply_patch\n                _execute_and_check_ret_code(repo_ctx, cmd)\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 94, in _execute_and_check_ret_code\n                fail(\"Non-zero return code({1}) when ...))\nNon-zero return code(1) when executing 'D:\\msys\\usr\\bin\\bash.exe -c patch --binary -p1 -d D:/msys/tmp/_bazel_admin/aeorbm85/external/protobuf_archive -i D:/tensorflow/third_party/protobuf/add_noinlines.patch':\nStdout: patching file src/google/protobuf/compiler/cpp/cpp_file.cc\nHunk #1 FAILED at 557 (different line endings).\nHunk #2 FAILED at 656 (different line endings).\nHunk #3 FAILED at 737 (different line endings).\n3 out of 3 hunks FAILED -- saving rejects to file src/google/protobuf/compiler/cpp/cpp_file.cc.rej\n\nStderr:  and referenced by '//tensorflow/tools/pip_package:simple_console_for_windows'.\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted.\n____Elapsed time: 34,135s\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNo\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nWindows 8.1 64bit\nTensorFlow installed from (source or binary):\nI'm trying to build from source to use CPU optimizations\nTensorFlow version (use command below):\n1.3 cloned from master\nPython version:\n3.6.1\nBazel version (if compiling from source):\n0.5.4\nCUDA/cuDNN version:\nCPU only\n\nDescribe the problem\nI'm trying to build TensorFlow from source to use CPU optimizations. I was getting patch error exactly as in Issue #10435 so I used the recommended solution by adding --binary to patch call at workspace.bzl function _apply_patch(). The tensorflow/core is now loaded, bur I get another error with tensorflow/contrib/session_bundle - see log.\nSource code / logs\n$ ./configure\nYou have bazel 0.5.4 installed.\nFound possible Python library paths:\n  D:\\anaconda\\lib\\site-packages\nPlease input the desired Python library path to use.  Default is [D:\\anaconda\\lib\\site-packages]\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\nNo XLA JIT support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with GDR support? [y/N]: n\nNo GDR support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with VERBS support? [y/N]: n\nNo VERBS support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with CUDA support? [y/N]: n\nNo CUDA support will be enabled for TensorFlow.\nDo you wish to build TensorFlow with MPI support? [y/N]: n\nNo MPI support will be enabled for TensorFlow.\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native]:\nAdd \"--config=mkl\" to your bazel command to build with MKL support.\nPlease note that MKL on MacOS or windows is still not supported.\nIf you would like to use a local MKL instead of downloading, please set the environment variable \"TF_MKL_ROOT\" every time before build.\nConfiguration finished\n\n$ ./bazel build --config=opt --cpu=x64_windows_msvc --host_cpu=x64_windows_msvc --copt=-w --host_copt=-w //tensorflow/tools/pip_package:build_pip_package\n.............\n____Loading package: tensorflow/tools/pip_package\n____Loading package: @bazel_tools//tools/cpp\n____Loading package: @bazel_tools//tools/jdk\n____Loading package: @local_config_xcode//\n____Loading package: @local_config_cc//\n____Loading package: @local_jdk//\n____Loading complete.  Analyzing...\n____Loading package: @bazel_tools//tools/launcher\n____Loading package: tensorflow/contrib/nn\n____Loading package: tensorflow/python/tools\n____Loading package: tensorflow/python/eager\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,500,767 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,866,533 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,351,924 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,602,866 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,223,337 bytes\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,589,997 bytes\nERROR: D:/tensorflow/tensorflow/tools/pip_package/BUILD:70:1: error loading package 'tensorflow/contrib/session_bundle': Encountered error while reading extension file 'protobuf.bzl': no such package '@protobuf_archive//': Traceback (most recent call last):\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 123\n                _apply_patch(repo_ctx, repo_ctx.attr.patch_file)\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 114, in _apply_patch\n                _execute_and_check_ret_code(repo_ctx, cmd)\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 94, in _execute_and_check_ret_code\n                fail(\"Non-zero return code({1}) when ...))\nNon-zero return code(1) when executing 'D:\\msys\\usr\\bin\\bash.exe -c patch --binary -p1 -d D:/msys/tmp/_bazel_admin/aeorbm85/external/protobuf_archive -i D:/tensorflow/third_party/protobuf/add_noinlines.patch':\nStdout: patching file src/google/protobuf/compiler/cpp/cpp_file.cc\nHunk #1 FAILED at 557 (different line endings).\nHunk #2 FAILED at 656 (different line endings).\nHunk #3 FAILED at 737 (different line endings).\n3 out of 3 hunks FAILED -- saving rejects to file src/google/protobuf/compiler/cpp/cpp_file.cc.rej\n\nStderr:  and referenced by '//tensorflow/tools/pip_package:simple_console_for_windows'.\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted.\n____Elapsed time: 34,135s", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows 8.1 64bit\r\n- **TensorFlow installed from (source or binary)**:\r\nI'm trying to build from source to use CPU optimizations\r\n- **TensorFlow version (use command below)**:\r\n1.3 cloned from master\r\n- **Python version**: \r\n3.6.1\r\n- **Bazel version (if compiling from source)**:\r\n0.5.4\r\n- **CUDA/cuDNN version**:\r\nCPU only\r\n### Describe the problem\r\nI'm trying to build TensorFlow from source to use CPU optimizations. I was getting `patch` error exactly as in [Issue #10435](https://github.com/tensorflow/tensorflow/issues/10435) so I used the [recommended solution](https://github.com/tensorflow/tensorflow/issues/10435#issuecomment-306422472) by adding `--binary` to `patch` call at _workspace.bzl_ function `_apply_patch()`. The _tensorflow/core_ is now loaded, bur I get another error with _tensorflow/contrib/session_bundle_ - see log.\r\n### Source code / logs\r\n```\r\n$ ./configure\r\nYou have bazel 0.5.4 installed.\r\nFound possible Python library paths:\r\n  D:\\anaconda\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [D:\\anaconda\\lib\\site-packages]\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\r\nNo XLA JIT support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with GDR support? [y/N]: n\r\nNo GDR support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with VERBS support? [y/N]: n\r\nNo VERBS support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: n\r\nNo CUDA support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with MPI support? [y/N]: n\r\nNo MPI support will be enabled for TensorFlow.\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native]:\r\nAdd \"--config=mkl\" to your bazel command to build with MKL support.\r\nPlease note that MKL on MacOS or windows is still not supported.\r\nIf you would like to use a local MKL instead of downloading, please set the environment variable \"TF_MKL_ROOT\" every time before build.\r\nConfiguration finished\r\n\r\n$ ./bazel build --config=opt --cpu=x64_windows_msvc --host_cpu=x64_windows_msvc --copt=-w --host_copt=-w //tensorflow/tools/pip_package:build_pip_package\r\n.............\r\n____Loading package: tensorflow/tools/pip_package\r\n____Loading package: @bazel_tools//tools/cpp\r\n____Loading package: @bazel_tools//tools/jdk\r\n____Loading package: @local_config_xcode//\r\n____Loading package: @local_config_cc//\r\n____Loading package: @local_jdk//\r\n____Loading complete.  Analyzing...\r\n____Loading package: @bazel_tools//tools/launcher\r\n____Loading package: tensorflow/contrib/nn\r\n____Loading package: tensorflow/python/tools\r\n____Loading package: tensorflow/python/eager\r\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,500,767 bytes\r\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,866,533 bytes\r\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,351,924 bytes\r\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,602,866 bytes\r\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 1,223,337 bytes\r\n____Downloading http://mirror.bazel.build/github.com/google/protobuf/archive/0b059a3d8a8f8aa40dde7bea55edca4ec5dfea66.tar.gz: 3,589,997 bytes\r\nERROR: D:/tensorflow/tensorflow/tools/pip_package/BUILD:70:1: error loading package 'tensorflow/contrib/session_bundle': Encountered error while reading extension file 'protobuf.bzl': no such package '@protobuf_archive//': Traceback (most recent call last):\r\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 123\r\n                _apply_patch(repo_ctx, repo_ctx.attr.patch_file)\r\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 114, in _apply_patch\r\n                _execute_and_check_ret_code(repo_ctx, cmd)\r\n        File \"D:/tensorflow/tensorflow/workspace.bzl\", line 94, in _execute_and_check_ret_code\r\n                fail(\"Non-zero return code({1}) when ...))\r\nNon-zero return code(1) when executing 'D:\\msys\\usr\\bin\\bash.exe -c patch --binary -p1 -d D:/msys/tmp/_bazel_admin/aeorbm85/external/protobuf_archive -i D:/tensorflow/third_party/protobuf/add_noinlines.patch':\r\nStdout: patching file src/google/protobuf/compiler/cpp/cpp_file.cc\r\nHunk #1 FAILED at 557 (different line endings).\r\nHunk #2 FAILED at 656 (different line endings).\r\nHunk #3 FAILED at 737 (different line endings).\r\n3 out of 3 hunks FAILED -- saving rejects to file src/google/protobuf/compiler/cpp/cpp_file.cc.rej\r\n\r\nStderr:  and referenced by '//tensorflow/tools/pip_package:simple_console_for_windows'.\r\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted.\r\n____Elapsed time: 34,135s\r\n```"}