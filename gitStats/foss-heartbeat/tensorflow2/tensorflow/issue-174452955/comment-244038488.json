{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/244038488", "html_url": "https://github.com/tensorflow/tensorflow/pull/4145#issuecomment-244038488", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4145", "id": 244038488, "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDAzODQ4OA==", "user": {"login": "jmhodges", "id": 598, "node_id": "MDQ6VXNlcjU5OA==", "avatar_url": "https://avatars2.githubusercontent.com/u/598?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmhodges", "html_url": "https://github.com/jmhodges", "followers_url": "https://api.github.com/users/jmhodges/followers", "following_url": "https://api.github.com/users/jmhodges/following{/other_user}", "gists_url": "https://api.github.com/users/jmhodges/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmhodges/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmhodges/subscriptions", "organizations_url": "https://api.github.com/users/jmhodges/orgs", "repos_url": "https://api.github.com/users/jmhodges/repos", "events_url": "https://api.github.com/users/jmhodges/events{/privacy}", "received_events_url": "https://api.github.com/users/jmhodges/received_events", "type": "User", "site_admin": false}, "created_at": "2016-09-01T10:23:14Z", "updated_at": "2016-09-01T10:23:14Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Building from source and think I'm running into the \"El Capitan doesn't let DYLD_LIBRARY_PATH be passed to certain executables\" error because <code>//tensorflow/cc:tutorials_example_trainer</code> is crashing with <code>Library not loaded: @rpath/libcudart.7.5.dylib</code>. I've managed to get it found by lldb and such, so it's really a matter of finding the right place to add the extra linker flags, I think. Early indication is that <code>--linkopt</code> alone isn't the right place.</p>\n<p>Output below. I'm sure I'll wake up to someone telling me I'm missing something clear to them. Thank you much for reading this.</p>\n<pre><code>$ bazel build --linkopt=\"-L/usr/local/cuda/lib\" -c opt --config=cuda //tensorflow/cc:tutorials_example_trainer --verbose_failures\n  INFO: Found 1 target...\nERROR: /Users/jmhodges/src/github.com/tensorflow/tensorflow/tensorflow/cc/BUILD:179:1: Executing genrule //tensorflow/cc:image_ops_genrule failed: bash failed: error executing command \n  (cd /private/var/tmp/_bazel_jmhodges/f1566b21c1a8243b6c363a1a9e5e03a4/execroot/tensorflow &amp;&amp; \\\n  exec env - \\\n    PATH='/Users/jmhodges/google-cloud-sdk/bin:/usr/local/cuda/bin:/Users/jmhodges/bin:/Users/jmhodges/projects/go/bin:/Library/Application Support/VMware Fusion:/Users/jmhodges/sys/depot_tools:/Users/jmhodges/bin:/Users/jmhodges/sys/bin:/Users/jmhodges/sys/sbin:/Users/jmhodges/projects/android_install/tools:/opt/local/bin:/opt/local/sbin:/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/MacGPG2/bin' \\\n    TMPDIR=/var/folders/t7/t3l9x81d7r710b8m1p0wxqp00000gn/T/ \\\n  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.h bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.cc 0'): com.google.devtools.build.lib.shell.AbnormalTerminationException: Process terminated by signal 5.\ndyld: Library not loaded: @rpath/libcudart.7.5.dylib\n  Referenced from: /private/var/tmp/_bazel_jmhodges/f1566b21c1a8243b6c363a1a9e5e03a4/execroot/tensorflow/bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc\n  Reason: image not found\n/bin/bash: line 1:  5404 Trace/BPT trap: 5       bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.h bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.cc 0\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\n</code></pre>", "body_text": "Building from source and think I'm running into the \"El Capitan doesn't let DYLD_LIBRARY_PATH be passed to certain executables\" error because //tensorflow/cc:tutorials_example_trainer is crashing with Library not loaded: @rpath/libcudart.7.5.dylib. I've managed to get it found by lldb and such, so it's really a matter of finding the right place to add the extra linker flags, I think. Early indication is that --linkopt alone isn't the right place.\nOutput below. I'm sure I'll wake up to someone telling me I'm missing something clear to them. Thank you much for reading this.\n$ bazel build --linkopt=\"-L/usr/local/cuda/lib\" -c opt --config=cuda //tensorflow/cc:tutorials_example_trainer --verbose_failures\n  INFO: Found 1 target...\nERROR: /Users/jmhodges/src/github.com/tensorflow/tensorflow/tensorflow/cc/BUILD:179:1: Executing genrule //tensorflow/cc:image_ops_genrule failed: bash failed: error executing command \n  (cd /private/var/tmp/_bazel_jmhodges/f1566b21c1a8243b6c363a1a9e5e03a4/execroot/tensorflow && \\\n  exec env - \\\n    PATH='/Users/jmhodges/google-cloud-sdk/bin:/usr/local/cuda/bin:/Users/jmhodges/bin:/Users/jmhodges/projects/go/bin:/Library/Application Support/VMware Fusion:/Users/jmhodges/sys/depot_tools:/Users/jmhodges/bin:/Users/jmhodges/sys/bin:/Users/jmhodges/sys/sbin:/Users/jmhodges/projects/android_install/tools:/opt/local/bin:/opt/local/sbin:/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/MacGPG2/bin' \\\n    TMPDIR=/var/folders/t7/t3l9x81d7r710b8m1p0wxqp00000gn/T/ \\\n  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.h bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.cc 0'): com.google.devtools.build.lib.shell.AbnormalTerminationException: Process terminated by signal 5.\ndyld: Library not loaded: @rpath/libcudart.7.5.dylib\n  Referenced from: /private/var/tmp/_bazel_jmhodges/f1566b21c1a8243b6c363a1a9e5e03a4/execroot/tensorflow/bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc\n  Reason: image not found\n/bin/bash: line 1:  5404 Trace/BPT trap: 5       bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.h bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.cc 0\nTarget //tensorflow/cc:tutorials_example_trainer failed to build", "body": "Building from source and think I'm running into the \"El Capitan doesn't let DYLD_LIBRARY_PATH be passed to certain executables\" error because `//tensorflow/cc:tutorials_example_trainer` is crashing with `Library not loaded: @rpath/libcudart.7.5.dylib`. I've managed to get it found by lldb and such, so it's really a matter of finding the right place to add the extra linker flags, I think. Early indication is that `--linkopt` alone isn't the right place.\n\nOutput below. I'm sure I'll wake up to someone telling me I'm missing something clear to them. Thank you much for reading this.\n\n```\n$ bazel build --linkopt=\"-L/usr/local/cuda/lib\" -c opt --config=cuda //tensorflow/cc:tutorials_example_trainer --verbose_failures\n  INFO: Found 1 target...\nERROR: /Users/jmhodges/src/github.com/tensorflow/tensorflow/tensorflow/cc/BUILD:179:1: Executing genrule //tensorflow/cc:image_ops_genrule failed: bash failed: error executing command \n  (cd /private/var/tmp/_bazel_jmhodges/f1566b21c1a8243b6c363a1a9e5e03a4/execroot/tensorflow && \\\n  exec env - \\\n    PATH='/Users/jmhodges/google-cloud-sdk/bin:/usr/local/cuda/bin:/Users/jmhodges/bin:/Users/jmhodges/projects/go/bin:/Library/Application Support/VMware Fusion:/Users/jmhodges/sys/depot_tools:/Users/jmhodges/bin:/Users/jmhodges/sys/bin:/Users/jmhodges/sys/sbin:/Users/jmhodges/projects/android_install/tools:/opt/local/bin:/opt/local/sbin:/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/MacGPG2/bin' \\\n    TMPDIR=/var/folders/t7/t3l9x81d7r710b8m1p0wxqp00000gn/T/ \\\n  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.h bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.cc 0'): com.google.devtools.build.lib.shell.AbnormalTerminationException: Process terminated by signal 5.\ndyld: Library not loaded: @rpath/libcudart.7.5.dylib\n  Referenced from: /private/var/tmp/_bazel_jmhodges/f1566b21c1a8243b6c363a1a9e5e03a4/execroot/tensorflow/bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc\n  Reason: image not found\n/bin/bash: line 1:  5404 Trace/BPT trap: 5       bazel-out/host/bin/tensorflow/cc/ops/image_ops_gen_cc bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.h bazel-out/local_darwin-opt/genfiles/tensorflow/cc/ops/image_ops.cc 0\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\n```\n"}