{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21164", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21164/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21164/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21164/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21164", "id": 344872794, "node_id": "MDU6SXNzdWUzNDQ4NzI3OTQ=", "number": 21164, "title": "Default floating point values in single_image_random_dot_stereograms_ops.cc cause syntax error", "user": {"login": "theHamsta", "id": 7189118, "node_id": "MDQ6VXNlcjcxODkxMTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/7189118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theHamsta", "html_url": "https://github.com/theHamsta", "followers_url": "https://api.github.com/users/theHamsta/followers", "following_url": "https://api.github.com/users/theHamsta/following{/other_user}", "gists_url": "https://api.github.com/users/theHamsta/gists{/gist_id}", "starred_url": "https://api.github.com/users/theHamsta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theHamsta/subscriptions", "organizations_url": "https://api.github.com/users/theHamsta/orgs", "repos_url": "https://api.github.com/users/theHamsta/repos", "events_url": "https://api.github.com/users/theHamsta/events{/privacy}", "received_events_url": "https://api.github.com/users/theHamsta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-07-26T14:38:53Z", "updated_at": "2018-10-08T12:28:12Z", "closed_at": "2018-09-10T19:44:57Z", "author_association": "NONE", "body_html": "<p>Have I written custom code: yes<br>\nOS Platform and Distribution: Ubuntu 18.04<br>\nTensorFlow installed from: origin master<br>\nTensorFlow version: 1.9<br>\nBazel version 0.15.2<br>\nCUDA/cuDNN version: 9.1/7.1<br>\nGPU model and memory:  NVIDIA-SMI 390.48<br>\nExact command to reproduce: use code below in python3 script<br>\nMobile device: N/A</p>\n<pre><code> import tensorflow as tf\n  vol = tf.contrib.util.make_tensor_proto([256, 256])\n</code></pre>\n<p>Import of /localhome/local/projects/lme_custom_ops/tensorflow/contrib/image/<strong>init</strong>.py causes syntax error on my system (see issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"224409205\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/serving/issues/421\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/serving/issues/421/hovercard\" href=\"https://github.com/tensorflow/serving/issues/421\">tensorflow/serving#421</a>).</p>\n<pre><code>Traceback (most recent call last):\nFile \"main.py\", line 6, in &lt;module&gt;\n    import geometry as geometry\nFile \"/localhome/local/projects/deep-iterative-reco/geometry.py\", line 20, in &lt;module&gt;\n    volume_origin = tf.contrib.util.make_tensor_proto([-((_volume_xy-1)/2 * _volume_spacing),-((_volume_xy-1)/2 * _volume_spacing)], tf.float32 )\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py\", line 53, in __getattr__\n    module = self._load()\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\n    module = importlib.import_module(self.__name__)\nFile \"/usr/lib/python3.6/importlib/__init__.py\", line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/__init__.py\", line 48, in &lt;module&gt;\n    from tensorflow.contrib import image\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/__init__.py\", line 70, in &lt;module&gt;\n    from tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py\", line 27, in &lt;module&gt;\n    \"_single_image_random_dot_stereograms.so\"))\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\n    ret = load_library.load_op_library(path)\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/load_library.py\", line 73, in load_op_library\n    exec(wrappers, module.__dict__)\nFile \"&lt;string&gt;\", line 28\n    def single_image_random_dot_stereograms(depth_values, hidden_surface_removal=True, convergence_dots_size=8, dots_per_inch=72, eye_separation=3, mu=0,333299994, normalize=True, normalize_max=-100, normalize_min=100, border_level=0, number_colors=256, output_image_shape=[1024, 768, 1], output_data_window=[1022, 757], name=None):\n                                                                                                                                                                ^\nSyntaxError: invalid syntax\n</code></pre>\n<p>Works again if I change the default kwargs float arguments to integer values. Reason maybe localization option (I am from Germany which uses , to indicate decimal point. E.g. 1.2 == 1,2 in Germany). Though I think I am using the US standard.</p>\n<p>Using this code in /tensorflow/contrib/image/ops/single_image_random_dot_stereograms_ops.cc solves the problem (not using floating values).</p>\n<pre><code>REGISTER_OP( \"SingleImageRandomDotStereograms\" )\n    .Attr( \"T: {double,float,int64,int32}\" )\n    .Input( \"depth_values: T\" )\n    .Output( \"image: uint8\" )\n    .Attr( \"hidden_surface_removal: bool = true\" )\n    .Attr( \"convergence_dots_size: int = 8\" )\n    .Attr( \"dots_per_inch: int = 72\" )\n    .Attr( \"eye_separation: float = 3\" )\n    .Attr( \"mu: float = 3333\" )\n    .Attr( \"normalize: bool = true\" )\n    .Attr( \"normalize_max: float = -100.0\" )\n    .Attr( \"normalize_min: float = 100.0\" )\n    .Attr( \"border_level: float = 0.0\" )\n    .Attr( \"number_colors: int = 256\" )\n</code></pre>\n<p>On python2 executing the following...</p>\n<pre><code>  Python 2.7.15rc1 (default, Apr 15 2018, 21:51:34) \n  [GCC 7.3.0] on linux2\n  Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n  &gt;&gt;&gt; import locale\n  &gt;&gt;&gt; locale.setlocale(locale.LC_ALL, '')\n        'LC_CTYPE=en_US.UTF-8;LC_NUMERIC=de_DE.UTF-8;LC_TIME=de_DE.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=de_DE.UTF-8;LC_ADDRESS=de_DE.UTF-8;LC_TELEPHONE=de_DE.UTF-8;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=de_DE.UTF-8'\n</code></pre>\n<p>Though I compiled for python3:</p>\n<pre><code>Python 3.6.5 (default, Apr  1 2018, 05:46:30) \nType \"copyright\", \"credits\" or \"license\" for more information.\n\nIPython 5.5.0 -- An enhanced Interactive Python.\n?         -&gt; Introduction and overview of IPython's features.\n%quickref -&gt; Quick reference.\nhelp      -&gt; Python's own help system.\nobject?   -&gt; Details about 'object', use 'object??' for extra details.\n\nIn [1]: \n...: \n...: import locale\n\nIn [2]: locale.localeconv()\nOut[2]: \n{'currency_symbol': '',\n'decimal_point': '.',\n'frac_digits': 127,\n'grouping': [],\n'int_curr_symbol': '',\n'int_frac_digits': 127,\n'mon_decimal_point': '',\n'mon_grouping': [],\n'mon_thousands_sep': '',\n'n_cs_precedes': 127,\n'n_sep_by_space': 127,\n'n_sign_posn': 127,\n'negative_sign': '',\n'p_cs_precedes': 127,\n'p_sep_by_space': 127,\n'p_sign_posn': 127,\n'positive_sign': '',\n'thousands_sep': ''}\n</code></pre>\n<p>I am using tensorflow revision <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/6d71d3fc659b317a38586f71ae94410ad3261f55/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/6d71d3fc659b317a38586f71ae94410ad3261f55\"><tt>6d71d3f</tt></a> on Ubuntu 18.08. cuDNN 7.1, CUDA 9.1</p>\n<p>This seems to be related: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"161438100\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/2974\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2974/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/2974\">#2974</a></p>", "body_text": "Have I written custom code: yes\nOS Platform and Distribution: Ubuntu 18.04\nTensorFlow installed from: origin master\nTensorFlow version: 1.9\nBazel version 0.15.2\nCUDA/cuDNN version: 9.1/7.1\nGPU model and memory:  NVIDIA-SMI 390.48\nExact command to reproduce: use code below in python3 script\nMobile device: N/A\n import tensorflow as tf\n  vol = tf.contrib.util.make_tensor_proto([256, 256])\n\nImport of /localhome/local/projects/lme_custom_ops/tensorflow/contrib/image/init.py causes syntax error on my system (see issue tensorflow/serving#421).\nTraceback (most recent call last):\nFile \"main.py\", line 6, in <module>\n    import geometry as geometry\nFile \"/localhome/local/projects/deep-iterative-reco/geometry.py\", line 20, in <module>\n    volume_origin = tf.contrib.util.make_tensor_proto([-((_volume_xy-1)/2 * _volume_spacing),-((_volume_xy-1)/2 * _volume_spacing)], tf.float32 )\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py\", line 53, in __getattr__\n    module = self._load()\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\n    module = importlib.import_module(self.__name__)\nFile \"/usr/lib/python3.6/importlib/__init__.py\", line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/__init__.py\", line 48, in <module>\n    from tensorflow.contrib import image\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/__init__.py\", line 70, in <module>\n    from tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py\", line 27, in <module>\n    \"_single_image_random_dot_stereograms.so\"))\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\n    ret = load_library.load_op_library(path)\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/load_library.py\", line 73, in load_op_library\n    exec(wrappers, module.__dict__)\nFile \"<string>\", line 28\n    def single_image_random_dot_stereograms(depth_values, hidden_surface_removal=True, convergence_dots_size=8, dots_per_inch=72, eye_separation=3, mu=0,333299994, normalize=True, normalize_max=-100, normalize_min=100, border_level=0, number_colors=256, output_image_shape=[1024, 768, 1], output_data_window=[1022, 757], name=None):\n                                                                                                                                                                ^\nSyntaxError: invalid syntax\n\nWorks again if I change the default kwargs float arguments to integer values. Reason maybe localization option (I am from Germany which uses , to indicate decimal point. E.g. 1.2 == 1,2 in Germany). Though I think I am using the US standard.\nUsing this code in /tensorflow/contrib/image/ops/single_image_random_dot_stereograms_ops.cc solves the problem (not using floating values).\nREGISTER_OP( \"SingleImageRandomDotStereograms\" )\n    .Attr( \"T: {double,float,int64,int32}\" )\n    .Input( \"depth_values: T\" )\n    .Output( \"image: uint8\" )\n    .Attr( \"hidden_surface_removal: bool = true\" )\n    .Attr( \"convergence_dots_size: int = 8\" )\n    .Attr( \"dots_per_inch: int = 72\" )\n    .Attr( \"eye_separation: float = 3\" )\n    .Attr( \"mu: float = 3333\" )\n    .Attr( \"normalize: bool = true\" )\n    .Attr( \"normalize_max: float = -100.0\" )\n    .Attr( \"normalize_min: float = 100.0\" )\n    .Attr( \"border_level: float = 0.0\" )\n    .Attr( \"number_colors: int = 256\" )\n\nOn python2 executing the following...\n  Python 2.7.15rc1 (default, Apr 15 2018, 21:51:34) \n  [GCC 7.3.0] on linux2\n  Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n  >>> import locale\n  >>> locale.setlocale(locale.LC_ALL, '')\n        'LC_CTYPE=en_US.UTF-8;LC_NUMERIC=de_DE.UTF-8;LC_TIME=de_DE.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=de_DE.UTF-8;LC_ADDRESS=de_DE.UTF-8;LC_TELEPHONE=de_DE.UTF-8;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=de_DE.UTF-8'\n\nThough I compiled for python3:\nPython 3.6.5 (default, Apr  1 2018, 05:46:30) \nType \"copyright\", \"credits\" or \"license\" for more information.\n\nIPython 5.5.0 -- An enhanced Interactive Python.\n?         -> Introduction and overview of IPython's features.\n%quickref -> Quick reference.\nhelp      -> Python's own help system.\nobject?   -> Details about 'object', use 'object??' for extra details.\n\nIn [1]: \n...: \n...: import locale\n\nIn [2]: locale.localeconv()\nOut[2]: \n{'currency_symbol': '',\n'decimal_point': '.',\n'frac_digits': 127,\n'grouping': [],\n'int_curr_symbol': '',\n'int_frac_digits': 127,\n'mon_decimal_point': '',\n'mon_grouping': [],\n'mon_thousands_sep': '',\n'n_cs_precedes': 127,\n'n_sep_by_space': 127,\n'n_sign_posn': 127,\n'negative_sign': '',\n'p_cs_precedes': 127,\n'p_sep_by_space': 127,\n'p_sign_posn': 127,\n'positive_sign': '',\n'thousands_sep': ''}\n\nI am using tensorflow revision 6d71d3f on Ubuntu 18.08. cuDNN 7.1, CUDA 9.1\nThis seems to be related: #2974", "body": "Have I written custom code: yes\r\nOS Platform and Distribution: Ubuntu 18.04\r\nTensorFlow installed from: origin master\r\nTensorFlow version: 1.9\r\nBazel version 0.15.2\r\nCUDA/cuDNN version: 9.1/7.1\r\nGPU model and memory:  NVIDIA-SMI 390.48\r\nExact command to reproduce: use code below in python3 script \r\nMobile device: N/A\r\n     \r\n     import tensorflow as tf\r\n      vol = tf.contrib.util.make_tensor_proto([256, 256])\r\n\r\nImport of /localhome/local/projects/lme_custom_ops/tensorflow/contrib/image/__init__.py causes syntax error on my system (see issue https://github.com/tensorflow/serving/issues/421).\r\n\r\n    Traceback (most recent call last):\r\n    File \"main.py\", line 6, in <module>\r\n        import geometry as geometry\r\n    File \"/localhome/local/projects/deep-iterative-reco/geometry.py\", line 20, in <module>\r\n        volume_origin = tf.contrib.util.make_tensor_proto([-((_volume_xy-1)/2 * _volume_spacing),-((_volume_xy-1)/2 * _volume_spacing)], tf.float32 )\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py\", line 53, in __getattr__\r\n        module = self._load()\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\r\n        module = importlib.import_module(self.__name__)\r\n    File \"/usr/lib/python3.6/importlib/__init__.py\", line 126, in import_module\r\n        return _bootstrap._gcd_import(name[level:], package, level)\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/__init__.py\", line 48, in <module>\r\n        from tensorflow.contrib import image\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/__init__.py\", line 70, in <module>\r\n        from tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py\", line 27, in <module>\r\n        \"_single_image_random_dot_stereograms.so\"))\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\r\n        ret = load_library.load_op_library(path)\r\n    File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/load_library.py\", line 73, in load_op_library\r\n        exec(wrappers, module.__dict__)\r\n    File \"<string>\", line 28\r\n        def single_image_random_dot_stereograms(depth_values, hidden_surface_removal=True, convergence_dots_size=8, dots_per_inch=72, eye_separation=3, mu=0,333299994, normalize=True, normalize_max=-100, normalize_min=100, border_level=0, number_colors=256, output_image_shape=[1024, 768, 1], output_data_window=[1022, 757], name=None):\r\n                                                                                                                                                                    ^\r\n    SyntaxError: invalid syntax\r\n\r\nWorks again if I change the default kwargs float arguments to integer values. Reason maybe localization option (I am from Germany which uses , to indicate decimal point. E.g. 1.2 == 1,2 in Germany). Though I think I am using the US standard.\r\n\r\nUsing this code in /tensorflow/contrib/image/ops/single_image_random_dot_stereograms_ops.cc solves the problem (not using floating values).\r\n\r\n    REGISTER_OP( \"SingleImageRandomDotStereograms\" )\r\n        .Attr( \"T: {double,float,int64,int32}\" )\r\n        .Input( \"depth_values: T\" )\r\n        .Output( \"image: uint8\" )\r\n        .Attr( \"hidden_surface_removal: bool = true\" )\r\n        .Attr( \"convergence_dots_size: int = 8\" )\r\n        .Attr( \"dots_per_inch: int = 72\" )\r\n        .Attr( \"eye_separation: float = 3\" )\r\n        .Attr( \"mu: float = 3333\" )\r\n        .Attr( \"normalize: bool = true\" )\r\n        .Attr( \"normalize_max: float = -100.0\" )\r\n        .Attr( \"normalize_min: float = 100.0\" )\r\n        .Attr( \"border_level: float = 0.0\" )\r\n        .Attr( \"number_colors: int = 256\" )\r\n\r\n\r\nOn python2 executing the following...  \r\n\r\n      Python 2.7.15rc1 (default, Apr 15 2018, 21:51:34) \r\n      [GCC 7.3.0] on linux2\r\n      Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n      >>> import locale\r\n      >>> locale.setlocale(locale.LC_ALL, '')\r\n            'LC_CTYPE=en_US.UTF-8;LC_NUMERIC=de_DE.UTF-8;LC_TIME=de_DE.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=de_DE.UTF-8;LC_ADDRESS=de_DE.UTF-8;LC_TELEPHONE=de_DE.UTF-8;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=de_DE.UTF-8'\r\n\r\nThough I compiled for python3:\r\n\r\n    Python 3.6.5 (default, Apr  1 2018, 05:46:30) \r\n    Type \"copyright\", \"credits\" or \"license\" for more information.\r\n\r\n    IPython 5.5.0 -- An enhanced Interactive Python.\r\n    ?         -> Introduction and overview of IPython's features.\r\n    %quickref -> Quick reference.\r\n    help      -> Python's own help system.\r\n    object?   -> Details about 'object', use 'object??' for extra details.\r\n\r\n    In [1]: \r\n    ...: \r\n    ...: import locale\r\n\r\n    In [2]: locale.localeconv()\r\n    Out[2]: \r\n    {'currency_symbol': '',\r\n    'decimal_point': '.',\r\n    'frac_digits': 127,\r\n    'grouping': [],\r\n    'int_curr_symbol': '',\r\n    'int_frac_digits': 127,\r\n    'mon_decimal_point': '',\r\n    'mon_grouping': [],\r\n    'mon_thousands_sep': '',\r\n    'n_cs_precedes': 127,\r\n    'n_sep_by_space': 127,\r\n    'n_sign_posn': 127,\r\n    'negative_sign': '',\r\n    'p_cs_precedes': 127,\r\n    'p_sep_by_space': 127,\r\n    'p_sign_posn': 127,\r\n    'positive_sign': '',\r\n    'thousands_sep': ''}\r\n\r\nI am using tensorflow revision 6d71d3fc659b317a38586f71ae94410ad3261f55 on Ubuntu 18.08. cuDNN 7.1, CUDA 9.1\r\n\r\nThis seems to be related: https://github.com/tensorflow/tensorflow/issues/2974"}