{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/364594754", "html_url": "https://github.com/tensorflow/tensorflow/issues/16780#issuecomment-364594754", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16780", "id": 364594754, "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDU5NDc1NA==", "user": {"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-09T23:03:52Z", "updated_at": "2018-02-09T23:03:52Z", "author_association": "MEMBER", "body_html": "<p>The first time your op is run is during a constant-folding optimization pass. When the output is sufficiently small the constant folding heuristic decides to replace the execution of the op by a constant, and when the 'real' step runs it doesn't need to execute your op again. When the output is larger, the heuristic decides it's better to keep re-running the op than fold it into a constant, so the 'real' step actually executes your op.</p>\n<p>If you put SetIsStateful on your Op registration then the constant folder ignores it, and it will only execute once as you expect, regardless of the size of the output.</p>\n<p>Closing for now but please reopen if that doesn't make sense!</p>", "body_text": "The first time your op is run is during a constant-folding optimization pass. When the output is sufficiently small the constant folding heuristic decides to replace the execution of the op by a constant, and when the 'real' step runs it doesn't need to execute your op again. When the output is larger, the heuristic decides it's better to keep re-running the op than fold it into a constant, so the 'real' step actually executes your op.\nIf you put SetIsStateful on your Op registration then the constant folder ignores it, and it will only execute once as you expect, regardless of the size of the output.\nClosing for now but please reopen if that doesn't make sense!", "body": "The first time your op is run is during a constant-folding optimization pass. When the output is sufficiently small the constant folding heuristic decides to replace the execution of the op by a constant, and when the 'real' step runs it doesn't need to execute your op again. When the output is larger, the heuristic decides it's better to keep re-running the op than fold it into a constant, so the 'real' step actually executes your op.\r\n\r\nIf you put SetIsStateful on your Op registration then the constant folder ignores it, and it will only execute once as you expect, regardless of the size of the output.\r\n\r\nClosing for now but please reopen if that doesn't make sense!"}