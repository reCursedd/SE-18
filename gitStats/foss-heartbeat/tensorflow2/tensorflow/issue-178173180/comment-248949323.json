{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/248949323", "html_url": "https://github.com/tensorflow/tensorflow/issues/4498#issuecomment-248949323", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4498", "id": 248949323, "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODk0OTMyMw==", "user": {"login": "JianbangZ", "id": 15835199, "node_id": "MDQ6VXNlcjE1ODM1MTk5", "avatar_url": "https://avatars1.githubusercontent.com/u/15835199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JianbangZ", "html_url": "https://github.com/JianbangZ", "followers_url": "https://api.github.com/users/JianbangZ/followers", "following_url": "https://api.github.com/users/JianbangZ/following{/other_user}", "gists_url": "https://api.github.com/users/JianbangZ/gists{/gist_id}", "starred_url": "https://api.github.com/users/JianbangZ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JianbangZ/subscriptions", "organizations_url": "https://api.github.com/users/JianbangZ/orgs", "repos_url": "https://api.github.com/users/JianbangZ/repos", "events_url": "https://api.github.com/users/JianbangZ/events{/privacy}", "received_events_url": "https://api.github.com/users/JianbangZ/received_events", "type": "User", "site_admin": false}, "created_at": "2016-09-22T16:07:47Z", "updated_at": "2016-09-22T16:07:47Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a> Thank you for the quick response. I am not training on GoogleNet, I am just using the method it uses to do distributed on my own network.<br>\nMy net only has 3 conv + 2 fc + 1 softmax readout layers to handle the input image size of 99*99. The total parameter count is about 9 M, which means the parameter size is 36 MB, so 40 GbE is way enough.</p>\n<p>My training speed is around 600 images/sec on single GPU/single process. Usually I use batch_size=128. with single machine 2 GPUs, so I can get 1200 images/sec.<br>\nWith distributed, no matter what batch size I try, it shows my network usage is around 1~1.3 Gbit/s, thus smaller batch size shows decreased performance.</p>\n<p>I am using the 0.10.0 pip binary.</p>\n<p>To make this easy, I uploaded my code to github, although it can't run b/c it's tied my with my own dataset and couple of environment variables, you can still see all my code.<br>\nThe script to kick off the task is <a href=\"https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/distributed_train.sh\">https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/distributed_train.sh</a><br>\nand the code to control most of the training logic is <a href=\"https://github.com/JianbangZ/eva/blob/master/eva/platform/base_distributed_train.py\">https://github.com/JianbangZ/eva/blob/master/eva/platform/base_distributed_train.py</a><br>\nI am sorry this file has a lot of commented out multi-GPU code.<br>\nthe code to define my network architect is here (I am using my own CustomNet although I implemented other nets in the same file) <a href=\"https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/cnn_model.py#L625\">https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/cnn_model.py#L625</a></p>", "body_text": "@mrry Thank you for the quick response. I am not training on GoogleNet, I am just using the method it uses to do distributed on my own network.\nMy net only has 3 conv + 2 fc + 1 softmax readout layers to handle the input image size of 99*99. The total parameter count is about 9 M, which means the parameter size is 36 MB, so 40 GbE is way enough.\nMy training speed is around 600 images/sec on single GPU/single process. Usually I use batch_size=128. with single machine 2 GPUs, so I can get 1200 images/sec.\nWith distributed, no matter what batch size I try, it shows my network usage is around 1~1.3 Gbit/s, thus smaller batch size shows decreased performance.\nI am using the 0.10.0 pip binary.\nTo make this easy, I uploaded my code to github, although it can't run b/c it's tied my with my own dataset and couple of environment variables, you can still see all my code.\nThe script to kick off the task is https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/distributed_train.sh\nand the code to control most of the training logic is https://github.com/JianbangZ/eva/blob/master/eva/platform/base_distributed_train.py\nI am sorry this file has a lot of commented out multi-GPU code.\nthe code to define my network architect is here (I am using my own CustomNet although I implemented other nets in the same file) https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/cnn_model.py#L625", "body": "@mrry Thank you for the quick response. I am not training on GoogleNet, I am just using the method it uses to do distributed on my own network.\nMy net only has 3 conv + 2 fc + 1 softmax readout layers to handle the input image size of 99*99. The total parameter count is about 9 M, which means the parameter size is 36 MB, so 40 GbE is way enough.\n\nMy training speed is around 600 images/sec on single GPU/single process. Usually I use batch_size=128. with single machine 2 GPUs, so I can get 1200 images/sec. \nWith distributed, no matter what batch size I try, it shows my network usage is around 1~1.3 Gbit/s, thus smaller batch size shows decreased performance. \n\nI am using the 0.10.0 pip binary.\n\nTo make this easy, I uploaded my code to github, although it can't run b/c it's tied my with my own dataset and couple of environment variables, you can still see all my code.\nThe script to kick off the task is https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/distributed_train.sh\nand the code to control most of the training logic is https://github.com/JianbangZ/eva/blob/master/eva/platform/base_distributed_train.py\nI am sorry this file has a lot of commented out multi-GPU code.\nthe code to define my network architect is here (I am using my own CustomNet although I implemented other nets in the same file) https://github.com/JianbangZ/eva/blob/master/eva/applications/facial_analysis/cnn_model.py#L625\n"}