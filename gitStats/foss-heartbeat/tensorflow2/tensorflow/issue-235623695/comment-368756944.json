{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/368756944", "html_url": "https://github.com/tensorflow/tensorflow/issues/10685#issuecomment-368756944", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10685", "id": 368756944, "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODc1Njk0NA==", "user": {"login": "anton-matosov", "id": 3339485, "node_id": "MDQ6VXNlcjMzMzk0ODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3339485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anton-matosov", "html_url": "https://github.com/anton-matosov", "followers_url": "https://api.github.com/users/anton-matosov/followers", "following_url": "https://api.github.com/users/anton-matosov/following{/other_user}", "gists_url": "https://api.github.com/users/anton-matosov/gists{/gist_id}", "starred_url": "https://api.github.com/users/anton-matosov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anton-matosov/subscriptions", "organizations_url": "https://api.github.com/users/anton-matosov/orgs", "repos_url": "https://api.github.com/users/anton-matosov/repos", "events_url": "https://api.github.com/users/anton-matosov/events{/privacy}", "received_events_url": "https://api.github.com/users/anton-matosov/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-27T05:58:57Z", "updated_at": "2018-02-27T05:58:57Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I have compared _tensorflow_wrap_toco.so on linux and mac and found 1 major difference that I suspect causes all these trouble.<br>\nOn linux it depends on Shared library <code>libtensorflow_framework.so</code></p>\n<pre><code>\n 0x0000000000000001 (NEEDED)             Shared library: [libtensorflow_framework.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [ld-linux-x86-64.so.2]\n</code></pre>\n<p>While on mac it has TF linked in statically (no libtensorflow_framework.so here and libmklml is linked to it directly):</p>\n<pre><code>LC 10: LC_LOAD_DYLIB         \t@rpath/libmklml.dylib\nLC 11: LC_LOAD_DYLIB         \t@rpath/libiomp5.dylib\nLC 12: LC_LOAD_DYLIB         \t/usr/lib/libSystem.B.dylib\nLC 13: LC_LOAD_DYLIB         \t/usr/lib/libc++.1.dylib\nLC 14: LC_LOAD_DYLIB         \t/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation\nLC 15: LC_LOAD_DYLIB         \t/usr/lib/libobjc.A.dylib\n</code></pre>\n<p>I am trying to put my head around <code>tf_py_wrap_cc</code> and all the deps in Bazel. But no luck so far.</p>\n<p>Any help is very welcome here.</p>", "body_text": "I have compared _tensorflow_wrap_toco.so on linux and mac and found 1 major difference that I suspect causes all these trouble.\nOn linux it depends on Shared library libtensorflow_framework.so\n\n 0x0000000000000001 (NEEDED)             Shared library: [libtensorflow_framework.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [ld-linux-x86-64.so.2]\n\nWhile on mac it has TF linked in statically (no libtensorflow_framework.so here and libmklml is linked to it directly):\nLC 10: LC_LOAD_DYLIB         \t@rpath/libmklml.dylib\nLC 11: LC_LOAD_DYLIB         \t@rpath/libiomp5.dylib\nLC 12: LC_LOAD_DYLIB         \t/usr/lib/libSystem.B.dylib\nLC 13: LC_LOAD_DYLIB         \t/usr/lib/libc++.1.dylib\nLC 14: LC_LOAD_DYLIB         \t/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation\nLC 15: LC_LOAD_DYLIB         \t/usr/lib/libobjc.A.dylib\n\nI am trying to put my head around tf_py_wrap_cc and all the deps in Bazel. But no luck so far.\nAny help is very welcome here.", "body": "I have compared _tensorflow_wrap_toco.so on linux and mac and found 1 major difference that I suspect causes all these trouble.\r\nOn linux it depends on Shared library `libtensorflow_framework.so`\r\n```\r\n\r\n 0x0000000000000001 (NEEDED)             Shared library: [libtensorflow_framework.so]\r\n 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]\r\n 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]\r\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\r\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\r\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\r\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\r\n 0x0000000000000001 (NEEDED)             Shared library: [ld-linux-x86-64.so.2]\r\n```\r\n\r\nWhile on mac it has TF linked in statically (no libtensorflow_framework.so here and libmklml is linked to it directly):\r\n```\r\nLC 10: LC_LOAD_DYLIB         \t@rpath/libmklml.dylib\r\nLC 11: LC_LOAD_DYLIB         \t@rpath/libiomp5.dylib\r\nLC 12: LC_LOAD_DYLIB         \t/usr/lib/libSystem.B.dylib\r\nLC 13: LC_LOAD_DYLIB         \t/usr/lib/libc++.1.dylib\r\nLC 14: LC_LOAD_DYLIB         \t/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation\r\nLC 15: LC_LOAD_DYLIB         \t/usr/lib/libobjc.A.dylib\r\n```\r\n\r\nI am trying to put my head around `tf_py_wrap_cc` and all the deps in Bazel. But no luck so far.\r\n\r\nAny help is very welcome here."}