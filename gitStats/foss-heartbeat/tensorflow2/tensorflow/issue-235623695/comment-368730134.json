{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/368730134", "html_url": "https://github.com/tensorflow/tensorflow/issues/10685#issuecomment-368730134", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10685", "id": 368730134, "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODczMDEzNA==", "user": {"login": "anton-matosov", "id": 3339485, "node_id": "MDQ6VXNlcjMzMzk0ODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3339485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anton-matosov", "html_url": "https://github.com/anton-matosov", "followers_url": "https://api.github.com/users/anton-matosov/followers", "following_url": "https://api.github.com/users/anton-matosov/following{/other_user}", "gists_url": "https://api.github.com/users/anton-matosov/gists{/gist_id}", "starred_url": "https://api.github.com/users/anton-matosov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anton-matosov/subscriptions", "organizations_url": "https://api.github.com/users/anton-matosov/orgs", "repos_url": "https://api.github.com/users/anton-matosov/repos", "events_url": "https://api.github.com/users/anton-matosov/events{/privacy}", "received_events_url": "https://api.github.com/users/anton-matosov/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-27T02:57:18Z", "updated_at": "2018-02-27T02:57:18Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Following crash trace in LLDB it looks like it is crashing in OpDef::~OpDef() from instance created in<br>\ntensorflow/core/ops/function_ops.cc:22</p>\n<pre><code>REGISTER_SYSTEM_OP(\"_Arg\")\n    .Output(\"output: T\")\n    .Attr(\"T: type\")\n    .Attr(\"index: int &gt;= 0\")\n    .SetIsStateful()\n    .SetShapeFn([](shape_inference::InferenceContext* context) {\n      context-&gt;set_output(0, context-&gt;UnknownShape());\n      return Status::OK();\n    })\n    .Doc(R\"doc(\nA graph node which represents an argument to a function.\n\noutput: The argument.\nindex: This argument is the index-th argument of the function.\n)doc\");\n</code></pre>\n<pre><code>    frame #0: 0x00007fff5044e9b6 libsystem_malloc.dylib`malloc_error_break\n    frame #1: 0x00007fff504407ed libsystem_malloc.dylib`free + 400\n    frame #2: 0x000000010932414d _pywrap_tensorflow_internal.so`tensorflow::OpDef::SharedDtor() + 125\n    frame #3: 0x0000000109323f5c _pywrap_tensorflow_internal.so`tensorflow::OpDef::~OpDef() + 28\n  * frame #4: 0x0000000119b93dcd _tensorflow_wrap_toco.so`_GLOBAL__sub_I_function_ops.cc + 189\n    frame #5: 0x0000000100392a0a dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 420\n    frame #6: 0x0000000100392c3a dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 40\n    frame #7: 0x000000010038e170 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, char const*, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 330\n    frame #8: 0x000000010038d2a6 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 134\n    frame #9: 0x000000010038d33a dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 74\n    frame #10: 0x00000001003813e5 dyld`dyld::runInitializers(ImageLoader*) + 82\n    frame #11: 0x000000010038a002 dyld`dlopen + 527\n    frame #12: 0x00007fff50298e86 libdyld.dylib`dlopen + 86\n    frame #13: 0x00000001001ce1b3 python`_PyImport_FindSharedFuncptr + 131```\n\n</code></pre>\n<pre><code>0x119b93d44 &lt;+52&gt;:  callq  0x119c8c010               ; tensorflow::OpDefBuilder::OpDefBuilder(tensorflow::StringPiece)\n0x119b93d49 &lt;+57&gt;:  leaq   0x857142(%rip), %rsi      ; \"output: T\"\n0x119b93d50 &lt;+64&gt;:  movl   $0x9, %edx\n0x119b93d55 &lt;+69&gt;:  movq   %rbx, %rdi\n0x119b93d58 &lt;+72&gt;:  callq  0x119c8c1c0               ; tensorflow::OpDefBuilder::Output(tensorflow::StringPiece)\n0x119b93d5d &lt;+77&gt;:  leaq   0x857138(%rip), %r14      ; \"T: type\"\n0x119b93d64 &lt;+84&gt;:  movl   $0x7, %edx\n0x119b93d69 &lt;+89&gt;:  movq   %rbx, %rdi\n0x119b93d6c &lt;+92&gt;:  movq   %r14, %rsi\n0x119b93d6f &lt;+95&gt;:  callq  0x119c8c020               ; tensorflow::OpDefBuilder::Attr(tensorflow::StringPiece)\n0x119b93d74 &lt;+100&gt;: leaq   0x857129(%rip), %r15      ; \"index: int &gt;= 0\"\n0x119b93d7b &lt;+107&gt;: movl   $0xf, %edx\n0x119b93d80 &lt;+112&gt;: movq   %rbx, %rdi\n0x119b93d83 &lt;+115&gt;: movq   %r15, %rsi\n0x119b93d86 &lt;+118&gt;: callq  0x119c8c020               ; tensorflow::OpDefBuilder::Attr(tensorflow::StringPiece)\n0x119b93d8b &lt;+123&gt;: movq   %rbx, %rdi\n0x119b93d8e &lt;+126&gt;: callq  0x119c8c3e0               ; tensorflow::OpDefBuilder::SetIsStateful()\n0x119b93d93 &lt;+131&gt;: leaq   -0x27a(%rip), %rsi        ; tensorflow::$_0::__invoke(tensorflow::shape_inference::InferenceContext*)\n0x119b93d9a &lt;+138&gt;: movq   %rbx, %rdi\n0x119b93d9d &lt;+141&gt;: callq  0x119c8c630               ; tensorflow::OpDefBuilder::SetShapeFn(tensorflow::Status (*)(tensorflow::shape_inference::InferenceContext*))\n0x119b93da2 &lt;+146&gt;: leaq   0x85710b(%rip), %rsi      ; \"\\nA graph node which represents an argument to a function.\\n\\noutput: The argument.\\nindex: This argument is the index-th argument of the function.\\n\"\n0x119b93da9 &lt;+153&gt;: movl   $0x90, %edx\n0x119b93dae &lt;+158&gt;: movq   %rbx, %rdi\n0x119b93db1 &lt;+161&gt;: callq  0x119c8c290               ; tensorflow::OpDefBuilder::Doc(tensorflow::StringPiece)\n0x119b93db6 &lt;+166&gt;: leaq   0x9532cf(%rip), %rdi      ; tensorflow::register_op0\n0x119b93dbd &lt;+173&gt;: movq   %rbx, %rsi\n0x119b93dc0 &lt;+176&gt;: callq  0x119c887e0               ; tensorflow::register_op::OpDefBuilderReceiver::OpDefBuilderReceiver(tensorflow::register_op::OpDefBuilderWrapper&lt;true&gt; const&amp;)\n0x119b93dc5 &lt;+181&gt;: movq   %rbx, %rdi\n0x119b93dc8 &lt;+184&gt;: callq  0x11a35cecc               ; symbol stub for: tensorflow::OpDefBuilder::~OpDefBuilder()\n</code></pre>\n<p>-&gt;  0x119b93dcd &lt;+189&gt;: leaq   0x857171(%rip), %rsi      ; \"_Retval\"<br>\n0x119b93dd4 &lt;+196&gt;: leaq   -0x160(%rbp), %rbx<br>\n0x119b93ddb &lt;+203&gt;: movl   $0x7, %edx</p>\n<pre><code>\nAt this point I will need help/hint from the tensorflow team to understand better what is going on here\n</code></pre>", "body_text": "Following crash trace in LLDB it looks like it is crashing in OpDef::~OpDef() from instance created in\ntensorflow/core/ops/function_ops.cc:22\nREGISTER_SYSTEM_OP(\"_Arg\")\n    .Output(\"output: T\")\n    .Attr(\"T: type\")\n    .Attr(\"index: int >= 0\")\n    .SetIsStateful()\n    .SetShapeFn([](shape_inference::InferenceContext* context) {\n      context->set_output(0, context->UnknownShape());\n      return Status::OK();\n    })\n    .Doc(R\"doc(\nA graph node which represents an argument to a function.\n\noutput: The argument.\nindex: This argument is the index-th argument of the function.\n)doc\");\n\n    frame #0: 0x00007fff5044e9b6 libsystem_malloc.dylib`malloc_error_break\n    frame #1: 0x00007fff504407ed libsystem_malloc.dylib`free + 400\n    frame #2: 0x000000010932414d _pywrap_tensorflow_internal.so`tensorflow::OpDef::SharedDtor() + 125\n    frame #3: 0x0000000109323f5c _pywrap_tensorflow_internal.so`tensorflow::OpDef::~OpDef() + 28\n  * frame #4: 0x0000000119b93dcd _tensorflow_wrap_toco.so`_GLOBAL__sub_I_function_ops.cc + 189\n    frame #5: 0x0000000100392a0a dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&) + 420\n    frame #6: 0x0000000100392c3a dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&) + 40\n    frame #7: 0x000000010038e170 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&, unsigned int, char const*, ImageLoader::InitializerTimingList&, ImageLoader::UninitedUpwards&) + 330\n    frame #8: 0x000000010038d2a6 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&, unsigned int, ImageLoader::InitializerTimingList&, ImageLoader::UninitedUpwards&) + 134\n    frame #9: 0x000000010038d33a dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&, ImageLoader::InitializerTimingList&) + 74\n    frame #10: 0x00000001003813e5 dyld`dyld::runInitializers(ImageLoader*) + 82\n    frame #11: 0x000000010038a002 dyld`dlopen + 527\n    frame #12: 0x00007fff50298e86 libdyld.dylib`dlopen + 86\n    frame #13: 0x00000001001ce1b3 python`_PyImport_FindSharedFuncptr + 131```\n\n\n0x119b93d44 <+52>:  callq  0x119c8c010               ; tensorflow::OpDefBuilder::OpDefBuilder(tensorflow::StringPiece)\n0x119b93d49 <+57>:  leaq   0x857142(%rip), %rsi      ; \"output: T\"\n0x119b93d50 <+64>:  movl   $0x9, %edx\n0x119b93d55 <+69>:  movq   %rbx, %rdi\n0x119b93d58 <+72>:  callq  0x119c8c1c0               ; tensorflow::OpDefBuilder::Output(tensorflow::StringPiece)\n0x119b93d5d <+77>:  leaq   0x857138(%rip), %r14      ; \"T: type\"\n0x119b93d64 <+84>:  movl   $0x7, %edx\n0x119b93d69 <+89>:  movq   %rbx, %rdi\n0x119b93d6c <+92>:  movq   %r14, %rsi\n0x119b93d6f <+95>:  callq  0x119c8c020               ; tensorflow::OpDefBuilder::Attr(tensorflow::StringPiece)\n0x119b93d74 <+100>: leaq   0x857129(%rip), %r15      ; \"index: int >= 0\"\n0x119b93d7b <+107>: movl   $0xf, %edx\n0x119b93d80 <+112>: movq   %rbx, %rdi\n0x119b93d83 <+115>: movq   %r15, %rsi\n0x119b93d86 <+118>: callq  0x119c8c020               ; tensorflow::OpDefBuilder::Attr(tensorflow::StringPiece)\n0x119b93d8b <+123>: movq   %rbx, %rdi\n0x119b93d8e <+126>: callq  0x119c8c3e0               ; tensorflow::OpDefBuilder::SetIsStateful()\n0x119b93d93 <+131>: leaq   -0x27a(%rip), %rsi        ; tensorflow::$_0::__invoke(tensorflow::shape_inference::InferenceContext*)\n0x119b93d9a <+138>: movq   %rbx, %rdi\n0x119b93d9d <+141>: callq  0x119c8c630               ; tensorflow::OpDefBuilder::SetShapeFn(tensorflow::Status (*)(tensorflow::shape_inference::InferenceContext*))\n0x119b93da2 <+146>: leaq   0x85710b(%rip), %rsi      ; \"\\nA graph node which represents an argument to a function.\\n\\noutput: The argument.\\nindex: This argument is the index-th argument of the function.\\n\"\n0x119b93da9 <+153>: movl   $0x90, %edx\n0x119b93dae <+158>: movq   %rbx, %rdi\n0x119b93db1 <+161>: callq  0x119c8c290               ; tensorflow::OpDefBuilder::Doc(tensorflow::StringPiece)\n0x119b93db6 <+166>: leaq   0x9532cf(%rip), %rdi      ; tensorflow::register_op0\n0x119b93dbd <+173>: movq   %rbx, %rsi\n0x119b93dc0 <+176>: callq  0x119c887e0               ; tensorflow::register_op::OpDefBuilderReceiver::OpDefBuilderReceiver(tensorflow::register_op::OpDefBuilderWrapper<true> const&)\n0x119b93dc5 <+181>: movq   %rbx, %rdi\n0x119b93dc8 <+184>: callq  0x11a35cecc               ; symbol stub for: tensorflow::OpDefBuilder::~OpDefBuilder()\n\n->  0x119b93dcd <+189>: leaq   0x857171(%rip), %rsi      ; \"_Retval\"\n0x119b93dd4 <+196>: leaq   -0x160(%rbp), %rbx\n0x119b93ddb <+203>: movl   $0x7, %edx\n\nAt this point I will need help/hint from the tensorflow team to understand better what is going on here", "body": "Following crash trace in LLDB it looks like it is crashing in OpDef::~OpDef() from instance created in \r\ntensorflow/core/ops/function_ops.cc:22\r\n```\r\nREGISTER_SYSTEM_OP(\"_Arg\")\r\n    .Output(\"output: T\")\r\n    .Attr(\"T: type\")\r\n    .Attr(\"index: int >= 0\")\r\n    .SetIsStateful()\r\n    .SetShapeFn([](shape_inference::InferenceContext* context) {\r\n      context->set_output(0, context->UnknownShape());\r\n      return Status::OK();\r\n    })\r\n    .Doc(R\"doc(\r\nA graph node which represents an argument to a function.\r\n\r\noutput: The argument.\r\nindex: This argument is the index-th argument of the function.\r\n)doc\");\r\n```\r\n\r\n```\r\n    frame #0: 0x00007fff5044e9b6 libsystem_malloc.dylib`malloc_error_break\r\n    frame #1: 0x00007fff504407ed libsystem_malloc.dylib`free + 400\r\n    frame #2: 0x000000010932414d _pywrap_tensorflow_internal.so`tensorflow::OpDef::SharedDtor() + 125\r\n    frame #3: 0x0000000109323f5c _pywrap_tensorflow_internal.so`tensorflow::OpDef::~OpDef() + 28\r\n  * frame #4: 0x0000000119b93dcd _tensorflow_wrap_toco.so`_GLOBAL__sub_I_function_ops.cc + 189\r\n    frame #5: 0x0000000100392a0a dyld`ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&) + 420\r\n    frame #6: 0x0000000100392c3a dyld`ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&) + 40\r\n    frame #7: 0x000000010038e170 dyld`ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&, unsigned int, char const*, ImageLoader::InitializerTimingList&, ImageLoader::UninitedUpwards&) + 330\r\n    frame #8: 0x000000010038d2a6 dyld`ImageLoader::processInitializers(ImageLoader::LinkContext const&, unsigned int, ImageLoader::InitializerTimingList&, ImageLoader::UninitedUpwards&) + 134\r\n    frame #9: 0x000000010038d33a dyld`ImageLoader::runInitializers(ImageLoader::LinkContext const&, ImageLoader::InitializerTimingList&) + 74\r\n    frame #10: 0x00000001003813e5 dyld`dyld::runInitializers(ImageLoader*) + 82\r\n    frame #11: 0x000000010038a002 dyld`dlopen + 527\r\n    frame #12: 0x00007fff50298e86 libdyld.dylib`dlopen + 86\r\n    frame #13: 0x00000001001ce1b3 python`_PyImport_FindSharedFuncptr + 131```\r\n\r\n```\r\n    0x119b93d44 <+52>:  callq  0x119c8c010               ; tensorflow::OpDefBuilder::OpDefBuilder(tensorflow::StringPiece)\r\n    0x119b93d49 <+57>:  leaq   0x857142(%rip), %rsi      ; \"output: T\"\r\n    0x119b93d50 <+64>:  movl   $0x9, %edx\r\n    0x119b93d55 <+69>:  movq   %rbx, %rdi\r\n    0x119b93d58 <+72>:  callq  0x119c8c1c0               ; tensorflow::OpDefBuilder::Output(tensorflow::StringPiece)\r\n    0x119b93d5d <+77>:  leaq   0x857138(%rip), %r14      ; \"T: type\"\r\n    0x119b93d64 <+84>:  movl   $0x7, %edx\r\n    0x119b93d69 <+89>:  movq   %rbx, %rdi\r\n    0x119b93d6c <+92>:  movq   %r14, %rsi\r\n    0x119b93d6f <+95>:  callq  0x119c8c020               ; tensorflow::OpDefBuilder::Attr(tensorflow::StringPiece)\r\n    0x119b93d74 <+100>: leaq   0x857129(%rip), %r15      ; \"index: int >= 0\"\r\n    0x119b93d7b <+107>: movl   $0xf, %edx\r\n    0x119b93d80 <+112>: movq   %rbx, %rdi\r\n    0x119b93d83 <+115>: movq   %r15, %rsi\r\n    0x119b93d86 <+118>: callq  0x119c8c020               ; tensorflow::OpDefBuilder::Attr(tensorflow::StringPiece)\r\n    0x119b93d8b <+123>: movq   %rbx, %rdi\r\n    0x119b93d8e <+126>: callq  0x119c8c3e0               ; tensorflow::OpDefBuilder::SetIsStateful()\r\n    0x119b93d93 <+131>: leaq   -0x27a(%rip), %rsi        ; tensorflow::$_0::__invoke(tensorflow::shape_inference::InferenceContext*)\r\n    0x119b93d9a <+138>: movq   %rbx, %rdi\r\n    0x119b93d9d <+141>: callq  0x119c8c630               ; tensorflow::OpDefBuilder::SetShapeFn(tensorflow::Status (*)(tensorflow::shape_inference::InferenceContext*))\r\n    0x119b93da2 <+146>: leaq   0x85710b(%rip), %rsi      ; \"\\nA graph node which represents an argument to a function.\\n\\noutput: The argument.\\nindex: This argument is the index-th argument of the function.\\n\"\r\n    0x119b93da9 <+153>: movl   $0x90, %edx\r\n    0x119b93dae <+158>: movq   %rbx, %rdi\r\n    0x119b93db1 <+161>: callq  0x119c8c290               ; tensorflow::OpDefBuilder::Doc(tensorflow::StringPiece)\r\n    0x119b93db6 <+166>: leaq   0x9532cf(%rip), %rdi      ; tensorflow::register_op0\r\n    0x119b93dbd <+173>: movq   %rbx, %rsi\r\n    0x119b93dc0 <+176>: callq  0x119c887e0               ; tensorflow::register_op::OpDefBuilderReceiver::OpDefBuilderReceiver(tensorflow::register_op::OpDefBuilderWrapper<true> const&)\r\n    0x119b93dc5 <+181>: movq   %rbx, %rdi\r\n    0x119b93dc8 <+184>: callq  0x11a35cecc               ; symbol stub for: tensorflow::OpDefBuilder::~OpDefBuilder()\r\n->  0x119b93dcd <+189>: leaq   0x857171(%rip), %rsi      ; \"_Retval\"\r\n    0x119b93dd4 <+196>: leaq   -0x160(%rbp), %rbx\r\n    0x119b93ddb <+203>: movl   $0x7, %edx\r\n```\r\n\r\nAt this point I will need help/hint from the tensorflow team to understand better what is going on here"}