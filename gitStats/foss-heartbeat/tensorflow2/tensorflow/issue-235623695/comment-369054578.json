{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/369054578", "html_url": "https://github.com/tensorflow/tensorflow/issues/10685#issuecomment-369054578", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10685", "id": 369054578, "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTA1NDU3OA==", "user": {"login": "anton-matosov", "id": 3339485, "node_id": "MDQ6VXNlcjMzMzk0ODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3339485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anton-matosov", "html_url": "https://github.com/anton-matosov", "followers_url": "https://api.github.com/users/anton-matosov/followers", "following_url": "https://api.github.com/users/anton-matosov/following{/other_user}", "gists_url": "https://api.github.com/users/anton-matosov/gists{/gist_id}", "starred_url": "https://api.github.com/users/anton-matosov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anton-matosov/subscriptions", "organizations_url": "https://api.github.com/users/anton-matosov/orgs", "repos_url": "https://api.github.com/users/anton-matosov/repos", "events_url": "https://api.github.com/users/anton-matosov/events{/privacy}", "received_events_url": "https://api.github.com/users/anton-matosov/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-27T22:46:25Z", "updated_at": "2018-02-27T22:46:51Z", "author_association": "CONTRIBUTOR", "body_html": "<p><g-emoji class=\"g-emoji\" alias=\"tada\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png\">\ud83c\udf89</g-emoji>I DID IT!<br>\nIt am not sure what was causing the issue (I was also playing with different optimization level and debug build, switching branches, etc.), but restarting from fresh checkout, clean conda env, rerun configure and build gave a working native binaries!!!</p>\n<p>With all the possible CPU runtime optimizations settings from <a href=\"https://www.tensorflow.org/performance/performance_guide#optimizing_for_cpu\" rel=\"nofollow\">here</a> I got this:</p>\n<h1>MKL - total images/sec: 5.82</h1>\n<h3>no MKL - total images/sec: 1.31</h3>\n<hr>\n<p>MKL benchmark command line</p>\n<pre><code>python tf_cnn_benchmarks.py --forward_only=False --device=cpu --mkl=True \\ \n            --kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\n            --batch_size=32 --num_inter_threads=1 --num_intra_threads=4\n</code></pre>", "body_text": "\ud83c\udf89I DID IT!\nIt am not sure what was causing the issue (I was also playing with different optimization level and debug build, switching branches, etc.), but restarting from fresh checkout, clean conda env, rerun configure and build gave a working native binaries!!!\nWith all the possible CPU runtime optimizations settings from here I got this:\nMKL - total images/sec: 5.82\nno MKL - total images/sec: 1.31\n\nMKL benchmark command line\npython tf_cnn_benchmarks.py --forward_only=False --device=cpu --mkl=True \\ \n            --kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\n            --batch_size=32 --num_inter_threads=1 --num_intra_threads=4", "body": "\ud83c\udf89I DID IT!\r\nIt am not sure what was causing the issue (I was also playing with different optimization level and debug build, switching branches, etc.), but restarting from fresh checkout, clean conda env, rerun configure and build gave a working native binaries!!!\r\n\r\nWith all the possible CPU runtime optimizations settings from [here](https://www.tensorflow.org/performance/performance_guide#optimizing_for_cpu) I got this:\r\n# MKL - total images/sec: 5.82\r\n### no MKL - total images/sec: 1.31 \r\n\r\n----\r\nMKL benchmark command line\r\n```\r\npython tf_cnn_benchmarks.py --forward_only=False --device=cpu --mkl=True \\ \r\n            --kmp_blocktime=0 --nodistortions --model=resnet50 --data_format=NCHW \\\r\n            --batch_size=32 --num_inter_threads=1 --num_intra_threads=4\r\n```"}