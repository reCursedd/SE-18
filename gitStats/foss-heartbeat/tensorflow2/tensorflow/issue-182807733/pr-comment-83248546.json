{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/83248546", "pull_request_review_id": 4097203, "id": 83248546, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDgzMjQ4NTQ2", "diff_hunk": "@@ -41,46 +51,67 @@ function main() {\n     exit 1\n   fi\n \n-  if [ ! -d bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/org_tensorflow ]; then\n-    # Really old (0.2.1-) runfiles, without workspace name.\n+  if is_windows; then\n+    mkdir -p ./bazel-bin/tensorflow/tools/pip_package/simple_console_for_window_unzip\n+    echo \"Unzipping simple_console_for_windows.zip to create runfiles tree...\"\n+    unzip -o -q ./bazel-bin/tensorflow/tools/pip_package/simple_console_for_windows.zip -d ./bazel-bin/tensorflow/tools/pip_package/simple_console_for_window_unzip\n+    echo \"Unzip finished.\"\n+    # runfiles structure after unzip the python binary\n     cp -R \\\n-      bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/tensorflow \\\n+      bazel-bin/tensorflow/tools/pip_package/simple_console_for_window_unzip/runfiles/org_tensorflow/tensorflow \\\n       \"${TMPDIR}\"\n     mkdir \"${TMPDIR}/external\"\n+    # Note: this makes an extra copy of org_tensorflow.\n     cp_external \\\n-      bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/external \\\n+      bazel-bin/tensorflow/tools/pip_package/simple_console_for_window_unzip/runfiles \\\n       \"${TMPDIR}/external\"\n-    RUNFILES=bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles\n+    RUNFILES=bazel-bin/tensorflow/tools/pip_package/simple_console_for_window_unzip/runfiles/org_tensorflow\n   else\n-    if [ -d bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/org_tensorflow/external ]; then\n-      # Old-style runfiles structure (--legacy_external_runfiles).\n+    if [ ! -d bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/org_tensorflow ]; then", "path": "tensorflow/tools/pip_package/build_pip_package.sh", "position": null, "original_position": 44, "commit_id": "a981a7dae464a04236c25c114872c02a4e3c574e", "original_commit_id": "38077a9dc0d076845eee39c3b52f055d30a7e29f", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "body": "Nit: Can you make this an `elif`? It's difficult to see what code has changed between the old and new version, so `elif` would let you have the same logic without changing so many lines.\n", "created_at": "2016-10-13T15:49:10Z", "updated_at": "2016-10-19T11:12:03Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/4942#discussion_r83248546", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/4942", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/83248546"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/4942#discussion_r83248546"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/4942"}}, "body_html": "<p>Nit: Can you make this an <code>elif</code>? It's difficult to see what code has changed between the old and new version, so <code>elif</code> would let you have the same logic without changing so many lines.</p>", "body_text": "Nit: Can you make this an elif? It's difficult to see what code has changed between the old and new version, so elif would let you have the same logic without changing so many lines."}