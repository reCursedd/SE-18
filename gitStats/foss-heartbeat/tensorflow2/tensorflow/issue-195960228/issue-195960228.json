{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6349", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6349/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6349/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6349/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6349", "id": 195960228, "node_id": "MDU6SXNzdWUxOTU5NjAyMjg=", "number": 6349, "title": "compile tensorflow with option \"-xMIC-AVX512\" on INTEL XEON PHI PROCESSORS failed\uff5e\uff5e", "user": {"login": "craftlk", "id": 11766771, "node_id": "MDQ6VXNlcjExNzY2Nzcx", "avatar_url": "https://avatars1.githubusercontent.com/u/11766771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/craftlk", "html_url": "https://github.com/craftlk", "followers_url": "https://api.github.com/users/craftlk/followers", "following_url": "https://api.github.com/users/craftlk/following{/other_user}", "gists_url": "https://api.github.com/users/craftlk/gists{/gist_id}", "starred_url": "https://api.github.com/users/craftlk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/craftlk/subscriptions", "organizations_url": "https://api.github.com/users/craftlk/orgs", "repos_url": "https://api.github.com/users/craftlk/repos", "events_url": "https://api.github.com/users/craftlk/events{/privacy}", "received_events_url": "https://api.github.com/users/craftlk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-12-16T01:30:49Z", "updated_at": "2017-06-16T17:35:58Z", "closed_at": "2017-06-16T17:35:58Z", "author_association": "NONE", "body_html": "<p>Hi,All,Thanks for your time.<br>\nI'm guest of a server with INTEL XEON PHI PROCESSORS(KNL) with CentOS7.<br>\nI set my own env at first and compile bazel(0.3.2) and tensorflow(v0.9.0rc0) successfully(CC=gcc).<br>\n(1) I set my own env as follows(most of it):<br>\nexport HOME=/home/guest<br>\nexport HOME_USR=$HOME/usr<br>\nexport JAVA_HOME=$HOME/jdk1.8.0_112<br>\nexport PATH=$HOME/intel/bin:$HOME/bazel_bin:$HOME_USR/bin:$JAVA_HOME/bin:$PATH<br>\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br>\nexport CPATH=$HOME_USR/include:$HOME/intel/include<br>\nexport C_INCLUDE_PATH=$CPATH<br>\nexport CPLUS_INCLUDE_PATH=$CPATH<br>\nexport LIBRARY_PATH=$HOME_USR/lib:$HOME_USR/lib64:$HOME/intel/lib/intel64_lin_mic/<br>\nexport LD_LIBRARY_PATH=$LIBRARY_PATH<br>\nexport LD_RUN_PATH=$LIBRARY_PATH<br>\nexport COMPILER_PATH=$PATH<br>\nexport CC=gcc<br>\nexport PKG_CONFIG_PATH=$HOME_USR/lib/pkgconfig:$PKG_CONFIG_PATH<br>\nexport PERL5LIB=$HOME_USR<br>\n(2)bazel is OK:<br>\n./compile.sh<br>\n(3)tensorflow is OK:<br>\n./configure<br>\nbazel build -c opt //tensorflow/tools/pip_package:build_pip_package<br>\n(4)Then the problem comes,I change the env CC=icpc , and run:<br>\nbazel build -c opt --copt=-xMIC-AVX512 //tensorflow/tools/pip_package:build_pip_package</p>\n<ol>\n<li>ERROR: /home/guest/.cache/bazel/_bazel_guest/ac941aabf1be9475583be832ae449128/external/gif_archive/BUILD:6:1: C++ compilation of rule '@gif_archive//:gif' failed: icpc failed: error executing command</li>\n<li>(cd /home/guest/.cache/bazel/_bazel_guest/ac941aabf1be9475583be832ae449128/execroot/tensorflow &amp;&amp; \\</li>\n<li>exec env - \\</li>\n<li>\n<pre><code>LD_LIBRARY_PATH=/home/guest/usr/lib:/home/guest/usr/lib64:/home/guest/cuda/lib64:/home/guest/cuda/lib64:/home/guest/cudnn:/home/guest/intel/lib/intel64_lin_mic/ \\\n</code></pre>\n</li>\n<li>\n<pre><code>PATH=/home/guest/intel/bin:/home/guest/bazel_bin:/home/guest/usr/bin:/home/guest/cuda/bin:/home/guest/jdk1.8.0_112/bin:/usr/lib64/mpich/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/guest/.local/bin:/home/guest/bin \\\n</code></pre>\n</li>\n<li>/home/guest/intel/bin/icpc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wl,-z,-relro,-z,now -B/home/guest/intel/bin -B/usr/bin -Wunused-but-set-parameter -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections -g0 -MD -MF bazel-out/host/bin/external/gif_archive/<em>objs/gif/external/gif_archive/gif_font.d -iquote external/gif_archive -iquote bazel-out/host/genfiles/external/gif_archive -iquote external/bazel_tools -iquote bazel-out/host/genfiles/external/bazel_tools -isystem external/gif_archive -isystem bazel-out/host/genfiles/external/gif_archive -isystem external/bazel_tools/tools/cpp/gcc3 -Wno-builtin-macro-redefined '-D__DATE</em>_=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c external/gif_archive/gif_font.c -o bazel-out/host/bin/external/gif_archive/_objs/gif/external/gif_archive/gif_font.o): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 2.</li>\n<li>icpc: command line warning <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"229679700\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10006\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10006/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10006\">#10006</a>: ignoring unknown option '-Wno-builtin-macro-redefined'</li>\n<li>Warning <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"149309983\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/2011\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2011/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/2011\">#2011</a>: predefined meaning of \"<strong>DATE</strong>\" discarded</li>\n<li></li>\n<li>Warning <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"149309983\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/2011\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2011/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/2011\">#2011</a>: predefined meaning of \"<strong>TIMESTAMP</strong>\" discarded</li>\n<li></li>\n<li>Warning <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"149309983\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/2011\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2011/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/2011\">#2011</a>: predefined meaning of \"<strong>TIME</strong>\" discarded</li>\n<li></li>\n<li>external/gif_archive/gif_font.c(231): error: a value of type \"void *\" cannot be assigned to an entity of type \"char *\"</li>\n<li>\n<pre><code>  dup = malloc(strlen(legend)+1);\n</code></pre>\n</li>\n<li>\n<pre><code>      ^\n</code></pre>\n</li>\n<li></li>\n<li>compilation aborted for external/gif_archive/gif_font.c (code 2)</li>\n<li>Target //tensorflow/tools/pip_package:build_pip_package failed to build</li>\n</ol>\n<p>(5)I've found a similar problem here :<br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"181133138\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/4775\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/4775/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/4775\">#4775</a><br>\nbut I don't know how to solve this problem?<br>\nI update bazel by \"git checkout tags/0.4.2\" under bazel, and try to ./compile.sh again(CC=icpc),but it doesn't work.</p>", "body_text": "Hi,All,Thanks for your time.\nI'm guest of a server with INTEL XEON PHI PROCESSORS(KNL) with CentOS7.\nI set my own env at first and compile bazel(0.3.2) and tensorflow(v0.9.0rc0) successfully(CC=gcc).\n(1) I set my own env as follows(most of it):\nexport HOME=/home/guest\nexport HOME_USR=$HOME/usr\nexport JAVA_HOME=$HOME/jdk1.8.0_112\nexport PATH=$HOME/intel/bin:$HOME/bazel_bin:$HOME_USR/bin:$JAVA_HOME/bin:$PATH\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport CPATH=$HOME_USR/include:$HOME/intel/include\nexport C_INCLUDE_PATH=$CPATH\nexport CPLUS_INCLUDE_PATH=$CPATH\nexport LIBRARY_PATH=$HOME_USR/lib:$HOME_USR/lib64:$HOME/intel/lib/intel64_lin_mic/\nexport LD_LIBRARY_PATH=$LIBRARY_PATH\nexport LD_RUN_PATH=$LIBRARY_PATH\nexport COMPILER_PATH=$PATH\nexport CC=gcc\nexport PKG_CONFIG_PATH=$HOME_USR/lib/pkgconfig:$PKG_CONFIG_PATH\nexport PERL5LIB=$HOME_USR\n(2)bazel is OK:\n./compile.sh\n(3)tensorflow is OK:\n./configure\nbazel build -c opt //tensorflow/tools/pip_package:build_pip_package\n(4)Then the problem comes,I change the env CC=icpc , and run:\nbazel build -c opt --copt=-xMIC-AVX512 //tensorflow/tools/pip_package:build_pip_package\n\nERROR: /home/guest/.cache/bazel/_bazel_guest/ac941aabf1be9475583be832ae449128/external/gif_archive/BUILD:6:1: C++ compilation of rule '@gif_archive//:gif' failed: icpc failed: error executing command\n(cd /home/guest/.cache/bazel/_bazel_guest/ac941aabf1be9475583be832ae449128/execroot/tensorflow && \\\nexec env - \\\n\nLD_LIBRARY_PATH=/home/guest/usr/lib:/home/guest/usr/lib64:/home/guest/cuda/lib64:/home/guest/cuda/lib64:/home/guest/cudnn:/home/guest/intel/lib/intel64_lin_mic/ \\\n\n\n\nPATH=/home/guest/intel/bin:/home/guest/bazel_bin:/home/guest/usr/bin:/home/guest/cuda/bin:/home/guest/jdk1.8.0_112/bin:/usr/lib64/mpich/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/guest/.local/bin:/home/guest/bin \\\n\n\n/home/guest/intel/bin/icpc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wl,-z,-relro,-z,now -B/home/guest/intel/bin -B/usr/bin -Wunused-but-set-parameter -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections -g0 -MD -MF bazel-out/host/bin/external/gif_archive/objs/gif/external/gif_archive/gif_font.d -iquote external/gif_archive -iquote bazel-out/host/genfiles/external/gif_archive -iquote external/bazel_tools -iquote bazel-out/host/genfiles/external/bazel_tools -isystem external/gif_archive -isystem bazel-out/host/genfiles/external/gif_archive -isystem external/bazel_tools/tools/cpp/gcc3 -Wno-builtin-macro-redefined '-D__DATE_=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c external/gif_archive/gif_font.c -o bazel-out/host/bin/external/gif_archive/_objs/gif/external/gif_archive/gif_font.o): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 2.\nicpc: command line warning #10006: ignoring unknown option '-Wno-builtin-macro-redefined'\nWarning #2011: predefined meaning of \"DATE\" discarded\n\nWarning #2011: predefined meaning of \"TIMESTAMP\" discarded\n\nWarning #2011: predefined meaning of \"TIME\" discarded\n\nexternal/gif_archive/gif_font.c(231): error: a value of type \"void *\" cannot be assigned to an entity of type \"char *\"\n\n  dup = malloc(strlen(legend)+1);\n\n\n\n      ^\n\n\n\ncompilation aborted for external/gif_archive/gif_font.c (code 2)\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\n\n(5)I've found a similar problem here :\n#4775\nbut I don't know how to solve this problem?\nI update bazel by \"git checkout tags/0.4.2\" under bazel, and try to ./compile.sh again(CC=icpc),but it doesn't work.", "body": "Hi,All,Thanks for your time.\r\nI'm guest of a server with INTEL XEON PHI PROCESSORS(KNL) with CentOS7.\r\nI set my own env at first and compile bazel(0.3.2) and tensorflow(v0.9.0rc0) successfully(CC=gcc).\r\n(1) I set my own env as follows(most of it):\r\nexport HOME=/home/guest\r\nexport HOME_USR=$HOME/usr\r\nexport JAVA_HOME=$HOME/jdk1.8.0_112\r\nexport PATH=$HOME/intel/bin:$HOME/bazel_bin:$HOME_USR/bin:$JAVA_HOME/bin:$PATH\r\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\r\nexport CPATH=$HOME_USR/include:$HOME/intel/include\r\nexport C_INCLUDE_PATH=$CPATH\r\nexport CPLUS_INCLUDE_PATH=$CPATH\r\nexport LIBRARY_PATH=$HOME_USR/lib:$HOME_USR/lib64:$HOME/intel/lib/intel64_lin_mic/\r\nexport LD_LIBRARY_PATH=$LIBRARY_PATH\r\nexport LD_RUN_PATH=$LIBRARY_PATH\r\nexport COMPILER_PATH=$PATH\r\nexport CC=gcc\r\nexport PKG_CONFIG_PATH=$HOME_USR/lib/pkgconfig:$PKG_CONFIG_PATH\r\nexport PERL5LIB=$HOME_USR\r\n(2)bazel is OK:  \r\n./compile.sh\r\n(3)tensorflow is OK:   \r\n./configure \r\nbazel build -c opt //tensorflow/tools/pip_package:build_pip_package\r\n(4)Then the problem comes,I change the env CC=icpc , and run:\r\nbazel build -c opt --copt=-xMIC-AVX512 //tensorflow/tools/pip_package:build_pip_package\r\n\r\n1. ERROR: /home/guest/.cache/bazel/_bazel_guest/ac941aabf1be9475583be832ae449128/external/gif_archive/BUILD:6:1: C++ compilation of rule '@gif_archive//:gif' failed: icpc failed: error executing command \r\n2.   (cd /home/guest/.cache/bazel/_bazel_guest/ac941aabf1be9475583be832ae449128/execroot/tensorflow && \\\r\n3.   exec env - \\\r\n4.     LD_LIBRARY_PATH=/home/guest/usr/lib:/home/guest/usr/lib64:/home/guest/cuda/lib64:/home/guest/cuda/lib64:/home/guest/cudnn:/home/guest/intel/lib/intel64_lin_mic/ \\\r\n5.     PATH=/home/guest/intel/bin:/home/guest/bazel_bin:/home/guest/usr/bin:/home/guest/cuda/bin:/home/guest/jdk1.8.0_112/bin:/usr/lib64/mpich/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/guest/.local/bin:/home/guest/bin \\\r\n6.   /home/guest/intel/bin/icpc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wl,-z,-relro,-z,now -B/home/guest/intel/bin -B/usr/bin -Wunused-but-set-parameter -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections -g0 -MD -MF bazel-out/host/bin/external/gif_archive/_objs/gif/external/gif_archive/gif_font.d -iquote external/gif_archive -iquote bazel-out/host/genfiles/external/gif_archive -iquote external/bazel_tools -iquote bazel-out/host/genfiles/external/bazel_tools -isystem external/gif_archive -isystem bazel-out/host/genfiles/external/gif_archive -isystem external/bazel_tools/tools/cpp/gcc3 -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c external/gif_archive/gif_font.c -o bazel-out/host/bin/external/gif_archive/_objs/gif/external/gif_archive/gif_font.o): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 2.\r\n7. icpc: command line warning #10006: ignoring unknown option '-Wno-builtin-macro-redefined'\r\n8. Warning #2011: predefined meaning of \"__DATE__\" discarded\r\n9. \r\n10. Warning #2011: predefined meaning of \"__TIMESTAMP__\" discarded\r\n11. \r\n12. Warning #2011: predefined meaning of \"__TIME__\" discarded\r\n13. \r\n14. external/gif_archive/gif_font.c(231): error: a value of type \"void *\" cannot be assigned to an entity of type \"char *\"\r\n15.       dup = malloc(strlen(legend)+1);\r\n16.           ^\r\n17. \r\n18. compilation aborted for external/gif_archive/gif_font.c (code 2)\r\n19. Target //tensorflow/tools/pip_package:build_pip_package failed to build\r\n\r\n(5)I've found a similar problem here :\r\nhttps://github.com/tensorflow/tensorflow/issues/4775\r\nbut I don't know how to solve this problem?\r\nI update bazel by \"git checkout tags/0.4.2\" under bazel, and try to ./compile.sh again(CC=icpc),but it doesn't work."}