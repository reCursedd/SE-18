{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3106", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3106/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3106/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3106/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3106", "id": 162978874, "node_id": "MDU6SXNzdWUxNjI5Nzg4NzQ=", "number": 3106, "title": "system memory leak", "user": {"login": "markpwoodward", "id": 6820773, "node_id": "MDQ6VXNlcjY4MjA3NzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/6820773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markpwoodward", "html_url": "https://github.com/markpwoodward", "followers_url": "https://api.github.com/users/markpwoodward/followers", "following_url": "https://api.github.com/users/markpwoodward/following{/other_user}", "gists_url": "https://api.github.com/users/markpwoodward/gists{/gist_id}", "starred_url": "https://api.github.com/users/markpwoodward/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markpwoodward/subscriptions", "organizations_url": "https://api.github.com/users/markpwoodward/orgs", "repos_url": "https://api.github.com/users/markpwoodward/repos", "events_url": "https://api.github.com/users/markpwoodward/events{/privacy}", "received_events_url": "https://api.github.com/users/markpwoodward/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-06-29T17:11:15Z", "updated_at": "2016-06-30T16:49:32Z", "closed_at": "2016-06-30T16:49:32Z", "author_association": "NONE", "body_html": "<p>Running tutorial_example_trainer (similar leak for my own tensorflow scripts) results in ~70MB of memory being lost. <code>free</code> shows the memory is used, but <code>ps</code> shows that no process is using the memory. Nothing short of a reboot seems to free up the memory.</p>\n<p>Reproduce with the following (After the ~10 minute run, you should be down ~7GB of memory)<br>\n<code>for i in </code>seq 1 100<code>; do ./bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu; done</code></p>\n<p>os: 14.04<br>\ngpu: Titan X (361.28)<br>\ncommit: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/0927e5eaf3f5f031dbb1d3a13ac6529d8263ad9e/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/0927e5eaf3f5f031dbb1d3a13ac6529d8263ad9e\"><tt>0927e5e</tt></a> (from yesterday)<br>\ncuda: 7.5<br>\ncudnn: 4.0.7<br>\nThis leak is also present on an EC2 12.04 with an older version of tensorflow, cuda 7.0, cudnn 6.5.</p>\n<p>Here is the output from a fresh reboot:</p>\n<pre><code>woodward@dev-box:~/install_files/tensorflow$ free -g\n             total       used       free     shared    buffers     cached\nMem:           125          0        125          0          0          0\n-/+ buffers/cache:          0        125\nSwap:          127          0        127\nwoodward@dev-box:~/install_files/tensorflow$ for i in `seq 1 100`; do ./bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu &amp;&gt;/dev/null; done\nwoodward@dev-box:~/install_files/tensorflow$ free -g\n             total       used       free     shared    buffers     cached\nMem:           125          7        118          0          0          0\n-/+ buffers/cache:          7        118\nSwap:          127          0        127\nwoodward@dev-box:~/install_files/tensorflow$ ps -Ao user,pid,%mem,vsz,rss,command --sort -rss | head -n 10\nUSER       PID %MEM    VSZ   RSS COMMAND\nroot      1263  0.0 105648  6532 sshd: woodward [priv]\nroot      1317  0.0 105648  6512 sshd: woodward [priv]\nwoodward  1387  0.0  22756  5560 /bin/bash\nwoodward  1388  0.0  22668  5504 /bin/bash\nwoodward  1390  0.0  22668  5488 /bin/bash\nwoodward  1389  0.0  22668  5464 /bin/bash\nroot      1097  0.0  61384  5376 /usr/sbin/sshd -D\nwoodward  1366  0.0  22552  5144 -bash\nwoodward  1365  0.0 106776  5000 sshd: woodward@pts/0\n</code></pre>", "body_text": "Running tutorial_example_trainer (similar leak for my own tensorflow scripts) results in ~70MB of memory being lost. free shows the memory is used, but ps shows that no process is using the memory. Nothing short of a reboot seems to free up the memory.\nReproduce with the following (After the ~10 minute run, you should be down ~7GB of memory)\nfor i in seq 1 100; do ./bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu; done\nos: 14.04\ngpu: Titan X (361.28)\ncommit: 0927e5e (from yesterday)\ncuda: 7.5\ncudnn: 4.0.7\nThis leak is also present on an EC2 12.04 with an older version of tensorflow, cuda 7.0, cudnn 6.5.\nHere is the output from a fresh reboot:\nwoodward@dev-box:~/install_files/tensorflow$ free -g\n             total       used       free     shared    buffers     cached\nMem:           125          0        125          0          0          0\n-/+ buffers/cache:          0        125\nSwap:          127          0        127\nwoodward@dev-box:~/install_files/tensorflow$ for i in `seq 1 100`; do ./bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu &>/dev/null; done\nwoodward@dev-box:~/install_files/tensorflow$ free -g\n             total       used       free     shared    buffers     cached\nMem:           125          7        118          0          0          0\n-/+ buffers/cache:          7        118\nSwap:          127          0        127\nwoodward@dev-box:~/install_files/tensorflow$ ps -Ao user,pid,%mem,vsz,rss,command --sort -rss | head -n 10\nUSER       PID %MEM    VSZ   RSS COMMAND\nroot      1263  0.0 105648  6532 sshd: woodward [priv]\nroot      1317  0.0 105648  6512 sshd: woodward [priv]\nwoodward  1387  0.0  22756  5560 /bin/bash\nwoodward  1388  0.0  22668  5504 /bin/bash\nwoodward  1390  0.0  22668  5488 /bin/bash\nwoodward  1389  0.0  22668  5464 /bin/bash\nroot      1097  0.0  61384  5376 /usr/sbin/sshd -D\nwoodward  1366  0.0  22552  5144 -bash\nwoodward  1365  0.0 106776  5000 sshd: woodward@pts/0", "body": "Running tutorial_example_trainer (similar leak for my own tensorflow scripts) results in ~70MB of memory being lost. `free` shows the memory is used, but `ps` shows that no process is using the memory. Nothing short of a reboot seems to free up the memory.\n\nReproduce with the following (After the ~10 minute run, you should be down ~7GB of memory)\n`for i in `seq 1 100`; do ./bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu; done`\n\nos: 14.04\ngpu: Titan X (361.28)\ncommit: 0927e5eaf3f5f031dbb1d3a13ac6529d8263ad9e (from yesterday)\ncuda: 7.5\ncudnn: 4.0.7\nThis leak is also present on an EC2 12.04 with an older version of tensorflow, cuda 7.0, cudnn 6.5.\n\nHere is the output from a fresh reboot:\n\n```\nwoodward@dev-box:~/install_files/tensorflow$ free -g\n             total       used       free     shared    buffers     cached\nMem:           125          0        125          0          0          0\n-/+ buffers/cache:          0        125\nSwap:          127          0        127\nwoodward@dev-box:~/install_files/tensorflow$ for i in `seq 1 100`; do ./bazel-bin/tensorflow/cc/tutorials_example_trainer --use_gpu &>/dev/null; done\nwoodward@dev-box:~/install_files/tensorflow$ free -g\n             total       used       free     shared    buffers     cached\nMem:           125          7        118          0          0          0\n-/+ buffers/cache:          7        118\nSwap:          127          0        127\nwoodward@dev-box:~/install_files/tensorflow$ ps -Ao user,pid,%mem,vsz,rss,command --sort -rss | head -n 10\nUSER       PID %MEM    VSZ   RSS COMMAND\nroot      1263  0.0 105648  6532 sshd: woodward [priv]\nroot      1317  0.0 105648  6512 sshd: woodward [priv]\nwoodward  1387  0.0  22756  5560 /bin/bash\nwoodward  1388  0.0  22668  5504 /bin/bash\nwoodward  1390  0.0  22668  5488 /bin/bash\nwoodward  1389  0.0  22668  5464 /bin/bash\nroot      1097  0.0  61384  5376 /usr/sbin/sshd -D\nwoodward  1366  0.0  22552  5144 -bash\nwoodward  1365  0.0 106776  5000 sshd: woodward@pts/0\n```\n"}