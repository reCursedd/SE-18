{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/429327841", "html_url": "https://github.com/tensorflow/tensorflow/issues/22903#issuecomment-429327841", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22903", "id": 429327841, "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTMyNzg0MQ==", "user": {"login": "volvador", "id": 15655730, "node_id": "MDQ6VXNlcjE1NjU1NzMw", "avatar_url": "https://avatars1.githubusercontent.com/u/15655730?v=4", "gravatar_id": "", "url": "https://api.github.com/users/volvador", "html_url": "https://github.com/volvador", "followers_url": "https://api.github.com/users/volvador/followers", "following_url": "https://api.github.com/users/volvador/following{/other_user}", "gists_url": "https://api.github.com/users/volvador/gists{/gist_id}", "starred_url": "https://api.github.com/users/volvador/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/volvador/subscriptions", "organizations_url": "https://api.github.com/users/volvador/orgs", "repos_url": "https://api.github.com/users/volvador/repos", "events_url": "https://api.github.com/users/volvador/events{/privacy}", "received_events_url": "https://api.github.com/users/volvador/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-12T13:35:47Z", "updated_at": "2018-10-12T13:35:47Z", "author_association": "NONE", "body_html": "<p>OK, I figured out that I needed to freeze the Keras graph before calling the tfcompile<br>\nSo I do this:</p>\n<pre><code>session = tf.keras.backend.get_session()\noutput_node_names = [node.op.name for node in model.outputs]\ngraphdef = tf.graph_util.convert_variables_to_constants(session, session.graph_def, output_node_names)\n</code></pre>\n<p>I need indeed to transform variables to constants&gt; Now how can I get a graph from the graphdef, and how can I get the input and output of that graph. Here is what I did, but does not seem to work</p>\n<pre><code>with tf.Graph().as_default() as graph:\n    tf.import_graph_def(graphdef)\n    inp = graph.get_tensor_by_name(graph.get_operations()[0].name+':0')\n    out = graph.get_tensor_by_name(graph.get_operations()[-1].name+':0')\n</code></pre>", "body_text": "OK, I figured out that I needed to freeze the Keras graph before calling the tfcompile\nSo I do this:\nsession = tf.keras.backend.get_session()\noutput_node_names = [node.op.name for node in model.outputs]\ngraphdef = tf.graph_util.convert_variables_to_constants(session, session.graph_def, output_node_names)\n\nI need indeed to transform variables to constants> Now how can I get a graph from the graphdef, and how can I get the input and output of that graph. Here is what I did, but does not seem to work\nwith tf.Graph().as_default() as graph:\n    tf.import_graph_def(graphdef)\n    inp = graph.get_tensor_by_name(graph.get_operations()[0].name+':0')\n    out = graph.get_tensor_by_name(graph.get_operations()[-1].name+':0')", "body": "OK, I figured out that I needed to freeze the Keras graph before calling the tfcompile\r\nSo I do this:\r\n\r\n    session = tf.keras.backend.get_session()\r\n    output_node_names = [node.op.name for node in model.outputs]\r\n    graphdef = tf.graph_util.convert_variables_to_constants(session, session.graph_def, output_node_names)\r\n  \r\n I need indeed to transform variables to constants> Now how can I get a graph from the graphdef, and how can I get the input and output of that graph. Here is what I did, but does not seem to work\r\n\r\n    with tf.Graph().as_default() as graph:\r\n        tf.import_graph_def(graphdef)\r\n        inp = graph.get_tensor_by_name(graph.get_operations()[0].name+':0')\r\n        out = graph.get_tensor_by_name(graph.get_operations()[-1].name+':0')\r\n\r\n    "}