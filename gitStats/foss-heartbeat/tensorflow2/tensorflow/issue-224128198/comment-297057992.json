{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/297057992", "html_url": "https://github.com/tensorflow/tensorflow/pull/9438#issuecomment-297057992", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9438", "id": 297057992, "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzA1Nzk5Mg==", "user": {"login": "vrv", "id": 463737, "node_id": "MDQ6VXNlcjQ2MzczNw==", "avatar_url": "https://avatars0.githubusercontent.com/u/463737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vrv", "html_url": "https://github.com/vrv", "followers_url": "https://api.github.com/users/vrv/followers", "following_url": "https://api.github.com/users/vrv/following{/other_user}", "gists_url": "https://api.github.com/users/vrv/gists{/gist_id}", "starred_url": "https://api.github.com/users/vrv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vrv/subscriptions", "organizations_url": "https://api.github.com/users/vrv/orgs", "repos_url": "https://api.github.com/users/vrv/repos", "events_url": "https://api.github.com/users/vrv/events{/privacy}", "received_events_url": "https://api.github.com/users/vrv/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-25T14:59:01Z", "updated_at": "2017-04-25T14:59:01Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Thanks for the PR!  I'm not entirely sure this is \"safe\" to do given the way Eigen works -- that define needs to be before the first include of the Tensor class so that the threaded implementations in Eigen are used.  Looking at some of the includers of this file, they are not defining EIGEN_USE_THREADS at the very beginning.</p>\n<p>cc <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16907534\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rmlarsen\">@rmlarsen</a></p>\n<p>I have two suggestions:</p>\n<ol>\n<li>\n<p>Find all cc files that include linalg_ops_common and add the #define at the top, so you can remove the need for the define in the header file.  This will take some work because you need to add the EIGEN_USE_THREADS in a bunch of places.</p>\n</li>\n<li>\n<p>Leave the code as is -- less ideal since I think it's bad practice to put this define in a header file, but certainly less work :)</p>\n</li>\n</ol>", "body_text": "Thanks for the PR!  I'm not entirely sure this is \"safe\" to do given the way Eigen works -- that define needs to be before the first include of the Tensor class so that the threaded implementations in Eigen are used.  Looking at some of the includers of this file, they are not defining EIGEN_USE_THREADS at the very beginning.\ncc @rmlarsen\nI have two suggestions:\n\n\nFind all cc files that include linalg_ops_common and add the #define at the top, so you can remove the need for the define in the header file.  This will take some work because you need to add the EIGEN_USE_THREADS in a bunch of places.\n\n\nLeave the code as is -- less ideal since I think it's bad practice to put this define in a header file, but certainly less work :)", "body": "Thanks for the PR!  I'm not entirely sure this is \"safe\" to do given the way Eigen works -- that define needs to be before the first include of the Tensor class so that the threaded implementations in Eigen are used.  Looking at some of the includers of this file, they are not defining EIGEN_USE_THREADS at the very beginning.\r\n\r\ncc @rmlarsen \r\n\r\nI have two suggestions:\r\n\r\n1. Find all cc files that include linalg_ops_common and add the #define at the top, so you can remove the need for the define in the header file.  This will take some work because you need to add the EIGEN_USE_THREADS in a bunch of places.\r\n\r\n2. Leave the code as is -- less ideal since I think it's bad practice to put this define in a header file, but certainly less work :)\r\n"}