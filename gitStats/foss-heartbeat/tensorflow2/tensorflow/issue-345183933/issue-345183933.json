{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21184", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21184/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21184/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21184/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21184", "id": 345183933, "node_id": "MDU6SXNzdWUzNDUxODM5MzM=", "number": 21184, "title": "ValueError: No op named QuantizedAdd in defined operations.", "user": {"login": "kiritozzl", "id": 18590696, "node_id": "MDQ6VXNlcjE4NTkwNjk2", "avatar_url": "https://avatars3.githubusercontent.com/u/18590696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kiritozzl", "html_url": "https://github.com/kiritozzl", "followers_url": "https://api.github.com/users/kiritozzl/followers", "following_url": "https://api.github.com/users/kiritozzl/following{/other_user}", "gists_url": "https://api.github.com/users/kiritozzl/gists{/gist_id}", "starred_url": "https://api.github.com/users/kiritozzl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kiritozzl/subscriptions", "organizations_url": "https://api.github.com/users/kiritozzl/orgs", "repos_url": "https://api.github.com/users/kiritozzl/repos", "events_url": "https://api.github.com/users/kiritozzl/events{/privacy}", "received_events_url": "https://api.github.com/users/kiritozzl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "angersson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angersson", "html_url": "https://github.com/angersson", "followers_url": "https://api.github.com/users/angersson/followers", "following_url": "https://api.github.com/users/angersson/following{/other_user}", "gists_url": "https://api.github.com/users/angersson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angersson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angersson/subscriptions", "organizations_url": "https://api.github.com/users/angersson/orgs", "repos_url": "https://api.github.com/users/angersson/repos", "events_url": "https://api.github.com/users/angersson/events{/privacy}", "received_events_url": "https://api.github.com/users/angersson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angersson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angersson", "html_url": "https://github.com/angersson", "followers_url": "https://api.github.com/users/angersson/followers", "following_url": "https://api.github.com/users/angersson/following{/other_user}", "gists_url": "https://api.github.com/users/angersson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angersson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angersson/subscriptions", "organizations_url": "https://api.github.com/users/angersson/orgs", "repos_url": "https://api.github.com/users/angersson/repos", "events_url": "https://api.github.com/users/angersson/events{/privacy}", "received_events_url": "https://api.github.com/users/angersson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-07-27T10:59:58Z", "updated_at": "2018-07-29T08:21:12Z", "closed_at": "2018-07-29T08:21:12Z", "author_association": "NONE", "body_html": "<p>python version:2.7.5 tensorflow version:1.2.0 bazel version:</p>\n<p>i want to use tensorflow bazel to quantize my trained model,the quantize code is follow:</p>\n<p><code>bazel-bin/tensorflow/tools/graph_transforms/transform_graph \\ --in_graph=/home/oup/zzl/zzl/AdversarialJPEG/JPEGFinalXu/Discriminative145000.pb \\ --out_graph=/home/oup/zzl/zzl/AdversarialJPEG/JPEGFinalXu/quantized8_Discriminative145000.pb \\ --outputs=Group_22/y_ \\ --transforms=' strip_unused_nodes(type=float, shape=\"1,253,253,1\") fold_constants(ignore_errors=true) fold_batch_norms fold_old_batch_norms quantize_nodes quantize_weights(minimum_size=0)'</code></p>\n<p>but when i try to get my trained model to test it accuracy, i get the error:</p>\n<p><code>tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0) 2018-07-27 14:01:15.643854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -&gt; (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:05:00.0) 2018-07-27 14:01:15.643863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:2) -&gt; (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:8a:00.0) Traceback (most recent call last): File \"testpb2.py\", line 82, in &lt;module&gt; _ = tf.import_graph_def(graph_def,name=\"\") File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 283, in import_graph_def raise ValueError('No op named %s in defined operations.' % node.op) ValueError: No op named QuantizedAdd in defined operations.</code></p>\n<p>and the code snippet to lead the error:</p>\n<p>`with tf.Session(config=config) as sess:<br>\n#load the quantity model<br>\nwith open(path+'quantized64_noDCT_retrained5000_Pruned_Discriminative145000.pb', 'rb') as f:<br>\ngraph_def = tf.GraphDef()<br>\ngraph_def.ParseFromString(f.read())<br>\n<strong>_ = tf.import_graph_def(graph_def,name=\"\")</strong><br>\ny_ = sess.graph.get_tensor_by_name('Group_22/y_:0')<br>\ncorrect_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1))<br>\naccuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))</p>\n<pre><code> init = tf.global_variables_initializer()\n sess.run(init)`\n</code></pre>\n<p>i don't konw why i delete the params 'quantize_nodes' in the quantize code it work normal,but add 'quantize_nodes' will raise the error above,is't my tensorflow version is too low lead this error?i have google that error but i can't found any solution,please give me some suggestion for that error,thank you very much!</p>", "body_text": "python version:2.7.5 tensorflow version:1.2.0 bazel version:\ni want to use tensorflow bazel to quantize my trained model,the quantize code is follow:\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\ --in_graph=/home/oup/zzl/zzl/AdversarialJPEG/JPEGFinalXu/Discriminative145000.pb \\ --out_graph=/home/oup/zzl/zzl/AdversarialJPEG/JPEGFinalXu/quantized8_Discriminative145000.pb \\ --outputs=Group_22/y_ \\ --transforms=' strip_unused_nodes(type=float, shape=\"1,253,253,1\") fold_constants(ignore_errors=true) fold_batch_norms fold_old_batch_norms quantize_nodes quantize_weights(minimum_size=0)'\nbut when i try to get my trained model to test it accuracy, i get the error:\ntensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0) 2018-07-27 14:01:15.643854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:05:00.0) 2018-07-27 14:01:15.643863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:8a:00.0) Traceback (most recent call last): File \"testpb2.py\", line 82, in <module> _ = tf.import_graph_def(graph_def,name=\"\") File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 283, in import_graph_def raise ValueError('No op named %s in defined operations.' % node.op) ValueError: No op named QuantizedAdd in defined operations.\nand the code snippet to lead the error:\n`with tf.Session(config=config) as sess:\n#load the quantity model\nwith open(path+'quantized64_noDCT_retrained5000_Pruned_Discriminative145000.pb', 'rb') as f:\ngraph_def = tf.GraphDef()\ngraph_def.ParseFromString(f.read())\n_ = tf.import_graph_def(graph_def,name=\"\")\ny_ = sess.graph.get_tensor_by_name('Group_22/y_:0')\ncorrect_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1))\naccuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))\n init = tf.global_variables_initializer()\n sess.run(init)`\n\ni don't konw why i delete the params 'quantize_nodes' in the quantize code it work normal,but add 'quantize_nodes' will raise the error above,is't my tensorflow version is too low lead this error?i have google that error but i can't found any solution,please give me some suggestion for that error,thank you very much!", "body": "python version:2.7.5 tensorflow version:1.2.0 bazel version:\r\n\r\ni want to use tensorflow bazel to quantize my trained model,the quantize code is follow:\r\n\r\n`bazel-bin/tensorflow/tools/graph_transforms/transform_graph \\\r\n  --in_graph=/home/oup/zzl/zzl/AdversarialJPEG/JPEGFinalXu/Discriminative145000.pb \\\r\n  --out_graph=/home/oup/zzl/zzl/AdversarialJPEG/JPEGFinalXu/quantized8_Discriminative145000.pb \\\r\n  --outputs=Group_22/y_ \\\r\n   --transforms='\r\n  strip_unused_nodes(type=float, shape=\"1,253,253,1\")\r\n  fold_constants(ignore_errors=true)\r\n  fold_batch_norms\r\n  fold_old_batch_norms\r\n  quantize_nodes\r\n  quantize_weights(minimum_size=0)'`\r\n\r\nbut when i try to get my trained model to test it accuracy, i get the error:\r\n\r\n`tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0)\r\n2018-07-27 14:01:15.643854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:05:00.0)\r\n2018-07-27 14:01:15.643863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:8a:00.0)\r\nTraceback (most recent call last):\r\n  File \"testpb2.py\", line 82, in <module>\r\n    _ = tf.import_graph_def(graph_def,name=\"\")\r\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 283, in import_graph_def\r\n    raise ValueError('No op named %s in defined operations.' % node.op)\r\nValueError: No op named QuantizedAdd in defined operations.`\r\n\r\nand the code snippet to lead the error:\r\n\r\n`with tf.Session(config=config) as sess:\r\n    #load the quantity model\r\n     with open(path+'quantized64_noDCT_retrained5000_Pruned_Discriminative145000.pb', 'rb') as f:\r\n        graph_def = tf.GraphDef()\r\n        graph_def.ParseFromString(f.read())\r\n        **_ = tf.import_graph_def(graph_def,name=\"\")**\r\n     y_ = sess.graph.get_tensor_by_name('Group_22/y_:0')\r\n     correct_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1))\r\n     accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))\r\n\r\n     init = tf.global_variables_initializer()\r\n     sess.run(init)`\r\n\r\n\r\ni don't konw why i delete the params 'quantize_nodes' in the quantize code it work normal,but add 'quantize_nodes' will raise the error above,is't my tensorflow version is too low lead this error?i have google that error but i can't found any solution,please give me some suggestion for that error,thank you very much!"}