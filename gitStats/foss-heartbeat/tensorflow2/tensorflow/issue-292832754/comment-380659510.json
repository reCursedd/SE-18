{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/380659510", "html_url": "https://github.com/tensorflow/tensorflow/issues/16587#issuecomment-380659510", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16587", "id": 380659510, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDY1OTUxMA==", "user": {"login": "kylemcdonald", "id": 157106, "node_id": "MDQ6VXNlcjE1NzEwNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/157106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kylemcdonald", "html_url": "https://github.com/kylemcdonald", "followers_url": "https://api.github.com/users/kylemcdonald/followers", "following_url": "https://api.github.com/users/kylemcdonald/following{/other_user}", "gists_url": "https://api.github.com/users/kylemcdonald/gists{/gist_id}", "starred_url": "https://api.github.com/users/kylemcdonald/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kylemcdonald/subscriptions", "organizations_url": "https://api.github.com/users/kylemcdonald/orgs", "repos_url": "https://api.github.com/users/kylemcdonald/repos", "events_url": "https://api.github.com/users/kylemcdonald/events{/privacy}", "received_events_url": "https://api.github.com/users/kylemcdonald/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-12T02:55:12Z", "updated_at": "2018-04-12T18:25:07Z", "author_association": "NONE", "body_html": "<p>i couldn't get it to build with the latest h5py. i thought it might be because i didn't run <code>bazel clean</code> in between builds, but i ran <code>bazel clean</code> and tried again and couldn't get it to work.</p>\n<pre><code>$ pip install git+https://github.com/h5py/h5py.git@2.8.0rc1`\n$ ./configure\n$ bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\"\nbazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\n...\nERROR: /home/kyle/Documents/setup/tensorflow/tensorflow/tools/api/generator/BUILD:27:1: Executing genrule //tensorflow/tools/api/generator:python_api_gen failed (Aborted): bash failed: error executing com\nmand /bin/bash -c ... (remaining 1 argument(s) skipped)\nWarning! ***HDF5 library version mismatched error***\nThe HDF5 header files used to compile this application do not match\nthe version used by the HDF5 library to which this application is linked.\nData corruption or segmentation faults may occur if the application continues.\nThis can happen when an application was compiled by one version of HDF5 but\nlinked with a different version of static or shared HDF5 library.\nYou should recompile the application or check your shared library related\nsettings such as 'LD_LIBRARY_PATH'.\nYou can, at your own risk, disable this warning by setting the environment\nvariable 'HDF5_DISABLE_VERSION_CHECK' to a value of '1'.\nSetting it to 2 or higher will suppress the warning messages totally.\nHeaders are 1.8.16, library is 1.8.17\n            SUMMARY OF THE HDF5 CONFIGURATION \n            ================================= \n\nGeneral Information:\n-------------------\n                   HDF5 Version: 1.8.17\n                  Configured on: Sat May 27 16:16:57 UTC 2017\n                  Configured by: root@de9f433bbe70\n                 Configure mode: production   \n                    Host system: x86_64-unknown-linux-gnu\n              Uname information: Linux de9f433bbe70 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n                       Byte sex: little-endian\n                      Libraries: static, shared\n             Installation point: /home/kyle/anaconda3\n\nCompiling Options:\n------------------\n               Compilation Mode: production   \n                     C Compiler: /opt/rh/devtoolset-2/root/usr/bin/gcc ( gcc (GCC) 4.8.2 20140120 )\n                         CFLAGS:  -m64\n                      H5_CFLAGS: -std=c99 -pedantic -Wall -Wextra -Wundef -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-qual -Wcast-align -Wwrite-strings -Wconversion -Waggregate-return -Wstrict-pro\ntotypes -Wmissing-prototypes -Wmissing-declarations -Wredundant-decls -Wnested-externs -Winline -Wfloat-equal -Wmissing-format-attribute -Wmissing-noreturn -Wpacked -Wdisabled-optimization -Wformat=2 -Wun\nreachable-code -Wendif-labels -Wdeclaration-after-statement -Wold-style-definition -Winvalid-pch -Wvariadic-macros -Winit-self -Wmissing-include-dirs -Wswitch-default -Wswitch-enum -Wunused-macros -Wunsaf\ne-loop-optimizations -Wc++-compat -Wstrict-overflow -Wlogical-op -Wlarger-than=2048 -Wvla -Wsync-nand -Wframe-larger-than=16384 -Wpacked-bitfield-compat -Wstrict-overflow=5 -Wjump-misses-init -Wdouble-pro\nmotion -Wsuggest-attribute=const -Wtrampolines -Wstack-usage=8192 -Wvector-operation-performance -Wsuggest-attribute=pure -Wsuggest-attribute=noreturn -Wsuggest-attribute=format -O3\n                      AM_CFLAGS:\n                       CPPFLAGS:\n                    H5_CPPFLAGS: -D_GNU_SOURCE -D_POSIX_C_SOURCE=200112L   -DNDEBUG -UH5_DEBUG_API\n                    AM_CPPFLAGS:  -I/home/kyle/anaconda3/include\n               Shared C Library: yes\n               Static C Library: yes\n  Statically Linked Executables: no\n                        LDFLAGS:\n                     H5_LDFLAGS:\n                     AM_LDFLAGS:  -L/home/kyle/anaconda3/lib\n                Extra libraries: -lrt -lpthread -lz -ldl -lm\n                       Archiver: ar\n                         Ranlib: ranlib\n              Debugged Packages:\n                    API Tracing: no\nLanguages:\n----------\n                        Fortran: yes\n               Fortran Compiler: /opt/rh/devtoolset-2/root/usr/bin/gfortran ( GNU Fortran (GCC) 4.8.2 20140120 )\n          Fortran 2003 Compiler: yes\n                  Fortran Flags:\n               H5 Fortran Flags:\n               AM Fortran Flags:\n         Shared Fortran Library: yes\n         Static Fortran Library: yes\n\n                            C++: yes\n                   C++ Compiler: /opt/rh/devtoolset-2/root/usr/bin/g++ ( g++ (GCC) 4.8.2 20140120 )\n                      C++ Flags:  -DBOOST_MATH_DISABLE_FLOAT128 -m64\n                   H5 C++ Flags:\n                   AM C++ Flags:\n             Shared C++ Library: yes\n             Static C++ Library: yes\n\nFeatures:\n---------\n                  Parallel HDF5: no\n             High Level library: yes\n                   Threadsafety: yes\n            Default API Mapping: v18\n With Deprecated Public Symbols: yes\n         I/O filters (external): deflate(zlib)\n                            MPE: no\n                     Direct VFD: no\n                        dmalloc: no\nClear file buffers before write: yes\n           Using memory checker: no\n         Function Stack Tracing: no\n      Strict File Format Checks: no\n   Optimization Instrumentation: no\nBye...\n/bin/bash: line 1:  5901 Aborted                 (core dumped) \n...\nINFO: Elapsed time: 2863.064s, Critical Path: 176.83s\nFAILED: Build did NOT complete successfully   \n</code></pre>\n<p>currently trying again, cleaning as much as possible:</p>\n<pre><code>$ bazel clean\n$ rm -rf /home/kyle/anaconda3/lib/python3.6/site-packages/tensor*\n$ cd .. ; rm -rf tensorflow # remove tensorflow repo\n$ pip install --upgrade --force-reinstall h5py==2.8.0rc1\n$ git clone https://github.com/tensorflow/tensorflow\n$ cd tensorflow\n$ ./configure\n$ bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\"\n</code></pre>\n<p>this time it worked! so it was something about not cleaning my installation completely before rebuilding with the new library.</p>", "body_text": "i couldn't get it to build with the latest h5py. i thought it might be because i didn't run bazel clean in between builds, but i ran bazel clean and tried again and couldn't get it to work.\n$ pip install git+https://github.com/h5py/h5py.git@2.8.0rc1`\n$ ./configure\n$ bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\"\nbazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\n...\nERROR: /home/kyle/Documents/setup/tensorflow/tensorflow/tools/api/generator/BUILD:27:1: Executing genrule //tensorflow/tools/api/generator:python_api_gen failed (Aborted): bash failed: error executing com\nmand /bin/bash -c ... (remaining 1 argument(s) skipped)\nWarning! ***HDF5 library version mismatched error***\nThe HDF5 header files used to compile this application do not match\nthe version used by the HDF5 library to which this application is linked.\nData corruption or segmentation faults may occur if the application continues.\nThis can happen when an application was compiled by one version of HDF5 but\nlinked with a different version of static or shared HDF5 library.\nYou should recompile the application or check your shared library related\nsettings such as 'LD_LIBRARY_PATH'.\nYou can, at your own risk, disable this warning by setting the environment\nvariable 'HDF5_DISABLE_VERSION_CHECK' to a value of '1'.\nSetting it to 2 or higher will suppress the warning messages totally.\nHeaders are 1.8.16, library is 1.8.17\n            SUMMARY OF THE HDF5 CONFIGURATION \n            ================================= \n\nGeneral Information:\n-------------------\n                   HDF5 Version: 1.8.17\n                  Configured on: Sat May 27 16:16:57 UTC 2017\n                  Configured by: root@de9f433bbe70\n                 Configure mode: production   \n                    Host system: x86_64-unknown-linux-gnu\n              Uname information: Linux de9f433bbe70 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n                       Byte sex: little-endian\n                      Libraries: static, shared\n             Installation point: /home/kyle/anaconda3\n\nCompiling Options:\n------------------\n               Compilation Mode: production   \n                     C Compiler: /opt/rh/devtoolset-2/root/usr/bin/gcc ( gcc (GCC) 4.8.2 20140120 )\n                         CFLAGS:  -m64\n                      H5_CFLAGS: -std=c99 -pedantic -Wall -Wextra -Wundef -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-qual -Wcast-align -Wwrite-strings -Wconversion -Waggregate-return -Wstrict-pro\ntotypes -Wmissing-prototypes -Wmissing-declarations -Wredundant-decls -Wnested-externs -Winline -Wfloat-equal -Wmissing-format-attribute -Wmissing-noreturn -Wpacked -Wdisabled-optimization -Wformat=2 -Wun\nreachable-code -Wendif-labels -Wdeclaration-after-statement -Wold-style-definition -Winvalid-pch -Wvariadic-macros -Winit-self -Wmissing-include-dirs -Wswitch-default -Wswitch-enum -Wunused-macros -Wunsaf\ne-loop-optimizations -Wc++-compat -Wstrict-overflow -Wlogical-op -Wlarger-than=2048 -Wvla -Wsync-nand -Wframe-larger-than=16384 -Wpacked-bitfield-compat -Wstrict-overflow=5 -Wjump-misses-init -Wdouble-pro\nmotion -Wsuggest-attribute=const -Wtrampolines -Wstack-usage=8192 -Wvector-operation-performance -Wsuggest-attribute=pure -Wsuggest-attribute=noreturn -Wsuggest-attribute=format -O3\n                      AM_CFLAGS:\n                       CPPFLAGS:\n                    H5_CPPFLAGS: -D_GNU_SOURCE -D_POSIX_C_SOURCE=200112L   -DNDEBUG -UH5_DEBUG_API\n                    AM_CPPFLAGS:  -I/home/kyle/anaconda3/include\n               Shared C Library: yes\n               Static C Library: yes\n  Statically Linked Executables: no\n                        LDFLAGS:\n                     H5_LDFLAGS:\n                     AM_LDFLAGS:  -L/home/kyle/anaconda3/lib\n                Extra libraries: -lrt -lpthread -lz -ldl -lm\n                       Archiver: ar\n                         Ranlib: ranlib\n              Debugged Packages:\n                    API Tracing: no\nLanguages:\n----------\n                        Fortran: yes\n               Fortran Compiler: /opt/rh/devtoolset-2/root/usr/bin/gfortran ( GNU Fortran (GCC) 4.8.2 20140120 )\n          Fortran 2003 Compiler: yes\n                  Fortran Flags:\n               H5 Fortran Flags:\n               AM Fortran Flags:\n         Shared Fortran Library: yes\n         Static Fortran Library: yes\n\n                            C++: yes\n                   C++ Compiler: /opt/rh/devtoolset-2/root/usr/bin/g++ ( g++ (GCC) 4.8.2 20140120 )\n                      C++ Flags:  -DBOOST_MATH_DISABLE_FLOAT128 -m64\n                   H5 C++ Flags:\n                   AM C++ Flags:\n             Shared C++ Library: yes\n             Static C++ Library: yes\n\nFeatures:\n---------\n                  Parallel HDF5: no\n             High Level library: yes\n                   Threadsafety: yes\n            Default API Mapping: v18\n With Deprecated Public Symbols: yes\n         I/O filters (external): deflate(zlib)\n                            MPE: no\n                     Direct VFD: no\n                        dmalloc: no\nClear file buffers before write: yes\n           Using memory checker: no\n         Function Stack Tracing: no\n      Strict File Format Checks: no\n   Optimization Instrumentation: no\nBye...\n/bin/bash: line 1:  5901 Aborted                 (core dumped) \n...\nINFO: Elapsed time: 2863.064s, Critical Path: 176.83s\nFAILED: Build did NOT complete successfully   \n\ncurrently trying again, cleaning as much as possible:\n$ bazel clean\n$ rm -rf /home/kyle/anaconda3/lib/python3.6/site-packages/tensor*\n$ cd .. ; rm -rf tensorflow # remove tensorflow repo\n$ pip install --upgrade --force-reinstall h5py==2.8.0rc1\n$ git clone https://github.com/tensorflow/tensorflow\n$ cd tensorflow\n$ ./configure\n$ bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\"\n\nthis time it worked! so it was something about not cleaning my installation completely before rebuilding with the new library.", "body": "i couldn't get it to build with the latest h5py. i thought it might be because i didn't run `bazel clean` in between builds, but i ran `bazel clean` and tried again and couldn't get it to work.\r\n\r\n```\r\n$ pip install git+https://github.com/h5py/h5py.git@2.8.0rc1`\r\n$ ./configure\r\n$ bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\"\r\nbazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\r\n...\r\nERROR: /home/kyle/Documents/setup/tensorflow/tensorflow/tools/api/generator/BUILD:27:1: Executing genrule //tensorflow/tools/api/generator:python_api_gen failed (Aborted): bash failed: error executing com\r\nmand /bin/bash -c ... (remaining 1 argument(s) skipped)\r\nWarning! ***HDF5 library version mismatched error***\r\nThe HDF5 header files used to compile this application do not match\r\nthe version used by the HDF5 library to which this application is linked.\r\nData corruption or segmentation faults may occur if the application continues.\r\nThis can happen when an application was compiled by one version of HDF5 but\r\nlinked with a different version of static or shared HDF5 library.\r\nYou should recompile the application or check your shared library related\r\nsettings such as 'LD_LIBRARY_PATH'.\r\nYou can, at your own risk, disable this warning by setting the environment\r\nvariable 'HDF5_DISABLE_VERSION_CHECK' to a value of '1'.\r\nSetting it to 2 or higher will suppress the warning messages totally.\r\nHeaders are 1.8.16, library is 1.8.17\r\n            SUMMARY OF THE HDF5 CONFIGURATION \r\n            ================================= \r\n\r\nGeneral Information:\r\n-------------------\r\n                   HDF5 Version: 1.8.17\r\n                  Configured on: Sat May 27 16:16:57 UTC 2017\r\n                  Configured by: root@de9f433bbe70\r\n                 Configure mode: production   \r\n                    Host system: x86_64-unknown-linux-gnu\r\n              Uname information: Linux de9f433bbe70 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n                       Byte sex: little-endian\r\n                      Libraries: static, shared\r\n             Installation point: /home/kyle/anaconda3\r\n\r\nCompiling Options:\r\n------------------\r\n               Compilation Mode: production   \r\n                     C Compiler: /opt/rh/devtoolset-2/root/usr/bin/gcc ( gcc (GCC) 4.8.2 20140120 )\r\n                         CFLAGS:  -m64\r\n                      H5_CFLAGS: -std=c99 -pedantic -Wall -Wextra -Wundef -Wshadow -Wpointer-arith -Wbad-function-cast -Wcast-qual -Wcast-align -Wwrite-strings -Wconversion -Waggregate-return -Wstrict-pro\r\ntotypes -Wmissing-prototypes -Wmissing-declarations -Wredundant-decls -Wnested-externs -Winline -Wfloat-equal -Wmissing-format-attribute -Wmissing-noreturn -Wpacked -Wdisabled-optimization -Wformat=2 -Wun\r\nreachable-code -Wendif-labels -Wdeclaration-after-statement -Wold-style-definition -Winvalid-pch -Wvariadic-macros -Winit-self -Wmissing-include-dirs -Wswitch-default -Wswitch-enum -Wunused-macros -Wunsaf\r\ne-loop-optimizations -Wc++-compat -Wstrict-overflow -Wlogical-op -Wlarger-than=2048 -Wvla -Wsync-nand -Wframe-larger-than=16384 -Wpacked-bitfield-compat -Wstrict-overflow=5 -Wjump-misses-init -Wdouble-pro\r\nmotion -Wsuggest-attribute=const -Wtrampolines -Wstack-usage=8192 -Wvector-operation-performance -Wsuggest-attribute=pure -Wsuggest-attribute=noreturn -Wsuggest-attribute=format -O3\r\n                      AM_CFLAGS:\r\n                       CPPFLAGS:\r\n                    H5_CPPFLAGS: -D_GNU_SOURCE -D_POSIX_C_SOURCE=200112L   -DNDEBUG -UH5_DEBUG_API\r\n                    AM_CPPFLAGS:  -I/home/kyle/anaconda3/include\r\n               Shared C Library: yes\r\n               Static C Library: yes\r\n  Statically Linked Executables: no\r\n                        LDFLAGS:\r\n                     H5_LDFLAGS:\r\n                     AM_LDFLAGS:  -L/home/kyle/anaconda3/lib\r\n                Extra libraries: -lrt -lpthread -lz -ldl -lm\r\n                       Archiver: ar\r\n                         Ranlib: ranlib\r\n              Debugged Packages:\r\n                    API Tracing: no\r\nLanguages:\r\n----------\r\n                        Fortran: yes\r\n               Fortran Compiler: /opt/rh/devtoolset-2/root/usr/bin/gfortran ( GNU Fortran (GCC) 4.8.2 20140120 )\r\n          Fortran 2003 Compiler: yes\r\n                  Fortran Flags:\r\n               H5 Fortran Flags:\r\n               AM Fortran Flags:\r\n         Shared Fortran Library: yes\r\n         Static Fortran Library: yes\r\n\r\n                            C++: yes\r\n                   C++ Compiler: /opt/rh/devtoolset-2/root/usr/bin/g++ ( g++ (GCC) 4.8.2 20140120 )\r\n                      C++ Flags:  -DBOOST_MATH_DISABLE_FLOAT128 -m64\r\n                   H5 C++ Flags:\r\n                   AM C++ Flags:\r\n             Shared C++ Library: yes\r\n             Static C++ Library: yes\r\n\r\nFeatures:\r\n---------\r\n                  Parallel HDF5: no\r\n             High Level library: yes\r\n                   Threadsafety: yes\r\n            Default API Mapping: v18\r\n With Deprecated Public Symbols: yes\r\n         I/O filters (external): deflate(zlib)\r\n                            MPE: no\r\n                     Direct VFD: no\r\n                        dmalloc: no\r\nClear file buffers before write: yes\r\n           Using memory checker: no\r\n         Function Stack Tracing: no\r\n      Strict File Format Checks: no\r\n   Optimization Instrumentation: no\r\nBye...\r\n/bin/bash: line 1:  5901 Aborted                 (core dumped) \r\n...\r\nINFO: Elapsed time: 2863.064s, Critical Path: 176.83s\r\nFAILED: Build did NOT complete successfully   \r\n```\r\n\r\ncurrently trying again, cleaning as much as possible:\r\n\r\n```\r\n$ bazel clean\r\n$ rm -rf /home/kyle/anaconda3/lib/python3.6/site-packages/tensor*\r\n$ cd .. ; rm -rf tensorflow # remove tensorflow repo\r\n$ pip install --upgrade --force-reinstall h5py==2.8.0rc1\r\n$ git clone https://github.com/tensorflow/tensorflow\r\n$ cd tensorflow\r\n$ ./configure\r\n$ bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\"\r\n```\r\n\r\nthis time it worked! so it was something about not cleaning my installation completely before rebuilding with the new library."}