{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/616", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/616/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/616/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/616/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/616", "id": 123865155, "node_id": "MDU6SXNzdWUxMjM4NjUxNTU=", "number": 616, "title": "How  to use tf.train.write_graph() and tf.import_graph_def()? It seems that it does not work.", "user": {"login": "leftstone2015", "id": 11816941, "node_id": "MDQ6VXNlcjExODE2OTQx", "avatar_url": "https://avatars2.githubusercontent.com/u/11816941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leftstone2015", "html_url": "https://github.com/leftstone2015", "followers_url": "https://api.github.com/users/leftstone2015/followers", "following_url": "https://api.github.com/users/leftstone2015/following{/other_user}", "gists_url": "https://api.github.com/users/leftstone2015/gists{/gist_id}", "starred_url": "https://api.github.com/users/leftstone2015/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leftstone2015/subscriptions", "organizations_url": "https://api.github.com/users/leftstone2015/orgs", "repos_url": "https://api.github.com/users/leftstone2015/repos", "events_url": "https://api.github.com/users/leftstone2015/events{/privacy}", "received_events_url": "https://api.github.com/users/leftstone2015/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": true, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 44, "created_at": "2015-12-25T08:41:51Z", "updated_at": "2017-01-26T00:22:15Z", "closed_at": "2016-03-29T05:35:05Z", "author_association": "NONE", "body_html": "<p>How  to use tf.train.write_graph() and tf.import_graph_def()? It seems that it does not work.</p>\n<p>Please refer the following codes and prints, the final result is None, but it is expected to be [101 102 103 104 105 106 107 108 109 110].</p>\n<p>code\uff1a</p>\n<p>import tensorflow as tf<br>\nimport os<br>\nimport numpy as np<br>\nfrom tensorflow.python.platform import gfile</p>\n<p>input1= tf.placeholder(tf.int32, [10], name=\"input\")<br>\ndata = np.arange(10)<br>\noutput1= tf.add(input1, tf.constant(1), name=\"output\")</p>\n<p>with tf.Session() as sess:<br>\nos.system(\"rm -rf /tmp/load\")<br>\ntf.train.write_graph(sess.graph_def, \"/tmp/load\", \"test.pb\", False)<br>\nprint sess.run(output1,{input1:data})<br>\nprint \"Done\"</p>\n<h1>load graph</h1>\n<p>with gfile.FastGFile(\"/tmp/load/test.pb\",'rb') as f:<br>\ngraph_def = tf.GraphDef()<br>\ngraph_def.ParseFromString(f.read())<br>\ntf.import_graph_def(graph_def, name='')</p>\n<h1>run</h1>\n<p>with tf.Session() as sess:<br>\ninput_x = sess.graph.get_tensor_by_name(\"input:0\")<br>\nprint input_x<br>\nConst = sess.graph.get_tensor_by_name(\"Const:0\")<br>\nprint Const<br>\noutput = sess.graph.get_operation_by_name(\"output\")<br>\nprint output</p>\n<pre><code>data1 = np.arange(10)+100\nprint \"data1:\", data1\nresult = sess.run(output, {input_x: data1})\nprint \"result:\",result\n</code></pre>\n<p>prints\uff1a<br>\n[ 1  2  3  4  5  6  7  8  9 10]<br>\nDone<br>\nTensor(\"input:0\", shape=TensorShape([Dimension(10)]), dtype=int32)<br>\nTensor(\"Const:0\", shape=TensorShape([]), dtype=int32)<br>\nname: \"output\"<br>\nop: \"Add\"<br>\ninput: \"input\"<br>\ninput: \"Const\"<br>\nattr {<br>\nkey: \"T\"<br>\nvalue {<br>\ntype: DT_INT32<br>\n}<br>\n}</p>\n<p>data1: [100 101 102 103 104 105 106 107 108 109]<br>\nresult: None</p>", "body_text": "How  to use tf.train.write_graph() and tf.import_graph_def()? It seems that it does not work.\nPlease refer the following codes and prints, the final result is None, but it is expected to be [101 102 103 104 105 106 107 108 109 110].\ncode\uff1a\nimport tensorflow as tf\nimport os\nimport numpy as np\nfrom tensorflow.python.platform import gfile\ninput1= tf.placeholder(tf.int32, [10], name=\"input\")\ndata = np.arange(10)\noutput1= tf.add(input1, tf.constant(1), name=\"output\")\nwith tf.Session() as sess:\nos.system(\"rm -rf /tmp/load\")\ntf.train.write_graph(sess.graph_def, \"/tmp/load\", \"test.pb\", False)\nprint sess.run(output1,{input1:data})\nprint \"Done\"\nload graph\nwith gfile.FastGFile(\"/tmp/load/test.pb\",'rb') as f:\ngraph_def = tf.GraphDef()\ngraph_def.ParseFromString(f.read())\ntf.import_graph_def(graph_def, name='')\nrun\nwith tf.Session() as sess:\ninput_x = sess.graph.get_tensor_by_name(\"input:0\")\nprint input_x\nConst = sess.graph.get_tensor_by_name(\"Const:0\")\nprint Const\noutput = sess.graph.get_operation_by_name(\"output\")\nprint output\ndata1 = np.arange(10)+100\nprint \"data1:\", data1\nresult = sess.run(output, {input_x: data1})\nprint \"result:\",result\n\nprints\uff1a\n[ 1  2  3  4  5  6  7  8  9 10]\nDone\nTensor(\"input:0\", shape=TensorShape([Dimension(10)]), dtype=int32)\nTensor(\"Const:0\", shape=TensorShape([]), dtype=int32)\nname: \"output\"\nop: \"Add\"\ninput: \"input\"\ninput: \"Const\"\nattr {\nkey: \"T\"\nvalue {\ntype: DT_INT32\n}\n}\ndata1: [100 101 102 103 104 105 106 107 108 109]\nresult: None", "body": "How  to use tf.train.write_graph() and tf.import_graph_def()? It seems that it does not work.\n\nPlease refer the following codes and prints, the final result is None, but it is expected to be [101 102 103 104 105 106 107 108 109 110].\n\ncode\uff1a\n\nimport tensorflow as tf\nimport os\nimport numpy as np\nfrom tensorflow.python.platform import gfile\n\ninput1= tf.placeholder(tf.int32, [10], name=\"input\")\ndata = np.arange(10)\noutput1= tf.add(input1, tf.constant(1), name=\"output\")\n\nwith tf.Session() as sess:\n    os.system(\"rm -rf /tmp/load\")\n    tf.train.write_graph(sess.graph_def, \"/tmp/load\", \"test.pb\", False)\n    print sess.run(output1,{input1:data})\nprint \"Done\"\n# load graph\n\nwith gfile.FastGFile(\"/tmp/load/test.pb\",'rb') as f:\n    graph_def = tf.GraphDef()\n    graph_def.ParseFromString(f.read())\n    tf.import_graph_def(graph_def, name='')\n# run\n\nwith tf.Session() as sess:\n    input_x = sess.graph.get_tensor_by_name(\"input:0\")\n    print input_x\n    Const = sess.graph.get_tensor_by_name(\"Const:0\")\n    print Const  \n    output = sess.graph.get_operation_by_name(\"output\")\n    print output\n\n```\ndata1 = np.arange(10)+100\nprint \"data1:\", data1\nresult = sess.run(output, {input_x: data1})\nprint \"result:\",result\n```\n\nprints\uff1a\n[ 1  2  3  4  5  6  7  8  9 10]\nDone\nTensor(\"input:0\", shape=TensorShape([Dimension(10)]), dtype=int32)\nTensor(\"Const:0\", shape=TensorShape([]), dtype=int32)\nname: \"output\"\nop: \"Add\"\ninput: \"input\"\ninput: \"Const\"\nattr {\n  key: \"T\"\n  value {\n    type: DT_INT32\n  }\n}\n\ndata1: [100 101 102 103 104 105 106 107 108 109]\nresult: None\n"}