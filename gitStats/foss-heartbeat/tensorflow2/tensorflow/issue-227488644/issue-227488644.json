{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9801", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9801/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9801/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9801/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9801", "id": 227488644, "node_id": "MDU6SXNzdWUyMjc0ODg2NDQ=", "number": 9801, "title": "ValueError: Cannot feed value of shape (1, 40, 3) for Tensor u'cls1_fc_pose_xyz_target:0', which has shape '(?, ?)", "user": {"login": "TheRed002", "id": 1557123, "node_id": "MDQ6VXNlcjE1NTcxMjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/1557123?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheRed002", "html_url": "https://github.com/TheRed002", "followers_url": "https://api.github.com/users/TheRed002/followers", "following_url": "https://api.github.com/users/TheRed002/following{/other_user}", "gists_url": "https://api.github.com/users/TheRed002/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheRed002/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheRed002/subscriptions", "organizations_url": "https://api.github.com/users/TheRed002/orgs", "repos_url": "https://api.github.com/users/TheRed002/repos", "events_url": "https://api.github.com/users/TheRed002/events{/privacy}", "received_events_url": "https://api.github.com/users/TheRed002/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-09T20:31:22Z", "updated_at": "2017-05-09T22:40:50Z", "closed_at": "2017-05-09T22:40:49Z", "author_association": "NONE", "body_html": "<p>I have installed keras using conda with tensorflow backend. I am experimenting with the keras version of posenet architecture. I have introduced a few LSTM layers into the original architecture and now my input should be of 5 dim(n_batch,n_frame,row,col,channel) and my model compiles correctly but when I call the fit function, it throws following <strong>error:</strong></p>\n<pre><code>Train on 129 samples, validate on 129 samples\n\nEpoch 1/800\n\nTraceback (most recent call last):\n\nFile \"train.py\", line 72, in &lt;module&gt;\n\ncallbacks=[checkpointer])\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/engine/training.py\", line 1485, in fit\n\ninitial_epoch=initial_epoch)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/engine/training.py\", line 1140, in _fit_loop\n\nouts = f(ins_batch)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 2073, in __call__\n\nfeed_dict=feed_dict)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 767, in run\n\nrun_metadata_ptr)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 944, in _run\n\n% (np_val.shape, subfeed_t.name, str(subfeed_t.get_shape())))\n\nValueError: Cannot feed value of shape (1, 40, 3) for Tensor u'cls1_fc_pose_xyz_target:0', which has shape '(?, ?)'\n</code></pre>\n<p>`</p>\n<p>and here the piece of code that I am using in <strong>training</strong>:</p>\n<pre><code>X_train=np.squeeze(np.array(dataset_train.images,dtype=float))\n\nX_test=np.squeeze(np.array(dataset_test.images,dtype=float))\n\ny_train=np.squeeze(np.array(dataset_train.poses,dtype=float))\n\nprint(\"X_train shape:\"+str(X_train.shape))#X_train shape:(129, 40, 224, 224, 3)\n\nprint(\"y_train shape:\"+str(y_train.shape))#y_train shape:(129, 40, 7)\n\ny_train_x = y_train[:,:,0:3]\n\ny_train_q = y_train[:,:,3:7]\n\ny_test = np.squeeze(np.array(dataset_test.poses))\n\nprint(\"X_test shape:\"+str(X_test.shape))#X_test shape:(129, 40, 224, 224, 3)\n\nprint(\"y_test shape:\"+str(y_test.shape))#y_test shape:(129, 40, 7)\n\ny_test_x = y_test[:,:,0:3]\n\ny_test_q = y_test[:,:,3:7]\n\n#Setup checkpointing\ncheckpointer = ModelCheckpoint(filepath=\"checkpoint_weights.h5\", verbose=1, save_best_only=True, save_weights_only=True)\n\nmodel.fit(X_train, [y_train_x, y_train_q, y_train_x, y_train_q, y_train_x, y_train_q],\n  batch_size=batch_size,\n  nb_epoch=800,\n  verbose=1,\n  validation_data=(X_test, [y_test_x, y_test_q, y_test_x, y_test_q, y_test_x, y_test_q]),\n  callbacks=[checkpointer])\n</code></pre>\n<p>and here is the <strong>input</strong> of my model:</p>\n<pre><code>input = Input(shape=(helper.frames_per_sequence,224, 224, 3))\n</code></pre>\n<p>and here is the <strong>lines causing error</strong>:</p>\n<pre><code>cls1_fc1_flat = Flatten()(cls1_reduction_pose)\n\ncls1_fc1_pose = Dense(1024,activation='relu',name='cls1_fc1_pose')(cls1_fc1_flat)\n\ncls1_fc_pose_xyz = Dense(3,name='cls1_fc_pose_xyz')(cls1_fc1_pose)\n\ncls1_fc_pose_wpqr = Dense(4,name='cls1_fc_pose_wpqr')(cls1_fc1_pose)\n</code></pre>", "body_text": "I have installed keras using conda with tensorflow backend. I am experimenting with the keras version of posenet architecture. I have introduced a few LSTM layers into the original architecture and now my input should be of 5 dim(n_batch,n_frame,row,col,channel) and my model compiles correctly but when I call the fit function, it throws following error:\nTrain on 129 samples, validate on 129 samples\n\nEpoch 1/800\n\nTraceback (most recent call last):\n\nFile \"train.py\", line 72, in <module>\n\ncallbacks=[checkpointer])\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/engine/training.py\", line 1485, in fit\n\ninitial_epoch=initial_epoch)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/engine/training.py\", line 1140, in _fit_loop\n\nouts = f(ins_batch)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 2073, in __call__\n\nfeed_dict=feed_dict)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 767, in run\n\nrun_metadata_ptr)\n\nFile \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 944, in _run\n\n% (np_val.shape, subfeed_t.name, str(subfeed_t.get_shape())))\n\nValueError: Cannot feed value of shape (1, 40, 3) for Tensor u'cls1_fc_pose_xyz_target:0', which has shape '(?, ?)'\n\n`\nand here the piece of code that I am using in training:\nX_train=np.squeeze(np.array(dataset_train.images,dtype=float))\n\nX_test=np.squeeze(np.array(dataset_test.images,dtype=float))\n\ny_train=np.squeeze(np.array(dataset_train.poses,dtype=float))\n\nprint(\"X_train shape:\"+str(X_train.shape))#X_train shape:(129, 40, 224, 224, 3)\n\nprint(\"y_train shape:\"+str(y_train.shape))#y_train shape:(129, 40, 7)\n\ny_train_x = y_train[:,:,0:3]\n\ny_train_q = y_train[:,:,3:7]\n\ny_test = np.squeeze(np.array(dataset_test.poses))\n\nprint(\"X_test shape:\"+str(X_test.shape))#X_test shape:(129, 40, 224, 224, 3)\n\nprint(\"y_test shape:\"+str(y_test.shape))#y_test shape:(129, 40, 7)\n\ny_test_x = y_test[:,:,0:3]\n\ny_test_q = y_test[:,:,3:7]\n\n#Setup checkpointing\ncheckpointer = ModelCheckpoint(filepath=\"checkpoint_weights.h5\", verbose=1, save_best_only=True, save_weights_only=True)\n\nmodel.fit(X_train, [y_train_x, y_train_q, y_train_x, y_train_q, y_train_x, y_train_q],\n  batch_size=batch_size,\n  nb_epoch=800,\n  verbose=1,\n  validation_data=(X_test, [y_test_x, y_test_q, y_test_x, y_test_q, y_test_x, y_test_q]),\n  callbacks=[checkpointer])\n\nand here is the input of my model:\ninput = Input(shape=(helper.frames_per_sequence,224, 224, 3))\n\nand here is the lines causing error:\ncls1_fc1_flat = Flatten()(cls1_reduction_pose)\n\ncls1_fc1_pose = Dense(1024,activation='relu',name='cls1_fc1_pose')(cls1_fc1_flat)\n\ncls1_fc_pose_xyz = Dense(3,name='cls1_fc_pose_xyz')(cls1_fc1_pose)\n\ncls1_fc_pose_wpqr = Dense(4,name='cls1_fc_pose_wpqr')(cls1_fc1_pose)", "body": "I have installed keras using conda with tensorflow backend. I am experimenting with the keras version of posenet architecture. I have introduced a few LSTM layers into the original architecture and now my input should be of 5 dim(n_batch,n_frame,row,col,channel) and my model compiles correctly but when I call the fit function, it throws following **error:**\r\n\r\n    Train on 129 samples, validate on 129 samples\r\n\r\n    Epoch 1/800\r\n\r\n    Traceback (most recent call last):\r\n\r\n    File \"train.py\", line 72, in <module>\r\n\r\n    callbacks=[checkpointer])\r\n\r\n    File \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/engine/training.py\", line 1485, in fit\r\n\r\n    initial_epoch=initial_epoch)\r\n\r\n    File \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/engine/training.py\", line 1140, in _fit_loop\r\n\r\n    outs = f(ins_batch)\r\n\r\n    File \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 2073, in __call__\r\n\r\n    feed_dict=feed_dict)\r\n\r\n    File \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 767, in run\r\n\r\n    run_metadata_ptr)\r\n\r\n    File \"/u/some_user/conda-envs/my_root2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 944, in _run\r\n\r\n    % (np_val.shape, subfeed_t.name, str(subfeed_t.get_shape())))\r\n\r\n    ValueError: Cannot feed value of shape (1, 40, 3) for Tensor u'cls1_fc_pose_xyz_target:0', which has shape '(?, ?)'\r\n`\r\n\r\nand here the piece of code that I am using in **training**:\r\n\r\n    X_train=np.squeeze(np.array(dataset_train.images,dtype=float))\r\n\r\n    X_test=np.squeeze(np.array(dataset_test.images,dtype=float))\r\n\r\n    y_train=np.squeeze(np.array(dataset_train.poses,dtype=float))\r\n\r\n    print(\"X_train shape:\"+str(X_train.shape))#X_train shape:(129, 40, 224, 224, 3)\r\n\r\n    print(\"y_train shape:\"+str(y_train.shape))#y_train shape:(129, 40, 7)\r\n\r\n    y_train_x = y_train[:,:,0:3]\r\n\r\n    y_train_q = y_train[:,:,3:7]\r\n\r\n    y_test = np.squeeze(np.array(dataset_test.poses))\r\n\r\n    print(\"X_test shape:\"+str(X_test.shape))#X_test shape:(129, 40, 224, 224, 3)\r\n\r\n    print(\"y_test shape:\"+str(y_test.shape))#y_test shape:(129, 40, 7)\r\n\r\n    y_test_x = y_test[:,:,0:3]\r\n\r\n    y_test_q = y_test[:,:,3:7]\r\n\r\n    #Setup checkpointing\r\n    checkpointer = ModelCheckpoint(filepath=\"checkpoint_weights.h5\", verbose=1, save_best_only=True, save_weights_only=True)\r\n\r\n    model.fit(X_train, [y_train_x, y_train_q, y_train_x, y_train_q, y_train_x, y_train_q],\r\n      batch_size=batch_size,\r\n      nb_epoch=800,\r\n      verbose=1,\r\n      validation_data=(X_test, [y_test_x, y_test_q, y_test_x, y_test_q, y_test_x, y_test_q]),\r\n      callbacks=[checkpointer])\r\nand here is the **input** of my model:\r\n\r\n    input = Input(shape=(helper.frames_per_sequence,224, 224, 3))\r\n\r\nand here is the **lines causing error**:\r\n\r\n    cls1_fc1_flat = Flatten()(cls1_reduction_pose)\r\n\r\n    cls1_fc1_pose = Dense(1024,activation='relu',name='cls1_fc1_pose')(cls1_fc1_flat)\r\n\r\n    cls1_fc_pose_xyz = Dense(3,name='cls1_fc_pose_xyz')(cls1_fc1_pose)\r\n\r\n    cls1_fc_pose_wpqr = Dense(4,name='cls1_fc_pose_wpqr')(cls1_fc1_pose)"}