{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/410318625", "html_url": "https://github.com/tensorflow/tensorflow/issues/21247#issuecomment-410318625", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21247", "id": 410318625, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDMxODYyNQ==", "user": {"login": "joonblue", "id": 20529566, "node_id": "MDQ6VXNlcjIwNTI5NTY2", "avatar_url": "https://avatars0.githubusercontent.com/u/20529566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joonblue", "html_url": "https://github.com/joonblue", "followers_url": "https://api.github.com/users/joonblue/followers", "following_url": "https://api.github.com/users/joonblue/following{/other_user}", "gists_url": "https://api.github.com/users/joonblue/gists{/gist_id}", "starred_url": "https://api.github.com/users/joonblue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joonblue/subscriptions", "organizations_url": "https://api.github.com/users/joonblue/orgs", "repos_url": "https://api.github.com/users/joonblue/repos", "events_url": "https://api.github.com/users/joonblue/events{/privacy}", "received_events_url": "https://api.github.com/users/joonblue/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-03T17:13:34Z", "updated_at": "2018-08-03T17:14:25Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1162712\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/shashishekhar\">@shashishekhar</a>, sorry for the delay.<br>\nI have added TFLite to AOSP 8 as a system preload app (for POC of my project) and built it using Android.mk.</p>\n<p>Here's my Android.mk look like,<br>\nLOCAL_PATH := $(call my-dir)<br>\n// TensorFlow-Lite sample app build<br>\ninclude $(CLEAR_VARS)<br>\nLOCAL_PACKAGE_NAME := tflite-sample<br>\nLOCAL_SDK_VERSION := current<br>\nLOCAL_MODULE_TAGS := optional<br>\nLOCAL_SRC_FILES := $(call all-java-files-under, app/src/main/java)<br>\nLOCAL_CERTIFICATE := platform<br>\nLOCAL_AAPT_FLAGS := <br>\n--auto-add-overlay <br>\n--extra-packages android.support.v7.appcompat <br>\n--extra-packages android.support.design <br>\n--extra-packages android.support.constraint<br>\nLOCAL_PROGUARD_FLAG_FILES := app/proguard-rules.pro<br>\nLOCAL_JAVACFLAGS :=-Xlint:all -Xlint:-path<br>\nLOCAL_ASSET_FILES := $(call find-subdir-assets)<br>\nLOCAL_RESOURCE_DIR := $(LOCAL_PATH)/app/src/main/res<br>\nLOCAL_RESOURCE_DIR += <br>\nprebuilts/sdk/current/support/v7/appcompat/res <br>\nprebuilts/sdk/current/support/design/res<br>\nLOCAL_STATIC_JAVA_LIBRARIES := <br>\nandroid-support-v4 <br>\nandroid-support-v7-appcompat <br>\nandroid-support-design <br>\nconstraint-layout-solver<br>\nLOCAL_STATIC_JAVA_AAR_LIBRARIES := <br>\nconstraint-layout <br>\ntensorflow-lite<br>\nLOCAL_FULL_MANIFEST_FILE := $(LOCAL_PATH)/app/src/main/AndroidManifest.xml<br>\ninclude $(BUILD_PACKAGE)</p>\n<p>include $(CLEAR_VARS)<br>\nLOCAL_PREBUILT_STATIC_JAVA_LIBRARIES := tensorflow-lite:libs/tensorflow-lite-0.0.0-nightly.aar<br>\ninclude $(BUILD_MULTI_PREBUILT)</p>\n<p>I have used downloaded tensorflow-lite:libs/tensorflow-lite-0.0.0-nightly.aar and copied conv_actions_labels.txt and conv_actions_frozen.tflite to /assets/</p>\n<p>And here's the locgat,<br>\n01-01 00:44:50.547 4652-4652/org.tensorflow.lite.demo E/AndroidRuntime: FATAL EXCEPTION: main<br>\nProcess: org.tensorflow.lite.demo, PID: 4652<br>\njava.lang.RuntimeException: Unable to start activity ComponentInfo{org.tensorflow.lite.demo/org.tensorflow.demo.SpeechActivity}: java.lang.IllegalArgumentException: Invalid handle to Interpreter.<br>\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2820)<br>\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2895)<br>\nat android.app.ActivityThread.-wrap11(Unknown Source:0)<br>\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1596)<br>\nat android.os.Handler.dispatchMessage(Handler.java:105)<br>\nat android.os.Looper.loop(Looper.java:164)<br>\nat android.app.ActivityThread.main(ActivityThread.java:6565)<br>\nat java.lang.reflect.Method.invoke(Native Method)<br>\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)<br>\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)<br>\nCaused by: java.lang.IllegalArgumentException: Invalid handle to Interpreter.<br>\nat org.tensorflow.lite.NativeInterpreterWrapper.resizeInput(Native Method)<br>\nat org.tensorflow.lite.NativeInterpreterWrapper.resizeInput(NativeInterpreterWrapper.java:155)<br>\nat org.tensorflow.lite.Interpreter.resizeInput(Interpreter.java:191)<br>\nat org.tensorflow.demo.SpeechActivity.onCreate(SpeechActivity.java:174)<br>\nat android.app.Activity.performCreate(Activity.java:6975)<br>\nat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1214)<br>\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2773)<br>\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2895)\u00a0<br>\nat android.app.ActivityThread.-wrap11(Unknown Source:0)\u00a0<br>\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1596)\u00a0<br>\nat android.os.Handler.dispatchMessage(Handler.java:105)\u00a0<br>\nat android.os.Looper.loop(Looper.java:164)\u00a0<br>\nat android.app.ActivityThread.main(ActivityThread.java:6565)\u00a0<br>\nat java.lang.reflect.Method.invoke(Native Method)\u00a0<br>\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\u00a0<br>\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\u00a0</p>\n<p>Please let me know if you need more info.</p>", "body_text": "@shashishekhar, sorry for the delay.\nI have added TFLite to AOSP 8 as a system preload app (for POC of my project) and built it using Android.mk.\nHere's my Android.mk look like,\nLOCAL_PATH := $(call my-dir)\n// TensorFlow-Lite sample app build\ninclude $(CLEAR_VARS)\nLOCAL_PACKAGE_NAME := tflite-sample\nLOCAL_SDK_VERSION := current\nLOCAL_MODULE_TAGS := optional\nLOCAL_SRC_FILES := $(call all-java-files-under, app/src/main/java)\nLOCAL_CERTIFICATE := platform\nLOCAL_AAPT_FLAGS := \n--auto-add-overlay \n--extra-packages android.support.v7.appcompat \n--extra-packages android.support.design \n--extra-packages android.support.constraint\nLOCAL_PROGUARD_FLAG_FILES := app/proguard-rules.pro\nLOCAL_JAVACFLAGS :=-Xlint:all -Xlint:-path\nLOCAL_ASSET_FILES := $(call find-subdir-assets)\nLOCAL_RESOURCE_DIR := $(LOCAL_PATH)/app/src/main/res\nLOCAL_RESOURCE_DIR += \nprebuilts/sdk/current/support/v7/appcompat/res \nprebuilts/sdk/current/support/design/res\nLOCAL_STATIC_JAVA_LIBRARIES := \nandroid-support-v4 \nandroid-support-v7-appcompat \nandroid-support-design \nconstraint-layout-solver\nLOCAL_STATIC_JAVA_AAR_LIBRARIES := \nconstraint-layout \ntensorflow-lite\nLOCAL_FULL_MANIFEST_FILE := $(LOCAL_PATH)/app/src/main/AndroidManifest.xml\ninclude $(BUILD_PACKAGE)\ninclude $(CLEAR_VARS)\nLOCAL_PREBUILT_STATIC_JAVA_LIBRARIES := tensorflow-lite:libs/tensorflow-lite-0.0.0-nightly.aar\ninclude $(BUILD_MULTI_PREBUILT)\nI have used downloaded tensorflow-lite:libs/tensorflow-lite-0.0.0-nightly.aar and copied conv_actions_labels.txt and conv_actions_frozen.tflite to /assets/\nAnd here's the locgat,\n01-01 00:44:50.547 4652-4652/org.tensorflow.lite.demo E/AndroidRuntime: FATAL EXCEPTION: main\nProcess: org.tensorflow.lite.demo, PID: 4652\njava.lang.RuntimeException: Unable to start activity ComponentInfo{org.tensorflow.lite.demo/org.tensorflow.demo.SpeechActivity}: java.lang.IllegalArgumentException: Invalid handle to Interpreter.\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2820)\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2895)\nat android.app.ActivityThread.-wrap11(Unknown Source:0)\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1596)\nat android.os.Handler.dispatchMessage(Handler.java:105)\nat android.os.Looper.loop(Looper.java:164)\nat android.app.ActivityThread.main(ActivityThread.java:6565)\nat java.lang.reflect.Method.invoke(Native Method)\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\nCaused by: java.lang.IllegalArgumentException: Invalid handle to Interpreter.\nat org.tensorflow.lite.NativeInterpreterWrapper.resizeInput(Native Method)\nat org.tensorflow.lite.NativeInterpreterWrapper.resizeInput(NativeInterpreterWrapper.java:155)\nat org.tensorflow.lite.Interpreter.resizeInput(Interpreter.java:191)\nat org.tensorflow.demo.SpeechActivity.onCreate(SpeechActivity.java:174)\nat android.app.Activity.performCreate(Activity.java:6975)\nat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1214)\nat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2773)\nat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2895)\u00a0\nat android.app.ActivityThread.-wrap11(Unknown Source:0)\u00a0\nat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1596)\u00a0\nat android.os.Handler.dispatchMessage(Handler.java:105)\u00a0\nat android.os.Looper.loop(Looper.java:164)\u00a0\nat android.app.ActivityThread.main(ActivityThread.java:6565)\u00a0\nat java.lang.reflect.Method.invoke(Native Method)\u00a0\nat com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\u00a0\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\u00a0\nPlease let me know if you need more info.", "body": "@shashishekhar, sorry for the delay.\r\nI have added TFLite to AOSP 8 as a system preload app (for POC of my project) and built it using Android.mk.\r\n\r\nHere's my Android.mk look like,\r\nLOCAL_PATH := $(call my-dir)\r\n// TensorFlow-Lite sample app build\r\ninclude $(CLEAR_VARS)\r\nLOCAL_PACKAGE_NAME := tflite-sample\r\nLOCAL_SDK_VERSION := current\r\nLOCAL_MODULE_TAGS := optional\r\nLOCAL_SRC_FILES := $(call all-java-files-under, app/src/main/java)\r\nLOCAL_CERTIFICATE := platform\r\nLOCAL_AAPT_FLAGS := \\\r\n                  --auto-add-overlay \\\r\n                  --extra-packages android.support.v7.appcompat \\\r\n                  --extra-packages android.support.design \\\r\n                  --extra-packages android.support.constraint\r\nLOCAL_PROGUARD_FLAG_FILES := app/proguard-rules.pro\r\nLOCAL_JAVACFLAGS :=-Xlint:all -Xlint:-path\r\nLOCAL_ASSET_FILES := $(call find-subdir-assets)\r\nLOCAL_RESOURCE_DIR := $(LOCAL_PATH)/app/src/main/res\r\nLOCAL_RESOURCE_DIR += \\\r\n                        prebuilts/sdk/current/support/v7/appcompat/res \\\r\n                        prebuilts/sdk/current/support/design/res\r\nLOCAL_STATIC_JAVA_LIBRARIES := \\\r\n                               android-support-v4 \\\r\n                               android-support-v7-appcompat \\\r\n                               android-support-design \\\r\n                               constraint-layout-solver\r\nLOCAL_STATIC_JAVA_AAR_LIBRARIES := \\\r\n                                constraint-layout \\\r\n                                tensorflow-lite\r\nLOCAL_FULL_MANIFEST_FILE := $(LOCAL_PATH)/app/src/main/AndroidManifest.xml\r\ninclude $(BUILD_PACKAGE)\r\n\r\ninclude $(CLEAR_VARS)\r\nLOCAL_PREBUILT_STATIC_JAVA_LIBRARIES := tensorflow-lite:libs/tensorflow-lite-0.0.0-nightly.aar\r\ninclude $(BUILD_MULTI_PREBUILT)\r\n\r\nI have used downloaded tensorflow-lite:libs/tensorflow-lite-0.0.0-nightly.aar and copied conv_actions_labels.txt and conv_actions_frozen.tflite to <project-root>/assets/\r\n\r\nAnd here's the locgat,\r\n01-01 00:44:50.547 4652-4652/org.tensorflow.lite.demo E/AndroidRuntime: FATAL EXCEPTION: main\r\n    Process: org.tensorflow.lite.demo, PID: 4652\r\n    java.lang.RuntimeException: Unable to start activity ComponentInfo{org.tensorflow.lite.demo/org.tensorflow.demo.SpeechActivity}: java.lang.IllegalArgumentException: Invalid handle to Interpreter.\r\n        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2820)\r\n        at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2895)\r\n        at android.app.ActivityThread.-wrap11(Unknown Source:0)\r\n        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1596)\r\n        at android.os.Handler.dispatchMessage(Handler.java:105)\r\n        at android.os.Looper.loop(Looper.java:164)\r\n        at android.app.ActivityThread.main(ActivityThread.java:6565)\r\n        at java.lang.reflect.Method.invoke(Native Method)\r\n        at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\r\n     Caused by: java.lang.IllegalArgumentException: Invalid handle to Interpreter.\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.resizeInput(Native Method)\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.resizeInput(NativeInterpreterWrapper.java:155)\r\n        at org.tensorflow.lite.Interpreter.resizeInput(Interpreter.java:191)\r\n        at org.tensorflow.demo.SpeechActivity.onCreate(SpeechActivity.java:174)\r\n        at android.app.Activity.performCreate(Activity.java:6975)\r\n        at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1214)\r\n        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2773)\r\n        at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2895)\u00a0\r\n        at android.app.ActivityThread.-wrap11(Unknown Source:0)\u00a0\r\n        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1596)\u00a0\r\n        at android.os.Handler.dispatchMessage(Handler.java:105)\u00a0\r\n        at android.os.Looper.loop(Looper.java:164)\u00a0\r\n        at android.app.ActivityThread.main(ActivityThread.java:6565)\u00a0\r\n        at java.lang.reflect.Method.invoke(Native Method)\u00a0\r\n        at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)\u00a0\r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)\u00a0\r\n\r\nPlease let me know if you need more info."}