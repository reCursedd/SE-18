{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22476", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22476/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22476/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22476/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22476", "id": 362966065, "node_id": "MDU6SXNzdWUzNjI5NjYwNjU=", "number": 22476, "title": "ArchLinux [Optimus-Bumblebee] - Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available", "user": {"login": "Dentrax", "id": 16493751, "node_id": "MDQ6VXNlcjE2NDkzNzUx", "avatar_url": "https://avatars3.githubusercontent.com/u/16493751?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dentrax", "html_url": "https://github.com/Dentrax", "followers_url": "https://api.github.com/users/Dentrax/followers", "following_url": "https://api.github.com/users/Dentrax/following{/other_user}", "gists_url": "https://api.github.com/users/Dentrax/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dentrax/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dentrax/subscriptions", "organizations_url": "https://api.github.com/users/Dentrax/orgs", "repos_url": "https://api.github.com/users/Dentrax/repos", "events_url": "https://api.github.com/users/Dentrax/events{/privacy}", "received_events_url": "https://api.github.com/users/Dentrax/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "harshini-gadige", "id": 42781361, "node_id": "MDQ6VXNlcjQyNzgxMzYx", "avatar_url": "https://avatars1.githubusercontent.com/u/42781361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshini-gadige", "html_url": "https://github.com/harshini-gadige", "followers_url": "https://api.github.com/users/harshini-gadige/followers", "following_url": "https://api.github.com/users/harshini-gadige/following{/other_user}", "gists_url": "https://api.github.com/users/harshini-gadige/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshini-gadige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshini-gadige/subscriptions", "organizations_url": "https://api.github.com/users/harshini-gadige/orgs", "repos_url": "https://api.github.com/users/harshini-gadige/repos", "events_url": "https://api.github.com/users/harshini-gadige/events{/privacy}", "received_events_url": "https://api.github.com/users/harshini-gadige/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "harshini-gadige", "id": 42781361, "node_id": "MDQ6VXNlcjQyNzgxMzYx", "avatar_url": "https://avatars1.githubusercontent.com/u/42781361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshini-gadige", "html_url": "https://github.com/harshini-gadige", "followers_url": "https://api.github.com/users/harshini-gadige/followers", "following_url": "https://api.github.com/users/harshini-gadige/following{/other_user}", "gists_url": "https://api.github.com/users/harshini-gadige/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshini-gadige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshini-gadige/subscriptions", "organizations_url": "https://api.github.com/users/harshini-gadige/orgs", "repos_url": "https://api.github.com/users/harshini-gadige/repos", "events_url": "https://api.github.com/users/harshini-gadige/events{/privacy}", "received_events_url": "https://api.github.com/users/harshini-gadige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-23T18:36:05Z", "updated_at": "2018-09-25T16:59:19Z", "closed_at": "2018-09-24T06:24:40Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: ArchLinux x64</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>: via pip</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>: 1.10.0</p>\n</li>\n<li>\n<p><strong>Python version</strong>: 3.6.5</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>: CUDA 9.2.148 - cuDNN 7.2.1</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>: NVIDIA GTX 970M 3GB</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:</p>\n</li>\n<li>\n<p>Note: I'm using Nvidia Optimus with Bumblebee: <a href=\"https://wiki.archlinux.org/index.php/bumblebee\" rel=\"nofollow\">https://wiki.archlinux.org/index.php/bumblebee</a></p>\n</li>\n</ul>\n<ol>\n<li>git clone <a href=\"https://github.com/isseu/emotion-recognition-neural-networks\">https://github.com/isseu/emotion-recognition-neural-networks</a></li>\n</ol>\n<ul>\n<li>Make reqiured configurations...</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p>I removed <code>tensorflow</code> and added <code>tensorflow-gpu 1.10.0</code> to <code>requirements.txt</code></p>\n</li>\n<li>\n<p><code>sudo optirun python3 emotion_recognition.py train</code> also tried:<br>\n<code>python3 emotion_recognition.py train</code></p>\n</li>\n</ol>\n<h3>Describe the problem</h3>\n<p>To run Train the data on my GPU, I just edited a few lines on emotion_recognation.py:</p>\n<p><code>import tensorflow as tf</code></p>\n<p>Added under <code>def __init__(self):</code><br>\n<code>tf.ConfigProto(allow_soft_placement=True)</code></p>\n<p>Added under <code>def start_training(self):</code></p>\n<pre><code>        with tf.device('/gpu:0'):\n            self.model.fit(bla bla bla)\n</code></pre>\n<h3>Source code / logs</h3>\n<pre><code>hdf5 is not supported on this machine (please install/reinstall h5py for optimal experience)\n[+] Dataset found and loaded\n[+] Building CNN\nWARNING:tensorflow:From /home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/initializations.py:119: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.\nInstructions for updating:\nUse tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.\nWARNING:tensorflow:From /home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/objectives.py:66: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\nInstructions for updating:\nkeep_dims is deprecated, use keepdims instead\n2018-09-23 21:31:13.883618: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-09-23 21:31:14.001876: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-09-23 21:31:14.002292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \nname: GeForce GTX 970M major: 5 minor: 2 memoryClockRate(GHz): 1.038\npciBusID: 0000:01:00.0\ntotalMemory: 2.95GiB freeMemory: 2.89GiB\n2018-09-23 21:31:14.002318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-23 21:31:14.260311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-23 21:31:14.260358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \n2018-09-23 21:31:14.260364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \n2018-09-23 21:31:14.260525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2595 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 970M, pci bus id: 0000:01:00.0, compute capability: 5.2)\n2018-09-23 21:31:14.554680: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.644729: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.733250: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.822594: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.911661: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:15.880266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-23 21:31:15.880304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-23 21:31:15.880313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \n2018-09-23 21:31:15.880321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \n2018-09-23 21:31:15.880412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2595 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 970M, pci bus id: 0000:01:00.0, compute capability: 5.2)\n[+] Training network\n---------------------------------\nRun id: emotion_recognition\nLog directory: /tmp/tflearn_logs/\n---------------------------------\nTraining samples: 11214\nValidation samples: 2804\n--\nTraceback (most recent call last):\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\n    return fn(*args)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1261, in _run_fn\n    self._extend_graph()\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1295, in _extend_graph\n    tf_session.ExtendSession(self._session)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_FLOAT]\n  device='CPU'; T in [DT_BFLOAT16]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_INT8]\n  device='CPU'; T in [DT_UINT8]\n  device='CPU'; T in [DT_INT16]\n  device='CPU'; T in [DT_UINT16]\n  device='CPU'; T in [DT_INT32]\n  device='CPU'; T in [DT_INT64]\n\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"emotion_recognition.py\", line 110, in &lt;module&gt;\n    network.start_training()\n  File \"emotion_recognition.py\", line 78, in start_training\n    run_id='emotion_recognition'\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/models/dnn.py\", line 216, in fit\n    callbacks=callbacks)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 339, in fit\n    show_metric)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 816, in _train\n    tflearn.is_training(True, session=self.session)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/config.py\", line 95, in is_training\n    tf.get_collection('is_training_ops')[0].eval(session=session)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 680, in eval\n    return _eval_using_default_session(self, feed_dict, self.graph, session)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 4951, in _eval_using_default_session\n    return session.run(tensors, feed_dict)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run\n    run_metadata_ptr)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\n    run_metadata)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_FLOAT]\n  device='CPU'; T in [DT_BFLOAT16]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_INT8]\n  device='CPU'; T in [DT_UINT8]\n  device='CPU'; T in [DT_INT16]\n  device='CPU'; T in [DT_UINT16]\n  device='CPU'; T in [DT_INT32]\n  device='CPU'; T in [DT_INT64]\n\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\n\nCaused by op 'Accuracy/__raw_', defined at:\n  File \"emotion_recognition.py\", line 110, in &lt;module&gt;\n    network.start_training()\n  File \"emotion_recognition.py\", line 78, in start_training\n    run_id='emotion_recognition'\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/models/dnn.py\", line 216, in fit\n    callbacks=callbacks)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 288, in fit\n    self.summ_writer, self.coord)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 794, in initialize_fit\n    val_feed_dict)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 937, in create_testing_summaries\n    summarize(self.metric, \"scalar\", sname, tr_summ_collection)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/summarizer.py\", line 98, in summarize\n    summaries.get_summary(type, name, value, summary_collection)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/summaries.py\", line 46, in get_summary\n    summ = tf.summary.scalar(tag, value)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/summary/summary.py\", line 90, in scalar\n    val = _gen_logging_ops.scalar_summary(tags=tag, values=tensor, name=scope)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 623, in scalar_summary\n    \"ScalarSummary\", tags=tags, values=values, name=name)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\n    return func(*args, **kwargs)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\n    op_def=op_def)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_FLOAT]\n  device='CPU'; T in [DT_BFLOAT16]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_INT8]\n  device='CPU'; T in [DT_UINT8]\n  device='CPU'; T in [DT_INT16]\n  device='CPU'; T in [DT_UINT16]\n  device='CPU'; T in [DT_INT32]\n  device='CPU'; T in [DT_INT64]\n\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\n</code></pre>", "body_text": "System information\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): ArchLinux x64\n\n\nTensorFlow installed from (source or binary): via pip\n\n\nTensorFlow version (use command below): 1.10.0\n\n\nPython version: 3.6.5\n\n\nCUDA/cuDNN version: CUDA 9.2.148 - cuDNN 7.2.1\n\n\nGPU model and memory: NVIDIA GTX 970M 3GB\n\n\nExact command to reproduce:\n\n\nNote: I'm using Nvidia Optimus with Bumblebee: https://wiki.archlinux.org/index.php/bumblebee\n\n\n\ngit clone https://github.com/isseu/emotion-recognition-neural-networks\n\n\nMake reqiured configurations...\n\n\n\nI removed tensorflow and added tensorflow-gpu 1.10.0 to requirements.txt\n\n\nsudo optirun python3 emotion_recognition.py train also tried:\npython3 emotion_recognition.py train\n\n\nDescribe the problem\nTo run Train the data on my GPU, I just edited a few lines on emotion_recognation.py:\nimport tensorflow as tf\nAdded under def __init__(self):\ntf.ConfigProto(allow_soft_placement=True)\nAdded under def start_training(self):\n        with tf.device('/gpu:0'):\n            self.model.fit(bla bla bla)\n\nSource code / logs\nhdf5 is not supported on this machine (please install/reinstall h5py for optimal experience)\n[+] Dataset found and loaded\n[+] Building CNN\nWARNING:tensorflow:From /home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/initializations.py:119: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.\nInstructions for updating:\nUse tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.\nWARNING:tensorflow:From /home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/objectives.py:66: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\nInstructions for updating:\nkeep_dims is deprecated, use keepdims instead\n2018-09-23 21:31:13.883618: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-09-23 21:31:14.001876: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-09-23 21:31:14.002292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \nname: GeForce GTX 970M major: 5 minor: 2 memoryClockRate(GHz): 1.038\npciBusID: 0000:01:00.0\ntotalMemory: 2.95GiB freeMemory: 2.89GiB\n2018-09-23 21:31:14.002318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-23 21:31:14.260311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-23 21:31:14.260358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \n2018-09-23 21:31:14.260364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \n2018-09-23 21:31:14.260525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2595 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970M, pci bus id: 0000:01:00.0, compute capability: 5.2)\n2018-09-23 21:31:14.554680: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.644729: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.733250: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.822594: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:14.911661: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\n2018-09-23 21:31:15.880266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-23 21:31:15.880304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-23 21:31:15.880313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \n2018-09-23 21:31:15.880321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \n2018-09-23 21:31:15.880412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2595 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970M, pci bus id: 0000:01:00.0, compute capability: 5.2)\n[+] Training network\n---------------------------------\nRun id: emotion_recognition\nLog directory: /tmp/tflearn_logs/\n---------------------------------\nTraining samples: 11214\nValidation samples: 2804\n--\nTraceback (most recent call last):\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\n    return fn(*args)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1261, in _run_fn\n    self._extend_graph()\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1295, in _extend_graph\n    tf_session.ExtendSession(self._session)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_FLOAT]\n  device='CPU'; T in [DT_BFLOAT16]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_INT8]\n  device='CPU'; T in [DT_UINT8]\n  device='CPU'; T in [DT_INT16]\n  device='CPU'; T in [DT_UINT16]\n  device='CPU'; T in [DT_INT32]\n  device='CPU'; T in [DT_INT64]\n\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"emotion_recognition.py\", line 110, in <module>\n    network.start_training()\n  File \"emotion_recognition.py\", line 78, in start_training\n    run_id='emotion_recognition'\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/models/dnn.py\", line 216, in fit\n    callbacks=callbacks)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 339, in fit\n    show_metric)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 816, in _train\n    tflearn.is_training(True, session=self.session)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/config.py\", line 95, in is_training\n    tf.get_collection('is_training_ops')[0].eval(session=session)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 680, in eval\n    return _eval_using_default_session(self, feed_dict, self.graph, session)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 4951, in _eval_using_default_session\n    return session.run(tensors, feed_dict)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run\n    run_metadata_ptr)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\n    run_metadata)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_FLOAT]\n  device='CPU'; T in [DT_BFLOAT16]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_INT8]\n  device='CPU'; T in [DT_UINT8]\n  device='CPU'; T in [DT_INT16]\n  device='CPU'; T in [DT_UINT16]\n  device='CPU'; T in [DT_INT32]\n  device='CPU'; T in [DT_INT64]\n\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\n\nCaused by op 'Accuracy/__raw_', defined at:\n  File \"emotion_recognition.py\", line 110, in <module>\n    network.start_training()\n  File \"emotion_recognition.py\", line 78, in start_training\n    run_id='emotion_recognition'\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/models/dnn.py\", line 216, in fit\n    callbacks=callbacks)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 288, in fit\n    self.summ_writer, self.coord)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 794, in initialize_fit\n    val_feed_dict)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 937, in create_testing_summaries\n    summarize(self.metric, \"scalar\", sname, tr_summ_collection)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/summarizer.py\", line 98, in summarize\n    summaries.get_summary(type, name, value, summary_collection)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/summaries.py\", line 46, in get_summary\n    summ = tf.summary.scalar(tag, value)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/summary/summary.py\", line 90, in scalar\n    val = _gen_logging_ops.scalar_summary(tags=tag, values=tensor, name=scope)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 623, in scalar_summary\n    \"ScalarSummary\", tags=tags, values=values, name=name)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\n    return func(*args, **kwargs)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\n    op_def=op_def)\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_FLOAT]\n  device='CPU'; T in [DT_BFLOAT16]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_INT8]\n  device='CPU'; T in [DT_UINT8]\n  device='CPU'; T in [DT_INT16]\n  device='CPU'; T in [DT_UINT16]\n  device='CPU'; T in [DT_INT32]\n  device='CPU'; T in [DT_INT64]\n\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]", "body": "### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: ArchLinux x64\r\n- **TensorFlow installed from (source or binary)**: via pip\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 3.6.5\r\n- **CUDA/cuDNN version**: CUDA 9.2.148 - cuDNN 7.2.1\r\n- **GPU model and memory**: NVIDIA GTX 970M 3GB\r\n\r\n- **Exact command to reproduce**:\r\n\r\n- Note: I'm using Nvidia Optimus with Bumblebee: https://wiki.archlinux.org/index.php/bumblebee\r\n\r\n1. git clone https://github.com/isseu/emotion-recognition-neural-networks\r\n* Make reqiured configurations...\r\n\r\n2. I removed `tensorflow` and added `tensorflow-gpu 1.10.0` to `requirements.txt`\r\n\r\n3. `sudo optirun python3 emotion_recognition.py train` also tried:\r\n`python3 emotion_recognition.py train`\r\n\r\n### Describe the problem\r\n\r\nTo run Train the data on my GPU, I just edited a few lines on emotion_recognation.py:\r\n\r\n`import tensorflow as tf`\r\n\r\nAdded under `def __init__(self):`\r\n`tf.ConfigProto(allow_soft_placement=True)`\r\n\r\nAdded under `def start_training(self):`\r\n```\r\n        with tf.device('/gpu:0'):\r\n            self.model.fit(bla bla bla)\r\n```\r\n\r\n### Source code / logs\r\n\r\n```\r\nhdf5 is not supported on this machine (please install/reinstall h5py for optimal experience)\r\n[+] Dataset found and loaded\r\n[+] Building CNN\r\nWARNING:tensorflow:From /home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/initializations.py:119: UniformUnitScaling.__init__ (from tensorflow.python.ops.init_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.initializers.variance_scaling instead with distribution=uniform to get equivalent behavior.\r\nWARNING:tensorflow:From /home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/objectives.py:66: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nkeep_dims is deprecated, use keepdims instead\r\n2018-09-23 21:31:13.883618: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-23 21:31:14.001876: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-09-23 21:31:14.002292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \r\nname: GeForce GTX 970M major: 5 minor: 2 memoryClockRate(GHz): 1.038\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 2.95GiB freeMemory: 2.89GiB\r\n2018-09-23 21:31:14.002318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-23 21:31:14.260311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-23 21:31:14.260358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \r\n2018-09-23 21:31:14.260364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \r\n2018-09-23 21:31:14.260525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2595 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970M, pci bus id: 0000:01:00.0, compute capability: 5.2)\r\n2018-09-23 21:31:14.554680: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\r\n2018-09-23 21:31:14.644729: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\r\n2018-09-23 21:31:14.733250: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\r\n2018-09-23 21:31:14.822594: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\r\n2018-09-23 21:31:14.911661: W tensorflow/core/framework/allocator.cc:108] Allocation of 226492416 exceeds 10% of system memory.\r\n2018-09-23 21:31:15.880266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-23 21:31:15.880304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-23 21:31:15.880313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \r\n2018-09-23 21:31:15.880321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \r\n2018-09-23 21:31:15.880412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2595 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970M, pci bus id: 0000:01:00.0, compute capability: 5.2)\r\n[+] Training network\r\n---------------------------------\r\nRun id: emotion_recognition\r\nLog directory: /tmp/tflearn_logs/\r\n---------------------------------\r\nTraining samples: 11214\r\nValidation samples: 2804\r\n--\r\nTraceback (most recent call last):\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\r\n    return fn(*args)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1261, in _run_fn\r\n    self._extend_graph()\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1295, in _extend_graph\r\n    tf_session.ExtendSession(self._session)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nRegistered kernels:\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_BFLOAT16]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_INT8]\r\n  device='CPU'; T in [DT_UINT8]\r\n  device='CPU'; T in [DT_INT16]\r\n  device='CPU'; T in [DT_UINT16]\r\n  device='CPU'; T in [DT_INT32]\r\n  device='CPU'; T in [DT_INT64]\r\n\r\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"emotion_recognition.py\", line 110, in <module>\r\n    network.start_training()\r\n  File \"emotion_recognition.py\", line 78, in start_training\r\n    run_id='emotion_recognition'\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/models/dnn.py\", line 216, in fit\r\n    callbacks=callbacks)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 339, in fit\r\n    show_metric)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 816, in _train\r\n    tflearn.is_training(True, session=self.session)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/config.py\", line 95, in is_training\r\n    tf.get_collection('is_training_ops')[0].eval(session=session)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 680, in eval\r\n    return _eval_using_default_session(self, feed_dict, self.graph, session)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 4951, in _eval_using_default_session\r\n    return session.run(tensors, feed_dict)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run\r\n    run_metadata_ptr)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\r\n    run_metadata)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nRegistered kernels:\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_BFLOAT16]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_INT8]\r\n  device='CPU'; T in [DT_UINT8]\r\n  device='CPU'; T in [DT_INT16]\r\n  device='CPU'; T in [DT_UINT16]\r\n  device='CPU'; T in [DT_INT32]\r\n  device='CPU'; T in [DT_INT64]\r\n\r\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\r\n\r\nCaused by op 'Accuracy/__raw_', defined at:\r\n  File \"emotion_recognition.py\", line 110, in <module>\r\n    network.start_training()\r\n  File \"emotion_recognition.py\", line 78, in start_training\r\n    run_id='emotion_recognition'\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/models/dnn.py\", line 216, in fit\r\n    callbacks=callbacks)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 288, in fit\r\n    self.summ_writer, self.coord)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 794, in initialize_fit\r\n    val_feed_dict)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/trainer.py\", line 937, in create_testing_summaries\r\n    summarize(self.metric, \"scalar\", sname, tr_summ_collection)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/helpers/summarizer.py\", line 98, in summarize\r\n    summaries.get_summary(type, name, value, summary_collection)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tflearn/summaries.py\", line 46, in get_summary\r\n    summ = tf.summary.scalar(tag, value)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/summary/summary.py\", line 90, in scalar\r\n    val = _gen_logging_ops.scalar_summary(tags=tag, values=tensor, name=scope)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 623, in scalar_summary\r\n    \"ScalarSummary\", tags=tags, values=values, name=name)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\r\n    op_def=op_def)\r\n  File \"/home/dentrax/Projects/GitHub/emotion-recognition-neural-networks/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'Accuracy/__raw_': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nRegistered kernels:\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_BFLOAT16]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_INT8]\r\n  device='CPU'; T in [DT_UINT8]\r\n  device='CPU'; T in [DT_INT16]\r\n  device='CPU'; T in [DT_UINT16]\r\n  device='CPU'; T in [DT_INT32]\r\n  device='CPU'; T in [DT_INT64]\r\n\r\n\t [[Node: Accuracy/__raw_ = ScalarSummary[T=DT_FLOAT, _device=\"/device:GPU:0\"](Accuracy/__raw_/tags, Accuracy/Mean)]]\r\n```\r\n"}