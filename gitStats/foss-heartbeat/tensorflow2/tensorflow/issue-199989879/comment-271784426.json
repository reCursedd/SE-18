{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/271784426", "html_url": "https://github.com/tensorflow/tensorflow/issues/6780#issuecomment-271784426", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6780", "id": 271784426, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTc4NDQyNg==", "user": {"login": "buptjz", "id": 3990778, "node_id": "MDQ6VXNlcjM5OTA3Nzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3990778?v=4", "gravatar_id": "", "url": "https://api.github.com/users/buptjz", "html_url": "https://github.com/buptjz", "followers_url": "https://api.github.com/users/buptjz/followers", "following_url": "https://api.github.com/users/buptjz/following{/other_user}", "gists_url": "https://api.github.com/users/buptjz/gists{/gist_id}", "starred_url": "https://api.github.com/users/buptjz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/buptjz/subscriptions", "organizations_url": "https://api.github.com/users/buptjz/orgs", "repos_url": "https://api.github.com/users/buptjz/repos", "events_url": "https://api.github.com/users/buptjz/events{/privacy}", "received_events_url": "https://api.github.com/users/buptjz/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-11T05:50:48Z", "updated_at": "2017-01-11T05:50:48Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a> Here's the complete backtrace:)</p>\n<pre><code>Traceback (most recent call last):\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\n    None)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1484093728.844289839\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; hadoop0560.et2.tbsite.net:25868, 1 -&gt; hadoop0138.et2.tbsite.net:27562, 2 -&gt; hadoop0177.et2.tbsite.net:26103, 3 -&gt; hadoop0712.et2.tbsite.net:26106, 4 -&gt; hadoop5021.et2.tbsite.net:29662, 5 -&gt; hadoop0616.et2.tbsite.net:26974, 6 -&gt; hadoop0635.et2.tbsite.net:29028, 7 -&gt; hadoop0580.et2.tbsite.net:29141, 8 -&gt; hadoop0587.et2.tbsite.net:28455, 9 -&gt; hadoop1845.et2.tbsite.net:27397, 10 -&gt; hadoop1892.et2.tbsite.net:28091, 11 -&gt; hadoop0511.et2.tbsite.net:27469, 12 -&gt; hadoop0744.et2.tbsite.net:25843, 13 -&gt; hadoop0621.et2.tbsite.net:25316, 14 -&gt; hadoop0067.et2.tbsite.net:26703, 15 -&gt; hadoop0612.et2.tbsite.net:28886}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; hadoop0743.et2.tbsite.net:28429, 1 -&gt; hadoop0245.et2.tbsite.net:28221, 2 -&gt; hadoop0633.et2.tbsite.net:25817, 3 -&gt; hadoop0729.et2.tbsite.net:26892, 4 -&gt; hadoop0642.et2.tbsite.net:29372, 5 -&gt; hadoop1006.et2.tbsite.net:26049, 6 -&gt; hadoop5035.et2.tbsite.net:26419, 7 -&gt; hadoop0718.et2.tbsite.net:26232, 8 -&gt; hadoop0947.et2.tbsite.net:27491, 9 -&gt; hadoop5028.et2.tbsite.net:25950, 10 -&gt; hadoop1873.et2.tbsite.net:27579, 11 -&gt; hadoop0618.et2.tbsite.net:27564, 12 -&gt; hadoop0172.et2.tbsite.net:26764, 13 -&gt; hadoop0637.et2.tbsite.net:28835, 14 -&gt; hadoop1863.et2.tbsite.net:28968, 15 -&gt; hadoop0614.et2.tbsite.net:26038, 16 -&gt; hadoop0715.et2.tbsite.net:29649, 17 -&gt; hadoop0735.et2.tbsite.net:25061, 18 -&gt; hadoop1003.et2.tbsite.net:27781, 19 -&gt; hadoop5047.et2.tbsite.net:26782, 20 -&gt; hadoop0738.et2.tbsite.net:25868, 21 -&gt; hadoop5041.et2.tbsite.net:29389, 22 -&gt; hadoop1872.et2.tbsite.net:25251, 23 -&gt; hadoop0891.et2.tbsite.net:25213, 24 -&gt; hadoop0785.et2.tbsite.net:29996, 25 -&gt; hadoop0809.et2.tbsite.net:29229, 26 -&gt; hadoop1836.et2.tbsite.net:29542, 27 -&gt; hadoop0592.et2.tbsite.net:28786, 28 -&gt; hadoop0714.et2.tbsite.net:28822, 29 -&gt; hadoop0572.et2.tbsite.net:27784, 30 -&gt; hadoop1838.et2.tbsite.net:29014, 31 -&gt; hadoop0600.et2.tbsite.net:29302, 32 -&gt; hadoop0178.et2.tbsite.net:25334, 33 -&gt; hadoop0471.et2.tbsite.net:25353, 34 -&gt; hadoop0649.et2.tbsite.net:25981, 35 -&gt; hadoop1848.et2.tbsite.net:26250, 36 -&gt; hadoop0569.et2.tbsite.net:28590, 37 -&gt; hadoop0589.et2.tbsite.net:25475, 38 -&gt; hadoop0771.et2.tbsite.net:29900, 39 -&gt; hadoop5030.et2.tbsite.net:25125, 40 -&gt; hadoop1890.et2.tbsite.net:27007, 41 -&gt; hadoop0946.et2.tbsite.net:28429, 42 -&gt; hadoop1859.et2.tbsite.net:26312, 43 -&gt; hadoop1828.et2.tbsite.net:25200, 44 -&gt; hadoop0762.et2.tbsite.net:27702, 45 -&gt; hadoop5038.et2.tbsite.net:27372, 46 -&gt; hadoop0609.et2.tbsite.net:29673, 47 -&gt; hadoop1878.et2.tbsite.net:29987, 48 -&gt; hadoop0704.et2.tbsite.net:25593, 49 -&gt; hadoop0815.et2.tbsite.net:26288, 50 -&gt; hadoop0488.et2.tbsite.net:26090, 51 -&gt; hadoop0826.et2.tbsite.net:28780, 52 -&gt; hadoop0890.et2.tbsite.net:27610, 53 -&gt; hadoop0713.et2.tbsite.net:26176, 54 -&gt; hadoop0845.et2.tbsite.net:28818, 55 -&gt; hadoop1827.et2.tbsite.net:29269, 56 -&gt; hadoop0767.et2.tbsite.net:26084, 57 -&gt; hadoop1853.et2.tbsite.net:26311, 58 -&gt; hadoop0837.et2.tbsite.net:29223, 59 -&gt; hadoop0256.et2.tbsite.net:28043, 60 -&gt; hadoop0728.et2.tbsite.net:26120, 61 -&gt; hadoop0535.et2.tbsite.net:26474, 62 -&gt; hadoop0857.et2.tbsite.net:27474, 63 -&gt; hadoop0482.et2.tbsite.net:28653, 64 -&gt; hadoop0737.et2.tbsite.net:26960, 65 -&gt; hadoop0848.et2.tbsite.net:27215, 66 -&gt; hadoop0606.et2.tbsite.net:29632, 67 -&gt; hadoop0613.et2.tbsite.net:26596, 68 -&gt; hadoop5007.et2.tbsite.net:27294, 69 -&gt; hadoop0698.et2.tbsite.net:29914, 70 -&gt; hadoop0768.et2.tbsite.net:26747, 71 -&gt; hadoop0545.et2.tbsite.net:27286, 72 -&gt; hadoop0578.et2.tbsite.net:26621, 73 -&gt; hadoop0789.et2.tbsite.net:27617, 74 -&gt; hadoop0699.et2.tbsite.net:27052, 75 -&gt; hadoop0627.et2.tbsite.net:27065, 76 -&gt; hadoop0804.et2.tbsite.net:29234, 77 -&gt; hadoop0821.et2.tbsite.net:27680, 78 -&gt; hadoop5048.et2.tbsite.net:25832, 79 -&gt; hadoop5033.et2.tbsite.net:27200, 80 -&gt; hadoop0756.et2.tbsite.net:26536, 81 -&gt; hadoop0689.et2.tbsite.net:26522, 82 -&gt; hadoop0851.et2.tbsite.net:29934, 83 -&gt; hadoop0541.et2.tbsite.net:27118, 84 -&gt; hadoop0647.et2.tbsite.net:27308, 85 -&gt; hadoop0579.et2.tbsite.net:27040, 86 -&gt; hadoop5055.et2.tbsite.net:26841, 87 -&gt; hadoop1882.et2.tbsite.net:26220, 88 -&gt; hadoop0615.et2.tbsite.net:25089, 89 -&gt; hadoop1902.et2.tbsite.net:26867, 90 -&gt; localhost:27983, 91 -&gt; hadoop0807.et2.tbsite.net:28033, 92 -&gt; hadoop5014.et2.tbsite.net:29535, 93 -&gt; hadoop0746.et2.tbsite.net:29884, 94 -&gt; hadoop0250.et2.tbsite.net:26868, 95 -&gt; hadoop0706.et2.tbsite.net:29045, 96 -&gt; hadoop0854.et2.tbsite.net:29149, 97 -&gt; hadoop0185.et2.tbsite.net:26971, 98 -&gt; hadoop0467.et2.tbsite.net:25830, 99 -&gt; hadoop0611.et2.tbsite.net:28720}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:211] Started server with target: grpc://localhost:27983\nINFO:tensorflow:Using config: {'save_summary_steps': 100000, '_num_ps_replicas': 16, '_task_type': u'worker', '_environment': u'cloud', '_is_chief': False, 'save_checkpoints_secs': 60, '_cluster_spec': &lt;tensorflow.python.training.server_lib.ClusterSpec object at 0x7f11f9b57d50&gt;, 'tf_config': intra_op_parallelism_threads: 4\ninter_op_parallelism_threads: 4\ngpu_options {\n  per_process_gpu_memory_fraction: 1\n}\n</code></pre>\n<pre><code>Traceback (most recent call last):\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 297, in _monitored_train\n    hooks=all_hooks) as super_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 447, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 618, in __init__\n    _WrappedSession.__init__(self, self._sess_creator.create_session())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 505, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 374, in create_session\n    self._master, config=self._config)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 346, in wait_for_session\n    sess)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 467, in _try_run_local_init_op\n    sess.run(self._local_init_op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'save/RestoreV2_26': Could not satisfy explicit device specification '/job:ps/task:4/device:CPU:0' because no devices matching that specification are registered in this process; available devices: /job:ps/replica:0/task:0/cpu:0, /job:ps/replica:0/task:1/cpu:0, /job:ps/replica:0/task:10/cpu:0, /job:ps/replica:0/task:11/cpu:0, /job:ps/replica:0/task:12/cpu:0, /job:ps/replica:0/task:13/cpu:0, /job:ps/replica:0/task:14/cpu:0, /job:ps/replica:0/task:15/cpu:0, /job:ps/replica:0/task:2/cpu:0, /job:ps/replica:0/task:3/cpu:0, /job:ps/replica:0/task:5/cpu:0, /job:ps/replica:0/task:6/cpu:0, /job:ps/replica:0/task:7/cpu:0, /job:ps/replica:0/task:8/cpu:0, /job:ps/replica:0/task:9/cpu:0, /job:worker/replica:0/task:0/cpu:0, /job:worker/replica:0/task:1/cpu:0, /job:worker/replica:0/task:10/cpu:0, /job:worker/replica:0/task:11/cpu:0, /job:worker/replica:0/task:12/cpu:0, /job:worker/replica:0/task:13/cpu:0, /job:worker/replica:0/task:14/cpu:0, /job:worker/replica:0/task:15/cpu:0, /job:worker/replica:0/task:16/cpu:0, /job:worker/replica:0/task:17/cpu:0, /job:worker/replica:0/task:18/cpu:0, /job:worker/replica:0/task:19/cpu:0, /job:worker/replica:0/task:2/cpu:0, /job:worker/replica:0/task:20/cpu:0, /job:worker/replica:0/task:21/cpu:0, /job:worker/replica:0/task:22/cpu:0, /job:worker/replica:0/task:23/cpu:0, /job:worker/replica:0/task:24/cpu:0, /job:worker/replica:0/task:25/cpu:0, /job:worker/replica:0/task:26/cpu:0, /job:worker/replica:0/task:27/cpu:0, /job:worker/replica:0/task:28/cpu:0, /job:worker/replica:0/task:29/cpu:0, /job:worker/replica:0/task:3/cpu:0, /job:worker/replica:0/task:30/cpu:0, /job:worker/replica:0/task:31/cpu:0, /job:worker/replica:0/task:32/cpu:0, /job:worker/replica:0/task:33/cpu:0, /job:worker/replica:0/task:34/cpu:0, /job:worker/replica:0/task:35/cpu:0, /job:worker/replica:0/task:36/cpu:0, /job:worker/replica:0/task:37/cpu:0, /job:worker/replica:0/task:38/cpu:0, /job:worker/replica:0/task:39/cpu:0, /job:worker/replica:0/task:4/cpu:0, /job:worker/replica:0/task:40/cpu:0, /job:worker/replica:0/task:41/cpu:0, /job:worker/replica:0/task:42/cpu:0, /job:worker/replica:0/task:43/cpu:0, /job:worker/replica:0/task:44/cpu:0, /job:worker/replica:0/task:45/cpu:0, /job:worker/replica:0/task:46/cpu:0, /job:worker/replica:0/task:47/cpu:0, /job:worker/replica:0/task:48/cpu:0, /job:worker/replica:0/task:49/cpu:0, /job:worker/replica:0/task:5/cpu:0, /job:worker/replica:0/task:50/cpu:0, /job:worker/replica:0/task:51/cpu:0, /job:worker/replica:0/task:52/cpu:0, /job:worker/replica:0/task:53/cpu:0, /job:worker/replica:0/task:54/cpu:0, /job:worker/replica:0/task:55/cpu:0, /job:worker/replica:0/task:56/cpu:0, /job:worker/replica:0/task:57/cpu:0, /job:worker/replica:0/task:58/cpu:0, /job:worker/replica:0/task:59/cpu:0, /job:worker/replica:0/task:6/cpu:0, /job:worker/replica:0/task:60/cpu:0, /job:worker/replica:0/task:61/cpu:0, /job:worker/replica:0/task:62/cpu:0, /job:worker/replica:0/task:63/cpu:0, /job:worker/replica:0/task:64/cpu:0, /job:worker/replica:0/task:65/cpu:0, /job:worker/replica:0/task:66/cpu:0, /job:worker/replica:0/task:67/cpu:0, /job:worker/replica:0/task:68/cpu:0, /job:worker/replica:0/task:69/cpu:0, /job:worker/replica:0/task:7/cpu:0, /job:worker/replica:0/task:70/cpu:0, /job:worker/replica:0/task:71/cpu:0, /job:worker/replica:0/task:72/cpu:0, /job:worker/replica:0/task:73/cpu:0, /job:worker/replica:0/task:74/cpu:0, /job:worker/replica:0/task:75/cpu:0, /job:worker/replica:0/task:76/cpu:0, /job:worker/replica:0/task:77/cpu:0, /job:worker/replica:0/task:78/cpu:0, /job:worker/replica:0/task:79/cpu:0, /job:worker/replica:0/task:8/cpu:0, /job:worker/replica:0/task:80/cpu:0, /job:worker/replica:0/task:81/cpu:0, /job:worker/replica:0/task:82/cpu:0, /job:worker/replica:0/task:83/cpu:0, /job:worker/replica:0/task:84/cpu:0, /job:worker/replica:0/task:85/cpu:0, /job:worker/replica:0/task:86/cpu:0, /job:worker/replica:0/task:87/cpu:0, /job:worker/replica:0/task:88/cpu:0, /job:worker/replica:0/task:89/cpu:0, /job:worker/replica:0/task:9/cpu:0, /job:worker/replica:0/task:90/cpu:0, /job:worker/replica:0/task:91/cpu:0, /job:worker/replica:0/task:92/cpu:0, /job:worker/replica:0/task:93/cpu:0, /job:worker/replica:0/task:94/cpu:0, /job:worker/replica:0/task:95/cpu:0, /job:worker/replica:0/task:96/cpu:0, /job:worker/replica:0/task:97/cpu:0, /job:worker/replica:0/task:98/cpu:0, /job:worker/replica:0/task:99/cpu:0\n     [[Node: save/RestoreV2_26 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:ps/task:4/device:CPU:0\"](save/Const, save/RestoreV2_26/tensor_names, save/RestoreV2_26/shape_and_slices)]]\n\nCaused by op u'save/RestoreV2_26', defined at:\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 297, in _monitored_train\n    hooks=all_hooks) as super_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 447, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 618, in __init__\n    _WrappedSession.__init__(self, self._sess_creator.create_session())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 505, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 372, in create_session\n    self._scaffold.finalize()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 163, in finalize\n    self._saver.build()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1030, in build\n    restore_sequentially=self._restore_sequentially)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 620, in build\n    restore_sequentially, reshape)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 404, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 361, in _AddRestoreOps\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 200, in restore_op\n    [spec.tensor.dtype])[0])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 441, in restore_v2\n    dtypes=dtypes, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\n    self._traceback = _extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'save/RestoreV2_26': Could not satisfy explicit device specification '/job:ps/task:4/device:CPU:0' because no devices matching that specification are registered in this process; available devices: /job:ps/replica:0/task:0/cpu:0, /job:ps/replica:0/task:1/cpu:0, /job:ps/replica:0/task:10/cpu:0, /job:ps/replica:0/task:11/cpu:0, /job:ps/replica:0/task:12/cpu:0, /job:ps/replica:0/task:13/cpu:0, /job:ps/replica:0/task:14/cpu:0, /job:ps/replica:0/task:15/cpu:0, /job:ps/replica:0/task:2/cpu:0, /job:ps/replica:0/task:3/cpu:0, /job:ps/replica:0/task:5/cpu:0, /job:ps/replica:0/task:6/cpu:0, /job:ps/replica:0/task:7/cpu:0, /job:ps/replica:0/task:8/cpu:0, /job:ps/replica:0/task:9/cpu:0, /job:worker/replica:0/task:0/cpu:0, /job:worker/replica:0/task:1/cpu:0, /job:worker/replica:0/task:10/cpu:0, /job:worker/replica:0/task:11/cpu:0, /job:worker/replica:0/task:12/cpu:0, /job:worker/replica:0/task:13/cpu:0, /job:worker/replica:0/task:14/cpu:0, /job:worker/replica:0/task:15/cpu:0, /job:worker/replica:0/task:16/cpu:0, /job:worker/replica:0/task:17/cpu:0, /job:worker/replica:0/task:18/cpu:0, /job:worker/replica:0/task:19/cpu:0, /job:worker/replica:0/task:2/cpu:0, /job:worker/replica:0/task:20/cpu:0, /job:worker/replica:0/task:21/cpu:0, /job:worker/replica:0/task:22/cpu:0, /job:worker/replica:0/task:23/cpu:0, /job:worker/replica:0/task:24/cpu:0, /job:worker/replica:0/task:25/cpu:0, /job:worker/replica:0/task:26/cpu:0, /job:worker/replica:0/task:27/cpu:0, /job:worker/replica:0/task:28/cpu:0, /job:worker/replica:0/task:29/cpu:0, /job:worker/replica:0/task:3/cpu:0, /job:worker/replica:0/task:30/cpu:0, /job:worker/replica:0/task:31/cpu:0, /job:worker/replica:0/task:32/cpu:0, /job:worker/replica:0/task:33/cpu:0, /job:worker/replica:0/task:34/cpu:0, /job:worker/replica:0/task:35/cpu:0, /job:worker/replica:0/task:36/cpu:0, /job:worker/replica:0/task:37/cpu:0, /job:worker/replica:0/task:38/cpu:0, /job:worker/replica:0/task:39/cpu:0, /job:worker/replica:0/task:4/cpu:0, /job:worker/replica:0/task:40/cpu:0, /job:worker/replica:0/task:41/cpu:0, /job:worker/replica:0/task:42/cpu:0, /job:worker/replica:0/task:43/cpu:0, /job:worker/replica:0/task:44/cpu:0, /job:worker/replica:0/task:45/cpu:0, /job:worker/replica:0/task:46/cpu:0, /job:worker/replica:0/task:47/cpu:0, /job:worker/replica:0/task:48/cpu:0, /job:worker/replica:0/task:49/cpu:0, /job:worker/replica:0/task:5/cpu:0, /job:worker/replica:0/task:50/cpu:0, /job:worker/replica:0/task:51/cpu:0, /job:worker/replica:0/task:52/cpu:0, /job:worker/replica:0/task:53/cpu:0, /job:worker/replica:0/task:54/cpu:0, /job:worker/replica:0/task:55/cpu:0, /job:worker/replica:0/task:56/cpu:0, /job:worker/replica:0/task:57/cpu:0, /job:worker/replica:0/task:58/cpu:0, /job:worker/replica:0/task:59/cpu:0, /job:worker/replica:0/task:6/cpu:0, /job:worker/replica:0/task:60/cpu:0, /job:worker/replica:0/task:61/cpu:0, /job:worker/replica:0/task:62/cpu:0, /job:worker/replica:0/task:63/cpu:0, /job:worker/replica:0/task:64/cpu:0, /job:worker/replica:0/task:65/cpu:0, /job:worker/replica:0/task:66/cpu:0, /job:worker/replica:0/task:67/cpu:0, /job:worker/replica:0/task:68/cpu:0, /job:worker/replica:0/task:69/cpu:0, /job:worker/replica:0/task:7/cpu:0, /job:worker/replica:0/task:70/cpu:0, /job:worker/replica:0/task:71/cpu:0, /job:worker/replica:0/task:72/cpu:0, /job:worker/replica:0/task:73/cpu:0, /job:worker/replica:0/task:74/cpu:0, /job:worker/replica:0/task:75/cpu:0, /job:worker/replica:0/task:76/cpu:0, /job:worker/replica:0/task:77/cpu:0, /job:worker/replica:0/task:78/cpu:0, /job:worker/replica:0/task:79/cpu:0, /job:worker/replica:0/task:8/cpu:0, /job:worker/replica:0/task:80/cpu:0, /job:worker/replica:0/task:81/cpu:0, /job:worker/replica:0/task:82/cpu:0, /job:worker/replica:0/task:83/cpu:0, /job:worker/replica:0/task:84/cpu:0, /job:worker/replica:0/task:85/cpu:0, /job:worker/replica:0/task:86/cpu:0, /job:worker/replica:0/task:87/cpu:0, /job:worker/replica:0/task:88/cpu:0, /job:worker/replica:0/task:89/cpu:0, /job:worker/replica:0/task:9/cpu:0, /job:worker/replica:0/task:90/cpu:0, /job:worker/replica:0/task:91/cpu:0, /job:worker/replica:0/task:92/cpu:0, /job:worker/replica:0/task:93/cpu:0, /job:worker/replica:0/task:94/cpu:0, /job:worker/replica:0/task:95/cpu:0, /job:worker/replica:0/task:96/cpu:0, /job:worker/replica:0/task:97/cpu:0, /job:worker/replica:0/task:98/cpu:0, /job:worker/replica:0/task:99/cpu:0\n     [[Node: save/RestoreV2_26 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:ps/task:4/device:CPU:0\"](save/Const, save/RestoreV2_26/tensor_names, save/RestoreV2_26/shape_and_slices)]]\n</code></pre>\n<pre><code>INFO:tensorflow:loss = 5.55723, step = 1431908\nE tensorflow/core/distributed_runtime/master_session.cc:1372] Cleanup partition error: Unavailable: {\"created\":\"@1484095048.299027908\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\nTraceback (most recent call last):\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\n    None)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1484095048.299027908\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\n</code></pre>", "body_text": "@yaroslavvb Here's the complete backtrace:)\nTraceback (most recent call last):\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\n    None)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1484093728.844289839\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> hadoop0560.et2.tbsite.net:25868, 1 -> hadoop0138.et2.tbsite.net:27562, 2 -> hadoop0177.et2.tbsite.net:26103, 3 -> hadoop0712.et2.tbsite.net:26106, 4 -> hadoop5021.et2.tbsite.net:29662, 5 -> hadoop0616.et2.tbsite.net:26974, 6 -> hadoop0635.et2.tbsite.net:29028, 7 -> hadoop0580.et2.tbsite.net:29141, 8 -> hadoop0587.et2.tbsite.net:28455, 9 -> hadoop1845.et2.tbsite.net:27397, 10 -> hadoop1892.et2.tbsite.net:28091, 11 -> hadoop0511.et2.tbsite.net:27469, 12 -> hadoop0744.et2.tbsite.net:25843, 13 -> hadoop0621.et2.tbsite.net:25316, 14 -> hadoop0067.et2.tbsite.net:26703, 15 -> hadoop0612.et2.tbsite.net:28886}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> hadoop0743.et2.tbsite.net:28429, 1 -> hadoop0245.et2.tbsite.net:28221, 2 -> hadoop0633.et2.tbsite.net:25817, 3 -> hadoop0729.et2.tbsite.net:26892, 4 -> hadoop0642.et2.tbsite.net:29372, 5 -> hadoop1006.et2.tbsite.net:26049, 6 -> hadoop5035.et2.tbsite.net:26419, 7 -> hadoop0718.et2.tbsite.net:26232, 8 -> hadoop0947.et2.tbsite.net:27491, 9 -> hadoop5028.et2.tbsite.net:25950, 10 -> hadoop1873.et2.tbsite.net:27579, 11 -> hadoop0618.et2.tbsite.net:27564, 12 -> hadoop0172.et2.tbsite.net:26764, 13 -> hadoop0637.et2.tbsite.net:28835, 14 -> hadoop1863.et2.tbsite.net:28968, 15 -> hadoop0614.et2.tbsite.net:26038, 16 -> hadoop0715.et2.tbsite.net:29649, 17 -> hadoop0735.et2.tbsite.net:25061, 18 -> hadoop1003.et2.tbsite.net:27781, 19 -> hadoop5047.et2.tbsite.net:26782, 20 -> hadoop0738.et2.tbsite.net:25868, 21 -> hadoop5041.et2.tbsite.net:29389, 22 -> hadoop1872.et2.tbsite.net:25251, 23 -> hadoop0891.et2.tbsite.net:25213, 24 -> hadoop0785.et2.tbsite.net:29996, 25 -> hadoop0809.et2.tbsite.net:29229, 26 -> hadoop1836.et2.tbsite.net:29542, 27 -> hadoop0592.et2.tbsite.net:28786, 28 -> hadoop0714.et2.tbsite.net:28822, 29 -> hadoop0572.et2.tbsite.net:27784, 30 -> hadoop1838.et2.tbsite.net:29014, 31 -> hadoop0600.et2.tbsite.net:29302, 32 -> hadoop0178.et2.tbsite.net:25334, 33 -> hadoop0471.et2.tbsite.net:25353, 34 -> hadoop0649.et2.tbsite.net:25981, 35 -> hadoop1848.et2.tbsite.net:26250, 36 -> hadoop0569.et2.tbsite.net:28590, 37 -> hadoop0589.et2.tbsite.net:25475, 38 -> hadoop0771.et2.tbsite.net:29900, 39 -> hadoop5030.et2.tbsite.net:25125, 40 -> hadoop1890.et2.tbsite.net:27007, 41 -> hadoop0946.et2.tbsite.net:28429, 42 -> hadoop1859.et2.tbsite.net:26312, 43 -> hadoop1828.et2.tbsite.net:25200, 44 -> hadoop0762.et2.tbsite.net:27702, 45 -> hadoop5038.et2.tbsite.net:27372, 46 -> hadoop0609.et2.tbsite.net:29673, 47 -> hadoop1878.et2.tbsite.net:29987, 48 -> hadoop0704.et2.tbsite.net:25593, 49 -> hadoop0815.et2.tbsite.net:26288, 50 -> hadoop0488.et2.tbsite.net:26090, 51 -> hadoop0826.et2.tbsite.net:28780, 52 -> hadoop0890.et2.tbsite.net:27610, 53 -> hadoop0713.et2.tbsite.net:26176, 54 -> hadoop0845.et2.tbsite.net:28818, 55 -> hadoop1827.et2.tbsite.net:29269, 56 -> hadoop0767.et2.tbsite.net:26084, 57 -> hadoop1853.et2.tbsite.net:26311, 58 -> hadoop0837.et2.tbsite.net:29223, 59 -> hadoop0256.et2.tbsite.net:28043, 60 -> hadoop0728.et2.tbsite.net:26120, 61 -> hadoop0535.et2.tbsite.net:26474, 62 -> hadoop0857.et2.tbsite.net:27474, 63 -> hadoop0482.et2.tbsite.net:28653, 64 -> hadoop0737.et2.tbsite.net:26960, 65 -> hadoop0848.et2.tbsite.net:27215, 66 -> hadoop0606.et2.tbsite.net:29632, 67 -> hadoop0613.et2.tbsite.net:26596, 68 -> hadoop5007.et2.tbsite.net:27294, 69 -> hadoop0698.et2.tbsite.net:29914, 70 -> hadoop0768.et2.tbsite.net:26747, 71 -> hadoop0545.et2.tbsite.net:27286, 72 -> hadoop0578.et2.tbsite.net:26621, 73 -> hadoop0789.et2.tbsite.net:27617, 74 -> hadoop0699.et2.tbsite.net:27052, 75 -> hadoop0627.et2.tbsite.net:27065, 76 -> hadoop0804.et2.tbsite.net:29234, 77 -> hadoop0821.et2.tbsite.net:27680, 78 -> hadoop5048.et2.tbsite.net:25832, 79 -> hadoop5033.et2.tbsite.net:27200, 80 -> hadoop0756.et2.tbsite.net:26536, 81 -> hadoop0689.et2.tbsite.net:26522, 82 -> hadoop0851.et2.tbsite.net:29934, 83 -> hadoop0541.et2.tbsite.net:27118, 84 -> hadoop0647.et2.tbsite.net:27308, 85 -> hadoop0579.et2.tbsite.net:27040, 86 -> hadoop5055.et2.tbsite.net:26841, 87 -> hadoop1882.et2.tbsite.net:26220, 88 -> hadoop0615.et2.tbsite.net:25089, 89 -> hadoop1902.et2.tbsite.net:26867, 90 -> localhost:27983, 91 -> hadoop0807.et2.tbsite.net:28033, 92 -> hadoop5014.et2.tbsite.net:29535, 93 -> hadoop0746.et2.tbsite.net:29884, 94 -> hadoop0250.et2.tbsite.net:26868, 95 -> hadoop0706.et2.tbsite.net:29045, 96 -> hadoop0854.et2.tbsite.net:29149, 97 -> hadoop0185.et2.tbsite.net:26971, 98 -> hadoop0467.et2.tbsite.net:25830, 99 -> hadoop0611.et2.tbsite.net:28720}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:211] Started server with target: grpc://localhost:27983\nINFO:tensorflow:Using config: {'save_summary_steps': 100000, '_num_ps_replicas': 16, '_task_type': u'worker', '_environment': u'cloud', '_is_chief': False, 'save_checkpoints_secs': 60, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f11f9b57d50>, 'tf_config': intra_op_parallelism_threads: 4\ninter_op_parallelism_threads: 4\ngpu_options {\n  per_process_gpu_memory_fraction: 1\n}\n\nTraceback (most recent call last):\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 297, in _monitored_train\n    hooks=all_hooks) as super_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 447, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 618, in __init__\n    _WrappedSession.__init__(self, self._sess_creator.create_session())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 505, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 374, in create_session\n    self._master, config=self._config)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 346, in wait_for_session\n    sess)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 467, in _try_run_local_init_op\n    sess.run(self._local_init_op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'save/RestoreV2_26': Could not satisfy explicit device specification '/job:ps/task:4/device:CPU:0' because no devices matching that specification are registered in this process; available devices: /job:ps/replica:0/task:0/cpu:0, /job:ps/replica:0/task:1/cpu:0, /job:ps/replica:0/task:10/cpu:0, /job:ps/replica:0/task:11/cpu:0, /job:ps/replica:0/task:12/cpu:0, /job:ps/replica:0/task:13/cpu:0, /job:ps/replica:0/task:14/cpu:0, /job:ps/replica:0/task:15/cpu:0, /job:ps/replica:0/task:2/cpu:0, /job:ps/replica:0/task:3/cpu:0, /job:ps/replica:0/task:5/cpu:0, /job:ps/replica:0/task:6/cpu:0, /job:ps/replica:0/task:7/cpu:0, /job:ps/replica:0/task:8/cpu:0, /job:ps/replica:0/task:9/cpu:0, /job:worker/replica:0/task:0/cpu:0, /job:worker/replica:0/task:1/cpu:0, /job:worker/replica:0/task:10/cpu:0, /job:worker/replica:0/task:11/cpu:0, /job:worker/replica:0/task:12/cpu:0, /job:worker/replica:0/task:13/cpu:0, /job:worker/replica:0/task:14/cpu:0, /job:worker/replica:0/task:15/cpu:0, /job:worker/replica:0/task:16/cpu:0, /job:worker/replica:0/task:17/cpu:0, /job:worker/replica:0/task:18/cpu:0, /job:worker/replica:0/task:19/cpu:0, /job:worker/replica:0/task:2/cpu:0, /job:worker/replica:0/task:20/cpu:0, /job:worker/replica:0/task:21/cpu:0, /job:worker/replica:0/task:22/cpu:0, /job:worker/replica:0/task:23/cpu:0, /job:worker/replica:0/task:24/cpu:0, /job:worker/replica:0/task:25/cpu:0, /job:worker/replica:0/task:26/cpu:0, /job:worker/replica:0/task:27/cpu:0, /job:worker/replica:0/task:28/cpu:0, /job:worker/replica:0/task:29/cpu:0, /job:worker/replica:0/task:3/cpu:0, /job:worker/replica:0/task:30/cpu:0, /job:worker/replica:0/task:31/cpu:0, /job:worker/replica:0/task:32/cpu:0, /job:worker/replica:0/task:33/cpu:0, /job:worker/replica:0/task:34/cpu:0, /job:worker/replica:0/task:35/cpu:0, /job:worker/replica:0/task:36/cpu:0, /job:worker/replica:0/task:37/cpu:0, /job:worker/replica:0/task:38/cpu:0, /job:worker/replica:0/task:39/cpu:0, /job:worker/replica:0/task:4/cpu:0, /job:worker/replica:0/task:40/cpu:0, /job:worker/replica:0/task:41/cpu:0, /job:worker/replica:0/task:42/cpu:0, /job:worker/replica:0/task:43/cpu:0, /job:worker/replica:0/task:44/cpu:0, /job:worker/replica:0/task:45/cpu:0, /job:worker/replica:0/task:46/cpu:0, /job:worker/replica:0/task:47/cpu:0, /job:worker/replica:0/task:48/cpu:0, /job:worker/replica:0/task:49/cpu:0, /job:worker/replica:0/task:5/cpu:0, /job:worker/replica:0/task:50/cpu:0, /job:worker/replica:0/task:51/cpu:0, /job:worker/replica:0/task:52/cpu:0, /job:worker/replica:0/task:53/cpu:0, /job:worker/replica:0/task:54/cpu:0, /job:worker/replica:0/task:55/cpu:0, /job:worker/replica:0/task:56/cpu:0, /job:worker/replica:0/task:57/cpu:0, /job:worker/replica:0/task:58/cpu:0, /job:worker/replica:0/task:59/cpu:0, /job:worker/replica:0/task:6/cpu:0, /job:worker/replica:0/task:60/cpu:0, /job:worker/replica:0/task:61/cpu:0, /job:worker/replica:0/task:62/cpu:0, /job:worker/replica:0/task:63/cpu:0, /job:worker/replica:0/task:64/cpu:0, /job:worker/replica:0/task:65/cpu:0, /job:worker/replica:0/task:66/cpu:0, /job:worker/replica:0/task:67/cpu:0, /job:worker/replica:0/task:68/cpu:0, /job:worker/replica:0/task:69/cpu:0, /job:worker/replica:0/task:7/cpu:0, /job:worker/replica:0/task:70/cpu:0, /job:worker/replica:0/task:71/cpu:0, /job:worker/replica:0/task:72/cpu:0, /job:worker/replica:0/task:73/cpu:0, /job:worker/replica:0/task:74/cpu:0, /job:worker/replica:0/task:75/cpu:0, /job:worker/replica:0/task:76/cpu:0, /job:worker/replica:0/task:77/cpu:0, /job:worker/replica:0/task:78/cpu:0, /job:worker/replica:0/task:79/cpu:0, /job:worker/replica:0/task:8/cpu:0, /job:worker/replica:0/task:80/cpu:0, /job:worker/replica:0/task:81/cpu:0, /job:worker/replica:0/task:82/cpu:0, /job:worker/replica:0/task:83/cpu:0, /job:worker/replica:0/task:84/cpu:0, /job:worker/replica:0/task:85/cpu:0, /job:worker/replica:0/task:86/cpu:0, /job:worker/replica:0/task:87/cpu:0, /job:worker/replica:0/task:88/cpu:0, /job:worker/replica:0/task:89/cpu:0, /job:worker/replica:0/task:9/cpu:0, /job:worker/replica:0/task:90/cpu:0, /job:worker/replica:0/task:91/cpu:0, /job:worker/replica:0/task:92/cpu:0, /job:worker/replica:0/task:93/cpu:0, /job:worker/replica:0/task:94/cpu:0, /job:worker/replica:0/task:95/cpu:0, /job:worker/replica:0/task:96/cpu:0, /job:worker/replica:0/task:97/cpu:0, /job:worker/replica:0/task:98/cpu:0, /job:worker/replica:0/task:99/cpu:0\n     [[Node: save/RestoreV2_26 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:ps/task:4/device:CPU:0\"](save/Const, save/RestoreV2_26/tensor_names, save/RestoreV2_26/shape_and_slices)]]\n\nCaused by op u'save/RestoreV2_26', defined at:\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 297, in _monitored_train\n    hooks=all_hooks) as super_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 447, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 618, in __init__\n    _WrappedSession.__init__(self, self._sess_creator.create_session())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 505, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 372, in create_session\n    self._scaffold.finalize()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 163, in finalize\n    self._saver.build()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1030, in build\n    restore_sequentially=self._restore_sequentially)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 620, in build\n    restore_sequentially, reshape)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 404, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 361, in _AddRestoreOps\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 200, in restore_op\n    [spec.tensor.dtype])[0])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 441, in restore_v2\n    dtypes=dtypes, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\n    self._traceback = _extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'save/RestoreV2_26': Could not satisfy explicit device specification '/job:ps/task:4/device:CPU:0' because no devices matching that specification are registered in this process; available devices: /job:ps/replica:0/task:0/cpu:0, /job:ps/replica:0/task:1/cpu:0, /job:ps/replica:0/task:10/cpu:0, /job:ps/replica:0/task:11/cpu:0, /job:ps/replica:0/task:12/cpu:0, /job:ps/replica:0/task:13/cpu:0, /job:ps/replica:0/task:14/cpu:0, /job:ps/replica:0/task:15/cpu:0, /job:ps/replica:0/task:2/cpu:0, /job:ps/replica:0/task:3/cpu:0, /job:ps/replica:0/task:5/cpu:0, /job:ps/replica:0/task:6/cpu:0, /job:ps/replica:0/task:7/cpu:0, /job:ps/replica:0/task:8/cpu:0, /job:ps/replica:0/task:9/cpu:0, /job:worker/replica:0/task:0/cpu:0, /job:worker/replica:0/task:1/cpu:0, /job:worker/replica:0/task:10/cpu:0, /job:worker/replica:0/task:11/cpu:0, /job:worker/replica:0/task:12/cpu:0, /job:worker/replica:0/task:13/cpu:0, /job:worker/replica:0/task:14/cpu:0, /job:worker/replica:0/task:15/cpu:0, /job:worker/replica:0/task:16/cpu:0, /job:worker/replica:0/task:17/cpu:0, /job:worker/replica:0/task:18/cpu:0, /job:worker/replica:0/task:19/cpu:0, /job:worker/replica:0/task:2/cpu:0, /job:worker/replica:0/task:20/cpu:0, /job:worker/replica:0/task:21/cpu:0, /job:worker/replica:0/task:22/cpu:0, /job:worker/replica:0/task:23/cpu:0, /job:worker/replica:0/task:24/cpu:0, /job:worker/replica:0/task:25/cpu:0, /job:worker/replica:0/task:26/cpu:0, /job:worker/replica:0/task:27/cpu:0, /job:worker/replica:0/task:28/cpu:0, /job:worker/replica:0/task:29/cpu:0, /job:worker/replica:0/task:3/cpu:0, /job:worker/replica:0/task:30/cpu:0, /job:worker/replica:0/task:31/cpu:0, /job:worker/replica:0/task:32/cpu:0, /job:worker/replica:0/task:33/cpu:0, /job:worker/replica:0/task:34/cpu:0, /job:worker/replica:0/task:35/cpu:0, /job:worker/replica:0/task:36/cpu:0, /job:worker/replica:0/task:37/cpu:0, /job:worker/replica:0/task:38/cpu:0, /job:worker/replica:0/task:39/cpu:0, /job:worker/replica:0/task:4/cpu:0, /job:worker/replica:0/task:40/cpu:0, /job:worker/replica:0/task:41/cpu:0, /job:worker/replica:0/task:42/cpu:0, /job:worker/replica:0/task:43/cpu:0, /job:worker/replica:0/task:44/cpu:0, /job:worker/replica:0/task:45/cpu:0, /job:worker/replica:0/task:46/cpu:0, /job:worker/replica:0/task:47/cpu:0, /job:worker/replica:0/task:48/cpu:0, /job:worker/replica:0/task:49/cpu:0, /job:worker/replica:0/task:5/cpu:0, /job:worker/replica:0/task:50/cpu:0, /job:worker/replica:0/task:51/cpu:0, /job:worker/replica:0/task:52/cpu:0, /job:worker/replica:0/task:53/cpu:0, /job:worker/replica:0/task:54/cpu:0, /job:worker/replica:0/task:55/cpu:0, /job:worker/replica:0/task:56/cpu:0, /job:worker/replica:0/task:57/cpu:0, /job:worker/replica:0/task:58/cpu:0, /job:worker/replica:0/task:59/cpu:0, /job:worker/replica:0/task:6/cpu:0, /job:worker/replica:0/task:60/cpu:0, /job:worker/replica:0/task:61/cpu:0, /job:worker/replica:0/task:62/cpu:0, /job:worker/replica:0/task:63/cpu:0, /job:worker/replica:0/task:64/cpu:0, /job:worker/replica:0/task:65/cpu:0, /job:worker/replica:0/task:66/cpu:0, /job:worker/replica:0/task:67/cpu:0, /job:worker/replica:0/task:68/cpu:0, /job:worker/replica:0/task:69/cpu:0, /job:worker/replica:0/task:7/cpu:0, /job:worker/replica:0/task:70/cpu:0, /job:worker/replica:0/task:71/cpu:0, /job:worker/replica:0/task:72/cpu:0, /job:worker/replica:0/task:73/cpu:0, /job:worker/replica:0/task:74/cpu:0, /job:worker/replica:0/task:75/cpu:0, /job:worker/replica:0/task:76/cpu:0, /job:worker/replica:0/task:77/cpu:0, /job:worker/replica:0/task:78/cpu:0, /job:worker/replica:0/task:79/cpu:0, /job:worker/replica:0/task:8/cpu:0, /job:worker/replica:0/task:80/cpu:0, /job:worker/replica:0/task:81/cpu:0, /job:worker/replica:0/task:82/cpu:0, /job:worker/replica:0/task:83/cpu:0, /job:worker/replica:0/task:84/cpu:0, /job:worker/replica:0/task:85/cpu:0, /job:worker/replica:0/task:86/cpu:0, /job:worker/replica:0/task:87/cpu:0, /job:worker/replica:0/task:88/cpu:0, /job:worker/replica:0/task:89/cpu:0, /job:worker/replica:0/task:9/cpu:0, /job:worker/replica:0/task:90/cpu:0, /job:worker/replica:0/task:91/cpu:0, /job:worker/replica:0/task:92/cpu:0, /job:worker/replica:0/task:93/cpu:0, /job:worker/replica:0/task:94/cpu:0, /job:worker/replica:0/task:95/cpu:0, /job:worker/replica:0/task:96/cpu:0, /job:worker/replica:0/task:97/cpu:0, /job:worker/replica:0/task:98/cpu:0, /job:worker/replica:0/task:99/cpu:0\n     [[Node: save/RestoreV2_26 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:ps/task:4/device:CPU:0\"](save/Const, save/RestoreV2_26/tensor_names, save/RestoreV2_26/shape_and_slices)]]\n\nINFO:tensorflow:loss = 5.55723, step = 1431908\nE tensorflow/core/distributed_runtime/master_session.cc:1372] Cleanup partition error: Unavailable: {\"created\":\"@1484095048.299027908\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\nTraceback (most recent call last):\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\n    train().start(unused_args=unused_argv)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/yarn_bootstrap.py\", line 94, in start\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\n    distribution_training.run_training(server.target, cluster_spec, task_id)\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\n    max_steps=train_max_steps\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\n    None)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1484095048.299027908\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}", "body": "@yaroslavvb Here's the complete backtrace:)\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\r\n    train().start(unused_args=unused_argv)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\r\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\r\n    distribution_training.run_training(server.target, cluster_spec, task_id)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\r\n    max_steps=train_max_steps\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\r\n    None)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1484093728.844289839\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\r\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> hadoop0560.et2.tbsite.net:25868, 1 -> hadoop0138.et2.tbsite.net:27562, 2 -> hadoop0177.et2.tbsite.net:26103, 3 -> hadoop0712.et2.tbsite.net:26106, 4 -> hadoop5021.et2.tbsite.net:29662, 5 -> hadoop0616.et2.tbsite.net:26974, 6 -> hadoop0635.et2.tbsite.net:29028, 7 -> hadoop0580.et2.tbsite.net:29141, 8 -> hadoop0587.et2.tbsite.net:28455, 9 -> hadoop1845.et2.tbsite.net:27397, 10 -> hadoop1892.et2.tbsite.net:28091, 11 -> hadoop0511.et2.tbsite.net:27469, 12 -> hadoop0744.et2.tbsite.net:25843, 13 -> hadoop0621.et2.tbsite.net:25316, 14 -> hadoop0067.et2.tbsite.net:26703, 15 -> hadoop0612.et2.tbsite.net:28886}\r\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> hadoop0743.et2.tbsite.net:28429, 1 -> hadoop0245.et2.tbsite.net:28221, 2 -> hadoop0633.et2.tbsite.net:25817, 3 -> hadoop0729.et2.tbsite.net:26892, 4 -> hadoop0642.et2.tbsite.net:29372, 5 -> hadoop1006.et2.tbsite.net:26049, 6 -> hadoop5035.et2.tbsite.net:26419, 7 -> hadoop0718.et2.tbsite.net:26232, 8 -> hadoop0947.et2.tbsite.net:27491, 9 -> hadoop5028.et2.tbsite.net:25950, 10 -> hadoop1873.et2.tbsite.net:27579, 11 -> hadoop0618.et2.tbsite.net:27564, 12 -> hadoop0172.et2.tbsite.net:26764, 13 -> hadoop0637.et2.tbsite.net:28835, 14 -> hadoop1863.et2.tbsite.net:28968, 15 -> hadoop0614.et2.tbsite.net:26038, 16 -> hadoop0715.et2.tbsite.net:29649, 17 -> hadoop0735.et2.tbsite.net:25061, 18 -> hadoop1003.et2.tbsite.net:27781, 19 -> hadoop5047.et2.tbsite.net:26782, 20 -> hadoop0738.et2.tbsite.net:25868, 21 -> hadoop5041.et2.tbsite.net:29389, 22 -> hadoop1872.et2.tbsite.net:25251, 23 -> hadoop0891.et2.tbsite.net:25213, 24 -> hadoop0785.et2.tbsite.net:29996, 25 -> hadoop0809.et2.tbsite.net:29229, 26 -> hadoop1836.et2.tbsite.net:29542, 27 -> hadoop0592.et2.tbsite.net:28786, 28 -> hadoop0714.et2.tbsite.net:28822, 29 -> hadoop0572.et2.tbsite.net:27784, 30 -> hadoop1838.et2.tbsite.net:29014, 31 -> hadoop0600.et2.tbsite.net:29302, 32 -> hadoop0178.et2.tbsite.net:25334, 33 -> hadoop0471.et2.tbsite.net:25353, 34 -> hadoop0649.et2.tbsite.net:25981, 35 -> hadoop1848.et2.tbsite.net:26250, 36 -> hadoop0569.et2.tbsite.net:28590, 37 -> hadoop0589.et2.tbsite.net:25475, 38 -> hadoop0771.et2.tbsite.net:29900, 39 -> hadoop5030.et2.tbsite.net:25125, 40 -> hadoop1890.et2.tbsite.net:27007, 41 -> hadoop0946.et2.tbsite.net:28429, 42 -> hadoop1859.et2.tbsite.net:26312, 43 -> hadoop1828.et2.tbsite.net:25200, 44 -> hadoop0762.et2.tbsite.net:27702, 45 -> hadoop5038.et2.tbsite.net:27372, 46 -> hadoop0609.et2.tbsite.net:29673, 47 -> hadoop1878.et2.tbsite.net:29987, 48 -> hadoop0704.et2.tbsite.net:25593, 49 -> hadoop0815.et2.tbsite.net:26288, 50 -> hadoop0488.et2.tbsite.net:26090, 51 -> hadoop0826.et2.tbsite.net:28780, 52 -> hadoop0890.et2.tbsite.net:27610, 53 -> hadoop0713.et2.tbsite.net:26176, 54 -> hadoop0845.et2.tbsite.net:28818, 55 -> hadoop1827.et2.tbsite.net:29269, 56 -> hadoop0767.et2.tbsite.net:26084, 57 -> hadoop1853.et2.tbsite.net:26311, 58 -> hadoop0837.et2.tbsite.net:29223, 59 -> hadoop0256.et2.tbsite.net:28043, 60 -> hadoop0728.et2.tbsite.net:26120, 61 -> hadoop0535.et2.tbsite.net:26474, 62 -> hadoop0857.et2.tbsite.net:27474, 63 -> hadoop0482.et2.tbsite.net:28653, 64 -> hadoop0737.et2.tbsite.net:26960, 65 -> hadoop0848.et2.tbsite.net:27215, 66 -> hadoop0606.et2.tbsite.net:29632, 67 -> hadoop0613.et2.tbsite.net:26596, 68 -> hadoop5007.et2.tbsite.net:27294, 69 -> hadoop0698.et2.tbsite.net:29914, 70 -> hadoop0768.et2.tbsite.net:26747, 71 -> hadoop0545.et2.tbsite.net:27286, 72 -> hadoop0578.et2.tbsite.net:26621, 73 -> hadoop0789.et2.tbsite.net:27617, 74 -> hadoop0699.et2.tbsite.net:27052, 75 -> hadoop0627.et2.tbsite.net:27065, 76 -> hadoop0804.et2.tbsite.net:29234, 77 -> hadoop0821.et2.tbsite.net:27680, 78 -> hadoop5048.et2.tbsite.net:25832, 79 -> hadoop5033.et2.tbsite.net:27200, 80 -> hadoop0756.et2.tbsite.net:26536, 81 -> hadoop0689.et2.tbsite.net:26522, 82 -> hadoop0851.et2.tbsite.net:29934, 83 -> hadoop0541.et2.tbsite.net:27118, 84 -> hadoop0647.et2.tbsite.net:27308, 85 -> hadoop0579.et2.tbsite.net:27040, 86 -> hadoop5055.et2.tbsite.net:26841, 87 -> hadoop1882.et2.tbsite.net:26220, 88 -> hadoop0615.et2.tbsite.net:25089, 89 -> hadoop1902.et2.tbsite.net:26867, 90 -> localhost:27983, 91 -> hadoop0807.et2.tbsite.net:28033, 92 -> hadoop5014.et2.tbsite.net:29535, 93 -> hadoop0746.et2.tbsite.net:29884, 94 -> hadoop0250.et2.tbsite.net:26868, 95 -> hadoop0706.et2.tbsite.net:29045, 96 -> hadoop0854.et2.tbsite.net:29149, 97 -> hadoop0185.et2.tbsite.net:26971, 98 -> hadoop0467.et2.tbsite.net:25830, 99 -> hadoop0611.et2.tbsite.net:28720}\r\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:211] Started server with target: grpc://localhost:27983\r\nINFO:tensorflow:Using config: {'save_summary_steps': 100000, '_num_ps_replicas': 16, '_task_type': u'worker', '_environment': u'cloud', '_is_chief': False, 'save_checkpoints_secs': 60, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f11f9b57d50>, 'tf_config': intra_op_parallelism_threads: 4\r\ninter_op_parallelism_threads: 4\r\ngpu_options {\r\n  per_process_gpu_memory_fraction: 1\r\n}\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\r\n    train().start(unused_args=unused_argv)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\r\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\r\n    distribution_training.run_training(server.target, cluster_spec, task_id)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\r\n    max_steps=train_max_steps\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 297, in _monitored_train\r\n    hooks=all_hooks) as super_sess:\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 447, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 618, in __init__\r\n    _WrappedSession.__init__(self, self._sess_creator.create_session())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 505, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 374, in create_session\r\n    self._master, config=self._config)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 346, in wait_for_session\r\n    sess)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 467, in _try_run_local_init_op\r\n    sess.run(self._local_init_op)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'save/RestoreV2_26': Could not satisfy explicit device specification '/job:ps/task:4/device:CPU:0' because no devices matching that specification are registered in this process; available devices: /job:ps/replica:0/task:0/cpu:0, /job:ps/replica:0/task:1/cpu:0, /job:ps/replica:0/task:10/cpu:0, /job:ps/replica:0/task:11/cpu:0, /job:ps/replica:0/task:12/cpu:0, /job:ps/replica:0/task:13/cpu:0, /job:ps/replica:0/task:14/cpu:0, /job:ps/replica:0/task:15/cpu:0, /job:ps/replica:0/task:2/cpu:0, /job:ps/replica:0/task:3/cpu:0, /job:ps/replica:0/task:5/cpu:0, /job:ps/replica:0/task:6/cpu:0, /job:ps/replica:0/task:7/cpu:0, /job:ps/replica:0/task:8/cpu:0, /job:ps/replica:0/task:9/cpu:0, /job:worker/replica:0/task:0/cpu:0, /job:worker/replica:0/task:1/cpu:0, /job:worker/replica:0/task:10/cpu:0, /job:worker/replica:0/task:11/cpu:0, /job:worker/replica:0/task:12/cpu:0, /job:worker/replica:0/task:13/cpu:0, /job:worker/replica:0/task:14/cpu:0, /job:worker/replica:0/task:15/cpu:0, /job:worker/replica:0/task:16/cpu:0, /job:worker/replica:0/task:17/cpu:0, /job:worker/replica:0/task:18/cpu:0, /job:worker/replica:0/task:19/cpu:0, /job:worker/replica:0/task:2/cpu:0, /job:worker/replica:0/task:20/cpu:0, /job:worker/replica:0/task:21/cpu:0, /job:worker/replica:0/task:22/cpu:0, /job:worker/replica:0/task:23/cpu:0, /job:worker/replica:0/task:24/cpu:0, /job:worker/replica:0/task:25/cpu:0, /job:worker/replica:0/task:26/cpu:0, /job:worker/replica:0/task:27/cpu:0, /job:worker/replica:0/task:28/cpu:0, /job:worker/replica:0/task:29/cpu:0, /job:worker/replica:0/task:3/cpu:0, /job:worker/replica:0/task:30/cpu:0, /job:worker/replica:0/task:31/cpu:0, /job:worker/replica:0/task:32/cpu:0, /job:worker/replica:0/task:33/cpu:0, /job:worker/replica:0/task:34/cpu:0, /job:worker/replica:0/task:35/cpu:0, /job:worker/replica:0/task:36/cpu:0, /job:worker/replica:0/task:37/cpu:0, /job:worker/replica:0/task:38/cpu:0, /job:worker/replica:0/task:39/cpu:0, /job:worker/replica:0/task:4/cpu:0, /job:worker/replica:0/task:40/cpu:0, /job:worker/replica:0/task:41/cpu:0, /job:worker/replica:0/task:42/cpu:0, /job:worker/replica:0/task:43/cpu:0, /job:worker/replica:0/task:44/cpu:0, /job:worker/replica:0/task:45/cpu:0, /job:worker/replica:0/task:46/cpu:0, /job:worker/replica:0/task:47/cpu:0, /job:worker/replica:0/task:48/cpu:0, /job:worker/replica:0/task:49/cpu:0, /job:worker/replica:0/task:5/cpu:0, /job:worker/replica:0/task:50/cpu:0, /job:worker/replica:0/task:51/cpu:0, /job:worker/replica:0/task:52/cpu:0, /job:worker/replica:0/task:53/cpu:0, /job:worker/replica:0/task:54/cpu:0, /job:worker/replica:0/task:55/cpu:0, /job:worker/replica:0/task:56/cpu:0, /job:worker/replica:0/task:57/cpu:0, /job:worker/replica:0/task:58/cpu:0, /job:worker/replica:0/task:59/cpu:0, /job:worker/replica:0/task:6/cpu:0, /job:worker/replica:0/task:60/cpu:0, /job:worker/replica:0/task:61/cpu:0, /job:worker/replica:0/task:62/cpu:0, /job:worker/replica:0/task:63/cpu:0, /job:worker/replica:0/task:64/cpu:0, /job:worker/replica:0/task:65/cpu:0, /job:worker/replica:0/task:66/cpu:0, /job:worker/replica:0/task:67/cpu:0, /job:worker/replica:0/task:68/cpu:0, /job:worker/replica:0/task:69/cpu:0, /job:worker/replica:0/task:7/cpu:0, /job:worker/replica:0/task:70/cpu:0, /job:worker/replica:0/task:71/cpu:0, /job:worker/replica:0/task:72/cpu:0, /job:worker/replica:0/task:73/cpu:0, /job:worker/replica:0/task:74/cpu:0, /job:worker/replica:0/task:75/cpu:0, /job:worker/replica:0/task:76/cpu:0, /job:worker/replica:0/task:77/cpu:0, /job:worker/replica:0/task:78/cpu:0, /job:worker/replica:0/task:79/cpu:0, /job:worker/replica:0/task:8/cpu:0, /job:worker/replica:0/task:80/cpu:0, /job:worker/replica:0/task:81/cpu:0, /job:worker/replica:0/task:82/cpu:0, /job:worker/replica:0/task:83/cpu:0, /job:worker/replica:0/task:84/cpu:0, /job:worker/replica:0/task:85/cpu:0, /job:worker/replica:0/task:86/cpu:0, /job:worker/replica:0/task:87/cpu:0, /job:worker/replica:0/task:88/cpu:0, /job:worker/replica:0/task:89/cpu:0, /job:worker/replica:0/task:9/cpu:0, /job:worker/replica:0/task:90/cpu:0, /job:worker/replica:0/task:91/cpu:0, /job:worker/replica:0/task:92/cpu:0, /job:worker/replica:0/task:93/cpu:0, /job:worker/replica:0/task:94/cpu:0, /job:worker/replica:0/task:95/cpu:0, /job:worker/replica:0/task:96/cpu:0, /job:worker/replica:0/task:97/cpu:0, /job:worker/replica:0/task:98/cpu:0, /job:worker/replica:0/task:99/cpu:0\r\n     [[Node: save/RestoreV2_26 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:ps/task:4/device:CPU:0\"](save/Const, save/RestoreV2_26/tensor_names, save/RestoreV2_26/shape_and_slices)]]\r\n\r\nCaused by op u'save/RestoreV2_26', defined at:\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\r\n    train().start(unused_args=unused_argv)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/yarn_bootstrap.py\", line 94, in start\r\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\r\n    distribution_training.run_training(server.target, cluster_spec, task_id)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000116/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\r\n    max_steps=train_max_steps\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 297, in _monitored_train\r\n    hooks=all_hooks) as super_sess:\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 447, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 618, in __init__\r\n    _WrappedSession.__init__(self, self._sess_creator.create_session())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 505, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 372, in create_session\r\n    self._scaffold.finalize()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 163, in finalize\r\n    self._saver.build()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1030, in build\r\n    restore_sequentially=self._restore_sequentially)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 620, in build\r\n    restore_sequentially, reshape)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 404, in _AddShardedRestoreOps\r\n    name=\"restore_shard\"))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 361, in _AddRestoreOps\r\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 200, in restore_op\r\n    [spec.tensor.dtype])[0])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 441, in restore_v2\r\n    dtypes=dtypes, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'save/RestoreV2_26': Could not satisfy explicit device specification '/job:ps/task:4/device:CPU:0' because no devices matching that specification are registered in this process; available devices: /job:ps/replica:0/task:0/cpu:0, /job:ps/replica:0/task:1/cpu:0, /job:ps/replica:0/task:10/cpu:0, /job:ps/replica:0/task:11/cpu:0, /job:ps/replica:0/task:12/cpu:0, /job:ps/replica:0/task:13/cpu:0, /job:ps/replica:0/task:14/cpu:0, /job:ps/replica:0/task:15/cpu:0, /job:ps/replica:0/task:2/cpu:0, /job:ps/replica:0/task:3/cpu:0, /job:ps/replica:0/task:5/cpu:0, /job:ps/replica:0/task:6/cpu:0, /job:ps/replica:0/task:7/cpu:0, /job:ps/replica:0/task:8/cpu:0, /job:ps/replica:0/task:9/cpu:0, /job:worker/replica:0/task:0/cpu:0, /job:worker/replica:0/task:1/cpu:0, /job:worker/replica:0/task:10/cpu:0, /job:worker/replica:0/task:11/cpu:0, /job:worker/replica:0/task:12/cpu:0, /job:worker/replica:0/task:13/cpu:0, /job:worker/replica:0/task:14/cpu:0, /job:worker/replica:0/task:15/cpu:0, /job:worker/replica:0/task:16/cpu:0, /job:worker/replica:0/task:17/cpu:0, /job:worker/replica:0/task:18/cpu:0, /job:worker/replica:0/task:19/cpu:0, /job:worker/replica:0/task:2/cpu:0, /job:worker/replica:0/task:20/cpu:0, /job:worker/replica:0/task:21/cpu:0, /job:worker/replica:0/task:22/cpu:0, /job:worker/replica:0/task:23/cpu:0, /job:worker/replica:0/task:24/cpu:0, /job:worker/replica:0/task:25/cpu:0, /job:worker/replica:0/task:26/cpu:0, /job:worker/replica:0/task:27/cpu:0, /job:worker/replica:0/task:28/cpu:0, /job:worker/replica:0/task:29/cpu:0, /job:worker/replica:0/task:3/cpu:0, /job:worker/replica:0/task:30/cpu:0, /job:worker/replica:0/task:31/cpu:0, /job:worker/replica:0/task:32/cpu:0, /job:worker/replica:0/task:33/cpu:0, /job:worker/replica:0/task:34/cpu:0, /job:worker/replica:0/task:35/cpu:0, /job:worker/replica:0/task:36/cpu:0, /job:worker/replica:0/task:37/cpu:0, /job:worker/replica:0/task:38/cpu:0, /job:worker/replica:0/task:39/cpu:0, /job:worker/replica:0/task:4/cpu:0, /job:worker/replica:0/task:40/cpu:0, /job:worker/replica:0/task:41/cpu:0, /job:worker/replica:0/task:42/cpu:0, /job:worker/replica:0/task:43/cpu:0, /job:worker/replica:0/task:44/cpu:0, /job:worker/replica:0/task:45/cpu:0, /job:worker/replica:0/task:46/cpu:0, /job:worker/replica:0/task:47/cpu:0, /job:worker/replica:0/task:48/cpu:0, /job:worker/replica:0/task:49/cpu:0, /job:worker/replica:0/task:5/cpu:0, /job:worker/replica:0/task:50/cpu:0, /job:worker/replica:0/task:51/cpu:0, /job:worker/replica:0/task:52/cpu:0, /job:worker/replica:0/task:53/cpu:0, /job:worker/replica:0/task:54/cpu:0, /job:worker/replica:0/task:55/cpu:0, /job:worker/replica:0/task:56/cpu:0, /job:worker/replica:0/task:57/cpu:0, /job:worker/replica:0/task:58/cpu:0, /job:worker/replica:0/task:59/cpu:0, /job:worker/replica:0/task:6/cpu:0, /job:worker/replica:0/task:60/cpu:0, /job:worker/replica:0/task:61/cpu:0, /job:worker/replica:0/task:62/cpu:0, /job:worker/replica:0/task:63/cpu:0, /job:worker/replica:0/task:64/cpu:0, /job:worker/replica:0/task:65/cpu:0, /job:worker/replica:0/task:66/cpu:0, /job:worker/replica:0/task:67/cpu:0, /job:worker/replica:0/task:68/cpu:0, /job:worker/replica:0/task:69/cpu:0, /job:worker/replica:0/task:7/cpu:0, /job:worker/replica:0/task:70/cpu:0, /job:worker/replica:0/task:71/cpu:0, /job:worker/replica:0/task:72/cpu:0, /job:worker/replica:0/task:73/cpu:0, /job:worker/replica:0/task:74/cpu:0, /job:worker/replica:0/task:75/cpu:0, /job:worker/replica:0/task:76/cpu:0, /job:worker/replica:0/task:77/cpu:0, /job:worker/replica:0/task:78/cpu:0, /job:worker/replica:0/task:79/cpu:0, /job:worker/replica:0/task:8/cpu:0, /job:worker/replica:0/task:80/cpu:0, /job:worker/replica:0/task:81/cpu:0, /job:worker/replica:0/task:82/cpu:0, /job:worker/replica:0/task:83/cpu:0, /job:worker/replica:0/task:84/cpu:0, /job:worker/replica:0/task:85/cpu:0, /job:worker/replica:0/task:86/cpu:0, /job:worker/replica:0/task:87/cpu:0, /job:worker/replica:0/task:88/cpu:0, /job:worker/replica:0/task:89/cpu:0, /job:worker/replica:0/task:9/cpu:0, /job:worker/replica:0/task:90/cpu:0, /job:worker/replica:0/task:91/cpu:0, /job:worker/replica:0/task:92/cpu:0, /job:worker/replica:0/task:93/cpu:0, /job:worker/replica:0/task:94/cpu:0, /job:worker/replica:0/task:95/cpu:0, /job:worker/replica:0/task:96/cpu:0, /job:worker/replica:0/task:97/cpu:0, /job:worker/replica:0/task:98/cpu:0, /job:worker/replica:0/task:99/cpu:0\r\n     [[Node: save/RestoreV2_26 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:ps/task:4/device:CPU:0\"](save/Const, save/RestoreV2_26/tensor_names, save/RestoreV2_26/shape_and_slices)]]\r\n```\r\n\r\n```\r\nINFO:tensorflow:loss = 5.55723, step = 1431908\r\nE tensorflow/core/distributed_runtime/master_session.cc:1372] Cleanup partition error: Unavailable: {\"created\":\"@1484095048.299027908\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\r\nTraceback (most recent call last):\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 42, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 43, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 38, in main\r\n    train().start(unused_args=unused_argv)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/yarn_bootstrap.py\", line 94, in start\r\n    self.worker_do(server, cluster_spec, FLAGS.task_index)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/train_on_yarn.py\", line 27, in worker_do\r\n    distribution_training.run_training(server.target, cluster_spec, task_id)\r\n  File \"/dump/11/nm-local-dir/usercache/admin/appcache/application_1477026424983_244601/container_e04_1477026424983_244601_01_000123/app/install/learning_to_match/bootstrap/../train/distribution_training.py\", line 62, in run_training\r\n    max_steps=train_max_steps\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\r\n    max_steps=max_steps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\r\n    None)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 766, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 964, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1484095048.299027908\",\"description\":\"EOF\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":235,\"grpc_status\":14}\r\n```"}