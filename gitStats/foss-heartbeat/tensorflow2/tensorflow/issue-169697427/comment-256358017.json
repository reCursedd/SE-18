{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/256358017", "html_url": "https://github.com/tensorflow/tensorflow/pull/3672#issuecomment-256358017", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3672", "id": 256358017, "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjM1ODAxNw==", "user": {"login": "mohamedadaly", "id": 3480703, "node_id": "MDQ6VXNlcjM0ODA3MDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/3480703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mohamedadaly", "html_url": "https://github.com/mohamedadaly", "followers_url": "https://api.github.com/users/mohamedadaly/followers", "following_url": "https://api.github.com/users/mohamedadaly/following{/other_user}", "gists_url": "https://api.github.com/users/mohamedadaly/gists{/gist_id}", "starred_url": "https://api.github.com/users/mohamedadaly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mohamedadaly/subscriptions", "organizations_url": "https://api.github.com/users/mohamedadaly/orgs", "repos_url": "https://api.github.com/users/mohamedadaly/repos", "events_url": "https://api.github.com/users/mohamedadaly/events{/privacy}", "received_events_url": "https://api.github.com/users/mohamedadaly/received_events", "type": "User", "site_admin": false}, "created_at": "2016-10-26T14:06:43Z", "updated_at": "2016-10-26T14:06:43Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The current gradient seems to have a problem when <code>batches</code> is <code>None</code> i.e. when using a variable size batches using Keras. Simply added this line</p>\n<div class=\"highlight highlight-source-python\"><pre>  batch_size <span class=\"pl-k\">=</span> array_ops.shape(op.inputs[<span class=\"pl-c1\">0</span>])[<span class=\"pl-c1\">0</span>]</pre></div>\n<p>after this</p>\n<div class=\"highlight highlight-source-python\"><pre>  batch_size, rows_in, cols_in, channels <span class=\"pl-k\">=</span> [\n    dim.value <span class=\"pl-k\">for</span> dim <span class=\"pl-k\">in</span> op.inputs[<span class=\"pl-c1\">0</span>].get_shape()\n  ]</pre></div>\n<p>and it seems to have fixed the problem. I am new to TensorFlow, so you probably have a better solution than this.</p>", "body_text": "The current gradient seems to have a problem when batches is None i.e. when using a variable size batches using Keras. Simply added this line\n  batch_size = array_ops.shape(op.inputs[0])[0]\nafter this\n  batch_size, rows_in, cols_in, channels = [\n    dim.value for dim in op.inputs[0].get_shape()\n  ]\nand it seems to have fixed the problem. I am new to TensorFlow, so you probably have a better solution than this.", "body": "The current gradient seems to have a problem when `batches` is `None` i.e. when using a variable size batches using Keras. Simply added this line\n\n``` python\n  batch_size = array_ops.shape(op.inputs[0])[0]\n```\n\nafter this\n\n``` python\n  batch_size, rows_in, cols_in, channels = [\n    dim.value for dim in op.inputs[0].get_shape()\n  ]\n```\n\nand it seems to have fixed the problem. I am new to TensorFlow, so you probably have a better solution than this.\n"}