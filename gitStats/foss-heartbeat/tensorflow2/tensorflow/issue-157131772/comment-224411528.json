{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/224411528", "html_url": "https://github.com/tensorflow/tensorflow/issues/2531#issuecomment-224411528", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2531", "id": 224411528, "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDQxMTUyOA==", "user": {"login": "TianweiXing", "id": 17885178, "node_id": "MDQ6VXNlcjE3ODg1MTc4", "avatar_url": "https://avatars1.githubusercontent.com/u/17885178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TianweiXing", "html_url": "https://github.com/TianweiXing", "followers_url": "https://api.github.com/users/TianweiXing/followers", "following_url": "https://api.github.com/users/TianweiXing/following{/other_user}", "gists_url": "https://api.github.com/users/TianweiXing/gists{/gist_id}", "starred_url": "https://api.github.com/users/TianweiXing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TianweiXing/subscriptions", "organizations_url": "https://api.github.com/users/TianweiXing/orgs", "repos_url": "https://api.github.com/users/TianweiXing/repos", "events_url": "https://api.github.com/users/TianweiXing/events{/privacy}", "received_events_url": "https://api.github.com/users/TianweiXing/received_events", "type": "User", "site_admin": false}, "created_at": "2016-06-07T20:55:38Z", "updated_at": "2016-06-07T20:55:38Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=161459\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/petewarden\">@petewarden</a><br>\nYes, I save the graphdef using freez_graph. However, when making inference using the graphdef, it requires float_ref. The freez_graph seems just store the variables to variables, not really \"freeze\" the graph and change the variable values to constant...</p>\n<p>So, I just use tf.train.write_graph to save a graphdef file.</p>\n<pre><code>    for v in tf.trainable_variables():\n        vc = tf.constant(v.eval())\n        tf.assign(v, vc, name=\"tf_weights\")\n    tf.train.write_graph(sess.graph_def, export_path, 'graph_def.pb', as_text=False)\n</code></pre>\n<p>Is this a good way to store graph for using in c++?</p>\n<p>Thanks</p>", "body_text": "@petewarden\nYes, I save the graphdef using freez_graph. However, when making inference using the graphdef, it requires float_ref. The freez_graph seems just store the variables to variables, not really \"freeze\" the graph and change the variable values to constant...\nSo, I just use tf.train.write_graph to save a graphdef file.\n    for v in tf.trainable_variables():\n        vc = tf.constant(v.eval())\n        tf.assign(v, vc, name=\"tf_weights\")\n    tf.train.write_graph(sess.graph_def, export_path, 'graph_def.pb', as_text=False)\n\nIs this a good way to store graph for using in c++?\nThanks", "body": "@petewarden \nYes, I save the graphdef using freez_graph. However, when making inference using the graphdef, it requires float_ref. The freez_graph seems just store the variables to variables, not really \"freeze\" the graph and change the variable values to constant...\n\nSo, I just use tf.train.write_graph to save a graphdef file.\n\n```\n    for v in tf.trainable_variables():\n        vc = tf.constant(v.eval())\n        tf.assign(v, vc, name=\"tf_weights\")\n    tf.train.write_graph(sess.graph_def, export_path, 'graph_def.pb', as_text=False)\n```\n\nIs this a good way to store graph for using in c++?\n\nThanks\n"}