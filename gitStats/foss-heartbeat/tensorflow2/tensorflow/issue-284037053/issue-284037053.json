{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15568", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15568/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15568/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15568/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15568", "id": 284037053, "node_id": "MDU6SXNzdWUyODQwMzcwNTM=", "number": 15568, "title": "InvalidArgumentError: slice index 0 of dimension 0 out of bounds.", "user": {"login": "AziziShekoofeh", "id": 8812771, "node_id": "MDQ6VXNlcjg4MTI3NzE=", "avatar_url": "https://avatars2.githubusercontent.com/u/8812771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AziziShekoofeh", "html_url": "https://github.com/AziziShekoofeh", "followers_url": "https://api.github.com/users/AziziShekoofeh/followers", "following_url": "https://api.github.com/users/AziziShekoofeh/following{/other_user}", "gists_url": "https://api.github.com/users/AziziShekoofeh/gists{/gist_id}", "starred_url": "https://api.github.com/users/AziziShekoofeh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AziziShekoofeh/subscriptions", "organizations_url": "https://api.github.com/users/AziziShekoofeh/orgs", "repos_url": "https://api.github.com/users/AziziShekoofeh/repos", "events_url": "https://api.github.com/users/AziziShekoofeh/events{/privacy}", "received_events_url": "https://api.github.com/users/AziziShekoofeh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-12-21T23:52:52Z", "updated_at": "2018-09-03T11:12:50Z", "closed_at": "2018-01-31T02:18:22Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<h3>Describe the problem</h3>\n<p>I am trying to encode and decode an image using tf.image.decode_jpeg and b64 encoding. The code is so simple but it seems I have an error regarding StrideSlice. I am not sure if the problem coming from the undefined shape of input placeholder or related to jpeg_decode.  Thanks.</p>\n<h3>Source code / logs</h3>\n<pre><code>import tensorflow as tf\nimport base64\nimport functools\n\n\ndef build_graph(input_len=None):\n    graph = tf.Graph()\n    with graph.as_default():\n        image_bytes = tf.placeholder(tf.string, name='input_node')\n        images = tf.map_fn(\n            functools.partial(tf.image.decode_jpeg, channels=3),\n            image_bytes,\n            dtype=tf.uint8\n        )\n        image_floats = tf.cast(images, tf.float32, name=\"output_node\") / 255.0\n\n    return graph\n\n\nif __name__ == '__main__':\n    file_name = \"test_1.jpg\"\n    with open(file_name, \"rb\") as imageFile:\n        image_string = imageFile.read()\n        image_encode = base64.b64encode(image_string).decode(\"utf-8\")\n\n    graph = build_graph(input_len=len(image_encode))\n\n    with tf.Session(graph=graph) as session:\n        init_op = tf.group(tf.global_variables_initializer(),\n                           tf.local_variables_initializer())\n        session.run(init_op)\n        input_node = graph.get_tensor_by_name(\"input_node:0\")\n        output_node = graph.get_tensor_by_name(\"output_node:0\")\n        image_out = session.run(output_node, feed_dict={input_node: image_encode})\n</code></pre>\n<p>These is the traceback:</p>\n<pre><code>Caused by op u'map/TensorArrayUnstack/strided_slice', defined at:\n  File \"/.../Simple_Graph_Design/ImageTest.py\", line 26, in &lt;module&gt;\n    graph = build_graph(input_len=len(image_encode))\n  File \"/.../Simple_Graph_Design/ImageTest.py\", line 13, in build_graph\n    dtype=tf.uint8\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/functional_ops.py\", line 354, in map_fn\n    elem_ta.unstack(elem) for elem_ta, elem in zip(elems_ta, elems_flat)]\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\n    return _add_should_use_warning(fn(*args, **kwargs))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/tensor_array_ops.py\", line 412, in unstack\n    num_elements = array_ops.shape(value)[0]\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 538, in _SliceHelper\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 706, in strided_slice\n    shrink_axis_mask=shrink_axis_mask)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 5430, in strided_slice\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): slice index 0 of dimension 0 out of bounds.\n\t [[Node: map/TensorArrayUnstack/strided_slice = StridedSlice[Index=DT_INT32, T=DT_INT32, begin_mask=0, ellipsis_mask=0, end_mask=0, new_axis_mask=0, shrink_axis_mask=1, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](map/TensorArrayUnstack/Shape, map/TensorArrayUnstack/strided_slice/stack, map/TensorArrayUnstack/strided_slice/stack_1, map/TensorArrayUnstack/strided_slice/stack_1)]]\n\n</code></pre>\n<h3>System information</h3>\n<ul>\n<li>TF version: 1.4.0</li>\n<li>Linux Ubuntu 16.04</li>\n<li>Python version: 2.7</li>\n<li>No CUDA or GPU</li>\n</ul>", "body_text": "Hi,\nDescribe the problem\nI am trying to encode and decode an image using tf.image.decode_jpeg and b64 encoding. The code is so simple but it seems I have an error regarding StrideSlice. I am not sure if the problem coming from the undefined shape of input placeholder or related to jpeg_decode.  Thanks.\nSource code / logs\nimport tensorflow as tf\nimport base64\nimport functools\n\n\ndef build_graph(input_len=None):\n    graph = tf.Graph()\n    with graph.as_default():\n        image_bytes = tf.placeholder(tf.string, name='input_node')\n        images = tf.map_fn(\n            functools.partial(tf.image.decode_jpeg, channels=3),\n            image_bytes,\n            dtype=tf.uint8\n        )\n        image_floats = tf.cast(images, tf.float32, name=\"output_node\") / 255.0\n\n    return graph\n\n\nif __name__ == '__main__':\n    file_name = \"test_1.jpg\"\n    with open(file_name, \"rb\") as imageFile:\n        image_string = imageFile.read()\n        image_encode = base64.b64encode(image_string).decode(\"utf-8\")\n\n    graph = build_graph(input_len=len(image_encode))\n\n    with tf.Session(graph=graph) as session:\n        init_op = tf.group(tf.global_variables_initializer(),\n                           tf.local_variables_initializer())\n        session.run(init_op)\n        input_node = graph.get_tensor_by_name(\"input_node:0\")\n        output_node = graph.get_tensor_by_name(\"output_node:0\")\n        image_out = session.run(output_node, feed_dict={input_node: image_encode})\n\nThese is the traceback:\nCaused by op u'map/TensorArrayUnstack/strided_slice', defined at:\n  File \"/.../Simple_Graph_Design/ImageTest.py\", line 26, in <module>\n    graph = build_graph(input_len=len(image_encode))\n  File \"/.../Simple_Graph_Design/ImageTest.py\", line 13, in build_graph\n    dtype=tf.uint8\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/functional_ops.py\", line 354, in map_fn\n    elem_ta.unstack(elem) for elem_ta, elem in zip(elems_ta, elems_flat)]\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\n    return _add_should_use_warning(fn(*args, **kwargs))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/tensor_array_ops.py\", line 412, in unstack\n    num_elements = array_ops.shape(value)[0]\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 538, in _SliceHelper\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 706, in strided_slice\n    shrink_axis_mask=shrink_axis_mask)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 5430, in strided_slice\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): slice index 0 of dimension 0 out of bounds.\n\t [[Node: map/TensorArrayUnstack/strided_slice = StridedSlice[Index=DT_INT32, T=DT_INT32, begin_mask=0, ellipsis_mask=0, end_mask=0, new_axis_mask=0, shrink_axis_mask=1, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](map/TensorArrayUnstack/Shape, map/TensorArrayUnstack/strided_slice/stack, map/TensorArrayUnstack/strided_slice/stack_1, map/TensorArrayUnstack/strided_slice/stack_1)]]\n\n\nSystem information\n\nTF version: 1.4.0\nLinux Ubuntu 16.04\nPython version: 2.7\nNo CUDA or GPU", "body": "Hi,\r\n\r\n### Describe the problem\r\nI am trying to encode and decode an image using tf.image.decode_jpeg and b64 encoding. The code is so simple but it seems I have an error regarding StrideSlice. I am not sure if the problem coming from the undefined shape of input placeholder or related to jpeg_decode.  Thanks. \r\n\r\n### Source code / logs\r\n```\r\nimport tensorflow as tf\r\nimport base64\r\nimport functools\r\n\r\n\r\ndef build_graph(input_len=None):\r\n    graph = tf.Graph()\r\n    with graph.as_default():\r\n        image_bytes = tf.placeholder(tf.string, name='input_node')\r\n        images = tf.map_fn(\r\n            functools.partial(tf.image.decode_jpeg, channels=3),\r\n            image_bytes,\r\n            dtype=tf.uint8\r\n        )\r\n        image_floats = tf.cast(images, tf.float32, name=\"output_node\") / 255.0\r\n\r\n    return graph\r\n\r\n\r\nif __name__ == '__main__':\r\n    file_name = \"test_1.jpg\"\r\n    with open(file_name, \"rb\") as imageFile:\r\n        image_string = imageFile.read()\r\n        image_encode = base64.b64encode(image_string).decode(\"utf-8\")\r\n\r\n    graph = build_graph(input_len=len(image_encode))\r\n\r\n    with tf.Session(graph=graph) as session:\r\n        init_op = tf.group(tf.global_variables_initializer(),\r\n                           tf.local_variables_initializer())\r\n        session.run(init_op)\r\n        input_node = graph.get_tensor_by_name(\"input_node:0\")\r\n        output_node = graph.get_tensor_by_name(\"output_node:0\")\r\n        image_out = session.run(output_node, feed_dict={input_node: image_encode})\r\n```\r\n\r\nThese is the traceback:\r\n\r\n```\r\nCaused by op u'map/TensorArrayUnstack/strided_slice', defined at:\r\n  File \"/.../Simple_Graph_Design/ImageTest.py\", line 26, in <module>\r\n    graph = build_graph(input_len=len(image_encode))\r\n  File \"/.../Simple_Graph_Design/ImageTest.py\", line 13, in build_graph\r\n    dtype=tf.uint8\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/functional_ops.py\", line 354, in map_fn\r\n    elem_ta.unstack(elem) for elem_ta, elem in zip(elems_ta, elems_flat)]\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\r\n    return _add_should_use_warning(fn(*args, **kwargs))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/tensor_array_ops.py\", line 412, in unstack\r\n    num_elements = array_ops.shape(value)[0]\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 538, in _SliceHelper\r\n    name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 706, in strided_slice\r\n    shrink_axis_mask=shrink_axis_mask)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 5430, in strided_slice\r\n    name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): slice index 0 of dimension 0 out of bounds.\r\n\t [[Node: map/TensorArrayUnstack/strided_slice = StridedSlice[Index=DT_INT32, T=DT_INT32, begin_mask=0, ellipsis_mask=0, end_mask=0, new_axis_mask=0, shrink_axis_mask=1, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](map/TensorArrayUnstack/Shape, map/TensorArrayUnstack/strided_slice/stack, map/TensorArrayUnstack/strided_slice/stack_1, map/TensorArrayUnstack/strided_slice/stack_1)]]\r\n\r\n```\r\n### System information\r\n- TF version: 1.4.0\r\n- Linux Ubuntu 16.04\r\n- Python version: 2.7\r\n- No CUDA or GPU \r\n\r\n\r\n\r\n\r\n"}