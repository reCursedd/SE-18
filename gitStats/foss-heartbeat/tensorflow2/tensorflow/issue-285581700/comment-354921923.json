{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/354921923", "html_url": "https://github.com/tensorflow/tensorflow/pull/15801#issuecomment-354921923", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15801", "id": 354921923, "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDkyMTkyMw==", "user": {"login": "vnavkal", "id": 5924638, "node_id": "MDQ6VXNlcjU5MjQ2Mzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/5924638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnavkal", "html_url": "https://github.com/vnavkal", "followers_url": "https://api.github.com/users/vnavkal/followers", "following_url": "https://api.github.com/users/vnavkal/following{/other_user}", "gists_url": "https://api.github.com/users/vnavkal/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnavkal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnavkal/subscriptions", "organizations_url": "https://api.github.com/users/vnavkal/orgs", "repos_url": "https://api.github.com/users/vnavkal/repos", "events_url": "https://api.github.com/users/vnavkal/events{/privacy}", "received_events_url": "https://api.github.com/users/vnavkal/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-03T01:49:21Z", "updated_at": "2018-01-03T01:49:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p>If desired, I could also make some other simplifications to the code that calculates the gradient when <code>compute_uv=False</code>:</p>\n<ol>\n<li>Remove the conditional on <code>use_adjoint</code>: the formula is really the same whether <code>use_adjoint</code> is <code>True</code> or <code>False</code>.</li>\n<li>Move it outside the <code>with ops.control_dependencies([grad_s, grad_u, grad_v])</code> block, perhaps to a new <code>with ops.control_dependencies([grad_s])</code> block.  (It doesn't use <code>grad_u</code> or <code>grad_v</code>.)  It's not clear to me why <code>ops.control_dependencies</code> is needed here at all, though, so I won't do this unless someone else confirms that it makes sense to do it.</li>\n</ol>", "body_text": "If desired, I could also make some other simplifications to the code that calculates the gradient when compute_uv=False:\n\nRemove the conditional on use_adjoint: the formula is really the same whether use_adjoint is True or False.\nMove it outside the with ops.control_dependencies([grad_s, grad_u, grad_v]) block, perhaps to a new with ops.control_dependencies([grad_s]) block.  (It doesn't use grad_u or grad_v.)  It's not clear to me why ops.control_dependencies is needed here at all, though, so I won't do this unless someone else confirms that it makes sense to do it.", "body": "If desired, I could also make some other simplifications to the code that calculates the gradient when `compute_uv=False`:\r\n1. Remove the conditional on `use_adjoint`: the formula is really the same whether `use_adjoint` is `True` or `False`.\r\n2. Move it outside the `with ops.control_dependencies([grad_s, grad_u, grad_v])` block, perhaps to a new `with ops.control_dependencies([grad_s])` block.  (It doesn't use `grad_u` or `grad_v`.)  It's not clear to me why `ops.control_dependencies` is needed here at all, though, so I won't do this unless someone else confirms that it makes sense to do it."}