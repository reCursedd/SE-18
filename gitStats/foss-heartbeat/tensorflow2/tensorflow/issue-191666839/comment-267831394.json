{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/267831394", "html_url": "https://github.com/tensorflow/tensorflow/issues/5853#issuecomment-267831394", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5853", "id": 267831394, "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzgzMTM5NA==", "user": {"login": "jramapuram", "id": 8204807, "node_id": "MDQ6VXNlcjgyMDQ4MDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/8204807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jramapuram", "html_url": "https://github.com/jramapuram", "followers_url": "https://api.github.com/users/jramapuram/followers", "following_url": "https://api.github.com/users/jramapuram/following{/other_user}", "gists_url": "https://api.github.com/users/jramapuram/gists{/gist_id}", "starred_url": "https://api.github.com/users/jramapuram/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jramapuram/subscriptions", "organizations_url": "https://api.github.com/users/jramapuram/orgs", "repos_url": "https://api.github.com/users/jramapuram/repos", "events_url": "https://api.github.com/users/jramapuram/events{/privacy}", "received_events_url": "https://api.github.com/users/jramapuram/received_events", "type": "User", "site_admin": false}, "created_at": "2016-12-18T16:40:22Z", "updated_at": "2016-12-18T16:40:22Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23431488\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/paul-the-noob\">@paul-the-noob</a> : looks like this is because of the usage of float64? This works for me:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n\n<span class=\"pl-k\">with</span> tf.device(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/gpu:0<span class=\"pl-pds\">'</span></span>):\n    <span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>tf.ConfigProto(<span class=\"pl-v\">allow_soft_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">False</span>)) <span class=\"pl-k\">as</span> sess:\n        M <span class=\"pl-k\">=</span> tf.SparseTensor(np.arange(<span class=\"pl-c1\">4</span>, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>np.float32).reshape(<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>),\n                            np.ones((<span class=\"pl-c1\">2</span>,), <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>np.float32),\n                            np.array((<span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">4</span>), <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>np.int32))\n        v <span class=\"pl-k\">=</span> tf.constant(np.ones((<span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">1</span>), <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>np.float32))\n        p <span class=\"pl-k\">=</span> tf.sparse_tensor_dense_matmul(M, v)\n\n        init <span class=\"pl-k\">=</span> tf.initialize_all_variables()\n        sess <span class=\"pl-k\">=</span> tf.Session()\n        sess.run(init)\n        <span class=\"pl-c1\">print</span> sess.run(p)</pre></div>\n<div class=\"highlight highlight-source-shell\"><pre>I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -<span class=\"pl-k\">&gt;</span> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\nWARNING:tensorflow:From <span class=\"pl-k\">&lt;</span>ipython-input-3-ddf78d11c31f<span class=\"pl-k\">&gt;</span>:12 <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\nInstructions <span class=\"pl-k\">for</span> updating:\nUse <span class=\"pl-s\"><span class=\"pl-pds\">`</span>tf.global_variables_initializer<span class=\"pl-pds\">`</span></span> instead.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -<span class=\"pl-k\">&gt;</span> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\n[[ 1.]\n [ 0.]\n [ 1.]\n [ 0.]]</pre></div>", "body_text": "@paul-the-noob : looks like this is because of the usage of float64? This works for me:\nimport tensorflow as tf\nimport numpy as np\n\nwith tf.device('/gpu:0'):\n    with tf.Session(config=tf.ConfigProto(allow_soft_placement=False)) as sess:\n        M = tf.SparseTensor(np.arange(4, dtype=np.float32).reshape(2, 2),\n                            np.ones((2,), dtype=np.float32),\n                            np.array((4, 4), dtype=np.int32))\n        v = tf.constant(np.ones((4, 1), dtype=np.float32))\n        p = tf.sparse_tensor_dense_matmul(M, v)\n\n        init = tf.initialize_all_variables()\n        sess = tf.Session()\n        sess.run(init)\n        print sess.run(p)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\nWARNING:tensorflow:From <ipython-input-3-ddf78d11c31f>:12 in <module>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\nInstructions for updating:\nUse `tf.global_variables_initializer` instead.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\n[[ 1.]\n [ 0.]\n [ 1.]\n [ 0.]]", "body": "@paul-the-noob : looks like this is because of the usage of float64? This works for me:\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nwith tf.device('/gpu:0'):\r\n    with tf.Session(config=tf.ConfigProto(allow_soft_placement=False)) as sess:\r\n        M = tf.SparseTensor(np.arange(4, dtype=np.float32).reshape(2, 2),\r\n                            np.ones((2,), dtype=np.float32),\r\n                            np.array((4, 4), dtype=np.int32))\r\n        v = tf.constant(np.ones((4, 1), dtype=np.float32))\r\n        p = tf.sparse_tensor_dense_matmul(M, v)\r\n\r\n        init = tf.initialize_all_variables()\r\n        sess = tf.Session()\r\n        sess.run(init)\r\n        print sess.run(p)\r\n```\r\n\r\n\r\n```bash\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\r\nWARNING:tensorflow:From <ipython-input-3-ddf78d11c31f>:12 in <module>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\r\nInstructions for updating:\r\nUse `tf.global_variables_initializer` instead.\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\r\n[[ 1.]\r\n [ 0.]\r\n [ 1.]\r\n [ 0.]]\r\n```"}