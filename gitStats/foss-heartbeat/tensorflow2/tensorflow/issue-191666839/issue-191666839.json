{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5853", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5853/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5853/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5853/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5853", "id": 191666839, "node_id": "MDU6SXNzdWUxOTE2NjY4Mzk=", "number": 5853, "title": "sparse_tensor_dense_matmul not working with float64 on gpu", "user": {"login": "paul-the-noob", "id": 23431488, "node_id": "MDQ6VXNlcjIzNDMxNDg4", "avatar_url": "https://avatars0.githubusercontent.com/u/23431488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paul-the-noob", "html_url": "https://github.com/paul-the-noob", "followers_url": "https://api.github.com/users/paul-the-noob/followers", "following_url": "https://api.github.com/users/paul-the-noob/following{/other_user}", "gists_url": "https://api.github.com/users/paul-the-noob/gists{/gist_id}", "starred_url": "https://api.github.com/users/paul-the-noob/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paul-the-noob/subscriptions", "organizations_url": "https://api.github.com/users/paul-the-noob/orgs", "repos_url": "https://api.github.com/users/paul-the-noob/repos", "events_url": "https://api.github.com/users/paul-the-noob/events{/privacy}", "received_events_url": "https://api.github.com/users/paul-the-noob/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "concretevitamin", "id": 592670, "node_id": "MDQ6VXNlcjU5MjY3MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/592670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/concretevitamin", "html_url": "https://github.com/concretevitamin", "followers_url": "https://api.github.com/users/concretevitamin/followers", "following_url": "https://api.github.com/users/concretevitamin/following{/other_user}", "gists_url": "https://api.github.com/users/concretevitamin/gists{/gist_id}", "starred_url": "https://api.github.com/users/concretevitamin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/concretevitamin/subscriptions", "organizations_url": "https://api.github.com/users/concretevitamin/orgs", "repos_url": "https://api.github.com/users/concretevitamin/repos", "events_url": "https://api.github.com/users/concretevitamin/events{/privacy}", "received_events_url": "https://api.github.com/users/concretevitamin/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "concretevitamin", "id": 592670, "node_id": "MDQ6VXNlcjU5MjY3MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/592670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/concretevitamin", "html_url": "https://github.com/concretevitamin", "followers_url": "https://api.github.com/users/concretevitamin/followers", "following_url": "https://api.github.com/users/concretevitamin/following{/other_user}", "gists_url": "https://api.github.com/users/concretevitamin/gists{/gist_id}", "starred_url": "https://api.github.com/users/concretevitamin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/concretevitamin/subscriptions", "organizations_url": "https://api.github.com/users/concretevitamin/orgs", "repos_url": "https://api.github.com/users/concretevitamin/repos", "events_url": "https://api.github.com/users/concretevitamin/events{/privacy}", "received_events_url": "https://api.github.com/users/concretevitamin/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2016-11-25T10:10:35Z", "updated_at": "2017-06-16T18:31:00Z", "closed_at": "2017-06-16T18:30:59Z", "author_association": "NONE", "body_html": "<p>tensorflow (I tried 0.11, 0.12 and master) claims sparse_tensor_dense_matmul be not supported on gpu, yet the docs</p>\n<p><a href=\"https://www.tensorflow.org/versions/r0.11/api_docs/python/sparse_ops.html#sparse_tensor_dense_matmul\" rel=\"nofollow\">https://www.tensorflow.org/versions/r0.11/api_docs/python/sparse_ops.html#sparse_tensor_dense_matmul</a></p>\n<p>and the fact that there is a source file</p>\n<p>tensorflow/core/kernels/sparse_tensor_dense_matmul_op_gpu.cu.cc</p>\n<p>which apparently gets compiled</p>\n<p>.cache/bazel/_bazel_panzer/eb98e8482caa36ec89e479cdd4c996e7/execroot/tensorflow/bazel-out/local_linux-py3-opt/bin/tensorflow/core/kernels/libsparse_tensor_dense_matmul_op_gpu.pic.lo</p>\n<p>suggest it should.</p>\n<p>############ example script</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\n\nwith tf.device('/gpu:0'):\n    M = tf.SparseTensor(np.arange(4).reshape(2, 2), np.ones((2,)), (3, 3))\n    v = tf.constant(np.ones((3, 1)))\n    p = tf.sparse_tensor_dense_matmul(M, v)\n\n    init = tf.initialize_all_variables()\n    sess = tf.Session()\n    sess.run(init)\n    p = sess.run (p)\n</code></pre>\n<p>############ output</p>\n<pre><code>panzer:~$ python3 sparse_tensor_dense_matmul.py\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally\nWARNING:tensorflow:From sparse_tensor_dense_matmul.py:9 in &lt;module&gt;.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\nInstructions for updating:\nUse `tf.global_variables_initializer` instead.\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.8095\npciBusID 0000:01:00.0\nTotal memory: 7.92GiB\nFree memory: 7.81GiB\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)\nTraceback (most recent call last):\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1021, in _do_call\n    return fn(*args)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 999, in _run_fn\n    self._extend_graph()\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1048, in _extend_graph\n    self._session, graph_def.SerializeToString(), status)\n  File \"/usr/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\n</code></pre>\n<p>During handling of the above exception, another exception occurred:</p>\n<pre><code>Traceback (most recent call last):\n  File \"sparse_tensor_dense_matmul.py\", line 11, in &lt;module&gt;\n    sess.run(init)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\n\nCaused by op 'SparseTensorDenseMatMul/SparseTensorDenseMatMul', defined at:\n  File \"sparse_tensor_dense_matmul.py\", line 7, in &lt;module&gt;\n    p = tf.sparse_tensor_dense_matmul(M, v)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/ops/sparse_ops.py\", line 1339, in sparse_tensor_dense_matmul\n    adjoint_b=adjoint_b)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_sparse_ops.py\", line 975, in _sparse_tensor_dense_mat_mul\n    adjoint_b=adjoint_b, name=name)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\n    op_def=op_def)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\n    self._traceback = _extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\n</code></pre>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nlinux (ubuntu 16.04)</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):<br>\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.44<br>\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.5.1.5</p>\n<p>If installed from source, provide</p>\n<ol>\n<li>\n<p>The commit hash (<code>git rev-parse HEAD</code>)<br>\n<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/e5d44ffa3d78271e2619c577f8240e530538bb61/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/e5d44ffa3d78271e2619c577f8240e530538bb61\"><tt>e5d44ff</tt></a></p>\n</li>\n<li>\n<p>The output of <code>bazel version</code><br>\nBuild label: 0.4.0<br>\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar<br>\nBuild time: Wed Nov 2 17:54:14 2016 (1478109254)<br>\nBuild timestamp: 1478109254<br>\nBuild timestamp as int: 1478109254</p>\n</li>\n</ol>", "body_text": "tensorflow (I tried 0.11, 0.12 and master) claims sparse_tensor_dense_matmul be not supported on gpu, yet the docs\nhttps://www.tensorflow.org/versions/r0.11/api_docs/python/sparse_ops.html#sparse_tensor_dense_matmul\nand the fact that there is a source file\ntensorflow/core/kernels/sparse_tensor_dense_matmul_op_gpu.cu.cc\nwhich apparently gets compiled\n.cache/bazel/_bazel_panzer/eb98e8482caa36ec89e479cdd4c996e7/execroot/tensorflow/bazel-out/local_linux-py3-opt/bin/tensorflow/core/kernels/libsparse_tensor_dense_matmul_op_gpu.pic.lo\nsuggest it should.\n############ example script\nimport tensorflow as tf\nimport numpy as np\n\nwith tf.device('/gpu:0'):\n    M = tf.SparseTensor(np.arange(4).reshape(2, 2), np.ones((2,)), (3, 3))\n    v = tf.constant(np.ones((3, 1)))\n    p = tf.sparse_tensor_dense_matmul(M, v)\n\n    init = tf.initialize_all_variables()\n    sess = tf.Session()\n    sess.run(init)\n    p = sess.run (p)\n\n############ output\npanzer:~$ python3 sparse_tensor_dense_matmul.py\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally\nWARNING:tensorflow:From sparse_tensor_dense_matmul.py:9 in <module>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\nInstructions for updating:\nUse `tf.global_variables_initializer` instead.\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.8095\npciBusID 0000:01:00.0\nTotal memory: 7.92GiB\nFree memory: 7.81GiB\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)\nTraceback (most recent call last):\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1021, in _do_call\n    return fn(*args)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 999, in _run_fn\n    self._extend_graph()\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1048, in _extend_graph\n    self._session, graph_def.SerializeToString(), status)\n  File \"/usr/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\n\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\n  File \"sparse_tensor_dense_matmul.py\", line 11, in <module>\n    sess.run(init)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 766, in run\n    run_metadata_ptr)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 964, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\n\nCaused by op 'SparseTensorDenseMatMul/SparseTensorDenseMatMul', defined at:\n  File \"sparse_tensor_dense_matmul.py\", line 7, in <module>\n    p = tf.sparse_tensor_dense_matmul(M, v)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/ops/sparse_ops.py\", line 1339, in sparse_tensor_dense_matmul\n    adjoint_b=adjoint_b)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_sparse_ops.py\", line 975, in _sparse_tensor_dense_mat_mul\n    adjoint_b=adjoint_b, name=name)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\n    op_def=op_def)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\n    self._traceback = _extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\n\nEnvironment info\nOperating System:\nlinux (ubuntu 16.04)\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.44\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.5.1.5\nIf installed from source, provide\n\n\nThe commit hash (git rev-parse HEAD)\ne5d44ff\n\n\nThe output of bazel version\nBuild label: 0.4.0\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Wed Nov 2 17:54:14 2016 (1478109254)\nBuild timestamp: 1478109254\nBuild timestamp as int: 1478109254", "body": "tensorflow (I tried 0.11, 0.12 and master) claims sparse_tensor_dense_matmul be not supported on gpu, yet the docs\r\n\r\nhttps://www.tensorflow.org/versions/r0.11/api_docs/python/sparse_ops.html#sparse_tensor_dense_matmul\r\n\r\nand the fact that there is a source file\r\n\r\ntensorflow/core/kernels/sparse_tensor_dense_matmul_op_gpu.cu.cc\r\n\r\nwhich apparently gets compiled\r\n\r\n.cache/bazel/_bazel_panzer/eb98e8482caa36ec89e479cdd4c996e7/execroot/tensorflow/bazel-out/local_linux-py3-opt/bin/tensorflow/core/kernels/libsparse_tensor_dense_matmul_op_gpu.pic.lo\r\n\r\nsuggest it should.\r\n\r\n############ example script\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nwith tf.device('/gpu:0'):\r\n    M = tf.SparseTensor(np.arange(4).reshape(2, 2), np.ones((2,)), (3, 3))\r\n    v = tf.constant(np.ones((3, 1)))\r\n    p = tf.sparse_tensor_dense_matmul(M, v)\r\n\r\n    init = tf.initialize_all_variables()\r\n    sess = tf.Session()\r\n    sess.run(init)\r\n    p = sess.run (p)\r\n```\r\n############ output\r\n```\r\npanzer:~$ python3 sparse_tensor_dense_matmul.py\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally\r\nWARNING:tensorflow:From sparse_tensor_dense_matmul.py:9 in <module>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\r\nInstructions for updating:\r\nUse `tf.global_variables_initializer` instead.\r\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:936] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\r\nname: GeForce GTX 1080\r\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.8095\r\npciBusID 0000:01:00.0\r\nTotal memory: 7.92GiB\r\nFree memory: 7.81GiB\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)\r\nTraceback (most recent call last):\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1021, in _do_call\r\n    return fn(*args)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 999, in _run_fn\r\n    self._extend_graph()\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1048, in _extend_graph\r\n    self._session, graph_def.SerializeToString(), status)\r\n  File \"/usr/lib/python3.5/contextlib.py\", line 66, in __exit__\r\n    next(self.gen)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\r\n```\r\nDuring handling of the above exception, another exception occurred:\r\n```\r\nTraceback (most recent call last):\r\n  File \"sparse_tensor_dense_matmul.py\", line 11, in <module>\r\n    sess.run(init)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 766, in run\r\n    run_metadata_ptr)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 964, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\r\n\r\nCaused by op 'SparseTensorDenseMatMul/SparseTensorDenseMatMul', defined at:\r\n  File \"sparse_tensor_dense_matmul.py\", line 7, in <module>\r\n    p = tf.sparse_tensor_dense_matmul(M, v)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/ops/sparse_ops.py\", line 1339, in sparse_tensor_dense_matmul\r\n    adjoint_b=adjoint_b)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_sparse_ops.py\", line 975, in _sparse_tensor_dense_mat_mul\r\n    adjoint_b=adjoint_b, name=name)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\r\n    op_def=op_def)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/home/panzer/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'SparseTensorDenseMatMul/SparseTensorDenseMatMul': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\n         [[Node: SparseTensorDenseMatMul/SparseTensorDenseMatMul = SparseTensorDenseMatMul[T=DT_DOUBLE, adjoint_a=false, adjoint_b=false, _device=\"/device:GPU:0\"](SparseTensor/indices, SparseTensor/values, SparseTensor/shape, Const)]]\r\n```\r\n\r\n### Environment info\r\nOperating System:\r\nlinux (ubuntu 16.04)\r\n\r\nInstalled version of CUDA and cuDNN: \r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.44\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudnn.so.5.1.5\r\n\r\nIf installed from source, provide \r\n\r\n1. The commit hash (`git rev-parse HEAD`)\r\ne5d44ffa3d78271e2619c577f8240e530538bb61\r\n\r\n2. The output of `bazel version`\r\nBuild label: 0.4.0\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Wed Nov 2 17:54:14 2016 (1478109254)\r\nBuild timestamp: 1478109254\r\nBuild timestamp as int: 1478109254\r\n\r\n"}