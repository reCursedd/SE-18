{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/216178156", "pull_request_review_id": 153600679, "id": 216178156, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjE3ODE1Ng==", "diff_hunk": "@@ -272,11 +275,16 @@ def __init__(self,\n         \"footer_bytes\", footer_bytes)\n     self._buffer_size = convert.optional_param_to_tensor(\n         \"buffer_size\", buffer_size, _DEFAULT_READER_BUFFER_SIZE_BYTES)\n+    self._compression_type = convert.optional_param_to_tensor(\n+        \"compression_type\",\n+        compression_type,\n+        argument_default=\"\",\n+        argument_dtype=dtypes.string)\n \n   def _as_variant_tensor(self):\n-    return gen_dataset_ops.fixed_length_record_dataset(\n+    return gen_dataset_ops.fixed_length_record_dataset_v2(", "path": "tensorflow/python/data/ops/readers.py", "position": null, "original_position": 31, "commit_id": "b3f02c5c030a1d3d2ca84c7b2d50740beb69eb9a", "original_commit_id": "8cfe7ed0d6b4c542e152661d0e4e3e4ffd7e94d8", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "body": "This potentially breaks [forward compatibility](https://www.tensorflow.org/guide/version_compat#backward_and_partial_forward_compatibility) for existing users of `FixedLengthRecordDataset`. To fix, we need to do two things:\r\n\r\n1. Detect when the `compression_type` is None (because all existing programs will have that property).\r\n2. When `compression_type` is None, keep generating the v1 op. The typical way to do this is:\r\n\r\n```python\r\nif self._compression_type is not None or compat.forward_compatible(2018, 9, 30):\r\n  # Use new code.\r\nelse: \r\n  # Use old code.\r\n```", "created_at": "2018-09-10T00:56:12Z", "updated_at": "2018-11-06T04:02:09Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/21861#discussion_r216178156", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21861", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/216178156"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/21861#discussion_r216178156"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21861"}}, "body_html": "<p>This potentially breaks <a href=\"https://www.tensorflow.org/guide/version_compat#backward_and_partial_forward_compatibility\" rel=\"nofollow\">forward compatibility</a> for existing users of <code>FixedLengthRecordDataset</code>. To fix, we need to do two things:</p>\n<ol>\n<li>Detect when the <code>compression_type</code> is None (because all existing programs will have that property).</li>\n<li>When <code>compression_type</code> is None, keep generating the v1 op. The typical way to do this is:</li>\n</ol>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">if</span> <span class=\"pl-c1\">self</span>._compression_type <span class=\"pl-k\">is</span> <span class=\"pl-k\">not</span> <span class=\"pl-c1\">None</span> <span class=\"pl-k\">or</span> compat.forward_compatible(<span class=\"pl-c1\">2018</span>, <span class=\"pl-c1\">9</span>, <span class=\"pl-c1\">30</span>):\n  <span class=\"pl-c\"><span class=\"pl-c\">#</span> Use new code.</span>\n<span class=\"pl-k\">else</span>: \n  <span class=\"pl-c\"><span class=\"pl-c\">#</span> Use old code.</span></pre></div>", "body_text": "This potentially breaks forward compatibility for existing users of FixedLengthRecordDataset. To fix, we need to do two things:\n\nDetect when the compression_type is None (because all existing programs will have that property).\nWhen compression_type is None, keep generating the v1 op. The typical way to do this is:\n\nif self._compression_type is not None or compat.forward_compatible(2018, 9, 30):\n  # Use new code.\nelse: \n  # Use old code."}