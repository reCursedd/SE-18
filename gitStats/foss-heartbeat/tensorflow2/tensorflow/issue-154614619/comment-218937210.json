{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/218937210", "html_url": "https://github.com/tensorflow/tensorflow/pull/2347#issuecomment-218937210", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2347", "id": 218937210, "node_id": "MDEyOklzc3VlQ29tbWVudDIxODkzNzIxMA==", "user": {"login": "davidzchen", "id": 5283042, "node_id": "MDQ6VXNlcjUyODMwNDI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5283042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidzchen", "html_url": "https://github.com/davidzchen", "followers_url": "https://api.github.com/users/davidzchen/followers", "following_url": "https://api.github.com/users/davidzchen/following{/other_user}", "gists_url": "https://api.github.com/users/davidzchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidzchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidzchen/subscriptions", "organizations_url": "https://api.github.com/users/davidzchen/orgs", "repos_url": "https://api.github.com/users/davidzchen/repos", "events_url": "https://api.github.com/users/davidzchen/events{/privacy}", "received_events_url": "https://api.github.com/users/davidzchen/received_events", "type": "User", "site_admin": false}, "created_at": "2016-05-13T02:27:09Z", "updated_at": "2016-05-13T02:27:09Z", "author_association": "MEMBER", "body_html": "<p>All of the targets that have this problem should be covered now.</p>\n<p>It seems that the problem is occurring when <a href=\"https://github.com/bazelbuild/bazel/blob/master/tools/cpp/osx_cc_wrapper.sh\">Bazel's cc_wrapper script</a> renames all the paths in the binary with the paths relative to the binary (since relpath in OS X doesn't really work). For these targets, the load commands in the binary end up being <a href=\"http://stackoverflow.com/questions/28324785/install-name-tool-cant-use-change-because-larger-updated-load-commands-do-not\" rel=\"nofollow\">larger after the renaming</a>, which would require relinking. The <code>-headerpad_max_install_names</code> flag would be needed to ensure there is enough room in the binary for the larger load statements.</p>\n<p>On that note, <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3721087\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/damienmg\">@damienmg</a>, do you think it would be a good idea to set <code>-headerpad</code> or <code>-headerpad_max_install_names</code> by default in <code>osx_cc_wrapper.sh</code> or should we just set the linkopt for targets that need them?</p>", "body_text": "All of the targets that have this problem should be covered now.\nIt seems that the problem is occurring when Bazel's cc_wrapper script renames all the paths in the binary with the paths relative to the binary (since relpath in OS X doesn't really work). For these targets, the load commands in the binary end up being larger after the renaming, which would require relinking. The -headerpad_max_install_names flag would be needed to ensure there is enough room in the binary for the larger load statements.\nOn that note, @damienmg, do you think it would be a good idea to set -headerpad or -headerpad_max_install_names by default in osx_cc_wrapper.sh or should we just set the linkopt for targets that need them?", "body": "All of the targets that have this problem should be covered now.\n\nIt seems that the problem is occurring when [Bazel's cc_wrapper script](https://github.com/bazelbuild/bazel/blob/master/tools/cpp/osx_cc_wrapper.sh) renames all the paths in the binary with the paths relative to the binary (since relpath in OS X doesn't really work). For these targets, the load commands in the binary end up being [larger after the renaming](http://stackoverflow.com/questions/28324785/install-name-tool-cant-use-change-because-larger-updated-load-commands-do-not), which would require relinking. The `-headerpad_max_install_names` flag would be needed to ensure there is enough room in the binary for the larger load statements.\n\nOn that note, @damienmg, do you think it would be a good idea to set `-headerpad` or `-headerpad_max_install_names` by default in `osx_cc_wrapper.sh` or should we just set the linkopt for targets that need them?\n"}