{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/353166800", "html_url": "https://github.com/tensorflow/tensorflow/pull/15109#issuecomment-353166800", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15109", "id": 353166800, "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzE2NjgwMA==", "user": {"login": "bowang", "id": 425637, "node_id": "MDQ6VXNlcjQyNTYzNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/425637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bowang", "html_url": "https://github.com/bowang", "followers_url": "https://api.github.com/users/bowang/followers", "following_url": "https://api.github.com/users/bowang/following{/other_user}", "gists_url": "https://api.github.com/users/bowang/gists{/gist_id}", "starred_url": "https://api.github.com/users/bowang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bowang/subscriptions", "organizations_url": "https://api.github.com/users/bowang/orgs", "repos_url": "https://api.github.com/users/bowang/repos", "events_url": "https://api.github.com/users/bowang/events{/privacy}", "received_events_url": "https://api.github.com/users/bowang/received_events", "type": "User", "site_admin": false}, "created_at": "2017-12-20T19:57:33Z", "updated_at": "2017-12-20T19:57:33Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16018\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/asimshankar\">@asimshankar</a> Here are some example code with/without <code>AUTO_REUSE</code></p>\n<p>Without <code>AUTO_REUSE</code></p>\n<pre><code>for i in range(num_gpus):\n  with tf.device('/gpu:%d' % i):\n    with tf.variable_scope('gpu', reuse=(i&gt;0)):\n      create_gpu_tower(i)\n</code></pre>\n<p>With <code>AUTO_REUSE</code></p>\n<pre><code>tf.get_variable_scope()._reuse = tf.AUTO_REUSE\nfor i in range(num_gpus):\n  with tf.device('/gpu:%d' % i):\n    create_gpu_tower(i)\n</code></pre>\n<p>By using <code>AUTO_REUSE</code>, we can avoid create the auxiliary scope <code>gpu</code>, which makes it easier and compatible with models created for a single GPU.</p>", "body_text": "@asimshankar Here are some example code with/without AUTO_REUSE\nWithout AUTO_REUSE\nfor i in range(num_gpus):\n  with tf.device('/gpu:%d' % i):\n    with tf.variable_scope('gpu', reuse=(i>0)):\n      create_gpu_tower(i)\n\nWith AUTO_REUSE\ntf.get_variable_scope()._reuse = tf.AUTO_REUSE\nfor i in range(num_gpus):\n  with tf.device('/gpu:%d' % i):\n    create_gpu_tower(i)\n\nBy using AUTO_REUSE, we can avoid create the auxiliary scope gpu, which makes it easier and compatible with models created for a single GPU.", "body": "@asimshankar Here are some example code with/without `AUTO_REUSE`\r\n\r\nWithout `AUTO_REUSE`\r\n```\r\nfor i in range(num_gpus):\r\n  with tf.device('/gpu:%d' % i):\r\n    with tf.variable_scope('gpu', reuse=(i>0)):\r\n      create_gpu_tower(i)\r\n```\r\n\r\nWith `AUTO_REUSE`\r\n```\r\ntf.get_variable_scope()._reuse = tf.AUTO_REUSE\r\nfor i in range(num_gpus):\r\n  with tf.device('/gpu:%d' % i):\r\n    create_gpu_tower(i)\r\n```\r\n\r\nBy using `AUTO_REUSE`, we can avoid create the auxiliary scope `gpu`, which makes it easier and compatible with models created for a single GPU."}