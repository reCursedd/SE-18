{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/393527962", "html_url": "https://github.com/tensorflow/tensorflow/issues/7051#issuecomment-393527962", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7051", "id": 393527962, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzUyNzk2Mg==", "user": {"login": "spacegoing", "id": 5180020, "node_id": "MDQ6VXNlcjUxODAwMjA=", "avatar_url": "https://avatars0.githubusercontent.com/u/5180020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spacegoing", "html_url": "https://github.com/spacegoing", "followers_url": "https://api.github.com/users/spacegoing/followers", "following_url": "https://api.github.com/users/spacegoing/following{/other_user}", "gists_url": "https://api.github.com/users/spacegoing/gists{/gist_id}", "starred_url": "https://api.github.com/users/spacegoing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spacegoing/subscriptions", "organizations_url": "https://api.github.com/users/spacegoing/orgs", "repos_url": "https://api.github.com/users/spacegoing/repos", "events_url": "https://api.github.com/users/spacegoing/events{/privacy}", "received_events_url": "https://api.github.com/users/spacegoing/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-31T13:22:04Z", "updated_at": "2018-05-31T13:23:52Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16824702\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/caisq\">@caisq</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=326106\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/aselle\">@aselle</a><br>\nIf you run <code>transformer_encoder</code> model from <code>tensor2tensor</code> repo: <a href=\"https://github.com/tensorflow/tensor2tensor#sentiment-analysis\">https://github.com/tensorflow/tensor2tensor#sentiment-analysis</a><br>\nwith tfdbg enabled, it will report:</p>\n<p><code>multiple devices with nodes named 'n/_78' but device_name is not specified</code></p>\n<p>My node has 4 v100 gpus. The script I use attached here:</p>\n<div class=\"highlight highlight-source-shell\"><pre><span class=\"pl-c\"><span class=\"pl-c\">#</span> t2t hparams</span>\nPROBLEM=sentiment_imdb\nMODEL=transformer_encoder\nHPARAMS=transformer_tiny\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> t2t dirs</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> MODEL-HPARAMS format is mandatory</span>\nPROJECT=/project/chli\nTRAIN_DIR=<span class=\"pl-smi\">$PROJECT</span>/<span class=\"pl-smi\">$MODEL</span>/t2t_train/<span class=\"pl-smi\">$PROBLEM</span>/<span class=\"pl-smi\">$MODEL</span>-<span class=\"pl-smi\">$HPARAMS</span>\nTMP_DIR=/tmp/t2t_datagen\nDATA_DIR=<span class=\"pl-smi\">$PROJECT</span>/<span class=\"pl-smi\">$MODEL</span>/t2t_data\n\nt2t-trainer \\\n  --data_dir=<span class=\"pl-smi\">$DATA_DIR</span> \\\n  --tmp_dir=<span class=\"pl-smi\">$TMP_DIR</span> \\\n  --output_dir=<span class=\"pl-smi\">$TRAIN_DIR</span> \\\n  --t2t_usr_dir=<span class=\"pl-smi\">$USER_DIR</span> \\\n  --problems=<span class=\"pl-smi\">$PROBLEM</span> \\\n  --model=<span class=\"pl-smi\">$MODEL</span> \\\n  --hparams_set=<span class=\"pl-smi\">$HPARAMS</span> \\\n  --generate_data=True \\\n  --train_steps=2000 \\\n  --worker_gpu=4 \\\n  --tfdbg</pre></div>", "body_text": "@caisq @aselle\nIf you run transformer_encoder model from tensor2tensor repo: https://github.com/tensorflow/tensor2tensor#sentiment-analysis\nwith tfdbg enabled, it will report:\nmultiple devices with nodes named 'n/_78' but device_name is not specified\nMy node has 4 v100 gpus. The script I use attached here:\n# t2t hparams\nPROBLEM=sentiment_imdb\nMODEL=transformer_encoder\nHPARAMS=transformer_tiny\n\n# t2t dirs\n# MODEL-HPARAMS format is mandatory\nPROJECT=/project/chli\nTRAIN_DIR=$PROJECT/$MODEL/t2t_train/$PROBLEM/$MODEL-$HPARAMS\nTMP_DIR=/tmp/t2t_datagen\nDATA_DIR=$PROJECT/$MODEL/t2t_data\n\nt2t-trainer \\\n  --data_dir=$DATA_DIR \\\n  --tmp_dir=$TMP_DIR \\\n  --output_dir=$TRAIN_DIR \\\n  --t2t_usr_dir=$USER_DIR \\\n  --problems=$PROBLEM \\\n  --model=$MODEL \\\n  --hparams_set=$HPARAMS \\\n  --generate_data=True \\\n  --train_steps=2000 \\\n  --worker_gpu=4 \\\n  --tfdbg", "body": "@caisq @aselle \r\nIf you run `transformer_encoder` model from `tensor2tensor` repo: https://github.com/tensorflow/tensor2tensor#sentiment-analysis\r\nwith tfdbg enabled, it will report:\r\n\r\n`multiple devices with nodes named 'n/_78' but device_name is not specified`\r\n\r\nMy node has 4 v100 gpus. The script I use attached here:\r\n\r\n``` bash\r\n# t2t hparams\r\nPROBLEM=sentiment_imdb\r\nMODEL=transformer_encoder\r\nHPARAMS=transformer_tiny\r\n\r\n# t2t dirs\r\n# MODEL-HPARAMS format is mandatory\r\nPROJECT=/project/chli\r\nTRAIN_DIR=$PROJECT/$MODEL/t2t_train/$PROBLEM/$MODEL-$HPARAMS\r\nTMP_DIR=/tmp/t2t_datagen\r\nDATA_DIR=$PROJECT/$MODEL/t2t_data\r\n\r\nt2t-trainer \\\r\n  --data_dir=$DATA_DIR \\\r\n  --tmp_dir=$TMP_DIR \\\r\n  --output_dir=$TRAIN_DIR \\\r\n  --t2t_usr_dir=$USER_DIR \\\r\n  --problems=$PROBLEM \\\r\n  --model=$MODEL \\\r\n  --hparams_set=$HPARAMS \\\r\n  --generate_data=True \\\r\n  --train_steps=2000 \\\r\n  --worker_gpu=4 \\\r\n  --tfdbg\r\n```"}