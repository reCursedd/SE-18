{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/410549878", "html_url": "https://github.com/tensorflow/tensorflow/issues/21332#issuecomment-410549878", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21332", "id": 410549878, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDU0OTg3OA==", "user": {"login": "psyhtest", "id": 6597818, "node_id": "MDQ6VXNlcjY1OTc4MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6597818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psyhtest", "html_url": "https://github.com/psyhtest", "followers_url": "https://api.github.com/users/psyhtest/followers", "following_url": "https://api.github.com/users/psyhtest/following{/other_user}", "gists_url": "https://api.github.com/users/psyhtest/gists{/gist_id}", "starred_url": "https://api.github.com/users/psyhtest/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psyhtest/subscriptions", "organizations_url": "https://api.github.com/users/psyhtest/orgs", "repos_url": "https://api.github.com/users/psyhtest/repos", "events_url": "https://api.github.com/users/psyhtest/events{/privacy}", "received_events_url": "https://api.github.com/users/psyhtest/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-05T21:36:56Z", "updated_at": "2018-08-05T21:36:56Z", "author_association": "NONE", "body_html": "<p>There are 20 occurrences of <code>offsetof</code> under <code>src/tensorflow</code>:</p>\n<pre><code>$ grep offsetof * -R \ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:// Jetson TX-2. This compiler does not support the offsetof() macro.\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_depth) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_row_size) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_depth) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_row_size) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_offset) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_offset) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, filter_offset) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_multiplier) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_activation_min) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_activation_max) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_shift) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_width) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_height) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_width) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_height) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8.h:// Jetson TX-2. This compiler does not support the offsetof() macro.\npython/eager/pywrap_tensor.cc:    offsetof(EagerTensor, weakreflist), /* tp_weaklistoffset */\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\n</code></pre>\n<p>I suspect this feature has crept into TF via TFLite, and requires compiler support (e.g. <a href=\"https://github.com/gcc-mirror/gcc/blob/gcc-7_1_0-release/gcc/ginclude/stddef.h#L416-L417\">gcc-7.1+</a>).</p>\n<p>The same <code>grep</code> for TF 1.8 and 1.7 returns only two occurrences:</p>\n<pre><code>anton@tegra-ubuntu:~/CK_TOOLS/lib-tensorflow-src-cpu-1.8-linux-64/src/tensorflow$ grep offsetof * -R \nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\nanton@tegra-ubuntu:~/CK_TOOLS/lib-tensorflow-src-cpu-1.7-linux-64/src/tensorflow$ grep offsetof * -R \nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\n</code></pre>", "body_text": "There are 20 occurrences of offsetof under src/tensorflow:\n$ grep offsetof * -R \ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:// Jetson TX-2. This compiler does not support the offsetof() macro.\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_depth) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_row_size) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_depth) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_row_size) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_offset) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_offset) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, filter_offset) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_multiplier) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_activation_min) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_activation_max) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_shift) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_width) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_height) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_width) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_height) ==\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8.h:// Jetson TX-2. This compiler does not support the offsetof() macro.\npython/eager/pywrap_tensor.cc:    offsetof(EagerTensor, weakreflist), /* tp_weaklistoffset */\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\n\nI suspect this feature has crept into TF via TFLite, and requires compiler support (e.g. gcc-7.1+).\nThe same grep for TF 1.8 and 1.7 returns only two occurrences:\nanton@tegra-ubuntu:~/CK_TOOLS/lib-tensorflow-src-cpu-1.8-linux-64/src/tensorflow$ grep offsetof * -R \nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\nanton@tegra-ubuntu:~/CK_TOOLS/lib-tensorflow-src-cpu-1.7-linux-64/src/tensorflow$ grep offsetof * -R \nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,", "body": "There are 20 occurrences of `offsetof` under `src/tensorflow`:\r\n```\r\n$ grep offsetof * -R \r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:// Jetson TX-2. This compiler does not support the offsetof() macro.\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_depth) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_row_size) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_depth) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_row_size) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_offset) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_offset) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, filter_offset) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_multiplier) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_activation_min) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_activation_max) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_shift) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_width) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, input_height) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_width) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:static_assert(offsetof(DepthwiseConvParams, output_height) ==\r\ncontrib/lite/kernels/internal/optimized/depthwiseconv_uint8.h:// Jetson TX-2. This compiler does not support the offsetof() macro.\r\npython/eager/pywrap_tensor.cc:    offsetof(EagerTensor, weakreflist), /* tp_weaklistoffset */\r\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\r\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\r\n```\r\nI suspect this feature has crept into TF via TFLite, and requires compiler support (e.g. [gcc-7.1+](https://github.com/gcc-mirror/gcc/blob/gcc-7_1_0-release/gcc/ginclude/stddef.h#L416-L417)).\r\n\r\nThe same `grep` for TF 1.8 and 1.7 returns only two occurrences:\r\n```\r\nanton@tegra-ubuntu:~/CK_TOOLS/lib-tensorflow-src-cpu-1.8-linux-64/src/tensorflow$ grep offsetof * -R \r\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\r\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\r\nanton@tegra-ubuntu:~/CK_TOOLS/lib-tensorflow-src-cpu-1.7-linux-64/src/tensorflow$ grep offsetof * -R \r\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuComplex, x) == 0,\r\nstream_executor/cuda/cuda_helpers.h:static_assert(offsetof(cuDoubleComplex, x) == 0,\r\n```"}