{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21332", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21332/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21332/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21332/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21332", "id": 346918188, "node_id": "MDU6SXNzdWUzNDY5MTgxODg=", "number": 21332, "title": "TensorFlow 1.9.0 fails on aarch64 platforms", "user": {"login": "psyhtest", "id": 6597818, "node_id": "MDQ6VXNlcjY1OTc4MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6597818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psyhtest", "html_url": "https://github.com/psyhtest", "followers_url": "https://api.github.com/users/psyhtest/followers", "following_url": "https://api.github.com/users/psyhtest/following{/other_user}", "gists_url": "https://api.github.com/users/psyhtest/gists{/gist_id}", "starred_url": "https://api.github.com/users/psyhtest/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psyhtest/subscriptions", "organizations_url": "https://api.github.com/users/psyhtest/orgs", "repos_url": "https://api.github.com/users/psyhtest/repos", "events_url": "https://api.github.com/users/psyhtest/events{/privacy}", "received_events_url": "https://api.github.com/users/psyhtest/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}], "state": "open", "locked": false, "assignee": {"login": "case540", "id": 1299636, "node_id": "MDQ6VXNlcjEyOTk2MzY=", "avatar_url": "https://avatars2.githubusercontent.com/u/1299636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/case540", "html_url": "https://github.com/case540", "followers_url": "https://api.github.com/users/case540/followers", "following_url": "https://api.github.com/users/case540/following{/other_user}", "gists_url": "https://api.github.com/users/case540/gists{/gist_id}", "starred_url": "https://api.github.com/users/case540/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/case540/subscriptions", "organizations_url": "https://api.github.com/users/case540/orgs", "repos_url": "https://api.github.com/users/case540/repos", "events_url": "https://api.github.com/users/case540/events{/privacy}", "received_events_url": "https://api.github.com/users/case540/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "case540", "id": 1299636, "node_id": "MDQ6VXNlcjEyOTk2MzY=", "avatar_url": "https://avatars2.githubusercontent.com/u/1299636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/case540", "html_url": "https://github.com/case540", "followers_url": "https://api.github.com/users/case540/followers", "following_url": "https://api.github.com/users/case540/following{/other_user}", "gists_url": "https://api.github.com/users/case540/gists{/gist_id}", "starred_url": "https://api.github.com/users/case540/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/case540/subscriptions", "organizations_url": "https://api.github.com/users/case540/orgs", "repos_url": "https://api.github.com/users/case540/repos", "events_url": "https://api.github.com/users/case540/events{/privacy}", "received_events_url": "https://api.github.com/users/case540/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2018-08-02T08:51:08Z", "updated_at": "2018-11-11T18:40:39Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>Building TensorFlow 1.9.0 from source fails on aarch64 platforms (NVIDIA TX1 and Linaro HiKey960) due to using an inappropriate compiler flag (<code>-mfpu=neon</code>):</p>\n<pre><code>ERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/internal/BUILD:359:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1)\ngcc: error: unrecognized command line option '-mfpu=neon'\n</code></pre>\n<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: N/A (a build problem)</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 16.04 (JetPack 3.1)</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.9.0</li>\n<li><strong>Python version</strong>: 2.7.12</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.15.2</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 5.5.0</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A (CPU ony)</li>\n<li><strong>GPU model and memory</strong>: N/A (CPU only)</li>\n<li><strong>Exact command to reproduce</strong>: Install dependencies and build via <a href=\"github.com/ctuning/ck-tensorflow\">CK-TensorFlow</a>:</li>\n</ul>\n<pre><code>$ sudo apt install liblapack-dev libatlas-dev\n$ sudo pip install enum34 mock pillow wheel absl-py scipy ck\n$ ck pull repo:ck-tensorflow\n$ ck install ck-env:package:tool-bazel-0.15.2-linux\n$ ck install package:lib-tensorflow-1.9.0-src-cpu --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\n</code></pre>\n<p><strong>NB:</strong> Restricting the number of building processes to 1 is necessary to prevent running out of memory on the NVIDIA TX1 platform (4 GB and no swap enabled) or similar.</p>\n<h3>Describe the problem</h3>\n<p>Building TensorFlow 1.9.0 fails on aarch64 platforms (NVIDIA TX1 and Linaro HiKey960). Similar instructions for TensorFlow 1.7.0 with Bazel 0.11.1 worked well:</p>\n<pre><code>$ ck install package:lib-tensorflow-1.7.0-src-cpu --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\n$ ck install package:lib-tensorflow-1.7.0-src-cpu-xla --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\n\n$ ck show env --tags=tensorflow,v1.7\nEnv UID:         Target OS: Bits: Name:                                       Version: Tags:\n\ned191cc45dda7ee4   linux-64    64 TensorFlow library (from sources, cpu, xla) 1.7      64bits,bazel,channel-stable,host-os-linux-64,lib,needs-bazel,needs-bazel-0.11.1,target-os-linux-64,tensorflow,tensorflow-cpu,v1,v1.7,v1.7.0,vcpu,vsrc,vxla\ned191cc45dda7ee3   linux-64    64 TensorFlow library (from sources, cpu)      1.7      64bits,bazel,channel-stable,host-os-linux-64,lib,needs-bazel,needs-bazel-0.11.1,target-os-linux-64,tensorflow,tensorflow-cpu,v1,v1.7,v1.7.0,vcpu,vsrc\n</code></pre>\n<p>They also worked for TensorFlow 1.8.0 with Bazel 0.13.0 after <a href=\"https://github.com/tensorflow/tensorflow/issues/18643#issuecomment-386245419\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/18643/hovercard\">including a patch</a> into the CK package:</p>\n<pre><code>$ sudo apt install liblapack-dev libatlas-dev\n$ sudo pip install enum34 mock pillow wheel absl-py scipy ck\n$ ck pull repo:ck-tensorflow\n$ ck install ck-env:package:tool-bazel-0.13.0-linux\n$ ck install package:lib-tensorflow-1.8.0-src-cpu [--env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1]\n</code></pre>\n<h3>Source code / logs</h3>\n<p>After about 10 hours, the build failed:</p>\n<pre><code>ERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/internal/BUILD:359:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1)\ngcc: error: unrecognized command line option '-mfpu=neon'\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\n</code></pre>", "body_text": "Building TensorFlow 1.9.0 from source fails on aarch64 platforms (NVIDIA TX1 and Linaro HiKey960) due to using an inappropriate compiler flag (-mfpu=neon):\nERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/internal/BUILD:359:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1)\ngcc: error: unrecognized command line option '-mfpu=neon'\n\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): N/A (a build problem)\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04 (JetPack 3.1)\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.9.0\nPython version: 2.7.12\nBazel version (if compiling from source): 0.15.2\nGCC/Compiler version (if compiling from source): 5.5.0\nCUDA/cuDNN version: N/A (CPU ony)\nGPU model and memory: N/A (CPU only)\nExact command to reproduce: Install dependencies and build via CK-TensorFlow:\n\n$ sudo apt install liblapack-dev libatlas-dev\n$ sudo pip install enum34 mock pillow wheel absl-py scipy ck\n$ ck pull repo:ck-tensorflow\n$ ck install ck-env:package:tool-bazel-0.15.2-linux\n$ ck install package:lib-tensorflow-1.9.0-src-cpu --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\n\nNB: Restricting the number of building processes to 1 is necessary to prevent running out of memory on the NVIDIA TX1 platform (4 GB and no swap enabled) or similar.\nDescribe the problem\nBuilding TensorFlow 1.9.0 fails on aarch64 platforms (NVIDIA TX1 and Linaro HiKey960). Similar instructions for TensorFlow 1.7.0 with Bazel 0.11.1 worked well:\n$ ck install package:lib-tensorflow-1.7.0-src-cpu --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\n$ ck install package:lib-tensorflow-1.7.0-src-cpu-xla --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\n\n$ ck show env --tags=tensorflow,v1.7\nEnv UID:         Target OS: Bits: Name:                                       Version: Tags:\n\ned191cc45dda7ee4   linux-64    64 TensorFlow library (from sources, cpu, xla) 1.7      64bits,bazel,channel-stable,host-os-linux-64,lib,needs-bazel,needs-bazel-0.11.1,target-os-linux-64,tensorflow,tensorflow-cpu,v1,v1.7,v1.7.0,vcpu,vsrc,vxla\ned191cc45dda7ee3   linux-64    64 TensorFlow library (from sources, cpu)      1.7      64bits,bazel,channel-stable,host-os-linux-64,lib,needs-bazel,needs-bazel-0.11.1,target-os-linux-64,tensorflow,tensorflow-cpu,v1,v1.7,v1.7.0,vcpu,vsrc\n\nThey also worked for TensorFlow 1.8.0 with Bazel 0.13.0 after including a patch into the CK package:\n$ sudo apt install liblapack-dev libatlas-dev\n$ sudo pip install enum34 mock pillow wheel absl-py scipy ck\n$ ck pull repo:ck-tensorflow\n$ ck install ck-env:package:tool-bazel-0.13.0-linux\n$ ck install package:lib-tensorflow-1.8.0-src-cpu [--env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1]\n\nSource code / logs\nAfter about 10 hours, the build failed:\nERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/internal/BUILD:359:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1)\ngcc: error: unrecognized command line option '-mfpu=neon'\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.", "body": "Building TensorFlow 1.9.0 from source fails on aarch64 platforms (NVIDIA TX1 and Linaro HiKey960) due to using an inappropriate compiler flag (`-mfpu=neon`):\r\n```\r\nERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/internal/BUILD:359:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1)\r\ngcc: error: unrecognized command line option '-mfpu=neon'\r\n```\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: N/A (a build problem)\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04 (JetPack 3.1)\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.9.0\r\n- **Python version**: 2.7.12\r\n- **Bazel version (if compiling from source)**: 0.15.2\r\n- **GCC/Compiler version (if compiling from source)**: 5.5.0\r\n- **CUDA/cuDNN version**: N/A (CPU ony)\r\n- **GPU model and memory**: N/A (CPU only)\r\n- **Exact command to reproduce**: Install dependencies and build via [CK-TensorFlow](github.com/ctuning/ck-tensorflow):\r\n```\r\n$ sudo apt install liblapack-dev libatlas-dev\r\n$ sudo pip install enum34 mock pillow wheel absl-py scipy ck\r\n$ ck pull repo:ck-tensorflow\r\n$ ck install ck-env:package:tool-bazel-0.15.2-linux\r\n$ ck install package:lib-tensorflow-1.9.0-src-cpu --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\r\n```\r\n**NB:** Restricting the number of building processes to 1 is necessary to prevent running out of memory on the NVIDIA TX1 platform (4 GB and no swap enabled) or similar.\r\n\r\n### Describe the problem\r\n\r\nBuilding TensorFlow 1.9.0 fails on aarch64 platforms (NVIDIA TX1 and Linaro HiKey960). Similar instructions for TensorFlow 1.7.0 with Bazel 0.11.1 worked well:\r\n```\r\n$ ck install package:lib-tensorflow-1.7.0-src-cpu --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\r\n$ ck install package:lib-tensorflow-1.7.0-src-cpu-xla --env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1\r\n\r\n$ ck show env --tags=tensorflow,v1.7\r\nEnv UID:         Target OS: Bits: Name:                                       Version: Tags:\r\n\r\ned191cc45dda7ee4   linux-64    64 TensorFlow library (from sources, cpu, xla) 1.7      64bits,bazel,channel-stable,host-os-linux-64,lib,needs-bazel,needs-bazel-0.11.1,target-os-linux-64,tensorflow,tensorflow-cpu,v1,v1.7,v1.7.0,vcpu,vsrc,vxla\r\ned191cc45dda7ee3   linux-64    64 TensorFlow library (from sources, cpu)      1.7      64bits,bazel,channel-stable,host-os-linux-64,lib,needs-bazel,needs-bazel-0.11.1,target-os-linux-64,tensorflow,tensorflow-cpu,v1,v1.7,v1.7.0,vcpu,vsrc\r\n```\r\nThey also worked for TensorFlow 1.8.0 with Bazel 0.13.0 after [including a patch](\r\nhttps://github.com/tensorflow/tensorflow/issues/18643#issuecomment-386245419\r\n) into the CK package:\r\n\r\n```\r\n$ sudo apt install liblapack-dev libatlas-dev\r\n$ sudo pip install enum34 mock pillow wheel absl-py scipy ck\r\n$ ck pull repo:ck-tensorflow\r\n$ ck install ck-env:package:tool-bazel-0.13.0-linux\r\n$ ck install package:lib-tensorflow-1.8.0-src-cpu [--env.CK_HOST_CPU_NUMBER_OF_PROCESSORS=1]\r\n```\r\n\r\n### Source code / logs\r\nAfter about 10 hours, the build failed:\r\n```\r\nERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/internal/BUILD:359:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels/internal:tensor_utils' failed (Exit 1)\r\ngcc: error: unrecognized command line option '-mfpu=neon'\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\n```"}