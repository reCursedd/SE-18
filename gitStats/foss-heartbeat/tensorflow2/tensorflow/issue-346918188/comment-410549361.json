{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/410549361", "html_url": "https://github.com/tensorflow/tensorflow/issues/21332#issuecomment-410549361", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21332", "id": 410549361, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDU0OTM2MQ==", "user": {"login": "psyhtest", "id": 6597818, "node_id": "MDQ6VXNlcjY1OTc4MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6597818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psyhtest", "html_url": "https://github.com/psyhtest", "followers_url": "https://api.github.com/users/psyhtest/followers", "following_url": "https://api.github.com/users/psyhtest/following{/other_user}", "gists_url": "https://api.github.com/users/psyhtest/gists{/gist_id}", "starred_url": "https://api.github.com/users/psyhtest/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psyhtest/subscriptions", "organizations_url": "https://api.github.com/users/psyhtest/orgs", "repos_url": "https://api.github.com/users/psyhtest/repos", "events_url": "https://api.github.com/users/psyhtest/events{/privacy}", "received_events_url": "https://api.github.com/users/psyhtest/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-05T21:27:59Z", "updated_at": "2018-08-05T21:27:59Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3395998\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/freedomtan\">@freedomtan</a>'s patch has helped me to make progress but only to find out about another failure to build TF 1.9 on aarch64 platforms:</p>\n<pre><code>ERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/BUILD:128:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:builtin_ops' failed (Exit 1)\nIn file included from ./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8.h:21:0,\n                 from tensorflow/contrib/lite/kernels/depthwise_conv.cc:26:\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:43: error: expected primary-expression before ',' token\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\n                                           ^\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:45: error: 'input_depth' was not declared in this scope\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\n                                             ^\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:56: error: 'offsetof' was not declared in this scope\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\n                                                        ^\n...\n</code></pre>\n<p>Now, peeking into <code>tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h</code> revealed the following case of conditional compilation excluding practically all of the file (full of inline assembly):</p>\n<pre><code>// Enable for arm64 except for the Nvidia Linux 4 Tegra (L4T) running on\n// Jetson TX-2. This compiler does not support the offsetof() macro.\n#if defined(__aarch64__) &amp;&amp; !defined(GOOGLE_L4T)\n</code></pre>\n<p>Now, that's at the same time both too specific (why only TX2, not TX1, HiKey960 or any other target?) and not specific (which compiler? gcc-5?)</p>", "body_text": "@freedomtan's patch has helped me to make progress but only to find out about another failure to build TF 1.9 on aarch64 platforms:\nERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/BUILD:128:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:builtin_ops' failed (Exit 1)\nIn file included from ./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8.h:21:0,\n                 from tensorflow/contrib/lite/kernels/depthwise_conv.cc:26:\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:43: error: expected primary-expression before ',' token\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\n                                           ^\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:45: error: 'input_depth' was not declared in this scope\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\n                                             ^\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:56: error: 'offsetof' was not declared in this scope\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\n                                                        ^\n...\n\nNow, peeking into tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h revealed the following case of conditional compilation excluding practically all of the file (full of inline assembly):\n// Enable for arm64 except for the Nvidia Linux 4 Tegra (L4T) running on\n// Jetson TX-2. This compiler does not support the offsetof() macro.\n#if defined(__aarch64__) && !defined(GOOGLE_L4T)\n\nNow, that's at the same time both too specific (why only TX2, not TX1, HiKey960 or any other target?) and not specific (which compiler? gcc-5?)", "body": "@freedomtan's patch has helped me to make progress but only to find out about another failure to build TF 1.9 on aarch64 platforms:\r\n```\r\nERROR: /home/anton/CK_TOOLS/lib-tensorflow-src-cpu-1.9-compiler.python-2.7.12-linux-64/src/tensorflow/contrib/lite/kernels/BUILD:128:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:builtin_ops' failed (Exit 1)\r\nIn file included from ./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8.h:21:0,\r\n                 from tensorflow/contrib/lite/kernels/depthwise_conv.cc:26:\r\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:43: error: expected primary-expression before ',' token\r\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\r\n                                           ^\r\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:45: error: 'input_depth' was not declared in this scope\r\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\r\n                                             ^\r\n./tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h:80:56: error: 'offsetof' was not declared in this scope\r\n static_assert(offsetof(DepthwiseConvParams, input_depth) ==\r\n                                                        ^\r\n...\r\n```\r\nNow, peeking into `tensorflow/contrib/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h` revealed the following case of conditional compilation excluding practically all of the file (full of inline assembly):\r\n```\r\n// Enable for arm64 except for the Nvidia Linux 4 Tegra (L4T) running on\r\n// Jetson TX-2. This compiler does not support the offsetof() macro.\r\n#if defined(__aarch64__) && !defined(GOOGLE_L4T)\r\n```\r\nNow, that's at the same time both too specific (why only TX2, not TX1, HiKey960 or any other target?) and not specific (which compiler? gcc-5?)"}