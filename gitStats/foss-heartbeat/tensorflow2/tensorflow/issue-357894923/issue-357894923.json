{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22134", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22134/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22134/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22134/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22134", "id": 357894923, "node_id": "MDU6SXNzdWUzNTc4OTQ5MjM=", "number": 22134, "title": "tensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients", "user": {"login": "rishi-rranjan", "id": 5673695, "node_id": "MDQ6VXNlcjU2NzM2OTU=", "avatar_url": "https://avatars2.githubusercontent.com/u/5673695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rishi-rranjan", "html_url": "https://github.com/rishi-rranjan", "followers_url": "https://api.github.com/users/rishi-rranjan/followers", "following_url": "https://api.github.com/users/rishi-rranjan/following{/other_user}", "gists_url": "https://api.github.com/users/rishi-rranjan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rishi-rranjan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rishi-rranjan/subscriptions", "organizations_url": "https://api.github.com/users/rishi-rranjan/orgs", "repos_url": "https://api.github.com/users/rishi-rranjan/repos", "events_url": "https://api.github.com/users/rishi-rranjan/events{/privacy}", "received_events_url": "https://api.github.com/users/rishi-rranjan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "azaks2", "id": 40365382, "node_id": "MDQ6VXNlcjQwMzY1Mzgy", "avatar_url": "https://avatars2.githubusercontent.com/u/40365382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azaks2", "html_url": "https://github.com/azaks2", "followers_url": "https://api.github.com/users/azaks2/followers", "following_url": "https://api.github.com/users/azaks2/following{/other_user}", "gists_url": "https://api.github.com/users/azaks2/gists{/gist_id}", "starred_url": "https://api.github.com/users/azaks2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azaks2/subscriptions", "organizations_url": "https://api.github.com/users/azaks2/orgs", "repos_url": "https://api.github.com/users/azaks2/repos", "events_url": "https://api.github.com/users/azaks2/events{/privacy}", "received_events_url": "https://api.github.com/users/azaks2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "azaks2", "id": 40365382, "node_id": "MDQ6VXNlcjQwMzY1Mzgy", "avatar_url": "https://avatars2.githubusercontent.com/u/40365382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azaks2", "html_url": "https://github.com/azaks2", "followers_url": "https://api.github.com/users/azaks2/followers", "following_url": "https://api.github.com/users/azaks2/following{/other_user}", "gists_url": "https://api.github.com/users/azaks2/gists{/gist_id}", "starred_url": "https://api.github.com/users/azaks2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azaks2/subscriptions", "organizations_url": "https://api.github.com/users/azaks2/orgs", "repos_url": "https://api.github.com/users/azaks2/repos", "events_url": "https://api.github.com/users/azaks2/events{/privacy}", "received_events_url": "https://api.github.com/users/azaks2/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-09-07T02:21:08Z", "updated_at": "2018-11-22T23:39:23Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>Please go to Stack Overflow for help and support:</p>\n<p><a href=\"https://stackoverflow.com/questions/tagged/tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/tagged/tensorflow</a></p>\n<p>If you open a GitHub issue, here is our policy:</p>\n<ol>\n<li>It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).</li>\n<li>The form below must be filled out.</li>\n<li>It shouldn't be a TensorBoard issue. Those go <a href=\"https://github.com/tensorflow/tensorboard/issues\">here</a>.</li>\n</ol>\n<p><strong>Here's why we have that policy</strong>: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.</p>\n<hr>\n<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes. Added some custom TF operators.</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 18.04</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>: N/A</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Binary</li>\n<li><strong>TensorFlow version (use command below)</strong>:1.10.1</li>\n<li><strong>Python version</strong>:3</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>:9.2</li>\n<li><strong>GPU model and memory</strong>: GeForce GTX 970</li>\n<li><strong>Exact command to reproduce</strong>:python3 train/train.py --gpu 0 --model frustum_pointnets_v2 --log_dir train/log_v2 --num_point 1024 --max_epoch 201 --batch_size 24 --decay_step 800000 --decay_rate 0.5</li>\n</ul>\n<p>You can collect some of this information using our environment capture script:</p>\n<p><a href=\"https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\">https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh</a></p>\n<p>You can obtain the TensorFlow version with</p>\n<p>python -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"</p>\n<h3>Describe the problem</h3>\n<p>Getting an error that \"No registered '_CopyFromGpuToHost' OpKernel\". Not able to find the refernce to this OpKernel anywhere.</p>\n<h3>Source code / logs</h3>\n<p>pid: 16638<br>\nWARNING:tensorflow:From /home/rishi/sw/frustum-pointnets/models/pointnet_util.py:126: calling reduce_max (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.<br>\nInstructions for updating:<br>\nkeep_dims is deprecated, use keepdims instead<br>\nWARNING:tensorflow:From /home/rishi/sw/frustum-pointnets/models/pointnet_util.py:212: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.<br>\nInstructions for updating:<br>\nkeep_dims is deprecated, use keepdims instead<br>\nWARNING:tensorflow:From /home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py:519: calling conv1d (from tensorflow.python.ops.nn_ops) with data_format=NHWC is deprecated and will be removed in a future version.<br>\nInstructions for updating:<br>\n<code>NHWC</code> for data_format is deprecated, use <code>NWC</code> instead<br>\n2018-09-06 19:00:38.848283: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>\n2018-09-06 19:00:38.920714: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-09-06 19:00:38.921052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:<br>\nname: GeForce GTX 970 major: 5 minor: 2 memoryClockRate(GHz): 1.1775<br>\npciBusID: 0000:01:00.0<br>\ntotalMemory: 3.94GiB freeMemory: 3.56GiB<br>\n2018-09-06 19:00:38.921067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0<br>\n2018-09-06 19:00:39.115930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-09-06 19:00:39.115958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0<br>\n2018-09-06 19:00:39.115967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N<br>\n2018-09-06 19:00:39.116154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3282 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0, compute capability: 5.2)<br>\n**** EPOCH 000 ****<br>\n2018-09-06 19:00:42.022472<br>\n2018-09-06 19:00:42.305938: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.<br>\n2018-09-06 19:00:42.322253: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.<br>\n2018-09-06 19:00:42.337831: W tensorflow/core/framework/allocator.cc:108] Allocation of 100663296 exceeds 10% of system memory.<br>\n2018-09-06 19:00:42.368540: W tensorflow/core/framework/allocator.cc:108] Allocation of 100663296 exceeds 10% of system memory.<br>\n2018-09-06 19:00:42.401274: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.<br>\n2018-09-06 19:00:52.106763: E tensorflow/core/common_runtime/executor.cc:697] Executor failed to create kernel. Not found: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost<a href=\"fa_layer3/truediv_2/_91\">T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a><br>\n.  Registered:  device='GPU'</p>\n<pre><code> [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\n</code></pre>\n<p>Traceback (most recent call last):<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call<br>\nreturn fn(*args)<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn<br>\noptions, feed_dict, fetch_list, target_list, run_metadata)<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun<br>\nrun_metadata)<br>\ntensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost<a href=\"fa_layer3/truediv_2/_91\">T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a><br>\n.  Registered:  device='GPU'</p>\n<pre><code> [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\n</code></pre>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"train/train.py\", line 376, in <br>\ntrain()<br>\nFile \"train/train.py\", line 201, in train<br>\ntrain_one_epoch(sess, ops, train_writer)<br>\nFile \"train/train.py\", line 256, in train_one_epoch<br>\nfeed_dict=feed_dict)<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run<br>\nrun_metadata_ptr)<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run<br>\nrun_metadata)<br>\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost<a href=\"fa_layer3/truediv_2/_91\">T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a><br>\n.  Registered:  device='GPU'</p>\n<pre><code> [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\n</code></pre>", "body_text": "Please go to Stack Overflow for help and support:\nhttps://stackoverflow.com/questions/tagged/tensorflow\nIf you open a GitHub issue, here is our policy:\n\nIt must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\nThe form below must be filled out.\nIt shouldn't be a TensorBoard issue. Those go here.\n\nHere's why we have that policy: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\n\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes. Added some custom TF operators.\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\nTensorFlow installed from (source or binary): Binary\nTensorFlow version (use command below):1.10.1\nPython version:3\nBazel version (if compiling from source):\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version:9.2\nGPU model and memory: GeForce GTX 970\nExact command to reproduce:python3 train/train.py --gpu 0 --model frustum_pointnets_v2 --log_dir train/log_v2 --num_point 1024 --max_epoch 201 --batch_size 24 --decay_step 800000 --decay_rate 0.5\n\nYou can collect some of this information using our environment capture script:\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\nYou can obtain the TensorFlow version with\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\nDescribe the problem\nGetting an error that \"No registered '_CopyFromGpuToHost' OpKernel\". Not able to find the refernce to this OpKernel anywhere.\nSource code / logs\npid: 16638\nWARNING:tensorflow:From /home/rishi/sw/frustum-pointnets/models/pointnet_util.py:126: calling reduce_max (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\nInstructions for updating:\nkeep_dims is deprecated, use keepdims instead\nWARNING:tensorflow:From /home/rishi/sw/frustum-pointnets/models/pointnet_util.py:212: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\nInstructions for updating:\nkeep_dims is deprecated, use keepdims instead\nWARNING:tensorflow:From /home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py:519: calling conv1d (from tensorflow.python.ops.nn_ops) with data_format=NHWC is deprecated and will be removed in a future version.\nInstructions for updating:\nNHWC for data_format is deprecated, use NWC instead\n2018-09-06 19:00:38.848283: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-09-06 19:00:38.920714: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-09-06 19:00:38.921052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:\nname: GeForce GTX 970 major: 5 minor: 2 memoryClockRate(GHz): 1.1775\npciBusID: 0000:01:00.0\ntotalMemory: 3.94GiB freeMemory: 3.56GiB\n2018-09-06 19:00:38.921067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-06 19:00:39.115930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-06 19:00:39.115958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\n2018-09-06 19:00:39.115967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\n2018-09-06 19:00:39.116154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3282 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0, compute capability: 5.2)\n**** EPOCH 000 ****\n2018-09-06 19:00:42.022472\n2018-09-06 19:00:42.305938: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.\n2018-09-06 19:00:42.322253: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.\n2018-09-06 19:00:42.337831: W tensorflow/core/framework/allocator.cc:108] Allocation of 100663296 exceeds 10% of system memory.\n2018-09-06 19:00:42.368540: W tensorflow/core/framework/allocator.cc:108] Allocation of 100663296 exceeds 10% of system memory.\n2018-09-06 19:00:42.401274: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.\n2018-09-06 19:00:52.106763: E tensorflow/core/common_runtime/executor.cc:697] Executor failed to create kernel. Not found: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHostT=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"\n.  Registered:  device='GPU'\n [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\n\nTraceback (most recent call last):\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\nreturn fn(*args)\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn\noptions, feed_dict, fetch_list, target_list, run_metadata)\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun\nrun_metadata)\ntensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHostT=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"\n.  Registered:  device='GPU'\n [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\n\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"train/train.py\", line 376, in \ntrain()\nFile \"train/train.py\", line 201, in train\ntrain_one_epoch(sess, ops, train_writer)\nFile \"train/train.py\", line 256, in train_one_epoch\nfeed_dict=feed_dict)\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run\nrun_metadata_ptr)\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\nrun_metadata)\nFile \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHostT=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"\n.  Registered:  device='GPU'\n [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes. Added some custom TF operators. \r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: Binary\r\n- **TensorFlow version (use command below)**:1.10.1\r\n- **Python version**:3\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:9.2\r\n- **GPU model and memory**: GeForce GTX 970\r\n- **Exact command to reproduce**:python3 train/train.py --gpu 0 --model frustum_pointnets_v2 --log_dir train/log_v2 --num_point 1024 --max_epoch 201 --batch_size 24 --decay_step 800000 --decay_rate 0.5\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nGetting an error that \"No registered '_CopyFromGpuToHost' OpKernel\". Not able to find the refernce to this OpKernel anywhere. \r\n\r\n### Source code / logs\r\npid: 16638\r\nWARNING:tensorflow:From /home/rishi/sw/frustum-pointnets/models/pointnet_util.py:126: calling reduce_max (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nkeep_dims is deprecated, use keepdims instead\r\nWARNING:tensorflow:From /home/rishi/sw/frustum-pointnets/models/pointnet_util.py:212: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nkeep_dims is deprecated, use keepdims instead\r\nWARNING:tensorflow:From /home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py:519: calling conv1d (from tensorflow.python.ops.nn_ops) with data_format=NHWC is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\n`NHWC` for data_format is deprecated, use `NWC` instead\r\n2018-09-06 19:00:38.848283: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-06 19:00:38.920714: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-09-06 19:00:38.921052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \r\nname: GeForce GTX 970 major: 5 minor: 2 memoryClockRate(GHz): 1.1775\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 3.94GiB freeMemory: 3.56GiB\r\n2018-09-06 19:00:38.921067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-06 19:00:39.115930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-06 19:00:39.115958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \r\n2018-09-06 19:00:39.115967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \r\n2018-09-06 19:00:39.116154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3282 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0, compute capability: 5.2)\r\n**** EPOCH 000 ****\r\n2018-09-06 19:00:42.022472\r\n2018-09-06 19:00:42.305938: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.\r\n2018-09-06 19:00:42.322253: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.\r\n2018-09-06 19:00:42.337831: W tensorflow/core/framework/allocator.cc:108] Allocation of 100663296 exceeds 10% of system memory.\r\n2018-09-06 19:00:42.368540: W tensorflow/core/framework/allocator.cc:108] Allocation of 100663296 exceeds 10% of system memory.\r\n2018-09-06 19:00:42.401274: W tensorflow/core/framework/allocator.cc:108] Allocation of 50331648 exceeds 10% of system memory.\r\n2018-09-06 19:00:52.106763: E tensorflow/core/common_runtime/executor.cc:697] Executor failed to create kernel. Not found: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)\r\n\t.  Registered:  device='GPU'\r\n\r\n\t [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\r\nTraceback (most recent call last):\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\r\n    return fn(*args)\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)\r\n\t.  Registered:  device='GPU'\r\n\r\n\t [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"train/train.py\", line 376, in <module>\r\n    train()\r\n  File \"train/train.py\", line 201, in train\r\n    train_one_epoch(sess, ops, train_writer)\r\n  File \"train/train.py\", line 256, in train_one_epoch\r\n    feed_dict=feed_dict)\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run\r\n    run_metadata_ptr)\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\r\n    run_metadata)\r\n  File \"/home/rishi/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.NotFoundError: No registered '_CopyFromGpuToHost' OpKernel for CPU devices compatible with node swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)\r\n\t.  Registered:  device='GPU'\r\n\r\n\t [[Node: swap_out_gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2 = _CopyFromGpuToHost[T=DT_FLOAT, _class=[\"loc@gradients/fa_layer3/ThreeInterpolate_grad/ThreeInterpolateGrad_2\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](fa_layer3/truediv_2/_91)]]\r\n\r\n"}