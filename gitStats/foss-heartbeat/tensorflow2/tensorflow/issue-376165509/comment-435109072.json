{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/435109072", "html_url": "https://github.com/tensorflow/tensorflow/issues/23413#issuecomment-435109072", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23413", "id": 435109072, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTEwOTA3Mg==", "user": {"login": "Svdvoort", "id": 23049683, "node_id": "MDQ6VXNlcjIzMDQ5Njgz", "avatar_url": "https://avatars2.githubusercontent.com/u/23049683?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Svdvoort", "html_url": "https://github.com/Svdvoort", "followers_url": "https://api.github.com/users/Svdvoort/followers", "following_url": "https://api.github.com/users/Svdvoort/following{/other_user}", "gists_url": "https://api.github.com/users/Svdvoort/gists{/gist_id}", "starred_url": "https://api.github.com/users/Svdvoort/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Svdvoort/subscriptions", "organizations_url": "https://api.github.com/users/Svdvoort/orgs", "repos_url": "https://api.github.com/users/Svdvoort/repos", "events_url": "https://api.github.com/users/Svdvoort/events{/privacy}", "received_events_url": "https://api.github.com/users/Svdvoort/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-01T16:58:48Z", "updated_at": "2018-11-01T16:59:32Z", "author_association": "NONE", "body_html": "<p>After some testing the problem can be resolved by replacing the model with:</p>\n<pre><code>from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Input, Activation\nfrom tensorflow.keras.models import Model\n\ndef cnn_model(rows, cols, channels):\n    model = Model()\n    inputs = Input(shape=(rows, cols, channels), dtype='float32')\n\n    conv1 = Conv2D(64, (3, 3),activation='linear',kernel_initializer='he_uniform')(inputs)\n    relu1 = Activation('relu')(conv1)\n    pooling1 = MaxPooling2D(pool_size=(5, 5))(relu1)\n\n    flatten = Flatten()(pooling1)\n\n    dense1 = Dense(512)(flatten)\n\n    relu2 = Activation('relu')(dense1)\n    flatten = Flatten()(conv1)\n    predictions = Dense(4, activation='softmax')(flatten)\n\n    model = Model(inputs=inputs, outputs=predictions)\n\n    return model\n</code></pre>\n<p>But it seems strange that replacing that replacing the ReLU solves the issue (and the error is quite unclear).</p>", "body_text": "After some testing the problem can be resolved by replacing the model with:\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Input, Activation\nfrom tensorflow.keras.models import Model\n\ndef cnn_model(rows, cols, channels):\n    model = Model()\n    inputs = Input(shape=(rows, cols, channels), dtype='float32')\n\n    conv1 = Conv2D(64, (3, 3),activation='linear',kernel_initializer='he_uniform')(inputs)\n    relu1 = Activation('relu')(conv1)\n    pooling1 = MaxPooling2D(pool_size=(5, 5))(relu1)\n\n    flatten = Flatten()(pooling1)\n\n    dense1 = Dense(512)(flatten)\n\n    relu2 = Activation('relu')(dense1)\n    flatten = Flatten()(conv1)\n    predictions = Dense(4, activation='softmax')(flatten)\n\n    model = Model(inputs=inputs, outputs=predictions)\n\n    return model\n\nBut it seems strange that replacing that replacing the ReLU solves the issue (and the error is quite unclear).", "body": "After some testing the problem can be resolved by replacing the model with:\r\n\r\n```\r\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Input, Activation\r\nfrom tensorflow.keras.models import Model\r\n\r\ndef cnn_model(rows, cols, channels):\r\n    model = Model()\r\n    inputs = Input(shape=(rows, cols, channels), dtype='float32')\r\n\r\n    conv1 = Conv2D(64, (3, 3),activation='linear',kernel_initializer='he_uniform')(inputs)\r\n    relu1 = Activation('relu')(conv1)\r\n    pooling1 = MaxPooling2D(pool_size=(5, 5))(relu1)\r\n\r\n    flatten = Flatten()(pooling1)\r\n\r\n    dense1 = Dense(512)(flatten)\r\n\r\n    relu2 = Activation('relu')(dense1)\r\n    flatten = Flatten()(conv1)\r\n    predictions = Dense(4, activation='softmax')(flatten)\r\n\r\n    model = Model(inputs=inputs, outputs=predictions)\r\n\r\n    return model\r\n```\r\n\r\nBut it seems strange that replacing that replacing the ReLU solves the issue (and the error is quite unclear). "}