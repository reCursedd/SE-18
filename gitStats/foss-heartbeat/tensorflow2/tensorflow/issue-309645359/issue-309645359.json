{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18081", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18081/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18081/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18081/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18081", "id": 309645359, "node_id": "MDU6SXNzdWUzMDk2NDUzNTk=", "number": 18081, "title": "running distributed tensorflow failed after update tf from 1.0 to 1.5", "user": {"login": "rigorosyang", "id": 26357405, "node_id": "MDQ6VXNlcjI2MzU3NDA1", "avatar_url": "https://avatars2.githubusercontent.com/u/26357405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rigorosyang", "html_url": "https://github.com/rigorosyang", "followers_url": "https://api.github.com/users/rigorosyang/followers", "following_url": "https://api.github.com/users/rigorosyang/following{/other_user}", "gists_url": "https://api.github.com/users/rigorosyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rigorosyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rigorosyang/subscriptions", "organizations_url": "https://api.github.com/users/rigorosyang/orgs", "repos_url": "https://api.github.com/users/rigorosyang/repos", "events_url": "https://api.github.com/users/rigorosyang/events{/privacy}", "received_events_url": "https://api.github.com/users/rigorosyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-03-29T07:18:53Z", "updated_at": "2018-05-07T18:03:44Z", "closed_at": "2018-05-07T18:03:44Z", "author_association": "NONE", "body_html": "<p>Hi TF Experts,</p>\n<p>after I upgrade the tf from 1.0 to 1.5(cuda from 8.0 to 9.0), run the example distributed tensorflow codes failed. below are the codes, it is very simple. The log always output \"CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\". the code works fine for any of my machines whose tf version is under 1.5</p>\n<pre><code>import tensorflow as tf\n\ncluster = tf.train.ClusterSpec({\"ps\": [\"localhost:33562\"], \"worker\": [\"localhost:12563\"]})\n\nps = tf.train.Server(cluster, job_name=\"ps\", task_index=0)\nworker = tf.train.Server(cluster, job_name=\"worker\", task_index=0)\n\nprint(\"PS: {0}\".format(ps.target))\nprint(\"Worker: {0}\".format(worker.target))\n\nwith tf.Session(worker.target) as sess:\n\n    W = tf.Variable(tf.zeros([784, 10]))\n    b = tf.Variable(tf.zeros([10]))\n\n    init = tf.global_variables_initializer()\n\n    print(\"RUNNING SESSION\")\n    sess.run(init)\n    print(\"SESSION FINISHED\")\n</code></pre>\n<p>below are the full log:</p>\n<p>2018-03-29 15:17:37.084856: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>\n2018-03-29 15:17:38.367466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 0 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:04:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:38.865113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 1 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:05:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:39.369172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 2 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:08:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:39.884151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 3 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:09:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:40.416114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 4 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:85:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:40.903122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 5 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:86:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:41.388600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 6 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:89:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:41.869760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 7 with properties:<br>\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112<br>\npciBusID: 0000:8a:00.0<br>\ntotalMemory: 23.90GiB freeMemory: 23.78GiB<br>\n2018-03-29 15:17:41.875020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1227] Device peer to peer matrix<br>\n2018-03-29 15:17:41.875488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1233] DMA: 0 1 2 3 4 5 6 7<br>\n2018-03-29 15:17:41.875509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 0:   Y Y Y Y N N N N<br>\n2018-03-29 15:17:41.875523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 1:   Y Y Y Y N N N N<br>\n2018-03-29 15:17:41.875533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 2:   Y Y Y Y N N N N<br>\n2018-03-29 15:17:41.875543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 3:   Y Y Y Y N N N N<br>\n2018-03-29 15:17:41.875553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 4:   N N N N Y Y Y Y<br>\n2018-03-29 15:17:41.875563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 5:   N N N N Y Y Y Y<br>\n2018-03-29 15:17:41.875572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 6:   N N N N Y Y Y Y<br>\n2018-03-29 15:17:41.875585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 7:   N N N N Y Y Y Y<br>\n2018-03-29 15:17:41.875614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7<br>\n2018-03-29 15:17:46.028033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:0 with 23084 MB memory) -&gt; physical GPU (device: 0, name: Tesla M40 24GB, pci bus id: 0000:04:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:46.610150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:1 with 23082 MB memory) -&gt; physical GPU (device: 1, name: Tesla M40 24GB, pci bus id: 0000:05:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:47.276168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:2 with 23080 MB memory) -&gt; physical GPU (device: 2, name: Tesla M40 24GB, pci bus id: 0000:08:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:48.026291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:3 with 23080 MB memory) -&gt; physical GPU (device: 3, name: Tesla M40 24GB, pci bus id: 0000:09:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:49.020908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:4 with 23084 MB memory) -&gt; physical GPU (device: 4, name: Tesla M40 24GB, pci bus id: 0000:85:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:49.806995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:5 with 23082 MB memory) -&gt; physical GPU (device: 5, name: Tesla M40 24GB, pci bus id: 0000:86:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:50.654150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:6 with 23080 MB memory) -&gt; physical GPU (device: 6, name: Tesla M40 24GB, pci bus id: 0000:89:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:51.499643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:7 with 23080 MB memory) -&gt; physical GPU (device: 7, name: Tesla M40 24GB, pci bus id: 0000:8a:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.345019: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; localhost:33562}<br>\n2018-03-29 15:17:52.345127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; localhost:12563}<br>\n2018-03-29 15:17:52.362801: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:324] Started server with target: grpc://localhost:33562<br>\n2018-03-29 15:17:52.363232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7<br>\n2018-03-29 15:17:52.363789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 983 MB memory) -&gt; physical GPU (device: 0, name: Tesla M40 24GB, pci bus id: 0000:04:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.364275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 985 MB memory) -&gt; physical GPU (device: 1, name: Tesla M40 24GB, pci bus id: 0000:05:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.364715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 987 MB memory) -&gt; physical GPU (device: 2, name: Tesla M40 24GB, pci bus id: 0000:08:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.365138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 987 MB memory) -&gt; physical GPU (device: 3, name: Tesla M40 24GB, pci bus id: 0000:09:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.366627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:4 with 983 MB memory) -&gt; physical GPU (device: 4, name: Tesla M40 24GB, pci bus id: 0000:85:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.367325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:5 with 985 MB memory) -&gt; physical GPU (device: 5, name: Tesla M40 24GB, pci bus id: 0000:86:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.367962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:6 with 987 MB memory) -&gt; physical GPU (device: 6, name: Tesla M40 24GB, pci bus id: 0000:89:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.368731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:7 with 987 MB memory) -&gt; physical GPU (device: 7, name: Tesla M40 24GB, pci bus id: 0000:8a:00.0, compute capability: 5.2)<br>\n2018-03-29 15:17:52.376139: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; localhost:33562}<br>\n2018-03-29 15:17:52.376230: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; localhost:12563}<br>\n2018-03-29 15:17:52.382382: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:324] Started server with target: grpc://localhost:12563<br>\nPS: grpc://localhost:33562<br>\nWorker: grpc://localhost:12563<br>\nRUNNING SESSION<br>\n2018-03-29 15:18:02.506942: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0<br>\n2018-03-29 15:18:12.507132: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0<br>\n2018-03-29 15:18:22.507277: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0<br>\n2018-03-29 15:18:32.507427: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0<br>\n2018-03-29 15:18:42.507560: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0</p>", "body_text": "Hi TF Experts,\nafter I upgrade the tf from 1.0 to 1.5(cuda from 8.0 to 9.0), run the example distributed tensorflow codes failed. below are the codes, it is very simple. The log always output \"CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\". the code works fine for any of my machines whose tf version is under 1.5\nimport tensorflow as tf\n\ncluster = tf.train.ClusterSpec({\"ps\": [\"localhost:33562\"], \"worker\": [\"localhost:12563\"]})\n\nps = tf.train.Server(cluster, job_name=\"ps\", task_index=0)\nworker = tf.train.Server(cluster, job_name=\"worker\", task_index=0)\n\nprint(\"PS: {0}\".format(ps.target))\nprint(\"Worker: {0}\".format(worker.target))\n\nwith tf.Session(worker.target) as sess:\n\n    W = tf.Variable(tf.zeros([784, 10]))\n    b = tf.Variable(tf.zeros([10]))\n\n    init = tf.global_variables_initializer()\n\n    print(\"RUNNING SESSION\")\n    sess.run(init)\n    print(\"SESSION FINISHED\")\n\nbelow are the full log:\n2018-03-29 15:17:37.084856: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-03-29 15:17:38.367466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 0 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:04:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:38.865113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 1 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:05:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:39.369172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 2 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:08:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:39.884151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 3 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:09:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:40.416114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 4 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:85:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:40.903122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 5 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:86:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:41.388600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 6 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:89:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:41.869760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 7 with properties:\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\npciBusID: 0000:8a:00.0\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\n2018-03-29 15:17:41.875020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1227] Device peer to peer matrix\n2018-03-29 15:17:41.875488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1233] DMA: 0 1 2 3 4 5 6 7\n2018-03-29 15:17:41.875509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 0:   Y Y Y Y N N N N\n2018-03-29 15:17:41.875523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 1:   Y Y Y Y N N N N\n2018-03-29 15:17:41.875533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 2:   Y Y Y Y N N N N\n2018-03-29 15:17:41.875543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 3:   Y Y Y Y N N N N\n2018-03-29 15:17:41.875553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 4:   N N N N Y Y Y Y\n2018-03-29 15:17:41.875563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 5:   N N N N Y Y Y Y\n2018-03-29 15:17:41.875572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 6:   N N N N Y Y Y Y\n2018-03-29 15:17:41.875585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 7:   N N N N Y Y Y Y\n2018-03-29 15:17:41.875614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-03-29 15:17:46.028033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:0 with 23084 MB memory) -> physical GPU (device: 0, name: Tesla M40 24GB, pci bus id: 0000:04:00.0, compute capability: 5.2)\n2018-03-29 15:17:46.610150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:1 with 23082 MB memory) -> physical GPU (device: 1, name: Tesla M40 24GB, pci bus id: 0000:05:00.0, compute capability: 5.2)\n2018-03-29 15:17:47.276168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:2 with 23080 MB memory) -> physical GPU (device: 2, name: Tesla M40 24GB, pci bus id: 0000:08:00.0, compute capability: 5.2)\n2018-03-29 15:17:48.026291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:3 with 23080 MB memory) -> physical GPU (device: 3, name: Tesla M40 24GB, pci bus id: 0000:09:00.0, compute capability: 5.2)\n2018-03-29 15:17:49.020908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:4 with 23084 MB memory) -> physical GPU (device: 4, name: Tesla M40 24GB, pci bus id: 0000:85:00.0, compute capability: 5.2)\n2018-03-29 15:17:49.806995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:5 with 23082 MB memory) -> physical GPU (device: 5, name: Tesla M40 24GB, pci bus id: 0000:86:00.0, compute capability: 5.2)\n2018-03-29 15:17:50.654150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:6 with 23080 MB memory) -> physical GPU (device: 6, name: Tesla M40 24GB, pci bus id: 0000:89:00.0, compute capability: 5.2)\n2018-03-29 15:17:51.499643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:7 with 23080 MB memory) -> physical GPU (device: 7, name: Tesla M40 24GB, pci bus id: 0000:8a:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.345019: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:33562}\n2018-03-29 15:17:52.345127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12563}\n2018-03-29 15:17:52.362801: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:324] Started server with target: grpc://localhost:33562\n2018-03-29 15:17:52.363232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-03-29 15:17:52.363789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 983 MB memory) -> physical GPU (device: 0, name: Tesla M40 24GB, pci bus id: 0000:04:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.364275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 985 MB memory) -> physical GPU (device: 1, name: Tesla M40 24GB, pci bus id: 0000:05:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.364715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 987 MB memory) -> physical GPU (device: 2, name: Tesla M40 24GB, pci bus id: 0000:08:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.365138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 987 MB memory) -> physical GPU (device: 3, name: Tesla M40 24GB, pci bus id: 0000:09:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.366627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:4 with 983 MB memory) -> physical GPU (device: 4, name: Tesla M40 24GB, pci bus id: 0000:85:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.367325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:5 with 985 MB memory) -> physical GPU (device: 5, name: Tesla M40 24GB, pci bus id: 0000:86:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.367962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:6 with 987 MB memory) -> physical GPU (device: 6, name: Tesla M40 24GB, pci bus id: 0000:89:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.368731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:7 with 987 MB memory) -> physical GPU (device: 7, name: Tesla M40 24GB, pci bus id: 0000:8a:00.0, compute capability: 5.2)\n2018-03-29 15:17:52.376139: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:33562}\n2018-03-29 15:17:52.376230: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12563}\n2018-03-29 15:17:52.382382: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:324] Started server with target: grpc://localhost:12563\nPS: grpc://localhost:33562\nWorker: grpc://localhost:12563\nRUNNING SESSION\n2018-03-29 15:18:02.506942: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\n2018-03-29 15:18:12.507132: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\n2018-03-29 15:18:22.507277: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\n2018-03-29 15:18:32.507427: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\n2018-03-29 15:18:42.507560: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0", "body": "Hi TF Experts,\r\n\r\nafter I upgrade the tf from 1.0 to 1.5(cuda from 8.0 to 9.0), run the example distributed tensorflow codes failed. below are the codes, it is very simple. The log always output \"CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\". the code works fine for any of my machines whose tf version is under 1.5\r\n```\r\nimport tensorflow as tf\r\n\r\ncluster = tf.train.ClusterSpec({\"ps\": [\"localhost:33562\"], \"worker\": [\"localhost:12563\"]})\r\n\r\nps = tf.train.Server(cluster, job_name=\"ps\", task_index=0)\r\nworker = tf.train.Server(cluster, job_name=\"worker\", task_index=0)\r\n\r\nprint(\"PS: {0}\".format(ps.target))\r\nprint(\"Worker: {0}\".format(worker.target))\r\n\r\nwith tf.Session(worker.target) as sess:\r\n\r\n    W = tf.Variable(tf.zeros([784, 10]))\r\n    b = tf.Variable(tf.zeros([10]))\r\n\r\n    init = tf.global_variables_initializer()\r\n\r\n    print(\"RUNNING SESSION\")\r\n    sess.run(init)\r\n    print(\"SESSION FINISHED\")\r\n```\r\nbelow are the full log:\r\n\r\n2018-03-29 15:17:37.084856: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-03-29 15:17:38.367466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 0 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:04:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:38.865113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 1 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:05:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:39.369172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 2 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:08:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:39.884151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 3 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:09:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:40.416114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 4 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:85:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:40.903122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 5 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:86:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:41.388600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 6 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:89:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:41.869760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 7 with properties: \r\nname: Tesla M40 24GB major: 5 minor: 2 memoryClockRate(GHz): 1.112\r\npciBusID: 0000:8a:00.0\r\ntotalMemory: 23.90GiB freeMemory: 23.78GiB\r\n2018-03-29 15:17:41.875020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1227] Device peer to peer matrix\r\n2018-03-29 15:17:41.875488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1233] DMA: 0 1 2 3 4 5 6 7 \r\n2018-03-29 15:17:41.875509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 0:   Y Y Y Y N N N N \r\n2018-03-29 15:17:41.875523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 1:   Y Y Y Y N N N N \r\n2018-03-29 15:17:41.875533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 2:   Y Y Y Y N N N N \r\n2018-03-29 15:17:41.875543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 3:   Y Y Y Y N N N N \r\n2018-03-29 15:17:41.875553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 4:   N N N N Y Y Y Y \r\n2018-03-29 15:17:41.875563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 5:   N N N N Y Y Y Y \r\n2018-03-29 15:17:41.875572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 6:   N N N N Y Y Y Y \r\n2018-03-29 15:17:41.875585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 7:   N N N N Y Y Y Y \r\n2018-03-29 15:17:41.875614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\r\n2018-03-29 15:17:46.028033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:0 with 23084 MB memory) -> physical GPU (device: 0, name: Tesla M40 24GB, pci bus id: 0000:04:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:46.610150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:1 with 23082 MB memory) -> physical GPU (device: 1, name: Tesla M40 24GB, pci bus id: 0000:05:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:47.276168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:2 with 23080 MB memory) -> physical GPU (device: 2, name: Tesla M40 24GB, pci bus id: 0000:08:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:48.026291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:3 with 23080 MB memory) -> physical GPU (device: 3, name: Tesla M40 24GB, pci bus id: 0000:09:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:49.020908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:4 with 23084 MB memory) -> physical GPU (device: 4, name: Tesla M40 24GB, pci bus id: 0000:85:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:49.806995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:5 with 23082 MB memory) -> physical GPU (device: 5, name: Tesla M40 24GB, pci bus id: 0000:86:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:50.654150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:6 with 23080 MB memory) -> physical GPU (device: 6, name: Tesla M40 24GB, pci bus id: 0000:89:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:51.499643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:ps/replica:0/task:0/device:GPU:7 with 23080 MB memory) -> physical GPU (device: 7, name: Tesla M40 24GB, pci bus id: 0000:8a:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.345019: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:33562}\r\n2018-03-29 15:17:52.345127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12563}\r\n2018-03-29 15:17:52.362801: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:324] Started server with target: grpc://localhost:33562\r\n2018-03-29 15:17:52.363232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\r\n2018-03-29 15:17:52.363789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 983 MB memory) -> physical GPU (device: 0, name: Tesla M40 24GB, pci bus id: 0000:04:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.364275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 985 MB memory) -> physical GPU (device: 1, name: Tesla M40 24GB, pci bus id: 0000:05:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.364715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 987 MB memory) -> physical GPU (device: 2, name: Tesla M40 24GB, pci bus id: 0000:08:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.365138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 987 MB memory) -> physical GPU (device: 3, name: Tesla M40 24GB, pci bus id: 0000:09:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.366627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:4 with 983 MB memory) -> physical GPU (device: 4, name: Tesla M40 24GB, pci bus id: 0000:85:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.367325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:5 with 985 MB memory) -> physical GPU (device: 5, name: Tesla M40 24GB, pci bus id: 0000:86:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.367962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:6 with 987 MB memory) -> physical GPU (device: 6, name: Tesla M40 24GB, pci bus id: 0000:89:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.368731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:worker/replica:0/task:0/device:GPU:7 with 987 MB memory) -> physical GPU (device: 7, name: Tesla M40 24GB, pci bus id: 0000:8a:00.0, compute capability: 5.2)\r\n2018-03-29 15:17:52.376139: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:33562}\r\n2018-03-29 15:17:52.376230: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12563}\r\n2018-03-29 15:17:52.382382: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:324] Started server with target: grpc://localhost:12563\r\nPS: grpc://localhost:33562\r\nWorker: grpc://localhost:12563\r\nRUNNING SESSION\r\n2018-03-29 15:18:02.506942: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\r\n2018-03-29 15:18:12.507132: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\r\n2018-03-29 15:18:22.507277: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\r\n2018-03-29 15:18:32.507427: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\r\n2018-03-29 15:18:42.507560: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:ps/replica:0/task:0\r\n"}