{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/331622780", "html_url": "https://github.com/tensorflow/tensorflow/issues/13018#issuecomment-331622780", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13018", "id": 331622780, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTYyMjc4MA==", "user": {"login": "harpone", "id": 5112840, "node_id": "MDQ6VXNlcjUxMTI4NDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/5112840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harpone", "html_url": "https://github.com/harpone", "followers_url": "https://api.github.com/users/harpone/followers", "following_url": "https://api.github.com/users/harpone/following{/other_user}", "gists_url": "https://api.github.com/users/harpone/gists{/gist_id}", "starred_url": "https://api.github.com/users/harpone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harpone/subscriptions", "organizations_url": "https://api.github.com/users/harpone/orgs", "repos_url": "https://api.github.com/users/harpone/repos", "events_url": "https://api.github.com/users/harpone/events{/privacy}", "received_events_url": "https://api.github.com/users/harpone/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-23T09:32:39Z", "updated_at": "2017-10-12T14:44:22Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a> Yeah already installed a nightly build but thanks! BTW I'm getting some weirdness with (yesterday's) nightly: I'm doing</p>\n<pre><code>    def input_fn():\n        \n        if y is not None:\n            data_this = [(x_, y_) for x_, y_ in zip(x, y)]\n        else:\n            data_this = x\n\n        dataset = tf.contrib.data.Dataset.from_generator(lambda: data_this, (tf.float32, tf.float32))\n        dataset = dataset.map(cropper)\n        dataset = dataset.repeat(epochs)\n        if shuffle:\n            dataset = dataset.shuffle(buffer_size=10000)\n        dataset = dataset.batch(batch_size)\n        iterator = dataset.make_one_shot_iterator()\n\n        if y is not None:\n            features, targets = iterator.get_next()\n            return features, targets\n</code></pre>\n<p>with a dataset formed of lists of same but varying shape x, y tensors. I get<br>\n<code>2017-09-23 12:26:55.844395: W tensorflow/core/framework/op_kernel.cc:1192] Out of range: StopIteration: Iteration finished.</code> which repeats <code>epoch</code> number of before the actual training. If I just do <code>.repeat()</code> it just throws the Out of range message forever...</p>\n<p>Anyway, I'm starting to really like the Dataset class (together with the Estimator). Really impressive work :)</p>\n<p>EDIT: I think the preoblem occurs because the generator is spitting out an entire batch of data instead of single <code>(feature, label)</code> at a time...</p>", "body_text": "@mrry Yeah already installed a nightly build but thanks! BTW I'm getting some weirdness with (yesterday's) nightly: I'm doing\n    def input_fn():\n        \n        if y is not None:\n            data_this = [(x_, y_) for x_, y_ in zip(x, y)]\n        else:\n            data_this = x\n\n        dataset = tf.contrib.data.Dataset.from_generator(lambda: data_this, (tf.float32, tf.float32))\n        dataset = dataset.map(cropper)\n        dataset = dataset.repeat(epochs)\n        if shuffle:\n            dataset = dataset.shuffle(buffer_size=10000)\n        dataset = dataset.batch(batch_size)\n        iterator = dataset.make_one_shot_iterator()\n\n        if y is not None:\n            features, targets = iterator.get_next()\n            return features, targets\n\nwith a dataset formed of lists of same but varying shape x, y tensors. I get\n2017-09-23 12:26:55.844395: W tensorflow/core/framework/op_kernel.cc:1192] Out of range: StopIteration: Iteration finished. which repeats epoch number of before the actual training. If I just do .repeat() it just throws the Out of range message forever...\nAnyway, I'm starting to really like the Dataset class (together with the Estimator). Really impressive work :)\nEDIT: I think the preoblem occurs because the generator is spitting out an entire batch of data instead of single (feature, label) at a time...", "body": "@mrry Yeah already installed a nightly build but thanks! BTW I'm getting some weirdness with (yesterday's) nightly: I'm doing\r\n\r\n```\r\n    def input_fn():\r\n        \r\n        if y is not None:\r\n            data_this = [(x_, y_) for x_, y_ in zip(x, y)]\r\n        else:\r\n            data_this = x\r\n\r\n        dataset = tf.contrib.data.Dataset.from_generator(lambda: data_this, (tf.float32, tf.float32))\r\n        dataset = dataset.map(cropper)\r\n        dataset = dataset.repeat(epochs)\r\n        if shuffle:\r\n            dataset = dataset.shuffle(buffer_size=10000)\r\n        dataset = dataset.batch(batch_size)\r\n        iterator = dataset.make_one_shot_iterator()\r\n\r\n        if y is not None:\r\n            features, targets = iterator.get_next()\r\n            return features, targets\r\n```\r\nwith a dataset formed of lists of same but varying shape x, y tensors. I get\r\n`2017-09-23 12:26:55.844395: W tensorflow/core/framework/op_kernel.cc:1192] Out of range: StopIteration: Iteration finished.` which repeats `epoch` number of before the actual training. If I just do `.repeat()` it just throws the Out of range message forever...\r\n\r\nAnyway, I'm starting to really like the Dataset class (together with the Estimator). Really impressive work :)\r\n\r\nEDIT: I think the preoblem occurs because the generator is spitting out an entire batch of data instead of single `(feature, label)` at a time..."}