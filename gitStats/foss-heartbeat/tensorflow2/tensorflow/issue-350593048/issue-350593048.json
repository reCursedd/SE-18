{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21615", "id": 350593048, "node_id": "MDU6SXNzdWUzNTA1OTMwNDg=", "number": 21615, "title": "Fine tuning a model by building a Scaffold in Mirrored Strategy is not supported", "user": {"login": "lamsalab", "id": 23664489, "node_id": "MDQ6VXNlcjIzNjY0NDg5", "avatar_url": "https://avatars2.githubusercontent.com/u/23664489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamsalab", "html_url": "https://github.com/lamsalab", "followers_url": "https://api.github.com/users/lamsalab/followers", "following_url": "https://api.github.com/users/lamsalab/following{/other_user}", "gists_url": "https://api.github.com/users/lamsalab/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamsalab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamsalab/subscriptions", "organizations_url": "https://api.github.com/users/lamsalab/orgs", "repos_url": "https://api.github.com/users/lamsalab/repos", "events_url": "https://api.github.com/users/lamsalab/events{/privacy}", "received_events_url": "https://api.github.com/users/lamsalab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "open", "locked": false, "assignee": {"login": "seemuch", "id": 2233625, "node_id": "MDQ6VXNlcjIyMzM2MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2233625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seemuch", "html_url": "https://github.com/seemuch", "followers_url": "https://api.github.com/users/seemuch/followers", "following_url": "https://api.github.com/users/seemuch/following{/other_user}", "gists_url": "https://api.github.com/users/seemuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/seemuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seemuch/subscriptions", "organizations_url": "https://api.github.com/users/seemuch/orgs", "repos_url": "https://api.github.com/users/seemuch/repos", "events_url": "https://api.github.com/users/seemuch/events{/privacy}", "received_events_url": "https://api.github.com/users/seemuch/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "seemuch", "id": 2233625, "node_id": "MDQ6VXNlcjIyMzM2MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2233625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seemuch", "html_url": "https://github.com/seemuch", "followers_url": "https://api.github.com/users/seemuch/followers", "following_url": "https://api.github.com/users/seemuch/following{/other_user}", "gists_url": "https://api.github.com/users/seemuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/seemuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seemuch/subscriptions", "organizations_url": "https://api.github.com/users/seemuch/orgs", "repos_url": "https://api.github.com/users/seemuch/repos", "events_url": "https://api.github.com/users/seemuch/events{/privacy}", "received_events_url": "https://api.github.com/users/seemuch/received_events", "type": "User", "site_admin": false}, {"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-08-14T20:51:33Z", "updated_at": "2018-11-12T18:51:41Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<p>Have I written custom code: Yes<br>\nOS Platform and Distribution: Linux Ubuntu 18.04<br>\nMobile device: N/A<br>\nTensorFlow installed from: source<br>\nTensorFlow version: ('v1.9.0-rc2-2165-g7b80190d52', '1.10.0-rc1')<br>\nPython version: 2.7<br>\nBazel version: 0.15.2<br>\nGCC/Compiler version: gcc version 6.4.0 20180424<br>\nCUDA/cuDNN version: 9.1 / 7.1<br>\nGPU model and memory: K80,  12GB<br>\nExact command to reproduce: N/A</p>\n<h3>Describe the problem</h3>\n<p>Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.<br>\nI have been trying to  fine tune my model using Mirrored Strategy. To initialize the weights from a given checkpoint, I pass a scaffold object to Estimator_Spec object, with init_fn as a parameter. However, when I run it, the program crashes (refer to the stacktrace below for more details). I looked around for similar issue, but couldn't find any. Hence, I had to dig through the source code to figure the cause of the issue. While exploring, I ran into this message:<br>\n<strong>TODO(anjalisridhar): Figure out how to resolve the following scaffold parameters: init_feed_dict, init_fn</strong><br>\ncalled here:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/estimator/estimator.py#L1599\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/estimator/estimator.py#L1599</a></p>\n<p>I was wondering whether fixing this is on priority list, or whether it has been sitting on the back burner until other issues have been resolved.</p>\n<p>i am not sure how to present a reproducible code in this context, but do let me know if I need to clarify some more.</p>\n<h3>Source code / logs</h3>\n<p>Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.</p>\n<p>INFO:tensorflow:Using config: {'_save_checkpoints_secs': 120, '_session_config': allow_soft_placement: true<br>\n, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': &lt;tensorflow.contrib.distribute.python.mirrored_strategy.MirroredStrategy object at 0x7fd221bfad10&gt;, '_is_chief': True, '_cluster_spec': &lt;tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd221bfacd0&gt;, '_model_dir': '../data/model2', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_evaluation_master': '', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': ''}<br>\n2018-08-11 08:50:44.010343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties:<br>\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235<br>\npciBusID: 0000:04:00.0<br>\ntotalMemory: 11.17GiB freeMemory: 11.10GiB<br>\n2018-08-11 08:50:44.164489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties:<br>\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235<br>\npciBusID: 0000:05:00.0<br>\ntotalMemory: 11.17GiB freeMemory: 11.10GiB<br>\n2018-08-11 08:50:44.164798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1<br>\n2018-08-11 08:50:44.719187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-08-11 08:50:44.719236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1<br>\n2018-08-11 08:50:44.719243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y<br>\n2018-08-11 08:50:44.719247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N<br>\n2018-08-11 08:50:44.719771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:0 with 10757 MB memory) -&gt; physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)<br>\n2018-08-11 08:50:44.885422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:1 with 10757 MB memory) -&gt; physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)<br>\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0<br>\nINFO:tensorflow:Configured nccl all-reduce.<br>\n2018-08-11 08:50:45.166638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1<br>\n2018-08-11 08:50:45.166758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-08-11 08:50:45.166769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1<br>\n2018-08-11 08:50:45.166777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y<br>\n2018-08-11 08:50:45.166793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N<br>\n2018-08-11 08:50:45.167078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10757 MB memory) -&gt; physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)<br>\n2018-08-11 08:50:45.167251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10757 MB memory) -&gt; physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)<br>\nINFO:tensorflow:Calling model_fn.<br>\nINFO:tensorflow:Calling model_fn.<br>\nINFO:tensorflow:batch_all_reduce invoked for batches size = 34 with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10<br>\nINFO:tensorflow:Done calling model_fn.<br>\nINFO:tensorflow:Done calling model_fn.<br>\nTraceback (most recent call last):<br>\nFile \"train.py\", line 167, in <br>\ntf.app.run()<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run<br>\n_sys.exit(main(argv))<br>\nFile \"train.py\", line 164, in main<br>\nclassifier.train( input_fn=_get_input, max_steps=FLAGS.max_num_steps )<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 343, in train<br>\nloss = self._train_model(input_fn, hooks, saving_listeners)<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1127, in _train_model<br>\nreturn self._train_model_distributed(input_fn, hooks, saving_listeners)<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1256, in _train_model_distributed<br>\ngrouped_estimator_spec.scaffold, self._train_distribution)<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1576, in _combine_distributed_scaffold<br>\ninit_fn = distribution.group(init_fn)<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/training/distribute.py\", line 1007, in group<br>\nreturn control_flow_ops.group(value, name=name)<br>\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3396, in group<br>\n\"'%s' with type '%s'\" % (inp, type(inp)))<br>\n<strong>TypeError: Expected tf.group() expected Tensor arguments not '&lt;function  at 0x7fcfe46a8c08&gt;' with type '&lt;type 'function'&gt;'</strong></p>", "body_text": "System information\nHave I written custom code: Yes\nOS Platform and Distribution: Linux Ubuntu 18.04\nMobile device: N/A\nTensorFlow installed from: source\nTensorFlow version: ('v1.9.0-rc2-2165-g7b80190d52', '1.10.0-rc1')\nPython version: 2.7\nBazel version: 0.15.2\nGCC/Compiler version: gcc version 6.4.0 20180424\nCUDA/cuDNN version: 9.1 / 7.1\nGPU model and memory: K80,  12GB\nExact command to reproduce: N/A\nDescribe the problem\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\nI have been trying to  fine tune my model using Mirrored Strategy. To initialize the weights from a given checkpoint, I pass a scaffold object to Estimator_Spec object, with init_fn as a parameter. However, when I run it, the program crashes (refer to the stacktrace below for more details). I looked around for similar issue, but couldn't find any. Hence, I had to dig through the source code to figure the cause of the issue. While exploring, I ran into this message:\nTODO(anjalisridhar): Figure out how to resolve the following scaffold parameters: init_feed_dict, init_fn\ncalled here:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/estimator/estimator.py#L1599\nI was wondering whether fixing this is on priority list, or whether it has been sitting on the back burner until other issues have been resolved.\ni am not sure how to present a reproducible code in this context, but do let me know if I need to clarify some more.\nSource code / logs\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 120, '_session_config': allow_soft_placement: true\n, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': <tensorflow.contrib.distribute.python.mirrored_strategy.MirroredStrategy object at 0x7fd221bfad10>, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd221bfacd0>, '_model_dir': '../data/model2', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_evaluation_master': '', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': ''}\n2018-08-11 08:50:44.010343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:04:00.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-08-11 08:50:44.164489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:05:00.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-08-11 08:50:44.164798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1\n2018-08-11 08:50:44.719187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-11 08:50:44.719236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1\n2018-08-11 08:50:44.719243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y\n2018-08-11 08:50:44.719247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N\n2018-08-11 08:50:44.719771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:0 with 10757 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)\n2018-08-11 08:50:44.885422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:1 with 10757 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0\nINFO:tensorflow:Configured nccl all-reduce.\n2018-08-11 08:50:45.166638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1\n2018-08-11 08:50:45.166758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-11 08:50:45.166769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1\n2018-08-11 08:50:45.166777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y\n2018-08-11 08:50:45.166793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N\n2018-08-11 08:50:45.167078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10757 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)\n2018-08-11 08:50:45.167251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10757 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:batch_all_reduce invoked for batches size = 34 with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nTraceback (most recent call last):\nFile \"train.py\", line 167, in \ntf.app.run()\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\nFile \"train.py\", line 164, in main\nclassifier.train( input_fn=_get_input, max_steps=FLAGS.max_num_steps )\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 343, in train\nloss = self._train_model(input_fn, hooks, saving_listeners)\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1127, in _train_model\nreturn self._train_model_distributed(input_fn, hooks, saving_listeners)\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1256, in _train_model_distributed\ngrouped_estimator_spec.scaffold, self._train_distribution)\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1576, in _combine_distributed_scaffold\ninit_fn = distribution.group(init_fn)\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/training/distribute.py\", line 1007, in group\nreturn control_flow_ops.group(value, name=name)\nFile \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3396, in group\n\"'%s' with type '%s'\" % (inp, type(inp)))\nTypeError: Expected tf.group() expected Tensor arguments not '<function  at 0x7fcfe46a8c08>' with type '<type 'function'>'", "body": "### System information\r\nHave I written custom code: Yes\r\nOS Platform and Distribution: Linux Ubuntu 18.04\r\nMobile device: N/A\r\nTensorFlow installed from: source\r\nTensorFlow version: ('v1.9.0-rc2-2165-g7b80190d52', '1.10.0-rc1')\r\nPython version: 2.7\r\nBazel version: 0.15.2\r\nGCC/Compiler version: gcc version 6.4.0 20180424\r\nCUDA/cuDNN version: 9.1 / 7.1\r\nGPU model and memory: K80,  12GB\r\nExact command to reproduce: N/A\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\nI have been trying to  fine tune my model using Mirrored Strategy. To initialize the weights from a given checkpoint, I pass a scaffold object to Estimator_Spec object, with init_fn as a parameter. However, when I run it, the program crashes (refer to the stacktrace below for more details). I looked around for similar issue, but couldn't find any. Hence, I had to dig through the source code to figure the cause of the issue. While exploring, I ran into this message:\r\n**TODO(anjalisridhar): Figure out how to resolve the following scaffold parameters: init_feed_dict, init_fn**\r\ncalled here:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/estimator/estimator.py#L1599\r\n\r\nI was wondering whether fixing this is on priority list, or whether it has been sitting on the back burner until other issues have been resolved.\r\n\r\ni am not sure how to present a reproducible code in this context, but do let me know if I need to clarify some more.\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n\r\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 120, '_session_config': allow_soft_placement: true\r\n, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': <tensorflow.contrib.distribute.python.mirrored_strategy.MirroredStrategy object at 0x7fd221bfad10>, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd221bfacd0>, '_model_dir': '../data/model2', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_evaluation_master': '', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': ''}\r\n2018-08-11 08:50:44.010343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:04:00.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-08-11 08:50:44.164489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:05:00.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-08-11 08:50:44.164798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1\r\n2018-08-11 08:50:44.719187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-11 08:50:44.719236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1\r\n2018-08-11 08:50:44.719243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y\r\n2018-08-11 08:50:44.719247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N\r\n2018-08-11 08:50:44.719771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:0 with 10757 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)\r\n2018-08-11 08:50:44.885422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:1 with 10757 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)\r\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0\r\nINFO:tensorflow:Configured nccl all-reduce.\r\n2018-08-11 08:50:45.166638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1\r\n2018-08-11 08:50:45.166758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-11 08:50:45.166769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1\r\n2018-08-11 08:50:45.166777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y\r\n2018-08-11 08:50:45.166793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N\r\n2018-08-11 08:50:45.167078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10757 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)\r\n2018-08-11 08:50:45.167251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10757 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:batch_all_reduce invoked for batches size = 34 with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 167, in <module>\r\n    tf.app.run()\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"train.py\", line 164, in main\r\n    classifier.train( input_fn=_get_input, max_steps=FLAGS.max_num_steps )\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 343, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1127, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1256, in _train_model_distributed\r\n    grouped_estimator_spec.scaffold, self._train_distribution)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1576, in _combine_distributed_scaffold\r\n    init_fn = distribution.group(init_fn)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/training/distribute.py\", line 1007, in group\r\n    return control_flow_ops.group(value, name=name)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3396, in group\r\n    \"'%s' with type '%s'\" % (inp, type(inp)))\r\n**TypeError: Expected tf.group() expected Tensor arguments not '<function <lambda> at 0x7fcfe46a8c08>' with type '<type 'function'>'**"}