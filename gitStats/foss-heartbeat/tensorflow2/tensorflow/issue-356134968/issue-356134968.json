{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21998", "id": 356134968, "node_id": "MDU6SXNzdWUzNTYxMzQ5Njg=", "number": 21998, "title": "TensorRT INT8 assertion failed when performing calibration", "user": {"login": "qinyao-he", "id": 6523975, "node_id": "MDQ6VXNlcjY1MjM5NzU=", "avatar_url": "https://avatars2.githubusercontent.com/u/6523975?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qinyao-he", "html_url": "https://github.com/qinyao-he", "followers_url": "https://api.github.com/users/qinyao-he/followers", "following_url": "https://api.github.com/users/qinyao-he/following{/other_user}", "gists_url": "https://api.github.com/users/qinyao-he/gists{/gist_id}", "starred_url": "https://api.github.com/users/qinyao-he/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qinyao-he/subscriptions", "organizations_url": "https://api.github.com/users/qinyao-he/orgs", "repos_url": "https://api.github.com/users/qinyao-he/repos", "events_url": "https://api.github.com/users/qinyao-he/events{/privacy}", "received_events_url": "https://api.github.com/users/qinyao-he/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-08-31T21:59:32Z", "updated_at": "2018-11-20T13:30:27Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nNo</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nUbuntu 16.04</p>\n</li>\n<li>\n<p><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>:</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>:<br>\nsource</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>:<br>\n('v1.9.0-rc2-3472-g61038f8', '1.10.0')<br>\ngithub master commit: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/61038f89e98fc430c56a9aa056692413c82eaafa/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/61038f89e98fc430c56a9aa056692413c82eaafa\"><tt>61038f8</tt></a></p>\n</li>\n<li>\n<p><strong>Python version</strong>:</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>:<br>\n0.16.1</p>\n</li>\n<li>\n<p><strong>GCC/Compiler version (if compiling from source)</strong>:<br>\n5.4.0</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:<br>\nCUDA 9.0 cuDNN 7.1.4</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\nTitan V</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:<br>\nI build TensorFlow from source with TensorRT 4.</p>\n</li>\n</ul>\n<p>Use official TensorFlow-TensorRT example:<br>\n<a href=\"https://github.com/tensorflow/models/tree/master/research/tensorrt\">https://github.com/tensorflow/models/tree/master/research/tensorrt</a><br>\nand do INT8 test with command:</p>\n<blockquote>\n<p>python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb --image_file=image.jpg --int8 --output_dir=output</p>\n</blockquote>\n<p>Note that you should download ImageNet pretrained model <a href=\"http://download.tensorflow.org/models/official/resnetv2_imagenet_frozen_graph.pb\" rel=\"nofollow\">http://download.tensorflow.org/models/official/resnetv2_imagenet_frozen_graph.pb</a></p>\n<h3>Describe the problem</h3>\n<p>Program core dumped when doing calibration step</p>\n<blockquote>\n<p>INFO:tensorflow:Starting Warmup cycle<br>\n2018-08-31 14:53:15.227087: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f0001860<br>\n2018-08-31 14:53:31.166463: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f1709b00<br>\npython: helpers.cpp:56: nvinfer1::DimsCHW nvinfer1::getCHW(const nvinfer1::Dims&amp;): Assertion `d.nbDims &gt;= 3' failed.<br>\n[1]    4880 abort (core dumped)  python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb  --int8</p>\n</blockquote>\n<p>This problem doesn't exist with tf 1.7 and 1.8.</p>", "body_text": "System information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNo\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nUbuntu 16.04\n\n\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\n\n\nTensorFlow installed from (source or binary):\nsource\n\n\nTensorFlow version (use command below):\n('v1.9.0-rc2-3472-g61038f8', '1.10.0')\ngithub master commit: 61038f8\n\n\nPython version:\n\n\nBazel version (if compiling from source):\n0.16.1\n\n\nGCC/Compiler version (if compiling from source):\n5.4.0\n\n\nCUDA/cuDNN version:\nCUDA 9.0 cuDNN 7.1.4\n\n\nGPU model and memory:\nTitan V\n\n\nExact command to reproduce:\nI build TensorFlow from source with TensorRT 4.\n\n\nUse official TensorFlow-TensorRT example:\nhttps://github.com/tensorflow/models/tree/master/research/tensorrt\nand do INT8 test with command:\n\npython tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb --image_file=image.jpg --int8 --output_dir=output\n\nNote that you should download ImageNet pretrained model http://download.tensorflow.org/models/official/resnetv2_imagenet_frozen_graph.pb\nDescribe the problem\nProgram core dumped when doing calibration step\n\nINFO:tensorflow:Starting Warmup cycle\n2018-08-31 14:53:15.227087: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f0001860\n2018-08-31 14:53:31.166463: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f1709b00\npython: helpers.cpp:56: nvinfer1::DimsCHW nvinfer1::getCHW(const nvinfer1::Dims&): Assertion `d.nbDims >= 3' failed.\n[1]    4880 abort (core dumped)  python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb  --int8\n\nThis problem doesn't exist with tf 1.7 and 1.8.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nUbuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\nsource\r\n- **TensorFlow version (use command below)**:\r\n('v1.9.0-rc2-3472-g61038f8', '1.10.0')\r\ngithub master commit: 61038f89e98fc430c56a9aa056692413c82eaafa\r\n\r\n- **Python version**:\r\n- **Bazel version (if compiling from source)**:\r\n0.16.1\r\n- **GCC/Compiler version (if compiling from source)**:\r\n5.4.0\r\n- **CUDA/cuDNN version**:\r\nCUDA 9.0 cuDNN 7.1.4\r\n- **GPU model and memory**:\r\nTitan V\r\n- **Exact command to reproduce**:\r\nI build TensorFlow from source with TensorRT 4.\r\n\r\nUse official TensorFlow-TensorRT example:\r\nhttps://github.com/tensorflow/models/tree/master/research/tensorrt\r\nand do INT8 test with command:\r\n\r\n> python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb --image_file=image.jpg --int8 --output_dir=output\r\n\r\nNote that you should download ImageNet pretrained model http://download.tensorflow.org/models/official/resnetv2_imagenet_frozen_graph.pb\r\n\r\n### Describe the problem\r\nProgram core dumped when doing calibration step\r\n\r\n> INFO:tensorflow:Starting Warmup cycle\r\n> 2018-08-31 14:53:15.227087: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f0001860                             \r\n> 2018-08-31 14:53:31.166463: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f1709b00                             \r\n> python: helpers.cpp:56: nvinfer1::DimsCHW nvinfer1::getCHW(const nvinfer1::Dims&): Assertion `d.nbDims >= 3' failed.                                                                               \r\n> [1]    4880 abort (core dumped)  python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb  --int8\r\n\r\nThis problem doesn't exist with tf 1.7 and 1.8.\r\n"}