{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6716", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6716/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6716/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6716/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6716", "id": 199382238, "node_id": "MDU6SXNzdWUxOTkzODIyMzg=", "number": 6716, "title": "Feature request: easier access to tensor de-allocation information", "user": {"login": "yaroslavvb", "id": 23068, "node_id": "MDQ6VXNlcjIzMDY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaroslavvb", "html_url": "https://github.com/yaroslavvb", "followers_url": "https://api.github.com/users/yaroslavvb/followers", "following_url": "https://api.github.com/users/yaroslavvb/following{/other_user}", "gists_url": "https://api.github.com/users/yaroslavvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaroslavvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaroslavvb/subscriptions", "organizations_url": "https://api.github.com/users/yaroslavvb/orgs", "repos_url": "https://api.github.com/users/yaroslavvb/repos", "events_url": "https://api.github.com/users/yaroslavvb/events{/privacy}", "received_events_url": "https://api.github.com/users/yaroslavvb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 21, "created_at": "2017-01-07T20:07:38Z", "updated_at": "2018-02-07T23:54:54Z", "closed_at": "2018-02-07T23:54:54Z", "author_association": "CONTRIBUTOR", "body_html": "<p>TLDR; to debug TensorFlow out-of-memory situations one needs to see tensor de-allocation info.</p>\n<p>You can see allocation stats in timeline, but without de-allocation info you can't calculate peak memory. Currently getting peak memory is possible by:</p>\n<ol>\n<li>\n<p>Hacking TensorFlow to print deallocation messages with timestamps as <a href=\"https://github.com/yaroslavvb/tensorflow/commit/5d4cd97c0a73e91ee37c025cd7a62fb46aae76a0\">here</a></p>\n</li>\n<li>\n<p>A bunch of regular expression to parse <code>__LOG_MEMORY__</code> messages as in <a href=\"https://github.com/yaroslavvb/notebooks/blob/master/saving%20memory%20by%20using%20functions.ipynb\">here</a></p>\n</li>\n</ol>\n<p>Since this needs building your own version of tensorflow, this is not accessible to most people. Perhaps this can be remedied by adding deallocation events to session run timeline? <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5376757\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/michaelisard\">@michaelisard</a></p>\n<p>Some recent places this issue came up:<br>\n<a href=\"http://stackoverflow.com/questions/41517145/outer-product-based-conv-filters-consume-disproportionately-high-memory\" rel=\"nofollow\">http://stackoverflow.com/questions/41517145/outer-product-based-conv-filters-consume-disproportionately-high-memory</a><br>\n<a href=\"http://stackoverflow.com/questions/41496251/fitting-large-matrix-calculations-into-memory-when-using-tensorflow\" rel=\"nofollow\">http://stackoverflow.com/questions/41496251/fitting-large-matrix-calculations-into-memory-when-using-tensorflow</a><br>\n<a href=\"http://stackoverflow.com/questions/41451273/tensorflow-specifying-storage-of-layer-activations\" rel=\"nofollow\">http://stackoverflow.com/questions/41451273/tensorflow-specifying-storage-of-layer-activations</a><br>\n<a href=\"http://stackoverflow.com/questions/40190510/tensorflow-how-to-log-gpu-memory-vram-utilization/40197094#comment70145571_40197094\" rel=\"nofollow\">http://stackoverflow.com/questions/40190510/tensorflow-how-to-log-gpu-memory-vram-utilization/40197094#comment70145571_40197094</a><br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"192908142\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/6019\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/6019/hovercard?comment_id=268037463&amp;comment_type=issue_comment\" href=\"https://github.com/tensorflow/tensorflow/issues/6019#issuecomment-268037463\">#6019 (comment)</a></p>", "body_text": "TLDR; to debug TensorFlow out-of-memory situations one needs to see tensor de-allocation info.\nYou can see allocation stats in timeline, but without de-allocation info you can't calculate peak memory. Currently getting peak memory is possible by:\n\n\nHacking TensorFlow to print deallocation messages with timestamps as here\n\n\nA bunch of regular expression to parse __LOG_MEMORY__ messages as in here\n\n\nSince this needs building your own version of tensorflow, this is not accessible to most people. Perhaps this can be remedied by adding deallocation events to session run timeline? @michaelisard\nSome recent places this issue came up:\nhttp://stackoverflow.com/questions/41517145/outer-product-based-conv-filters-consume-disproportionately-high-memory\nhttp://stackoverflow.com/questions/41496251/fitting-large-matrix-calculations-into-memory-when-using-tensorflow\nhttp://stackoverflow.com/questions/41451273/tensorflow-specifying-storage-of-layer-activations\nhttp://stackoverflow.com/questions/40190510/tensorflow-how-to-log-gpu-memory-vram-utilization/40197094#comment70145571_40197094\n#6019 (comment)", "body": "TLDR; to debug TensorFlow out-of-memory situations one needs to see tensor de-allocation info.\r\n\r\nYou can see allocation stats in timeline, but without de-allocation info you can't calculate peak memory. Currently getting peak memory is possible by:\r\n\r\n1. Hacking TensorFlow to print deallocation messages with timestamps as [here](https://github.com/yaroslavvb/tensorflow/commit/5d4cd97c0a73e91ee37c025cd7a62fb46aae76a0)\r\n\r\n2. A bunch of regular expression to parse `__LOG_MEMORY__` messages as in [here](https://github.com/yaroslavvb/notebooks/blob/master/saving%20memory%20by%20using%20functions.ipynb)\r\n\r\nSince this needs building your own version of tensorflow, this is not accessible to most people. Perhaps this can be remedied by adding deallocation events to session run timeline? @michaelisard \r\n\r\nSome recent places this issue came up:\r\nhttp://stackoverflow.com/questions/41517145/outer-product-based-conv-filters-consume-disproportionately-high-memory\r\nhttp://stackoverflow.com/questions/41496251/fitting-large-matrix-calculations-into-memory-when-using-tensorflow\r\nhttp://stackoverflow.com/questions/41451273/tensorflow-specifying-storage-of-layer-activations\r\nhttp://stackoverflow.com/questions/40190510/tensorflow-how-to-log-gpu-memory-vram-utilization/40197094#comment70145571_40197094\r\nhttps://github.com/tensorflow/tensorflow/issues/6019#issuecomment-268037463"}