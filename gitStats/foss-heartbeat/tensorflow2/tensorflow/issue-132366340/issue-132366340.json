{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1028", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1028/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1028/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1028/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1028", "id": 132366340, "node_id": "MDU6SXNzdWUxMzIzNjYzNDA=", "number": 1028, "title": "Tensorflow with CUDA build failure in Docker", "user": {"login": "AlexJoz", "id": 12504137, "node_id": "MDQ6VXNlcjEyNTA0MTM3", "avatar_url": "https://avatars2.githubusercontent.com/u/12504137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlexJoz", "html_url": "https://github.com/AlexJoz", "followers_url": "https://api.github.com/users/AlexJoz/followers", "following_url": "https://api.github.com/users/AlexJoz/following{/other_user}", "gists_url": "https://api.github.com/users/AlexJoz/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlexJoz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlexJoz/subscriptions", "organizations_url": "https://api.github.com/users/AlexJoz/orgs", "repos_url": "https://api.github.com/users/AlexJoz/repos", "events_url": "https://api.github.com/users/AlexJoz/events{/privacy}", "received_events_url": "https://api.github.com/users/AlexJoz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-02-09T09:14:07Z", "updated_at": "2016-02-11T01:20:06Z", "closed_at": "2016-02-11T01:20:06Z", "author_association": "NONE", "body_html": "<p>Hello) Trying to make dockerfile with ubuntu 14, tensorflow on python3 with cuda and ec2 support ..</p>\n<p>TF ver 0.6.0<br>\nBazel ver 0.1.4<br>\nStarting from docker image: nvidia/cuda:7.0-cudnn2-devel</p>\n<p>In dockerfile have smth like this:</p>\n<pre><code>\nRUN TF_UNOFFICIAL_SETTING=1 \\\n     TF_CUDA_COMPUTE_CAPABILITIES=3.0 \\\n     PYTHON_BIN_PATH=/usr/bin/python3 ./configure &amp;&amp; \\\n   bazel build \\\n     --config=cuda \\\n     --verbose_failures \\\n     --spawn_strategy=standalone \\\n     --local_resources 4096,1.0,1.0 \\\n     tensorflow/tools/pip_package:build_pip_package &amp;&amp; \\\n\n    bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &amp;&amp; \\\n\n    echo $(date) : \"=== Building wheel\" &amp;&amp; \\\n\n    python3 setup.py bdist_wheel --python-tag py34 &gt;/dev/null &amp;&amp; \\\n\n    pip3 install --upgrade /tmp/pip/tensorflow-0.6.0-py34-none-any.whl\n</code></pre>\n<p>Without --localresources had \"Killed\" error like <a href=\"http://stackoverflow.com/questions/34699069/building-tensorflow-from-source-on-ubuntu-14-04-lts-gcc-internal-compiler-erro\" rel=\"nofollow\">here</a><br>\n--spawn_strategy from <a href=\"https://github.com/bazelbuild/bazel/issues/698\" data-hovercard-type=\"issue\" data-hovercard-url=\"/bazelbuild/bazel/issues/698/hovercard\">here</a></p>\n<p>Now have such error, and have no idea what to do next =(</p>\n<pre><code>\n`____[577 / 1,175] Compiling tensorflow/python/pywrap_tensorflow.cc\n____[580 / 1,175] Compiling tensorflow/core/util/work_sharder.cc [for host]\n____[585 / 1,175] Compiling tensorflow/core/lib/hash/crc32c.cc [for host]\n____[587 / 1,175] Compiling tensorflow/core/lib/histogram/histogram.cc [for host\n]\nERROR: /tensorflow/tensorflow/stream_executor/BUILD:5:1: undeclared inclusion(s)\nin rule '//tensorflow/stream_executor:stream_executor':\nthis rule is missing dependency declarations for the following files included by\n'tensorflow/stream_executor/cuda/cuda_rng.cc':\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_rng.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_activation.h'\n'/tensorflow/tensorflow/stream_executor/cuda/multi_op_activation.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_gpu_executor.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_kernel.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_driver.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_helpers.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_platform_id.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_stream.h'.\n\n____Building complete.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\n\n____Elapsed time: 998.708s, Critical Path: 715.53s`\n</code></pre>", "body_text": "Hello) Trying to make dockerfile with ubuntu 14, tensorflow on python3 with cuda and ec2 support ..\nTF ver 0.6.0\nBazel ver 0.1.4\nStarting from docker image: nvidia/cuda:7.0-cudnn2-devel\nIn dockerfile have smth like this:\n\nRUN TF_UNOFFICIAL_SETTING=1 \\\n     TF_CUDA_COMPUTE_CAPABILITIES=3.0 \\\n     PYTHON_BIN_PATH=/usr/bin/python3 ./configure && \\\n   bazel build \\\n     --config=cuda \\\n     --verbose_failures \\\n     --spawn_strategy=standalone \\\n     --local_resources 4096,1.0,1.0 \\\n     tensorflow/tools/pip_package:build_pip_package && \\\n\n    bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip && \\\n\n    echo $(date) : \"=== Building wheel\" && \\\n\n    python3 setup.py bdist_wheel --python-tag py34 >/dev/null && \\\n\n    pip3 install --upgrade /tmp/pip/tensorflow-0.6.0-py34-none-any.whl\n\nWithout --localresources had \"Killed\" error like here\n--spawn_strategy from here\nNow have such error, and have no idea what to do next =(\n\n`____[577 / 1,175] Compiling tensorflow/python/pywrap_tensorflow.cc\n____[580 / 1,175] Compiling tensorflow/core/util/work_sharder.cc [for host]\n____[585 / 1,175] Compiling tensorflow/core/lib/hash/crc32c.cc [for host]\n____[587 / 1,175] Compiling tensorflow/core/lib/histogram/histogram.cc [for host\n]\nERROR: /tensorflow/tensorflow/stream_executor/BUILD:5:1: undeclared inclusion(s)\nin rule '//tensorflow/stream_executor:stream_executor':\nthis rule is missing dependency declarations for the following files included by\n'tensorflow/stream_executor/cuda/cuda_rng.cc':\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_rng.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_activation.h'\n'/tensorflow/tensorflow/stream_executor/cuda/multi_op_activation.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_gpu_executor.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_kernel.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_driver.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_helpers.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_platform_id.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_stream.h'.\n\n____Building complete.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\n\n____Elapsed time: 998.708s, Critical Path: 715.53s`", "body": "Hello) Trying to make dockerfile with ubuntu 14, tensorflow on python3 with cuda and ec2 support ..\n\nTF ver 0.6.0\nBazel ver 0.1.4\nStarting from docker image: nvidia/cuda:7.0-cudnn2-devel\n\nIn dockerfile have smth like this:\n\n```\n\nRUN TF_UNOFFICIAL_SETTING=1 \\\n     TF_CUDA_COMPUTE_CAPABILITIES=3.0 \\\n     PYTHON_BIN_PATH=/usr/bin/python3 ./configure && \\\n   bazel build \\\n     --config=cuda \\\n     --verbose_failures \\\n     --spawn_strategy=standalone \\\n     --local_resources 4096,1.0,1.0 \\\n     tensorflow/tools/pip_package:build_pip_package && \\\n\n    bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip && \\\n\n    echo $(date) : \"=== Building wheel\" && \\\n\n    python3 setup.py bdist_wheel --python-tag py34 >/dev/null && \\\n\n    pip3 install --upgrade /tmp/pip/tensorflow-0.6.0-py34-none-any.whl\n```\n\nWithout --localresources had \"Killed\" error like [here](http://stackoverflow.com/questions/34699069/building-tensorflow-from-source-on-ubuntu-14-04-lts-gcc-internal-compiler-erro)\n--spawn_strategy from [here](https://github.com/bazelbuild/bazel/issues/698)\n\nNow have such error, and have no idea what to do next =(\n\n```\n\n`____[577 / 1,175] Compiling tensorflow/python/pywrap_tensorflow.cc\n____[580 / 1,175] Compiling tensorflow/core/util/work_sharder.cc [for host]\n____[585 / 1,175] Compiling tensorflow/core/lib/hash/crc32c.cc [for host]\n____[587 / 1,175] Compiling tensorflow/core/lib/histogram/histogram.cc [for host\n]\nERROR: /tensorflow/tensorflow/stream_executor/BUILD:5:1: undeclared inclusion(s)\nin rule '//tensorflow/stream_executor:stream_executor':\nthis rule is missing dependency declarations for the following files included by\n'tensorflow/stream_executor/cuda/cuda_rng.cc':\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_rng.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_activation.h'\n'/tensorflow/tensorflow/stream_executor/cuda/multi_op_activation.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_gpu_executor.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_kernel.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_driver.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_helpers.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_platform_id.h'\n'/tensorflow/tensorflow/stream_executor/cuda/cuda_stream.h'.\n\n____Building complete.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\n\n____Elapsed time: 998.708s, Critical Path: 715.53s`\n```\n"}