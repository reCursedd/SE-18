{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/189337545", "html_url": "https://github.com/tensorflow/tensorflow/issues/435#issuecomment-189337545", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/435", "id": 189337545, "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTMzNzU0NQ==", "user": {"login": "fxsuper", "id": 16196995, "node_id": "MDQ6VXNlcjE2MTk2OTk1", "avatar_url": "https://avatars1.githubusercontent.com/u/16196995?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxsuper", "html_url": "https://github.com/fxsuper", "followers_url": "https://api.github.com/users/fxsuper/followers", "following_url": "https://api.github.com/users/fxsuper/following{/other_user}", "gists_url": "https://api.github.com/users/fxsuper/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxsuper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxsuper/subscriptions", "organizations_url": "https://api.github.com/users/fxsuper/orgs", "repos_url": "https://api.github.com/users/fxsuper/repos", "events_url": "https://api.github.com/users/fxsuper/events{/privacy}", "received_events_url": "https://api.github.com/users/fxsuper/received_events", "type": "User", "site_admin": false}, "created_at": "2016-02-26T15:56:15Z", "updated_at": "2016-02-26T15:56:15Z", "author_association": "NONE", "body_html": "<p>Hmmm I'm getting some very strange results. So just to be sure, the way I'm controlling threads is by invoking a session this way:</p>\n<pre><code>num_threads = 4\nsess = tf.Session(config=tf.ConfigProto(inter_op_parallelism_threads=num_threads,\n                                                   intra_op_parallelism_threads=num_threads,\n                                                   log_device_placement=False,\n                                                   allow_soft_placement=False))\n</code></pre>\n<p>Strangely, when I set <code>num_threads</code> to 1, <em>both</em> implementations speed up, contrary to your expectation. My implementation goes from 0.06 secs to 0.03 secs, and <code>tf.cross</code> goes from 0.1 secs to 0.05 secs. Not sure why this is happening. The tests are very minimal, just basically what I wrote earlier.</p>", "body_text": "Hmmm I'm getting some very strange results. So just to be sure, the way I'm controlling threads is by invoking a session this way:\nnum_threads = 4\nsess = tf.Session(config=tf.ConfigProto(inter_op_parallelism_threads=num_threads,\n                                                   intra_op_parallelism_threads=num_threads,\n                                                   log_device_placement=False,\n                                                   allow_soft_placement=False))\n\nStrangely, when I set num_threads to 1, both implementations speed up, contrary to your expectation. My implementation goes from 0.06 secs to 0.03 secs, and tf.cross goes from 0.1 secs to 0.05 secs. Not sure why this is happening. The tests are very minimal, just basically what I wrote earlier.", "body": "Hmmm I'm getting some very strange results. So just to be sure, the way I'm controlling threads is by invoking a session this way:\n\n```\nnum_threads = 4\nsess = tf.Session(config=tf.ConfigProto(inter_op_parallelism_threads=num_threads,\n                                                   intra_op_parallelism_threads=num_threads,\n                                                   log_device_placement=False,\n                                                   allow_soft_placement=False))\n```\n\nStrangely, when I set `num_threads` to 1, _both_ implementations speed up, contrary to your expectation. My implementation goes from 0.06 secs to 0.03 secs, and `tf.cross` goes from 0.1 secs to 0.05 secs. Not sure why this is happening. The tests are very minimal, just basically what I wrote earlier.\n"}