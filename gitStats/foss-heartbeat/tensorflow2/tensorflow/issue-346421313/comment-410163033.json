{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/410163033", "html_url": "https://github.com/tensorflow/tensorflow/issues/21294#issuecomment-410163033", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21294", "id": 410163033, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDE2MzAzMw==", "user": {"login": "joyicejin", "id": 32789540, "node_id": "MDQ6VXNlcjMyNzg5NTQw", "avatar_url": "https://avatars2.githubusercontent.com/u/32789540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joyicejin", "html_url": "https://github.com/joyicejin", "followers_url": "https://api.github.com/users/joyicejin/followers", "following_url": "https://api.github.com/users/joyicejin/following{/other_user}", "gists_url": "https://api.github.com/users/joyicejin/gists{/gist_id}", "starred_url": "https://api.github.com/users/joyicejin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joyicejin/subscriptions", "organizations_url": "https://api.github.com/users/joyicejin/orgs", "repos_url": "https://api.github.com/users/joyicejin/repos", "events_url": "https://api.github.com/users/joyicejin/events{/privacy}", "received_events_url": "https://api.github.com/users/joyicejin/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-03T06:56:36Z", "updated_at": "2018-08-03T08:53:10Z", "author_association": "NONE", "body_html": "<p>Sorry, maybe I should tell you my work now, I just want to convert my own defined tensorflow model into a tflite model which works in mobile phones.</p>\n<p>In my code I use following codes to create an adam optimizer for trainning process</p>\n<pre><code>#Optimizer that use different learning rates for each part of the network\n            train_op, grads_and_vars_op = adam_clipping_list_lr(\n                loss=train_net.loss_op,              \n                list_lrs=[0.00001, 0.0001],\n                list_train_vars=[train_vars1, train_vars2],\n                clip_value=10.0\n            )\n</code></pre>\n<p>First I freezed the model by the freeze_graph.py in tensorflow reposite and  and optimized the model by the optimize_for_inference.py command.<br>\nThe I  use the following command to produce a tflite mobile model.<br>\n<code>**tflite_convert --graph_def_file=./opt.pb --output_format=TFLITE --output_file=./model.tflite --inference_type=FLOAT --input_arrays=inputs --output_arrays=softmax --input_shapes=1,5000,1,1</code><br>\nBut I got the following message:**</p>\n<p>/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n2018-08-03 14:13:55.136839: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>\n2018-08-03 14:13:55.241106: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-08-03 14:13:55.241540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties:<br>\nname: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.873<br>\npciBusID: 0000:07:00.0<br>\ntotalMemory: 7.93GiB freeMemory: 7.27GiB<br>\n2018-08-03 14:13:55.241554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0<br>\n2018-08-03 14:13:55.417519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-08-03 14:13:55.417569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0<br>\n2018-08-03 14:13:55.417575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N<br>\n2018-08-03 14:13:55.417775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7020 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:07:00.0, compute capability: 6.1)<br>\nTraceback (most recent call last):<br>\nFile \"/usr/local/bin/tflite_convert\", line 11, in <br>\nsys.exit(main())<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 320, in main<br>\napp.run(main=run_main, argv=sys.argv[:1])<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 125, in run<br>\n_sys.exit(main(argv))<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 316, in run_main<br>\n_convert_model(tflite_flags)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 121, in _convert_model<br>\noutput_data = converter.convert()<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/lite.py\", line 309, in convert<br>\nallow_custom_ops=self.allow_custom_ops)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert.py\", line 225, in toco_convert<br>\ninput_data.SerializeToString())<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert.py\", line 107, in toco_convert_protos<br>\n(stdout, stderr))<br>\n<strong>RuntimeError: TOCO failed see console for info.</strong><br>\nb'2018-08-03 14:13:58.069666: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.069846: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070054: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070240: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070338: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070471: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070627: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070771: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.074949: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.075008: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Unpack\\n2018-08-03 14:13:58.099706: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 322 operators, 491 arrays (0 quantized)\\n2018-08-03 14:13:58.103204: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 322 operators, 491 arrays (0 quantized)\\n2018-08-03 14:13:58.103368: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] <strong>RandomUniform op outputting \"rssEEG/l1_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy).</strong> <strong>Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this</strong>\\n2018-08-03 14:13:58.104557: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l5_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.105416: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l9_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.138101: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85]<code>RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). ``Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03</code>14:13:58.142571: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.164082: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.168823: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.168978: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l12_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.171340: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 277 operators, 425 arrays (0 quantized)\\n2018-08-03 14:13:58.171902: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l12_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.171985: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172107: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172222: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172334: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172541: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l9_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172844: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l5_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.173163: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l1_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.175469: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 277 operators, 425 arrays (0 quantized)\\n2018-08-03 14:13:58.178267: I tensorflow/contrib/lite/toco/allocate_transient_arrays.cc:329] Total transient array allocated size: 256128 bytes, theoretical optimal value: 256000 bytes.\\n2018-08-03 14:13:58.179561: F tensorflow/contrib/lite/toco/tflite/export.cc:330] <code>**</code>Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If<code>**</code> you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.contrib.lite.toco_convert(). Here is a list of operators for which  <strong>you will need custom implementations: RandomUniform, Reciprocal, TensorFlowSqrt, TensorFlowSquare, TensorFlowSum, Unpack.\\nAborted (core dumped)\\n'</strong><br>\nNone</p>\n<p>Then I adoped the detailed conveting process, when I use the quantize_graph command below:<br>\n<code>sudo bazel-bin/tensorflow/tools/quantization/quantize_graph  --input=./op.pb --output_node_names=\"rssEEG/l13_softmax/Add\" --output=./model.pb --mode=eightbit</code></p>\n<p>I got the metioned error message:<br>\nValueError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.</p>\n<p>Detailed message here:<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88<br>\nreturn f(*args, **kwds)<br>\ntf.estimator package not installed.<br>\nTraceback (most recent call last):<br>\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 418, in import_graph_def<br>\ngraph._c_graph, serialized, options)  # pylint: disable=protected-access<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/tools/quantization/quantize_graph.py\", line 1302, in <br>\napp.run()<br>\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 125, in run<br>\n_sys.exit(main(argv))<br>\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/tools/quantization/quantize_graph.py\", line 1273, in main<br>\nimporter.import_graph_def(tf_graph, input_map={}, name=\"\")<br>\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/util/deprecation.py\", line 488, in new_func<br>\nreturn func(*args, **kwargs)<br>\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 422, in import_graph_def<br>\nraise ValueError(str(e))<br>\nValueError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.</p>", "body_text": "Sorry, maybe I should tell you my work now, I just want to convert my own defined tensorflow model into a tflite model which works in mobile phones.\nIn my code I use following codes to create an adam optimizer for trainning process\n#Optimizer that use different learning rates for each part of the network\n            train_op, grads_and_vars_op = adam_clipping_list_lr(\n                loss=train_net.loss_op,              \n                list_lrs=[0.00001, 0.0001],\n                list_train_vars=[train_vars1, train_vars2],\n                clip_value=10.0\n            )\n\nFirst I freezed the model by the freeze_graph.py in tensorflow reposite and  and optimized the model by the optimize_for_inference.py command.\nThe I  use the following command to produce a tflite mobile model.\n**tflite_convert --graph_def_file=./opt.pb --output_format=TFLITE --output_file=./model.tflite --inference_type=FLOAT --input_arrays=inputs --output_arrays=softmax --input_shapes=1,5000,1,1\nBut I got the following message:**\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n2018-08-03 14:13:55.136839: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-08-03 14:13:55.241106: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-08-03 14:13:55.241540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties:\nname: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.873\npciBusID: 0000:07:00.0\ntotalMemory: 7.93GiB freeMemory: 7.27GiB\n2018-08-03 14:13:55.241554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0\n2018-08-03 14:13:55.417519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-03 14:13:55.417569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0\n2018-08-03 14:13:55.417575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N\n2018-08-03 14:13:55.417775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7020 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:07:00.0, compute capability: 6.1)\nTraceback (most recent call last):\nFile \"/usr/local/bin/tflite_convert\", line 11, in \nsys.exit(main())\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 320, in main\napp.run(main=run_main, argv=sys.argv[:1])\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 316, in run_main\n_convert_model(tflite_flags)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 121, in _convert_model\noutput_data = converter.convert()\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/lite.py\", line 309, in convert\nallow_custom_ops=self.allow_custom_ops)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert.py\", line 225, in toco_convert\ninput_data.SerializeToString())\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert.py\", line 107, in toco_convert_protos\n(stdout, stderr))\nRuntimeError: TOCO failed see console for info.\nb'2018-08-03 14:13:58.069666: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.069846: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070054: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070240: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070338: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070471: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070627: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070771: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.074949: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.075008: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Unpack\\n2018-08-03 14:13:58.099706: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 322 operators, 491 arrays (0 quantized)\\n2018-08-03 14:13:58.103204: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 322 operators, 491 arrays (0 quantized)\\n2018-08-03 14:13:58.103368: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l1_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.104557: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l5_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.105416: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l9_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.138101: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85]RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). ``Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-0314:13:58.142571: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.164082: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.168823: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.168978: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l12_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.171340: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 277 operators, 425 arrays (0 quantized)\\n2018-08-03 14:13:58.171902: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l12_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.171985: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172107: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172222: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172334: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172541: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l9_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172844: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l5_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.173163: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l1_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.175469: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 277 operators, 425 arrays (0 quantized)\\n2018-08-03 14:13:58.178267: I tensorflow/contrib/lite/toco/allocate_transient_arrays.cc:329] Total transient array allocated size: 256128 bytes, theoretical optimal value: 256000 bytes.\\n2018-08-03 14:13:58.179561: F tensorflow/contrib/lite/toco/tflite/export.cc:330] **Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If** you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.contrib.lite.toco_convert(). Here is a list of operators for which  you will need custom implementations: RandomUniform, Reciprocal, TensorFlowSqrt, TensorFlowSquare, TensorFlowSum, Unpack.\\nAborted (core dumped)\\n'\nNone\nThen I adoped the detailed conveting process, when I use the quantize_graph command below:\nsudo bazel-bin/tensorflow/tools/quantization/quantize_graph  --input=./op.pb --output_node_names=\"rssEEG/l13_softmax/Add\" --output=./model.pb --mode=eightbit\nI got the metioned error message:\nValueError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.\nDetailed message here:\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\nreturn f(*args, **kwds)\ntf.estimator package not installed.\nTraceback (most recent call last):\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 418, in import_graph_def\ngraph._c_graph, serialized, options)  # pylint: disable=protected-access\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/tools/quantization/quantize_graph.py\", line 1302, in \napp.run()\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/tools/quantization/quantize_graph.py\", line 1273, in main\nimporter.import_graph_def(tf_graph, input_map={}, name=\"\")\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/util/deprecation.py\", line 488, in new_func\nreturn func(*args, **kwargs)\nFile \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 422, in import_graph_def\nraise ValueError(str(e))\nValueError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.", "body": "Sorry, maybe I should tell you my work now, I just want to convert my own defined tensorflow model into a tflite model which works in mobile phones.\r\n\r\nIn my code I use following codes to create an adam optimizer for trainning process\r\n \r\n```\r\n#Optimizer that use different learning rates for each part of the network\r\n            train_op, grads_and_vars_op = adam_clipping_list_lr(\r\n                loss=train_net.loss_op,              \r\n                list_lrs=[0.00001, 0.0001],\r\n                list_train_vars=[train_vars1, train_vars2],\r\n                clip_value=10.0\r\n            )\r\n```\r\n\r\nFirst I freezed the model by the freeze_graph.py in tensorflow reposite and  and optimized the model by the optimize_for_inference.py command.\r\nThe I  use the following command to produce a tflite mobile model.\r\n`**tflite_convert --graph_def_file=./opt.pb --output_format=TFLITE --output_file=./model.tflite --inference_type=FLOAT --input_arrays=inputs --output_arrays=softmax --input_shapes=1,5000,1,1`\r\nBut I got the following message:**\r\n\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n2018-08-03 14:13:55.136839: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-08-03 14:13:55.241106: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-03 14:13:55.241540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties: \r\nname: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.873\r\npciBusID: 0000:07:00.0\r\ntotalMemory: 7.93GiB freeMemory: 7.27GiB\r\n2018-08-03 14:13:55.241554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0\r\n2018-08-03 14:13:55.417519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-03 14:13:55.417569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0 \r\n2018-08-03 14:13:55.417575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N \r\n2018-08-03 14:13:55.417775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7020 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:07:00.0, compute capability: 6.1)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/tflite_convert\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 320, in main\r\n    app.run(main=run_main, argv=sys.argv[:1])\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 316, in run_main\r\n    _convert_model(tflite_flags)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/tflite_convert.py\", line 121, in _convert_model\r\n    output_data = converter.convert()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/lite.py\", line 309, in convert\r\n    allow_custom_ops=self.allow_custom_ops)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert.py\", line 225, in toco_convert\r\n    input_data.SerializeToString())\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert.py\", line 107, in toco_convert_protos\r\n    (stdout, stderr))\r\n**RuntimeError: TOCO failed see console for info.**\r\nb'2018-08-03 14:13:58.069666: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.069846: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070054: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070240: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070338: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070471: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070627: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.070771: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.074949: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Reciprocal\\n2018-08-03 14:13:58.075008: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1366] Converting unsupported operation: Unpack\\n2018-08-03 14:13:58.099706: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 322 operators, 491 arrays (0 quantized)\\n2018-08-03 14:13:58.103204: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 322 operators, 491 arrays (0 quantized)\\n2018-08-03 14:13:58.103368: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] **RandomUniform op outputting \"rssEEG/l1_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy).** **Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this**\\n2018-08-03 14:13:58.104557: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l5_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.105416: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l9_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.138101: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85]` RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). ``Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 `14:13:58.142571: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.164082: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.168823: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.168978: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l12_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.171340: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 277 operators, 425 arrays (0 quantized)\\n2018-08-03 14:13:58.171902: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l12_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.171985: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172107: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/BW/BW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172222: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell1/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172334: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l11_bi_gru/BiRNN/FW/FW/MultiRNNCell/Cell0/dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172541: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l9_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.172844: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l5_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.173163: W tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:85] RandomUniform op outputting \"rssEEG/l1_dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\\n2018-08-03 14:13:58.175469: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 277 operators, 425 arrays (0 quantized)\\n2018-08-03 14:13:58.178267: I tensorflow/contrib/lite/toco/allocate_transient_arrays.cc:329] Total transient array allocated size: 256128 bytes, theoretical optimal value: 256000 bytes.\\n2018-08-03 14:13:58.179561: F tensorflow/contrib/lite/toco/tflite/export.cc:330] `**`Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If`**` you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.contrib.lite.toco_convert(). Here is a list of operators for which  **you will need custom implementations: RandomUniform, Reciprocal, TensorFlowSqrt, TensorFlowSquare, TensorFlowSum, Unpack.\\nAborted (core dumped)\\n'**\r\nNone\r\n\r\n\r\nThen I adoped the detailed conveting process, when I use the quantize_graph command below:\r\n`sudo bazel-bin/tensorflow/tools/quantization/quantize_graph  --input=./op.pb --output_node_names=\"rssEEG/l13_softmax/Add\" --output=./model.pb --mode=eightbit`\r\n\r\nI got the metioned error message:\r\nValueError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.\r\n\r\nDetailed message here:\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/usr/lib/python3.5/importlib/_bootstrap.py:222: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\ntf.estimator package not installed.\r\nTraceback (most recent call last):\r\n  File \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 418, in import_graph_def\r\n    graph._c_graph, serialized, options)  # pylint: disable=protected-access\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/tools/quantization/quantize_graph.py\", line 1302, in <module>\r\n    app.run()\r\n  File \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/tools/quantization/quantize_graph.py\", line 1273, in main\r\n    importer.import_graph_def(tf_graph, input_map={}, name=\"\")\r\n  File \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/media/joyice/ssdata/tensorflow/bazel-bin/tensorflow/tools/quantization/quantize_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 422, in import_graph_def\r\n    raise ValueError(str(e))\r\nValueError: Input 0 of node save/Assign was passed float from beta1_power:0 incompatible with expected float_ref.\r\n\r\n\r\n\r\n\r\n"}