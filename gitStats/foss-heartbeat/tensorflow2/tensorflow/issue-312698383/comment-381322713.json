{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/381322713", "html_url": "https://github.com/tensorflow/tensorflow/issues/18361#issuecomment-381322713", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18361", "id": 381322713, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTMyMjcxMw==", "user": {"login": "dkhmelenko", "id": 4306809, "node_id": "MDQ6VXNlcjQzMDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4306809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkhmelenko", "html_url": "https://github.com/dkhmelenko", "followers_url": "https://api.github.com/users/dkhmelenko/followers", "following_url": "https://api.github.com/users/dkhmelenko/following{/other_user}", "gists_url": "https://api.github.com/users/dkhmelenko/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkhmelenko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkhmelenko/subscriptions", "organizations_url": "https://api.github.com/users/dkhmelenko/orgs", "repos_url": "https://api.github.com/users/dkhmelenko/repos", "events_url": "https://api.github.com/users/dkhmelenko/events{/privacy}", "received_events_url": "https://api.github.com/users/dkhmelenko/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-14T11:29:21Z", "updated_at": "2018-04-14T11:29:21Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16018\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/asimshankar\">@asimshankar</a> Thank you for your help!</p>\n<p>I'm trying to freeze my model and I'm getting the error</p>\n<pre><code>TypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor(\"linear/linear_model/bias_weights:0\", shape=(18,), dtype=float32)\n</code></pre>\n<p>I looked on  <a href=\"https://stackoverflow.com/search?q=names_to_saveables+must+be+a+dict+\" rel=\"nofollow\">StackOverflow</a> and seems this issue happens to many people and there is no answer to that.</p>\n<p>Do you know what can be the reason?</p>\n<p>The code for creating the model is very simple</p>\n<div class=\"highlight highlight-source-python\"><pre>gender <span class=\"pl-k\">=</span> tf.feature_column.categorical_column_with_vocabulary_list(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>gender<span class=\"pl-pds\">\"</span></span>, [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>m<span class=\"pl-pds\">\"</span></span>])\ngoal <span class=\"pl-k\">=</span> tf.feature_column.categorical_column_with_vocabulary_list(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>goal<span class=\"pl-pds\">\"</span></span>, [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>fit<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>lose<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>muscle<span class=\"pl-pds\">\"</span></span>])\nlevel <span class=\"pl-k\">=</span> tf.feature_column.categorical_column_with_vocabulary_list(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>level<span class=\"pl-pds\">\"</span></span>, [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>begin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>middle<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>advance<span class=\"pl-pds\">\"</span></span>])\n\nfeature_columns <span class=\"pl-k\">=</span> [gender,goal,level]\ninput_fn <span class=\"pl-k\">=</span> tf.estimator.inputs.pandas_input_fn(<span class=\"pl-v\">x</span><span class=\"pl-k\">=</span>x_train, <span class=\"pl-v\">y</span><span class=\"pl-k\">=</span>y_train, <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">100</span>, <span class=\"pl-v\">num_epochs</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>, <span class=\"pl-v\">shuffle</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\nmodel <span class=\"pl-k\">=</span> tf.estimator.LinearClassifier(<span class=\"pl-v\">feature_columns</span><span class=\"pl-k\">=</span>feature_columns, <span class=\"pl-v\">n_classes</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">18</span>, <span class=\"pl-v\">model_dir</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>export<span class=\"pl-pds\">\"</span></span>)\n\nmodel.train(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">100</span>)</pre></div>", "body_text": "@asimshankar Thank you for your help!\nI'm trying to freeze my model and I'm getting the error\nTypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor(\"linear/linear_model/bias_weights:0\", shape=(18,), dtype=float32)\n\nI looked on  StackOverflow and seems this issue happens to many people and there is no answer to that.\nDo you know what can be the reason?\nThe code for creating the model is very simple\ngender = tf.feature_column.categorical_column_with_vocabulary_list(\"gender\", [\"f\", \"m\"])\ngoal = tf.feature_column.categorical_column_with_vocabulary_list(\"goal\", [\"fit\", \"lose\", \"muscle\"])\nlevel = tf.feature_column.categorical_column_with_vocabulary_list(\"level\", [\"begin\", \"middle\", \"advance\"])\n\nfeature_columns = [gender,goal,level]\ninput_fn = tf.estimator.inputs.pandas_input_fn(x=x_train, y=y_train, batch_size=100, num_epochs=None, shuffle=True)\nmodel = tf.estimator.LinearClassifier(feature_columns=feature_columns, n_classes=18, model_dir=\"export\")\n\nmodel.train(input_fn=input_fn, steps=100)", "body": "@asimshankar Thank you for your help! \r\n\r\nI'm trying to freeze my model and I'm getting the error \r\n```\r\nTypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor(\"linear/linear_model/bias_weights:0\", shape=(18,), dtype=float32)\r\n```\r\n\r\nI looked on  [StackOverflow](https://stackoverflow.com/search?q=names_to_saveables+must+be+a+dict+) and seems this issue happens to many people and there is no answer to that.\r\n\r\nDo you know what can be the reason? \r\n\r\nThe code for creating the model is very simple\r\n```python\r\ngender = tf.feature_column.categorical_column_with_vocabulary_list(\"gender\", [\"f\", \"m\"])\r\ngoal = tf.feature_column.categorical_column_with_vocabulary_list(\"goal\", [\"fit\", \"lose\", \"muscle\"])\r\nlevel = tf.feature_column.categorical_column_with_vocabulary_list(\"level\", [\"begin\", \"middle\", \"advance\"])\r\n\r\nfeature_columns = [gender,goal,level]\r\ninput_fn = tf.estimator.inputs.pandas_input_fn(x=x_train, y=y_train, batch_size=100, num_epochs=None, shuffle=True)\r\nmodel = tf.estimator.LinearClassifier(feature_columns=feature_columns, n_classes=18, model_dir=\"export\")\r\n\r\nmodel.train(input_fn=input_fn, steps=100)\r\n```"}