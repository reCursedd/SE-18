{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4455", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4455/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4455/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4455/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4455", "id": 177757846, "node_id": "MDU6SXNzdWUxNzc3NTc4NDY=", "number": 4455, "title": "Distributed TF managed session: inter_op_parallelism_threads and intra_op_parallelism_threads has no effect", "user": {"login": "hholst80", "id": 6200749, "node_id": "MDQ6VXNlcjYyMDA3NDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/6200749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hholst80", "html_url": "https://github.com/hholst80", "followers_url": "https://api.github.com/users/hholst80/followers", "following_url": "https://api.github.com/users/hholst80/following{/other_user}", "gists_url": "https://api.github.com/users/hholst80/gists{/gist_id}", "starred_url": "https://api.github.com/users/hholst80/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hholst80/subscriptions", "organizations_url": "https://api.github.com/users/hholst80/orgs", "repos_url": "https://api.github.com/users/hholst80/repos", "events_url": "https://api.github.com/users/hholst80/events{/privacy}", "received_events_url": "https://api.github.com/users/hholst80/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-09-19T11:11:08Z", "updated_at": "2016-10-11T18:31:43Z", "closed_at": "2016-10-11T18:31:43Z", "author_association": "CONTRIBUTOR", "body_html": "<p>We are using:</p>\n<pre lang=\".python\"><code>with sv.managed_session(\n  server.target,\n  config=tf.ConfigProto(log_device_placement=True,\n                        inter_op_parallelism_threads=1,\n                        intra_op_parallelism_threads=1),\n) as sess:\n</code></pre>\n<p>but TensorFlow still launches a number of threads proportional to the number of cores on each process. I counted +50 threads used by each process on my 24 vcore machine.</p>\n<p>What can we do to limit the number of threads in a managed session.</p>\n<p>EDIT: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a> identified the problem. See the end of the thread about Session vs Server options.</p>", "body_text": "We are using:\nwith sv.managed_session(\n  server.target,\n  config=tf.ConfigProto(log_device_placement=True,\n                        inter_op_parallelism_threads=1,\n                        intra_op_parallelism_threads=1),\n) as sess:\n\nbut TensorFlow still launches a number of threads proportional to the number of cores on each process. I counted +50 threads used by each process on my 24 vcore machine.\nWhat can we do to limit the number of threads in a managed session.\nEDIT: @yaroslavvb identified the problem. See the end of the thread about Session vs Server options.", "body": "We are using:\n\n``` .python\nwith sv.managed_session(\n  server.target,\n  config=tf.ConfigProto(log_device_placement=True,\n                        inter_op_parallelism_threads=1,\n                        intra_op_parallelism_threads=1),\n) as sess:\n```\n\nbut TensorFlow still launches a number of threads proportional to the number of cores on each process. I counted +50 threads used by each process on my 24 vcore machine.\n\nWhat can we do to limit the number of threads in a managed session.\n\nEDIT: @yaroslavvb identified the problem. See the end of the thread about Session vs Server options.\n"}