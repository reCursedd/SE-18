{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/408831341", "html_url": "https://github.com/tensorflow/tensorflow/issues/20878#issuecomment-408831341", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20878", "id": 408831341, "node_id": "MDEyOklzc3VlQ29tbWVudDQwODgzMTM0MQ==", "user": {"login": "bennyooo", "id": 17111728, "node_id": "MDQ6VXNlcjE3MTExNzI4", "avatar_url": "https://avatars3.githubusercontent.com/u/17111728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bennyooo", "html_url": "https://github.com/bennyooo", "followers_url": "https://api.github.com/users/bennyooo/followers", "following_url": "https://api.github.com/users/bennyooo/following{/other_user}", "gists_url": "https://api.github.com/users/bennyooo/gists{/gist_id}", "starred_url": "https://api.github.com/users/bennyooo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bennyooo/subscriptions", "organizations_url": "https://api.github.com/users/bennyooo/orgs", "repos_url": "https://api.github.com/users/bennyooo/repos", "events_url": "https://api.github.com/users/bennyooo/events{/privacy}", "received_events_url": "https://api.github.com/users/bennyooo/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-30T11:24:36Z", "updated_at": "2018-07-30T11:44:23Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1900612\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gargn\">@gargn</a> I'm afraid I cannot upload the file itself but here is the output of keras.model.summary( ). I hope that helps:</p>\n<hr>\n<p>Layer (type)                    Output Shape         Param #     Connected to</p>\n<hr>\n<p>input_1 (InputLayer)            (None, 224, 224, 3)  0</p>\n<hr>\n<p>Conv1 (Conv2D)                  (None, 112, 112, 32) 864         input_1[0][0]</p>\n<hr>\n<p>bn_Conv1 (BatchNormalization)   (None, 112, 112, 32) 128         Conv1[0][0]</p>\n<hr>\n<p>Conv1_relu (Activation)         (None, 112, 112, 32) 0           bn_Conv1[0][0]</p>\n<hr>\n<p>expanded_conv_depthwise (Depthw (None, 112, 112, 32) 288         Conv1_relu[0][0]</p>\n<hr>\n<p>expanded_conv_depthwise_BN (Bat (None, 112, 112, 32) 128         expanded_conv_depthwise[0][0]</p>\n<hr>\n<p>expanded_conv_depthwise_relu (A (None, 112, 112, 32) 0           expanded_conv_depthwise_BN[0][0]</p>\n<hr>\n<p>expanded_conv_project (Conv2D)  (None, 112, 112, 16) 512         expanded_conv_depthwise_relu[0][0</p>\n<hr>\n<p>expanded_conv_project_BN (Batch (None, 112, 112, 16) 64          expanded_conv_project[0][0]</p>\n<hr>\n<p>block_1_expand (Conv2D)         (None, 112, 112, 96) 1536        expanded_conv_project_BN[0][0]</p>\n<hr>\n<p>block_1_expand_BN (BatchNormali (None, 112, 112, 96) 384         block_1_expand[0][0]</p>\n<hr>\n<p>block_1_expand_relu (Activation (None, 112, 112, 96) 0           block_1_expand_BN[0][0]</p>\n<hr>\n<p>block_1_depthwise (DepthwiseCon (None, 56, 56, 96)   864         block_1_expand_relu[0][0]</p>\n<hr>\n<p>block_1_depthwise_BN (BatchNorm (None, 56, 56, 96)   384         block_1_depthwise[0][0]</p>\n<hr>\n<p>block_1_depthwise_relu (Activat (None, 56, 56, 96)   0           block_1_depthwise_BN[0][0]</p>\n<hr>\n<p>block_1_project (Conv2D)        (None, 56, 56, 24)   2304        block_1_depthwise_relu[0][0]</p>\n<hr>\n<p>block_1_project_BN (BatchNormal (None, 56, 56, 24)   96          block_1_project[0][0]</p>\n<hr>\n<p>block_2_expand (Conv2D)         (None, 56, 56, 144)  3456        block_1_project_BN[0][0]</p>\n<hr>\n<p>block_2_expand_BN (BatchNormali (None, 56, 56, 144)  576         block_2_expand[0][0]</p>\n<hr>\n<p>block_2_expand_relu (Activation (None, 56, 56, 144)  0           block_2_expand_BN[0][0]</p>\n<hr>\n<p>block_2_depthwise (DepthwiseCon (None, 56, 56, 144)  1296        block_2_expand_relu[0][0]</p>\n<hr>\n<p>block_2_depthwise_BN (BatchNorm (None, 56, 56, 144)  576         block_2_depthwise[0][0]</p>\n<hr>\n<p>block_2_depthwise_relu (Activat (None, 56, 56, 144)  0           block_2_depthwise_BN[0][0]</p>\n<hr>\n<p>block_2_project (Conv2D)        (None, 56, 56, 24)   3456        block_2_depthwise_relu[0][0]</p>\n<hr>\n<p>block_2_project_BN (BatchNormal (None, 56, 56, 24)   96          block_2_project[0][0]</p>\n<hr>\n<p>block_2_add (Add)               (None, 56, 56, 24)   0           block_1_project_BN[0][0]<br>\nblock_2_project_BN[0][0]</p>\n<hr>\n<p>block_3_expand (Conv2D)         (None, 56, 56, 144)  3456        block_2_add[0][0]</p>\n<hr>\n<p>block_3_expand_BN (BatchNormali (None, 56, 56, 144)  576         block_3_expand[0][0]</p>\n<hr>\n<p>block_3_expand_relu (Activation (None, 56, 56, 144)  0           block_3_expand_BN[0][0]</p>\n<hr>\n<p>block_3_depthwise (DepthwiseCon (None, 28, 28, 144)  1296        block_3_expand_relu[0][0]</p>\n<hr>\n<p>block_3_depthwise_BN (BatchNorm (None, 28, 28, 144)  576         block_3_depthwise[0][0]</p>\n<hr>\n<p>block_3_depthwise_relu (Activat (None, 28, 28, 144)  0           block_3_depthwise_BN[0][0]</p>\n<hr>\n<p>block_3_project (Conv2D)        (None, 28, 28, 32)   4608        block_3_depthwise_relu[0][0]</p>\n<hr>\n<p>block_3_project_BN (BatchNormal (None, 28, 28, 32)   128         block_3_project[0][0]</p>\n<hr>\n<p>block_4_expand (Conv2D)         (None, 28, 28, 192)  6144        block_3_project_BN[0][0]</p>\n<hr>\n<p>block_4_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_4_expand[0][0]</p>\n<hr>\n<p>block_4_expand_relu (Activation (None, 28, 28, 192)  0           block_4_expand_BN[0][0]</p>\n<hr>\n<p>block_4_depthwise (DepthwiseCon (None, 28, 28, 192)  1728        block_4_expand_relu[0][0]</p>\n<hr>\n<p>block_4_depthwise_BN (BatchNorm (None, 28, 28, 192)  768         block_4_depthwise[0][0]</p>\n<hr>\n<p>block_4_depthwise_relu (Activat (None, 28, 28, 192)  0           block_4_depthwise_BN[0][0]</p>\n<hr>\n<p>block_4_project (Conv2D)        (None, 28, 28, 32)   6144        block_4_depthwise_relu[0][0]</p>\n<hr>\n<p>block_4_project_BN (BatchNormal (None, 28, 28, 32)   128         block_4_project[0][0]</p>\n<hr>\n<p>block_4_add (Add)               (None, 28, 28, 32)   0           block_3_project_BN[0][0]<br>\nblock_4_project_BN[0][0]</p>\n<hr>\n<p>block_5_expand (Conv2D)         (None, 28, 28, 192)  6144        block_4_add[0][0]</p>\n<hr>\n<p>block_5_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_5_expand[0][0]</p>\n<hr>\n<p>block_5_expand_relu (Activation (None, 28, 28, 192)  0           block_5_expand_BN[0][0]</p>\n<hr>\n<p>block_5_depthwise (DepthwiseCon (None, 28, 28, 192)  1728        block_5_expand_relu[0][0]</p>\n<hr>\n<p>block_5_depthwise_BN (BatchNorm (None, 28, 28, 192)  768         block_5_depthwise[0][0]</p>\n<hr>\n<p>block_5_depthwise_relu (Activat (None, 28, 28, 192)  0           block_5_depthwise_BN[0][0]</p>\n<hr>\n<p>block_5_project (Conv2D)        (None, 28, 28, 32)   6144        block_5_depthwise_relu[0][0]</p>\n<hr>\n<p>block_5_project_BN (BatchNormal (None, 28, 28, 32)   128         block_5_project[0][0]</p>\n<hr>\n<p>block_5_add (Add)               (None, 28, 28, 32)   0           block_4_add[0][0]<br>\nblock_5_project_BN[0][0]</p>\n<hr>\n<p>block_6_expand (Conv2D)         (None, 28, 28, 192)  6144        block_5_add[0][0]</p>\n<hr>\n<p>block_6_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_6_expand[0][0]</p>\n<hr>\n<p>block_6_expand_relu (Activation (None, 28, 28, 192)  0           block_6_expand_BN[0][0]</p>\n<hr>\n<p>block_6_depthwise (DepthwiseCon (None, 14, 14, 192)  1728        block_6_expand_relu[0][0]</p>\n<hr>\n<p>block_6_depthwise_BN (BatchNorm (None, 14, 14, 192)  768         block_6_depthwise[0][0]</p>\n<hr>\n<p>block_6_depthwise_relu (Activat (None, 14, 14, 192)  0           block_6_depthwise_BN[0][0]</p>\n<hr>\n<p>block_6_project (Conv2D)        (None, 14, 14, 64)   12288       block_6_depthwise_relu[0][0]</p>\n<hr>\n<p>block_6_project_BN (BatchNormal (None, 14, 14, 64)   256         block_6_project[0][0]</p>\n<hr>\n<p>block_7_expand (Conv2D)         (None, 14, 14, 384)  24576       block_6_project_BN[0][0]</p>\n<hr>\n<p>block_7_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_7_expand[0][0]</p>\n<hr>\n<p>block_7_expand_relu (Activation (None, 14, 14, 384)  0           block_7_expand_BN[0][0]</p>\n<hr>\n<p>block_7_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_7_expand_relu[0][0]</p>\n<hr>\n<p>block_7_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_7_depthwise[0][0]</p>\n<hr>\n<p>block_7_depthwise_relu (Activat (None, 14, 14, 384)  0           block_7_depthwise_BN[0][0]</p>\n<hr>\n<p>block_7_project (Conv2D)        (None, 14, 14, 64)   24576       block_7_depthwise_relu[0][0]</p>\n<hr>\n<p>block_7_project_BN (BatchNormal (None, 14, 14, 64)   256         block_7_project[0][0]</p>\n<hr>\n<p>block_7_add (Add)               (None, 14, 14, 64)   0           block_6_project_BN[0][0]<br>\nblock_7_project_BN[0][0]</p>\n<hr>\n<p>block_8_expand (Conv2D)         (None, 14, 14, 384)  24576       block_7_add[0][0]</p>\n<hr>\n<p>block_8_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_8_expand[0][0]</p>\n<hr>\n<p>block_8_expand_relu (Activation (None, 14, 14, 384)  0           block_8_expand_BN[0][0]</p>\n<hr>\n<p>block_8_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_8_expand_relu[0][0]</p>\n<hr>\n<p>block_8_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_8_depthwise[0][0]</p>\n<hr>\n<p>block_8_depthwise_relu (Activat (None, 14, 14, 384)  0           block_8_depthwise_BN[0][0]</p>\n<hr>\n<p>block_8_project (Conv2D)        (None, 14, 14, 64)   24576       block_8_depthwise_relu[0][0]</p>\n<hr>\n<p>block_8_project_BN (BatchNormal (None, 14, 14, 64)   256         block_8_project[0][0]</p>\n<hr>\n<p>block_8_add (Add)               (None, 14, 14, 64)   0           block_7_add[0][0]<br>\nblock_8_project_BN[0][0]</p>\n<hr>\n<p>block_9_expand (Conv2D)         (None, 14, 14, 384)  24576       block_8_add[0][0]</p>\n<hr>\n<p>block_9_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_9_expand[0][0]</p>\n<hr>\n<p>block_9_expand_relu (Activation (None, 14, 14, 384)  0           block_9_expand_BN[0][0]</p>\n<hr>\n<p>block_9_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_9_expand_relu[0][0]</p>\n<hr>\n<p>block_9_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_9_depthwise[0][0]</p>\n<hr>\n<p>block_9_depthwise_relu (Activat (None, 14, 14, 384)  0           block_9_depthwise_BN[0][0]</p>\n<hr>\n<p>block_9_project (Conv2D)        (None, 14, 14, 64)   24576       block_9_depthwise_relu[0][0]</p>\n<hr>\n<p>block_9_project_BN (BatchNormal (None, 14, 14, 64)   256         block_9_project[0][0]</p>\n<hr>\n<p>block_9_add (Add)               (None, 14, 14, 64)   0           block_8_add[0][0]<br>\nblock_9_project_BN[0][0]</p>\n<hr>\n<p>block_10_expand (Conv2D)        (None, 14, 14, 384)  24576       block_9_add[0][0]</p>\n<hr>\n<p>block_10_expand_BN (BatchNormal (None, 14, 14, 384)  1536        block_10_expand[0][0]</p>\n<hr>\n<p>block_10_expand_relu (Activatio (None, 14, 14, 384)  0           block_10_expand_BN[0][0]</p>\n<hr>\n<p>block_10_depthwise (DepthwiseCo (None, 14, 14, 384)  3456        block_10_expand_relu[0][0]</p>\n<hr>\n<p>block_10_depthwise_BN (BatchNor (None, 14, 14, 384)  1536        block_10_depthwise[0][0]</p>\n<hr>\n<p>block_10_depthwise_relu (Activa (None, 14, 14, 384)  0           block_10_depthwise_BN[0][0]</p>\n<hr>\n<p>block_10_project (Conv2D)       (None, 14, 14, 96)   36864       block_10_depthwise_relu[0][0]</p>\n<hr>\n<p>block_10_project_BN (BatchNorma (None, 14, 14, 96)   384         block_10_project[0][0]</p>\n<hr>\n<p>block_11_expand (Conv2D)        (None, 14, 14, 576)  55296       block_10_project_BN[0][0]</p>\n<hr>\n<p>block_11_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_11_expand[0][0]</p>\n<hr>\n<p>block_11_expand_relu (Activatio (None, 14, 14, 576)  0           block_11_expand_BN[0][0]</p>\n<hr>\n<p>block_11_depthwise (DepthwiseCo (None, 14, 14, 576)  5184        block_11_expand_relu[0][0]</p>\n<hr>\n<p>block_11_depthwise_BN (BatchNor (None, 14, 14, 576)  2304        block_11_depthwise[0][0]</p>\n<hr>\n<p>block_11_depthwise_relu (Activa (None, 14, 14, 576)  0           block_11_depthwise_BN[0][0]</p>\n<hr>\n<p>block_11_project (Conv2D)       (None, 14, 14, 96)   55296       block_11_depthwise_relu[0][0]</p>\n<hr>\n<p>block_11_project_BN (BatchNorma (None, 14, 14, 96)   384         block_11_project[0][0]</p>\n<hr>\n<p>block_11_add (Add)              (None, 14, 14, 96)   0           block_10_project_BN[0][0]<br>\nblock_11_project_BN[0][0]</p>\n<hr>\n<p>block_12_expand (Conv2D)        (None, 14, 14, 576)  55296       block_11_add[0][0]</p>\n<hr>\n<p>block_12_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_12_expand[0][0]</p>\n<hr>\n<p>block_12_expand_relu (Activatio (None, 14, 14, 576)  0           block_12_expand_BN[0][0]</p>\n<hr>\n<p>block_12_depthwise (DepthwiseCo (None, 14, 14, 576)  5184        block_12_expand_relu[0][0]</p>\n<hr>\n<p>block_12_depthwise_BN (BatchNor (None, 14, 14, 576)  2304        block_12_depthwise[0][0]</p>\n<hr>\n<p>block_12_depthwise_relu (Activa (None, 14, 14, 576)  0           block_12_depthwise_BN[0][0]</p>\n<hr>\n<p>block_12_project (Conv2D)       (None, 14, 14, 96)   55296       block_12_depthwise_relu[0][0]</p>\n<hr>\n<p>block_12_project_BN (BatchNorma (None, 14, 14, 96)   384         block_12_project[0][0]</p>\n<hr>\n<p>block_12_add (Add)              (None, 14, 14, 96)   0           block_11_add[0][0]<br>\nblock_12_project_BN[0][0]</p>\n<hr>\n<p>block_13_expand (Conv2D)        (None, 14, 14, 576)  55296       block_12_add[0][0]</p>\n<hr>\n<p>block_13_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_13_expand[0][0]</p>\n<hr>\n<p>block_13_expand_relu (Activatio (None, 14, 14, 576)  0           block_13_expand_BN[0][0]</p>\n<hr>\n<p>block_13_depthwise (DepthwiseCo (None, 7, 7, 576)    5184        block_13_expand_relu[0][0]</p>\n<hr>\n<p>block_13_depthwise_BN (BatchNor (None, 7, 7, 576)    2304        block_13_depthwise[0][0]</p>\n<hr>\n<p>block_13_depthwise_relu (Activa (None, 7, 7, 576)    0           block_13_depthwise_BN[0][0]</p>\n<hr>\n<p>block_13_project (Conv2D)       (None, 7, 7, 160)    92160       block_13_depthwise_relu[0][0]</p>\n<hr>\n<p>block_13_project_BN (BatchNorma (None, 7, 7, 160)    640         block_13_project[0][0]</p>\n<hr>\n<p>block_14_expand (Conv2D)        (None, 7, 7, 960)    153600      block_13_project_BN[0][0]</p>\n<hr>\n<p>block_14_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_14_expand[0][0]</p>\n<hr>\n<p>block_14_expand_relu (Activatio (None, 7, 7, 960)    0           block_14_expand_BN[0][0]</p>\n<hr>\n<p>block_14_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_14_expand_relu[0][0]</p>\n<hr>\n<p>block_14_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_14_depthwise[0][0]</p>\n<hr>\n<p>block_14_depthwise_relu (Activa (None, 7, 7, 960)    0           block_14_depthwise_BN[0][0]</p>\n<hr>\n<p>block_14_project (Conv2D)       (None, 7, 7, 160)    153600      block_14_depthwise_relu[0][0]</p>\n<hr>\n<p>block_14_project_BN (BatchNorma (None, 7, 7, 160)    640         block_14_project[0][0]</p>\n<hr>\n<p>block_14_add (Add)              (None, 7, 7, 160)    0           block_13_project_BN[0][0]<br>\nblock_14_project_BN[0][0]</p>\n<hr>\n<p>block_15_expand (Conv2D)        (None, 7, 7, 960)    153600      block_14_add[0][0]</p>\n<hr>\n<p>block_15_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_15_expand[0][0]</p>\n<hr>\n<p>block_15_expand_relu (Activatio (None, 7, 7, 960)    0           block_15_expand_BN[0][0]</p>\n<hr>\n<p>block_15_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_15_expand_relu[0][0]</p>\n<hr>\n<p>block_15_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_15_depthwise[0][0]</p>\n<hr>\n<p>block_15_depthwise_relu (Activa (None, 7, 7, 960)    0           block_15_depthwise_BN[0][0]</p>\n<hr>\n<p>block_15_project (Conv2D)       (None, 7, 7, 160)    153600      block_15_depthwise_relu[0][0]</p>\n<hr>\n<p>block_15_project_BN (BatchNorma (None, 7, 7, 160)    640         block_15_project[0][0]</p>\n<hr>\n<p>block_15_add (Add)              (None, 7, 7, 160)    0           block_14_add[0][0]<br>\nblock_15_project_BN[0][0]</p>\n<hr>\n<p>block_16_expand (Conv2D)        (None, 7, 7, 960)    153600      block_15_add[0][0]</p>\n<hr>\n<p>block_16_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_16_expand[0][0]</p>\n<hr>\n<p>block_16_expand_relu (Activatio (None, 7, 7, 960)    0           block_16_expand_BN[0][0]</p>\n<hr>\n<p>block_16_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_16_expand_relu[0][0]</p>\n<hr>\n<p>block_16_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_16_depthwise[0][0]</p>\n<hr>\n<p>block_16_depthwise_relu (Activa (None, 7, 7, 960)    0           block_16_depthwise_BN[0][0]</p>\n<hr>\n<p>block_16_project (Conv2D)       (None, 7, 7, 320)    307200      block_16_depthwise_relu[0][0]</p>\n<hr>\n<p>block_16_project_BN (BatchNorma (None, 7, 7, 320)    1280        block_16_project[0][0]</p>\n<hr>\n<p>Conv_1 (Conv2D)                 (None, 7, 7, 1280)   409600      block_16_project_BN[0][0]</p>\n<hr>\n<p>Conv_1_bn (BatchNormalization)  (None, 7, 7, 1280)   5120        Conv_1[0][0]</p>\n<hr>\n<p>out_relu (Activation)           (None, 7, 7, 1280)   0           Conv_1_bn[0][0]</p>\n<hr>\n<p>global_average_pooling2d_1 (Glo (None, 1280)         0           out_relu[0][0]</p>\n<hr>\n<p>drop (Dropout)                  (None, 1280)         0           global_average_pooling2d_1[0][0]</p>\n<hr>\n<p>distribution (Dense)            (None, 10)           12810       drop[0][0]</p>\n<p>Then I used the following code to create the .pb file:</p>\n<pre><code>def serialize_model(model):\n    # Serialize the model and get its weights, for quick re-building.\n    config = model.get_config()\n    weights = model.get_weights()\n\n    # Re-build a model where the learning phase is now hard-coded to 0.\n    # CustomObjectScope necessary for importing a pre-trained MobileNet\n    with CustomObjectScope({'relu6': relu6}):\n        new_model = Model.from_config(config)\n\n    new_model.set_weights(weights)\n\n    input_layers = new_model.input\n    print(new_model.input_shape)\n\n    output_layers = new_model.output\n    print(new_model.output_shape)\n\n    temp_dir = \"graph\"\n    checkpoint_prefix = os.path.join(temp_dir, \"saved_checkpoint\")\n    checkpoint_state_name = \"checkpoint_state\"\n    input_graph_name = \"input_graph.pb\"\n    output_graph_name = \"output_graph.pb\"\n\n    # Temporary save graph to disk without weights included.\n    saver = tf.train.Saver()\n    checkpoint_path = saver.save(K.get_session(), checkpoint_prefix, global_step=0,\n                                 latest_filename=checkpoint_state_name)\n    tf.train.write_graph(K.get_session().graph, temp_dir, input_graph_name)\n\n    input_graph_path = os.path.join(temp_dir, input_graph_name)\n    input_saver_def_path = \"\"\n    input_binary = False\n    output_node_names = model.output.name.split(':')[0]  # model dependent\n    restore_op_name = \"save/restore_all\"\n    filename_tensor_name = \"save/Const:0\"\n    output_graph_path = os.path.join(temp_dir, output_graph_name)\n    clear_devices = False\n\n    # Embed weights inside the graph and save to disk.\n    freeze_graph.freeze_graph(input_graph_path, input_saver_def_path, input_binary, checkpoint_path, output_node_names,\n                              restore_op_name, filename_tensor_name, output_graph_path, clear_devices, \"\")\n\n    # The output_graph is the resulting and functional graph with embedded weights.\n    if os.path.exists(\"graph/output_graph.pb\"):\n        print(\"Model successfully exported to .pb file\")\n</code></pre>\n<p>After that I used this command to strip unused nodes:</p>\n<blockquote>\n<p>bazel run tensorflow/tools/graph_transforms:transform_graph --<br>\n--in_graph=input.pb<br>\n--out_graph=output.pb --inputs='input_1_2' --outputs='distribution_2/Softmax'<br>\n--transforms='<br>\nstrip_unused_nodes(type=float, shape=\"1,224,224,3\")<br>\nfold_constants(ignore_errors=true)<br>\nfold_batch_norms'</p>\n</blockquote>\n<p>All these steps worked fine but when trying to export the file into .tflite the errors mentioned in my post above occure.</p>", "body_text": "@gargn I'm afraid I cannot upload the file itself but here is the output of keras.model.summary( ). I hope that helps:\n\nLayer (type)                    Output Shape         Param #     Connected to\n\ninput_1 (InputLayer)            (None, 224, 224, 3)  0\n\nConv1 (Conv2D)                  (None, 112, 112, 32) 864         input_1[0][0]\n\nbn_Conv1 (BatchNormalization)   (None, 112, 112, 32) 128         Conv1[0][0]\n\nConv1_relu (Activation)         (None, 112, 112, 32) 0           bn_Conv1[0][0]\n\nexpanded_conv_depthwise (Depthw (None, 112, 112, 32) 288         Conv1_relu[0][0]\n\nexpanded_conv_depthwise_BN (Bat (None, 112, 112, 32) 128         expanded_conv_depthwise[0][0]\n\nexpanded_conv_depthwise_relu (A (None, 112, 112, 32) 0           expanded_conv_depthwise_BN[0][0]\n\nexpanded_conv_project (Conv2D)  (None, 112, 112, 16) 512         expanded_conv_depthwise_relu[0][0\n\nexpanded_conv_project_BN (Batch (None, 112, 112, 16) 64          expanded_conv_project[0][0]\n\nblock_1_expand (Conv2D)         (None, 112, 112, 96) 1536        expanded_conv_project_BN[0][0]\n\nblock_1_expand_BN (BatchNormali (None, 112, 112, 96) 384         block_1_expand[0][0]\n\nblock_1_expand_relu (Activation (None, 112, 112, 96) 0           block_1_expand_BN[0][0]\n\nblock_1_depthwise (DepthwiseCon (None, 56, 56, 96)   864         block_1_expand_relu[0][0]\n\nblock_1_depthwise_BN (BatchNorm (None, 56, 56, 96)   384         block_1_depthwise[0][0]\n\nblock_1_depthwise_relu (Activat (None, 56, 56, 96)   0           block_1_depthwise_BN[0][0]\n\nblock_1_project (Conv2D)        (None, 56, 56, 24)   2304        block_1_depthwise_relu[0][0]\n\nblock_1_project_BN (BatchNormal (None, 56, 56, 24)   96          block_1_project[0][0]\n\nblock_2_expand (Conv2D)         (None, 56, 56, 144)  3456        block_1_project_BN[0][0]\n\nblock_2_expand_BN (BatchNormali (None, 56, 56, 144)  576         block_2_expand[0][0]\n\nblock_2_expand_relu (Activation (None, 56, 56, 144)  0           block_2_expand_BN[0][0]\n\nblock_2_depthwise (DepthwiseCon (None, 56, 56, 144)  1296        block_2_expand_relu[0][0]\n\nblock_2_depthwise_BN (BatchNorm (None, 56, 56, 144)  576         block_2_depthwise[0][0]\n\nblock_2_depthwise_relu (Activat (None, 56, 56, 144)  0           block_2_depthwise_BN[0][0]\n\nblock_2_project (Conv2D)        (None, 56, 56, 24)   3456        block_2_depthwise_relu[0][0]\n\nblock_2_project_BN (BatchNormal (None, 56, 56, 24)   96          block_2_project[0][0]\n\nblock_2_add (Add)               (None, 56, 56, 24)   0           block_1_project_BN[0][0]\nblock_2_project_BN[0][0]\n\nblock_3_expand (Conv2D)         (None, 56, 56, 144)  3456        block_2_add[0][0]\n\nblock_3_expand_BN (BatchNormali (None, 56, 56, 144)  576         block_3_expand[0][0]\n\nblock_3_expand_relu (Activation (None, 56, 56, 144)  0           block_3_expand_BN[0][0]\n\nblock_3_depthwise (DepthwiseCon (None, 28, 28, 144)  1296        block_3_expand_relu[0][0]\n\nblock_3_depthwise_BN (BatchNorm (None, 28, 28, 144)  576         block_3_depthwise[0][0]\n\nblock_3_depthwise_relu (Activat (None, 28, 28, 144)  0           block_3_depthwise_BN[0][0]\n\nblock_3_project (Conv2D)        (None, 28, 28, 32)   4608        block_3_depthwise_relu[0][0]\n\nblock_3_project_BN (BatchNormal (None, 28, 28, 32)   128         block_3_project[0][0]\n\nblock_4_expand (Conv2D)         (None, 28, 28, 192)  6144        block_3_project_BN[0][0]\n\nblock_4_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_4_expand[0][0]\n\nblock_4_expand_relu (Activation (None, 28, 28, 192)  0           block_4_expand_BN[0][0]\n\nblock_4_depthwise (DepthwiseCon (None, 28, 28, 192)  1728        block_4_expand_relu[0][0]\n\nblock_4_depthwise_BN (BatchNorm (None, 28, 28, 192)  768         block_4_depthwise[0][0]\n\nblock_4_depthwise_relu (Activat (None, 28, 28, 192)  0           block_4_depthwise_BN[0][0]\n\nblock_4_project (Conv2D)        (None, 28, 28, 32)   6144        block_4_depthwise_relu[0][0]\n\nblock_4_project_BN (BatchNormal (None, 28, 28, 32)   128         block_4_project[0][0]\n\nblock_4_add (Add)               (None, 28, 28, 32)   0           block_3_project_BN[0][0]\nblock_4_project_BN[0][0]\n\nblock_5_expand (Conv2D)         (None, 28, 28, 192)  6144        block_4_add[0][0]\n\nblock_5_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_5_expand[0][0]\n\nblock_5_expand_relu (Activation (None, 28, 28, 192)  0           block_5_expand_BN[0][0]\n\nblock_5_depthwise (DepthwiseCon (None, 28, 28, 192)  1728        block_5_expand_relu[0][0]\n\nblock_5_depthwise_BN (BatchNorm (None, 28, 28, 192)  768         block_5_depthwise[0][0]\n\nblock_5_depthwise_relu (Activat (None, 28, 28, 192)  0           block_5_depthwise_BN[0][0]\n\nblock_5_project (Conv2D)        (None, 28, 28, 32)   6144        block_5_depthwise_relu[0][0]\n\nblock_5_project_BN (BatchNormal (None, 28, 28, 32)   128         block_5_project[0][0]\n\nblock_5_add (Add)               (None, 28, 28, 32)   0           block_4_add[0][0]\nblock_5_project_BN[0][0]\n\nblock_6_expand (Conv2D)         (None, 28, 28, 192)  6144        block_5_add[0][0]\n\nblock_6_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_6_expand[0][0]\n\nblock_6_expand_relu (Activation (None, 28, 28, 192)  0           block_6_expand_BN[0][0]\n\nblock_6_depthwise (DepthwiseCon (None, 14, 14, 192)  1728        block_6_expand_relu[0][0]\n\nblock_6_depthwise_BN (BatchNorm (None, 14, 14, 192)  768         block_6_depthwise[0][0]\n\nblock_6_depthwise_relu (Activat (None, 14, 14, 192)  0           block_6_depthwise_BN[0][0]\n\nblock_6_project (Conv2D)        (None, 14, 14, 64)   12288       block_6_depthwise_relu[0][0]\n\nblock_6_project_BN (BatchNormal (None, 14, 14, 64)   256         block_6_project[0][0]\n\nblock_7_expand (Conv2D)         (None, 14, 14, 384)  24576       block_6_project_BN[0][0]\n\nblock_7_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_7_expand[0][0]\n\nblock_7_expand_relu (Activation (None, 14, 14, 384)  0           block_7_expand_BN[0][0]\n\nblock_7_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_7_expand_relu[0][0]\n\nblock_7_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_7_depthwise[0][0]\n\nblock_7_depthwise_relu (Activat (None, 14, 14, 384)  0           block_7_depthwise_BN[0][0]\n\nblock_7_project (Conv2D)        (None, 14, 14, 64)   24576       block_7_depthwise_relu[0][0]\n\nblock_7_project_BN (BatchNormal (None, 14, 14, 64)   256         block_7_project[0][0]\n\nblock_7_add (Add)               (None, 14, 14, 64)   0           block_6_project_BN[0][0]\nblock_7_project_BN[0][0]\n\nblock_8_expand (Conv2D)         (None, 14, 14, 384)  24576       block_7_add[0][0]\n\nblock_8_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_8_expand[0][0]\n\nblock_8_expand_relu (Activation (None, 14, 14, 384)  0           block_8_expand_BN[0][0]\n\nblock_8_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_8_expand_relu[0][0]\n\nblock_8_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_8_depthwise[0][0]\n\nblock_8_depthwise_relu (Activat (None, 14, 14, 384)  0           block_8_depthwise_BN[0][0]\n\nblock_8_project (Conv2D)        (None, 14, 14, 64)   24576       block_8_depthwise_relu[0][0]\n\nblock_8_project_BN (BatchNormal (None, 14, 14, 64)   256         block_8_project[0][0]\n\nblock_8_add (Add)               (None, 14, 14, 64)   0           block_7_add[0][0]\nblock_8_project_BN[0][0]\n\nblock_9_expand (Conv2D)         (None, 14, 14, 384)  24576       block_8_add[0][0]\n\nblock_9_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_9_expand[0][0]\n\nblock_9_expand_relu (Activation (None, 14, 14, 384)  0           block_9_expand_BN[0][0]\n\nblock_9_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_9_expand_relu[0][0]\n\nblock_9_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_9_depthwise[0][0]\n\nblock_9_depthwise_relu (Activat (None, 14, 14, 384)  0           block_9_depthwise_BN[0][0]\n\nblock_9_project (Conv2D)        (None, 14, 14, 64)   24576       block_9_depthwise_relu[0][0]\n\nblock_9_project_BN (BatchNormal (None, 14, 14, 64)   256         block_9_project[0][0]\n\nblock_9_add (Add)               (None, 14, 14, 64)   0           block_8_add[0][0]\nblock_9_project_BN[0][0]\n\nblock_10_expand (Conv2D)        (None, 14, 14, 384)  24576       block_9_add[0][0]\n\nblock_10_expand_BN (BatchNormal (None, 14, 14, 384)  1536        block_10_expand[0][0]\n\nblock_10_expand_relu (Activatio (None, 14, 14, 384)  0           block_10_expand_BN[0][0]\n\nblock_10_depthwise (DepthwiseCo (None, 14, 14, 384)  3456        block_10_expand_relu[0][0]\n\nblock_10_depthwise_BN (BatchNor (None, 14, 14, 384)  1536        block_10_depthwise[0][0]\n\nblock_10_depthwise_relu (Activa (None, 14, 14, 384)  0           block_10_depthwise_BN[0][0]\n\nblock_10_project (Conv2D)       (None, 14, 14, 96)   36864       block_10_depthwise_relu[0][0]\n\nblock_10_project_BN (BatchNorma (None, 14, 14, 96)   384         block_10_project[0][0]\n\nblock_11_expand (Conv2D)        (None, 14, 14, 576)  55296       block_10_project_BN[0][0]\n\nblock_11_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_11_expand[0][0]\n\nblock_11_expand_relu (Activatio (None, 14, 14, 576)  0           block_11_expand_BN[0][0]\n\nblock_11_depthwise (DepthwiseCo (None, 14, 14, 576)  5184        block_11_expand_relu[0][0]\n\nblock_11_depthwise_BN (BatchNor (None, 14, 14, 576)  2304        block_11_depthwise[0][0]\n\nblock_11_depthwise_relu (Activa (None, 14, 14, 576)  0           block_11_depthwise_BN[0][0]\n\nblock_11_project (Conv2D)       (None, 14, 14, 96)   55296       block_11_depthwise_relu[0][0]\n\nblock_11_project_BN (BatchNorma (None, 14, 14, 96)   384         block_11_project[0][0]\n\nblock_11_add (Add)              (None, 14, 14, 96)   0           block_10_project_BN[0][0]\nblock_11_project_BN[0][0]\n\nblock_12_expand (Conv2D)        (None, 14, 14, 576)  55296       block_11_add[0][0]\n\nblock_12_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_12_expand[0][0]\n\nblock_12_expand_relu (Activatio (None, 14, 14, 576)  0           block_12_expand_BN[0][0]\n\nblock_12_depthwise (DepthwiseCo (None, 14, 14, 576)  5184        block_12_expand_relu[0][0]\n\nblock_12_depthwise_BN (BatchNor (None, 14, 14, 576)  2304        block_12_depthwise[0][0]\n\nblock_12_depthwise_relu (Activa (None, 14, 14, 576)  0           block_12_depthwise_BN[0][0]\n\nblock_12_project (Conv2D)       (None, 14, 14, 96)   55296       block_12_depthwise_relu[0][0]\n\nblock_12_project_BN (BatchNorma (None, 14, 14, 96)   384         block_12_project[0][0]\n\nblock_12_add (Add)              (None, 14, 14, 96)   0           block_11_add[0][0]\nblock_12_project_BN[0][0]\n\nblock_13_expand (Conv2D)        (None, 14, 14, 576)  55296       block_12_add[0][0]\n\nblock_13_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_13_expand[0][0]\n\nblock_13_expand_relu (Activatio (None, 14, 14, 576)  0           block_13_expand_BN[0][0]\n\nblock_13_depthwise (DepthwiseCo (None, 7, 7, 576)    5184        block_13_expand_relu[0][0]\n\nblock_13_depthwise_BN (BatchNor (None, 7, 7, 576)    2304        block_13_depthwise[0][0]\n\nblock_13_depthwise_relu (Activa (None, 7, 7, 576)    0           block_13_depthwise_BN[0][0]\n\nblock_13_project (Conv2D)       (None, 7, 7, 160)    92160       block_13_depthwise_relu[0][0]\n\nblock_13_project_BN (BatchNorma (None, 7, 7, 160)    640         block_13_project[0][0]\n\nblock_14_expand (Conv2D)        (None, 7, 7, 960)    153600      block_13_project_BN[0][0]\n\nblock_14_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_14_expand[0][0]\n\nblock_14_expand_relu (Activatio (None, 7, 7, 960)    0           block_14_expand_BN[0][0]\n\nblock_14_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_14_expand_relu[0][0]\n\nblock_14_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_14_depthwise[0][0]\n\nblock_14_depthwise_relu (Activa (None, 7, 7, 960)    0           block_14_depthwise_BN[0][0]\n\nblock_14_project (Conv2D)       (None, 7, 7, 160)    153600      block_14_depthwise_relu[0][0]\n\nblock_14_project_BN (BatchNorma (None, 7, 7, 160)    640         block_14_project[0][0]\n\nblock_14_add (Add)              (None, 7, 7, 160)    0           block_13_project_BN[0][0]\nblock_14_project_BN[0][0]\n\nblock_15_expand (Conv2D)        (None, 7, 7, 960)    153600      block_14_add[0][0]\n\nblock_15_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_15_expand[0][0]\n\nblock_15_expand_relu (Activatio (None, 7, 7, 960)    0           block_15_expand_BN[0][0]\n\nblock_15_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_15_expand_relu[0][0]\n\nblock_15_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_15_depthwise[0][0]\n\nblock_15_depthwise_relu (Activa (None, 7, 7, 960)    0           block_15_depthwise_BN[0][0]\n\nblock_15_project (Conv2D)       (None, 7, 7, 160)    153600      block_15_depthwise_relu[0][0]\n\nblock_15_project_BN (BatchNorma (None, 7, 7, 160)    640         block_15_project[0][0]\n\nblock_15_add (Add)              (None, 7, 7, 160)    0           block_14_add[0][0]\nblock_15_project_BN[0][0]\n\nblock_16_expand (Conv2D)        (None, 7, 7, 960)    153600      block_15_add[0][0]\n\nblock_16_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_16_expand[0][0]\n\nblock_16_expand_relu (Activatio (None, 7, 7, 960)    0           block_16_expand_BN[0][0]\n\nblock_16_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_16_expand_relu[0][0]\n\nblock_16_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_16_depthwise[0][0]\n\nblock_16_depthwise_relu (Activa (None, 7, 7, 960)    0           block_16_depthwise_BN[0][0]\n\nblock_16_project (Conv2D)       (None, 7, 7, 320)    307200      block_16_depthwise_relu[0][0]\n\nblock_16_project_BN (BatchNorma (None, 7, 7, 320)    1280        block_16_project[0][0]\n\nConv_1 (Conv2D)                 (None, 7, 7, 1280)   409600      block_16_project_BN[0][0]\n\nConv_1_bn (BatchNormalization)  (None, 7, 7, 1280)   5120        Conv_1[0][0]\n\nout_relu (Activation)           (None, 7, 7, 1280)   0           Conv_1_bn[0][0]\n\nglobal_average_pooling2d_1 (Glo (None, 1280)         0           out_relu[0][0]\n\ndrop (Dropout)                  (None, 1280)         0           global_average_pooling2d_1[0][0]\n\ndistribution (Dense)            (None, 10)           12810       drop[0][0]\nThen I used the following code to create the .pb file:\ndef serialize_model(model):\n    # Serialize the model and get its weights, for quick re-building.\n    config = model.get_config()\n    weights = model.get_weights()\n\n    # Re-build a model where the learning phase is now hard-coded to 0.\n    # CustomObjectScope necessary for importing a pre-trained MobileNet\n    with CustomObjectScope({'relu6': relu6}):\n        new_model = Model.from_config(config)\n\n    new_model.set_weights(weights)\n\n    input_layers = new_model.input\n    print(new_model.input_shape)\n\n    output_layers = new_model.output\n    print(new_model.output_shape)\n\n    temp_dir = \"graph\"\n    checkpoint_prefix = os.path.join(temp_dir, \"saved_checkpoint\")\n    checkpoint_state_name = \"checkpoint_state\"\n    input_graph_name = \"input_graph.pb\"\n    output_graph_name = \"output_graph.pb\"\n\n    # Temporary save graph to disk without weights included.\n    saver = tf.train.Saver()\n    checkpoint_path = saver.save(K.get_session(), checkpoint_prefix, global_step=0,\n                                 latest_filename=checkpoint_state_name)\n    tf.train.write_graph(K.get_session().graph, temp_dir, input_graph_name)\n\n    input_graph_path = os.path.join(temp_dir, input_graph_name)\n    input_saver_def_path = \"\"\n    input_binary = False\n    output_node_names = model.output.name.split(':')[0]  # model dependent\n    restore_op_name = \"save/restore_all\"\n    filename_tensor_name = \"save/Const:0\"\n    output_graph_path = os.path.join(temp_dir, output_graph_name)\n    clear_devices = False\n\n    # Embed weights inside the graph and save to disk.\n    freeze_graph.freeze_graph(input_graph_path, input_saver_def_path, input_binary, checkpoint_path, output_node_names,\n                              restore_op_name, filename_tensor_name, output_graph_path, clear_devices, \"\")\n\n    # The output_graph is the resulting and functional graph with embedded weights.\n    if os.path.exists(\"graph/output_graph.pb\"):\n        print(\"Model successfully exported to .pb file\")\n\nAfter that I used this command to strip unused nodes:\n\nbazel run tensorflow/tools/graph_transforms:transform_graph --\n--in_graph=input.pb\n--out_graph=output.pb --inputs='input_1_2' --outputs='distribution_2/Softmax'\n--transforms='\nstrip_unused_nodes(type=float, shape=\"1,224,224,3\")\nfold_constants(ignore_errors=true)\nfold_batch_norms'\n\nAll these steps worked fine but when trying to export the file into .tflite the errors mentioned in my post above occure.", "body": "@gargn I'm afraid I cannot upload the file itself but here is the output of keras.model.summary( ). I hope that helps:\r\n__________________________________________________________________________________________________\r\nLayer (type)                    Output Shape         Param #     Connected to                     \r\n__________________________________________________________________________________________________\r\n\r\ninput_1 (InputLayer)            (None, 224, 224, 3)  0                                            \r\n__________________________________________________________________________________________________\r\nConv1 (Conv2D)                  (None, 112, 112, 32) 864         input_1[0][0]                    \r\n__________________________________________________________________________________________________\r\nbn_Conv1 (BatchNormalization)   (None, 112, 112, 32) 128         Conv1[0][0]                      \r\n__________________________________________________________________________________________________\r\nConv1_relu (Activation)         (None, 112, 112, 32) 0           bn_Conv1[0][0]                   \r\n__________________________________________________________________________________________________\r\nexpanded_conv_depthwise (Depthw (None, 112, 112, 32) 288         Conv1_relu[0][0]                 \r\n__________________________________________________________________________________________________\r\nexpanded_conv_depthwise_BN (Bat (None, 112, 112, 32) 128         expanded_conv_depthwise[0][0]    \r\n__________________________________________________________________________________________________\r\nexpanded_conv_depthwise_relu (A (None, 112, 112, 32) 0           expanded_conv_depthwise_BN[0][0] \r\n__________________________________________________________________________________________________\r\nexpanded_conv_project (Conv2D)  (None, 112, 112, 16) 512         expanded_conv_depthwise_relu[0][0\r\n__________________________________________________________________________________________________\r\nexpanded_conv_project_BN (Batch (None, 112, 112, 16) 64          expanded_conv_project[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_1_expand (Conv2D)         (None, 112, 112, 96) 1536        expanded_conv_project_BN[0][0]   \r\n__________________________________________________________________________________________________\r\nblock_1_expand_BN (BatchNormali (None, 112, 112, 96) 384         block_1_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_1_expand_relu (Activation (None, 112, 112, 96) 0           block_1_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_1_depthwise (DepthwiseCon (None, 56, 56, 96)   864         block_1_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_1_depthwise_BN (BatchNorm (None, 56, 56, 96)   384         block_1_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_1_depthwise_relu (Activat (None, 56, 56, 96)   0           block_1_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_1_project (Conv2D)        (None, 56, 56, 24)   2304        block_1_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_1_project_BN (BatchNormal (None, 56, 56, 24)   96          block_1_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_2_expand (Conv2D)         (None, 56, 56, 144)  3456        block_1_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_2_expand_BN (BatchNormali (None, 56, 56, 144)  576         block_2_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_2_expand_relu (Activation (None, 56, 56, 144)  0           block_2_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_2_depthwise (DepthwiseCon (None, 56, 56, 144)  1296        block_2_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_2_depthwise_BN (BatchNorm (None, 56, 56, 144)  576         block_2_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_2_depthwise_relu (Activat (None, 56, 56, 144)  0           block_2_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_2_project (Conv2D)        (None, 56, 56, 24)   3456        block_2_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_2_project_BN (BatchNormal (None, 56, 56, 24)   96          block_2_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_2_add (Add)               (None, 56, 56, 24)   0           block_1_project_BN[0][0]         \r\n                                                                 block_2_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_3_expand (Conv2D)         (None, 56, 56, 144)  3456        block_2_add[0][0]                \r\n__________________________________________________________________________________________________\r\nblock_3_expand_BN (BatchNormali (None, 56, 56, 144)  576         block_3_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_3_expand_relu (Activation (None, 56, 56, 144)  0           block_3_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_3_depthwise (DepthwiseCon (None, 28, 28, 144)  1296        block_3_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_3_depthwise_BN (BatchNorm (None, 28, 28, 144)  576         block_3_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_3_depthwise_relu (Activat (None, 28, 28, 144)  0           block_3_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_3_project (Conv2D)        (None, 28, 28, 32)   4608        block_3_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_3_project_BN (BatchNormal (None, 28, 28, 32)   128         block_3_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_4_expand (Conv2D)         (None, 28, 28, 192)  6144        block_3_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_4_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_4_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_4_expand_relu (Activation (None, 28, 28, 192)  0           block_4_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_4_depthwise (DepthwiseCon (None, 28, 28, 192)  1728        block_4_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_4_depthwise_BN (BatchNorm (None, 28, 28, 192)  768         block_4_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_4_depthwise_relu (Activat (None, 28, 28, 192)  0           block_4_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_4_project (Conv2D)        (None, 28, 28, 32)   6144        block_4_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_4_project_BN (BatchNormal (None, 28, 28, 32)   128         block_4_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_4_add (Add)               (None, 28, 28, 32)   0           block_3_project_BN[0][0]         \r\n                                                                 block_4_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_5_expand (Conv2D)         (None, 28, 28, 192)  6144        block_4_add[0][0]                \r\n__________________________________________________________________________________________________\r\nblock_5_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_5_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_5_expand_relu (Activation (None, 28, 28, 192)  0           block_5_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_5_depthwise (DepthwiseCon (None, 28, 28, 192)  1728        block_5_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_5_depthwise_BN (BatchNorm (None, 28, 28, 192)  768         block_5_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_5_depthwise_relu (Activat (None, 28, 28, 192)  0           block_5_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_5_project (Conv2D)        (None, 28, 28, 32)   6144        block_5_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_5_project_BN (BatchNormal (None, 28, 28, 32)   128         block_5_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_5_add (Add)               (None, 28, 28, 32)   0           block_4_add[0][0]                \r\n                                                                 block_5_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_6_expand (Conv2D)         (None, 28, 28, 192)  6144        block_5_add[0][0]                \r\n__________________________________________________________________________________________________\r\nblock_6_expand_BN (BatchNormali (None, 28, 28, 192)  768         block_6_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_6_expand_relu (Activation (None, 28, 28, 192)  0           block_6_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_6_depthwise (DepthwiseCon (None, 14, 14, 192)  1728        block_6_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_6_depthwise_BN (BatchNorm (None, 14, 14, 192)  768         block_6_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_6_depthwise_relu (Activat (None, 14, 14, 192)  0           block_6_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_6_project (Conv2D)        (None, 14, 14, 64)   12288       block_6_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_6_project_BN (BatchNormal (None, 14, 14, 64)   256         block_6_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_7_expand (Conv2D)         (None, 14, 14, 384)  24576       block_6_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_7_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_7_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_7_expand_relu (Activation (None, 14, 14, 384)  0           block_7_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_7_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_7_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_7_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_7_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_7_depthwise_relu (Activat (None, 14, 14, 384)  0           block_7_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_7_project (Conv2D)        (None, 14, 14, 64)   24576       block_7_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_7_project_BN (BatchNormal (None, 14, 14, 64)   256         block_7_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_7_add (Add)               (None, 14, 14, 64)   0           block_6_project_BN[0][0]         \r\n                                                                 block_7_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_8_expand (Conv2D)         (None, 14, 14, 384)  24576       block_7_add[0][0]                \r\n__________________________________________________________________________________________________\r\nblock_8_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_8_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_8_expand_relu (Activation (None, 14, 14, 384)  0           block_8_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_8_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_8_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_8_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_8_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_8_depthwise_relu (Activat (None, 14, 14, 384)  0           block_8_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_8_project (Conv2D)        (None, 14, 14, 64)   24576       block_8_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_8_project_BN (BatchNormal (None, 14, 14, 64)   256         block_8_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_8_add (Add)               (None, 14, 14, 64)   0           block_7_add[0][0]                \r\n                                                                 block_8_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_9_expand (Conv2D)         (None, 14, 14, 384)  24576       block_8_add[0][0]                \r\n__________________________________________________________________________________________________\r\nblock_9_expand_BN (BatchNormali (None, 14, 14, 384)  1536        block_9_expand[0][0]             \r\n__________________________________________________________________________________________________\r\nblock_9_expand_relu (Activation (None, 14, 14, 384)  0           block_9_expand_BN[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_9_depthwise (DepthwiseCon (None, 14, 14, 384)  3456        block_9_expand_relu[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_9_depthwise_BN (BatchNorm (None, 14, 14, 384)  1536        block_9_depthwise[0][0]          \r\n__________________________________________________________________________________________________\r\nblock_9_depthwise_relu (Activat (None, 14, 14, 384)  0           block_9_depthwise_BN[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_9_project (Conv2D)        (None, 14, 14, 64)   24576       block_9_depthwise_relu[0][0]     \r\n__________________________________________________________________________________________________\r\nblock_9_project_BN (BatchNormal (None, 14, 14, 64)   256         block_9_project[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_9_add (Add)               (None, 14, 14, 64)   0           block_8_add[0][0]                \r\n                                                                 block_9_project_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_10_expand (Conv2D)        (None, 14, 14, 384)  24576       block_9_add[0][0]                \r\n__________________________________________________________________________________________________\r\nblock_10_expand_BN (BatchNormal (None, 14, 14, 384)  1536        block_10_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_10_expand_relu (Activatio (None, 14, 14, 384)  0           block_10_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_10_depthwise (DepthwiseCo (None, 14, 14, 384)  3456        block_10_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_10_depthwise_BN (BatchNor (None, 14, 14, 384)  1536        block_10_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_10_depthwise_relu (Activa (None, 14, 14, 384)  0           block_10_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_10_project (Conv2D)       (None, 14, 14, 96)   36864       block_10_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_10_project_BN (BatchNorma (None, 14, 14, 96)   384         block_10_project[0][0]           \r\n__________________________________________________________________________________________________\r\nblock_11_expand (Conv2D)        (None, 14, 14, 576)  55296       block_10_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_11_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_11_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_11_expand_relu (Activatio (None, 14, 14, 576)  0           block_11_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_11_depthwise (DepthwiseCo (None, 14, 14, 576)  5184        block_11_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_11_depthwise_BN (BatchNor (None, 14, 14, 576)  2304        block_11_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_11_depthwise_relu (Activa (None, 14, 14, 576)  0           block_11_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_11_project (Conv2D)       (None, 14, 14, 96)   55296       block_11_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_11_project_BN (BatchNorma (None, 14, 14, 96)   384         block_11_project[0][0]           \r\n__________________________________________________________________________________________________\r\nblock_11_add (Add)              (None, 14, 14, 96)   0           block_10_project_BN[0][0]        \r\n                                                                 block_11_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_12_expand (Conv2D)        (None, 14, 14, 576)  55296       block_11_add[0][0]               \r\n__________________________________________________________________________________________________\r\nblock_12_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_12_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_12_expand_relu (Activatio (None, 14, 14, 576)  0           block_12_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_12_depthwise (DepthwiseCo (None, 14, 14, 576)  5184        block_12_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_12_depthwise_BN (BatchNor (None, 14, 14, 576)  2304        block_12_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_12_depthwise_relu (Activa (None, 14, 14, 576)  0           block_12_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_12_project (Conv2D)       (None, 14, 14, 96)   55296       block_12_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_12_project_BN (BatchNorma (None, 14, 14, 96)   384         block_12_project[0][0]           \r\n__________________________________________________________________________________________________\r\nblock_12_add (Add)              (None, 14, 14, 96)   0           block_11_add[0][0]               \r\n                                                                 block_12_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_13_expand (Conv2D)        (None, 14, 14, 576)  55296       block_12_add[0][0]               \r\n__________________________________________________________________________________________________\r\nblock_13_expand_BN (BatchNormal (None, 14, 14, 576)  2304        block_13_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_13_expand_relu (Activatio (None, 14, 14, 576)  0           block_13_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_13_depthwise (DepthwiseCo (None, 7, 7, 576)    5184        block_13_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_13_depthwise_BN (BatchNor (None, 7, 7, 576)    2304        block_13_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_13_depthwise_relu (Activa (None, 7, 7, 576)    0           block_13_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_13_project (Conv2D)       (None, 7, 7, 160)    92160       block_13_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_13_project_BN (BatchNorma (None, 7, 7, 160)    640         block_13_project[0][0]           \r\n__________________________________________________________________________________________________\r\nblock_14_expand (Conv2D)        (None, 7, 7, 960)    153600      block_13_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_14_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_14_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_14_expand_relu (Activatio (None, 7, 7, 960)    0           block_14_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_14_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_14_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_14_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_14_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_14_depthwise_relu (Activa (None, 7, 7, 960)    0           block_14_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_14_project (Conv2D)       (None, 7, 7, 160)    153600      block_14_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_14_project_BN (BatchNorma (None, 7, 7, 160)    640         block_14_project[0][0]           \r\n__________________________________________________________________________________________________\r\nblock_14_add (Add)              (None, 7, 7, 160)    0           block_13_project_BN[0][0]        \r\n                                                                 block_14_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_15_expand (Conv2D)        (None, 7, 7, 960)    153600      block_14_add[0][0]               \r\n__________________________________________________________________________________________________\r\nblock_15_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_15_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_15_expand_relu (Activatio (None, 7, 7, 960)    0           block_15_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_15_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_15_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_15_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_15_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_15_depthwise_relu (Activa (None, 7, 7, 960)    0           block_15_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_15_project (Conv2D)       (None, 7, 7, 160)    153600      block_15_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_15_project_BN (BatchNorma (None, 7, 7, 160)    640         block_15_project[0][0]           \r\n__________________________________________________________________________________________________\r\nblock_15_add (Add)              (None, 7, 7, 160)    0           block_14_add[0][0]               \r\n                                                                 block_15_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nblock_16_expand (Conv2D)        (None, 7, 7, 960)    153600      block_15_add[0][0]               \r\n__________________________________________________________________________________________________\r\nblock_16_expand_BN (BatchNormal (None, 7, 7, 960)    3840        block_16_expand[0][0]            \r\n__________________________________________________________________________________________________\r\nblock_16_expand_relu (Activatio (None, 7, 7, 960)    0           block_16_expand_BN[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_16_depthwise (DepthwiseCo (None, 7, 7, 960)    8640        block_16_expand_relu[0][0]       \r\n__________________________________________________________________________________________________\r\nblock_16_depthwise_BN (BatchNor (None, 7, 7, 960)    3840        block_16_depthwise[0][0]         \r\n__________________________________________________________________________________________________\r\nblock_16_depthwise_relu (Activa (None, 7, 7, 960)    0           block_16_depthwise_BN[0][0]      \r\n__________________________________________________________________________________________________\r\nblock_16_project (Conv2D)       (None, 7, 7, 320)    307200      block_16_depthwise_relu[0][0]    \r\n__________________________________________________________________________________________________\r\nblock_16_project_BN (BatchNorma (None, 7, 7, 320)    1280        block_16_project[0][0]           \r\n__________________________________________________________________________________________________\r\nConv_1 (Conv2D)                 (None, 7, 7, 1280)   409600      block_16_project_BN[0][0]        \r\n__________________________________________________________________________________________________\r\nConv_1_bn (BatchNormalization)  (None, 7, 7, 1280)   5120        Conv_1[0][0]                     \r\n__________________________________________________________________________________________________\r\nout_relu (Activation)           (None, 7, 7, 1280)   0           Conv_1_bn[0][0]                  \r\n__________________________________________________________________________________________________\r\nglobal_average_pooling2d_1 (Glo (None, 1280)         0           out_relu[0][0]                   \r\n__________________________________________________________________________________________________\r\ndrop (Dropout)                  (None, 1280)         0           global_average_pooling2d_1[0][0] \r\n__________________________________________________________________________________________________\r\ndistribution (Dense)            (None, 10)           12810       drop[0][0]                       \r\n\r\nThen I used the following code to create the .pb file:\r\n\r\n```\r\ndef serialize_model(model):\r\n    # Serialize the model and get its weights, for quick re-building.\r\n    config = model.get_config()\r\n    weights = model.get_weights()\r\n\r\n    # Re-build a model where the learning phase is now hard-coded to 0.\r\n    # CustomObjectScope necessary for importing a pre-trained MobileNet\r\n    with CustomObjectScope({'relu6': relu6}):\r\n        new_model = Model.from_config(config)\r\n\r\n    new_model.set_weights(weights)\r\n\r\n    input_layers = new_model.input\r\n    print(new_model.input_shape)\r\n\r\n    output_layers = new_model.output\r\n    print(new_model.output_shape)\r\n\r\n    temp_dir = \"graph\"\r\n    checkpoint_prefix = os.path.join(temp_dir, \"saved_checkpoint\")\r\n    checkpoint_state_name = \"checkpoint_state\"\r\n    input_graph_name = \"input_graph.pb\"\r\n    output_graph_name = \"output_graph.pb\"\r\n\r\n    # Temporary save graph to disk without weights included.\r\n    saver = tf.train.Saver()\r\n    checkpoint_path = saver.save(K.get_session(), checkpoint_prefix, global_step=0,\r\n                                 latest_filename=checkpoint_state_name)\r\n    tf.train.write_graph(K.get_session().graph, temp_dir, input_graph_name)\r\n\r\n    input_graph_path = os.path.join(temp_dir, input_graph_name)\r\n    input_saver_def_path = \"\"\r\n    input_binary = False\r\n    output_node_names = model.output.name.split(':')[0]  # model dependent\r\n    restore_op_name = \"save/restore_all\"\r\n    filename_tensor_name = \"save/Const:0\"\r\n    output_graph_path = os.path.join(temp_dir, output_graph_name)\r\n    clear_devices = False\r\n\r\n    # Embed weights inside the graph and save to disk.\r\n    freeze_graph.freeze_graph(input_graph_path, input_saver_def_path, input_binary, checkpoint_path, output_node_names,\r\n                              restore_op_name, filename_tensor_name, output_graph_path, clear_devices, \"\")\r\n\r\n    # The output_graph is the resulting and functional graph with embedded weights.\r\n    if os.path.exists(\"graph/output_graph.pb\"):\r\n        print(\"Model successfully exported to .pb file\")\r\n```\r\nAfter that I used this command to strip unused nodes:\r\n\r\n> bazel run tensorflow/tools/graph_transforms:transform_graph --\r\n> --in_graph=input.pb\r\n> --out_graph=output.pb --inputs='input_1_2' --outputs='distribution_2/Softmax'\r\n> --transforms='\r\n>   strip_unused_nodes(type=float, shape=\"1,224,224,3\")\r\n>   fold_constants(ignore_errors=true)\r\n>   fold_batch_norms'\r\n\r\nAll these steps worked fine but when trying to export the file into .tflite the errors mentioned in my post above occure."}