{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/518", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/518/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/518/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/518/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/518", "id": 122233160, "node_id": "MDU6SXNzdWUxMjIyMzMxNjA=", "number": 518, "title": "Unable to fetch IndexedSlices", "user": {"login": "kentonl", "id": 2646947, "node_id": "MDQ6VXNlcjI2NDY5NDc=", "avatar_url": "https://avatars3.githubusercontent.com/u/2646947?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kentonl", "html_url": "https://github.com/kentonl", "followers_url": "https://api.github.com/users/kentonl/followers", "following_url": "https://api.github.com/users/kentonl/following{/other_user}", "gists_url": "https://api.github.com/users/kentonl/gists{/gist_id}", "starred_url": "https://api.github.com/users/kentonl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kentonl/subscriptions", "organizations_url": "https://api.github.com/users/kentonl/orgs", "repos_url": "https://api.github.com/users/kentonl/repos", "events_url": "https://api.github.com/users/kentonl/events{/privacy}", "received_events_url": "https://api.github.com/users/kentonl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-12-15T09:49:38Z", "updated_at": "2017-02-09T22:37:45Z", "closed_at": "2016-01-12T23:19:34Z", "author_association": "CONTRIBUTOR", "body_html": "<p>It appears that IndexedSlices cannot be fetched, as demonstrated by the following program, which is trying to inspect the gradients of an embedding matrix:</p>\n<pre><code>import tensorflow as tf\n\nx = tf.placeholder(tf.int32)\ny = tf.placeholder(tf.float32)\nembeddings = tf.get_variable(\"embeddings\", [1, 1])\nloss = tf.reduce_mean(tf.square(y - tf.nn.embedding_lookup(embeddings, x)))\ngrads = tf.gradients(loss, embeddings)\n\nwith tf.Session() as session:\n    tf.initialize_all_variables().run()\n    print(\"Gradient value: {}\".format(session.run(grads, { x : 0, y : 0.0 })))\n</code></pre>\n<p>Running the code above gives this error:</p>\n<pre><code>TypeError: Fetch argument &lt;tensorflow.python.framework.ops.IndexedSlices object at 0x1053d69d0&gt; of &lt;tensorflow.python.framework.ops.IndexedSlices object at 0x1053d69d0&gt; has invalid type &lt;class 'tensorflow.python.framework.ops.IndexedSlices'&gt;, must be a string or Tensor. (Can not convert a IndexedSlices into a Tensor or Operation.)\n</code></pre>\n<p>Is this result intended? If so, would there be a better way to inspect the gradients?</p>\n<p>Thanks!</p>", "body_text": "It appears that IndexedSlices cannot be fetched, as demonstrated by the following program, which is trying to inspect the gradients of an embedding matrix:\nimport tensorflow as tf\n\nx = tf.placeholder(tf.int32)\ny = tf.placeholder(tf.float32)\nembeddings = tf.get_variable(\"embeddings\", [1, 1])\nloss = tf.reduce_mean(tf.square(y - tf.nn.embedding_lookup(embeddings, x)))\ngrads = tf.gradients(loss, embeddings)\n\nwith tf.Session() as session:\n    tf.initialize_all_variables().run()\n    print(\"Gradient value: {}\".format(session.run(grads, { x : 0, y : 0.0 })))\n\nRunning the code above gives this error:\nTypeError: Fetch argument <tensorflow.python.framework.ops.IndexedSlices object at 0x1053d69d0> of <tensorflow.python.framework.ops.IndexedSlices object at 0x1053d69d0> has invalid type <class 'tensorflow.python.framework.ops.IndexedSlices'>, must be a string or Tensor. (Can not convert a IndexedSlices into a Tensor or Operation.)\n\nIs this result intended? If so, would there be a better way to inspect the gradients?\nThanks!", "body": "It appears that IndexedSlices cannot be fetched, as demonstrated by the following program, which is trying to inspect the gradients of an embedding matrix:\n\n```\nimport tensorflow as tf\n\nx = tf.placeholder(tf.int32)\ny = tf.placeholder(tf.float32)\nembeddings = tf.get_variable(\"embeddings\", [1, 1])\nloss = tf.reduce_mean(tf.square(y - tf.nn.embedding_lookup(embeddings, x)))\ngrads = tf.gradients(loss, embeddings)\n\nwith tf.Session() as session:\n    tf.initialize_all_variables().run()\n    print(\"Gradient value: {}\".format(session.run(grads, { x : 0, y : 0.0 })))\n```\n\nRunning the code above gives this error:\n\n```\nTypeError: Fetch argument <tensorflow.python.framework.ops.IndexedSlices object at 0x1053d69d0> of <tensorflow.python.framework.ops.IndexedSlices object at 0x1053d69d0> has invalid type <class 'tensorflow.python.framework.ops.IndexedSlices'>, must be a string or Tensor. (Can not convert a IndexedSlices into a Tensor or Operation.)\n```\n\nIs this result intended? If so, would there be a better way to inspect the gradients?\n\nThanks!\n"}