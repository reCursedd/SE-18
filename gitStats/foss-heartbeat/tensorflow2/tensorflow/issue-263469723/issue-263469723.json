{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13523", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13523/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13523/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13523/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13523", "id": 263469723, "node_id": "MDU6SXNzdWUyNjM0Njk3MjM=", "number": 13523, "title": "Float variable in loop not incremented properly", "user": {"login": "bernhardlutz", "id": 5912133, "node_id": "MDQ6VXNlcjU5MTIxMzM=", "avatar_url": "https://avatars3.githubusercontent.com/u/5912133?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bernhardlutz", "html_url": "https://github.com/bernhardlutz", "followers_url": "https://api.github.com/users/bernhardlutz/followers", "following_url": "https://api.github.com/users/bernhardlutz/following{/other_user}", "gists_url": "https://api.github.com/users/bernhardlutz/gists{/gist_id}", "starred_url": "https://api.github.com/users/bernhardlutz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bernhardlutz/subscriptions", "organizations_url": "https://api.github.com/users/bernhardlutz/orgs", "repos_url": "https://api.github.com/users/bernhardlutz/repos", "events_url": "https://api.github.com/users/bernhardlutz/events{/privacy}", "received_events_url": "https://api.github.com/users/bernhardlutz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-10-06T14:41:27Z", "updated_at": "2017-10-06T16:03:05Z", "closed_at": "2017-10-06T16:03:05Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>I am running the following code in tensorflow:</p>\n<p>import tensorflow as tf</p>\n<p>count = tf.get_variable(\"count\", shape=(), dtype=tf.float32, trainable=False)<br>\ntf.assign(count, 0)<br>\ni = tf.get_variable(\"i\", shape=(), dtype=tf.int32, trainable=False)<br>\ntf.assign(i, 0)</p>\n<p>cond = lambda i, count: tf.less(i, 5)<br>\nbody = lambda i, count: (tf.add(i,1), tf.add(count, 1))<br>\ni, count = tf.while_loop(cond, body, [i, count], shape_invariants=[tf.TensorShape(None), tf.TensorShape(None)])</p>\n<p>init = tf.global_variables_initializer()</p>\n<p>with tf.Session() as session:<br>\nsession.run(init)<br>\nprint(\"i\", session.run(i), \"count\", session.run(count))</p>\n<p>The expected result is that both, count and i have value 5. However, for count I get always different strange results like 6.18427 5.47266 5.81323</p>\n<p>However, when I change the datatype of count to tf.int32, it works as expected.</p>\n<p>Ubuntu 16.04 64 Bit<br>\nTF Version: v1.2.0-5-g435cdfc 1.2.1<br>\nPython 3.5.2</p>", "body_text": "Hi,\nI am running the following code in tensorflow:\nimport tensorflow as tf\ncount = tf.get_variable(\"count\", shape=(), dtype=tf.float32, trainable=False)\ntf.assign(count, 0)\ni = tf.get_variable(\"i\", shape=(), dtype=tf.int32, trainable=False)\ntf.assign(i, 0)\ncond = lambda i, count: tf.less(i, 5)\nbody = lambda i, count: (tf.add(i,1), tf.add(count, 1))\ni, count = tf.while_loop(cond, body, [i, count], shape_invariants=[tf.TensorShape(None), tf.TensorShape(None)])\ninit = tf.global_variables_initializer()\nwith tf.Session() as session:\nsession.run(init)\nprint(\"i\", session.run(i), \"count\", session.run(count))\nThe expected result is that both, count and i have value 5. However, for count I get always different strange results like 6.18427 5.47266 5.81323\nHowever, when I change the datatype of count to tf.int32, it works as expected.\nUbuntu 16.04 64 Bit\nTF Version: v1.2.0-5-g435cdfc 1.2.1\nPython 3.5.2", "body": "Hi,\r\n\r\nI am running the following code in tensorflow:\r\n\r\nimport tensorflow as tf\r\n\r\ncount = tf.get_variable(\"count\", shape=(), dtype=tf.float32, trainable=False)\r\ntf.assign(count, 0)\r\ni = tf.get_variable(\"i\", shape=(), dtype=tf.int32, trainable=False)\r\ntf.assign(i, 0)\r\n\r\ncond = lambda i, count: tf.less(i, 5)\r\nbody = lambda i, count: (tf.add(i,1), tf.add(count, 1))\r\ni, count = tf.while_loop(cond, body, [i, count], shape_invariants=[tf.TensorShape(None), tf.TensorShape(None)])\r\n\r\ninit = tf.global_variables_initializer()\r\n\r\nwith tf.Session() as session:\r\n    session.run(init)\r\n    print(\"i\", session.run(i), \"count\", session.run(count))\r\n\r\nThe expected result is that both, count and i have value 5. However, for count I get always different strange results like 6.18427 5.47266 5.81323\r\n\r\nHowever, when I change the datatype of count to tf.int32, it works as expected.\r\n\r\nUbuntu 16.04 64 Bit\r\nTF Version: v1.2.0-5-g435cdfc 1.2.1\r\nPython 3.5.2\r\n"}