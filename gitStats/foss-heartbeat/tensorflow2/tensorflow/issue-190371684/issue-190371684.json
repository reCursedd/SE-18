{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5695", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5695/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5695/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5695/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5695", "id": 190371684, "node_id": "MDU6SXNzdWUxOTAzNzE2ODQ=", "number": 5695, "title": "strange output and jam while running \"train_setp.run()\" in tensorflow", "user": {"login": "liu-mingyuan", "id": 23001069, "node_id": "MDQ6VXNlcjIzMDAxMDY5", "avatar_url": "https://avatars0.githubusercontent.com/u/23001069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liu-mingyuan", "html_url": "https://github.com/liu-mingyuan", "followers_url": "https://api.github.com/users/liu-mingyuan/followers", "following_url": "https://api.github.com/users/liu-mingyuan/following{/other_user}", "gists_url": "https://api.github.com/users/liu-mingyuan/gists{/gist_id}", "starred_url": "https://api.github.com/users/liu-mingyuan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liu-mingyuan/subscriptions", "organizations_url": "https://api.github.com/users/liu-mingyuan/orgs", "repos_url": "https://api.github.com/users/liu-mingyuan/repos", "events_url": "https://api.github.com/users/liu-mingyuan/events{/privacy}", "received_events_url": "https://api.github.com/users/liu-mingyuan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-11-18T17:09:05Z", "updated_at": "2016-11-21T20:38:12Z", "closed_at": "2016-11-21T20:38:12Z", "author_association": "NONE", "body_html": "<p>I am a newcomer of Tensorflow and I encounter trouble while trying to train a convolutional neuralnetwork. I receive massive output information which seems initializing something while running:<br>\n<strong>train_step.run(session=sess,feed_dict={x:batch[0],y_:batch[1],keep_prob:0.5})</strong><br>\nWhat is more, while testing the accuracy of my training data, the program output some information and stop working, so I have to stop it with \"ctrl+c\"<br>\nI think there is something wrong with \"sess\"  but I do not know how to fix them. Part of my code are listed below:<br>\nto emphasize the places I think are important and help you understand it quickly, I use # in my code and (  )in my output to express what  I think and mark some vital command by -&gt;</p>\n<pre><code>-&gt;sess = tf.InteractiveSession(config=tf.ConfigProto(log_device_placement=True))\n# I initialized my sess\nfor d in ['/gpu:0']:\n    with tf.device(d):\n        x=tf.placeholder(tf.float32,shape=[None, 224, 224, 1])\n        y_=tf.placeholder(tf.float32,shape=[None,3])\n      -&gt;vggNet=vgg16( x, weights='vgg16_weights.npz', sess=sess)\n         # vgg16 is a Class to define and initialize neuralnetwork\n        cross_entropy = -tf.reduce_sum(y_*tf.log(tf.clip_by_value(vggNet.probs,1e-10,1.0)))\ntrain_step=tf.train.AdamOptimizer(l_rate).minimize(cross_entropy)\ncorrect_prediction=tf.equal(tf.argmax(vggNet.probs,1),tf.argmax(y_,1))\naccuracy=tf.reduce_mean(tf.cast(correct_prediction,\"float\"))\n-&gt;sess.run(tf.initialize_all_variables())\nprint ('\\n\\n\\n session run successfully ! \\n\\n\\n')\n#I think after this, there should not be any initialize work\nfor i in range (20000):\n    batch=octData.train.next_batch(train_batch_size)\n    #load data to batch\n    if (i+1)%5==0:\n        print '#',\n        #this has been printed\n    if (i+1)%20==0:\n        print ('evaluating train dataset ...')\n        #this has been printed but the program get stuck after some output\n        train_accuracy = sess.run(accuracy,feed_dict={x:batch[0], y_: batch[1], vggNet.keep_prob: 1.0})\n        #after this my program jammed, the following print do not work\n        print \"  step %d, training accuracy %g\"%(i,train_accuracy)\n   -&gt;train_step.run(session=sess,feed_dict={x:batch[0],y_:batch[1],vggNet.keep_prob:0.5})\n    #I think all the strange output are printed by this,vggNet.keep_prob is a parameter to control drop out in fc layer\n</code></pre>\n<p>According to the tutorial of tensorflow, the output in the loop <strong>for i in range (20000):</strong> should be what I print in the program. However, the following information are presented to me.</p>\n<pre><code>session run successfully !   \n(I believe this is the printed info at previous line before the loop **for i in range (20000):**)\n\n\nAdam/epsilon: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . . (I omit some similar output there )\ngradients/clip_by_value/Minimum_grad/Shape_1: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . . \nfc3/weights/read: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . .\nI tensorflow/core/common_runtime/simple_placer.cc:819] conv5_3/biases/read: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . .\nconv5_3/biases/read: /job:localhost/replica:0/task:0/gpu:0\n. . . . . . \n. . . . . . \n# # # # evaluating train dataset ...\n(I think the program is about to calculate the accuracy of training set)\n. . . . . .\nfc3/biases/read: /job:localhost/replica:0/task:0/gpu:0\n. , . . . .\nI tensorflow/core/common_runtime/simple_placer.cc:819] fc1/Reshape/shape: /job:localhost/replica:0/task:0/gpu:0\n</code></pre>\n<p>And after that my program got jammed. There is nothing wrong with the batch, which is used to read data and it has nothing to do with tensorflow. I think <strong>sess</strong> is the most likely cause of the problem. Do anybody know what is going on and how to fix it?</p>", "body_text": "I am a newcomer of Tensorflow and I encounter trouble while trying to train a convolutional neuralnetwork. I receive massive output information which seems initializing something while running:\ntrain_step.run(session=sess,feed_dict={x:batch[0],y_:batch[1],keep_prob:0.5})\nWhat is more, while testing the accuracy of my training data, the program output some information and stop working, so I have to stop it with \"ctrl+c\"\nI think there is something wrong with \"sess\"  but I do not know how to fix them. Part of my code are listed below:\nto emphasize the places I think are important and help you understand it quickly, I use # in my code and (  )in my output to express what  I think and mark some vital command by ->\n->sess = tf.InteractiveSession(config=tf.ConfigProto(log_device_placement=True))\n# I initialized my sess\nfor d in ['/gpu:0']:\n    with tf.device(d):\n        x=tf.placeholder(tf.float32,shape=[None, 224, 224, 1])\n        y_=tf.placeholder(tf.float32,shape=[None,3])\n      ->vggNet=vgg16( x, weights='vgg16_weights.npz', sess=sess)\n         # vgg16 is a Class to define and initialize neuralnetwork\n        cross_entropy = -tf.reduce_sum(y_*tf.log(tf.clip_by_value(vggNet.probs,1e-10,1.0)))\ntrain_step=tf.train.AdamOptimizer(l_rate).minimize(cross_entropy)\ncorrect_prediction=tf.equal(tf.argmax(vggNet.probs,1),tf.argmax(y_,1))\naccuracy=tf.reduce_mean(tf.cast(correct_prediction,\"float\"))\n->sess.run(tf.initialize_all_variables())\nprint ('\\n\\n\\n session run successfully ! \\n\\n\\n')\n#I think after this, there should not be any initialize work\nfor i in range (20000):\n    batch=octData.train.next_batch(train_batch_size)\n    #load data to batch\n    if (i+1)%5==0:\n        print '#',\n        #this has been printed\n    if (i+1)%20==0:\n        print ('evaluating train dataset ...')\n        #this has been printed but the program get stuck after some output\n        train_accuracy = sess.run(accuracy,feed_dict={x:batch[0], y_: batch[1], vggNet.keep_prob: 1.0})\n        #after this my program jammed, the following print do not work\n        print \"  step %d, training accuracy %g\"%(i,train_accuracy)\n   ->train_step.run(session=sess,feed_dict={x:batch[0],y_:batch[1],vggNet.keep_prob:0.5})\n    #I think all the strange output are printed by this,vggNet.keep_prob is a parameter to control drop out in fc layer\n\nAccording to the tutorial of tensorflow, the output in the loop for i in range (20000): should be what I print in the program. However, the following information are presented to me.\nsession run successfully !   \n(I believe this is the printed info at previous line before the loop **for i in range (20000):**)\n\n\nAdam/epsilon: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . . (I omit some similar output there )\ngradients/clip_by_value/Minimum_grad/Shape_1: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . . \nfc3/weights/read: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . .\nI tensorflow/core/common_runtime/simple_placer.cc:819] conv5_3/biases/read: /job:localhost/replica:0/task:0/gpu:0\n. . .  . . .\nconv5_3/biases/read: /job:localhost/replica:0/task:0/gpu:0\n. . . . . . \n. . . . . . \n# # # # evaluating train dataset ...\n(I think the program is about to calculate the accuracy of training set)\n. . . . . .\nfc3/biases/read: /job:localhost/replica:0/task:0/gpu:0\n. , . . . .\nI tensorflow/core/common_runtime/simple_placer.cc:819] fc1/Reshape/shape: /job:localhost/replica:0/task:0/gpu:0\n\nAnd after that my program got jammed. There is nothing wrong with the batch, which is used to read data and it has nothing to do with tensorflow. I think sess is the most likely cause of the problem. Do anybody know what is going on and how to fix it?", "body": "I am a newcomer of Tensorflow and I encounter trouble while trying to train a convolutional neuralnetwork. I receive massive output information which seems initializing something while running:\r\n**train_step.run(session=sess,feed_dict={x:batch[0],y_:batch[1],keep_prob:0.5})**\r\nWhat is more, while testing the accuracy of my training data, the program output some information and stop working, so I have to stop it with \"ctrl+c\" \r\nI think there is something wrong with \"sess\"  but I do not know how to fix them. Part of my code are listed below:\r\nto emphasize the places I think are important and help you understand it quickly, I use # in my code and (  )in my output to express what  I think and mark some vital command by ->\r\n```\r\n->sess = tf.InteractiveSession(config=tf.ConfigProto(log_device_placement=True))\r\n# I initialized my sess\r\nfor d in ['/gpu:0']:\r\n    with tf.device(d):\r\n        x=tf.placeholder(tf.float32,shape=[None, 224, 224, 1])\r\n        y_=tf.placeholder(tf.float32,shape=[None,3])\r\n      ->vggNet=vgg16( x, weights='vgg16_weights.npz', sess=sess)\r\n         # vgg16 is a Class to define and initialize neuralnetwork\r\n        cross_entropy = -tf.reduce_sum(y_*tf.log(tf.clip_by_value(vggNet.probs,1e-10,1.0)))\r\ntrain_step=tf.train.AdamOptimizer(l_rate).minimize(cross_entropy)\r\ncorrect_prediction=tf.equal(tf.argmax(vggNet.probs,1),tf.argmax(y_,1))\r\naccuracy=tf.reduce_mean(tf.cast(correct_prediction,\"float\"))\r\n->sess.run(tf.initialize_all_variables())\r\nprint ('\\n\\n\\n session run successfully ! \\n\\n\\n')\r\n#I think after this, there should not be any initialize work\r\nfor i in range (20000):\r\n    batch=octData.train.next_batch(train_batch_size)\r\n    #load data to batch\r\n    if (i+1)%5==0:\r\n        print '#',\r\n        #this has been printed\r\n    if (i+1)%20==0:\r\n        print ('evaluating train dataset ...')\r\n        #this has been printed but the program get stuck after some output\r\n        train_accuracy = sess.run(accuracy,feed_dict={x:batch[0], y_: batch[1], vggNet.keep_prob: 1.0})\r\n        #after this my program jammed, the following print do not work\r\n        print \"  step %d, training accuracy %g\"%(i,train_accuracy)\r\n   ->train_step.run(session=sess,feed_dict={x:batch[0],y_:batch[1],vggNet.keep_prob:0.5})\r\n    #I think all the strange output are printed by this,vggNet.keep_prob is a parameter to control drop out in fc layer\r\n```\r\n\r\nAccording to the tutorial of tensorflow, the output in the loop **for i in range (20000):** should be what I print in the program. However, the following information are presented to me.\r\n\r\n```\r\nsession run successfully !   \r\n(I believe this is the printed info at previous line before the loop **for i in range (20000):**)\r\n\r\n\r\nAdam/epsilon: /job:localhost/replica:0/task:0/gpu:0\r\n. . .  . . . (I omit some similar output there )\r\ngradients/clip_by_value/Minimum_grad/Shape_1: /job:localhost/replica:0/task:0/gpu:0\r\n. . .  . . . \r\nfc3/weights/read: /job:localhost/replica:0/task:0/gpu:0\r\n. . .  . . .\r\nI tensorflow/core/common_runtime/simple_placer.cc:819] conv5_3/biases/read: /job:localhost/replica:0/task:0/gpu:0\r\n. . .  . . .\r\nconv5_3/biases/read: /job:localhost/replica:0/task:0/gpu:0\r\n. . . . . . \r\n. . . . . . \r\n# # # # evaluating train dataset ...\r\n(I think the program is about to calculate the accuracy of training set)\r\n. . . . . .\r\nfc3/biases/read: /job:localhost/replica:0/task:0/gpu:0\r\n. , . . . .\r\nI tensorflow/core/common_runtime/simple_placer.cc:819] fc1/Reshape/shape: /job:localhost/replica:0/task:0/gpu:0\r\n```\r\nAnd after that my program got jammed. There is nothing wrong with the batch, which is used to read data and it has nothing to do with tensorflow. I think **sess** is the most likely cause of the problem. Do anybody know what is going on and how to fix it?"}