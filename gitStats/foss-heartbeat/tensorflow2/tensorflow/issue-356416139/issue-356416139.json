{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22023", "id": 356416139, "node_id": "MDU6SXNzdWUzNTY0MTYxMzk=", "number": 22023, "title": "Tensorflow build fails with vectorization ", "user": {"login": "Nayana-ibm", "id": 20816038, "node_id": "MDQ6VXNlcjIwODE2MDM4", "avatar_url": "https://avatars0.githubusercontent.com/u/20816038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nayana-ibm", "html_url": "https://github.com/Nayana-ibm", "followers_url": "https://api.github.com/users/Nayana-ibm/followers", "following_url": "https://api.github.com/users/Nayana-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/Nayana-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nayana-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nayana-ibm/subscriptions", "organizations_url": "https://api.github.com/users/Nayana-ibm/orgs", "repos_url": "https://api.github.com/users/Nayana-ibm/repos", "events_url": "https://api.github.com/users/Nayana-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/Nayana-ibm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2018-09-03T09:01:22Z", "updated_at": "2018-11-13T10:39:54Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:  Ubuntu 16.04, 18.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:  source</li>\n<li><strong>TensorFlow version (use command below)</strong>:  1.8.0</li>\n<li><strong>Python version</strong>:  2.7.15rc1</li>\n<li><strong>Bazel version (if compiling from source)</strong>:  0.12.0</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: gcc-7.3.0, gcc-6.3.0</li>\n<li><strong>CUDA/cuDNN version</strong>: NA</li>\n<li><strong>GPU model and memory</strong>: NA</li>\n<li><strong>Exact command to reproduce</strong>:  <code> bazel build -c opt  --incompatible_load_argument_is_label=false --incompatible_disallow_uncalled_set_constructor=false  --config=opt  --copt=\"-mzvector\" //tensorflow/tools/pip_package:build_pip_package</code></li>\n</ul>\n<p><strong>Description:</strong><br>\nWhile building TensorFlow with vectorization on s390x platform, faced following issues :<br>\n<strong>With gcc 6.3.0 , Ubuntu 16.04, z13</strong>  :</p>\n<pre><code>INFO: From Compiling external/snappy/snappy-sinksource.cc [for host]:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\nSlow read: a 7184608-byte read from /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/sqlite3.c took 26065ms.\nERROR: /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/BUILD:35:1: C++ compilation of rule '@org_sqlite//:org_sqlite' failed (Exit 1)\nexternal/org_sqlite/sqlite3.c: In function 'vdbeRecordCompareInt':\nexternal/org_sqlite/sqlite3.c:76283:1: internal compiler error: in maybe_record_trace_start, at dwarf2cfi.c:2284\n}\n\u02c6\n0x1385bc7 maybe_record_trace_start\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2284\n0x1388285 scan_trace\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2462\n0x13888dd create_cfi_notes\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2616\n0x13888dd execute_dwarf2_frame\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2974\n0x13888dd execute\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:3454\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nPlease include the complete backtrace with any bug report.\nSee &lt;http://gcc.gnu.org/bugs.html&gt; for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 1795.018s, Critical Path: 24.14s\nFAILED: Build did NOT complete successfully\n</code></pre>\n<p><strong>With gcc 6.3.0/7.3.0 , Ubuntu 16.04, z14</strong>  :</p>\n<pre><code>ERROR: /tensorflow/tensorflow/core/kernels/BUILD:436:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed (Exit 1)\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:427:0,\n                from external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,\n                from ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,\n                from ./tensorflow/core/kernels/split_lib.h:20,\n                from tensorflow/core/kernels/split_lib_cpu.cc:18:\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Eigen::internal::Packet4f Eigen::internal::vec_splat_packet4f(const Packet4f&amp;)':\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:11: error: request for member 'v4f' in 'splat', which is of non-class type 'Eigen::internal::Packet4f {aka __vector(4) float}'\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\n          \u02c6\u02dc\u02dc\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:35: error: request for member 'v4f' in 'from', which is of non-class type 'const Packet4f {aka const __vector(4) float}'\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\n                                  \u02c6\u02dc\u02dc\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:44: internal compiler error: tree check: expected class 'type', have 'exceptional' (error_mark) in s390_fn_types_compatible, at config/s390/s390-c.c:727\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\n                                           \u02c6\n0x80cc535f tree_class_check_failed(tree_node const*, tree_code_class, char const*, int, char const*)\n       ../../gcc-6.3.0/gcc/tree.c:9704\n</code></pre>\n<p><strong>With gcc 7.3.0 , Ubuntu 18.04, z14</strong>  :</p>\n<pre><code>\nINFO: From Compiling tensorflow/contrib/lite/util.cc:\ntensorflow/contrib/lite/util.cc: In function 'TfLiteIntArray* tflite::ConvertArrayToTfLiteIntArray(int, const int*)':\ntensorflow/contrib/lite/util.cc:25:24: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (size_t i = 0; i &lt; rank; i++) {\n                      \u02dc\u02dc\u02c6\u02dc\u02dc\u02dc\u02dc\u02dc\nERROR: /scratch/ecos0030/nayana/tensorflow/tensorflow/contrib/lite/kernels/BUILD:43:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:eig         en_support' failed (Exit 1)\nIn file included from external/eigen_archive/Eigen/Core:248:0,\n                 from ./third_party/eigen3/Eigen/Core:1,\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&amp;) [with Packet = __vector(2         ) double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet2d pround&lt;Packet2d&gt;(const Packet2d&amp; a) { return vec_round(a); }\n                                                                                      \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&amp;) [with Packet = __vector(2)          double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet2d pceil&lt;Packet2d&gt;(const  Packet2d&amp; a) { return vec_ceil(a); }\n                                                                                      \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&amp;) [with Packet = __vector(2         ) double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet2d pfloor&lt;Packet2d&gt;(const Packet2d&amp; a) { return vec_floor(a); }\n                                                                                      \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: note: suggested alternative: '__builtin_s390_vfidb'\nIn file included from external/eigen_archive/Eigen/Core:427:0,\n                 from ./third_party/eigen3/Eigen/Core:1,\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pmadd(const Packet&amp;, const Packet&amp;, const Packe         t&amp;) [with Packet = __vector(4) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1073:141: error: cannot convert 'const Packet4f {aka const __vector(4) float}' to '__         vector(2) double' for argument '1' to '__vector(2) double __builtin_s390_vfmadb(__vector(2) double, __vector(2) double, __vector(2) double)'\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet4f pmadd&lt;Packet4f&gt;  (const Packet4f&amp; a, const Packet4f&amp; b, const Packet4f&amp; c) { return vec_madd(a, b, c); }\n                                                                                                                                             \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pxor(const Packet&amp;, const Packet&amp;) [with Packet          = __vector(4) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1078:118: error: invalid parameter combination for intrinsic '__builtin_s390_vec_xor'\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet4f pxor&lt;Packet4f&gt;   (const Packet4f&amp; a, const Packet4f&amp; b) { return vec_xor(a, b); }\n                                                                                                                      \u02c6\nIn file included from external/eigen_archive/Eigen/Core:248:0,\n                 from ./third_party/eigen3/Eigen/Core:1,\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&amp;) [with Packet = __vector(4         ) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet4f pround&lt;Packet4f&gt; (const Packet4f&amp; a) { return vec_round(a); }\n                                                                                       \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&amp;) [with Packet = __vector(4)          float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet4f pceil&lt;Packet4f&gt;  (const Packet4f&amp; a) { return vec_ceil(a); }\n                                                                                       \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&amp;) [with Packet = __vector(4         ) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate&lt;&gt; EIGEN_STRONG_INLINE Packet4f pfloor&lt;Packet4f&gt; (const Packet4f&amp; a) { return vec_floor(a); }\n                                                                                       \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h: In function 'Packet Eigen::internal::pexp(const Packet&amp;) [with Packet = __vector(         2) double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: error: '__builtin_s390_vfi' was not declared in this scope\n   fx = vec_floor(fx);\n        \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: note: suggested alternative: '__builtin_s390_vfidb'\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\n</code></pre>", "body_text": "System information\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Ubuntu 16.04, 18.04\nTensorFlow installed from (source or binary):  source\nTensorFlow version (use command below):  1.8.0\nPython version:  2.7.15rc1\nBazel version (if compiling from source):  0.12.0\nGCC/Compiler version (if compiling from source): gcc-7.3.0, gcc-6.3.0\nCUDA/cuDNN version: NA\nGPU model and memory: NA\nExact command to reproduce:   bazel build -c opt  --incompatible_load_argument_is_label=false --incompatible_disallow_uncalled_set_constructor=false  --config=opt  --copt=\"-mzvector\" //tensorflow/tools/pip_package:build_pip_package\n\nDescription:\nWhile building TensorFlow with vectorization on s390x platform, faced following issues :\nWith gcc 6.3.0 , Ubuntu 16.04, z13  :\nINFO: From Compiling external/snappy/snappy-sinksource.cc [for host]:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\nSlow read: a 7184608-byte read from /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/sqlite3.c took 26065ms.\nERROR: /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/BUILD:35:1: C++ compilation of rule '@org_sqlite//:org_sqlite' failed (Exit 1)\nexternal/org_sqlite/sqlite3.c: In function 'vdbeRecordCompareInt':\nexternal/org_sqlite/sqlite3.c:76283:1: internal compiler error: in maybe_record_trace_start, at dwarf2cfi.c:2284\n}\n\u02c6\n0x1385bc7 maybe_record_trace_start\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2284\n0x1388285 scan_trace\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2462\n0x13888dd create_cfi_notes\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2616\n0x13888dd execute_dwarf2_frame\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2974\n0x13888dd execute\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:3454\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nPlease include the complete backtrace with any bug report.\nSee <http://gcc.gnu.org/bugs.html> for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 1795.018s, Critical Path: 24.14s\nFAILED: Build did NOT complete successfully\n\nWith gcc 6.3.0/7.3.0 , Ubuntu 16.04, z14  :\nERROR: /tensorflow/tensorflow/core/kernels/BUILD:436:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed (Exit 1)\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:427:0,\n                from external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,\n                from ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,\n                from ./tensorflow/core/kernels/split_lib.h:20,\n                from tensorflow/core/kernels/split_lib_cpu.cc:18:\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Eigen::internal::Packet4f Eigen::internal::vec_splat_packet4f(const Packet4f&)':\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:11: error: request for member 'v4f' in 'splat', which is of non-class type 'Eigen::internal::Packet4f {aka __vector(4) float}'\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\n          \u02c6\u02dc\u02dc\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:35: error: request for member 'v4f' in 'from', which is of non-class type 'const Packet4f {aka const __vector(4) float}'\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\n                                  \u02c6\u02dc\u02dc\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:44: internal compiler error: tree check: expected class 'type', have 'exceptional' (error_mark) in s390_fn_types_compatible, at config/s390/s390-c.c:727\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\n                                           \u02c6\n0x80cc535f tree_class_check_failed(tree_node const*, tree_code_class, char const*, int, char const*)\n       ../../gcc-6.3.0/gcc/tree.c:9704\n\nWith gcc 7.3.0 , Ubuntu 18.04, z14  :\n\nINFO: From Compiling tensorflow/contrib/lite/util.cc:\ntensorflow/contrib/lite/util.cc: In function 'TfLiteIntArray* tflite::ConvertArrayToTfLiteIntArray(int, const int*)':\ntensorflow/contrib/lite/util.cc:25:24: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (size_t i = 0; i < rank; i++) {\n                      \u02dc\u02dc\u02c6\u02dc\u02dc\u02dc\u02dc\u02dc\nERROR: /scratch/ecos0030/nayana/tensorflow/tensorflow/contrib/lite/kernels/BUILD:43:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:eig         en_support' failed (Exit 1)\nIn file included from external/eigen_archive/Eigen/Core:248:0,\n                 from ./third_party/eigen3/Eigen/Core:1,\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&) [with Packet = __vector(2         ) double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate<> EIGEN_STRONG_INLINE Packet2d pround<Packet2d>(const Packet2d& a) { return vec_round(a); }\n                                                                                      \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&) [with Packet = __vector(2)          double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate<> EIGEN_STRONG_INLINE Packet2d pceil<Packet2d>(const  Packet2d& a) { return vec_ceil(a); }\n                                                                                      \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&) [with Packet = __vector(2         ) double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate<> EIGEN_STRONG_INLINE Packet2d pfloor<Packet2d>(const Packet2d& a) { return vec_floor(a); }\n                                                                                      \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: note: suggested alternative: '__builtin_s390_vfidb'\nIn file included from external/eigen_archive/Eigen/Core:427:0,\n                 from ./third_party/eigen3/Eigen/Core:1,\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pmadd(const Packet&, const Packet&, const Packe         t&) [with Packet = __vector(4) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1073:141: error: cannot convert 'const Packet4f {aka const __vector(4) float}' to '__         vector(2) double' for argument '1' to '__vector(2) double __builtin_s390_vfmadb(__vector(2) double, __vector(2) double, __vector(2) double)'\ntemplate<> EIGEN_STRONG_INLINE Packet4f pmadd<Packet4f>  (const Packet4f& a, const Packet4f& b, const Packet4f& c) { return vec_madd(a, b, c); }\n                                                                                                                                             \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pxor(const Packet&, const Packet&) [with Packet          = __vector(4) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1078:118: error: invalid parameter combination for intrinsic '__builtin_s390_vec_xor'\ntemplate<> EIGEN_STRONG_INLINE Packet4f pxor<Packet4f>   (const Packet4f& a, const Packet4f& b) { return vec_xor(a, b); }\n                                                                                                                      \u02c6\nIn file included from external/eigen_archive/Eigen/Core:248:0,\n                 from ./third_party/eigen3/Eigen/Core:1,\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&) [with Packet = __vector(4         ) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate<> EIGEN_STRONG_INLINE Packet4f pround<Packet4f> (const Packet4f& a) { return vec_round(a); }\n                                                                                       \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&) [with Packet = __vector(4)          float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate<> EIGEN_STRONG_INLINE Packet4f pceil<Packet4f>  (const Packet4f& a) { return vec_ceil(a); }\n                                                                                       \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&) [with Packet = __vector(4         ) float]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: error: '__builtin_s390_vfi' was not declared in this scope\ntemplate<> EIGEN_STRONG_INLINE Packet4f pfloor<Packet4f> (const Packet4f& a) { return vec_floor(a); }\n                                                                                       \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: note: suggested alternative: '__builtin_s390_vfidb'\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h: In function 'Packet Eigen::internal::pexp(const Packet&) [with Packet = __vector(         2) double]':\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: error: '__builtin_s390_vfi' was not declared in this scope\n   fx = vec_floor(fx);\n        \u02c6\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: note: suggested alternative: '__builtin_s390_vfidb'\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build", "body": "### System information\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  Ubuntu 16.04, 18.04 \r\n- **TensorFlow installed from (source or binary)**:  source \r\n- **TensorFlow version (use command below)**:  1.8.0 \r\n- **Python version**:  2.7.15rc1\r\n- **Bazel version (if compiling from source)**:  0.12.0\r\n- **GCC/Compiler version (if compiling from source)**: gcc-7.3.0, gcc-6.3.0\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**:  ` bazel build -c opt  --incompatible_load_argument_is_label=false --incompatible_disallow_uncalled_set_constructor=false  --config=opt  --copt=\"-mzvector\" //tensorflow/tools/pip_package:build_pip_package`\r\n\r\n**Description:** \r\nWhile building TensorFlow with vectorization on s390x platform, faced following issues :\r\n**With gcc 6.3.0 , Ubuntu 16.04, z13**  :\r\n\r\n```\r\nINFO: From Compiling external/snappy/snappy-sinksource.cc [for host]:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nSlow read: a 7184608-byte read from /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/sqlite3.c took 26065ms.\r\nERROR: /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/BUILD:35:1: C++ compilation of rule '@org_sqlite//:org_sqlite' failed (Exit 1)\r\nexternal/org_sqlite/sqlite3.c: In function 'vdbeRecordCompareInt':\r\nexternal/org_sqlite/sqlite3.c:76283:1: internal compiler error: in maybe_record_trace_start, at dwarf2cfi.c:2284\r\n}\r\n\u02c6\r\n0x1385bc7 maybe_record_trace_start\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2284\r\n0x1388285 scan_trace\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2462\r\n0x13888dd create_cfi_notes\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2616\r\n0x13888dd execute_dwarf2_frame\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2974\r\n0x13888dd execute\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:3454\r\nPlease submit a full bug report,\r\nwith preprocessed source if appropriate.\r\nPlease include the complete backtrace with any bug report.\r\nSee <http://gcc.gnu.org/bugs.html> for instructions.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 1795.018s, Critical Path: 24.14s\r\nFAILED: Build did NOT complete successfully\r\n```\r\n**With gcc 6.3.0/7.3.0 , Ubuntu 16.04, z14**  :\r\n\r\n```\r\nERROR: /tensorflow/tensorflow/core/kernels/BUILD:436:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed (Exit 1)\r\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:427:0,\r\n                from external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,\r\n                from ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,\r\n                from ./tensorflow/core/kernels/split_lib.h:20,\r\n                from tensorflow/core/kernels/split_lib_cpu.cc:18:\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Eigen::internal::Packet4f Eigen::internal::vec_splat_packet4f(const Packet4f&)':\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:11: error: request for member 'v4f' in 'splat', which is of non-class type 'Eigen::internal::Packet4f {aka __vector(4) float}'\r\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\r\n          \u02c6\u02dc\u02dc\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:35: error: request for member 'v4f' in 'from', which is of non-class type 'const Packet4f {aka const __vector(4) float}'\r\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\r\n                                  \u02c6\u02dc\u02dc\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:44: internal compiler error: tree check: expected class 'type', have 'exceptional' (error_mark) in s390_fn_types_compatible, at config/s390/s390-c.c:727\r\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\r\n                                           \u02c6\r\n0x80cc535f tree_class_check_failed(tree_node const*, tree_code_class, char const*, int, char const*)\r\n       ../../gcc-6.3.0/gcc/tree.c:9704\r\n```\r\n\r\n**With gcc 7.3.0 , Ubuntu 18.04, z14**  :\r\n```\r\n\r\nINFO: From Compiling tensorflow/contrib/lite/util.cc:\r\ntensorflow/contrib/lite/util.cc: In function 'TfLiteIntArray* tflite::ConvertArrayToTfLiteIntArray(int, const int*)':\r\ntensorflow/contrib/lite/util.cc:25:24: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   for (size_t i = 0; i < rank; i++) {\r\n                      \u02dc\u02dc\u02c6\u02dc\u02dc\u02dc\u02dc\u02dc\r\nERROR: /scratch/ecos0030/nayana/tensorflow/tensorflow/contrib/lite/kernels/BUILD:43:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:eig         en_support' failed (Exit 1)\r\nIn file included from external/eigen_archive/Eigen/Core:248:0,\r\n                 from ./third_party/eigen3/Eigen/Core:1,\r\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&) [with Packet = __vector(2         ) double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet2d pround<Packet2d>(const Packet2d& a) { return vec_round(a); }\r\n                                                                                      \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&) [with Packet = __vector(2)          double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet2d pceil<Packet2d>(const  Packet2d& a) { return vec_ceil(a); }\r\n                                                                                      \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&) [with Packet = __vector(2         ) double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet2d pfloor<Packet2d>(const Packet2d& a) { return vec_floor(a); }\r\n                                                                                      \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: note: suggested alternative: '__builtin_s390_vfidb'\r\nIn file included from external/eigen_archive/Eigen/Core:427:0,\r\n                 from ./third_party/eigen3/Eigen/Core:1,\r\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pmadd(const Packet&, const Packet&, const Packe         t&) [with Packet = __vector(4) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1073:141: error: cannot convert 'const Packet4f {aka const __vector(4) float}' to '__         vector(2) double' for argument '1' to '__vector(2) double __builtin_s390_vfmadb(__vector(2) double, __vector(2) double, __vector(2) double)'\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pmadd<Packet4f>  (const Packet4f& a, const Packet4f& b, const Packet4f& c) { return vec_madd(a, b, c); }\r\n                                                                                                                                             \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pxor(const Packet&, const Packet&) [with Packet          = __vector(4) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1078:118: error: invalid parameter combination for intrinsic '__builtin_s390_vec_xor'\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pxor<Packet4f>   (const Packet4f& a, const Packet4f& b) { return vec_xor(a, b); }\r\n                                                                                                                      \u02c6\r\nIn file included from external/eigen_archive/Eigen/Core:248:0,\r\n                 from ./third_party/eigen3/Eigen/Core:1,\r\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&) [with Packet = __vector(4         ) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pround<Packet4f> (const Packet4f& a) { return vec_round(a); }\r\n                                                                                       \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&) [with Packet = __vector(4)          float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pceil<Packet4f>  (const Packet4f& a) { return vec_ceil(a); }\r\n                                                                                       \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&) [with Packet = __vector(4         ) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pfloor<Packet4f> (const Packet4f& a) { return vec_floor(a); }\r\n                                                                                       \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h: In function 'Packet Eigen::internal::pexp(const Packet&) [with Packet = __vector(         2) double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: error: '__builtin_s390_vfi' was not declared in this scope\r\n   fx = vec_floor(fx);\r\n        \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: note: suggested alternative: '__builtin_s390_vfidb'\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n```\r\n\r\n"}