{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8245", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8245/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8245/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8245/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8245", "id": 213111796, "node_id": "MDU6SXNzdWUyMTMxMTE3OTY=", "number": 8245, "title": "Minor but confusing mistake in doc about shape of output tensor of gather_nd", "user": {"login": "kaufManu", "id": 5639197, "node_id": "MDQ6VXNlcjU2MzkxOTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/5639197?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaufManu", "html_url": "https://github.com/kaufManu", "followers_url": "https://api.github.com/users/kaufManu/followers", "following_url": "https://api.github.com/users/kaufManu/following{/other_user}", "gists_url": "https://api.github.com/users/kaufManu/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaufManu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaufManu/subscriptions", "organizations_url": "https://api.github.com/users/kaufManu/orgs", "repos_url": "https://api.github.com/users/kaufManu/repos", "events_url": "https://api.github.com/users/kaufManu/events{/privacy}", "received_events_url": "https://api.github.com/users/kaufManu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "girving", "id": 70511, "node_id": "MDQ6VXNlcjcwNTEx", "avatar_url": "https://avatars1.githubusercontent.com/u/70511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/girving", "html_url": "https://github.com/girving", "followers_url": "https://api.github.com/users/girving/followers", "following_url": "https://api.github.com/users/girving/following{/other_user}", "gists_url": "https://api.github.com/users/girving/gists{/gist_id}", "starred_url": "https://api.github.com/users/girving/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/girving/subscriptions", "organizations_url": "https://api.github.com/users/girving/orgs", "repos_url": "https://api.github.com/users/girving/repos", "events_url": "https://api.github.com/users/girving/events{/privacy}", "received_events_url": "https://api.github.com/users/girving/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "girving", "id": 70511, "node_id": "MDQ6VXNlcjcwNTEx", "avatar_url": "https://avatars1.githubusercontent.com/u/70511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/girving", "html_url": "https://github.com/girving", "followers_url": "https://api.github.com/users/girving/followers", "following_url": "https://api.github.com/users/girving/following{/other_user}", "gists_url": "https://api.github.com/users/girving/gists{/gist_id}", "starred_url": "https://api.github.com/users/girving/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/girving/subscriptions", "organizations_url": "https://api.github.com/users/girving/orgs", "repos_url": "https://api.github.com/users/girving/repos", "events_url": "https://api.github.com/users/girving/events{/privacy}", "received_events_url": "https://api.github.com/users/girving/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-03-09T17:38:03Z", "updated_at": "2017-05-01T16:22:26Z", "closed_at": "2017-05-01T16:22:26Z", "author_association": "NONE", "body_html": "<p>According to the docs of <a href=\"https://www.tensorflow.org/api_docs/python/tf/gather_nd\" rel=\"nofollow\"><code>gather_nd(params, indices)</code></a>, the output tensor produced by the function has shape</p>\n<pre><code>[d_0, ..., d_{Q-2}, params.shape[K], ..., params.shape[P-1]].\n</code></pre>\n<p>where <code>[d_0, ..., d_{Q-2}</code> are the dimensions of <code>indices</code> without the last one, <code>P</code> is the rank of params and <code>K</code> is the length of the innermost dimension of <code>indices</code>. Firstly, I believe it should say <code>params.shape[K-1]</code> instead of <code>params.shape[K]</code>. But even then, I think that this formula is only true if <code>K &lt; P</code>, i.e. for slices. For access to elements, consider the following example:</p>\n<pre><code># data is shape [2, 3, 2]\ndata = np.reshape(np.arange(12), [2, 3, 2])\nx = tf.constant(data)\n# indices is shape [2, 3]\nindices = np.array([[0, 0, 0], [1, 2, 1]])\n# result is shape [2, ]\nresult = tf.gather_nd(x, indices)\n</code></pre>\n<p>According to the above formula, the output tensor should have shape <code>[2, 2]</code>, which it does not. I guess the correct formula for element access should be</p>\n<pre><code>[d_0, ..., d_{Q-2}]\n</code></pre>\n<p>This might already be implicitly assumed with the above formula, but if so, it is not very clear. I realise that this is a super minor thing and one can easily find out the behaviour by doing some tests. However I still wanted to raise it, as I found it a bit tricky to get the hang of <code>gather_nd</code> in the first place and these subtle differences confused me even more.</p>", "body_text": "According to the docs of gather_nd(params, indices), the output tensor produced by the function has shape\n[d_0, ..., d_{Q-2}, params.shape[K], ..., params.shape[P-1]].\n\nwhere [d_0, ..., d_{Q-2} are the dimensions of indices without the last one, P is the rank of params and K is the length of the innermost dimension of indices. Firstly, I believe it should say params.shape[K-1] instead of params.shape[K]. But even then, I think that this formula is only true if K < P, i.e. for slices. For access to elements, consider the following example:\n# data is shape [2, 3, 2]\ndata = np.reshape(np.arange(12), [2, 3, 2])\nx = tf.constant(data)\n# indices is shape [2, 3]\nindices = np.array([[0, 0, 0], [1, 2, 1]])\n# result is shape [2, ]\nresult = tf.gather_nd(x, indices)\n\nAccording to the above formula, the output tensor should have shape [2, 2], which it does not. I guess the correct formula for element access should be\n[d_0, ..., d_{Q-2}]\n\nThis might already be implicitly assumed with the above formula, but if so, it is not very clear. I realise that this is a super minor thing and one can easily find out the behaviour by doing some tests. However I still wanted to raise it, as I found it a bit tricky to get the hang of gather_nd in the first place and these subtle differences confused me even more.", "body": "According to the docs of [`gather_nd(params, indices)`](https://www.tensorflow.org/api_docs/python/tf/gather_nd), the output tensor produced by the function has shape\r\n\r\n```\r\n[d_0, ..., d_{Q-2}, params.shape[K], ..., params.shape[P-1]].\r\n```\r\n\r\nwhere `[d_0, ..., d_{Q-2}` are the dimensions of `indices` without the last one, `P` is the rank of params and `K` is the length of the innermost dimension of `indices`. Firstly, I believe it should say `params.shape[K-1]` instead of `params.shape[K]`. But even then, I think that this formula is only true if `K < P`, i.e. for slices. For access to elements, consider the following example:\r\n\r\n```\r\n# data is shape [2, 3, 2]\r\ndata = np.reshape(np.arange(12), [2, 3, 2])\r\nx = tf.constant(data)\r\n# indices is shape [2, 3]\r\nindices = np.array([[0, 0, 0], [1, 2, 1]])\r\n# result is shape [2, ]\r\nresult = tf.gather_nd(x, indices)\r\n```\r\nAccording to the above formula, the output tensor should have shape `[2, 2]`, which it does not. I guess the correct formula for element access should be\r\n\r\n```\r\n[d_0, ..., d_{Q-2}]\r\n```\r\nThis might already be implicitly assumed with the above formula, but if so, it is not very clear. I realise that this is a super minor thing and one can easily find out the behaviour by doing some tests. However I still wanted to raise it, as I found it a bit tricky to get the hang of `gather_nd` in the first place and these subtle differences confused me even more.\r\n\r\n\r\n"}