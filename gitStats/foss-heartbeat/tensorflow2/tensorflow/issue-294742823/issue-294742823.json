{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16800", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16800/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16800/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16800/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16800", "id": 294742823, "node_id": "MDU6SXNzdWUyOTQ3NDI4MjM=", "number": 16800, "title": "How to compile and use Opencv in tensorflow c++?", "user": {"login": "hxw111", "id": 27355147, "node_id": "MDQ6VXNlcjI3MzU1MTQ3", "avatar_url": "https://avatars2.githubusercontent.com/u/27355147?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hxw111", "html_url": "https://github.com/hxw111", "followers_url": "https://api.github.com/users/hxw111/followers", "following_url": "https://api.github.com/users/hxw111/following{/other_user}", "gists_url": "https://api.github.com/users/hxw111/gists{/gist_id}", "starred_url": "https://api.github.com/users/hxw111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hxw111/subscriptions", "organizations_url": "https://api.github.com/users/hxw111/orgs", "repos_url": "https://api.github.com/users/hxw111/repos", "events_url": "https://api.github.com/users/hxw111/events{/privacy}", "received_events_url": "https://api.github.com/users/hxw111/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-06T12:33:00Z", "updated_at": "2018-10-20T15:08:57Z", "closed_at": "2018-02-06T17:00:33Z", "author_association": "NONE", "body_html": "<p>I want to implement a model inference in tensorflow c++ and have saved the model as .pb file. But I can't use opencv to process the image. I wonder how can I add the opencv lib to the bazel project? Are there any tricks to solve the problem? Thanks!</p>\n<p>This is the code of the bazel BUILD file:</p>\n<pre><code>package(\n    default_visibility = [\"//tensorflow:internal\"],\n)\n\nlicenses([\"notice\"])  # Apache 2.0\n\nexports_files([\"LICENSE\"])\n\nload(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\")\n\ntf_cc_binary(\n    name = \"mask_rcnn\",\n    srcs = [\n        \"main.cc\",\n    ],\n    #prefix = \"flower\",\n    linkopts = select({\n        \"//tensorflow:android\": [\n            \"-pie\",\n            \"-landroid\",\n            \"-ljnigraphics\",\n            \"-llog\",\n            \"-lm\",\n            \"-z defs\",\n            \"-s\",\n            \"-Wl,--exclude-libs,ALL\",\n        ],\n        \"//conditions:default\": [\"-lm\"],\n    }),\n    deps = select({\n        \"//tensorflow:android\": [\n            # cc:cc_ops is used to include image ops (for label_image)\n            # Jpg, gif, and png related code won't be included\n            \"//tensorflow/cc:cc_ops\",\n            \"//tensorflow/core:android_tensorflow_lib\",\n            # cc:android_tensorflow_image_op is for including jpeg/gif/png\n            # decoder to enable real-image evaluation on Android\n            \"//tensorflow/core/kernels:android_tensorflow_image_op\",\n        ],\n        \"//conditions:default\": [\n            \"//tensorflow/cc:cc_ops\",\n            \"//tensorflow/core:core_cpu\",\n            \"//tensorflow/core:framework\",\n            \"//tensorflow/core:framework_internal\",\n            \"//tensorflow/core:lib\",\n            \"//tensorflow/core:protos_all_cc\",\n            \"//tensorflow/core:tensorflow\",\n        ],\n    }),\n)\n\nfilegroup(\n    name = \"all_files\",\n    srcs = glob(\n        [\"**/*\"],\n        exclude = [\n            \"**/METADATA\",\n            \"**/OWNERS\",\n            \"bin/**\",\n            \"gen/**\",\n        ],\n    ),\n    visibility = [\"//tensorflow:__subpackages__\"],\n)\n</code></pre>", "body_text": "I want to implement a model inference in tensorflow c++ and have saved the model as .pb file. But I can't use opencv to process the image. I wonder how can I add the opencv lib to the bazel project? Are there any tricks to solve the problem? Thanks!\nThis is the code of the bazel BUILD file:\npackage(\n    default_visibility = [\"//tensorflow:internal\"],\n)\n\nlicenses([\"notice\"])  # Apache 2.0\n\nexports_files([\"LICENSE\"])\n\nload(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\")\n\ntf_cc_binary(\n    name = \"mask_rcnn\",\n    srcs = [\n        \"main.cc\",\n    ],\n    #prefix = \"flower\",\n    linkopts = select({\n        \"//tensorflow:android\": [\n            \"-pie\",\n            \"-landroid\",\n            \"-ljnigraphics\",\n            \"-llog\",\n            \"-lm\",\n            \"-z defs\",\n            \"-s\",\n            \"-Wl,--exclude-libs,ALL\",\n        ],\n        \"//conditions:default\": [\"-lm\"],\n    }),\n    deps = select({\n        \"//tensorflow:android\": [\n            # cc:cc_ops is used to include image ops (for label_image)\n            # Jpg, gif, and png related code won't be included\n            \"//tensorflow/cc:cc_ops\",\n            \"//tensorflow/core:android_tensorflow_lib\",\n            # cc:android_tensorflow_image_op is for including jpeg/gif/png\n            # decoder to enable real-image evaluation on Android\n            \"//tensorflow/core/kernels:android_tensorflow_image_op\",\n        ],\n        \"//conditions:default\": [\n            \"//tensorflow/cc:cc_ops\",\n            \"//tensorflow/core:core_cpu\",\n            \"//tensorflow/core:framework\",\n            \"//tensorflow/core:framework_internal\",\n            \"//tensorflow/core:lib\",\n            \"//tensorflow/core:protos_all_cc\",\n            \"//tensorflow/core:tensorflow\",\n        ],\n    }),\n)\n\nfilegroup(\n    name = \"all_files\",\n    srcs = glob(\n        [\"**/*\"],\n        exclude = [\n            \"**/METADATA\",\n            \"**/OWNERS\",\n            \"bin/**\",\n            \"gen/**\",\n        ],\n    ),\n    visibility = [\"//tensorflow:__subpackages__\"],\n)", "body": "I want to implement a model inference in tensorflow c++ and have saved the model as .pb file. But I can't use opencv to process the image. I wonder how can I add the opencv lib to the bazel project? Are there any tricks to solve the problem? Thanks!\r\n\r\nThis is the code of the bazel BUILD file:\r\n\r\n    package(\r\n        default_visibility = [\"//tensorflow:internal\"],\r\n    )\r\n\r\n    licenses([\"notice\"])  # Apache 2.0\r\n\r\n    exports_files([\"LICENSE\"])\r\n\r\n    load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\")\r\n\r\n    tf_cc_binary(\r\n        name = \"mask_rcnn\",\r\n        srcs = [\r\n            \"main.cc\",\r\n        ],\r\n        #prefix = \"flower\",\r\n        linkopts = select({\r\n            \"//tensorflow:android\": [\r\n                \"-pie\",\r\n                \"-landroid\",\r\n                \"-ljnigraphics\",\r\n                \"-llog\",\r\n                \"-lm\",\r\n                \"-z defs\",\r\n                \"-s\",\r\n                \"-Wl,--exclude-libs,ALL\",\r\n            ],\r\n            \"//conditions:default\": [\"-lm\"],\r\n        }),\r\n        deps = select({\r\n            \"//tensorflow:android\": [\r\n                # cc:cc_ops is used to include image ops (for label_image)\r\n                # Jpg, gif, and png related code won't be included\r\n                \"//tensorflow/cc:cc_ops\",\r\n                \"//tensorflow/core:android_tensorflow_lib\",\r\n                # cc:android_tensorflow_image_op is for including jpeg/gif/png\r\n                # decoder to enable real-image evaluation on Android\r\n                \"//tensorflow/core/kernels:android_tensorflow_image_op\",\r\n            ],\r\n            \"//conditions:default\": [\r\n                \"//tensorflow/cc:cc_ops\",\r\n                \"//tensorflow/core:core_cpu\",\r\n                \"//tensorflow/core:framework\",\r\n                \"//tensorflow/core:framework_internal\",\r\n                \"//tensorflow/core:lib\",\r\n                \"//tensorflow/core:protos_all_cc\",\r\n                \"//tensorflow/core:tensorflow\",\r\n            ],\r\n        }),\r\n    )\r\n\r\n    filegroup(\r\n        name = \"all_files\",\r\n        srcs = glob(\r\n            [\"**/*\"],\r\n            exclude = [\r\n                \"**/METADATA\",\r\n                \"**/OWNERS\",\r\n                \"bin/**\",\r\n                \"gen/**\",\r\n            ],\r\n        ),\r\n        visibility = [\"//tensorflow:__subpackages__\"],\r\n    )\r\n\r\n\r\n"}