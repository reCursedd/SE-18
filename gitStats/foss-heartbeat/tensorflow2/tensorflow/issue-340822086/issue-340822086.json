{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20755", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20755/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20755/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20755/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/20755", "id": 340822086, "node_id": "MDExOlB1bGxSZXF1ZXN0MjAxMTQ0MjM0", "number": 20755, "title": "Let segmenter able to detect invalid input/output segment nodes beforehand.", "user": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-07-12T22:37:11Z", "updated_at": "2018-07-23T22:09:11Z", "closed_at": "2018-07-23T21:59:48Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/20755", "html_url": "https://github.com/tensorflow/tensorflow/pull/20755", "diff_url": "https://github.com/tensorflow/tensorflow/pull/20755.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/20755.patch"}, "body_html": "<p>Changes include:</p>\n<ol>\n<li>Added two candidate selector parameters to SegmentGraph, so it can use them to detect input/output edges that are not suitable for conversion and remove corresponding input/output nodes beforehand, instead of delaying the detection to conversion time by when the whole conversion will fail. The detail removal algorithm is documented as comments in the code. We have multiple internal use case for this, and all conversion fails without this removal logic.</li>\n<li>Implemented the selector in convert_nodes.cc as InputEdgeValidator and OutputEdgeValidator. I encapsulate related logic into helper methods like GetInputProperties/GetOutputProperties/ValidateInputProperties and reuse them in both the selector and the conversion code, and also fix a bug in the GetOutputProperties() logic where it used <code>graph-&gt;FindNodeId(connection.inside_id)-&gt;output_type(connection.outside_port);</code> previously.</li>\n<li>Simplify segment_test.cc and add tests for the selector.</li>\n</ol>\n<p>Please let me know if you have any questions.<br>\nAlso +<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3979096\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/benbarsdell\">@benbarsdell</a> for the segmenter changes (since I'm not able to add you as reviewer..).</p>", "body_text": "Changes include:\n\nAdded two candidate selector parameters to SegmentGraph, so it can use them to detect input/output edges that are not suitable for conversion and remove corresponding input/output nodes beforehand, instead of delaying the detection to conversion time by when the whole conversion will fail. The detail removal algorithm is documented as comments in the code. We have multiple internal use case for this, and all conversion fails without this removal logic.\nImplemented the selector in convert_nodes.cc as InputEdgeValidator and OutputEdgeValidator. I encapsulate related logic into helper methods like GetInputProperties/GetOutputProperties/ValidateInputProperties and reuse them in both the selector and the conversion code, and also fix a bug in the GetOutputProperties() logic where it used graph->FindNodeId(connection.inside_id)->output_type(connection.outside_port); previously.\nSimplify segment_test.cc and add tests for the selector.\n\nPlease let me know if you have any questions.\nAlso +@benbarsdell for the segmenter changes (since I'm not able to add you as reviewer..).", "body": "Changes include:\r\n\r\n1. Added two candidate selector parameters to SegmentGraph, so it can use them to detect input/output edges that are not suitable for conversion and remove corresponding input/output nodes beforehand, instead of delaying the detection to conversion time by when the whole conversion will fail. The detail removal algorithm is documented as comments in the code. We have multiple internal use case for this, and all conversion fails without this removal logic.\r\n2. Implemented the selector in convert_nodes.cc as InputEdgeValidator and OutputEdgeValidator. I encapsulate related logic into helper methods like GetInputProperties/GetOutputProperties/ValidateInputProperties and reuse them in both the selector and the conversion code, and also fix a bug in the GetOutputProperties() logic where it used `graph->FindNodeId(connection.inside_id)->output_type(connection.outside_port);` previously.\r\n3. Simplify segment_test.cc and add tests for the selector.\r\n\r\nPlease let me know if you have any questions.\r\nAlso +@benbarsdell for the segmenter changes (since I'm not able to add you as reviewer..)."}