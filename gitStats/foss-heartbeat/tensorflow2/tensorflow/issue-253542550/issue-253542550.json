{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12674", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12674/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12674/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12674/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12674", "id": 253542550, "node_id": "MDU6SXNzdWUyNTM1NDI1NTA=", "number": 12674, "title": "Same code, runs fine in one machine, ValueError in another. ", "user": {"login": "dhernandd", "id": 26725321, "node_id": "MDQ6VXNlcjI2NzI1MzIx", "avatar_url": "https://avatars1.githubusercontent.com/u/26725321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhernandd", "html_url": "https://github.com/dhernandd", "followers_url": "https://api.github.com/users/dhernandd/followers", "following_url": "https://api.github.com/users/dhernandd/following{/other_user}", "gists_url": "https://api.github.com/users/dhernandd/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhernandd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhernandd/subscriptions", "organizations_url": "https://api.github.com/users/dhernandd/orgs", "repos_url": "https://api.github.com/users/dhernandd/repos", "events_url": "https://api.github.com/users/dhernandd/events{/privacy}", "received_events_url": "https://api.github.com/users/dhernandd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "panyx0718", "id": 2887803, "node_id": "MDQ6VXNlcjI4ODc4MDM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2887803?v=4", "gravatar_id": "", "url": "https://api.github.com/users/panyx0718", "html_url": "https://github.com/panyx0718", "followers_url": "https://api.github.com/users/panyx0718/followers", "following_url": "https://api.github.com/users/panyx0718/following{/other_user}", "gists_url": "https://api.github.com/users/panyx0718/gists{/gist_id}", "starred_url": "https://api.github.com/users/panyx0718/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/panyx0718/subscriptions", "organizations_url": "https://api.github.com/users/panyx0718/orgs", "repos_url": "https://api.github.com/users/panyx0718/repos", "events_url": "https://api.github.com/users/panyx0718/events{/privacy}", "received_events_url": "https://api.github.com/users/panyx0718/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "panyx0718", "id": 2887803, "node_id": "MDQ6VXNlcjI4ODc4MDM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2887803?v=4", "gravatar_id": "", "url": "https://api.github.com/users/panyx0718", "html_url": "https://github.com/panyx0718", "followers_url": "https://api.github.com/users/panyx0718/followers", "following_url": "https://api.github.com/users/panyx0718/following{/other_user}", "gists_url": "https://api.github.com/users/panyx0718/gists{/gist_id}", "starred_url": "https://api.github.com/users/panyx0718/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/panyx0718/subscriptions", "organizations_url": "https://api.github.com/users/panyx0718/orgs", "repos_url": "https://api.github.com/users/panyx0718/repos", "events_url": "https://api.github.com/users/panyx0718/events{/privacy}", "received_events_url": "https://api.github.com/users/panyx0718/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2017-08-29T06:31:28Z", "updated_at": "2017-09-05T20:05:57Z", "closed_at": "2017-09-05T20:05:57Z", "author_association": "NONE", "body_html": "<p>I am running a modified version of the LFADS code available at</p>\n<p><a href=\"https://github.com/tensorflow/models/tree/master/lfads\">https://github.com/tensorflow/models/tree/master/lfads</a></p>\n<p>I run the exact same code in two machines, in one it works fine, in another it throws a ValueError. Here are the two tf_env.txt</p>\n<h2>MY MACHINE (CODE WORKS)</h2>\n<p>== cat /etc/issue ===============================================<br>\nDarwin Daniels-MacBook-Pro-2.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64<br>\nMac OS X 10.12.6</p>\n<p>== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nApple LLVM version 8.1.0 (clang-802.0.42)<br>\nTarget: x86_64-apple-darwin16.7.0<br>\nThread model: posix<br>\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</p>\n<p>== uname -a =====================================================<br>\nDarwin Daniels-MacBook-Pro-2.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64</p>\n<p>== check pips ===================================================<br>\nnumpy (1.13.1)<br>\nprotobuf (3.4.0)<br>\ntensorflow (1.3.0)<br>\ntensorflow-gpu (1.1.0)<br>\ntensorflow-tensorboard (0.1.2)</p>\n<p>== check for virtualenv =========================================<br>\nFalse</p>\n<p>== tensorflow import ============================================<br>\ntf.VERSION = 1.1.0<br>\ntf.GIT_VERSION = unknown<br>\ntf.COMPILER_VERSION = unknown<br>\nSanity check: array([1], dtype=int32)</p>\n<p>== env ==========================================================<br>\nLD_LIBRARY_PATH is unset<br>\nDYLD_LIBRARY_PATH is unset</p>\n<p>== nvidia-smi ===================================================<br>\n./collect.sh: line 105: nvidia-smi: command not found</p>\n<p>== cuda libs  ===================================================</p>\n<h2>THE CLUSTER MACHINE (THROWS THE VALUE ERROR)</h2>\n<p>== cat /etc/issue ===============================================<br>\nLinux holmes 3.10.0-327.el7.x86_64 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP Thu Oct 29 17:29:29 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux<br>\nVERSION=\"7.3 (Maipo)\"<br>\nVERSION_ID=\"7.3\"<br>\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.3<br>\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.3\"</p>\n<p>== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nc++ (GCC) 6.1.0<br>\nCopyright (C) 2016 Free Software Foundation, Inc.<br>\nThis is free software; see the source for copying conditions.  There is NO<br>\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n<p>== uname -a =====================================================<br>\nLinux holmes 3.10.0-327.el7.x86_64 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP Thu Oct 29 17:29:29 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux</p>\n<p>== check pips ===================================================<br>\nnumpy (1.13.1)<br>\nnumpydoc (0.6.0)<br>\nprotobuf (3.4.0)<br>\ntensorflow (1.3.0)<br>\ntensorflow-tensorboard (0.1.5)</p>\n<p>== check for virtualenv =========================================<br>\nFalse</p>\n<p>== tensorflow import ============================================<br>\ntf.VERSION = 1.3.0<br>\ntf.GIT_VERSION = v1.3.0-rc2-20-g0787eee<br>\ntf.COMPILER_VERSION = v1.3.0-rc2-20-g0787eee<br>\nSanity check: array([1], dtype=int32)</p>\n<p>== env ==========================================================<br>\nLD_LIBRARY_PATH /cm/shared/apps/slurm/16.05.8/lib64/slurm:/cm/shared/apps/slurm/16.05.8/lib64:/cm/local/apps/gcc/6.1.0/lib:/cm/local/apps/gcc/6.1.0/lib64<br>\nDYLD_LIBRARY_PATH is unset</p>\n<p>== nvidia-smi ===================================================<br>\n./collect.sh: line 105: nvidia-smi: command not found</p>\n<h3>SOURCE CODE/ LOGS</h3>\n<p>Here is the log for the error:</p>\n<p>Traceback (most recent call last):<br>\n.....<br>\nFile \"./lfads.py\", line 1014, in _optimization<br>\ngrads = tf.gradients(self.cost, tvars)<br>\nFile \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 562, in gradients<br>\nin_grad.set_shape(t_in.get_shape())<br>\nFile \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 378, in set_shape<br>\nself._shape = self._shape.merge_with(shape)<br>\nFile \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/tensor_shape.py\", line 566, in merge_with<br>\nraise ValueError(\"Shapes %s and %s are not compatible\" % (self, other))<br>\nValueError: Shapes (50, ?) and (1,) are not compatible</p>\n<p>I have diffed the files involved, to double check that they are the same. Can someone point me to what can possibly be happening?</p>", "body_text": "I am running a modified version of the LFADS code available at\nhttps://github.com/tensorflow/models/tree/master/lfads\nI run the exact same code in two machines, in one it works fine, in another it throws a ValueError. Here are the two tf_env.txt\nMY MACHINE (CODE WORKS)\n== cat /etc/issue ===============================================\nDarwin Daniels-MacBook-Pro-2.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64\nMac OS X 10.12.6\n== are we in docker =============================================\nNo\n== compiler =====================================================\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.7.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n== uname -a =====================================================\nDarwin Daniels-MacBook-Pro-2.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64\n== check pips ===================================================\nnumpy (1.13.1)\nprotobuf (3.4.0)\ntensorflow (1.3.0)\ntensorflow-gpu (1.1.0)\ntensorflow-tensorboard (0.1.2)\n== check for virtualenv =========================================\nFalse\n== tensorflow import ============================================\ntf.VERSION = 1.1.0\ntf.GIT_VERSION = unknown\ntf.COMPILER_VERSION = unknown\nSanity check: array([1], dtype=int32)\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n== nvidia-smi ===================================================\n./collect.sh: line 105: nvidia-smi: command not found\n== cuda libs  ===================================================\nTHE CLUSTER MACHINE (THROWS THE VALUE ERROR)\n== cat /etc/issue ===============================================\nLinux holmes 3.10.0-327.el7.x86_64 #1 SMP Thu Oct 29 17:29:29 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"7.3 (Maipo)\"\nVERSION_ID=\"7.3\"\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.3\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.3\"\n== are we in docker =============================================\nNo\n== compiler =====================================================\nc++ (GCC) 6.1.0\nCopyright (C) 2016 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n== uname -a =====================================================\nLinux holmes 3.10.0-327.el7.x86_64 #1 SMP Thu Oct 29 17:29:29 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux\n== check pips ===================================================\nnumpy (1.13.1)\nnumpydoc (0.6.0)\nprotobuf (3.4.0)\ntensorflow (1.3.0)\ntensorflow-tensorboard (0.1.5)\n== check for virtualenv =========================================\nFalse\n== tensorflow import ============================================\ntf.VERSION = 1.3.0\ntf.GIT_VERSION = v1.3.0-rc2-20-g0787eee\ntf.COMPILER_VERSION = v1.3.0-rc2-20-g0787eee\nSanity check: array([1], dtype=int32)\n== env ==========================================================\nLD_LIBRARY_PATH /cm/shared/apps/slurm/16.05.8/lib64/slurm:/cm/shared/apps/slurm/16.05.8/lib64:/cm/local/apps/gcc/6.1.0/lib:/cm/local/apps/gcc/6.1.0/lib64\nDYLD_LIBRARY_PATH is unset\n== nvidia-smi ===================================================\n./collect.sh: line 105: nvidia-smi: command not found\nSOURCE CODE/ LOGS\nHere is the log for the error:\nTraceback (most recent call last):\n.....\nFile \"./lfads.py\", line 1014, in _optimization\ngrads = tf.gradients(self.cost, tvars)\nFile \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 562, in gradients\nin_grad.set_shape(t_in.get_shape())\nFile \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 378, in set_shape\nself._shape = self._shape.merge_with(shape)\nFile \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/tensor_shape.py\", line 566, in merge_with\nraise ValueError(\"Shapes %s and %s are not compatible\" % (self, other))\nValueError: Shapes (50, ?) and (1,) are not compatible\nI have diffed the files involved, to double check that they are the same. Can someone point me to what can possibly be happening?", "body": "I am running a modified version of the LFADS code available at\r\n\r\nhttps://github.com/tensorflow/models/tree/master/lfads\r\n\r\nI run the exact same code in two machines, in one it works fine, in another it throws a ValueError. Here are the two tf_env.txt\r\n\r\n## MY MACHINE (CODE WORKS)\r\n== cat /etc/issue ===============================================\r\nDarwin Daniels-MacBook-Pro-2.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64\r\nMac OS X 10.12.6\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nApple LLVM version 8.1.0 (clang-802.0.42)\r\nTarget: x86_64-apple-darwin16.7.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n\r\n== uname -a =====================================================\r\nDarwin Daniels-MacBook-Pro-2.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.1)\r\nprotobuf (3.4.0)\r\ntensorflow (1.3.0)\r\ntensorflow-gpu (1.1.0)\r\ntensorflow-tensorboard (0.1.2)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.1.0\r\ntf.GIT_VERSION = unknown\r\ntf.COMPILER_VERSION = unknown\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n./collect.sh: line 105: nvidia-smi: command not found\r\n\r\n== cuda libs  ===================================================\r\n\r\n## THE CLUSTER MACHINE (THROWS THE VALUE ERROR)\r\n== cat /etc/issue ===============================================\r\nLinux holmes 3.10.0-327.el7.x86_64 #1 SMP Thu Oct 29 17:29:29 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"7.3 (Maipo)\"\r\nVERSION_ID=\"7.3\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.3\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.3\"\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 6.1.0\r\nCopyright (C) 2016 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux holmes 3.10.0-327.el7.x86_64 #1 SMP Thu Oct 29 17:29:29 EDT 2015 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.1)\r\nnumpydoc (0.6.0)\r\nprotobuf (3.4.0)\r\ntensorflow (1.3.0)\r\ntensorflow-tensorboard (0.1.5)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.3.0\r\ntf.GIT_VERSION = v1.3.0-rc2-20-g0787eee\r\ntf.COMPILER_VERSION = v1.3.0-rc2-20-g0787eee\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /cm/shared/apps/slurm/16.05.8/lib64/slurm:/cm/shared/apps/slurm/16.05.8/lib64:/cm/local/apps/gcc/6.1.0/lib:/cm/local/apps/gcc/6.1.0/lib64\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n./collect.sh: line 105: nvidia-smi: command not found\r\n\r\n\r\n### SOURCE CODE/ LOGS\r\n\r\nHere is the log for the error:\r\n\r\nTraceback (most recent call last):\r\n.....\r\n  File \"./lfads.py\", line 1014, in _optimization\r\n    grads = tf.gradients(self.cost, tvars)\r\n  File \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 562, in gradients\r\n    in_grad.set_shape(t_in.get_shape())\r\n  File \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 378, in set_shape\r\n    self._shape = self._shape.merge_with(shape)\r\n  File \"/home/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/tensor_shape.py\", line 566, in merge_with\r\n    raise ValueError(\"Shapes %s and %s are not compatible\" % (self, other))\r\nValueError: Shapes (50, ?) and (1,) are not compatible\r\n\r\n\r\nI have diffed the files involved, to double check that they are the same. Can someone point me to what can possibly be happening?\r\n"}