{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21897", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21897/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21897/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21897/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21897", "id": 354315849, "node_id": "MDU6SXNzdWUzNTQzMTU4NDk=", "number": 21897, "title": "DistributionStrategy multi-node multi-GPU Estimator training: \"cannot assign a device for operation\"", "user": {"login": "jppgks", "id": 11156808, "node_id": "MDQ6VXNlcjExMTU2ODA4", "avatar_url": "https://avatars3.githubusercontent.com/u/11156808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jppgks", "html_url": "https://github.com/jppgks", "followers_url": "https://api.github.com/users/jppgks/followers", "following_url": "https://api.github.com/users/jppgks/following{/other_user}", "gists_url": "https://api.github.com/users/jppgks/gists{/gist_id}", "starred_url": "https://api.github.com/users/jppgks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jppgks/subscriptions", "organizations_url": "https://api.github.com/users/jppgks/orgs", "repos_url": "https://api.github.com/users/jppgks/repos", "events_url": "https://api.github.com/users/jppgks/events{/privacy}", "received_events_url": "https://api.github.com/users/jppgks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-08-27T13:20:08Z", "updated_at": "2018-10-19T22:24:19Z", "closed_at": "2018-10-19T22:24:19Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: <code>Yes</code></li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: <code>Linux Ubuntu 16.04</code></li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>: <code>NA</code></li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: <code>source</code></li>\n<li><strong>TensorFlow version (use command below)</strong>:  <code>1.10</code> (<code>master</code> @ <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/187ed273038ccde054fa27bf19582b0cd8e5cb57/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/187ed273038ccde054fa27bf19582b0cd8e5cb57\"><tt>187ed27</tt></a>)</li>\n<li><strong>Python version</strong>: <code>2.7</code></li>\n<li><strong>Bazel version (if compiling from source)</strong>: <code>0.16.1</code></li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: <code>4.8.5</code></li>\n<li><strong>CUDA/cuDNN version</strong>: <code>9.1.85</code>/<code>7.1.4</code></li>\n<li><strong>GPU model and memory</strong>: <code>4x NVIDIA P100</code>,  <code>16GB</code> per node</li>\n<li><strong>Exact command to reproduce</strong>: See below</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I'm trying to use a DistributionStrategy (e.g. MirroredStrategy) to train an Estimator in a multi-node, multi-GPU cluster. However, when I start two <code>tf.train.Server</code> tasks (each on a different node) and try to have the <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/distribute/python/examples/simple_estimator_example.py\">simple Estimator example from the  <code>tf.contrib.distribute</code> source</a> run across these two workers (<a href=\"https://github.com/jppgks/tensorflow-distribution-strategy/blob/master/multi-node/workers/simple_estimator_example.py\">here's my modified example</a>), I get the error below saying a device can't be assigned.</p>\n<p>I'm suspecting that maybe my cluster setup isn't entirely correct. In that case, I would like to see how the documentation can be updated to include better instructions to run (multi-node) DistributionStrategy. I'm happy to help out with that.</p>\n<p><em>pinging <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=14104855\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/guptapriya\">@guptapriya</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1647833\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yuefengz\">@yuefengz</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=32556631\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/anj-s\">@anj-s</a></em></p>\n<h3>Source code / logs</h3>\n<p><strong>Source.</strong><br>\nAvailable on GitHub <a href=\"https://github.com/jppgks/tensorflow-distribution-strategy/tree/master/multi-node/workers\">here</a>.</p>\n<p><strong>Command.</strong><br>\nOur cluster uses PBS/Torque as job manager, hence the <code>qsub</code>, but the contents of the file are standard bash.</p>\n<div class=\"highlight highlight-source-shell\"><pre>qsub launch_tf_workers.sh</pre></div>\n<p><strong>Job output.</strong></p>\n<div class=\"highlight highlight-text-python-traceback\"><pre><span class=\"pl-en\">CLUSTER_SPEC</span>: <span class=\"pl-s\">{\"worker\": [\"r22g35:2222\", \"r22g36:2222\"]}</span>\n2018-08-27 10:18:18.155846: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\n2018-08-27 10:18:22.169890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:61:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:22.788786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:62:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:23.424017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:89:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:24.071758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:8a:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:24.071884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:25.178802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:25.178891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:25.178912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:25.178929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:25.178944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:25.178960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:25.179902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 15123 MB memory) -&gt; physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.315544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 15123 MB memory) -&gt; physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.451748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 15123 MB memory) -&gt; physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.587799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 15123 MB memory) -&gt; physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.725327: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:222] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; localhost:2222, 1 -&gt; r22g36:2222}\n2018-08-27 10:18:25.725775: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:381] Started server with target: grpc://localhost:2222\n2018-08-27 10:18:30.874254: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\n2018-08-27 10:18:34.716434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:61:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:35.336941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:62:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:35.969664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:89:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:36.617192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:8a:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:36.617325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:37.725846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:37.725937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:37.725958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:37.725974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:37.725990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:37.726006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:37.726951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:0 with 15123 MB memory) -&gt; physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:37.863759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:1 with 15123 MB memory) -&gt; physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:37.999537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:2 with 15123 MB memory) -&gt; physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:38.135424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:3 with 15123 MB memory) -&gt; physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\n2018-08-27 10:18:38.272553: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:222] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; r22g35:2222, 1 -&gt; localhost:2222}\n2018-08-27 10:18:38.273006: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:381] Started server with target: grpc://localhost:2222\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\n2018-08-27 10:18:46.714305: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\n2018-08-27 10:18:50.653650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:61:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:51.271311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:62:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:51.901031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:89:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:52.566886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \n<span class=\"pl-en\">name</span>: <span class=\"pl-s\">Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805</span>\n<span class=\"pl-en\">pciBusID</span>: <span class=\"pl-s\">0000:8a:00.0</span>\n<span class=\"pl-en\">totalMemory</span>: <span class=\"pl-s\">15.90GiB freeMemory: 15.61GiB</span>\n2018-08-27 10:18:52.567011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:53.672876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:53.672965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:53.672987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:53.673003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:53.673019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:53.673035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:53.673974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15123 MB memory) -&gt; physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:53.809434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15123 MB memory) -&gt; physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:53.946947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 15123 MB memory) -&gt; physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:54.084679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 15123 MB memory) -&gt; physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.049981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:57.050183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:57.050217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:57.050244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:57.050270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:57.050295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:57.050319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:57.050912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15123 MB memory) -&gt; physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.051179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15123 MB memory) -&gt; physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.051476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 15123 MB memory) -&gt; physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.051755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 15123 MB memory) -&gt; physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:1 -&gt; device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:2 -&gt; device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:3 -&gt; device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0\n2018-08-27 10:18:57.052199: I tensorflow/core/common_runtime/direct_session.cc:291] Device mapping:\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:1 -&gt; device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:2 -&gt; device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:3 -&gt; device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0\n\n2018-08-27 10:18:57.066840: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp' because the input edge from 'global_step/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.066913: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_1' because the input edge from 'global_step/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.066945: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_2' because the input edge from 'global_step/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.066975: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_4' because the input edge from 'global_step/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067004: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_5' because the input edge from 'global_step/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067033: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_6' because the input edge from 'global_step/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067066: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_7' because the input edge from 'global_step/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067096: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_8' because the input edge from 'dense/kernel/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067125: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_9' because the input edge from 'dense/kernel/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067153: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_10' because the input edge from 'dense/kernel/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067190: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_12' because the input edge from 'dense/kernel/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067219: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_13' because the input edge from 'dense/kernel/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067248: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_14' because the input edge from 'dense/kernel/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067276: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_15' because the input edge from 'dense/kernel/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067305: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_16' because the input edge from 'dense/bias/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067334: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_17' because the input edge from 'dense/bias/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067362: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_18' because the input edge from 'dense/bias/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067397: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_20' because the input edge from 'dense/bias/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067426: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_21' because the input edge from 'dense/bias/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067454: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_22' because the input edge from 'dense/bias/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067482: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_23' because the input edge from 'dense/bias/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067512: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp' because the input edge from 'global_step/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067541: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_1' because the input edge from 'global_step/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067569: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_2' because the input edge from 'global_step/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067598: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_4' because the input edge from 'global_step/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067626: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_5' because the input edge from 'global_step/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067654: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_6' because the input edge from 'global_step/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067683: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_7' because the input edge from 'global_step/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067714: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_8' because the input edge from 'dense/kernel/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067743: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_9' because the input edge from 'dense/kernel/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067771: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_10' because the input edge from 'dense/kernel/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067800: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_12' because the input edge from 'dense/kernel/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067828: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_13' because the input edge from 'dense/kernel/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067857: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_14' because the input edge from 'dense/kernel/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067885: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_15' because the input edge from 'dense/kernel/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067914: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_16' because the input edge from 'dense/bias/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067942: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_17' because the input edge from 'dense/bias/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067970: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_18' because the input edge from 'dense/bias/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067999: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_20' because the input edge from 'dense/bias/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.068030: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_21' because the input edge from 'dense/bias/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.068059: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_22' because the input edge from 'dense/bias/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.068087: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_23' because the input edge from 'dense/bias/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\nTraceback (most recent call last):\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">128</span>, in <span class=\"pl-en\">&lt;module&gt;</span>\n    tf.app.run()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\"</span>, line <span class=\"pl-c1\">125</span>, in <span class=\"pl-en\">run</span>\n    _sys.exit(main(argv))\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">113</span>, in <span class=\"pl-en\">main</span>\n    estimator.train(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">354</span>, in <span class=\"pl-en\">train</span>\n    loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._train_model(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1177</span>, in <span class=\"pl-en\">_train_model</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._train_model_distributed(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1320</span>, in <span class=\"pl-en\">_train_model_distributed</span>\n    saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1400</span>, in <span class=\"pl-en\">_train_with_estimator_spec</span>\n    log_step_count_steps<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._config.log_step_count_steps) <span class=\"pl-k\">as</span> mon_sess:\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">504</span>, in <span class=\"pl-en\">MonitoredTrainingSession</span>\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">920</span>, in <span class=\"pl-en\">__init__</span>\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">643</span>, in <span class=\"pl-en\">__init__</span>\n    <span class=\"pl-c1\">self</span>._sess <span class=\"pl-k\">=</span> _RecoverableSession(<span class=\"pl-c1\">self</span>._coordinated_creator)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">1106</span>, in <span class=\"pl-en\">__init__</span>\n    _WrappedSession.<span class=\"pl-c1\">__init__</span>(<span class=\"pl-c1\">self</span>, <span class=\"pl-c1\">self</span>._create_session())\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">1111</span>, in <span class=\"pl-en\">_create_session</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._sess_creator.create_session()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">800</span>, in <span class=\"pl-en\">create_session</span>\n    <span class=\"pl-c1\">self</span>.tf_sess <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._session_creator.create_session()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">566</span>, in <span class=\"pl-en\">create_session</span>\n    init_fn<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._scaffold.init_fn)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\"</span>, line <span class=\"pl-c1\">287</span>, in <span class=\"pl-en\">prepare_session</span>\n    sess.run(init_op, <span class=\"pl-v\">feed_dict</span><span class=\"pl-k\">=</span>init_feed_dict)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">887</span>, in <span class=\"pl-en\">run</span>\n    run_metadata_ptr)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">1110</span>, in <span class=\"pl-en\">_run</span>\n    feed_dict_tensor, options, run_metadata)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">1286</span>, in <span class=\"pl-en\">_do_run</span>\n    run_metadata)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">1308</span>, in <span class=\"pl-en\">_do_call</span>\n    <span class=\"pl-k\">raise</span> <span class=\"pl-c1\">type</span>(e)(node_def, op, message)\n<span class=\"pl-en\">tensorflow.python.framework.errors_impl.InvalidArgumentError</span>: <span class=\"pl-s\">Cannot assign a device for operation 'hooks/steps_per_run/IsInitialized/VarIsInitializedOp': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/job:worker/replica:0/task:0/device:GPU:0'</span>\nColocation Debug Info:\nColocation group had the following types and devices: \n<span class=\"pl-en\">ReadVariableOp</span>: <span class=\"pl-s\">GPU CPU </span>\n<span class=\"pl-en\">AssignVariableOp</span>: <span class=\"pl-s\">CPU </span>\n<span class=\"pl-en\">VarIsInitializedOp</span>: <span class=\"pl-s\">GPU CPU </span>\n<span class=\"pl-en\">VarHandleOp</span>: <span class=\"pl-s\">CPU </span>\n<span class=\"pl-en\">Const</span>: <span class=\"pl-s\">GPU CPU </span>\n\nColocation members and user-requested devices:\n  hooks/steps_per_run/Initializer/ones (Const) \n  hooks/steps_per_run (VarHandleOp) \n  hooks/steps_per_run/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) \n  hooks/steps_per_run/Assign (AssignVariableOp) \n  hooks/steps_per_run/Read/ReadVariableOp (ReadVariableOp) \n  report_uninitialized_variables/VarIsInitializedOp_24 (VarIsInitializedOp) /job:worker/replica:0/task:0/device:GPU:0\n\n\t [[{{node hooks/steps_per_run/IsInitialized/VarIsInitializedOp}} = VarIsInitializedOp[](hooks/steps_per_run)]]\n\nCaused by op u'hooks/steps_per_run/IsInitialized/VarIsInitializedOp', defined at:\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">128</span>, in <span class=\"pl-en\">&lt;module&gt;</span>\n    tf.app.run()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\"</span>, line <span class=\"pl-c1\">125</span>, in <span class=\"pl-en\">run</span>\n    _sys.exit(main(argv))\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">113</span>, in <span class=\"pl-en\">main</span>\n    estimator.train(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">354</span>, in <span class=\"pl-en\">train</span>\n    loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._train_model(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1177</span>, in <span class=\"pl-en\">_train_model</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._train_model_distributed(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1240</span>, in <span class=\"pl-en\">_train_model_distributed</span>\n    steps_per_run_variable <span class=\"pl-k\">=</span> training.get_or_create_steps_per_run_variable()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/basic_session_run_hooks.py\"</span>, line <span class=\"pl-c1\">309</span>, in <span class=\"pl-en\">get_or_create_steps_per_run_variable</span>\n    use_resource<span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\"</span>, line <span class=\"pl-c1\">1484</span>, in <span class=\"pl-en\">get_variable</span>\n    aggregation<span class=\"pl-k\">=</span>aggregation)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\"</span>, line <span class=\"pl-c1\">1234</span>, in <span class=\"pl-en\">get_variable</span>\n    aggregation<span class=\"pl-k\">=</span>aggregation)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\"</span>, line <span class=\"pl-c1\">538</span>, in <span class=\"pl-en\">get_variable</span>\n    aggregation<span class=\"pl-k\">=</span>aggregation)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\"</span>, line <span class=\"pl-c1\">492</span>, in <span class=\"pl-en\">_true_getter</span>\n    aggregation<span class=\"pl-k\">=</span>aggregation)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\"</span>, line <span class=\"pl-c1\">920</span>, in <span class=\"pl-en\">_get_single_variable</span>\n    aggregation<span class=\"pl-k\">=</span>aggregation)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\"</span>, line <span class=\"pl-c1\">131</span>, in <span class=\"pl-en\">__call__</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">cls</span>._variable_call(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\"</span>, line <span class=\"pl-c1\">127</span>, in <span class=\"pl-en\">_variable_call</span>\n    aggregation<span class=\"pl-k\">=</span>aggregation)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\"</span>, line <span class=\"pl-c1\">106</span>, in <span class=\"pl-en\">&lt;lambda&gt;</span>\n    previous_getter <span class=\"pl-k\">=</span> <span class=\"pl-k\">lambda</span> <span class=\"pl-k\">**</span><span class=\"pl-smi\">kwargs</span>: default_variable_creator(<span class=\"pl-c1\">None</span>, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\"</span>, line <span class=\"pl-c1\">2418</span>, in <span class=\"pl-en\">default_variable_creator</span>\n    import_scope<span class=\"pl-k\">=</span>import_scope)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\"</span>, line <span class=\"pl-c1\">133</span>, in <span class=\"pl-en\">__call__</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">super</span>(VariableMetaclass, <span class=\"pl-c1\">cls</span>).<span class=\"pl-c1\">__call__</span>(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/resource_variable_ops.py\"</span>, line <span class=\"pl-c1\">297</span>, in <span class=\"pl-en\">__init__</span>\n    constraint<span class=\"pl-k\">=</span>constraint)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/resource_variable_ops.py\"</span>, line <span class=\"pl-c1\">455</span>, in <span class=\"pl-en\">_init_from_args</span>\n    gen_resource_variable_ops.var_is_initialized_op(<span class=\"pl-c1\">self</span>._handle))\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/gen_resource_variable_ops.py\"</span>, line <span class=\"pl-c1\">1263</span>, in <span class=\"pl-en\">var_is_initialized_op</span>\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>VarIsInitializedOp<span class=\"pl-pds\">\"</span></span>, resource<span class=\"pl-k\">=</span>resource, name<span class=\"pl-k\">=</span>name)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\"</span>, line <span class=\"pl-c1\">787</span>, in <span class=\"pl-en\">_apply_op_helper</span>\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\"</span>, line <span class=\"pl-c1\">488</span>, in <span class=\"pl-en\">new_func</span>\n    <span class=\"pl-k\">return</span> func(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\"</span>, line <span class=\"pl-c1\">3263</span>, in <span class=\"pl-en\">create_op</span>\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\"</span>, line <span class=\"pl-c1\">1751</span>, in <span class=\"pl-en\">__init__</span>\n    <span class=\"pl-c1\">self</span>._traceback <span class=\"pl-k\">=</span> tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'hooks/steps_per_run/IsInitialized/VarIsInitializedOp': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/job:worker/replica:0/task:0/device:GPU:0'\nColocation Debug Info:\nColocation group had the following types and devices: \n<span class=\"pl-en\">ReadVariableOp</span>: <span class=\"pl-s\">GPU CPU </span>\n<span class=\"pl-en\">AssignVariableOp</span>: <span class=\"pl-s\">CPU </span>\n<span class=\"pl-en\">VarIsInitializedOp</span>: <span class=\"pl-s\">GPU CPU </span>\n<span class=\"pl-en\">VarHandleOp</span>: <span class=\"pl-s\">CPU </span>\n<span class=\"pl-en\">Const</span>: <span class=\"pl-s\">GPU CPU </span>\n\nColocation members and user-requested devices:\n  hooks/steps_per_run/Initializer/ones (Const) \n  hooks/steps_per_run (VarHandleOp) \n  hooks/steps_per_run/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) \n  hooks/steps_per_run/Assign (AssignVariableOp) \n  hooks/steps_per_run/Read/ReadVariableOp (ReadVariableOp) \n  report_uninitialized_variables/VarIsInitializedOp_24 (VarIsInitializedOp) /job:worker/replica:0/task:0/device:GPU:0\n\n\t [[{{node hooks/steps_per_run/IsInitialized/VarIsInitializedOp}} = VarIsInitializedOp[](hooks/steps_per_run)]]</pre></div>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below):  1.10 (master @ 187ed27)\nPython version: 2.7\nBazel version (if compiling from source): 0.16.1\nGCC/Compiler version (if compiling from source): 4.8.5\nCUDA/cuDNN version: 9.1.85/7.1.4\nGPU model and memory: 4x NVIDIA P100,  16GB per node\nExact command to reproduce: See below\n\nDescribe the problem\nI'm trying to use a DistributionStrategy (e.g. MirroredStrategy) to train an Estimator in a multi-node, multi-GPU cluster. However, when I start two tf.train.Server tasks (each on a different node) and try to have the simple Estimator example from the  tf.contrib.distribute source run across these two workers (here's my modified example), I get the error below saying a device can't be assigned.\nI'm suspecting that maybe my cluster setup isn't entirely correct. In that case, I would like to see how the documentation can be updated to include better instructions to run (multi-node) DistributionStrategy. I'm happy to help out with that.\npinging @mrry @guptapriya @yuefengz @anj-s\nSource code / logs\nSource.\nAvailable on GitHub here.\nCommand.\nOur cluster uses PBS/Torque as job manager, hence the qsub, but the contents of the file are standard bash.\nqsub launch_tf_workers.sh\nJob output.\nCLUSTER_SPEC: {\"worker\": [\"r22g35:2222\", \"r22g36:2222\"]}\n2018-08-27 10:18:18.155846: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\n2018-08-27 10:18:22.169890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:61:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:22.788786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:62:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:23.424017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:89:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:24.071758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:8a:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:24.071884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:25.178802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:25.178891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:25.178912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:25.178929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:25.178944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:25.178960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:25.179902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.315544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.451748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.587799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\n2018-08-27 10:18:25.725327: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:222] Initialize GrpcChannelCache for job worker -> {0 -> localhost:2222, 1 -> r22g36:2222}\n2018-08-27 10:18:25.725775: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:381] Started server with target: grpc://localhost:2222\n2018-08-27 10:18:30.874254: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\n2018-08-27 10:18:34.716434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:61:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:35.336941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:62:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:35.969664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:89:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:36.617192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:8a:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:36.617325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:37.725846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:37.725937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:37.725958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:37.725974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:37.725990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:37.726006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:37.726951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:37.863759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:37.999537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:38.135424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\n2018-08-27 10:18:38.272553: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:222] Initialize GrpcChannelCache for job worker -> {0 -> r22g35:2222, 1 -> localhost:2222}\n2018-08-27 10:18:38.273006: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:381] Started server with target: grpc://localhost:2222\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\n2018-08-27 10:18:46.714305: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\n2018-08-27 10:18:50.653650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:61:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:51.271311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:62:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:51.901031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:89:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:52.566886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\npciBusID: 0000:8a:00.0\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\n2018-08-27 10:18:52.567011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:53.672876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:53.672965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:53.672987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:53.673003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:53.673019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:53.673035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:53.673974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:53.809434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:53.946947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:54.084679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.049981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-27 10:18:57.050183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-27 10:18:57.050217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \n2018-08-27 10:18:57.050244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \n2018-08-27 10:18:57.050270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \n2018-08-27 10:18:57.050295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \n2018-08-27 10:18:57.050319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \n2018-08-27 10:18:57.050912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.051179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.051476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\n2018-08-27 10:18:57.051755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:1 -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:2 -> device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:3 -> device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0\n2018-08-27 10:18:57.052199: I tensorflow/core/common_runtime/direct_session.cc:291] Device mapping:\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:1 -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:2 -> device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0\n/job:localhost/replica:0/task:0/device:GPU:3 -> device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0\n\n2018-08-27 10:18:57.066840: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp' because the input edge from 'global_step/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.066913: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_1' because the input edge from 'global_step/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.066945: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_2' because the input edge from 'global_step/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.066975: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_4' because the input edge from 'global_step/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067004: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_5' because the input edge from 'global_step/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067033: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_6' because the input edge from 'global_step/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067066: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_7' because the input edge from 'global_step/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067096: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_8' because the input edge from 'dense/kernel/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067125: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_9' because the input edge from 'dense/kernel/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067153: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_10' because the input edge from 'dense/kernel/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067190: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_12' because the input edge from 'dense/kernel/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067219: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_13' because the input edge from 'dense/kernel/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067248: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_14' because the input edge from 'dense/kernel/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067276: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_15' because the input edge from 'dense/kernel/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067305: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_16' because the input edge from 'dense/bias/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067334: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_17' because the input edge from 'dense/bias/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067362: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_18' because the input edge from 'dense/bias/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067397: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_20' because the input edge from 'dense/bias/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067426: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_21' because the input edge from 'dense/bias/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067454: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_22' because the input edge from 'dense/bias/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067482: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_23' because the input edge from 'dense/bias/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067512: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp' because the input edge from 'global_step/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067541: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_1' because the input edge from 'global_step/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067569: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_2' because the input edge from 'global_step/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067598: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_4' because the input edge from 'global_step/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067626: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_5' because the input edge from 'global_step/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067654: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_6' because the input edge from 'global_step/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067683: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_7' because the input edge from 'global_step/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067714: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_8' because the input edge from 'dense/kernel/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067743: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_9' because the input edge from 'dense/kernel/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067771: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_10' because the input edge from 'dense/kernel/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067800: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_12' because the input edge from 'dense/kernel/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.067828: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_13' because the input edge from 'dense/kernel/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.067857: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_14' because the input edge from 'dense/kernel/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.067885: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_15' because the input edge from 'dense/kernel/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\n2018-08-27 10:18:57.067914: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_16' because the input edge from 'dense/bias/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\n2018-08-27 10:18:57.067942: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_17' because the input edge from 'dense/bias/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\n2018-08-27 10:18:57.067970: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_18' because the input edge from 'dense/bias/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\n2018-08-27 10:18:57.067999: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_20' because the input edge from 'dense/bias/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\n2018-08-27 10:18:57.068030: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_21' because the input edge from 'dense/bias/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\n2018-08-27 10:18:57.068059: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_22' because the input edge from 'dense/bias/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\n2018-08-27 10:18:57.068087: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_23' because the input edge from 'dense/bias/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\nTraceback (most recent call last):\n  File \"simple_estimator_example.py\", line 128, in <module>\n    tf.app.run()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n    _sys.exit(main(argv))\n  File \"simple_estimator_example.py\", line 113, in main\n    estimator.train(input_fn=input_fn, steps=10)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1177, in _train_model\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1320, in _train_model_distributed\n    saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1400, in _train_with_estimator_spec\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 504, in MonitoredTrainingSession\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 920, in __init__\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 643, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1106, in __init__\n    _WrappedSession.__init__(self, self._create_session())\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1111, in _create_session\n    return self._sess_creator.create_session()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 566, in create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 287, in prepare_session\n    sess.run(init_op, feed_dict=init_feed_dict)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 887, in run\n    run_metadata_ptr)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\n    run_metadata)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'hooks/steps_per_run/IsInitialized/VarIsInitializedOp': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/job:worker/replica:0/task:0/device:GPU:0'\nColocation Debug Info:\nColocation group had the following types and devices: \nReadVariableOp: GPU CPU \nAssignVariableOp: CPU \nVarIsInitializedOp: GPU CPU \nVarHandleOp: CPU \nConst: GPU CPU \n\nColocation members and user-requested devices:\n  hooks/steps_per_run/Initializer/ones (Const) \n  hooks/steps_per_run (VarHandleOp) \n  hooks/steps_per_run/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) \n  hooks/steps_per_run/Assign (AssignVariableOp) \n  hooks/steps_per_run/Read/ReadVariableOp (ReadVariableOp) \n  report_uninitialized_variables/VarIsInitializedOp_24 (VarIsInitializedOp) /job:worker/replica:0/task:0/device:GPU:0\n\n\t [[{{node hooks/steps_per_run/IsInitialized/VarIsInitializedOp}} = VarIsInitializedOp[](hooks/steps_per_run)]]\n\nCaused by op u'hooks/steps_per_run/IsInitialized/VarIsInitializedOp', defined at:\n  File \"simple_estimator_example.py\", line 128, in <module>\n    tf.app.run()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n    _sys.exit(main(argv))\n  File \"simple_estimator_example.py\", line 113, in main\n    estimator.train(input_fn=input_fn, steps=10)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1177, in _train_model\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1240, in _train_model_distributed\n    steps_per_run_variable = training.get_or_create_steps_per_run_variable()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 309, in get_or_create_steps_per_run_variable\n    use_resource=True)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1484, in get_variable\n    aggregation=aggregation)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1234, in get_variable\n    aggregation=aggregation)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 538, in get_variable\n    aggregation=aggregation)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 492, in _true_getter\n    aggregation=aggregation)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 920, in _get_single_variable\n    aggregation=aggregation)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 131, in __call__\n    return cls._variable_call(*args, **kwargs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 127, in _variable_call\n    aggregation=aggregation)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 106, in <lambda>\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2418, in default_variable_creator\n    import_scope=import_scope)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 133, in __call__\n    return super(VariableMetaclass, cls).__call__(*args, **kwargs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/resource_variable_ops.py\", line 297, in __init__\n    constraint=constraint)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/resource_variable_ops.py\", line 455, in _init_from_args\n    gen_resource_variable_ops.var_is_initialized_op(self._handle))\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/gen_resource_variable_ops.py\", line 1263, in var_is_initialized_op\n    \"VarIsInitializedOp\", resource=resource, name=name)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3263, in create_op\n    op_def=op_def)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1751, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'hooks/steps_per_run/IsInitialized/VarIsInitializedOp': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/job:worker/replica:0/task:0/device:GPU:0'\nColocation Debug Info:\nColocation group had the following types and devices: \nReadVariableOp: GPU CPU \nAssignVariableOp: CPU \nVarIsInitializedOp: GPU CPU \nVarHandleOp: CPU \nConst: GPU CPU \n\nColocation members and user-requested devices:\n  hooks/steps_per_run/Initializer/ones (Const) \n  hooks/steps_per_run (VarHandleOp) \n  hooks/steps_per_run/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) \n  hooks/steps_per_run/Assign (AssignVariableOp) \n  hooks/steps_per_run/Read/ReadVariableOp (ReadVariableOp) \n  report_uninitialized_variables/VarIsInitializedOp_24 (VarIsInitializedOp) /job:worker/replica:0/task:0/device:GPU:0\n\n\t [[{{node hooks/steps_per_run/IsInitialized/VarIsInitializedOp}} = VarIsInitializedOp[](hooks/steps_per_run)]]", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: `Yes`\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: `Linux Ubuntu 16.04`\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: `NA`\r\n- **TensorFlow installed from (source or binary)**: `source`\r\n- **TensorFlow version (use command below)**:  `1.10` (`master` @ 187ed273038ccde054fa27bf19582b0cd8e5cb57)\r\n- **Python version**: `2.7`\r\n- **Bazel version (if compiling from source)**: `0.16.1`\r\n- **GCC/Compiler version (if compiling from source)**: `4.8.5`\r\n- **CUDA/cuDNN version**: `9.1.85`/`7.1.4`\r\n- **GPU model and memory**: `4x NVIDIA P100`,  `16GB` per node\r\n- **Exact command to reproduce**: See below\r\n\r\n### Describe the problem\r\nI'm trying to use a DistributionStrategy (e.g. MirroredStrategy) to train an Estimator in a multi-node, multi-GPU cluster. However, when I start two `tf.train.Server` tasks (each on a different node) and try to have the [simple Estimator example from the  `tf.contrib.distribute` source](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/distribute/python/examples/simple_estimator_example.py) run across these two workers ([here's my modified example](https://github.com/jppgks/tensorflow-distribution-strategy/blob/master/multi-node/workers/simple_estimator_example.py)), I get the error below saying a device can't be assigned.\r\n\r\nI'm suspecting that maybe my cluster setup isn't entirely correct. In that case, I would like to see how the documentation can be updated to include better instructions to run (multi-node) DistributionStrategy. I'm happy to help out with that.\r\n\r\n_pinging @mrry @guptapriya @yuefengz @anj-s_\r\n\r\n### Source code / logs\r\n**Source.** \r\nAvailable on GitHub [here](https://github.com/jppgks/tensorflow-distribution-strategy/tree/master/multi-node/workers).\r\n\r\n**Command.**\r\nOur cluster uses PBS/Torque as job manager, hence the `qsub`, but the contents of the file are standard bash.\r\n```bash\r\nqsub launch_tf_workers.sh\r\n```\r\n\r\n**Job output.** \r\n```pytb\r\nCLUSTER_SPEC: {\"worker\": [\"r22g35:2222\", \"r22g36:2222\"]}\r\n2018-08-27 10:18:18.155846: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\r\n2018-08-27 10:18:22.169890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:61:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:22.788786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:62:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:23.424017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:89:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:24.071758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:8a:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:24.071884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-27 10:18:25.178802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-27 10:18:25.178891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-27 10:18:25.178912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-27 10:18:25.178929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-27 10:18:25.178944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-27 10:18:25.178960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-27 10:18:25.179902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:25.315544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:25.451748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:25.587799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:25.725327: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:222] Initialize GrpcChannelCache for job worker -> {0 -> localhost:2222, 1 -> r22g36:2222}\r\n2018-08-27 10:18:25.725775: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:381] Started server with target: grpc://localhost:2222\r\n2018-08-27 10:18:30.874254: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\r\n2018-08-27 10:18:34.716434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:61:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:35.336941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:62:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:35.969664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:89:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:36.617192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:8a:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:36.617325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-27 10:18:37.725846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-27 10:18:37.725937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-27 10:18:37.725958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-27 10:18:37.725974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-27 10:18:37.725990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-27 10:18:37.726006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-27 10:18:37.726951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:37.863759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:37.999537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:38.135424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:worker/replica:0/task:1/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:38.272553: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:222] Initialize GrpcChannelCache for job worker -> {0 -> r22g35:2222, 1 -> localhost:2222}\r\n2018-08-27 10:18:38.273006: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:381] Started server with target: grpc://localhost:2222\r\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\r\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\r\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\r\nWARNING:tensorflow:Could not find a standard reader in the input pipeline(one of TextLineDataset, TFRecordDataset, FixedLengthRecordDataset).Falling back to sharding the dataset anyway. Please verifycorrectness of auto-sharding for your input.\r\n2018-08-27 10:18:46.714305: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX512F\r\n2018-08-27 10:18:50.653650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:61:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:51.271311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:62:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:51.901031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:89:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:52.566886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \r\nname: Tesla P100-SXM2-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.4805\r\npciBusID: 0000:8a:00.0\r\ntotalMemory: 15.90GiB freeMemory: 15.61GiB\r\n2018-08-27 10:18:52.567011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-27 10:18:53.672876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-27 10:18:53.672965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-27 10:18:53.672987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-27 10:18:53.673003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-27 10:18:53.673019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-27 10:18:53.673035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-27 10:18:53.673974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:53.809434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:53.946947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:54.084679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:57.049981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-27 10:18:57.050183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-27 10:18:57.050217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-27 10:18:57.050244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-27 10:18:57.050270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-27 10:18:57.050295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-27 10:18:57.050319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-27 10:18:57.050912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15123 MB memory) -> physical GPU (device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:57.051179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15123 MB memory) -> physical GPU (device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:57.051476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 15123 MB memory) -> physical GPU (device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0)\r\n2018-08-27 10:18:57.051755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 15123 MB memory) -> physical GPU (device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0\r\n/job:localhost/replica:0/task:0/device:GPU:1 -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0\r\n/job:localhost/replica:0/task:0/device:GPU:2 -> device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0\r\n/job:localhost/replica:0/task:0/device:GPU:3 -> device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0\r\n2018-08-27 10:18:57.052199: I tensorflow/core/common_runtime/direct_session.cc:291] Device mapping:\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:61:00.0, compute capability: 6.0\r\n/job:localhost/replica:0/task:0/device:GPU:1 -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:62:00.0, compute capability: 6.0\r\n/job:localhost/replica:0/task:0/device:GPU:2 -> device: 2, name: Tesla P100-SXM2-16GB, pci bus id: 0000:89:00.0, compute capability: 6.0\r\n/job:localhost/replica:0/task:0/device:GPU:3 -> device: 3, name: Tesla P100-SXM2-16GB, pci bus id: 0000:8a:00.0, compute capability: 6.0\r\n\r\n2018-08-27 10:18:57.066840: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp' because the input edge from 'global_step/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\r\n2018-08-27 10:18:57.066913: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_1' because the input edge from 'global_step/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\r\n2018-08-27 10:18:57.066945: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_2' because the input edge from 'global_step/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\r\n2018-08-27 10:18:57.066975: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_4' because the input edge from 'global_step/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\r\n2018-08-27 10:18:57.067004: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_5' because the input edge from 'global_step/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\r\n2018-08-27 10:18:57.067033: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_6' because the input edge from 'global_step/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\r\n2018-08-27 10:18:57.067066: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_7' because the input edge from 'global_step/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\r\n2018-08-27 10:18:57.067096: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_8' because the input edge from 'dense/kernel/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\r\n2018-08-27 10:18:57.067125: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_9' because the input edge from 'dense/kernel/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\r\n2018-08-27 10:18:57.067153: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_10' because the input edge from 'dense/kernel/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\r\n2018-08-27 10:18:57.067190: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_12' because the input edge from 'dense/kernel/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\r\n2018-08-27 10:18:57.067219: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_13' because the input edge from 'dense/kernel/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\r\n2018-08-27 10:18:57.067248: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_14' because the input edge from 'dense/kernel/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\r\n2018-08-27 10:18:57.067276: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_15' because the input edge from 'dense/kernel/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\r\n2018-08-27 10:18:57.067305: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_16' because the input edge from 'dense/bias/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\r\n2018-08-27 10:18:57.067334: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_17' because the input edge from 'dense/bias/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\r\n2018-08-27 10:18:57.067362: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_18' because the input edge from 'dense/bias/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\r\n2018-08-27 10:18:57.067397: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_20' because the input edge from 'dense/bias/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\r\n2018-08-27 10:18:57.067426: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_21' because the input edge from 'dense/bias/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\r\n2018-08-27 10:18:57.067454: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_22' because the input edge from 'dense/bias/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\r\n2018-08-27 10:18:57.067482: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables/VarIsInitializedOp_23' because the input edge from 'dense/bias/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\r\n2018-08-27 10:18:57.067512: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp' because the input edge from 'global_step/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\r\n2018-08-27 10:18:57.067541: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_1' because the input edge from 'global_step/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\r\n2018-08-27 10:18:57.067569: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_2' because the input edge from 'global_step/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\r\n2018-08-27 10:18:57.067598: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_4' because the input edge from 'global_step/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\r\n2018-08-27 10:18:57.067626: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_5' because the input edge from 'global_step/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\r\n2018-08-27 10:18:57.067654: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_6' because the input edge from 'global_step/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\r\n2018-08-27 10:18:57.067683: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_7' because the input edge from 'global_step/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\r\n2018-08-27 10:18:57.067714: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_8' because the input edge from 'dense/kernel/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\r\n2018-08-27 10:18:57.067743: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_9' because the input edge from 'dense/kernel/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\r\n2018-08-27 10:18:57.067771: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_10' because the input edge from 'dense/kernel/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\r\n2018-08-27 10:18:57.067800: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_12' because the input edge from 'dense/kernel/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\r\n2018-08-27 10:18:57.067828: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_13' because the input edge from 'dense/kernel/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\r\n2018-08-27 10:18:57.067857: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_14' because the input edge from 'dense/kernel/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\r\n2018-08-27 10:18:57.067885: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_15' because the input edge from 'dense/kernel/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\r\n2018-08-27 10:18:57.067914: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_16' because the input edge from 'dense/bias/replica_3' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:3\r\n2018-08-27 10:18:57.067942: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_17' because the input edge from 'dense/bias/replica_2' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:2\r\n2018-08-27 10:18:57.067970: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_18' because the input edge from 'dense/bias/replica_1' is a reference connection and already has a device field set to /job:worker/replica:0/task:0/device:GPU:1\r\n2018-08-27 10:18:57.067999: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_20' because the input edge from 'dense/bias/replica_4' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:0\r\n2018-08-27 10:18:57.068030: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_21' because the input edge from 'dense/bias/replica_5' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:1\r\n2018-08-27 10:18:57.068059: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_22' because the input edge from 'dense/bias/replica_6' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:2\r\n2018-08-27 10:18:57.068087: I tensorflow/core/common_runtime/placer.cc:747] Ignoring device specification /job:worker/replica:0/task:0/device:GPU:0 for node 'report_uninitialized_variables_1/VarIsInitializedOp_23' because the input edge from 'dense/bias/replica_7' is a reference connection and already has a device field set to /job:worker/replica:0/task:1/device:GPU:3\r\nTraceback (most recent call last):\r\n  File \"simple_estimator_example.py\", line 128, in <module>\r\n    tf.app.run()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"simple_estimator_example.py\", line 113, in main\r\n    estimator.train(input_fn=input_fn, steps=10)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1177, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1320, in _train_model_distributed\r\n    saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1400, in _train_with_estimator_spec\r\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 504, in MonitoredTrainingSession\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 920, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 643, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1106, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1111, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 566, in create_session\r\n    init_fn=self._scaffold.init_fn)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 287, in prepare_session\r\n    sess.run(init_op, feed_dict=init_feed_dict)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 887, in run\r\n    run_metadata_ptr)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\r\n    run_metadata)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'hooks/steps_per_run/IsInitialized/VarIsInitializedOp': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/job:worker/replica:0/task:0/device:GPU:0'\r\nColocation Debug Info:\r\nColocation group had the following types and devices: \r\nReadVariableOp: GPU CPU \r\nAssignVariableOp: CPU \r\nVarIsInitializedOp: GPU CPU \r\nVarHandleOp: CPU \r\nConst: GPU CPU \r\n\r\nColocation members and user-requested devices:\r\n  hooks/steps_per_run/Initializer/ones (Const) \r\n  hooks/steps_per_run (VarHandleOp) \r\n  hooks/steps_per_run/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) \r\n  hooks/steps_per_run/Assign (AssignVariableOp) \r\n  hooks/steps_per_run/Read/ReadVariableOp (ReadVariableOp) \r\n  report_uninitialized_variables/VarIsInitializedOp_24 (VarIsInitializedOp) /job:worker/replica:0/task:0/device:GPU:0\r\n\r\n\t [[{{node hooks/steps_per_run/IsInitialized/VarIsInitializedOp}} = VarIsInitializedOp[](hooks/steps_per_run)]]\r\n\r\nCaused by op u'hooks/steps_per_run/IsInitialized/VarIsInitializedOp', defined at:\r\n  File \"simple_estimator_example.py\", line 128, in <module>\r\n    tf.app.run()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"simple_estimator_example.py\", line 113, in main\r\n    estimator.train(input_fn=input_fn, steps=10)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1177, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1240, in _train_model_distributed\r\n    steps_per_run_variable = training.get_or_create_steps_per_run_variable()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/basic_session_run_hooks.py\", line 309, in get_or_create_steps_per_run_variable\r\n    use_resource=True)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1484, in get_variable\r\n    aggregation=aggregation)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1234, in get_variable\r\n    aggregation=aggregation)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 538, in get_variable\r\n    aggregation=aggregation)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 492, in _true_getter\r\n    aggregation=aggregation)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 920, in _get_single_variable\r\n    aggregation=aggregation)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 131, in __call__\r\n    return cls._variable_call(*args, **kwargs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 127, in _variable_call\r\n    aggregation=aggregation)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 106, in <lambda>\r\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2418, in default_variable_creator\r\n    import_scope=import_scope)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 133, in __call__\r\n    return super(VariableMetaclass, cls).__call__(*args, **kwargs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/resource_variable_ops.py\", line 297, in __init__\r\n    constraint=constraint)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/resource_variable_ops.py\", line 455, in _init_from_args\r\n    gen_resource_variable_ops.var_is_initialized_op(self._handle))\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/gen_resource_variable_ops.py\", line 1263, in var_is_initialized_op\r\n    \"VarIsInitializedOp\", resource=resource, name=name)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3263, in create_op\r\n    op_def=op_def)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1751, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'hooks/steps_per_run/IsInitialized/VarIsInitializedOp': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/job:worker/replica:0/task:0/device:GPU:0'\r\nColocation Debug Info:\r\nColocation group had the following types and devices: \r\nReadVariableOp: GPU CPU \r\nAssignVariableOp: CPU \r\nVarIsInitializedOp: GPU CPU \r\nVarHandleOp: CPU \r\nConst: GPU CPU \r\n\r\nColocation members and user-requested devices:\r\n  hooks/steps_per_run/Initializer/ones (Const) \r\n  hooks/steps_per_run (VarHandleOp) \r\n  hooks/steps_per_run/IsInitialized/VarIsInitializedOp (VarIsInitializedOp) \r\n  hooks/steps_per_run/Assign (AssignVariableOp) \r\n  hooks/steps_per_run/Read/ReadVariableOp (ReadVariableOp) \r\n  report_uninitialized_variables/VarIsInitializedOp_24 (VarIsInitializedOp) /job:worker/replica:0/task:0/device:GPU:0\r\n\r\n\t [[{{node hooks/steps_per_run/IsInitialized/VarIsInitializedOp}} = VarIsInitializedOp[](hooks/steps_per_run)]]\r\n```\r\n"}