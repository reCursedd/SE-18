{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/416486317", "html_url": "https://github.com/tensorflow/tensorflow/issues/21897#issuecomment-416486317", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21897", "id": 416486317, "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjQ4NjMxNw==", "user": {"login": "jppgks", "id": 11156808, "node_id": "MDQ6VXNlcjExMTU2ODA4", "avatar_url": "https://avatars3.githubusercontent.com/u/11156808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jppgks", "html_url": "https://github.com/jppgks", "followers_url": "https://api.github.com/users/jppgks/followers", "following_url": "https://api.github.com/users/jppgks/following{/other_user}", "gists_url": "https://api.github.com/users/jppgks/gists{/gist_id}", "starred_url": "https://api.github.com/users/jppgks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jppgks/subscriptions", "organizations_url": "https://api.github.com/users/jppgks/orgs", "repos_url": "https://api.github.com/users/jppgks/repos", "events_url": "https://api.github.com/users/jppgks/events{/privacy}", "received_events_url": "https://api.github.com/users/jppgks/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-28T07:52:12Z", "updated_at": "2018-08-28T07:52:12Z", "author_association": "NONE", "body_html": "<p>The error I had before with <code>VarIsInitializedOp </code> is now replaced by the following placement issue with <code>IteratorToStringHandle</code> after building from master @ <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/e2c6ec9e86dd86e0dd56e0f11302a5bf5d9ed440/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/e2c6ec9e86dd86e0dd56e0f11302a5bf5d9ed440\"><tt>e2c6ec9</tt></a>.</p>\n<div class=\"highlight highlight-text-python-traceback\"><pre>Traceback (most recent call last):\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">109</span>, in <span class=\"pl-en\">&lt;module&gt;</span>\n    tf.app.run()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\"</span>, line <span class=\"pl-c1\">125</span>, in <span class=\"pl-en\">run</span>\n    _sys.exit(main(argv))\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">94</span>, in <span class=\"pl-en\">main</span>\n    estimator.train(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">354</span>, in <span class=\"pl-en\">train</span>\n    loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._train_model(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1181</span>, in <span class=\"pl-en\">_train_model</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._train_model_distributed(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1325</span>, in <span class=\"pl-en\">_train_model_distributed</span>\n    saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1405</span>, in <span class=\"pl-en\">_train_with_estimator_spec</span>\n    log_step_count_steps<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._config.log_step_count_steps) <span class=\"pl-k\">as</span> mon_sess:\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">504</span>, in <span class=\"pl-en\">MonitoredTrainingSession</span>\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">920</span>, in <span class=\"pl-en\">__init__</span>\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">643</span>, in <span class=\"pl-en\">__init__</span>\n    <span class=\"pl-c1\">self</span>._sess <span class=\"pl-k\">=</span> _RecoverableSession(<span class=\"pl-c1\">self</span>._coordinated_creator)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">1106</span>, in <span class=\"pl-en\">__init__</span>\n    _WrappedSession.<span class=\"pl-c1\">__init__</span>(<span class=\"pl-c1\">self</span>, <span class=\"pl-c1\">self</span>._create_session())\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">1111</span>, in <span class=\"pl-en\">_create_session</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._sess_creator.create_session()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">800</span>, in <span class=\"pl-en\">create_session</span>\n    <span class=\"pl-c1\">self</span>.tf_sess <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._session_creator.create_session()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\"</span>, line <span class=\"pl-c1\">566</span>, in <span class=\"pl-en\">create_session</span>\n    init_fn<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._scaffold.init_fn)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\"</span>, line <span class=\"pl-c1\">287</span>, in <span class=\"pl-en\">prepare_session</span>\n    sess.run(init_op, <span class=\"pl-v\">feed_dict</span><span class=\"pl-k\">=</span>init_feed_dict)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">887</span>, in <span class=\"pl-en\">run</span>\n    run_metadata_ptr)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">1110</span>, in <span class=\"pl-en\">_run</span>\n    feed_dict_tensor, options, run_metadata)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">1286</span>, in <span class=\"pl-en\">_do_run</span>\n    run_metadata)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\"</span>, line <span class=\"pl-c1\">1308</span>, in <span class=\"pl-en\">_do_call</span>\n    <span class=\"pl-k\">raise</span> <span class=\"pl-c1\">type</span>(e)(node_def, op, message)\n<span class=\"pl-en\">tensorflow.python.framework.errors_impl.InvalidArgumentError</span>: <span class=\"pl-s\">Cannot assign a device for operation 'IteratorToStringHandle': Operation was explicitly assigned to /job:worker/task:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:GPU:0, /job:localhost/replica:0/task:0/device:GPU:1, /job:localhost/replica:0/task:0/device:GPU:2, /job:localhost/replica:0/task:0/device:GPU:3 ]. Make sure the device specification refers to a valid device.</span>\n\t [[{{node IteratorToStringHandle}} = IteratorToStringHandle[_device=\"/job:worker/task:0\"](IteratorV2)]]\n\nCaused by op u'IteratorToStringHandle', defined at:\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">109</span>, in <span class=\"pl-en\">&lt;module&gt;</span>\n    tf.app.run()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\"</span>, line <span class=\"pl-c1\">125</span>, in <span class=\"pl-en\">run</span>\n    _sys.exit(main(argv))\n  File <span class=\"pl-s\">\"simple_estimator_example.py\"</span>, line <span class=\"pl-c1\">94</span>, in <span class=\"pl-en\">main</span>\n    estimator.train(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">354</span>, in <span class=\"pl-en\">train</span>\n    loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._train_model(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1181</span>, in <span class=\"pl-en\">_train_model</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._train_model_distributed(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1249</span>, in <span class=\"pl-en\">_train_model_distributed</span>\n    input_fn, model_fn_lib.ModeKeys.<span class=\"pl-c1\">TRAIN</span>, <span class=\"pl-c1\">self</span>._train_distribution)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\"</span>, line <span class=\"pl-c1\">1044</span>, in <span class=\"pl-en\">_get_iterator_from_input_fn</span>\n    iterator <span class=\"pl-k\">=</span> result.make_initializable_iterator()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/values.py\"</span>, line <span class=\"pl-c1\">831</span>, in <span class=\"pl-en\">make_initializable_iterator</span>\n    iterators[worker] <span class=\"pl-k\">=</span> dataset.make_initializable_iterator()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/values.py\"</span>, line <span class=\"pl-c1\">736</span>, in <span class=\"pl-en\">make_initializable_iterator</span>\n    dataset_iterator <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._dataset.make_initializable_iterator()\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/prefetching_ops_v2.py\"</span>, line <span class=\"pl-c1\">184</span>, in <span class=\"pl-en\">make_initializable_iterator</span>\n    shared_name<span class=\"pl-k\">=</span>shared_name)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/prefetching_ops_v2.py\"</span>, line <span class=\"pl-c1\">72</span>, in <span class=\"pl-en\">__init__</span>\n    shared_name, <span class=\"pl-c1\">self</span>._input_dataset.output_classes)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/data/ops/iterator_ops.py\"</span>, line <span class=\"pl-c1\">213</span>, in <span class=\"pl-en\">from_structure</span>\n    output_classes)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/data/ops/iterator_ops.py\"</span>, line <span class=\"pl-c1\">100</span>, in <span class=\"pl-en\">__init__</span>\n    <span class=\"pl-c1\">self</span>._iterator_resource)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/gen_dataset_ops.py\"</span>, line <span class=\"pl-c1\">2393</span>, in <span class=\"pl-en\">iterator_to_string_handle</span>\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>IteratorToStringHandle<span class=\"pl-pds\">\"</span></span>, resource_handle<span class=\"pl-k\">=</span>resource_handle, name<span class=\"pl-k\">=</span>name)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\"</span>, line <span class=\"pl-c1\">787</span>, in <span class=\"pl-en\">_apply_op_helper</span>\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\"</span>, line <span class=\"pl-c1\">488</span>, in <span class=\"pl-en\">new_func</span>\n    <span class=\"pl-k\">return</span> func(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\"</span>, line <span class=\"pl-c1\">3254</span>, in <span class=\"pl-en\">create_op</span>\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\">\"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\"</span>, line <span class=\"pl-c1\">1750</span>, in <span class=\"pl-en\">__init__</span>\n    <span class=\"pl-c1\">self</span>._traceback <span class=\"pl-k\">=</span> tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'IteratorToStringHandle': Operation was explicitly assigned to /job:worker/task:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:GPU:0, /job:localhost/replica:0/task:0/device:GPU:1, /job:localhost/replica:0/task:0/device:GPU:2, /job:localhost/replica:0/task:0/device:GPU:3 ]. Make sure the device specification refers to a valid device.\n\t [[{{node IteratorToStringHandle}} = IteratorToStringHandle[_device=\"/job:worker/task:0\"](IteratorV2)]]</pre></div>", "body_text": "The error I had before with VarIsInitializedOp  is now replaced by the following placement issue with IteratorToStringHandle after building from master @ e2c6ec9.\nTraceback (most recent call last):\n  File \"simple_estimator_example.py\", line 109, in <module>\n    tf.app.run()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n    _sys.exit(main(argv))\n  File \"simple_estimator_example.py\", line 94, in main\n    estimator.train(input_fn=input_fn, steps=10)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1181, in _train_model\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1325, in _train_model_distributed\n    saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1405, in _train_with_estimator_spec\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 504, in MonitoredTrainingSession\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 920, in __init__\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 643, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1106, in __init__\n    _WrappedSession.__init__(self, self._create_session())\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1111, in _create_session\n    return self._sess_creator.create_session()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 566, in create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 287, in prepare_session\n    sess.run(init_op, feed_dict=init_feed_dict)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 887, in run\n    run_metadata_ptr)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\n    run_metadata)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'IteratorToStringHandle': Operation was explicitly assigned to /job:worker/task:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:GPU:0, /job:localhost/replica:0/task:0/device:GPU:1, /job:localhost/replica:0/task:0/device:GPU:2, /job:localhost/replica:0/task:0/device:GPU:3 ]. Make sure the device specification refers to a valid device.\n\t [[{{node IteratorToStringHandle}} = IteratorToStringHandle[_device=\"/job:worker/task:0\"](IteratorV2)]]\n\nCaused by op u'IteratorToStringHandle', defined at:\n  File \"simple_estimator_example.py\", line 109, in <module>\n    tf.app.run()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\n    _sys.exit(main(argv))\n  File \"simple_estimator_example.py\", line 94, in main\n    estimator.train(input_fn=input_fn, steps=10)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1181, in _train_model\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1249, in _train_model_distributed\n    input_fn, model_fn_lib.ModeKeys.TRAIN, self._train_distribution)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1044, in _get_iterator_from_input_fn\n    iterator = result.make_initializable_iterator()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/values.py\", line 831, in make_initializable_iterator\n    iterators[worker] = dataset.make_initializable_iterator()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/values.py\", line 736, in make_initializable_iterator\n    dataset_iterator = self._dataset.make_initializable_iterator()\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/prefetching_ops_v2.py\", line 184, in make_initializable_iterator\n    shared_name=shared_name)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/prefetching_ops_v2.py\", line 72, in __init__\n    shared_name, self._input_dataset.output_classes)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/data/ops/iterator_ops.py\", line 213, in from_structure\n    output_classes)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/data/ops/iterator_ops.py\", line 100, in __init__\n    self._iterator_resource)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/gen_dataset_ops.py\", line 2393, in iterator_to_string_handle\n    \"IteratorToStringHandle\", resource_handle=resource_handle, name=name)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3254, in create_op\n    op_def=op_def)\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1750, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'IteratorToStringHandle': Operation was explicitly assigned to /job:worker/task:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:GPU:0, /job:localhost/replica:0/task:0/device:GPU:1, /job:localhost/replica:0/task:0/device:GPU:2, /job:localhost/replica:0/task:0/device:GPU:3 ]. Make sure the device specification refers to a valid device.\n\t [[{{node IteratorToStringHandle}} = IteratorToStringHandle[_device=\"/job:worker/task:0\"](IteratorV2)]]", "body": "The error I had before with `VarIsInitializedOp ` is now replaced by the following placement issue with `IteratorToStringHandle` after building from master @ e2c6ec9e86dd86e0dd56e0f11302a5bf5d9ed440.\r\n\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"simple_estimator_example.py\", line 109, in <module>\r\n    tf.app.run()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"simple_estimator_example.py\", line 94, in main\r\n    estimator.train(input_fn=input_fn, steps=10)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1181, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1325, in _train_model_distributed\r\n    saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1405, in _train_with_estimator_spec\r\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 504, in MonitoredTrainingSession\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 920, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 643, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1106, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1111, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 566, in create_session\r\n    init_fn=self._scaffold.init_fn)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 287, in prepare_session\r\n    sess.run(init_op, feed_dict=init_feed_dict)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 887, in run\r\n    run_metadata_ptr)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\r\n    run_metadata)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'IteratorToStringHandle': Operation was explicitly assigned to /job:worker/task:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:GPU:0, /job:localhost/replica:0/task:0/device:GPU:1, /job:localhost/replica:0/task:0/device:GPU:2, /job:localhost/replica:0/task:0/device:GPU:3 ]. Make sure the device specification refers to a valid device.\r\n\t [[{{node IteratorToStringHandle}} = IteratorToStringHandle[_device=\"/job:worker/task:0\"](IteratorV2)]]\r\n\r\nCaused by op u'IteratorToStringHandle', defined at:\r\n  File \"simple_estimator_example.py\", line 109, in <module>\r\n    tf.app.run()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"simple_estimator_example.py\", line 94, in main\r\n    estimator.train(input_fn=input_fn, steps=10)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1181, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1249, in _train_model_distributed\r\n    input_fn, model_fn_lib.ModeKeys.TRAIN, self._train_distribution)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1044, in _get_iterator_from_input_fn\r\n    iterator = result.make_initializable_iterator()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/values.py\", line 831, in make_initializable_iterator\r\n    iterators[worker] = dataset.make_initializable_iterator()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/values.py\", line 736, in make_initializable_iterator\r\n    dataset_iterator = self._dataset.make_initializable_iterator()\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/prefetching_ops_v2.py\", line 184, in make_initializable_iterator\r\n    shared_name=shared_name)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/contrib/distribute/python/prefetching_ops_v2.py\", line 72, in __init__\r\n    shared_name, self._input_dataset.output_classes)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/data/ops/iterator_ops.py\", line 213, in from_structure\r\n    output_classes)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/data/ops/iterator_ops.py\", line 100, in __init__\r\n    self._iterator_resource)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/ops/gen_dataset_ops.py\", line 2393, in iterator_to_string_handle\r\n    \"IteratorToStringHandle\", resource_handle=resource_handle, name=name)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3254, in create_op\r\n    op_def=op_def)\r\n  File \"/data/leuven/319/vsc31962/miniconda3/envs/py27-tf-source/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1750, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'IteratorToStringHandle': Operation was explicitly assigned to /job:worker/task:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:GPU:0, /job:localhost/replica:0/task:0/device:GPU:1, /job:localhost/replica:0/task:0/device:GPU:2, /job:localhost/replica:0/task:0/device:GPU:3 ]. Make sure the device specification refers to a valid device.\r\n\t [[{{node IteratorToStringHandle}} = IteratorToStringHandle[_device=\"/job:worker/task:0\"](IteratorV2)]]\r\n```"}