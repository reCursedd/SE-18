{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/223255007", "pull_request_review_id": 162331885, "id": 223255007, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMzI1NTAwNw==", "diff_hunk": "@@ -1314,8 +1364,12 @@ tensorflow::Status ConvertConv2DHelper(\n   VLOG(2) << \"data_format: \" << data_format;\n   if (data_format == \"NHWC\") {\n     // TODO(jie): transpose it back!\n+    nvinfer1::ITensor* inp = output_tensor;\n     output_tensor = ctx.TransposeTensor(output_tensor, {0, 2, 3, 1});\n     TFTRT_RETURN_ERROR_IF_NULLPTR(output_tensor, node_def.name());\n+    // Store input and output tensors so that quantization ranges from output of shuffle\n+    // can be inferred backwards for input\n+    ctx.quantization_infer_backwards_[output_tensor] = inp;", "path": "tensorflow/contrib/tensorrt/convert/convert_nodes.cc", "position": null, "original_position": 94, "commit_id": "c9774910f1e24b964f0a31fdbf98df472d92501b", "original_commit_id": "09c215a9c134dcc52882b153973617e125ad300b", "user": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "body": "I think this is equivalent to `ctx.CopyQuantizationRange(inp, output_tensor, false);`?\r\n\r\nAlso, why not do forward copy here? Actually in general how do we decide when to do forward copy and when to do backward? It seems we can always do both?", "created_at": "2018-10-08T06:14:10Z", "updated_at": "2018-11-21T23:48:52Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/22788#discussion_r223255007", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22788", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/223255007"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/22788#discussion_r223255007"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22788"}}, "body_html": "<p>I think this is equivalent to <code>ctx.CopyQuantizationRange(inp, output_tensor, false);</code>?</p>\n<p>Also, why not do forward copy here? Actually in general how do we decide when to do forward copy and when to do backward? It seems we can always do both?</p>", "body_text": "I think this is equivalent to ctx.CopyQuantizationRange(inp, output_tensor, false);?\nAlso, why not do forward copy here? Actually in general how do we decide when to do forward copy and when to do backward? It seems we can always do both?"}