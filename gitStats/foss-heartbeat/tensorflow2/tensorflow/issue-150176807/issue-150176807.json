{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2053", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2053/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2053/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2053/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2053", "id": 150176807, "node_id": "MDU6SXNzdWUxNTAxNzY4MDc=", "number": 2053, "title": "Failed to build from source due to missing libcudart.so.7.5:", "user": {"login": "akors", "id": 3023492, "node_id": "MDQ6VXNlcjMwMjM0OTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/3023492?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akors", "html_url": "https://github.com/akors", "followers_url": "https://api.github.com/users/akors/followers", "following_url": "https://api.github.com/users/akors/following{/other_user}", "gists_url": "https://api.github.com/users/akors/gists{/gist_id}", "starred_url": "https://api.github.com/users/akors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akors/subscriptions", "organizations_url": "https://api.github.com/users/akors/orgs", "repos_url": "https://api.github.com/users/akors/repos", "events_url": "https://api.github.com/users/akors/events{/privacy}", "received_events_url": "https://api.github.com/users/akors/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "keveman", "id": 229914, "node_id": "MDQ6VXNlcjIyOTkxNA==", "avatar_url": "https://avatars1.githubusercontent.com/u/229914?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keveman", "html_url": "https://github.com/keveman", "followers_url": "https://api.github.com/users/keveman/followers", "following_url": "https://api.github.com/users/keveman/following{/other_user}", "gists_url": "https://api.github.com/users/keveman/gists{/gist_id}", "starred_url": "https://api.github.com/users/keveman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keveman/subscriptions", "organizations_url": "https://api.github.com/users/keveman/orgs", "repos_url": "https://api.github.com/users/keveman/repos", "events_url": "https://api.github.com/users/keveman/events{/privacy}", "received_events_url": "https://api.github.com/users/keveman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keveman", "id": 229914, "node_id": "MDQ6VXNlcjIyOTkxNA==", "avatar_url": "https://avatars1.githubusercontent.com/u/229914?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keveman", "html_url": "https://github.com/keveman", "followers_url": "https://api.github.com/users/keveman/followers", "following_url": "https://api.github.com/users/keveman/following{/other_user}", "gists_url": "https://api.github.com/users/keveman/gists{/gist_id}", "starred_url": "https://api.github.com/users/keveman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keveman/subscriptions", "organizations_url": "https://api.github.com/users/keveman/orgs", "repos_url": "https://api.github.com/users/keveman/repos", "events_url": "https://api.github.com/users/keveman/events{/privacy}", "received_events_url": "https://api.github.com/users/keveman/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 22, "created_at": "2016-04-21T20:02:20Z", "updated_at": "2016-07-18T02:32:45Z", "closed_at": "2016-05-10T22:11:25Z", "author_association": "NONE", "body_html": "<p>Hi! I tried to compile the tutorials_example_trainer file, and I have quite a journey behind me. I recompiled GCC several times, I recompiled bazel dozens of times and did a fair share of CROSSTOOLS editing.<br>\nAt this point, I am stuck. The compliation fails with the message:</p>\n<p><code>bazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc: error while loading shared libraries: libcudart.so.7.5: cannot open shared object file: No such file or directory Target //tensorflow/cc:tutorials_example_trainer failed to build</code></p>\n<p>I am using Tensorflow HEAD (currently <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/7b536cd5cfdbfd0fbc80496a38624557fb977783/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/7b536cd5cfdbfd0fbc80496a38624557fb977783\"><tt>7b536cd</tt></a>), I have CUDA 7.5 installed in /usr/local/cuda-7.5 .</p>\n<p>My LD_LIBRARY_PATH is set to :/usr/local/cuda/lib64:/usr/local/cuda/lib64 , and the files exist there.<br>\nI tried to point bazel to the library directory by adding</p>\n<p><code>+  linker_flag: \"-L/usr/local/cuda/lib64\"</code><br>\n.</p>\n<h3>Environment info</h3>\n<p>Operating System: Fedora 23</p>\n<p>Installed version of CUDA and cuDNN: 7.5 and 4.0.7</p>\n<pre><code>$ ls /usr/local/cuda-7.5/lib64/libcud*\n/usr/local/cuda-7.5/lib64/libcudadevrt.a    /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18  /usr/local/cuda-7.5/lib64/libcudnn.so.4\n/usr/local/cuda-7.5/lib64/libcudart.so      /usr/local/cuda-7.5/lib64/libcudart_static.a   /usr/local/cuda-7.5/lib64/libcudnn.so.4.0.7\n/usr/local/cuda-7.5/lib64/libcudart.so.7.5  /usr/local/cuda-7.5/lib64/libcudnn.so          /usr/local/cuda-7.5/lib64/libcudnn_static.a\n</code></pre>\n<p>If installed from sources, provide the commit hash: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/7b536cd5cfdbfd0fbc80496a38624557fb977783/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/7b536cd5cfdbfd0fbc80496a38624557fb977783\"><tt>7b536cd</tt></a></p>\n<h3>Steps to reproduce</h3>\n<ol>\n<li>Recompiled Bazel, version 0.2.1 with the following patch: <a href=\"https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-bazel-custom-gcc-patch\">https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-bazel-custom-gcc-patch</a></li>\n<li>Applied the following patch to TensorFlow: <a href=\"https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-tensorflow-custom-gcc-patch\">https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-tensorflow-custom-gcc-patch</a></li>\n<li>Ran ./configure with /opt/gcc-4.9/bin/gcc as compiler, but default otherwise.</li>\n<li>Ran bazel build -c opt --config=cuda --local_resources 4096,3.0,1.0 -j 4 //tensorflow/cc:tutorials_example_trainer --verbose_failures</li>\n</ol>\n<h3>What have you tried?</h3>\n<ol>\n<li>I cried a lot.</li>\n<li>Add <code>linker_flag: \"-L/usr/local/cuda/lib64\"</code> to <code>third_party/gpus/crosstool/CROSSTOOL</code></li>\n<li>Add <code>linker_flag: \"-Wl,-R/usr/local/cuda/lib64\"</code>  to <code>third_party/gpus/crosstool/CROSSTOOL</code></li>\n<li>Recompile bazel, with added <code>linker_flag: \"-Wl,-R/usr/local/cuda/lib64\"</code> in <code>tools/cpp/CROSSTOOL</code></li>\n<li>Create a file <code>/etc/ld.so.conf.d/LOCAL_cuda-lib64.conf</code> with the contents <code>/usr/local/cuda/lib64</code> and ran <code>ldconfig</code></li>\n</ol>\n<h3>Logs or other output that would be helpful</h3>\n<p>Here's the full output of the last operation:</p>\n<pre><code>ERROR: /home/alexander/.local/src/tensorflow/tensorflow/cc/BUILD:28:1: Executing genrule //tensorflow/cc:random_ops_genrule failed: namespace-sandbox failed: error executing command \n  (cd /home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow &amp;&amp; \\\n  exec env - \\\n    PATH=/usr/lib/ccache:/usr/lib/ccache:/usr/lib64/qt-3.3/bin:/usr/lib64/ccache:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/alexander/.local/bin:/home/alexander/bin:/home/alexander/.local/bin:/home/alexander/bin \\\n  /home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow/_bin/namespace-sandbox @/home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow/bazel-sandbox/7d27406c-6595-46a2-a8dc-b7faf7c28c88-0.params -- /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc bazel-out/local_linux-opt/genfiles/tensorflow/cc/ops/random_ops.h bazel-out/local_linux-opt/genfiles/tensorflow/cc/ops/random_ops.cc 0').\nbazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc: error while loading shared libraries: libcudart.so.7.5: cannot open shared object file: No such file or directory\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\nINFO: Elapsed time: 630.365s, Critical Path: 137.07s\n</code></pre>\n<p>ps.: Out of curiosity, what are you TensorFlow devs using for a development machine? Has any of you actually tried using a modern Linux distribution that comes with GCC newer than 4.9 for compilation? You really should. It's quite the experience.</p>", "body_text": "Hi! I tried to compile the tutorials_example_trainer file, and I have quite a journey behind me. I recompiled GCC several times, I recompiled bazel dozens of times and did a fair share of CROSSTOOLS editing.\nAt this point, I am stuck. The compliation fails with the message:\nbazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc: error while loading shared libraries: libcudart.so.7.5: cannot open shared object file: No such file or directory Target //tensorflow/cc:tutorials_example_trainer failed to build\nI am using Tensorflow HEAD (currently 7b536cd), I have CUDA 7.5 installed in /usr/local/cuda-7.5 .\nMy LD_LIBRARY_PATH is set to :/usr/local/cuda/lib64:/usr/local/cuda/lib64 , and the files exist there.\nI tried to point bazel to the library directory by adding\n+  linker_flag: \"-L/usr/local/cuda/lib64\"\n.\nEnvironment info\nOperating System: Fedora 23\nInstalled version of CUDA and cuDNN: 7.5 and 4.0.7\n$ ls /usr/local/cuda-7.5/lib64/libcud*\n/usr/local/cuda-7.5/lib64/libcudadevrt.a    /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18  /usr/local/cuda-7.5/lib64/libcudnn.so.4\n/usr/local/cuda-7.5/lib64/libcudart.so      /usr/local/cuda-7.5/lib64/libcudart_static.a   /usr/local/cuda-7.5/lib64/libcudnn.so.4.0.7\n/usr/local/cuda-7.5/lib64/libcudart.so.7.5  /usr/local/cuda-7.5/lib64/libcudnn.so          /usr/local/cuda-7.5/lib64/libcudnn_static.a\n\nIf installed from sources, provide the commit hash: 7b536cd\nSteps to reproduce\n\nRecompiled Bazel, version 0.2.1 with the following patch: https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-bazel-custom-gcc-patch\nApplied the following patch to TensorFlow: https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-tensorflow-custom-gcc-patch\nRan ./configure with /opt/gcc-4.9/bin/gcc as compiler, but default otherwise.\nRan bazel build -c opt --config=cuda --local_resources 4096,3.0,1.0 -j 4 //tensorflow/cc:tutorials_example_trainer --verbose_failures\n\nWhat have you tried?\n\nI cried a lot.\nAdd linker_flag: \"-L/usr/local/cuda/lib64\" to third_party/gpus/crosstool/CROSSTOOL\nAdd linker_flag: \"-Wl,-R/usr/local/cuda/lib64\"  to third_party/gpus/crosstool/CROSSTOOL\nRecompile bazel, with added linker_flag: \"-Wl,-R/usr/local/cuda/lib64\" in tools/cpp/CROSSTOOL\nCreate a file /etc/ld.so.conf.d/LOCAL_cuda-lib64.conf with the contents /usr/local/cuda/lib64 and ran ldconfig\n\nLogs or other output that would be helpful\nHere's the full output of the last operation:\nERROR: /home/alexander/.local/src/tensorflow/tensorflow/cc/BUILD:28:1: Executing genrule //tensorflow/cc:random_ops_genrule failed: namespace-sandbox failed: error executing command \n  (cd /home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow && \\\n  exec env - \\\n    PATH=/usr/lib/ccache:/usr/lib/ccache:/usr/lib64/qt-3.3/bin:/usr/lib64/ccache:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/alexander/.local/bin:/home/alexander/bin:/home/alexander/.local/bin:/home/alexander/bin \\\n  /home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow/_bin/namespace-sandbox @/home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow/bazel-sandbox/7d27406c-6595-46a2-a8dc-b7faf7c28c88-0.params -- /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc bazel-out/local_linux-opt/genfiles/tensorflow/cc/ops/random_ops.h bazel-out/local_linux-opt/genfiles/tensorflow/cc/ops/random_ops.cc 0').\nbazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc: error while loading shared libraries: libcudart.so.7.5: cannot open shared object file: No such file or directory\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\nINFO: Elapsed time: 630.365s, Critical Path: 137.07s\n\nps.: Out of curiosity, what are you TensorFlow devs using for a development machine? Has any of you actually tried using a modern Linux distribution that comes with GCC newer than 4.9 for compilation? You really should. It's quite the experience.", "body": "Hi! I tried to compile the tutorials_example_trainer file, and I have quite a journey behind me. I recompiled GCC several times, I recompiled bazel dozens of times and did a fair share of CROSSTOOLS editing.\nAt this point, I am stuck. The compliation fails with the message:\n\n`bazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc: error while loading shared libraries: libcudart.so.7.5: cannot open shared object file: No such file or directory\nTarget //tensorflow/cc:tutorials_example_trainer failed to build`\n\nI am using Tensorflow HEAD (currently 7b536cd5cfdbfd0fbc80496a38624557fb977783), I have CUDA 7.5 installed in /usr/local/cuda-7.5 .\n\nMy LD_LIBRARY_PATH is set to :/usr/local/cuda/lib64:/usr/local/cuda/lib64 , and the files exist there.\nI tried to point bazel to the library directory by adding \n\n`+  linker_flag: \"-L/usr/local/cuda/lib64\"`\n.\n### Environment info\n\nOperating System: Fedora 23\n\nInstalled version of CUDA and cuDNN: 7.5 and 4.0.7\n\n```\n$ ls /usr/local/cuda-7.5/lib64/libcud*\n/usr/local/cuda-7.5/lib64/libcudadevrt.a    /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18  /usr/local/cuda-7.5/lib64/libcudnn.so.4\n/usr/local/cuda-7.5/lib64/libcudart.so      /usr/local/cuda-7.5/lib64/libcudart_static.a   /usr/local/cuda-7.5/lib64/libcudnn.so.4.0.7\n/usr/local/cuda-7.5/lib64/libcudart.so.7.5  /usr/local/cuda-7.5/lib64/libcudnn.so          /usr/local/cuda-7.5/lib64/libcudnn_static.a\n```\n\nIf installed from sources, provide the commit hash: 7b536cd5cfdbfd0fbc80496a38624557fb977783\n### Steps to reproduce\n1. Recompiled Bazel, version 0.2.1 with the following patch: https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-bazel-custom-gcc-patch\n2. Applied the following patch to TensorFlow: https://gist.github.com/akors/5db13e874c144b3b111f0e0326d7b771#file-tensorflow-custom-gcc-patch\n3. Ran ./configure with /opt/gcc-4.9/bin/gcc as compiler, but default otherwise.\n4. Ran bazel build -c opt --config=cuda --local_resources 4096,3.0,1.0 -j 4 //tensorflow/cc:tutorials_example_trainer --verbose_failures\n### What have you tried?\n1. I cried a lot.\n2. Add `linker_flag: \"-L/usr/local/cuda/lib64\"` to `third_party/gpus/crosstool/CROSSTOOL`\n3. Add `linker_flag: \"-Wl,-R/usr/local/cuda/lib64\"`  to `third_party/gpus/crosstool/CROSSTOOL`\n4. Recompile bazel, with added `linker_flag: \"-Wl,-R/usr/local/cuda/lib64\"` in `tools/cpp/CROSSTOOL`\n5. Create a file `/etc/ld.so.conf.d/LOCAL_cuda-lib64.conf` with the contents `/usr/local/cuda/lib64` and ran `ldconfig`\n### Logs or other output that would be helpful\n\nHere's the full output of the last operation:\n\n```\nERROR: /home/alexander/.local/src/tensorflow/tensorflow/cc/BUILD:28:1: Executing genrule //tensorflow/cc:random_ops_genrule failed: namespace-sandbox failed: error executing command \n  (cd /home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow && \\\n  exec env - \\\n    PATH=/usr/lib/ccache:/usr/lib/ccache:/usr/lib64/qt-3.3/bin:/usr/lib64/ccache:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/alexander/.local/bin:/home/alexander/bin:/home/alexander/.local/bin:/home/alexander/bin \\\n  /home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow/_bin/namespace-sandbox @/home/alexander/.cache/bazel/_bazel_alexander/3fc3a90944d6c7fe99106d6e515412c7/tensorflow/bazel-sandbox/7d27406c-6595-46a2-a8dc-b7faf7c28c88-0.params -- /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc bazel-out/local_linux-opt/genfiles/tensorflow/cc/ops/random_ops.h bazel-out/local_linux-opt/genfiles/tensorflow/cc/ops/random_ops.cc 0').\nbazel-out/host/bin/tensorflow/cc/ops/random_ops_gen_cc: error while loading shared libraries: libcudart.so.7.5: cannot open shared object file: No such file or directory\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\nINFO: Elapsed time: 630.365s, Critical Path: 137.07s\n```\n\nps.: Out of curiosity, what are you TensorFlow devs using for a development machine? Has any of you actually tried using a modern Linux distribution that comes with GCC newer than 4.9 for compilation? You really should. It's quite the experience.\n"}