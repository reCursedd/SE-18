{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10009", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10009/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10009/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10009/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10009", "id": 229722919, "node_id": "MDU6SXNzdWUyMjk3MjI5MTk=", "number": 10009, "title": "Problems with `raw_rnn` with dynamic dimensions", "user": {"login": "petrux", "id": 401919, "node_id": "MDQ6VXNlcjQwMTkxOQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/401919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrux", "html_url": "https://github.com/petrux", "followers_url": "https://api.github.com/users/petrux/followers", "following_url": "https://api.github.com/users/petrux/following{/other_user}", "gists_url": "https://api.github.com/users/petrux/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrux/subscriptions", "organizations_url": "https://api.github.com/users/petrux/orgs", "repos_url": "https://api.github.com/users/petrux/repos", "events_url": "https://api.github.com/users/petrux/events{/privacy}", "received_events_url": "https://api.github.com/users/petrux/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-18T15:52:44Z", "updated_at": "2017-05-25T16:27:09Z", "closed_at": "2017-05-25T16:27:00Z", "author_association": "NONE", "body_html": "<p>I am trying to implement the <a href=\"https://arxiv.org/abs/1603.08148\" rel=\"nofollow\">pointing softmax</a> in TF 1.1 and I am using <code>raw_rnn</code> but I get an error. Since is hard to explain the whole thing, here is how to reproduce it:</p>\n<div class=\"highlight highlight-source-shell\"><pre>$ git clone https://github.com/petrux/LiTeFlow.git\n$ <span class=\"pl-c1\">cd</span> LiTeFlow\n$ git checkout broken\n$ ./bin/py3venv.sh\n$ <span class=\"pl-c1\">source</span> .py3venv/bin/activate\n$ python3 -m unittest liteflow.tests.test_layers._TestSmoke</pre></div>\n<p>the error that I have is:</p>\n<div class=\"highlight highlight-source-shell\"><pre>petrux@orion:<span class=\"pl-k\">~</span>/Projects/LiTeFlow$ python3 -m unittest liteflow.tests.test_layers._TestSmoke\n./usr/local/lib/python3.5/dist-packages/tensorflow/python/util/deprecation.py:212: DeprecationWarning: <span class=\"pl-en\">inspect.getargspec</span>() is deprecated, use <span class=\"pl-en\">inspect.signature</span>() instead\n  arg_spec = inspect.getargspec(func)\n/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/keras/python/keras/backend.py:3593: ResourceWarning: unclosed file <span class=\"pl-k\">&lt;</span>_io.TextIOWrapper name=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/home/petrux/.keras/keras.json<span class=\"pl-pds\">'</span></span> mode=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>r<span class=\"pl-pds\">'</span></span> encoding=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>UTF-8<span class=\"pl-pds\">'</span></span><span class=\"pl-k\">&gt;</span>\n  _config = json.load(open(_config_path))\n/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/labeled_tensor/python/ops/_typecheck.py:233: DeprecationWarning: <span class=\"pl-en\">inspect.getargspec</span>() is deprecated, use <span class=\"pl-en\">inspect.signature</span>() instead\n  spec = inspect.getargspec(f)\nelements_finished: Tensor(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>PointingDecoder_1_1/rnn/GreaterEqual:0<span class=\"pl-pds\">\"</span></span>, shape=(<span class=\"pl-k\">?</span>,), dtype=bool)\nnext_cell_input: Tensor(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>PointingDecoder_1_1/rnn/concat:0<span class=\"pl-pds\">\"</span></span>, shape=(<span class=\"pl-k\">?</span>, <span class=\"pl-k\">?</span>), dtype=float32)\nnext_cell_state: Tensor(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>GRUCellZeroState/zeros:0<span class=\"pl-pds\">\"</span></span>, shape=(<span class=\"pl-k\">?</span>, 5), dtype=float32)\nemit_output: Tensor(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>zeros:0<span class=\"pl-pds\">\"</span></span>, shape=(<span class=\"pl-k\">?</span>, <span class=\"pl-k\">?</span>), dtype=float32)\nnext_loop_state: (<span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>PointingDecoder_1_1/rnn/LocationSoftmax_1/softmax/truediv:0<span class=\"pl-pds\">'</span></span> shape=(<span class=\"pl-k\">?</span>, <span class=\"pl-k\">?</span>) dtype=float<span class=\"pl-k\">32&gt;</span>, <span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>PointingDecoder_1_1/rnn/LocationSoftmax_1/Sum:0<span class=\"pl-pds\">'</span></span> shape=(<span class=\"pl-k\">?</span>, 4) dtype=float<span class=\"pl-k\">32&gt;</span>)\n\nE\n======================================================================\nERROR: test_smoke (liteflow.tests.test_layers._TestSmoke)\nBuild a pointer decoder and <span class=\"pl-c1\">test</span> that it works.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py<span class=\"pl-pds\">\"</span></span>, line 1356, <span class=\"pl-k\">in</span> zeros\n    shape = tensor_shape.as_shape(shape)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py<span class=\"pl-pds\">\"</span></span>, line 800, <span class=\"pl-k\">in</span> as_shape\n    <span class=\"pl-k\">return</span> TensorShape(shape)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py<span class=\"pl-pds\">\"</span></span>, line 436, <span class=\"pl-k\">in</span> __init__\n    self._dims = [as_dimension(d) <span class=\"pl-k\">for</span> <span class=\"pl-smi\">d</span> <span class=\"pl-k\">in</span> dims_iter]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py<span class=\"pl-pds\">\"</span></span>, line 436, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>listcomp<span class=\"pl-k\">&gt;</span>\n    self._dims = [as_dimension(d) <span class=\"pl-k\">for</span> <span class=\"pl-smi\">d</span> <span class=\"pl-k\">in</span> dims_iter]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py<span class=\"pl-pds\">\"</span></span>, line 378, <span class=\"pl-k\">in</span> as_dimension\n    <span class=\"pl-k\">return</span> Dimension(value)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py<span class=\"pl-pds\">\"</span></span>, line 33, <span class=\"pl-k\">in</span> __init__\n    self._value = int(value)\nTypeError: <span class=\"pl-en\">int</span>() argument must be a string, a bytes-like object or a number, not <span class=\"pl-s\"><span class=\"pl-pds\">'</span>Tensor<span class=\"pl-pds\">'</span></span>\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/petrux/Projects/LiTeFlow/liteflow/tests/test_layers.py<span class=\"pl-pds\">\"</span></span>, line 518, <span class=\"pl-k\">in</span> test_smoke\n    output = <span class=\"pl-en\">decoder</span>()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/petrux/Projects/LiTeFlow/liteflow/layers.py<span class=\"pl-pds\">\"</span></span>, line 616, <span class=\"pl-k\">in</span> __call__\n    <span class=\"pl-k\">return</span> super(PointingDecoder, <span class=\"pl-en\">self).__call__</span>()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/petrux/Projects/LiTeFlow/liteflow/layers.py<span class=\"pl-pds\">\"</span></span>, line 147, <span class=\"pl-k\">in</span> __call__\n    result = self._call_helper(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/home/petrux/Projects/LiTeFlow/liteflow/layers.py<span class=\"pl-pds\">\"</span></span>, line 610, <span class=\"pl-k\">in</span> _call_helper\n    outputs_ta, _, _ = tf.nn.raw_rnn(self._decoder_cell, self._loop_fn)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/rnn.py<span class=\"pl-pds\">\"</span></span>, line 965, <span class=\"pl-k\">in</span> raw_rnn\n    <span class=\"pl-k\">for</span> <span class=\"pl-smi\">size_i, dtype_i</span> <span class=\"pl-k\">in</span> zip(flat_emit_size, flat_emit_dtypes)]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/rnn.py<span class=\"pl-pds\">\"</span></span>, line 965, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>listcomp<span class=\"pl-k\">&gt;</span>\n    <span class=\"pl-k\">for</span> <span class=\"pl-smi\">size_i, dtype_i</span> <span class=\"pl-k\">in</span> zip(flat_emit_size, flat_emit_dtypes)]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py<span class=\"pl-pds\">\"</span></span>, line 1359, <span class=\"pl-k\">in</span> zeros\n    shape = ops.convert_to_tensor(shape, dtype=dtypes.int32, name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>shape<span class=\"pl-pds\">\"</span></span>)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py<span class=\"pl-pds\">\"</span></span>, line 639, <span class=\"pl-k\">in</span> convert_to_tensor\n    as_ref=False)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py<span class=\"pl-pds\">\"</span></span>, line 704, <span class=\"pl-k\">in</span> internal_convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py<span class=\"pl-pds\">\"</span></span>, line 905, <span class=\"pl-k\">in</span> _autopacking_conversion_function\n    <span class=\"pl-k\">return</span> _autopacking_helper(v, inferred_dtype, name or <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>packed<span class=\"pl-pds\">\"</span></span>)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py<span class=\"pl-pds\">\"</span></span>, line 867, <span class=\"pl-k\">in</span> _autopacking_helper\n    constant_op.constant(elem, dtype=dtype, name=str(i)))\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/constant_op.py<span class=\"pl-pds\">\"</span></span>, line 102, <span class=\"pl-k\">in</span> constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_util.py<span class=\"pl-pds\">\"</span></span>, line 360, <span class=\"pl-k\">in</span> make_tensor_proto\n    raise ValueError(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>None values not supported.<span class=\"pl-pds\">\"</span></span>)\nValueError: None values not supported.\n\n----------------------------------------------------------------------\nRan 2 tests <span class=\"pl-k\">in</span> 0.430s\n\nFAILED (errors=1)</pre></div>\n<p><strong>EDIT</strong> a working implementation is <a href=\"https://github.com/petrux/LiTeFlow/tree/pointing-decoder/liteflow\">here</a>.</p>", "body_text": "I am trying to implement the pointing softmax in TF 1.1 and I am using raw_rnn but I get an error. Since is hard to explain the whole thing, here is how to reproduce it:\n$ git clone https://github.com/petrux/LiTeFlow.git\n$ cd LiTeFlow\n$ git checkout broken\n$ ./bin/py3venv.sh\n$ source .py3venv/bin/activate\n$ python3 -m unittest liteflow.tests.test_layers._TestSmoke\nthe error that I have is:\npetrux@orion:~/Projects/LiTeFlow$ python3 -m unittest liteflow.tests.test_layers._TestSmoke\n./usr/local/lib/python3.5/dist-packages/tensorflow/python/util/deprecation.py:212: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead\n  arg_spec = inspect.getargspec(func)\n/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/keras/python/keras/backend.py:3593: ResourceWarning: unclosed file <_io.TextIOWrapper name='/home/petrux/.keras/keras.json' mode='r' encoding='UTF-8'>\n  _config = json.load(open(_config_path))\n/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/labeled_tensor/python/ops/_typecheck.py:233: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead\n  spec = inspect.getargspec(f)\nelements_finished: Tensor(\"PointingDecoder_1_1/rnn/GreaterEqual:0\", shape=(?,), dtype=bool)\nnext_cell_input: Tensor(\"PointingDecoder_1_1/rnn/concat:0\", shape=(?, ?), dtype=float32)\nnext_cell_state: Tensor(\"GRUCellZeroState/zeros:0\", shape=(?, 5), dtype=float32)\nemit_output: Tensor(\"zeros:0\", shape=(?, ?), dtype=float32)\nnext_loop_state: (<tf.Tensor 'PointingDecoder_1_1/rnn/LocationSoftmax_1/softmax/truediv:0' shape=(?, ?) dtype=float32>, <tf.Tensor 'PointingDecoder_1_1/rnn/LocationSoftmax_1/Sum:0' shape=(?, 4) dtype=float32>)\n\nE\n======================================================================\nERROR: test_smoke (liteflow.tests.test_layers._TestSmoke)\nBuild a pointer decoder and test that it works.\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 1356, in zeros\n    shape = tensor_shape.as_shape(shape)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 800, in as_shape\n    return TensorShape(shape)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 436, in __init__\n    self._dims = [as_dimension(d) for d in dims_iter]\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 436, in <listcomp>\n    self._dims = [as_dimension(d) for d in dims_iter]\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 378, in as_dimension\n    return Dimension(value)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 33, in __init__\n    self._value = int(value)\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'Tensor'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/tests/test_layers.py\", line 518, in test_smoke\n    output = decoder()\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/layers.py\", line 616, in __call__\n    return super(PointingDecoder, self).__call__()\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/layers.py\", line 147, in __call__\n    result = self._call_helper(*args, **kwargs)\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/layers.py\", line 610, in _call_helper\n    outputs_ta, _, _ = tf.nn.raw_rnn(self._decoder_cell, self._loop_fn)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/rnn.py\", line 965, in raw_rnn\n    for size_i, dtype_i in zip(flat_emit_size, flat_emit_dtypes)]\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/rnn.py\", line 965, in <listcomp>\n    for size_i, dtype_i in zip(flat_emit_size, flat_emit_dtypes)]\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 1359, in zeros\n    shape = ops.convert_to_tensor(shape, dtype=dtypes.int32, name=\"shape\")\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 639, in convert_to_tensor\n    as_ref=False)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 704, in internal_convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 905, in _autopacking_conversion_function\n    return _autopacking_helper(v, inferred_dtype, name or \"packed\")\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 867, in _autopacking_helper\n    constant_op.constant(elem, dtype=dtype, name=str(i)))\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/constant_op.py\", line 102, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_util.py\", line 360, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")\nValueError: None values not supported.\n\n----------------------------------------------------------------------\nRan 2 tests in 0.430s\n\nFAILED (errors=1)\nEDIT a working implementation is here.", "body": "I am trying to implement the [pointing softmax](https://arxiv.org/abs/1603.08148) in TF 1.1 and I am using `raw_rnn` but I get an error. Since is hard to explain the whole thing, here is how to reproduce it:\r\n\r\n```bash\r\n$ git clone https://github.com/petrux/LiTeFlow.git\r\n$ cd LiTeFlow\r\n$ git checkout broken\r\n$ ./bin/py3venv.sh\r\n$ source .py3venv/bin/activate\r\n$ python3 -m unittest liteflow.tests.test_layers._TestSmoke\r\n```\r\nthe error that I have is:\r\n\r\n```bash\r\npetrux@orion:~/Projects/LiTeFlow$ python3 -m unittest liteflow.tests.test_layers._TestSmoke\r\n./usr/local/lib/python3.5/dist-packages/tensorflow/python/util/deprecation.py:212: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead\r\n  arg_spec = inspect.getargspec(func)\r\n/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/keras/python/keras/backend.py:3593: ResourceWarning: unclosed file <_io.TextIOWrapper name='/home/petrux/.keras/keras.json' mode='r' encoding='UTF-8'>\r\n  _config = json.load(open(_config_path))\r\n/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/labeled_tensor/python/ops/_typecheck.py:233: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead\r\n  spec = inspect.getargspec(f)\r\nelements_finished: Tensor(\"PointingDecoder_1_1/rnn/GreaterEqual:0\", shape=(?,), dtype=bool)\r\nnext_cell_input: Tensor(\"PointingDecoder_1_1/rnn/concat:0\", shape=(?, ?), dtype=float32)\r\nnext_cell_state: Tensor(\"GRUCellZeroState/zeros:0\", shape=(?, 5), dtype=float32)\r\nemit_output: Tensor(\"zeros:0\", shape=(?, ?), dtype=float32)\r\nnext_loop_state: (<tf.Tensor 'PointingDecoder_1_1/rnn/LocationSoftmax_1/softmax/truediv:0' shape=(?, ?) dtype=float32>, <tf.Tensor 'PointingDecoder_1_1/rnn/LocationSoftmax_1/Sum:0' shape=(?, 4) dtype=float32>)\r\n\r\nE\r\n======================================================================\r\nERROR: test_smoke (liteflow.tests.test_layers._TestSmoke)\r\nBuild a pointer decoder and test that it works.\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 1356, in zeros\r\n    shape = tensor_shape.as_shape(shape)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 800, in as_shape\r\n    return TensorShape(shape)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 436, in __init__\r\n    self._dims = [as_dimension(d) for d in dims_iter]\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 436, in <listcomp>\r\n    self._dims = [as_dimension(d) for d in dims_iter]\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 378, in as_dimension\r\n    return Dimension(value)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 33, in __init__\r\n    self._value = int(value)\r\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'Tensor'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/tests/test_layers.py\", line 518, in test_smoke\r\n    output = decoder()\r\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/layers.py\", line 616, in __call__\r\n    return super(PointingDecoder, self).__call__()\r\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/layers.py\", line 147, in __call__\r\n    result = self._call_helper(*args, **kwargs)\r\n  File \"/home/petrux/Projects/LiTeFlow/liteflow/layers.py\", line 610, in _call_helper\r\n    outputs_ta, _, _ = tf.nn.raw_rnn(self._decoder_cell, self._loop_fn)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/rnn.py\", line 965, in raw_rnn\r\n    for size_i, dtype_i in zip(flat_emit_size, flat_emit_dtypes)]\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/rnn.py\", line 965, in <listcomp>\r\n    for size_i, dtype_i in zip(flat_emit_size, flat_emit_dtypes)]\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 1359, in zeros\r\n    shape = ops.convert_to_tensor(shape, dtype=dtypes.int32, name=\"shape\")\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 639, in convert_to_tensor\r\n    as_ref=False)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 704, in internal_convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 905, in _autopacking_conversion_function\r\n    return _autopacking_helper(v, inferred_dtype, name or \"packed\")\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 867, in _autopacking_helper\r\n    constant_op.constant(elem, dtype=dtype, name=str(i)))\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/constant_op.py\", line 102, in constant\r\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_util.py\", line 360, in make_tensor_proto\r\n    raise ValueError(\"None values not supported.\")\r\nValueError: None values not supported.\r\n\r\n----------------------------------------------------------------------\r\nRan 2 tests in 0.430s\r\n\r\nFAILED (errors=1)\r\n```  \r\n  \r\n**EDIT** a working implementation is [here](https://github.com/petrux/LiTeFlow/tree/pointing-decoder/liteflow)."}