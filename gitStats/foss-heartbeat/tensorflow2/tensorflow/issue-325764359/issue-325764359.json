{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19501", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19501/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19501/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19501/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19501", "id": 325764359, "node_id": "MDU6SXNzdWUzMjU3NjQzNTk=", "number": 19501, "title": "Tensorflow Estimator API doesn't work in distributed mode", "user": {"login": "gravitywp", "id": 8477504, "node_id": "MDQ6VXNlcjg0Nzc1MDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/8477504?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gravitywp", "html_url": "https://github.com/gravitywp", "followers_url": "https://api.github.com/users/gravitywp/followers", "following_url": "https://api.github.com/users/gravitywp/following{/other_user}", "gists_url": "https://api.github.com/users/gravitywp/gists{/gist_id}", "starred_url": "https://api.github.com/users/gravitywp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gravitywp/subscriptions", "organizations_url": "https://api.github.com/users/gravitywp/orgs", "repos_url": "https://api.github.com/users/gravitywp/repos", "events_url": "https://api.github.com/users/gravitywp/events{/privacy}", "received_events_url": "https://api.github.com/users/gravitywp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-05-23T15:40:20Z", "updated_at": "2018-11-16T18:39:17Z", "closed_at": "2018-07-19T08:51:55Z", "author_association": "NONE", "body_html": "<p>here is my test code</p>\n<pre><code>from tensorflow.python.keras.layers import Conv1D, MaxPooling1D\nfrom tensorflow.python.keras.models import Model\nimport logging\nlevel = logging.getLevelName('INFO')\nlogging.getLogger().setLevel(level)\nmodel = tf.keras.Sequential()\noutput = Dense(2, activation=\"softmax\")\nmodel.add(Dense(64, activation=\"relu\", input_shape=(10,)))\nmodel.add(output)\nmodel.compile('rmsprop', 'categorical_crossentropy')\nest_model = tf.keras.estimator.model_to_estimator(keras_model=model)\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(\n        x={\"dense_2_input\": np.random.randint(10, size=(320, 10))},\n        y=np.random.rand(320, 2),\n        num_epochs=10000,\n        shuffle=False)\nest_model.train(train_input_fn)\n</code></pre>\n<p>My TF_CONFIG is like is</p>\n<pre><code>TF_CONFIG={\n\"cluster\": {\"chief\": [\"localhost:2223\"], \n\"worker\": [\"localhost:2221\"], \n\"ps\": [\"lcoalhost:2222\"]}, \n\"task\": {\"index\": \"0\", \"type\": \"chief\"}\n}\n</code></pre>\n<p>The chief is stuck on logging<br>\n<code>INFO:tensorflow:Restoring parameters from /tmp/tmpe_c82nqn/keras_model.ckpt</code><br>\nand no ports is listening.<br>\nMaybe I can't simulate cluster in local?</p>\n<p>When I using strace to found out why? I saw a lots<br>\n<code>[pid 16719] futex(0x7f4c39cab604, FUTEX_WAIT_BITSET_PRIVATE, 850, {4401792, 658466075}, ffffffff) = -1 ETIMEDOUT (Connection timed out)</code></p>\n<p>Without TF_CONFIG set, the code is working fine.</p>\n<p>Any suggestion?</p>", "body_text": "here is my test code\nfrom tensorflow.python.keras.layers import Conv1D, MaxPooling1D\nfrom tensorflow.python.keras.models import Model\nimport logging\nlevel = logging.getLevelName('INFO')\nlogging.getLogger().setLevel(level)\nmodel = tf.keras.Sequential()\noutput = Dense(2, activation=\"softmax\")\nmodel.add(Dense(64, activation=\"relu\", input_shape=(10,)))\nmodel.add(output)\nmodel.compile('rmsprop', 'categorical_crossentropy')\nest_model = tf.keras.estimator.model_to_estimator(keras_model=model)\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(\n        x={\"dense_2_input\": np.random.randint(10, size=(320, 10))},\n        y=np.random.rand(320, 2),\n        num_epochs=10000,\n        shuffle=False)\nest_model.train(train_input_fn)\n\nMy TF_CONFIG is like is\nTF_CONFIG={\n\"cluster\": {\"chief\": [\"localhost:2223\"], \n\"worker\": [\"localhost:2221\"], \n\"ps\": [\"lcoalhost:2222\"]}, \n\"task\": {\"index\": \"0\", \"type\": \"chief\"}\n}\n\nThe chief is stuck on logging\nINFO:tensorflow:Restoring parameters from /tmp/tmpe_c82nqn/keras_model.ckpt\nand no ports is listening.\nMaybe I can't simulate cluster in local?\nWhen I using strace to found out why? I saw a lots\n[pid 16719] futex(0x7f4c39cab604, FUTEX_WAIT_BITSET_PRIVATE, 850, {4401792, 658466075}, ffffffff) = -1 ETIMEDOUT (Connection timed out)\nWithout TF_CONFIG set, the code is working fine.\nAny suggestion?", "body": "here is my test code \r\n\r\n```\r\nfrom tensorflow.python.keras.layers import Conv1D, MaxPooling1D\r\nfrom tensorflow.python.keras.models import Model\r\nimport logging\r\nlevel = logging.getLevelName('INFO')\r\nlogging.getLogger().setLevel(level)\r\nmodel = tf.keras.Sequential()\r\noutput = Dense(2, activation=\"softmax\")\r\nmodel.add(Dense(64, activation=\"relu\", input_shape=(10,)))\r\nmodel.add(output)\r\nmodel.compile('rmsprop', 'categorical_crossentropy')\r\nest_model = tf.keras.estimator.model_to_estimator(keras_model=model)\r\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(\r\n        x={\"dense_2_input\": np.random.randint(10, size=(320, 10))},\r\n        y=np.random.rand(320, 2),\r\n        num_epochs=10000,\r\n        shuffle=False)\r\nest_model.train(train_input_fn)\r\n```\r\n\r\nMy TF_CONFIG is like is\r\n```\r\nTF_CONFIG={\r\n\"cluster\": {\"chief\": [\"localhost:2223\"], \r\n\"worker\": [\"localhost:2221\"], \r\n\"ps\": [\"lcoalhost:2222\"]}, \r\n\"task\": {\"index\": \"0\", \"type\": \"chief\"}\r\n}\r\n```\r\n\r\nThe chief is stuck on logging \r\n`INFO:tensorflow:Restoring parameters from /tmp/tmpe_c82nqn/keras_model.ckpt` \r\nand no ports is listening.\r\nMaybe I can't simulate cluster in local? \r\n\r\nWhen I using strace to found out why? I saw a lots \r\n`[pid 16719] futex(0x7f4c39cab604, FUTEX_WAIT_BITSET_PRIVATE, 850, {4401792, 658466075}, ffffffff) = -1 ETIMEDOUT (Connection timed out)`\r\n\r\nWithout TF_CONFIG set, the code is working fine.\r\n\r\nAny suggestion? "}