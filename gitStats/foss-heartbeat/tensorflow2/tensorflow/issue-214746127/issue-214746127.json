{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8471", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8471/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8471/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8471/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8471", "id": 214746127, "node_id": "MDU6SXNzdWUyMTQ3NDYxMjc=", "number": 8471, "title": "InvalidArgumentError (traceback): BiasGrad requires tensor size <= int32 max in 3D CNN, Tensorflow", "user": {"login": "suchetasu", "id": 26463903, "node_id": "MDQ6VXNlcjI2NDYzOTAz", "avatar_url": "https://avatars0.githubusercontent.com/u/26463903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suchetasu", "html_url": "https://github.com/suchetasu", "followers_url": "https://api.github.com/users/suchetasu/followers", "following_url": "https://api.github.com/users/suchetasu/following{/other_user}", "gists_url": "https://api.github.com/users/suchetasu/gists{/gist_id}", "starred_url": "https://api.github.com/users/suchetasu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suchetasu/subscriptions", "organizations_url": "https://api.github.com/users/suchetasu/orgs", "repos_url": "https://api.github.com/users/suchetasu/repos", "events_url": "https://api.github.com/users/suchetasu/events{/privacy}", "received_events_url": "https://api.github.com/users/suchetasu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-03-16T15:37:09Z", "updated_at": "2017-04-08T07:12:20Z", "closed_at": "2017-04-08T07:12:20Z", "author_association": "NONE", "body_html": "<p>I am using 3D CNN model in tensorflow. My input image dimension is 3D i.e. (192 * 256 * 256) with one color channel image and i have used three Convolutional layers (with patches of 5 * 5 * 5) and 3 pooling layers (kernal size : 3 * 3 * 3 and stride : 2 * 2 * 2), one full-connection-layer with 128 nodes and output layer with two nodes. The number of samples are 120 for training. Batch size : 10</p>\n<p>I am facing the below error on the cluster:</p>\n<p>W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.<br>\nTraceback (most recent call last):<br>\nFile \"./mri_cnn.py\", line 362, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"./mri_cnn.py\", line 332, in main<br>\nsess.run(optimizer, feed_dict={train_data_node: batch_data,train_labels_node: batch_labels})<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: BiasGrad requires tensor size &lt;= int32 max<br>\n[[Node: gradients/BiasAdd_grad/BiasAddGrad = BiasAddGrad<a href=\"gradients/Relu_grad/ReluGrad\">T=DT_FLOAT, data_format=\"NHWC\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]</p>\n<p>Caused by op u'gradients/BiasAdd_grad/BiasAddGrad', defined at:<br>\nFile \"./mri_cnn.py\", line 362, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"./mri_cnn.py\", line 290, in main<br>\noptimizer = tf.train.AdamOptimizer(learning_rate=0.0).minimize(train_loss) # Adam Optimizer<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 288, in minimize<br>\ngrad_loss=grad_loss)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 354, in compute_gradients<br>\ncolocate_gradients_with_ops=colocate_gradients_with_ops)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients_impl.py\", line 482, in gradients<br>\nin_grads = grad_fn(op, *out_grads)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 204, in _BiasAddGrad<br>\ndata_format=data_format))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 313, in bias_add_grad<br>\ndata_format=data_format, name=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1264, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>...which was originally created as op u'BiasAdd', defined at:<br>\nFile \"./mri_cnn.py\", line 362, in <br>\ntf.app.run()<br>\n[elided 0 identical lines from previous traceback]<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"./mri_cnn.py\", line 272, in main<br>\ntrain_prediction = model(train_data_node, True)<br>\nFile \"./mri_cnn.py\", line 181, in model<br>\nrelu = tf.nn.relu(tf.nn.bias_add(conv, conv1_biases))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 1316, in bias_add<br>\nreturn gen_nn_ops._bias_add(value, bias, data_format=data_format, name=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 281, in _bias_add<br>\ndata_format=data_format, name=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1264, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): BiasGrad requires tensor size &lt;= int32 max<br>\n[[Node: gradients/BiasAdd_grad/BiasAddGrad = BiasAddGrad<a href=\"gradients/Relu_grad/ReluGrad\">T=DT_FLOAT, data_format=\"NHWC\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]</p>\n<p>Please suggest, how to fix it?</p>", "body_text": "I am using 3D CNN model in tensorflow. My input image dimension is 3D i.e. (192 * 256 * 256) with one color channel image and i have used three Convolutional layers (with patches of 5 * 5 * 5) and 3 pooling layers (kernal size : 3 * 3 * 3 and stride : 2 * 2 * 2), one full-connection-layer with 128 nodes and output layer with two nodes. The number of samples are 120 for training. Batch size : 10\nI am facing the below error on the cluster:\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\nTraceback (most recent call last):\nFile \"./mri_cnn.py\", line 362, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"./mri_cnn.py\", line 332, in main\nsess.run(optimizer, feed_dict={train_data_node: batch_data,train_labels_node: batch_labels})\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\ntarget_list, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: BiasGrad requires tensor size <= int32 max\n[[Node: gradients/BiasAdd_grad/BiasAddGrad = BiasAddGradT=DT_FLOAT, data_format=\"NHWC\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nCaused by op u'gradients/BiasAdd_grad/BiasAddGrad', defined at:\nFile \"./mri_cnn.py\", line 362, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"./mri_cnn.py\", line 290, in main\noptimizer = tf.train.AdamOptimizer(learning_rate=0.0).minimize(train_loss) # Adam Optimizer\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 288, in minimize\ngrad_loss=grad_loss)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 354, in compute_gradients\ncolocate_gradients_with_ops=colocate_gradients_with_ops)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients_impl.py\", line 482, in gradients\nin_grads = grad_fn(op, *out_grads)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 204, in _BiasAddGrad\ndata_format=data_format))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 313, in bias_add_grad\ndata_format=data_format, name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\nop_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1264, in init\nself._traceback = _extract_stack()\n...which was originally created as op u'BiasAdd', defined at:\nFile \"./mri_cnn.py\", line 362, in \ntf.app.run()\n[elided 0 identical lines from previous traceback]\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"./mri_cnn.py\", line 272, in main\ntrain_prediction = model(train_data_node, True)\nFile \"./mri_cnn.py\", line 181, in model\nrelu = tf.nn.relu(tf.nn.bias_add(conv, conv1_biases))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 1316, in bias_add\nreturn gen_nn_ops._bias_add(value, bias, data_format=data_format, name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 281, in _bias_add\ndata_format=data_format, name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\nop_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1264, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): BiasGrad requires tensor size <= int32 max\n[[Node: gradients/BiasAdd_grad/BiasAddGrad = BiasAddGradT=DT_FLOAT, data_format=\"NHWC\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nPlease suggest, how to fix it?", "body": "I am using 3D CNN model in tensorflow. My input image dimension is 3D i.e. (192 * 256 * 256) with one color channel image and i have used three Convolutional layers (with patches of 5 * 5 * 5) and 3 pooling layers (kernal size : 3 * 3 * 3 and stride : 2 * 2 * 2), one full-connection-layer with 128 nodes and output layer with two nodes. The number of samples are 120 for training. Batch size : 10\r\n\r\nI am facing the below error on the cluster:\r\n\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\r\nTraceback (most recent call last):\r\n  File \"./mri_cnn.py\", line 362, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"./mri_cnn.py\", line 332, in main\r\n    sess.run(optimizer, feed_dict={train_data_node: batch_data,train_labels_node: batch_labels})\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: BiasGrad requires tensor size <= int32 max\r\n         [[Node: gradients/BiasAdd_grad/BiasAddGrad = BiasAddGrad[T=DT_FLOAT, data_format=\"NHWC\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](gradients/Relu_grad/ReluGrad)]]\r\n\r\nCaused by op u'gradients/BiasAdd_grad/BiasAddGrad', defined at:\r\n  File \"./mri_cnn.py\", line 362, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"./mri_cnn.py\", line 290, in main\r\n    optimizer = tf.train.AdamOptimizer(learning_rate=0.0).minimize(train_loss) # Adam Optimizer\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 288, in minimize\r\n    grad_loss=grad_loss)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 354, in compute_gradients\r\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients_impl.py\", line 482, in gradients\r\n    in_grads = grad_fn(op, *out_grads)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 204, in _BiasAddGrad\r\n    data_format=data_format))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 313, in bias_add_grad\r\n    data_format=data_format, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1264, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\n...which was originally created as op u'BiasAdd', defined at:\r\n  File \"./mri_cnn.py\", line 362, in <module>\r\n    tf.app.run()\r\n[elided 0 identical lines from previous traceback]\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 44, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"./mri_cnn.py\", line 272, in main\r\n    train_prediction = model(train_data_node, True)\r\n  File \"./mri_cnn.py\", line 181, in model\r\n    relu = tf.nn.relu(tf.nn.bias_add(conv, conv1_biases))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 1316, in bias_add\r\n    return gen_nn_ops._bias_add(value, bias, data_format=data_format, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 281, in _bias_add\r\n    data_format=data_format, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1264, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): BiasGrad requires tensor size <= int32 max\r\n         [[Node: gradients/BiasAdd_grad/BiasAddGrad = BiasAddGrad[T=DT_FLOAT, data_format=\"NHWC\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](gradients/Relu_grad/ReluGrad)]]\r\n\r\nPlease suggest, how to fix it?"}