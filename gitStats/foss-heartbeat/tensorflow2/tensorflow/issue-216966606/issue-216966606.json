{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8710", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8710/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8710/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8710/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8710", "id": 216966606, "node_id": "MDU6SXNzdWUyMTY5NjY2MDY=", "number": 8710, "title": "Random crashing in c2c fft", "user": {"login": "Timeroot", "id": 568733, "node_id": "MDQ6VXNlcjU2ODczMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/568733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Timeroot", "html_url": "https://github.com/Timeroot", "followers_url": "https://api.github.com/users/Timeroot/followers", "following_url": "https://api.github.com/users/Timeroot/following{/other_user}", "gists_url": "https://api.github.com/users/Timeroot/gists{/gist_id}", "starred_url": "https://api.github.com/users/Timeroot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Timeroot/subscriptions", "organizations_url": "https://api.github.com/users/Timeroot/orgs", "repos_url": "https://api.github.com/users/Timeroot/repos", "events_url": "https://api.github.com/users/Timeroot/events{/privacy}", "received_events_url": "https://api.github.com/users/Timeroot/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-03-25T10:56:53Z", "updated_at": "2017-03-28T23:08:59Z", "closed_at": "2017-03-28T23:08:59Z", "author_association": "NONE", "body_html": "<p>I'm having issues with the c2c fft. I would think this was more an issue with my code except that it seems to be non-deterministic. As a result I'm having a hard time getting a minimal example. I'm working on a recurrent neural net, in which the recurrent cell involves an fft (and an ifft), and the crash seems to occur more often as I increase the depth (number of recurrent cells chained together), or as I increase the size of the tensor being fft'd. The problem doesn't seem to scale with the product of these two, though, so I don't immediately think it's a memory issue: rather, it happens only if both are above some sort of weak cutoffs. (40 and 80 causes problems for me consistently.) This is on a GPU with 1.7GB of memory, and not much else in the computation graph, so I don't think I'm hitting constraints there. It's also very odd that the error is so random: I can typically run through 100 batches (each of 1 element) before it crashes, although this number seems random. I find the error message pretty inscrutable -- it reads:</p>\n<pre><code>E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_fft.cc:169] failed to create cuFFT batched plan:2\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_fft.cc:111] failed to run cuFFT routine cufftSetStream: 1\nTraceback (most recent call last):\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1022, in _do_call\n    return fn(*args)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1004, in _run_fn\n    status, run_metadata)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: c2c fft failed : in.shape=[2,110]\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"stacknn_test.py\", line 300, in &lt;module&gt;\n    results = sess.run([merged, loss], feed_dict={xs: x, y_true: y})\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: c2c fft failed : in.shape=[2,110]\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nCaused by op 'stack_wrapper_14/FFT', defined at:\n  File \"stacknn_test.py\", line 254, in &lt;module&gt;\n    (cell_output, state) = cell(inp, state)\n  File \"stacknn_test.py\", line 162, in __call__\n    tf.pad(state_stack, [[0,0], [0, self._stack_size]])\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 812, in fft\n    result = _op_def_lib.apply_op(\"FFT\", input=input, name=name)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in __init__\n    self._traceback = _extract_stack()\n\nInternalError (see above for traceback): c2c fft failed : in.shape=[2,110]\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n</code></pre>\n<p>and I could only find one stack overflow question about this: <a href=\"http://stackoverflow.com/questions/41720751/ignoring-warning-unable-to-load-cudnn-dso-effecting-fft-computation\" rel=\"nofollow\">http://stackoverflow.com/questions/41720751/ignoring-warning-unable-to-load-cudnn-dso-effecting-fft-computation</a> which ended up only getting some comment about the cudnn DSO. I don't have the cudnn DSO either, but if /that's/ what's causing this problem, I would be surprised.</p>\n<p>Using Tensorflow version 1.0.1, the Windows GPU build. Python version 3.5.3. The machine has a single GPU with compute capabilities 3.0. It has no problem loading cublas64_80.dll, cufft64_80.dll,  nvcuda.dll, and curand64_80.dll, but I don't have a cudnn dso.</p>", "body_text": "I'm having issues with the c2c fft. I would think this was more an issue with my code except that it seems to be non-deterministic. As a result I'm having a hard time getting a minimal example. I'm working on a recurrent neural net, in which the recurrent cell involves an fft (and an ifft), and the crash seems to occur more often as I increase the depth (number of recurrent cells chained together), or as I increase the size of the tensor being fft'd. The problem doesn't seem to scale with the product of these two, though, so I don't immediately think it's a memory issue: rather, it happens only if both are above some sort of weak cutoffs. (40 and 80 causes problems for me consistently.) This is on a GPU with 1.7GB of memory, and not much else in the computation graph, so I don't think I'm hitting constraints there. It's also very odd that the error is so random: I can typically run through 100 batches (each of 1 element) before it crashes, although this number seems random. I find the error message pretty inscrutable -- it reads:\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_fft.cc:169] failed to create cuFFT batched plan:2\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_fft.cc:111] failed to run cuFFT routine cufftSetStream: 1\nTraceback (most recent call last):\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1022, in _do_call\n    return fn(*args)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1004, in _run_fn\n    status, run_metadata)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: c2c fft failed : in.shape=[2,110]\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"stacknn_test.py\", line 300, in <module>\n    results = sess.run([merged, loss], feed_dict={xs: x, y_true: y})\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: c2c fft failed : in.shape=[2,110]\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nCaused by op 'stack_wrapper_14/FFT', defined at:\n  File \"stacknn_test.py\", line 254, in <module>\n    (cell_output, state) = cell(inp, state)\n  File \"stacknn_test.py\", line 162, in __call__\n    tf.pad(state_stack, [[0,0], [0, self._stack_size]])\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 812, in fft\n    result = _op_def_lib.apply_op(\"FFT\", input=input, name=name)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in __init__\n    self._traceback = _extract_stack()\n\nInternalError (see above for traceback): c2c fft failed : in.shape=[2,110]\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nand I could only find one stack overflow question about this: http://stackoverflow.com/questions/41720751/ignoring-warning-unable-to-load-cudnn-dso-effecting-fft-computation which ended up only getting some comment about the cudnn DSO. I don't have the cudnn DSO either, but if /that's/ what's causing this problem, I would be surprised.\nUsing Tensorflow version 1.0.1, the Windows GPU build. Python version 3.5.3. The machine has a single GPU with compute capabilities 3.0. It has no problem loading cublas64_80.dll, cufft64_80.dll,  nvcuda.dll, and curand64_80.dll, but I don't have a cudnn dso.", "body": "I'm having issues with the c2c fft. I would think this was more an issue with my code except that it seems to be non-deterministic. As a result I'm having a hard time getting a minimal example. I'm working on a recurrent neural net, in which the recurrent cell involves an fft (and an ifft), and the crash seems to occur more often as I increase the depth (number of recurrent cells chained together), or as I increase the size of the tensor being fft'd. The problem doesn't seem to scale with the product of these two, though, so I don't immediately think it's a memory issue: rather, it happens only if both are above some sort of weak cutoffs. (40 and 80 causes problems for me consistently.) This is on a GPU with 1.7GB of memory, and not much else in the computation graph, so I don't think I'm hitting constraints there. It's also very odd that the error is so random: I can typically run through 100 batches (each of 1 element) before it crashes, although this number seems random. I find the error message pretty inscrutable -- it reads:\r\n\r\n```\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_fft.cc:169] failed to create cuFFT batched plan:2\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_fft.cc:111] failed to run cuFFT routine cufftSetStream: 1\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1022, in _do_call\r\n    return fn(*args)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1004, in _run_fn\r\n    status, run_metadata)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\contextlib.py\", line 66, in __exit__\r\n    next(self.gen)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InternalError: c2c fft failed : in.shape=[2,110]\r\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\r\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"stacknn_test.py\", line 300, in <module>\r\n    results = sess.run([merged, loss], feed_dict={xs: x, y_true: y})\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: c2c fft failed : in.shape=[2,110]\r\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\r\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\nCaused by op 'stack_wrapper_14/FFT', defined at:\r\n  File \"stacknn_test.py\", line 254, in <module>\r\n    (cell_output, state) = cell(inp, state)\r\n  File \"stacknn_test.py\", line 162, in __call__\r\n    tf.pad(state_stack, [[0,0], [0, self._stack_size]])\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 812, in fft\r\n    result = _op_def_lib.apply_op(\"FFT\", input=input, name=name)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"C:\\Users\\Timeroot\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInternalError (see above for traceback): c2c fft failed : in.shape=[2,110]\r\n         [[Node: stack_wrapper_14/FFT = FFT[_device=\"/job:localhost/replica:0/task:0/gpu:0\"](stack_wrapper_14/Pad/_535)]]\r\n         [[Node: stack_wrapper_34/shift_exp/_1147 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_2694_stack_wrapper_34/shift_exp\", tensor_type=DT_COMPLEX64, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n```\r\n\r\nand I could only find one stack overflow question about this: http://stackoverflow.com/questions/41720751/ignoring-warning-unable-to-load-cudnn-dso-effecting-fft-computation which ended up only getting some comment about the cudnn DSO. I don't have the cudnn DSO either, but if /that's/ what's causing this problem, I would be surprised.\r\n\r\nUsing Tensorflow version 1.0.1, the Windows GPU build. Python version 3.5.3. The machine has a single GPU with compute capabilities 3.0. It has no problem loading cublas64_80.dll, cufft64_80.dll,  nvcuda.dll, and curand64_80.dll, but I don't have a cudnn dso."}