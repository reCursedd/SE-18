{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2621", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2621/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2621/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2621/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2621", "id": 158106811, "node_id": "MDU6SXNzdWUxNTgxMDY4MTE=", "number": 2621, "title": "gpu support error(sampled_loss)", "user": {"login": "yanghoonkim", "id": 9985986, "node_id": "MDQ6VXNlcjk5ODU5ODY=", "avatar_url": "https://avatars2.githubusercontent.com/u/9985986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yanghoonkim", "html_url": "https://github.com/yanghoonkim", "followers_url": "https://api.github.com/users/yanghoonkim/followers", "following_url": "https://api.github.com/users/yanghoonkim/following{/other_user}", "gists_url": "https://api.github.com/users/yanghoonkim/gists{/gist_id}", "starred_url": "https://api.github.com/users/yanghoonkim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yanghoonkim/subscriptions", "organizations_url": "https://api.github.com/users/yanghoonkim/orgs", "repos_url": "https://api.github.com/users/yanghoonkim/repos", "events_url": "https://api.github.com/users/yanghoonkim/events{/privacy}", "received_events_url": "https://api.github.com/users/yanghoonkim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-06-02T10:19:14Z", "updated_at": "2016-07-18T18:06:47Z", "closed_at": "2016-07-18T18:06:47Z", "author_association": "NONE", "body_html": "<p>I'm now a little bit hesitated that I have found a similar issue before, however I can't find it now</p>\n<p>in the file seq2seq_model.py in translate foloder, I use    with device(\"/gpu:0')     instead of cpu, there's an error like this :</p>\n<div class=\"highlight highlight-source-js\"><pre>InvalidArgumentError                      <span class=\"pl-en\">Traceback</span> (most recent call last)\n<span class=\"pl-k\">&lt;</span>ipython<span class=\"pl-k\">-</span>input<span class=\"pl-k\">-</span><span class=\"pl-c1\">10</span><span class=\"pl-k\">-</span><span class=\"pl-ii\">84f5fbeb6a90</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span><span class=\"pl-c1\">module</span><span class=\"pl-k\">&gt;</span>()\n      <span class=\"pl-c1\">1</span> sess <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tf</span>.<span class=\"pl-en\">InteractiveSession</span>()\n<span class=\"pl-k\">--</span><span class=\"pl-c\"><span class=\"pl-c\">--&gt;</span></span> <span class=\"pl-c1\">2</span> <span class=\"pl-smi\">nmt</span>.<span class=\"pl-en\">train</span>(sess, train_data, valid_data, <span class=\"pl-c1\">EVALUATE_PER</span>)\n\n<span class=\"pl-k\">&lt;</span>ipython<span class=\"pl-k\">-</span>input<span class=\"pl-k\">-</span><span class=\"pl-c1\">6</span><span class=\"pl-k\">-</span>ca1988aa7469<span class=\"pl-k\">&gt;</span> <span class=\"pl-k\">in</span> <span class=\"pl-en\">train</span>(self, sess, train_data, valid_data, evaluate_per)\n    <span class=\"pl-c1\">190</span> \n    <span class=\"pl-c1\">191</span>             _, cost <span class=\"pl-k\">=</span> <span class=\"pl-smi\">self</span>.<span class=\"pl-en\">step</span>(sess, train_encoder_batches[batch_i], train_decoder_batches[batch_i], \n<span class=\"pl-c\"><span class=\"pl-c\">--&gt;</span></span> <span class=\"pl-c1\">192</span>                                train_target_batches[batch_i], train_target_weight_batches[batch_i], <span class=\"pl-smi\">self</span>.<span class=\"pl-smi\">train_flag</span>)\n    <span class=\"pl-c1\">193</span> \n    <span class=\"pl-c1\">194</span>             # <span class=\"pl-k\">if</span> the loss is equal to <span class=\"pl-c1\">NaN</span>(not a number), raise error\n\n<span class=\"pl-k\">&lt;</span>ipython<span class=\"pl-k\">-</span>input<span class=\"pl-k\">-</span><span class=\"pl-c1\">6</span><span class=\"pl-k\">-</span>ca1988aa7469<span class=\"pl-k\">&gt;</span> <span class=\"pl-k\">in</span> <span class=\"pl-en\">step</span>(self, sess, encoder_data, decoder_data, target_data, tw_data, train_flag)\n    <span class=\"pl-c1\">122</span>                 <span class=\"pl-smi\">output_feed</span>.<span class=\"pl-c1\">append</span>(<span class=\"pl-smi\">self</span>.<span class=\"pl-smi\">final_outputs</span>[idx])\n    <span class=\"pl-c1\">123</span> \n<span class=\"pl-c\"><span class=\"pl-c\">--&gt;</span></span> <span class=\"pl-c1\">124</span>         output <span class=\"pl-k\">=</span> <span class=\"pl-smi\">sess</span>.<span class=\"pl-en\">run</span>(output_feed, input_feed)\n    <span class=\"pl-c1\">125</span>         <span class=\"pl-k\">return</span> output\n    <span class=\"pl-c1\">126</span> \n\n<span class=\"pl-sr\"><span class=\"pl-pds\">/</span>opt<span class=\"pl-pds\">/</span></span>anaconda2<span class=\"pl-k\">/</span>lib<span class=\"pl-k\">/</span>python2.<span class=\"pl-ii\">7</span><span class=\"pl-k\">/</span>site<span class=\"pl-k\">-</span>packages<span class=\"pl-k\">/</span>tensorflow<span class=\"pl-k\">/</span>python<span class=\"pl-k\">/</span>client<span class=\"pl-k\">/</span><span class=\"pl-smi\">session</span>.<span class=\"pl-smi\">pyc</span> <span class=\"pl-k\">in</span> <span class=\"pl-en\">run</span>(self, fetches, feed_dict)\n    <span class=\"pl-c1\">313</span>         <span class=\"pl-s\"><span class=\"pl-pds\">`</span>Tensor<span class=\"pl-pds\">`</span></span> that doesn<span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-ii\">t exist.</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    314     \"\"\"</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">--&gt; 315     return self._run(None, fetches, feed_dict)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    316 </span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    317   def partial_run(self, handle, fetches, feed_dict=None):</span></span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    509     # Run request and get response.</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    510     results = self._do_run(handle, target_list, unique_fetches,</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">--&gt; 511                            feed_dict_string)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    512 </span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    513     # User may have fetched the same tensor multiple times, but we</span></span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    562     if handle is None:</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    563       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">--&gt; 564                            target_list)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    565     else:</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    566       return self._do_call(_prun_fn, self._session, handle, feed_dict,</span></span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    584         # pylint: disable=protected-access</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    585         raise errors._make_specific_exception(node_def, op, error_message,</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">--&gt; 586                                               e.code)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    587         # pylint: enable=protected-access</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    588       six.reraise(e_type, e_value, e_traceback)</span></span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">InvalidArgumentError: Cannot assign a device to node <span class=\"pl-pds\">'</span></span>sequence_loss_by_example<span class=\"pl-k\">/</span>sampled_softmax_loss_39<span class=\"pl-k\">/</span>embedding_lookup_1<span class=\"pl-s\"><span class=\"pl-pds\">'</span>: Could not satisfy explicit device specification <span class=\"pl-pds\">'</span></span><span class=\"pl-k\">/</span>device<span class=\"pl-k\">:</span><span class=\"pl-c1\">GPU</span><span class=\"pl-k\">:</span><span class=\"pl-c1\">0</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">     [[Node: sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1 = Gather[Tindices=DT_INT64, Tparams=DT_FLOAT, validate_indices=true, _device=\"/device:GPU:0\"](proj_b/read, sequence_loss_by_example/sampled_softmax_loss_39/concat)]]</span></span>\n<span class=\"pl-s\">Caused by op u<span class=\"pl-pds\">'</span></span>sequence_loss_by_example<span class=\"pl-k\">/</span>sampled_softmax_loss_39<span class=\"pl-k\">/</span>embedding_lookup_1<span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-ii\">, defined at:</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/runpy.py\", line 162, in _run_module_as_main</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    \"__main__\", fname, loader, pkg_name)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/runpy.py\", line 72, in _run_code</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    exec code in run_globals</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in &lt;module&gt;</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    app.launch_new_instance()</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/traitlets/config/application.py\", line 592, in launch_instance</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    app.start()</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 403, in start</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    ioloop.IOLoop.instance().start()</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 151, in start</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    super(ZMQIOLoop, self).start()</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/ioloop.py\", line 866, in start</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    handler_func(fd_obj, events)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    return fn(*args, **kwargs)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 433, in _handle_events</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    self._handle_recv()</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 465, in _handle_recv</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    self._run_callback(callback, msg)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 407, in _run_callback</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    callback(*args, **kwargs)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    return fn(*args, **kwargs)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 260, in dispatcher</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    return self.dispatch_shell(stream, msg)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 212, in dispatch_shell</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    handler(stream, idents, msg)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 370, in execute_request</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    user_expressions, allow_stdin)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 175, in do_execute</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    shell.run_cell(code, store_history=store_history, silent=silent)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2902, in run_cell</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    interactivity=interactivity, compiler=compiler, result=result)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_ast_nodes</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    if self.run_code(code, result):</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 3066, in run_code</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    exec(code_obj, self.user_global_ns, self.user_ns)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"&lt;ipython-input-9-bfcd832d993d&gt;\", line 2, in &lt;module&gt;</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    BATCH_SIZE, NUM_SAMPLES, MAX_GRADIENT_NORM, LEARNING_RATE, decay_factor = LEARNING_RATE_DECAY_FACTOR)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"&lt;ipython-input-6-ca1988aa7469&gt;\", line 88, in __init__</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    self.loss_sequence = seq2seq.sequence_loss_by_example(self.outputs, self.targets, self.tw, self.target_voca, softmax_loss_function = softmax_loss_function)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"seq2seq_mod070_ver5.py\", line 974, in sequence_loss_by_example</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    crossent = softmax_loss_function(logit, target)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"&lt;ipython-input-6-ca1988aa7469&gt;\", line 66, in sampled_loss</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    self.target_voca)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn.py\", line 865, in sampled_softmax_loss</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    name=name)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn.py\", line 661, in _compute_sampled_logits</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    all_b = embedding_ops.embedding_lookup(biases, all_ids)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/embedding_ops.py\", line 86, in embedding_lookup</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    validate_indices=validate_indices)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 423, in gather</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    validate_indices=validate_indices, name=name)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/op_def_library.py\", line 655, in apply_op</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    op_def=op_def)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2040, in create_op</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    original_op=self._default_original_op, op_def=op_def)</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1087, in __init__</span></span>\n<span class=\"pl-s\"><span class=\"pl-ii\">    self._traceback = _extract_stack()</span></span></pre></div>\n<p>what's the problem with this?</p>\n<p>I heard that there are many device related things modified in release 0.8.0 just because of many of ops are coded with cuda(?)  then why not this part, I mean sampled_loss part in seq2seq_model.py</p>", "body_text": "I'm now a little bit hesitated that I have found a similar issue before, however I can't find it now\nin the file seq2seq_model.py in translate foloder, I use    with device(\"/gpu:0')     instead of cpu, there's an error like this :\nInvalidArgumentError                      Traceback (most recent call last)\n<ipython-input-10-84f5fbeb6a90> in <module>()\n      1 sess = tf.InteractiveSession()\n----> 2 nmt.train(sess, train_data, valid_data, EVALUATE_PER)\n\n<ipython-input-6-ca1988aa7469> in train(self, sess, train_data, valid_data, evaluate_per)\n    190 \n    191             _, cost = self.step(sess, train_encoder_batches[batch_i], train_decoder_batches[batch_i], \n--> 192                                train_target_batches[batch_i], train_target_weight_batches[batch_i], self.train_flag)\n    193 \n    194             # if the loss is equal to NaN(not a number), raise error\n\n<ipython-input-6-ca1988aa7469> in step(self, sess, encoder_data, decoder_data, target_data, tw_data, train_flag)\n    122                 output_feed.append(self.final_outputs[idx])\n    123 \n--> 124         output = sess.run(output_feed, input_feed)\n    125         return output\n    126 \n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict)\n    313         `Tensor` that doesn't exist.\n    314     \"\"\"\n--> 315     return self._run(None, fetches, feed_dict)\n    316 \n    317   def partial_run(self, handle, fetches, feed_dict=None):\n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict)\n    509     # Run request and get response.\n    510     results = self._do_run(handle, target_list, unique_fetches,\n--> 511                            feed_dict_string)\n    512 \n    513     # User may have fetched the same tensor multiple times, but we\n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict)\n    562     if handle is None:\n    563       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n--> 564                            target_list)\n    565     else:\n    566       return self._do_call(_prun_fn, self._session, handle, feed_dict,\n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\n    584         # pylint: disable=protected-access\n    585         raise errors._make_specific_exception(node_def, op, error_message,\n--> 586                                               e.code)\n    587         # pylint: enable=protected-access\n    588       six.reraise(e_type, e_value, e_traceback)\n\nInvalidArgumentError: Cannot assign a device to node 'sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1': Could not satisfy explicit device specification '/device:GPU:0'\n     [[Node: sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1 = Gather[Tindices=DT_INT64, Tparams=DT_FLOAT, validate_indices=true, _device=\"/device:GPU:0\"](proj_b/read, sequence_loss_by_example/sampled_softmax_loss_39/concat)]]\nCaused by op u'sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1', defined at:\n  File \"/opt/anaconda2/lib/python2.7/runpy.py\", line 162, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/opt/anaconda2/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in <module>\n    app.launch_new_instance()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/traitlets/config/application.py\", line 592, in launch_instance\n    app.start()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 403, in start\n    ioloop.IOLoop.instance().start()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 151, in start\n    super(ZMQIOLoop, self).start()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/ioloop.py\", line 866, in start\n    handler_func(fd_obj, events)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 433, in _handle_events\n    self._handle_recv()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 465, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 407, in _run_callback\n    callback(*args, **kwargs)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 260, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 212, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 370, in execute_request\n    user_expressions, allow_stdin)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 175, in do_execute\n    shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2902, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 3066, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-9-bfcd832d993d>\", line 2, in <module>\n    BATCH_SIZE, NUM_SAMPLES, MAX_GRADIENT_NORM, LEARNING_RATE, decay_factor = LEARNING_RATE_DECAY_FACTOR)\n  File \"<ipython-input-6-ca1988aa7469>\", line 88, in __init__\n    self.loss_sequence = seq2seq.sequence_loss_by_example(self.outputs, self.targets, self.tw, self.target_voca, softmax_loss_function = softmax_loss_function)\n  File \"seq2seq_mod070_ver5.py\", line 974, in sequence_loss_by_example\n    crossent = softmax_loss_function(logit, target)\n  File \"<ipython-input-6-ca1988aa7469>\", line 66, in sampled_loss\n    self.target_voca)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn.py\", line 865, in sampled_softmax_loss\n    name=name)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn.py\", line 661, in _compute_sampled_logits\n    all_b = embedding_ops.embedding_lookup(biases, all_ids)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/embedding_ops.py\", line 86, in embedding_lookup\n    validate_indices=validate_indices)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 423, in gather\n    validate_indices=validate_indices, name=name)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/op_def_library.py\", line 655, in apply_op\n    op_def=op_def)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2040, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1087, in __init__\n    self._traceback = _extract_stack()\nwhat's the problem with this?\nI heard that there are many device related things modified in release 0.8.0 just because of many of ops are coded with cuda(?)  then why not this part, I mean sampled_loss part in seq2seq_model.py", "body": "I'm now a little bit hesitated that I have found a similar issue before, however I can't find it now\n\nin the file seq2seq_model.py in translate foloder, I use    with device(\"/gpu:0')     instead of cpu, there's an error like this : \n\n``` javascript\nInvalidArgumentError                      Traceback (most recent call last)\n<ipython-input-10-84f5fbeb6a90> in <module>()\n      1 sess = tf.InteractiveSession()\n----> 2 nmt.train(sess, train_data, valid_data, EVALUATE_PER)\n\n<ipython-input-6-ca1988aa7469> in train(self, sess, train_data, valid_data, evaluate_per)\n    190 \n    191             _, cost = self.step(sess, train_encoder_batches[batch_i], train_decoder_batches[batch_i], \n--> 192                                train_target_batches[batch_i], train_target_weight_batches[batch_i], self.train_flag)\n    193 \n    194             # if the loss is equal to NaN(not a number), raise error\n\n<ipython-input-6-ca1988aa7469> in step(self, sess, encoder_data, decoder_data, target_data, tw_data, train_flag)\n    122                 output_feed.append(self.final_outputs[idx])\n    123 \n--> 124         output = sess.run(output_feed, input_feed)\n    125         return output\n    126 \n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict)\n    313         `Tensor` that doesn't exist.\n    314     \"\"\"\n--> 315     return self._run(None, fetches, feed_dict)\n    316 \n    317   def partial_run(self, handle, fetches, feed_dict=None):\n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict)\n    509     # Run request and get response.\n    510     results = self._do_run(handle, target_list, unique_fetches,\n--> 511                            feed_dict_string)\n    512 \n    513     # User may have fetched the same tensor multiple times, but we\n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict)\n    562     if handle is None:\n    563       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n--> 564                            target_list)\n    565     else:\n    566       return self._do_call(_prun_fn, self._session, handle, feed_dict,\n\n/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\n    584         # pylint: disable=protected-access\n    585         raise errors._make_specific_exception(node_def, op, error_message,\n--> 586                                               e.code)\n    587         # pylint: enable=protected-access\n    588       six.reraise(e_type, e_value, e_traceback)\n\nInvalidArgumentError: Cannot assign a device to node 'sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1': Could not satisfy explicit device specification '/device:GPU:0'\n     [[Node: sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1 = Gather[Tindices=DT_INT64, Tparams=DT_FLOAT, validate_indices=true, _device=\"/device:GPU:0\"](proj_b/read, sequence_loss_by_example/sampled_softmax_loss_39/concat)]]\nCaused by op u'sequence_loss_by_example/sampled_softmax_loss_39/embedding_lookup_1', defined at:\n  File \"/opt/anaconda2/lib/python2.7/runpy.py\", line 162, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/opt/anaconda2/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in <module>\n    app.launch_new_instance()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/traitlets/config/application.py\", line 592, in launch_instance\n    app.start()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 403, in start\n    ioloop.IOLoop.instance().start()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 151, in start\n    super(ZMQIOLoop, self).start()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/ioloop.py\", line 866, in start\n    handler_func(fd_obj, events)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 433, in _handle_events\n    self._handle_recv()\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 465, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 407, in _run_callback\n    callback(*args, **kwargs)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 260, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 212, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 370, in execute_request\n    user_expressions, allow_stdin)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 175, in do_execute\n    shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2902, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/opt/anaconda2/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 3066, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-9-bfcd832d993d>\", line 2, in <module>\n    BATCH_SIZE, NUM_SAMPLES, MAX_GRADIENT_NORM, LEARNING_RATE, decay_factor = LEARNING_RATE_DECAY_FACTOR)\n  File \"<ipython-input-6-ca1988aa7469>\", line 88, in __init__\n    self.loss_sequence = seq2seq.sequence_loss_by_example(self.outputs, self.targets, self.tw, self.target_voca, softmax_loss_function = softmax_loss_function)\n  File \"seq2seq_mod070_ver5.py\", line 974, in sequence_loss_by_example\n    crossent = softmax_loss_function(logit, target)\n  File \"<ipython-input-6-ca1988aa7469>\", line 66, in sampled_loss\n    self.target_voca)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn.py\", line 865, in sampled_softmax_loss\n    name=name)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn.py\", line 661, in _compute_sampled_logits\n    all_b = embedding_ops.embedding_lookup(biases, all_ids)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/embedding_ops.py\", line 86, in embedding_lookup\n    validate_indices=validate_indices)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 423, in gather\n    validate_indices=validate_indices, name=name)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/op_def_library.py\", line 655, in apply_op\n    op_def=op_def)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2040, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/opt/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1087, in __init__\n    self._traceback = _extract_stack()\n```\n\nwhat's the problem with this?\n\nI heard that there are many device related things modified in release 0.8.0 just because of many of ops are coded with cuda(?)  then why not this part, I mean sampled_loss part in seq2seq_model.py\n"}