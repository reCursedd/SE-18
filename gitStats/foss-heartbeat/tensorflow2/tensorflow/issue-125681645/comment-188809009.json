{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/188809009", "html_url": "https://github.com/tensorflow/tensorflow/pull/728#issuecomment-188809009", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/728", "id": 188809009, "node_id": "MDEyOklzc3VlQ29tbWVudDE4ODgwOTAwOQ==", "user": {"login": "ageron", "id": 76661, "node_id": "MDQ6VXNlcjc2NjYx", "avatar_url": "https://avatars3.githubusercontent.com/u/76661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ageron", "html_url": "https://github.com/ageron", "followers_url": "https://api.github.com/users/ageron/followers", "following_url": "https://api.github.com/users/ageron/following{/other_user}", "gists_url": "https://api.github.com/users/ageron/gists{/gist_id}", "starred_url": "https://api.github.com/users/ageron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ageron/subscriptions", "organizations_url": "https://api.github.com/users/ageron/orgs", "repos_url": "https://api.github.com/users/ageron/repos", "events_url": "https://api.github.com/users/ageron/events{/privacy}", "received_events_url": "https://api.github.com/users/ageron/received_events", "type": "User", "site_admin": false}, "created_at": "2016-02-25T14:27:39Z", "updated_at": "2016-02-25T14:29:44Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1057676\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rbharath\">@rbharath</a> I updated the code to move cmake/ to tensorflow/contrib/cmake/, and I updated to the latest upstream commit and fixed a couple issues.  The code builds and runs fine on my MacOSX machine (<code>tf_tutorials_example_trainer</code>), but I just tried to build it on an Ubuntu VM, and it failed with similar issues as you (linkage errors).  Adding the following code just after \"find_package(Threads)\" in tensorflow/contrib/cmake/CMakeLists.txt fixed the build problem:</p>\n<pre><code>IF (UNIX)\n    LINK_LIBRARIES(${CMAKE_THREAD_LIBS_INIT} ${CMAKE_DL_LIBS} -lm -lrt)\nENDIF (UNIX)\n</code></pre>\n<p>Now it builds all the way to the end, but I get a segfault when I run tf_tutorials_example_trainer on Ubuntu.  I'm investigating why, here's a quick dbg session:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/146645/debug_tf.txt\">debug_tf.txt</a></p>\n<p>Before building TensorFlow, I installed a few packages:</p>\n<pre><code>sudo apt-get install build-essential\nsudo apt-get install zlib1g-dev\n</code></pre>\n<p>I also built and installed Protobuf 3 from the source in google/protobuf (I followed the instructions in google/protobuf/cmake/README.md, without gmock)<br>\nAs I installed it in a non-standard directory, I added the following options to the cmake commands when building TensorFlow:</p>\n<pre><code>-DPROTOBUF_PROTOC_EXECUTABLE=[...]/install/bin/protoc\n-DPROTOBUF_INCLUDE_DIR=[...]/install/include\n-DPROTOBUF_PROTOC_LIBRARY=[...]/install/lib/libprotoc.a\n-DPROTOBUF_LIBRARY=[...]/install/lib/libprotobuf.a\n</code></pre>", "body_text": "@rbharath I updated the code to move cmake/ to tensorflow/contrib/cmake/, and I updated to the latest upstream commit and fixed a couple issues.  The code builds and runs fine on my MacOSX machine (tf_tutorials_example_trainer), but I just tried to build it on an Ubuntu VM, and it failed with similar issues as you (linkage errors).  Adding the following code just after \"find_package(Threads)\" in tensorflow/contrib/cmake/CMakeLists.txt fixed the build problem:\nIF (UNIX)\n    LINK_LIBRARIES(${CMAKE_THREAD_LIBS_INIT} ${CMAKE_DL_LIBS} -lm -lrt)\nENDIF (UNIX)\n\nNow it builds all the way to the end, but I get a segfault when I run tf_tutorials_example_trainer on Ubuntu.  I'm investigating why, here's a quick dbg session:\ndebug_tf.txt\nBefore building TensorFlow, I installed a few packages:\nsudo apt-get install build-essential\nsudo apt-get install zlib1g-dev\n\nI also built and installed Protobuf 3 from the source in google/protobuf (I followed the instructions in google/protobuf/cmake/README.md, without gmock)\nAs I installed it in a non-standard directory, I added the following options to the cmake commands when building TensorFlow:\n-DPROTOBUF_PROTOC_EXECUTABLE=[...]/install/bin/protoc\n-DPROTOBUF_INCLUDE_DIR=[...]/install/include\n-DPROTOBUF_PROTOC_LIBRARY=[...]/install/lib/libprotoc.a\n-DPROTOBUF_LIBRARY=[...]/install/lib/libprotobuf.a", "body": "@rbharath I updated the code to move cmake/ to tensorflow/contrib/cmake/, and I updated to the latest upstream commit and fixed a couple issues.  The code builds and runs fine on my MacOSX machine (`tf_tutorials_example_trainer`), but I just tried to build it on an Ubuntu VM, and it failed with similar issues as you (linkage errors).  Adding the following code just after \"find_package(Threads)\" in tensorflow/contrib/cmake/CMakeLists.txt fixed the build problem:\n\n```\nIF (UNIX)\n    LINK_LIBRARIES(${CMAKE_THREAD_LIBS_INIT} ${CMAKE_DL_LIBS} -lm -lrt)\nENDIF (UNIX)\n```\n\nNow it builds all the way to the end, but I get a segfault when I run tf_tutorials_example_trainer on Ubuntu.  I'm investigating why, here's a quick dbg session:\n[debug_tf.txt](https://github.com/tensorflow/tensorflow/files/146645/debug_tf.txt)\n\nBefore building TensorFlow, I installed a few packages:\n\n```\nsudo apt-get install build-essential\nsudo apt-get install zlib1g-dev\n```\n\nI also built and installed Protobuf 3 from the source in google/protobuf (I followed the instructions in google/protobuf/cmake/README.md, without gmock)\nAs I installed it in a non-standard directory, I added the following options to the cmake commands when building TensorFlow:\n\n```\n-DPROTOBUF_PROTOC_EXECUTABLE=[...]/install/bin/protoc\n-DPROTOBUF_INCLUDE_DIR=[...]/install/include\n-DPROTOBUF_PROTOC_LIBRARY=[...]/install/lib/libprotoc.a\n-DPROTOBUF_LIBRARY=[...]/install/lib/libprotobuf.a\n```\n"}