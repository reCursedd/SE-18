{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/406198689", "html_url": "https://github.com/tensorflow/tensorflow/issues/20867#issuecomment-406198689", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20867", "id": 406198689, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjE5ODY4OQ==", "user": {"login": "raninbowlalala", "id": 21166976, "node_id": "MDQ6VXNlcjIxMTY2OTc2", "avatar_url": "https://avatars3.githubusercontent.com/u/21166976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raninbowlalala", "html_url": "https://github.com/raninbowlalala", "followers_url": "https://api.github.com/users/raninbowlalala/followers", "following_url": "https://api.github.com/users/raninbowlalala/following{/other_user}", "gists_url": "https://api.github.com/users/raninbowlalala/gists{/gist_id}", "starred_url": "https://api.github.com/users/raninbowlalala/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raninbowlalala/subscriptions", "organizations_url": "https://api.github.com/users/raninbowlalala/orgs", "repos_url": "https://api.github.com/users/raninbowlalala/repos", "events_url": "https://api.github.com/users/raninbowlalala/events{/privacy}", "received_events_url": "https://api.github.com/users/raninbowlalala/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-19T08:32:30Z", "updated_at": "2018-07-19T08:32:30Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1450614\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/suharshs\">@suharshs</a> I find the code in tensorflow\\contrib\\quantize\\python\\fold_batch_norms.py, because the moving_mean_tensor, bn_decay_mean_tensor, moving_variance_tensor and bn_decay_var_tensor is not assign a value, can you take a look at it?</p>\n<pre><code> # TODO(suharshs): Find a way to get rid of this inner match.\n      for mul_match_result in moving_avg_mul_matcher.match_graph(graph):\n        sub_op = mul_match_result.get_op(moving_average_sub_pattern)\n        if sub_op.inputs[1].name == bn_op.outputs[1].name:\n          # During training: Batch Mean is bn_op.outputs[1]\n          moving_mean_tensor = sub_op.inputs[0]\n          bn_decay_mean_tensor = mul_match_result.get_tensor(bn_decay_pattern)\n        if sub_op.inputs[1].name == bn_op.outputs[2].name:\n          # During training: Batch Var is bn_op.outputs[2]\n          moving_variance_tensor = sub_op.inputs[0]\n          bn_decay_var_tensor = mul_match_result.get_tensor(bn_decay_pattern)\n</code></pre>", "body_text": "@suharshs I find the code in tensorflow\\contrib\\quantize\\python\\fold_batch_norms.py, because the moving_mean_tensor, bn_decay_mean_tensor, moving_variance_tensor and bn_decay_var_tensor is not assign a value, can you take a look at it?\n # TODO(suharshs): Find a way to get rid of this inner match.\n      for mul_match_result in moving_avg_mul_matcher.match_graph(graph):\n        sub_op = mul_match_result.get_op(moving_average_sub_pattern)\n        if sub_op.inputs[1].name == bn_op.outputs[1].name:\n          # During training: Batch Mean is bn_op.outputs[1]\n          moving_mean_tensor = sub_op.inputs[0]\n          bn_decay_mean_tensor = mul_match_result.get_tensor(bn_decay_pattern)\n        if sub_op.inputs[1].name == bn_op.outputs[2].name:\n          # During training: Batch Var is bn_op.outputs[2]\n          moving_variance_tensor = sub_op.inputs[0]\n          bn_decay_var_tensor = mul_match_result.get_tensor(bn_decay_pattern)", "body": "@suharshs I find the code in tensorflow\\contrib\\quantize\\python\\fold_batch_norms.py, because the moving_mean_tensor, bn_decay_mean_tensor, moving_variance_tensor and bn_decay_var_tensor is not assign a value, can you take a look at it?\r\n```\r\n # TODO(suharshs): Find a way to get rid of this inner match.\r\n      for mul_match_result in moving_avg_mul_matcher.match_graph(graph):\r\n        sub_op = mul_match_result.get_op(moving_average_sub_pattern)\r\n        if sub_op.inputs[1].name == bn_op.outputs[1].name:\r\n          # During training: Batch Mean is bn_op.outputs[1]\r\n          moving_mean_tensor = sub_op.inputs[0]\r\n          bn_decay_mean_tensor = mul_match_result.get_tensor(bn_decay_pattern)\r\n        if sub_op.inputs[1].name == bn_op.outputs[2].name:\r\n          # During training: Batch Var is bn_op.outputs[2]\r\n          moving_variance_tensor = sub_op.inputs[0]\r\n          bn_decay_var_tensor = mul_match_result.get_tensor(bn_decay_pattern)\r\n```"}