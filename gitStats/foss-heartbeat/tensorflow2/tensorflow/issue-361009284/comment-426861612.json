{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/426861612", "html_url": "https://github.com/tensorflow/tensorflow/issues/22325#issuecomment-426861612", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22325", "id": 426861612, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjg2MTYxMg==", "user": {"login": "joseortiz3", "id": 18585219, "node_id": "MDQ6VXNlcjE4NTg1MjE5", "avatar_url": "https://avatars3.githubusercontent.com/u/18585219?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joseortiz3", "html_url": "https://github.com/joseortiz3", "followers_url": "https://api.github.com/users/joseortiz3/followers", "following_url": "https://api.github.com/users/joseortiz3/following{/other_user}", "gists_url": "https://api.github.com/users/joseortiz3/gists{/gist_id}", "starred_url": "https://api.github.com/users/joseortiz3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joseortiz3/subscriptions", "organizations_url": "https://api.github.com/users/joseortiz3/orgs", "repos_url": "https://api.github.com/users/joseortiz3/repos", "events_url": "https://api.github.com/users/joseortiz3/events{/privacy}", "received_events_url": "https://api.github.com/users/joseortiz3/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-04T02:07:16Z", "updated_at": "2018-10-04T02:10:15Z", "author_association": "NONE", "body_html": "<p>I don't know why this fix only works with Bazel 0.16.1.<br>\nWith Bazel 17.x, manually changing this line fixed my <a href=\"https://docs.bazel.build/versions/master/skylark/lib/repository_ctx.html#execute\" rel=\"nofollow\"><code>repository_ctx.execute</code></a> not finding grep:</p>\n<p>In line 531 of cuda_configure.bzl:</p>\n<div class=\"highlight highlight-source-python\"><pre>    result <span class=\"pl-k\">=</span> repository_ctx.execute(\n        <span class=\"pl-c\"><span class=\"pl-c\">#</span> Grep one more lines as some #defines are splitted into two lines.</span>\n        [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>grep<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>--color=never<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-A1<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-E<span class=\"pl-pds\">\"</span></span>, define, <span class=\"pl-c1\">str</span>(h_path)],\n    )</pre></div>\n<p>Changing it to</p>\n<div class=\"highlight highlight-source-python\"><pre>    result <span class=\"pl-k\">=</span> repository_ctx.execute(\n        <span class=\"pl-c\"><span class=\"pl-c\">#</span> Grep one more lines as some #defines are splitted into two lines.</span>\n        [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>C:/msys64/usr/bin/grep<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>--color=never<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-A1<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-E<span class=\"pl-pds\">\"</span></span>, define, <span class=\"pl-c1\">str</span>(h_path)],\n    )</pre></div>\n<p>Curiously, instead adding <code>\"C:/msys64/usr/bin/grep\"</code> to my path did not work, as <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5025458\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rcorvus\">@rcorvus</a> pointed out.</p>\n<p>Please fix this; I spent two hours on this, and probably a couple dozen more people will too. Obviously my \"fix\" is not universal, and I don't know of one that would be.</p>\n<p>Doesn't help that Bazel's error message seems to imply that <code>cuddn.h</code> couldn't be found, when in reality grep couldn't be found...</p>", "body_text": "I don't know why this fix only works with Bazel 0.16.1.\nWith Bazel 17.x, manually changing this line fixed my repository_ctx.execute not finding grep:\nIn line 531 of cuda_configure.bzl:\n    result = repository_ctx.execute(\n        # Grep one more lines as some #defines are splitted into two lines.\n        [\"grep\", \"--color=never\", \"-A1\", \"-E\", define, str(h_path)],\n    )\nChanging it to\n    result = repository_ctx.execute(\n        # Grep one more lines as some #defines are splitted into two lines.\n        [\"C:/msys64/usr/bin/grep\", \"--color=never\", \"-A1\", \"-E\", define, str(h_path)],\n    )\nCuriously, instead adding \"C:/msys64/usr/bin/grep\" to my path did not work, as @rcorvus pointed out.\nPlease fix this; I spent two hours on this, and probably a couple dozen more people will too. Obviously my \"fix\" is not universal, and I don't know of one that would be.\nDoesn't help that Bazel's error message seems to imply that cuddn.h couldn't be found, when in reality grep couldn't be found...", "body": "I don't know why this fix only works with Bazel 0.16.1. \r\nWith Bazel 17.x, manually changing this line fixed my [`repository_ctx.execute`](https://docs.bazel.build/versions/master/skylark/lib/repository_ctx.html#execute) not finding grep:\r\n\r\nIn line 531 of cuda_configure.bzl:\r\n\r\n```python\r\n    result = repository_ctx.execute(\r\n        # Grep one more lines as some #defines are splitted into two lines.\r\n        [\"grep\", \"--color=never\", \"-A1\", \"-E\", define, str(h_path)],\r\n    )\r\n```\r\n\r\nChanging it to\r\n\r\n```python\r\n    result = repository_ctx.execute(\r\n        # Grep one more lines as some #defines are splitted into two lines.\r\n        [\"C:/msys64/usr/bin/grep\", \"--color=never\", \"-A1\", \"-E\", define, str(h_path)],\r\n    )\r\n```\r\n\r\nCuriously, instead adding `\"C:/msys64/usr/bin/grep\"` to my path did not work, as @rcorvus pointed out.\r\n\r\nPlease fix this; I spent two hours on this, and probably a couple dozen more people will too. Obviously my \"fix\" is not universal, and I don't know of one that would be.\r\n\r\n Doesn't help that Bazel's error message seems to imply that `cuddn.h` couldn't be found, when in reality grep couldn't be found..."}