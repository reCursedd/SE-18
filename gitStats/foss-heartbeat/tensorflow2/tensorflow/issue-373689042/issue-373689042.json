{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23228", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23228/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23228/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23228/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23228", "id": 373689042, "node_id": "MDU6SXNzdWUzNzM2ODkwNDI=", "number": 23228, "title": "Bug in problem.py input_fn", "user": {"login": "mikeymezher", "id": 5401052, "node_id": "MDQ6VXNlcjU0MDEwNTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/5401052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mikeymezher", "html_url": "https://github.com/mikeymezher", "followers_url": "https://api.github.com/users/mikeymezher/followers", "following_url": "https://api.github.com/users/mikeymezher/following{/other_user}", "gists_url": "https://api.github.com/users/mikeymezher/gists{/gist_id}", "starred_url": "https://api.github.com/users/mikeymezher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mikeymezher/subscriptions", "organizations_url": "https://api.github.com/users/mikeymezher/orgs", "repos_url": "https://api.github.com/users/mikeymezher/repos", "events_url": "https://api.github.com/users/mikeymezher/events{/privacy}", "received_events_url": "https://api.github.com/users/mikeymezher/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-10-24T21:42:35Z", "updated_at": "2018-10-26T18:08:21Z", "closed_at": "2018-10-26T18:08:21Z", "author_association": "NONE", "body_html": "<p>Using tensor2tensor 1.9 and tf 1.9.0, while overriding the problem.py input_fn:<br>\nTraceback (most recent call last):<br>\nFile \"/usr/local/bin/t2t-trainer\", line 33, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 125, in run<br>\n_sys.exit(main(argv))<br>\nFile \"/usr/local/bin/t2t-trainer\", line 28, in main<br>\nt2t_trainer.main(argv)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/bin/t2t_trainer.py\", line 355, in main<br>\nexecute_schedule(exp)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/bin/t2t_trainer.py\", line 321, in execute_schedule<br>\ngetattr(exp, FLAGS.schedule)()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/utils/trainer_lib.py\", line 331, in continuous_train_a<br>\nnd_eval<br>\nself._eval_spec)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 447, in train_and_eva<br>\nluate<br>\nreturn executor.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 531, in run<br>\nreturn self.run_local()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 669, in run_local<br>\nhooks=train_hooks)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 366, in train<br>\nloss = self._train_model(input_fn, hooks, saving_listeners)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1119, in _train_mode<br>\nl<br>\nreturn self._train_model_default(input_fn, hooks, saving_listeners)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1132, in _train_mode<br>\nl_default<br>\nfeatures, labels, model_fn_lib.ModeKeys.TRAIN, self.config)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1992, in _<br>\ncall_model_fn<br>\nfeatures, labels, mode, config)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1107, in _call_model<br>\n_fn<br>\nmodel_fn_results = self._model_fn(features=features, **kwargs)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 2212, in _<br>\nmodel_fn<br>\ninput_holders.generate_infeed_enqueue_ops_and_dequeue_fn())<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1001, in g<br>\nenerate_infeed_enqueue_ops_and_dequeue_fn<br>\nself._invoke_input_fn_and_record_structure())<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1065, in _<br>\ninvoke_input_fn_and_record_structure<br>\nhost_device, host_id))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 692, in ge<br>\nnerate_per_host_enqueue_ops_fn_for_host<br>\ninputs = _Inputs.from_input_fn(input_fn(user_context))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 2163, in _<br>\ninput_fn<br>\nreturn input_fn(**kwargs)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/data_generators/problem.py\", line 735, in estimator_in<br>\nput_fn<br>\ndataset_kwargs=dataset_kwargs)<br>\nFile \"/home/michaelbesc/BESC_Source/route-prediction_MMedts/training_minimal_wCat_decOnly/trainer/routes.py\", lin<br>\ne 579, in input_fn<br>\nbatch_size, padded_shapes, drop_remainder=True)<br>\nTypeError: padded_batch() got an unexpected keyword argument 'drop_remainder'</p>\n<p>This is because in tf 1.9 the 'drop remainder' argument doesn't yet exist (becomes available tf 1.10.0)<br>\nNot sure why this issue doesn't seem to occur when input_fn is not overridden.</p>", "body_text": "Using tensor2tensor 1.9 and tf 1.9.0, while overriding the problem.py input_fn:\nTraceback (most recent call last):\nFile \"/usr/local/bin/t2t-trainer\", line 33, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\nFile \"/usr/local/bin/t2t-trainer\", line 28, in main\nt2t_trainer.main(argv)\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/bin/t2t_trainer.py\", line 355, in main\nexecute_schedule(exp)\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/bin/t2t_trainer.py\", line 321, in execute_schedule\ngetattr(exp, FLAGS.schedule)()\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/utils/trainer_lib.py\", line 331, in continuous_train_a\nnd_eval\nself._eval_spec)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 447, in train_and_eva\nluate\nreturn executor.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 531, in run\nreturn self.run_local()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 669, in run_local\nhooks=train_hooks)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\nloss = self._train_model(input_fn, hooks, saving_listeners)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1119, in _train_mode\nl\nreturn self._train_model_default(input_fn, hooks, saving_listeners)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1132, in _train_mode\nl_default\nfeatures, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1992, in _\ncall_model_fn\nfeatures, labels, mode, config)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1107, in _call_model\n_fn\nmodel_fn_results = self._model_fn(features=features, **kwargs)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 2212, in _\nmodel_fn\ninput_holders.generate_infeed_enqueue_ops_and_dequeue_fn())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1001, in g\nenerate_infeed_enqueue_ops_and_dequeue_fn\nself._invoke_input_fn_and_record_structure())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1065, in _\ninvoke_input_fn_and_record_structure\nhost_device, host_id))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 692, in ge\nnerate_per_host_enqueue_ops_fn_for_host\ninputs = _Inputs.from_input_fn(input_fn(user_context))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 2163, in _\ninput_fn\nreturn input_fn(**kwargs)\nFile \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/data_generators/problem.py\", line 735, in estimator_in\nput_fn\ndataset_kwargs=dataset_kwargs)\nFile \"/home/michaelbesc/BESC_Source/route-prediction_MMedts/training_minimal_wCat_decOnly/trainer/routes.py\", lin\ne 579, in input_fn\nbatch_size, padded_shapes, drop_remainder=True)\nTypeError: padded_batch() got an unexpected keyword argument 'drop_remainder'\nThis is because in tf 1.9 the 'drop remainder' argument doesn't yet exist (becomes available tf 1.10.0)\nNot sure why this issue doesn't seem to occur when input_fn is not overridden.", "body": "Using tensor2tensor 1.9 and tf 1.9.0, while overriding the problem.py input_fn:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/t2t-trainer\", line 33, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"/usr/local/bin/t2t-trainer\", line 28, in main\r\n    t2t_trainer.main(argv)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/bin/t2t_trainer.py\", line 355, in main\r\n    execute_schedule(exp)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/bin/t2t_trainer.py\", line 321, in execute_schedule\r\n    getattr(exp, FLAGS.schedule)()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/utils/trainer_lib.py\", line 331, in continuous_train_a\r\nnd_eval\r\n    self._eval_spec)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 447, in train_and_eva\r\nluate\r\n    return executor.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 531, in run\r\n    return self.run_local()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 669, in run_local\r\n    hooks=train_hooks)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1119, in _train_mode\r\nl\r\n    return self._train_model_default(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1132, in _train_mode\r\nl_default\r\n    features, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1992, in _\r\ncall_model_fn\r\n    features, labels, mode, config)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1107, in _call_model\r\n_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 2212, in _\r\nmodel_fn\r\n    input_holders.generate_infeed_enqueue_ops_and_dequeue_fn())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1001, in g\r\nenerate_infeed_enqueue_ops_and_dequeue_fn\r\n    self._invoke_input_fn_and_record_structure())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 1065, in _\r\ninvoke_input_fn_and_record_structure\r\n    host_device, host_id))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 692, in ge\r\nnerate_per_host_enqueue_ops_fn_for_host\r\n    inputs = _Inputs.from_input_fn(input_fn(user_context))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_estimator.py\", line 2163, in _\r\ninput_fn\r\n    return input_fn(**kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensor2tensor/data_generators/problem.py\", line 735, in estimator_in\r\nput_fn\r\n    dataset_kwargs=dataset_kwargs)\r\n  File \"/home/michaelbesc/BESC_Source/route-prediction_MMedts/training_minimal_wCat_decOnly/trainer/routes.py\", lin\r\ne 579, in input_fn\r\n    batch_size, padded_shapes, drop_remainder=True)\r\nTypeError: padded_batch() got an unexpected keyword argument 'drop_remainder'\r\n\r\n\r\nThis is because in tf 1.9 the 'drop remainder' argument doesn't yet exist (becomes available tf 1.10.0)\r\nNot sure why this issue doesn't seem to occur when input_fn is not overridden. "}