{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/153876341", "pull_request_review_id": 79951833, "id": 153876341, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE1Mzg3NjM0MQ==", "diff_hunk": "@@ -143,47 +149,33 @@ def run_training():\n                        tf.local_variables_initializer())\n \n     # Create a session for running operations in the Graph.\n-    sess = tf.Session()\n-\n-    # Initialize the variables (the trained variables and the\n-    # epoch counter).\n-    sess.run(init_op)\n-\n-    # Start input enqueue threads.\n-    coord = tf.train.Coordinator()\n-    threads = tf.train.start_queue_runners(sess=sess, coord=coord)\n-\n-    try:\n-      step = 0\n-      while not coord.should_stop():\n-        start_time = time.time()\n-\n-        # Run one step of the model.  The return values are\n-        # the activations from the `train_op` (which is\n-        # discarded) and the `loss` op.  To inspect the values\n-        # of your ops or variables, you may include them in\n-        # the list passed to sess.run() and the value tensors\n-        # will be returned in the tuple from the call.\n-        _, loss_value = sess.run([train_op, loss])\n-\n-        duration = time.time() - start_time\n-\n-        # Print an overview fairly often.\n-        if step % 100 == 0:\n-          print('Step %d: loss = %.2f (%.3f sec)' % (step, loss_value,\n+    with tf.Session().as_default() as sess:", "path": "tensorflow/examples/how_tos/reading_data/fully_connected_reader.py", "position": null, "original_position": 152, "commit_id": "e018f3093dc1f94fa64c3ca928fca685f43aae50", "original_commit_id": "0808db05d39fb7fb4fbde38a4c556f7dc2a8c652", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "body": "Actually, I'd upgrade this to \"Mandatory:\", since the only difference in adding `.as_default()` is to delay closing the `Session` until it is garbage collected. In this code, it might not make a difference, but if somebody copies and pastes it (as they are likely to do) they might find that the session stays alive for longer than they'd like.", "created_at": "2017-11-29T18:35:02Z", "updated_at": "2017-12-04T14:43:25Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/14751#discussion_r153876341", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/14751", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/153876341"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/14751#discussion_r153876341"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/14751"}}, "body_html": "<p>Actually, I'd upgrade this to \"Mandatory:\", since the only difference in adding <code>.as_default()</code> is to delay closing the <code>Session</code> until it is garbage collected. In this code, it might not make a difference, but if somebody copies and pastes it (as they are likely to do) they might find that the session stays alive for longer than they'd like.</p>", "body_text": "Actually, I'd upgrade this to \"Mandatory:\", since the only difference in adding .as_default() is to delay closing the Session until it is garbage collected. In this code, it might not make a difference, but if somebody copies and pastes it (as they are likely to do) they might find that the session stays alive for longer than they'd like.", "in_reply_to_id": 153871315}