{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13784", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13784/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13784/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13784/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13784", "id": 266132110, "node_id": "MDU6SXNzdWUyNjYxMzIxMTA=", "number": 13784, "title": "Docker image file generated by parameterized_docker_build.sh fails (3)", "user": {"login": "SaintNazaire", "id": 23476368, "node_id": "MDQ6VXNlcjIzNDc2MzY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23476368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SaintNazaire", "html_url": "https://github.com/SaintNazaire", "followers_url": "https://api.github.com/users/SaintNazaire/followers", "following_url": "https://api.github.com/users/SaintNazaire/following{/other_user}", "gists_url": "https://api.github.com/users/SaintNazaire/gists{/gist_id}", "starred_url": "https://api.github.com/users/SaintNazaire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SaintNazaire/subscriptions", "organizations_url": "https://api.github.com/users/SaintNazaire/orgs", "repos_url": "https://api.github.com/users/SaintNazaire/repos", "events_url": "https://api.github.com/users/SaintNazaire/events{/privacy}", "received_events_url": "https://api.github.com/users/SaintNazaire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-10-17T13:49:28Z", "updated_at": "2017-12-21T14:44:26Z", "closed_at": "2017-12-21T14:44:26Z", "author_association": "CONTRIBUTOR", "body_html": "<p><strong>Issue</strong></p>\n<p>Fixed previous docker install issue <a href=\"https://github.com/tensorflow/tensorflow/issues/13379\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/13379/hovercard\">#13379</a></p>\n<p>Executing parameterized_docker_build.sh generates new docker file but image fails to turn into an docker image, throws error message.</p>\n<p><strong>System information</strong></p>\n<ul>\n<li>I have used a stock example script provided in TensorFlow</li>\n<li>Windows 10 professional</li>\n<li>TensorFlow install as docker image tensorflow/tensorflow:1.3.0-devel-py3</li>\n<li>TensorFlow version 1.3</li>\n<li>Python version 3</li>\n<li>Bazel version 0.5.0</li>\n<li>CUDA/cuDNN version not relevant (CPU install)</li>\n<li>GPU model and memory not relevant (CPU install)</li>\n<li>Docker CE 17.09.0-ce</li>\n</ul>\n<p><code>$which docker</code></p>\n<blockquote>\n<p>/usr/bin/docker</p>\n</blockquote>\n<p><strong>Command triggering issue</strong></p>\n<p><code>$/tensorflow/tensorflow/tools/docker/parameterized_docker_build.sh</code></p>\n<p><strong>Error messages</strong></p>\n<blockquote>\n<p>Required build parameters:<br>\nTF_DOCKER_BUILD_TYPE=cpu<br>\nTF_DOCKER_BUILD_IS_DEVEL=no<br>\nTF_DOCKER_BUILD_DEVEL_BRANCH=</p>\n<p>Optional build parameters:<br>\nTF_DOCKER_BUILD_CENTRAL_PIP=<a href=\"http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\" rel=\"nofollow\">http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl</a><br>\nTF_DOCKER_BUILD_IMAGE_NAME=<br>\nTF_DOCKER_BUILD_VERSION=<br>\nTF_DOCKER_BUILD_PORT=<br>\nTF_DOCKER_BUILD_PUSH_CMD=</p>\n<p>FINAL_IMAGE_NAME: tensorflow/tensorflow<br>\nFINAL_TAG: latest<br>\nOriginal Dockerfile: /tensorflow/tensorflow/tools/docker/Dockerfile</p>\n<p>Docker build will occur in temporary directory: /tmp/tmp.nBIOwyaShf<br>\nDownloading pip wheel from: <a href=\"http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\" rel=\"nofollow\">http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl</a></p>\n<p>Modified Dockerfile at: /tmp/tmp.nBIOwyaShf/Dockerfile</p>\n<p>Building docker image with image name and tag: /tensorflow:latest<br>\ninvalid argument \"/tensorflow:latest\" for t: invalid reference format<br>\nSee 'docker build --help'.<br>\nFAIL: docker build of /tensorflow:latest with Dockerfile /tmp/tmp.nBIOwyaShf/Dockerfile failed</p>\n</blockquote>\n<p><strong>Inspecting the resulting docker file for further introspection</strong></p>\n<p><code>$cat /tmp/tmp.nBIOwyaShf/Dockerfile</code></p>\n<blockquote>\n<p>FROM ubuntu:16.04</p>\n<p>MAINTAINER Craig Citro <a href=\"mailto:craigcitro@google.com\">craigcitro@google.com</a></p>\n<p>RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends <br>\nbuild-essential <br>\ncurl <br>\nlibfreetype6-dev <br>\nlibpng12-dev <br>\nlibzmq3-dev <br>\npkg-config <br>\npython <br>\npython-dev <br>\nrsync <br>\nsoftware-properties-common <br>\nunzip <br>\n&amp;&amp; <br>\napt-get clean &amp;&amp; <br>\nrm -rf /var/lib/apt/lists/*</p>\n<p>RUN curl -O <a href=\"https://bootstrap.pypa.io/get-pip.py\" rel=\"nofollow\">https://bootstrap.pypa.io/get-pip.py</a> &amp;&amp; <br>\npython get-pip.py &amp;&amp; <br>\nrm get-pip.py</p>\n<p>RUN pip --no-cache-dir install <br>\nPillow <br>\nh5py <br>\nipykernel <br>\njupyter <br>\nmatplotlib <br>\nnumpy <br>\npandas <br>\nscipy <br>\nsklearn <br>\n&amp;&amp; <br>\npython -m ipykernel.kernelspec</p>\n<p>RUN pip --no-cache-dir install <a href=\"http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\" rel=\"nofollow\">http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl</a></p>\n<p>COPY jupyter_notebook_config.py /root/.jupyter/</p>\n<p>COPY notebooks /notebooks</p>\n<p>COPY run_jupyter.sh /</p>\n<p>EXPOSE 6006<br>\nEXPOSE 8888</p>\n<p>WORKDIR \"/notebooks\"</p>\n<p>CMD [\"/run_jupyter.sh\", \"--allow-root\"]</p>\n</blockquote>\n<p><strong>Additional introspection with docker image file</strong></p>\n<p>Copied and pasted the parameterized_docker_build.sh output docker file content and tried to execute on docker hub which fails.</p>\n<p>Docker hub log reports yields the following additional error information:</p>\n<blockquote>\n<p>Step 6/9 : RUN pip --no-cache-dir install <a href=\"http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\" rel=\"nofollow\">http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl</a></p>\n<p>---&gt; Running in fd0d49a714e4</p>\n<p>\ufffd[91mtensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl is not a supported wheel on this platform.<br>\n\ufffd[0m<br>\nRemoving intermediate container fd0d49a714e4</p>\n<p>The command '/bin/sh -c pip --no-cache-dir install <a href=\"http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\" rel=\"nofollow\">http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl</a>' returned a non-zero code: 1</p>\n</blockquote>", "body_text": "Issue\nFixed previous docker install issue #13379\nExecuting parameterized_docker_build.sh generates new docker file but image fails to turn into an docker image, throws error message.\nSystem information\n\nI have used a stock example script provided in TensorFlow\nWindows 10 professional\nTensorFlow install as docker image tensorflow/tensorflow:1.3.0-devel-py3\nTensorFlow version 1.3\nPython version 3\nBazel version 0.5.0\nCUDA/cuDNN version not relevant (CPU install)\nGPU model and memory not relevant (CPU install)\nDocker CE 17.09.0-ce\n\n$which docker\n\n/usr/bin/docker\n\nCommand triggering issue\n$/tensorflow/tensorflow/tools/docker/parameterized_docker_build.sh\nError messages\n\nRequired build parameters:\nTF_DOCKER_BUILD_TYPE=cpu\nTF_DOCKER_BUILD_IS_DEVEL=no\nTF_DOCKER_BUILD_DEVEL_BRANCH=\nOptional build parameters:\nTF_DOCKER_BUILD_CENTRAL_PIP=http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\nTF_DOCKER_BUILD_IMAGE_NAME=\nTF_DOCKER_BUILD_VERSION=\nTF_DOCKER_BUILD_PORT=\nTF_DOCKER_BUILD_PUSH_CMD=\nFINAL_IMAGE_NAME: tensorflow/tensorflow\nFINAL_TAG: latest\nOriginal Dockerfile: /tensorflow/tensorflow/tools/docker/Dockerfile\nDocker build will occur in temporary directory: /tmp/tmp.nBIOwyaShf\nDownloading pip wheel from: http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\nModified Dockerfile at: /tmp/tmp.nBIOwyaShf/Dockerfile\nBuilding docker image with image name and tag: /tensorflow:latest\ninvalid argument \"/tensorflow:latest\" for t: invalid reference format\nSee 'docker build --help'.\nFAIL: docker build of /tensorflow:latest with Dockerfile /tmp/tmp.nBIOwyaShf/Dockerfile failed\n\nInspecting the resulting docker file for further introspection\n$cat /tmp/tmp.nBIOwyaShf/Dockerfile\n\nFROM ubuntu:16.04\nMAINTAINER Craig Citro craigcitro@google.com\nRUN apt-get update && apt-get install -y --no-install-recommends \nbuild-essential \ncurl \nlibfreetype6-dev \nlibpng12-dev \nlibzmq3-dev \npkg-config \npython \npython-dev \nrsync \nsoftware-properties-common \nunzip \n&& \napt-get clean && \nrm -rf /var/lib/apt/lists/*\nRUN curl -O https://bootstrap.pypa.io/get-pip.py && \npython get-pip.py && \nrm get-pip.py\nRUN pip --no-cache-dir install \nPillow \nh5py \nipykernel \njupyter \nmatplotlib \nnumpy \npandas \nscipy \nsklearn \n&& \npython -m ipykernel.kernelspec\nRUN pip --no-cache-dir install http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\nCOPY jupyter_notebook_config.py /root/.jupyter/\nCOPY notebooks /notebooks\nCOPY run_jupyter.sh /\nEXPOSE 6006\nEXPOSE 8888\nWORKDIR \"/notebooks\"\nCMD [\"/run_jupyter.sh\", \"--allow-root\"]\n\nAdditional introspection with docker image file\nCopied and pasted the parameterized_docker_build.sh output docker file content and tried to execute on docker hub which fails.\nDocker hub log reports yields the following additional error information:\n\nStep 6/9 : RUN pip --no-cache-dir install http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\n---> Running in fd0d49a714e4\n\ufffd[91mtensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl is not a supported wheel on this platform.\n\ufffd[0m\nRemoving intermediate container fd0d49a714e4\nThe command '/bin/sh -c pip --no-cache-dir install http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl' returned a non-zero code: 1", "body": "**Issue**\r\n\r\nFixed previous docker install issue [#13379](https://github.com/tensorflow/tensorflow/issues/13379)\r\n\r\nExecuting parameterized_docker_build.sh generates new docker file but image fails to turn into an docker image, throws error message.\r\n\r\n**System information**\r\n\r\n- I have used a stock example script provided in TensorFlow\r\n- Windows 10 professional\r\n- TensorFlow install as docker image tensorflow/tensorflow:1.3.0-devel-py3\r\n- TensorFlow version 1.3\r\n- Python version 3\r\n- Bazel version 0.5.0\r\n- CUDA/cuDNN version not relevant (CPU install)\r\n- GPU model and memory not relevant (CPU install)\r\n- Docker CE 17.09.0-ce\r\n\r\n`$which docker`\r\n> /usr/bin/docker\r\n\r\n**Command triggering issue**\r\n\r\n`$/tensorflow/tensorflow/tools/docker/parameterized_docker_build.sh`\r\n\r\n**Error messages**\r\n\r\n> Required build parameters:\r\n>   TF_DOCKER_BUILD_TYPE=cpu\r\n>   TF_DOCKER_BUILD_IS_DEVEL=no\r\n>   TF_DOCKER_BUILD_DEVEL_BRANCH=\r\n> \r\n> Optional build parameters:\r\n>   TF_DOCKER_BUILD_CENTRAL_PIP=http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\r\n>   TF_DOCKER_BUILD_IMAGE_NAME=\r\n>   TF_DOCKER_BUILD_VERSION=\r\n>   TF_DOCKER_BUILD_PORT=\r\n>   TF_DOCKER_BUILD_PUSH_CMD=\r\n> \r\n> FINAL_IMAGE_NAME: tensorflow/tensorflow\r\n> FINAL_TAG: latest\r\n> Original Dockerfile: /tensorflow/tensorflow/tools/docker/Dockerfile\r\n> \r\n> \r\n> Docker build will occur in temporary directory: /tmp/tmp.nBIOwyaShf\r\n> Downloading pip wheel from: http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\r\n> \r\n> Modified Dockerfile at: /tmp/tmp.nBIOwyaShf/Dockerfile\r\n> \r\n> Building docker image with image name and tag: /tensorflow:latest\r\n> invalid argument \"/tensorflow:latest\" for t: invalid reference format\r\n> See 'docker build --help'.\r\n> FAIL: docker build of /tensorflow:latest with Dockerfile /tmp/tmp.nBIOwyaShf/Dockerfile failed\r\n\r\n**Inspecting the resulting docker file for further introspection**\r\n\r\n`$cat /tmp/tmp.nBIOwyaShf/Dockerfile`\r\n\r\n> FROM ubuntu:16.04\r\n> \r\n> MAINTAINER Craig Citro <craigcitro@google.com>\r\n> \r\n> RUN apt-get update && apt-get install -y --no-install-recommends \\\r\n>         build-essential \\\r\n>         curl \\\r\n>         libfreetype6-dev \\\r\n>         libpng12-dev \\\r\n>         libzmq3-dev \\\r\n>         pkg-config \\\r\n>         python \\\r\n>         python-dev \\\r\n>         rsync \\\r\n>         software-properties-common \\\r\n>         unzip \\\r\n>         && \\\r\n>     apt-get clean && \\\r\n>     rm -rf /var/lib/apt/lists/*\r\n> \r\n> RUN curl -O https://bootstrap.pypa.io/get-pip.py && \\\r\n>     python get-pip.py && \\\r\n>     rm get-pip.py\r\n> \r\n> RUN pip --no-cache-dir install \\\r\n>         Pillow \\\r\n>         h5py \\\r\n>         ipykernel \\\r\n>         jupyter \\\r\n>         matplotlib \\\r\n>         numpy \\\r\n>         pandas \\\r\n>         scipy \\\r\n>         sklearn \\\r\n>         && \\\r\n>     python -m ipykernel.kernelspec\r\n> \r\n> RUN pip --no-cache-dir install http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\r\n> \r\n> \r\n> COPY jupyter_notebook_config.py /root/.jupyter/\r\n> \r\n> COPY notebooks /notebooks\r\n> \r\n> COPY run_jupyter.sh /\r\n> \r\n> EXPOSE 6006\r\n> EXPOSE 8888\r\n> \r\n> WORKDIR \"/notebooks\"\r\n> \r\n> CMD [\"/run_jupyter.sh\", \"--allow-root\"]\r\n\r\n**Additional introspection with docker image file**\r\n\r\nCopied and pasted the parameterized_docker_build.sh output docker file content and tried to execute on docker hub which fails.\r\n\r\nDocker hub log reports yields the following additional error information:\r\n\r\n> Step 6/9 : RUN pip --no-cache-dir install http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl\r\n> \r\n>  ---> Running in fd0d49a714e4\r\n> \r\n> \u001b[91mtensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl is not a supported wheel on this platform.\r\n> \u001b[0m\r\n> Removing intermediate container fd0d49a714e4\r\n> \r\n> The command '/bin/sh -c pip --no-cache-dir install http://ci.tensorflow.org/view/Nightly/job/nightly-python35-linux-cpu/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-1.head-cp35-cp35m-manylinux1_x86_64.whl' returned a non-zero code: 1"}