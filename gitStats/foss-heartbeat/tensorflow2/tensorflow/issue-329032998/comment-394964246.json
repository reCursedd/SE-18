{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/394964246", "html_url": "https://github.com/tensorflow/tensorflow/issues/19744#issuecomment-394964246", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19744", "id": 394964246, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDk2NDI0Ng==", "user": {"login": "jrabary", "id": 1025387, "node_id": "MDQ6VXNlcjEwMjUzODc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1025387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrabary", "html_url": "https://github.com/jrabary", "followers_url": "https://api.github.com/users/jrabary/followers", "following_url": "https://api.github.com/users/jrabary/following{/other_user}", "gists_url": "https://api.github.com/users/jrabary/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrabary/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrabary/subscriptions", "organizations_url": "https://api.github.com/users/jrabary/orgs", "repos_url": "https://api.github.com/users/jrabary/repos", "events_url": "https://api.github.com/users/jrabary/events{/privacy}", "received_events_url": "https://api.github.com/users/jrabary/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-06T07:09:36Z", "updated_at": "2018-06-06T07:09:36Z", "author_association": "NONE", "body_html": "<p>Another attempt to warm start the training with MirroredStrategy is to use <code>tf.estimator.WarmStartSetting</code> as follow :</p>\n<pre><code>ws = tf.estimator.WarmStartSettings(\n        ckpt_to_initialize_from=params['resnet_checkpoint'],\n        vars_to_warm_start='resnet50.*',\n        var_name_to_prev_var_name=var_name_to_prev_var_name\n    )\n\nsession_config = tf.ConfigProto(allow_soft_placement=True)\n\nif FLAGS.num_gpus == 0:\n        distribution = tf.contrib.distribute.OneDeviceStrategy('device:CPU:0')\nelif FLAGS.num_gpus == 1:\n        distribution = tf.contrib.distribute.OneDeviceStrategy('device:GPU:0')\nelse:\n        distribution = tf.contrib.distribute.MirroredStrategy(\n            num_gpus=FLAGS.num_gpus\n        )\nrun_config = tf.estimator.RunConfig(train_distribute=distribution,\n                                        session_config=session_config)\n\nestimator = tf.estimator.Estimator(\n        model_fn=model_function,\n        params=params,\n        config=run_config,\n        model_dir=FLAGS.model_dir,\n        warm_start_from=ws\n    )\n</code></pre>\n<p>But this fails as well, with the following error:<br>\n<code>TypeError: var MUST be one of the following: a Variable, list of Variable or PartitionedVariable, but is &lt;class 'tensorflow.contrib.distribute.python.values.MirroredVariable'&gt;</code></p>", "body_text": "Another attempt to warm start the training with MirroredStrategy is to use tf.estimator.WarmStartSetting as follow :\nws = tf.estimator.WarmStartSettings(\n        ckpt_to_initialize_from=params['resnet_checkpoint'],\n        vars_to_warm_start='resnet50.*',\n        var_name_to_prev_var_name=var_name_to_prev_var_name\n    )\n\nsession_config = tf.ConfigProto(allow_soft_placement=True)\n\nif FLAGS.num_gpus == 0:\n        distribution = tf.contrib.distribute.OneDeviceStrategy('device:CPU:0')\nelif FLAGS.num_gpus == 1:\n        distribution = tf.contrib.distribute.OneDeviceStrategy('device:GPU:0')\nelse:\n        distribution = tf.contrib.distribute.MirroredStrategy(\n            num_gpus=FLAGS.num_gpus\n        )\nrun_config = tf.estimator.RunConfig(train_distribute=distribution,\n                                        session_config=session_config)\n\nestimator = tf.estimator.Estimator(\n        model_fn=model_function,\n        params=params,\n        config=run_config,\n        model_dir=FLAGS.model_dir,\n        warm_start_from=ws\n    )\n\nBut this fails as well, with the following error:\nTypeError: var MUST be one of the following: a Variable, list of Variable or PartitionedVariable, but is <class 'tensorflow.contrib.distribute.python.values.MirroredVariable'>", "body": "Another attempt to warm start the training with MirroredStrategy is to use `tf.estimator.WarmStartSetting` as follow :\r\n\r\n```\r\nws = tf.estimator.WarmStartSettings(\r\n        ckpt_to_initialize_from=params['resnet_checkpoint'],\r\n        vars_to_warm_start='resnet50.*',\r\n        var_name_to_prev_var_name=var_name_to_prev_var_name\r\n    )\r\n\r\nsession_config = tf.ConfigProto(allow_soft_placement=True)\r\n\r\nif FLAGS.num_gpus == 0:\r\n        distribution = tf.contrib.distribute.OneDeviceStrategy('device:CPU:0')\r\nelif FLAGS.num_gpus == 1:\r\n        distribution = tf.contrib.distribute.OneDeviceStrategy('device:GPU:0')\r\nelse:\r\n        distribution = tf.contrib.distribute.MirroredStrategy(\r\n            num_gpus=FLAGS.num_gpus\r\n        )\r\nrun_config = tf.estimator.RunConfig(train_distribute=distribution,\r\n                                        session_config=session_config)\r\n\r\nestimator = tf.estimator.Estimator(\r\n        model_fn=model_function,\r\n        params=params,\r\n        config=run_config,\r\n        model_dir=FLAGS.model_dir,\r\n        warm_start_from=ws\r\n    )\r\n```\r\n\r\nBut this fails as well, with the following error:\r\n`TypeError: var MUST be one of the following: a Variable, list of Variable or PartitionedVariable, but is <class 'tensorflow.contrib.distribute.python.values.MirroredVariable'>`"}