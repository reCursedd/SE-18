{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/403176707", "html_url": "https://github.com/tensorflow/tensorflow/issues/20552#issuecomment-403176707", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20552", "id": 403176707, "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzE3NjcwNw==", "user": {"login": "Youki", "id": 1643282, "node_id": "MDQ6VXNlcjE2NDMyODI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1643282?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Youki", "html_url": "https://github.com/Youki", "followers_url": "https://api.github.com/users/Youki/followers", "following_url": "https://api.github.com/users/Youki/following{/other_user}", "gists_url": "https://api.github.com/users/Youki/gists{/gist_id}", "starred_url": "https://api.github.com/users/Youki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Youki/subscriptions", "organizations_url": "https://api.github.com/users/Youki/orgs", "repos_url": "https://api.github.com/users/Youki/repos", "events_url": "https://api.github.com/users/Youki/events{/privacy}", "received_events_url": "https://api.github.com/users/Youki/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-07T00:41:16Z", "updated_at": "2018-07-07T00:41:16Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1112263\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/facaiy\">@facaiy</a> Found that the problem can't be reproducible now. Both with/without tf.keras.Model are now working with TF &gt;= 1.8.0. Is there any update that fix this problem???</p>\n<p><strong>In TensorFlow &gt;= 1.8.0 (tested with 1.8.0 and 1.9.0-rc2) without tf.keras.Model</strong></p>\n<pre><code>def get_keras_model():\n  model = tf.keras.Sequential()\n  model.add(tf.keras.layers.InputLayer(input_shape=[28*28]))\n  model.add(tf.keras.layers.Dense(300, activation='relu'))\n  model.add(tf.keras.layers.Dense(100, activation='relu'))\n  model.add(tf.keras.layers.Dense(10, activation='softmax'))\n  model.compile(loss='categorical_crossentropy',\n                optimizer=tf.keras.optimizers.SGD(lr=0.005),\n                metrics=['accuracy'])\n  return model\n\nmodel = get_keras_model()\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir='./model')\n</code></pre>\n<pre><code>INFO:tensorflow:Using the Keras model provided.\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_service': None, '_cluster_spec': &lt;tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed725a5828&gt;, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\n</code></pre>\n<p><strong>In TensorFlow &gt;= 1.8.0 (tested with 1.8.0 and 1.9.0-rc2) with tf.keras.Model</strong></p>\n<pre><code>def get_keras_model():\n  _model = tf.keras.Sequential()\n  _model.add(tf.keras.layers.InputLayer(input_shape=[28*28]))\n  _model.add(tf.keras.layers.Dense(300, activation='relu'))\n  _model.add(tf.keras.layers.Dense(100, activation='relu'))\n  _model.add(tf.keras.layers.Dense(10, activation='softmax'))\n  model = tf.keras.Model(inputs=_model.input, outputs=_model.output)\n  model.compile(loss='categorical_crossentropy',\n                optimizer=tf.keras.optimizers.SGD(lr=0.005),\n                metrics=['accuracy'])\n  return model\n\nmodel = get_keras_model()\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir='./model')\n</code></pre>\n<pre><code>INFO:tensorflow:Using the Keras model provided.\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_service': None, '_cluster_spec': &lt;tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed6d9ceb38&gt;, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\n</code></pre>", "body_text": "@facaiy Found that the problem can't be reproducible now. Both with/without tf.keras.Model are now working with TF >= 1.8.0. Is there any update that fix this problem???\nIn TensorFlow >= 1.8.0 (tested with 1.8.0 and 1.9.0-rc2) without tf.keras.Model\ndef get_keras_model():\n  model = tf.keras.Sequential()\n  model.add(tf.keras.layers.InputLayer(input_shape=[28*28]))\n  model.add(tf.keras.layers.Dense(300, activation='relu'))\n  model.add(tf.keras.layers.Dense(100, activation='relu'))\n  model.add(tf.keras.layers.Dense(10, activation='softmax'))\n  model.compile(loss='categorical_crossentropy',\n                optimizer=tf.keras.optimizers.SGD(lr=0.005),\n                metrics=['accuracy'])\n  return model\n\nmodel = get_keras_model()\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir='./model')\n\nINFO:tensorflow:Using the Keras model provided.\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed725a5828>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\n\nIn TensorFlow >= 1.8.0 (tested with 1.8.0 and 1.9.0-rc2) with tf.keras.Model\ndef get_keras_model():\n  _model = tf.keras.Sequential()\n  _model.add(tf.keras.layers.InputLayer(input_shape=[28*28]))\n  _model.add(tf.keras.layers.Dense(300, activation='relu'))\n  _model.add(tf.keras.layers.Dense(100, activation='relu'))\n  _model.add(tf.keras.layers.Dense(10, activation='softmax'))\n  model = tf.keras.Model(inputs=_model.input, outputs=_model.output)\n  model.compile(loss='categorical_crossentropy',\n                optimizer=tf.keras.optimizers.SGD(lr=0.005),\n                metrics=['accuracy'])\n  return model\n\nmodel = get_keras_model()\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir='./model')\n\nINFO:tensorflow:Using the Keras model provided.\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed6d9ceb38>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}", "body": "@facaiy Found that the problem can't be reproducible now. Both with/without tf.keras.Model are now working with TF >= 1.8.0. Is there any update that fix this problem???\r\n\r\n**In TensorFlow >= 1.8.0 (tested with 1.8.0 and 1.9.0-rc2) without tf.keras.Model**\r\n\r\n```\r\ndef get_keras_model():\r\n  model = tf.keras.Sequential()\r\n  model.add(tf.keras.layers.InputLayer(input_shape=[28*28]))\r\n  model.add(tf.keras.layers.Dense(300, activation='relu'))\r\n  model.add(tf.keras.layers.Dense(100, activation='relu'))\r\n  model.add(tf.keras.layers.Dense(10, activation='softmax'))\r\n  model.compile(loss='categorical_crossentropy',\r\n                optimizer=tf.keras.optimizers.SGD(lr=0.005),\r\n                metrics=['accuracy'])\r\n  return model\r\n\r\nmodel = get_keras_model()\r\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir='./model')\r\n```\r\n\r\n```\r\nINFO:tensorflow:Using the Keras model provided.\r\nINFO:tensorflow:Using default config.\r\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed725a5828>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\n```\r\n\r\n**In TensorFlow >= 1.8.0 (tested with 1.8.0 and 1.9.0-rc2) with tf.keras.Model**\r\n\r\n```\r\ndef get_keras_model():\r\n  _model = tf.keras.Sequential()\r\n  _model.add(tf.keras.layers.InputLayer(input_shape=[28*28]))\r\n  _model.add(tf.keras.layers.Dense(300, activation='relu'))\r\n  _model.add(tf.keras.layers.Dense(100, activation='relu'))\r\n  _model.add(tf.keras.layers.Dense(10, activation='softmax'))\r\n  model = tf.keras.Model(inputs=_model.input, outputs=_model.output)\r\n  model.compile(loss='categorical_crossentropy',\r\n                optimizer=tf.keras.optimizers.SGD(lr=0.005),\r\n                metrics=['accuracy'])\r\n  return model\r\n\r\nmodel = get_keras_model()\r\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir='./model')\r\n```\r\n\r\n```\r\nINFO:tensorflow:Using the Keras model provided.\r\nINFO:tensorflow:Using default config.\r\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed6d9ceb38>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\n```\r\n"}