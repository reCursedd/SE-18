{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6534", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6534/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6534/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6534/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6534", "id": 197806508, "node_id": "MDU6SXNzdWUxOTc4MDY1MDg=", "number": 6534, "title": "InvalidArgumentError (see above for traceback): Nan in summary histogram for: dnn/hiddenlayer_0_activation", "user": {"login": "omarshehab", "id": 4205827, "node_id": "MDQ6VXNlcjQyMDU4Mjc=", "avatar_url": "https://avatars0.githubusercontent.com/u/4205827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omarshehab", "html_url": "https://github.com/omarshehab", "followers_url": "https://api.github.com/users/omarshehab/followers", "following_url": "https://api.github.com/users/omarshehab/following{/other_user}", "gists_url": "https://api.github.com/users/omarshehab/gists{/gist_id}", "starred_url": "https://api.github.com/users/omarshehab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omarshehab/subscriptions", "organizations_url": "https://api.github.com/users/omarshehab/orgs", "repos_url": "https://api.github.com/users/omarshehab/repos", "events_url": "https://api.github.com/users/omarshehab/events{/privacy}", "received_events_url": "https://api.github.com/users/omarshehab/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-12-28T07:02:23Z", "updated_at": "2017-01-06T00:10:24Z", "closed_at": "2017-01-06T00:10:24Z", "author_association": "NONE", "body_html": "<p>I am trying to do regression for my own data following the example of <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/learn/boston.py\">Deep Neural Network Regression with Boston Data</a>.</p>\n<p>Following is my code.</p>\n<pre><code>from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\nfrom sklearn import cross_validation\nfrom sklearn import metrics\nfrom sklearn import preprocessing\nimport tensorflow as tf\nfrom tensorflow.contrib import learn\nfrom numpy import genfromtxt\nimport numpy as np\n\n\ndef main():\n  # Load dataset\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_x.csv\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_y.csv\n\n  x_test = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_x.csv', delimiter=',')\n  y_test = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_y.csv', delimiter=',')\n  x_test = x_test.astype(np.float32, copy=False)\n  y_test = y_test.astype(np.float32, copy=False)\n  \n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_x.csv\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_y.csv\n\n  x_train = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_x.csv', delimiter=',')\n  y_train = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_y.csv', delimiter=',')\n  x_train = x_train.astype(np.float32, copy=False)\n  y_train = y_train.astype(np.float32, copy=False)\n  \n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_validate_data_x.csv\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_validate_data_y.csv\n\n  # Scale data (training set) to 0 mean and unit standard deviation.\n  # scaler = preprocessing.StandardScaler()\n  # x_train = scaler.fit_transform(x_train)\n\n  # Build 2 layer fully connected DNN with 10, 10 units respectively.\n  feature_columns = learn.infer_real_valued_columns_from_input(x_train)\n  regressor = learn.DNNRegressor(\n      feature_columns=feature_columns, hidden_units=[10, 10],optimizer=tf.train.GradientDescentOptimizer(\n      learning_rate=0.1))\n\n  # Fit\n  regressor.fit(x_train, y_train, steps=5000, batch_size=1)\n\n  # Predict and score\n  y_predicted = list(\n      regressor.predict(scaler.transform(x_test), as_iterable=True))\n  score = metrics.mean_squared_error(y_predicted, y_test)\n\n  print('MSE: {0:f}'.format(score))\n\n\nif __name__ == '__main__':\n  tf.app.run()\n</code></pre>\n<p>I am getting the following error.</p>\n<blockquote>\n<blockquote>\n<blockquote>\n<blockquote>\n<p>arm_data_regression.main()<br>\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpIda516<br>\nINFO:tensorflow:Using default config.<br>\nINFO:tensorflow:Using config: {'save_summary_steps': 100, '_num_ps_replicas': 0, '_task_type': None, '_environment': 'local', '_is_chief': True, 'save_checkpoints_secs': 600, '_cluster_spec': &lt;tensorflow.python.training.server_lib.ClusterSpec object at 0x7f5464bf7a10&gt;, 'tf_config': gpu_options {<br>\nper_process_gpu_memory_fraction: 1<br>\n}<br>\n, '_task_id': 0, 'tf_random_seed': None, 'keep_checkpoint_every_n_hours': 10000, '_evaluation_master': '', 'save_checkpoints_steps': None, '_master': '', 'keep_checkpoint_max': 5}<br>\nWARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with x is deprecated and will be removed after 2016-12-01.<br>\nInstructions for updating:<br>\nEstimator is decoupled from Scikit Learn interface by moving into<br>\nseparate class SKCompat. Arguments x, y and batch_size are only<br>\navailable in the SKCompat class, Estimator will only accept input_fn.<br>\nExample conversion:<br>\nest = Estimator(...) -&gt; est = SKCompat(Estimator(...))<br>\nWARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with y is deprecated and will be removed after 2016-12-01.<br>\nInstructions for updating:<br>\nEstimator is decoupled from Scikit Learn interface by moving into<br>\nseparate class SKCompat. Arguments x, y and batch_size are only<br>\navailable in the SKCompat class, Estimator will only accept input_fn.<br>\nExample conversion:<br>\nest = Estimator(...) -&gt; est = SKCompat(Estimator(...))<br>\nWARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with batch_size is deprecated and will be removed after 2016-12-01.<br>\nInstructions for updating:<br>\nEstimator is decoupled from Scikit Learn interface by moving into<br>\nseparate class SKCompat. Arguments x, y and batch_size are only<br>\navailable in the SKCompat class, Estimator will only accept input_fn.<br>\nExample conversion:<br>\nest = Estimator(...) -&gt; est = SKCompat(Estimator(...))<br>\nINFO:tensorflow:Summary name dnn/hiddenlayer_0:fraction_of_zero_values is illegal; using dnn/hiddenlayer_0_fraction_of_zero_values instead.<br>\nINFO:tensorflow:Summary name dnn/hiddenlayer_0:activation is illegal; using dnn/hiddenlayer_0_activation instead.<br>\nINFO:tensorflow:Summary name dnn/hiddenlayer_1:fraction_of_zero_values is illegal; using dnn/hiddenlayer_1_fraction_of_zero_values instead.<br>\nINFO:tensorflow:Summary name dnn/hiddenlayer_1:activation is illegal; using dnn/hiddenlayer_1_activation instead.<br>\nINFO:tensorflow:Summary name logits:fraction_of_zero_values is illegal; using logits_fraction_of_zero_values instead.<br>\nINFO:tensorflow:Summary name logits:activation is illegal; using logits_activation instead.<br>\nINFO:tensorflow:Create CheckpointSaverHook.<br>\nTraceback (most recent call last):<br>\nFile \"\", line 1, in <br>\nFile \"arm_data_regression.py\", line 45, in main<br>\nregressor.fit(x_train, y_train, batch_size=1)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func<br>\nreturn func(*args, **kwargs)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit<br>\nmax_steps=max_steps)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model<br>\nmax_steps=max_steps)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train<br>\nNone)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 473, in run<br>\nrun_metadata=run_metadata)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 628, in run<br>\nrun_metadata=run_metadata)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 595, in run<br>\nreturn self._sess.run(*args, **kwargs)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 729, in run<br>\nrun_metadata=run_metadata)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 595, in run<br>\nreturn self._sess.run(*args, **kwargs)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 766, in run<br>\nrun_metadata_ptr)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 964, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1014, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1034, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Nan in summary histogram for: dnn/hiddenlayer_0_activation<br>\n[[Node: dnn/hiddenlayer_0_activation = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](dnn/hiddenlayer_0_activation/tag, dnn/hiddenlayer_0/hiddenlayer_0/Relu)]]</p>\n</blockquote>\n</blockquote>\n</blockquote>\n<p>Caused by op u'dnn/hiddenlayer_0_activation', defined at:<br>\nFile \"\", line 1, in <br>\nFile \"arm_data_regression.py\", line 45, in main<br>\nregressor.fit(x_train, y_train, batch_size=1)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func<br>\nreturn func(*args, **kwargs)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit<br>\nmax_steps=max_steps)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 699, in _train_model<br>\ntrain_ops = self._get_train_ops(features, labels)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 219, in _get_train_ops<br>\nlogits = self._logits(features, is_training=True)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 312, in _logits<br>\nlogits = self._dnn_logits(features, is_training)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 295, in _dnn_logits<br>\nfeatures, self._dnn_feature_columns, is_training)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/composable_model.py\", line 360, in build_model<br>\nself._add_hidden_layer_summary(net, scope.name)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/composable_model.py\", line 322, in _add_hidden_layer_summary<br>\nsummary.histogram(\"%s:activation\" % tag, value)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/summary/summary.py\", line 205, in histogram<br>\ntag=scope.rstrip('/'), values=values, name=scope)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 139, in _histogram_summary<br>\nname=name)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op<br>\nop_def=op_def)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1128, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): Nan in summary histogram for: dnn/hiddenlayer_0_activation<br>\n[[Node: dnn/hiddenlayer_0_activation = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](dnn/hiddenlayer_0_activation/tag, dnn/hiddenlayer_0/hiddenlayer_0/Relu)]]</p>\n</blockquote>\n<p>Am I passing any deprecated argument to DNNRegressor.fit()?</p>", "body_text": "I am trying to do regression for my own data following the example of Deep Neural Network Regression with Boston Data.\nFollowing is my code.\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\nfrom sklearn import cross_validation\nfrom sklearn import metrics\nfrom sklearn import preprocessing\nimport tensorflow as tf\nfrom tensorflow.contrib import learn\nfrom numpy import genfromtxt\nimport numpy as np\n\n\ndef main():\n  # Load dataset\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_x.csv\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_y.csv\n\n  x_test = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_x.csv', delimiter=',')\n  y_test = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_y.csv', delimiter=',')\n  x_test = x_test.astype(np.float32, copy=False)\n  y_test = y_test.astype(np.float32, copy=False)\n  \n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_x.csv\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_y.csv\n\n  x_train = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_x.csv', delimiter=',')\n  y_train = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_y.csv', delimiter=',')\n  x_train = x_train.astype(np.float32, copy=False)\n  y_train = y_train.astype(np.float32, copy=False)\n  \n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_validate_data_x.csv\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_validate_data_y.csv\n\n  # Scale data (training set) to 0 mean and unit standard deviation.\n  # scaler = preprocessing.StandardScaler()\n  # x_train = scaler.fit_transform(x_train)\n\n  # Build 2 layer fully connected DNN with 10, 10 units respectively.\n  feature_columns = learn.infer_real_valued_columns_from_input(x_train)\n  regressor = learn.DNNRegressor(\n      feature_columns=feature_columns, hidden_units=[10, 10],optimizer=tf.train.GradientDescentOptimizer(\n      learning_rate=0.1))\n\n  # Fit\n  regressor.fit(x_train, y_train, steps=5000, batch_size=1)\n\n  # Predict and score\n  y_predicted = list(\n      regressor.predict(scaler.transform(x_test), as_iterable=True))\n  score = metrics.mean_squared_error(y_predicted, y_test)\n\n  print('MSE: {0:f}'.format(score))\n\n\nif __name__ == '__main__':\n  tf.app.run()\n\nI am getting the following error.\n\n\n\n\narm_data_regression.main()\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpIda516\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'save_summary_steps': 100, '_num_ps_replicas': 0, '_task_type': None, '_environment': 'local', '_is_chief': True, 'save_checkpoints_secs': 600, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f5464bf7a10>, 'tf_config': gpu_options {\nper_process_gpu_memory_fraction: 1\n}\n, '_task_id': 0, 'tf_random_seed': None, 'keep_checkpoint_every_n_hours': 10000, '_evaluation_master': '', 'save_checkpoints_steps': None, '_master': '', 'keep_checkpoint_max': 5}\nWARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with x is deprecated and will be removed after 2016-12-01.\nInstructions for updating:\nEstimator is decoupled from Scikit Learn interface by moving into\nseparate class SKCompat. Arguments x, y and batch_size are only\navailable in the SKCompat class, Estimator will only accept input_fn.\nExample conversion:\nest = Estimator(...) -> est = SKCompat(Estimator(...))\nWARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with y is deprecated and will be removed after 2016-12-01.\nInstructions for updating:\nEstimator is decoupled from Scikit Learn interface by moving into\nseparate class SKCompat. Arguments x, y and batch_size are only\navailable in the SKCompat class, Estimator will only accept input_fn.\nExample conversion:\nest = Estimator(...) -> est = SKCompat(Estimator(...))\nWARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with batch_size is deprecated and will be removed after 2016-12-01.\nInstructions for updating:\nEstimator is decoupled from Scikit Learn interface by moving into\nseparate class SKCompat. Arguments x, y and batch_size are only\navailable in the SKCompat class, Estimator will only accept input_fn.\nExample conversion:\nest = Estimator(...) -> est = SKCompat(Estimator(...))\nINFO:tensorflow:Summary name dnn/hiddenlayer_0:fraction_of_zero_values is illegal; using dnn/hiddenlayer_0_fraction_of_zero_values instead.\nINFO:tensorflow:Summary name dnn/hiddenlayer_0:activation is illegal; using dnn/hiddenlayer_0_activation instead.\nINFO:tensorflow:Summary name dnn/hiddenlayer_1:fraction_of_zero_values is illegal; using dnn/hiddenlayer_1_fraction_of_zero_values instead.\nINFO:tensorflow:Summary name dnn/hiddenlayer_1:activation is illegal; using dnn/hiddenlayer_1_activation instead.\nINFO:tensorflow:Summary name logits:fraction_of_zero_values is illegal; using logits_fraction_of_zero_values instead.\nINFO:tensorflow:Summary name logits:activation is illegal; using logits_activation instead.\nINFO:tensorflow:Create CheckpointSaverHook.\nTraceback (most recent call last):\nFile \"\", line 1, in \nFile \"arm_data_regression.py\", line 45, in main\nregressor.fit(x_train, y_train, batch_size=1)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\nreturn func(*args, **kwargs)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\nmax_steps=max_steps)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\nmax_steps=max_steps)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\nNone)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\nrun_metadata=run_metadata)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\nrun_metadata=run_metadata)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\nreturn self._sess.run(*args, **kwargs)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\nrun_metadata=run_metadata)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\nreturn self._sess.run(*args, **kwargs)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 766, in run\nrun_metadata_ptr)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 964, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\ntarget_list, options, run_metadata)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Nan in summary histogram for: dnn/hiddenlayer_0_activation\n[[Node: dnn/hiddenlayer_0_activation = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](dnn/hiddenlayer_0_activation/tag, dnn/hiddenlayer_0/hiddenlayer_0/Relu)]]\n\n\n\nCaused by op u'dnn/hiddenlayer_0_activation', defined at:\nFile \"\", line 1, in \nFile \"arm_data_regression.py\", line 45, in main\nregressor.fit(x_train, y_train, batch_size=1)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\nreturn func(*args, **kwargs)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\nmax_steps=max_steps)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 699, in _train_model\ntrain_ops = self._get_train_ops(features, labels)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 219, in _get_train_ops\nlogits = self._logits(features, is_training=True)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 312, in _logits\nlogits = self._dnn_logits(features, is_training)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 295, in _dnn_logits\nfeatures, self._dnn_feature_columns, is_training)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/composable_model.py\", line 360, in build_model\nself._add_hidden_layer_summary(net, scope.name)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/composable_model.py\", line 322, in _add_hidden_layer_summary\nsummary.histogram(\"%s:activation\" % tag, value)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/summary/summary.py\", line 205, in histogram\ntag=scope.rstrip('/'), values=values, name=scope)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 139, in _histogram_summary\nname=name)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\nop_def=op_def)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1128, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): Nan in summary histogram for: dnn/hiddenlayer_0_activation\n[[Node: dnn/hiddenlayer_0_activation = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](dnn/hiddenlayer_0_activation/tag, dnn/hiddenlayer_0/hiddenlayer_0/Relu)]]\n\nAm I passing any deprecated argument to DNNRegressor.fit()?", "body": "I am trying to do regression for my own data following the example of [Deep Neural Network Regression with Boston Data](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/learn/boston.py).\r\n\r\nFollowing is my code.\r\n\r\n```\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\nfrom sklearn import cross_validation\r\nfrom sklearn import metrics\r\nfrom sklearn import preprocessing\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib import learn\r\nfrom numpy import genfromtxt\r\nimport numpy as np\r\n\r\n\r\ndef main():\r\n  # Load dataset\r\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_x.csv\r\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_y.csv\r\n\r\n  x_test = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_x.csv', delimiter=',')\r\n  y_test = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_test_data_y.csv', delimiter=',')\r\n  x_test = x_test.astype(np.float32, copy=False)\r\n  y_test = y_test.astype(np.float32, copy=False)\r\n  \r\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_x.csv\r\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_y.csv\r\n\r\n  x_train = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_x.csv', delimiter=',')\r\n  y_train = genfromtxt('ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_training_data_y.csv', delimiter=',')\r\n  x_train = x_train.astype(np.float32, copy=False)\r\n  y_train = y_train.astype(np.float32, copy=False)\r\n  \r\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_validate_data_x.csv\r\n  # ARM4mDec2002Jul2015OklahomaV2_mar_apr_may_date_time_normalized_16000_validate_data_y.csv\r\n\r\n  # Scale data (training set) to 0 mean and unit standard deviation.\r\n  # scaler = preprocessing.StandardScaler()\r\n  # x_train = scaler.fit_transform(x_train)\r\n\r\n  # Build 2 layer fully connected DNN with 10, 10 units respectively.\r\n  feature_columns = learn.infer_real_valued_columns_from_input(x_train)\r\n  regressor = learn.DNNRegressor(\r\n      feature_columns=feature_columns, hidden_units=[10, 10],optimizer=tf.train.GradientDescentOptimizer(\r\n      learning_rate=0.1))\r\n\r\n  # Fit\r\n  regressor.fit(x_train, y_train, steps=5000, batch_size=1)\r\n\r\n  # Predict and score\r\n  y_predicted = list(\r\n      regressor.predict(scaler.transform(x_test), as_iterable=True))\r\n  score = metrics.mean_squared_error(y_predicted, y_test)\r\n\r\n  print('MSE: {0:f}'.format(score))\r\n\r\n\r\nif __name__ == '__main__':\r\n  tf.app.run()\r\n```\r\n\r\nI am getting the following error.\r\n\r\n> >>> arm_data_regression.main()\r\n> WARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpIda516\r\n> INFO:tensorflow:Using default config.\r\n> INFO:tensorflow:Using config: {'save_summary_steps': 100, '_num_ps_replicas': 0, '_task_type': None, '_environment': 'local', '_is_chief': True, 'save_checkpoints_secs': 600, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f5464bf7a10>, 'tf_config': gpu_options {\r\n>   per_process_gpu_memory_fraction: 1\r\n> }\r\n> , '_task_id': 0, 'tf_random_seed': None, 'keep_checkpoint_every_n_hours': 10000, '_evaluation_master': '', 'save_checkpoints_steps': None, '_master': '', 'keep_checkpoint_max': 5}\r\n> WARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with x is deprecated and will be removed after 2016-12-01.\r\n> Instructions for updating:\r\n> Estimator is decoupled from Scikit Learn interface by moving into\r\n> separate class SKCompat. Arguments x, y and batch_size are only\r\n> available in the SKCompat class, Estimator will only accept input_fn.\r\n> Example conversion:\r\n>   est = Estimator(...) -> est = SKCompat(Estimator(...))\r\n> WARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with y is deprecated and will be removed after 2016-12-01.\r\n> Instructions for updating:\r\n> Estimator is decoupled from Scikit Learn interface by moving into\r\n> separate class SKCompat. Arguments x, y and batch_size are only\r\n> available in the SKCompat class, Estimator will only accept input_fn.\r\n> Example conversion:\r\n>   est = Estimator(...) -> est = SKCompat(Estimator(...))\r\n> WARNING:tensorflow:From arm_data_regression.py:45 in main.: calling fit (from tensorflow.contrib.learn.python.learn.estimators.estimator) with batch_size is deprecated and will be removed after 2016-12-01.\r\n> Instructions for updating:\r\n> Estimator is decoupled from Scikit Learn interface by moving into\r\n> separate class SKCompat. Arguments x, y and batch_size are only\r\n> available in the SKCompat class, Estimator will only accept input_fn.\r\n> Example conversion:\r\n>   est = Estimator(...) -> est = SKCompat(Estimator(...))\r\n> INFO:tensorflow:Summary name dnn/hiddenlayer_0:fraction_of_zero_values is illegal; using dnn/hiddenlayer_0_fraction_of_zero_values instead.\r\n> INFO:tensorflow:Summary name dnn/hiddenlayer_0:activation is illegal; using dnn/hiddenlayer_0_activation instead.\r\n> INFO:tensorflow:Summary name dnn/hiddenlayer_1:fraction_of_zero_values is illegal; using dnn/hiddenlayer_1_fraction_of_zero_values instead.\r\n> INFO:tensorflow:Summary name dnn/hiddenlayer_1:activation is illegal; using dnn/hiddenlayer_1_activation instead.\r\n> INFO:tensorflow:Summary name logits:fraction_of_zero_values is illegal; using logits_fraction_of_zero_values instead.\r\n> INFO:tensorflow:Summary name logits:activation is illegal; using logits_activation instead.\r\n> INFO:tensorflow:Create CheckpointSaverHook.\r\n> Traceback (most recent call last):\r\n>   File \"<stdin>\", line 1, in <module>\r\n>   File \"arm_data_regression.py\", line 45, in main\r\n>     regressor.fit(x_train, y_train, batch_size=1)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\r\n>     return func(*args, **kwargs)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\r\n>     max_steps=max_steps)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 733, in _train_model\r\n>     max_steps=max_steps)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 301, in _monitored_train\r\n>     None)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 473, in run\r\n>     run_metadata=run_metadata)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 628, in run\r\n>     run_metadata=run_metadata)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\r\n>     return self._sess.run(*args, **kwargs)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 729, in run\r\n>     run_metadata=run_metadata)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 595, in run\r\n>     return self._sess.run(*args, **kwargs)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 766, in run\r\n>    run_metadata_ptr)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 964, in _run\r\n>     feed_dict_string, options, run_metadata)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1014, in _do_run\r\n>     target_list, options, run_metadata)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1034, in _do_call\r\n>     raise type(e)(node_def, op, message)\r\n> tensorflow.python.framework.errors_impl.InvalidArgumentError: Nan in summary histogram for: dnn/hiddenlayer_0_activation\r\n> \t [[Node: dnn/hiddenlayer_0_activation = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](dnn/hiddenlayer_0_activation/tag, dnn/hiddenlayer_0/hiddenlayer_0/Relu)]]\r\n> \r\n> Caused by op u'dnn/hiddenlayer_0_activation', defined at:\r\n>   File \"<stdin>\", line 1, in <module>\r\n>   File \"arm_data_regression.py\", line 45, in main\r\n>     regressor.fit(x_train, y_train, batch_size=1)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 191, in new_func\r\n>     return func(*args, **kwargs)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 355, in fit\r\n>     max_steps=max_steps)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 699, in _train_model\r\n>     train_ops = self._get_train_ops(features, labels)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 219, in _get_train_ops\r\n>     logits = self._logits(features, is_training=True)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 312, in _logits\r\n>     logits = self._dnn_logits(features, is_training)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 295, in _dnn_logits\r\n>     features, self._dnn_feature_columns, is_training)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/composable_model.py\", line 360, in build_model\r\n>     self._add_hidden_layer_summary(net, scope.name)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/composable_model.py\", line 322, in _add_hidden_layer_summary\r\n>     summary.histogram(\"%s:activation\" % tag, value)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/summary/summary.py\", line 205, in histogram\r\n>     tag=scope.rstrip('/'), values=values, name=scope)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 139, in _histogram_summary\r\n>     name=name)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 759, in apply_op\r\n>     op_def=op_def)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2240, in create_op\r\n>     original_op=self._default_original_op, op_def=op_def)\r\n>   File \"/home/shehab/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1128, in __init__\r\n>     self._traceback = _extract_stack()\r\n> \r\n> InvalidArgumentError (see above for traceback): Nan in summary histogram for: dnn/hiddenlayer_0_activation\r\n> \t [[Node: dnn/hiddenlayer_0_activation = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](dnn/hiddenlayer_0_activation/tag, dnn/hiddenlayer_0/hiddenlayer_0/Relu)]]\r\n\r\n\r\nAm I passing any deprecated argument to DNNRegressor.fit()?\r\n\r\n\r\n"}