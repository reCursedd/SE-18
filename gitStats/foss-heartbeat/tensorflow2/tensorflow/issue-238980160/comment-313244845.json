{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/313244845", "html_url": "https://github.com/tensorflow/tensorflow/issues/11091#issuecomment-313244845", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11091", "id": 313244845, "node_id": "MDEyOklzc3VlQ29tbWVudDMxMzI0NDg0NQ==", "user": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-05T22:30:59Z", "updated_at": "2017-07-05T22:30:59Z", "author_association": "MEMBER", "body_html": "<div class=\"email-fragment\">This is really hard to debug without having access to the full graph.\n\nWhat I'd do if I did have access  to the full graph would be bisect it;\nremoving chunks of graph at a time until the error in second derivative\ngoes down to see if there's some part of the code which is less numerically\nstable than it should be.</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Wed, Jul 5, 2017 at 3:17 PM, Anish Athalye ***@***.***&gt; wrote:\n Okay, so I tried the following:\n\n I have a network y(x), where y contains no tf.gradient ops, and I checked:\n\n    1.\n\n    tf.check_numerics(tf.gradients(y, x)[0]) -- result is ok\n    2.\n\n    tf.test.compute_gradient_error(x, ..., y, ...) -- result is ~ 983 (is\n    that okay? in any case, for training, first derivatives seem to work)\n    3.\n\n    tf.check_numerics(tf.gradients(tf.gradients(y, x)[0], x)[0]) -- result\n    is ok\n    4.\n\n    tf.test.compute_gradient_error(x, ..., tf.gradients(y, x)[0], ...) -\n    result is ~ 1522423936\n\n Finite differences probably isn't producing great results because y is a\n fairly big graph. But still, having a maximum error of 1e9 seems kind of\n large.\n\n What do you suggest looking into next?\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"238980160\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/11091\" href=\"https://github.com/tensorflow/tensorflow/issues/11091#issuecomment-313241964\">#11091 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AAATxdLiF38xxI13fIJsHsvl7rooT44Cks5sLAuTgaJpZM4OHLlJ\">https://github.com/notifications/unsubscribe-auth/AAATxdLiF38xxI13fIJsHsvl7rooT44Cks5sLAuTgaJpZM4OHLlJ</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n<div class=\"email-signature-reply\">-- \n - Alex</div>\n</div>", "body_text": "This is really hard to debug without having access to the full graph.\n\nWhat I'd do if I did have access  to the full graph would be bisect it;\nremoving chunks of graph at a time until the error in second derivative\ngoes down to see if there's some part of the code which is less numerically\nstable than it should be.\n\u2026\nOn Wed, Jul 5, 2017 at 3:17 PM, Anish Athalye ***@***.***> wrote:\n Okay, so I tried the following:\n\n I have a network y(x), where y contains no tf.gradient ops, and I checked:\n\n    1.\n\n    tf.check_numerics(tf.gradients(y, x)[0]) -- result is ok\n    2.\n\n    tf.test.compute_gradient_error(x, ..., y, ...) -- result is ~ 983 (is\n    that okay? in any case, for training, first derivatives seem to work)\n    3.\n\n    tf.check_numerics(tf.gradients(tf.gradients(y, x)[0], x)[0]) -- result\n    is ok\n    4.\n\n    tf.test.compute_gradient_error(x, ..., tf.gradients(y, x)[0], ...) -\n    result is ~ 1522423936\n\n Finite differences probably isn't producing great results because y is a\n fairly big graph. But still, having a maximum error of 1e9 seems kind of\n large.\n\n What do you suggest looking into next?\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#11091 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AAATxdLiF38xxI13fIJsHsvl7rooT44Cks5sLAuTgaJpZM4OHLlJ>\n .\n\n\n-- \n - Alex", "body": "This is really hard to debug without having access to the full graph.\n\nWhat I'd do if I did have access  to the full graph would be bisect it;\nremoving chunks of graph at a time until the error in second derivative\ngoes down to see if there's some part of the code which is less numerically\nstable than it should be.\n\nOn Wed, Jul 5, 2017 at 3:17 PM, Anish Athalye <notifications@github.com>\nwrote:\n\n> Okay, so I tried the following:\n>\n> I have a network y(x), where y contains no tf.gradient ops, and I checked:\n>\n>    1.\n>\n>    tf.check_numerics(tf.gradients(y, x)[0]) -- result is ok\n>    2.\n>\n>    tf.test.compute_gradient_error(x, ..., y, ...) -- result is ~ 983 (is\n>    that okay? in any case, for training, first derivatives seem to work)\n>    3.\n>\n>    tf.check_numerics(tf.gradients(tf.gradients(y, x)[0], x)[0]) -- result\n>    is ok\n>    4.\n>\n>    tf.test.compute_gradient_error(x, ..., tf.gradients(y, x)[0], ...) -\n>    result is ~ 1522423936\n>\n> Finite differences probably isn't producing great results because y is a\n> fairly big graph. But still, having a maximum error of 1e9 seems kind of\n> large.\n>\n> What do you suggest looking into next?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/11091#issuecomment-313241964>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AAATxdLiF38xxI13fIJsHsvl7rooT44Cks5sLAuTgaJpZM4OHLlJ>\n> .\n>\n\n\n\n-- \n - Alex\n"}