{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20701", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20701/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20701/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20701/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20701", "id": 340305663, "node_id": "MDU6SXNzdWUzNDAzMDU2NjM=", "number": 20701, "title": "Eager execution does not work for R interface under Python 3", "user": {"login": "jjallaire", "id": 104391, "node_id": "MDQ6VXNlcjEwNDM5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/104391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjallaire", "html_url": "https://github.com/jjallaire", "followers_url": "https://api.github.com/users/jjallaire/followers", "following_url": "https://api.github.com/users/jjallaire/following{/other_user}", "gists_url": "https://api.github.com/users/jjallaire/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjallaire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjallaire/subscriptions", "organizations_url": "https://api.github.com/users/jjallaire/orgs", "repos_url": "https://api.github.com/users/jjallaire/repos", "events_url": "https://api.github.com/users/jjallaire/events{/privacy}", "received_events_url": "https://api.github.com/users/jjallaire/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, {"login": "akshaym", "id": 122911, "node_id": "MDQ6VXNlcjEyMjkxMQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/122911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaym", "html_url": "https://github.com/akshaym", "followers_url": "https://api.github.com/users/akshaym/followers", "following_url": "https://api.github.com/users/akshaym/following{/other_user}", "gists_url": "https://api.github.com/users/akshaym/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaym/subscriptions", "organizations_url": "https://api.github.com/users/akshaym/orgs", "repos_url": "https://api.github.com/users/akshaym/repos", "events_url": "https://api.github.com/users/akshaym/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaym/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2018-07-11T15:57:32Z", "updated_at": "2018-07-16T17:21:20Z", "closed_at": "2018-07-16T17:21:20Z", "author_association": "NONE", "body_html": "<p>Hi there, I am the maintainer of the R interface to TensorFlow. We are currently in the process of porting various Eager examples to R. We haven't had trouble with Python 2 versions of TensorFlow, but with Python 3 versions we get some strange errors.</p>\n<p>I realize that this is within the R interface so technically falls outside of the scope of TF for Python. However, in order for us to address this we need some insight as to what might be different for Eager under Python 3. I'll provide a detailed repro and explanation of it's under the hood behavior below.</p>\n<p>cc <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=577277\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/martinwicke\">@martinwicke</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=19695904\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/random-forests\">@random-forests</a></p>\n<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 18.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: TensorFlow v1.10.0-dev20180710</li>\n<li><strong>Python version</strong>:  3.6.5</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A</li>\n<li><strong>GPU model and memory</strong>: N/A</li>\n<li><strong>Exact command to reproduce</strong>: See below</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Using the R interface to TensorFlow:</p>\n<div class=\"highlight highlight-source-r\"><pre>library(<span class=\"pl-smi\">tensorflow</span>)\n<span class=\"pl-smi\">tf</span><span class=\"pl-k\">$</span>enable_eager_execution()\n<span class=\"pl-smi\">x</span> <span class=\"pl-k\">&lt;-</span> <span class=\"pl-smi\">tf</span><span class=\"pl-k\">$</span>constant(<span class=\"pl-c1\">1</span>)\n<span class=\"pl-smi\">tf</span><span class=\"pl-k\">$</span>add(<span class=\"pl-smi\">x</span>, <span class=\"pl-smi\">x</span>)</pre></div>\n<p>Results in this error:</p>\n<pre><code>SystemError: &lt;built-in function TFE_Py_FastPathExecute&gt; returned a result with an error set \n</code></pre>\n<p>This error occurs within the definition of <code>add()</code> within <code>gen_math_ops.py</code>:</p>\n<div class=\"highlight highlight-source-python\"><pre>  _result <span class=\"pl-k\">=</span> _pywrap_tensorflow.TFE_Py_FastPathExecute(\n        _ctx._context_handle, _ctx._eager_context.device_name, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Add<span class=\"pl-pds\">\"</span></span>, name,\n        _ctx._post_execution_callbacks, x, y)</pre></div>\n<p>This code works as expected under TF w/ Python 2.</p>\n<p>Again, I realize that this is the R interface so you might not have an intuition about what could be wrong. You can think of the R interface conceptually as just using the C Python API to invoke functions. So in the above code we are essentially using:</p>\n<ul>\n<li><code>PyImport_Import</code> to import the tensorflow module</li>\n<li><code>PyObject_CallFunctionObjArgs</code> to call Python functions (e.g. <code>tf.enable_eager_execution</code>, <code>tf.constant</code>, etc.)</li>\n</ul>\n<p>My theory is that under Python 3 there is something being done at the Python language level that we aren't emulating or capture when calling through the Python C interface.  Hopefully this provides you with some clues as to what that might be and we will be able to make whatever changes are required to make this work within R.</p>", "body_text": "Hi there, I am the maintainer of the R interface to TensorFlow. We are currently in the process of porting various Eager examples to R. We haven't had trouble with Python 2 versions of TensorFlow, but with Python 3 versions we get some strange errors.\nI realize that this is within the R interface so technically falls outside of the scope of TF for Python. However, in order for us to address this we need some insight as to what might be different for Eager under Python 3. I'll provide a detailed repro and explanation of it's under the hood behavior below.\ncc @martinwicke @random-forests\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\nTensorFlow installed from (source or binary): Binary\nTensorFlow version (use command below): TensorFlow v1.10.0-dev20180710\nPython version:  3.6.5\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce: See below\n\nDescribe the problem\nUsing the R interface to TensorFlow:\nlibrary(tensorflow)\ntf$enable_eager_execution()\nx <- tf$constant(1)\ntf$add(x, x)\nResults in this error:\nSystemError: <built-in function TFE_Py_FastPathExecute> returned a result with an error set \n\nThis error occurs within the definition of add() within gen_math_ops.py:\n  _result = _pywrap_tensorflow.TFE_Py_FastPathExecute(\n        _ctx._context_handle, _ctx._eager_context.device_name, \"Add\", name,\n        _ctx._post_execution_callbacks, x, y)\nThis code works as expected under TF w/ Python 2.\nAgain, I realize that this is the R interface so you might not have an intuition about what could be wrong. You can think of the R interface conceptually as just using the C Python API to invoke functions. So in the above code we are essentially using:\n\nPyImport_Import to import the tensorflow module\nPyObject_CallFunctionObjArgs to call Python functions (e.g. tf.enable_eager_execution, tf.constant, etc.)\n\nMy theory is that under Python 3 there is something being done at the Python language level that we aren't emulating or capture when calling through the Python C interface.  Hopefully this provides you with some clues as to what that might be and we will be able to make whatever changes are required to make this work within R.", "body": "Hi there, I am the maintainer of the R interface to TensorFlow. We are currently in the process of porting various Eager examples to R. We haven't had trouble with Python 2 versions of TensorFlow, but with Python 3 versions we get some strange errors. \r\n\r\nI realize that this is within the R interface so technically falls outside of the scope of TF for Python. However, in order for us to address this we need some insight as to what might be different for Eager under Python 3. I'll provide a detailed repro and explanation of it's under the hood behavior below.\r\n\r\ncc @martinwicke @random-forests \r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 18.04\r\n- **TensorFlow installed from (source or binary)**: Binary\r\n- **TensorFlow version (use command below)**: TensorFlow v1.10.0-dev20180710 \r\n- **Python version**:  3.6.5\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: See below\r\n\r\n### Describe the problem\r\n\r\nUsing the R interface to TensorFlow:\r\n\r\n```r\r\nlibrary(tensorflow)\r\ntf$enable_eager_execution()\r\nx <- tf$constant(1)\r\ntf$add(x, x)\r\n```\r\n\r\nResults in this error:\r\n\r\n```\r\nSystemError: <built-in function TFE_Py_FastPathExecute> returned a result with an error set \r\n```\r\n\r\nThis error occurs within the definition of `add()` within `gen_math_ops.py`:\r\n\r\n```python\r\n  _result = _pywrap_tensorflow.TFE_Py_FastPathExecute(\r\n        _ctx._context_handle, _ctx._eager_context.device_name, \"Add\", name,\r\n        _ctx._post_execution_callbacks, x, y)\r\n```\r\n\r\nThis code works as expected under TF w/ Python 2.\r\n\r\nAgain, I realize that this is the R interface so you might not have an intuition about what could be wrong. You can think of the R interface conceptually as just using the C Python API to invoke functions. So in the above code we are essentially using:\r\n\r\n- `PyImport_Import` to import the tensorflow module\r\n- `PyObject_CallFunctionObjArgs` to call Python functions (e.g. `tf.enable_eager_execution`, `tf.constant`, etc.)\r\n\r\nMy theory is that under Python 3 there is something being done at the Python language level that we aren't emulating or capture when calling through the Python C interface.  Hopefully this provides you with some clues as to what that might be and we will be able to make whatever changes are required to make this work within R.\r\n\r\n"}