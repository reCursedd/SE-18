{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19840", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19840/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19840/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19840/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19840", "id": 330383219, "node_id": "MDU6SXNzdWUzMzAzODMyMTk=", "number": 19840, "title": "TF that is build from r1.9 - crashes with _gru_ops.so: undefined symbol: _ZN15stream_executor6Stream12ThenBlasGemmENS_4blas9TransposeES2_yyyfRKNS_12DeviceMemoryIfEEiS6_ifPS4_i ", "user": {"login": "b0noI", "id": 554101, "node_id": "MDQ6VXNlcjU1NDEwMQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/554101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b0noI", "html_url": "https://github.com/b0noI", "followers_url": "https://api.github.com/users/b0noI/followers", "following_url": "https://api.github.com/users/b0noI/following{/other_user}", "gists_url": "https://api.github.com/users/b0noI/gists{/gist_id}", "starred_url": "https://api.github.com/users/b0noI/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b0noI/subscriptions", "organizations_url": "https://api.github.com/users/b0noI/orgs", "repos_url": "https://api.github.com/users/b0noI/repos", "events_url": "https://api.github.com/users/b0noI/events{/privacy}", "received_events_url": "https://api.github.com/users/b0noI/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 24, "created_at": "2018-06-07T18:20:58Z", "updated_at": "2018-11-08T09:50:38Z", "closed_at": "2018-07-06T00:29:12Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No, I have used unchanged code from branch r1.9, commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/e1436b2952c7600c8ac88114210381db0398be16/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/e1436b2952c7600c8ac88114210381db0398be16\"><tt>e1436b2</tt></a></li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 18.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>:branch r1.9, commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/e1436b2952c7600c8ac88114210381db0398be16/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/e1436b2952c7600c8ac88114210381db0398be16\"><tt>e1436b2</tt></a></li>\n<li><strong>Python version</strong>: 3.6.5</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.10.1</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 4.8</li>\n<li><strong>CUDA/cuDNN version</strong>: 9.2/7.2</li>\n<li><strong>GPU model and memory</strong>: V100, 16Gb</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<div class=\"highlight highlight-source-shell\"><pre>git clone https://github.com/tensorflow/benchmarks.git\n<span class=\"pl-c1\">cd</span> benchmarks/scripts/tf_cnn_benchmarks\ngit checkout 551caecb936312690d6bc8c8c2e2562089e2c200\npython3 tf_cnn_benchmarks.py --data_format=NCHW --batch_size=256 --num_batches=100 --model=resnet50 --optimizer=momentum --variable_update=replicated --nodistortions --hierarchical_copy=True --gradient_repacking=8 --datasets_use_prefetch=False --display_every=10 --gpu_thread_mode=gpu_shared --num_gpus=8 --use_fp16=True</pre></div>\n<h3>Results:</h3>\n<pre><code>python3 tf_cnn_benchmarks.py --data_format=NCHW --batch_size=256 --num_batches=100 --model=resnet50 --optimizer=momentum --variable_update=replicated --nodistortions --hierarchical_copy=True --gradient_repacking=8 --datasets_use_prefetch=False --display_every=10 --gpu_thread_mode=gpu_shared --num_gpus=8 --use_fp16=True\n/usr/lib/python3/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\nTraceback (most recent call last):\n  File \"tf_cnn_benchmarks.py\", line 27, in &lt;module&gt;\n    import benchmark_cnn\n  File \"/home/vkovalevskyi/benchmarks/scripts/tf_cnn_benchmarks/benchmark_cnn.py\", line 48, in &lt;module&gt;\n    import data_utils\n  File \"/home/vkovalevskyi/benchmarks/scripts/tf_cnn_benchmarks/data_utils.py\", line 21, in &lt;module&gt;\n    from tensorflow.contrib.data.python.ops import batching\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/__init__.py\", line 35, in &lt;module&gt;\n    from tensorflow.contrib import cudnn_rnn\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/__init__.py\", line 34, in &lt;module&gt;\n    from tensorflow.contrib.cudnn_rnn.python.layers import *\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/__init__.py\", line 23, in &lt;module&gt;\n    from tensorflow.contrib.cudnn_rnn.python.layers.cudnn_rnn import *\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/cudnn_rnn.py\", line 20, in &lt;module&gt;\n    from tensorflow.contrib.cudnn_rnn.python.ops import cudnn_rnn_ops\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/ops/cudnn_rnn_ops.py\", line 22, in &lt;module&gt;\n    from tensorflow.contrib.rnn.python.ops import lstm_ops\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/__init__.py\", line 88, in &lt;module&gt;\n    from tensorflow.contrib.rnn.python.ops.gru_ops import *\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/python/ops/gru_ops.py\", line 33, in &lt;module&gt;\n    resource_loader.get_path_to_datafile(\"_gru_ops.so\"))\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\n    ret = load_library.load_op_library(path)\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/python/framework/load_library.py\", line 56, in load_op_library\n    lib_handle = py_tf.TF_LoadLibrary(library_filename)\ntensorflow.python.framework.errors_impl.NotFoundError: /home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/python/ops/_gru_ops.so: undefined symbol: _ZN15stream_executor6Stream12ThenBlasGemmENS_4blas9TransposeES2_yyyfRKNS_12DeviceMemoryIfEEiS6_ifPS4_i\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No, I have used unchanged code from branch r1.9, commit e1436b2\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below):branch r1.9, commit e1436b2\nPython version: 3.6.5\nBazel version (if compiling from source): 0.10.1\nGCC/Compiler version (if compiling from source): 4.8\nCUDA/cuDNN version: 9.2/7.2\nGPU model and memory: V100, 16Gb\nExact command to reproduce:\n\ngit clone https://github.com/tensorflow/benchmarks.git\ncd benchmarks/scripts/tf_cnn_benchmarks\ngit checkout 551caecb936312690d6bc8c8c2e2562089e2c200\npython3 tf_cnn_benchmarks.py --data_format=NCHW --batch_size=256 --num_batches=100 --model=resnet50 --optimizer=momentum --variable_update=replicated --nodistortions --hierarchical_copy=True --gradient_repacking=8 --datasets_use_prefetch=False --display_every=10 --gpu_thread_mode=gpu_shared --num_gpus=8 --use_fp16=True\nResults:\npython3 tf_cnn_benchmarks.py --data_format=NCHW --batch_size=256 --num_batches=100 --model=resnet50 --optimizer=momentum --variable_update=replicated --nodistortions --hierarchical_copy=True --gradient_repacking=8 --datasets_use_prefetch=False --display_every=10 --gpu_thread_mode=gpu_shared --num_gpus=8 --use_fp16=True\n/usr/lib/python3/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\nTraceback (most recent call last):\n  File \"tf_cnn_benchmarks.py\", line 27, in <module>\n    import benchmark_cnn\n  File \"/home/vkovalevskyi/benchmarks/scripts/tf_cnn_benchmarks/benchmark_cnn.py\", line 48, in <module>\n    import data_utils\n  File \"/home/vkovalevskyi/benchmarks/scripts/tf_cnn_benchmarks/data_utils.py\", line 21, in <module>\n    from tensorflow.contrib.data.python.ops import batching\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/__init__.py\", line 35, in <module>\n    from tensorflow.contrib import cudnn_rnn\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/__init__.py\", line 34, in <module>\n    from tensorflow.contrib.cudnn_rnn.python.layers import *\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/__init__.py\", line 23, in <module>\n    from tensorflow.contrib.cudnn_rnn.python.layers.cudnn_rnn import *\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/cudnn_rnn.py\", line 20, in <module>\n    from tensorflow.contrib.cudnn_rnn.python.ops import cudnn_rnn_ops\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/ops/cudnn_rnn_ops.py\", line 22, in <module>\n    from tensorflow.contrib.rnn.python.ops import lstm_ops\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/__init__.py\", line 88, in <module>\n    from tensorflow.contrib.rnn.python.ops.gru_ops import *\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/python/ops/gru_ops.py\", line 33, in <module>\n    resource_loader.get_path_to_datafile(\"_gru_ops.so\"))\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\n    ret = load_library.load_op_library(path)\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/python/framework/load_library.py\", line 56, in load_op_library\n    lib_handle = py_tf.TF_LoadLibrary(library_filename)\ntensorflow.python.framework.errors_impl.NotFoundError: /home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/python/ops/_gru_ops.so: undefined symbol: _ZN15stream_executor6Stream12ThenBlasGemmENS_4blas9TransposeES2_yyyfRKNS_12DeviceMemoryIfEEiS6_ifPS4_i", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No, I have used unchanged code from branch r1.9, commit e1436b2952c7600c8ac88114210381db0398be16\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**:branch r1.9, commit e1436b2952c7600c8ac88114210381db0398be16\r\n- **Python version**: 3.6.5\r\n- **Bazel version (if compiling from source)**: 0.10.1\r\n- **GCC/Compiler version (if compiling from source)**: 4.8\r\n- **CUDA/cuDNN version**: 9.2/7.2\r\n- **GPU model and memory**: V100, 16Gb\r\n- **Exact command to reproduce**:\r\n\r\n```bash\r\ngit clone https://github.com/tensorflow/benchmarks.git\r\ncd benchmarks/scripts/tf_cnn_benchmarks\r\ngit checkout 551caecb936312690d6bc8c8c2e2562089e2c200\r\npython3 tf_cnn_benchmarks.py --data_format=NCHW --batch_size=256 --num_batches=100 --model=resnet50 --optimizer=momentum --variable_update=replicated --nodistortions --hierarchical_copy=True --gradient_repacking=8 --datasets_use_prefetch=False --display_every=10 --gpu_thread_mode=gpu_shared --num_gpus=8 --use_fp16=True\r\n```\r\n\r\n### Results:\r\n```\r\npython3 tf_cnn_benchmarks.py --data_format=NCHW --batch_size=256 --num_batches=100 --model=resnet50 --optimizer=momentum --variable_update=replicated --nodistortions --hierarchical_copy=True --gradient_repacking=8 --datasets_use_prefetch=False --display_every=10 --gpu_thread_mode=gpu_shared --num_gpus=8 --use_fp16=True\r\n/usr/lib/python3/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\nTraceback (most recent call last):\r\n  File \"tf_cnn_benchmarks.py\", line 27, in <module>\r\n    import benchmark_cnn\r\n  File \"/home/vkovalevskyi/benchmarks/scripts/tf_cnn_benchmarks/benchmark_cnn.py\", line 48, in <module>\r\n    import data_utils\r\n  File \"/home/vkovalevskyi/benchmarks/scripts/tf_cnn_benchmarks/data_utils.py\", line 21, in <module>\r\n    from tensorflow.contrib.data.python.ops import batching\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/__init__.py\", line 35, in <module>\r\n    from tensorflow.contrib import cudnn_rnn\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/__init__.py\", line 34, in <module>\r\n    from tensorflow.contrib.cudnn_rnn.python.layers import *\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/__init__.py\", line 23, in <module>\r\n    from tensorflow.contrib.cudnn_rnn.python.layers.cudnn_rnn import *\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/cudnn_rnn.py\", line 20, in <module>\r\n    from tensorflow.contrib.cudnn_rnn.python.ops import cudnn_rnn_ops\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/cudnn_rnn/python/ops/cudnn_rnn_ops.py\", line 22, in <module>\r\n    from tensorflow.contrib.rnn.python.ops import lstm_ops\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/__init__.py\", line 88, in <module>\r\n    from tensorflow.contrib.rnn.python.ops.gru_ops import *\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/python/ops/gru_ops.py\", line 33, in <module>\r\n    resource_loader.get_path_to_datafile(\"_gru_ops.so\"))\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\r\n    ret = load_library.load_op_library(path)\r\n  File \"/home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/python/framework/load_library.py\", line 56, in load_op_library\r\n    lib_handle = py_tf.TF_LoadLibrary(library_filename)\r\ntensorflow.python.framework.errors_impl.NotFoundError: /home/vkovalevskyi/.local/lib/python3.6/site-packages/tensorflow/contrib/rnn/python/ops/_gru_ops.so: undefined symbol: _ZN15stream_executor6Stream12ThenBlasGemmENS_4blas9TransposeES2_yyyfRKNS_12DeviceMemoryIfEEiS6_ifPS4_i\r\n```"}