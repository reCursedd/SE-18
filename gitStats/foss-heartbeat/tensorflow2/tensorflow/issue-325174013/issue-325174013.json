{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19455", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19455/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19455/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19455/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19455", "id": 325174013, "node_id": "MDU6SXNzdWUzMjUxNzQwMTM=", "number": 19455, "title": "CuDNN error while fitting CNN ", "user": {"login": "alenashilina", "id": 18195604, "node_id": "MDQ6VXNlcjE4MTk1NjA0", "avatar_url": "https://avatars1.githubusercontent.com/u/18195604?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alenashilina", "html_url": "https://github.com/alenashilina", "followers_url": "https://api.github.com/users/alenashilina/followers", "following_url": "https://api.github.com/users/alenashilina/following{/other_user}", "gists_url": "https://api.github.com/users/alenashilina/gists{/gist_id}", "starred_url": "https://api.github.com/users/alenashilina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alenashilina/subscriptions", "organizations_url": "https://api.github.com/users/alenashilina/orgs", "repos_url": "https://api.github.com/users/alenashilina/repos", "events_url": "https://api.github.com/users/alenashilina/events{/privacy}", "received_events_url": "https://api.github.com/users/alenashilina/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-05-22T07:37:40Z", "updated_at": "2018-11-22T18:56:48Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>OS: Windows 10 64bit<br>\nTensorFlow GPU: 1.5.0 (installed with pip)<br>\nPython Version: 3.6.4<br>\nIDE : Spyder 3.2.6<br>\nCUDA: v9.0<br>\nCuDNN: v7.0.5 for CUDA 9.0<br>\nGPU: GeForce GTX 960M 4GB<br>\nNVIDIA drivers: 397.64</p>\n<p>So, I was trying to run some CNN (and also CapsNet where the first layer is just a convolution layer). And it keeps crushing with the error below. From what I found on the internet I decided to reinstall cuda and cudnn. And the code with CNN worked. Though capsnet still didn't. I googled more and found out that cuda reset your drivers after installation, so, I needed to update my drivers. I had something like 380 or 384. Don't remember exactly. I installed 397. And now they both don't work again. I'm desperate. I don't know what to do anymore.<br>\nThe CNN code works fine on CPU though.</p>\n<p>Error given by CNN code:</p>\n<p><code>2018\udae1\udea9\udae1\udeba 15:50:40.136802: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2 2018\udae1\udea9\udae1\udeba 15:50:40.925004: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties:  name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176 pciBusID: 0000:01:00.0 totalMemory: 4.00GiB freeMemory: 3.34GiB 2018\udae1\udea9\udae1\udeba 15:50:40.930269: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011&gt; (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) 2018\udae1\udea9\udae1\udeba 15:50:47.834229: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.866263: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.905931: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.907669: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.909351: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.911059: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:48.585303: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2018\udae1\udea9\udae1\udeba 15:50:48.586924: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM 2018\udae1\udea9\udae1\udeba 15:50:48.588290: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011&gt;parent()\u2011&gt;GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &amp;algorithms)  2018\udae1\udea9\udae1\udeba 15:53:45.749902: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2 2018\udae1\udea9\udae1\udeba 15:53:46.246273: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties:  name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176 pciBusID: 0000:01:00.0 totalMemory: 4.00GiB freeMemory: 3.34GiB 2018\udae1\udea9\udae1\udeba 15:53:46.248497: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011&gt; (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) 2018\udae1\udea9\udae1\udeba 15:53:49.372376: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.373772: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.377767: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.379147: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.380568: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.382145: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.646183: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2018\udae1\udea9\udae1\udeba 15:53:49.647436: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM 2018\udae1\udea9\udae1\udeba 15:53:49.648615: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011&gt;parent()\u2011&gt;GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &amp;algorithms)</code></p>\n<p>Part of the error given by capsnet:</p>\n<p><code>2018\udae1\udea9\udae1\udeba 15:49:02.623151: W C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\bfc_allocator.cc:277] *****************************************___________________________________________________________ 2018\udae1\udea9\udae1\udeba 15:49:02.624700: W C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\framework\\op_kernel.cc:1198] Resource exhausted: OOM when allocating tensor with shape[24,6,6,3,3,32,32,4,4,4] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc 2018\udae1\udea9\udae1\udeba 16:22:12.617066: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2 2018\udae1\udea9\udae1\udeba 16:22:13.091828: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties:  name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176 pciBusID: 0000:01:00.0 totalMemory: 4.00GiB freeMemory: 3.34GiB 2018\udae1\udea9\udae1\udeba 16:22:13.094135: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011&gt; (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) 2018\udae1\udea9\udae1\udeba 16:23:36.501624: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2018\udae1\udea9\udae1\udeba 16:23:36.504510: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM 2018\udae1\udea9\udae1\udeba 16:23:36.507233: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011&gt;parent()\u2011&gt;GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &amp;algorithms)</code></p>", "body_text": "OS: Windows 10 64bit\nTensorFlow GPU: 1.5.0 (installed with pip)\nPython Version: 3.6.4\nIDE : Spyder 3.2.6\nCUDA: v9.0\nCuDNN: v7.0.5 for CUDA 9.0\nGPU: GeForce GTX 960M 4GB\nNVIDIA drivers: 397.64\nSo, I was trying to run some CNN (and also CapsNet where the first layer is just a convolution layer). And it keeps crushing with the error below. From what I found on the internet I decided to reinstall cuda and cudnn. And the code with CNN worked. Though capsnet still didn't. I googled more and found out that cuda reset your drivers after installation, so, I needed to update my drivers. I had something like 380 or 384. Don't remember exactly. I installed 397. And now they both don't work again. I'm desperate. I don't know what to do anymore.\nThe CNN code works fine on CPU though.\nError given by CNN code:\n2018\udae1\udea9\udae1\udeba 15:50:40.136802: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2 2018\udae1\udea9\udae1\udeba 15:50:40.925004: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties:  name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176 pciBusID: 0000:01:00.0 totalMemory: 4.00GiB freeMemory: 3.34GiB 2018\udae1\udea9\udae1\udeba 15:50:40.930269: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) 2018\udae1\udea9\udae1\udeba 15:50:47.834229: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.866263: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.905931: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.907669: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.909351: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:47.911059: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:50:48.585303: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2018\udae1\udea9\udae1\udeba 15:50:48.586924: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM 2018\udae1\udea9\udae1\udeba 15:50:48.588290: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011>parent()\u2011>GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &algorithms)  2018\udae1\udea9\udae1\udeba 15:53:45.749902: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2 2018\udae1\udea9\udae1\udeba 15:53:46.246273: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties:  name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176 pciBusID: 0000:01:00.0 totalMemory: 4.00GiB freeMemory: 3.34GiB 2018\udae1\udea9\udae1\udeba 15:53:46.248497: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) 2018\udae1\udea9\udae1\udeba 15:53:49.372376: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.373772: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.377767: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.379147: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.380568: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.382145: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED 2018\udae1\udea9\udae1\udeba 15:53:49.646183: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2018\udae1\udea9\udae1\udeba 15:53:49.647436: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM 2018\udae1\udea9\udae1\udeba 15:53:49.648615: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011>parent()\u2011>GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &algorithms)\nPart of the error given by capsnet:\n2018\udae1\udea9\udae1\udeba 15:49:02.623151: W C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\bfc_allocator.cc:277] *****************************************___________________________________________________________ 2018\udae1\udea9\udae1\udeba 15:49:02.624700: W C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\framework\\op_kernel.cc:1198] Resource exhausted: OOM when allocating tensor with shape[24,6,6,3,3,32,32,4,4,4] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc 2018\udae1\udea9\udae1\udeba 16:22:12.617066: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2 2018\udae1\udea9\udae1\udeba 16:22:13.091828: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties:  name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176 pciBusID: 0000:01:00.0 totalMemory: 4.00GiB freeMemory: 3.34GiB 2018\udae1\udea9\udae1\udeba 16:22:13.094135: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) 2018\udae1\udea9\udae1\udeba 16:23:36.501624: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2018\udae1\udea9\udae1\udeba 16:23:36.504510: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM 2018\udae1\udea9\udae1\udeba 16:23:36.507233: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011>parent()\u2011>GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &algorithms)", "body": "OS: Windows 10 64bit\r\nTensorFlow GPU: 1.5.0 (installed with pip)\r\nPython Version: 3.6.4\r\nIDE : Spyder 3.2.6\r\nCUDA: v9.0\r\nCuDNN: v7.0.5 for CUDA 9.0\r\nGPU: GeForce GTX 960M 4GB\r\nNVIDIA drivers: 397.64\r\n\r\n\r\nSo, I was trying to run some CNN (and also CapsNet where the first layer is just a convolution layer). And it keeps crushing with the error below. From what I found on the internet I decided to reinstall cuda and cudnn. And the code with CNN worked. Though capsnet still didn't. I googled more and found out that cuda reset your drivers after installation, so, I needed to update my drivers. I had something like 380 or 384. Don't remember exactly. I installed 397. And now they both don't work again. I'm desperate. I don't know what to do anymore.\r\nThe CNN code works fine on CPU though.\r\n\r\nError given by CNN code:\r\n\r\n` 2018\udae1\udea9\udae1\udeba 15:50:40.136802: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n2018\udae1\udea9\udae1\udeba 15:50:40.925004: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties: \r\nname: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 4.00GiB freeMemory: 3.34GiB\r\n2018\udae1\udea9\udae1\udeba 15:50:40.930269: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0)\r\n2018\udae1\udea9\udae1\udeba 15:50:47.834229: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:50:47.866263: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:50:47.905931: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:50:47.907669: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:50:47.909351: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:50:47.911059: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:50:48.585303: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2018\udae1\udea9\udae1\udeba 15:50:48.586924: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\r\n2018\udae1\udea9\udae1\udeba 15:50:48.588290: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011>parent()\u2011>GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &algorithms) \r\n2018\udae1\udea9\udae1\udeba 15:53:45.749902: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n2018\udae1\udea9\udae1\udeba 15:53:46.246273: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties: \r\nname: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 4.00GiB freeMemory: 3.34GiB\r\n2018\udae1\udea9\udae1\udeba 15:53:46.248497: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0)\r\n2018\udae1\udea9\udae1\udeba 15:53:49.372376: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:53:49.373772: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:53:49.377767: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:53:49.379147: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:53:49.380568: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:53:49.382145: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:444] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018\udae1\udea9\udae1\udeba 15:53:49.646183: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2018\udae1\udea9\udae1\udeba 15:53:49.647436: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\r\n2018\udae1\udea9\udae1\udeba 15:53:49.648615: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011>parent()\u2011>GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &algorithms) `\r\n\r\n\r\nPart of the error given by capsnet:\r\n\r\n` 2018\udae1\udea9\udae1\udeba 15:49:02.623151: W C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\bfc_allocator.cc:277] *****************************************___________________________________________________________\r\n2018\udae1\udea9\udae1\udeba 15:49:02.624700: W C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\framework\\op_kernel.cc:1198] Resource exhausted: OOM when allocating tensor with shape[24,6,6,3,3,32,32,4,4,4] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n2018\udae1\udea9\udae1\udeba 16:22:12.617066: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n2018\udae1\udea9\udae1\udeba 16:22:13.091828: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1105] Found device 0 with properties: \r\nname: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 4.00GiB freeMemory: 3.34GiB\r\n2018\udae1\udea9\udae1\udeba 16:22:13.094135: I C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) \u2011> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0)\r\n2018\udae1\udea9\udae1\udeba 16:23:36.501624: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2018\udae1\udea9\udae1\udeba 16:23:36.504510: E C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\r\n2018\udae1\udea9\udae1\udeba 16:23:36.507233: F C:\\tf_jenkins\\workspace\\rel\u2011win\\M\\windows\u2011gpu\\PY\\36\\tensorflow\\core\\kernels\\conv_ops.cc:717] Check failed: stream\u2011>parent()\u2011>GetConvolveAlgorithms( conv_parameters.ShouldIncludeWinogradNonfusedAlgo(), &algorithms) `\r\n\r\n\r\n\r\n"}