{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/263188834", "html_url": "https://github.com/tensorflow/tensorflow/pull/5813#issuecomment-263188834", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5813", "id": 263188834, "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzE4ODgzNA==", "user": {"login": "Syndrome777", "id": 6788909, "node_id": "MDQ6VXNlcjY3ODg5MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/6788909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Syndrome777", "html_url": "https://github.com/Syndrome777", "followers_url": "https://api.github.com/users/Syndrome777/followers", "following_url": "https://api.github.com/users/Syndrome777/following{/other_user}", "gists_url": "https://api.github.com/users/Syndrome777/gists{/gist_id}", "starred_url": "https://api.github.com/users/Syndrome777/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Syndrome777/subscriptions", "organizations_url": "https://api.github.com/users/Syndrome777/orgs", "repos_url": "https://api.github.com/users/Syndrome777/repos", "events_url": "https://api.github.com/users/Syndrome777/events{/privacy}", "received_events_url": "https://api.github.com/users/Syndrome777/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-28T05:51:55Z", "updated_at": "2016-11-28T06:17:18Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=684901\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/lukaszkaiser\">@lukaszkaiser</a> It seems that there may be still some bugs here to load the former saved models.<br>\nI have read the log, and It seems that the test failed at saver.restore(). I think it's triggered by that we have changed the variable's name in optimizer.<br>\nIf we remove the change that replacing 'Adam_N' with 'Adam:w' ('Adam: v'), it may be pass these failure.<br>\nDo you have any idea to deal with it?</p>\n<pre><code>Caused by op u'save/RestoreV2', defined at:\n  File \"/workspace/pip_test/tests/io_test.py\", line 123, in &lt;module&gt;\n    tf.test.main()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/test.py\", line 91, in main\n    return _googletest.main()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/googletest.py\", line 84, in main\n    benchmark.benchmarks_main(true_main=g_main)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/benchmark.py\", line 321, in benchmarks_main\n    true_main()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/googletest.py\", line 58, in g_main\n    return unittest_main(*args, **kwargs)\n  File \"/usr/lib/python2.7/unittest/main.py\", line 95, in __init__\n    self.runTests()\n  File \"/usr/lib/python2.7/unittest/main.py\", line 232, in runTests\n    self.result = testRunner.run(self.test)\n  File \"/usr/lib/python2.7/unittest/runner.py\", line 151, in run\n    test(result)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 70, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 108, in run\n    test(result)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 70, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 108, in run\n    test(result)\n  File \"/usr/lib/python2.7/unittest/case.py\", line 395, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib/python2.7/unittest/case.py\", line 331, in run\n    testMethod()\n  File \"/workspace/pip_test/tests/io_test.py\", line 64, in test_pandas_series\n    score = accuracy_score(labels, list(classifier.predict(data)))\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/linear.py\", line 68, in _as_iterable\n    for pred in preds:\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 902, in _infer_model_as_iterable\n    restore_checkpoint_path=checkpoint_path):\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 858, in run_feeds_iter\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 93, in _restore_from_checkpoint\n    saver = saver or _make_saver(graph)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 86, in _make_saver\n    max_to_keep=keep_checkpoint_max)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1028, in __init__\n    self.build()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1058, in build\n    restore_sequentially=self._restore_sequentially)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 648, in build\n    restore_sequentially, reshape)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 429, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 386, in _AddRestoreOps\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 225, in restore_op\n    [spec.tensor.dtype])[0])\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 441, in restore_v2\n    dtypes=dtypes, name=name)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2371, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1258, in __init__\n    self._traceback = _extract_stack()\n\nInternalError (see above for traceback): Overlapping slices: existing slice = 0,4:0,3, new slice = 0,4:0,3\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT64], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n</code></pre>", "body_text": "@lukaszkaiser It seems that there may be still some bugs here to load the former saved models.\nI have read the log, and It seems that the test failed at saver.restore(). I think it's triggered by that we have changed the variable's name in optimizer.\nIf we remove the change that replacing 'Adam_N' with 'Adam:w' ('Adam: v'), it may be pass these failure.\nDo you have any idea to deal with it?\nCaused by op u'save/RestoreV2', defined at:\n  File \"/workspace/pip_test/tests/io_test.py\", line 123, in <module>\n    tf.test.main()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/test.py\", line 91, in main\n    return _googletest.main()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/googletest.py\", line 84, in main\n    benchmark.benchmarks_main(true_main=g_main)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/benchmark.py\", line 321, in benchmarks_main\n    true_main()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/googletest.py\", line 58, in g_main\n    return unittest_main(*args, **kwargs)\n  File \"/usr/lib/python2.7/unittest/main.py\", line 95, in __init__\n    self.runTests()\n  File \"/usr/lib/python2.7/unittest/main.py\", line 232, in runTests\n    self.result = testRunner.run(self.test)\n  File \"/usr/lib/python2.7/unittest/runner.py\", line 151, in run\n    test(result)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 70, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 108, in run\n    test(result)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 70, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 108, in run\n    test(result)\n  File \"/usr/lib/python2.7/unittest/case.py\", line 395, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib/python2.7/unittest/case.py\", line 331, in run\n    testMethod()\n  File \"/workspace/pip_test/tests/io_test.py\", line 64, in test_pandas_series\n    score = accuracy_score(labels, list(classifier.predict(data)))\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/linear.py\", line 68, in _as_iterable\n    for pred in preds:\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 902, in _infer_model_as_iterable\n    restore_checkpoint_path=checkpoint_path):\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 858, in run_feeds_iter\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 93, in _restore_from_checkpoint\n    saver = saver or _make_saver(graph)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 86, in _make_saver\n    max_to_keep=keep_checkpoint_max)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1028, in __init__\n    self.build()\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1058, in build\n    restore_sequentially=self._restore_sequentially)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 648, in build\n    restore_sequentially, reshape)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 429, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 386, in _AddRestoreOps\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 225, in restore_op\n    [spec.tensor.dtype])[0])\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 441, in restore_v2\n    dtypes=dtypes, name=name)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2371, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1258, in __init__\n    self._traceback = _extract_stack()\n\nInternalError (see above for traceback): Overlapping slices: existing slice = 0,4:0,3, new slice = 0,4:0,3\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT64], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]", "body": "@lukaszkaiser It seems that there may be still some bugs here to load the former saved models. \r\nI have read the log, and It seems that the test failed at saver.restore(). I think it's triggered by that we have changed the variable's name in optimizer.\r\nIf we remove the change that replacing 'Adam_N' with 'Adam:w' ('Adam: v'), it may be pass these failure.\r\nDo you have any idea to deal with it?\r\n```\r\nCaused by op u'save/RestoreV2', defined at:\r\n  File \"/workspace/pip_test/tests/io_test.py\", line 123, in <module>\r\n    tf.test.main()\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/test.py\", line 91, in main\r\n    return _googletest.main()\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/googletest.py\", line 84, in main\r\n    benchmark.benchmarks_main(true_main=g_main)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/benchmark.py\", line 321, in benchmarks_main\r\n    true_main()\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/googletest.py\", line 58, in g_main\r\n    return unittest_main(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/unittest/main.py\", line 95, in __init__\r\n    self.runTests()\r\n  File \"/usr/lib/python2.7/unittest/main.py\", line 232, in runTests\r\n    self.result = testRunner.run(self.test)\r\n  File \"/usr/lib/python2.7/unittest/runner.py\", line 151, in run\r\n    test(result)\r\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 70, in __call__\r\n    return self.run(*args, **kwds)\r\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 108, in run\r\n    test(result)\r\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 70, in __call__\r\n    return self.run(*args, **kwds)\r\n  File \"/usr/lib/python2.7/unittest/suite.py\", line 108, in run\r\n    test(result)\r\n  File \"/usr/lib/python2.7/unittest/case.py\", line 395, in __call__\r\n    return self.run(*args, **kwds)\r\n  File \"/usr/lib/python2.7/unittest/case.py\", line 331, in run\r\n    testMethod()\r\n  File \"/workspace/pip_test/tests/io_test.py\", line 64, in test_pandas_series\r\n    score = accuracy_score(labels, list(classifier.predict(data)))\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/linear.py\", line 68, in _as_iterable\r\n    for pred in preds:\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 902, in _infer_model_as_iterable\r\n    restore_checkpoint_path=checkpoint_path):\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 858, in run_feeds_iter\r\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 93, in _restore_from_checkpoint\r\n    saver = saver or _make_saver(graph)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 86, in _make_saver\r\n    max_to_keep=keep_checkpoint_max)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1028, in __init__\r\n    self.build()\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1058, in build\r\n    restore_sequentially=self._restore_sequentially)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 648, in build\r\n    restore_sequentially, reshape)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 429, in _AddShardedRestoreOps\r\n    name=\"restore_shard\"))\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 386, in _AddRestoreOps\r\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 225, in restore_op\r\n    [spec.tensor.dtype])[0])\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 441, in restore_v2\r\n    dtypes=dtypes, name=name)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2371, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/workspace/pip_test/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1258, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInternalError (see above for traceback): Overlapping slices: existing slice = 0,4:0,3, new slice = 0,4:0,3\r\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT64], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\r\n```"}