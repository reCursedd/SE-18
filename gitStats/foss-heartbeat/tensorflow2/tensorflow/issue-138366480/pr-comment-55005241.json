{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/55005241", "pull_request_review_id": null, "id": 55005241, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDA1MjQx", "diff_hunk": "@@ -0,0 +1,126 @@\n+#!/usr/bin/env bash\n+# Copyright 2016 Google Inc. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+# ==============================================================================\n+#\n+# Build and test TensorFlow docker images.\n+# The tests include Python unit tests-on-install and tutorial tests.\n+#\n+# Usage: docker_test.sh <IMAGE_TYPE> <TAG> <WHL_PATH>\n+# Arguments:\n+#   IMAGE_TYPE : Type of the image: (CPU|GPU)\n+#   TAG        : Docker image tag\n+#   WHL_PATH   : Path to the whl file to be installed inside the docker image\n+#\n+#   e.g.: docker_test.sh CPU someone/tensorflow:0.8.0 pip_test/whl/tensorflow-0.8.0-cp27-none-linux_x86_64.whl\n+#\n+\n+# Helper functions\n+# Exit after a failure\n+die() {\n+  echo $@\n+  exit 1\n+}\n+\n+# Convert to lower case\n+to_lower () {\n+  echo \"$1\" | tr '[:upper:]' '[:lower:]'\n+}\n+\n+\n+# Helper function to traverse directories up until given file is found.\n+function upsearch () {\n+  test / == \"$PWD\" && return || \\\n+      test -e \"$1\" && echo \"$PWD\" && return || \\\n+      cd .. && upsearch \"$1\"\n+}\n+\n+\n+# Verify command line argument\n+if [[ $# != \"3\" ]]; then\n+  die \"Usage: $(basename $0) <IMAGE_TYPE> <TAG> <WHL_PATH>\"\n+fi\n+IMAGE_TYPE=$(to_lower \"$1\")\n+DOCKER_IMG_TAG=$2\n+WHL_PATH=$3\n+\n+# Verify image type\n+if [[ \"${IMAGE_TYPE}\" == \"cpu\" ]]; then\n+  DOCKERFILE=\"tensorflow/tools/docker/Dockerfile\"\n+elif [[ \"${IMAGE_TYPE}\" == \"gpu\" ]]; then\n+  DOCKERFILE=\"tensorflow/tools/docker/Dockerfile.gpu\"\n+else\n+  die \"Unrecognized image type: $1\"\n+fi\n+\n+# Verify docker binary existence\n+if [[ -z $(which docker) ]]; then\n+  die \"FAILED: docker binary unavailable\"\n+fi\n+\n+# Locate the base directory\n+BASE_DIR=$(upsearch \"${DOCKERFILE}\")\n+if [[ -z \"${BASE_DIR}\" ]]; then\n+  die \"FAILED: Unable to find the base directory where the dockerfile \"\\\n+\"${DOCKERFFILE} resides\"\n+fi\n+echo \"Base directory: ${BASE_DIR}\"\n+\n+pushd ${BASE_DIR} > /dev/null\n+\n+# Build docker image\n+DOCKERFILE_PATH=\"${BASE_DIR}/${DOCKERFILE}\"\n+DOCKERFILE_DIR=\"$(dirname ${DOCKERFILE_PATH})\"\n+\n+# Check to make sure that the whl file exists\n+test -f ${WHL_PATH} || die \"whl file does not exist: ${WHL_PATH}\"\n+\n+TMP_WHL_DIR=\"${DOCKERFILE_DIR}/whl\"\n+mkdir -p \"${TMP_WHL_DIR}\"\n+cp \"${WHL_PATH}\" \"${TMP_WHL_DIR}/\" \\\n+|| die \"FAILED to copy whl file from ${WHL_PATH} to ${TMP_WHL_DIR}/\"", "path": "tensorflow/tools/ci_build/builds/docker_test.sh", "position": null, "original_position": 92, "commit_id": "8082cf2ffdfab0842b479bdec214d7463322fe50", "original_commit_id": "0de5a91dfca931c900a025647aac6ae0a95bd375", "user": {"login": "jendap", "id": 567848, "node_id": "MDQ6VXNlcjU2Nzg0OA==", "avatar_url": "https://avatars0.githubusercontent.com/u/567848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jendap", "html_url": "https://github.com/jendap", "followers_url": "https://api.github.com/users/jendap/followers", "following_url": "https://api.github.com/users/jendap/following{/other_user}", "gists_url": "https://api.github.com/users/jendap/gists{/gist_id}", "starred_url": "https://api.github.com/users/jendap/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jendap/subscriptions", "organizations_url": "https://api.github.com/users/jendap/orgs", "repos_url": "https://api.github.com/users/jendap/repos", "events_url": "https://api.github.com/users/jendap/events{/privacy}", "received_events_url": "https://api.github.com/users/jendap/received_events", "type": "User", "site_admin": false}, "body": "nit: the || is usually written at the end of first line ( ... || \\ ) and next line have some (four) spaces at the beginning\n", "created_at": "2016-03-04T09:03:05Z", "updated_at": "2016-03-05T00:18:04Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/1380#discussion_r55005241", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1380", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/55005241"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/1380#discussion_r55005241"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1380"}}, "body_html": "<p>nit: the || is usually written at the end of first line ( ... || \\ ) and next line have some (four) spaces at the beginning</p>", "body_text": "nit: the || is usually written at the end of first line ( ... || \\ ) and next line have some (four) spaces at the beginning"}