{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/210181623", "html_url": "https://github.com/tensorflow/tensorflow/issues/1934#issuecomment-210181623", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1934", "id": 210181623, "node_id": "MDEyOklzc3VlQ29tbWVudDIxMDE4MTYyMw==", "user": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "created_at": "2016-04-14T22:23:27Z", "updated_at": "2016-04-14T22:23:27Z", "author_association": "MEMBER", "body_html": "<p>If you replace write</p>\n<p>sub_op = tf.assign_sub(A, B)</p>\n<p>then the broadcasting happens implicitly in the underlying Eigen<br>\nexpression, and the memory overhead should be minimal.</p>\n<p>(Low level code is here:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/dense_update_ops.h#L43\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/dense_update_ops.h#L43</a><br>\n)</p>\n<p>Rasmus</p>\n<p>On Thu, Apr 14, 2016 at 9:44 AM, zffchen78 <a href=\"mailto:notifications@github.com\">notifications@github.com</a> wrote:</p>\n<blockquote>\n<p>On q1.</p>\n<p>Because A - B is an automatic broadcasting binary operation. A - B does<br>\nnot require B to be expanded to use 2.5GB. Only the result needs to be<br>\nallocated (2.5GB). So, the peak memory usage in your code snippet should be<br>\n2.5GB + 500KB + 2.5GB.</p>\n<p>On q2.</p>\n<p>It's been worked on. There can be multiple approaches to this issue: a)<br>\nextend assign_sub() to support broadcasting; b) support inplace operationos<br>\nlike -=, +=, etc.</p>\n<p>\u2014<br>\nYou are receiving this because you were assigned.<br>\nReply to this email directly or view it on GitHub<br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"148266318\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1934\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1934/hovercard?comment_id=210042344&amp;comment_type=issue_comment\" href=\"https://github.com/tensorflow/tensorflow/issues/1934#issuecomment-210042344\">#1934 (comment)</a></p>\n</blockquote>", "body_text": "If you replace write\nsub_op = tf.assign_sub(A, B)\nthen the broadcasting happens implicitly in the underlying Eigen\nexpression, and the memory overhead should be minimal.\n(Low level code is here:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/dense_update_ops.h#L43\n)\nRasmus\nOn Thu, Apr 14, 2016 at 9:44 AM, zffchen78 notifications@github.com wrote:\n\nOn q1.\nBecause A - B is an automatic broadcasting binary operation. A - B does\nnot require B to be expanded to use 2.5GB. Only the result needs to be\nallocated (2.5GB). So, the peak memory usage in your code snippet should be\n2.5GB + 500KB + 2.5GB.\nOn q2.\nIt's been worked on. There can be multiple approaches to this issue: a)\nextend assign_sub() to support broadcasting; b) support inplace operationos\nlike -=, +=, etc.\n\u2014\nYou are receiving this because you were assigned.\nReply to this email directly or view it on GitHub\n#1934 (comment)", "body": "If you replace write\n\nsub_op = tf.assign_sub(A, B)\n\nthen the broadcasting happens implicitly in the underlying Eigen\nexpression, and the memory overhead should be minimal.\n\n(Low level code is here:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/dense_update_ops.h#L43\n)\n\nRasmus\n\nOn Thu, Apr 14, 2016 at 9:44 AM, zffchen78 notifications@github.com wrote:\n\n> On q1.\n> \n> Because A - B is an automatic broadcasting binary operation. A - B does\n> not require B to be expanded to use 2.5GB. Only the result needs to be\n> allocated (2.5GB). So, the peak memory usage in your code snippet should be\n> 2.5GB + 500KB + 2.5GB.\n> \n> On q2.\n> \n> It's been worked on. There can be multiple approaches to this issue: a)\n> extend assign_sub() to support broadcasting; b) support inplace operationos\n> like -=, +=, etc.\n> \n> \u2014\n> You are receiving this because you were assigned.\n> Reply to this email directly or view it on GitHub\n> https://github.com/tensorflow/tensorflow/issues/1934#issuecomment-210042344\n"}