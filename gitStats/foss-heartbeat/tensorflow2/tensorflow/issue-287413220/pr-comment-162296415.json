{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/162296415", "pull_request_review_id": 89726813, "id": 162296415, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjI5NjQxNQ==", "diff_hunk": "@@ -1045,12 +1058,30 @@ void RdmaTensorResponse::RecvHandler(Rendezvous::ParsedKey parsed,\n         << \" gpu_info: \" << src_dev->tensorflow_gpu_device_info();\n \n     if (can_memcpy) {\n+      // If the tensor is located on a GDR compatible GPU, there is no need to\n+      // copy it. We can send directly from the source, just need to make sure\n+      // we are in sync with the GPU stream.\n+      // If the tensor's meta-data changed however, we will need to clone it,\n+      // so anyway we'll have to copy it from GPU to CPU first. If at some\n+      // point in time Clone() is changed to only save a shallow copy, we can\n+      // skip the copy here as well.\n+      if ((in.TotalBytes() > 0) && !meta_data_changed_ &&", "path": "tensorflow/contrib/verbs/rdma.cc", "position": 862, "original_position": 39, "commit_id": "c9189ae40f9860f77fe6a3741d287b049184d5f2", "original_commit_id": "d6faa02e29a4b50f2a393b28f1dbe468f4a5814d", "user": {"login": "shamoya", "id": 22274255, "node_id": "MDQ6VXNlcjIyMjc0MjU1", "avatar_url": "https://avatars2.githubusercontent.com/u/22274255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shamoya", "html_url": "https://github.com/shamoya", "followers_url": "https://api.github.com/users/shamoya/followers", "following_url": "https://api.github.com/users/shamoya/following{/other_user}", "gists_url": "https://api.github.com/users/shamoya/gists{/gist_id}", "starred_url": "https://api.github.com/users/shamoya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shamoya/subscriptions", "organizations_url": "https://api.github.com/users/shamoya/orgs", "repos_url": "https://api.github.com/users/shamoya/repos", "events_url": "https://api.github.com/users/shamoya/events{/privacy}", "received_events_url": "https://api.github.com/users/shamoya/received_events", "type": "User", "site_admin": false}, "body": "Thanks @poxvoculi !\r\nCan we merge/cherry-pick this into r1.5 branch as well ?\r\nIn terms of the binary release, it doesn't affect anything, as this code is compiled out of the binary anyway. So users needs to clone the repo and recompile this with VERBs support anyway.\r\nHowever, it's much easier for users to work with a specific branch version instead of working with master (which can bring a lot of API changes and stability) or a sporadic HASH.\r\n", "created_at": "2018-01-18T10:04:54Z", "updated_at": "2018-01-18T10:04:54Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/16005#discussion_r162296415", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/16005", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/162296415"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/16005#discussion_r162296415"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/16005"}}, "body_html": "<p>Thanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15676913\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/poxvoculi\">@poxvoculi</a> !<br>\nCan we merge/cherry-pick this into r1.5 branch as well ?<br>\nIn terms of the binary release, it doesn't affect anything, as this code is compiled out of the binary anyway. So users needs to clone the repo and recompile this with VERBs support anyway.<br>\nHowever, it's much easier for users to work with a specific branch version instead of working with master (which can bring a lot of API changes and stability) or a sporadic HASH.</p>", "body_text": "Thanks @poxvoculi !\nCan we merge/cherry-pick this into r1.5 branch as well ?\nIn terms of the binary release, it doesn't affect anything, as this code is compiled out of the binary anyway. So users needs to clone the repo and recompile this with VERBs support anyway.\nHowever, it's much easier for users to work with a specific branch version instead of working with master (which can bring a lot of API changes and stability) or a sporadic HASH.", "in_reply_to_id": 162230570}