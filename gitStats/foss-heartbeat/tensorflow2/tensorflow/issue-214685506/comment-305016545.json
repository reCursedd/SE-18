{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/305016545", "html_url": "https://github.com/tensorflow/tensorflow/issues/8466#issuecomment-305016545", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8466", "id": 305016545, "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTAxNjU0NQ==", "user": {"login": "hartb", "id": 18429659, "node_id": "MDQ6VXNlcjE4NDI5NjU5", "avatar_url": "https://avatars1.githubusercontent.com/u/18429659?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hartb", "html_url": "https://github.com/hartb", "followers_url": "https://api.github.com/users/hartb/followers", "following_url": "https://api.github.com/users/hartb/following{/other_user}", "gists_url": "https://api.github.com/users/hartb/gists{/gist_id}", "starred_url": "https://api.github.com/users/hartb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hartb/subscriptions", "organizations_url": "https://api.github.com/users/hartb/orgs", "repos_url": "https://api.github.com/users/hartb/repos", "events_url": "https://api.github.com/users/hartb/events{/privacy}", "received_events_url": "https://api.github.com/users/hartb/received_events", "type": "User", "site_admin": false}, "created_at": "2017-05-30T21:39:53Z", "updated_at": "2017-05-30T21:39:53Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I'm able to reproduce this on a POWER system with:</p>\n<ul>\n<li>TensorFlow        1.1.0</li>\n<li>Ubuntu            16.04.2 (kernel 4.4.0-77-generic)</li>\n<li>libc6:ppc64el     2.23-0ubuntu7</li>\n<li>cuda-cudart-8-0   8.0.61-1</li>\n<li>GPU driver        375.51</li>\n</ul>\n<p>In a crash I caught, it looks like there are 2 mutexes and 2 or 3 threads involved.</p>\n<p>First mutex is wanted by thread 1 (110471 / 0x1af87), and seems to be owned by thead 17 (110465 / 0x1af81). Thread 1 detects a deadlock while trying to acquire and asserts.</p>\n<p>(In the core file, this mutex appears locked by thread 113 (110449 / 0x1af71) which conflicts with the ownership recorded in the mutex. But it also appears to be marked as if the owner has died, so maybe thread 113 had been waiting and made a bit of progress after thread 1 hit the assert().)</p>\n<pre><code>(gdb) x/20x 0x100056c7e40\n0x100056c7e40:  0xc001af71      0x00000001      0x0001af81      0x00000001\n                __lock          __count         __owner         __nusers\n0x100056c7e50:  0x00000021      0x00000000      0x00000000      0x00000000\n                __kind\n</code></pre>\n<p>Second mutex is wanted by thead 17 (110465 / 0x1af81) and is locked by thread 1 (110471 / 0x1af87).</p>\n<pre><code>(gdb) x/8x 0x3fff57d39e78\n0x3fff57d39e78: 0x8001af87      0x00000001      0x00000000      0x00000000\n                __lock          __count         __owner         __nusers\n0x3fff57d39e88: 0x00000021      0x00000000      0x00000000      0x00000000\n                __kind\n</code></pre>\n<p>All three of the involved threads had come through cudaLaunch() and are somewhere in libcuda:</p>\n<pre><code>Thread 1 (Thread 0x3bffad57f1a0 (LWP 110471)):\n#0  0x00003fffa027edb0 in __GI_raise (sig=&lt;optimized out&gt;) at ../sysdeps/unix/sysv/linux/raise.c:54\n#1  0x00003fffa0281270 in __GI_abort () at abort.c:89\n#2  0x00003fffa0274290 in __assert_fail_base (fmt=&lt;optimized out&gt;,\n    assertion=0x3fffa04296e8 \"INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP &amp;&amp; kind != PTHREAD_MUTEX_RECURSIVE_NP)\",\n    file=0x3fffa04296c8 \"../nptl/pthread_mutex_lock.c\", line=&lt;optimized out&gt;, function=&lt;optimized out&gt;) at assert.c:92\n#3  0x00003fffa0274384 in __GI___assert_fail (\n    assertion=0x3fffa04296e8 \"INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP &amp;&amp; kind != PTHREAD_MUTEX_RECURSIVE_NP)\",\n    file=0x3fffa04296c8 \"../nptl/pthread_mutex_lock.c\", line=&lt;optimized out&gt;, function=0x3fffa0429830 &lt;__PRETTY_FUNCTION__.9294&gt; \"__pthread_mutex_lock_full\") at assert.c:101\n#4  0x00003fffa041b400 in __pthread_mutex_lock_full (mutex=0x100056c7e40) at ../nptl/pthread_mutex_lock.c:347\n#5  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#6  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#7  0x00003fff8b806ef4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#8  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#9  0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#10 0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#11 0x00003fff909d4678 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#12 0x00003fff909e95e0 in tensorflow::functor::CastFunctor&lt;Eigen::GpuDevice, float, unsigned char&gt;::operator()(Eigen::GpuDevice const&amp;, Eigen::TensorMap&lt;Eigen::Tensor&lt;float, 1, 1, long&gt;, 16,\n Eigen::MakePointer&gt;, Eigen::TensorMap&lt;Eigen::Tensor&lt;unsigned char const, 1, 1, long&gt;, 16, Eigen::MakePointer&gt;) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#13 0x00003fff909d0c6c in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#14 0x00003fff9096c03c in tensorflow::CastOpBase::Compute(tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#15 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#16 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#17 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#18 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl&lt;tensorflow::thread::EigenEnvironment&gt;::WorkerLoop(int) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#19 0x00003fff91ee1688 in std::_Function_handler&lt;void (), Eigen::NonBlockingThreadPoolTempl&lt;tensorflow::thread::EigenEnvironment&gt;::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\nigenEnvironment)::{lambda()#1}&gt;::_M_invoke(std::_Any_data const&amp;) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#20 0x00003fff91eddf74 in std::_Function_handler&lt;void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function&lt;void ()&gt;)::{lambda()#1}&gt;::_M_invoke(std::_Any_data const&amp;) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#21 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#22 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\n#23 0x00003fffa0418070 in start_thread (arg=0x3bffad57f1a0) at pthread_create.c:335\n#24 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\n\n\nThread 17 (Thread 0x3bffb057f1a0 (LWP 110465)):\n#0  0x00003fffa041adc4 in __pthread_mutex_lock_full (mutex=0x3fff57d39e78) at ../nptl/pthread_mutex_lock.c:339\n#1  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#2  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#3  0x00003fff8b929e28 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#4  0x00003fff8b8f95ac in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#5  0x00003fff8b90cab0 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#6  0x00003fff8ba9a454 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#7  0x00003fff8b806cec in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#8  0x00003fff8b806f38 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#9  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#10 0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#11 0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#12 0x00003fff90bc9e08 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#13 0x00003fff90be4a50 in void tensorflow::functor::ReduceFunctor&lt;Eigen::GpuDevice, Eigen::internal::ProdReducer&lt;int&gt; &gt;::Reduce&lt;Eigen::TensorMap&lt;Eigen::Tensor&lt;int, 0, 1, long&gt;, 16, Eigen::Ma\nkePointer&gt;, Eigen::TensorMap&lt;Eigen::Tensor&lt;int const, 1, 1, long&gt;, 16, Eigen::MakePointer&gt;, Eigen::array&lt;long, 1ul&gt; &gt;(Eigen::GpuDevice const&amp;, Eigen::TensorMap&lt;Eigen::Tensor&lt;int, 0, 1, long&gt;\n, 16, Eigen::MakePointer&gt;, Eigen::TensorMap&lt;Eigen::Tensor&lt;int const, 1, 1, long&gt;, 16, Eigen::MakePointer&gt;, Eigen::array&lt;long, 1ul&gt; const&amp;, Eigen::internal::ProdReducer&lt;int&gt; const&amp;) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#14 0x00003fff90b919c4 in tensorflow::ReductionOp&lt;Eigen::GpuDevice, int, Eigen::internal::ProdReducer&lt;int&gt; &gt;::Compute(tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#15 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#16 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#17 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#18 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl&lt;tensorflow::thread::EigenEnvironment&gt;::WorkerLoop(int) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#19 0x00003fff91ee1688 in std::_Function_handler&lt;void (), Eigen::NonBlockingThreadPoolTempl&lt;tensorflow::thread::EigenEnvironment&gt;::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\nigenEnvironment)::{lambda()#1}&gt;::_M_invoke(std::_Any_data const&amp;) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#20 0x00003fff91eddf74 in std::_Function_handler&lt;void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function&lt;void ()&gt;)::{lambda()#1}&gt;::_M_invoke(std::_Any_data const&amp;) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#21 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#22 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\n#23 0x00003fffa0418070 in start_thread (arg=0x3bffb057f1a0) at pthread_create.c:335\n#24 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\n\n\nThread 113 (Thread 0x3bffb857f1a0 (LWP 110449)):\n#0  0x00003fffa041adc4 in __pthread_mutex_lock_full (mutex=0x100056c7e40) at ../nptl/pthread_mutex_lock.c:339\n#1  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#2  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#3  0x00003fff8b806ef4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#4  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#5  0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#6  0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#7  0x00003fff909d3238 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#8  0x00003fff909e38e0 in tensorflow::functor::CastFunctor&lt;Eigen::GpuDevice, int, unsigned char&gt;::operator()(Eigen::GpuDevice const&amp;, Eigen::TensorMap&lt;Eigen::Tensor&lt;int, 1, 1, long&gt;, 16, Eig\nen::MakePointer&gt;, Eigen::TensorMap&lt;Eigen::Tensor&lt;unsigned char const, 1, 1, long&gt;, 16, Eigen::MakePointer&gt;) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#9  0x00003fff909d099c in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#10 0x00003fff9096c03c in tensorflow::CastOpBase::Compute(tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#11 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#12 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#13 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#14 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl&lt;tensorflow::thread::EigenEnvironment&gt;::WorkerLoop(int) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#15 0x00003fff91ee1688 in std::_Function_handler&lt;void (), Eigen::NonBlockingThreadPoolTempl&lt;tensorflow::thread::EigenEnvironment&gt;::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\nigenEnvironment)::{lambda()#1}&gt;::_M_invoke(std::_Any_data const&amp;) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#16 0x00003fff91eddf74 in std::_Function_handler&lt;void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function&lt;void ()&gt;)::{lambda()#1}&gt;::_M_invoke(std::_Any_data const&amp;) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#17 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#18 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#19 0x00003fffa0418070 in start_thread (arg=0x3bffb857f1a0) at pthread_create.c:335\n#20 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\n</code></pre>", "body_text": "I'm able to reproduce this on a POWER system with:\n\nTensorFlow        1.1.0\nUbuntu            16.04.2 (kernel 4.4.0-77-generic)\nlibc6:ppc64el     2.23-0ubuntu7\ncuda-cudart-8-0   8.0.61-1\nGPU driver        375.51\n\nIn a crash I caught, it looks like there are 2 mutexes and 2 or 3 threads involved.\nFirst mutex is wanted by thread 1 (110471 / 0x1af87), and seems to be owned by thead 17 (110465 / 0x1af81). Thread 1 detects a deadlock while trying to acquire and asserts.\n(In the core file, this mutex appears locked by thread 113 (110449 / 0x1af71) which conflicts with the ownership recorded in the mutex. But it also appears to be marked as if the owner has died, so maybe thread 113 had been waiting and made a bit of progress after thread 1 hit the assert().)\n(gdb) x/20x 0x100056c7e40\n0x100056c7e40:  0xc001af71      0x00000001      0x0001af81      0x00000001\n                __lock          __count         __owner         __nusers\n0x100056c7e50:  0x00000021      0x00000000      0x00000000      0x00000000\n                __kind\n\nSecond mutex is wanted by thead 17 (110465 / 0x1af81) and is locked by thread 1 (110471 / 0x1af87).\n(gdb) x/8x 0x3fff57d39e78\n0x3fff57d39e78: 0x8001af87      0x00000001      0x00000000      0x00000000\n                __lock          __count         __owner         __nusers\n0x3fff57d39e88: 0x00000021      0x00000000      0x00000000      0x00000000\n                __kind\n\nAll three of the involved threads had come through cudaLaunch() and are somewhere in libcuda:\nThread 1 (Thread 0x3bffad57f1a0 (LWP 110471)):\n#0  0x00003fffa027edb0 in __GI_raise (sig=<optimized out>) at ../sysdeps/unix/sysv/linux/raise.c:54\n#1  0x00003fffa0281270 in __GI_abort () at abort.c:89\n#2  0x00003fffa0274290 in __assert_fail_base (fmt=<optimized out>,\n    assertion=0x3fffa04296e8 \"INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)\",\n    file=0x3fffa04296c8 \"../nptl/pthread_mutex_lock.c\", line=<optimized out>, function=<optimized out>) at assert.c:92\n#3  0x00003fffa0274384 in __GI___assert_fail (\n    assertion=0x3fffa04296e8 \"INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)\",\n    file=0x3fffa04296c8 \"../nptl/pthread_mutex_lock.c\", line=<optimized out>, function=0x3fffa0429830 <__PRETTY_FUNCTION__.9294> \"__pthread_mutex_lock_full\") at assert.c:101\n#4  0x00003fffa041b400 in __pthread_mutex_lock_full (mutex=0x100056c7e40) at ../nptl/pthread_mutex_lock.c:347\n#5  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#6  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#7  0x00003fff8b806ef4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#8  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#9  0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#10 0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#11 0x00003fff909d4678 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#12 0x00003fff909e95e0 in tensorflow::functor::CastFunctor<Eigen::GpuDevice, float, unsigned char>::operator()(Eigen::GpuDevice const&, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16,\n Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<unsigned char const, 1, 1, long>, 16, Eigen::MakePointer>) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#13 0x00003fff909d0c6c in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#14 0x00003fff9096c03c in tensorflow::CastOpBase::Compute(tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#15 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#16 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#17 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#18 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#19 0x00003fff91ee1688 in std::_Function_handler<void (), Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\nigenEnvironment)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#20 0x00003fff91eddf74 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#21 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#22 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\n#23 0x00003fffa0418070 in start_thread (arg=0x3bffad57f1a0) at pthread_create.c:335\n#24 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\n\n\nThread 17 (Thread 0x3bffb057f1a0 (LWP 110465)):\n#0  0x00003fffa041adc4 in __pthread_mutex_lock_full (mutex=0x3fff57d39e78) at ../nptl/pthread_mutex_lock.c:339\n#1  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#2  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#3  0x00003fff8b929e28 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#4  0x00003fff8b8f95ac in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#5  0x00003fff8b90cab0 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#6  0x00003fff8ba9a454 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#7  0x00003fff8b806cec in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#8  0x00003fff8b806f38 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#9  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#10 0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#11 0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#12 0x00003fff90bc9e08 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#13 0x00003fff90be4a50 in void tensorflow::functor::ReduceFunctor<Eigen::GpuDevice, Eigen::internal::ProdReducer<int> >::Reduce<Eigen::TensorMap<Eigen::Tensor<int, 0, 1, long>, 16, Eigen::Ma\nkePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::array<long, 1ul> >(Eigen::GpuDevice const&, Eigen::TensorMap<Eigen::Tensor<int, 0, 1, long>\n, 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::array<long, 1ul> const&, Eigen::internal::ProdReducer<int> const&) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#14 0x00003fff90b919c4 in tensorflow::ReductionOp<Eigen::GpuDevice, int, Eigen::internal::ProdReducer<int> >::Compute(tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#15 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#16 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#17 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#18 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#19 0x00003fff91ee1688 in std::_Function_handler<void (), Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\nigenEnvironment)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#20 0x00003fff91eddf74 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#21 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#22 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\n#23 0x00003fffa0418070 in start_thread (arg=0x3bffb057f1a0) at pthread_create.c:335\n#24 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\n\n\nThread 113 (Thread 0x3bffb857f1a0 (LWP 110449)):\n#0  0x00003fffa041adc4 in __pthread_mutex_lock_full (mutex=0x100056c7e40) at ../nptl/pthread_mutex_lock.c:339\n#1  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#2  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#3  0x00003fff8b806ef4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#4  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\n#5  0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#6  0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\n#7  0x00003fff909d3238 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#8  0x00003fff909e38e0 in tensorflow::functor::CastFunctor<Eigen::GpuDevice, int, unsigned char>::operator()(Eigen::GpuDevice const&, Eigen::TensorMap<Eigen::Tensor<int, 1, 1, long>, 16, Eig\nen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<unsigned char const, 1, 1, long>, 16, Eigen::MakePointer>) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#9  0x00003fff909d099c in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#10 0x00003fff9096c03c in tensorflow::CastOpBase::Compute(tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#11 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#12 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#13 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#14 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#15 0x00003fff91ee1688 in std::_Function_handler<void (), Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\nigenEnvironment)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#16 0x00003fff91eddf74 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()\n   from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#17 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\n#18 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\n---Type <return> to continue, or q <return> to quit---\n#19 0x00003fffa0418070 in start_thread (arg=0x3bffb857f1a0) at pthread_create.c:335\n#20 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96", "body": "I'm able to reproduce this on a POWER system with:\r\n\r\n- TensorFlow        1.1.0\r\n- Ubuntu            16.04.2 (kernel 4.4.0-77-generic)\r\n- libc6:ppc64el     2.23-0ubuntu7\r\n- cuda-cudart-8-0   8.0.61-1\r\n- GPU driver        375.51\r\n\r\nIn a crash I caught, it looks like there are 2 mutexes and 2 or 3 threads involved.\r\n\r\nFirst mutex is wanted by thread 1 (110471 / 0x1af87), and seems to be owned by thead 17 (110465 / 0x1af81). Thread 1 detects a deadlock while trying to acquire and asserts.\r\n\r\n(In the core file, this mutex appears locked by thread 113 (110449 / 0x1af71) which conflicts with the ownership recorded in the mutex. But it also appears to be marked as if the owner has died, so maybe thread 113 had been waiting and made a bit of progress after thread 1 hit the assert().)\r\n\r\n    (gdb) x/20x 0x100056c7e40\r\n    0x100056c7e40:  0xc001af71      0x00000001      0x0001af81      0x00000001\r\n                    __lock          __count         __owner         __nusers\r\n    0x100056c7e50:  0x00000021      0x00000000      0x00000000      0x00000000\r\n                    __kind\r\n\r\nSecond mutex is wanted by thead 17 (110465 / 0x1af81) and is locked by thread 1 (110471 / 0x1af87).\r\n\r\n    (gdb) x/8x 0x3fff57d39e78\r\n    0x3fff57d39e78: 0x8001af87      0x00000001      0x00000000      0x00000000\r\n                    __lock          __count         __owner         __nusers\r\n    0x3fff57d39e88: 0x00000021      0x00000000      0x00000000      0x00000000\r\n                    __kind\r\n\r\nAll three of the involved threads had come through cudaLaunch() and are somewhere in libcuda:\r\n\r\n    Thread 1 (Thread 0x3bffad57f1a0 (LWP 110471)):\r\n    #0  0x00003fffa027edb0 in __GI_raise (sig=<optimized out>) at ../sysdeps/unix/sysv/linux/raise.c:54\r\n    #1  0x00003fffa0281270 in __GI_abort () at abort.c:89\r\n    #2  0x00003fffa0274290 in __assert_fail_base (fmt=<optimized out>,\r\n        assertion=0x3fffa04296e8 \"INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)\",\r\n        file=0x3fffa04296c8 \"../nptl/pthread_mutex_lock.c\", line=<optimized out>, function=<optimized out>) at assert.c:92\r\n    #3  0x00003fffa0274384 in __GI___assert_fail (\r\n        assertion=0x3fffa04296e8 \"INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)\",\r\n        file=0x3fffa04296c8 \"../nptl/pthread_mutex_lock.c\", line=<optimized out>, function=0x3fffa0429830 <__PRETTY_FUNCTION__.9294> \"__pthread_mutex_lock_full\") at assert.c:101\r\n    #4  0x00003fffa041b400 in __pthread_mutex_lock_full (mutex=0x100056c7e40) at ../nptl/pthread_mutex_lock.c:347\r\n    #5  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #6  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #7  0x00003fff8b806ef4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #8  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #9  0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n    #10 0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n    #11 0x00003fff909d4678 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #12 0x00003fff909e95e0 in tensorflow::functor::CastFunctor<Eigen::GpuDevice, float, unsigned char>::operator()(Eigen::GpuDevice const&, Eigen::TensorMap<Eigen::Tensor<float, 1, 1, long>, 16,\r\n     Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<unsigned char const, 1, 1, long>, 16, Eigen::MakePointer>) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #13 0x00003fff909d0c6c in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #14 0x00003fff9096c03c in tensorflow::CastOpBase::Compute(tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #15 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #16 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #17 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #18 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #19 0x00003fff91ee1688 in std::_Function_handler<void (), Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\r\n    igenEnvironment)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #20 0x00003fff91eddf74 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #21 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #22 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\r\n    #23 0x00003fffa0418070 in start_thread (arg=0x3bffad57f1a0) at pthread_create.c:335\r\n    #24 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\r\n\r\n\r\n    Thread 17 (Thread 0x3bffb057f1a0 (LWP 110465)):\r\n    #0  0x00003fffa041adc4 in __pthread_mutex_lock_full (mutex=0x3fff57d39e78) at ../nptl/pthread_mutex_lock.c:339\r\n    #1  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #2  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #3  0x00003fff8b929e28 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #4  0x00003fff8b8f95ac in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #5  0x00003fff8b90cab0 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #6  0x00003fff8ba9a454 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #7  0x00003fff8b806cec in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #8  0x00003fff8b806f38 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #9  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #10 0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n    #11 0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n    #12 0x00003fff90bc9e08 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #13 0x00003fff90be4a50 in void tensorflow::functor::ReduceFunctor<Eigen::GpuDevice, Eigen::internal::ProdReducer<int> >::Reduce<Eigen::TensorMap<Eigen::Tensor<int, 0, 1, long>, 16, Eigen::Ma\r\n    kePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::array<long, 1ul> >(Eigen::GpuDevice const&, Eigen::TensorMap<Eigen::Tensor<int, 0, 1, long>\r\n    , 16, Eigen::MakePointer>, Eigen::TensorMap<Eigen::Tensor<int const, 1, 1, long>, 16, Eigen::MakePointer>, Eigen::array<long, 1ul> const&, Eigen::internal::ProdReducer<int> const&) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #14 0x00003fff90b919c4 in tensorflow::ReductionOp<Eigen::GpuDevice, int, Eigen::internal::ProdReducer<int> >::Compute(tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #15 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #16 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #17 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #18 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #19 0x00003fff91ee1688 in std::_Function_handler<void (), Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\r\n    igenEnvironment)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #20 0x00003fff91eddf74 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #21 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #22 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\r\n    #23 0x00003fffa0418070 in start_thread (arg=0x3bffb057f1a0) at pthread_create.c:335\r\n    #24 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\r\n\r\n\r\n    Thread 113 (Thread 0x3bffb857f1a0 (LWP 110449)):\r\n    #0  0x00003fffa041adc4 in __pthread_mutex_lock_full (mutex=0x100056c7e40) at ../nptl/pthread_mutex_lock.c:339\r\n    #1  0x00003fff8b94e268 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #2  0x00003fff8b9202d8 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #3  0x00003fff8b806ef4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #4  0x00003fff8b9a46f8 in cuLaunchKernel () from /usr/lib/powerpc64le-linux-gnu/libcuda.so.1\r\n    #5  0x00003fff7596f0b8 in ?? () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n    #6  0x00003fff759bda88 in cudaLaunch () from /usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n    #7  0x00003fff909d3238 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #8  0x00003fff909e38e0 in tensorflow::functor::CastFunctor<Eigen::GpuDevice, int, unsigned char>::operator()(Eigen::GpuDevice const&, Eigen::TensorMap<Eigen::Tensor<int, 1, 1, long>, 16, Eig\r\n    en::MakePointer>, Eigen::TensorMap<Eigen::Tensor<unsigned char const, 1, 1, long>, 16, Eigen::MakePointer>) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #9  0x00003fff909d099c in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #10 0x00003fff9096c03c in tensorflow::CastOpBase::Compute(tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #11 0x00003fff91a8332c in tensorflow::BaseGPUDevice::ComputeHelper(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #12 0x00003fff91a83778 in tensorflow::BaseGPUDevice::Compute(tensorflow::OpKernel*, tensorflow::OpKernelContext*) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #13 0x00003fff91ac6e20 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #14 0x00003fff91ee0d30 in Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #15 0x00003fff91ee1688 in std::_Function_handler<void (), Eigen::NonBlockingThreadPoolTempl<tensorflow::thread::EigenEnvironment>::NonBlockingThreadPoolTempl(int, bool, tensorflow::thread::E\r\n    igenEnvironment)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #16 0x00003fff91eddf74 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()\r\n       from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #17 0x00003fff91f12f90 in ?? () from /opt/DL/tensorflow/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n    #18 0x00003fff758049a4 in ?? () from /usr/lib/powerpc64le-linux-gnu/libstdc++.so.6\r\n    ---Type <return> to continue, or q <return> to quit---\r\n    #19 0x00003fffa0418070 in start_thread (arg=0x3bffb857f1a0) at pthread_create.c:335\r\n    #20 0x00003fffa0363230 in clone () at ../sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S:96\r\n"}