{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8466", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8466/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8466/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8466/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8466", "id": 214685506, "node_id": "MDU6SXNzdWUyMTQ2ODU1MDY=", "number": 8466, "title": "python: ../nptl/pthread_mutex_lock.c:349: __pthread_mutex_lock_full: Assertion `INTERNAL_SYSCALL_ERRNO (e, __err) != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)' failed.", "user": {"login": "pedropgusmao", "id": 847743, "node_id": "MDQ6VXNlcjg0Nzc0Mw==", "avatar_url": "https://avatars2.githubusercontent.com/u/847743?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pedropgusmao", "html_url": "https://github.com/pedropgusmao", "followers_url": "https://api.github.com/users/pedropgusmao/followers", "following_url": "https://api.github.com/users/pedropgusmao/following{/other_user}", "gists_url": "https://api.github.com/users/pedropgusmao/gists{/gist_id}", "starred_url": "https://api.github.com/users/pedropgusmao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pedropgusmao/subscriptions", "organizations_url": "https://api.github.com/users/pedropgusmao/orgs", "repos_url": "https://api.github.com/users/pedropgusmao/repos", "events_url": "https://api.github.com/users/pedropgusmao/events{/privacy}", "received_events_url": "https://api.github.com/users/pedropgusmao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2017-03-16T12:16:09Z", "updated_at": "2017-09-08T04:55:21Z", "closed_at": "2017-09-08T04:55:21Z", "author_association": "NONE", "body_html": "<p>Tensorflow is crashing when run using multiple GPUs (2,3,and 4) on cifar10_multi_gpu .py example in a Power8 computer.</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>We have found some suggestions regarding updating glibc (<a href=\"https://bugs.launchpad.net/ubuntu/+source/glibc/+bug/1642390?cm_mc_uid=49967414488814888059863&amp;cm_mc_sid_50200000=1489663906\" rel=\"nofollow\">https://bugs.launchpad.net/ubuntu/+source/glibc/+bug/1642390?cm_mc_uid=49967414488814888059863&amp;cm_mc_sid_50200000=1489663906</a>), but our system is already updated to the latest version and the problem remains.<br>\nWe have also used ppc64_pc to reduce SMT (to 2)  and also turned off. Still the problem remains.</p>\n<h3>Environment info</h3>\n<p><em>Operating System:<br>\nDistributor ID:\tUbuntu<br>\nDescription:\tUbuntu 16.04.2 LTS<br>\nRelease:\t16.04<br>\nCodename:\txenial<br>\nLinux minsky31 4.4.0-64-generic <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"116063037\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/85\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/85/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/85\">#85</a>-Ubuntu SMP Mon Feb 20 17:05:51 UTC 2017 ppc64le ppc64le ppc64le GNU/Linux</em></p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):<br>\n<em>CUDA<br>\n-rw-r--r-- 1 root root 559800 gen 27 00:10 /usr/local/cuda/lib64/libcudadevrt.a<br>\nlrwxrwxrwx 1 root root     16 gen 27 00:13 /usr/local/cuda/lib64/libcudart.so -&gt; libcudart.so.8.0<br>\nlrwxrwxrwx 1 root root     19 gen 27 00:13 /usr/local/cuda/lib64/libcudart.so.8.0 -&gt; libcudart.so.8.0.61<br>\n-rw-r--r-- 1 root root 476024 gen 27 00:10 /usr/local/cuda/lib64/libcudart.so.8.0.61<br>\n-rw-r--r-- 1 root root 966166 gen 27 00:10 /usr/local/cuda/lib64/libcudart_static.a<br>\ncuDNN<br>\n/usr/lib/powerpc64le-linux-gnu/libcudnn_static.a<br>\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so.5.1.10<br>\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so<br>\n/usr/lib/powerpc64le-linux-gnu/libcudnn_static_v5.a<br>\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so.5</em></p>\n<p>If installed from source, provide<br>\n<em>1. The commit hash (<code>git rev-parse HEAD</code>):<br>\n<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/012f9c10dcc27a838ed4b170b9036483bc2c5869/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/012f9c10dcc27a838ed4b170b9036483bc2c5869\"><tt>012f9c1</tt></a></em></p>\n<ol start=\"2\">\n<li>The output of <code>bazel version</code>:<br>\n<em>Build label: 0.4.3-2017-01-24 (@6fc5c53)<br>\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar<br>\nBuild time: Tue Jan 24 20:34:16 2017 (1485290056)<br>\nBuild timestamp: 1485290056<br>\nBuild timestamp as int: 1485290056</em></li>\n</ol>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<p><em>We downloaded the files from <a href=\"https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10\">https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10</a><br>\nand tried to run the cifar10_multi_gpu example using four P100 gpus.</em></p>\n<h3>What other attempted solutions have you tried?</h3>\n<p>We tried removing the calls from measuring time, logging etc, but the problem remains.</p>\n<h3>Logs or other output that would be helpful</h3>\n<p>(If logs are large, please upload as attachment or provide link).</p>\n<p><em>When it blocks, it simply hangs<br>\n2017-03-16 12:09:56.391752: step 800, loss = 3.33 (2982.8 examples/sec; 0.011 sec/batch)<br>\n2017-03-16 12:09:57.002419: step 810, loss = 3.49 (3998.9 examples/sec; 0.008 sec/batch)<br>\n2017-03-16 12:09:57.476172: step 820, loss = 3.24 (3003.8 examples/sec; 0.011 sec/batch)<br>\nand the result from strace when it blocks:<br>\nstrace: Process 111228 attached<br>\nfutex(0x3fffd5d49744, FUTEX_WAIT_PRIVATE, 1, NULL</em></p>\n<p>Otherwise, when it gives the error :<br>\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x10013f8cf10, FUTEX_WAKE_PRIVATE, 1) = 1<br>\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)<br>\nfutex(0x10013f8cf10, FUTEX_WAKE_PRIVATE, 1) = 1<br>\nfutex(0x3fffd1afc324, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3fffd1afc2f8, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x3fffd1afc324, FUTEX_WAIT_PRIVATE, 1, NULL &lt;unfinished ...&gt;<br>\n+++ killed by SIGABRT (core dumped) +++</p>\n<p>strace gives as last lines:<br>\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nfutex(0x3bff90000020, FUTEX_WAKE_PRIVATE, 1) = 1<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0<br>\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0<br>\nstat(\"/etc/localtime\", {st_mode=S_IFREG|0644, st_size=2692, ...}) = 0<br>\nwrite(1, \"2017-03-16 12:22:38.084717: step\"..., 90) = 90<br>\nfutex(0x1001efacf10, FUTEX_WAKE_PRIVATE, 1) = 1<br>\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0<br>\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)<br>\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL</p>", "body_text": "Tensorflow is crashing when run using multiple GPUs (2,3,and 4) on cifar10_multi_gpu .py example in a Power8 computer.\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nWe have found some suggestions regarding updating glibc (https://bugs.launchpad.net/ubuntu/+source/glibc/+bug/1642390?cm_mc_uid=49967414488814888059863&cm_mc_sid_50200000=1489663906), but our system is already updated to the latest version and the problem remains.\nWe have also used ppc64_pc to reduce SMT (to 2)  and also turned off. Still the problem remains.\nEnvironment info\nOperating System:\nDistributor ID:\tUbuntu\nDescription:\tUbuntu 16.04.2 LTS\nRelease:\t16.04\nCodename:\txenial\nLinux minsky31 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 17:05:51 UTC 2017 ppc64le ppc64le ppc64le GNU/Linux\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\nCUDA\n-rw-r--r-- 1 root root 559800 gen 27 00:10 /usr/local/cuda/lib64/libcudadevrt.a\nlrwxrwxrwx 1 root root     16 gen 27 00:13 /usr/local/cuda/lib64/libcudart.so -> libcudart.so.8.0\nlrwxrwxrwx 1 root root     19 gen 27 00:13 /usr/local/cuda/lib64/libcudart.so.8.0 -> libcudart.so.8.0.61\n-rw-r--r-- 1 root root 476024 gen 27 00:10 /usr/local/cuda/lib64/libcudart.so.8.0.61\n-rw-r--r-- 1 root root 966166 gen 27 00:10 /usr/local/cuda/lib64/libcudart_static.a\ncuDNN\n/usr/lib/powerpc64le-linux-gnu/libcudnn_static.a\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so.5.1.10\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so\n/usr/lib/powerpc64le-linux-gnu/libcudnn_static_v5.a\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so.5\nIf installed from source, provide\n1. The commit hash (git rev-parse HEAD):\n012f9c1\n\nThe output of bazel version:\nBuild label: 0.4.3-2017-01-24 (@6fc5c53)\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Tue Jan 24 20:34:16 2017 (1485290056)\nBuild timestamp: 1485290056\nBuild timestamp as int: 1485290056\n\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nWe downloaded the files from https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10\nand tried to run the cifar10_multi_gpu example using four P100 gpus.\nWhat other attempted solutions have you tried?\nWe tried removing the calls from measuring time, logging etc, but the problem remains.\nLogs or other output that would be helpful\n(If logs are large, please upload as attachment or provide link).\nWhen it blocks, it simply hangs\n2017-03-16 12:09:56.391752: step 800, loss = 3.33 (2982.8 examples/sec; 0.011 sec/batch)\n2017-03-16 12:09:57.002419: step 810, loss = 3.49 (3998.9 examples/sec; 0.008 sec/batch)\n2017-03-16 12:09:57.476172: step 820, loss = 3.24 (3003.8 examples/sec; 0.011 sec/batch)\nand the result from strace when it blocks:\nstrace: Process 111228 attached\nfutex(0x3fffd5d49744, FUTEX_WAIT_PRIVATE, 1, NULL\nOtherwise, when it gives the error :\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x10013f8cf10, FUTEX_WAKE_PRIVATE, 1) = 1\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)\nfutex(0x10013f8cf10, FUTEX_WAKE_PRIVATE, 1) = 1\nfutex(0x3fffd1afc324, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3fffd1afc2f8, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x3fffd1afc324, FUTEX_WAIT_PRIVATE, 1, NULL <unfinished ...>\n+++ killed by SIGABRT (core dumped) +++\nstrace gives as last lines:\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nfutex(0x3bff90000020, FUTEX_WAKE_PRIVATE, 1) = 1\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\nstat(\"/etc/localtime\", {st_mode=S_IFREG|0644, st_size=2692, ...}) = 0\nwrite(1, \"2017-03-16 12:22:38.084717: step\"..., 90) = 90\nfutex(0x1001efacf10, FUTEX_WAKE_PRIVATE, 1) = 1\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL", "body": "Tensorflow is crashing when run using multiple GPUs (2,3,and 4) on cifar10_multi_gpu .py example in a Power8 computer.\r\n\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nWe have found some suggestions regarding updating glibc (https://bugs.launchpad.net/ubuntu/+source/glibc/+bug/1642390?cm_mc_uid=49967414488814888059863&cm_mc_sid_50200000=1489663906), but our system is already updated to the latest version and the problem remains.\r\nWe have also used ppc64_pc to reduce SMT (to 2)  and also turned off. Still the problem remains. \r\n\r\n### Environment info\r\n_Operating System:\r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 16.04.2 LTS\r\nRelease:\t16.04\r\nCodename:\txenial\r\nLinux minsky31 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 17:05:51 UTC 2017 ppc64le ppc64le ppc64le GNU/Linux_\r\n\r\n\r\nInstalled version of CUDA and cuDNN: \r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n_CUDA\r\n-rw-r--r-- 1 root root 559800 gen 27 00:10 /usr/local/cuda/lib64/libcudadevrt.a\r\nlrwxrwxrwx 1 root root     16 gen 27 00:13 /usr/local/cuda/lib64/libcudart.so -> libcudart.so.8.0\r\nlrwxrwxrwx 1 root root     19 gen 27 00:13 /usr/local/cuda/lib64/libcudart.so.8.0 -> libcudart.so.8.0.61\r\n-rw-r--r-- 1 root root 476024 gen 27 00:10 /usr/local/cuda/lib64/libcudart.so.8.0.61\r\n-rw-r--r-- 1 root root 966166 gen 27 00:10 /usr/local/cuda/lib64/libcudart_static.a\r\ncuDNN\r\n/usr/lib/powerpc64le-linux-gnu/libcudnn_static.a\r\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so.5.1.10\r\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so\r\n/usr/lib/powerpc64le-linux-gnu/libcudnn_static_v5.a\r\n/usr/lib/powerpc64le-linux-gnu/libcudnn.so.5_\r\n\r\n\r\nIf installed from source, provide \r\n_1. The commit hash (`git rev-parse HEAD`):\r\n012f9c10dcc27a838ed4b170b9036483bc2c5869_\r\n\r\n2. The output of `bazel version`:\r\n_Build label: 0.4.3-2017-01-24 (@6fc5c53)\r\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Tue Jan 24 20:34:16 2017 (1485290056)\r\nBuild timestamp: 1485290056\r\nBuild timestamp as int: 1485290056_\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n_We downloaded the files from https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10\r\nand tried to run the cifar10_multi_gpu example using four P100 gpus._ \r\n\r\n### What other attempted solutions have you tried?\r\nWe tried removing the calls from measuring time, logging etc, but the problem remains. \r\n\r\n### Logs or other output that would be helpful\r\n(If logs are large, please upload as attachment or provide link).\r\n\r\n_When it blocks, it simply hangs \r\n2017-03-16 12:09:56.391752: step 800, loss = 3.33 (2982.8 examples/sec; 0.011 sec/batch)\r\n2017-03-16 12:09:57.002419: step 810, loss = 3.49 (3998.9 examples/sec; 0.008 sec/batch)\r\n2017-03-16 12:09:57.476172: step 820, loss = 3.24 (3003.8 examples/sec; 0.011 sec/batch)\r\nand the result from strace when it blocks:\r\nstrace: Process 111228 attached\r\nfutex(0x3fffd5d49744, FUTEX_WAIT_PRIVATE, 1, NULL_\r\n\r\nOtherwise, when it gives the error : \r\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x10013f8cf10, FUTEX_WAKE_PRIVATE, 1) = 1\r\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x10013f8cf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)\r\nfutex(0x10013f8cf10, FUTEX_WAKE_PRIVATE, 1) = 1\r\nfutex(0x3fffd1afc324, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3fffd1afc2f8, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x3fffd1afc324, FUTEX_WAIT_PRIVATE, 1, NULL <unfinished ...>\r\n+++ killed by SIGABRT (core dumped) +++\r\n\r\n\r\nstrace gives as last lines:\r\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nfutex(0x3bff90000020, FUTEX_WAKE_PRIVATE, 1) = 1\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL) = 0\r\nfutex(0x3ffff8dbd158, FUTEX_WAKE_PRIVATE, 1) = 0\r\nstat(\"/etc/localtime\", {st_mode=S_IFREG|0644, st_size=2692, ...}) = 0\r\nwrite(1, \"2017-03-16 12:22:38.084717: step\"..., 90) = 90\r\nfutex(0x1001efacf10, FUTEX_WAKE_PRIVATE, 1) = 1\r\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = 0\r\nfutex(0x1001efacf10, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 0, NULL, ffffffff) = -1 EAGAIN (Resource temporarily unavailable)\r\nfutex(0x3ffff8dbd184, FUTEX_WAIT_PRIVATE, 1, NULL\r\n\r\n\r\n"}