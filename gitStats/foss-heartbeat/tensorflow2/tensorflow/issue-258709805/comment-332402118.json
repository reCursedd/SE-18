{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/332402118", "html_url": "https://github.com/tensorflow/tensorflow/issues/13146#issuecomment-332402118", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13146", "id": 332402118, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjQwMjExOA==", "user": {"login": "tumusudheer", "id": 3826735, "node_id": "MDQ6VXNlcjM4MjY3MzU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3826735?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tumusudheer", "html_url": "https://github.com/tumusudheer", "followers_url": "https://api.github.com/users/tumusudheer/followers", "following_url": "https://api.github.com/users/tumusudheer/following{/other_user}", "gists_url": "https://api.github.com/users/tumusudheer/gists{/gist_id}", "starred_url": "https://api.github.com/users/tumusudheer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tumusudheer/subscriptions", "organizations_url": "https://api.github.com/users/tumusudheer/orgs", "repos_url": "https://api.github.com/users/tumusudheer/repos", "events_url": "https://api.github.com/users/tumusudheer/events{/privacy}", "received_events_url": "https://api.github.com/users/tumusudheer/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-27T03:58:56Z", "updated_at": "2017-09-27T03:58:56Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1034716\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zhangyaobit\">@zhangyaobit</a> ,</p>\n<p>Here is the output of the inspect_checkpoint for all tensors:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1335722/inspect_output.txt\">inspect_output.txt</a></p>\n<p>For tensor_name:  text_box_300/conv10_box/conv_cls/BatchNorm/moving_mean<br>\n[ 0.0456978   0.01166576  0.01197682]<br>\nThe shape is 3.<br>\nSimilarly, the shape of text_box_300/conv7/BatchNorm/moving_mean is 19.</p>\n<p>But the checkpoint was the result of graph trained on GPU with operations taking data in NCHW format. When I created the graph to run inference on CPU (with NHWC data inputs) and restoring from GPU checkpoint, I'm getting the above errors.<br>\nAre you saying that when I'm creating the graph to run inference on CPU, the dimensions are not consistent with checkpoint dimensions ?  Should n' t they be different because the checkpoints are the result of Graph created with NCHW operations and I'm trying to restore it with graph created with NHWC operations ?</p>\n<p>As per your suggestion to making changes, do I need to make changes to the tensors while I'm creating the graph to run inference on CPU and take NHWC data format  or do I need to make changes after creating the graph and while restoring weights ?</p>\n<p>Thank you very much for taking your time to assist me with this issue.</p>", "body_text": "Hi @zhangyaobit ,\nHere is the output of the inspect_checkpoint for all tensors:\ninspect_output.txt\nFor tensor_name:  text_box_300/conv10_box/conv_cls/BatchNorm/moving_mean\n[ 0.0456978   0.01166576  0.01197682]\nThe shape is 3.\nSimilarly, the shape of text_box_300/conv7/BatchNorm/moving_mean is 19.\nBut the checkpoint was the result of graph trained on GPU with operations taking data in NCHW format. When I created the graph to run inference on CPU (with NHWC data inputs) and restoring from GPU checkpoint, I'm getting the above errors.\nAre you saying that when I'm creating the graph to run inference on CPU, the dimensions are not consistent with checkpoint dimensions ?  Should n' t they be different because the checkpoints are the result of Graph created with NCHW operations and I'm trying to restore it with graph created with NHWC operations ?\nAs per your suggestion to making changes, do I need to make changes to the tensors while I'm creating the graph to run inference on CPU and take NHWC data format  or do I need to make changes after creating the graph and while restoring weights ?\nThank you very much for taking your time to assist me with this issue.", "body": "Hi @zhangyaobit ,\r\n\r\nHere is the output of the inspect_checkpoint for all tensors:\r\n[inspect_output.txt](https://github.com/tensorflow/tensorflow/files/1335722/inspect_output.txt)\r\n\r\nFor tensor_name:  text_box_300/conv10_box/conv_cls/BatchNorm/moving_mean\r\n[ 0.0456978   0.01166576  0.01197682]\r\nThe shape is 3.\r\nSimilarly, the shape of text_box_300/conv7/BatchNorm/moving_mean is 19.\r\n\r\nBut the checkpoint was the result of graph trained on GPU with operations taking data in NCHW format. When I created the graph to run inference on CPU (with NHWC data inputs) and restoring from GPU checkpoint, I'm getting the above errors.\r\n Are you saying that when I'm creating the graph to run inference on CPU, the dimensions are not consistent with checkpoint dimensions ?  Should n' t they be different because the checkpoints are the result of Graph created with NCHW operations and I'm trying to restore it with graph created with NHWC operations ?\r\n\r\nAs per your suggestion to making changes, do I need to make changes to the tensors while I'm creating the graph to run inference on CPU and take NHWC data format  or do I need to make changes after creating the graph and while restoring weights ?\r\n\r\nThank you very much for taking your time to assist me with this issue.\r\n"}