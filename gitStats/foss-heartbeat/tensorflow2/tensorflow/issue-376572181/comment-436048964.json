{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/436048964", "html_url": "https://github.com/tensorflow/tensorflow/issues/23434#issuecomment-436048964", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23434", "id": 436048964, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjA0ODk2NA==", "user": {"login": "ivan-marroquin", "id": 28459534, "node_id": "MDQ6VXNlcjI4NDU5NTM0", "avatar_url": "https://avatars1.githubusercontent.com/u/28459534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivan-marroquin", "html_url": "https://github.com/ivan-marroquin", "followers_url": "https://api.github.com/users/ivan-marroquin/followers", "following_url": "https://api.github.com/users/ivan-marroquin/following{/other_user}", "gists_url": "https://api.github.com/users/ivan-marroquin/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivan-marroquin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivan-marroquin/subscriptions", "organizations_url": "https://api.github.com/users/ivan-marroquin/orgs", "repos_url": "https://api.github.com/users/ivan-marroquin/repos", "events_url": "https://api.github.com/users/ivan-marroquin/events{/privacy}", "received_events_url": "https://api.github.com/users/ivan-marroquin/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-05T21:52:01Z", "updated_at": "2018-11-05T21:52:01Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=42781361\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/harshini-gadige\">@harshini-gadige</a> , I updated tensorflow to version 1.11 as suggested. Unfortunately, I still have the same issue. For some reason the gRPC can't be started. I went to examine code examples on tensorflow distributed - as per your suggestion, and I rewrote the main Python script as follows:</p>\n<p>def find_amount_gpus(device, connection):<br>\nspec= tf.train.ClusterSpec(SPEC_Second)<br>\nserver= tf.train.Server(spec, job_name= device[0], task_index= device[1])</p>\n<pre><code>if (device[0] == \"ps\"):\n    server.join()\n\nif (device[0] == \"worker\"):\n    with tf.device(tf.train.replica_device_setter(worker_device= \"/job:worker/task:%d\" % device[1], cluster= spec)):\n        gpus_configuration(connection)\n</code></pre>\n<p>if <strong>name</strong> == '<strong>main</strong>':<br>\ndevices= [[\"ps\", 0], [\"worker\", 0], [\"worker\", 1]]<br>\njobs= []<br>\npipe_list= []</p>\n<pre><code>for i in devices: #for i in range(0, 1):#N_workers):\n    parent_conn, child_conn= Pipe()\n    p= Process(target= find_amount_gpus, args=(i, child_conn), daemon= True)\n    jobs.append(p)\n    pipe_list.append(parent_conn)\n    p.start()\n\ntotal_results= [out.recv() for out in pipe_list]\n</code></pre>\n<p>Below you will find the entire error log:</p>\n<p>E1105 15:50:49.242000000 17544 external/grpc/src/core/ext/transport/chttp2/server/insecure/server_chttp2.cc:40] {\"created\":\"@1541454649.242000000\",\"description\":\"No address added out of total 1 resolved\",\"file\":\"external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc\",\"file_line\":307,\"referenced_errors\":[{\"created\":\"@1541454649.242000000\",\"description\":\"Failed to add port to server\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":509,\"referenced_errors\":[{\"created\":\"@1541454649.242000000\",\"description\":\"OS Error\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":201,\"os_error\":\"Only one usage of each socket address (protocol/network address/port) is normally permitted.\\r\\n\",\"syscall\":\"bind\",\"wsa_error\":10048}]}]}<br>\nProcess Process-3:<br>\nTraceback (most recent call last):<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 258, in _bootstrap<br>\nself.run()<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 93, in run<br>\nself._target(*self._args, **self._kwargs)<br>\nFile \"C:\\Users\\IMarroquin\\Documents\\My_Python_Scripts\\MLP\\Test_main_distributed.py\", line 35, in find_amount_gpus<br>\nserver= tf.train.Server(spec, job_name= device[0], task_index= device[1])<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\training\\server_lib.py\", line 148, in <strong>init</strong><br>\nself._server_def.SerializeToString(), status)<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 526, in <strong>exit</strong><br>\nc_api.TF_GetCode(self.status.status))<br>\ntensorflow.python.framework.errors_impl.UnknownError: Could not start gRPC server<br>\nE1105 15:50:49.319000000 14416 external/grpc/src/core/ext/transport/chttp2/server/insecure/server_chttp2.cc:40] {\"created\":\"@1541454649.319000000\",\"description\":\"No address added out of total 1 resolved\",\"file\":\"external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc\",\"file_line\":307,\"referenced_errors\":[{\"created\":\"@1541454649.319000000\",\"description\":\"Failed to add port to server\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":509,\"referenced_errors\":[{\"created\":\"@1541454649.319000000\",\"description\":\"OS Error\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":201,\"os_error\":\"Only one usage of each socket address (protocol/network address/port) is normally permitted.\\r\\n\",\"syscall\":\"bind\",\"wsa_error\":10048}]}]}<br>\nProcess Process-2:<br>\nTraceback (most recent call last):<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 258, in _bootstrap<br>\nself.run()<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 93, in run<br>\nself._target(*self._args, **self._kwargs)<br>\nFile \"C:\\Users\\IMarroquin\\Documents\\My_Python_Scripts\\MLP\\Test_main_distributed.py\", line 35, in find_amount_gpus<br>\nserver= tf.train.Server(spec, job_name= device[0], task_index= device[1])<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\training\\server_lib.py\", line 148, in <strong>init</strong><br>\nself._server_def.SerializeToString(), status)<br>\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 526, in <strong>exit</strong><br>\nc_api.TF_GetCode(self.status.status))<br>\ntensorflow.python.framework.errors_impl.UnknownError: Could not start gRPC server</p>", "body_text": "Hi @harshini-gadige , I updated tensorflow to version 1.11 as suggested. Unfortunately, I still have the same issue. For some reason the gRPC can't be started. I went to examine code examples on tensorflow distributed - as per your suggestion, and I rewrote the main Python script as follows:\ndef find_amount_gpus(device, connection):\nspec= tf.train.ClusterSpec(SPEC_Second)\nserver= tf.train.Server(spec, job_name= device[0], task_index= device[1])\nif (device[0] == \"ps\"):\n    server.join()\n\nif (device[0] == \"worker\"):\n    with tf.device(tf.train.replica_device_setter(worker_device= \"/job:worker/task:%d\" % device[1], cluster= spec)):\n        gpus_configuration(connection)\n\nif name == 'main':\ndevices= [[\"ps\", 0], [\"worker\", 0], [\"worker\", 1]]\njobs= []\npipe_list= []\nfor i in devices: #for i in range(0, 1):#N_workers):\n    parent_conn, child_conn= Pipe()\n    p= Process(target= find_amount_gpus, args=(i, child_conn), daemon= True)\n    jobs.append(p)\n    pipe_list.append(parent_conn)\n    p.start()\n\ntotal_results= [out.recv() for out in pipe_list]\n\nBelow you will find the entire error log:\nE1105 15:50:49.242000000 17544 external/grpc/src/core/ext/transport/chttp2/server/insecure/server_chttp2.cc:40] {\"created\":\"@1541454649.242000000\",\"description\":\"No address added out of total 1 resolved\",\"file\":\"external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc\",\"file_line\":307,\"referenced_errors\":[{\"created\":\"@1541454649.242000000\",\"description\":\"Failed to add port to server\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":509,\"referenced_errors\":[{\"created\":\"@1541454649.242000000\",\"description\":\"OS Error\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":201,\"os_error\":\"Only one usage of each socket address (protocol/network address/port) is normally permitted.\\r\\n\",\"syscall\":\"bind\",\"wsa_error\":10048}]}]}\nProcess Process-3:\nTraceback (most recent call last):\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 258, in _bootstrap\nself.run()\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 93, in run\nself._target(*self._args, **self._kwargs)\nFile \"C:\\Users\\IMarroquin\\Documents\\My_Python_Scripts\\MLP\\Test_main_distributed.py\", line 35, in find_amount_gpus\nserver= tf.train.Server(spec, job_name= device[0], task_index= device[1])\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\training\\server_lib.py\", line 148, in init\nself._server_def.SerializeToString(), status)\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 526, in exit\nc_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.UnknownError: Could not start gRPC server\nE1105 15:50:49.319000000 14416 external/grpc/src/core/ext/transport/chttp2/server/insecure/server_chttp2.cc:40] {\"created\":\"@1541454649.319000000\",\"description\":\"No address added out of total 1 resolved\",\"file\":\"external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc\",\"file_line\":307,\"referenced_errors\":[{\"created\":\"@1541454649.319000000\",\"description\":\"Failed to add port to server\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":509,\"referenced_errors\":[{\"created\":\"@1541454649.319000000\",\"description\":\"OS Error\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":201,\"os_error\":\"Only one usage of each socket address (protocol/network address/port) is normally permitted.\\r\\n\",\"syscall\":\"bind\",\"wsa_error\":10048}]}]}\nProcess Process-2:\nTraceback (most recent call last):\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 258, in _bootstrap\nself.run()\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 93, in run\nself._target(*self._args, **self._kwargs)\nFile \"C:\\Users\\IMarroquin\\Documents\\My_Python_Scripts\\MLP\\Test_main_distributed.py\", line 35, in find_amount_gpus\nserver= tf.train.Server(spec, job_name= device[0], task_index= device[1])\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\training\\server_lib.py\", line 148, in init\nself._server_def.SerializeToString(), status)\nFile \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 526, in exit\nc_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.UnknownError: Could not start gRPC server", "body": "Hi @harshini-gadige , I updated tensorflow to version 1.11 as suggested. Unfortunately, I still have the same issue. For some reason the gRPC can't be started. I went to examine code examples on tensorflow distributed - as per your suggestion, and I rewrote the main Python script as follows:\r\n\r\ndef find_amount_gpus(device, connection):\r\n    spec= tf.train.ClusterSpec(SPEC_Second)\r\n    server= tf.train.Server(spec, job_name= device[0], task_index= device[1])\r\n   \r\n    if (device[0] == \"ps\"):\r\n        server.join()\r\n\r\n    if (device[0] == \"worker\"):\r\n        with tf.device(tf.train.replica_device_setter(worker_device= \"/job:worker/task:%d\" % device[1], cluster= spec)):\r\n            gpus_configuration(connection)\r\n\r\nif __name__ == '__main__':\r\n    devices= [[\"ps\", 0], [\"worker\", 0], [\"worker\", 1]]\r\n    jobs= []\r\n    pipe_list= []\r\n    \r\n    for i in devices: #for i in range(0, 1):#N_workers):\r\n        parent_conn, child_conn= Pipe()\r\n        p= Process(target= find_amount_gpus, args=(i, child_conn), daemon= True)\r\n        jobs.append(p)\r\n        pipe_list.append(parent_conn)\r\n        p.start()\r\n    \r\n    total_results= [out.recv() for out in pipe_list]\r\n\r\n\r\nBelow you will find the entire error log:\r\n\r\nE1105 15:50:49.242000000 17544 external/grpc/src/core/ext/transport/chttp2/server/insecure/server_chttp2.cc:40] {\"created\":\"@1541454649.242000000\",\"description\":\"No address added out of total 1 resolved\",\"file\":\"external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc\",\"file_line\":307,\"referenced_errors\":[{\"created\":\"@1541454649.242000000\",\"description\":\"Failed to add port to server\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":509,\"referenced_errors\":[{\"created\":\"@1541454649.242000000\",\"description\":\"OS Error\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":201,\"os_error\":\"Only one usage of each socket address (protocol/network address/port) is normally permitted.\\r\\n\",\"syscall\":\"bind\",\"wsa_error\":10048}]}]}\r\nProcess Process-3:\r\nTraceback (most recent call last):\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"C:\\Users\\IMarroquin\\Documents\\My_Python_Scripts\\MLP\\Test_main_distributed.py\", line 35, in find_amount_gpus\r\n    server= tf.train.Server(spec, job_name= device[0], task_index= device[1])\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\training\\server_lib.py\", line 148, in __init__\r\n    self._server_def.SerializeToString(), status)\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 526, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.UnknownError: Could not start gRPC server\r\nE1105 15:50:49.319000000 14416 external/grpc/src/core/ext/transport/chttp2/server/insecure/server_chttp2.cc:40] {\"created\":\"@1541454649.319000000\",\"description\":\"No address added out of total 1 resolved\",\"file\":\"external/grpc/src/core/ext/transport/chttp2/server/chttp2_server.cc\",\"file_line\":307,\"referenced_errors\":[{\"created\":\"@1541454649.319000000\",\"description\":\"Failed to add port to server\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":509,\"referenced_errors\":[{\"created\":\"@1541454649.319000000\",\"description\":\"OS Error\",\"file\":\"external/grpc/src/core/lib/iomgr/tcp_server_windows.cc\",\"file_line\":201,\"os_error\":\"Only one usage of each socket address (protocol/network address/port) is normally permitted.\\r\\n\",\"syscall\":\"bind\",\"wsa_error\":10048}]}]}\r\nProcess Process-2:\r\nTraceback (most recent call last):\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\multiprocessing\\process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"C:\\Users\\IMarroquin\\Documents\\My_Python_Scripts\\MLP\\Test_main_distributed.py\", line 35, in find_amount_gpus\r\n    server= tf.train.Server(spec, job_name= device[0], task_index= device[1])\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\training\\server_lib.py\", line 148, in __init__\r\n    self._server_def.SerializeToString(), status)\r\n  File \"C:\\Temp\\Python\\Python-3.6.5\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 526, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.UnknownError: Could not start gRPC server\r\n\r\n"}