{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/270187266", "html_url": "https://github.com/tensorflow/tensorflow/issues/6509#issuecomment-270187266", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6509", "id": 270187266, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDE4NzI2Ng==", "user": {"login": "name-name", "id": 5275814, "node_id": "MDQ6VXNlcjUyNzU4MTQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/5275814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/name-name", "html_url": "https://github.com/name-name", "followers_url": "https://api.github.com/users/name-name/followers", "following_url": "https://api.github.com/users/name-name/following{/other_user}", "gists_url": "https://api.github.com/users/name-name/gists{/gist_id}", "starred_url": "https://api.github.com/users/name-name/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/name-name/subscriptions", "organizations_url": "https://api.github.com/users/name-name/orgs", "repos_url": "https://api.github.com/users/name-name/repos", "events_url": "https://api.github.com/users/name-name/events{/privacy}", "received_events_url": "https://api.github.com/users/name-name/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-03T18:33:43Z", "updated_at": "2017-01-03T18:33:43Z", "author_association": "NONE", "body_html": "<p>Thanks for sharing!! I had the same problem and when I replace the tf.one_hot by the following hand-written implementation it finally works.<br>\n#instead of    one_hot_y = tf.one_hot(y, 43)</p>\n<p>num_labels = 43<br>\nsparse_labels = tf.reshape(y, [-1, 1])<br>\nderived_size = tf.shape(sparse_labels)[0]<br>\nindices = tf.reshape(tf.range(0, derived_size, 1), [-1, 1])<br>\nconcated = tf.concat(1, [indices, sparse_labels])<br>\noutshape = tf.concat(0, [tf.reshape(derived_size, [1]), tf.reshape(num_labels, [1])])<br>\none_hot_y = tf.sparse_to_dense(concated, outshape, 1.0, 0.0)</p>", "body_text": "Thanks for sharing!! I had the same problem and when I replace the tf.one_hot by the following hand-written implementation it finally works.\n#instead of    one_hot_y = tf.one_hot(y, 43)\nnum_labels = 43\nsparse_labels = tf.reshape(y, [-1, 1])\nderived_size = tf.shape(sparse_labels)[0]\nindices = tf.reshape(tf.range(0, derived_size, 1), [-1, 1])\nconcated = tf.concat(1, [indices, sparse_labels])\noutshape = tf.concat(0, [tf.reshape(derived_size, [1]), tf.reshape(num_labels, [1])])\none_hot_y = tf.sparse_to_dense(concated, outshape, 1.0, 0.0)", "body": "Thanks for sharing!! I had the same problem and when I replace the tf.one_hot by the following hand-written implementation it finally works.\r\n#instead of    one_hot_y = tf.one_hot(y, 43)\r\n\r\nnum_labels = 43\r\nsparse_labels = tf.reshape(y, [-1, 1])\r\nderived_size = tf.shape(sparse_labels)[0]\r\nindices = tf.reshape(tf.range(0, derived_size, 1), [-1, 1])\r\nconcated = tf.concat(1, [indices, sparse_labels])\r\noutshape = tf.concat(0, [tf.reshape(derived_size, [1]), tf.reshape(num_labels, [1])])\r\none_hot_y = tf.sparse_to_dense(concated, outshape, 1.0, 0.0)\r\n"}