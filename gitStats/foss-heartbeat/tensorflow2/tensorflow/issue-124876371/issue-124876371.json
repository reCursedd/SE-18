{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/684", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/684/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/684/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/684/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/684", "id": 124876371, "node_id": "MDU6SXNzdWUxMjQ4NzYzNzE=", "number": 684, "title": "CUDA_ERROR_NO_DEVICE with Tesla K40c", "user": {"login": "Stephaninos", "id": 2768465, "node_id": "MDQ6VXNlcjI3Njg0NjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2768465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Stephaninos", "html_url": "https://github.com/Stephaninos", "followers_url": "https://api.github.com/users/Stephaninos/followers", "following_url": "https://api.github.com/users/Stephaninos/following{/other_user}", "gists_url": "https://api.github.com/users/Stephaninos/gists{/gist_id}", "starred_url": "https://api.github.com/users/Stephaninos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Stephaninos/subscriptions", "organizations_url": "https://api.github.com/users/Stephaninos/orgs", "repos_url": "https://api.github.com/users/Stephaninos/repos", "events_url": "https://api.github.com/users/Stephaninos/events{/privacy}", "received_events_url": "https://api.github.com/users/Stephaninos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284463744, "node_id": "MDU6TGFiZWwyODQ0NjM3NDQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cuda", "name": "cuda", "color": "f7c6c7", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "zheng-xq", "id": 15736910, "node_id": "MDQ6VXNlcjE1NzM2OTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/15736910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zheng-xq", "html_url": "https://github.com/zheng-xq", "followers_url": "https://api.github.com/users/zheng-xq/followers", "following_url": "https://api.github.com/users/zheng-xq/following{/other_user}", "gists_url": "https://api.github.com/users/zheng-xq/gists{/gist_id}", "starred_url": "https://api.github.com/users/zheng-xq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zheng-xq/subscriptions", "organizations_url": "https://api.github.com/users/zheng-xq/orgs", "repos_url": "https://api.github.com/users/zheng-xq/repos", "events_url": "https://api.github.com/users/zheng-xq/events{/privacy}", "received_events_url": "https://api.github.com/users/zheng-xq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "zheng-xq", "id": 15736910, "node_id": "MDQ6VXNlcjE1NzM2OTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/15736910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zheng-xq", "html_url": "https://github.com/zheng-xq", "followers_url": "https://api.github.com/users/zheng-xq/followers", "following_url": "https://api.github.com/users/zheng-xq/following{/other_user}", "gists_url": "https://api.github.com/users/zheng-xq/gists{/gist_id}", "starred_url": "https://api.github.com/users/zheng-xq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zheng-xq/subscriptions", "organizations_url": "https://api.github.com/users/zheng-xq/orgs", "repos_url": "https://api.github.com/users/zheng-xq/repos", "events_url": "https://api.github.com/users/zheng-xq/events{/privacy}", "received_events_url": "https://api.github.com/users/zheng-xq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2016-01-05T01:35:40Z", "updated_at": "2017-04-14T02:37:16Z", "closed_at": "2016-01-09T01:21:34Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>I'm trying to use TF on a machine with 40 CPUs and 1 Tesla K40c.</p>\n<p>The machine is running openSUSE 13.2 and has CUDA 7 and cuDNN 6.5 installed.</p>\n<p><strong>Problem</strong></p>\n<p>When trying to run a simple test script</p>\n<pre><code>import tensorflow as tf\nhello = tf.constant('Hello, TensorFlow!')\nsess = tf.Session(config=tf.ConfigProto(log_device_placement=True))\nprint sess.run(hello)\na = tf.constant(10)\nb = tf.constant(32)\nprint sess.run(a+b)\n</code></pre>\n<p>I get this output + the error \"CUDA_ERROR_NO_DEVICE\":</p>\n<pre><code>I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcublas.so.7.0 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcudnn.so.6.5 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcufft.so.7.0 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcuda.so locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcurand.so.7.0 locally\nI tensorflow/core/common_runtime/local_device.cc:40] Local device intra op parallelism threads: 40\nE tensorflow/stream_executor/cuda/cuda_driver.cc:481] failed call to cuInit: CUDA_ERROR_NO_DEVICE\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:114] retrieving CUDA diagnostic information for host: ml-login2\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:121] hostname: ml-login2\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:146] libcuda reported version is: 346.46\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:257] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  346.46  Tue Feb 17 17:56:08 PST 2015\nGCC version:  gcc version 4.8.3 20140627 [gcc-4_8-branch revision 212064] (SUSE Linux) \nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:150] kernel reported version is: 346.46\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:226] kernel version seems to match DSO: 346.46\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:127] DMA: \nI tensorflow/core/common_runtime/direct_session.cc:58] Direct session inter op parallelism threads: 40\nDevice mapping: no known devices.\nI tensorflow/core/common_runtime/direct_session.cc:134] Device mapping:\n\nConst: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const: /job:localhost/replica:0/task:0/cpu:0\nHello, TensorFlow!\nConst_2: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const_2: /job:localhost/replica:0/task:0/cpu:0\nConst_1: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const_1: /job:localhost/replica:0/task:0/cpu:0\nadd: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] add: /job:localhost/replica:0/task:0/cpu:0\n</code></pre>\n<p><strong>What I've tried</strong><br>\nI've tried reinstalling the CUDA toolkit, installing TF from source, but all resulted in the same error.<br>\nnvidia-smi properly finds the GPU and I can successfully run GPU computations through C code that depends on CUDA. It seems that somehow TF can't detect the GPU.</p>\n<p>Is this a known issue with k40c GPUs and is there a fix?</p>\n<p>Thanks!<br>\n-Stephan</p>", "body_text": "Hi,\nI'm trying to use TF on a machine with 40 CPUs and 1 Tesla K40c.\nThe machine is running openSUSE 13.2 and has CUDA 7 and cuDNN 6.5 installed.\nProblem\nWhen trying to run a simple test script\nimport tensorflow as tf\nhello = tf.constant('Hello, TensorFlow!')\nsess = tf.Session(config=tf.ConfigProto(log_device_placement=True))\nprint sess.run(hello)\na = tf.constant(10)\nb = tf.constant(32)\nprint sess.run(a+b)\n\nI get this output + the error \"CUDA_ERROR_NO_DEVICE\":\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcublas.so.7.0 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcudnn.so.6.5 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcufft.so.7.0 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcuda.so locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcurand.so.7.0 locally\nI tensorflow/core/common_runtime/local_device.cc:40] Local device intra op parallelism threads: 40\nE tensorflow/stream_executor/cuda/cuda_driver.cc:481] failed call to cuInit: CUDA_ERROR_NO_DEVICE\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:114] retrieving CUDA diagnostic information for host: ml-login2\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:121] hostname: ml-login2\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:146] libcuda reported version is: 346.46\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:257] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  346.46  Tue Feb 17 17:56:08 PST 2015\nGCC version:  gcc version 4.8.3 20140627 [gcc-4_8-branch revision 212064] (SUSE Linux) \nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:150] kernel reported version is: 346.46\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:226] kernel version seems to match DSO: 346.46\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:127] DMA: \nI tensorflow/core/common_runtime/direct_session.cc:58] Direct session inter op parallelism threads: 40\nDevice mapping: no known devices.\nI tensorflow/core/common_runtime/direct_session.cc:134] Device mapping:\n\nConst: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const: /job:localhost/replica:0/task:0/cpu:0\nHello, TensorFlow!\nConst_2: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const_2: /job:localhost/replica:0/task:0/cpu:0\nConst_1: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const_1: /job:localhost/replica:0/task:0/cpu:0\nadd: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] add: /job:localhost/replica:0/task:0/cpu:0\n\nWhat I've tried\nI've tried reinstalling the CUDA toolkit, installing TF from source, but all resulted in the same error.\nnvidia-smi properly finds the GPU and I can successfully run GPU computations through C code that depends on CUDA. It seems that somehow TF can't detect the GPU.\nIs this a known issue with k40c GPUs and is there a fix?\nThanks!\n-Stephan", "body": "Hi,\n\nI'm trying to use TF on a machine with 40 CPUs and 1 Tesla K40c. \n\nThe machine is running openSUSE 13.2 and has CUDA 7 and cuDNN 6.5 installed.\n\n**Problem**\n\nWhen trying to run a simple test script\n\n```\nimport tensorflow as tf\nhello = tf.constant('Hello, TensorFlow!')\nsess = tf.Session(config=tf.ConfigProto(log_device_placement=True))\nprint sess.run(hello)\na = tf.constant(10)\nb = tf.constant(32)\nprint sess.run(a+b)\n```\n\nI get this output + the error \"CUDA_ERROR_NO_DEVICE\":\n\n```\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcublas.so.7.0 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcudnn.so.6.5 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcufft.so.7.0 locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcuda.so locally\nI tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcurand.so.7.0 locally\nI tensorflow/core/common_runtime/local_device.cc:40] Local device intra op parallelism threads: 40\nE tensorflow/stream_executor/cuda/cuda_driver.cc:481] failed call to cuInit: CUDA_ERROR_NO_DEVICE\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:114] retrieving CUDA diagnostic information for host: ml-login2\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:121] hostname: ml-login2\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:146] libcuda reported version is: 346.46\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:257] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  346.46  Tue Feb 17 17:56:08 PST 2015\nGCC version:  gcc version 4.8.3 20140627 [gcc-4_8-branch revision 212064] (SUSE Linux) \nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:150] kernel reported version is: 346.46\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:226] kernel version seems to match DSO: 346.46\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:127] DMA: \nI tensorflow/core/common_runtime/direct_session.cc:58] Direct session inter op parallelism threads: 40\nDevice mapping: no known devices.\nI tensorflow/core/common_runtime/direct_session.cc:134] Device mapping:\n\nConst: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const: /job:localhost/replica:0/task:0/cpu:0\nHello, TensorFlow!\nConst_2: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const_2: /job:localhost/replica:0/task:0/cpu:0\nConst_1: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] Const_1: /job:localhost/replica:0/task:0/cpu:0\nadd: /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:304] add: /job:localhost/replica:0/task:0/cpu:0\n```\n\n**What I've tried**\nI've tried reinstalling the CUDA toolkit, installing TF from source, but all resulted in the same error. \nnvidia-smi properly finds the GPU and I can successfully run GPU computations through C code that depends on CUDA. It seems that somehow TF can't detect the GPU.\n\nIs this a known issue with k40c GPUs and is there a fix?\n\nThanks!\n-Stephan\n"}