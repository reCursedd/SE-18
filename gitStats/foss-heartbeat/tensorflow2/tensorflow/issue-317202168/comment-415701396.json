{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/415701396", "html_url": "https://github.com/tensorflow/tensorflow/issues/18829#issuecomment-415701396", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18829", "id": 415701396, "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTcwMTM5Ng==", "user": {"login": "jass-singh", "id": 20219876, "node_id": "MDQ6VXNlcjIwMjE5ODc2", "avatar_url": "https://avatars1.githubusercontent.com/u/20219876?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jass-singh", "html_url": "https://github.com/jass-singh", "followers_url": "https://api.github.com/users/jass-singh/followers", "following_url": "https://api.github.com/users/jass-singh/following{/other_user}", "gists_url": "https://api.github.com/users/jass-singh/gists{/gist_id}", "starred_url": "https://api.github.com/users/jass-singh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jass-singh/subscriptions", "organizations_url": "https://api.github.com/users/jass-singh/orgs", "repos_url": "https://api.github.com/users/jass-singh/repos", "events_url": "https://api.github.com/users/jass-singh/events{/privacy}", "received_events_url": "https://api.github.com/users/jass-singh/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-24T09:11:12Z", "updated_at": "2018-08-24T09:12:22Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=19912807\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/alokranjan007\">@alokranjan007</a></p>\n<ol>\n<li>I am using Mobilenet model ssd_mobilenet_v1_coco_2017_11_17 , retraining on faces.</li>\n</ol>\n<p>export PYTHONPATH=$PYTHONPATH:<code>pwd</code>:<code>pwd</code>/slim<br>\nexport CONFIG_FILE=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/pipeline.config<br>\nexport CHECKPOINT_PATH=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/model.ckpt<br>\nexport OUTPUT_DIR=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/</p>\n<ol start=\"2\">\n<li>Further, creating .pb using pipeline.config,</li>\n</ol>\n<p>python object_detection/export_tflite_ssd_graph.py <br>\n--pipeline_config_path=$CONFIG_FILE <br>\n--trained_checkpoint_prefix=$CHECKPOINT_PATH <br>\n--output_directory=$OUTPUT_DIR <br>\n--add_postprocessing_op=true</p>\n<ol start=\"3\">\n<li>\n<p>Then, made changes in DetectorActivity.java file in the tensorflow/contrib/lite/examples/android/app/src/main/java as below:<br>\nprivate static final boolean TF_OD_API_IS_QUANTIZED = false;</p>\n</li>\n<li>\n<p>At last ,</p>\n</li>\n</ol>\n<p>bazel run -c opt tensorflow/contrib/lite/toco:toco -- <br>\n--input_file=$OUTPUT_DIR/tflite_graph.pb <br>\n--output_file=$OUTPUT_DIR/custom_mob_2018_08_23_v2.tflite <br>\n--input_shapes=1,300,300,3 <br>\n--input_arrays=normalized_input_image_tensor <br>\n--output_arrays='TFLite_Detection_PostProcess','TFLite_Detection_PostProcess:1','TFLite_Detection_PostProcess:2','TFLite_Detection_PostProcess:3'  <br>\n--inference_type=FLOAT <br>\n--mean_values=128 <br>\n--std_values=128 <br>\n--change_concat_input_ranges=false <br>\n--allow_custom_ops</p>", "body_text": "@alokranjan007\n\nI am using Mobilenet model ssd_mobilenet_v1_coco_2017_11_17 , retraining on faces.\n\nexport PYTHONPATH=$PYTHONPATH:pwd:pwd/slim\nexport CONFIG_FILE=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/pipeline.config\nexport CHECKPOINT_PATH=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/model.ckpt\nexport OUTPUT_DIR=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/\n\nFurther, creating .pb using pipeline.config,\n\npython object_detection/export_tflite_ssd_graph.py \n--pipeline_config_path=$CONFIG_FILE \n--trained_checkpoint_prefix=$CHECKPOINT_PATH \n--output_directory=$OUTPUT_DIR \n--add_postprocessing_op=true\n\n\nThen, made changes in DetectorActivity.java file in the tensorflow/contrib/lite/examples/android/app/src/main/java as below:\nprivate static final boolean TF_OD_API_IS_QUANTIZED = false;\n\n\nAt last ,\n\n\nbazel run -c opt tensorflow/contrib/lite/toco:toco -- \n--input_file=$OUTPUT_DIR/tflite_graph.pb \n--output_file=$OUTPUT_DIR/custom_mob_2018_08_23_v2.tflite \n--input_shapes=1,300,300,3 \n--input_arrays=normalized_input_image_tensor \n--output_arrays='TFLite_Detection_PostProcess','TFLite_Detection_PostProcess:1','TFLite_Detection_PostProcess:2','TFLite_Detection_PostProcess:3'  \n--inference_type=FLOAT \n--mean_values=128 \n--std_values=128 \n--change_concat_input_ranges=false \n--allow_custom_ops", "body": "@alokranjan007 \r\n\r\n1. I am using Mobilenet model ssd_mobilenet_v1_coco_2017_11_17 , retraining on faces.\r\n\r\nexport PYTHONPATH=$PYTHONPATH:`pwd`:`pwd`/slim\r\nexport CONFIG_FILE=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/pipeline.config\r\nexport CHECKPOINT_PATH=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/model.ckpt\r\nexport OUTPUT_DIR=/home/jaskaran/Git_Download_Libraries/face_detection_inference_graph_2018_08_23/\r\n\r\n2. Further, creating .pb using pipeline.config,\r\n\r\npython object_detection/export_tflite_ssd_graph.py \\\r\n--pipeline_config_path=$CONFIG_FILE \\\r\n--trained_checkpoint_prefix=$CHECKPOINT_PATH \\\r\n--output_directory=$OUTPUT_DIR \\\r\n--add_postprocessing_op=true\r\n\r\n\r\n3. Then, made changes in DetectorActivity.java file in the tensorflow/contrib/lite/examples/android/app/src/main/java as below:\r\nprivate static final boolean TF_OD_API_IS_QUANTIZED = false;\r\n\r\n\r\n4.  At last ,\r\n\r\nbazel run -c opt tensorflow/contrib/lite/toco:toco -- \\\r\n--input_file=$OUTPUT_DIR/tflite_graph.pb \\\r\n--output_file=$OUTPUT_DIR/custom_mob_2018_08_23_v2.tflite \\\r\n--input_shapes=1,300,300,3 \\\r\n--input_arrays=normalized_input_image_tensor \\\r\n--output_arrays='TFLite_Detection_PostProcess','TFLite_Detection_PostProcess:1','TFLite_Detection_PostProcess:2','TFLite_Detection_PostProcess:3'  \\\r\n--inference_type=FLOAT \\\r\n--mean_values=128 \\\r\n--std_values=128 \\\r\n--change_concat_input_ranges=false \\\r\n--allow_custom_ops\r\n"}