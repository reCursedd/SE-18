{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5440", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5440/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5440/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5440/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5440", "id": 187651137, "node_id": "MDU6SXNzdWUxODc2NTExMzc=", "number": 5440, "title": "Load user defined op with relative path", "user": {"login": "singlasahil14", "id": 6660192, "node_id": "MDQ6VXNlcjY2NjAxOTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/6660192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/singlasahil14", "html_url": "https://github.com/singlasahil14", "followers_url": "https://api.github.com/users/singlasahil14/followers", "following_url": "https://api.github.com/users/singlasahil14/following{/other_user}", "gists_url": "https://api.github.com/users/singlasahil14/gists{/gist_id}", "starred_url": "https://api.github.com/users/singlasahil14/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/singlasahil14/subscriptions", "organizations_url": "https://api.github.com/users/singlasahil14/orgs", "repos_url": "https://api.github.com/users/singlasahil14/repos", "events_url": "https://api.github.com/users/singlasahil14/events{/privacy}", "received_events_url": "https://api.github.com/users/singlasahil14/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "jart", "id": 49262, "node_id": "MDQ6VXNlcjQ5MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/49262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jart", "html_url": "https://github.com/jart", "followers_url": "https://api.github.com/users/jart/followers", "following_url": "https://api.github.com/users/jart/following{/other_user}", "gists_url": "https://api.github.com/users/jart/gists{/gist_id}", "starred_url": "https://api.github.com/users/jart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jart/subscriptions", "organizations_url": "https://api.github.com/users/jart/orgs", "repos_url": "https://api.github.com/users/jart/repos", "events_url": "https://api.github.com/users/jart/events{/privacy}", "received_events_url": "https://api.github.com/users/jart/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jart", "id": 49262, "node_id": "MDQ6VXNlcjQ5MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/49262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jart", "html_url": "https://github.com/jart", "followers_url": "https://api.github.com/users/jart/followers", "following_url": "https://api.github.com/users/jart/following{/other_user}", "gists_url": "https://api.github.com/users/jart/gists{/gist_id}", "starred_url": "https://api.github.com/users/jart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jart/subscriptions", "organizations_url": "https://api.github.com/users/jart/orgs", "repos_url": "https://api.github.com/users/jart/repos", "events_url": "https://api.github.com/users/jart/events{/privacy}", "received_events_url": "https://api.github.com/users/jart/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2016-11-07T08:28:58Z", "updated_at": "2017-01-14T00:50:08Z", "closed_at": "2017-01-14T00:50:07Z", "author_association": "NONE", "body_html": "<p>How to load a user defined op with relative path? It works fine with absolute path. But I want to do it using relative path.</p>\n<p><strong>I used this command to build the op:</strong><br>\n<code>bazel build -s --copt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" -c opt //tensorflow/core/user_ops:zero_out.so</code></p>\n<p><strong>The build file I used is:</strong></p>\n<div class=\"highlight highlight-source-python\"><pre>load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>//tensorflow:tensorflow.bzl<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>tf_custom_op_library<span class=\"pl-pds\">\"</span></span>)\ntf_custom_op_library(\n    <span class=\"pl-v\">name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>zero_out.so<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-v\">srcs</span> <span class=\"pl-k\">=</span> [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>zero_out.cc<span class=\"pl-pds\">\"</span></span>],\n)</pre></div>\n<p><strong>The output of the build command is :</strong></p>\n<pre><code>INFO: Found 1 target...\n&gt;&gt;&gt;&gt;&gt; # //tensorflow/core/user_ops:zero_out.so [action 'Creating runfiles tree bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles']\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow &amp;&amp; \\\n  exec env - \\\n    PATH=/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Users/sahilsingla/Downloads/earthengine-api/demos/trendy-lights/google-cloud/google-cloud-sdk/bin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/Users/sahilsingla/torch/install/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/sahilsingla/.local/bin:/opt/X11/bin:/Users/sahilsingla/torch/install/lib/luarocks/rocks:/usr/local/cuda/bin:/Users/sahilsingla/.local/bin:/usr/local/mysql/bin:/usr/local/sbin \\\n    TMPDIR=/var/folders/n6/kj5blsmn39qfzncks2_rt8pm0000gn/T/ \\\n  /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow/_bin/build-runfiles bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles_manifest bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles)\n&gt;&gt;&gt;&gt;&gt; # //tensorflow/core/user_ops:zero_out.so [action 'Compiling tensorflow/core/user_ops/zero_out.cc']\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow &amp;&amp; \\\n  exec env - \\\n    PATH=/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Users/sahilsingla/Downloads/earthengine-api/demos/trendy-lights/google-cloud/google-cloud-sdk/bin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/Users/sahilsingla/torch/install/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/sahilsingla/.local/bin:/opt/X11/bin:/Users/sahilsingla/torch/install/lib/luarocks/rocks:/usr/local/cuda/bin:/Users/sahilsingla/.local/bin:/usr/local/mysql/bin:/usr/local/sbin \\\n    TMPDIR=/var/folders/n6/kj5blsmn39qfzncks2_rt8pm0000gn/T/ \\\n  external/local_config_cc/cc_wrapper.sh -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wthread-safety -Wself-assign -fcolor-diagnostics -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections '-D_GLIBCXX_USE_CXX11_ABI=0' '-std=c++0x' -MD -MF bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.d '-frandom-seed=bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o' -fPIC -DEIGEN_MPL2_ONLY -iquote . -iquote bazel-out/local-opt/genfiles -iquote external/protobuf -iquote bazel-out/local-opt/genfiles/external/protobuf -iquote external/bazel_tools -iquote bazel-out/local-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/local-opt/genfiles/external/eigen_archive -isystem external/protobuf/src -isystem bazel-out/local-opt/genfiles/external/protobuf/src -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/local-opt/genfiles/external/eigen_archive -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare -fno-exceptions -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/core/user_ops/zero_out.cc -o bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o)\n&gt;&gt;&gt;&gt;&gt; # //tensorflow/core/user_ops:zero_out.so [action 'Linking tensorflow/core/user_ops/zero_out.so']\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow &amp;&amp; \\\n  exec env - \\\n  external/local_config_cc/cc_wrapper.sh -shared -o bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so -Wl,-all_load bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o bazel-out/local-opt/bin/external/protobuf/libprotobuf.pic.a bazel-out/local-opt/bin/external/protobuf/libprotobuf_lite.pic.a '' -lpthread -lstdc++ -lm -undefined dynamic_lookup -headerpad_max_install_names)\nTarget //tensorflow/core/user_ops:zero_out.so up-to-date:\n  bazel-bin/tensorflow/core/user_ops/zero_out.so\nINFO: Elapsed time: 3.717s, Critical Path: 3.36s\n</code></pre>\n<p><strong>Pleas let me know if there is a way to make it work.</strong></p>", "body_text": "How to load a user defined op with relative path? It works fine with absolute path. But I want to do it using relative path.\nI used this command to build the op:\nbazel build -s --copt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" -c opt //tensorflow/core/user_ops:zero_out.so\nThe build file I used is:\nload(\"//tensorflow:tensorflow.bzl\", \"tf_custom_op_library\")\ntf_custom_op_library(\n    name = \"zero_out.so\",\n    srcs = [\"zero_out.cc\"],\n)\nThe output of the build command is :\nINFO: Found 1 target...\n>>>>> # //tensorflow/core/user_ops:zero_out.so [action 'Creating runfiles tree bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles']\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow && \\\n  exec env - \\\n    PATH=/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Users/sahilsingla/Downloads/earthengine-api/demos/trendy-lights/google-cloud/google-cloud-sdk/bin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/Users/sahilsingla/torch/install/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/sahilsingla/.local/bin:/opt/X11/bin:/Users/sahilsingla/torch/install/lib/luarocks/rocks:/usr/local/cuda/bin:/Users/sahilsingla/.local/bin:/usr/local/mysql/bin:/usr/local/sbin \\\n    TMPDIR=/var/folders/n6/kj5blsmn39qfzncks2_rt8pm0000gn/T/ \\\n  /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow/_bin/build-runfiles bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles_manifest bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles)\n>>>>> # //tensorflow/core/user_ops:zero_out.so [action 'Compiling tensorflow/core/user_ops/zero_out.cc']\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow && \\\n  exec env - \\\n    PATH=/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Users/sahilsingla/Downloads/earthengine-api/demos/trendy-lights/google-cloud/google-cloud-sdk/bin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/Users/sahilsingla/torch/install/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/sahilsingla/.local/bin:/opt/X11/bin:/Users/sahilsingla/torch/install/lib/luarocks/rocks:/usr/local/cuda/bin:/Users/sahilsingla/.local/bin:/usr/local/mysql/bin:/usr/local/sbin \\\n    TMPDIR=/var/folders/n6/kj5blsmn39qfzncks2_rt8pm0000gn/T/ \\\n  external/local_config_cc/cc_wrapper.sh -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wthread-safety -Wself-assign -fcolor-diagnostics -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections '-D_GLIBCXX_USE_CXX11_ABI=0' '-std=c++0x' -MD -MF bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.d '-frandom-seed=bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o' -fPIC -DEIGEN_MPL2_ONLY -iquote . -iquote bazel-out/local-opt/genfiles -iquote external/protobuf -iquote bazel-out/local-opt/genfiles/external/protobuf -iquote external/bazel_tools -iquote bazel-out/local-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/local-opt/genfiles/external/eigen_archive -isystem external/protobuf/src -isystem bazel-out/local-opt/genfiles/external/protobuf/src -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/local-opt/genfiles/external/eigen_archive -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare -fno-exceptions -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/core/user_ops/zero_out.cc -o bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o)\n>>>>> # //tensorflow/core/user_ops:zero_out.so [action 'Linking tensorflow/core/user_ops/zero_out.so']\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow && \\\n  exec env - \\\n  external/local_config_cc/cc_wrapper.sh -shared -o bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so -Wl,-all_load bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o bazel-out/local-opt/bin/external/protobuf/libprotobuf.pic.a bazel-out/local-opt/bin/external/protobuf/libprotobuf_lite.pic.a '' -lpthread -lstdc++ -lm -undefined dynamic_lookup -headerpad_max_install_names)\nTarget //tensorflow/core/user_ops:zero_out.so up-to-date:\n  bazel-bin/tensorflow/core/user_ops/zero_out.so\nINFO: Elapsed time: 3.717s, Critical Path: 3.36s\n\nPleas let me know if there is a way to make it work.", "body": "How to load a user defined op with relative path? It works fine with absolute path. But I want to do it using relative path.\r\n\r\n**I used this command to build the op:** \r\n`bazel build -s --copt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" -c opt //tensorflow/core/user_ops:zero_out.so`\r\n\r\n**The build file I used is:** \r\n\r\n```python\r\nload(\"//tensorflow:tensorflow.bzl\", \"tf_custom_op_library\")\r\ntf_custom_op_library(\r\n    name = \"zero_out.so\",\r\n    srcs = [\"zero_out.cc\"],\r\n)\r\n```\r\n\r\n**The output of the build command is :** \r\n\r\n```\r\nINFO: Found 1 target...\r\n>>>>> # //tensorflow/core/user_ops:zero_out.so [action 'Creating runfiles tree bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles']\r\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow && \\\r\n  exec env - \\\r\n    PATH=/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Users/sahilsingla/Downloads/earthengine-api/demos/trendy-lights/google-cloud/google-cloud-sdk/bin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/Users/sahilsingla/torch/install/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/sahilsingla/.local/bin:/opt/X11/bin:/Users/sahilsingla/torch/install/lib/luarocks/rocks:/usr/local/cuda/bin:/Users/sahilsingla/.local/bin:/usr/local/mysql/bin:/usr/local/sbin \\\r\n    TMPDIR=/var/folders/n6/kj5blsmn39qfzncks2_rt8pm0000gn/T/ \\\r\n  /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow/_bin/build-runfiles bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles_manifest bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so.runfiles)\r\n>>>>> # //tensorflow/core/user_ops:zero_out.so [action 'Compiling tensorflow/core/user_ops/zero_out.cc']\r\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow && \\\r\n  exec env - \\\r\n    PATH=/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Users/sahilsingla/Downloads/earthengine-api/demos/trendy-lights/google-cloud/google-cloud-sdk/bin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/Users/sahilsingla/torch/install/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/sahilsingla/.local/bin:/opt/X11/bin:/Users/sahilsingla/torch/install/lib/luarocks/rocks:/usr/local/cuda/bin:/Users/sahilsingla/.local/bin:/usr/local/mysql/bin:/usr/local/sbin \\\r\n    TMPDIR=/var/folders/n6/kj5blsmn39qfzncks2_rt8pm0000gn/T/ \\\r\n  external/local_config_cc/cc_wrapper.sh -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wthread-safety -Wself-assign -fcolor-diagnostics -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections '-D_GLIBCXX_USE_CXX11_ABI=0' '-std=c++0x' -MD -MF bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.d '-frandom-seed=bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o' -fPIC -DEIGEN_MPL2_ONLY -iquote . -iquote bazel-out/local-opt/genfiles -iquote external/protobuf -iquote bazel-out/local-opt/genfiles/external/protobuf -iquote external/bazel_tools -iquote bazel-out/local-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/local-opt/genfiles/external/eigen_archive -isystem external/protobuf/src -isystem bazel-out/local-opt/genfiles/external/protobuf/src -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/local-opt/genfiles/external/eigen_archive -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare -fno-exceptions -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/core/user_ops/zero_out.cc -o bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o)\r\n>>>>> # //tensorflow/core/user_ops:zero_out.so [action 'Linking tensorflow/core/user_ops/zero_out.so']\r\n(cd /private/var/tmp/_bazel_sahilsingla/c1460bc7debae191fe6190e883a41a47/execroot/tensorflow && \\\r\n  exec env - \\\r\n  external/local_config_cc/cc_wrapper.sh -shared -o bazel-out/local-opt/bin/tensorflow/core/user_ops/zero_out.so -Wl,-all_load bazel-out/local-opt/bin/tensorflow/core/user_ops/_objs/zero_out.so/tensorflow/core/user_ops/zero_out.pic.o bazel-out/local-opt/bin/external/protobuf/libprotobuf.pic.a bazel-out/local-opt/bin/external/protobuf/libprotobuf_lite.pic.a '' -lpthread -lstdc++ -lm -undefined dynamic_lookup -headerpad_max_install_names)\r\nTarget //tensorflow/core/user_ops:zero_out.so up-to-date:\r\n  bazel-bin/tensorflow/core/user_ops/zero_out.so\r\nINFO: Elapsed time: 3.717s, Critical Path: 3.36s\r\n```\r\n\r\n**Pleas let me know if there is a way to make it work.**\r\n"}