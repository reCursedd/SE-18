{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8916", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8916/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8916/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8916/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8916", "id": 218841480, "node_id": "MDU6SXNzdWUyMTg4NDE0ODA=", "number": 8916, "title": "Cannot assign a device to node 'Variable'", "user": {"login": "evan176", "id": 6711559, "node_id": "MDQ6VXNlcjY3MTE1NTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/6711559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/evan176", "html_url": "https://github.com/evan176", "followers_url": "https://api.github.com/users/evan176/followers", "following_url": "https://api.github.com/users/evan176/following{/other_user}", "gists_url": "https://api.github.com/users/evan176/gists{/gist_id}", "starred_url": "https://api.github.com/users/evan176/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/evan176/subscriptions", "organizations_url": "https://api.github.com/users/evan176/orgs", "repos_url": "https://api.github.com/users/evan176/repos", "events_url": "https://api.github.com/users/evan176/events{/privacy}", "received_events_url": "https://api.github.com/users/evan176/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-03T06:34:14Z", "updated_at": "2017-04-04T02:27:06Z", "closed_at": "2017-04-04T02:27:06Z", "author_association": "NONE", "body_html": "<h3>Environment info</h3>\n<p>Operating System: Ubuntu 16.04</p>\n<p>Installed version of CUDA and cuDNN:<br>\n/usr/local/cuda-8.0/lib64/libcudadevrt.a<br>\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61<br>\n/usr/local/cuda-8.0/lib64/libcudnn.so.5<br>\n/usr/local/cuda-8.0/lib64/libcudart.so<br>\n/usr/local/cuda-8.0/lib64/libcudart_static.a<br>\n/usr/local/cuda-8.0/lib64/libcudnn_static.a<br>\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0<br>\n/usr/local/cuda-8.0/lib64/libcudnn.so</p>\n<p>Tensorflow version: 1.0.1</p>\n<h3>If possible, provide a minimal reproducible example</h3>\n<p>with tf.device('/gpu:0'):<br>\na = tf.Variable([[1, 1]], tf.float32)</p>\n<p>with tf.device('/cpu:0'):<br>\nb = tf.Variable([[0, 0]], tf.float32)</p>\n<p>It will get:<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.<br>\n...</p>\n<h3>What other attempted solutions have you tried?</h3>\n<p>with tf.device('/gpu:0'):<br>\na = tf.Variable([[1.0, 1.0]], tf.float32)</p>\n<p>with tf.device('/cpu:0'):<br>\nb = tf.Variable([[0.0, 0.0]], tf.float32)<br>\nIf I change the contents of the initial value from integer to float, everything will be fine.</p>\n<h3>Logs or other output that would be helpful</h3>\n<p>(If logs are large, please upload as attachment or provide link).<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.<br>\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.<br>\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:<br>\nname: GeForce 940M<br>\nmajor: 5 minor: 0 memoryClockRate (GHz) 1.176<br>\npciBusID 0000:04:00.0<br>\nTotal memory: 1.96GiB<br>\nFree memory: 1.60GiB<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0)<br>\nDevice mapping:<br>\n/job:localhost/replica:0/task:0/gpu:0 -&gt; device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0<br>\nI tensorflow/core/common_runtime/direct_session.cc:257] Device mapping:<br>\n/job:localhost/replica:0/task:0/gpu:0 -&gt; device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0</p>\n<p>Variable_1: (VariableV2): /job:localhost/replica:0/task:0/cpu:0<br>\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1: (VariableV2)/job:localhost/replica:0/task:0/cpu:0<br>\nVariable_1/read: (Identity): /job:localhost/replica:0/task:0/cpu:0<br>\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1/read: (Identity)/job:localhost/replica:0/task:0/cpu:0<br>\nPrint_1: (Print): /job:localhost/replica:0/task:0/cpu:0<br>\nI tensorflow/core/common_runtime/simple_placer.cc:841] Print_1: (Print)/job:localhost/replica:0/task:0/cpu:0<br>\nVariable_1/Assign: (Assign): /job:localhost/replica:0/task:0/cpu:0<br>\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1/Assign: (Assign)/job:localhost/replica:0/task:0/cpu:0<br>\ninit/NoOp: (NoOp): /job:localhost/replica:0/task:0/cpu:0<br>\nI tensorflow/core/common_runtime/simple_placer.cc:841] init/NoOp: (NoOp)/job:localhost/replica:0/task:0/cpu:0<br>\nTraceback (most recent call last):<br>\nFile \"test.py\", line 20, in <br>\nsess.run(tf.global_variables_initializer())<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.<br>\nColocation Debug Info:<br>\nColocation group had the following types and devices:<br>\nAssign: CPU<br>\nIdentity: CPU<br>\nVariableV2: CPU<br>\n[[Node: Variable = VariableV2<a href=\"\">container=\"\", dtype=DT_INT32, shape=[1,2], shared_name=\"\", _device=\"/device:GPU:0\"</a>]]</p>\n<p>Caused by op u'Variable', defined at:<br>\nFile \"test.py\", line 8, in <br>\na = tf.Variable([[1, 1]], tf.float32)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 197, in <strong>init</strong><br>\nexpected_shape=expected_shape)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 293, in _init_from_args<br>\nname=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/state_ops.py\", line 128, in variable_op_v2<br>\nshared_name=shared_name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_state_ops.py\", line 708, in _variable_v2<br>\nname=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2327, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1226, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.<br>\nColocation Debug Info:<br>\nColocation group had the following types and devices:<br>\nAssign: CPU<br>\nIdentity: CPU<br>\nVariableV2: CPU<br>\n[[Node: Variable = VariableV2<a href=\"\">container=\"\", dtype=DT_INT32, shape=[1,2], shared_name=\"\", _device=\"/device:GPU:0\"</a>]]</p>", "body_text": "Environment info\nOperating System: Ubuntu 16.04\nInstalled version of CUDA and cuDNN:\n/usr/local/cuda-8.0/lib64/libcudadevrt.a\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61\n/usr/local/cuda-8.0/lib64/libcudnn.so.5\n/usr/local/cuda-8.0/lib64/libcudart.so\n/usr/local/cuda-8.0/lib64/libcudart_static.a\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0\n/usr/local/cuda-8.0/lib64/libcudnn.so\nTensorflow version: 1.0.1\nIf possible, provide a minimal reproducible example\nwith tf.device('/gpu:0'):\na = tf.Variable([[1, 1]], tf.float32)\nwith tf.device('/cpu:0'):\nb = tf.Variable([[0, 0]], tf.float32)\nIt will get:\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n...\nWhat other attempted solutions have you tried?\nwith tf.device('/gpu:0'):\na = tf.Variable([[1.0, 1.0]], tf.float32)\nwith tf.device('/cpu:0'):\nb = tf.Variable([[0.0, 0.0]], tf.float32)\nIf I change the contents of the initial value from integer to float, everything will be fine.\nLogs or other output that would be helpful\n(If logs are large, please upload as attachment or provide link).\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\nname: GeForce 940M\nmajor: 5 minor: 0 memoryClockRate (GHz) 1.176\npciBusID 0000:04:00.0\nTotal memory: 1.96GiB\nFree memory: 1.60GiB\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0\nI tensorflow/core/common_runtime/direct_session.cc:257] Device mapping:\n/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0\nVariable_1: (VariableV2): /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1: (VariableV2)/job:localhost/replica:0/task:0/cpu:0\nVariable_1/read: (Identity): /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1/read: (Identity)/job:localhost/replica:0/task:0/cpu:0\nPrint_1: (Print): /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:841] Print_1: (Print)/job:localhost/replica:0/task:0/cpu:0\nVariable_1/Assign: (Assign): /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1/Assign: (Assign)/job:localhost/replica:0/task:0/cpu:0\ninit/NoOp: (NoOp): /job:localhost/replica:0/task:0/cpu:0\nI tensorflow/core/common_runtime/simple_placer.cc:841] init/NoOp: (NoOp)/job:localhost/replica:0/task:0/cpu:0\nTraceback (most recent call last):\nFile \"test.py\", line 20, in \nsess.run(tf.global_variables_initializer())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\ntarget_list, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices:\nAssign: CPU\nIdentity: CPU\nVariableV2: CPU\n[[Node: Variable = VariableV2container=\"\", dtype=DT_INT32, shape=[1,2], shared_name=\"\", _device=\"/device:GPU:0\"]]\nCaused by op u'Variable', defined at:\nFile \"test.py\", line 8, in \na = tf.Variable([[1, 1]], tf.float32)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 197, in init\nexpected_shape=expected_shape)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 293, in _init_from_args\nname=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/state_ops.py\", line 128, in variable_op_v2\nshared_name=shared_name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_state_ops.py\", line 708, in _variable_v2\nname=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\nop_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2327, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1226, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices:\nAssign: CPU\nIdentity: CPU\nVariableV2: CPU\n[[Node: Variable = VariableV2container=\"\", dtype=DT_INT32, shape=[1,2], shared_name=\"\", _device=\"/device:GPU:0\"]]", "body": "### Environment info\r\nOperating System: Ubuntu 16.04\r\n\r\nInstalled version of CUDA and cuDNN: \r\n/usr/local/cuda-8.0/lib64/libcudadevrt.a\r\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61\r\n/usr/local/cuda-8.0/lib64/libcudnn.so.5\r\n/usr/local/cuda-8.0/lib64/libcudart.so\r\n/usr/local/cuda-8.0/lib64/libcudart_static.a\r\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\r\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n/usr/local/cuda-8.0/lib64/libcudnn.so\r\n\r\nTensorflow version: 1.0.1\r\n\r\n### If possible, provide a minimal reproducible example\r\nwith tf.device('/gpu:0'):\r\n    a = tf.Variable([[1, 1]], tf.float32)\r\n\r\nwith tf.device('/cpu:0'):\r\n    b = tf.Variable([[0, 0]], tf.float32)\r\n\r\nIt will get:\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\n...\r\n\r\n### What other attempted solutions have you tried?\r\nwith tf.device('/gpu:0'):\r\n    a = tf.Variable([[1.0, 1.0]], tf.float32)\r\n\r\nwith tf.device('/cpu:0'):\r\n    b = tf.Variable([[0.0, 0.0]], tf.float32)\r\nIf I change the contents of the initial value from integer to float, everything will be fine.\r\n\r\n### Logs or other output that would be helpful\r\n(If logs are large, please upload as attachment or provide link).\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\r\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: \r\nname: GeForce 940M\r\nmajor: 5 minor: 0 memoryClockRate (GHz) 1.176\r\npciBusID 0000:04:00.0\r\nTotal memory: 1.96GiB\r\nFree memory: 1.60GiB\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 \r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y \r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0\r\nI tensorflow/core/common_runtime/direct_session.cc:257] Device mapping:\r\n/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: GeForce 940M, pci bus id: 0000:04:00.0\r\n\r\nVariable_1: (VariableV2): /job:localhost/replica:0/task:0/cpu:0\r\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1: (VariableV2)/job:localhost/replica:0/task:0/cpu:0\r\nVariable_1/read: (Identity): /job:localhost/replica:0/task:0/cpu:0\r\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1/read: (Identity)/job:localhost/replica:0/task:0/cpu:0\r\nPrint_1: (Print): /job:localhost/replica:0/task:0/cpu:0\r\nI tensorflow/core/common_runtime/simple_placer.cc:841] Print_1: (Print)/job:localhost/replica:0/task:0/cpu:0\r\nVariable_1/Assign: (Assign): /job:localhost/replica:0/task:0/cpu:0\r\nI tensorflow/core/common_runtime/simple_placer.cc:841] Variable_1/Assign: (Assign)/job:localhost/replica:0/task:0/cpu:0\r\ninit/NoOp: (NoOp): /job:localhost/replica:0/task:0/cpu:0\r\nI tensorflow/core/common_runtime/simple_placer.cc:841] init/NoOp: (NoOp)/job:localhost/replica:0/task:0/cpu:0\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 20, in <module>\r\n    sess.run(tf.global_variables_initializer())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nColocation Debug Info:\r\nColocation group had the following types and devices: \r\nAssign: CPU \r\nIdentity: CPU \r\nVariableV2: CPU \r\n\t [[Node: Variable = VariableV2[container=\"\", dtype=DT_INT32, shape=[1,2], shared_name=\"\", _device=\"/device:GPU:0\"]()]]\r\n\r\nCaused by op u'Variable', defined at:\r\n  File \"test.py\", line 8, in <module>\r\n    a = tf.Variable([[1, 1]], tf.float32)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 197, in __init__\r\n    expected_shape=expected_shape)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 293, in _init_from_args\r\n    name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/state_ops.py\", line 128, in variable_op_v2\r\n    shared_name=shared_name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_state_ops.py\", line 708, in _variable_v2\r\n    name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2327, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1226, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device to node 'Variable': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nColocation Debug Info:\r\nColocation group had the following types and devices: \r\nAssign: CPU \r\nIdentity: CPU \r\nVariableV2: CPU \r\n\t [[Node: Variable = VariableV2[container=\"\", dtype=DT_INT32, shape=[1,2], shared_name=\"\", _device=\"/device:GPU:0\"]()]]\r\n\r\n"}