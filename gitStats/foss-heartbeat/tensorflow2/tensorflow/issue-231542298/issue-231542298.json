{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10210", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10210/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10210/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10210/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10210", "id": 231542298, "node_id": "MDU6SXNzdWUyMzE1NDIyOTg=", "number": 10210, "title": "tf.summary.image bug with input_queues", "user": {"login": "AndreiCostinescu", "id": 9751090, "node_id": "MDQ6VXNlcjk3NTEwOTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9751090?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AndreiCostinescu", "html_url": "https://github.com/AndreiCostinescu", "followers_url": "https://api.github.com/users/AndreiCostinescu/followers", "following_url": "https://api.github.com/users/AndreiCostinescu/following{/other_user}", "gists_url": "https://api.github.com/users/AndreiCostinescu/gists{/gist_id}", "starred_url": "https://api.github.com/users/AndreiCostinescu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AndreiCostinescu/subscriptions", "organizations_url": "https://api.github.com/users/AndreiCostinescu/orgs", "repos_url": "https://api.github.com/users/AndreiCostinescu/repos", "events_url": "https://api.github.com/users/AndreiCostinescu/events{/privacy}", "received_events_url": "https://api.github.com/users/AndreiCostinescu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-05-26T06:58:59Z", "updated_at": "2017-06-02T11:48:42Z", "closed_at": "2017-06-02T00:38:03Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code</strong>: yes</li>\n<li><strong>OS Platform and Distribution</strong>: Windows 10, Linux Ubuntu 14.04.02</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.1.0</li>\n<li><strong>CUDA/cuDNN version</strong>: 8.0</li>\n<li><strong>Exact command to reproduce</strong>: python error_reading_with_summary.py</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When creating <code>tf.summary.image()</code> summaries when using <code>tf.train.slice_input_producer()</code> for generating the images, the input queue gets emptied very fast and I end up with less data for training...<br>\nFor example: When having 5 images, the first image gets read but when I try collecting the second image I get a <code>tf.errors.OutOfRangeError</code> error. This is not a problem with how I input the images because when I leave out the summaries I can read all images.<br>\nI get multiple warnings like</p>\n<pre><code>2017-05-26 08:33:43.017260: W c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:1152] Out of range: FIFOQueue '_6_input_producer/input_producer' is closed and has insufficient elements (requested 1, current size 0)\n\t [[Node: input_producer/input_producer_Dequeue = QueueDequeueV2[component_types=[DT_INT32], timeout_ms=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](input_producer/input_producer)]]\n</code></pre>\n<p>when I create the summary operation and then run the summary operation.<br>\nInterestingly enough, I also get this warning when I run the summary operation without any summaries created. But at least then all my images get read.<br>\nWhen I don't have any summaries and don't run any summary operation this warning doesn't appear at all.</p>\n<p>The attached archive contains a minimal replicating example. The <code>tf.summary.image()</code> is at line 15-16 in the <code>get_batch()</code> function and the <code>merged_summary_op</code> is created at line 31 and run at line 45 in the <code>test_read_images_summary()</code> function.<br>\nRun <code>python error_reading_with_summaries</code> to execute all 4 cases:</p>\n<ol>\n<li>When the summary isn't created and the summary operation isn't executed.</li>\n<li>When the summary is created but the summary operation isn't executed.</li>\n<li>When the summary isn't created but the summary operation is executed.</li>\n<li>When the summary is created and the summary operation is executed.</li>\n</ol>\n<p>Use the option <code>-s</code> for only creating the summary and <code>-r</code> only for executing the summary operation and use both <code>-r -s</code> for creating and executing the summary operation.</p>\n<h3>Source code / logs</h3>\n<p>Source code, traceback and images are included: <a href=\"https://github.com/tensorflow/tensorflow/files/1031025/error_reading_with_summary.zip\">error_reading_with_summary.zip</a><br>\nRun <code>python error_reading_with_summaries.py</code> or <code>python error_reading_with_summaries.py -h</code> for help.</p>", "body_text": "System information\n\nHave I written custom code: yes\nOS Platform and Distribution: Windows 10, Linux Ubuntu 14.04.02\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.1.0\nCUDA/cuDNN version: 8.0\nExact command to reproduce: python error_reading_with_summary.py\n\nDescribe the problem\nWhen creating tf.summary.image() summaries when using tf.train.slice_input_producer() for generating the images, the input queue gets emptied very fast and I end up with less data for training...\nFor example: When having 5 images, the first image gets read but when I try collecting the second image I get a tf.errors.OutOfRangeError error. This is not a problem with how I input the images because when I leave out the summaries I can read all images.\nI get multiple warnings like\n2017-05-26 08:33:43.017260: W c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:1152] Out of range: FIFOQueue '_6_input_producer/input_producer' is closed and has insufficient elements (requested 1, current size 0)\n\t [[Node: input_producer/input_producer_Dequeue = QueueDequeueV2[component_types=[DT_INT32], timeout_ms=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](input_producer/input_producer)]]\n\nwhen I create the summary operation and then run the summary operation.\nInterestingly enough, I also get this warning when I run the summary operation without any summaries created. But at least then all my images get read.\nWhen I don't have any summaries and don't run any summary operation this warning doesn't appear at all.\nThe attached archive contains a minimal replicating example. The tf.summary.image() is at line 15-16 in the get_batch() function and the merged_summary_op is created at line 31 and run at line 45 in the test_read_images_summary() function.\nRun python error_reading_with_summaries to execute all 4 cases:\n\nWhen the summary isn't created and the summary operation isn't executed.\nWhen the summary is created but the summary operation isn't executed.\nWhen the summary isn't created but the summary operation is executed.\nWhen the summary is created and the summary operation is executed.\n\nUse the option -s for only creating the summary and -r only for executing the summary operation and use both -r -s for creating and executing the summary operation.\nSource code / logs\nSource code, traceback and images are included: error_reading_with_summary.zip\nRun python error_reading_with_summaries.py or python error_reading_with_summaries.py -h for help.", "body": "### System information\r\n- **Have I written custom code**: yes\r\n- **OS Platform and Distribution**: Windows 10, Linux Ubuntu 14.04.02\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.1.0\r\n- **CUDA/cuDNN version**: 8.0\r\n- **Exact command to reproduce**: python error_reading_with_summary.py\r\n\r\n### Describe the problem\r\nWhen creating `tf.summary.image()` summaries when using `tf.train.slice_input_producer()` for generating the images, the input queue gets emptied very fast and I end up with less data for training... \r\nFor example: When having 5 images, the first image gets read but when I try collecting the second image I get a `tf.errors.OutOfRangeError` error. This is not a problem with how I input the images because when I leave out the summaries I can read all images.\r\nI get multiple warnings like\r\n```\r\n2017-05-26 08:33:43.017260: W c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:1152] Out of range: FIFOQueue '_6_input_producer/input_producer' is closed and has insufficient elements (requested 1, current size 0)\r\n\t [[Node: input_producer/input_producer_Dequeue = QueueDequeueV2[component_types=[DT_INT32], timeout_ms=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](input_producer/input_producer)]]\r\n```\r\nwhen I create the summary operation and then run the summary operation.\r\nInterestingly enough, I also get this warning when I run the summary operation without any summaries created. But at least then all my images get read.\r\nWhen I don't have any summaries and don't run any summary operation this warning doesn't appear at all.\r\n\r\nThe attached archive contains a minimal replicating example. The `tf.summary.image()` is at line 15-16 in the `get_batch()` function and the `merged_summary_op` is created at line 31 and run at line 45 in the `test_read_images_summary()` function.\r\nRun `python error_reading_with_summaries` to execute all 4 cases: \r\n1. When the summary isn't created and the summary operation isn't executed.\r\n2. When the summary is created but the summary operation isn't executed.\r\n3. When the summary isn't created but the summary operation is executed.\r\n4. When the summary is created and the summary operation is executed.\r\n\r\nUse the option `-s` for only creating the summary and `-r` only for executing the summary operation and use both `-r -s` for creating and executing the summary operation.\r\n\r\n### Source code / logs\r\nSource code, traceback and images are included: [error_reading_with_summary.zip](https://github.com/tensorflow/tensorflow/files/1031025/error_reading_with_summary.zip)\r\nRun `python error_reading_with_summaries.py` or `python error_reading_with_summaries.py -h` for help."}