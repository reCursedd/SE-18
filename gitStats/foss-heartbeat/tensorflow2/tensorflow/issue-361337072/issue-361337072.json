{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22346", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22346/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22346/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22346/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22346", "id": 361337072, "node_id": "MDU6SXNzdWUzNjEzMzcwNzI=", "number": 22346, "title": " NotFoundError (see above for traceback): Key Variable not found in checkpoint     \t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], ", "user": {"login": "oroojlooy", "id": 20797260, "node_id": "MDQ6VXNlcjIwNzk3MjYw", "avatar_url": "https://avatars0.githubusercontent.com/u/20797260?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oroojlooy", "html_url": "https://github.com/oroojlooy", "followers_url": "https://api.github.com/users/oroojlooy/followers", "following_url": "https://api.github.com/users/oroojlooy/following{/other_user}", "gists_url": "https://api.github.com/users/oroojlooy/gists{/gist_id}", "starred_url": "https://api.github.com/users/oroojlooy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oroojlooy/subscriptions", "organizations_url": "https://api.github.com/users/oroojlooy/orgs", "repos_url": "https://api.github.com/users/oroojlooy/repos", "events_url": "https://api.github.com/users/oroojlooy/events{/privacy}", "received_events_url": "https://api.github.com/users/oroojlooy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-09-18T14:36:57Z", "updated_at": "2018-09-20T18:50:40Z", "closed_at": "2018-09-20T18:50:40Z", "author_association": "NONE", "body_html": "<p>When I restore a saved model using:</p>\n<pre><code>checkpoint = tf.train.get_checkpoint_state(config.pre_model_dir)\nif checkpoint and checkpoint.model_checkpoint_path:\n saver.restore(session, checkpoint.model_checkpoint_path)\n</code></pre>\n<p>, I am getting this error:</p>\n<pre><code>INFO:tensorflow:Restoring parameters from ./saved_model/10_zones/10/network--1685000\n---------------------------------------------------------------------------\nNotFoundError                             Traceback (most recent call last)\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\n   1321     try:\n-&gt; 1322       return fn(*args)\n   1323     except errors.OpError as e:\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\n   1306       return self._call_tf_sessionrun(\n-&gt; 1307           options, feed_dict, fetch_list, target_list, run_metadata)\n   1308 \n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\n   1408           self._session, options, feed_dict, fetch_list, target_list,\n-&gt; 1409           run_metadata)\n   1410     else:\n\nNotFoundError: Key Variable not found in checkpoint\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n\nDuring handling of the above exception, another exception occurred:\n\nNotFoundError                             Traceback (most recent call last)\n&lt;ipython-input-97-0cbd09927b40&gt; in &lt;module&gt;()\n     42 checkpoint = tf.train.get_checkpoint_state(config.pre_model_dir)\n     43 if checkpoint and checkpoint.model_checkpoint_path:\n---&gt; 44     saver.restore(session, checkpoint.model_checkpoint_path)\n     45     print(\"loaded the model\")\n     46 else:\n\n/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\n   1800     else:\n   1801       sess.run(self.saver_def.restore_op_name,\n-&gt; 1802                {self.saver_def.filename_tensor_name: save_path})\n   1803 \n   1804   @staticmethod\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\n    898     try:\n    899       result = self._run(None, fetches, feed_dict, options_ptr,\n--&gt; 900                          run_metadata_ptr)\n    901       if run_metadata:\n    902         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\n   1133     if final_fetches or final_targets or (handle and feed_dict_tensor):\n   1134       results = self._do_run(handle, final_targets, final_fetches,\n-&gt; 1135                              feed_dict_tensor, options, run_metadata)\n   1136     else:\n   1137       results = []\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n   1314     if handle is None:\n   1315       return self._do_call(_run_fn, feeds, fetches, targets, options,\n-&gt; 1316                            run_metadata)\n   1317     else:\n   1318       return self._do_call(_prun_fn, handle, feeds, fetches)\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\n   1333         except KeyError:\n   1334           pass\n-&gt; 1335       raise type(e)(node_def, op, message)\n   1336 \n   1337   def _extend_graph(self):\n\nNotFoundError: Key Variable not found in checkpoint\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n\nCaused by op 'save/RestoreV2', defined at:\n  File \"/usr/lib64/python3.6/runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib64/python3.6/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/usr/lib/python3.6/site-packages/ipykernel_launcher.py\", line 16, in &lt;module&gt;\n    app.launch_new_instance()\n  File \"/usr/lib/python3.6/site-packages/traitlets/config/application.py\", line 658, in launch_instance\n    app.start()\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 486, in start\n    self.io_loop.start()\n  File \"/usr/lib64/python3.6/site-packages/tornado/platform/asyncio.py\", line 127, in start\n    self.asyncio_loop.run_forever()\n  File \"/usr/lib64/python3.6/asyncio/base_events.py\", line 422, in run_forever\n    self._run_once()\n  File \"/usr/lib64/python3.6/asyncio/base_events.py\", line 1432, in _run_once\n    handle._run()\n  File \"/usr/lib64/python3.6/asyncio/events.py\", line 145, in _run\n    self._callback(*self._args)\n  File \"/usr/lib64/python3.6/site-packages/tornado/platform/asyncio.py\", line 117, in _handle_events\n    handler_func(fileobj, events)\n  File \"/usr/lib64/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\n    self._handle_recv()\n  File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\n    callback(*args, **kwargs)\n  File \"/usr/lib64/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\n    user_expressions, allow_stdin)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2662, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2785, in _run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2903, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2963, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"&lt;ipython-input-97-0cbd09927b40&gt;\", line 26, in &lt;module&gt;\n    saver = tf.train.Saver()\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1338, in __init__\n    self.build()\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1347, in build\n    self._build(self._filename, build_save=True, build_restore=True)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1384, in _build\n    build_save=build_save, build_restore=build_restore)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 835, in _build_internal\n    restore_sequentially, reshape)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 472, in _AddRestoreOps\n    restore_sequentially)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 886, in bulk_restore\n    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1463, in restore_v2\n    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op\n    op_def=op_def)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1718, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nNotFoundError (see above for traceback): Key Variable not found in checkpoint\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n</code></pre>\n<p>I searched about this error, and there was a tf bug which requires to call the model using a full relative path, and I followed that path and tried values: <code>'./saved_model/10_zones/10'</code> and <code>os.path.abspath(config.pre_model_dir+'./../saved_model/10_zones/10')</code><br>\nfor <code>config.pre_model_dir</code>. Both resulted in a same error.</p>\n<p>I also checked the name of the saved variables using<br>\nfrom tensorflow.contrib.framework.python.framework import checkpoint_utils</p>\n<pre><code>var_list = checkpoint_utils.list_variables(config.pre_model_dir)\nfor v in var_list:\n    print(v)\n</code></pre>\n<p>which is:</p>\n<pre><code>('actor/main_net/layer1/biases/Variable', [90])\n('actor/main_net/layer1/biases/Variable/Adam', [90])\n('actor/main_net/layer1/biases/Variable/Adam_1', [90])\n('actor/main_net/layer1/weights/Variable', [30, 90])\n('actor/main_net/layer1/weights/Variable/Adam', [30, 90])\n('actor/main_net/layer1/weights/Variable/Adam_1', [30, 90])\n('actor/main_net/layer2/biases/Variable', [60])\n('actor/main_net/layer2/biases/Variable/Adam', [60])\n('actor/main_net/layer2/biases/Variable/Adam_1', [60])\n('actor/main_net/layer2/weights/Variable', [90, 60])\n('actor/main_net/layer2/weights/Variable/Adam', [90, 60])\n('actor/main_net/layer2/weights/Variable/Adam_1', [90, 60])\n('actor/main_net/layer3/biases/Variable', [30])\n('actor/main_net/layer3/biases/Variable/Adam', [30])\n('actor/main_net/layer3/biases/Variable/Adam_1', [30])\n('actor/main_net/layer3/weights/Variable', [60, 30])\n('actor/main_net/layer3/weights/Variable/Adam', [60, 30])\n('actor/main_net/layer3/weights/Variable/Adam_1', [60, 30])\n('actor/main_net/layer4/biases/Variable', [10])\n('actor/main_net/layer4/biases/Variable/Adam', [10])\n('actor/main_net/layer4/biases/Variable/Adam_1', [10])\n('actor/main_net/layer4/weights/Variable', [30, 10])\n('actor/main_net/layer4/weights/Variable/Adam', [30, 10])\n('actor/main_net/layer4/weights/Variable/Adam_1', [30, 10])\n('actor/target_net/layer1/biases/Variable', [90])\n('actor/target_net/layer1/weights/Variable', [30, 90])\n('actor/target_net/layer2/biases/Variable', [60])\n('actor/target_net/layer2/weights/Variable', [90, 60])\n('actor/target_net/layer3/biases/Variable', [30])\n('actor/target_net/layer3/weights/Variable', [60, 30])\n('actor/target_net/layer4/biases/Variable', [10])\n('actor/target_net/layer4/weights/Variable', [30, 10])\n('beta1_power', [])\n('beta1_power_1', [])\n('beta2_power', [])\n('beta2_power_1', [])\n('critic/main_net/l1/biases', [90])\n('critic/main_net/l1/biases/Adam', [90])\n('critic/main_net/l1/biases/Adam_1', [90])\n('critic/main_net/l1/weights', [40, 90])\n('critic/main_net/l1/weights/Adam', [40, 90])\n('critic/main_net/l1/weights/Adam_1', [40, 90])\n('critic/main_net/l2/biases', [60])\n('critic/main_net/l2/biases/Adam', [60])\n('critic/main_net/l2/biases/Adam_1', [60])\n('critic/main_net/l2/weights', [90, 60])\n('critic/main_net/l2/weights/Adam', [90, 60])\n('critic/main_net/l2/weights/Adam_1', [90, 60])\n('critic/main_net/l3/biases', [30])\n('critic/main_net/l3/biases/Adam', [30])\n('critic/main_net/l3/biases/Adam_1', [30])\n('critic/main_net/l3/weights', [60, 30])\n('critic/main_net/l3/weights/Adam', [60, 30])\n('critic/main_net/l3/weights/Adam_1', [60, 30])\n('critic/main_net/l4/bias', [1])\n('critic/main_net/l4/bias/Adam', [1])\n('critic/main_net/l4/bias/Adam_1', [1])\n('critic/main_net/l4/kernel', [30, 1])\n('critic/main_net/l4/kernel/Adam', [30, 1])\n('critic/main_net/l4/kernel/Adam_1', [30, 1])\n('critic/target_net/l1/biases', [90])\n('critic/target_net/l1/weights', [40, 90])\n('critic/target_net/l2/biases', [60])\n('critic/target_net/l2/weights', [90, 60])\n('critic/target_net/l3/biases', [30])\n('critic/target_net/l3/weights', [60, 30])\n('critic/target_net/l4/bias', [1])\n('critic/target_net/l4/kernel', [30, 1])\n</code></pre>\n<p>with what <code>tf.global_variables()</code> in my current model results in, and they are both similar:</p>\n<pre><code>&lt;tf.Variable 'actor/main_net/layer1/weights/Variable:0' shape=(30, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer1/biases/Variable:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer2/weights/Variable:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer2/biases/Variable:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer3/weights/Variable:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer3/biases/Variable:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer4/weights/Variable:0' shape=(30, 10) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer4/biases/Variable:0' shape=(10,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer1/weights/Variable:0' shape=(30, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer1/biases/Variable:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer2/weights/Variable:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer2/biases/Variable:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer3/weights/Variable:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer3/biases/Variable:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer4/weights/Variable:0' shape=(30, 10) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/target_net/layer4/biases/Variable:0' shape=(10,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'Variable:0' shape=() dtype=int32_ref&gt;,\n &lt;tf.Variable 'beta1_power:0' shape=() dtype=float32_ref&gt;,\n &lt;tf.Variable 'beta2_power:0' shape=() dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer1/weights/Variable/Adam:0' shape=(30, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer1/weights/Variable/Adam_1:0' shape=(30, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer1/biases/Variable/Adam:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer1/biases/Variable/Adam_1:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer2/weights/Variable/Adam:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer2/weights/Variable/Adam_1:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer2/biases/Variable/Adam:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer2/biases/Variable/Adam_1:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer3/weights/Variable/Adam:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer3/weights/Variable/Adam_1:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer3/biases/Variable/Adam:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer3/biases/Variable/Adam_1:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer4/weights/Variable/Adam:0' shape=(30, 10) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer4/weights/Variable/Adam_1:0' shape=(30, 10) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer4/biases/Variable/Adam:0' shape=(10,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'actor/main_net/layer4/biases/Variable/Adam_1:0' shape=(10,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l1/weights:0' shape=(40, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l1/biases:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l2/weights:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l2/biases:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l3/weights:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l3/biases:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l4/kernel:0' shape=(30, 1) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l4/bias:0' shape=(1,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l1/weights:0' shape=(40, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l1/biases:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l2/weights:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l2/biases:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l3/weights:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l3/biases:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l4/kernel:0' shape=(30, 1) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/target_net/l4/bias:0' shape=(1,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'beta1_power_1:0' shape=() dtype=float32_ref&gt;,\n &lt;tf.Variable 'beta2_power_1:0' shape=() dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l1/weights/Adam:0' shape=(40, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l1/weights/Adam_1:0' shape=(40, 90) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l1/biases/Adam:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l1/biases/Adam_1:0' shape=(90,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l2/weights/Adam:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l2/weights/Adam_1:0' shape=(90, 60) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l2/biases/Adam:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l2/biases/Adam_1:0' shape=(60,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l3/weights/Adam:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l3/weights/Adam_1:0' shape=(60, 30) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l3/biases/Adam:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l3/biases/Adam_1:0' shape=(30,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l4/kernel/Adam:0' shape=(30, 1) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l4/kernel/Adam_1:0' shape=(30, 1) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l4/bias/Adam:0' shape=(1,) dtype=float32_ref&gt;,\n &lt;tf.Variable 'critic/main_net/l4/bias/Adam_1:0' shape=(1,) dtype=float32_ref&gt;\n</code></pre>\n<p>The only difference in these two lists, is <code> &lt;tf.Variable 'Variable:0' shape=() dtype=int32_ref&gt;</code>, which I do not know what is this for and how it is generated. But, I do not think if it is the problem, since any of my models that can be restored also has it.</p>\n<p>I appreciate any help and comment to resolve this error.</p>\n<hr>\n<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:Yes.</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 18.04</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>: No</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.8</li>\n<li><strong>Python version</strong>: 3.6</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: 9.0</li>\n<li><strong>GPU model and memory</strong>: P100, 24 GB</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>", "body_text": "When I restore a saved model using:\ncheckpoint = tf.train.get_checkpoint_state(config.pre_model_dir)\nif checkpoint and checkpoint.model_checkpoint_path:\n saver.restore(session, checkpoint.model_checkpoint_path)\n\n, I am getting this error:\nINFO:tensorflow:Restoring parameters from ./saved_model/10_zones/10/network--1685000\n---------------------------------------------------------------------------\nNotFoundError                             Traceback (most recent call last)\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\n   1321     try:\n-> 1322       return fn(*args)\n   1323     except errors.OpError as e:\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\n   1306       return self._call_tf_sessionrun(\n-> 1307           options, feed_dict, fetch_list, target_list, run_metadata)\n   1308 \n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\n   1408           self._session, options, feed_dict, fetch_list, target_list,\n-> 1409           run_metadata)\n   1410     else:\n\nNotFoundError: Key Variable not found in checkpoint\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n\nDuring handling of the above exception, another exception occurred:\n\nNotFoundError                             Traceback (most recent call last)\n<ipython-input-97-0cbd09927b40> in <module>()\n     42 checkpoint = tf.train.get_checkpoint_state(config.pre_model_dir)\n     43 if checkpoint and checkpoint.model_checkpoint_path:\n---> 44     saver.restore(session, checkpoint.model_checkpoint_path)\n     45     print(\"loaded the model\")\n     46 else:\n\n/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\n   1800     else:\n   1801       sess.run(self.saver_def.restore_op_name,\n-> 1802                {self.saver_def.filename_tensor_name: save_path})\n   1803 \n   1804   @staticmethod\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\n    898     try:\n    899       result = self._run(None, fetches, feed_dict, options_ptr,\n--> 900                          run_metadata_ptr)\n    901       if run_metadata:\n    902         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\n   1133     if final_fetches or final_targets or (handle and feed_dict_tensor):\n   1134       results = self._do_run(handle, final_targets, final_fetches,\n-> 1135                              feed_dict_tensor, options, run_metadata)\n   1136     else:\n   1137       results = []\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n   1314     if handle is None:\n   1315       return self._do_call(_run_fn, feeds, fetches, targets, options,\n-> 1316                            run_metadata)\n   1317     else:\n   1318       return self._do_call(_prun_fn, handle, feeds, fetches)\n\n/usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\n   1333         except KeyError:\n   1334           pass\n-> 1335       raise type(e)(node_def, op, message)\n   1336 \n   1337   def _extend_graph(self):\n\nNotFoundError: Key Variable not found in checkpoint\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n\nCaused by op 'save/RestoreV2', defined at:\n  File \"/usr/lib64/python3.6/runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib64/python3.6/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/usr/lib/python3.6/site-packages/ipykernel_launcher.py\", line 16, in <module>\n    app.launch_new_instance()\n  File \"/usr/lib/python3.6/site-packages/traitlets/config/application.py\", line 658, in launch_instance\n    app.start()\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 486, in start\n    self.io_loop.start()\n  File \"/usr/lib64/python3.6/site-packages/tornado/platform/asyncio.py\", line 127, in start\n    self.asyncio_loop.run_forever()\n  File \"/usr/lib64/python3.6/asyncio/base_events.py\", line 422, in run_forever\n    self._run_once()\n  File \"/usr/lib64/python3.6/asyncio/base_events.py\", line 1432, in _run_once\n    handle._run()\n  File \"/usr/lib64/python3.6/asyncio/events.py\", line 145, in _run\n    self._callback(*self._args)\n  File \"/usr/lib64/python3.6/site-packages/tornado/platform/asyncio.py\", line 117, in _handle_events\n    handler_func(fileobj, events)\n  File \"/usr/lib64/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\n    self._handle_recv()\n  File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\n    callback(*args, **kwargs)\n  File \"/usr/lib64/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\n    user_expressions, allow_stdin)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/usr/lib/python3.6/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2662, in run_cell\n    raw_cell, store_history, silent, shell_futures)\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2785, in _run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2903, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2963, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-97-0cbd09927b40>\", line 26, in <module>\n    saver = tf.train.Saver()\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1338, in __init__\n    self.build()\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1347, in build\n    self._build(self._filename, build_save=True, build_restore=True)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1384, in _build\n    build_save=build_save, build_restore=build_restore)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 835, in _build_internal\n    restore_sequentially, reshape)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 472, in _AddRestoreOps\n    restore_sequentially)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 886, in bulk_restore\n    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1463, in restore_v2\n    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op\n    op_def=op_def)\n  File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1718, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nNotFoundError (see above for traceback): Key Variable not found in checkpoint\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n\nI searched about this error, and there was a tf bug which requires to call the model using a full relative path, and I followed that path and tried values: './saved_model/10_zones/10' and os.path.abspath(config.pre_model_dir+'./../saved_model/10_zones/10')\nfor config.pre_model_dir. Both resulted in a same error.\nI also checked the name of the saved variables using\nfrom tensorflow.contrib.framework.python.framework import checkpoint_utils\nvar_list = checkpoint_utils.list_variables(config.pre_model_dir)\nfor v in var_list:\n    print(v)\n\nwhich is:\n('actor/main_net/layer1/biases/Variable', [90])\n('actor/main_net/layer1/biases/Variable/Adam', [90])\n('actor/main_net/layer1/biases/Variable/Adam_1', [90])\n('actor/main_net/layer1/weights/Variable', [30, 90])\n('actor/main_net/layer1/weights/Variable/Adam', [30, 90])\n('actor/main_net/layer1/weights/Variable/Adam_1', [30, 90])\n('actor/main_net/layer2/biases/Variable', [60])\n('actor/main_net/layer2/biases/Variable/Adam', [60])\n('actor/main_net/layer2/biases/Variable/Adam_1', [60])\n('actor/main_net/layer2/weights/Variable', [90, 60])\n('actor/main_net/layer2/weights/Variable/Adam', [90, 60])\n('actor/main_net/layer2/weights/Variable/Adam_1', [90, 60])\n('actor/main_net/layer3/biases/Variable', [30])\n('actor/main_net/layer3/biases/Variable/Adam', [30])\n('actor/main_net/layer3/biases/Variable/Adam_1', [30])\n('actor/main_net/layer3/weights/Variable', [60, 30])\n('actor/main_net/layer3/weights/Variable/Adam', [60, 30])\n('actor/main_net/layer3/weights/Variable/Adam_1', [60, 30])\n('actor/main_net/layer4/biases/Variable', [10])\n('actor/main_net/layer4/biases/Variable/Adam', [10])\n('actor/main_net/layer4/biases/Variable/Adam_1', [10])\n('actor/main_net/layer4/weights/Variable', [30, 10])\n('actor/main_net/layer4/weights/Variable/Adam', [30, 10])\n('actor/main_net/layer4/weights/Variable/Adam_1', [30, 10])\n('actor/target_net/layer1/biases/Variable', [90])\n('actor/target_net/layer1/weights/Variable', [30, 90])\n('actor/target_net/layer2/biases/Variable', [60])\n('actor/target_net/layer2/weights/Variable', [90, 60])\n('actor/target_net/layer3/biases/Variable', [30])\n('actor/target_net/layer3/weights/Variable', [60, 30])\n('actor/target_net/layer4/biases/Variable', [10])\n('actor/target_net/layer4/weights/Variable', [30, 10])\n('beta1_power', [])\n('beta1_power_1', [])\n('beta2_power', [])\n('beta2_power_1', [])\n('critic/main_net/l1/biases', [90])\n('critic/main_net/l1/biases/Adam', [90])\n('critic/main_net/l1/biases/Adam_1', [90])\n('critic/main_net/l1/weights', [40, 90])\n('critic/main_net/l1/weights/Adam', [40, 90])\n('critic/main_net/l1/weights/Adam_1', [40, 90])\n('critic/main_net/l2/biases', [60])\n('critic/main_net/l2/biases/Adam', [60])\n('critic/main_net/l2/biases/Adam_1', [60])\n('critic/main_net/l2/weights', [90, 60])\n('critic/main_net/l2/weights/Adam', [90, 60])\n('critic/main_net/l2/weights/Adam_1', [90, 60])\n('critic/main_net/l3/biases', [30])\n('critic/main_net/l3/biases/Adam', [30])\n('critic/main_net/l3/biases/Adam_1', [30])\n('critic/main_net/l3/weights', [60, 30])\n('critic/main_net/l3/weights/Adam', [60, 30])\n('critic/main_net/l3/weights/Adam_1', [60, 30])\n('critic/main_net/l4/bias', [1])\n('critic/main_net/l4/bias/Adam', [1])\n('critic/main_net/l4/bias/Adam_1', [1])\n('critic/main_net/l4/kernel', [30, 1])\n('critic/main_net/l4/kernel/Adam', [30, 1])\n('critic/main_net/l4/kernel/Adam_1', [30, 1])\n('critic/target_net/l1/biases', [90])\n('critic/target_net/l1/weights', [40, 90])\n('critic/target_net/l2/biases', [60])\n('critic/target_net/l2/weights', [90, 60])\n('critic/target_net/l3/biases', [30])\n('critic/target_net/l3/weights', [60, 30])\n('critic/target_net/l4/bias', [1])\n('critic/target_net/l4/kernel', [30, 1])\n\nwith what tf.global_variables() in my current model results in, and they are both similar:\n<tf.Variable 'actor/main_net/layer1/weights/Variable:0' shape=(30, 90) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer1/biases/Variable:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer2/weights/Variable:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer2/biases/Variable:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer3/weights/Variable:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer3/biases/Variable:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer4/weights/Variable:0' shape=(30, 10) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer4/biases/Variable:0' shape=(10,) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer1/weights/Variable:0' shape=(30, 90) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer1/biases/Variable:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer2/weights/Variable:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer2/biases/Variable:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer3/weights/Variable:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer3/biases/Variable:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer4/weights/Variable:0' shape=(30, 10) dtype=float32_ref>,\n <tf.Variable 'actor/target_net/layer4/biases/Variable:0' shape=(10,) dtype=float32_ref>,\n <tf.Variable 'Variable:0' shape=() dtype=int32_ref>,\n <tf.Variable 'beta1_power:0' shape=() dtype=float32_ref>,\n <tf.Variable 'beta2_power:0' shape=() dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer1/weights/Variable/Adam:0' shape=(30, 90) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer1/weights/Variable/Adam_1:0' shape=(30, 90) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer1/biases/Variable/Adam:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer1/biases/Variable/Adam_1:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer2/weights/Variable/Adam:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer2/weights/Variable/Adam_1:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer2/biases/Variable/Adam:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer2/biases/Variable/Adam_1:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer3/weights/Variable/Adam:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer3/weights/Variable/Adam_1:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer3/biases/Variable/Adam:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer3/biases/Variable/Adam_1:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer4/weights/Variable/Adam:0' shape=(30, 10) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer4/weights/Variable/Adam_1:0' shape=(30, 10) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer4/biases/Variable/Adam:0' shape=(10,) dtype=float32_ref>,\n <tf.Variable 'actor/main_net/layer4/biases/Variable/Adam_1:0' shape=(10,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l1/weights:0' shape=(40, 90) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l1/biases:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l2/weights:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l2/biases:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l3/weights:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l3/biases:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l4/kernel:0' shape=(30, 1) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l4/bias:0' shape=(1,) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l1/weights:0' shape=(40, 90) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l1/biases:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l2/weights:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l2/biases:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l3/weights:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l3/biases:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l4/kernel:0' shape=(30, 1) dtype=float32_ref>,\n <tf.Variable 'critic/target_net/l4/bias:0' shape=(1,) dtype=float32_ref>,\n <tf.Variable 'beta1_power_1:0' shape=() dtype=float32_ref>,\n <tf.Variable 'beta2_power_1:0' shape=() dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l1/weights/Adam:0' shape=(40, 90) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l1/weights/Adam_1:0' shape=(40, 90) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l1/biases/Adam:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l1/biases/Adam_1:0' shape=(90,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l2/weights/Adam:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l2/weights/Adam_1:0' shape=(90, 60) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l2/biases/Adam:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l2/biases/Adam_1:0' shape=(60,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l3/weights/Adam:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l3/weights/Adam_1:0' shape=(60, 30) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l3/biases/Adam:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l3/biases/Adam_1:0' shape=(30,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l4/kernel/Adam:0' shape=(30, 1) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l4/kernel/Adam_1:0' shape=(30, 1) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l4/bias/Adam:0' shape=(1,) dtype=float32_ref>,\n <tf.Variable 'critic/main_net/l4/bias/Adam_1:0' shape=(1,) dtype=float32_ref>\n\nThe only difference in these two lists, is  <tf.Variable 'Variable:0' shape=() dtype=int32_ref>, which I do not know what is this for and how it is generated. But, I do not think if it is the problem, since any of my models that can be restored also has it.\nI appreciate any help and comment to resolve this error.\n\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):Yes.\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\nTensorFlow installed from (source or binary): binary\nTensorFlow version (use command below): 1.8\nPython version: 3.6\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version: 9.0\nGPU model and memory: P100, 24 GB\nExact command to reproduce:", "body": "When I restore a saved model using:\r\n\r\n    checkpoint = tf.train.get_checkpoint_state(config.pre_model_dir)\r\n    if checkpoint and checkpoint.model_checkpoint_path:\r\n     saver.restore(session, checkpoint.model_checkpoint_path)\r\n, I am getting this error: \r\n\r\n\r\n    INFO:tensorflow:Restoring parameters from ./saved_model/10_zones/10/network--1685000\r\n    ---------------------------------------------------------------------------\r\n    NotFoundError                             Traceback (most recent call last)\r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n       1321     try:\r\n    -> 1322       return fn(*args)\r\n       1323     except errors.OpError as e:\r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n       1306       return self._call_tf_sessionrun(\r\n    -> 1307           options, feed_dict, fetch_list, target_list, run_metadata)\r\n       1308 \r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n       1408           self._session, options, feed_dict, fetch_list, target_list,\r\n    -> 1409           run_metadata)\r\n       1410     else:\r\n    \r\n    NotFoundError: Key Variable not found in checkpoint\r\n    \t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\r\n    \t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\r\n    \r\n    During handling of the above exception, another exception occurred:\r\n    \r\n    NotFoundError                             Traceback (most recent call last)\r\n    <ipython-input-97-0cbd09927b40> in <module>()\r\n         42 checkpoint = tf.train.get_checkpoint_state(config.pre_model_dir)\r\n         43 if checkpoint and checkpoint.model_checkpoint_path:\r\n    ---> 44     saver.restore(session, checkpoint.model_checkpoint_path)\r\n         45     print(\"loaded the model\")\r\n         46 else:\r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\r\n       1800     else:\r\n       1801       sess.run(self.saver_def.restore_op_name,\r\n    -> 1802                {self.saver_def.filename_tensor_name: save_path})\r\n       1803 \r\n       1804   @staticmethod\r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n        898     try:\r\n        899       result = self._run(None, fetches, feed_dict, options_ptr,\r\n    --> 900                          run_metadata_ptr)\r\n        901       if run_metadata:\r\n        902         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n       1133     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n       1134       results = self._do_run(handle, final_targets, final_fetches,\r\n    -> 1135                              feed_dict_tensor, options, run_metadata)\r\n       1136     else:\r\n       1137       results = []\r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n       1314     if handle is None:\r\n       1315       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n    -> 1316                            run_metadata)\r\n       1317     else:\r\n       1318       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n    \r\n    /usr/lib/python3.6/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n       1333         except KeyError:\r\n       1334           pass\r\n    -> 1335       raise type(e)(node_def, op, message)\r\n       1336 \r\n       1337   def _extend_graph(self):\r\n    \r\n    NotFoundError: Key Variable not found in checkpoint\r\n    \t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\r\n    \t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\r\n    \r\n    Caused by op 'save/RestoreV2', defined at:\r\n      File \"/usr/lib64/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n        \"__main__\", mod_spec)\r\n      File \"/usr/lib64/python3.6/runpy.py\", line 85, in _run_code\r\n        exec(code, run_globals)\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel_launcher.py\", line 16, in <module>\r\n        app.launch_new_instance()\r\n      File \"/usr/lib/python3.6/site-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n        app.start()\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 486, in start\r\n        self.io_loop.start()\r\n      File \"/usr/lib64/python3.6/site-packages/tornado/platform/asyncio.py\", line 127, in start\r\n        self.asyncio_loop.run_forever()\r\n      File \"/usr/lib64/python3.6/asyncio/base_events.py\", line 422, in run_forever\r\n        self._run_once()\r\n      File \"/usr/lib64/python3.6/asyncio/base_events.py\", line 1432, in _run_once\r\n        handle._run()\r\n      File \"/usr/lib64/python3.6/asyncio/events.py\", line 145, in _run\r\n        self._callback(*self._args)\r\n      File \"/usr/lib64/python3.6/site-packages/tornado/platform/asyncio.py\", line 117, in _handle_events\r\n        handler_func(fileobj, events)\r\n      File \"/usr/lib64/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\r\n        return fn(*args, **kwargs)\r\n      File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\r\n        self._handle_recv()\r\n      File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\r\n        self._run_callback(callback, msg)\r\n      File \"/usr/lib64/python3.6/site-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\r\n        callback(*args, **kwargs)\r\n      File \"/usr/lib64/python3.6/site-packages/tornado/stack_context.py\", line 276, in null_wrapper\r\n        return fn(*args, **kwargs)\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n        return self.dispatch_shell(stream, msg)\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\r\n        handler(stream, idents, msg)\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n        user_expressions, allow_stdin)\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\r\n        res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n      File \"/usr/lib/python3.6/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\r\n        return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n      File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2662, in run_cell\r\n        raw_cell, store_history, silent, shell_futures)\r\n      File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2785, in _run_cell\r\n        interactivity=interactivity, compiler=compiler, result=result)\r\n      File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2903, in run_ast_nodes\r\n        if self.run_code(code, result):\r\n      File \"/usr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2963, in run_code\r\n        exec(code_obj, self.user_global_ns, self.user_ns)\r\n      File \"<ipython-input-97-0cbd09927b40>\", line 26, in <module>\r\n        saver = tf.train.Saver()\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1338, in __init__\r\n        self.build()\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1347, in build\r\n        self._build(self._filename, build_save=True, build_restore=True)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1384, in _build\r\n        build_save=build_save, build_restore=build_restore)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 835, in _build_internal\r\n        restore_sequentially, reshape)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 472, in _AddRestoreOps\r\n        restore_sequentially)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 886, in bulk_restore\r\n        return io_ops.restore_v2(filename_tensor, names, slices, dtypes)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1463, in restore_v2\r\n        shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n        op_def=op_def)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op\r\n        op_def=op_def)\r\n      File \"/usr/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1718, in __init__\r\n        self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n    \r\n    NotFoundError (see above for traceback): Key Variable not found in checkpoint\r\n    \t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\r\n    \t [[Node: save/RestoreV2/_21 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_18_save/RestoreV2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\r\n\r\n\r\nI searched about this error, and there was a tf bug which requires to call the model using a full relative path, and I followed that path and tried values: `'./saved_model/10_zones/10'` and `os.path.abspath(config.pre_model_dir+'./../saved_model/10_zones/10')`\r\nfor `config.pre_model_dir`. Both resulted in a same error. \r\n\r\nI also checked the name of the saved variables using \r\nfrom tensorflow.contrib.framework.python.framework import checkpoint_utils\r\n\r\n    var_list = checkpoint_utils.list_variables(config.pre_model_dir)\r\n    for v in var_list:\r\n        print(v)\r\nwhich is:\r\n\r\n    ('actor/main_net/layer1/biases/Variable', [90])\r\n    ('actor/main_net/layer1/biases/Variable/Adam', [90])\r\n    ('actor/main_net/layer1/biases/Variable/Adam_1', [90])\r\n    ('actor/main_net/layer1/weights/Variable', [30, 90])\r\n    ('actor/main_net/layer1/weights/Variable/Adam', [30, 90])\r\n    ('actor/main_net/layer1/weights/Variable/Adam_1', [30, 90])\r\n    ('actor/main_net/layer2/biases/Variable', [60])\r\n    ('actor/main_net/layer2/biases/Variable/Adam', [60])\r\n    ('actor/main_net/layer2/biases/Variable/Adam_1', [60])\r\n    ('actor/main_net/layer2/weights/Variable', [90, 60])\r\n    ('actor/main_net/layer2/weights/Variable/Adam', [90, 60])\r\n    ('actor/main_net/layer2/weights/Variable/Adam_1', [90, 60])\r\n    ('actor/main_net/layer3/biases/Variable', [30])\r\n    ('actor/main_net/layer3/biases/Variable/Adam', [30])\r\n    ('actor/main_net/layer3/biases/Variable/Adam_1', [30])\r\n    ('actor/main_net/layer3/weights/Variable', [60, 30])\r\n    ('actor/main_net/layer3/weights/Variable/Adam', [60, 30])\r\n    ('actor/main_net/layer3/weights/Variable/Adam_1', [60, 30])\r\n    ('actor/main_net/layer4/biases/Variable', [10])\r\n    ('actor/main_net/layer4/biases/Variable/Adam', [10])\r\n    ('actor/main_net/layer4/biases/Variable/Adam_1', [10])\r\n    ('actor/main_net/layer4/weights/Variable', [30, 10])\r\n    ('actor/main_net/layer4/weights/Variable/Adam', [30, 10])\r\n    ('actor/main_net/layer4/weights/Variable/Adam_1', [30, 10])\r\n    ('actor/target_net/layer1/biases/Variable', [90])\r\n    ('actor/target_net/layer1/weights/Variable', [30, 90])\r\n    ('actor/target_net/layer2/biases/Variable', [60])\r\n    ('actor/target_net/layer2/weights/Variable', [90, 60])\r\n    ('actor/target_net/layer3/biases/Variable', [30])\r\n    ('actor/target_net/layer3/weights/Variable', [60, 30])\r\n    ('actor/target_net/layer4/biases/Variable', [10])\r\n    ('actor/target_net/layer4/weights/Variable', [30, 10])\r\n    ('beta1_power', [])\r\n    ('beta1_power_1', [])\r\n    ('beta2_power', [])\r\n    ('beta2_power_1', [])\r\n    ('critic/main_net/l1/biases', [90])\r\n    ('critic/main_net/l1/biases/Adam', [90])\r\n    ('critic/main_net/l1/biases/Adam_1', [90])\r\n    ('critic/main_net/l1/weights', [40, 90])\r\n    ('critic/main_net/l1/weights/Adam', [40, 90])\r\n    ('critic/main_net/l1/weights/Adam_1', [40, 90])\r\n    ('critic/main_net/l2/biases', [60])\r\n    ('critic/main_net/l2/biases/Adam', [60])\r\n    ('critic/main_net/l2/biases/Adam_1', [60])\r\n    ('critic/main_net/l2/weights', [90, 60])\r\n    ('critic/main_net/l2/weights/Adam', [90, 60])\r\n    ('critic/main_net/l2/weights/Adam_1', [90, 60])\r\n    ('critic/main_net/l3/biases', [30])\r\n    ('critic/main_net/l3/biases/Adam', [30])\r\n    ('critic/main_net/l3/biases/Adam_1', [30])\r\n    ('critic/main_net/l3/weights', [60, 30])\r\n    ('critic/main_net/l3/weights/Adam', [60, 30])\r\n    ('critic/main_net/l3/weights/Adam_1', [60, 30])\r\n    ('critic/main_net/l4/bias', [1])\r\n    ('critic/main_net/l4/bias/Adam', [1])\r\n    ('critic/main_net/l4/bias/Adam_1', [1])\r\n    ('critic/main_net/l4/kernel', [30, 1])\r\n    ('critic/main_net/l4/kernel/Adam', [30, 1])\r\n    ('critic/main_net/l4/kernel/Adam_1', [30, 1])\r\n    ('critic/target_net/l1/biases', [90])\r\n    ('critic/target_net/l1/weights', [40, 90])\r\n    ('critic/target_net/l2/biases', [60])\r\n    ('critic/target_net/l2/weights', [90, 60])\r\n    ('critic/target_net/l3/biases', [30])\r\n    ('critic/target_net/l3/weights', [60, 30])\r\n    ('critic/target_net/l4/bias', [1])\r\n    ('critic/target_net/l4/kernel', [30, 1])\r\n\r\nwith what `tf.global_variables()` in my current model results in, and they are both similar:\r\n\r\n    <tf.Variable 'actor/main_net/layer1/weights/Variable:0' shape=(30, 90) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer1/biases/Variable:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer2/weights/Variable:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer2/biases/Variable:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer3/weights/Variable:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer3/biases/Variable:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer4/weights/Variable:0' shape=(30, 10) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer4/biases/Variable:0' shape=(10,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer1/weights/Variable:0' shape=(30, 90) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer1/biases/Variable:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer2/weights/Variable:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer2/biases/Variable:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer3/weights/Variable:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer3/biases/Variable:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer4/weights/Variable:0' shape=(30, 10) dtype=float32_ref>,\r\n     <tf.Variable 'actor/target_net/layer4/biases/Variable:0' shape=(10,) dtype=float32_ref>,\r\n     <tf.Variable 'Variable:0' shape=() dtype=int32_ref>,\r\n     <tf.Variable 'beta1_power:0' shape=() dtype=float32_ref>,\r\n     <tf.Variable 'beta2_power:0' shape=() dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer1/weights/Variable/Adam:0' shape=(30, 90) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer1/weights/Variable/Adam_1:0' shape=(30, 90) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer1/biases/Variable/Adam:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer1/biases/Variable/Adam_1:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer2/weights/Variable/Adam:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer2/weights/Variable/Adam_1:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer2/biases/Variable/Adam:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer2/biases/Variable/Adam_1:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer3/weights/Variable/Adam:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer3/weights/Variable/Adam_1:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer3/biases/Variable/Adam:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer3/biases/Variable/Adam_1:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer4/weights/Variable/Adam:0' shape=(30, 10) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer4/weights/Variable/Adam_1:0' shape=(30, 10) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer4/biases/Variable/Adam:0' shape=(10,) dtype=float32_ref>,\r\n     <tf.Variable 'actor/main_net/layer4/biases/Variable/Adam_1:0' shape=(10,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l1/weights:0' shape=(40, 90) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l1/biases:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l2/weights:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l2/biases:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l3/weights:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l3/biases:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l4/kernel:0' shape=(30, 1) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l4/bias:0' shape=(1,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l1/weights:0' shape=(40, 90) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l1/biases:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l2/weights:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l2/biases:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l3/weights:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l3/biases:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l4/kernel:0' shape=(30, 1) dtype=float32_ref>,\r\n     <tf.Variable 'critic/target_net/l4/bias:0' shape=(1,) dtype=float32_ref>,\r\n     <tf.Variable 'beta1_power_1:0' shape=() dtype=float32_ref>,\r\n     <tf.Variable 'beta2_power_1:0' shape=() dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l1/weights/Adam:0' shape=(40, 90) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l1/weights/Adam_1:0' shape=(40, 90) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l1/biases/Adam:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l1/biases/Adam_1:0' shape=(90,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l2/weights/Adam:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l2/weights/Adam_1:0' shape=(90, 60) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l2/biases/Adam:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l2/biases/Adam_1:0' shape=(60,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l3/weights/Adam:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l3/weights/Adam_1:0' shape=(60, 30) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l3/biases/Adam:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l3/biases/Adam_1:0' shape=(30,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l4/kernel/Adam:0' shape=(30, 1) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l4/kernel/Adam_1:0' shape=(30, 1) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l4/bias/Adam:0' shape=(1,) dtype=float32_ref>,\r\n     <tf.Variable 'critic/main_net/l4/bias/Adam_1:0' shape=(1,) dtype=float32_ref>\r\n\r\n\r\nThe only difference in these two lists, is ` <tf.Variable 'Variable:0' shape=() dtype=int32_ref>`, which I do not know what is this for and how it is generated. But, I do not think if it is the problem, since any of my models that can be restored also has it. \r\n\r\nI appreciate any help and comment to resolve this error. \r\n  \r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:Yes. \r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.8\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: 9.0\r\n- **GPU model and memory**: P100, 24 GB\r\n- **Exact command to reproduce**: \r\n"}