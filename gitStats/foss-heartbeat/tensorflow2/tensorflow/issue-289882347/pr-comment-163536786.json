{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/163536786", "pull_request_review_id": 91163081, "id": 163536786, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzUzNjc4Ng==", "diff_hunk": "@@ -84,15 +85,15 @@ def conjugate_gradient(operator,\n \n   def stopping_criterion(i, state):\n     return math_ops.logical_and(i < max_iter,\n-                                util.l2norm_squared(state.r) > tol)\n+                                linalg_ops.norm(state.r) > tol)\n \n   def cg_step(i, state):\n     z = operator.apply(state.p)\n     alpha = state.gamma / util.dot(state.p, z)\n     x = state.x + alpha * state.p\n     r = state.r - alpha * z\n     if preconditioner is None:\n-      gamma = util.l2norm_squared(r)\n+      gamma = util.dot(r, r)\n       beta = gamma / state.gamma", "path": "tensorflow/contrib/solvers/python/ops/linear_equations.py", "position": null, "original_position": 43, "commit_id": "c2908c2e74530edaba6f95c4b86f184c77a1afcf", "original_commit_id": "c2908c2e74530edaba6f95c4b86f184c77a1afcf", "user": {"login": "Cescfangs", "id": 11382612, "node_id": "MDQ6VXNlcjExMzgyNjEy", "avatar_url": "https://avatars2.githubusercontent.com/u/11382612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cescfangs", "html_url": "https://github.com/Cescfangs", "followers_url": "https://api.github.com/users/Cescfangs/followers", "following_url": "https://api.github.com/users/Cescfangs/following{/other_user}", "gists_url": "https://api.github.com/users/Cescfangs/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cescfangs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cescfangs/subscriptions", "organizations_url": "https://api.github.com/users/Cescfangs/orgs", "repos_url": "https://api.github.com/users/Cescfangs/repos", "events_url": "https://api.github.com/users/Cescfangs/events{/privacy}", "received_events_url": "https://api.github.com/users/Cescfangs/received_events", "type": "User", "site_admin": false}, "body": "using `util.dot()` here because `linalg_ops.norm()` apply `sqrt` , we have to call `square` to get squared_norm, this could cause precision slightly lower than `dot()` every step, we want to avoid it when iter_num is large. \r\nIn fact using  `linalg_ops.norm(r) ** 2` here would make results \"much\" different when preconditioner=`None` and `identity_operator`(which supposed to be identical).", "created_at": "2018-01-24T12:46:49Z", "updated_at": "2018-01-24T12:46:49Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/16237#discussion_r163536786", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/16237", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/163536786"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/16237#discussion_r163536786"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/16237"}}, "body_html": "<p>using <code>util.dot()</code> here because <code>linalg_ops.norm()</code> apply <code>sqrt</code> , we have to call <code>square</code> to get squared_norm, this could cause precision slightly lower than <code>dot()</code> every step, we want to avoid it when iter_num is large.<br>\nIn fact using  <code>linalg_ops.norm(r) ** 2</code> here would make results \"much\" different when preconditioner=<code>None</code> and <code>identity_operator</code>(which supposed to be identical).</p>", "body_text": "using util.dot() here because linalg_ops.norm() apply sqrt , we have to call square to get squared_norm, this could cause precision slightly lower than dot() every step, we want to avoid it when iter_num is large.\nIn fact using  linalg_ops.norm(r) ** 2 here would make results \"much\" different when preconditioner=None and identity_operator(which supposed to be identical)."}