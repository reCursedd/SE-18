{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/401361859", "html_url": "https://github.com/tensorflow/tensorflow/pull/20284#issuecomment-401361859", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20284", "id": 401361859, "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTM2MTg1OQ==", "user": {"login": "msarahan", "id": 38393, "node_id": "MDQ6VXNlcjM4Mzkz", "avatar_url": "https://avatars3.githubusercontent.com/u/38393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msarahan", "html_url": "https://github.com/msarahan", "followers_url": "https://api.github.com/users/msarahan/followers", "following_url": "https://api.github.com/users/msarahan/following{/other_user}", "gists_url": "https://api.github.com/users/msarahan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msarahan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msarahan/subscriptions", "organizations_url": "https://api.github.com/users/msarahan/orgs", "repos_url": "https://api.github.com/users/msarahan/repos", "events_url": "https://api.github.com/users/msarahan/events{/privacy}", "received_events_url": "https://api.github.com/users/msarahan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-29T13:56:13Z", "updated_at": "2018-06-29T13:56:13Z", "author_association": "NONE", "body_html": "<p>Seems very close to working, but I'm confused on an error with the external grpc.  I have put up my patch (I am applying it to 1.9.0rc1 right now): <a href=\"https://gist.github.com/msarahan/e38ccd45521617356a099d50b172f2b8\">https://gist.github.com/msarahan/e38ccd45521617356a099d50b172f2b8</a></p>\n<p>The error is:</p>\n<pre><code>Analyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages loaded)\nERROR: /Users/msarahan/miniconda3/conda-bld/tensorflow-base_1530276141984/work/tensorflow/core/distributed_runtime/rpc/BUILD:97:1: no such package '@grpc//': tf_http_archive rule //external:grpc must create a directory and referenced by '//tensorflow/core/distributed_runtime/rpc:grpc_channel'\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted: no such package '@grpc//': tf_http_archive rule //external:grpc must create a directory\nINFO: Elapsed time: 9.950s\n</code></pre>\n<p>My build script calls bazel with:</p>\n<pre><code>     bazel ${BAZEL_OPTS} build \\\n           --verbose_failures \\\n           --config=opt \\\n           --action_env TF_SYSTEM_LIBS=\"${TF_SYSTEM_LIBS}\" \\\n           --define PREFIX=\"${PREFIX}\" \\\n           //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<p>Before I was passing in --define as you recommended, it was dying in earlier externals, such as png.  That gives me confidence in the overall approach, but it seems I have something wrong.  If I remove grpc from the list of externals, it gets further, but dies on missing the license from LMDB.  It should not be necessary to list actual files in the external stuff, right?</p>", "body_text": "Seems very close to working, but I'm confused on an error with the external grpc.  I have put up my patch (I am applying it to 1.9.0rc1 right now): https://gist.github.com/msarahan/e38ccd45521617356a099d50b172f2b8\nThe error is:\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages loaded)\nERROR: /Users/msarahan/miniconda3/conda-bld/tensorflow-base_1530276141984/work/tensorflow/core/distributed_runtime/rpc/BUILD:97:1: no such package '@grpc//': tf_http_archive rule //external:grpc must create a directory and referenced by '//tensorflow/core/distributed_runtime/rpc:grpc_channel'\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted: no such package '@grpc//': tf_http_archive rule //external:grpc must create a directory\nINFO: Elapsed time: 9.950s\n\nMy build script calls bazel with:\n     bazel ${BAZEL_OPTS} build \\\n           --verbose_failures \\\n           --config=opt \\\n           --action_env TF_SYSTEM_LIBS=\"${TF_SYSTEM_LIBS}\" \\\n           --define PREFIX=\"${PREFIX}\" \\\n           //tensorflow/tools/pip_package:build_pip_package\n\nBefore I was passing in --define as you recommended, it was dying in earlier externals, such as png.  That gives me confidence in the overall approach, but it seems I have something wrong.  If I remove grpc from the list of externals, it gets further, but dies on missing the license from LMDB.  It should not be necessary to list actual files in the external stuff, right?", "body": "Seems very close to working, but I'm confused on an error with the external grpc.  I have put up my patch (I am applying it to 1.9.0rc1 right now): https://gist.github.com/msarahan/e38ccd45521617356a099d50b172f2b8\r\n\r\nThe error is:\r\n\r\n```\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages loaded)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages loaded)\r\nERROR: /Users/msarahan/miniconda3/conda-bld/tensorflow-base_1530276141984/work/tensorflow/core/distributed_runtime/rpc/BUILD:97:1: no such package '@grpc//': tf_http_archive rule //external:grpc must create a directory and referenced by '//tensorflow/core/distributed_runtime/rpc:grpc_channel'\r\nERROR: Analysis of target '//tensorflow/tools/pip_package:build_pip_package' failed; build aborted: no such package '@grpc//': tf_http_archive rule //external:grpc must create a directory\r\nINFO: Elapsed time: 9.950s\r\n```\r\n\r\nMy build script calls bazel with: \r\n\r\n```\r\n     bazel ${BAZEL_OPTS} build \\\r\n           --verbose_failures \\\r\n           --config=opt \\\r\n           --action_env TF_SYSTEM_LIBS=\"${TF_SYSTEM_LIBS}\" \\\r\n           --define PREFIX=\"${PREFIX}\" \\\r\n           //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n\r\nBefore I was passing in --define as you recommended, it was dying in earlier externals, such as png.  That gives me confidence in the overall approach, but it seems I have something wrong.  If I remove grpc from the list of externals, it gets further, but dies on missing the license from LMDB.  It should not be necessary to list actual files in the external stuff, right?"}