{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20284", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20284/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20284/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20284/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/20284", "id": 335514928, "node_id": "MDExOlB1bGxSZXF1ZXN0MTk3MTk1NzA2", "number": 20284, "title": "Enable unbundling dependencies and linking to the system libraries instead.", "user": {"login": "perfinion", "id": 363227, "node_id": "MDQ6VXNlcjM2MzIyNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/363227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/perfinion", "html_url": "https://github.com/perfinion", "followers_url": "https://api.github.com/users/perfinion/followers", "following_url": "https://api.github.com/users/perfinion/following{/other_user}", "gists_url": "https://api.github.com/users/perfinion/gists{/gist_id}", "starred_url": "https://api.github.com/users/perfinion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/perfinion/subscriptions", "organizations_url": "https://api.github.com/users/perfinion/orgs", "repos_url": "https://api.github.com/users/perfinion/repos", "events_url": "https://api.github.com/users/perfinion/events{/privacy}", "received_events_url": "https://api.github.com/users/perfinion/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 419840263, "node_id": "MDU6TGFiZWw0MTk4NDAyNjM=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20testing%20(then%20merge)", "name": "awaiting testing (then merge)", "color": "c2e0c6", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 33, "created_at": "2018-06-25T18:19:12Z", "updated_at": "2018-07-24T09:20:42Z", "closed_at": "2018-07-13T22:44:11Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/20284", "html_url": "https://github.com/tensorflow/tensorflow/pull/20284", "diff_url": "https://github.com/tensorflow/tensorflow/pull/20284.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/20284.patch"}, "body_html": "<p>This series adds a framework to be able to unbundle the dependencies from tensorflow. Previously, bazel rebuilds every single dep from scratch. This allows distro packages to disable bundling on a per-dep basis and link with the libraries that already exist on the system.</p>\n<p>For more information why deps should be unbundled, see these links: <a href=\"https://wiki.gentoo.org/wiki/Why_not_bundle_dependencies\" rel=\"nofollow\">https://wiki.gentoo.org/wiki/Why_not_bundle_dependencies</a><br>\n<a href=\"https://fedoraproject.org/wiki/Bundled_Libraries\" rel=\"nofollow\">https://fedoraproject.org/wiki/Bundled_Libraries</a></p>\n<p>The deps I have unbundled so far work on my Gentoo machine. Thanks to <a href=\"mailto:dennisjenkins@google.com\">dennisjenkins@google.com</a> for testing this on Gentoo as well. There are still more that need to be unbundled but this covers enough to be useful already. This has not been tested on any other distro than Gentoo but I don't forsee any big incompatibilities.</p>\n<p>The libs that are unbundled are configured by setting <code>build --action_env TF_SYSTEM_LIBS=\"comma,sep,list\"</code><br>\neg:</p>\n<pre><code>build --action_env TF_SYSTEM_LIBS=\"com_googlesource_code_re2,nasm,jpeg,png_archive,org_sqlite,gif_archive,six_archive,astor_archive,termcolor_archive,pcre,swig,curl,grpc,lmdb,zlib_archive,snappy,flatbuffers,cython,jemalloc\"\n</code></pre>\n<p>Once configured, the tarball for the dep will not be downloaded or extracted, and the BUILD file will be swapped to the system_build_file instead which contains different rules to compile and link against the system package.<br>\nThere are also macros if_system_lib(name, a, b) and if_not_system_lib(name, a, b) to configure other things in the build.</p>\n<p>DO NOT MERGE THIS YET. I'm opening this for comments are review here before its ready for merging.</p>", "body_text": "This series adds a framework to be able to unbundle the dependencies from tensorflow. Previously, bazel rebuilds every single dep from scratch. This allows distro packages to disable bundling on a per-dep basis and link with the libraries that already exist on the system.\nFor more information why deps should be unbundled, see these links: https://wiki.gentoo.org/wiki/Why_not_bundle_dependencies\nhttps://fedoraproject.org/wiki/Bundled_Libraries\nThe deps I have unbundled so far work on my Gentoo machine. Thanks to dennisjenkins@google.com for testing this on Gentoo as well. There are still more that need to be unbundled but this covers enough to be useful already. This has not been tested on any other distro than Gentoo but I don't forsee any big incompatibilities.\nThe libs that are unbundled are configured by setting build --action_env TF_SYSTEM_LIBS=\"comma,sep,list\"\neg:\nbuild --action_env TF_SYSTEM_LIBS=\"com_googlesource_code_re2,nasm,jpeg,png_archive,org_sqlite,gif_archive,six_archive,astor_archive,termcolor_archive,pcre,swig,curl,grpc,lmdb,zlib_archive,snappy,flatbuffers,cython,jemalloc\"\n\nOnce configured, the tarball for the dep will not be downloaded or extracted, and the BUILD file will be swapped to the system_build_file instead which contains different rules to compile and link against the system package.\nThere are also macros if_system_lib(name, a, b) and if_not_system_lib(name, a, b) to configure other things in the build.\nDO NOT MERGE THIS YET. I'm opening this for comments are review here before its ready for merging.", "body": "This series adds a framework to be able to unbundle the dependencies from tensorflow. Previously, bazel rebuilds every single dep from scratch. This allows distro packages to disable bundling on a per-dep basis and link with the libraries that already exist on the system.\r\n\r\nFor more information why deps should be unbundled, see these links: https://wiki.gentoo.org/wiki/Why_not_bundle_dependencies\r\nhttps://fedoraproject.org/wiki/Bundled_Libraries\r\n\r\nThe deps I have unbundled so far work on my Gentoo machine. Thanks to dennisjenkins@google.com for testing this on Gentoo as well. There are still more that need to be unbundled but this covers enough to be useful already. This has not been tested on any other distro than Gentoo but I don't forsee any big incompatibilities.\r\n\r\nThe libs that are unbundled are configured by setting `build --action_env TF_SYSTEM_LIBS=\"comma,sep,list\"`\r\neg:\r\n```\r\nbuild --action_env TF_SYSTEM_LIBS=\"com_googlesource_code_re2,nasm,jpeg,png_archive,org_sqlite,gif_archive,six_archive,astor_archive,termcolor_archive,pcre,swig,curl,grpc,lmdb,zlib_archive,snappy,flatbuffers,cython,jemalloc\"\r\n```\r\n\r\nOnce configured, the tarball for the dep will not be downloaded or extracted, and the BUILD file will be swapped to the system_build_file instead which contains different rules to compile and link against the system package.\r\nThere are also macros if_system_lib(name, a, b) and if_not_system_lib(name, a, b) to configure other things in the build.\r\n\r\nDO NOT MERGE THIS YET. I'm opening this for comments are review here before its ready for merging."}