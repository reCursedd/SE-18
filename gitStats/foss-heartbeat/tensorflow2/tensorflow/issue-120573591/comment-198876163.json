{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/198876163", "html_url": "https://github.com/tensorflow/tensorflow/issues/418#issuecomment-198876163", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/418", "id": 198876163, "node_id": "MDEyOklzc3VlQ29tbWVudDE5ODg3NjE2Mw==", "user": {"login": "sjperkins", "id": 3530212, "node_id": "MDQ6VXNlcjM1MzAyMTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/3530212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjperkins", "html_url": "https://github.com/sjperkins", "followers_url": "https://api.github.com/users/sjperkins/followers", "following_url": "https://api.github.com/users/sjperkins/following{/other_user}", "gists_url": "https://api.github.com/users/sjperkins/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjperkins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjperkins/subscriptions", "organizations_url": "https://api.github.com/users/sjperkins/orgs", "repos_url": "https://api.github.com/users/sjperkins/repos", "events_url": "https://api.github.com/users/sjperkins/events{/privacy}", "received_events_url": "https://api.github.com/users/sjperkins/received_events", "type": "User", "site_admin": false}, "created_at": "2016-03-20T08:52:50Z", "updated_at": "2016-03-20T08:52:50Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6690052\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tejaskhot\">@tejaskhot</a> <code>ravel_multi_index</code> above should do it</p>\n<div class=\"highlight highlight-source-python\"><pre>matrix <span class=\"pl-k\">=</span> tf.random_normal([M,N])\nrow_indices <span class=\"pl-k\">=</span> tf.Variable([<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">5</span>,<span class=\"pl-c1\">8</span>,<span class=\"pl-c1\">9</span>])\ncol_indices <span class=\"pl-k\">=</span> tf.Variable([<span class=\"pl-c1\">5</span>,<span class=\"pl-c1\">3</span>,<span class=\"pl-c1\">8</span>,<span class=\"pl-c1\">2</span>])\nflat_index <span class=\"pl-k\">=</span> ravel_multi_index(matrix, [row_indices, col_indices])\ndata <span class=\"pl-k\">=</span> rf.gather(tf.reshape(matrix, [<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>]), flat_index)</pre></div>\n<p>Note that <code>ravel_multi_index</code> only works with the static tensor shape inferred prior to running the expression tree. If your tensor shape is dynamic, <code>ravel_multi_index</code> will need to be updated to use <code>tf.shape()</code> during expression tree execution. <a href=\"http://stackoverflow.com/questions/36035092/multi-dimensional-gather-in-tensorflow\" rel=\"nofollow\">This</a> StackOverflow question would be a good place to answer that. However, the indices (<code>row_indices</code> and <code>col_indices</code>) are currently evaluated at run-time.</p>", "body_text": "@tejaskhot ravel_multi_index above should do it\nmatrix = tf.random_normal([M,N])\nrow_indices = tf.Variable([1,5,8,9])\ncol_indices = tf.Variable([5,3,8,2])\nflat_index = ravel_multi_index(matrix, [row_indices, col_indices])\ndata = rf.gather(tf.reshape(matrix, [-1]), flat_index)\nNote that ravel_multi_index only works with the static tensor shape inferred prior to running the expression tree. If your tensor shape is dynamic, ravel_multi_index will need to be updated to use tf.shape() during expression tree execution. This StackOverflow question would be a good place to answer that. However, the indices (row_indices and col_indices) are currently evaluated at run-time.", "body": "@tejaskhot `ravel_multi_index` above should do it\n\n``` python\nmatrix = tf.random_normal([M,N])\nrow_indices = tf.Variable([1,5,8,9])\ncol_indices = tf.Variable([5,3,8,2])\nflat_index = ravel_multi_index(matrix, [row_indices, col_indices])\ndata = rf.gather(tf.reshape(matrix, [-1]), flat_index)\n```\n\nNote that `ravel_multi_index` only works with the static tensor shape inferred prior to running the expression tree. If your tensor shape is dynamic, `ravel_multi_index` will need to be updated to use `tf.shape()` during expression tree execution. [This](http://stackoverflow.com/questions/36035092/multi-dimensional-gather-in-tensorflow) StackOverflow question would be a good place to answer that. However, the indices (`row_indices` and `col_indices`) are currently evaluated at run-time.\n"}