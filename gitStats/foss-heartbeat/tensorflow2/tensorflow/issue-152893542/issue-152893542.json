{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2211", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2211/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2211/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2211/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2211", "id": 152893542, "node_id": "MDU6SXNzdWUxNTI4OTM1NDI=", "number": 2211, "title": "tf.add_check_numerics_ops() adds ops to while_loop frame", "user": {"login": "hexahedria", "id": 4992683, "node_id": "MDQ6VXNlcjQ5OTI2ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/4992683?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hexahedria", "html_url": "https://github.com/hexahedria", "followers_url": "https://api.github.com/users/hexahedria/followers", "following_url": "https://api.github.com/users/hexahedria/following{/other_user}", "gists_url": "https://api.github.com/users/hexahedria/gists{/gist_id}", "starred_url": "https://api.github.com/users/hexahedria/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hexahedria/subscriptions", "organizations_url": "https://api.github.com/users/hexahedria/orgs", "repos_url": "https://api.github.com/users/hexahedria/repos", "events_url": "https://api.github.com/users/hexahedria/events{/privacy}", "received_events_url": "https://api.github.com/users/hexahedria/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-05-03T22:59:31Z", "updated_at": "2017-10-02T07:29:30Z", "closed_at": "2017-06-16T17:44:37Z", "author_association": "NONE", "body_html": "<p>When I construct a graph that contains a tf.while_loop, and then try to call tf.add_check_numerics_ops(), I get an InvalidArgumentError.</p>\n<p>Given the code</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">test</span>():\n    i <span class=\"pl-k\">=</span> tf.constant(<span class=\"pl-c1\">0</span>, tf.float32)\n    c <span class=\"pl-k\">=</span> <span class=\"pl-k\">lambda</span> <span class=\"pl-smi\">i</span>: tf.less(i, <span class=\"pl-c1\">10</span>)\n    b <span class=\"pl-k\">=</span> <span class=\"pl-k\">lambda</span> <span class=\"pl-smi\">i</span>: tf.add(i, <span class=\"pl-c1\">1</span>)\n    r <span class=\"pl-k\">=</span> tf.while_loop(c, b, [i])\n\n    check <span class=\"pl-k\">=</span> tf.add_check_numerics_ops()\n\n    <span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n        <span class=\"pl-c1\">print</span> sess.run([r,check])</pre></div>\n<p>I get the error</p>\n<div class=\"highlight highlight-source-python\"><pre>Traceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;stdin&gt;<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>minimal_bug_example.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">12</span>, <span class=\"pl-k\">in</span> test\n    <span class=\"pl-c1\">print</span> sess.run([r,check])\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Library/Python/2.7/site-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">340</span>, <span class=\"pl-k\">in</span> run\n    run_metadata_ptr)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Library/Python/2.7/site-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">564</span>, <span class=\"pl-k\">in</span> _run\n    feed_dict_string, options, run_metadata)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Library/Python/2.7/site-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">637</span>, <span class=\"pl-k\">in</span> _do_run\n    target_list, options, run_metadata)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/Library/Python/2.7/site-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">659</span>, <span class=\"pl-k\">in</span> _do_call\n    e.code)\ntensorflow.python.framework.errors.InvalidArgumentError: All inputs to node CheckNumerics_1 must be <span class=\"pl-k\">from</span> the same frame.</pre></div>\n<p>I'm running Tensorflow installed from pip, version 0.8.0. As far as I can tell, this is caused by the while_loop creating a new control flow context, but the check numerics op living outside that context.</p>", "body_text": "When I construct a graph that contains a tf.while_loop, and then try to call tf.add_check_numerics_ops(), I get an InvalidArgumentError.\nGiven the code\nimport tensorflow as tf\n\ndef test():\n    i = tf.constant(0, tf.float32)\n    c = lambda i: tf.less(i, 10)\n    b = lambda i: tf.add(i, 1)\n    r = tf.while_loop(c, b, [i])\n\n    check = tf.add_check_numerics_ops()\n\n    with tf.Session() as sess:\n        print sess.run([r,check])\nI get the error\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"minimal_bug_example.py\", line 12, in test\n    print sess.run([r,check])\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 340, in run\n    run_metadata_ptr)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 564, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 637, in _do_run\n    target_list, options, run_metadata)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 659, in _do_call\n    e.code)\ntensorflow.python.framework.errors.InvalidArgumentError: All inputs to node CheckNumerics_1 must be from the same frame.\nI'm running Tensorflow installed from pip, version 0.8.0. As far as I can tell, this is caused by the while_loop creating a new control flow context, but the check numerics op living outside that context.", "body": "When I construct a graph that contains a tf.while_loop, and then try to call tf.add_check_numerics_ops(), I get an InvalidArgumentError.\n\nGiven the code\n\n``` python\nimport tensorflow as tf\n\ndef test():\n    i = tf.constant(0, tf.float32)\n    c = lambda i: tf.less(i, 10)\n    b = lambda i: tf.add(i, 1)\n    r = tf.while_loop(c, b, [i])\n\n    check = tf.add_check_numerics_ops()\n\n    with tf.Session() as sess:\n        print sess.run([r,check])\n```\n\nI get the error\n\n``` python\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"minimal_bug_example.py\", line 12, in test\n    print sess.run([r,check])\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 340, in run\n    run_metadata_ptr)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 564, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 637, in _do_run\n    target_list, options, run_metadata)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/client/session.py\", line 659, in _do_call\n    e.code)\ntensorflow.python.framework.errors.InvalidArgumentError: All inputs to node CheckNumerics_1 must be from the same frame.\n```\n\nI'm running Tensorflow installed from pip, version 0.8.0. As far as I can tell, this is caused by the while_loop creating a new control flow context, but the check numerics op living outside that context.\n"}