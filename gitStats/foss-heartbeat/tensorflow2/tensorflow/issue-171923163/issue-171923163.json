{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3903", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3903/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3903/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3903/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3903", "id": 171923163, "node_id": "MDU6SXNzdWUxNzE5MjMxNjM=", "number": 3903, "title": "conversion to graph_def lose tensor shapes", "user": {"login": "gauravgupta22", "id": 17435125, "node_id": "MDQ6VXNlcjE3NDM1MTI1", "avatar_url": "https://avatars0.githubusercontent.com/u/17435125?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gauravgupta22", "html_url": "https://github.com/gauravgupta22", "followers_url": "https://api.github.com/users/gauravgupta22/followers", "following_url": "https://api.github.com/users/gauravgupta22/following{/other_user}", "gists_url": "https://api.github.com/users/gauravgupta22/gists{/gist_id}", "starred_url": "https://api.github.com/users/gauravgupta22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gauravgupta22/subscriptions", "organizations_url": "https://api.github.com/users/gauravgupta22/orgs", "repos_url": "https://api.github.com/users/gauravgupta22/repos", "events_url": "https://api.github.com/users/gauravgupta22/events{/privacy}", "received_events_url": "https://api.github.com/users/gauravgupta22/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-08-18T15:01:38Z", "updated_at": "2016-08-18T17:37:49Z", "closed_at": "2016-08-18T17:37:49Z", "author_association": "NONE", "body_html": "<p>If i convert a tensorflow model to graph_def using<br>\n<code>tf.get_default_graph().as_graph_def()</code><br>\nAnd later import it again, i lose the information regarding the tensor shapes</p>\n<h3>Code</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> import any tensorflow model</span>\nnet <span class=\"pl-k\">=</span> <span class=\"pl-c1\">__import__</span> (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>mynet<span class=\"pl-pds\">'</span></span>)\nimages <span class=\"pl-k\">=</span> tf.placeholder(tf.float32, [<span class=\"pl-c1\">32</span>,<span class=\"pl-c1\">28</span>,<span class=\"pl-c1\">28</span>,<span class=\"pl-c1\">3</span>])\nnet <span class=\"pl-k\">=</span> <span class=\"pl-c1\">getattr</span>(net, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>LeNet<span class=\"pl-pds\">'</span></span>)({<span class=\"pl-s\"><span class=\"pl-pds\">'</span>data<span class=\"pl-pds\">'</span></span>: images})\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> iterate through the graph</span>\ngraph <span class=\"pl-k\">=</span> tf.get_default_graph()\n<span class=\"pl-k\">for</span> i <span class=\"pl-k\">in</span> graph.get_operations():\n    <span class=\"pl-c1\">print</span> i.name\n    <span class=\"pl-c1\">print</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>OUTPUTS <span class=\"pl-pds\">'</span></span>,\n    <span class=\"pl-k\">for</span> j <span class=\"pl-k\">in</span> i.outputs:\n        <span class=\"pl-c1\">print</span> j.get_shape(),\n    <span class=\"pl-c1\">print</span> \n\n<span class=\"pl-c1\">print</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>*************** CONVERT MODEL TO GRAPH_DEF AND IMPORT AGAIN ***************<span class=\"pl-pds\">\"</span></span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Graph as graph_def</span>\ngraph_def <span class=\"pl-k\">=</span> tf.get_default_graph().as_graph_def()\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> reset everything</span>\ntf.reset_default_graph()\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Import the graph_def</span>\ntf.import_graph_def(graph_def,<span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span>)\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> iterate through the graph again</span>\ngraph <span class=\"pl-k\">=</span> tf.get_default_graph()\n<span class=\"pl-k\">for</span> i <span class=\"pl-k\">in</span> graph.get_operations():\n    <span class=\"pl-c1\">print</span> i.name\n    <span class=\"pl-c1\">print</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>OUTPUTS <span class=\"pl-pds\">'</span></span>,\n    <span class=\"pl-k\">for</span> j <span class=\"pl-k\">in</span> i.outputs:\n        <span class=\"pl-c1\">print</span> j.get_shape(),\n    <span class=\"pl-c1\">print</span></pre></div>\n<h3>Output</h3>\n<pre><code>Placeholder\nOUTPUTS  (32, 28, 28, 3)\nconv1/weights\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Assign\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/read\nOUTPUTS  (5, 5, 3, 20)\nconv1/Conv2D\nOUTPUTS  (32, 24, 24, 20)\nconv1/biases\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/mul\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform\nOUTPUTS  (20,)\nconv1/biases/Assign\nOUTPUTS  (20,)\nconv1/biases/read\nOUTPUTS  (20,)\nconv1/BiasAdd\nOUTPUTS  (32, 24, 24, 20)\npool1\nOUTPUTS  (32, 12, 12, 20)\nconv2/weights\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Assign\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/read\nOUTPUTS  (5, 5, 20, 50)\nconv2/Conv2D\nOUTPUTS  (32, 8, 8, 50)\nconv2/biases\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/mul\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform\nOUTPUTS  (50,)\nconv2/biases/Assign\nOUTPUTS  (50,)\nconv2/biases/read\nOUTPUTS  (50,)\nconv2/BiasAdd\nOUTPUTS  (32, 8, 8, 50)\npool2\nOUTPUTS  (32, 4, 4, 50)\nip1/Reshape/shape\nOUTPUTS  (2,)\nip1/Reshape\nOUTPUTS  (32, 800)\nip1/weights\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/mul\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform\nOUTPUTS  (800, 500)\nip1/weights/Assign\nOUTPUTS  (800, 500)\nip1/weights/read\nOUTPUTS  (800, 500)\nip1/biases\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/mul\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform\nOUTPUTS  (500,)\nip1/biases/Assign\nOUTPUTS  (500,)\nip1/biases/read\nOUTPUTS  (500,)\nip1/ip1/MatMul\nOUTPUTS  (32, 500)\nip1/ip1/BiasAdd\nOUTPUTS  (32, 500)\nip1/ip1\nOUTPUTS  (32, 500)\nip2/weights\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/mul\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform\nOUTPUTS  (500, 10)\nip2/weights/Assign\nOUTPUTS  (500, 10)\nip2/weights/read\nOUTPUTS  (500, 10)\nip2/biases\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/mul\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform\nOUTPUTS  (10,)\nip2/biases/Assign\nOUTPUTS  (10,)\nip2/biases/read\nOUTPUTS  (10,)\nip2/ip2/MatMul\nOUTPUTS  (32, 10)\nip2/ip2\nOUTPUTS  (32, 10)\nprob\nOUTPUTS  (32, 10)\n*************** CONVERT MODEL TO GRAPH_DEF AND IMPORT AGAIN ***************\nPlaceholder\nOUTPUTS  (32, 28, 28, 3)\nconv1/weights\nOUTPUTS  &lt;unknown&gt;\nconv1/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Assign\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/read\nOUTPUTS  &lt;unknown&gt;\nconv1/Conv2D\nOUTPUTS  (32, ?, ?, ?)\nconv1/biases\nOUTPUTS  &lt;unknown&gt;\nconv1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/mul\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform\nOUTPUTS  (20,)\nconv1/biases/Assign\nOUTPUTS  (20,)\nconv1/biases/read\nOUTPUTS  &lt;unknown&gt;\nconv1/BiasAdd\nOUTPUTS  (32, ?, ?, ?)\npool1\nOUTPUTS  (32, ?, ?, ?)\nconv2/weights\nOUTPUTS  &lt;unknown&gt;\nconv2/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Assign\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/read\nOUTPUTS  &lt;unknown&gt;\nconv2/Conv2D\nOUTPUTS  (32, ?, ?, ?)\nconv2/biases\nOUTPUTS  &lt;unknown&gt;\nconv2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/mul\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform\nOUTPUTS  (50,)\nconv2/biases/Assign\nOUTPUTS  (50,)\nconv2/biases/read\nOUTPUTS  &lt;unknown&gt;\nconv2/BiasAdd\nOUTPUTS  (32, ?, ?, ?)\npool2\nOUTPUTS  (32, ?, ?, ?)\nip1/Reshape/shape\nOUTPUTS  (2,)\nip1/Reshape\nOUTPUTS  (?, 800)\nip1/weights\nOUTPUTS  &lt;unknown&gt;\nip1/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/mul\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform\nOUTPUTS  (800, 500)\nip1/weights/Assign\nOUTPUTS  (800, 500)\nip1/weights/read\nOUTPUTS  &lt;unknown&gt;\nip1/biases\nOUTPUTS  &lt;unknown&gt;\nip1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/mul\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform\nOUTPUTS  (500,)\nip1/biases/Assign\nOUTPUTS  (500,)\nip1/biases/read\nOUTPUTS  &lt;unknown&gt;\nip1/ip1/MatMul\nOUTPUTS  (?, ?)\nip1/ip1/BiasAdd\nOUTPUTS  (?, ?)\nip1/ip1\nOUTPUTS  (?, ?)\nip2/weights\nOUTPUTS  &lt;unknown&gt;\nip2/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/mul\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform\nOUTPUTS  (500, 10)\nip2/weights/Assign\nOUTPUTS  (500, 10)\nip2/weights/read\nOUTPUTS  &lt;unknown&gt;\nip2/biases\nOUTPUTS  &lt;unknown&gt;\nip2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/mul\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform\nOUTPUTS  (10,)\nip2/biases/Assign\nOUTPUTS  (10,)\nip2/biases/read\nOUTPUTS  &lt;unknown&gt;\nip2/ip2/MatMul\nOUTPUTS  (?, ?)\nip2/ip2\nOUTPUTS  (?, ?)\nprob\nOUTPUTS  (?, ?)\n</code></pre>\n<p>It can be clearly seen that the shape of the last tensor (and others as well) in the model was <code>(32, 10)</code> and after conversion to graph_def and import again it becomes <code>(?, ?)</code>.</p>\n<p>Is there any other way to get output shapes out of any graph_def?</p>", "body_text": "If i convert a tensorflow model to graph_def using\ntf.get_default_graph().as_graph_def()\nAnd later import it again, i lose the information regarding the tensor shapes\nCode\nimport tensorflow as tf\n\n# import any tensorflow model\nnet = __import__ ('mynet')\nimages = tf.placeholder(tf.float32, [32,28,28,3])\nnet = getattr(net, 'LeNet')({'data': images})\n\n# iterate through the graph\ngraph = tf.get_default_graph()\nfor i in graph.get_operations():\n    print i.name\n    print 'OUTPUTS ',\n    for j in i.outputs:\n        print j.get_shape(),\n    print \n\nprint \"*************** CONVERT MODEL TO GRAPH_DEF AND IMPORT AGAIN ***************\"\n\n# Graph as graph_def\ngraph_def = tf.get_default_graph().as_graph_def()\n\n# reset everything\ntf.reset_default_graph()\n\n# Import the graph_def\ntf.import_graph_def(graph_def,name='')\n\n# iterate through the graph again\ngraph = tf.get_default_graph()\nfor i in graph.get_operations():\n    print i.name\n    print 'OUTPUTS ',\n    for j in i.outputs:\n        print j.get_shape(),\n    print\nOutput\nPlaceholder\nOUTPUTS  (32, 28, 28, 3)\nconv1/weights\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Assign\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/read\nOUTPUTS  (5, 5, 3, 20)\nconv1/Conv2D\nOUTPUTS  (32, 24, 24, 20)\nconv1/biases\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/mul\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform\nOUTPUTS  (20,)\nconv1/biases/Assign\nOUTPUTS  (20,)\nconv1/biases/read\nOUTPUTS  (20,)\nconv1/BiasAdd\nOUTPUTS  (32, 24, 24, 20)\npool1\nOUTPUTS  (32, 12, 12, 20)\nconv2/weights\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Assign\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/read\nOUTPUTS  (5, 5, 20, 50)\nconv2/Conv2D\nOUTPUTS  (32, 8, 8, 50)\nconv2/biases\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/mul\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform\nOUTPUTS  (50,)\nconv2/biases/Assign\nOUTPUTS  (50,)\nconv2/biases/read\nOUTPUTS  (50,)\nconv2/BiasAdd\nOUTPUTS  (32, 8, 8, 50)\npool2\nOUTPUTS  (32, 4, 4, 50)\nip1/Reshape/shape\nOUTPUTS  (2,)\nip1/Reshape\nOUTPUTS  (32, 800)\nip1/weights\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/mul\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform\nOUTPUTS  (800, 500)\nip1/weights/Assign\nOUTPUTS  (800, 500)\nip1/weights/read\nOUTPUTS  (800, 500)\nip1/biases\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/mul\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform\nOUTPUTS  (500,)\nip1/biases/Assign\nOUTPUTS  (500,)\nip1/biases/read\nOUTPUTS  (500,)\nip1/ip1/MatMul\nOUTPUTS  (32, 500)\nip1/ip1/BiasAdd\nOUTPUTS  (32, 500)\nip1/ip1\nOUTPUTS  (32, 500)\nip2/weights\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/mul\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform\nOUTPUTS  (500, 10)\nip2/weights/Assign\nOUTPUTS  (500, 10)\nip2/weights/read\nOUTPUTS  (500, 10)\nip2/biases\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/mul\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform\nOUTPUTS  (10,)\nip2/biases/Assign\nOUTPUTS  (10,)\nip2/biases/read\nOUTPUTS  (10,)\nip2/ip2/MatMul\nOUTPUTS  (32, 10)\nip2/ip2\nOUTPUTS  (32, 10)\nprob\nOUTPUTS  (32, 10)\n*************** CONVERT MODEL TO GRAPH_DEF AND IMPORT AGAIN ***************\nPlaceholder\nOUTPUTS  (32, 28, 28, 3)\nconv1/weights\nOUTPUTS  <unknown>\nconv1/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Assign\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/read\nOUTPUTS  <unknown>\nconv1/Conv2D\nOUTPUTS  (32, ?, ?, ?)\nconv1/biases\nOUTPUTS  <unknown>\nconv1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/mul\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform\nOUTPUTS  (20,)\nconv1/biases/Assign\nOUTPUTS  (20,)\nconv1/biases/read\nOUTPUTS  <unknown>\nconv1/BiasAdd\nOUTPUTS  (32, ?, ?, ?)\npool1\nOUTPUTS  (32, ?, ?, ?)\nconv2/weights\nOUTPUTS  <unknown>\nconv2/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Assign\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/read\nOUTPUTS  <unknown>\nconv2/Conv2D\nOUTPUTS  (32, ?, ?, ?)\nconv2/biases\nOUTPUTS  <unknown>\nconv2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/mul\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform\nOUTPUTS  (50,)\nconv2/biases/Assign\nOUTPUTS  (50,)\nconv2/biases/read\nOUTPUTS  <unknown>\nconv2/BiasAdd\nOUTPUTS  (32, ?, ?, ?)\npool2\nOUTPUTS  (32, ?, ?, ?)\nip1/Reshape/shape\nOUTPUTS  (2,)\nip1/Reshape\nOUTPUTS  (?, 800)\nip1/weights\nOUTPUTS  <unknown>\nip1/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/mul\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform\nOUTPUTS  (800, 500)\nip1/weights/Assign\nOUTPUTS  (800, 500)\nip1/weights/read\nOUTPUTS  <unknown>\nip1/biases\nOUTPUTS  <unknown>\nip1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/mul\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform\nOUTPUTS  (500,)\nip1/biases/Assign\nOUTPUTS  (500,)\nip1/biases/read\nOUTPUTS  <unknown>\nip1/ip1/MatMul\nOUTPUTS  (?, ?)\nip1/ip1/BiasAdd\nOUTPUTS  (?, ?)\nip1/ip1\nOUTPUTS  (?, ?)\nip2/weights\nOUTPUTS  <unknown>\nip2/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/mul\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform\nOUTPUTS  (500, 10)\nip2/weights/Assign\nOUTPUTS  (500, 10)\nip2/weights/read\nOUTPUTS  <unknown>\nip2/biases\nOUTPUTS  <unknown>\nip2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/mul\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform\nOUTPUTS  (10,)\nip2/biases/Assign\nOUTPUTS  (10,)\nip2/biases/read\nOUTPUTS  <unknown>\nip2/ip2/MatMul\nOUTPUTS  (?, ?)\nip2/ip2\nOUTPUTS  (?, ?)\nprob\nOUTPUTS  (?, ?)\n\nIt can be clearly seen that the shape of the last tensor (and others as well) in the model was (32, 10) and after conversion to graph_def and import again it becomes (?, ?).\nIs there any other way to get output shapes out of any graph_def?", "body": "If i convert a tensorflow model to graph_def using\n`tf.get_default_graph().as_graph_def()`\nAnd later import it again, i lose the information regarding the tensor shapes\n### Code\n\n``` python\nimport tensorflow as tf\n\n# import any tensorflow model\nnet = __import__ ('mynet')\nimages = tf.placeholder(tf.float32, [32,28,28,3])\nnet = getattr(net, 'LeNet')({'data': images})\n\n# iterate through the graph\ngraph = tf.get_default_graph()\nfor i in graph.get_operations():\n    print i.name\n    print 'OUTPUTS ',\n    for j in i.outputs:\n        print j.get_shape(),\n    print \n\nprint \"*************** CONVERT MODEL TO GRAPH_DEF AND IMPORT AGAIN ***************\"\n\n# Graph as graph_def\ngraph_def = tf.get_default_graph().as_graph_def()\n\n# reset everything\ntf.reset_default_graph()\n\n# Import the graph_def\ntf.import_graph_def(graph_def,name='')\n\n# iterate through the graph again\ngraph = tf.get_default_graph()\nfor i in graph.get_operations():\n    print i.name\n    print 'OUTPUTS ',\n    for j in i.outputs:\n        print j.get_shape(),\n    print\n```\n### Output\n\n```\nPlaceholder\nOUTPUTS  (32, 28, 28, 3)\nconv1/weights\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Assign\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/read\nOUTPUTS  (5, 5, 3, 20)\nconv1/Conv2D\nOUTPUTS  (32, 24, 24, 20)\nconv1/biases\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/mul\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform\nOUTPUTS  (20,)\nconv1/biases/Assign\nOUTPUTS  (20,)\nconv1/biases/read\nOUTPUTS  (20,)\nconv1/BiasAdd\nOUTPUTS  (32, 24, 24, 20)\npool1\nOUTPUTS  (32, 12, 12, 20)\nconv2/weights\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Assign\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/read\nOUTPUTS  (5, 5, 20, 50)\nconv2/Conv2D\nOUTPUTS  (32, 8, 8, 50)\nconv2/biases\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/mul\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform\nOUTPUTS  (50,)\nconv2/biases/Assign\nOUTPUTS  (50,)\nconv2/biases/read\nOUTPUTS  (50,)\nconv2/BiasAdd\nOUTPUTS  (32, 8, 8, 50)\npool2\nOUTPUTS  (32, 4, 4, 50)\nip1/Reshape/shape\nOUTPUTS  (2,)\nip1/Reshape\nOUTPUTS  (32, 800)\nip1/weights\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/mul\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform\nOUTPUTS  (800, 500)\nip1/weights/Assign\nOUTPUTS  (800, 500)\nip1/weights/read\nOUTPUTS  (800, 500)\nip1/biases\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/mul\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform\nOUTPUTS  (500,)\nip1/biases/Assign\nOUTPUTS  (500,)\nip1/biases/read\nOUTPUTS  (500,)\nip1/ip1/MatMul\nOUTPUTS  (32, 500)\nip1/ip1/BiasAdd\nOUTPUTS  (32, 500)\nip1/ip1\nOUTPUTS  (32, 500)\nip2/weights\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/mul\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform\nOUTPUTS  (500, 10)\nip2/weights/Assign\nOUTPUTS  (500, 10)\nip2/weights/read\nOUTPUTS  (500, 10)\nip2/biases\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/mul\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform\nOUTPUTS  (10,)\nip2/biases/Assign\nOUTPUTS  (10,)\nip2/biases/read\nOUTPUTS  (10,)\nip2/ip2/MatMul\nOUTPUTS  (32, 10)\nip2/ip2\nOUTPUTS  (32, 10)\nprob\nOUTPUTS  (32, 10)\n*************** CONVERT MODEL TO GRAPH_DEF AND IMPORT AGAIN ***************\nPlaceholder\nOUTPUTS  (32, 28, 28, 3)\nconv1/weights\nOUTPUTS  <unknown>\nconv1/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/Assign\nOUTPUTS  (5, 5, 3, 20)\nconv1/weights/read\nOUTPUTS  <unknown>\nconv1/Conv2D\nOUTPUTS  (32, ?, ?, ?)\nconv1/biases\nOUTPUTS  <unknown>\nconv1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv1/biases/Initializer/random_uniform/mul\nOUTPUTS  (20,)\nconv1/biases/Initializer/random_uniform\nOUTPUTS  (20,)\nconv1/biases/Assign\nOUTPUTS  (20,)\nconv1/biases/read\nOUTPUTS  <unknown>\nconv1/BiasAdd\nOUTPUTS  (32, ?, ?, ?)\npool1\nOUTPUTS  (32, ?, ?, ?)\nconv2/weights\nOUTPUTS  <unknown>\nconv2/weights/Initializer/random_uniform/shape\nOUTPUTS  (4,)\nconv2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/weights/Initializer/random_uniform/mul\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Initializer/random_uniform\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/Assign\nOUTPUTS  (5, 5, 20, 50)\nconv2/weights/read\nOUTPUTS  <unknown>\nconv2/Conv2D\nOUTPUTS  (32, ?, ?, ?)\nconv2/biases\nOUTPUTS  <unknown>\nconv2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nconv2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nconv2/biases/Initializer/random_uniform/mul\nOUTPUTS  (50,)\nconv2/biases/Initializer/random_uniform\nOUTPUTS  (50,)\nconv2/biases/Assign\nOUTPUTS  (50,)\nconv2/biases/read\nOUTPUTS  <unknown>\nconv2/BiasAdd\nOUTPUTS  (32, ?, ?, ?)\npool2\nOUTPUTS  (32, ?, ?, ?)\nip1/Reshape/shape\nOUTPUTS  (2,)\nip1/Reshape\nOUTPUTS  (?, 800)\nip1/weights\nOUTPUTS  <unknown>\nip1/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip1/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/weights/Initializer/random_uniform/mul\nOUTPUTS  (800, 500)\nip1/weights/Initializer/random_uniform\nOUTPUTS  (800, 500)\nip1/weights/Assign\nOUTPUTS  (800, 500)\nip1/weights/read\nOUTPUTS  <unknown>\nip1/biases\nOUTPUTS  <unknown>\nip1/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip1/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip1/biases/Initializer/random_uniform/mul\nOUTPUTS  (500,)\nip1/biases/Initializer/random_uniform\nOUTPUTS  (500,)\nip1/biases/Assign\nOUTPUTS  (500,)\nip1/biases/read\nOUTPUTS  <unknown>\nip1/ip1/MatMul\nOUTPUTS  (?, ?)\nip1/ip1/BiasAdd\nOUTPUTS  (?, ?)\nip1/ip1\nOUTPUTS  (?, ?)\nip2/weights\nOUTPUTS  <unknown>\nip2/weights/Initializer/random_uniform/shape\nOUTPUTS  (2,)\nip2/weights/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/RandomUniform\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/weights/Initializer/random_uniform/mul\nOUTPUTS  (500, 10)\nip2/weights/Initializer/random_uniform\nOUTPUTS  (500, 10)\nip2/weights/Assign\nOUTPUTS  (500, 10)\nip2/weights/read\nOUTPUTS  <unknown>\nip2/biases\nOUTPUTS  <unknown>\nip2/biases/Initializer/random_uniform/shape\nOUTPUTS  (1,)\nip2/biases/Initializer/random_uniform/min\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/max\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/RandomUniform\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform/sub\nOUTPUTS  ()\nip2/biases/Initializer/random_uniform/mul\nOUTPUTS  (10,)\nip2/biases/Initializer/random_uniform\nOUTPUTS  (10,)\nip2/biases/Assign\nOUTPUTS  (10,)\nip2/biases/read\nOUTPUTS  <unknown>\nip2/ip2/MatMul\nOUTPUTS  (?, ?)\nip2/ip2\nOUTPUTS  (?, ?)\nprob\nOUTPUTS  (?, ?)\n```\n\nIt can be clearly seen that the shape of the last tensor (and others as well) in the model was `(32, 10)` and after conversion to graph_def and import again it becomes `(?, ?)`.\n\nIs there any other way to get output shapes out of any graph_def?\n"}