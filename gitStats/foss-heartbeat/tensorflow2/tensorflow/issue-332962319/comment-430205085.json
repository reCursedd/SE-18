{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/430205085", "html_url": "https://github.com/tensorflow/tensorflow/issues/20073#issuecomment-430205085", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20073", "id": 430205085, "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDIwNTA4NQ==", "user": {"login": "emikulic", "id": 828806, "node_id": "MDQ6VXNlcjgyODgwNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/828806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emikulic", "html_url": "https://github.com/emikulic", "followers_url": "https://api.github.com/users/emikulic/followers", "following_url": "https://api.github.com/users/emikulic/following{/other_user}", "gists_url": "https://api.github.com/users/emikulic/gists{/gist_id}", "starred_url": "https://api.github.com/users/emikulic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emikulic/subscriptions", "organizations_url": "https://api.github.com/users/emikulic/orgs", "repos_url": "https://api.github.com/users/emikulic/repos", "events_url": "https://api.github.com/users/emikulic/events{/privacy}", "received_events_url": "https://api.github.com/users/emikulic/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-16T11:41:13Z", "updated_at": "2018-10-16T11:41:13Z", "author_association": "NONE", "body_html": "<p>This is still happening with tf 1.11.0 keras 2.1.6-tf.</p>\n<p>Repro:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c1\">FN</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>tmp.model.h5<span class=\"pl-pds\">'</span></span>\nmodel <span class=\"pl-k\">=</span> keras.Sequential([\n  keras.layers.InputLayer(<span class=\"pl-v\">input_shape</span><span class=\"pl-k\">=</span>(<span class=\"pl-c1\">8</span>, <span class=\"pl-c1\">8</span>, <span class=\"pl-c1\">1</span>)),\n  keras.layers.Conv2D(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">5</span>),\n])\nkeras.models.save_model(model, <span class=\"pl-c1\">FN</span>)\nkeras.models.load_model(<span class=\"pl-c1\">FN</span>)</pre></div>\n<p>This errors out with:</p>\n<pre><code>Traceback (most recent call last):\n  File \"./saveload.py\", line 24, in &lt;module&gt;\n    keras.models.load_model(FN)\n  File \"tensorflow/python/keras/engine/saving.py\", line 233, in load_model\n    load_weights_from_hdf5_group(f['model_weights'], model.layers)\n  File \"tensorflow/python/keras/engine/saving.py\", line 784, in load_weights_from_hdf5_group\n    ' layers.')\nValueError: You are trying to load a weight file containing 1 layers into a model with 0 layers.\n</code></pre>\n<p>It appears to work without the InputLayer, e.g.:</p>\n<div class=\"highlight highlight-source-python\"><pre>model <span class=\"pl-k\">=</span> keras.Sequential([                                                        \n  keras.layers.Conv2D(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-v\">input_shape</span><span class=\"pl-k\">=</span>(<span class=\"pl-c1\">8</span>, <span class=\"pl-c1\">8</span>, <span class=\"pl-c1\">1</span>)),                               \n])                                                                                </pre></div>", "body_text": "This is still happening with tf 1.11.0 keras 2.1.6-tf.\nRepro:\nFN = 'tmp.model.h5'\nmodel = keras.Sequential([\n  keras.layers.InputLayer(input_shape=(8, 8, 1)),\n  keras.layers.Conv2D(1, 5),\n])\nkeras.models.save_model(model, FN)\nkeras.models.load_model(FN)\nThis errors out with:\nTraceback (most recent call last):\n  File \"./saveload.py\", line 24, in <module>\n    keras.models.load_model(FN)\n  File \"tensorflow/python/keras/engine/saving.py\", line 233, in load_model\n    load_weights_from_hdf5_group(f['model_weights'], model.layers)\n  File \"tensorflow/python/keras/engine/saving.py\", line 784, in load_weights_from_hdf5_group\n    ' layers.')\nValueError: You are trying to load a weight file containing 1 layers into a model with 0 layers.\n\nIt appears to work without the InputLayer, e.g.:\nmodel = keras.Sequential([                                                        \n  keras.layers.Conv2D(1, 5, input_shape=(8, 8, 1)),                               \n])", "body": "This is still happening with tf 1.11.0 keras 2.1.6-tf.\r\n\r\nRepro:\r\n\r\n```python\r\nFN = 'tmp.model.h5'\r\nmodel = keras.Sequential([\r\n  keras.layers.InputLayer(input_shape=(8, 8, 1)),\r\n  keras.layers.Conv2D(1, 5),\r\n])\r\nkeras.models.save_model(model, FN)\r\nkeras.models.load_model(FN)\r\n```\r\n\r\nThis errors out with:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"./saveload.py\", line 24, in <module>\r\n    keras.models.load_model(FN)\r\n  File \"tensorflow/python/keras/engine/saving.py\", line 233, in load_model\r\n    load_weights_from_hdf5_group(f['model_weights'], model.layers)\r\n  File \"tensorflow/python/keras/engine/saving.py\", line 784, in load_weights_from_hdf5_group\r\n    ' layers.')\r\nValueError: You are trying to load a weight file containing 1 layers into a model with 0 layers.\r\n```\r\n\r\nIt appears to work without the InputLayer, e.g.:\r\n\r\n```python\r\nmodel = keras.Sequential([                                                        \r\n  keras.layers.Conv2D(1, 5, input_shape=(8, 8, 1)),                               \r\n])                                                                                \r\n```"}