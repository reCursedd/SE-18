{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20073", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20073/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20073/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20073/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20073", "id": 332962319, "node_id": "MDU6SXNzdWUzMzI5NjIzMTk=", "number": 20073, "title": "Can't load hdf5 files when using tf.keras.SequentialModel.add() and ModelCheckpoint()", "user": {"login": "ddurham2", "id": 4805134, "node_id": "MDQ6VXNlcjQ4MDUxMzQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/4805134?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ddurham2", "html_url": "https://github.com/ddurham2", "followers_url": "https://api.github.com/users/ddurham2/followers", "following_url": "https://api.github.com/users/ddurham2/following{/other_user}", "gists_url": "https://api.github.com/users/ddurham2/gists{/gist_id}", "starred_url": "https://api.github.com/users/ddurham2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ddurham2/subscriptions", "organizations_url": "https://api.github.com/users/ddurham2/orgs", "repos_url": "https://api.github.com/users/ddurham2/repos", "events_url": "https://api.github.com/users/ddurham2/events{/privacy}", "received_events_url": "https://api.github.com/users/ddurham2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2018-06-16T05:27:47Z", "updated_at": "2018-11-16T00:33:26Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>Bug.  Compiled Tensorflow 1.8 and 1.9rc0 both fail. Linux Mint 18.2.  Python-3.5.2  CUDA 9.0/CuDNN 7.0</p>\n<p>Have I written custom code: I've attached a file<br>\nOS Platform and Distribution: Linux Mint 18.2<br>\nTensorFlow installed from: source<br>\nTensorFlow version: 1.8 and 1.9rc0<br>\nBazel version: 0.13.1<br>\nCUDA/cuDNN version: 9.0/7.0<br>\nGPU model and memory: Nvidia 1080Ti<br>\nExact command to reproduce: run the attached script.</p>\n<p>When using tf.keras.SequentialModel to build a network, and using tf.keras.callbacks.ModelCheckpoint to save the model/weights during training, the saved hdf5 file cannot be loaded into the same model.</p>\n<p>I believe the same problem was observed in keras-1.0<br>\nSee here: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"147802910\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/keras-team/keras/issues/2281\" data-hovercard-type=\"issue\" data-hovercard-url=\"/keras-team/keras/issues/2281/hovercard\" href=\"https://github.com/keras-team/keras/issues/2281\">keras-team/keras#2281</a><br>\nAnd reportedly fixed here: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/keras-team/keras/commit/1206120d1084cbe45dc2876f002cb572a97e3844/hovercard\" href=\"https://github.com/keras-team/keras/commit/1206120d1084cbe45dc2876f002cb572a97e3844\">keras-team/keras@<tt>1206120</tt></a></p>\n<p>I've attached a minimal script which will readily reproduce the problem here: <a href=\"https://github.com/tensorflow/tensorflow/files/2107894/save-bug.txt\">save-bug.txt</a></p>\n<p>The output error I receive when attempting to load the model weights into the same model which I saved them from is:</p>\n<pre><code>Traceback (most recent call last):\n  File \"./save-bug.py\", line 38, in &lt;module&gt;\n    predict()\n  File \"./save-bug.py\", line 31, in predict\n    model.load_weights('test.hdf5');\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/_impl/keras/engine/network.py\", line 1190, in load_weights\n    saving.load_weights_from_hdf5_group(f, self.layers)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/_impl/keras/engine/saving.py\", line 697, in load_weights_from_hdf5_group\n    ' layers.')\nValueError: You are trying to load a weight file containing 1 layers into a model with 0 layers.\n</code></pre>", "body_text": "Bug.  Compiled Tensorflow 1.8 and 1.9rc0 both fail. Linux Mint 18.2.  Python-3.5.2  CUDA 9.0/CuDNN 7.0\nHave I written custom code: I've attached a file\nOS Platform and Distribution: Linux Mint 18.2\nTensorFlow installed from: source\nTensorFlow version: 1.8 and 1.9rc0\nBazel version: 0.13.1\nCUDA/cuDNN version: 9.0/7.0\nGPU model and memory: Nvidia 1080Ti\nExact command to reproduce: run the attached script.\nWhen using tf.keras.SequentialModel to build a network, and using tf.keras.callbacks.ModelCheckpoint to save the model/weights during training, the saved hdf5 file cannot be loaded into the same model.\nI believe the same problem was observed in keras-1.0\nSee here: keras-team/keras#2281\nAnd reportedly fixed here: keras-team/keras@1206120\nI've attached a minimal script which will readily reproduce the problem here: save-bug.txt\nThe output error I receive when attempting to load the model weights into the same model which I saved them from is:\nTraceback (most recent call last):\n  File \"./save-bug.py\", line 38, in <module>\n    predict()\n  File \"./save-bug.py\", line 31, in predict\n    model.load_weights('test.hdf5');\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/_impl/keras/engine/network.py\", line 1190, in load_weights\n    saving.load_weights_from_hdf5_group(f, self.layers)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/_impl/keras/engine/saving.py\", line 697, in load_weights_from_hdf5_group\n    ' layers.')\nValueError: You are trying to load a weight file containing 1 layers into a model with 0 layers.", "body": "Bug.  Compiled Tensorflow 1.8 and 1.9rc0 both fail. Linux Mint 18.2.  Python-3.5.2  CUDA 9.0/CuDNN 7.0\r\n\r\nHave I written custom code: I've attached a file\r\nOS Platform and Distribution: Linux Mint 18.2\r\nTensorFlow installed from: source\r\nTensorFlow version: 1.8 and 1.9rc0\r\nBazel version: 0.13.1\r\nCUDA/cuDNN version: 9.0/7.0\r\nGPU model and memory: Nvidia 1080Ti\r\nExact command to reproduce: run the attached script.\r\n\r\n\r\nWhen using tf.keras.SequentialModel to build a network, and using tf.keras.callbacks.ModelCheckpoint to save the model/weights during training, the saved hdf5 file cannot be loaded into the same model.\r\n\r\nI believe the same problem was observed in keras-1.0\r\nSee here: https://github.com/keras-team/keras/issues/2281\r\nAnd reportedly fixed here: https://github.com/keras-team/keras/commit/1206120d1084cbe45dc2876f002cb572a97e3844\r\n\r\nI've attached a minimal script which will readily reproduce the problem here: [save-bug.txt](https://github.com/tensorflow/tensorflow/files/2107894/save-bug.txt)\r\n\r\nThe output error I receive when attempting to load the model weights into the same model which I saved them from is:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"./save-bug.py\", line 38, in <module>\r\n    predict()\r\n  File \"./save-bug.py\", line 31, in predict\r\n    model.load_weights('test.hdf5');\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/_impl/keras/engine/network.py\", line 1190, in load_weights\r\n    saving.load_weights_from_hdf5_group(f, self.layers)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/_impl/keras/engine/saving.py\", line 697, in load_weights_from_hdf5_group\r\n    ' layers.')\r\nValueError: You are trying to load a weight file containing 1 layers into a model with 0 layers.\r\n```\r\n"}