{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/245075693", "html_url": "https://github.com/tensorflow/tensorflow/issues/4175#issuecomment-245075693", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4175", "id": 245075693, "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTA3NTY5Mw==", "user": {"login": "craymichael", "id": 20629897, "node_id": "MDQ6VXNlcjIwNjI5ODk3", "avatar_url": "https://avatars2.githubusercontent.com/u/20629897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/craymichael", "html_url": "https://github.com/craymichael", "followers_url": "https://api.github.com/users/craymichael/followers", "following_url": "https://api.github.com/users/craymichael/following{/other_user}", "gists_url": "https://api.github.com/users/craymichael/gists{/gist_id}", "starred_url": "https://api.github.com/users/craymichael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/craymichael/subscriptions", "organizations_url": "https://api.github.com/users/craymichael/orgs", "repos_url": "https://api.github.com/users/craymichael/repos", "events_url": "https://api.github.com/users/craymichael/events{/privacy}", "received_events_url": "https://api.github.com/users/craymichael/received_events", "type": "User", "site_admin": false}, "created_at": "2016-09-06T20:13:56Z", "updated_at": "2016-09-06T20:28:26Z", "author_association": "NONE", "body_html": "<p>Yeah it shouldn't and yes it fails for me when using any Estimator when I specify <code>{'auc': streaming_auc}</code> as a desired metric. LinearEstimator traceback:</p>\n<pre><code>Traceback (most recent call last):\n  File \"main.py\", line 308, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv))\n  File \"main.py\", line 239, in main\n    eval_steps=1\n  File \"/usr/local/lib/tensorflow/cross_validation/evaluate.py\", line 45, in evaluate\n    metrics=metrics\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 356, in evaluate\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 630, in _evaluate_model\n    eval_dict = self._get_eval_ops(features, targets, metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/linear.py\", line 204, in _get_eval_ops\n    metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 454, in _get_eval_ops\n    return self._target_column.get_eval_ops(features, logits, targets, metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 288, in get_eval_ops\n    self.get_weight_tensor(features)))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 371, in _run_metrics\n    result[name] = metric(predictions, targets)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/metrics/python/ops/metric_ops.py\", line 802, in streaming_auc\n    fp_update_op) = _tp_fn_tn_fp(predictions, labels, thresholds, ignore_mask)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/metrics/python/ops/metric_ops.py\", line 673, in _tp_fn_tn_fp\n    thresh_tiled),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_math_ops.py\", line 845, in greater\n    result = _op_def_lib.apply_op(\"Greater\", x=x, y=y, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 468, in apply_op\n    inferred_from[input_arg.type_attr]))\nTypeError: Input 'y' of 'Greater' Op has type float32 that does not match type int64 of argument 'x'.\n</code></pre>", "body_text": "Yeah it shouldn't and yes it fails for me when using any Estimator when I specify {'auc': streaming_auc} as a desired metric. LinearEstimator traceback:\nTraceback (most recent call last):\n  File \"main.py\", line 308, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv))\n  File \"main.py\", line 239, in main\n    eval_steps=1\n  File \"/usr/local/lib/tensorflow/cross_validation/evaluate.py\", line 45, in evaluate\n    metrics=metrics\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 356, in evaluate\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 630, in _evaluate_model\n    eval_dict = self._get_eval_ops(features, targets, metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/linear.py\", line 204, in _get_eval_ops\n    metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 454, in _get_eval_ops\n    return self._target_column.get_eval_ops(features, logits, targets, metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 288, in get_eval_ops\n    self.get_weight_tensor(features)))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 371, in _run_metrics\n    result[name] = metric(predictions, targets)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/metrics/python/ops/metric_ops.py\", line 802, in streaming_auc\n    fp_update_op) = _tp_fn_tn_fp(predictions, labels, thresholds, ignore_mask)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/metrics/python/ops/metric_ops.py\", line 673, in _tp_fn_tn_fp\n    thresh_tiled),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_math_ops.py\", line 845, in greater\n    result = _op_def_lib.apply_op(\"Greater\", x=x, y=y, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 468, in apply_op\n    inferred_from[input_arg.type_attr]))\nTypeError: Input 'y' of 'Greater' Op has type float32 that does not match type int64 of argument 'x'.", "body": "Yeah it shouldn't and yes it fails for me when using any Estimator when I specify `{'auc': streaming_auc}` as a desired metric. LinearEstimator traceback:\n\n```\nTraceback (most recent call last):\n  File \"main.py\", line 308, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv))\n  File \"main.py\", line 239, in main\n    eval_steps=1\n  File \"/usr/local/lib/tensorflow/cross_validation/evaluate.py\", line 45, in evaluate\n    metrics=metrics\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 356, in evaluate\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 630, in _evaluate_model\n    eval_dict = self._get_eval_ops(features, targets, metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/linear.py\", line 204, in _get_eval_ops\n    metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 454, in _get_eval_ops\n    return self._target_column.get_eval_ops(features, logits, targets, metrics)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 288, in get_eval_ops\n    self.get_weight_tensor(features)))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 371, in _run_metrics\n    result[name] = metric(predictions, targets)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/metrics/python/ops/metric_ops.py\", line 802, in streaming_auc\n    fp_update_op) = _tp_fn_tn_fp(predictions, labels, thresholds, ignore_mask)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/metrics/python/ops/metric_ops.py\", line 673, in _tp_fn_tn_fp\n    thresh_tiled),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_math_ops.py\", line 845, in greater\n    result = _op_def_lib.apply_op(\"Greater\", x=x, y=y, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 468, in apply_op\n    inferred_from[input_arg.type_attr]))\nTypeError: Input 'y' of 'Greater' Op has type float32 that does not match type int64 of argument 'x'.\n```\n"}