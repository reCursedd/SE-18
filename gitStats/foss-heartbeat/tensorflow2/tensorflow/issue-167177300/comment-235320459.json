{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/235320459", "html_url": "https://github.com/tensorflow/tensorflow/issues/3475#issuecomment-235320459", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3475", "id": 235320459, "node_id": "MDEyOklzc3VlQ29tbWVudDIzNTMyMDQ1OQ==", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "created_at": "2016-07-26T16:15:22Z", "updated_at": "2016-07-26T16:15:22Z", "author_association": "CONTRIBUTOR", "body_html": "<p>The error message suggests that you're assigning a GPU device to one of the nodes in the <code>tf.train.Saver</code>, but it doesn't have a GPU implementation. The standard solution to this is to enable <code>allow_soft_placement=True</code> in your session <code>ConfigProto</code>.</p>\n<p>Looking at your stack trace, it seems like you aren't passing this to <code>sv.prepare_or_wait_for_session()</code>:</p>\n<pre><code>  File \"./mnist_expert_dist.py\", line 121, in run_training\n    sess = sv.prepare_or_wait_for_session(server.target)\n</code></pre>\n<p>...but in your GitHub repository, you do <a href=\"https://github.com/guolinke/temp/blob/5585113151169974e6d511a135c22972e6140205/mnist_expert_dist.py#L113\">appear to pass it</a> (and configure it correctly):</p>\n<div class=\"highlight highlight-source-python\"><pre>  sess_config <span class=\"pl-k\">=</span> tf.ConfigProto(<span class=\"pl-v\">allow_soft_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>, <span class=\"pl-v\">log_device_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>,\n                           <span class=\"pl-v\">device_filters</span><span class=\"pl-k\">=</span>[<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:ps<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:worker/task:<span class=\"pl-c1\">%d</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">%</span> <span class=\"pl-c1\">FLAGS</span>.task_index])\n  <span class=\"pl-c\"><span class=\"pl-c\">#</span> ...</span>\n  sess <span class=\"pl-k\">=</span> sv.prepare_or_wait_for_session(server.target, <span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>sess_config)</pre></div>\n<p>Do you still get the same error with the latest version of your code?</p>", "body_text": "The error message suggests that you're assigning a GPU device to one of the nodes in the tf.train.Saver, but it doesn't have a GPU implementation. The standard solution to this is to enable allow_soft_placement=True in your session ConfigProto.\nLooking at your stack trace, it seems like you aren't passing this to sv.prepare_or_wait_for_session():\n  File \"./mnist_expert_dist.py\", line 121, in run_training\n    sess = sv.prepare_or_wait_for_session(server.target)\n\n...but in your GitHub repository, you do appear to pass it (and configure it correctly):\n  sess_config = tf.ConfigProto(allow_soft_placement=True, log_device_placement=True,\n                           device_filters=[\"/job:ps\", \"/job:worker/task:%d\" % FLAGS.task_index])\n  # ...\n  sess = sv.prepare_or_wait_for_session(server.target, config=sess_config)\nDo you still get the same error with the latest version of your code?", "body": "The error message suggests that you're assigning a GPU device to one of the nodes in the `tf.train.Saver`, but it doesn't have a GPU implementation. The standard solution to this is to enable `allow_soft_placement=True` in your session `ConfigProto`.\n\nLooking at your stack trace, it seems like you aren't passing this to `sv.prepare_or_wait_for_session()`:\n\n```\n  File \"./mnist_expert_dist.py\", line 121, in run_training\n    sess = sv.prepare_or_wait_for_session(server.target)\n```\n\n...but in your GitHub repository, you do [appear to pass it](https://github.com/guolinke/temp/blob/5585113151169974e6d511a135c22972e6140205/mnist_expert_dist.py#L113) (and configure it correctly):\n\n``` python\n  sess_config = tf.ConfigProto(allow_soft_placement=True, log_device_placement=True,\n                           device_filters=[\"/job:ps\", \"/job:worker/task:%d\" % FLAGS.task_index])\n  # ...\n  sess = sv.prepare_or_wait_for_session(server.target, config=sess_config)\n```\n\nDo you still get the same error with the latest version of your code?\n"}