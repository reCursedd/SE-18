{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12431", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12431/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12431/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12431/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12431", "id": 251504903, "node_id": "MDU6SXNzdWUyNTE1MDQ5MDM=", "number": 12431, "title": "[android demo] UnsatisfiedLinkError exception on app start if build with nativeBuildSystem = 'none'", "user": {"login": "ArtsiomCh", "id": 14268320, "node_id": "MDQ6VXNlcjE0MjY4MzIw", "avatar_url": "https://avatars1.githubusercontent.com/u/14268320?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArtsiomCh", "html_url": "https://github.com/ArtsiomCh", "followers_url": "https://api.github.com/users/ArtsiomCh/followers", "following_url": "https://api.github.com/users/ArtsiomCh/following{/other_user}", "gists_url": "https://api.github.com/users/ArtsiomCh/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArtsiomCh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArtsiomCh/subscriptions", "organizations_url": "https://api.github.com/users/ArtsiomCh/orgs", "repos_url": "https://api.github.com/users/ArtsiomCh/repos", "events_url": "https://api.github.com/users/ArtsiomCh/events{/privacy}", "received_events_url": "https://api.github.com/users/ArtsiomCh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2017-08-20T18:12:39Z", "updated_at": "2017-12-20T10:19:20Z", "closed_at": "2017-09-06T00:00:58Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nNO</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\napp build at Android Studio 2.3.3 on Linux Ubuntu 16.04<br>\napp tested on Meizu M2 Note (Android 5.1, API 22)</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nSource</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\nMaster branch from GitHub</li>\n<li><strong>Python version</strong>:<br>\n2.7 (not used in that case)</li>\n<li><strong>Bazel version (if compiling from source)</strong>:<br>\n0.5.3 (not used in that case)</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\nnone</li>\n<li><strong>GPU model and memory</strong>:<br>\nnone</li>\n<li><strong>Exact command to reproduce</strong>:<br>\nAndroid Studio/Run (build.gradle)</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>With <code>nativeBuildSystem = 'none'</code> app exit with UnsatisfiedLinkError exception (see log below).<br>\nQuick investigation shows call of <code>env.ImageUtils.convertYUV420SPToARGB8888(Native Method)</code> native method from <code>CameraActivity.onPreviewFrame(CameraActivity.java:113)</code>.<br>\n<code>convertYUV420SPToARGB8888</code> suppose to be implemented in <code>libtensorflow_demo.so</code> wich is not created in case of <code>nativeBuildSystem = 'none'</code>. (With <code>nativeBuildSystem = 'cmake'</code> <code>libtensorflow_demo.so</code> created and <code>convertYUV420SPToARGB8888</code> works fine)<br>\nQuick fix may be obtained by including <code>libtensorflow_demo.so</code> into JCenter and download it like the TensorFlow Inference Interface package.<br>\nAnother solution would be Java implementation of <code>convertYUV420SPToARGB8888</code>, the same as it been done for <code>convertYUV420ToARGB8888</code> in commit #003deb8 at PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"236547816\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10771\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/10771/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/10771\">#10771</a> \"Refactor and implementation of the camera API 1, it fixes <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"217135698\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8736\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/8736/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/8736\">#8736</a> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"236547816\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10771\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/10771/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/10771\">#10771</a>\".<br>\nI start working with that Java implementation of <code>convertYUV420SPToARGB8888</code> but I don't think I have enough skills to make it. At the moment I create Java wrapper for native convertYUV420SPToARGB8888 and make all native methods <code>private</code> to isolate the rest of the Java code from occasional use them:<br>\n<a href=\"url\">https://github.com/ArtsiomCh/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/CameraActivity.java</a><br>\n<a href=\"url\">https://github.com/ArtsiomCh/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/env/ImageUtils.java</a><br>\nWould be great if <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4120796\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/osdamv\">@osdamv</a> (creator of Java implementation of <code>convertYUV420ToARGB8888</code>) can help in porting Java implementation of <code>convertYUV420ToARGB8888</code> for <code>convertYUV420SPToARGB8888</code></p>\n<h3>Source code / logs</h3>\n<p>08-20 13:28:38.212 19058-19058/? I/TensorFlowInferenceInterface: Model load took 1303ms, TensorFlow version: 1.2.0<br>\n08-20 13:28:38.217 19058-19058/? I/TensorFlowInferenceInterface: Successfully loaded model from 'file:///android_asset/tensorflow_inception_graph.pb'<br>\n08-20 13:28:38.219 19058-19058/? I/TensorFlowImageClassifier: Read 1001 labels, output layer size is 1008<br>\n08-20 13:28:38.219 19058-19058/? I/tensorflow: ClassifierActivity: Sensor orientation: 90, Screen orientation: 0<br>\n08-20 13:28:38.219 19058-19058/? I/tensorflow: ClassifierActivity: Initializing at size 640x480<br>\n08-20 13:28:38.223 19058-19058/? W/tensorflow: ImageUtils: Native library not found, native RGB -&gt; YUV conversion may be unavailable.<br>\n08-20 13:28:38.225 19058-19058/? E/art: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(byte[], int[], int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888___3B_3IIIZ)<br>\n08-20 13:28:38.226 19058-19058/? E/AndroidRuntime: FATAL EXCEPTION: main<br>\nProcess: org.tensorflow.demo, PID: 19058<br>\njava.lang.UnsatisfiedLinkError: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(byte[], int[], int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888___3B_3IIIZ)<br>\nat org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(Native Method)<br>\nat org.tensorflow.demo.CameraActivity.onPreviewFrame(CameraActivity.java:113)<br>\nat android.hardware.Camera$EventHandler.handleMessage(Camera.java:1288)<br>\nat android.os.Handler.dispatchMessage(Handler.java:111)<br>\nat android.os.Looper.loop(Looper.java:194)<br>\nat android.app.ActivityThread.main(ActivityThread.java:5877)<br>\nat java.lang.reflect.Method.invoke(Native Method)<br>\nat java.lang.reflect.Method.invoke(Method.java:372)<br>\nat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1020)<br>\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:815)<br>\n08-20 13:28:38.265 19058-19058/? I/Process: Sending signal. PID: 19058 SIG: 9</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNO\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\napp build at Android Studio 2.3.3 on Linux Ubuntu 16.04\napp tested on Meizu M2 Note (Android 5.1, API 22)\nTensorFlow installed from (source or binary):\nSource\nTensorFlow version (use command below):\nMaster branch from GitHub\nPython version:\n2.7 (not used in that case)\nBazel version (if compiling from source):\n0.5.3 (not used in that case)\nCUDA/cuDNN version:\nnone\nGPU model and memory:\nnone\nExact command to reproduce:\nAndroid Studio/Run (build.gradle)\n\nDescribe the problem\nWith nativeBuildSystem = 'none' app exit with UnsatisfiedLinkError exception (see log below).\nQuick investigation shows call of env.ImageUtils.convertYUV420SPToARGB8888(Native Method) native method from CameraActivity.onPreviewFrame(CameraActivity.java:113).\nconvertYUV420SPToARGB8888 suppose to be implemented in libtensorflow_demo.so wich is not created in case of nativeBuildSystem = 'none'. (With nativeBuildSystem = 'cmake' libtensorflow_demo.so created and convertYUV420SPToARGB8888 works fine)\nQuick fix may be obtained by including libtensorflow_demo.so into JCenter and download it like the TensorFlow Inference Interface package.\nAnother solution would be Java implementation of convertYUV420SPToARGB8888, the same as it been done for convertYUV420ToARGB8888 in commit #003deb8 at PR #10771 \"Refactor and implementation of the camera API 1, it fixes #8736 #10771\".\nI start working with that Java implementation of convertYUV420SPToARGB8888 but I don't think I have enough skills to make it. At the moment I create Java wrapper for native convertYUV420SPToARGB8888 and make all native methods private to isolate the rest of the Java code from occasional use them:\nhttps://github.com/ArtsiomCh/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/CameraActivity.java\nhttps://github.com/ArtsiomCh/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/env/ImageUtils.java\nWould be great if @osdamv (creator of Java implementation of convertYUV420ToARGB8888) can help in porting Java implementation of convertYUV420ToARGB8888 for convertYUV420SPToARGB8888\nSource code / logs\n08-20 13:28:38.212 19058-19058/? I/TensorFlowInferenceInterface: Model load took 1303ms, TensorFlow version: 1.2.0\n08-20 13:28:38.217 19058-19058/? I/TensorFlowInferenceInterface: Successfully loaded model from 'file:///android_asset/tensorflow_inception_graph.pb'\n08-20 13:28:38.219 19058-19058/? I/TensorFlowImageClassifier: Read 1001 labels, output layer size is 1008\n08-20 13:28:38.219 19058-19058/? I/tensorflow: ClassifierActivity: Sensor orientation: 90, Screen orientation: 0\n08-20 13:28:38.219 19058-19058/? I/tensorflow: ClassifierActivity: Initializing at size 640x480\n08-20 13:28:38.223 19058-19058/? W/tensorflow: ImageUtils: Native library not found, native RGB -> YUV conversion may be unavailable.\n08-20 13:28:38.225 19058-19058/? E/art: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(byte[], int[], int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888___3B_3IIIZ)\n08-20 13:28:38.226 19058-19058/? E/AndroidRuntime: FATAL EXCEPTION: main\nProcess: org.tensorflow.demo, PID: 19058\njava.lang.UnsatisfiedLinkError: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(byte[], int[], int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888___3B_3IIIZ)\nat org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(Native Method)\nat org.tensorflow.demo.CameraActivity.onPreviewFrame(CameraActivity.java:113)\nat android.hardware.Camera$EventHandler.handleMessage(Camera.java:1288)\nat android.os.Handler.dispatchMessage(Handler.java:111)\nat android.os.Looper.loop(Looper.java:194)\nat android.app.ActivityThread.main(ActivityThread.java:5877)\nat java.lang.reflect.Method.invoke(Native Method)\nat java.lang.reflect.Method.invoke(Method.java:372)\nat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1020)\nat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:815)\n08-20 13:28:38.265 19058-19058/? I/Process: Sending signal. PID: 19058 SIG: 9", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNO\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\napp build at Android Studio 2.3.3 on Linux Ubuntu 16.04\r\napp tested on Meizu M2 Note (Android 5.1, API 22) \r\n- **TensorFlow installed from (source or binary)**:\r\nSource\r\n- **TensorFlow version (use command below)**:\r\nMaster branch from GitHub\r\n- **Python version**: \r\n2.7 (not used in that case)\r\n- **Bazel version (if compiling from source)**:\r\n0.5.3 (not used in that case) \r\n- **CUDA/cuDNN version**:\r\nnone\r\n- **GPU model and memory**:\r\nnone\r\n- **Exact command to reproduce**:\r\nAndroid Studio/Run (build.gradle)\r\n\r\n### Describe the problem\r\nWith `nativeBuildSystem = 'none'` app exit with UnsatisfiedLinkError exception (see log below).\r\nQuick investigation shows call of `env.ImageUtils.convertYUV420SPToARGB8888(Native Method)` native method from `CameraActivity.onPreviewFrame(CameraActivity.java:113)`. \r\n`convertYUV420SPToARGB8888` suppose to be implemented in `libtensorflow_demo.so` wich is not created in case of `nativeBuildSystem = 'none'`. (With `nativeBuildSystem = 'cmake'` `libtensorflow_demo.so` created and `convertYUV420SPToARGB8888` works fine)\r\nQuick fix may be obtained by including `libtensorflow_demo.so` into JCenter and download it like the TensorFlow Inference Interface package.\r\nAnother solution would be Java implementation of `convertYUV420SPToARGB8888`, the same as it been done for `convertYUV420ToARGB8888` in commit #003deb8 at PR #10771 \"Refactor and implementation of the camera API 1, it fixes #8736 #10771\".\r\nI start working with that Java implementation of `convertYUV420SPToARGB8888` but I don't think I have enough skills to make it. At the moment I create Java wrapper for native convertYUV420SPToARGB8888 and make all native methods `private` to isolate the rest of the Java code from occasional use them:\r\n[https://github.com/ArtsiomCh/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/CameraActivity.java](url)\r\n[https://github.com/ArtsiomCh/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/env/ImageUtils.java](url)\r\nWould be great if @osdamv (creator of Java implementation of `convertYUV420ToARGB8888`) can help in porting Java implementation of `convertYUV420ToARGB8888` for `convertYUV420SPToARGB8888`\r\n\r\n### Source code / logs\r\n08-20 13:28:38.212 19058-19058/? I/TensorFlowInferenceInterface: Model load took 1303ms, TensorFlow version: 1.2.0\r\n08-20 13:28:38.217 19058-19058/? I/TensorFlowInferenceInterface: Successfully loaded model from 'file:///android_asset/tensorflow_inception_graph.pb'\r\n08-20 13:28:38.219 19058-19058/? I/TensorFlowImageClassifier: Read 1001 labels, output layer size is 1008\r\n08-20 13:28:38.219 19058-19058/? I/tensorflow: ClassifierActivity: Sensor orientation: 90, Screen orientation: 0\r\n08-20 13:28:38.219 19058-19058/? I/tensorflow: ClassifierActivity: Initializing at size 640x480\r\n08-20 13:28:38.223 19058-19058/? W/tensorflow: ImageUtils: Native library not found, native RGB -> YUV conversion may be unavailable.\r\n08-20 13:28:38.225 19058-19058/? E/art: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(byte[], int[], int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888___3B_3IIIZ)\r\n08-20 13:28:38.226 19058-19058/? E/AndroidRuntime: FATAL EXCEPTION: main\r\n                                                   Process: org.tensorflow.demo, PID: 19058\r\n                                                   java.lang.UnsatisfiedLinkError: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(byte[], int[], int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420SPToARGB8888___3B_3IIIZ)\r\n                                                       at org.tensorflow.demo.env.ImageUtils.convertYUV420SPToARGB8888(Native Method)\r\n                                                       at org.tensorflow.demo.CameraActivity.onPreviewFrame(CameraActivity.java:113)\r\n                                                       at android.hardware.Camera$EventHandler.handleMessage(Camera.java:1288)\r\n                                                       at android.os.Handler.dispatchMessage(Handler.java:111)\r\n                                                       at android.os.Looper.loop(Looper.java:194)\r\n                                                       at android.app.ActivityThread.main(ActivityThread.java:5877)\r\n                                                       at java.lang.reflect.Method.invoke(Native Method)\r\n                                                       at java.lang.reflect.Method.invoke(Method.java:372)\r\n                                                       at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1020)\r\n                                                       at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:815)\r\n08-20 13:28:38.265 19058-19058/? I/Process: Sending signal. PID: 19058 SIG: 9"}