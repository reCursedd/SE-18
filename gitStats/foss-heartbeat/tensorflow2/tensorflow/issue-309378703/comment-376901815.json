{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/376901815", "html_url": "https://github.com/tensorflow/tensorflow/pull/18047#issuecomment-376901815", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18047", "id": 376901815, "node_id": "MDEyOklzc3VlQ29tbWVudDM3NjkwMTgxNQ==", "user": {"login": "rongjiecomputer", "id": 13115060, "node_id": "MDQ6VXNlcjEzMTE1MDYw", "avatar_url": "https://avatars2.githubusercontent.com/u/13115060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rongjiecomputer", "html_url": "https://github.com/rongjiecomputer", "followers_url": "https://api.github.com/users/rongjiecomputer/followers", "following_url": "https://api.github.com/users/rongjiecomputer/following{/other_user}", "gists_url": "https://api.github.com/users/rongjiecomputer/gists{/gist_id}", "starred_url": "https://api.github.com/users/rongjiecomputer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rongjiecomputer/subscriptions", "organizations_url": "https://api.github.com/users/rongjiecomputer/orgs", "repos_url": "https://api.github.com/users/rongjiecomputer/repos", "events_url": "https://api.github.com/users/rongjiecomputer/events{/privacy}", "received_events_url": "https://api.github.com/users/rongjiecomputer/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-28T14:13:41Z", "updated_at": "2018-03-28T14:14:44Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4171702\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/meteorcloudy\">@meteorcloudy</a> Can you change the internal fix to <code>_WIN32</code> and <code>_MSC_VER</code> where appropriate instead of relying on <code>COMPILER_MSVC</code> from <code>CROSSTOOL</code>?</p>\n<p>I was thinking about asking Bazel to remove <code>-DCOMPILER_MSVC</code> from <code>CROSSTOOL</code> completely. IMO, build system should add as little compile/link flags as possible.</p>\n<p>Many Google projects like Protobuf and Chromium do use <code>COMPILER_MSVC</code> macro, but they are defined in header file and IWYU rule is enforced. Only Tensorflow is not following the rule.</p>\n<p>EDIT: Abseil C++ just use <code>_WIN32</code> and <code>_MSC_VER</code> directly.</p>", "body_text": "@meteorcloudy Can you change the internal fix to _WIN32 and _MSC_VER where appropriate instead of relying on COMPILER_MSVC from CROSSTOOL?\nI was thinking about asking Bazel to remove -DCOMPILER_MSVC from CROSSTOOL completely. IMO, build system should add as little compile/link flags as possible.\nMany Google projects like Protobuf and Chromium do use COMPILER_MSVC macro, but they are defined in header file and IWYU rule is enforced. Only Tensorflow is not following the rule.\nEDIT: Abseil C++ just use _WIN32 and _MSC_VER directly.", "body": "@meteorcloudy Can you change the internal fix to `_WIN32` and `_MSC_VER` where appropriate instead of relying on `COMPILER_MSVC` from `CROSSTOOL`?\r\n\r\nI was thinking about asking Bazel to remove `-DCOMPILER_MSVC` from `CROSSTOOL` completely. IMO, build system should add as little compile/link flags as possible.\r\n\r\nMany Google projects like Protobuf and Chromium do use `COMPILER_MSVC` macro, but they are defined in header file and IWYU rule is enforced. Only Tensorflow is not following the rule.\r\n\r\nEDIT: Abseil C++ just use `_WIN32` and `_MSC_VER` directly."}