{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/376911348", "html_url": "https://github.com/tensorflow/tensorflow/pull/18047#issuecomment-376911348", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18047", "id": 376911348, "node_id": "MDEyOklzc3VlQ29tbWVudDM3NjkxMTM0OA==", "user": {"login": "rongjiecomputer", "id": 13115060, "node_id": "MDQ6VXNlcjEzMTE1MDYw", "avatar_url": "https://avatars2.githubusercontent.com/u/13115060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rongjiecomputer", "html_url": "https://github.com/rongjiecomputer", "followers_url": "https://api.github.com/users/rongjiecomputer/followers", "following_url": "https://api.github.com/users/rongjiecomputer/following{/other_user}", "gists_url": "https://api.github.com/users/rongjiecomputer/gists{/gist_id}", "starred_url": "https://api.github.com/users/rongjiecomputer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rongjiecomputer/subscriptions", "organizations_url": "https://api.github.com/users/rongjiecomputer/orgs", "repos_url": "https://api.github.com/users/rongjiecomputer/repos", "events_url": "https://api.github.com/users/rongjiecomputer/events{/privacy}", "received_events_url": "https://api.github.com/users/rongjiecomputer/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-28T14:40:53Z", "updated_at": "2018-03-28T14:40:53Z", "author_association": "CONTRIBUTOR", "body_html": "<blockquote>\n<p>So maybe change it to:</p>\n</blockquote>\n<pre><code>#if defined(_MSC_VER) &amp;&amp; !defined(__clang__)\n#include \"tensorflow/core/platform/windows/cpu_info.h\"\n#endif\n</code></pre>\n<blockquote>\n<p>Then remove the check in <code>tensorflow/core/platform/windows/cpu_info.h</code> ?</p>\n</blockquote>\n<p><code>tensorflow/core/platform/windows/cpu_info.h</code> will include <code>intrin.h</code> which Clang+MSVC also needs. I will change <code>PLATFORM_WINDOWS</code> to <code>_MSC_VER</code> in and still keep the <code>__clang__</code> check in <code>tensorflow/core/platform/windows/cpu_info.h</code>. Sounds good?</p>", "body_text": "So maybe change it to:\n\n#if defined(_MSC_VER) && !defined(__clang__)\n#include \"tensorflow/core/platform/windows/cpu_info.h\"\n#endif\n\n\nThen remove the check in tensorflow/core/platform/windows/cpu_info.h ?\n\ntensorflow/core/platform/windows/cpu_info.h will include intrin.h which Clang+MSVC also needs. I will change PLATFORM_WINDOWS to _MSC_VER in and still keep the __clang__ check in tensorflow/core/platform/windows/cpu_info.h. Sounds good?", "body": "> So maybe change it to:\r\n```\r\n#if defined(_MSC_VER) && !defined(__clang__)\r\n#include \"tensorflow/core/platform/windows/cpu_info.h\"\r\n#endif\r\n```\r\n> Then remove the check in `tensorflow/core/platform/windows/cpu_info.h` ?\r\n\r\n`tensorflow/core/platform/windows/cpu_info.h` will include `intrin.h` which Clang+MSVC also needs. I will change `PLATFORM_WINDOWS` to `_MSC_VER` in and still keep the `__clang__` check in `tensorflow/core/platform/windows/cpu_info.h`. Sounds good?"}