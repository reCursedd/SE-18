{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/52821233", "pull_request_review_id": null, "id": 52821233, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIxMjMz", "diff_hunk": "@@ -69,17 +69,22 @@ abs_path() {\n     [[ $1 = /* ]] && echo \"$1\" || echo \"$PWD/${1#./}\"\n }\n \n+# Exit after a failure\n+die() {\n+    echo $@\n+    exit 1\n+}\n+\n # Get the command line arguments\n CONTAINER_TYPE=$( echo \"$1\" | tr '[:upper:]' '[:lower:]' )\n \n PIP_BUILD_TARGET=\"//tensorflow/tools/pip_package:build_pip_package\"\n if [[ ${CONTAINER_TYPE} == \"cpu\" ]]; then\n-  bazel build -c opt ${PIP_BUILD_TARGET}\n+  bazel build -c opt ${PIP_BUILD_TARGET} || die \"Build failed.\"\n elif [[ ${CONTAINER_TYPE} == \"gpu\" ]]; then\n-  bazel build -c opt --config=cuda ${PIP_BUILD_TARGET}\n+  bazel build -c opt --config=cuda ${PIP_BUILD_TARGET} || die \"Build failed.\"\n else\n-  echo \"Unrecognized container type: \\\"${CONTAINER_TYPE}\\\"\"\n-  exit 1\n+  die \"Unrecognized container type: \\\"${CONTAINER_TYPE}\\\"\"\n fi", "path": "tensorflow/tools/ci_build/builds/pip.sh", "position": 24, "original_position": 24, "commit_id": "7c798086b728ed9afee1448ae3a430b0bb1b3afe", "original_commit_id": "7c798086b728ed9afee1448ae3a430b0bb1b3afe", "user": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "body": "I think an easier and cleaner change would be adding \" &&\" after this line, (line 88, fi). It guarantees that the script either \n1) Goes through the one of the first two logical branches with exit code 0\nor \n2) Go into the last logical branch, in which case it'll certainly die properly with exit 1. \n", "created_at": "2016-02-13T02:21:12Z", "updated_at": "2016-02-13T02:22:21Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/1082#discussion_r52821233", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1082", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/52821233"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/1082#discussion_r52821233"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1082"}}, "body_html": "<p>I think an easier and cleaner change would be adding \" &amp;&amp;\" after this line, (line 88, fi). It guarantees that the script either</p>\n<ol>\n<li>Goes through the one of the first two logical branches with exit code 0<br>\nor</li>\n<li>Go into the last logical branch, in which case it'll certainly die properly with exit 1.</li>\n</ol>", "body_text": "I think an easier and cleaner change would be adding \" &&\" after this line, (line 88, fi). It guarantees that the script either\n\nGoes through the one of the first two logical branches with exit code 0\nor\nGo into the last logical branch, in which case it'll certainly die properly with exit 1."}