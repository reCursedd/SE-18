{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8235", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8235/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8235/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8235/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8235", "id": 212971783, "node_id": "MDU6SXNzdWUyMTI5NzE3ODM=", "number": 8235, "title": "RuntimeError: Graph is finalized and cannot be modified. when I use tf.train.Supervisor", "user": {"login": "fanlu", "id": 1620875, "node_id": "MDQ6VXNlcjE2MjA4NzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1620875?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fanlu", "html_url": "https://github.com/fanlu", "followers_url": "https://api.github.com/users/fanlu/followers", "following_url": "https://api.github.com/users/fanlu/following{/other_user}", "gists_url": "https://api.github.com/users/fanlu/gists{/gist_id}", "starred_url": "https://api.github.com/users/fanlu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fanlu/subscriptions", "organizations_url": "https://api.github.com/users/fanlu/orgs", "repos_url": "https://api.github.com/users/fanlu/repos", "events_url": "https://api.github.com/users/fanlu/events{/privacy}", "received_events_url": "https://api.github.com/users/fanlu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-03-09T08:53:08Z", "updated_at": "2018-02-08T07:28:08Z", "closed_at": "2017-03-09T17:12:08Z", "author_association": "CONTRIBUTOR", "body_html": "<p>In [1]: import tensorflow as tf</p>\n<p>In [2]: g = tf.Variable(0, name=\"g\")</p>\n<p>In [3]: def pre_load(sess):<br>\n...:     print(\"load\")<br>\n...:     sess.run(g.assign(1))<br>\n...:</p>\n<p>In [4]: sv = tf.train.Supervisor(logdir=\"/tmp/2/\", init_fn=pre_load)</p>\n<p>In [5]: with sv.managed_session() as sess:<br>\n...:     sess.run(tf.group(tf.global_variables_initializer(), tf.local_variables_initializer()))<br>\n...:     print(sess.run(g))</p>\n<h2>when I run this code in ipython,<br>\nI got an execption below<br>\nINFO:tensorflow:Error reported to Coordinator: &lt;type 'exceptions.RuntimeError'&gt;, Graph is finalized and cannot be modified.</h2>\n<p>RuntimeError                              Traceback (most recent call last)<br>\n in ()<br>\n----&gt; 1 with sv.managed_session() as sess:<br>\n2     sess.run(tf.group(tf.global_variables_initializer(), tf.local_variables_initializer()))<br>\n3     print(sess.run(g))<br>\n4</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/contextlib.pyc in <strong>enter</strong>(self)<br>\n15     def <strong>enter</strong>(self):<br>\n16         try:<br>\n---&gt; 17             return self.gen.next()<br>\n18         except StopIteration:<br>\n19             raise RuntimeError(\"generator didn't yield\")</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in managed_session(self, master, config, start_standard_services, close_summary_writer)<br>\n971         # threads which are not checking for <code>should_stop()</code>.  They<br>\n972         # will be stopped when we close the session further down.<br>\n--&gt; 973         self.stop(close_summary_writer=close_summary_writer)<br>\n974       finally:<br>\n975         # Close the session to finish up all pending calls.  We do not care</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in stop(self, threads, close_summary_writer)<br>\n799       # reported.<br>\n800       self._coord.join(threads,<br>\n--&gt; 801                        stop_grace_period_secs=self._stop_grace_secs)<br>\n802     finally:<br>\n803       # Close the writer last, in case one of the running threads was using it.</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/coordinator.pyc in join(self, threads, stop_grace_period_secs)<br>\n384       self._registered_threads = set()<br>\n385       if self._exc_info_to_raise:<br>\n--&gt; 386         six.reraise(*self._exc_info_to_raise)<br>\n387       elif stragglers:<br>\n388         raise RuntimeError(</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in managed_session(self, master, config, start_standard_services, close_summary_writer)<br>\n960       sess = self.prepare_or_wait_for_session(<br>\n961           master=master, config=config,<br>\n--&gt; 962           start_standard_services=start_standard_services)<br>\n963       yield sess<br>\n964     except Exception as e:</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in prepare_or_wait_for_session(self, master, config, wait_for_checkpoint, max_wait_secs, start_standard_services)<br>\n717           checkpoint_dir=self._logdir, wait_for_checkpoint=wait_for_checkpoint,<br>\n718           max_wait_secs=max_wait_secs, config=config,<br>\n--&gt; 719           init_feed_dict=self._init_feed_dict, init_fn=self._init_fn)<br>\n720       self._write_graph()<br>\n721       if start_standard_services:</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.pyc in prepare_session(self, master, init_op, saver, checkpoint_dir, checkpoint_filename_with_path, wait_for_checkpoint, max_wait_secs, config, init_feed_dict, init_fn)<br>\n262         sess.run(init_op, feed_dict=init_feed_dict)<br>\n263       if init_fn:<br>\n--&gt; 264         init_fn(sess)<br>\n265<br>\n266     local_init_success, msg = self._try_run_local_init_op(sess)</p>\n<p> in pre_load(sess)<br>\n1 def pre_load(sess):<br>\n2     print(\"load\")<br>\n----&gt; 3     sess.run(g.assign(1))<br>\n4</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/ops/variables.pyc in assign(self, value, use_locking)<br>\n549       the assignment has completed.<br>\n550     \"\"\"<br>\n--&gt; 551     return state_ops.assign(self._variable, value, use_locking=use_locking)<br>\n552<br>\n553   def assign_add(self, delta, use_locking=False):</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/ops/gen_state_ops.pyc in assign(ref, value, validate_shape, use_locking, name)<br>\n45   result = _op_def_lib.apply_op(\"Assign\", ref=ref, value=value,<br>\n46                                 validate_shape=validate_shape,<br>\n---&gt; 47                                 use_locking=use_locking, name=name)<br>\n48   return result<br>\n49</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.pyc in apply_op(self, op_type_name, name, **keywords)<br>\n489                 dtype=dtype,<br>\n490                 as_ref=input_arg.is_ref,<br>\n--&gt; 491                 preferred_dtype=default_dtype)<br>\n492           except TypeError as err:<br>\n493             if dtype is None:</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in internal_convert_to_tensor(value, dtype, name, as_ref, preferred_dtype)<br>\n714<br>\n715         if ret is None:<br>\n--&gt; 716           ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)<br>\n717<br>\n718         if ret is NotImplemented:</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyc in _constant_tensor_conversion_function(v, dtype, name, as_ref)<br>\n174                                          as_ref=False):<br>\n175   _ = as_ref<br>\n--&gt; 176   return constant(v, dtype=dtype, name=name)<br>\n177<br>\n178</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyc in constant(value, dtype, shape, name, verify_shape)<br>\n167   const_tensor = g.create_op(<br>\n168       \"Const\", [], [dtype_value.type],<br>\n--&gt; 169       attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]<br>\n170   return const_tensor<br>\n171</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in create_op(self, op_type, inputs, dtypes, input_types, name, attrs, op_def, compute_shapes, compute_device)<br>\n2352<br>\n2353     \"\"\"<br>\n-&gt; 2354     self._check_not_finalized()<br>\n2355     for idx, a in enumerate(inputs):<br>\n2356       if not isinstance(a, Tensor):</p>\n<p>/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in _check_not_finalized(self)<br>\n2075     \"\"\"<br>\n2076     if self._finalized:<br>\n-&gt; 2077       raise RuntimeError(\"Graph is finalized and cannot be modified.\")<br>\n2078<br>\n2079   def _add_op(self, op):</p>\n<p>RuntimeError: Graph is finalized and cannot be modified.</p>", "body_text": "In [1]: import tensorflow as tf\nIn [2]: g = tf.Variable(0, name=\"g\")\nIn [3]: def pre_load(sess):\n...:     print(\"load\")\n...:     sess.run(g.assign(1))\n...:\nIn [4]: sv = tf.train.Supervisor(logdir=\"/tmp/2/\", init_fn=pre_load)\nIn [5]: with sv.managed_session() as sess:\n...:     sess.run(tf.group(tf.global_variables_initializer(), tf.local_variables_initializer()))\n...:     print(sess.run(g))\nwhen I run this code in ipython,\nI got an execption below\nINFO:tensorflow:Error reported to Coordinator: <type 'exceptions.RuntimeError'>, Graph is finalized and cannot be modified.\nRuntimeError                              Traceback (most recent call last)\n in ()\n----> 1 with sv.managed_session() as sess:\n2     sess.run(tf.group(tf.global_variables_initializer(), tf.local_variables_initializer()))\n3     print(sess.run(g))\n4\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/contextlib.pyc in enter(self)\n15     def enter(self):\n16         try:\n---> 17             return self.gen.next()\n18         except StopIteration:\n19             raise RuntimeError(\"generator didn't yield\")\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in managed_session(self, master, config, start_standard_services, close_summary_writer)\n971         # threads which are not checking for should_stop().  They\n972         # will be stopped when we close the session further down.\n--> 973         self.stop(close_summary_writer=close_summary_writer)\n974       finally:\n975         # Close the session to finish up all pending calls.  We do not care\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in stop(self, threads, close_summary_writer)\n799       # reported.\n800       self._coord.join(threads,\n--> 801                        stop_grace_period_secs=self._stop_grace_secs)\n802     finally:\n803       # Close the writer last, in case one of the running threads was using it.\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/coordinator.pyc in join(self, threads, stop_grace_period_secs)\n384       self._registered_threads = set()\n385       if self._exc_info_to_raise:\n--> 386         six.reraise(*self._exc_info_to_raise)\n387       elif stragglers:\n388         raise RuntimeError(\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in managed_session(self, master, config, start_standard_services, close_summary_writer)\n960       sess = self.prepare_or_wait_for_session(\n961           master=master, config=config,\n--> 962           start_standard_services=start_standard_services)\n963       yield sess\n964     except Exception as e:\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in prepare_or_wait_for_session(self, master, config, wait_for_checkpoint, max_wait_secs, start_standard_services)\n717           checkpoint_dir=self._logdir, wait_for_checkpoint=wait_for_checkpoint,\n718           max_wait_secs=max_wait_secs, config=config,\n--> 719           init_feed_dict=self._init_feed_dict, init_fn=self._init_fn)\n720       self._write_graph()\n721       if start_standard_services:\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.pyc in prepare_session(self, master, init_op, saver, checkpoint_dir, checkpoint_filename_with_path, wait_for_checkpoint, max_wait_secs, config, init_feed_dict, init_fn)\n262         sess.run(init_op, feed_dict=init_feed_dict)\n263       if init_fn:\n--> 264         init_fn(sess)\n265\n266     local_init_success, msg = self._try_run_local_init_op(sess)\n in pre_load(sess)\n1 def pre_load(sess):\n2     print(\"load\")\n----> 3     sess.run(g.assign(1))\n4\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/ops/variables.pyc in assign(self, value, use_locking)\n549       the assignment has completed.\n550     \"\"\"\n--> 551     return state_ops.assign(self._variable, value, use_locking=use_locking)\n552\n553   def assign_add(self, delta, use_locking=False):\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/ops/gen_state_ops.pyc in assign(ref, value, validate_shape, use_locking, name)\n45   result = _op_def_lib.apply_op(\"Assign\", ref=ref, value=value,\n46                                 validate_shape=validate_shape,\n---> 47                                 use_locking=use_locking, name=name)\n48   return result\n49\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.pyc in apply_op(self, op_type_name, name, **keywords)\n489                 dtype=dtype,\n490                 as_ref=input_arg.is_ref,\n--> 491                 preferred_dtype=default_dtype)\n492           except TypeError as err:\n493             if dtype is None:\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in internal_convert_to_tensor(value, dtype, name, as_ref, preferred_dtype)\n714\n715         if ret is None:\n--> 716           ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n717\n718         if ret is NotImplemented:\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyc in _constant_tensor_conversion_function(v, dtype, name, as_ref)\n174                                          as_ref=False):\n175   _ = as_ref\n--> 176   return constant(v, dtype=dtype, name=name)\n177\n178\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyc in constant(value, dtype, shape, name, verify_shape)\n167   const_tensor = g.create_op(\n168       \"Const\", [], [dtype_value.type],\n--> 169       attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]\n170   return const_tensor\n171\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in create_op(self, op_type, inputs, dtypes, input_types, name, attrs, op_def, compute_shapes, compute_device)\n2352\n2353     \"\"\"\n-> 2354     self._check_not_finalized()\n2355     for idx, a in enumerate(inputs):\n2356       if not isinstance(a, Tensor):\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in _check_not_finalized(self)\n2075     \"\"\"\n2076     if self._finalized:\n-> 2077       raise RuntimeError(\"Graph is finalized and cannot be modified.\")\n2078\n2079   def _add_op(self, op):\nRuntimeError: Graph is finalized and cannot be modified.", "body": "In [1]: import tensorflow as tf\r\n\r\nIn [2]: g = tf.Variable(0, name=\"g\")\r\n\r\nIn [3]: def pre_load(sess):\r\n   ...:     print(\"load\")\r\n   ...:     sess.run(g.assign(1))\r\n   ...:\r\n\r\nIn [4]: sv = tf.train.Supervisor(logdir=\"/tmp/2/\", init_fn=pre_load)\r\n\r\nIn [5]: with sv.managed_session() as sess:\r\n   ...:     sess.run(tf.group(tf.global_variables_initializer(), tf.local_variables_initializer()))\r\n   ...:     print(sess.run(g))\r\n\r\nwhen I run this code in ipython,\r\nI got an execption below\r\nINFO:tensorflow:Error reported to Coordinator: <type 'exceptions.RuntimeError'>, Graph is finalized and cannot be modified.\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-5-a3cd6e10e8d0> in <module>()\r\n----> 1 with sv.managed_session() as sess:\r\n      2     sess.run(tf.group(tf.global_variables_initializer(), tf.local_variables_initializer()))\r\n      3     print(sess.run(g))\r\n      4\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/contextlib.pyc in __enter__(self)\r\n     15     def __enter__(self):\r\n     16         try:\r\n---> 17             return self.gen.next()\r\n     18         except StopIteration:\r\n     19             raise RuntimeError(\"generator didn't yield\")\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in managed_session(self, master, config, start_standard_services, close_summary_writer)\r\n    971         # threads which are not checking for `should_stop()`.  They\r\n    972         # will be stopped when we close the session further down.\r\n--> 973         self.stop(close_summary_writer=close_summary_writer)\r\n    974       finally:\r\n    975         # Close the session to finish up all pending calls.  We do not care\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in stop(self, threads, close_summary_writer)\r\n    799       # reported.\r\n    800       self._coord.join(threads,\r\n--> 801                        stop_grace_period_secs=self._stop_grace_secs)\r\n    802     finally:\r\n    803       # Close the writer last, in case one of the running threads was using it.\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/coordinator.pyc in join(self, threads, stop_grace_period_secs)\r\n    384       self._registered_threads = set()\r\n    385       if self._exc_info_to_raise:\r\n--> 386         six.reraise(*self._exc_info_to_raise)\r\n    387       elif stragglers:\r\n    388         raise RuntimeError(\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in managed_session(self, master, config, start_standard_services, close_summary_writer)\r\n    960       sess = self.prepare_or_wait_for_session(\r\n    961           master=master, config=config,\r\n--> 962           start_standard_services=start_standard_services)\r\n    963       yield sess\r\n    964     except Exception as e:\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/supervisor.pyc in prepare_or_wait_for_session(self, master, config, wait_for_checkpoint, max_wait_secs, start_standard_services)\r\n    717           checkpoint_dir=self._logdir, wait_for_checkpoint=wait_for_checkpoint,\r\n    718           max_wait_secs=max_wait_secs, config=config,\r\n--> 719           init_feed_dict=self._init_feed_dict, init_fn=self._init_fn)\r\n    720       self._write_graph()\r\n    721       if start_standard_services:\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.pyc in prepare_session(self, master, init_op, saver, checkpoint_dir, checkpoint_filename_with_path, wait_for_checkpoint, max_wait_secs, config, init_feed_dict, init_fn)\r\n    262         sess.run(init_op, feed_dict=init_feed_dict)\r\n    263       if init_fn:\r\n--> 264         init_fn(sess)\r\n    265\r\n    266     local_init_success, msg = self._try_run_local_init_op(sess)\r\n\r\n<ipython-input-3-65858289aa25> in pre_load(sess)\r\n      1 def pre_load(sess):\r\n      2     print(\"load\")\r\n----> 3     sess.run(g.assign(1))\r\n      4\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/ops/variables.pyc in assign(self, value, use_locking)\r\n    549       the assignment has completed.\r\n    550     \"\"\"\r\n--> 551     return state_ops.assign(self._variable, value, use_locking=use_locking)\r\n    552\r\n    553   def assign_add(self, delta, use_locking=False):\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/ops/gen_state_ops.pyc in assign(ref, value, validate_shape, use_locking, name)\r\n     45   result = _op_def_lib.apply_op(\"Assign\", ref=ref, value=value,\r\n     46                                 validate_shape=validate_shape,\r\n---> 47                                 use_locking=use_locking, name=name)\r\n     48   return result\r\n     49\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.pyc in apply_op(self, op_type_name, name, **keywords)\r\n    489                 dtype=dtype,\r\n    490                 as_ref=input_arg.is_ref,\r\n--> 491                 preferred_dtype=default_dtype)\r\n    492           except TypeError as err:\r\n    493             if dtype is None:\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in internal_convert_to_tensor(value, dtype, name, as_ref, preferred_dtype)\r\n    714\r\n    715         if ret is None:\r\n--> 716           ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n    717\r\n    718         if ret is NotImplemented:\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyc in _constant_tensor_conversion_function(v, dtype, name, as_ref)\r\n    174                                          as_ref=False):\r\n    175   _ = as_ref\r\n--> 176   return constant(v, dtype=dtype, name=name)\r\n    177\r\n    178\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyc in constant(value, dtype, shape, name, verify_shape)\r\n    167   const_tensor = g.create_op(\r\n    168       \"Const\", [], [dtype_value.type],\r\n--> 169       attrs={\"value\": tensor_value, \"dtype\": dtype_value}, name=name).outputs[0]\r\n    170   return const_tensor\r\n    171\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in create_op(self, op_type, inputs, dtypes, input_types, name, attrs, op_def, compute_shapes, compute_device)\r\n   2352\r\n   2353     \"\"\"\r\n-> 2354     self._check_not_finalized()\r\n   2355     for idx, a in enumerate(inputs):\r\n   2356       if not isinstance(a, Tensor):\r\n\r\n/Users/lonica/anaconda3/envs/py2/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in _check_not_finalized(self)\r\n   2075     \"\"\"\r\n   2076     if self._finalized:\r\n-> 2077       raise RuntimeError(\"Graph is finalized and cannot be modified.\")\r\n   2078\r\n   2079   def _add_op(self, op):\r\n\r\nRuntimeError: Graph is finalized and cannot be modified."}