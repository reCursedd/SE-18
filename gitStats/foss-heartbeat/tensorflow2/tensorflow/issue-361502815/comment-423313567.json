{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/423313567", "html_url": "https://github.com/tensorflow/tensorflow/issues/22362#issuecomment-423313567", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22362", "id": 423313567, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzMxMzU2Nw==", "user": {"login": "okdzhimiev", "id": 7122484, "node_id": "MDQ6VXNlcjcxMjI0ODQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/7122484?v=4", "gravatar_id": "", "url": "https://api.github.com/users/okdzhimiev", "html_url": "https://github.com/okdzhimiev", "followers_url": "https://api.github.com/users/okdzhimiev/followers", "following_url": "https://api.github.com/users/okdzhimiev/following{/other_user}", "gists_url": "https://api.github.com/users/okdzhimiev/gists{/gist_id}", "starred_url": "https://api.github.com/users/okdzhimiev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/okdzhimiev/subscriptions", "organizations_url": "https://api.github.com/users/okdzhimiev/orgs", "repos_url": "https://api.github.com/users/okdzhimiev/repos", "events_url": "https://api.github.com/users/okdzhimiev/events{/privacy}", "received_events_url": "https://api.github.com/users/okdzhimiev/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-20T20:00:28Z", "updated_at": "2018-09-20T20:00:28Z", "author_association": "NONE", "body_html": "<p>Yes, that extra operation is:<br>\n<code>sess.run(tf.local_variables_initializer())</code></p>\n<p>Just tested - your suggestion works - Java will read the saved-in-python-model w/o errors:</p>\n<div class=\"highlight highlight-source-python\"><pre>builder <span class=\"pl-k\">=</span> tf.saved_model.builder.SavedModelBuilder(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>somedir<span class=\"pl-pds\">'</span></span>)\nbuilder.add_meta_graph_and_variables(sess,[tf.saved_model.tag_constants.<span class=\"pl-c1\">SERVING</span>],<span class=\"pl-v\">main_op</span><span class=\"pl-k\">=</span>tf.local_variables_initializer())\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> builder.add_meta_graph_and_variables(sess,[tf.saved_model.tag_constants.SERVING])</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> builder.save(True)</span>\nbuilder.save(<span class=\"pl-c1\">False</span>) <span class=\"pl-c\"><span class=\"pl-c\">#</span> True = *.pbtxt, False = *.pb</span></pre></div>\n<p>log output:</p>\n<pre><code>2018-09-20 13:48:40.812262: I tensorflow/cc/saved_model/loader.cc:90] Running MainOp on SavedModel bundle.\n</code></pre>\n<p>Thanks.</p>", "body_text": "Yes, that extra operation is:\nsess.run(tf.local_variables_initializer())\nJust tested - your suggestion works - Java will read the saved-in-python-model w/o errors:\nbuilder = tf.saved_model.builder.SavedModelBuilder('somedir')\nbuilder.add_meta_graph_and_variables(sess,[tf.saved_model.tag_constants.SERVING],main_op=tf.local_variables_initializer())\n# builder.add_meta_graph_and_variables(sess,[tf.saved_model.tag_constants.SERVING])\n# builder.save(True)\nbuilder.save(False) # True = *.pbtxt, False = *.pb\nlog output:\n2018-09-20 13:48:40.812262: I tensorflow/cc/saved_model/loader.cc:90] Running MainOp on SavedModel bundle.\n\nThanks.", "body": "Yes, that extra operation is:\r\n`sess.run(tf.local_variables_initializer())`\r\n\r\nJust tested - your suggestion works - Java will read the saved-in-python-model w/o errors:\r\n```python\r\nbuilder = tf.saved_model.builder.SavedModelBuilder('somedir')\r\nbuilder.add_meta_graph_and_variables(sess,[tf.saved_model.tag_constants.SERVING],main_op=tf.local_variables_initializer())\r\n# builder.add_meta_graph_and_variables(sess,[tf.saved_model.tag_constants.SERVING])\r\n# builder.save(True)\r\nbuilder.save(False) # True = *.pbtxt, False = *.pb\r\n```\r\nlog output:\r\n```\r\n2018-09-20 13:48:40.812262: I tensorflow/cc/saved_model/loader.cc:90] Running MainOp on SavedModel bundle.\r\n```\r\nThanks.\r\n"}