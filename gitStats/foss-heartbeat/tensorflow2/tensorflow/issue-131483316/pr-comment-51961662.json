{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/51961662", "pull_request_review_id": null, "id": 51961662, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTYxNjYy", "diff_hunk": "@@ -0,0 +1,204 @@\n+#!/usr/bin/env bash\n+# Copyright 2016 Google Inc. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+# ==============================================================================\n+#\n+# Usage:\n+#   ci_parameterized_build.sh\n+#\n+# The script obeys the following required environment variables:\n+#   TF_BUILD_CONTAINER_TYPE:   (CPU | GPU | ANDROID)\n+#   TF_BUILD_PYTHON_VERSION:   (PYTHON2 | PYTHON3)\n+#   TF_BUILD_IS_OPT:           (NO_OPT | OPT)\n+#   TF_BUILD_IS_PIP:           (NO_PIP | PIP)\n+#\n+# Note: certain combinations of parameter values are regarded\n+# as invalid and will cause the script to exit with code 0. For example:\n+#   NO_OPT & PIP     (PIP builds should always use OPT)\n+#   ANDROID & PIP    (Android and PIP builds are mutually exclusive)\n+#\n+# Additionally, the script follows the directions of optional environment\n+# variables:\n+#   TF_BUILD_DRY_RUN:  If it is set to any non-empty value that is not \"0\",\n+#                      the script will just generate and print the final\n+#                      command, but not actually run it.\n+#   TF_BUILD_APPEND_CI_DOCKER_EXTRA_PARAMS:\n+#                      String appended to the content of CI_DOCKER_EXTRA_PARAMS\n+#   TF_BUILD_APPEND_ARGUMENTS:\n+#                      Additional command line arguments for the bazel,\n+#                      pip.sh or android.sh command\n+#   TF_BUILD_BAZEL_TARGET:\n+#                      Used to override the default bazel build target:\n+#                      //tensorflow/...\n+#\n+# This script can be used by Jenkins parameterized / matrix builds.\n+\n+# Helper function: Convert to lower case\n+to_lower () {\n+  echo \"$1\" | tr '[:upper:]' '[:lower:]'\n+}\n+\n+# Helper function: Strip leading and trailing whitespaces\n+str_strip () {\n+  echo -e \"$1\" | sed -e 's/^[[:space:]]*//' -e 's/[[:space:]]*$//'\n+}\n+\n+\n+##########################################################\n+# Default configuration\n+CI_BUILD_DIR=\"tensorflow/tools/ci_build\"\n+\n+# Command to call when Docker is available\n+DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/ci_build.sh\"\n+# Command to call when Docker is unavailable\n+NO_DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/builds/configured\"\n+\n+# Additional option flags to apply when Docker is unavailable (e.g., on Mac)\n+NO_DOCKER_OPT_FLAG=\"-j 1 --genrule_strategy=standalone \"\\", "path": "tensorflow/tools/ci_build/ci_parameterized_build.sh", "position": null, "original_position": 68, "commit_id": "84a6dfd7f28b29ddd513811ef48d7ed82b2d7e65", "original_commit_id": "64a334fb6f71fb9d30e0baa35d8e8681be404159", "user": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "body": "If it works, let's omit the -j1.\n\nOn Thu, Feb 4, 2016 at 4:33 PM Jan Prach notifications@github.com wrote:\n\n> In tensorflow/tools/ci_build/ci_parameterized_build.sh\n> https://github.com/tensorflow/tensorflow/pull/998#discussion_r51961149:\n> \n> > +str_strip () {\n> > -  echo -e \"$1\" | sed -e 's/^[[:space:]]_//' -e 's/[[:space:]]_$//'\n> >   +}\n> >   +\n> >   +\n> >   +##########################################################\n> >   +# Default configuration\n> >   +CI_BUILD_DIR=\"tensorflow/tools/ci_build\"\n> >   +\n> >   +# Command to call when Docker is available\n> >   +DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/ci_build.sh\"\n> >   +# Command to call when Docker is unavailable\n> >   +NO_DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/builds/configured\"\n> >   +\n> >   +# Additional option flags to apply when Docker is unavailable (e.g., on Mac)\n> >   +NO_DOCKER_OPT_FLAG=\"-j 1 --genrule_strategy=standalone \"\\\n> \n> Do we need these arguments outside of mac? Why just one job? It will take\n> forever to build, will it not? And why the other two?\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/tensorflow/tensorflow/pull/998/files#r51961149.\n", "created_at": "2016-02-05T00:40:08Z", "updated_at": "2016-02-05T21:48:51Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/998#discussion_r51961662", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/998", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/51961662"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/998#discussion_r51961662"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/998"}}, "body_html": "<p>If it works, let's omit the -j1.</p>\n<p>On Thu, Feb 4, 2016 at 4:33 PM Jan Prach <a href=\"mailto:notifications@github.com\">notifications@github.com</a> wrote:</p>\n<blockquote>\n<p>In tensorflow/tools/ci_build/ci_parameterized_build.sh<br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"131483316\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/998\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/998/hovercard?comment_id=51961149&amp;comment_type=review_comment\" href=\"https://github.com/tensorflow/tensorflow/pull/998#discussion_r51961149\">#998 (comment)</a>:</p>\n<blockquote>\n<p>+str_strip () {</p>\n<ul>\n<li>echo -e \"$1\" | sed -e 's/^[[:space:]]<em>//' -e 's/[[:space:]]</em>$//'<br>\n+}</li>\n</ul>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>+##########################################################<br>\n+# Default configuration<br>\n+CI_BUILD_DIR=\"tensorflow/tools/ci_build\"<br>\n+<br>\n+# Command to call when Docker is available<br>\n+DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/ci_build.sh\"<br>\n+# Command to call when Docker is unavailable<br>\n+NO_DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/builds/configured\"<br>\n+<br>\n+# Additional option flags to apply when Docker is unavailable (e.g., on Mac)<br>\n+NO_DOCKER_OPT_FLAG=\"-j 1 --genrule_strategy=standalone \"\\</p>\n</blockquote>\n<p>Do we need these arguments outside of mac? Why just one job? It will take<br>\nforever to build, will it not? And why the other two?</p>\n<p>\u2014<br>\nReply to this email directly or view it on GitHub<br>\n<a href=\"https://github.com/tensorflow/tensorflow/pull/998/files#r51961149\">https://github.com/tensorflow/tensorflow/pull/998/files#r51961149</a>.</p>\n</blockquote>", "body_text": "If it works, let's omit the -j1.\nOn Thu, Feb 4, 2016 at 4:33 PM Jan Prach notifications@github.com wrote:\n\nIn tensorflow/tools/ci_build/ci_parameterized_build.sh\n#998 (comment):\n\n+str_strip () {\n\necho -e \"$1\" | sed -e 's/^[[:space:]]//' -e 's/[[:space:]]$//'\n+}\n\n\n\n\n\n+##########################################################\n+# Default configuration\n+CI_BUILD_DIR=\"tensorflow/tools/ci_build\"\n+\n+# Command to call when Docker is available\n+DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/ci_build.sh\"\n+# Command to call when Docker is unavailable\n+NO_DOCKER_MAIN_CMD=\"${CI_BUILD_DIR}/builds/configured\"\n+\n+# Additional option flags to apply when Docker is unavailable (e.g., on Mac)\n+NO_DOCKER_OPT_FLAG=\"-j 1 --genrule_strategy=standalone \"\\\n\nDo we need these arguments outside of mac? Why just one job? It will take\nforever to build, will it not? And why the other two?\n\u2014\nReply to this email directly or view it on GitHub\nhttps://github.com/tensorflow/tensorflow/pull/998/files#r51961149."}