{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6682", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6682/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6682/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6682/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6682", "id": 199136431, "node_id": "MDU6SXNzdWUxOTkxMzY0MzE=", "number": 6682, "title": "Weird behavior of tf.tensordot when shapes are partly known", "user": {"login": "jihunchoi", "id": 1898501, "node_id": "MDQ6VXNlcjE4OTg1MDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1898501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jihunchoi", "html_url": "https://github.com/jihunchoi", "followers_url": "https://api.github.com/users/jihunchoi/followers", "following_url": "https://api.github.com/users/jihunchoi/following{/other_user}", "gists_url": "https://api.github.com/users/jihunchoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/jihunchoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jihunchoi/subscriptions", "organizations_url": "https://api.github.com/users/jihunchoi/orgs", "repos_url": "https://api.github.com/users/jihunchoi/repos", "events_url": "https://api.github.com/users/jihunchoi/events{/privacy}", "received_events_url": "https://api.github.com/users/jihunchoi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2017-01-06T06:55:05Z", "updated_at": "2017-06-16T19:23:49Z", "closed_at": "2017-06-16T19:23:49Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I frequently use <code>tf.tensordot</code>, for its flexibility on axes.<br>\nHowever, as I multiply two tensors whose shapes are partly known, it cannot infer the shape of the result tensor, i.e. shape is <code>&lt;unknown&gt;</code>, while other alternative functions that do the same operation infer shapes well.</p>\n<p>For example, let <code>a</code> and <code>b</code> be</p>\n<pre><code>a = tf.placeholder('float32', shape=[None, 100])\nb = tf.placeholder('float32', shape=[100, 300])\n</code></pre>\n<p>We can validate that the below functions infer shapes well.</p>\n<pre><code>result_matmul = tf.matmul(a, b)\nresult_matmul.get_shape().as_list()  # [None, 300]\n\nresult_einsum = tf.einsum('ij,jk-&gt;ik', a, b)\nresult_einsum.get_shape().as_list()  # [None, 300]\n</code></pre>\n<p>However, when <code>tf.tensordot</code> is used, the weird result occurs:</p>\n<pre><code>result_tensordot = tf.tensordot(a, b, axes=[[1], [0]])\nresult_tensordot.get_shape()  # TensorShape(None)\nresult_tensordot.get_shape().as_list()  # Error\n</code></pre>\n<p>Thus, I have to call <code>set_shape(shape)</code> function explicitly to make the output be able to be used for further operations.</p>\n<p>There also exists an issue that it still uses <code>concat</code> function, where the warning that it would be deprecated after 2016-12-14 occurs, instead of <code>concat_v2</code>.</p>", "body_text": "I frequently use tf.tensordot, for its flexibility on axes.\nHowever, as I multiply two tensors whose shapes are partly known, it cannot infer the shape of the result tensor, i.e. shape is <unknown>, while other alternative functions that do the same operation infer shapes well.\nFor example, let a and b be\na = tf.placeholder('float32', shape=[None, 100])\nb = tf.placeholder('float32', shape=[100, 300])\n\nWe can validate that the below functions infer shapes well.\nresult_matmul = tf.matmul(a, b)\nresult_matmul.get_shape().as_list()  # [None, 300]\n\nresult_einsum = tf.einsum('ij,jk->ik', a, b)\nresult_einsum.get_shape().as_list()  # [None, 300]\n\nHowever, when tf.tensordot is used, the weird result occurs:\nresult_tensordot = tf.tensordot(a, b, axes=[[1], [0]])\nresult_tensordot.get_shape()  # TensorShape(None)\nresult_tensordot.get_shape().as_list()  # Error\n\nThus, I have to call set_shape(shape) function explicitly to make the output be able to be used for further operations.\nThere also exists an issue that it still uses concat function, where the warning that it would be deprecated after 2016-12-14 occurs, instead of concat_v2.", "body": "I frequently use ```tf.tensordot```, for its flexibility on axes.\r\nHowever, as I multiply two tensors whose shapes are partly known, it cannot infer the shape of the result tensor, i.e. shape is `<unknown>`, while other alternative functions that do the same operation infer shapes well.\r\n\r\nFor example, let `a` and `b` be\r\n```\r\na = tf.placeholder('float32', shape=[None, 100])\r\nb = tf.placeholder('float32', shape=[100, 300])\r\n```\r\n\r\nWe can validate that the below functions infer shapes well.\r\n```\r\nresult_matmul = tf.matmul(a, b)\r\nresult_matmul.get_shape().as_list()  # [None, 300]\r\n\r\nresult_einsum = tf.einsum('ij,jk->ik', a, b)\r\nresult_einsum.get_shape().as_list()  # [None, 300]\r\n```\r\n\r\nHowever, when `tf.tensordot` is used, the weird result occurs:\r\n```\r\nresult_tensordot = tf.tensordot(a, b, axes=[[1], [0]])\r\nresult_tensordot.get_shape()  # TensorShape(None)\r\nresult_tensordot.get_shape().as_list()  # Error\r\n```\r\nThus, I have to call `set_shape(shape)` function explicitly to make the output be able to be used for further operations.\r\n\r\nThere also exists an issue that it still uses `concat` function, where the warning that it would be deprecated after 2016-12-14 occurs, instead of `concat_v2`."}