{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15103", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15103/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15103/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15103/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15103", "id": 279123381, "node_id": "MDU6SXNzdWUyNzkxMjMzODE=", "number": 15103, "title": "No GPU OpKernel for tf.exp() operation for Complex64", "user": {"login": "VinceMarron", "id": 24817118, "node_id": "MDQ6VXNlcjI0ODE3MTE4", "avatar_url": "https://avatars3.githubusercontent.com/u/24817118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VinceMarron", "html_url": "https://github.com/VinceMarron", "followers_url": "https://api.github.com/users/VinceMarron/followers", "following_url": "https://api.github.com/users/VinceMarron/following{/other_user}", "gists_url": "https://api.github.com/users/VinceMarron/gists{/gist_id}", "starred_url": "https://api.github.com/users/VinceMarron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VinceMarron/subscriptions", "organizations_url": "https://api.github.com/users/VinceMarron/orgs", "repos_url": "https://api.github.com/users/VinceMarron/repos", "events_url": "https://api.github.com/users/VinceMarron/events{/privacy}", "received_events_url": "https://api.github.com/users/VinceMarron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2017-12-04T19:43:46Z", "updated_at": "2018-07-20T21:12:31Z", "closed_at": "2017-12-15T19:54:38Z", "author_association": "NONE", "body_html": "<p>I am running tensorflow 1.4.0 from nightly build ('v1.3.0-rc1-5297-g4b7d79b6ea'  on ubuntu 16.04). I've had success working in eager mode (great job with this guys!) however I think I found a small bug:</p>\n<p>It seems that there is no OpKernel on device='GPU'  for the tf.exp() operation applied to complex numbers in eager mode.  This can be reproduced with the below code:</p>\n<pre><code>import tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution()\n\nwith tf.device('/gpu:0'):\n  g = tf.spectral.rfft(tf.ones(64))\n  \n  tf.exp(g)\n</code></pre>\n<p>which results in</p>\n<pre lang=\"NotFoundError:\" data-meta=\"No registered 'Exp' OpKernel for GPU devices compatible with node Exp = Exp[T=DT_COMPLEX64](dummy_input)\"><code>\t (OpKernel was found, but attributes didn't match)\n\t.  Registered:  device='CPU'; T in [DT_COMPLEX128]\n  device='CPU'; T in [DT_COMPLEX64]\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_FLOAT]\n  device='GPU'; T in [DT_DOUBLE]\n  device='GPU'; T in [DT_HALF]\n  device='GPU'; T in [DT_FLOAT]\n [Op:Exp]\n</code></pre>\n<p>a more practical example that would lead to this same error:</p>\n<pre><code>import tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution(device_policy=tfe.DEVICE_PLACEMENT_SILENT)\n\nframe_length=256\nframe_step=64\nn_mels = 64\nsr=16000\nfilename = 'path/to/a.wav'\n\nsome_signal = tf.contrib.ffmpeg.decode_audio(tf.read_file(filename), \n                                     file_format='wav', \n                                     samples_per_second=16000, \n                                     channel_count=1)\n\nwith tf.device('/gpu:0'):\n  stft = tf.contrib.signal.stft(tf.transpose(some_signal), frame_length=frame_length, \n                                  frame_step=frame_step, fft_length=frame_length)\n\n  linear_to_mel_weight_matrix = tf.contrib.signal.linear_to_mel_weight_matrix(\n      n_mels, 1+frame_length//2, sr)\n\n  magnitude_spectrograms = tf.abs(stft)\n  log_mel_spec = tf.log(1e-6+ tf.tensordot(magnitude_spectrograms,\n                                           linear_to_mel_weight_matrix, \n                                           axes = [[2], [0]]))\n\n  mfccs = tf.contrib.signal.mfccs_from_log_mel_spectrograms(log_mel_spec)\n</code></pre>\n<p>Keeping operations on CPU works just fine but I figured this would be easy to implement for GPU as well. Thanks</p>", "body_text": "I am running tensorflow 1.4.0 from nightly build ('v1.3.0-rc1-5297-g4b7d79b6ea'  on ubuntu 16.04). I've had success working in eager mode (great job with this guys!) however I think I found a small bug:\nIt seems that there is no OpKernel on device='GPU'  for the tf.exp() operation applied to complex numbers in eager mode.  This can be reproduced with the below code:\nimport tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution()\n\nwith tf.device('/gpu:0'):\n  g = tf.spectral.rfft(tf.ones(64))\n  \n  tf.exp(g)\n\nwhich results in\n\t (OpKernel was found, but attributes didn't match)\n\t.  Registered:  device='CPU'; T in [DT_COMPLEX128]\n  device='CPU'; T in [DT_COMPLEX64]\n  device='CPU'; T in [DT_DOUBLE]\n  device='CPU'; T in [DT_HALF]\n  device='CPU'; T in [DT_FLOAT]\n  device='GPU'; T in [DT_DOUBLE]\n  device='GPU'; T in [DT_HALF]\n  device='GPU'; T in [DT_FLOAT]\n [Op:Exp]\n\na more practical example that would lead to this same error:\nimport tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution(device_policy=tfe.DEVICE_PLACEMENT_SILENT)\n\nframe_length=256\nframe_step=64\nn_mels = 64\nsr=16000\nfilename = 'path/to/a.wav'\n\nsome_signal = tf.contrib.ffmpeg.decode_audio(tf.read_file(filename), \n                                     file_format='wav', \n                                     samples_per_second=16000, \n                                     channel_count=1)\n\nwith tf.device('/gpu:0'):\n  stft = tf.contrib.signal.stft(tf.transpose(some_signal), frame_length=frame_length, \n                                  frame_step=frame_step, fft_length=frame_length)\n\n  linear_to_mel_weight_matrix = tf.contrib.signal.linear_to_mel_weight_matrix(\n      n_mels, 1+frame_length//2, sr)\n\n  magnitude_spectrograms = tf.abs(stft)\n  log_mel_spec = tf.log(1e-6+ tf.tensordot(magnitude_spectrograms,\n                                           linear_to_mel_weight_matrix, \n                                           axes = [[2], [0]]))\n\n  mfccs = tf.contrib.signal.mfccs_from_log_mel_spectrograms(log_mel_spec)\n\nKeeping operations on CPU works just fine but I figured this would be easy to implement for GPU as well. Thanks", "body": "I am running tensorflow 1.4.0 from nightly build ('v1.3.0-rc1-5297-g4b7d79b6ea'  on ubuntu 16.04). I've had success working in eager mode (great job with this guys!) however I think I found a small bug:\r\n\r\nIt seems that there is no OpKernel on device='GPU'  for the tf.exp() operation applied to complex numbers in eager mode.  This can be reproduced with the below code:\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.eager as tfe\r\n\r\ntfe.enable_eager_execution()\r\n\r\nwith tf.device('/gpu:0'):\r\n  g = tf.spectral.rfft(tf.ones(64))\r\n  \r\n  tf.exp(g)\r\n```\r\nwhich results in\r\n```NotFoundError: No registered 'Exp' OpKernel for GPU devices compatible with node Exp = Exp[T=DT_COMPLEX64](dummy_input)\r\n\t (OpKernel was found, but attributes didn't match)\r\n\t.  Registered:  device='CPU'; T in [DT_COMPLEX128]\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_FLOAT]\r\n  device='GPU'; T in [DT_DOUBLE]\r\n  device='GPU'; T in [DT_HALF]\r\n  device='GPU'; T in [DT_FLOAT]\r\n [Op:Exp]\r\n```\r\n\r\na more practical example that would lead to this same error:\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.eager as tfe\r\n\r\ntfe.enable_eager_execution(device_policy=tfe.DEVICE_PLACEMENT_SILENT)\r\n\r\nframe_length=256\r\nframe_step=64\r\nn_mels = 64\r\nsr=16000\r\nfilename = 'path/to/a.wav'\r\n\r\nsome_signal = tf.contrib.ffmpeg.decode_audio(tf.read_file(filename), \r\n                                     file_format='wav', \r\n                                     samples_per_second=16000, \r\n                                     channel_count=1)\r\n\r\nwith tf.device('/gpu:0'):\r\n  stft = tf.contrib.signal.stft(tf.transpose(some_signal), frame_length=frame_length, \r\n                                  frame_step=frame_step, fft_length=frame_length)\r\n\r\n  linear_to_mel_weight_matrix = tf.contrib.signal.linear_to_mel_weight_matrix(\r\n      n_mels, 1+frame_length//2, sr)\r\n\r\n  magnitude_spectrograms = tf.abs(stft)\r\n  log_mel_spec = tf.log(1e-6+ tf.tensordot(magnitude_spectrograms,\r\n                                           linear_to_mel_weight_matrix, \r\n                                           axes = [[2], [0]]))\r\n\r\n  mfccs = tf.contrib.signal.mfccs_from_log_mel_spectrograms(log_mel_spec)\r\n```\r\n\r\nKeeping operations on CPU works just fine but I figured this would be easy to implement for GPU as well. Thanks\r\n"}