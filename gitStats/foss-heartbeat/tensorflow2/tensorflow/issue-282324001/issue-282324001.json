{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15380", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15380/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15380/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15380/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15380", "id": 282324001, "node_id": "MDU6SXNzdWUyODIzMjQwMDE=", "number": 15380, "title": "CMake: external package: PIC option not working", "user": {"login": "myungjoo", "id": 1109011, "node_id": "MDQ6VXNlcjExMDkwMTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/1109011?v=4", "gravatar_id": "", "url": "https://api.github.com/users/myungjoo", "html_url": "https://github.com/myungjoo", "followers_url": "https://api.github.com/users/myungjoo/followers", "following_url": "https://api.github.com/users/myungjoo/following{/other_user}", "gists_url": "https://api.github.com/users/myungjoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/myungjoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/myungjoo/subscriptions", "organizations_url": "https://api.github.com/users/myungjoo/orgs", "repos_url": "https://api.github.com/users/myungjoo/repos", "events_url": "https://api.github.com/users/myungjoo/events{/privacy}", "received_events_url": "https://api.github.com/users/myungjoo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-12-15T05:30:13Z", "updated_at": "2018-01-23T22:53:54Z", "closed_at": "2018-01-23T21:40:45Z", "author_association": "CONTRIBUTOR", "body_html": "<p>In many of external cmake files (<code>/tensorflow/contrib/cmake/external/*.cmake</code>), it tries to turn PIC on and off with:</p>\n<pre><code>      CMAKE_CACHE_ARGS\n                if(tensorflow_ENABLE_POSITION_INDEPENDENT_CODE)\n                        -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON\n                else()\n                        -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF\n                endif()\n</code></pre>\n<p>However, the result (with cmake 3.5) is not what we wanted in CMakeCache:</p>\n<pre><code>CMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF; endif();\n</code></pre>\n<p>Where it should be</p>\n<pre><code>CMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON\n</code></pre>\n<p>because <code>tensorflow_ENABLE_POSITION_INDEPENDENT_CODE</code> is ON.</p>\n<p>This can be corrected by:</p>\n<pre><code>  -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=${tensorflow_ENABLE_POSITION_INDEPENDENT_CODE}\n</code></pre>\n<p>I'll send a PR after some testing along with other fixes (e.g., linking to ZLIB as shared object, not static linking)</p>\n<p>---- update requested from <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=28546240\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tensorflowbutler\">@tensorflowbutler</a> ----<br>\nHave I written custom code: No.<br>\nOS Platform and Distribution: PR-tested at Ubuntu-16.04 and Tizen<br>\nTensorFlow installed from: N/A<br>\nTensorFlow version: github master branch of last week: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/00f8b97fc601381546aea89315dee549bdbbbdfc/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/00f8b97fc601381546aea89315dee549bdbbbdfc\"><tt>00f8b97</tt></a><br>\nBazel version: N/A (doing it without bazel)<br>\nCUDA/cuDNN version: Tizen: 9/7 / Ubuntu: 8/6<br>\nGPU model and memory: Titan Xp<br>\nExact command to reproduce: N/A (it is about build)</p>", "body_text": "In many of external cmake files (/tensorflow/contrib/cmake/external/*.cmake), it tries to turn PIC on and off with:\n      CMAKE_CACHE_ARGS\n                if(tensorflow_ENABLE_POSITION_INDEPENDENT_CODE)\n                        -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON\n                else()\n                        -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF\n                endif()\n\nHowever, the result (with cmake 3.5) is not what we wanted in CMakeCache:\nCMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF; endif();\n\nWhere it should be\nCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON\n\nbecause tensorflow_ENABLE_POSITION_INDEPENDENT_CODE is ON.\nThis can be corrected by:\n  -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=${tensorflow_ENABLE_POSITION_INDEPENDENT_CODE}\n\nI'll send a PR after some testing along with other fixes (e.g., linking to ZLIB as shared object, not static linking)\n---- update requested from @tensorflowbutler ----\nHave I written custom code: No.\nOS Platform and Distribution: PR-tested at Ubuntu-16.04 and Tizen\nTensorFlow installed from: N/A\nTensorFlow version: github master branch of last week: 00f8b97\nBazel version: N/A (doing it without bazel)\nCUDA/cuDNN version: Tizen: 9/7 / Ubuntu: 8/6\nGPU model and memory: Titan Xp\nExact command to reproduce: N/A (it is about build)", "body": "In many of external cmake files (```/tensorflow/contrib/cmake/external/*.cmake```), it tries to turn PIC on and off with:\r\n```\r\n      CMAKE_CACHE_ARGS\r\n                if(tensorflow_ENABLE_POSITION_INDEPENDENT_CODE)\r\n                        -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON\r\n                else()\r\n                        -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF\r\n                endif()\r\n```\r\n\r\nHowever, the result (with cmake 3.5) is not what we wanted in CMakeCache:\r\n```\r\nCMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF; endif();\r\n```\r\nWhere it should be\r\n```\r\nCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON\r\n```\r\nbecause ```tensorflow_ENABLE_POSITION_INDEPENDENT_CODE``` is ON.\r\n\r\nThis can be corrected by:\r\n```\r\n  -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=${tensorflow_ENABLE_POSITION_INDEPENDENT_CODE}\r\n```\r\n\r\nI'll send a PR after some testing along with other fixes (e.g., linking to ZLIB as shared object, not static linking)\r\n\r\n---- update requested from @tensorflowbutler ----\r\nHave I written custom code: No.\r\nOS Platform and Distribution: PR-tested at Ubuntu-16.04 and Tizen\r\nTensorFlow installed from: N/A\r\nTensorFlow version: github master branch of last week: 00f8b97fc601381546aea89315dee549bdbbbdfc\r\nBazel version: N/A (doing it without bazel)\r\nCUDA/cuDNN version: Tizen: 9/7 / Ubuntu: 8/6\r\nGPU model and memory: Titan Xp\r\nExact command to reproduce: N/A (it is about build)"}