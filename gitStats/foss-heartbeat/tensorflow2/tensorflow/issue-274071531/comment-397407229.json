{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/397407229", "html_url": "https://github.com/tensorflow/tensorflow/issues/14572#issuecomment-397407229", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14572", "id": 397407229, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzQwNzIyOQ==", "user": {"login": "surry", "id": 9781018, "node_id": "MDQ6VXNlcjk3ODEwMTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/9781018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/surry", "html_url": "https://github.com/surry", "followers_url": "https://api.github.com/users/surry/followers", "following_url": "https://api.github.com/users/surry/following{/other_user}", "gists_url": "https://api.github.com/users/surry/gists{/gist_id}", "starred_url": "https://api.github.com/users/surry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/surry/subscriptions", "organizations_url": "https://api.github.com/users/surry/orgs", "repos_url": "https://api.github.com/users/surry/repos", "events_url": "https://api.github.com/users/surry/events{/privacy}", "received_events_url": "https://api.github.com/users/surry/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-14T19:13:31Z", "updated_at": "2018-06-14T19:13:31Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I've also noticed this issue when running Tensorboard 1.8.0 with an s3:// path for the logdir. It takes a long time (several minutes) to read .tfevents files that are less than 50 MB.</p>\n<p>Here's a way I think this can be reproduced:</p>\n<ol>\n<li>Put a TF events file from a training run in S3. I used one that was ~43 MB</li>\n<li>Run the following Python code:</li>\n</ol>\n<pre><code>from tensorboard.backend.event_processing.event_file_loader import EventFileLoader\nloader = EventFileLoader('s3://path/to/tfevents/file')\ngenerator = loader.Load()\nfor event in g:\n  continue\n</code></pre>\n<p>This took around 50 minutes to complete with the official TensorFlow 1.8.0 installed via pip. The slowdown is also apparent if you point Tensoboard to a logdir in S3 - the graphs load much more slowly when reading from S3.</p>\n<p>I was looking at the S3 filesystem code and noticed an extra data copy in S3RandomAccessFile::Read(). I removed this and rebuilt TensorFlow. Afterwards, Tensorboard seems to load much faster from S3. This change should also help when loading datasets and checkpoints from S3.</p>\n<p>PR here: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"332524555\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/20034\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/20034/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/20034\">#20034</a></p>", "body_text": "I've also noticed this issue when running Tensorboard 1.8.0 with an s3:// path for the logdir. It takes a long time (several minutes) to read .tfevents files that are less than 50 MB.\nHere's a way I think this can be reproduced:\n\nPut a TF events file from a training run in S3. I used one that was ~43 MB\nRun the following Python code:\n\nfrom tensorboard.backend.event_processing.event_file_loader import EventFileLoader\nloader = EventFileLoader('s3://path/to/tfevents/file')\ngenerator = loader.Load()\nfor event in g:\n  continue\n\nThis took around 50 minutes to complete with the official TensorFlow 1.8.0 installed via pip. The slowdown is also apparent if you point Tensoboard to a logdir in S3 - the graphs load much more slowly when reading from S3.\nI was looking at the S3 filesystem code and noticed an extra data copy in S3RandomAccessFile::Read(). I removed this and rebuilt TensorFlow. Afterwards, Tensorboard seems to load much faster from S3. This change should also help when loading datasets and checkpoints from S3.\nPR here: #20034", "body": "I've also noticed this issue when running Tensorboard 1.8.0 with an s3:// path for the logdir. It takes a long time (several minutes) to read .tfevents files that are less than 50 MB.\r\n\r\nHere's a way I think this can be reproduced:\r\n\r\n1. Put a TF events file from a training run in S3. I used one that was ~43 MB\r\n2. Run the following Python code:\r\n```\r\nfrom tensorboard.backend.event_processing.event_file_loader import EventFileLoader\r\nloader = EventFileLoader('s3://path/to/tfevents/file')\r\ngenerator = loader.Load()\r\nfor event in g:\r\n  continue\r\n```\r\nThis took around 50 minutes to complete with the official TensorFlow 1.8.0 installed via pip. The slowdown is also apparent if you point Tensoboard to a logdir in S3 - the graphs load much more slowly when reading from S3.\r\n\r\nI was looking at the S3 filesystem code and noticed an extra data copy in S3RandomAccessFile::Read(). I removed this and rebuilt TensorFlow. Afterwards, Tensorboard seems to load much faster from S3. This change should also help when loading datasets and checkpoints from S3.\r\n\r\nPR here: https://github.com/tensorflow/tensorflow/pull/20034"}