{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19924", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19924/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19924/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19924/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19924", "id": 331433749, "node_id": "MDU6SXNzdWUzMzE0MzM3NDk=", "number": 19924, "title": "Build from source fails due to function mismatch in MPIServer code", "user": {"login": "emaballarin", "id": 34656580, "node_id": "MDQ6VXNlcjM0NjU2NTgw", "avatar_url": "https://avatars3.githubusercontent.com/u/34656580?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emaballarin", "html_url": "https://github.com/emaballarin", "followers_url": "https://api.github.com/users/emaballarin/followers", "following_url": "https://api.github.com/users/emaballarin/following{/other_user}", "gists_url": "https://api.github.com/users/emaballarin/gists{/gist_id}", "starred_url": "https://api.github.com/users/emaballarin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emaballarin/subscriptions", "organizations_url": "https://api.github.com/users/emaballarin/orgs", "repos_url": "https://api.github.com/users/emaballarin/repos", "events_url": "https://api.github.com/users/emaballarin/events{/privacy}", "received_events_url": "https://api.github.com/users/emaballarin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-06-12T04:33:03Z", "updated_at": "2018-06-13T14:33:45Z", "closed_at": "2018-06-13T14:33:45Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>Context:</h3>\n<p>Trying to build from source, master branch as of 12/06/2018 T 06.00 UTC+2.<br>\nConfigured to build with MPI support, using OpenMPI 3 (compiled from source and already tried and tested, including with older versions of TF, such as the TF master branch from a week ago).</p>\n<p>The error occurs during compilation, preventing it to conclude successfully. Disabling MPI from configure leads to successful build.</p>\n<h3>Error messages (relevant parts):</h3>\n<pre><code>ERROR: [...]/tensorflow/tensorflow/contrib/mpi/BUILD:83:1: C++ compilation of rule '//tensorflow/contrib/mpi:mpi_server_lib' failed (Exit 1)\ntensorflow/contrib/mpi/mpi_server_lib.cc: In member function 'tensorflow::Status tensorflow::MPIServer::Init(tensorflow::ServiceInitFunction, tensorflow::RendezvousMgrCreationFunction)':\ntensorflow/contrib/mpi/mpi_server_lib.cc:57:64: error: no matching function for call to 'tensorflow::MPIServer::Init(tensorflow::ServiceInitFunction&amp;, tensorflow::RendezvousMgrCreationFunction&amp;)'\n   Status s = GrpcServer::Init(service_func, rendezvous_mgr_func);\n                                                                ^\n</code></pre>\n<h3>Debugging steps tried so far:</h3>\n<p>I am not familiar with the codebase, but it seems that the recently introduced feature <em>Collective Ops</em> (commits in <em>Part 8</em>) does add an argument place to non-empty <code>GrpcServer::Init</code> calls in <code>tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc</code>, which is then called in <code>tensorflow/contrib/mpi/mpi_server_lib.cc</code> with a number of arguments not matching any definition.</p>\n<h3>System information (if needed, anyway)</h3>\n<ul>\n<li><strong>Have I written custom code</strong>: Yes, but probably unrelated (<a href=\"https://github.com/tensorflow/tensorflow/commit/191da96863333222768f5ecc3b58de64729346cf.patch\">this</a> and <a href=\"https://github.com/tensorflow/tensorflow/commit/749c3e9bc36c37f2981b635a4022a6f0db5c30f7.patch\">this</a> patches to fix a GCC 8.1-related problem with MPI's streamexecutor);</li>\n<li><strong>OS Platform and Distribution</strong>: Manjaro Linux (ArchLinux);</li>\n<li><strong>TensorFlow installed from</strong>: Source, master branch;</li>\n<li><strong>TensorFlow version</strong>: 1.9-RC0</li>\n<li><strong>Python version</strong>: 3.6.3 (IntelPython)</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.14.1- (@non-git)</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 8.1.1; 7.x for CUDA</li>\n<li><strong>CUDA/cuDNN version</strong>: 9.2/7.1</li>\n<li><strong>GPU model and memory</strong>: Quadro Mobile M1000M (compute capability: 5)</li>\n<li><strong>Exact command to reproduce</strong>: Building from source (<code>/bin/bazel build --config=opt --config=cuda --config=mkl --copt=\"-DEIGEN_USE_VML\" //tensorflow/tools/pip_package:build_pip_package</code> after having configured to use MPI)</li>\n</ul>", "body_text": "Context:\nTrying to build from source, master branch as of 12/06/2018 T 06.00 UTC+2.\nConfigured to build with MPI support, using OpenMPI 3 (compiled from source and already tried and tested, including with older versions of TF, such as the TF master branch from a week ago).\nThe error occurs during compilation, preventing it to conclude successfully. Disabling MPI from configure leads to successful build.\nError messages (relevant parts):\nERROR: [...]/tensorflow/tensorflow/contrib/mpi/BUILD:83:1: C++ compilation of rule '//tensorflow/contrib/mpi:mpi_server_lib' failed (Exit 1)\ntensorflow/contrib/mpi/mpi_server_lib.cc: In member function 'tensorflow::Status tensorflow::MPIServer::Init(tensorflow::ServiceInitFunction, tensorflow::RendezvousMgrCreationFunction)':\ntensorflow/contrib/mpi/mpi_server_lib.cc:57:64: error: no matching function for call to 'tensorflow::MPIServer::Init(tensorflow::ServiceInitFunction&, tensorflow::RendezvousMgrCreationFunction&)'\n   Status s = GrpcServer::Init(service_func, rendezvous_mgr_func);\n                                                                ^\n\nDebugging steps tried so far:\nI am not familiar with the codebase, but it seems that the recently introduced feature Collective Ops (commits in Part 8) does add an argument place to non-empty GrpcServer::Init calls in tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc, which is then called in tensorflow/contrib/mpi/mpi_server_lib.cc with a number of arguments not matching any definition.\nSystem information (if needed, anyway)\n\nHave I written custom code: Yes, but probably unrelated (this and this patches to fix a GCC 8.1-related problem with MPI's streamexecutor);\nOS Platform and Distribution: Manjaro Linux (ArchLinux);\nTensorFlow installed from: Source, master branch;\nTensorFlow version: 1.9-RC0\nPython version: 3.6.3 (IntelPython)\nBazel version (if compiling from source): 0.14.1- (@non-git)\nGCC/Compiler version (if compiling from source): 8.1.1; 7.x for CUDA\nCUDA/cuDNN version: 9.2/7.1\nGPU model and memory: Quadro Mobile M1000M (compute capability: 5)\nExact command to reproduce: Building from source (/bin/bazel build --config=opt --config=cuda --config=mkl --copt=\"-DEIGEN_USE_VML\" //tensorflow/tools/pip_package:build_pip_package after having configured to use MPI)", "body": "### Context:\r\nTrying to build from source, master branch as of 12/06/2018 T 06.00 UTC+2.\r\nConfigured to build with MPI support, using OpenMPI 3 (compiled from source and already tried and tested, including with older versions of TF, such as the TF master branch from a week ago).\r\n\r\nThe error occurs during compilation, preventing it to conclude successfully. Disabling MPI from configure leads to successful build.\r\n\r\n### Error messages (relevant parts):\r\n```\r\nERROR: [...]/tensorflow/tensorflow/contrib/mpi/BUILD:83:1: C++ compilation of rule '//tensorflow/contrib/mpi:mpi_server_lib' failed (Exit 1)\r\ntensorflow/contrib/mpi/mpi_server_lib.cc: In member function 'tensorflow::Status tensorflow::MPIServer::Init(tensorflow::ServiceInitFunction, tensorflow::RendezvousMgrCreationFunction)':\r\ntensorflow/contrib/mpi/mpi_server_lib.cc:57:64: error: no matching function for call to 'tensorflow::MPIServer::Init(tensorflow::ServiceInitFunction&, tensorflow::RendezvousMgrCreationFunction&)'\r\n   Status s = GrpcServer::Init(service_func, rendezvous_mgr_func);\r\n                                                                ^\r\n```\r\n\r\n### Debugging steps tried so far:\r\nI am not familiar with the codebase, but it seems that the recently introduced feature *Collective Ops* (commits in *Part 8*) does add an argument place to non-empty `GrpcServer::Init` calls in `tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc`, which is then called in `tensorflow/contrib/mpi/mpi_server_lib.cc` with a number of arguments not matching any definition.\r\n\r\n### System information (if needed, anyway)\r\n- **Have I written custom code**: Yes, but probably unrelated ([this](https://github.com/tensorflow/tensorflow/commit/191da96863333222768f5ecc3b58de64729346cf.patch) and [this](https://github.com/tensorflow/tensorflow/commit/749c3e9bc36c37f2981b635a4022a6f0db5c30f7.patch) patches to fix a GCC 8.1-related problem with MPI's streamexecutor);\r\n- **OS Platform and Distribution**: Manjaro Linux (ArchLinux);\r\n- **TensorFlow installed from**: Source, master branch;\r\n- **TensorFlow version**: 1.9-RC0\r\n- **Python version**: 3.6.3 (IntelPython)\r\n- **Bazel version (if compiling from source)**: 0.14.1- (@non-git)\r\n- **GCC/Compiler version (if compiling from source)**: 8.1.1; 7.x for CUDA\r\n- **CUDA/cuDNN version**: 9.2/7.1\r\n- **GPU model and memory**: Quadro Mobile M1000M (compute capability: 5)\r\n- **Exact command to reproduce**: Building from source (`/bin/bazel build --config=opt --config=cuda --config=mkl --copt=\"-DEIGEN_USE_VML\" //tensorflow/tools/pip_package:build_pip_package` after having configured to use MPI)"}