{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/162265273", "html_url": "https://github.com/tensorflow/tensorflow/issues/419#issuecomment-162265273", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/419", "id": 162265273, "node_id": "MDEyOklzc3VlQ29tbWVudDE2MjI2NTI3Mw==", "user": {"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}, "created_at": "2015-12-06T02:51:57Z", "updated_at": "2015-12-06T02:51:57Z", "author_association": "MEMBER", "body_html": "<p>Thanks Hamid. I'm guessing this might be a discrepancy between what the<br>\ncompiler expects of API level 21 and what the device provides at level 20.</p>\n<p>I've just tried setting my WORKSPACE ndk api_level to 20 and found that the<br>\nAndroid demo still builds. Could you try the same and see if that corrects<br>\nthe issue?</p>\n<p>On Sat, Dec 5, 2015 at 9:33 PM, Hamid Bazargani <a href=\"mailto:notifications@github.com\">notifications@github.com</a><br>\nwrote:</p>\n<blockquote>\n<p>I followed your instruction. Still no success.<br>\nFollowing is my steps:<br>\n1- changed google/protobuf/BUILD</p>\n<p>// [\"\"] returns bazel error<br>\nLINK_OPTS = []</p>\n<p>2- changed tensorflow/examples/android/BUILD</p>\n<p>cc_library(<br>\nname = \"tensorflow_native_libs\",<br>\nsrcs = glob([\"jni/<strong>/*.cc\"]),<br>\nhdrs = glob([\"jni/</strong>/*.h\"]),<br>\ncopts = [<br>\n\"-std=c++11\",<br>\n\"-mfpu=neon\",<br>\n\"-O2\",<br>\n],<br>\nlinkopts = [\"-llog -landroid -lm -ljnigraphics\"],<br>\ntags = [<br>\n\"manual\",<br>\n\"notap\",<br>\n],<br>\ndeps = [<br>\n#    \":dummy_pthread\", // commented<br>\n\"//tensorflow/core:android_tensorflow_lib\",<br>\n],<br>\n)</p>\n<p>3- My workspace looks:</p>\n<p>android_sdk_repository(<br>\nname = \"androidsdk\",<br>\napi_level = 20,<br>\nbuild_tools_version = \"20.0.0\",<br>\n# Replace with path to Android SDK on your system<br>\npath = \"/hamidb/software/TADP/android-sdk-linux\",<br>\n)<br>\nandroid_ndk_repository(<br>\nname=\"androidndk\",<br>\npath=\"/hamidb/software/TADP/android-ndk-r10c\",<br>\napi_level=21)</p>\n<p>4- I issued (I also tried without android_arm)</p>\n<p>bazel build --verbose_failures<br>\n//tensorflow/examples/android:tensorflow_demo --config=android_arm<br>\nAfter running the apk file my logcat logs:</p>\n<p>--------- beginning of /dev/log/main<br>\nD/Raydium_ts_main( 242): ## Report rate in 10 seconds =1213<br>\nI/art ( 1219): GcCauseBackground partial concurrent mark sweep GC freed<br>\n6011(335KB) AllocSpace objects, 27(1351KB) LOS objects, 12% free, 6MB/7MB,<br>\npaused 5.823ms total 48.435ms<br>\n--------- beginning of /dev/log/system<br>\nI/ActivityManager( 904): START u0 {act=android.intent.action.MAIN<br>\ncat=[android.intent.category.LAUNCHER] flg=0x10200000<br>\ncmp=org.tensorflow.demo/.CameraActivity bnds=[984,1381][1176,1573]} from<br>\npid 1219<br>\nW/art ( 166): Could not get current activity<br>\nI/ActivityManager( 904): Start proc org.tensorflow.demo for activity<br>\norg.tensorflow.demo/.CameraActivity: pid=11918 uid=10073 gids={50073, 1028,<br>\n1015}<br>\nW/NvAppProfileService( 904): App Profiles: Enabled<br>\nI/PowerServiceCient( 904): Successfully bound to service<br>\n<em>E/art (11918):<br>\ndlopen(\"/data/app-lib/org.tensorflow.demo-1/libtensorflow_demo.so\",<br>\nRTLD_LAZY) failed: dlopen failed: cannot locate symbol \"getpagesize\"<br>\nreferenced by \"libtensorflow_demo.so\"...</em><br>\nD/AndroidRuntime(11918): Shutting down VM<br>\nE/AndroidRuntime(11918): FATAL EXCEPTION: main<br>\nE/AndroidRuntime(11918): Process: org.tensorflow.demo, PID: 11918<br>\n<em>E/AndroidRuntime(11918): java.lang.UnsatisfiedLinkError: dlopen failed:<br>\ncannot locate symbol \"getpagesize\" referenced by \"libtensorflow_demo.so\"...</em><br>\nE/AndroidRuntime(11918): at java.lang.Runtime.loadLibrary(Runtime.java:364)<br>\nE/AndroidRuntime(11918): at java.lang.System.loadLibrary(System.java:526)<br>\nE/AndroidRuntime(11918): at<br>\norg.tensorflow.demo.TensorflowClassifier.(TensorflowClassifier.java:46)<br>\nE/AndroidRuntime(11918): at<br>\norg.tensorflow.demo.TensorflowImageListener.(TensorflowImageListener.java:51)<br>\nE/AndroidRuntime(11918): at<br>\norg.tensorflow.demo.CameraConnectionFragment.(CameraConnectionFragment.java:212)<br>\nE/AndroidRuntime(11918): at<br>\norg.tensorflow.demo.CameraConnectionFragment.newInstance(CameraConnectionFragment.java:91)<br>\nE/AndroidRuntime(11918): at<br>\norg.tensorflow.demo.CameraActivity.onCreate(CameraActivity.java:30)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.Activity.performCreate(Activity.java:5231)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1087)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.ActivityThread.performLaunchActivity(ActivityThread.java:2160)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2246)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.ActivityThread.access$800(ActivityThread.java:136)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.ActivityThread$H.handleMessage(ActivityThread.java:1197)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.os.Handler.dispatchMessage(Handler.java:102)<br>\nE/AndroidRuntime(11918): at android.os.Looper.loop(Looper.java:136)<br>\nE/AndroidRuntime(11918): at<br>\nandroid.app.ActivityThread.main(ActivityThread.java:5030)<br>\nE/AndroidRuntime(11918): at java.lang.reflect.Method.invoke(Native Method)<br>\nE/AndroidRuntime(11918): at<br>\ncom.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)<br>\nE/AndroidRuntime(11918): at<br>\ncom.android.internal.os.ZygoteInit.main(ZygoteInit.java:609)<br>\nW/ActivityManager( 904): Force finishing activity<br>\norg.tensorflow.demo/.CameraActivity<br>\nW/ActivityManager( 904): Activity pause timeout for<br>\nActivityRecord{65595fd8 u0 org.tensorflow.demo/.CameraActivity t73 f}<br>\nI/Process (11918): Sending signal. PID: 11918 SIG: 9<br>\nW/InputMethodManagerService( 904): Window already focused, ignoring focus<br>\ngain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@65367aa0<br>\nattribute=null, token = android.os.BinderProxy@651cfa9<br>\n<a href=\"https://github.com/android.os.BinderProxy/tensorflow/commit/651cfa98\">https://github.com/android.os.BinderProxy/tensorflow/commit/651cfa98</a><br>\nI/ActivityManager( 904): Process org.tensorflow.demo (pid 11918) has died.<br>\nD/Raydium_ts_main( 242): ## Report rate in 10 seconds =1038</p>\n<p>\u2014<br>\nReply to this email directly or view it on GitHub<br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"120591969\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/419\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/419/hovercard?comment_id=162264595&amp;comment_type=issue_comment\" href=\"https://github.com/tensorflow/tensorflow/issues/419#issuecomment-162264595\">#419 (comment)</a><br>\n.</p>\n</blockquote>", "body_text": "Thanks Hamid. I'm guessing this might be a discrepancy between what the\ncompiler expects of API level 21 and what the device provides at level 20.\nI've just tried setting my WORKSPACE ndk api_level to 20 and found that the\nAndroid demo still builds. Could you try the same and see if that corrects\nthe issue?\nOn Sat, Dec 5, 2015 at 9:33 PM, Hamid Bazargani notifications@github.com\nwrote:\n\nI followed your instruction. Still no success.\nFollowing is my steps:\n1- changed google/protobuf/BUILD\n// [\"\"] returns bazel error\nLINK_OPTS = []\n2- changed tensorflow/examples/android/BUILD\ncc_library(\nname = \"tensorflow_native_libs\",\nsrcs = glob([\"jni//*.cc\"]),\nhdrs = glob([\"jni//*.h\"]),\ncopts = [\n\"-std=c++11\",\n\"-mfpu=neon\",\n\"-O2\",\n],\nlinkopts = [\"-llog -landroid -lm -ljnigraphics\"],\ntags = [\n\"manual\",\n\"notap\",\n],\ndeps = [\n#    \":dummy_pthread\", // commented\n\"//tensorflow/core:android_tensorflow_lib\",\n],\n)\n3- My workspace looks:\nandroid_sdk_repository(\nname = \"androidsdk\",\napi_level = 20,\nbuild_tools_version = \"20.0.0\",\n# Replace with path to Android SDK on your system\npath = \"/hamidb/software/TADP/android-sdk-linux\",\n)\nandroid_ndk_repository(\nname=\"androidndk\",\npath=\"/hamidb/software/TADP/android-ndk-r10c\",\napi_level=21)\n4- I issued (I also tried without android_arm)\nbazel build --verbose_failures\n//tensorflow/examples/android:tensorflow_demo --config=android_arm\nAfter running the apk file my logcat logs:\n--------- beginning of /dev/log/main\nD/Raydium_ts_main( 242): ## Report rate in 10 seconds =1213\nI/art ( 1219): GcCauseBackground partial concurrent mark sweep GC freed\n6011(335KB) AllocSpace objects, 27(1351KB) LOS objects, 12% free, 6MB/7MB,\npaused 5.823ms total 48.435ms\n--------- beginning of /dev/log/system\nI/ActivityManager( 904): START u0 {act=android.intent.action.MAIN\ncat=[android.intent.category.LAUNCHER] flg=0x10200000\ncmp=org.tensorflow.demo/.CameraActivity bnds=[984,1381][1176,1573]} from\npid 1219\nW/art ( 166): Could not get current activity\nI/ActivityManager( 904): Start proc org.tensorflow.demo for activity\norg.tensorflow.demo/.CameraActivity: pid=11918 uid=10073 gids={50073, 1028,\n1015}\nW/NvAppProfileService( 904): App Profiles: Enabled\nI/PowerServiceCient( 904): Successfully bound to service\nE/art (11918):\ndlopen(\"/data/app-lib/org.tensorflow.demo-1/libtensorflow_demo.so\",\nRTLD_LAZY) failed: dlopen failed: cannot locate symbol \"getpagesize\"\nreferenced by \"libtensorflow_demo.so\"...\nD/AndroidRuntime(11918): Shutting down VM\nE/AndroidRuntime(11918): FATAL EXCEPTION: main\nE/AndroidRuntime(11918): Process: org.tensorflow.demo, PID: 11918\nE/AndroidRuntime(11918): java.lang.UnsatisfiedLinkError: dlopen failed:\ncannot locate symbol \"getpagesize\" referenced by \"libtensorflow_demo.so\"...\nE/AndroidRuntime(11918): at java.lang.Runtime.loadLibrary(Runtime.java:364)\nE/AndroidRuntime(11918): at java.lang.System.loadLibrary(System.java:526)\nE/AndroidRuntime(11918): at\norg.tensorflow.demo.TensorflowClassifier.(TensorflowClassifier.java:46)\nE/AndroidRuntime(11918): at\norg.tensorflow.demo.TensorflowImageListener.(TensorflowImageListener.java:51)\nE/AndroidRuntime(11918): at\norg.tensorflow.demo.CameraConnectionFragment.(CameraConnectionFragment.java:212)\nE/AndroidRuntime(11918): at\norg.tensorflow.demo.CameraConnectionFragment.newInstance(CameraConnectionFragment.java:91)\nE/AndroidRuntime(11918): at\norg.tensorflow.demo.CameraActivity.onCreate(CameraActivity.java:30)\nE/AndroidRuntime(11918): at\nandroid.app.Activity.performCreate(Activity.java:5231)\nE/AndroidRuntime(11918): at\nandroid.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1087)\nE/AndroidRuntime(11918): at\nandroid.app.ActivityThread.performLaunchActivity(ActivityThread.java:2160)\nE/AndroidRuntime(11918): at\nandroid.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2246)\nE/AndroidRuntime(11918): at\nandroid.app.ActivityThread.access$800(ActivityThread.java:136)\nE/AndroidRuntime(11918): at\nandroid.app.ActivityThread$H.handleMessage(ActivityThread.java:1197)\nE/AndroidRuntime(11918): at\nandroid.os.Handler.dispatchMessage(Handler.java:102)\nE/AndroidRuntime(11918): at android.os.Looper.loop(Looper.java:136)\nE/AndroidRuntime(11918): at\nandroid.app.ActivityThread.main(ActivityThread.java:5030)\nE/AndroidRuntime(11918): at java.lang.reflect.Method.invoke(Native Method)\nE/AndroidRuntime(11918): at\ncom.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)\nE/AndroidRuntime(11918): at\ncom.android.internal.os.ZygoteInit.main(ZygoteInit.java:609)\nW/ActivityManager( 904): Force finishing activity\norg.tensorflow.demo/.CameraActivity\nW/ActivityManager( 904): Activity pause timeout for\nActivityRecord{65595fd8 u0 org.tensorflow.demo/.CameraActivity t73 f}\nI/Process (11918): Sending signal. PID: 11918 SIG: 9\nW/InputMethodManagerService( 904): Window already focused, ignoring focus\ngain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@65367aa0\nattribute=null, token = android.os.BinderProxy@651cfa9\nhttps://github.com/android.os.BinderProxy/tensorflow/commit/651cfa98\nI/ActivityManager( 904): Process org.tensorflow.demo (pid 11918) has died.\nD/Raydium_ts_main( 242): ## Report rate in 10 seconds =1038\n\u2014\nReply to this email directly or view it on GitHub\n#419 (comment)\n.", "body": "Thanks Hamid. I'm guessing this might be a discrepancy between what the\ncompiler expects of API level 21 and what the device provides at level 20.\n\nI've just tried setting my WORKSPACE ndk api_level to 20 and found that the\nAndroid demo still builds. Could you try the same and see if that corrects\nthe issue?\n\nOn Sat, Dec 5, 2015 at 9:33 PM, Hamid Bazargani notifications@github.com\nwrote:\n\n> I followed your instruction. Still no success.\n> Following is my steps:\n> 1- changed google/protobuf/BUILD\n> \n> // [\"\"] returns bazel error\n> LINK_OPTS = []\n> \n> 2- changed tensorflow/examples/android/BUILD\n> \n> cc_library(\n>     name = \"tensorflow_native_libs\",\n>     srcs = glob([\"jni/**/*.cc\"]),\n>     hdrs = glob([\"jni/**/*.h\"]),\n>     copts = [\n>         \"-std=c++11\",\n>         \"-mfpu=neon\",\n>         \"-O2\",\n>     ],\n>     linkopts = [\"-llog -landroid -lm -ljnigraphics\"],\n>     tags = [\n>         \"manual\",\n>         \"notap\",\n>     ],\n>     deps = [\n>     #    \":dummy_pthread\", // commented\n>         \"//tensorflow/core:android_tensorflow_lib\",\n>     ],\n> )\n> \n> 3- My workspace looks:\n> \n> android_sdk_repository(\n>     name = \"androidsdk\",\n>     api_level = 20,\n>     build_tools_version = \"20.0.0\",\n>     # Replace with path to Android SDK on your system\n>     path = \"/hamidb/software/TADP/android-sdk-linux\",\n> )\n> android_ndk_repository(\n>     name=\"androidndk\",\n>     path=\"/hamidb/software/TADP/android-ndk-r10c\",\n>     api_level=21)\n> \n> 4- I issued (I also tried without android_arm)\n> \n> bazel build --verbose_failures\n> //tensorflow/examples/android:tensorflow_demo --config=android_arm\n> After running the apk file my logcat logs:\n> \n> --------- beginning of /dev/log/main\n> D/Raydium_ts_main( 242): ## Report rate in 10 seconds =1213\n> I/art ( 1219): GcCauseBackground partial concurrent mark sweep GC freed\n> 6011(335KB) AllocSpace objects, 27(1351KB) LOS objects, 12% free, 6MB/7MB,\n> paused 5.823ms total 48.435ms\n> --------- beginning of /dev/log/system\n> I/ActivityManager( 904): START u0 {act=android.intent.action.MAIN\n> cat=[android.intent.category.LAUNCHER] flg=0x10200000\n> cmp=org.tensorflow.demo/.CameraActivity bnds=[984,1381][1176,1573]} from\n> pid 1219\n> W/art ( 166): Could not get current activity\n> I/ActivityManager( 904): Start proc org.tensorflow.demo for activity\n> org.tensorflow.demo/.CameraActivity: pid=11918 uid=10073 gids={50073, 1028,\n> 1015}\n> W/NvAppProfileService( 904): App Profiles: Enabled\n> I/PowerServiceCient( 904): Successfully bound to service\n> _E/art (11918):\n> dlopen(\"/data/app-lib/org.tensorflow.demo-1/libtensorflow_demo.so\",\n> RTLD_LAZY) failed: dlopen failed: cannot locate symbol \"getpagesize\"\n> referenced by \"libtensorflow_demo.so\"..._\n> D/AndroidRuntime(11918): Shutting down VM\n> E/AndroidRuntime(11918): FATAL EXCEPTION: main\n> E/AndroidRuntime(11918): Process: org.tensorflow.demo, PID: 11918\n> _E/AndroidRuntime(11918): java.lang.UnsatisfiedLinkError: dlopen failed:\n> cannot locate symbol \"getpagesize\" referenced by \"libtensorflow_demo.so\"..._\n> E/AndroidRuntime(11918): at java.lang.Runtime.loadLibrary(Runtime.java:364)\n> E/AndroidRuntime(11918): at java.lang.System.loadLibrary(System.java:526)\n> E/AndroidRuntime(11918): at\n> org.tensorflow.demo.TensorflowClassifier.(TensorflowClassifier.java:46)\n> E/AndroidRuntime(11918): at\n> org.tensorflow.demo.TensorflowImageListener.(TensorflowImageListener.java:51)\n> E/AndroidRuntime(11918): at\n> org.tensorflow.demo.CameraConnectionFragment.(CameraConnectionFragment.java:212)\n> E/AndroidRuntime(11918): at\n> org.tensorflow.demo.CameraConnectionFragment.newInstance(CameraConnectionFragment.java:91)\n> E/AndroidRuntime(11918): at\n> org.tensorflow.demo.CameraActivity.onCreate(CameraActivity.java:30)\n> E/AndroidRuntime(11918): at\n> android.app.Activity.performCreate(Activity.java:5231)\n> E/AndroidRuntime(11918): at\n> android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1087)\n> E/AndroidRuntime(11918): at\n> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2160)\n> E/AndroidRuntime(11918): at\n> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2246)\n> E/AndroidRuntime(11918): at\n> android.app.ActivityThread.access$800(ActivityThread.java:136)\n> E/AndroidRuntime(11918): at\n> android.app.ActivityThread$H.handleMessage(ActivityThread.java:1197)\n> E/AndroidRuntime(11918): at\n> android.os.Handler.dispatchMessage(Handler.java:102)\n> E/AndroidRuntime(11918): at android.os.Looper.loop(Looper.java:136)\n> E/AndroidRuntime(11918): at\n> android.app.ActivityThread.main(ActivityThread.java:5030)\n> E/AndroidRuntime(11918): at java.lang.reflect.Method.invoke(Native Method)\n> E/AndroidRuntime(11918): at\n> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)\n> E/AndroidRuntime(11918): at\n> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:609)\n> W/ActivityManager( 904): Force finishing activity\n> org.tensorflow.demo/.CameraActivity\n> W/ActivityManager( 904): Activity pause timeout for\n> ActivityRecord{65595fd8 u0 org.tensorflow.demo/.CameraActivity t73 f}\n> I/Process (11918): Sending signal. PID: 11918 SIG: 9\n> W/InputMethodManagerService( 904): Window already focused, ignoring focus\n> gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@65367aa0\n> attribute=null, token = android.os.BinderProxy@651cfa9\n> https://github.com/android.os.BinderProxy/tensorflow/commit/651cfa98\n> I/ActivityManager( 904): Process org.tensorflow.demo (pid 11918) has died.\n> D/Raydium_ts_main( 242): ## Report rate in 10 seconds =1038\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/tensorflow/tensorflow/issues/419#issuecomment-162264595\n> .\n"}