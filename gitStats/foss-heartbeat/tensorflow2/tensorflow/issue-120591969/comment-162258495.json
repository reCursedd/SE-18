{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/162258495", "html_url": "https://github.com/tensorflow/tensorflow/issues/419#issuecomment-162258495", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/419", "id": 162258495, "node_id": "MDEyOklzc3VlQ29tbWVudDE2MjI1ODQ5NQ==", "user": {"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}, "created_at": "2015-12-06T00:06:43Z", "updated_at": "2015-12-06T00:06:43Z", "author_association": "MEMBER", "body_html": "<p>Hi Hamid,</p>\n<p>The libpthread.so target is just a kludge to get around the fact that the<br>\nprotobuf library attempts to link it in, despite this not being necessary<br>\n(or possible) on Android.</p>\n<p>A cleaner workaround for you is to edit google/protobuf/BUILD and change<br>\nthe line:</p>\n<p>LINK_OPTS = [\"-lpthread\"]<br>\nto:<br>\nLINK_OPTS = [\"\"]</p>\n<p>Ideally the protobuf linkopts would be dependent on build target, or the<br>\ndummy libpthread.so file could be generated at compile-time so that it<br>\nwould match the target architecture (will look into it).</p>\n<p>On Sat, Dec 5, 2015 at 5:19 PM, Hamid Bazargani <a href=\"mailto:notifications@github.com\">notifications@github.com</a><br>\nwrote:</p>\n<blockquote>\n<p>I tried to build the demo application for Android for KitKat device (API<br>\n20). I was able to modify the app not to use new hardware.camera2 and it<br>\nworked on Android Lollipops successfully. However there is an issue<br>\ntargeting older Android device.<br>\nIt turned out that the app crashes right after trying to load the native<br>\nshared library, tensorflow_demo in my case.<br>\nAnd that's due to dependency of libpthread.so to libmediandk.so that is<br>\nnot supported for API older than 21. See the following logcat message:</p>\n<p>Error: ..dlopen failed: could not load library \"libmediandk.so\" needed by<br>\n\"libtensorflow_demo.so\"; caused by library \"libmediandk.so\" not found</p>\n<p>I also desperately tried to replace the cloned libpthread.so with the<br>\nsame file from my /usr/arm-linux-gnueabi/lib/ directory with no success.<br>\nI am using:<br>\n1- android-ndk-r10c<br>\n2- api_level=20<br>\n3- build_tools_version = \"20.0.0\"</p>\n<p>Did I missed anything in that process?</p>\n<p>\u2014<br>\nReply to this email directly or view it on GitHub<br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"120591969\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/419\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/419/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/419\">#419</a>.</p>\n</blockquote>", "body_text": "Hi Hamid,\nThe libpthread.so target is just a kludge to get around the fact that the\nprotobuf library attempts to link it in, despite this not being necessary\n(or possible) on Android.\nA cleaner workaround for you is to edit google/protobuf/BUILD and change\nthe line:\nLINK_OPTS = [\"-lpthread\"]\nto:\nLINK_OPTS = [\"\"]\nIdeally the protobuf linkopts would be dependent on build target, or the\ndummy libpthread.so file could be generated at compile-time so that it\nwould match the target architecture (will look into it).\nOn Sat, Dec 5, 2015 at 5:19 PM, Hamid Bazargani notifications@github.com\nwrote:\n\nI tried to build the demo application for Android for KitKat device (API\n20). I was able to modify the app not to use new hardware.camera2 and it\nworked on Android Lollipops successfully. However there is an issue\ntargeting older Android device.\nIt turned out that the app crashes right after trying to load the native\nshared library, tensorflow_demo in my case.\nAnd that's due to dependency of libpthread.so to libmediandk.so that is\nnot supported for API older than 21. See the following logcat message:\nError: ..dlopen failed: could not load library \"libmediandk.so\" needed by\n\"libtensorflow_demo.so\"; caused by library \"libmediandk.so\" not found\nI also desperately tried to replace the cloned libpthread.so with the\nsame file from my /usr/arm-linux-gnueabi/lib/ directory with no success.\nI am using:\n1- android-ndk-r10c\n2- api_level=20\n3- build_tools_version = \"20.0.0\"\nDid I missed anything in that process?\n\u2014\nReply to this email directly or view it on GitHub\n#419.", "body": "Hi Hamid,\n\nThe libpthread.so target is just a kludge to get around the fact that the\nprotobuf library attempts to link it in, despite this not being necessary\n(or possible) on Android.\n\nA cleaner workaround for you is to edit google/protobuf/BUILD and change\nthe line:\n\nLINK_OPTS = [\"-lpthread\"]\nto:\nLINK_OPTS = [\"\"]\n\nIdeally the protobuf linkopts would be dependent on build target, or the\ndummy libpthread.so file could be generated at compile-time so that it\nwould match the target architecture (will look into it).\n\nOn Sat, Dec 5, 2015 at 5:19 PM, Hamid Bazargani notifications@github.com\nwrote:\n\n> I tried to build the demo application for Android for KitKat device (API\n> 20). I was able to modify the app not to use new hardware.camera2 and it\n> worked on Android Lollipops successfully. However there is an issue\n> targeting older Android device.\n> It turned out that the app crashes right after trying to load the native\n> shared library, tensorflow_demo in my case.\n> And that's due to dependency of libpthread.so to libmediandk.so that is\n> not supported for API older than 21. See the following logcat message:\n> \n> Error: ..dlopen failed: could not load library \"libmediandk.so\" needed by\n> \"libtensorflow_demo.so\"; caused by library \"libmediandk.so\" not found\n> \n> I also desperately tried to replace the cloned libpthread.so with the\n> same file from my /usr/arm-linux-gnueabi/lib/ directory with no success.\n> I am using:\n> 1- android-ndk-r10c\n> 2- api_level=20\n> 3- build_tools_version = \"20.0.0\"\n> \n> Did I missed anything in that process?\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/tensorflow/tensorflow/issues/419.\n"}