{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/175195825", "pull_request_review_id": 104695216, "id": 175195825, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3NTE5NTgyNQ==", "diff_hunk": "@@ -539,12 +538,23 @@ def norm(tensor,\n \n   with ops.name_scope(name, 'norm', [tensor]):\n     tensor = ops.convert_to_tensor(tensor)\n+    rank = len(tensor.get_shape().as_list())\n+    axis = tuple(map(lambda i: i if i >= 0 else i + rank, axis))\n+\n     if ord in ['fro', 'euclidean', 2, 2.0]:\n-      # TODO(rmlarsen): Move 2-norm to a separate clause once we support it for\n-      # matrices.\n-      result = math_ops.sqrt(\n-          math_ops.reduce_sum(\n-              tensor * math_ops.conj(tensor), axis, keepdims=True))\n+      if is_matrix_norm and ord in [2, 2.0]:\n+        axes = list(range(rank))\n+        perm_before = list(filter(lambda i: i not in axis, axes)) + list(axis)\n+        perm_after = list(map(perm_before.index, axes))\n+        result = array_ops.transpose(array_ops.expand_dims(", "path": "tensorflow/python/ops/linalg_ops.py", "position": null, "original_position": 45, "commit_id": "ed260b6e7f87938eae34de67e4df3ebb36451806", "original_commit_id": "36c43a77b17674c62c9c5b51a953c281ff222b1e", "user": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "body": "No need to write this as a on-liner. Break it into the three natural steps (permute, compute matrix 2-norms, permute back) to make this more readable.", "created_at": "2018-03-16T19:41:24Z", "updated_at": "2018-04-17T08:22:16Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/17740#discussion_r175195825", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17740", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/175195825"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/17740#discussion_r175195825"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17740"}}, "body_html": "<p>No need to write this as a on-liner. Break it into the three natural steps (permute, compute matrix 2-norms, permute back) to make this more readable.</p>", "body_text": "No need to write this as a on-liner. Break it into the three natural steps (permute, compute matrix 2-norms, permute back) to make this more readable."}