{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6384", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6384/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6384/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6384/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6384", "id": 196272459, "node_id": "MDU6SXNzdWUxOTYyNzI0NTk=", "number": 6384, "title": "Error in einsum with unspecified dimensions", "user": {"login": "noammor", "id": 4738203, "node_id": "MDQ6VXNlcjQ3MzgyMDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/4738203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/noammor", "html_url": "https://github.com/noammor", "followers_url": "https://api.github.com/users/noammor/followers", "following_url": "https://api.github.com/users/noammor/following{/other_user}", "gists_url": "https://api.github.com/users/noammor/gists{/gist_id}", "starred_url": "https://api.github.com/users/noammor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/noammor/subscriptions", "organizations_url": "https://api.github.com/users/noammor/orgs", "repos_url": "https://api.github.com/users/noammor/repos", "events_url": "https://api.github.com/users/noammor/events{/privacy}", "received_events_url": "https://api.github.com/users/noammor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2016-12-18T12:13:13Z", "updated_at": "2017-01-07T20:42:08Z", "closed_at": "2017-01-04T23:35:32Z", "author_association": "NONE", "body_html": "<p>Code:</p>\n<pre><code>import tensorflow as tf\n\nx = tf.placeholder(dtype=tf.int32)\n\nA = tf.random_normal([13, x, 512])\nB = tf.random_normal([512, 3])\nC = tf.einsum('ijk,kl-&gt;ijl', A, B)\n\nwith tf.Session() as sess:\n    print(sess.run(C, {x: 7}))\n</code></pre>\n<p>Output:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home/noam/code/test/test_einsum.py\", line 7, in &lt;module&gt;\n    C = tf.einsum('ijk,kl-&gt;ijl', A, B)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 212, in einsum\n    axes_to_sum)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 341, in _einsum_reduction\n    product = _reshape_if_necessary(product, uncompacted_shape)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 366, in _reshape_if_necessary\n    return array_ops.reshape(tensor, new_shape)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2448, in reshape\n    name=name)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\n    raise err\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 490, in apply_op\n    preferred_dtype=default_dtype)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 441, in make_tensor_proto\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 441, in &lt;listcomp&gt;\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/util/compat.py\", line 65, in as_bytes\n    (bytes_or_text,))\nTypeError: Expected binary or unicode string, got 13\n</code></pre>\n<p>Using Tensorflow version 0.12.0-rc0, also tested and fails the same way on 0.12.0-rc1.</p>", "body_text": "Code:\nimport tensorflow as tf\n\nx = tf.placeholder(dtype=tf.int32)\n\nA = tf.random_normal([13, x, 512])\nB = tf.random_normal([512, 3])\nC = tf.einsum('ijk,kl->ijl', A, B)\n\nwith tf.Session() as sess:\n    print(sess.run(C, {x: 7}))\n\nOutput:\nTraceback (most recent call last):\n  File \"/home/noam/code/test/test_einsum.py\", line 7, in <module>\n    C = tf.einsum('ijk,kl->ijl', A, B)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 212, in einsum\n    axes_to_sum)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 341, in _einsum_reduction\n    product = _reshape_if_necessary(product, uncompacted_shape)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 366, in _reshape_if_necessary\n    return array_ops.reshape(tensor, new_shape)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2448, in reshape\n    name=name)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\n    raise err\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 490, in apply_op\n    preferred_dtype=default_dtype)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 441, in make_tensor_proto\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 441, in <listcomp>\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/util/compat.py\", line 65, in as_bytes\n    (bytes_or_text,))\nTypeError: Expected binary or unicode string, got 13\n\nUsing Tensorflow version 0.12.0-rc0, also tested and fails the same way on 0.12.0-rc1.", "body": "Code:\r\n\r\n\r\n    import tensorflow as tf\r\n    \r\n    x = tf.placeholder(dtype=tf.int32)\r\n    \r\n    A = tf.random_normal([13, x, 512])\r\n    B = tf.random_normal([512, 3])\r\n    C = tf.einsum('ijk,kl->ijl', A, B)\r\n    \r\n    with tf.Session() as sess:\r\n        print(sess.run(C, {x: 7}))\r\n\r\nOutput:\r\n\r\n    Traceback (most recent call last):\r\n      File \"/home/noam/code/test/test_einsum.py\", line 7, in <module>\r\n        C = tf.einsum('ijk,kl->ijl', A, B)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 212, in einsum\r\n        axes_to_sum)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 341, in _einsum_reduction\r\n        product = _reshape_if_necessary(product, uncompacted_shape)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/special_math_ops.py\", line 366, in _reshape_if_necessary\r\n        return array_ops.reshape(tensor, new_shape)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2448, in reshape\r\n        name=name)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\r\n        raise err\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 490, in apply_op\r\n        preferred_dtype=default_dtype)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\r\n        ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\r\n        return constant(v, dtype=dtype, name=name)\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\r\n        tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 441, in make_tensor_proto\r\n        tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 441, in <listcomp>\r\n        tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\r\n      File \"/home/noam/miniconda3/envs/ml/lib/python3.5/site-packages/tensorflow/python/util/compat.py\", line 65, in as_bytes\r\n        (bytes_or_text,))\r\n    TypeError: Expected binary or unicode string, got 13\r\n\r\nUsing Tensorflow version 0.12.0-rc0, also tested and fails the same way on 0.12.0-rc1."}