{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22379", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22379/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22379/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22379/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22379", "id": 361671141, "node_id": "MDU6SXNzdWUzNjE2NzExNDE=", "number": 22379, "title": "[TF1.10] Use the method \"experimental_create_eval_graph()\" of quantize_graph.py to quantize a frozen_model, succeeded but failed at serializing by graph_util", "user": {"login": "oscarriddle", "id": 13745902, "node_id": "MDQ6VXNlcjEzNzQ1OTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/13745902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oscarriddle", "html_url": "https://github.com/oscarriddle", "followers_url": "https://api.github.com/users/oscarriddle/followers", "following_url": "https://api.github.com/users/oscarriddle/following{/other_user}", "gists_url": "https://api.github.com/users/oscarriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/oscarriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oscarriddle/subscriptions", "organizations_url": "https://api.github.com/users/oscarriddle/orgs", "repos_url": "https://api.github.com/users/oscarriddle/repos", "events_url": "https://api.github.com/users/oscarriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/oscarriddle/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-09-19T10:01:11Z", "updated_at": "2018-11-13T12:25:11Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: MacOS 10.13.6</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>: No</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: pip install tensorflow-gpu==1.10.0</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.10.0</li>\n<li><strong>Python version</strong>: 2.7</li>\n<li><strong>Bazel version (if compiling from source)</strong>: no</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: clang 9.1.0</li>\n<li><strong>CUDA/cuDNN version</strong>: no</li>\n<li><strong>GPU model and memory</strong>: no</li>\n<li><strong>Exact command to reproduce</strong>: Please refer to my test script below:</li>\n</ul>\n<p>Hi,<br>\nI tried to use the tool named quantize_graph.py to quantize a frozen_graph from FP32 to INT8.<br>\nAfter import the frozen model, I called the method named \"experimental_create_eval_graph\" and seems succeeded.<br>\nLater when I try to use graph_util to freeze variables to constant, error occurred.<br>\nScript:</p>\n<pre><code>from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\nfrom tensorflow.contrib.layers.python.layers import layers\nfrom tensorflow.contrib.quantize.python import quantize_graph\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.framework import test_util\nfrom tensorflow.python.ops import array_ops\nfrom tensorflow.python.ops import init_ops\nfrom tensorflow.python.ops import nn_ops\n\nfrom tensorflow.python.framework import importer as importer\nfrom tensorflow.python.client import session as csess\nfrom tensorflow.core.protobuf import config_pb2 as cpb2\nfrom tensorflow.python.framework import ops as ops\nfrom tensorflow.python.framework import graph_util\nfrom tensorflow.python.platform import gfile\n\n#tf.enable_eager_execution()\n\noutput_node_name = 'InceptionV3/Logits/SpatialSqueeze'\ninput_node_name = 'Placeholder'\noutput_path = 'test.pb'\ng = tf.Graph()\nwith g.as_default():\n    output_graph_def = tf.GraphDef()\n    with open('frozen_graph.pb', 'rb') as f:\n        output_graph_def.ParseFromString(f.read())\n        _ = tf.import_graph_def(output_graph_def, name='')\n    print([n.name for n in output_graph_def.node])\n    quantize_graph.experimental_create_eval_graph(\n        input_graph = g,\n        weight_bits = 8,\n        activation_bits = 8,\n        quant_delay=None,\n        scope=None)\n\n    print('=========================')\n    print([n.name for n in g.as_graph_def().node])\n\n\n#saver = tf.train.Saver(write_version=tf.train.SaverDef.V1)\nwith csess.Session(config=cpb2.ConfigProto(), graph=g) as sess:\n    inp = tf.get_default_graph().get_tensor_by_name('Placeholder:0')\n    out = tf.get_default_graph().get_tensor_by_name('InceptionV3/Logits/SpatialSqueeze:0')\n    g = graph_util.convert_variables_to_constants(sess, g.as_graph_def(), out)\n    with tf.gfile.GFile(output_path, \"wb\") as f:\n        f.write(g.SerializeToString())\n#    saver_path = saver.save(sess, \"model.ckpt\")\n</code></pre>\n<p>The Error log:</p>\n<pre><code>Traceback (most recent call last):\n  File \"test.py\", line 48, in &lt;module&gt;\n    g = graph_util.convert_variables_to_constants(sess, g.as_graph_def(), out)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 232, in convert_variables_to_constants\n    inference_graph = extract_sub_graph(input_graph_def, output_node_names)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 174, in extract_sub_graph\n    _assert_nodes_are_present(name_to_node, dest_nodes)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 132, in _assert_nodes_are_present\n    for d in nodes:\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/ops.py\", line 431, in __iter__\n    \"Tensor objects are not iterable when eager execution is not \"\nTypeError: Tensor objects are not iterable when eager execution is not enabled. To iterate over this tensor use tf.map_fn.\n\n</code></pre>\n<p>After enabling the eager execution mode, the error remains the same.<br>\nNot sure whether my script is correct and whether there is a way to serialize the quantized graph to a file? Any idea will be welcome.</p>\n<p>Thanks,</p>\n<hr>\n<p>I wrote a script to try to evaluate the accuracy of the quantized model over a test dataset.<br>\nBut a \"FailedPreconditionError\" error raised. Note that I'm using the official inceptionv3 model, and the output node is named \"InceptionV3/Logits/SpatialSqueeze\".<br>\nI wonder whether there will be a demo about how to use the quantized graph to do the prediction?<br>\nLet me update the full log</p>\n<pre><code>\n2018-09-25 10:51:49.521178: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-09-25 10:51:49.700182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \nname: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:84:00.0\ntotalMemory: 11.91GiB freeMemory: 11.75GiB\n2018-09-25 10:51:49.700336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-25 10:51:50.023026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-25 10:51:50.023106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \n2018-09-25 10:51:50.023120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \n2018-09-25 10:51:50.023437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11364 MB memory) -&gt; physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:84:00.0, compute capability: 6.1)\nTraceback (most recent call last):\n  File \"test.py\", line 61, in &lt;module&gt;\n    val = sess.run(out, {inp: preProcessImage(img_path)})\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 877, in run\n    run_metadata_ptr)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\n    run_metadata)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.FailedPreconditionError: Attempting to use uninitialized value InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min\n\t [[Node: InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min)]]\n\t [[Node: InceptionV3/Logits/SpatialSqueeze/_755 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_2389_InceptionV3/Logits/SpatialSqueeze\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\n\nCaused by op u'InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read', defined at:\n  File \"test.py\", line 50, in &lt;module&gt;\n    quantize_graph.experimental_create_eval_graph(input_graph = g,weight_bits = 8,activation_bits = 8,quant_delay=None,scope=None)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize_graph.py\", line 228, in experimental_create_eval_graph\n    scope=scope)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize_graph.py\", line 73, in _create_graph\n    scope=scope)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize.py\", line 94, in Quantize\n    consumer_scope=scope)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize.py\", line 545, in _InsertQuantOp\n    name_prefix=name_prefix))\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\n    return func(*args, **current_args)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quant_ops.py\", line 101, in LastValueQuantize\n    trainable=False)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\n    return func(*args, **current_args)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/variables.py\", line 297, in model_variable\n    use_resource=use_resource)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\n    return func(*args, **current_args)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/variables.py\", line 252, in variable\n    use_resource=use_resource)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1467, in get_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1217, in get_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 527, in get_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 481, in _true_getter\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 903, in _get_single_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2443, in variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2425, in &lt;lambda&gt;\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2406, in default_variable_creator\n    constraint=constraint)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 259, in __init__\n    constraint=constraint)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 422, in _init_from_args\n    self._snapshot = array_ops.identity(self._variable, name=\"read\")\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/array_ops.py\", line 80, in identity\n    return gen_array_ops.identity(input, name=name)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 3264, in identity\n    \"Identity\", input=input, name=name)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\n    return func(*args, **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\n    op_def=op_def)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nFailedPreconditionError (see above for traceback): Attempting to use uninitialized value InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min\n\t [[Node: InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min)]]\n\t [[Node: InceptionV3/Logits/SpatialSqueeze/_755 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_2389_InceptionV3/Logits/SpatialSqueeze\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\n\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS 10.13.6\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\nTensorFlow installed from (source or binary): pip install tensorflow-gpu==1.10.0\nTensorFlow version (use command below): 1.10.0\nPython version: 2.7\nBazel version (if compiling from source): no\nGCC/Compiler version (if compiling from source): clang 9.1.0\nCUDA/cuDNN version: no\nGPU model and memory: no\nExact command to reproduce: Please refer to my test script below:\n\nHi,\nI tried to use the tool named quantize_graph.py to quantize a frozen_graph from FP32 to INT8.\nAfter import the frozen model, I called the method named \"experimental_create_eval_graph\" and seems succeeded.\nLater when I try to use graph_util to freeze variables to constant, error occurred.\nScript:\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\nfrom tensorflow.contrib.layers.python.layers import layers\nfrom tensorflow.contrib.quantize.python import quantize_graph\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.framework import test_util\nfrom tensorflow.python.ops import array_ops\nfrom tensorflow.python.ops import init_ops\nfrom tensorflow.python.ops import nn_ops\n\nfrom tensorflow.python.framework import importer as importer\nfrom tensorflow.python.client import session as csess\nfrom tensorflow.core.protobuf import config_pb2 as cpb2\nfrom tensorflow.python.framework import ops as ops\nfrom tensorflow.python.framework import graph_util\nfrom tensorflow.python.platform import gfile\n\n#tf.enable_eager_execution()\n\noutput_node_name = 'InceptionV3/Logits/SpatialSqueeze'\ninput_node_name = 'Placeholder'\noutput_path = 'test.pb'\ng = tf.Graph()\nwith g.as_default():\n    output_graph_def = tf.GraphDef()\n    with open('frozen_graph.pb', 'rb') as f:\n        output_graph_def.ParseFromString(f.read())\n        _ = tf.import_graph_def(output_graph_def, name='')\n    print([n.name for n in output_graph_def.node])\n    quantize_graph.experimental_create_eval_graph(\n        input_graph = g,\n        weight_bits = 8,\n        activation_bits = 8,\n        quant_delay=None,\n        scope=None)\n\n    print('=========================')\n    print([n.name for n in g.as_graph_def().node])\n\n\n#saver = tf.train.Saver(write_version=tf.train.SaverDef.V1)\nwith csess.Session(config=cpb2.ConfigProto(), graph=g) as sess:\n    inp = tf.get_default_graph().get_tensor_by_name('Placeholder:0')\n    out = tf.get_default_graph().get_tensor_by_name('InceptionV3/Logits/SpatialSqueeze:0')\n    g = graph_util.convert_variables_to_constants(sess, g.as_graph_def(), out)\n    with tf.gfile.GFile(output_path, \"wb\") as f:\n        f.write(g.SerializeToString())\n#    saver_path = saver.save(sess, \"model.ckpt\")\n\nThe Error log:\nTraceback (most recent call last):\n  File \"test.py\", line 48, in <module>\n    g = graph_util.convert_variables_to_constants(sess, g.as_graph_def(), out)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 232, in convert_variables_to_constants\n    inference_graph = extract_sub_graph(input_graph_def, output_node_names)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 174, in extract_sub_graph\n    _assert_nodes_are_present(name_to_node, dest_nodes)\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 132, in _assert_nodes_are_present\n    for d in nodes:\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/ops.py\", line 431, in __iter__\n    \"Tensor objects are not iterable when eager execution is not \"\nTypeError: Tensor objects are not iterable when eager execution is not enabled. To iterate over this tensor use tf.map_fn.\n\n\nAfter enabling the eager execution mode, the error remains the same.\nNot sure whether my script is correct and whether there is a way to serialize the quantized graph to a file? Any idea will be welcome.\nThanks,\n\nI wrote a script to try to evaluate the accuracy of the quantized model over a test dataset.\nBut a \"FailedPreconditionError\" error raised. Note that I'm using the official inceptionv3 model, and the output node is named \"InceptionV3/Logits/SpatialSqueeze\".\nI wonder whether there will be a demo about how to use the quantized graph to do the prediction?\nLet me update the full log\n\n2018-09-25 10:51:49.521178: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-09-25 10:51:49.700182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \nname: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:84:00.0\ntotalMemory: 11.91GiB freeMemory: 11.75GiB\n2018-09-25 10:51:49.700336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-25 10:51:50.023026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-25 10:51:50.023106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \n2018-09-25 10:51:50.023120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \n2018-09-25 10:51:50.023437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11364 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:84:00.0, compute capability: 6.1)\nTraceback (most recent call last):\n  File \"test.py\", line 61, in <module>\n    val = sess.run(out, {inp: preProcessImage(img_path)})\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 877, in run\n    run_metadata_ptr)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\n    run_metadata)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.FailedPreconditionError: Attempting to use uninitialized value InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min\n\t [[Node: InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min)]]\n\t [[Node: InceptionV3/Logits/SpatialSqueeze/_755 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_2389_InceptionV3/Logits/SpatialSqueeze\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\n\nCaused by op u'InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read', defined at:\n  File \"test.py\", line 50, in <module>\n    quantize_graph.experimental_create_eval_graph(input_graph = g,weight_bits = 8,activation_bits = 8,quant_delay=None,scope=None)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize_graph.py\", line 228, in experimental_create_eval_graph\n    scope=scope)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize_graph.py\", line 73, in _create_graph\n    scope=scope)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize.py\", line 94, in Quantize\n    consumer_scope=scope)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize.py\", line 545, in _InsertQuantOp\n    name_prefix=name_prefix))\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\n    return func(*args, **current_args)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quant_ops.py\", line 101, in LastValueQuantize\n    trainable=False)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\n    return func(*args, **current_args)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/variables.py\", line 297, in model_variable\n    use_resource=use_resource)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\n    return func(*args, **current_args)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/variables.py\", line 252, in variable\n    use_resource=use_resource)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1467, in get_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1217, in get_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 527, in get_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 481, in _true_getter\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 903, in _get_single_variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2443, in variable\n    aggregation=aggregation)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2425, in <lambda>\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2406, in default_variable_creator\n    constraint=constraint)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 259, in __init__\n    constraint=constraint)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 422, in _init_from_args\n    self._snapshot = array_ops.identity(self._variable, name=\"read\")\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/array_ops.py\", line 80, in identity\n    return gen_array_ops.identity(input, name=name)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 3264, in identity\n    \"Identity\", input=input, name=name)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\n    return func(*args, **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\n    op_def=op_def)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nFailedPreconditionError (see above for traceback): Attempting to use uninitialized value InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min\n\t [[Node: InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min)]]\n\t [[Node: InceptionV3/Logits/SpatialSqueeze/_755 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_2389_InceptionV3/Logits/SpatialSqueeze\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOS 10.13.6\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No\r\n- **TensorFlow installed from (source or binary)**: pip install tensorflow-gpu==1.10.0\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: no\r\n- **GCC/Compiler version (if compiling from source)**: clang 9.1.0\r\n- **CUDA/cuDNN version**: no\r\n- **GPU model and memory**: no\r\n- **Exact command to reproduce**: Please refer to my test script below:\r\n\r\nHi, \r\nI tried to use the tool named quantize_graph.py to quantize a frozen_graph from FP32 to INT8.\r\nAfter import the frozen model, I called the method named \"experimental_create_eval_graph\" and seems succeeded.\r\nLater when I try to use graph_util to freeze variables to constant, error occurred.\r\nScript:\r\n```\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib.layers.python.layers import layers\r\nfrom tensorflow.contrib.quantize.python import quantize_graph\r\nfrom tensorflow.python.framework import ops\r\nfrom tensorflow.python.framework import test_util\r\nfrom tensorflow.python.ops import array_ops\r\nfrom tensorflow.python.ops import init_ops\r\nfrom tensorflow.python.ops import nn_ops\r\n\r\nfrom tensorflow.python.framework import importer as importer\r\nfrom tensorflow.python.client import session as csess\r\nfrom tensorflow.core.protobuf import config_pb2 as cpb2\r\nfrom tensorflow.python.framework import ops as ops\r\nfrom tensorflow.python.framework import graph_util\r\nfrom tensorflow.python.platform import gfile\r\n\r\n#tf.enable_eager_execution()\r\n\r\noutput_node_name = 'InceptionV3/Logits/SpatialSqueeze'\r\ninput_node_name = 'Placeholder'\r\noutput_path = 'test.pb'\r\ng = tf.Graph()\r\nwith g.as_default():\r\n    output_graph_def = tf.GraphDef()\r\n    with open('frozen_graph.pb', 'rb') as f:\r\n        output_graph_def.ParseFromString(f.read())\r\n        _ = tf.import_graph_def(output_graph_def, name='')\r\n    print([n.name for n in output_graph_def.node])\r\n    quantize_graph.experimental_create_eval_graph(\r\n        input_graph = g,\r\n        weight_bits = 8,\r\n        activation_bits = 8,\r\n        quant_delay=None,\r\n        scope=None)\r\n\r\n    print('=========================')\r\n    print([n.name for n in g.as_graph_def().node])\r\n\r\n\r\n#saver = tf.train.Saver(write_version=tf.train.SaverDef.V1)\r\nwith csess.Session(config=cpb2.ConfigProto(), graph=g) as sess:\r\n    inp = tf.get_default_graph().get_tensor_by_name('Placeholder:0')\r\n    out = tf.get_default_graph().get_tensor_by_name('InceptionV3/Logits/SpatialSqueeze:0')\r\n    g = graph_util.convert_variables_to_constants(sess, g.as_graph_def(), out)\r\n    with tf.gfile.GFile(output_path, \"wb\") as f:\r\n        f.write(g.SerializeToString())\r\n#    saver_path = saver.save(sess, \"model.ckpt\")\r\n```\r\nThe Error log:\r\n```\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 48, in <module>\r\n    g = graph_util.convert_variables_to_constants(sess, g.as_graph_def(), out)\r\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 232, in convert_variables_to_constants\r\n    inference_graph = extract_sub_graph(input_graph_def, output_node_names)\r\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 174, in extract_sub_graph\r\n    _assert_nodes_are_present(name_to_node, dest_nodes)\r\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 132, in _assert_nodes_are_present\r\n    for d in nodes:\r\n  File \"/Library/Python/2.7/site-packages/tensorflow/python/framework/ops.py\", line 431, in __iter__\r\n    \"Tensor objects are not iterable when eager execution is not \"\r\nTypeError: Tensor objects are not iterable when eager execution is not enabled. To iterate over this tensor use tf.map_fn.\r\n\r\n```\r\nAfter enabling the eager execution mode, the error remains the same.\r\nNot sure whether my script is correct and whether there is a way to serialize the quantized graph to a file? Any idea will be welcome.\r\n\r\nThanks,\r\n\r\n--------------------------\r\n\r\nI wrote a script to try to evaluate the accuracy of the quantized model over a test dataset.\r\nBut a \"FailedPreconditionError\" error raised. Note that I'm using the official inceptionv3 model, and the output node is named \"InceptionV3/Logits/SpatialSqueeze\".\r\nI wonder whether there will be a demo about how to use the quantized graph to do the prediction?\r\nLet me update the full log\r\n```\r\n\r\n2018-09-25 10:51:49.521178: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-25 10:51:49.700182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \r\nname: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:84:00.0\r\ntotalMemory: 11.91GiB freeMemory: 11.75GiB\r\n2018-09-25 10:51:49.700336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-25 10:51:50.023026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-25 10:51:50.023106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \r\n2018-09-25 10:51:50.023120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \r\n2018-09-25 10:51:50.023437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11364 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:84:00.0, compute capability: 6.1)\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 61, in <module>\r\n    val = sess.run(out, {inp: preProcessImage(img_path)})\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 877, in run\r\n    run_metadata_ptr)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\r\n    run_metadata)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.FailedPreconditionError: Attempting to use uninitialized value InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min\r\n\t [[Node: InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min)]]\r\n\t [[Node: InceptionV3/Logits/SpatialSqueeze/_755 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_2389_InceptionV3/Logits/SpatialSqueeze\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nCaused by op u'InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read', defined at:\r\n  File \"test.py\", line 50, in <module>\r\n    quantize_graph.experimental_create_eval_graph(input_graph = g,weight_bits = 8,activation_bits = 8,quant_delay=None,scope=None)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize_graph.py\", line 228, in experimental_create_eval_graph\r\n    scope=scope)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize_graph.py\", line 73, in _create_graph\r\n    scope=scope)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize.py\", line 94, in Quantize\r\n    consumer_scope=scope)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quantize.py\", line 545, in _InsertQuantOp\r\n    name_prefix=name_prefix))\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/quantize/python/quant_ops.py\", line 101, in LastValueQuantize\r\n    trainable=False)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/variables.py\", line 297, in model_variable\r\n    use_resource=use_resource)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/variables.py\", line 252, in variable\r\n    use_resource=use_resource)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1467, in get_variable\r\n    aggregation=aggregation)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 1217, in get_variable\r\n    aggregation=aggregation)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 527, in get_variable\r\n    aggregation=aggregation)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 481, in _true_getter\r\n    aggregation=aggregation)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 903, in _get_single_variable\r\n    aggregation=aggregation)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2443, in variable\r\n    aggregation=aggregation)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2425, in <lambda>\r\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py\", line 2406, in default_variable_creator\r\n    constraint=constraint)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 259, in __init__\r\n    constraint=constraint)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/variables.py\", line 422, in _init_from_args\r\n    self._snapshot = array_ops.identity(self._variable, name=\"read\")\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/array_ops.py\", line 80, in identity\r\n    return gen_array_ops.identity(input, name=name)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 3264, in identity\r\n    \"Identity\", input=input, name=name)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\r\n    op_def=op_def)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nFailedPreconditionError (see above for traceback): Attempting to use uninitialized value InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min\r\n\t [[Node: InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min/read = Identity[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](InceptionV3/InceptionV3/Mixed_7c/Branch_0/Conv2d_0a_1x1/weights_quant/min)]]\r\n\t [[Node: InceptionV3/Logits/SpatialSqueeze/_755 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_2389_InceptionV3/Logits/SpatialSqueeze\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\n```\r\n"}