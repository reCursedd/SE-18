{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/337834355", "html_url": "https://github.com/tensorflow/tensorflow/pull/11392#issuecomment-337834355", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11392", "id": 337834355, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzgzNDM1NQ==", "user": {"login": "avolkov1", "id": 21350261, "node_id": "MDQ6VXNlcjIxMzUwMjYx", "avatar_url": "https://avatars3.githubusercontent.com/u/21350261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avolkov1", "html_url": "https://github.com/avolkov1", "followers_url": "https://api.github.com/users/avolkov1/followers", "following_url": "https://api.github.com/users/avolkov1/following{/other_user}", "gists_url": "https://api.github.com/users/avolkov1/gists{/gist_id}", "starred_url": "https://api.github.com/users/avolkov1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avolkov1/subscriptions", "organizations_url": "https://api.github.com/users/avolkov1/orgs", "repos_url": "https://api.github.com/users/avolkov1/repos", "events_url": "https://api.github.com/users/avolkov1/events{/privacy}", "received_events_url": "https://api.github.com/users/avolkov1/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-19T08:18:22Z", "updated_at": "2017-10-19T08:18:22Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=2613663\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byronyi\">@byronyi</a> I keep getting an error: <code>UnavailableError: No such device: cannot bind to rdma://hsw215:2302</code></p>\n<p>No matter what port I've tried I get that error. The hsw215 is a compute node. This is my cluster spec:</p>\n<pre><code>CLUSTER_SPEC_DICT: {'ps': ['hsw215:2300'], 'worker': ['hsw215:2301', 'hsw215:2302', 'hsw215:2303', 'hsw215:2304']}\n</code></pre>\n<p>I compiled TF 1.4 with GDR, and I have nv_peer_mem running:</p>\n<pre><code>$ ibv_devinfo\nhca_id: mlx5_0\n        transport:                      InfiniBand (0)\n        fw_ver:                         10.16.1006\n        node_guid:                      e41d:2d03:0006:ae40\n        sys_image_guid:                 e41d:2d03:0006:ae40\n        vendor_id:                      0x02c9\n        vendor_part_id:                 4113\n        hw_ver:                         0x0\n        board_id:                       MT_1210110019\n        phys_port_cnt:                  2\n        Device ports:\n                port:   1\n                        state:                  PORT_ACTIVE (4)\n                        max_mtu:                4096 (5)\n                        active_mtu:             4096 (5)\n                        sm_lid:                 1\n                        port_lid:               16\n                        port_lmc:               0x00\n                        link_layer:             InfiniBand\n\n                port:   2\n                        state:                  PORT_DOWN (1)\n                        max_mtu:                4096 (5)\n                        active_mtu:             4096 (5)\n                        sm_lid:                 0\n                        port_lid:               65535\n                        port_lmc:               0x00\n                        link_layer:             InfiniBand\n\n\n$ service nv_peer_mem status\nnv_peer_mem module is loaded.\n</code></pre>\n<p>My code runs fine with <code>protocol='grpc+verbs'</code>. I get messages like:</p>\n<pre><code>I tensorflow/contrib/verbs/rdma_mgr.cc:56] connecting to remote node /job:worker/replica:0/task:0\n</code></pre>\n<p>Rdma runs well, but I can't get the gdr working. Maybe I'm doing something stupid, but it's not clear from the README what else needs to be done. Thanks.</p>", "body_text": "@byronyi I keep getting an error: UnavailableError: No such device: cannot bind to rdma://hsw215:2302\nNo matter what port I've tried I get that error. The hsw215 is a compute node. This is my cluster spec:\nCLUSTER_SPEC_DICT: {'ps': ['hsw215:2300'], 'worker': ['hsw215:2301', 'hsw215:2302', 'hsw215:2303', 'hsw215:2304']}\n\nI compiled TF 1.4 with GDR, and I have nv_peer_mem running:\n$ ibv_devinfo\nhca_id: mlx5_0\n        transport:                      InfiniBand (0)\n        fw_ver:                         10.16.1006\n        node_guid:                      e41d:2d03:0006:ae40\n        sys_image_guid:                 e41d:2d03:0006:ae40\n        vendor_id:                      0x02c9\n        vendor_part_id:                 4113\n        hw_ver:                         0x0\n        board_id:                       MT_1210110019\n        phys_port_cnt:                  2\n        Device ports:\n                port:   1\n                        state:                  PORT_ACTIVE (4)\n                        max_mtu:                4096 (5)\n                        active_mtu:             4096 (5)\n                        sm_lid:                 1\n                        port_lid:               16\n                        port_lmc:               0x00\n                        link_layer:             InfiniBand\n\n                port:   2\n                        state:                  PORT_DOWN (1)\n                        max_mtu:                4096 (5)\n                        active_mtu:             4096 (5)\n                        sm_lid:                 0\n                        port_lid:               65535\n                        port_lmc:               0x00\n                        link_layer:             InfiniBand\n\n\n$ service nv_peer_mem status\nnv_peer_mem module is loaded.\n\nMy code runs fine with protocol='grpc+verbs'. I get messages like:\nI tensorflow/contrib/verbs/rdma_mgr.cc:56] connecting to remote node /job:worker/replica:0/task:0\n\nRdma runs well, but I can't get the gdr working. Maybe I'm doing something stupid, but it's not clear from the README what else needs to be done. Thanks.", "body": "@byronyi I keep getting an error: `UnavailableError: No such device: cannot bind to rdma://hsw215:2302`\r\n\r\nNo matter what port I've tried I get that error. The hsw215 is a compute node. This is my cluster spec:\r\n```\r\nCLUSTER_SPEC_DICT: {'ps': ['hsw215:2300'], 'worker': ['hsw215:2301', 'hsw215:2302', 'hsw215:2303', 'hsw215:2304']}\r\n```\r\n\r\nI compiled TF 1.4 with GDR, and I have nv_peer_mem running:\r\n```\r\n$ ibv_devinfo\r\nhca_id: mlx5_0\r\n        transport:                      InfiniBand (0)\r\n        fw_ver:                         10.16.1006\r\n        node_guid:                      e41d:2d03:0006:ae40\r\n        sys_image_guid:                 e41d:2d03:0006:ae40\r\n        vendor_id:                      0x02c9\r\n        vendor_part_id:                 4113\r\n        hw_ver:                         0x0\r\n        board_id:                       MT_1210110019\r\n        phys_port_cnt:                  2\r\n        Device ports:\r\n                port:   1\r\n                        state:                  PORT_ACTIVE (4)\r\n                        max_mtu:                4096 (5)\r\n                        active_mtu:             4096 (5)\r\n                        sm_lid:                 1\r\n                        port_lid:               16\r\n                        port_lmc:               0x00\r\n                        link_layer:             InfiniBand\r\n\r\n                port:   2\r\n                        state:                  PORT_DOWN (1)\r\n                        max_mtu:                4096 (5)\r\n                        active_mtu:             4096 (5)\r\n                        sm_lid:                 0\r\n                        port_lid:               65535\r\n                        port_lmc:               0x00\r\n                        link_layer:             InfiniBand\r\n\r\n\r\n$ service nv_peer_mem status\r\nnv_peer_mem module is loaded.\r\n```\r\n\r\nMy code runs fine with `protocol='grpc+verbs'`. I get messages like:\r\n```\r\nI tensorflow/contrib/verbs/rdma_mgr.cc:56] connecting to remote node /job:worker/replica:0/task:0\r\n```\r\nRdma runs well, but I can't get the gdr working. Maybe I'm doing something stupid, but it's not clear from the README what else needs to be done. Thanks.\r\n"}