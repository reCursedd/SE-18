{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/336805574", "html_url": "https://github.com/tensorflow/tensorflow/issues/5719#issuecomment-336805574", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5719", "id": 336805574, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjgwNTU3NA==", "user": {"login": "ed-alertedh", "id": 24605895, "node_id": "MDQ6VXNlcjI0NjA1ODk1", "avatar_url": "https://avatars1.githubusercontent.com/u/24605895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ed-alertedh", "html_url": "https://github.com/ed-alertedh", "followers_url": "https://api.github.com/users/ed-alertedh/followers", "following_url": "https://api.github.com/users/ed-alertedh/following{/other_user}", "gists_url": "https://api.github.com/users/ed-alertedh/gists{/gist_id}", "starred_url": "https://api.github.com/users/ed-alertedh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ed-alertedh/subscriptions", "organizations_url": "https://api.github.com/users/ed-alertedh/orgs", "repos_url": "https://api.github.com/users/ed-alertedh/repos", "events_url": "https://api.github.com/users/ed-alertedh/events{/privacy}", "received_events_url": "https://api.github.com/users/ed-alertedh/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-16T07:42:13Z", "updated_at": "2017-10-16T07:42:13Z", "author_association": "NONE", "body_html": "<p>OK, looks like you've made significant changes since I last tried it, but I'm still seeing the same behaviour on tf-nightly-gpu==1.4.0.dev20171013. Info below but let me know if I can gather any more - sorry for not reporting earlier!</p>\n<p>Minimal working example for my machine:</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\n\nFLAGS = tf.flags.FLAGS\n\ntf.flags.DEFINE_integer('m', 1, 'batch size')\ntf.flags.DEFINE_integer('n', 1, 'data length')\ntf.flags.DEFINE_integer('k', 1, 'pick the top k')\n\ndims = (FLAGS.m, FLAGS.n)\n\nwith tf.device('/gpu:0'):\n    test_data = np.random.uniform(size=dims)\n    data = tf.constant(test_data, dtype=tf.float64)\n    k_in = tf.constant(FLAGS.k)\n    op_under_test = tf.nn.top_k(data, k_in, sorted=False)\n\nconf = tf.ConfigProto(log_device_placement=True, allow_soft_placement=False)\n# Don't perform optimizations for tests so we don't inadvertently run\n# gpu ops on cpu\nconf.graph_options.optimizer_options.opt_level = -1\nwith tf.Session(config=conf) as sess:\n    sess.run(op_under_test)\n</code></pre>\n<p>Error log for input of size [1, 6140]<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1386529/error_log.txt\">error_log.txt</a><br>\nNormal execution for input of size [1,6139]<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1386530/normal_execution.txt\">normal_execution.txt</a></p>", "body_text": "OK, looks like you've made significant changes since I last tried it, but I'm still seeing the same behaviour on tf-nightly-gpu==1.4.0.dev20171013. Info below but let me know if I can gather any more - sorry for not reporting earlier!\nMinimal working example for my machine:\nimport tensorflow as tf\nimport numpy as np\n\nFLAGS = tf.flags.FLAGS\n\ntf.flags.DEFINE_integer('m', 1, 'batch size')\ntf.flags.DEFINE_integer('n', 1, 'data length')\ntf.flags.DEFINE_integer('k', 1, 'pick the top k')\n\ndims = (FLAGS.m, FLAGS.n)\n\nwith tf.device('/gpu:0'):\n    test_data = np.random.uniform(size=dims)\n    data = tf.constant(test_data, dtype=tf.float64)\n    k_in = tf.constant(FLAGS.k)\n    op_under_test = tf.nn.top_k(data, k_in, sorted=False)\n\nconf = tf.ConfigProto(log_device_placement=True, allow_soft_placement=False)\n# Don't perform optimizations for tests so we don't inadvertently run\n# gpu ops on cpu\nconf.graph_options.optimizer_options.opt_level = -1\nwith tf.Session(config=conf) as sess:\n    sess.run(op_under_test)\n\nError log for input of size [1, 6140]\nerror_log.txt\nNormal execution for input of size [1,6139]\nnormal_execution.txt", "body": "OK, looks like you've made significant changes since I last tried it, but I'm still seeing the same behaviour on tf-nightly-gpu==1.4.0.dev20171013. Info below but let me know if I can gather any more - sorry for not reporting earlier!\r\n\r\nMinimal working example for my machine:\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nFLAGS = tf.flags.FLAGS\r\n\r\ntf.flags.DEFINE_integer('m', 1, 'batch size')\r\ntf.flags.DEFINE_integer('n', 1, 'data length')\r\ntf.flags.DEFINE_integer('k', 1, 'pick the top k')\r\n\r\ndims = (FLAGS.m, FLAGS.n)\r\n\r\nwith tf.device('/gpu:0'):\r\n    test_data = np.random.uniform(size=dims)\r\n    data = tf.constant(test_data, dtype=tf.float64)\r\n    k_in = tf.constant(FLAGS.k)\r\n    op_under_test = tf.nn.top_k(data, k_in, sorted=False)\r\n\r\nconf = tf.ConfigProto(log_device_placement=True, allow_soft_placement=False)\r\n# Don't perform optimizations for tests so we don't inadvertently run\r\n# gpu ops on cpu\r\nconf.graph_options.optimizer_options.opt_level = -1\r\nwith tf.Session(config=conf) as sess:\r\n    sess.run(op_under_test)\r\n```\r\n\r\nError log for input of size [1, 6140]\r\n[error_log.txt](https://github.com/tensorflow/tensorflow/files/1386529/error_log.txt)\r\nNormal execution for input of size [1,6139]\r\n[normal_execution.txt](https://github.com/tensorflow/tensorflow/files/1386530/normal_execution.txt)\r\n\r\n"}