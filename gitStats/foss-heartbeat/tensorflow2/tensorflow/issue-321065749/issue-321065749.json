{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19139", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19139/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19139/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19139/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19139", "id": 321065749, "node_id": "MDU6SXNzdWUzMjEwNjU3NDk=", "number": 19139, "title": "Can't quantize nodes In while", "user": {"login": "efeiefei", "id": 8653223, "node_id": "MDQ6VXNlcjg2NTMyMjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/8653223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/efeiefei", "html_url": "https://github.com/efeiefei", "followers_url": "https://api.github.com/users/efeiefei/followers", "following_url": "https://api.github.com/users/efeiefei/following{/other_user}", "gists_url": "https://api.github.com/users/efeiefei/gists{/gist_id}", "starred_url": "https://api.github.com/users/efeiefei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/efeiefei/subscriptions", "organizations_url": "https://api.github.com/users/efeiefei/orgs", "repos_url": "https://api.github.com/users/efeiefei/repos", "events_url": "https://api.github.com/users/efeiefei/events{/privacy}", "received_events_url": "https://api.github.com/users/efeiefei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-05-08T07:02:19Z", "updated_at": "2018-06-25T19:01:07Z", "closed_at": "2018-06-25T19:01:07Z", "author_association": "NONE", "body_html": "<p>I have similar errors with <a href=\"https://github.com/tensorflow/tensorflow/issues/7162\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7162/hovercard\">#7162</a> when quantize_nodes for <a href=\"https://github.com/tensorflow/tensor2tensor\">Tensor2Tensor Transformer</a> model.<br>\nIt's no problem after freeze_graph, it's also no problem with quantize_weights. But when I qutize_nodes, it will:</p>\n<pre><code>tensorflow.python.framework.errors_impl.InvalidArgumentError: The node 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1/eightbit' has inputs from different frames. The input 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1_eightbit/transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1/Enter/quantize' is in frame 'transformer/while/while_context'. The input 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/mul_1/eightbit/requantize' is in frame ''.\n</code></pre>\n<p>I have tried TF1.4 and TF1.7, and the error is the same.<br>\nCan anyone help me?</p>", "body_text": "I have similar errors with #7162 when quantize_nodes for Tensor2Tensor Transformer model.\nIt's no problem after freeze_graph, it's also no problem with quantize_weights. But when I qutize_nodes, it will:\ntensorflow.python.framework.errors_impl.InvalidArgumentError: The node 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1/eightbit' has inputs from different frames. The input 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1_eightbit/transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1/Enter/quantize' is in frame 'transformer/while/while_context'. The input 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/mul_1/eightbit/requantize' is in frame ''.\n\nI have tried TF1.4 and TF1.7, and the error is the same.\nCan anyone help me?", "body": "I have similar errors with [#7162](https://github.com/tensorflow/tensorflow/issues/7162) when quantize_nodes for [Tensor2Tensor Transformer](https://github.com/tensorflow/tensor2tensor) model.\r\nIt's no problem after freeze_graph, it's also no problem with quantize_weights. But when I qutize_nodes, it will:\r\n```\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: The node 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1/eightbit' has inputs from different frames. The input 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1_eightbit/transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/add_1/Enter/quantize' is in frame 'transformer/while/while_context'. The input 'transformer/while/body/parallel_0/body/decoder/layer_prepostprocess/layer_norm/mul_1/eightbit/requantize' is in frame ''.\r\n```\r\nI have tried TF1.4 and TF1.7, and the error is the same.\r\nCan anyone help me?"}