{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/386486740", "html_url": "https://github.com/tensorflow/tensorflow/issues/675#issuecomment-386486740", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/675", "id": 386486740, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjQ4Njc0MA==", "user": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-04T01:48:16Z", "updated_at": "2018-05-04T01:48:16Z", "author_association": "MEMBER", "body_html": "<p>This is indeed a bug in TF. It's caused by taking the gradient(y, x) inside a while loop wrt such that the computation of y from x goes through a different while loop, something like:</p>\n<pre><code>x = ...\ny = while_loop(..., [x])\nz = while_loop(..., tf.gradients(y, x), [y])\n</code></pre>\n<p>So in <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7227349\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mholzel\">@mholzel</a>'s script, it's from passing the outcome of one jacobian call to the other jacobian call. (BTW, thanks very much for the easy repro.)</p>\n<p>Unfortunately this is quite tricky to fix. I'll try to take another look at it tomorrow and see if I can come up with something.</p>", "body_text": "This is indeed a bug in TF. It's caused by taking the gradient(y, x) inside a while loop wrt such that the computation of y from x goes through a different while loop, something like:\nx = ...\ny = while_loop(..., [x])\nz = while_loop(..., tf.gradients(y, x), [y])\n\nSo in @mholzel's script, it's from passing the outcome of one jacobian call to the other jacobian call. (BTW, thanks very much for the easy repro.)\nUnfortunately this is quite tricky to fix. I'll try to take another look at it tomorrow and see if I can come up with something.", "body": "This is indeed a bug in TF. It's caused by taking the gradient(y, x) inside a while loop wrt such that the computation of y from x goes through a different while loop, something like:\r\n```\r\nx = ...\r\ny = while_loop(..., [x])\r\nz = while_loop(..., tf.gradients(y, x), [y])\r\n```\r\n\r\nSo in @mholzel's script, it's from passing the outcome of one jacobian call to the other jacobian call. (BTW, thanks very much for the easy repro.)\r\n\r\nUnfortunately this is quite tricky to fix. I'll try to take another look at it tomorrow and see if I can come up with something."}