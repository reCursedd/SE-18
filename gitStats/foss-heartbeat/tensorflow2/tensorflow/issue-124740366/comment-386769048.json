{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/386769048", "html_url": "https://github.com/tensorflow/tensorflow/issues/675#issuecomment-386769048", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/675", "id": 386769048, "node_id": "MDEyOklzc3VlQ29tbWVudDM4Njc2OTA0OA==", "user": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-05T01:18:46Z", "updated_at": "2018-05-05T01:18:46Z", "author_association": "MEMBER", "body_html": "<p>This is actually extremely tricky to fix. I'm not sure how this was working in 1.4, was it definitely giving the right answer?</p>\n<p>The fundamental problem is that the second jacobian call (i.e. the hessian) is calling tf.gradients() inside a while loop, and that backprop calculation must go through the while loop from the first jacobian call. TF computes while loop gradients using stacks to store intermediate loop values, so if you're doing that calculation multiple times via another loop, we'd have to somehow re-use the stack values on each iteration. This is conceptually possible but would be a pretty big change. I can at least try to improve the error message though.</p>", "body_text": "This is actually extremely tricky to fix. I'm not sure how this was working in 1.4, was it definitely giving the right answer?\nThe fundamental problem is that the second jacobian call (i.e. the hessian) is calling tf.gradients() inside a while loop, and that backprop calculation must go through the while loop from the first jacobian call. TF computes while loop gradients using stacks to store intermediate loop values, so if you're doing that calculation multiple times via another loop, we'd have to somehow re-use the stack values on each iteration. This is conceptually possible but would be a pretty big change. I can at least try to improve the error message though.", "body": "This is actually extremely tricky to fix. I'm not sure how this was working in 1.4, was it definitely giving the right answer?\r\n\r\nThe fundamental problem is that the second jacobian call (i.e. the hessian) is calling tf.gradients() inside a while loop, and that backprop calculation must go through the while loop from the first jacobian call. TF computes while loop gradients using stacks to store intermediate loop values, so if you're doing that calculation multiple times via another loop, we'd have to somehow re-use the stack values on each iteration. This is conceptually possible but would be a pretty big change. I can at least try to improve the error message though."}