{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/429298207", "html_url": "https://github.com/tensorflow/tensorflow/issues/22865#issuecomment-429298207", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22865", "id": 429298207, "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTI5ODIwNw==", "user": {"login": "cjr0106", "id": 32252431, "node_id": "MDQ6VXNlcjMyMjUyNDMx", "avatar_url": "https://avatars3.githubusercontent.com/u/32252431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjr0106", "html_url": "https://github.com/cjr0106", "followers_url": "https://api.github.com/users/cjr0106/followers", "following_url": "https://api.github.com/users/cjr0106/following{/other_user}", "gists_url": "https://api.github.com/users/cjr0106/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjr0106/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjr0106/subscriptions", "organizations_url": "https://api.github.com/users/cjr0106/orgs", "repos_url": "https://api.github.com/users/cjr0106/repos", "events_url": "https://api.github.com/users/cjr0106/events{/privacy}", "received_events_url": "https://api.github.com/users/cjr0106/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-12T11:43:32Z", "updated_at": "2018-10-12T11:43:32Z", "author_association": "NONE", "body_html": "<p>thanks so much , i solved it . but i got the input_shapes:[?,?,?3]. here are the result when i run  the commond:<br>\n<code>./bazel -bin/tensorflow/tools/graph_transforms/summarize_graph --in_graph=/home/caojinrong/ssd_mobilenet_v2_coco_2018_03_29/ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb</code></p>\n<p>i got the return :<br>\n<code>Found 1 possible inputs: (**name=image_tensor, type=uint8(4), shape=[?,?,?,3]**)  No variables spotted. Found 4 possible outputs: **(name=num_detections, op=Identity) (name=detection_classes, op=Identity) (name=detection_scores, op=Identity) (name=detection_boxes, op=Identity**)  Found 16878731 (16.88M) const parameters, 0 (0) variable parameters, and 1548 control_edges Op types used: 2572 Const, 549 Gather, 465 Identity, 452 Minimum, 371 Reshape, 360 Maximum, 344 Mul, 267 Sub, 261 Add, 211 Cast, 186 Greater, 180 Where, 180 Split, 165 Slice, 144 ConcatV2, 127 StridedSlice, 121 Pack, 116 Shape, 94 Unpack, 92 ZerosLike, 92 Squeeze, 90 NonMaxSuppressionV2, 64 Rsqrt, 55 Conv2D, 47 Relu6, 45 ExpandDims, 40 Fill, 37 Tile, 33 RealDiv, 30 Range, 29 Switch, 26 Enter, 21 DepthwiseConv2dNative, 14 Merge, 12 BiasAdd, 11 TensorArrayV3, 8 NextIteration, 6 Exit, 6 TensorArrayWriteV3, 6 TensorArraySizeV3, 6 TensorArrayGatherV3, 6 Sqrt, 5 TensorArrayReadV3, 5 TensorArrayScatterV3, 3 Equal, 3 Transpose, 3 Assert, 3 Rank, 2 Exp, 2 Less, 2 LoopCond, 1 All, 1 TopKV2, 1 Size, 1 Sigmoid, 1 ResizeBilinear, 1 Placeholder To use with tensorflow/tools/benchmark:benchmark_model try these arguments: bazel run tensorflow/tools/benchmark:benchmark_model -- --graph=/home/caojinrong/ssd_mobilenet_v2_coco_2018_03_29/ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb --show_flops --input_layer=image_tensor --input_layer_type=uint8 --input_layer_shape=-1,-1,-1,3 --output_layer=num_detections,detection_classes,detection_scores,detection_boxes </code><br>\nso the input shape =[?,?,?,3]</p>\n<p>but when use the post_training_quantize,if the input_shape write as the return,the relevent code is :<br>\n<code>converter = tf.contrib.lite.TocoConverter.from_frozen_graph( str(graph_def_file), input_arrays, output_arrays, input_shapes={\"image_tensor\":[-1,-1,-1,3]}) converter.post_training_quantize = True</code></p>\n<p>it got the error:<br>\n<code>Traceback (most recent call last): File \"quant.py\", line 9, in &lt;module&gt; str(graph_def_file), input_arrays, output_arrays, input_shapes={\"image_tensor\":[-1,-1,-1,3]}) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/lite.py\", line 274, in from_frozen_graph _set_tensor_shapes(input_tensors, input_shapes) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert_saved_model.py\", line 205, in set_tensor_shapes tensor.set_shape(shape) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 540, in set_shape shape = tensor_shape.TensorShape(shape) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 542, in __init__ self._dims = [as_dimension(d) for d in dims_iter] File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 542, in &lt;listcomp&gt; self._dims = [as_dimension(d) for d in dims_iter] File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 482, in as_dimension return Dimension(value) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 42, in __init__ raise ValueError(\"Dimension %d must be &gt;= 0\" % self._value) ValueError: Dimension -1 must be &gt;= 0 </code><br>\nit got confused.@ <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7286405\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/aejaex\">@aejaex</a></p>", "body_text": "thanks so much , i solved it . but i got the input_shapes:[?,?,?3]. here are the result when i run  the commond:\n./bazel -bin/tensorflow/tools/graph_transforms/summarize_graph --in_graph=/home/caojinrong/ssd_mobilenet_v2_coco_2018_03_29/ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb\ni got the return :\nFound 1 possible inputs: (**name=image_tensor, type=uint8(4), shape=[?,?,?,3]**)  No variables spotted. Found 4 possible outputs: **(name=num_detections, op=Identity) (name=detection_classes, op=Identity) (name=detection_scores, op=Identity) (name=detection_boxes, op=Identity**)  Found 16878731 (16.88M) const parameters, 0 (0) variable parameters, and 1548 control_edges Op types used: 2572 Const, 549 Gather, 465 Identity, 452 Minimum, 371 Reshape, 360 Maximum, 344 Mul, 267 Sub, 261 Add, 211 Cast, 186 Greater, 180 Where, 180 Split, 165 Slice, 144 ConcatV2, 127 StridedSlice, 121 Pack, 116 Shape, 94 Unpack, 92 ZerosLike, 92 Squeeze, 90 NonMaxSuppressionV2, 64 Rsqrt, 55 Conv2D, 47 Relu6, 45 ExpandDims, 40 Fill, 37 Tile, 33 RealDiv, 30 Range, 29 Switch, 26 Enter, 21 DepthwiseConv2dNative, 14 Merge, 12 BiasAdd, 11 TensorArrayV3, 8 NextIteration, 6 Exit, 6 TensorArrayWriteV3, 6 TensorArraySizeV3, 6 TensorArrayGatherV3, 6 Sqrt, 5 TensorArrayReadV3, 5 TensorArrayScatterV3, 3 Equal, 3 Transpose, 3 Assert, 3 Rank, 2 Exp, 2 Less, 2 LoopCond, 1 All, 1 TopKV2, 1 Size, 1 Sigmoid, 1 ResizeBilinear, 1 Placeholder To use with tensorflow/tools/benchmark:benchmark_model try these arguments: bazel run tensorflow/tools/benchmark:benchmark_model -- --graph=/home/caojinrong/ssd_mobilenet_v2_coco_2018_03_29/ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb --show_flops --input_layer=image_tensor --input_layer_type=uint8 --input_layer_shape=-1,-1,-1,3 --output_layer=num_detections,detection_classes,detection_scores,detection_boxes \nso the input shape =[?,?,?,3]\nbut when use the post_training_quantize,if the input_shape write as the return,the relevent code is :\nconverter = tf.contrib.lite.TocoConverter.from_frozen_graph( str(graph_def_file), input_arrays, output_arrays, input_shapes={\"image_tensor\":[-1,-1,-1,3]}) converter.post_training_quantize = True\nit got the error:\nTraceback (most recent call last): File \"quant.py\", line 9, in <module> str(graph_def_file), input_arrays, output_arrays, input_shapes={\"image_tensor\":[-1,-1,-1,3]}) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/lite.py\", line 274, in from_frozen_graph _set_tensor_shapes(input_tensors, input_shapes) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert_saved_model.py\", line 205, in set_tensor_shapes tensor.set_shape(shape) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 540, in set_shape shape = tensor_shape.TensorShape(shape) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 542, in __init__ self._dims = [as_dimension(d) for d in dims_iter] File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 542, in <listcomp> self._dims = [as_dimension(d) for d in dims_iter] File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 482, in as_dimension return Dimension(value) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 42, in __init__ raise ValueError(\"Dimension %d must be >= 0\" % self._value) ValueError: Dimension -1 must be >= 0 \nit got confused.@ @aejaex", "body": "thanks so much , i solved it . but i got the input_shapes:[?,?,?3]. here are the result when i run  the commond:\r\n`./bazel -bin/tensorflow/tools/graph_transforms/summarize_graph --in_graph=/home/caojinrong/ssd_mobilenet_v2_coco_2018_03_29/ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb`\r\n\r\ni got the return :\r\n`Found 1 possible inputs: (**name=image_tensor, type=uint8(4), shape=[?,?,?,3]**) \r\nNo variables spotted.\r\nFound 4 possible outputs: **(name=num_detections, op=Identity) (name=detection_classes, op=Identity) (name=detection_scores, op=Identity) (name=detection_boxes, op=Identity**) \r\nFound 16878731 (16.88M) const parameters, 0 (0) variable parameters, and 1548 control_edges\r\nOp types used: 2572 Const, 549 Gather, 465 Identity, 452 Minimum, 371 Reshape, 360 Maximum, 344 Mul, 267 Sub, 261 Add, 211 Cast, 186 Greater, 180 Where, 180 Split, 165 Slice, 144 ConcatV2, 127 StridedSlice, 121 Pack, 116 Shape, 94 Unpack, 92 ZerosLike, 92 Squeeze, 90 NonMaxSuppressionV2, 64 Rsqrt, 55 Conv2D, 47 Relu6, 45 ExpandDims, 40 Fill, 37 Tile, 33 RealDiv, 30 Range, 29 Switch, 26 Enter, 21 DepthwiseConv2dNative, 14 Merge, 12 BiasAdd, 11 TensorArrayV3, 8 NextIteration, 6 Exit, 6 TensorArrayWriteV3, 6 TensorArraySizeV3, 6 TensorArrayGatherV3, 6 Sqrt, 5 TensorArrayReadV3, 5 TensorArrayScatterV3, 3 Equal, 3 Transpose, 3 Assert, 3 Rank, 2 Exp, 2 Less, 2 LoopCond, 1 All, 1 TopKV2, 1 Size, 1 Sigmoid, 1 ResizeBilinear, 1 Placeholder\r\nTo use with tensorflow/tools/benchmark:benchmark_model try these arguments:\r\nbazel run tensorflow/tools/benchmark:benchmark_model -- --graph=/home/caojinrong/ssd_mobilenet_v2_coco_2018_03_29/ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb --show_flops --input_layer=image_tensor --input_layer_type=uint8 --input_layer_shape=-1,-1,-1,3 --output_layer=num_detections,detection_classes,detection_scores,detection_boxes\r\n`\r\nso the input shape =[?,?,?,3]\r\n\r\nbut when use the post_training_quantize,if the input_shape write as the return,the relevent code is :\r\n`converter = tf.contrib.lite.TocoConverter.from_frozen_graph(\r\n str(graph_def_file), input_arrays, output_arrays, input_shapes={\"image_tensor\":[-1,-1,-1,3]})\r\nconverter.post_training_quantize = True`\r\n\r\nit got the error:\r\n`Traceback (most recent call last):\r\n  File \"quant.py\", line 9, in <module>\r\n    str(graph_def_file), input_arrays, output_arrays, input_shapes={\"image_tensor\":[-1,-1,-1,3]})\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/lite.py\", line 274, in from_frozen_graph\r\n    _set_tensor_shapes(input_tensors, input_shapes)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/lite/python/convert_saved_model.py\", line 205, in set_tensor_shapes\r\n    tensor.set_shape(shape)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 540, in set_shape\r\n    shape = tensor_shape.TensorShape(shape)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 542, in __init__\r\n    self._dims = [as_dimension(d) for d in dims_iter]\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 542, in <listcomp>\r\n    self._dims = [as_dimension(d) for d in dims_iter]\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 482, in as_dimension\r\n    return Dimension(value)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/tensor_shape.py\", line 42, in __init__\r\n    raise ValueError(\"Dimension %d must be >= 0\" % self._value)\r\nValueError: Dimension -1 must be >= 0\r\n`\r\nit got confused.@ @aejaex "}