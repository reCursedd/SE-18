{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/385234577", "html_url": "https://github.com/tensorflow/tensorflow/issues/18643#issuecomment-385234577", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18643", "id": 385234577, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTIzNDU3Nw==", "user": {"login": "peterlee0127", "id": 906325, "node_id": "MDQ6VXNlcjkwNjMyNQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/906325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peterlee0127", "html_url": "https://github.com/peterlee0127", "followers_url": "https://api.github.com/users/peterlee0127/followers", "following_url": "https://api.github.com/users/peterlee0127/following{/other_user}", "gists_url": "https://api.github.com/users/peterlee0127/gists{/gist_id}", "starred_url": "https://api.github.com/users/peterlee0127/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peterlee0127/subscriptions", "organizations_url": "https://api.github.com/users/peterlee0127/orgs", "repos_url": "https://api.github.com/users/peterlee0127/repos", "events_url": "https://api.github.com/users/peterlee0127/events{/privacy}", "received_events_url": "https://api.github.com/users/peterlee0127/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-29T08:18:34Z", "updated_at": "2018-04-30T00:53:42Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=8907830\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jessebenson\">@jessebenson</a>  Yes. It works. I build tensorflow-1.8.0rc1-cp27-cp27mu-linux_aarch64.whl and work successfully.<br>\nI also created a patch for this. Could I create a new PR for this ?</p>\n<p>Updated:<br>\nBut I think this may not best fix. Maybe we should try to add aarch64_linux arch to formal config files ?<br>\nCurrently, we have \"android_x86,android_x86_64,raspberry_pi_armeabi,android_arm,android_mips64,linux_x86_64\" and so on.<br>\nIn many config file, we can do like this</p>\n<pre><code>    copts = select({\n        \"@org_tensorflow//tensorflow:aarch64_linux\": [\n            \"-DPNG_ARM_NEON_OPT=0\",\n        ],\n        \"@org_tensorflow//tensorflow:windows_msvc\": [\n            \"/DHAVE_CONFIG_H\",\n            \"/EHsc\",\n        ]\n    }),\n</code></pre>\n<p>Patch</p>\n<pre><code>diff --git a/third_party/png.BUILD b/third_party/png.BUILD\nindex 76ab32d..bc4551a 100644\n--- a/third_party/png.BUILD\n+++ b/third_party/png.BUILD\n@@ -35,6 +35,7 @@ cc_library(\n     ],\n     includes = [\".\"],\n     linkopts = [\"-lm\"],\n+    copts = [\"-DPNG_ARM_NEON_OPT=0\"],\n     visibility = [\"//visibility:public\"],\n     deps = [\"@zlib_archive//:zlib\"],\n )\n</code></pre>", "body_text": "@jessebenson  Yes. It works. I build tensorflow-1.8.0rc1-cp27-cp27mu-linux_aarch64.whl and work successfully.\nI also created a patch for this. Could I create a new PR for this ?\nUpdated:\nBut I think this may not best fix. Maybe we should try to add aarch64_linux arch to formal config files ?\nCurrently, we have \"android_x86,android_x86_64,raspberry_pi_armeabi,android_arm,android_mips64,linux_x86_64\" and so on.\nIn many config file, we can do like this\n    copts = select({\n        \"@org_tensorflow//tensorflow:aarch64_linux\": [\n            \"-DPNG_ARM_NEON_OPT=0\",\n        ],\n        \"@org_tensorflow//tensorflow:windows_msvc\": [\n            \"/DHAVE_CONFIG_H\",\n            \"/EHsc\",\n        ]\n    }),\n\nPatch\ndiff --git a/third_party/png.BUILD b/third_party/png.BUILD\nindex 76ab32d..bc4551a 100644\n--- a/third_party/png.BUILD\n+++ b/third_party/png.BUILD\n@@ -35,6 +35,7 @@ cc_library(\n     ],\n     includes = [\".\"],\n     linkopts = [\"-lm\"],\n+    copts = [\"-DPNG_ARM_NEON_OPT=0\"],\n     visibility = [\"//visibility:public\"],\n     deps = [\"@zlib_archive//:zlib\"],\n )", "body": "@jessebenson  Yes. It works. I build tensorflow-1.8.0rc1-cp27-cp27mu-linux_aarch64.whl and work successfully.\r\nI also created a patch for this. Could I create a new PR for this ? \r\n\r\nUpdated:\r\nBut I think this may not best fix. Maybe we should try to add aarch64_linux arch to formal config files ?\r\nCurrently, we have \"android_x86,android_x86_64,raspberry_pi_armeabi,android_arm,android_mips64,linux_x86_64\" and so on.\r\nIn many config file, we can do like this\r\n```\r\n    copts = select({\r\n        \"@org_tensorflow//tensorflow:aarch64_linux\": [\r\n            \"-DPNG_ARM_NEON_OPT=0\",\r\n        ],\r\n        \"@org_tensorflow//tensorflow:windows_msvc\": [\r\n            \"/DHAVE_CONFIG_H\",\r\n            \"/EHsc\",\r\n        ]\r\n    }),\r\n```\r\nPatch\r\n```\r\ndiff --git a/third_party/png.BUILD b/third_party/png.BUILD\r\nindex 76ab32d..bc4551a 100644\r\n--- a/third_party/png.BUILD\r\n+++ b/third_party/png.BUILD\r\n@@ -35,6 +35,7 @@ cc_library(\r\n     ],\r\n     includes = [\".\"],\r\n     linkopts = [\"-lm\"],\r\n+    copts = [\"-DPNG_ARM_NEON_OPT=0\"],\r\n     visibility = [\"//visibility:public\"],\r\n     deps = [\"@zlib_archive//:zlib\"],\r\n )\r\n```"}