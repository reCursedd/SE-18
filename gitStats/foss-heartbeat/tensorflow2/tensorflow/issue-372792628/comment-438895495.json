{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/438895495", "html_url": "https://github.com/tensorflow/tensorflow/issues/23179#issuecomment-438895495", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23179", "id": 438895495, "node_id": "MDEyOklzc3VlQ29tbWVudDQzODg5NTQ5NQ==", "user": {"login": "delock", "id": 19373651, "node_id": "MDQ6VXNlcjE5MzczNjUx", "avatar_url": "https://avatars2.githubusercontent.com/u/19373651?v=4", "gravatar_id": "", "url": "https://api.github.com/users/delock", "html_url": "https://github.com/delock", "followers_url": "https://api.github.com/users/delock/followers", "following_url": "https://api.github.com/users/delock/following{/other_user}", "gists_url": "https://api.github.com/users/delock/gists{/gist_id}", "starred_url": "https://api.github.com/users/delock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/delock/subscriptions", "organizations_url": "https://api.github.com/users/delock/orgs", "repos_url": "https://api.github.com/users/delock/repos", "events_url": "https://api.github.com/users/delock/events{/privacy}", "received_events_url": "https://api.github.com/users/delock/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-15T02:38:23Z", "updated_at": "2018-11-15T02:38:39Z", "author_association": "NONE", "body_html": "<p>Oh, I'm experimenting with r1.10.1 branch, the allow optimization part is not present on r1.10.1.  I'll try the line in master and see how it goes.</p>\n<blockquote>\n<p>I am not sure what do you mean \"will be blocked by ...\". When we use <code>AddFunction</code> to build the graph for the sake of optimization, then stateful actions are allowed (see <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/dataset.cc#L143\">here</a>).</p>\n<p>Your optimization should check whether the FilterDataset function matches a certain pattern and if so, replace it with SamplingDataset.</p>\n</blockquote>\n<p>Yes, that's exactly I'm doing, it works well for the filter function, and get the performance expected, thanks for the suggestion!</p>", "body_text": "Oh, I'm experimenting with r1.10.1 branch, the allow optimization part is not present on r1.10.1.  I'll try the line in master and see how it goes.\n\nI am not sure what do you mean \"will be blocked by ...\". When we use AddFunction to build the graph for the sake of optimization, then stateful actions are allowed (see here).\nYour optimization should check whether the FilterDataset function matches a certain pattern and if so, replace it with SamplingDataset.\n\nYes, that's exactly I'm doing, it works well for the filter function, and get the performance expected, thanks for the suggestion!", "body": "Oh, I'm experimenting with r1.10.1 branch, the allow optimization part is not present on r1.10.1.  I'll try the line in master and see how it goes.\r\n> I am not sure what do you mean \"will be blocked by ...\". When we use `AddFunction` to build the graph for the sake of optimization, then stateful actions are allowed (see [here](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/dataset.cc#L143)).\r\n> \r\n> Your optimization should check whether the FilterDataset function matches a certain pattern and if so, replace it with SamplingDataset.\r\n\r\nYes, that's exactly I'm doing, it works well for the filter function, and get the performance expected, thanks for the suggestion!\r\n"}