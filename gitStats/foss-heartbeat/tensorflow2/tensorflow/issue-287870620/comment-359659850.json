{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/359659850", "html_url": "https://github.com/tensorflow/tensorflow/issues/16045#issuecomment-359659850", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16045", "id": 359659850, "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTY1OTg1MA==", "user": {"login": "jlebar", "id": 150663, "node_id": "MDQ6VXNlcjE1MDY2Mw==", "avatar_url": "https://avatars1.githubusercontent.com/u/150663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlebar", "html_url": "https://github.com/jlebar", "followers_url": "https://api.github.com/users/jlebar/followers", "following_url": "https://api.github.com/users/jlebar/following{/other_user}", "gists_url": "https://api.github.com/users/jlebar/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlebar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlebar/subscriptions", "organizations_url": "https://api.github.com/users/jlebar/orgs", "repos_url": "https://api.github.com/users/jlebar/repos", "events_url": "https://api.github.com/users/jlebar/events{/privacy}", "received_events_url": "https://api.github.com/users/jlebar/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-23T03:05:00Z", "updated_at": "2018-01-23T03:05:00Z", "author_association": "MEMBER", "body_html": "<p>Spent a while debugging this today.  I've found a number of XLA computations which generate different values than we get with the reference backend, but this isn't necessarily a sign of a bug.  In particular, cudnn convolution isn't necessarily deterministic or even particularly accurate, depending on the algorithm we choose.</p>\n<p>In theory XLA and TF use pretty much the same method for choosing cudnn algorithms, so I'd be surprised if this was the source of your problem.  But it's making it hard for me to tell what, if anything, is going wrong here...</p>\n<p>I'm going to try to spend another day poking around at the XLA level to see if I can see what's going wrong here, but we may need that e2e testcase after all.</p>\n<p>cc <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=348932\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/hawkinsp\">@hawkinsp</a>, who may have ideas himself.</p>", "body_text": "Spent a while debugging this today.  I've found a number of XLA computations which generate different values than we get with the reference backend, but this isn't necessarily a sign of a bug.  In particular, cudnn convolution isn't necessarily deterministic or even particularly accurate, depending on the algorithm we choose.\nIn theory XLA and TF use pretty much the same method for choosing cudnn algorithms, so I'd be surprised if this was the source of your problem.  But it's making it hard for me to tell what, if anything, is going wrong here...\nI'm going to try to spend another day poking around at the XLA level to see if I can see what's going wrong here, but we may need that e2e testcase after all.\ncc @hawkinsp, who may have ideas himself.", "body": "Spent a while debugging this today.  I've found a number of XLA computations which generate different values than we get with the reference backend, but this isn't necessarily a sign of a bug.  In particular, cudnn convolution isn't necessarily deterministic or even particularly accurate, depending on the algorithm we choose.\r\n\r\nIn theory XLA and TF use pretty much the same method for choosing cudnn algorithms, so I'd be surprised if this was the source of your problem.  But it's making it hard for me to tell what, if anything, is going wrong here...\r\n\r\nI'm going to try to spend another day poking around at the XLA level to see if I can see what's going wrong here, but we may need that e2e testcase after all.\r\n\r\ncc @hawkinsp, who may have ideas himself."}