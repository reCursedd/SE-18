{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23513", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23513/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23513/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23513/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23513", "id": 377270527, "node_id": "MDU6SXNzdWUzNzcyNzA1Mjc=", "number": 23513, "title": "[TF1.7][CUDA9.0] TF compilation from source with GPU failed, something goes wrongly with protobuf_archive", "user": {"login": "oscarriddle", "id": 13745902, "node_id": "MDQ6VXNlcjEzNzQ1OTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/13745902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oscarriddle", "html_url": "https://github.com/oscarriddle", "followers_url": "https://api.github.com/users/oscarriddle/followers", "following_url": "https://api.github.com/users/oscarriddle/following{/other_user}", "gists_url": "https://api.github.com/users/oscarriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/oscarriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oscarriddle/subscriptions", "organizations_url": "https://api.github.com/users/oscarriddle/orgs", "repos_url": "https://api.github.com/users/oscarriddle/repos", "events_url": "https://api.github.com/users/oscarriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/oscarriddle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-11-05T06:48:38Z", "updated_at": "2018-11-06T07:36:27Z", "closed_at": "2018-11-06T07:36:27Z", "author_association": "NONE", "body_html": "<p><strong>System information</strong></p>\n<ul>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS</li>\n<li>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NO</li>\n<li>TensorFlow installed from (source or binary): source</li>\n<li>TensorFlow version: r1.7</li>\n<li>Python version: Python 2.7</li>\n<li>Installed using virtualenv? pip? conda?: Source</li>\n<li>Bazel version (if compiling from source): 0.10.1</li>\n<li>GCC/Compiler version (if compiling from source): gcc-5.3</li>\n<li>CUDA/cuDNN version: 9.0 / 7.0.5</li>\n<li>GPU model and memory: TitanXP 12GB</li>\n</ul>\n<p><strong>Describe the problem</strong><br>\nThe CPU back-end TF compilation is successfully done, then I tried to compile the Tensorflow from source with GPU back-end support.<br>\nAfter following the tutorial <a href=\"https://www.tensorflow.org/install/source\" rel=\"nofollow\"></a>, the compilation is proceeded to about: [23xx/6xxx], then an error popped up which is as follow:</p>\n<pre><code>.\n.\n.\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateAllocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:232:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index &lt; graph_info_-&gt;num_nodes()) {\n                  ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateDeallocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:245:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index &lt; graph_info_-&gt;num_nodes()) {\n                  ^\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc [for host]:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nINFO: From Compiling external/snappy/snappy.cc:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nINFO: From Compiling external/snappy/snappy.cc [for host]:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nERROR: /home/web_server/.cache/bazel/_bazel_web_server/9c777c8c1d70f40d5fbbacb4888a5481/external/protobuf_archive/BUILD:259:1: Linking of rule '@protobuf_archive//:js_embed' failed (Exit 1)\n/usr/bin/ld: bazel-out/host/bin/external/protobuf_archive/_objs/js_embed/external/protobuf_archive/src/google/protobuf/compiler/js/embed.o: unrecognized relocation (0x2a) in section `.text._ZL7AddFilePKcPSo.constprop.25'\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 72.355s, Critical Path: 26.30s\nFAILED: Build did NOT complete successfully\n</code></pre>\n<p>I guess this shall be an known issue and something relevant to a configuration problem, however, I didn't find anything helpful.</p>\n<hr>\n<pre><code>Below is my ./configuration:\n$ ./configure \nWARNING: Running Bazel server needs to be killed, because the startup options are different.\nYou have bazel 0.10.1 installed.\nDo you wish to build TensorFlow with jemalloc as malloc support? [Y/n]: n\nNo jemalloc as malloc support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Google Cloud Platform support? [Y/n]: n\nNo Google Cloud Platform support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Hadoop File System support? [Y/n]: n\nNo Hadoop File System support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Amazon S3 File System support? [Y/n]: n\nNo Amazon S3 File System support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Apache Kafka Platform support? [y/N]: n\nNo Apache Kafka Platform support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\nNo XLA JIT support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with GDR support? [y/N]: n\nNo GDR support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with VERBS support? [y/N]: n\nNo VERBS support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: n\nNo OpenCL SYCL support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\nCUDA support will be enabled for TensorFlow.\n\nPlease specify the CUDA SDK version you want to use, e.g. 7.0. [Leave empty to default to CUDA 9.0]: \n\n\nPlease specify the location where CUDA 9.0 toolkit is installed. Refer to README.md for more details. [Default is /usr/local/cuda]: /home/web_server/xiaolun/cuda-9.0\n\n\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuDNN 7.0]: \n\n\nPlease specify the location where cuDNN 7 library is installed. Refer to README.md for more details. [Default is /home/web_server/xiaolun/cuda-9.0]:\n\n\nDo you wish to build TensorFlow with TensorRT support? [y/N]: n\nNo TensorRT support will be enabled for TensorFlow.\n\nPlease specify a list of comma-separated Cuda compute capabilities you want to build with.\nYou can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.\nPlease note that each additional compute capability significantly increases your build time and binary size. [Default is: 6.1]\n\n\nDo you want to use clang as CUDA compiler? [y/N]: n\nnvcc will be used as CUDA compiler.\n\nPlease specify which gcc should be used by nvcc as the host compiler. [Default is /bin/gcc]: /home/web_server/gcc-5.3\n\n\nDo you wish to build TensorFlow with MPI support? [y/N]: n\nNo MPI support will be enabled for TensorFlow.\n\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native]: \n\n\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]: n\nNot configuring the WORKSPACE for Android builds.\n\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=&lt;&gt;\" to your build command. See tools/bazel.rc for more details.\n\t--config=mkl         \t# Build with MKL support.\n\t--config=monolithic  \t# Config for mostly static monolithic build.\nConfiguration finished\n\n</code></pre>\n<hr>\n<p>I reset the environment variables and recompile it. This time the error is as below:</p>\n<pre><code>INFO: From Compiling tensorflow/contrib/lite/arena_planner.cc:\ntensorflow/contrib/lite/arena_planner.cc: In member function 'virtual TfLiteStatus tflite::ArenaPlanner::PlanAllocations()':\ntensorflow/contrib/lite/arena_planner.cc:82:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (int i = 0; i &lt; graph_info_-&gt;num_nodes(); ++i) {\n                     ^\ntensorflow/contrib/lite/arena_planner.cc:101:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (int i = 0; i &lt; graph_info_-&gt;num_nodes(); ++i) {\n                     ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'virtual TfLiteStatus tflite::ArenaPlanner::ExecuteAllocations(int, int)':\ntensorflow/contrib/lite/arena_planner.cc:139:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (int i = 0; i &lt; graph_info_-&gt;num_tensors(); ++i) {\n                     ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateAllocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:232:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index &lt; graph_info_-&gt;num_nodes()) {\n                  ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateDeallocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:245:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index &lt; graph_info_-&gt;num_nodes()) {\n                  ^\nERROR: /home/web_server/.cache/bazel/_bazel_web_server/924cb0e3b475d8bc0bc364784129b908/external/protobuf_archive/BUILD:259:1: Linking of rule '@protobuf_archive//:js_embed' failed (Exit 1)\n/usr/bin/ld: bazel-out/host/bin/external/protobuf_archive/_objs/js_embed/external/protobuf_archive/src/google/protobuf/compiler/js/embed.o: unrecognized relocation (0x2a) in section `.text._ZL7AddFilePKcPSo.constprop.25'\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 90.569s, Critical Path: 47.78s\nFAILED: Build did NOT complete successfully\n\n</code></pre>\n<p>Any idea will be welcome.</p>", "body_text": "System information\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NO\nTensorFlow installed from (source or binary): source\nTensorFlow version: r1.7\nPython version: Python 2.7\nInstalled using virtualenv? pip? conda?: Source\nBazel version (if compiling from source): 0.10.1\nGCC/Compiler version (if compiling from source): gcc-5.3\nCUDA/cuDNN version: 9.0 / 7.0.5\nGPU model and memory: TitanXP 12GB\n\nDescribe the problem\nThe CPU back-end TF compilation is successfully done, then I tried to compile the Tensorflow from source with GPU back-end support.\nAfter following the tutorial , the compilation is proceeded to about: [23xx/6xxx], then an error popped up which is as follow:\n.\n.\n.\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateAllocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:232:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index < graph_info_->num_nodes()) {\n                  ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateDeallocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:245:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index < graph_info_->num_nodes()) {\n                  ^\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc [for host]:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nINFO: From Compiling external/snappy/snappy.cc:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nINFO: From Compiling external/snappy/snappy.cc [for host]:\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\nERROR: /home/web_server/.cache/bazel/_bazel_web_server/9c777c8c1d70f40d5fbbacb4888a5481/external/protobuf_archive/BUILD:259:1: Linking of rule '@protobuf_archive//:js_embed' failed (Exit 1)\n/usr/bin/ld: bazel-out/host/bin/external/protobuf_archive/_objs/js_embed/external/protobuf_archive/src/google/protobuf/compiler/js/embed.o: unrecognized relocation (0x2a) in section `.text._ZL7AddFilePKcPSo.constprop.25'\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 72.355s, Critical Path: 26.30s\nFAILED: Build did NOT complete successfully\n\nI guess this shall be an known issue and something relevant to a configuration problem, however, I didn't find anything helpful.\n\nBelow is my ./configuration:\n$ ./configure \nWARNING: Running Bazel server needs to be killed, because the startup options are different.\nYou have bazel 0.10.1 installed.\nDo you wish to build TensorFlow with jemalloc as malloc support? [Y/n]: n\nNo jemalloc as malloc support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Google Cloud Platform support? [Y/n]: n\nNo Google Cloud Platform support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Hadoop File System support? [Y/n]: n\nNo Hadoop File System support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Amazon S3 File System support? [Y/n]: n\nNo Amazon S3 File System support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with Apache Kafka Platform support? [y/N]: n\nNo Apache Kafka Platform support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\nNo XLA JIT support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with GDR support? [y/N]: n\nNo GDR support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with VERBS support? [y/N]: n\nNo VERBS support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: n\nNo OpenCL SYCL support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\nCUDA support will be enabled for TensorFlow.\n\nPlease specify the CUDA SDK version you want to use, e.g. 7.0. [Leave empty to default to CUDA 9.0]: \n\n\nPlease specify the location where CUDA 9.0 toolkit is installed. Refer to README.md for more details. [Default is /usr/local/cuda]: /home/web_server/xiaolun/cuda-9.0\n\n\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuDNN 7.0]: \n\n\nPlease specify the location where cuDNN 7 library is installed. Refer to README.md for more details. [Default is /home/web_server/xiaolun/cuda-9.0]:\n\n\nDo you wish to build TensorFlow with TensorRT support? [y/N]: n\nNo TensorRT support will be enabled for TensorFlow.\n\nPlease specify a list of comma-separated Cuda compute capabilities you want to build with.\nYou can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.\nPlease note that each additional compute capability significantly increases your build time and binary size. [Default is: 6.1]\n\n\nDo you want to use clang as CUDA compiler? [y/N]: n\nnvcc will be used as CUDA compiler.\n\nPlease specify which gcc should be used by nvcc as the host compiler. [Default is /bin/gcc]: /home/web_server/gcc-5.3\n\n\nDo you wish to build TensorFlow with MPI support? [y/N]: n\nNo MPI support will be enabled for TensorFlow.\n\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native]: \n\n\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]: n\nNot configuring the WORKSPACE for Android builds.\n\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See tools/bazel.rc for more details.\n\t--config=mkl         \t# Build with MKL support.\n\t--config=monolithic  \t# Config for mostly static monolithic build.\nConfiguration finished\n\n\n\nI reset the environment variables and recompile it. This time the error is as below:\nINFO: From Compiling tensorflow/contrib/lite/arena_planner.cc:\ntensorflow/contrib/lite/arena_planner.cc: In member function 'virtual TfLiteStatus tflite::ArenaPlanner::PlanAllocations()':\ntensorflow/contrib/lite/arena_planner.cc:82:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (int i = 0; i < graph_info_->num_nodes(); ++i) {\n                     ^\ntensorflow/contrib/lite/arena_planner.cc:101:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (int i = 0; i < graph_info_->num_nodes(); ++i) {\n                     ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'virtual TfLiteStatus tflite::ArenaPlanner::ExecuteAllocations(int, int)':\ntensorflow/contrib/lite/arena_planner.cc:139:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for (int i = 0; i < graph_info_->num_tensors(); ++i) {\n                     ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateAllocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:232:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index < graph_info_->num_nodes()) {\n                  ^\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateDeallocationOfInternalTensors(int)':\ntensorflow/contrib/lite/arena_planner.cc:245:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   if (node_index < graph_info_->num_nodes()) {\n                  ^\nERROR: /home/web_server/.cache/bazel/_bazel_web_server/924cb0e3b475d8bc0bc364784129b908/external/protobuf_archive/BUILD:259:1: Linking of rule '@protobuf_archive//:js_embed' failed (Exit 1)\n/usr/bin/ld: bazel-out/host/bin/external/protobuf_archive/_objs/js_embed/external/protobuf_archive/src/google/protobuf/compiler/js/embed.o: unrecognized relocation (0x2a) in section `.text._ZL7AddFilePKcPSo.constprop.25'\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 90.569s, Critical Path: 47.78s\nFAILED: Build did NOT complete successfully\n\n\nAny idea will be welcome.", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NO\r\n- TensorFlow installed from (source or binary): source \r\n- TensorFlow version: r1.7\r\n- Python version: Python 2.7\r\n- Installed using virtualenv? pip? conda?: Source \r\n- Bazel version (if compiling from source): 0.10.1\r\n- GCC/Compiler version (if compiling from source): gcc-5.3\r\n- CUDA/cuDNN version: 9.0 / 7.0.5\r\n- GPU model and memory: TitanXP 12GB\r\n\r\n\r\n\r\n**Describe the problem**\r\nThe CPU back-end TF compilation is successfully done, then I tried to compile the Tensorflow from source with GPU back-end support.\r\nAfter following the tutorial [](https://www.tensorflow.org/install/source), the compilation is proceeded to about: [23xx/6xxx], then an error popped up which is as follow:\r\n```\r\n.\r\n.\r\n.\r\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateAllocationOfInternalTensors(int)':\r\ntensorflow/contrib/lite/arena_planner.cc:232:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   if (node_index < graph_info_->num_nodes()) {\r\n                  ^\r\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateDeallocationOfInternalTensors(int)':\r\ntensorflow/contrib/lite/arena_planner.cc:245:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   if (node_index < graph_info_->num_nodes()) {\r\n                  ^\r\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\r\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc [for host]:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\r\nINFO: From Compiling external/snappy/snappy.cc:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\r\nINFO: From Compiling external/snappy/snappy.cc [for host]:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\ncc1plus: warning: unrecognized command line option '-Wno-shift-negative-value'\r\nERROR: /home/web_server/.cache/bazel/_bazel_web_server/9c777c8c1d70f40d5fbbacb4888a5481/external/protobuf_archive/BUILD:259:1: Linking of rule '@protobuf_archive//:js_embed' failed (Exit 1)\r\n/usr/bin/ld: bazel-out/host/bin/external/protobuf_archive/_objs/js_embed/external/protobuf_archive/src/google/protobuf/compiler/js/embed.o: unrecognized relocation (0x2a) in section `.text._ZL7AddFilePKcPSo.constprop.25'\r\n/usr/bin/ld: final link failed: Bad value\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 72.355s, Critical Path: 26.30s\r\nFAILED: Build did NOT complete successfully\r\n```\r\nI guess this shall be an known issue and something relevant to a configuration problem, however, I didn't find anything helpful.\r\n\r\n-------\r\n```\r\nBelow is my ./configuration:\r\n$ ./configure \r\nWARNING: Running Bazel server needs to be killed, because the startup options are different.\r\nYou have bazel 0.10.1 installed.\r\nDo you wish to build TensorFlow with jemalloc as malloc support? [Y/n]: n\r\nNo jemalloc as malloc support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with Google Cloud Platform support? [Y/n]: n\r\nNo Google Cloud Platform support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with Hadoop File System support? [Y/n]: n\r\nNo Hadoop File System support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with Amazon S3 File System support? [Y/n]: n\r\nNo Amazon S3 File System support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with Apache Kafka Platform support? [y/N]: n\r\nNo Apache Kafka Platform support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\r\nNo XLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with GDR support? [y/N]: n\r\nNo GDR support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with VERBS support? [y/N]: n\r\nNo VERBS support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: n\r\nNo OpenCL SYCL support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify the CUDA SDK version you want to use, e.g. 7.0. [Leave empty to default to CUDA 9.0]: \r\n\r\n\r\nPlease specify the location where CUDA 9.0 toolkit is installed. Refer to README.md for more details. [Default is /usr/local/cuda]: /home/web_server/xiaolun/cuda-9.0\r\n\r\n\r\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuDNN 7.0]: \r\n\r\n\r\nPlease specify the location where cuDNN 7 library is installed. Refer to README.md for more details. [Default is /home/web_server/xiaolun/cuda-9.0]:\r\n\r\n\r\nDo you wish to build TensorFlow with TensorRT support? [y/N]: n\r\nNo TensorRT support will be enabled for TensorFlow.\r\n\r\nPlease specify a list of comma-separated Cuda compute capabilities you want to build with.\r\nYou can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.\r\nPlease note that each additional compute capability significantly increases your build time and binary size. [Default is: 6.1]\r\n\r\n\r\nDo you want to use clang as CUDA compiler? [y/N]: n\r\nnvcc will be used as CUDA compiler.\r\n\r\nPlease specify which gcc should be used by nvcc as the host compiler. [Default is /bin/gcc]: /home/web_server/gcc-5.3\r\n\r\n\r\nDo you wish to build TensorFlow with MPI support? [y/N]: n\r\nNo MPI support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native]: \r\n\r\n\r\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]: n\r\nNot configuring the WORKSPACE for Android builds.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See tools/bazel.rc for more details.\r\n\t--config=mkl         \t# Build with MKL support.\r\n\t--config=monolithic  \t# Config for mostly static monolithic build.\r\nConfiguration finished\r\n\r\n```\r\n\r\n------------\r\n\r\nI reset the environment variables and recompile it. This time the error is as below:\r\n```\r\nINFO: From Compiling tensorflow/contrib/lite/arena_planner.cc:\r\ntensorflow/contrib/lite/arena_planner.cc: In member function 'virtual TfLiteStatus tflite::ArenaPlanner::PlanAllocations()':\r\ntensorflow/contrib/lite/arena_planner.cc:82:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   for (int i = 0; i < graph_info_->num_nodes(); ++i) {\r\n                     ^\r\ntensorflow/contrib/lite/arena_planner.cc:101:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   for (int i = 0; i < graph_info_->num_nodes(); ++i) {\r\n                     ^\r\ntensorflow/contrib/lite/arena_planner.cc: In member function 'virtual TfLiteStatus tflite::ArenaPlanner::ExecuteAllocations(int, int)':\r\ntensorflow/contrib/lite/arena_planner.cc:139:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   for (int i = 0; i < graph_info_->num_tensors(); ++i) {\r\n                     ^\r\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateAllocationOfInternalTensors(int)':\r\ntensorflow/contrib/lite/arena_planner.cc:232:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   if (node_index < graph_info_->num_nodes()) {\r\n                  ^\r\ntensorflow/contrib/lite/arena_planner.cc: In member function 'TfLiteStatus tflite::ArenaPlanner::CalculateDeallocationOfInternalTensors(int)':\r\ntensorflow/contrib/lite/arena_planner.cc:245:18: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   if (node_index < graph_info_->num_nodes()) {\r\n                  ^\r\nERROR: /home/web_server/.cache/bazel/_bazel_web_server/924cb0e3b475d8bc0bc364784129b908/external/protobuf_archive/BUILD:259:1: Linking of rule '@protobuf_archive//:js_embed' failed (Exit 1)\r\n/usr/bin/ld: bazel-out/host/bin/external/protobuf_archive/_objs/js_embed/external/protobuf_archive/src/google/protobuf/compiler/js/embed.o: unrecognized relocation (0x2a) in section `.text._ZL7AddFilePKcPSo.constprop.25'\r\n/usr/bin/ld: final link failed: Bad value\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 90.569s, Critical Path: 47.78s\r\nFAILED: Build did NOT complete successfully\r\n\r\n```\r\n\r\nAny idea will be welcome.\r\n"}