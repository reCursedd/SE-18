{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/288921186", "html_url": "https://github.com/tensorflow/tensorflow/issues/8567#issuecomment-288921186", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8567", "id": 288921186, "node_id": "MDEyOklzc3VlQ29tbWVudDI4ODkyMTE4Ng==", "user": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-24T03:05:17Z", "updated_at": "2017-03-24T14:34:03Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1497445\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/derekhh\">@derekhh</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=88808\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/skye\">@skye</a><br>\nAssuming the <code>sess.run([key, image])</code> does not run in a distributed setting, tfdbg (TensorFlow Debugger) should be able to help here. (tfdbg supports only <code>DirectSessions</code> right now; support for distributed session is in the works.)</p>\n<p>Modifying <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1497445\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/derekhh\">@derekhh</a> 's code example a little, we have:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">from</span> tensorflow.python <span class=\"pl-k\">import</span> debug <span class=\"pl-k\">as</span> tf_debug  <span class=\"pl-c\"><span class=\"pl-c\">#</span> tfdbg-required import</span>\n\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n    <span class=\"pl-c\"><span class=\"pl-c\">#</span> Activate tfdbg CLI!</span>\n    sess <span class=\"pl-k\">=</span> tf_debug.LocalCLIDebugWrapperSession(sess)\n\n    coord <span class=\"pl-k\">=</span> tf.train.Coordinator()\n    threads <span class=\"pl-k\">=</span> tf.train.start_queue_runners(<span class=\"pl-v\">coord</span><span class=\"pl-k\">=</span>coord)\n\n    num_files <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0</span>\n    num_failed <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0</span>\n    <span class=\"pl-k\">while</span> <span class=\"pl-k\">not</span> coord.should_stop():\n      <span class=\"pl-k\">try</span>:\n        key_val, image_val <span class=\"pl-k\">=</span> sess.run([key, image])\n        num_files <span class=\"pl-k\">+=</span> <span class=\"pl-c1\">1</span>\n      <span class=\"pl-k\">except</span> tf.errors.InvalidArgumentError:\n        num_failed <span class=\"pl-k\">+=</span> <span class=\"pl-c1\">1</span></pre></div>\n<p>Then, when you run your program, you will automatically drop to the tfdbg CLI. Keep entering <code>tfdbg&gt; run</code> until you reach the error screen that looks like the<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/16824702/24298761/5fcdf53e-107d-11e7-82c3-0bf03b03180c.png\"><img src=\"https://cloud.githubusercontent.com/assets/16824702/24298761/5fcdf53e-107d-11e7-82c3-0bf03b03180c.png\" alt=\"gh1\" style=\"max-width:100%;\"></a></p>\n<p>(You may run into the problem that there are too many images and you need to enter <code>run</code> too many times to encounter the first error. In that case, you can set <code>shuffle=False</code> and figure out in which iteration the error occurs. Say it is the 12345th iteration. Then in tfdbg CLI, you can do <code>tfdbg&gt; run -t 12345</code> to stop at the error.)</p>\n<p>Click the <code>li -r cond/DecodeJpeg</code> link with your mouse (or type it in, if you like typing) and you'll see a screen like the following:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/16824702/24278808/73d4159c-101c-11e7-8e4f-e76e5493988c.png\"><img src=\"https://cloud.githubusercontent.com/assets/16824702/24278808/73d4159c-101c-11e7-8e4f-e76e5493988c.png\" alt=\"debug_string_input_producer_2\" style=\"max-width:100%;\"></a></p>\n<p>The first input, namely <code>cond/DecodeJpeg/Switch</code>, corresponds to the tf.cond node. The node <code>ReaderReadV2</code> is the input to the <code>PyFunc</code>. To see the value of the first output (i.e., the key) of it, do</p>\n<pre><code>tfdbg&gt; pt ReaderReadV2:0\n</code></pre>\n<p>and that should give you the value of the file name/path string.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/16824702/24278907/2da6c064-101d-11e7-939a-b0258f753b4b.png\"><img src=\"https://cloud.githubusercontent.com/assets/16824702/24278907/2da6c064-101d-11e7-939a-b0258f753b4b.png\" alt=\"debug_string_input_producer_3\" style=\"max-width:100%;\"></a></p>\n<p>Foot note: I don't know what version of TF you are using, but tfdbg UI has undergone some improvement since the 1.0 release. The screenshots above are generated with the latest release (1.1.0rc0). So please use 1.1.0rc0 or nightly if you want the best experience.</p>", "body_text": "@derekhh @skye\nAssuming the sess.run([key, image]) does not run in a distributed setting, tfdbg (TensorFlow Debugger) should be able to help here. (tfdbg supports only DirectSessions right now; support for distributed session is in the works.)\nModifying @derekhh 's code example a little, we have:\nfrom tensorflow.python import debug as tf_debug  # tfdbg-required import\n\nwith tf.Session() as sess:\n    # Activate tfdbg CLI!\n    sess = tf_debug.LocalCLIDebugWrapperSession(sess)\n\n    coord = tf.train.Coordinator()\n    threads = tf.train.start_queue_runners(coord=coord)\n\n    num_files = 0\n    num_failed = 0\n    while not coord.should_stop():\n      try:\n        key_val, image_val = sess.run([key, image])\n        num_files += 1\n      except tf.errors.InvalidArgumentError:\n        num_failed += 1\nThen, when you run your program, you will automatically drop to the tfdbg CLI. Keep entering tfdbg> run until you reach the error screen that looks like the\n\n(You may run into the problem that there are too many images and you need to enter run too many times to encounter the first error. In that case, you can set shuffle=False and figure out in which iteration the error occurs. Say it is the 12345th iteration. Then in tfdbg CLI, you can do tfdbg> run -t 12345 to stop at the error.)\nClick the li -r cond/DecodeJpeg link with your mouse (or type it in, if you like typing) and you'll see a screen like the following:\n\nThe first input, namely cond/DecodeJpeg/Switch, corresponds to the tf.cond node. The node ReaderReadV2 is the input to the PyFunc. To see the value of the first output (i.e., the key) of it, do\ntfdbg> pt ReaderReadV2:0\n\nand that should give you the value of the file name/path string.\n\nFoot note: I don't know what version of TF you are using, but tfdbg UI has undergone some improvement since the 1.0 release. The screenshots above are generated with the latest release (1.1.0rc0). So please use 1.1.0rc0 or nightly if you want the best experience.", "body": "@derekhh @skye \r\nAssuming the `sess.run([key, image])` does not run in a distributed setting, tfdbg (TensorFlow Debugger) should be able to help here. (tfdbg supports only `DirectSessions` right now; support for distributed session is in the works.)\r\n\r\nModifying @derekhh 's code example a little, we have:\r\n```python\r\nfrom tensorflow.python import debug as tf_debug  # tfdbg-required import\r\n\r\nwith tf.Session() as sess:\r\n    # Activate tfdbg CLI!\r\n    sess = tf_debug.LocalCLIDebugWrapperSession(sess)\r\n\r\n    coord = tf.train.Coordinator()\r\n    threads = tf.train.start_queue_runners(coord=coord)\r\n\r\n    num_files = 0\r\n    num_failed = 0\r\n    while not coord.should_stop():\r\n      try:\r\n        key_val, image_val = sess.run([key, image])\r\n        num_files += 1\r\n      except tf.errors.InvalidArgumentError:\r\n        num_failed += 1\r\n```\r\n\r\nThen, when you run your program, you will automatically drop to the tfdbg CLI. Keep entering `tfdbg> run` until you reach the error screen that looks like the\r\n![gh1](https://cloud.githubusercontent.com/assets/16824702/24298761/5fcdf53e-107d-11e7-82c3-0bf03b03180c.png)\r\n\r\n(You may run into the problem that there are too many images and you need to enter `run` too many times to encounter the first error. In that case, you can set `shuffle=False` and figure out in which iteration the error occurs. Say it is the 12345th iteration. Then in tfdbg CLI, you can do `tfdbg> run -t 12345` to stop at the error.)\r\n\r\nClick the `li -r cond/DecodeJpeg` link with your mouse (or type it in, if you like typing) and you'll see a screen like the following:\r\n![debug_string_input_producer_2](https://cloud.githubusercontent.com/assets/16824702/24278808/73d4159c-101c-11e7-8e4f-e76e5493988c.png)\r\n\r\nThe first input, namely `cond/DecodeJpeg/Switch`, corresponds to the tf.cond node. The node `ReaderReadV2` is the input to the `PyFunc`. To see the value of the first output (i.e., the key) of it, do\r\n```\r\ntfdbg> pt ReaderReadV2:0\r\n```\r\nand that should give you the value of the file name/path string.\r\n![debug_string_input_producer_3](https://cloud.githubusercontent.com/assets/16824702/24278907/2da6c064-101d-11e7-939a-b0258f753b4b.png)\r\n\r\nFoot note: I don't know what version of TF you are using, but tfdbg UI has undergone some improvement since the 1.0 release. The screenshots above are generated with the latest release (1.1.0rc0). So please use 1.1.0rc0 or nightly if you want the best experience.\r\n\r\n\r\n"}