{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22304", "id": 360709968, "node_id": "MDU6SXNzdWUzNjA3MDk5Njg=", "number": 22304, "title": "C++   set_allow_soft_placement does not work", "user": {"login": "xu-song", "id": 13825126, "node_id": "MDQ6VXNlcjEzODI1MTI2", "avatar_url": "https://avatars3.githubusercontent.com/u/13825126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xu-song", "html_url": "https://github.com/xu-song", "followers_url": "https://api.github.com/users/xu-song/followers", "following_url": "https://api.github.com/users/xu-song/following{/other_user}", "gists_url": "https://api.github.com/users/xu-song/gists{/gist_id}", "starred_url": "https://api.github.com/users/xu-song/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xu-song/subscriptions", "organizations_url": "https://api.github.com/users/xu-song/orgs", "repos_url": "https://api.github.com/users/xu-song/repos", "events_url": "https://api.github.com/users/xu-song/events{/privacy}", "received_events_url": "https://api.github.com/users/xu-song/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-09-17T03:02:13Z", "updated_at": "2018-11-13T18:57:18Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:</li>\n<li>**OS Platform and Distribution: Mac  CPU</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.8.0</li>\n<li><strong>Python version</strong>: 2.7</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I have set set_allow_soft_placement(true), but it does not work.</p>\n<h3>Source code / logs</h3>\n<p>c++ source code</p>\n<div class=\"highlight highlight-source-c++\"><pre>    <span class=\"pl-k\">const</span> string pathToGraph = \u201ctf/checkpoint/model-<span class=\"pl-c1\">1</span>.meta<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>;</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">    tensorflow::SessionOptions options;</span>\n<span class=\"pl-s\">    options.config.set_allow_soft_placement(true);  // why this does not work?</span>\n<span class=\"pl-s\">    auto session = NewSession(options);</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">    Status status = session-&gt;Create(graph_def.graph_def());</span>\n<span class=\"pl-s\"></span></pre></div>\n<p>It get errors in my mac(cpu),  no error in GPU.</p>\n<div class=\"highlight highlight-source-shell\"><pre>./eval\nlibc++abi.dylib: terminating with uncaught exception of <span class=\"pl-c1\">type</span> std::runtime_error: \nError creating graph: Invalid argument: Cannot assign a device <span class=\"pl-k\">for</span> \noperation <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ExponentialMovingAverage/AssignMovingAvg_5/sub<span class=\"pl-pds\">'</span></span>: \nOperation was explicitly assigned to /device:GPU:0 but available devices are \n[ /job:localhost/replica:0/task:0/device:CPU:0 ]. \nMake sure the device specification refers to a valid device.</pre></div>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\n**OS Platform and Distribution: Mac  CPU\nTensorFlow installed from (source or binary): binary\nTensorFlow version (use command below): 1.8.0\nPython version: 2.7\n\nDescribe the problem\nI have set set_allow_soft_placement(true), but it does not work.\nSource code / logs\nc++ source code\n    const string pathToGraph = \u201ctf/checkpoint/model-1.meta\";\n\n    tensorflow::SessionOptions options;\n    options.config.set_allow_soft_placement(true);  // why this does not work?\n    auto session = NewSession(options);\n\n    Status status = session->Create(graph_def.graph_def());\n\nIt get errors in my mac(cpu),  no error in GPU.\n./eval\nlibc++abi.dylib: terminating with uncaught exception of type std::runtime_error: \nError creating graph: Invalid argument: Cannot assign a device for \noperation 'ExponentialMovingAverage/AssignMovingAvg_5/sub': \nOperation was explicitly assigned to /device:GPU:0 but available devices are \n[ /job:localhost/replica:0/task:0/device:CPU:0 ]. \nMake sure the device specification refers to a valid device.", "body": "\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution: Mac  CPU\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.8.0\r\n- **Python version**: 2.7\r\n\r\n### Describe the problem\r\n\r\nI have set set_allow_soft_placement(true), but it does not work.\r\n\r\n\r\n\r\n### Source code / logs\r\n\r\n\r\nc++ source code\r\n```c++\r\n    const string pathToGraph = \u201ctf/checkpoint/model-1.meta\";\r\n\r\n    tensorflow::SessionOptions options;\r\n    options.config.set_allow_soft_placement(true);  // why this does not work?\r\n    auto session = NewSession(options);\r\n\r\n    Status status = session->Create(graph_def.graph_def());\r\n\r\n```\r\n\r\nIt get errors in my mac(cpu),  no error in GPU.\r\n\r\n```sh\r\n./eval\r\nlibc++abi.dylib: terminating with uncaught exception of type std::runtime_error: \r\nError creating graph: Invalid argument: Cannot assign a device for \r\noperation 'ExponentialMovingAverage/AssignMovingAvg_5/sub': \r\nOperation was explicitly assigned to /device:GPU:0 but available devices are \r\n[ /job:localhost/replica:0/task:0/device:CPU:0 ]. \r\nMake sure the device specification refers to a valid device.\r\n```\r\n"}