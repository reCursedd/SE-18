{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3897", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3897/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3897/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3897/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3897", "id": 171856978, "node_id": "MDU6SXNzdWUxNzE4NTY5Nzg=", "number": 3897, "title": "Tensorflow gradients are always zero!", "user": {"login": "inderpreetsganda", "id": 10248819, "node_id": "MDQ6VXNlcjEwMjQ4ODE5", "avatar_url": "https://avatars0.githubusercontent.com/u/10248819?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inderpreetsganda", "html_url": "https://github.com/inderpreetsganda", "followers_url": "https://api.github.com/users/inderpreetsganda/followers", "following_url": "https://api.github.com/users/inderpreetsganda/following{/other_user}", "gists_url": "https://api.github.com/users/inderpreetsganda/gists{/gist_id}", "starred_url": "https://api.github.com/users/inderpreetsganda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inderpreetsganda/subscriptions", "organizations_url": "https://api.github.com/users/inderpreetsganda/orgs", "repos_url": "https://api.github.com/users/inderpreetsganda/repos", "events_url": "https://api.github.com/users/inderpreetsganda/events{/privacy}", "received_events_url": "https://api.github.com/users/inderpreetsganda/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-08-18T09:28:11Z", "updated_at": "2016-08-20T06:19:18Z", "closed_at": "2016-08-20T06:19:18Z", "author_association": "NONE", "body_html": "<p>Tensorflow gradients are always zero with respect to conv layers that are after first conv layer. I've tried different ways to check that but gradients are always zero! Here is the small reproducible code that can be run to check that.</p>\n<pre><code>from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\nimport numpy as np\nimport math\nimport os\nimport random\nimport tflearn\nbatch_size = 100\nstart = 0\nend = batch_size\nlearning_rate = 0.000001\nnum_classes = 4\ntime_steps = 4\nembedding = 2\nstep = 1\n_units = 500\nnum_of_filters = 1000\n\ntrain_set_x = [[[1,2],[3,4],[5,6],[7,8]],[[1,2],[3,4],[5,6],[7,8]]]\ntrain_set_y = [0,1]\n\nX = tf.placeholder(tf.float32, [None,time_steps,embedding])\nY = tf.placeholder(tf.int32, [None])\n\n\nx = tf.expand_dims(X,3)\n\nfilter_shape = [1, embedding, 1, num_of_filters]\nconv_weights = tf.get_variable(\"conv_weights1\" , filter_shape, tf.float32, tf.contrib.layers.xavier_initializer())\nconv_biases = tf.Variable(tf.constant(0.1, shape=[num_of_filters]))\nconv = tf.nn.conv2d(x, conv_weights, strides=[1,1,1,1], padding = \"VALID\")\nnormalize = conv + conv_biases\ntf_normalize = tflearn.layers.normalization.batch_normalization(normalize)\nrelu = tf.nn.elu(tf_normalize)\npooling = tf.reduce_max(relu, reduction_indices = 3, keep_dims = True)\noutputs_fed_lstm = pooling\n\nfilter_shape2 = [1, 1, 1, num_of_filters]\nconv_weights2 = tf.get_variable(\"conv_weights2\" , filter_shape2, tf.float32, tf.contrib.layers.xavier_initializer())\nconv_biases2 = tf.Variable(tf.constant(0.1, shape=[num_of_filters]))\nconv2 = tf.nn.conv2d(outputs_fed_lstm, conv_weights2, strides=[1,1,1,1], padding = \"VALID\")\nnormalize2 = conv2 + conv_biases2\ntf_normalize2 = tflearn.layers.normalization.batch_normalization(normalize2)\nrelu2 = tf.nn.elu(tf_normalize2)\npooling2 = tf.reduce_max(relu2, reduction_indices = 3, keep_dims = True)\noutputs_fed_lstm2 = pooling2\n\nx = tf.squeeze(outputs_fed_lstm2, [2])     \nx = tf.transpose(x, [1, 0, 2])\nx = tf.reshape(x, [-1, 1])\nx = tf.split(0, time_steps, x)\n\nlstm = tf.nn.rnn_cell.LSTMCell(num_units = _units)\n\n# multi_lstm = tf.nn.rnn_cell.MultiRNNCell([lstm] * lstm_layers, state_is_tuple = True)\n\noutputs , state = tf.nn.rnn(lstm,x, dtype = tf.float32)     \n\nweights = tf.Variable(tf.random_normal([_units,num_classes]))\nbiases  = tf.Variable(tf.random_normal([num_classes]))\n\nlogits = tf.matmul(outputs[-1], weights) + biases\n\n\n\nc_loss = tf.nn.sparse_softmax_cross_entropy_with_logits(logits,Y)\nloss = tf.reduce_mean(c_loss)\n\n\nglobal_step = tf.Variable(0, name=\"global_step\", trainable=False)\n# decayed_learning_rate = tf.train.exponential_decay(learning_rate,0,10000,0.9)\noptimizer= tf.train.AdamOptimizer(learning_rate)\nminimize_loss = optimizer.minimize(loss, global_step=global_step)   \ngrads_and_vars = optimizer.compute_gradients(loss,[conv_weights2]) \ncorrect_predict = tf.nn.in_top_k(logits, Y, 1)\naccuracy = tf.reduce_mean(tf.cast(correct_predict, tf.float32))\n\n\ninit = tf.initialize_all_variables()\n\nwith tf.Session() as sess:\n     sess.run(init)\n     for i in range(1):\n         for j in range(1):\n             x = train_set_x\n             y = train_set_y\n             sess.run(minimize_loss,feed_dict={X : x, Y : y})\n             step += 1  \n             gr_print = sess.run([grad for grad, _ in grads_and_vars], feed_dict={X : x, Y : y})\n             print (gr_print)\n             cost = sess.run(loss,feed_dict = {X: x,Y: y})\n             accu = sess.run(accuracy,feed_dict = {X: x, Y: y})\n             print (\"Loss after one Epoch(Training) = \" + \"{:.6f}\".format(cost) + \", Training Accuracy= \" + \"{:.5f}\".format(accu))\n</code></pre>\n<p>And here is the output</p>\n<pre><code>[array([[[[ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  5.21326828,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ]]]], dtype=float32)]\n</code></pre>", "body_text": "Tensorflow gradients are always zero with respect to conv layers that are after first conv layer. I've tried different ways to check that but gradients are always zero! Here is the small reproducible code that can be run to check that.\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\nimport numpy as np\nimport math\nimport os\nimport random\nimport tflearn\nbatch_size = 100\nstart = 0\nend = batch_size\nlearning_rate = 0.000001\nnum_classes = 4\ntime_steps = 4\nembedding = 2\nstep = 1\n_units = 500\nnum_of_filters = 1000\n\ntrain_set_x = [[[1,2],[3,4],[5,6],[7,8]],[[1,2],[3,4],[5,6],[7,8]]]\ntrain_set_y = [0,1]\n\nX = tf.placeholder(tf.float32, [None,time_steps,embedding])\nY = tf.placeholder(tf.int32, [None])\n\n\nx = tf.expand_dims(X,3)\n\nfilter_shape = [1, embedding, 1, num_of_filters]\nconv_weights = tf.get_variable(\"conv_weights1\" , filter_shape, tf.float32, tf.contrib.layers.xavier_initializer())\nconv_biases = tf.Variable(tf.constant(0.1, shape=[num_of_filters]))\nconv = tf.nn.conv2d(x, conv_weights, strides=[1,1,1,1], padding = \"VALID\")\nnormalize = conv + conv_biases\ntf_normalize = tflearn.layers.normalization.batch_normalization(normalize)\nrelu = tf.nn.elu(tf_normalize)\npooling = tf.reduce_max(relu, reduction_indices = 3, keep_dims = True)\noutputs_fed_lstm = pooling\n\nfilter_shape2 = [1, 1, 1, num_of_filters]\nconv_weights2 = tf.get_variable(\"conv_weights2\" , filter_shape2, tf.float32, tf.contrib.layers.xavier_initializer())\nconv_biases2 = tf.Variable(tf.constant(0.1, shape=[num_of_filters]))\nconv2 = tf.nn.conv2d(outputs_fed_lstm, conv_weights2, strides=[1,1,1,1], padding = \"VALID\")\nnormalize2 = conv2 + conv_biases2\ntf_normalize2 = tflearn.layers.normalization.batch_normalization(normalize2)\nrelu2 = tf.nn.elu(tf_normalize2)\npooling2 = tf.reduce_max(relu2, reduction_indices = 3, keep_dims = True)\noutputs_fed_lstm2 = pooling2\n\nx = tf.squeeze(outputs_fed_lstm2, [2])     \nx = tf.transpose(x, [1, 0, 2])\nx = tf.reshape(x, [-1, 1])\nx = tf.split(0, time_steps, x)\n\nlstm = tf.nn.rnn_cell.LSTMCell(num_units = _units)\n\n# multi_lstm = tf.nn.rnn_cell.MultiRNNCell([lstm] * lstm_layers, state_is_tuple = True)\n\noutputs , state = tf.nn.rnn(lstm,x, dtype = tf.float32)     \n\nweights = tf.Variable(tf.random_normal([_units,num_classes]))\nbiases  = tf.Variable(tf.random_normal([num_classes]))\n\nlogits = tf.matmul(outputs[-1], weights) + biases\n\n\n\nc_loss = tf.nn.sparse_softmax_cross_entropy_with_logits(logits,Y)\nloss = tf.reduce_mean(c_loss)\n\n\nglobal_step = tf.Variable(0, name=\"global_step\", trainable=False)\n# decayed_learning_rate = tf.train.exponential_decay(learning_rate,0,10000,0.9)\noptimizer= tf.train.AdamOptimizer(learning_rate)\nminimize_loss = optimizer.minimize(loss, global_step=global_step)   \ngrads_and_vars = optimizer.compute_gradients(loss,[conv_weights2]) \ncorrect_predict = tf.nn.in_top_k(logits, Y, 1)\naccuracy = tf.reduce_mean(tf.cast(correct_predict, tf.float32))\n\n\ninit = tf.initialize_all_variables()\n\nwith tf.Session() as sess:\n     sess.run(init)\n     for i in range(1):\n         for j in range(1):\n             x = train_set_x\n             y = train_set_y\n             sess.run(minimize_loss,feed_dict={X : x, Y : y})\n             step += 1  \n             gr_print = sess.run([grad for grad, _ in grads_and_vars], feed_dict={X : x, Y : y})\n             print (gr_print)\n             cost = sess.run(loss,feed_dict = {X: x,Y: y})\n             accu = sess.run(accuracy,feed_dict = {X: x, Y: y})\n             print (\"Loss after one Epoch(Training) = \" + \"{:.6f}\".format(cost) + \", Training Accuracy= \" + \"{:.5f}\".format(accu))\n\nAnd here is the output\n[array([[[[ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  5.21326828,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ]]]], dtype=float32)]", "body": "Tensorflow gradients are always zero with respect to conv layers that are after first conv layer. I've tried different ways to check that but gradients are always zero! Here is the small reproducible code that can be run to check that.\n\n```\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\nimport numpy as np\nimport math\nimport os\nimport random\nimport tflearn\nbatch_size = 100\nstart = 0\nend = batch_size\nlearning_rate = 0.000001\nnum_classes = 4\ntime_steps = 4\nembedding = 2\nstep = 1\n_units = 500\nnum_of_filters = 1000\n\ntrain_set_x = [[[1,2],[3,4],[5,6],[7,8]],[[1,2],[3,4],[5,6],[7,8]]]\ntrain_set_y = [0,1]\n\nX = tf.placeholder(tf.float32, [None,time_steps,embedding])\nY = tf.placeholder(tf.int32, [None])\n\n\nx = tf.expand_dims(X,3)\n\nfilter_shape = [1, embedding, 1, num_of_filters]\nconv_weights = tf.get_variable(\"conv_weights1\" , filter_shape, tf.float32, tf.contrib.layers.xavier_initializer())\nconv_biases = tf.Variable(tf.constant(0.1, shape=[num_of_filters]))\nconv = tf.nn.conv2d(x, conv_weights, strides=[1,1,1,1], padding = \"VALID\")\nnormalize = conv + conv_biases\ntf_normalize = tflearn.layers.normalization.batch_normalization(normalize)\nrelu = tf.nn.elu(tf_normalize)\npooling = tf.reduce_max(relu, reduction_indices = 3, keep_dims = True)\noutputs_fed_lstm = pooling\n\nfilter_shape2 = [1, 1, 1, num_of_filters]\nconv_weights2 = tf.get_variable(\"conv_weights2\" , filter_shape2, tf.float32, tf.contrib.layers.xavier_initializer())\nconv_biases2 = tf.Variable(tf.constant(0.1, shape=[num_of_filters]))\nconv2 = tf.nn.conv2d(outputs_fed_lstm, conv_weights2, strides=[1,1,1,1], padding = \"VALID\")\nnormalize2 = conv2 + conv_biases2\ntf_normalize2 = tflearn.layers.normalization.batch_normalization(normalize2)\nrelu2 = tf.nn.elu(tf_normalize2)\npooling2 = tf.reduce_max(relu2, reduction_indices = 3, keep_dims = True)\noutputs_fed_lstm2 = pooling2\n\nx = tf.squeeze(outputs_fed_lstm2, [2])     \nx = tf.transpose(x, [1, 0, 2])\nx = tf.reshape(x, [-1, 1])\nx = tf.split(0, time_steps, x)\n\nlstm = tf.nn.rnn_cell.LSTMCell(num_units = _units)\n\n# multi_lstm = tf.nn.rnn_cell.MultiRNNCell([lstm] * lstm_layers, state_is_tuple = True)\n\noutputs , state = tf.nn.rnn(lstm,x, dtype = tf.float32)     \n\nweights = tf.Variable(tf.random_normal([_units,num_classes]))\nbiases  = tf.Variable(tf.random_normal([num_classes]))\n\nlogits = tf.matmul(outputs[-1], weights) + biases\n\n\n\nc_loss = tf.nn.sparse_softmax_cross_entropy_with_logits(logits,Y)\nloss = tf.reduce_mean(c_loss)\n\n\nglobal_step = tf.Variable(0, name=\"global_step\", trainable=False)\n# decayed_learning_rate = tf.train.exponential_decay(learning_rate,0,10000,0.9)\noptimizer= tf.train.AdamOptimizer(learning_rate)\nminimize_loss = optimizer.minimize(loss, global_step=global_step)   \ngrads_and_vars = optimizer.compute_gradients(loss,[conv_weights2]) \ncorrect_predict = tf.nn.in_top_k(logits, Y, 1)\naccuracy = tf.reduce_mean(tf.cast(correct_predict, tf.float32))\n\n\ninit = tf.initialize_all_variables()\n\nwith tf.Session() as sess:\n     sess.run(init)\n     for i in range(1):\n         for j in range(1):\n             x = train_set_x\n             y = train_set_y\n             sess.run(minimize_loss,feed_dict={X : x, Y : y})\n             step += 1  \n             gr_print = sess.run([grad for grad, _ in grads_and_vars], feed_dict={X : x, Y : y})\n             print (gr_print)\n             cost = sess.run(loss,feed_dict = {X: x,Y: y})\n             accu = sess.run(accuracy,feed_dict = {X: x, Y: y})\n             print (\"Loss after one Epoch(Training) = \" + \"{:.6f}\".format(cost) + \", Training Accuracy= \" + \"{:.5f}\".format(accu))\n```\n\nAnd here is the output\n\n```\n[array([[[[ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  5.21326828,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ,\n           0.        ,  0.        ,  0.        ,  0.        ,  0.        ]]]], dtype=float32)]\n```\n"}