{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1095", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1095/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1095/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1095/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1095", "id": 133547223, "node_id": "MDU6SXNzdWUxMzM1NDcyMjM=", "number": 1095, "title": "Gradient of tf.py_func and how to define gradients for a custom op only with python", "user": {"login": "carpedm20", "id": 3346407, "node_id": "MDQ6VXNlcjMzNDY0MDc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3346407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carpedm20", "html_url": "https://github.com/carpedm20", "followers_url": "https://api.github.com/users/carpedm20/followers", "following_url": "https://api.github.com/users/carpedm20/following{/other_user}", "gists_url": "https://api.github.com/users/carpedm20/gists{/gist_id}", "starred_url": "https://api.github.com/users/carpedm20/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carpedm20/subscriptions", "organizations_url": "https://api.github.com/users/carpedm20/orgs", "repos_url": "https://api.github.com/users/carpedm20/repos", "events_url": "https://api.github.com/users/carpedm20/events{/privacy}", "received_events_url": "https://api.github.com/users/carpedm20/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "zffchen78", "id": 7943790, "node_id": "MDQ6VXNlcjc5NDM3OTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/7943790?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zffchen78", "html_url": "https://github.com/zffchen78", "followers_url": "https://api.github.com/users/zffchen78/followers", "following_url": "https://api.github.com/users/zffchen78/following{/other_user}", "gists_url": "https://api.github.com/users/zffchen78/gists{/gist_id}", "starred_url": "https://api.github.com/users/zffchen78/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zffchen78/subscriptions", "organizations_url": "https://api.github.com/users/zffchen78/orgs", "repos_url": "https://api.github.com/users/zffchen78/repos", "events_url": "https://api.github.com/users/zffchen78/events{/privacy}", "received_events_url": "https://api.github.com/users/zffchen78/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "zffchen78", "id": 7943790, "node_id": "MDQ6VXNlcjc5NDM3OTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/7943790?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zffchen78", "html_url": "https://github.com/zffchen78", "followers_url": "https://api.github.com/users/zffchen78/followers", "following_url": "https://api.github.com/users/zffchen78/following{/other_user}", "gists_url": "https://api.github.com/users/zffchen78/gists{/gist_id}", "starred_url": "https://api.github.com/users/zffchen78/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zffchen78/subscriptions", "organizations_url": "https://api.github.com/users/zffchen78/orgs", "repos_url": "https://api.github.com/users/zffchen78/repos", "events_url": "https://api.github.com/users/zffchen78/events{/privacy}", "received_events_url": "https://api.github.com/users/zffchen78/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 26, "created_at": "2016-02-14T15:20:05Z", "updated_at": "2018-08-12T15:07:28Z", "closed_at": "2016-06-08T22:48:08Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I know about <code>tf.py_func</code> which I can use a python code as an op but how gradient is calculated with it?</p>\n<p>Also, is there anyway I can set the gradient only with python? I think one way might be adding a custom op that calculate gradients into an array and use the array as an argument of <code>apply_gradients</code>.</p>\n<p>For example:</p>\n<pre><code>x = tf.Variable(3.) # this is an custom op\ny = tf.Variable(4.)\nloss = 13 - x * y\n\nopt = tf.train.GradientDescentOptimizer(0.1)\n[(y_grad, y_val)] = opt.compute_gradients(loss, [y])\nclipped_grads_and_vars = [(x * y, x), (y_grad, y_val)] # custom gradient is x * y\n\noptim = opt.apply_gradients(clipped_grads_and_vars)\n</code></pre>\n<p>Is this safe way to apply custom gradients only with python?</p>", "body_text": "I know about tf.py_func which I can use a python code as an op but how gradient is calculated with it?\nAlso, is there anyway I can set the gradient only with python? I think one way might be adding a custom op that calculate gradients into an array and use the array as an argument of apply_gradients.\nFor example:\nx = tf.Variable(3.) # this is an custom op\ny = tf.Variable(4.)\nloss = 13 - x * y\n\nopt = tf.train.GradientDescentOptimizer(0.1)\n[(y_grad, y_val)] = opt.compute_gradients(loss, [y])\nclipped_grads_and_vars = [(x * y, x), (y_grad, y_val)] # custom gradient is x * y\n\noptim = opt.apply_gradients(clipped_grads_and_vars)\n\nIs this safe way to apply custom gradients only with python?", "body": "I know about `tf.py_func` which I can use a python code as an op but how gradient is calculated with it?\n\nAlso, is there anyway I can set the gradient only with python? I think one way might be adding a custom op that calculate gradients into an array and use the array as an argument of `apply_gradients`.\n\nFor example:\n\n```\nx = tf.Variable(3.) # this is an custom op\ny = tf.Variable(4.)\nloss = 13 - x * y\n\nopt = tf.train.GradientDescentOptimizer(0.1)\n[(y_grad, y_val)] = opt.compute_gradients(loss, [y])\nclipped_grads_and_vars = [(x * y, x), (y_grad, y_val)] # custom gradient is x * y\n\noptim = opt.apply_gradients(clipped_grads_and_vars)\n```\n\nIs this safe way to apply custom gradients only with python?\n"}