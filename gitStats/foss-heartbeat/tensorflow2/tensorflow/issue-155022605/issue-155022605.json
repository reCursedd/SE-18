{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2386", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2386/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2386/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2386/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2386", "id": 155022605, "node_id": "MDU6SXNzdWUxNTUwMjI2MDU=", "number": 2386, "title": "Distributed tensorflow hang when turning from Async to Sync", "user": {"login": "smartcat2010", "id": 10429114, "node_id": "MDQ6VXNlcjEwNDI5MTE0", "avatar_url": "https://avatars1.githubusercontent.com/u/10429114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smartcat2010", "html_url": "https://github.com/smartcat2010", "followers_url": "https://api.github.com/users/smartcat2010/followers", "following_url": "https://api.github.com/users/smartcat2010/following{/other_user}", "gists_url": "https://api.github.com/users/smartcat2010/gists{/gist_id}", "starred_url": "https://api.github.com/users/smartcat2010/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smartcat2010/subscriptions", "organizations_url": "https://api.github.com/users/smartcat2010/orgs", "repos_url": "https://api.github.com/users/smartcat2010/repos", "events_url": "https://api.github.com/users/smartcat2010/events{/privacy}", "received_events_url": "https://api.github.com/users/smartcat2010/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2016-05-16T12:48:13Z", "updated_at": "2018-10-24T07:14:02Z", "closed_at": "2016-05-20T00:25:51Z", "author_association": "NONE", "body_html": "<p>I follow <a href=\"https://www.tensorflow.org/versions/r0.8/how_tos/distributed/index.html\" rel=\"nofollow\">Distributed tensorflow</a> to port our RNN to multi-GPU cards. I start 4 processes and each process run on a different GPU card.<br>\nAfter solving the <a href=\"https://github.com/tensorflow/tensorflow/issues/2292\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/2292/hovercard\">issue</a>, I could run it on my 4 GPU cards server in Asynchronized mode.</p>\n<p>Then I change my code to Synchronized mode by adding only the following code:<br>\noptimizer = tf.train.SyncReplicasOptimizer(<br>\noptimizer,<br>\nreplicas_to_aggregate = 4,<br>\nreplica_id = FLAGS.task_index,<br>\ntotal_num_replicas = 4<br>\n#variable_averages = exp_moving_averager,    # Remove this for simple.<br>\n#variables_to_average = variables_to_average # Remove this for simple.<br>\n)</p>\n<p>Then the job will hang in session.run(...)<br>\nIs there any other thing needed to change when switch from Async mode to Sync mode?</p>\n<p>Thanks a lot in advance!</p>", "body_text": "I follow Distributed tensorflow to port our RNN to multi-GPU cards. I start 4 processes and each process run on a different GPU card.\nAfter solving the issue, I could run it on my 4 GPU cards server in Asynchronized mode.\nThen I change my code to Synchronized mode by adding only the following code:\noptimizer = tf.train.SyncReplicasOptimizer(\noptimizer,\nreplicas_to_aggregate = 4,\nreplica_id = FLAGS.task_index,\ntotal_num_replicas = 4\n#variable_averages = exp_moving_averager,    # Remove this for simple.\n#variables_to_average = variables_to_average # Remove this for simple.\n)\nThen the job will hang in session.run(...)\nIs there any other thing needed to change when switch from Async mode to Sync mode?\nThanks a lot in advance!", "body": "I follow [Distributed tensorflow](https://www.tensorflow.org/versions/r0.8/how_tos/distributed/index.html) to port our RNN to multi-GPU cards. I start 4 processes and each process run on a different GPU card.\nAfter solving the [issue](https://github.com/tensorflow/tensorflow/issues/2292), I could run it on my 4 GPU cards server in Asynchronized mode. \n\nThen I change my code to Synchronized mode by adding only the following code:\n    optimizer = tf.train.SyncReplicasOptimizer(\n        optimizer,\n        replicas_to_aggregate = 4, \n        replica_id = FLAGS.task_index,\n        total_num_replicas = 4\n        #variable_averages = exp_moving_averager,    # Remove this for simple.\n        #variables_to_average = variables_to_average # Remove this for simple.\n        )\n\nThen the job will hang in session.run(...)\nIs there any other thing needed to change when switch from Async mode to Sync mode?\n\nThanks a lot in advance!\n"}