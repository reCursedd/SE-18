{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/261689086", "html_url": "https://github.com/tensorflow/tensorflow/issues/2922#issuecomment-261689086", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2922", "id": 261689086, "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTY4OTA4Ng==", "user": {"login": "nateypants", "id": 10746370, "node_id": "MDQ6VXNlcjEwNzQ2Mzcw", "avatar_url": "https://avatars0.githubusercontent.com/u/10746370?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nateypants", "html_url": "https://github.com/nateypants", "followers_url": "https://api.github.com/users/nateypants/followers", "following_url": "https://api.github.com/users/nateypants/following{/other_user}", "gists_url": "https://api.github.com/users/nateypants/gists{/gist_id}", "starred_url": "https://api.github.com/users/nateypants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nateypants/subscriptions", "organizations_url": "https://api.github.com/users/nateypants/orgs", "repos_url": "https://api.github.com/users/nateypants/repos", "events_url": "https://api.github.com/users/nateypants/events{/privacy}", "received_events_url": "https://api.github.com/users/nateypants/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-19T03:03:13Z", "updated_at": "2016-11-19T03:03:51Z", "author_association": "NONE", "body_html": "<p>I followed the suggestion by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=175486\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ilblackdragon\">@ilblackdragon</a> to pass a callable function, however, it still results in the same Traceback (TypeError: Expected binary or unicode string, got &lt;function exp_decay at 0x11e9fc410&gt;) once fit is called. Replacing exp_decay with a float works. Does not appear to be working.</p>\n<p>Relevant code:</p>\n<pre><code>X_train,y_train,X_valid,y_valid,X_test,y_test,_,_ = loadData()\n\nfeature_columns = learn.infer_real_valued_columns_from_input(X_train)\n\ndef get_optimizer():\n    def exp_decay(global_step):\n      return tf.train.exponential_decay(\n          learning_rate=0.00001, global_step=global_step,\n          decay_steps=100, decay_rate=0.97, starcase=True)\n    # use customized decay function in learning_rate\n    return tf.train.AdagradOptimizer(learning_rate=exp_decay)\n\nestimator = learn.DNNRegressor(\n    model_dir='./Model3/',\n    hidden_units=[int(np.mean([X_train.shape[1],1]))],\n    feature_columns=feature_columns,\n    enable_centered_bias=True,\n    optimizer=get_optimizer\n    )\n\nepochs=20\n\nestimator.fit(X_train,y_train,steps=epochs*y_train.shape[0])\n</code></pre>", "body_text": "I followed the suggestion by @ilblackdragon to pass a callable function, however, it still results in the same Traceback (TypeError: Expected binary or unicode string, got <function exp_decay at 0x11e9fc410>) once fit is called. Replacing exp_decay with a float works. Does not appear to be working.\nRelevant code:\nX_train,y_train,X_valid,y_valid,X_test,y_test,_,_ = loadData()\n\nfeature_columns = learn.infer_real_valued_columns_from_input(X_train)\n\ndef get_optimizer():\n    def exp_decay(global_step):\n      return tf.train.exponential_decay(\n          learning_rate=0.00001, global_step=global_step,\n          decay_steps=100, decay_rate=0.97, starcase=True)\n    # use customized decay function in learning_rate\n    return tf.train.AdagradOptimizer(learning_rate=exp_decay)\n\nestimator = learn.DNNRegressor(\n    model_dir='./Model3/',\n    hidden_units=[int(np.mean([X_train.shape[1],1]))],\n    feature_columns=feature_columns,\n    enable_centered_bias=True,\n    optimizer=get_optimizer\n    )\n\nepochs=20\n\nestimator.fit(X_train,y_train,steps=epochs*y_train.shape[0])", "body": "I followed the suggestion by @ilblackdragon to pass a callable function, however, it still results in the same Traceback (TypeError: Expected binary or unicode string, got <function exp_decay at 0x11e9fc410>) once fit is called. Replacing exp_decay with a float works. Does not appear to be working.\n\nRelevant code:\n\n```\nX_train,y_train,X_valid,y_valid,X_test,y_test,_,_ = loadData()\n\nfeature_columns = learn.infer_real_valued_columns_from_input(X_train)\n\ndef get_optimizer():\n    def exp_decay(global_step):\n      return tf.train.exponential_decay(\n          learning_rate=0.00001, global_step=global_step,\n          decay_steps=100, decay_rate=0.97, starcase=True)\n    # use customized decay function in learning_rate\n    return tf.train.AdagradOptimizer(learning_rate=exp_decay)\n\nestimator = learn.DNNRegressor(\n    model_dir='./Model3/',\n    hidden_units=[int(np.mean([X_train.shape[1],1]))],\n    feature_columns=feature_columns,\n    enable_centered_bias=True,\n    optimizer=get_optimizer\n    )\n\nepochs=20\n\nestimator.fit(X_train,y_train,steps=epochs*y_train.shape[0])\n```\n"}