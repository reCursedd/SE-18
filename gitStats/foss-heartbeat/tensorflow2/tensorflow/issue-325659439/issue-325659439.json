{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19495", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19495/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19495/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19495/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19495", "id": 325659439, "node_id": "MDU6SXNzdWUzMjU2NTk0Mzk=", "number": 19495, "title": "How to optimize for inference , from frozen graph?", "user": {"login": "bibhu107", "id": 23478853, "node_id": "MDQ6VXNlcjIzNDc4ODUz", "avatar_url": "https://avatars0.githubusercontent.com/u/23478853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bibhu107", "html_url": "https://github.com/bibhu107", "followers_url": "https://api.github.com/users/bibhu107/followers", "following_url": "https://api.github.com/users/bibhu107/following{/other_user}", "gists_url": "https://api.github.com/users/bibhu107/gists{/gist_id}", "starred_url": "https://api.github.com/users/bibhu107/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bibhu107/subscriptions", "organizations_url": "https://api.github.com/users/bibhu107/orgs", "repos_url": "https://api.github.com/users/bibhu107/repos", "events_url": "https://api.github.com/users/bibhu107/events{/privacy}", "received_events_url": "https://api.github.com/users/bibhu107/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-23T11:15:34Z", "updated_at": "2018-05-24T05:16:26Z", "closed_at": "2018-05-24T05:16:26Z", "author_association": "NONE", "body_html": "<pre><code>import tensorflow as tf\nfrom tensorflow.python.tools import freeze_graph\nfrom tensorflow.python.tools import optimize_for_inference_lib\n\ninputGraph = tf.GraphDef()\nwith tf.gfile.Open(\"frozen.pb\", \"rb\") as f:\n    data2read = f.read()\n    inputGraph.ParseFromString(data2read)\n\noutputGraph = optimize_for_inference_lib.optimize_for_inference(\n                inputGraph,\n                [\"inputTensor\"], # an array of the input node(s)\n                [\"output/output\"], # an array of output nodes\n                tf.int32.as_datatype_enum)\n\n        # Save the optimized graph\n\nf = tf.gfile.FastGFile(\"outputOptimizedGraph.pb\", \"w\")\nf.write(outputGraph.SerializeToString())    \n\n</code></pre>\n<p>Output : /home/bibhu/anaconda2/lib/python2.7/site-packages/h5py/<strong>init</strong>.py:36: FutureWarning: Conversion of the second argument of issubdtype from <code>float</code> to <code>np.floating</code> is deprecated. In future, it will be treated as <code>np.float64 == np.dtype(float).type</code>.<br>\nfrom ._conv import register_converters as _register_converters<br>\nTraceback (most recent call last):<br>\nFile \"convert_frozen.py\", line 14, in <br>\ntf.int32.as_datatype_enum)<br>\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/tools/optimize_for_inference_lib.py\", line 111, in optimize_for_inference<br>\nplaceholder_type_enum)<br>\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/tools/strip_unused_lib.py\", line 86, in strip_unused<br>\noutput_node_names)<br>\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 174, in extract_sub_graph<br>\n_assert_nodes_are_present(name_to_node, dest_nodes)<br>\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-<strong>packages/tensorflow/python/framework/graph_util_impl.py\", line 133, in _assert_nodes_are_present<br>\nassert d in name_to_node, \"%s is not in graph\" % d<br>\nAssertionError: output/output is not in grap</strong></p>", "body_text": "import tensorflow as tf\nfrom tensorflow.python.tools import freeze_graph\nfrom tensorflow.python.tools import optimize_for_inference_lib\n\ninputGraph = tf.GraphDef()\nwith tf.gfile.Open(\"frozen.pb\", \"rb\") as f:\n    data2read = f.read()\n    inputGraph.ParseFromString(data2read)\n\noutputGraph = optimize_for_inference_lib.optimize_for_inference(\n                inputGraph,\n                [\"inputTensor\"], # an array of the input node(s)\n                [\"output/output\"], # an array of output nodes\n                tf.int32.as_datatype_enum)\n\n        # Save the optimized graph\n\nf = tf.gfile.FastGFile(\"outputOptimizedGraph.pb\", \"w\")\nf.write(outputGraph.SerializeToString())    \n\n\nOutput : /home/bibhu/anaconda2/lib/python2.7/site-packages/h5py/init.py:36: FutureWarning: Conversion of the second argument of issubdtype from float to np.floating is deprecated. In future, it will be treated as np.float64 == np.dtype(float).type.\nfrom ._conv import register_converters as _register_converters\nTraceback (most recent call last):\nFile \"convert_frozen.py\", line 14, in \ntf.int32.as_datatype_enum)\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/tools/optimize_for_inference_lib.py\", line 111, in optimize_for_inference\nplaceholder_type_enum)\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/tools/strip_unused_lib.py\", line 86, in strip_unused\noutput_node_names)\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 174, in extract_sub_graph\n_assert_nodes_are_present(name_to_node, dest_nodes)\nFile \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 133, in _assert_nodes_are_present\nassert d in name_to_node, \"%s is not in graph\" % d\nAssertionError: output/output is not in grap", "body": "```\r\nimport tensorflow as tf\r\nfrom tensorflow.python.tools import freeze_graph\r\nfrom tensorflow.python.tools import optimize_for_inference_lib\r\n\r\ninputGraph = tf.GraphDef()\r\nwith tf.gfile.Open(\"frozen.pb\", \"rb\") as f:\r\n    data2read = f.read()\r\n    inputGraph.ParseFromString(data2read)\r\n\r\noutputGraph = optimize_for_inference_lib.optimize_for_inference(\r\n                inputGraph,\r\n                [\"inputTensor\"], # an array of the input node(s)\r\n                [\"output/output\"], # an array of output nodes\r\n                tf.int32.as_datatype_enum)\r\n\r\n        # Save the optimized graph\r\n\r\nf = tf.gfile.FastGFile(\"outputOptimizedGraph.pb\", \"w\")\r\nf.write(outputGraph.SerializeToString())    \r\n\r\n```\r\nOutput : /home/bibhu/anaconda2/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\nTraceback (most recent call last):\r\n  File \"convert_frozen.py\", line 14, in <module>\r\n    tf.int32.as_datatype_enum)\r\n  File \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/tools/optimize_for_inference_lib.py\", line 111, in optimize_for_inference\r\n    placeholder_type_enum)\r\n  File \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/tools/strip_unused_lib.py\", line 86, in strip_unused\r\n    output_node_names)\r\n  File \"/home/bibhu/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/graph_util_impl.py\", line 174, in extract_sub_graph\r\n    _assert_nodes_are_present(name_to_node, dest_nodes)\r\n  File \"/home/bibhu/anaconda2/lib/python2.7/site-**packages/tensorflow/python/framework/graph_util_impl.py\", line 133, in _assert_nodes_are_present\r\n    assert d in name_to_node, \"%s is not in graph\" % d\r\nAssertionError: output/output is not in grap**"}