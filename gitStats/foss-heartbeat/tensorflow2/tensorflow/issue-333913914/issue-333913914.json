{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20134", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20134/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20134/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20134/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20134", "id": 333913914, "node_id": "MDU6SXNzdWUzMzM5MTM5MTQ=", "number": 20134, "title": "IndexError: tuple index out of range CNN Tensor flow", "user": {"login": "Daromog", "id": 40415903, "node_id": "MDQ6VXNlcjQwNDE1OTAz", "avatar_url": "https://avatars1.githubusercontent.com/u/40415903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Daromog", "html_url": "https://github.com/Daromog", "followers_url": "https://api.github.com/users/Daromog/followers", "following_url": "https://api.github.com/users/Daromog/following{/other_user}", "gists_url": "https://api.github.com/users/Daromog/gists{/gist_id}", "starred_url": "https://api.github.com/users/Daromog/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Daromog/subscriptions", "organizations_url": "https://api.github.com/users/Daromog/orgs", "repos_url": "https://api.github.com/users/Daromog/repos", "events_url": "https://api.github.com/users/Daromog/events{/privacy}", "received_events_url": "https://api.github.com/users/Daromog/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-06-20T03:44:06Z", "updated_at": "2018-08-04T18:40:49Z", "closed_at": "2018-08-04T18:37:27Z", "author_association": "NONE", "body_html": "<p>I'm working on a convolutional network in tensor flow and I get the following error:</p>\n<p>IndexError: tuple index out of range</p>\n<p>when I feed my data to the model  for training I do not know how to fix it. Below is the main function code. I think that my error is in y (labels). I think that the problem is the format of the labels that I can get from input_pipeline function, but I don't know how to fix it.</p>\n<p>`def main(unused_argv):</p>\n<pre><code>images_batch,labels_batch=input_pipeline(train_path,batch_size,num_epochs)\n\nwith tf.Session() as sess:\n\n    #Inicializamos las variables\n    init_op=tf.group(tf.global_variables_initializer(),tf.local_variables_initializer())\n    sess.run(init_op)\n\n    #Corremos las filas(queue) que se crearon en el grafico computacional \n    tf.train.start_queue_runners(sess=sess)\n\n   detector=tf.estimator.Estimator(model_fn=cnn_model,model_dir=\"/tmp/gun_cnn_detector\")\n\n    train_fn=tf.estimator.inputs.numpy_input_fn(\n        x={\"x\":images_batch.eval()},\n        y=labels_batch.eval(),\n        batch_size=10,\n        num_epochs=None,\n        shuffle=True)\n   detector.train(\n        input_fn=train_fn,\n        steps=2)\n\n    writer = tf.summary.FileWriter('.')\n    writer.add_graph(tf.get_default_graph())`\n</code></pre>\n<p>`def input_pipeline(filenames,batch_size,num_epochs):<br>\nfilename_queue=tf.train.string_input_producer([filenames],num_epochs=num_epochs,shuffle=True)<br>\nimages,labels=read_file(filename_queue)</p>\n<pre><code>return images,labels`\n</code></pre>\n<p>I tried a lot of things. Below is the read function. Also I have another question: when I decode my image, what is the correct format? float32 or uint8?</p>\n<p>`def read_file(filename_queue):</p>\n<pre><code>#Funcion para leer el archivo tf.record, y retornamos el next recrod\nreader=tf.TFRecordReader()\n_,serialized_example=reader.read(filename_queue)\n\n#Se decodifica el tf.record retornando un diccionario \nfeature={'train/image':tf.FixedLenFeature([],tf.string),\n         'train/label':tf.FixedLenFeature([],tf.int64)}\nfeatures=tf.parse_single_example(serialized_example,features=feature)\n\n#Convertimos el string a numeros de los decodificados features\nimage=tf.decode_raw(features['train/image'],tf.float32)* (1 / 255.0)\n\n#Convertimos a datos\nlabel=tf.cast(features['train/label'],dtype=tf.int32)\n\n#Reshape data\nimage=tf.reshape(image,[224,224,3]) \n\nreturn image,label`\n</code></pre>\n<p>This is the error I get:</p>\n<p><code>/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/h5py/init.py:36: FutureWarning: Conversion of the second argument of issubdtype from float to np.floating is deprecated. In future, it will be treated as np.float64 == np.dtype(float).type. from ._conv import register_converters as _register_converters Traceback (most recent call last): File \"/Users/David/Desktop/David/General/Tesis/Practica/Programas/CNN/CNN.py\", line 113, in tf.app.run() File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 126, in run _sys.exit(main(argv)) File \"/Users/David/Desktop/David/General/Tesis/Practica/Programas/CNN/CNN.py\", line 104, in main steps=2) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 363, in train loss = self._train_model(input_fn, hooks, saving_listeners) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 843, in _train_model return self._train_model_default(input_fn, hooks, saving_listeners) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 853, in _train_model_default input_fn, model_fn_lib.ModeKeys.TRAIN)) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 691, in _get_features_and_labels_from_input_fn result = self._call_input_fn(input_fn, mode) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 798, in _call_input_fn return input_fn(**kwargs) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/inputs/numpy_io.py\", line 175, in input_fn if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1: File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/inputs/numpy_io.py\", line 175, in if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1: IndexError: tuple index out of range [Finished in 3.9s with exit code 1]</code></p>", "body_text": "I'm working on a convolutional network in tensor flow and I get the following error:\nIndexError: tuple index out of range\nwhen I feed my data to the model  for training I do not know how to fix it. Below is the main function code. I think that my error is in y (labels). I think that the problem is the format of the labels that I can get from input_pipeline function, but I don't know how to fix it.\n`def main(unused_argv):\nimages_batch,labels_batch=input_pipeline(train_path,batch_size,num_epochs)\n\nwith tf.Session() as sess:\n\n    #Inicializamos las variables\n    init_op=tf.group(tf.global_variables_initializer(),tf.local_variables_initializer())\n    sess.run(init_op)\n\n    #Corremos las filas(queue) que se crearon en el grafico computacional \n    tf.train.start_queue_runners(sess=sess)\n\n   detector=tf.estimator.Estimator(model_fn=cnn_model,model_dir=\"/tmp/gun_cnn_detector\")\n\n    train_fn=tf.estimator.inputs.numpy_input_fn(\n        x={\"x\":images_batch.eval()},\n        y=labels_batch.eval(),\n        batch_size=10,\n        num_epochs=None,\n        shuffle=True)\n   detector.train(\n        input_fn=train_fn,\n        steps=2)\n\n    writer = tf.summary.FileWriter('.')\n    writer.add_graph(tf.get_default_graph())`\n\n`def input_pipeline(filenames,batch_size,num_epochs):\nfilename_queue=tf.train.string_input_producer([filenames],num_epochs=num_epochs,shuffle=True)\nimages,labels=read_file(filename_queue)\nreturn images,labels`\n\nI tried a lot of things. Below is the read function. Also I have another question: when I decode my image, what is the correct format? float32 or uint8?\n`def read_file(filename_queue):\n#Funcion para leer el archivo tf.record, y retornamos el next recrod\nreader=tf.TFRecordReader()\n_,serialized_example=reader.read(filename_queue)\n\n#Se decodifica el tf.record retornando un diccionario \nfeature={'train/image':tf.FixedLenFeature([],tf.string),\n         'train/label':tf.FixedLenFeature([],tf.int64)}\nfeatures=tf.parse_single_example(serialized_example,features=feature)\n\n#Convertimos el string a numeros de los decodificados features\nimage=tf.decode_raw(features['train/image'],tf.float32)* (1 / 255.0)\n\n#Convertimos a datos\nlabel=tf.cast(features['train/label'],dtype=tf.int32)\n\n#Reshape data\nimage=tf.reshape(image,[224,224,3]) \n\nreturn image,label`\n\nThis is the error I get:\n/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/h5py/init.py:36: FutureWarning: Conversion of the second argument of issubdtype from float to np.floating is deprecated. In future, it will be treated as np.float64 == np.dtype(float).type. from ._conv import register_converters as _register_converters Traceback (most recent call last): File \"/Users/David/Desktop/David/General/Tesis/Practica/Programas/CNN/CNN.py\", line 113, in tf.app.run() File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 126, in run _sys.exit(main(argv)) File \"/Users/David/Desktop/David/General/Tesis/Practica/Programas/CNN/CNN.py\", line 104, in main steps=2) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 363, in train loss = self._train_model(input_fn, hooks, saving_listeners) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 843, in _train_model return self._train_model_default(input_fn, hooks, saving_listeners) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 853, in _train_model_default input_fn, model_fn_lib.ModeKeys.TRAIN)) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 691, in _get_features_and_labels_from_input_fn result = self._call_input_fn(input_fn, mode) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 798, in _call_input_fn return input_fn(**kwargs) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/inputs/numpy_io.py\", line 175, in input_fn if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1: File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/inputs/numpy_io.py\", line 175, in if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1: IndexError: tuple index out of range [Finished in 3.9s with exit code 1]", "body": "I'm working on a convolutional network in tensor flow and I get the following error:\r\n\r\n IndexError: tuple index out of range\r\n\r\nwhen I feed my data to the model  for training I do not know how to fix it. Below is the main function code. I think that my error is in y (labels). I think that the problem is the format of the labels that I can get from input_pipeline function, but I don't know how to fix it.\r\n\r\n`def main(unused_argv):\r\n\r\n    images_batch,labels_batch=input_pipeline(train_path,batch_size,num_epochs)\r\n\r\n    with tf.Session() as sess:\r\n\r\n        #Inicializamos las variables\r\n        init_op=tf.group(tf.global_variables_initializer(),tf.local_variables_initializer())\r\n        sess.run(init_op)\r\n\r\n        #Corremos las filas(queue) que se crearon en el grafico computacional \r\n        tf.train.start_queue_runners(sess=sess)\r\n\r\n       detector=tf.estimator.Estimator(model_fn=cnn_model,model_dir=\"/tmp/gun_cnn_detector\")\r\n\r\n        train_fn=tf.estimator.inputs.numpy_input_fn(\r\n            x={\"x\":images_batch.eval()},\r\n            y=labels_batch.eval(),\r\n            batch_size=10,\r\n            num_epochs=None,\r\n            shuffle=True)\r\n       detector.train(\r\n            input_fn=train_fn,\r\n            steps=2)\r\n\r\n        writer = tf.summary.FileWriter('.')\r\n        writer.add_graph(tf.get_default_graph())`\r\n\r\n`def input_pipeline(filenames,batch_size,num_epochs):\r\n    filename_queue=tf.train.string_input_producer([filenames],num_epochs=num_epochs,shuffle=True)\r\n    images,labels=read_file(filename_queue)\r\n\r\n    return images,labels`\r\n\r\nI tried a lot of things. Below is the read function. Also I have another question: when I decode my image, what is the correct format? float32 or uint8?\r\n\r\n`def read_file(filename_queue):\r\n\r\n    #Funcion para leer el archivo tf.record, y retornamos el next recrod\r\n    reader=tf.TFRecordReader()\r\n    _,serialized_example=reader.read(filename_queue)\r\n\r\n    #Se decodifica el tf.record retornando un diccionario \r\n    feature={'train/image':tf.FixedLenFeature([],tf.string),\r\n             'train/label':tf.FixedLenFeature([],tf.int64)}\r\n    features=tf.parse_single_example(serialized_example,features=feature)\r\n\r\n    #Convertimos el string a numeros de los decodificados features\r\n    image=tf.decode_raw(features['train/image'],tf.float32)* (1 / 255.0)\r\n\r\n    #Convertimos a datos\r\n    label=tf.cast(features['train/label'],dtype=tf.int32)\r\n\r\n    #Reshape data\r\n    image=tf.reshape(image,[224,224,3]) \r\n\r\n    return image,label`\r\n\r\n\r\nThis is the error I get:\r\n\r\n`/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/h5py/init.py:36: FutureWarning: Conversion of the second argument of issubdtype from float to np.floating is deprecated. In future, it will be treated as np.float64 == np.dtype(float).type. from ._conv import register_converters as _register_converters Traceback (most recent call last): File \"/Users/David/Desktop/David/General/Tesis/Practica/Programas/CNN/CNN.py\", line 113, in tf.app.run() File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 126, in run _sys.exit(main(argv)) File \"/Users/David/Desktop/David/General/Tesis/Practica/Programas/CNN/CNN.py\", line 104, in main steps=2) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 363, in train loss = self._train_model(input_fn, hooks, saving_listeners) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 843, in _train_model return self._train_model_default(input_fn, hooks, saving_listeners) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 853, in _train_model_default input_fn, model_fn_lib.ModeKeys.TRAIN)) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 691, in _get_features_and_labels_from_input_fn result = self._call_input_fn(input_fn, mode) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 798, in _call_input_fn return input_fn(**kwargs) File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/inputs/numpy_io.py\", line 175, in input_fn if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1: File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/tensorflow/python/estimator/inputs/numpy_io.py\", line 175, in if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1: IndexError: tuple index out of range [Finished in 3.9s with exit code 1]`\r\n"}