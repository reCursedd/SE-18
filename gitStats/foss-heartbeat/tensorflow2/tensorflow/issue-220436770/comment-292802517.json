{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/292802517", "html_url": "https://github.com/tensorflow/tensorflow/issues/9073#issuecomment-292802517", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9073", "id": 292802517, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjgwMjUxNw==", "user": {"login": "timanglade", "id": 9924, "node_id": "MDQ6VXNlcjk5MjQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/9924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timanglade", "html_url": "https://github.com/timanglade", "followers_url": "https://api.github.com/users/timanglade/followers", "following_url": "https://api.github.com/users/timanglade/following{/other_user}", "gists_url": "https://api.github.com/users/timanglade/gists{/gist_id}", "starred_url": "https://api.github.com/users/timanglade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timanglade/subscriptions", "organizations_url": "https://api.github.com/users/timanglade/orgs", "repos_url": "https://api.github.com/users/timanglade/repos", "events_url": "https://api.github.com/users/timanglade/events{/privacy}", "received_events_url": "https://api.github.com/users/timanglade/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-09T18:17:35Z", "updated_at": "2017-04-09T18:17:59Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Thanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4059304\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/es007\">@es007</a>, I got a little further thanks to your comment, but it did not solve the problem.</p>\n<p>First of all, your <code>strstrc</code> declaration does not seem necessary and creates a compile-time error for my ops_to_register.h. I just removed it, and I got through running <code>tensorflow/contrib/makefile/compile_ios_tensorflow.sh \"-Os -DSELECTIVE_REGISTRATION\"</code>. The binary libtensorflow-core.a that comes out is noticeably smaller, 263MB instead of 483.</p>\n<p>I can compile my iOS app with it just fine, but I hit an error whenever I try to build the graph. The error in my logs is:</p>\n<pre><code>Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Conv2D' with these attrs.  Registered devices: [CPU], Registered kernels:\n  &lt;no registered kernels&gt;\n\n\t [[Node: conv1/convolution = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"VALID\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true](input_1, conv1/kernel)]]\n</code></pre>\n<p>FWIW, the Conv2D OpKernel seems properly listed in <a href=\"https://www.dropbox.com/s/bginmeuipl5i479/ops_to_register.h?dl=0\" rel=\"nofollow\">my ops_to_register.h file</a>).</p>\n<p>I thought it could be caused by the <code>use_cudnn_on_gpu=true</code> attribute, but the fact is the exact same graph file loads &amp; runs fine if I use a regular TensorFlow iOS library (without selective registration), so it still sounds like an issue related selective registration?</p>", "body_text": "Thanks @es007, I got a little further thanks to your comment, but it did not solve the problem.\nFirst of all, your strstrc declaration does not seem necessary and creates a compile-time error for my ops_to_register.h. I just removed it, and I got through running tensorflow/contrib/makefile/compile_ios_tensorflow.sh \"-Os -DSELECTIVE_REGISTRATION\". The binary libtensorflow-core.a that comes out is noticeably smaller, 263MB instead of 483.\nI can compile my iOS app with it just fine, but I hit an error whenever I try to build the graph. The error in my logs is:\nCould not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Conv2D' with these attrs.  Registered devices: [CPU], Registered kernels:\n  <no registered kernels>\n\n\t [[Node: conv1/convolution = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"VALID\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true](input_1, conv1/kernel)]]\n\nFWIW, the Conv2D OpKernel seems properly listed in my ops_to_register.h file).\nI thought it could be caused by the use_cudnn_on_gpu=true attribute, but the fact is the exact same graph file loads & runs fine if I use a regular TensorFlow iOS library (without selective registration), so it still sounds like an issue related selective registration?", "body": "Thanks @es007, I got a little further thanks to your comment, but it did not solve the problem.\r\n\r\nFirst of all, your `strstrc` declaration does not seem necessary and creates a compile-time error for my ops_to_register.h. I just removed it, and I got through running `tensorflow/contrib/makefile/compile_ios_tensorflow.sh \"-Os -DSELECTIVE_REGISTRATION\"`. The binary libtensorflow-core.a that comes out is noticeably smaller, 263MB instead of 483.\r\n\r\nI can compile my iOS app with it just fine, but I hit an error whenever I try to build the graph. The error in my logs is:\r\n\r\n```\r\nCould not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Conv2D' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[Node: conv1/convolution = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"VALID\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true](input_1, conv1/kernel)]]\r\n```\r\n\r\nFWIW, the Conv2D OpKernel seems properly listed in [my ops_to_register.h file](https://www.dropbox.com/s/bginmeuipl5i479/ops_to_register.h?dl=0)).\r\n\r\nI thought it could be caused by the `use_cudnn_on_gpu=true` attribute, but the fact is the exact same graph file loads & runs fine if I use a regular TensorFlow iOS library (without selective registration), so it still sounds like an issue related selective registration?"}