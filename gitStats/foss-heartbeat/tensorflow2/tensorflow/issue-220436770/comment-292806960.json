{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/292806960", "html_url": "https://github.com/tensorflow/tensorflow/issues/9073#issuecomment-292806960", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9073", "id": 292806960, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjgwNjk2MA==", "user": {"login": "cwhipkey", "id": 17578177, "node_id": "MDQ6VXNlcjE3NTc4MTc3", "avatar_url": "https://avatars0.githubusercontent.com/u/17578177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cwhipkey", "html_url": "https://github.com/cwhipkey", "followers_url": "https://api.github.com/users/cwhipkey/followers", "following_url": "https://api.github.com/users/cwhipkey/following{/other_user}", "gists_url": "https://api.github.com/users/cwhipkey/gists{/gist_id}", "starred_url": "https://api.github.com/users/cwhipkey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cwhipkey/subscriptions", "organizations_url": "https://api.github.com/users/cwhipkey/orgs", "repos_url": "https://api.github.com/users/cwhipkey/repos", "events_url": "https://api.github.com/users/cwhipkey/events{/privacy}", "received_events_url": "https://api.github.com/users/cwhipkey/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-09T19:26:45Z", "updated_at": "2017-04-09T19:26:45Z", "author_association": "MEMBER", "body_html": "<div class=\"email-fragment\">In some cases, the host compiler used to generate the header file differs\nfrom the compiler used for generating the on-device code - the difference\nbeing in how whitespace pasting works in some parts of macro preprocessing.\n\nThe version of the selective registration python lib at master resolves\nthis by doing comparison ignoring whitespace.\n\nIt also removes use of strstr so that could be useful as well.\n\nThe strcmp issue may still remain, but that could be resolved with strcmp\nimplementation listed in this thread.</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Apr 9, 2017 11:20 AM, \"Tim Anglade\" ***@***.***&gt; wrote:\n Thanks <a class=\"user-mention\" href=\"https://github.com/es007\">@es007</a> &lt;<a href=\"https://github.com/es007\">https://github.com/es007</a>&gt;, I got a little further thanks\n to your comment, but it did not solve the problem.\n\n First of all, your strstrc declaration does not seem necessary and\n creates a compile-time error for my ops_to_register.h. I just removed it,\n and I got through running tensorflow/contrib/makefile/compile_ios_tensorflow.sh\n \"-Os -DSELECTIVE_REGISTRATION\". The binary libtensorflow-core.a that\n comes out is noticeably smaller, 263MB instead of 483.\n\n I can compile my iOS app with it just fine, I hit an error whenever I try\n to build the graph. The error in my logs is:\n\n Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Conv2D' with these attrs.  Registered devices: [CPU], Registered kernels:\n   &lt;no registered kernels&gt;\n\n \t [[Node: conv1/convolution = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"VALID\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true](input_1, conv1/kernel)]]\n\n FWIW, the Conv2D OpKernel seems properly listed in my ops_to_register.h\n file &lt;<a href=\"https://www.dropbox.com/s/bginmeuipl5i479/ops_to_register.h?dl=0\">https://www.dropbox.com/s/bginmeuipl5i479/ops_to_register.h?dl=0</a>&gt;).\n\n I thought it could be caused by the use_cudnn_on_gpu=true attribute, but\n the fact is the exact same graph file loads &amp; runs fine if I use a regular\n TensorFlow iOS library (without selective registration), so it still sounds\n like an issue related selective registration?\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"220436770\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9073\" href=\"https://github.com/tensorflow/tensorflow/issues/9073#issuecomment-292802517\">#9073 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AQw4wbciD70Fch5tBgQ-5gJaJ7pylNmfks5ruSFfgaJpZM4M3315\">https://github.com/notifications/unsubscribe-auth/AQw4wbciD70Fch5tBgQ-5gJaJ7pylNmfks5ruSFfgaJpZM4M3315</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "In some cases, the host compiler used to generate the header file differs\nfrom the compiler used for generating the on-device code - the difference\nbeing in how whitespace pasting works in some parts of macro preprocessing.\n\nThe version of the selective registration python lib at master resolves\nthis by doing comparison ignoring whitespace.\n\nIt also removes use of strstr so that could be useful as well.\n\nThe strcmp issue may still remain, but that could be resolved with strcmp\nimplementation listed in this thread.\n\u2026\nOn Apr 9, 2017 11:20 AM, \"Tim Anglade\" ***@***.***> wrote:\n Thanks @es007 <https://github.com/es007>, I got a little further thanks\n to your comment, but it did not solve the problem.\n\n First of all, your strstrc declaration does not seem necessary and\n creates a compile-time error for my ops_to_register.h. I just removed it,\n and I got through running tensorflow/contrib/makefile/compile_ios_tensorflow.sh\n \"-Os -DSELECTIVE_REGISTRATION\". The binary libtensorflow-core.a that\n comes out is noticeably smaller, 263MB instead of 483.\n\n I can compile my iOS app with it just fine, I hit an error whenever I try\n to build the graph. The error in my logs is:\n\n Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Conv2D' with these attrs.  Registered devices: [CPU], Registered kernels:\n   <no registered kernels>\n\n \t [[Node: conv1/convolution = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"VALID\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true](input_1, conv1/kernel)]]\n\n FWIW, the Conv2D OpKernel seems properly listed in my ops_to_register.h\n file <https://www.dropbox.com/s/bginmeuipl5i479/ops_to_register.h?dl=0>).\n\n I thought it could be caused by the use_cudnn_on_gpu=true attribute, but\n the fact is the exact same graph file loads & runs fine if I use a regular\n TensorFlow iOS library (without selective registration), so it still sounds\n like an issue related selective registration?\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#9073 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AQw4wbciD70Fch5tBgQ-5gJaJ7pylNmfks5ruSFfgaJpZM4M3315>\n .", "body": "In some cases, the host compiler used to generate the header file differs\nfrom the compiler used for generating the on-device code - the difference\nbeing in how whitespace pasting works in some parts of macro preprocessing.\n\nThe version of the selective registration python lib at master resolves\nthis by doing comparison ignoring whitespace.\n\nIt also removes use of strstr so that could be useful as well.\n\nThe strcmp issue may still remain, but that could be resolved with strcmp\nimplementation listed in this thread.\n\nOn Apr 9, 2017 11:20 AM, \"Tim Anglade\" <notifications@github.com> wrote:\n\n> Thanks @es007 <https://github.com/es007>, I got a little further thanks\n> to your comment, but it did not solve the problem.\n>\n> First of all, your strstrc declaration does not seem necessary and\n> creates a compile-time error for my ops_to_register.h. I just removed it,\n> and I got through running tensorflow/contrib/makefile/compile_ios_tensorflow.sh\n> \"-Os -DSELECTIVE_REGISTRATION\". The binary libtensorflow-core.a that\n> comes out is noticeably smaller, 263MB instead of 483.\n>\n> I can compile my iOS app with it just fine, I hit an error whenever I try\n> to build the graph. The error in my logs is:\n>\n> Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Conv2D' with these attrs.  Registered devices: [CPU], Registered kernels:\n>   <no registered kernels>\n>\n> \t [[Node: conv1/convolution = Conv2D[T=DT_FLOAT, data_format=\"NHWC\", padding=\"VALID\", strides=[1, 2, 2, 1], use_cudnn_on_gpu=true](input_1, conv1/kernel)]]\n>\n> FWIW, the Conv2D OpKernel seems properly listed in my ops_to_register.h\n> file <https://www.dropbox.com/s/bginmeuipl5i479/ops_to_register.h?dl=0>).\n>\n> I thought it could be caused by the use_cudnn_on_gpu=true attribute, but\n> the fact is the exact same graph file loads & runs fine if I use a regular\n> TensorFlow iOS library (without selective registration), so it still sounds\n> like an issue related selective registration?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/9073#issuecomment-292802517>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AQw4wbciD70Fch5tBgQ-5gJaJ7pylNmfks5ruSFfgaJpZM4M3315>\n> .\n>\n"}