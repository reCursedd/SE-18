{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/342304359", "html_url": "https://github.com/tensorflow/tensorflow/issues/14285#issuecomment-342304359", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14285", "id": 342304359, "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjMwNDM1OQ==", "user": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-06T22:08:47Z", "updated_at": "2017-11-06T22:08:47Z", "author_association": "MEMBER", "body_html": "<p>libsystem_malloc.dylib seems wrong; if you're using the pip package TensorFlow should be using jemalloc. Maybe <a href=\"https://github.com/rwth-i6/returnn/blob/148d103e13ebecb83c0d40539ae84eadabc14873/NativeOp.cpp#L499\">this symbol</a> is leaking into TensorFlow since you <a href=\"https://github.com/rwth-i6/returnn/blob/b53a0a5c1c6acd0235fde2adcfeb8fb20b213fa8/TFNativeOp.py#L88\">load the op with RTLD_GLOBAL</a>? If so, you could just link the op to libtensorflow_framework.so and load with RTLD_LOCAL.</p>", "body_text": "libsystem_malloc.dylib seems wrong; if you're using the pip package TensorFlow should be using jemalloc. Maybe this symbol is leaking into TensorFlow since you load the op with RTLD_GLOBAL? If so, you could just link the op to libtensorflow_framework.so and load with RTLD_LOCAL.", "body": "libsystem_malloc.dylib seems wrong; if you're using the pip package TensorFlow should be using jemalloc. Maybe [this symbol](https://github.com/rwth-i6/returnn/blob/148d103e13ebecb83c0d40539ae84eadabc14873/NativeOp.cpp#L499) is leaking into TensorFlow since you [load the op with RTLD_GLOBAL](https://github.com/rwth-i6/returnn/blob/b53a0a5c1c6acd0235fde2adcfeb8fb20b213fa8/TFNativeOp.py#L88)? If so, you could just link the op to libtensorflow_framework.so and load with RTLD_LOCAL."}