{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/347480491", "html_url": "https://github.com/tensorflow/tensorflow/issues/14828#issuecomment-347480491", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14828", "id": 347480491, "node_id": "MDEyOklzc3VlQ29tbWVudDM0NzQ4MDQ5MQ==", "user": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-28T10:30:43Z", "updated_at": "2017-11-28T10:30:43Z", "author_association": "MEMBER", "body_html": "<p>Yup, as <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1112263\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/facaiy\">@facaiy</a> pointed out, <code>tfe.gradients_function</code> attempts to return the gradient with respect to all the parameters of the function, which in the case of <code>tf.sin</code> are two (<code>x</code> and the string <code>name</code>).</p>\n<p>The following should work:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> tensorflow.contrib.eager <span class=\"pl-k\">as</span> tfe\n\ntfe.enable_eager_execution()\ng <span class=\"pl-k\">=</span> tfe.gradients_function(tf.sin, [<span class=\"pl-c1\">0</span>])\ng([<span class=\"pl-c1\">1.0</span>])</pre></div>\n<p>as would the following:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> tensorflow.contrib.eager <span class=\"pl-k\">as</span> tfe\n\ntfe.enable_eager_execution()\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">f</span>(<span class=\"pl-smi\">x</span>): <span class=\"pl-k\">return</span> tf.sin(x)\n\ng <span class=\"pl-k\">=</span> tfe.gradients_function(f)\ng([<span class=\"pl-c1\">1.0</span>])</pre></div>\n<p>The error message could be nicer of course :)</p>\n<p>FYI: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5061\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/alextp\">@alextp</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1994308\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/akshayka\">@akshayka</a> as they may be touching that code right now and might have ideas on the mechanics of improving the error message.</p>\n<p>Hope that helps. Feel free to reopen if I have misunderstood. Thanks.</p>", "body_text": "Yup, as @facaiy pointed out, tfe.gradients_function attempts to return the gradient with respect to all the parameters of the function, which in the case of tf.sin are two (x and the string name).\nThe following should work:\nimport tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution()\ng = tfe.gradients_function(tf.sin, [0])\ng([1.0])\nas would the following:\nimport tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution()\n\ndef f(x): return tf.sin(x)\n\ng = tfe.gradients_function(f)\ng([1.0])\nThe error message could be nicer of course :)\nFYI: @alextp @akshayka as they may be touching that code right now and might have ideas on the mechanics of improving the error message.\nHope that helps. Feel free to reopen if I have misunderstood. Thanks.", "body": "Yup, as @facaiy pointed out, `tfe.gradients_function` attempts to return the gradient with respect to all the parameters of the function, which in the case of `tf.sin` are two (`x` and the string `name`).\r\n\r\nThe following should work:\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.eager as tfe\r\n\r\ntfe.enable_eager_execution()\r\ng = tfe.gradients_function(tf.sin, [0])\r\ng([1.0])\r\n```\r\n\r\nas would the following:\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.eager as tfe\r\n\r\ntfe.enable_eager_execution()\r\n\r\ndef f(x): return tf.sin(x)\r\n\r\ng = tfe.gradients_function(f)\r\ng([1.0])\r\n```\r\n\r\nThe error message could be nicer of course :)\r\n\r\nFYI: @alextp @akshayka as they may be touching that code right now and might have ideas on the mechanics of improving the error message.\r\n\r\nHope that helps. Feel free to reopen if I have misunderstood. Thanks."}