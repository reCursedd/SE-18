{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/317963726", "html_url": "https://github.com/tensorflow/tensorflow/issues/2175#issuecomment-317963726", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2175", "id": 317963726, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNzk2MzcyNg==", "user": {"login": "AFAgarap", "id": 11130276, "node_id": "MDQ6VXNlcjExMTMwMjc2", "avatar_url": "https://avatars1.githubusercontent.com/u/11130276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AFAgarap", "html_url": "https://github.com/AFAgarap", "followers_url": "https://api.github.com/users/AFAgarap/followers", "following_url": "https://api.github.com/users/AFAgarap/following{/other_user}", "gists_url": "https://api.github.com/users/AFAgarap/gists{/gist_id}", "starred_url": "https://api.github.com/users/AFAgarap/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AFAgarap/subscriptions", "organizations_url": "https://api.github.com/users/AFAgarap/orgs", "repos_url": "https://api.github.com/users/AFAgarap/repos", "events_url": "https://api.github.com/users/AFAgarap/events{/privacy}", "received_events_url": "https://api.github.com/users/AFAgarap/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-26T06:45:09Z", "updated_at": "2017-07-26T06:45:09Z", "author_association": "NONE", "body_html": "<p>I found this code by <a href=\"https://stackoverflow.com/users/395857/franck-dernoncourt\" rel=\"nofollow\">Franck Dernoncourt</a> from his question in <a href=\"https://stackoverflow.com/questions/42422042/forcing-tensorflow-gpu-to-use-the-cpu-from-the-command-line\" rel=\"nofollow\">Stack Overflow</a>:</p>\n<pre><code>session_conf = tf.ConfigProto(\n    device_count={'CPU' : 1, 'GPU' : 0},\n    allow_soft_placement=True,\n    log_device_placement=False\n)\n</code></pre>\n<p>Then use that <code>ConfigProto</code> in <code>tf.Session</code>, that is:</p>\n<pre><code>with tf.Session(config=session_conf) as sess:\n    # run commands\n    ...\n</code></pre>\n<p>I did the above code in a simple implementation:</p>\n<pre><code>import tensorflow as tf\n\na = tf.constant([x for x in range(0, 3)], dtype=tf.float32, shape=[2, 3], name='a')\nb = tf.constant([x for x in range(3, 6)], dtype=tf.float32, shape=[3, 2], name='b')\nc = tf.matmul(a, b)\n\nsession_conf = tf.ConfigProto(\n    device_count={'CPU' : 1, 'GPU' : 0},\n    allow_soft_placement=True,\n    log_device_placement=False\n)\n\nwith tf.Session(config=session_conf) as sess:\n    print(sess.run(c))\n</code></pre>\n<p>Then I had the following result:</p>\n<pre><code>2017-07-26 14:34:42.208873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0)\nDevice mapping: no known devices.\n2017-07-26 14:34:42.208980: I tensorflow/core/common_runtime/direct_session.cc:265] Device mapping:\n\nMatMul: (MatMul): /job:localhost/replica:0/task:0/cpu:0\n2017-07-26 14:34:42.210952: I tensorflow/core/common_runtime/simple_placer.cc:847] MatMul: (MatMul)/job:localhost/replica:0/task:0/cpu:0\nb: (Const): /job:localhost/replica:0/task:0/cpu:0\n2017-07-26 14:34:42.211003: I tensorflow/core/common_runtime/simple_placer.cc:847] b: (Const)/job:localhost/replica:0/task:0/cpu:0\na: (Const): /job:localhost/replica:0/task:0/cpu:0\n2017-07-26 14:34:42.211029: I tensorflow/core/common_runtime/simple_placer.cc:847] a: (Const)/job:localhost/replica:0/task:0/cpu:0\n[[ 15.  15.]\n [ 26.  28.]]\n</code></pre>\n<p>As you can see, it did map the computation to <code>cpu:0</code>.</p>", "body_text": "I found this code by Franck Dernoncourt from his question in Stack Overflow:\nsession_conf = tf.ConfigProto(\n    device_count={'CPU' : 1, 'GPU' : 0},\n    allow_soft_placement=True,\n    log_device_placement=False\n)\n\nThen use that ConfigProto in tf.Session, that is:\nwith tf.Session(config=session_conf) as sess:\n    # run commands\n    ...\n\nI did the above code in a simple implementation:\nimport tensorflow as tf\n\na = tf.constant([x for x in range(0, 3)], dtype=tf.float32, shape=[2, 3], name='a')\nb = tf.constant([x for x in range(3, 6)], dtype=tf.float32, shape=[3, 2], name='b')\nc = tf.matmul(a, b)\n\nsession_conf = tf.ConfigProto(\n    device_count={'CPU' : 1, 'GPU' : 0},\n    allow_soft_placement=True,\n    log_device_placement=False\n)\n\nwith tf.Session(config=session_conf) as sess:\n    print(sess.run(c))\n\nThen I had the following result:\n2017-07-26 14:34:42.208873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0)\nDevice mapping: no known devices.\n2017-07-26 14:34:42.208980: I tensorflow/core/common_runtime/direct_session.cc:265] Device mapping:\n\nMatMul: (MatMul): /job:localhost/replica:0/task:0/cpu:0\n2017-07-26 14:34:42.210952: I tensorflow/core/common_runtime/simple_placer.cc:847] MatMul: (MatMul)/job:localhost/replica:0/task:0/cpu:0\nb: (Const): /job:localhost/replica:0/task:0/cpu:0\n2017-07-26 14:34:42.211003: I tensorflow/core/common_runtime/simple_placer.cc:847] b: (Const)/job:localhost/replica:0/task:0/cpu:0\na: (Const): /job:localhost/replica:0/task:0/cpu:0\n2017-07-26 14:34:42.211029: I tensorflow/core/common_runtime/simple_placer.cc:847] a: (Const)/job:localhost/replica:0/task:0/cpu:0\n[[ 15.  15.]\n [ 26.  28.]]\n\nAs you can see, it did map the computation to cpu:0.", "body": "I found this code by [Franck Dernoncourt](https://stackoverflow.com/users/395857/franck-dernoncourt) from his question in [Stack Overflow](https://stackoverflow.com/questions/42422042/forcing-tensorflow-gpu-to-use-the-cpu-from-the-command-line):\r\n\r\n```\r\nsession_conf = tf.ConfigProto(\r\n    device_count={'CPU' : 1, 'GPU' : 0},\r\n    allow_soft_placement=True,\r\n    log_device_placement=False\r\n)\r\n```\r\n\r\nThen use that `ConfigProto` in `tf.Session`, that is:\r\n\r\n```\r\nwith tf.Session(config=session_conf) as sess:\r\n    # run commands\r\n    ...\r\n```\r\n\r\nI did the above code in a simple implementation:\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\na = tf.constant([x for x in range(0, 3)], dtype=tf.float32, shape=[2, 3], name='a')\r\nb = tf.constant([x for x in range(3, 6)], dtype=tf.float32, shape=[3, 2], name='b')\r\nc = tf.matmul(a, b)\r\n\r\nsession_conf = tf.ConfigProto(\r\n    device_count={'CPU' : 1, 'GPU' : 0},\r\n    allow_soft_placement=True,\r\n    log_device_placement=False\r\n)\r\n\r\nwith tf.Session(config=session_conf) as sess:\r\n    print(sess.run(c))\r\n```\r\n\r\nThen I had the following result:\r\n\r\n```\r\n2017-07-26 14:34:42.208873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0)\r\nDevice mapping: no known devices.\r\n2017-07-26 14:34:42.208980: I tensorflow/core/common_runtime/direct_session.cc:265] Device mapping:\r\n\r\nMatMul: (MatMul): /job:localhost/replica:0/task:0/cpu:0\r\n2017-07-26 14:34:42.210952: I tensorflow/core/common_runtime/simple_placer.cc:847] MatMul: (MatMul)/job:localhost/replica:0/task:0/cpu:0\r\nb: (Const): /job:localhost/replica:0/task:0/cpu:0\r\n2017-07-26 14:34:42.211003: I tensorflow/core/common_runtime/simple_placer.cc:847] b: (Const)/job:localhost/replica:0/task:0/cpu:0\r\na: (Const): /job:localhost/replica:0/task:0/cpu:0\r\n2017-07-26 14:34:42.211029: I tensorflow/core/common_runtime/simple_placer.cc:847] a: (Const)/job:localhost/replica:0/task:0/cpu:0\r\n[[ 15.  15.]\r\n [ 26.  28.]]\r\n```\r\n\r\nAs you can see, it did map the computation to `cpu:0`."}