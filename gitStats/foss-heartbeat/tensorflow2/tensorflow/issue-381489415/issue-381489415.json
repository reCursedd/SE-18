{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23794", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23794/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23794/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23794/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23794", "id": 381489415, "node_id": "MDU6SXNzdWUzODE0ODk0MTU=", "number": 23794, "title": "RuntimeError : about tf.Gradient() in eager mode", "user": {"login": "Johnson-yue", "id": 10268274, "node_id": "MDQ6VXNlcjEwMjY4Mjc0", "avatar_url": "https://avatars0.githubusercontent.com/u/10268274?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Johnson-yue", "html_url": "https://github.com/Johnson-yue", "followers_url": "https://api.github.com/users/Johnson-yue/followers", "following_url": "https://api.github.com/users/Johnson-yue/following{/other_user}", "gists_url": "https://api.github.com/users/Johnson-yue/gists{/gist_id}", "starred_url": "https://api.github.com/users/Johnson-yue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Johnson-yue/subscriptions", "organizations_url": "https://api.github.com/users/Johnson-yue/orgs", "repos_url": "https://api.github.com/users/Johnson-yue/repos", "events_url": "https://api.github.com/users/Johnson-yue/events{/privacy}", "received_events_url": "https://api.github.com/users/Johnson-yue/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "akshaym", "id": 122911, "node_id": "MDQ6VXNlcjEyMjkxMQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/122911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaym", "html_url": "https://github.com/akshaym", "followers_url": "https://api.github.com/users/akshaym/followers", "following_url": "https://api.github.com/users/akshaym/following{/other_user}", "gists_url": "https://api.github.com/users/akshaym/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaym/subscriptions", "organizations_url": "https://api.github.com/users/akshaym/orgs", "repos_url": "https://api.github.com/users/akshaym/repos", "events_url": "https://api.github.com/users/akshaym/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaym/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "akshaym", "id": 122911, "node_id": "MDQ6VXNlcjEyMjkxMQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/122911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaym", "html_url": "https://github.com/akshaym", "followers_url": "https://api.github.com/users/akshaym/followers", "following_url": "https://api.github.com/users/akshaym/following{/other_user}", "gists_url": "https://api.github.com/users/akshaym/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaym/subscriptions", "organizations_url": "https://api.github.com/users/akshaym/orgs", "repos_url": "https://api.github.com/users/akshaym/repos", "events_url": "https://api.github.com/users/akshaym/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaym/received_events", "type": "User", "site_admin": false}, {"login": "yongtang", "id": 6932348, "node_id": "MDQ6VXNlcjY5MzIzNDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6932348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongtang", "html_url": "https://github.com/yongtang", "followers_url": "https://api.github.com/users/yongtang/followers", "following_url": "https://api.github.com/users/yongtang/following{/other_user}", "gists_url": "https://api.github.com/users/yongtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongtang/subscriptions", "organizations_url": "https://api.github.com/users/yongtang/orgs", "repos_url": "https://api.github.com/users/yongtang/repos", "events_url": "https://api.github.com/users/yongtang/events{/privacy}", "received_events_url": "https://api.github.com/users/yongtang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-11-16T08:11:22Z", "updated_at": "2018-11-21T00:03:02Z", "closed_at": "2018-11-21T00:03:02Z", "author_association": "NONE", "body_html": "<p><strong>System information</strong></p>\n<ul>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04):   Linux Ubuntu 16.04</li>\n<li>TensorFlow installed from (source or binary):  pip installed</li>\n<li>TensorFlow version (use command below):   1.10.0</li>\n<li>Python version: 3.5</li>\n<li>CUDA/cuDNN version: cuda-9.0, cudnn-7.2</li>\n<li>GPU model and memory:   GTX 1080 ti - 11G</li>\n</ul>\n<p><strong>Describe the current behavior</strong><br>\nI have a huge model with large parameter, before train code, cost GPU memory is 7859MB, and  my local memory unused is 234M free(total is 32G)<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/10268274/48605840-dca73500-e9b8-11e8-84ac-8a7a8bb617ba.png\"><img src=\"https://user-images.githubusercontent.com/10268274/48605840-dca73500-e9b8-11e8-84ac-8a7a8bb617ba.png\" alt=\"image\" style=\"max-width:100%;\"></a><br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/10268274/48605858-ea5cba80-e9b8-11e8-92b9-3bc184829bba.png\"><img src=\"https://user-images.githubusercontent.com/10268274/48605858-ea5cba80-e9b8-11e8-92b9-3bc184829bba.png\" alt=\"image\" style=\"max-width:100%;\"></a></p>\n<p>when I bug the code ,occur this warning:</p>\n<pre><code>2018-11-16 15:52:30.386249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-11-16 15:52:30.571530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-11-16 15:52:30.571559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\n2018-11-16 15:52:30.571565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\n2018-11-16 15:52:30.571742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9772 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-11-16 15:52:34.410871: W tensorflow/core/framework/allocator.cc:108] Allocation of 423405000 exceeds 10% of system memory.\n2018-11-16 15:52:34.602313: W tensorflow/core/framework/allocator.cc:108] Allocation of 372480000 exceeds 10% of system memory.\n\n</code></pre>\n<p>I will update my discriminator network so I compute gradient first and in eager mode, I used tf.GradientTape() for it.<br>\nBut Exception here: I already used tf.GradientTape() for gradients but, it also warning tf.gradients is not supported when eager execution is enabled.  I did not use tf.gradient anywhere!!!!<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/10268274/48606113-a9b17100-e9b9-11e8-856b-e88a5bbed34e.png\"><img src=\"https://user-images.githubusercontent.com/10268274/48606113-a9b17100-e9b9-11e8-856b-e88a5bbed34e.png\" alt=\"image\" style=\"max-width:100%;\"></a></p>\n<p>and I test demo code like line:1508-1511 in pictures, it worked well. But line:1557 it did not work with same code!!!!  I am sure that I did not use tf.gradients() in my code!!</p>\n<p><strong>Describe the expected behavior</strong></p>\n<p>It should be work</p>\n<p><strong>Other info / logs</strong><br>\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/10268274/48606265-30664e00-e9ba-11e8-9688-553d27c0ab45.png\"><img src=\"https://user-images.githubusercontent.com/10268274/48606265-30664e00-e9ba-11e8-9688-553d27c0ab45.png\" alt=\"image\" style=\"max-width:100%;\"></a></p>", "body_text": "System information\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):   Linux Ubuntu 16.04\nTensorFlow installed from (source or binary):  pip installed\nTensorFlow version (use command below):   1.10.0\nPython version: 3.5\nCUDA/cuDNN version: cuda-9.0, cudnn-7.2\nGPU model and memory:   GTX 1080 ti - 11G\n\nDescribe the current behavior\nI have a huge model with large parameter, before train code, cost GPU memory is 7859MB, and  my local memory unused is 234M free(total is 32G)\n\n\nwhen I bug the code ,occur this warning:\n2018-11-16 15:52:30.386249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-11-16 15:52:30.571530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-11-16 15:52:30.571559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\n2018-11-16 15:52:30.571565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\n2018-11-16 15:52:30.571742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9772 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-11-16 15:52:34.410871: W tensorflow/core/framework/allocator.cc:108] Allocation of 423405000 exceeds 10% of system memory.\n2018-11-16 15:52:34.602313: W tensorflow/core/framework/allocator.cc:108] Allocation of 372480000 exceeds 10% of system memory.\n\n\nI will update my discriminator network so I compute gradient first and in eager mode, I used tf.GradientTape() for it.\nBut Exception here: I already used tf.GradientTape() for gradients but, it also warning tf.gradients is not supported when eager execution is enabled.  I did not use tf.gradient anywhere!!!!\n\nand I test demo code like line:1508-1511 in pictures, it worked well. But line:1557 it did not work with same code!!!!  I am sure that I did not use tf.gradients() in my code!!\nDescribe the expected behavior\nIt should be work\nOther info / logs\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):   Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary):  pip installed\r\n- TensorFlow version (use command below):   1.10.0\r\n- Python version: 3.5\r\n- CUDA/cuDNN version: cuda-9.0, cudnn-7.2\r\n- GPU model and memory:   GTX 1080 ti - 11G\r\n\r\n**Describe the current behavior**\r\nI have a huge model with large parameter, before train code, cost GPU memory is 7859MB, and  my local memory unused is 234M free(total is 32G)\r\n![image](https://user-images.githubusercontent.com/10268274/48605840-dca73500-e9b8-11e8-84ac-8a7a8bb617ba.png)\r\n![image](https://user-images.githubusercontent.com/10268274/48605858-ea5cba80-e9b8-11e8-92b9-3bc184829bba.png)\r\n\r\nwhen I bug the code ,occur this warning:\r\n```\r\n2018-11-16 15:52:30.386249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-11-16 15:52:30.571530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-11-16 15:52:30.571559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\r\n2018-11-16 15:52:30.571565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\r\n2018-11-16 15:52:30.571742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9772 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-11-16 15:52:34.410871: W tensorflow/core/framework/allocator.cc:108] Allocation of 423405000 exceeds 10% of system memory.\r\n2018-11-16 15:52:34.602313: W tensorflow/core/framework/allocator.cc:108] Allocation of 372480000 exceeds 10% of system memory.\r\n\r\n```\r\nI will update my discriminator network so I compute gradient first and in eager mode, I used tf.GradientTape() for it.\r\nBut Exception here: I already used tf.GradientTape() for gradients but, it also warning tf.gradients is not supported when eager execution is enabled.  I did not use tf.gradient anywhere!!!!\r\n![image](https://user-images.githubusercontent.com/10268274/48606113-a9b17100-e9b9-11e8-856b-e88a5bbed34e.png)\r\n\r\nand I test demo code like line:1508-1511 in pictures, it worked well. But line:1557 it did not work with same code!!!!  I am sure that I did not use tf.gradients() in my code!!\r\n\r\n**Describe the expected behavior**\r\n\r\nIt should be work \r\n\r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n![image](https://user-images.githubusercontent.com/10268274/48606265-30664e00-e9ba-11e8-9688-553d27c0ab45.png)\r\n"}