{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12467", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12467/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12467/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12467/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12467", "id": 251813971, "node_id": "MDU6SXNzdWUyNTE4MTM5NzE=", "number": 12467, "title": "Error in estimator.py ", "user": {"login": "Po-Hsuan-Huang", "id": 17848106, "node_id": "MDQ6VXNlcjE3ODQ4MTA2", "avatar_url": "https://avatars1.githubusercontent.com/u/17848106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Po-Hsuan-Huang", "html_url": "https://github.com/Po-Hsuan-Huang", "followers_url": "https://api.github.com/users/Po-Hsuan-Huang/followers", "following_url": "https://api.github.com/users/Po-Hsuan-Huang/following{/other_user}", "gists_url": "https://api.github.com/users/Po-Hsuan-Huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Po-Hsuan-Huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Po-Hsuan-Huang/subscriptions", "organizations_url": "https://api.github.com/users/Po-Hsuan-Huang/orgs", "repos_url": "https://api.github.com/users/Po-Hsuan-Huang/repos", "events_url": "https://api.github.com/users/Po-Hsuan-Huang/events{/privacy}", "received_events_url": "https://api.github.com/users/Po-Hsuan-Huang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-08-22T01:40:46Z", "updated_at": "2017-08-22T04:18:11Z", "closed_at": "2017-08-22T04:18:11Z", "author_association": "NONE", "body_html": "<p>Hi,<br>\nI am running the tutorial code A Guide to TF Layers: Building a Convolutional Neural Network on API r.1.3<br>\n<a href=\"https://www.tensorflow.org/tutorials/layers\" rel=\"nofollow\">https://www.tensorflow.org/tutorials/layers</a></p>\n<p>My code is here.<br>\n<a href=\"https://gist.github.com/Po-Hsuan-Huang/91e31d59fd3aa07f40272b75fe2a924d\">https://gist.github.com/Po-Hsuan-Huang/91e31d59fd3aa07f40272b75fe2a924d</a></p>\n<p>The error shows:</p>\n<pre><code>runfile('/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py', wdir='/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST')\nExtracting MNIST-data/train-images-idx3-ubyte.gz\nExtracting MNIST-data/train-labels-idx1-ubyte.gz\nExtracting MNIST-data/t10k-images-idx3-ubyte.gz\nExtracting MNIST-data/t10k-labels-idx1-ubyte.gz\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_tf_random_seed': 1, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_save_checkpoints_steps': None, '_model_dir': '/tmp/mnist_convnet_model', '_save_summary_steps': 100}\nTraceback (most recent call last):\n\n  File \"&lt;ipython-input-1-c9b70e26f791&gt;\", line 1, in &lt;module&gt;\n    runfile('/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py', wdir='/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST')\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/spyder/utils/site/sitecustomize.py\", line 866, in runfile\n    execfile(filename, namespace)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/spyder/utils/site/sitecustomize.py\", line 94, in execfile\n    builtins.execfile(filename, *where)\n\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 129, in &lt;module&gt;\n    main(None)\n\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 117, in main\n    hooks=[logging_hook])\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 241, in train\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 630, in _train_model\n    model_fn_lib.ModeKeys.TRAIN)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 615, in _call_model_fn\n    model_fn_results = self._model_fn(features=features, **kwargs)\n\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 24, in cnn_model_fn\n    input_layer = tf.reshape(features, [-1, 28, 28, 1])\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2619, in reshape\n    name=name)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\n    raise err\n\nTypeError: Failed to convert object of type &lt;type 'dict'&gt; to Tensor. Contents: {'x': &lt;tf.Tensor 'random_shuffle_queue_DequeueMany:1' shape=(100, 784) dtype=float32&gt;}. Consider casting elements to a supported type.\n</code></pre>\n<p>I traced down a little bit, and found the function <code>estimator._call_input_fn()</code>  does not use parameter 'mode' at all, thus not able to create a tuple comprises features and labels. Is it the tutorial that needs to be modified, or there is some problem with this function. I don't understand why <code>mode </code> is unused here.</p>\n<p>Thanks ! Sorry if this should not be posted here.</p>\n<pre><code>def _call_input_fn(self, input_fn, mode):\n    \"\"\"Calls the input function.\n\n    Args:\n      input_fn: The input function.\n      mode: ModeKeys\n\n    Returns:\n      Either features or (features, labels) where features and labels are:\n        features - `Tensor` or dictionary of string feature name to `Tensor`.\n        labels - `Tensor` or dictionary of `Tensor` with labels.\n\n    Raises:\n      ValueError: if input_fn takes invalid arguments.\n    \"\"\"\n    del mode  # unused\n    input_fn_args = util.fn_args(input_fn)\n    kwargs = {}\n    if 'params' in input_fn_args:\n      kwargs['params'] = self.params\n    if 'config' in input_fn_args:\n      kwargs['config'] = self.config\n    with ops.device('/cpu:0'):\n      return input_fn(**kwargs)\n\n</code></pre>", "body_text": "Hi,\nI am running the tutorial code A Guide to TF Layers: Building a Convolutional Neural Network on API r.1.3\nhttps://www.tensorflow.org/tutorials/layers\nMy code is here.\nhttps://gist.github.com/Po-Hsuan-Huang/91e31d59fd3aa07f40272b75fe2a924d\nThe error shows:\nrunfile('/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py', wdir='/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST')\nExtracting MNIST-data/train-images-idx3-ubyte.gz\nExtracting MNIST-data/train-labels-idx1-ubyte.gz\nExtracting MNIST-data/t10k-images-idx3-ubyte.gz\nExtracting MNIST-data/t10k-labels-idx1-ubyte.gz\nINFO:tensorflow:Using default config.\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_tf_random_seed': 1, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_save_checkpoints_steps': None, '_model_dir': '/tmp/mnist_convnet_model', '_save_summary_steps': 100}\nTraceback (most recent call last):\n\n  File \"<ipython-input-1-c9b70e26f791>\", line 1, in <module>\n    runfile('/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py', wdir='/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST')\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/spyder/utils/site/sitecustomize.py\", line 866, in runfile\n    execfile(filename, namespace)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/spyder/utils/site/sitecustomize.py\", line 94, in execfile\n    builtins.execfile(filename, *where)\n\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 129, in <module>\n    main(None)\n\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 117, in main\n    hooks=[logging_hook])\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 241, in train\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 630, in _train_model\n    model_fn_lib.ModeKeys.TRAIN)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 615, in _call_model_fn\n    model_fn_results = self._model_fn(features=features, **kwargs)\n\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 24, in cnn_model_fn\n    input_layer = tf.reshape(features, [-1, 28, 28, 1])\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2619, in reshape\n    name=name)\n\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\n    raise err\n\nTypeError: Failed to convert object of type <type 'dict'> to Tensor. Contents: {'x': <tf.Tensor 'random_shuffle_queue_DequeueMany:1' shape=(100, 784) dtype=float32>}. Consider casting elements to a supported type.\n\nI traced down a little bit, and found the function estimator._call_input_fn()  does not use parameter 'mode' at all, thus not able to create a tuple comprises features and labels. Is it the tutorial that needs to be modified, or there is some problem with this function. I don't understand why mode  is unused here.\nThanks ! Sorry if this should not be posted here.\ndef _call_input_fn(self, input_fn, mode):\n    \"\"\"Calls the input function.\n\n    Args:\n      input_fn: The input function.\n      mode: ModeKeys\n\n    Returns:\n      Either features or (features, labels) where features and labels are:\n        features - `Tensor` or dictionary of string feature name to `Tensor`.\n        labels - `Tensor` or dictionary of `Tensor` with labels.\n\n    Raises:\n      ValueError: if input_fn takes invalid arguments.\n    \"\"\"\n    del mode  # unused\n    input_fn_args = util.fn_args(input_fn)\n    kwargs = {}\n    if 'params' in input_fn_args:\n      kwargs['params'] = self.params\n    if 'config' in input_fn_args:\n      kwargs['config'] = self.config\n    with ops.device('/cpu:0'):\n      return input_fn(**kwargs)", "body": "Hi, \r\nI am running the tutorial code A Guide to TF Layers: Building a Convolutional Neural Network on API r.1.3\r\nhttps://www.tensorflow.org/tutorials/layers\r\n\r\nMy code is here. \r\nhttps://gist.github.com/Po-Hsuan-Huang/91e31d59fd3aa07f40272b75fe2a924d\r\n\r\nThe error shows:\r\n```\r\nrunfile('/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py', wdir='/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST')\r\nExtracting MNIST-data/train-images-idx3-ubyte.gz\r\nExtracting MNIST-data/train-labels-idx1-ubyte.gz\r\nExtracting MNIST-data/t10k-images-idx3-ubyte.gz\r\nExtracting MNIST-data/t10k-labels-idx1-ubyte.gz\r\nINFO:tensorflow:Using default config.\r\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_tf_random_seed': 1, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_save_checkpoints_steps': None, '_model_dir': '/tmp/mnist_convnet_model', '_save_summary_steps': 100}\r\nTraceback (most recent call last):\r\n\r\n  File \"<ipython-input-1-c9b70e26f791>\", line 1, in <module>\r\n    runfile('/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py', wdir='/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST')\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/spyder/utils/site/sitecustomize.py\", line 866, in runfile\r\n    execfile(filename, namespace)\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/spyder/utils/site/sitecustomize.py\", line 94, in execfile\r\n    builtins.execfile(filename, *where)\r\n\r\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 129, in <module>\r\n    main(None)\r\n\r\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 117, in main\r\n    hooks=[logging_hook])\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 241, in train\r\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 630, in _train_model\r\n    model_fn_lib.ModeKeys.TRAIN)\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 615, in _call_model_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n\r\n  File \"/Users/pohsuanhuang/Documents/workspace/tensorflow_models/NMIST/cnn_mnist.py\", line 24, in cnn_model_fn\r\n    input_layer = tf.reshape(features, [-1, 28, 28, 1])\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2619, in reshape\r\n    name=name)\r\n\r\n  File \"/Users/pohsuanhuang/miniconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\r\n    raise err\r\n\r\nTypeError: Failed to convert object of type <type 'dict'> to Tensor. Contents: {'x': <tf.Tensor 'random_shuffle_queue_DequeueMany:1' shape=(100, 784) dtype=float32>}. Consider casting elements to a supported type.\r\n```\r\n\r\nI traced down a little bit, and found the function `estimator._call_input_fn()`  does not use parameter 'mode' at all, thus not able to create a tuple comprises features and labels. Is it the tutorial that needs to be modified, or there is some problem with this function. I don't understand why `mode ` is unused here. \r\n\r\nThanks ! Sorry if this should not be posted here.\r\n\r\n```\r\ndef _call_input_fn(self, input_fn, mode):\r\n    \"\"\"Calls the input function.\r\n\r\n    Args:\r\n      input_fn: The input function.\r\n      mode: ModeKeys\r\n\r\n    Returns:\r\n      Either features or (features, labels) where features and labels are:\r\n        features - `Tensor` or dictionary of string feature name to `Tensor`.\r\n        labels - `Tensor` or dictionary of `Tensor` with labels.\r\n\r\n    Raises:\r\n      ValueError: if input_fn takes invalid arguments.\r\n    \"\"\"\r\n    del mode  # unused\r\n    input_fn_args = util.fn_args(input_fn)\r\n    kwargs = {}\r\n    if 'params' in input_fn_args:\r\n      kwargs['params'] = self.params\r\n    if 'config' in input_fn_args:\r\n      kwargs['config'] = self.config\r\n    with ops.device('/cpu:0'):\r\n      return input_fn(**kwargs)\r\n\r\n```"}