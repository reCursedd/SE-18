{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14112", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14112/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14112/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14112/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14112", "id": 269783844, "node_id": "MDU6SXNzdWUyNjk3ODM4NDQ=", "number": 14112, "title": "[iOS] No OpKernel was registered to support Op 'Prod' with these attrs", "user": {"login": "tamias65", "id": 8967153, "node_id": "MDQ6VXNlcjg5NjcxNTM=", "avatar_url": "https://avatars0.githubusercontent.com/u/8967153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tamias65", "html_url": "https://github.com/tamias65", "followers_url": "https://api.github.com/users/tamias65/followers", "following_url": "https://api.github.com/users/tamias65/following{/other_user}", "gists_url": "https://api.github.com/users/tamias65/gists{/gist_id}", "starred_url": "https://api.github.com/users/tamias65/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tamias65/subscriptions", "organizations_url": "https://api.github.com/users/tamias65/orgs", "repos_url": "https://api.github.com/users/tamias65/repos", "events_url": "https://api.github.com/users/tamias65/events{/privacy}", "received_events_url": "https://api.github.com/users/tamias65/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-10-30T23:11:27Z", "updated_at": "2018-05-01T09:35:04Z", "closed_at": "2017-10-31T04:46:41Z", "author_association": "NONE", "body_html": "<p>I'm trying to load the faster_rcnn_resnet101_coco model from the <a href=\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md\">Tensorflow Object Detection model zoo</a> onto the iOS camera example.  Currently, I'm running in to the issue with</p>\n<pre><code>No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\n  &lt;no registered kernels&gt;\n</code></pre>\n<p>The environment is as follows:</p>\n<ul>\n<li>python 3.6</li>\n<li>xcode 9.0.1</li>\n<li>mac os 10.12</li>\n<li>tensorflow built from source using r1.4</li>\n<li>bazel 0.5.4</li>\n</ul>\n<p>I have done things as follow:</p>\n<ol>\n<li>\n<p>Following the iOS static library build <a href=\"https://github.com/tensorflow/tensorflow/tree/r1.4/tensorflow/contrib/makefile\">instructions</a>,</p>\n</li>\n<li>\n<p>Successfully ran</p>\n</li>\n</ol>\n<p><code>tensorflow/contrib/makefile/download_dependencies.sh </code><br>\n3. Successfully ran</p>\n<p><code>tensorflow/contrib/makefile/compile_ios_protobuf.sh</code></p>\n<ol start=\"4\">\n<li>Successfully ran</li>\n</ol>\n<pre><code>export HOST_NSYNC_LIB=`tensorflow/contrib/makefile/compile_nsync.sh`\nexport TARGET_NSYNC_LIB=`tensorflow/contrib/makefile/compile_nsync.sh -t ios`\n</code></pre>\n<ol start=\"5\">\n<li>Created faster-rcnn specific ops:</li>\n</ol>\n<pre><code>  bazel build tensorflow/python/tools:print_selective_registration_header \n  bazel-bin/tensorflow/python/tools/print_selective_registration_header \\\n    --graphs=frozen_inference_graph.pb &gt; ops_to_register.h\n</code></pre>\n<ol start=\"6\">\n<li>\n<p>Moved <code>ops_to_register.h</code> under <code>tensorflow/core/framework/</code></p>\n</li>\n<li>\n<p>Successfully built <code>libtensorflow-core.a</code> to account for additional types and custom ops</p>\n</li>\n</ol>\n<pre><code>tensorflow/contrib/makefile/compile_ios_tensorflow.sh \"-O3  -DANDROID_TYPES=ANDROID_TYPES_FULL -DSELECTIVE_REGISTRATION -DSUPPORT_SELECTIVE_REGISTRATION\"\n</code></pre>\n<ol start=\"8\">\n<li>Verified the creation of</li>\n</ol>\n<pre><code>tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a\ntensorflow/contrib/makefile/gen/protobuf_ios/lib/libprotobuf.a\ntensorflow/contrib/makefile/gen/protobuf_ios/lib/libprotobuf-lite.a\n</code></pre>\n<ol start=\"9\">\n<li>\n<p>Check for <code>tf_op_files.txt</code>, and made sure <code>tensorflow/core/ops/math_ops.cc</code> exists (I think this is where \"Prod\" is covered since there's no such file as <code>cwise_op_prod.cc</code>?)</p>\n</li>\n<li>\n<p>Updated iOS camera example with faster-rcnn model, imported \"mscoco_label_map\", and corresponding input/output layers.</p>\n</li>\n</ol>\n<p>When running, I can't get pass error</p>\n<pre><code>2017-10-30 18:00:28.307769: E [path]/tensorflow_utils.mm:209] Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\n  &lt;no registered kernels&gt;\n\n\t [[Node: SecondStageBoxPredictor/Flatten/Prod = Prod[T=DT_INT32, Tidx=DT_INT32, keep_dims=false](SecondStageBoxPredictor/Flatten/Slice_1, SecondStageBoxPredictor/Flatten/Const)]]\n2017-10-30 18:00:28.320101: F [path]CameraExampleViewController.mm:495] Couldn't load model: Invalid argument: No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\n  &lt;no registered kernels&gt;\n\n\t [[Node: SecondStageBoxPredictor/Flatten/Prod = Prod[T=DT_INT32, Tidx=DT_INT32, keep_dims=false](SecondStageBoxPredictor/Flatten/Slice_1, SecondStageBoxPredictor/Flatten/Const)]]\n</code></pre>\n<p>If I try the same steps with the model <code>ssd_mobilenet_v1_coco</code> from the same model zoo, it works fine.  I've also tried the instructions from <a href=\"https://github.com/JieHe96/iOS_Tensorflow_ObjectDetection_Example\">JieHe96/iOS_Tensorflow_ObjectDetection_Example</a> but runs into the exact same problem.</p>\n<p>Can anyone help?</p>", "body_text": "I'm trying to load the faster_rcnn_resnet101_coco model from the Tensorflow Object Detection model zoo onto the iOS camera example.  Currently, I'm running in to the issue with\nNo OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\n  <no registered kernels>\n\nThe environment is as follows:\n\npython 3.6\nxcode 9.0.1\nmac os 10.12\ntensorflow built from source using r1.4\nbazel 0.5.4\n\nI have done things as follow:\n\n\nFollowing the iOS static library build instructions,\n\n\nSuccessfully ran\n\n\ntensorflow/contrib/makefile/download_dependencies.sh \n3. Successfully ran\ntensorflow/contrib/makefile/compile_ios_protobuf.sh\n\nSuccessfully ran\n\nexport HOST_NSYNC_LIB=`tensorflow/contrib/makefile/compile_nsync.sh`\nexport TARGET_NSYNC_LIB=`tensorflow/contrib/makefile/compile_nsync.sh -t ios`\n\n\nCreated faster-rcnn specific ops:\n\n  bazel build tensorflow/python/tools:print_selective_registration_header \n  bazel-bin/tensorflow/python/tools/print_selective_registration_header \\\n    --graphs=frozen_inference_graph.pb > ops_to_register.h\n\n\n\nMoved ops_to_register.h under tensorflow/core/framework/\n\n\nSuccessfully built libtensorflow-core.a to account for additional types and custom ops\n\n\ntensorflow/contrib/makefile/compile_ios_tensorflow.sh \"-O3  -DANDROID_TYPES=ANDROID_TYPES_FULL -DSELECTIVE_REGISTRATION -DSUPPORT_SELECTIVE_REGISTRATION\"\n\n\nVerified the creation of\n\ntensorflow/contrib/makefile/gen/lib/libtensorflow-core.a\ntensorflow/contrib/makefile/gen/protobuf_ios/lib/libprotobuf.a\ntensorflow/contrib/makefile/gen/protobuf_ios/lib/libprotobuf-lite.a\n\n\n\nCheck for tf_op_files.txt, and made sure tensorflow/core/ops/math_ops.cc exists (I think this is where \"Prod\" is covered since there's no such file as cwise_op_prod.cc?)\n\n\nUpdated iOS camera example with faster-rcnn model, imported \"mscoco_label_map\", and corresponding input/output layers.\n\n\nWhen running, I can't get pass error\n2017-10-30 18:00:28.307769: E [path]/tensorflow_utils.mm:209] Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\n  <no registered kernels>\n\n\t [[Node: SecondStageBoxPredictor/Flatten/Prod = Prod[T=DT_INT32, Tidx=DT_INT32, keep_dims=false](SecondStageBoxPredictor/Flatten/Slice_1, SecondStageBoxPredictor/Flatten/Const)]]\n2017-10-30 18:00:28.320101: F [path]CameraExampleViewController.mm:495] Couldn't load model: Invalid argument: No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\n  <no registered kernels>\n\n\t [[Node: SecondStageBoxPredictor/Flatten/Prod = Prod[T=DT_INT32, Tidx=DT_INT32, keep_dims=false](SecondStageBoxPredictor/Flatten/Slice_1, SecondStageBoxPredictor/Flatten/Const)]]\n\nIf I try the same steps with the model ssd_mobilenet_v1_coco from the same model zoo, it works fine.  I've also tried the instructions from JieHe96/iOS_Tensorflow_ObjectDetection_Example but runs into the exact same problem.\nCan anyone help?", "body": "I'm trying to load the faster_rcnn_resnet101_coco model from the [Tensorflow Object Detection model zoo](https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md) onto the iOS camera example.  Currently, I'm running in to the issue with \r\n```\r\nNo OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n  <no registered kernels>\r\n```\r\n\r\nThe environment is as follows:\r\n\r\n- python 3.6\r\n- xcode 9.0.1\r\n- mac os 10.12\r\n- tensorflow built from source using r1.4\r\n- bazel 0.5.4\r\n\r\nI have done things as follow:\r\n\r\n1. Following the iOS static library build [instructions](https://github.com/tensorflow/tensorflow/tree/r1.4/tensorflow/contrib/makefile),\r\n\r\n2. Successfully ran \r\n\r\n`tensorflow/contrib/makefile/download_dependencies.sh\r\n`\r\n3. Successfully ran \r\n\r\n`tensorflow/contrib/makefile/compile_ios_protobuf.sh`\r\n\r\n4. Successfully ran \r\n\r\n```\r\nexport HOST_NSYNC_LIB=`tensorflow/contrib/makefile/compile_nsync.sh`\r\nexport TARGET_NSYNC_LIB=`tensorflow/contrib/makefile/compile_nsync.sh -t ios`\r\n```\r\n\r\n5. Created faster-rcnn specific ops:\r\n```\r\n  bazel build tensorflow/python/tools:print_selective_registration_header \r\n  bazel-bin/tensorflow/python/tools/print_selective_registration_header \\\r\n    --graphs=frozen_inference_graph.pb > ops_to_register.h\r\n```\r\n\r\n6. Moved `ops_to_register.h` under `tensorflow/core/framework/`\r\n\r\n7. Successfully built `libtensorflow-core.a` to account for additional types and custom ops\r\n```\r\ntensorflow/contrib/makefile/compile_ios_tensorflow.sh \"-O3  -DANDROID_TYPES=ANDROID_TYPES_FULL -DSELECTIVE_REGISTRATION -DSUPPORT_SELECTIVE_REGISTRATION\"\r\n```\r\n\r\n8. Verified the creation of \r\n```\r\ntensorflow/contrib/makefile/gen/lib/libtensorflow-core.a\r\ntensorflow/contrib/makefile/gen/protobuf_ios/lib/libprotobuf.a\r\ntensorflow/contrib/makefile/gen/protobuf_ios/lib/libprotobuf-lite.a\r\n```\r\n\r\n9. Check for `tf_op_files.txt`, and made sure `tensorflow/core/ops/math_ops.cc` exists (I think this is where \"Prod\" is covered since there's no such file as `cwise_op_prod.cc`?)\r\n\r\n10. Updated iOS camera example with faster-rcnn model, imported \"mscoco_label_map\", and corresponding input/output layers.\r\n\r\nWhen running, I can't get pass error \r\n```\r\n2017-10-30 18:00:28.307769: E [path]/tensorflow_utils.mm:209] Could not create TensorFlow Graph: Invalid argument: No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[Node: SecondStageBoxPredictor/Flatten/Prod = Prod[T=DT_INT32, Tidx=DT_INT32, keep_dims=false](SecondStageBoxPredictor/Flatten/Slice_1, SecondStageBoxPredictor/Flatten/Const)]]\r\n2017-10-30 18:00:28.320101: F [path]CameraExampleViewController.mm:495] Couldn't load model: Invalid argument: No OpKernel was registered to support Op 'Prod' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[Node: SecondStageBoxPredictor/Flatten/Prod = Prod[T=DT_INT32, Tidx=DT_INT32, keep_dims=false](SecondStageBoxPredictor/Flatten/Slice_1, SecondStageBoxPredictor/Flatten/Const)]]\r\n```\r\n\r\nIf I try the same steps with the model `ssd_mobilenet_v1_coco` from the same model zoo, it works fine.  I've also tried the instructions from [JieHe96/iOS_Tensorflow_ObjectDetection_Example](https://github.com/JieHe96/iOS_Tensorflow_ObjectDetection_Example) but runs into the exact same problem.\r\n\r\nCan anyone help?\r\n\r\n"}