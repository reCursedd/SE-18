{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6518", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6518/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6518/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6518/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6518", "id": 197691722, "node_id": "MDU6SXNzdWUxOTc2OTE3MjI=", "number": 6518, "title": "tf.sequence_mask with int64 does not work", "user": {"login": "albertz", "id": 59132, "node_id": "MDQ6VXNlcjU5MTMy", "avatar_url": "https://avatars0.githubusercontent.com/u/59132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/albertz", "html_url": "https://github.com/albertz", "followers_url": "https://api.github.com/users/albertz/followers", "following_url": "https://api.github.com/users/albertz/following{/other_user}", "gists_url": "https://api.github.com/users/albertz/gists{/gist_id}", "starred_url": "https://api.github.com/users/albertz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/albertz/subscriptions", "organizations_url": "https://api.github.com/users/albertz/orgs", "repos_url": "https://api.github.com/users/albertz/repos", "events_url": "https://api.github.com/users/albertz/events{/privacy}", "received_events_url": "https://api.github.com/users/albertz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-12-27T11:47:28Z", "updated_at": "2018-02-07T23:49:22Z", "closed_at": "2018-02-07T23:49:22Z", "author_association": "NONE", "body_html": "<p>Given some tensor <code>x</code> with shape (batch,time) and <code>seq_lens</code> of shape (batch,) of dtype <code>int64</code>, I wanted to use this code:</p>\n<pre><code>    mask = tf.sequence_mask(seq_lens, maxlen=tf.shape(x)[1])\n</code></pre>\n<p>This fails with <code>TypeError: Input 'y' of 'Less' Op has type int64 that does not match type int32 of argument 'x'.</code> in <code>gen_math_ops._range(0, maxlen, 1) &lt; expand_dims(lengths, 1)</code>.</p>\n<p>If I add <code>seq_lens = tf.cast(seq_lens, \"int32\")</code> before, then it works.</p>\n<p>Casting <code>tf.shape(x)[1]</code> to <code>int64</code> does not work (because of <code>gen_math_ops._range(0, maxlen, 1)</code> which treats <code>0</code> and <code>1</code> as <code>int32</code> and then raises <code>TypeError: Input 'limit' of 'Range' Op has type int64 that does not match type int32 of argument 'start'</code>).</p>", "body_text": "Given some tensor x with shape (batch,time) and seq_lens of shape (batch,) of dtype int64, I wanted to use this code:\n    mask = tf.sequence_mask(seq_lens, maxlen=tf.shape(x)[1])\n\nThis fails with TypeError: Input 'y' of 'Less' Op has type int64 that does not match type int32 of argument 'x'. in gen_math_ops._range(0, maxlen, 1) < expand_dims(lengths, 1).\nIf I add seq_lens = tf.cast(seq_lens, \"int32\") before, then it works.\nCasting tf.shape(x)[1] to int64 does not work (because of gen_math_ops._range(0, maxlen, 1) which treats 0 and 1 as int32 and then raises TypeError: Input 'limit' of 'Range' Op has type int64 that does not match type int32 of argument 'start').", "body": "Given some tensor `x` with shape (batch,time) and `seq_lens` of shape (batch,) of dtype `int64`, I wanted to use this code:\r\n```\r\n    mask = tf.sequence_mask(seq_lens, maxlen=tf.shape(x)[1])\r\n```\r\n\r\nThis fails with `TypeError: Input 'y' of 'Less' Op has type int64 that does not match type int32 of argument 'x'.` in `gen_math_ops._range(0, maxlen, 1) < expand_dims(lengths, 1)`.\r\n\r\nIf I add `seq_lens = tf.cast(seq_lens, \"int32\")` before, then it works.\r\n\r\nCasting `tf.shape(x)[1]` to `int64` does not work (because of `gen_math_ops._range(0, maxlen, 1)` which treats `0` and `1` as `int32` and then raises `TypeError: Input 'limit' of 'Range' Op has type int64 that does not match type int32 of argument 'start'`).\r\n"}