{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5518", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5518/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5518/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5518/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5518", "id": 188513832, "node_id": "MDU6SXNzdWUxODg1MTM4MzI=", "number": 5518, "title": "Op type not registered 'SqrtGrad'", "user": {"login": "leslietso", "id": 12133211, "node_id": "MDQ6VXNlcjEyMTMzMjEx", "avatar_url": "https://avatars2.githubusercontent.com/u/12133211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leslietso", "html_url": "https://github.com/leslietso", "followers_url": "https://api.github.com/users/leslietso/followers", "following_url": "https://api.github.com/users/leslietso/following{/other_user}", "gists_url": "https://api.github.com/users/leslietso/gists{/gist_id}", "starred_url": "https://api.github.com/users/leslietso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leslietso/subscriptions", "organizations_url": "https://api.github.com/users/leslietso/orgs", "repos_url": "https://api.github.com/users/leslietso/repos", "events_url": "https://api.github.com/users/leslietso/events{/privacy}", "received_events_url": "https://api.github.com/users/leslietso/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-11-10T13:53:39Z", "updated_at": "2017-06-14T02:05:37Z", "closed_at": "2017-06-14T02:05:37Z", "author_association": "NONE", "body_html": "<p>I am unable to create the Tensorflow graph from an imported model on Android using JNI. When attempting to load the file with <code>tensorflow::Status s = session-&gt;Create(graph_def);</code>, I receive the error, <code>Not found: Op type not registered 'SqrtGrad'</code>.</p>\n<p>I checked <code>jni-build/jni/include/tensorflow/python/ops/math_ops.py</code> and <code>SqrtGrad</code> does exist. As running the model on Python does not return this error, could this be a problem when I generated my protobuf file with <code>tf.train.write_graph(sess.graph_def, 'location', 'trained_model.pb', as_text=False)</code>?</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"169060198\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3619\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3619/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3619\">#3619</a><br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"167915549\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3533\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3533/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3533\">#3533</a></p>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nMac OS 10.12<br>\nAndroid Cyanogenmod 12<br>\nTensorflow 0.10.0 on Jupyter</p>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<p>This section of code is from <a href=\"https://github.com/miyosuda/TensorFlowAndroidMNIST/tree/master/jni-build/jni\">TensorFlowAndroidMNIST</a></p>\n<p><a href=\"https://github.com/tensorflow/tensorflow/files/583485/trained_model.pb.zip\">trained_model.pb.zip</a></p>\n<pre><code>static std::unique_ptr&lt;tensorflow::Session&gt; session;\n\nstatic bool g_compute_graph_initialized = false;\nusing namespace tensorflow;\n\nJNIEXPORT jfloat JNICALL\nTENSORFLOW_METHOD(init)(JNIEnv* env, jobject thiz, jobject java_asset_manager, jstring model) {\n\n\tconst char* const model_cstr = env-&gt;GetStringUTFChars(model, NULL);\n\n\ttensorflow::SessionOptions options;\n\ttensorflow::ConfigProto&amp; config = options.config;\n\n\tsession.reset(tensorflow::NewSession(options));\n\n\ttensorflow::GraphDef graph_def;\n\tAAssetManager* const asset_manager = AAssetManager_fromJava(env, java_asset_manager);\n\n\tReadFileToProto(asset_manager, model_cstr, &amp;graph_def);\n\ttensorflow::Status s = session-&gt;Create(graph_def);\n\n\tif (!s.ok()) {\n\t\tLOG(ERROR) &lt;&lt; \"Could not create Tensorflow Graph: \" &lt;&lt; s;\n\t\treturn -1;\n\t}\n}\n</code></pre>\n<h3>What other attempted solutions have you tried?</h3>\n<p>I have tried adding <code>tensorflow/contrib/*</code>to <code>tf_op_files.txt</code> and <code>\"//tensorflow/contrib/all_files\"</code> to the tensorflow/BUILD file.</p>", "body_text": "I am unable to create the Tensorflow graph from an imported model on Android using JNI. When attempting to load the file with tensorflow::Status s = session->Create(graph_def);, I receive the error, Not found: Op type not registered 'SqrtGrad'.\nI checked jni-build/jni/include/tensorflow/python/ops/math_ops.py and SqrtGrad does exist. As running the model on Python does not return this error, could this be a problem when I generated my protobuf file with tf.train.write_graph(sess.graph_def, 'location', 'trained_model.pb', as_text=False)?\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n#3619\n#3533\nEnvironment info\nOperating System:\nMac OS 10.12\nAndroid Cyanogenmod 12\nTensorflow 0.10.0 on Jupyter\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nThis section of code is from TensorFlowAndroidMNIST\ntrained_model.pb.zip\nstatic std::unique_ptr<tensorflow::Session> session;\n\nstatic bool g_compute_graph_initialized = false;\nusing namespace tensorflow;\n\nJNIEXPORT jfloat JNICALL\nTENSORFLOW_METHOD(init)(JNIEnv* env, jobject thiz, jobject java_asset_manager, jstring model) {\n\n\tconst char* const model_cstr = env->GetStringUTFChars(model, NULL);\n\n\ttensorflow::SessionOptions options;\n\ttensorflow::ConfigProto& config = options.config;\n\n\tsession.reset(tensorflow::NewSession(options));\n\n\ttensorflow::GraphDef graph_def;\n\tAAssetManager* const asset_manager = AAssetManager_fromJava(env, java_asset_manager);\n\n\tReadFileToProto(asset_manager, model_cstr, &graph_def);\n\ttensorflow::Status s = session->Create(graph_def);\n\n\tif (!s.ok()) {\n\t\tLOG(ERROR) << \"Could not create Tensorflow Graph: \" << s;\n\t\treturn -1;\n\t}\n}\n\nWhat other attempted solutions have you tried?\nI have tried adding tensorflow/contrib/*to tf_op_files.txt and \"//tensorflow/contrib/all_files\" to the tensorflow/BUILD file.", "body": "I am unable to create the Tensorflow graph from an imported model on Android using JNI. When attempting to load the file with `tensorflow::Status s = session->Create(graph_def);`, I receive the error, `Not found: Op type not registered 'SqrtGrad'`.\r\n\r\nI checked `jni-build/jni/include/tensorflow/python/ops/math_ops.py` and `SqrtGrad` does exist. As running the model on Python does not return this error, could this be a problem when I generated my protobuf file with `tf.train.write_graph(sess.graph_def, 'location', 'trained_model.pb', as_text=False)`?\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nhttps://github.com/tensorflow/tensorflow/issues/3619\r\nhttps://github.com/tensorflow/tensorflow/issues/3533\r\n\r\n### Environment info\r\nOperating System:\r\nMac OS 10.12\r\nAndroid Cyanogenmod 12\r\nTensorflow 0.10.0 on Jupyter\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\nThis section of code is from [TensorFlowAndroidMNIST](https://github.com/miyosuda/TensorFlowAndroidMNIST/tree/master/jni-build/jni)\r\n\r\n[trained_model.pb.zip](https://github.com/tensorflow/tensorflow/files/583485/trained_model.pb.zip)\r\n```\r\nstatic std::unique_ptr<tensorflow::Session> session;\r\n\r\nstatic bool g_compute_graph_initialized = false;\r\nusing namespace tensorflow;\r\n\r\nJNIEXPORT jfloat JNICALL\r\nTENSORFLOW_METHOD(init)(JNIEnv* env, jobject thiz, jobject java_asset_manager, jstring model) {\r\n\r\n\tconst char* const model_cstr = env->GetStringUTFChars(model, NULL);\r\n\r\n\ttensorflow::SessionOptions options;\r\n\ttensorflow::ConfigProto& config = options.config;\r\n\r\n\tsession.reset(tensorflow::NewSession(options));\r\n\r\n\ttensorflow::GraphDef graph_def;\r\n\tAAssetManager* const asset_manager = AAssetManager_fromJava(env, java_asset_manager);\r\n\r\n\tReadFileToProto(asset_manager, model_cstr, &graph_def);\r\n\ttensorflow::Status s = session->Create(graph_def);\r\n\r\n\tif (!s.ok()) {\r\n\t\tLOG(ERROR) << \"Could not create Tensorflow Graph: \" << s;\r\n\t\treturn -1;\r\n\t}\r\n}\r\n```\r\n\r\n### What other attempted solutions have you tried?\r\nI have tried adding `tensorflow/contrib/*`to `tf_op_files.txt` and `\"//tensorflow/contrib/all_files\"` to the tensorflow/BUILD file.\r\n"}