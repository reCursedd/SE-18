{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/259935621", "html_url": "https://github.com/tensorflow/tensorflow/issues/5518#issuecomment-259935621", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5518", "id": 259935621, "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTkzNTYyMQ==", "user": {"login": "leslietso", "id": 12133211, "node_id": "MDQ6VXNlcjEyMTMzMjEx", "avatar_url": "https://avatars2.githubusercontent.com/u/12133211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leslietso", "html_url": "https://github.com/leslietso", "followers_url": "https://api.github.com/users/leslietso/followers", "following_url": "https://api.github.com/users/leslietso/following{/other_user}", "gists_url": "https://api.github.com/users/leslietso/gists{/gist_id}", "starred_url": "https://api.github.com/users/leslietso/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leslietso/subscriptions", "organizations_url": "https://api.github.com/users/leslietso/orgs", "repos_url": "https://api.github.com/users/leslietso/repos", "events_url": "https://api.github.com/users/leslietso/events{/privacy}", "received_events_url": "https://api.github.com/users/leslietso/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-11T11:11:17Z", "updated_at": "2016-11-12T13:00:43Z", "author_association": "NONE", "body_html": "<p>You are correct in saying that I do not want to train on my Android device.</p>\n<p>In order to run <code>optimize_for_inference</code>, I wanted to first run <code>freeze_graph</code> mentioned in the \"deploying.txt\" file you posted. However, I get the error <code>UnicodeDecodeError: 'utf8' codec can't decode byte 0x96 in position 331: invalid start byte</code> when attempting to run the bash script:</p>\n<pre><code>#!/bin/bash\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n--input_graph=/Users/leslie/Downloads/trained_model.pb \\\n--input_checkpoint=/Users/leslie/Downloads/Y6_1478303913_Leslie \\\n--output_graph=/tmp/frozen_graph.pb --output_node_names=Y_GroundTruth\n</code></pre>\n<p>Could this be a problem in the way I created my graph and checkpoint? I created the input_graph via <code>tf.train.write_graph(sess.graph_def, location, 'trained_model.pb', as_text=False)</code> and the checkpoint is created via <code>saver.save(sess, chkpointpath)</code>. Answers from StackOverflow say that the python script has non-ascii characters and that I should just simply strip them from the python script but I do not think that is such a great idea.</p>\n<p><strong>Full traceback:</strong></p>\n<pre><code>Traceback (most recent call last):\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 135, in &lt;module&gt;\n    tf.app.run()\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 132, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 98, in freeze_graph\n    text_format.Merge(f.read().decode(\"utf-8\"), input_graph_def)\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x96 in position 331: invalid start byte\n</code></pre>\n<p><strong>UPDATE:</strong><br>\nI generated my protobuf file with <code>as_text = True</code> and the error above did not show up. However, I only got the following output.</p>\n<pre><code>Converted 0 variables to const ops.\n1 ops in the final graph.\n</code></pre>\n<p>Complete contents of \"frozen_graph.pb\"</p>\n<pre><code>6\n\nY_GroundTruth\ufffd\ufffdPlaceholder*\ufffd\n\ufffddtype\ufffd\ufffd0\ufffd*\ufffd\n\ufffdshape\ufffd\ufffd:\n</code></pre>\n<p>For completeness sake I tried <code>freeze_graph</code> with my metagraph, but I received a similar error.</p>\n<pre><code>Traceback (most recent call last):\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 135, in &lt;module&gt;\n    tf.app.run()\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 132, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 98, in freeze_graph\n    text_format.Merge(f.read().decode(\"utf-8\"), input_graph_def)\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0xc4 in position 1: invalid continuation byte\n</code></pre>", "body_text": "You are correct in saying that I do not want to train on my Android device.\nIn order to run optimize_for_inference, I wanted to first run freeze_graph mentioned in the \"deploying.txt\" file you posted. However, I get the error UnicodeDecodeError: 'utf8' codec can't decode byte 0x96 in position 331: invalid start byte when attempting to run the bash script:\n#!/bin/bash\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n--input_graph=/Users/leslie/Downloads/trained_model.pb \\\n--input_checkpoint=/Users/leslie/Downloads/Y6_1478303913_Leslie \\\n--output_graph=/tmp/frozen_graph.pb --output_node_names=Y_GroundTruth\n\nCould this be a problem in the way I created my graph and checkpoint? I created the input_graph via tf.train.write_graph(sess.graph_def, location, 'trained_model.pb', as_text=False) and the checkpoint is created via saver.save(sess, chkpointpath). Answers from StackOverflow say that the python script has non-ascii characters and that I should just simply strip them from the python script but I do not think that is such a great idea.\nFull traceback:\nTraceback (most recent call last):\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 135, in <module>\n    tf.app.run()\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 132, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 98, in freeze_graph\n    text_format.Merge(f.read().decode(\"utf-8\"), input_graph_def)\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x96 in position 331: invalid start byte\n\nUPDATE:\nI generated my protobuf file with as_text = True and the error above did not show up. However, I only got the following output.\nConverted 0 variables to const ops.\n1 ops in the final graph.\n\nComplete contents of \"frozen_graph.pb\"\n6\n\nY_GroundTruth\ufffd\ufffdPlaceholder*\ufffd\n\ufffddtype\ufffd\ufffd0\ufffd*\ufffd\n\ufffdshape\ufffd\ufffd:\n\nFor completeness sake I tried freeze_graph with my metagraph, but I received a similar error.\nTraceback (most recent call last):\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 135, in <module>\n    tf.app.run()\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 132, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 98, in freeze_graph\n    text_format.Merge(f.read().decode(\"utf-8\"), input_graph_def)\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0xc4 in position 1: invalid continuation byte", "body": "You are correct in saying that I do not want to train on my Android device. \n\nIn order to run `optimize_for_inference`, I wanted to first run `freeze_graph` mentioned in the \"deploying.txt\" file you posted. However, I get the error `UnicodeDecodeError: 'utf8' codec can't decode byte 0x96 in position 331: invalid start byte` when attempting to run the bash script:\n\n```\n#!/bin/bash\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n--input_graph=/Users/leslie/Downloads/trained_model.pb \\\n--input_checkpoint=/Users/leslie/Downloads/Y6_1478303913_Leslie \\\n--output_graph=/tmp/frozen_graph.pb --output_node_names=Y_GroundTruth\n```\n\nCould this be a problem in the way I created my graph and checkpoint? I created the input_graph via `tf.train.write_graph(sess.graph_def, location, 'trained_model.pb', as_text=False)` and the checkpoint is created via `saver.save(sess, chkpointpath)`. Answers from StackOverflow say that the python script has non-ascii characters and that I should just simply strip them from the python script but I do not think that is such a great idea.\n\n**Full traceback:**\n\n```\nTraceback (most recent call last):\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 135, in <module>\n    tf.app.run()\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 132, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 98, in freeze_graph\n    text_format.Merge(f.read().decode(\"utf-8\"), input_graph_def)\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x96 in position 331: invalid start byte\n```\n\n**UPDATE:**\nI generated my protobuf file with `as_text = True` and the error above did not show up. However, I only got the following output.\n\n```\nConverted 0 variables to const ops.\n1 ops in the final graph.\n```\n\nComplete contents of \"frozen_graph.pb\"\n\n```\n6\n\nY_GroundTruth\u0012\u000bPlaceholder*\u000b\n\u0005dtype\u0012\u00020\u0001*\u000b\n\u0005shape\u0012\u0002:\n```\n\nFor completeness sake I tried `freeze_graph` with my metagraph, but I received a similar error.\n\n```\nTraceback (most recent call last):\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 135, in <module>\n    tf.app.run()\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 43, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 132, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/Users/leslie/tensorflow-master/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 98, in freeze_graph\n    text_format.Merge(f.read().decode(\"utf-8\"), input_graph_def)\n  File \"/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0xc4 in position 1: invalid continuation byte\n```\n"}