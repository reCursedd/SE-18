{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/205988791", "pull_request_review_id": 141361824, "id": 205988791, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTk4ODc5MQ==", "diff_hunk": "@@ -727,6 +727,81 @@ TEST_F(MathGradTest, Div) {\n   }\n }\n \n+TEST_F(MathGradTest, UnsafeDiv) {\n+  auto x = test::AsTensor<float>({0.f, -3.f, -2.f,\n+                                  -1.f, 0.f, 1.f,\n+                                  2.f, 3.f, 0.f},\n+                                 TensorShape({3, 3}));\n+  auto y = test::AsTensor<float>({-10.f, 0.f, 10.f}, TensorShape({3, 1}));\n+  Tensor dx;\n+  Tensor dy;\n+  {\n+    SymGrad(\"UnsafeDiv\", x, y, &dx, &dy);\n+    {\n+      auto g = [](float x, float y) {\n+        if (y == 0.f) {\n+          return 0.f;\n+        } else {\n+          return 1.f / y;\n+        }\n+      };\n+      test::ExpectClose(dx, test::AsTensor<float>(\n+                                {g(0.f, -10.f), g(-3.f, -10.f), g(-2.f, -10.f),\n+                                 g(-1.f, 0.f), g(0.f, 0.f), g(1.f, 0.f),\n+                                 g(2.f, 10.f), g(3.f, 10.f), g(0.f, 10.f)},\n+                                TensorShape({3, 3})));\n+    }\n+    {\n+      auto g = [](float x, float y) {\n+        if (y == 0.f) {\n+          return 0.f;\n+        }\n+        else {\n+          return -x / (y * y);\n+        }\n+      };\n+      test::ExpectClose(dy,\n+                        test::AsTensor<float>(\n+                            {g(0.f, -10.f) + g(-3.f, -10.f) + g(-2.f, -10.f),\n+                             g(-1.f, 0.f) + g(0.f, 0.f) + g(1.f, 0.f),\n+                             g(2.f, 10.f) + g(3.f, 10.f) + g(0.f, 10.f)},\n+                            TensorShape({3, 1})));\n+    }\n+  }\n+  {  // Swap x and y", "path": "tensorflow/core/ops/math_grad_test.cc", "position": null, "original_position": 45, "commit_id": "8f4bb0fed956a35b767c0984d9587636cba661bb", "original_commit_id": "456bd20568fa723858e65fac93eed141cc5d1f19", "user": {"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}, "body": "Punctuation", "created_at": "2018-07-29T22:04:40Z", "updated_at": "2018-08-14T07:26:55Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/19105#discussion_r205988791", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/19105", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/205988791"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/19105#discussion_r205988791"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/19105"}}, "body_html": "<p>Punctuation</p>", "body_text": "Punctuation"}