{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2566", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2566/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2566/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2566/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2566", "id": 157388019, "node_id": "MDU6SXNzdWUxNTczODgwMTk=", "number": 2566, "title": "Android Example utils fail on models > 64MB", "user": {"login": "kuza55", "id": 387986, "node_id": "MDQ6VXNlcjM4Nzk4Ng==", "avatar_url": "https://avatars3.githubusercontent.com/u/387986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kuza55", "html_url": "https://github.com/kuza55", "followers_url": "https://api.github.com/users/kuza55/followers", "following_url": "https://api.github.com/users/kuza55/following{/other_user}", "gists_url": "https://api.github.com/users/kuza55/gists{/gist_id}", "starred_url": "https://api.github.com/users/kuza55/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kuza55/subscriptions", "organizations_url": "https://api.github.com/users/kuza55/orgs", "repos_url": "https://api.github.com/users/kuza55/repos", "events_url": "https://api.github.com/users/kuza55/events{/privacy}", "received_events_url": "https://api.github.com/users/kuza55/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-05-29T14:09:58Z", "updated_at": "2016-06-17T21:58:37Z", "closed_at": "2016-06-17T21:58:37Z", "author_association": "NONE", "body_html": "<p>I've been trying to get started with tensorflow and I wanted to use an image recognition model I trained in the android example, but when I tried to replace the models in the example with my model, it would crash without a lot of information.</p>\n<p>I finally figure out that ReadFileToProto in jni_utils.cc does not support reading files larger than 64MB: <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/jni/jni_utils.cc#L107\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/jni/jni_utils.cc#L107</a></p>\n<p>Adding these lines seemed to fix the issue of not being able to load my graph at all:</p>\n<pre><code>::google::protobuf::io::CodedInputStream coded_stream(&amp;adaptor);\ncoded_stream.SetTotalBytesLimit(1024LL &lt;&lt; 20, 512LL &lt;&lt; 20);\n\ncoded_stream.Skip(start);\nCHECK(message-&gt;ParseFromCodedStream(&amp;coded_stream));\n</code></pre>\n<p>I'm probably not the first to stumble into this problem, but I feel like I just wasted hours of my life on a trivially avoidable problem and I hope no-one else has to waste time on that little bit of protobuf trivia.</p>", "body_text": "I've been trying to get started with tensorflow and I wanted to use an image recognition model I trained in the android example, but when I tried to replace the models in the example with my model, it would crash without a lot of information.\nI finally figure out that ReadFileToProto in jni_utils.cc does not support reading files larger than 64MB: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/jni/jni_utils.cc#L107\nAdding these lines seemed to fix the issue of not being able to load my graph at all:\n::google::protobuf::io::CodedInputStream coded_stream(&adaptor);\ncoded_stream.SetTotalBytesLimit(1024LL << 20, 512LL << 20);\n\ncoded_stream.Skip(start);\nCHECK(message->ParseFromCodedStream(&coded_stream));\n\nI'm probably not the first to stumble into this problem, but I feel like I just wasted hours of my life on a trivially avoidable problem and I hope no-one else has to waste time on that little bit of protobuf trivia.", "body": "I've been trying to get started with tensorflow and I wanted to use an image recognition model I trained in the android example, but when I tried to replace the models in the example with my model, it would crash without a lot of information.\n\nI finally figure out that ReadFileToProto in jni_utils.cc does not support reading files larger than 64MB: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/jni/jni_utils.cc#L107\n\nAdding these lines seemed to fix the issue of not being able to load my graph at all:\n\n```\n::google::protobuf::io::CodedInputStream coded_stream(&adaptor);\ncoded_stream.SetTotalBytesLimit(1024LL << 20, 512LL << 20);\n\ncoded_stream.Skip(start);\nCHECK(message->ParseFromCodedStream(&coded_stream));\n```\n\nI'm probably not the first to stumble into this problem, but I feel like I just wasted hours of my life on a trivially avoidable problem and I hope no-one else has to waste time on that little bit of protobuf trivia.\n"}