{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5401", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5401/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5401/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5401/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5401", "id": 187415917, "node_id": "MDU6SXNzdWUxODc0MTU5MTc=", "number": 5401, "title": "Creating and fitting a Trainable leaks file descriptors ", "user": {"login": "brianquinlan", "id": 8851008, "node_id": "MDQ6VXNlcjg4NTEwMDg=", "avatar_url": "https://avatars2.githubusercontent.com/u/8851008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianquinlan", "html_url": "https://github.com/brianquinlan", "followers_url": "https://api.github.com/users/brianquinlan/followers", "following_url": "https://api.github.com/users/brianquinlan/following{/other_user}", "gists_url": "https://api.github.com/users/brianquinlan/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianquinlan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianquinlan/subscriptions", "organizations_url": "https://api.github.com/users/brianquinlan/orgs", "repos_url": "https://api.github.com/users/brianquinlan/repos", "events_url": "https://api.github.com/users/brianquinlan/events{/privacy}", "received_events_url": "https://api.github.com/users/brianquinlan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-11-04T19:12:43Z", "updated_at": "2016-11-17T22:30:06Z", "closed_at": "2016-11-17T22:30:06Z", "author_association": "NONE", "body_html": "<p>Creating a Trainable and calling fit() on it leaks file descriptors.</p>\n<h3>Environment info</h3>\n<p>Operating System: Mac OS X</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):</p>\n<p>None</p>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>A link to the pip package you installed:</li>\n<li>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.</li>\n</ol>\n<p>0.11.0rc0</p>\n<p>If installed from source, provide</p>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<pre><code>import numpy as np\nimport tensorflow\nfrom tensorflow.contrib import learn, layers\n\ndef input_fn():\n    return (\n        {'a': tensorflow.constant([1.1, 2.2, 3.3], dtype=tensorflow.float32)}, \n        tensorflow.constant([5.0, 8.0, 12.5], dtype=tensorflow.float32))\n\nwhile True:\n    linear_regressor = learn.LinearRegressor(\n        feature_columns=[layers.real_valued_column('a')])\n    linear_regressor.fit(input_fn=input_fn, steps=1)\n</code></pre>\n<h3>Logs or other output that would be helpful</h3>\n<p>Traceback (most recent call last):<br>\nFile \"tensor_bug.py\", line 13, in <br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 333, in fit<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 708, in _train_model<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 285, in _monitored_train<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 368, in run<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 521, in run<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 488, in run<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 612, in run<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 634, in _call_hook_before_run<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/basic_session_run_hooks.py\", line 180, in before_run<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/training_util.py\", line 76, in write_graph<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 211, in write_string_to_file<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 89, in write<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 81, in _prewrite_check<br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 66, in <strong>exit</strong><br>\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/errors.py\", line 463, in raise_exception_on_not_ok_status<br>\ntensorflow.python.framework.errors.ResourceExhaustedError: /var/folders/6c/3pzbp8jj3zd0lkhsszmvyd5h001cct/T/tmpzr7juea4/graph.pbtxt</p>\n<p>During the run \"lsof\" is indicating that the number of file descriptors used is increased on every loop iteration.</p>", "body_text": "Creating a Trainable and calling fit() on it leaks file descriptors.\nEnvironment info\nOperating System: Mac OS X\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\nNone\nIf installed from binary pip package, provide:\n\nA link to the pip package you installed:\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\n\n0.11.0rc0\nIf installed from source, provide\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nimport numpy as np\nimport tensorflow\nfrom tensorflow.contrib import learn, layers\n\ndef input_fn():\n    return (\n        {'a': tensorflow.constant([1.1, 2.2, 3.3], dtype=tensorflow.float32)}, \n        tensorflow.constant([5.0, 8.0, 12.5], dtype=tensorflow.float32))\n\nwhile True:\n    linear_regressor = learn.LinearRegressor(\n        feature_columns=[layers.real_valued_column('a')])\n    linear_regressor.fit(input_fn=input_fn, steps=1)\n\nLogs or other output that would be helpful\nTraceback (most recent call last):\nFile \"tensor_bug.py\", line 13, in \nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 333, in fit\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 708, in _train_model\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 285, in _monitored_train\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 368, in run\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 521, in run\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 488, in run\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 612, in run\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 634, in _call_hook_before_run\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/basic_session_run_hooks.py\", line 180, in before_run\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/training_util.py\", line 76, in write_graph\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 211, in write_string_to_file\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 89, in write\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 81, in _prewrite_check\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 66, in exit\nFile \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/errors.py\", line 463, in raise_exception_on_not_ok_status\ntensorflow.python.framework.errors.ResourceExhaustedError: /var/folders/6c/3pzbp8jj3zd0lkhsszmvyd5h001cct/T/tmpzr7juea4/graph.pbtxt\nDuring the run \"lsof\" is indicating that the number of file descriptors used is increased on every loop iteration.", "body": "Creating a Trainable and calling fit() on it leaks file descriptors.\r\n\r\n### Environment info\r\nOperating System: Mac OS X\r\n\r\nInstalled version of CUDA and cuDNN: \r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n\r\nNone\r\n\r\nIf installed from binary pip package, provide:\r\n\r\n1. A link to the pip package you installed:\r\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\r\n\r\n0.11.0rc0\r\n\r\nIf installed from source, provide \r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow\r\nfrom tensorflow.contrib import learn, layers\r\n\r\ndef input_fn():\r\n    return (\r\n        {'a': tensorflow.constant([1.1, 2.2, 3.3], dtype=tensorflow.float32)}, \r\n        tensorflow.constant([5.0, 8.0, 12.5], dtype=tensorflow.float32))\r\n\r\nwhile True:\r\n    linear_regressor = learn.LinearRegressor(\r\n        feature_columns=[layers.real_valued_column('a')])\r\n    linear_regressor.fit(input_fn=input_fn, steps=1)\r\n```\r\n\r\n### Logs or other output that would be helpful\r\n\r\nTraceback (most recent call last):\r\n  File \"tensor_bug.py\", line 13, in <module>\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 333, in fit\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 708, in _train_model\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 285, in _monitored_train\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 368, in run\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 521, in run\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 488, in run\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 612, in run\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.py\", line 634, in _call_hook_before_run\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/contrib/learn/python/learn/basic_session_run_hooks.py\", line 180, in before_run\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/training_util.py\", line 76, in write_graph\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 211, in write_string_to_file\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 89, in write\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/lib/io/file_io.py\", line 81, in _prewrite_check\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 66, in __exit__\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/errors.py\", line 463, in raise_exception_on_not_ok_status\r\ntensorflow.python.framework.errors.ResourceExhaustedError: /var/folders/6c/3pzbp8jj3zd0lkhsszmvyd5h001cct/T/tmpzr7juea4/graph.pbtxt\r\n\r\nDuring the run \"lsof\" is indicating that the number of file descriptors used is increased on every loop iteration."}