{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19746", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19746/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19746/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19746/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19746", "id": 329044786, "node_id": "MDU6SXNzdWUzMjkwNDQ3ODY=", "number": 19746, "title": "FLOP calculation by tf.profiler might be wrong", "user": {"login": "benmyara", "id": 16196950, "node_id": "MDQ6VXNlcjE2MTk2OTUw", "avatar_url": "https://avatars2.githubusercontent.com/u/16196950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benmyara", "html_url": "https://github.com/benmyara", "followers_url": "https://api.github.com/users/benmyara/followers", "following_url": "https://api.github.com/users/benmyara/following{/other_user}", "gists_url": "https://api.github.com/users/benmyara/gists{/gist_id}", "starred_url": "https://api.github.com/users/benmyara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benmyara/subscriptions", "organizations_url": "https://api.github.com/users/benmyara/orgs", "repos_url": "https://api.github.com/users/benmyara/repos", "events_url": "https://api.github.com/users/benmyara/events{/privacy}", "received_events_url": "https://api.github.com/users/benmyara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-06-04T12:59:15Z", "updated_at": "2018-10-27T11:50:01Z", "closed_at": "2018-10-26T21:09:07Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Have I written custom code: Yes<br>\nOS Platform and Distribution: macOS 10.11.13<br>\nTensorFlow installed from: pip<br>\nTensorFlow version: 1.6.0<br>\nBazel version: N/A<br>\nCUDA/cuDNN version: N/A<br>\nGPU model and memory: N/A<br>\nExact command to reproduce: see code below</p>\n<pre><code>import tensorflow as tf\ng = tf.Graph()\nwith g.as_default():\n    m, p, q = 25, 16, 9\n    A = tf.Variable(tf.zeros([m, p]))\n    B = tf.Variable(tf.zeros([p, q]))\n    C = tf.matmul(A,B)\n\n    flops = tf.profiler.profile(g, options = tf.profiler.ProfileOptionBuilder.float_operation())\n    if flops is not None:\n        print('FLOP should be', m * q * (2 * p - 1))\n        print('Calculated FLOP', flops.total_float_ops)\n</code></pre>\n<p>Given two matrices <code>A</code> of shape <code>(m, p)</code> and <code>B</code> of shape <code>(p, q)</code>, the number of floating point operations (FLOP) should be <code>mq(2p-1)</code>.</p>\n<p>Calculating the number of FLOP using tensorflow's profiler gives <code>2mqp</code> instead of <code>mq(2p-1)</code>.</p>", "body_text": "Have I written custom code: Yes\nOS Platform and Distribution: macOS 10.11.13\nTensorFlow installed from: pip\nTensorFlow version: 1.6.0\nBazel version: N/A\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce: see code below\nimport tensorflow as tf\ng = tf.Graph()\nwith g.as_default():\n    m, p, q = 25, 16, 9\n    A = tf.Variable(tf.zeros([m, p]))\n    B = tf.Variable(tf.zeros([p, q]))\n    C = tf.matmul(A,B)\n\n    flops = tf.profiler.profile(g, options = tf.profiler.ProfileOptionBuilder.float_operation())\n    if flops is not None:\n        print('FLOP should be', m * q * (2 * p - 1))\n        print('Calculated FLOP', flops.total_float_ops)\n\nGiven two matrices A of shape (m, p) and B of shape (p, q), the number of floating point operations (FLOP) should be mq(2p-1).\nCalculating the number of FLOP using tensorflow's profiler gives 2mqp instead of mq(2p-1).", "body": "Have I written custom code: Yes\r\nOS Platform and Distribution: macOS 10.11.13\r\nTensorFlow installed from: pip \r\nTensorFlow version: 1.6.0\r\nBazel version: N/A\r\nCUDA/cuDNN version: N/A\r\nGPU model and memory: N/A\r\nExact command to reproduce: see code below\r\n\r\n```\r\nimport tensorflow as tf\r\ng = tf.Graph()\r\nwith g.as_default():\r\n    m, p, q = 25, 16, 9\r\n    A = tf.Variable(tf.zeros([m, p]))\r\n    B = tf.Variable(tf.zeros([p, q]))\r\n    C = tf.matmul(A,B)\r\n\r\n    flops = tf.profiler.profile(g, options = tf.profiler.ProfileOptionBuilder.float_operation())\r\n    if flops is not None:\r\n        print('FLOP should be', m * q * (2 * p - 1))\r\n        print('Calculated FLOP', flops.total_float_ops)\r\n```\r\n\r\n\r\nGiven two matrices `A` of shape `(m, p)` and `B` of shape `(p, q)`, the number of floating point operations (FLOP) should be `mq(2p-1)`.\r\n\r\nCalculating the number of FLOP using tensorflow's profiler gives `2mqp` instead of `mq(2p-1)`."}