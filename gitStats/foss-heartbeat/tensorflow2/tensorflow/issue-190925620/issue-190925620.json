{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5777", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5777/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5777/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5777/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5777", "id": 190925620, "node_id": "MDU6SXNzdWUxOTA5MjU2MjA=", "number": 5777, "title": "GPU becomes unavailable after computer wakes up ", "user": {"login": "Sadrpour", "id": 15974411, "node_id": "MDQ6VXNlcjE1OTc0NDEx", "avatar_url": "https://avatars2.githubusercontent.com/u/15974411?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Sadrpour", "html_url": "https://github.com/Sadrpour", "followers_url": "https://api.github.com/users/Sadrpour/followers", "following_url": "https://api.github.com/users/Sadrpour/following{/other_user}", "gists_url": "https://api.github.com/users/Sadrpour/gists{/gist_id}", "starred_url": "https://api.github.com/users/Sadrpour/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Sadrpour/subscriptions", "organizations_url": "https://api.github.com/users/Sadrpour/orgs", "repos_url": "https://api.github.com/users/Sadrpour/repos", "events_url": "https://api.github.com/users/Sadrpour/events{/privacy}", "received_events_url": "https://api.github.com/users/Sadrpour/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2016-11-22T07:25:16Z", "updated_at": "2018-08-13T22:54:10Z", "closed_at": "2018-02-07T23:39:48Z", "author_association": "NONE", "body_html": "<p>I noticed many have issues with GPU being unavailable with message (e.g., <a href=\"https://github.com/tensorflow/tensorflow/issues/394\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/394/hovercard\">issue 394</a>)</p>\n<p><code>E tensorflow/stream_executor/cuda/cuda_driver.cc:491] failed call to cuInit: CUDA_ERROR_UNKNOWN </code><br>\nsome suggested <code>sudo apt-get install nvidia-modprobe</code>  but it does not work for all including me. my GPU works until i put the computer to sleep/suspense, but after waking up the computer i always get the message above and the GPU (gtx 1070) is no longer available in execution of the code (only CPU is used) in nvidia docker.  I also noticed if prior to suspending the computer i exit the docker and then restart it when i wake the computer the GPU is still available in docker. So, the problem happens if i suspend the computer while the ipython-notebook session is up and running.</p>\n<p>I am using nvidia-docker</p>\n<p><code>nvidia-docker run -it -p 8888:8888 -v /*..../Data/docker:/docker --name TensorFlow   gcr.io/tensorflow/tensorflow:latest-gpu /bin/bash</code></p>\n<p>Nvidia-smi and nvidia-debugdump -l both show the GPU is installed and driver is up to date within docker and in the host.</p>\n<p>when i run nvidia-smi in docker the output is</p>\n<p>+-----------------------------------------------------------------------------+<br>\n| NVIDIA-SMI 367.57                 Driver Version: 367.57                    |<br>\n|-------------------------------+----------------------+----------------------+<br>\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |<br>\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |<br>\n|===============================+======================+======================|<br>\n|   0  GeForce GTX 1070    Off  | 0000:01:00.0      On |                  N/A |<br>\n|  0%   41C    P0    39W / 180W |    450MiB /  8105MiB |      0%      Default |<br>\n+-------------------------------+----------------------+----------------------+</p>\n<p>+-----------------------------------------------------------------------------+<br>\n| Processes:                                                       GPU Memory |<br>\n|  GPU       PID  Type  Process name                               Usage      |<br>\n|=============================================================================|<br>\n+-----------------------------------------------------------------------------+</p>\n<pre><code>I tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcurand.so locally\nE tensorflow/stream_executor/cuda/cuda_driver.cc:491] failed call to cuInit: CUDA_ERROR_UNKNOWN\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:153] retrieving CUDA diagnostic information for host: ca234sff235\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:160] hostname: ca234sff235\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:185] libcuda reported version is: 367.57.0\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:356] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  367.57  Mon Oct  3 20:37:01 PDT 2016\nGCC version:  gcc version 4.9.3 (Ubuntu 4.9.3-13ubuntu2) \n\"\"\"\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] kernel reported version is: 367.57.0\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:293] kernel version seems to match DSO: 367.57.0\n</code></pre>\n<p>Software specs:<br>\nOS: Ubuntu 16.04 LTS - 64 bit<br>\nGPU driver: nvidia 367.57<br>\nCuda : 7.5</p>", "body_text": "I noticed many have issues with GPU being unavailable with message (e.g., issue 394)\nE tensorflow/stream_executor/cuda/cuda_driver.cc:491] failed call to cuInit: CUDA_ERROR_UNKNOWN \nsome suggested sudo apt-get install nvidia-modprobe  but it does not work for all including me. my GPU works until i put the computer to sleep/suspense, but after waking up the computer i always get the message above and the GPU (gtx 1070) is no longer available in execution of the code (only CPU is used) in nvidia docker.  I also noticed if prior to suspending the computer i exit the docker and then restart it when i wake the computer the GPU is still available in docker. So, the problem happens if i suspend the computer while the ipython-notebook session is up and running.\nI am using nvidia-docker\nnvidia-docker run -it -p 8888:8888 -v /*..../Data/docker:/docker --name TensorFlow   gcr.io/tensorflow/tensorflow:latest-gpu /bin/bash\nNvidia-smi and nvidia-debugdump -l both show the GPU is installed and driver is up to date within docker and in the host.\nwhen i run nvidia-smi in docker the output is\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 367.57                 Driver Version: 367.57                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1070    Off  | 0000:01:00.0      On |                  N/A |\n|  0%   41C    P0    39W / 180W |    450MiB /  8105MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n|=============================================================================|\n+-----------------------------------------------------------------------------+\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcurand.so locally\nE tensorflow/stream_executor/cuda/cuda_driver.cc:491] failed call to cuInit: CUDA_ERROR_UNKNOWN\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:153] retrieving CUDA diagnostic information for host: ca234sff235\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:160] hostname: ca234sff235\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:185] libcuda reported version is: 367.57.0\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:356] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  367.57  Mon Oct  3 20:37:01 PDT 2016\nGCC version:  gcc version 4.9.3 (Ubuntu 4.9.3-13ubuntu2) \n\"\"\"\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] kernel reported version is: 367.57.0\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:293] kernel version seems to match DSO: 367.57.0\n\nSoftware specs:\nOS: Ubuntu 16.04 LTS - 64 bit\nGPU driver: nvidia 367.57\nCuda : 7.5", "body": "I noticed many have issues with GPU being unavailable with message (e.g., [issue 394](https://github.com/tensorflow/tensorflow/issues/394))\r\n\r\n`E tensorflow/stream_executor/cuda/cuda_driver.cc:491] failed call to cuInit: CUDA_ERROR_UNKNOWN\r\n` \r\nsome suggested `sudo apt-get install nvidia-modprobe`  but it does not work for all including me. my GPU works until i put the computer to sleep/suspense, but after waking up the computer i always get the message above and the GPU (gtx 1070) is no longer available in execution of the code (only CPU is used) in nvidia docker.  I also noticed if prior to suspending the computer i exit the docker and then restart it when i wake the computer the GPU is still available in docker. So, the problem happens if i suspend the computer while the ipython-notebook session is up and running. \r\n\r\nI am using nvidia-docker \r\n\r\n`nvidia-docker run -it -p 8888:8888 -v /*..../Data/docker:/docker --name TensorFlow   gcr.io/tensorflow/tensorflow:latest-gpu /bin/bash`\r\n\r\nNvidia-smi and nvidia-debugdump -l both show the GPU is installed and driver is up to date within docker and in the host. \r\n\r\nwhen i run nvidia-smi in docker the output is \r\n\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 367.57                 Driver Version: 367.57                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1070    Off  | 0000:01:00.0      On |                  N/A |\r\n|  0%   41C    P0    39W / 180W |    450MiB /  8105MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID  Type  Process name                               Usage      |\r\n|=============================================================================|\r\n+-----------------------------------------------------------------------------+\r\n\r\n                                                                               \r\n\r\n\r\n```\r\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcublas.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcudnn.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcufft.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:111] successfully opened CUDA library libcurand.so locally\r\nE tensorflow/stream_executor/cuda/cuda_driver.cc:491] failed call to cuInit: CUDA_ERROR_UNKNOWN\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:153] retrieving CUDA diagnostic information for host: ca234sff235\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:160] hostname: ca234sff235\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:185] libcuda reported version is: 367.57.0\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:356] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  367.57  Mon Oct  3 20:37:01 PDT 2016\r\nGCC version:  gcc version 4.9.3 (Ubuntu 4.9.3-13ubuntu2) \r\n\"\"\"\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] kernel reported version is: 367.57.0\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:293] kernel version seems to match DSO: 367.57.0\r\n```\r\n\r\nSoftware specs:\r\nOS: Ubuntu 16.04 LTS - 64 bit\r\nGPU driver: nvidia 367.57\r\nCuda : 7.5"}