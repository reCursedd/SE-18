{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3731", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3731/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3731/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3731/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3731", "id": 170445823, "node_id": "MDU6SXNzdWUxNzA0NDU4MjM=", "number": 3731, "title": "0.10.0rc0: tf.pack uses the wrong negative axis", "user": {"login": "jlowin", "id": 153965, "node_id": "MDQ6VXNlcjE1Mzk2NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/153965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlowin", "html_url": "https://github.com/jlowin", "followers_url": "https://api.github.com/users/jlowin/followers", "following_url": "https://api.github.com/users/jlowin/following{/other_user}", "gists_url": "https://api.github.com/users/jlowin/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlowin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlowin/subscriptions", "organizations_url": "https://api.github.com/users/jlowin/orgs", "repos_url": "https://api.github.com/users/jlowin/repos", "events_url": "https://api.github.com/users/jlowin/events{/privacy}", "received_events_url": "https://api.github.com/users/jlowin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "girving", "id": 70511, "node_id": "MDQ6VXNlcjcwNTEx", "avatar_url": "https://avatars1.githubusercontent.com/u/70511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/girving", "html_url": "https://github.com/girving", "followers_url": "https://api.github.com/users/girving/followers", "following_url": "https://api.github.com/users/girving/following{/other_user}", "gists_url": "https://api.github.com/users/girving/gists{/gist_id}", "starred_url": "https://api.github.com/users/girving/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/girving/subscriptions", "organizations_url": "https://api.github.com/users/girving/orgs", "repos_url": "https://api.github.com/users/girving/repos", "events_url": "https://api.github.com/users/girving/events{/privacy}", "received_events_url": "https://api.github.com/users/girving/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "girving", "id": 70511, "node_id": "MDQ6VXNlcjcwNTEx", "avatar_url": "https://avatars1.githubusercontent.com/u/70511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/girving", "html_url": "https://github.com/girving", "followers_url": "https://api.github.com/users/girving/followers", "following_url": "https://api.github.com/users/girving/following{/other_user}", "gists_url": "https://api.github.com/users/girving/gists{/gist_id}", "starred_url": "https://api.github.com/users/girving/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/girving/subscriptions", "organizations_url": "https://api.github.com/users/girving/orgs", "repos_url": "https://api.github.com/users/girving/repos", "events_url": "https://api.github.com/users/girving/events{/privacy}", "received_events_url": "https://api.github.com/users/girving/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2016-08-10T15:26:16Z", "updated_at": "2016-08-12T16:49:55Z", "closed_at": "2016-08-12T16:49:55Z", "author_association": "NONE", "body_html": "<p>When supplied a negative axis, tf.pack() actually operates on <code>(axis - 1)</code>. For example, providing <code>axis=-1</code> operates on the second-to-last axis, not the last axis.</p>\n<p>This code illustrates the issue:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>10 tensors with shape 2, 3, 4, 5</span>\nx <span class=\"pl-k\">=</span> [tf.convert_to_tensor(np.zeros((<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">5</span>)))] <span class=\"pl-k\">*</span> <span class=\"pl-c1\">10</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> pack along last axis explicitly</span>\ntf.pack(x, <span class=\"pl-c1\">4</span>).get_shape().as_list() <span class=\"pl-c\"><span class=\"pl-c\">#</span> [2, 3, 4, 5, 10]</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> pack along last axis with negative axis, doesn't work</span>\ntf.pack(x, <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>).get_shape().as_list() <span class=\"pl-c\"><span class=\"pl-c\">#</span> [2, 3, 4, 10, 5]</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> this doesn't match the behavior of unpack(), so packing/unpacking </span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> along the same negative axis fails</span>\n<span class=\"pl-c1\">len</span>(tf.unpack(tf.pack(x, <span class=\"pl-v\">axis</span><span class=\"pl-k\">=</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>), <span class=\"pl-v\">axis</span><span class=\"pl-k\">=</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>)) <span class=\"pl-k\">==</span> <span class=\"pl-c1\">10</span> <span class=\"pl-c\"><span class=\"pl-c\">#</span> False</span>\n</pre></div>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nmacOS 10.11</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):<br>\nN/A</p>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>Which pip package you installed.<br>\n<a href=\"https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.10.0rc0-py3-none-any.whl\" rel=\"nofollow\">https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.10.0rc0-py3-none-any.whl</a></li>\n<li>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.<br>\n0.10.0rc0</li>\n</ol>", "body_text": "When supplied a negative axis, tf.pack() actually operates on (axis - 1). For example, providing axis=-1 operates on the second-to-last axis, not the last axis.\nThis code illustrates the issue:\nimport tensorflow as tf\nimport numpy as np\n\n#10 tensors with shape 2, 3, 4, 5\nx = [tf.convert_to_tensor(np.zeros((2, 3, 4, 5)))] * 10\n\n# pack along last axis explicitly\ntf.pack(x, 4).get_shape().as_list() # [2, 3, 4, 5, 10]\n\n# pack along last axis with negative axis, doesn't work\ntf.pack(x, -1).get_shape().as_list() # [2, 3, 4, 10, 5]\n\n# this doesn't match the behavior of unpack(), so packing/unpacking \n# along the same negative axis fails\nlen(tf.unpack(tf.pack(x, axis=-1), axis=-1)) == 10 # False\n\nEnvironment info\nOperating System:\nmacOS 10.11\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\nN/A\nIf installed from binary pip package, provide:\n\nWhich pip package you installed.\nhttps://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.10.0rc0-py3-none-any.whl\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\n0.10.0rc0", "body": "When supplied a negative axis, tf.pack() actually operates on `(axis - 1)`. For example, providing `axis=-1` operates on the second-to-last axis, not the last axis.\n\nThis code illustrates the issue:\n\n``` python\nimport tensorflow as tf\nimport numpy as np\n\n#10 tensors with shape 2, 3, 4, 5\nx = [tf.convert_to_tensor(np.zeros((2, 3, 4, 5)))] * 10\n\n# pack along last axis explicitly\ntf.pack(x, 4).get_shape().as_list() # [2, 3, 4, 5, 10]\n\n# pack along last axis with negative axis, doesn't work\ntf.pack(x, -1).get_shape().as_list() # [2, 3, 4, 10, 5]\n\n# this doesn't match the behavior of unpack(), so packing/unpacking \n# along the same negative axis fails\nlen(tf.unpack(tf.pack(x, axis=-1), axis=-1)) == 10 # False\n\n```\n### Environment info\n\nOperating System: \nmacOS 10.11\n\nInstalled version of CUDA and cuDNN: \n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`): \nN/A\n\nIf installed from binary pip package, provide:\n1. Which pip package you installed.\n   https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.10.0rc0-py3-none-any.whl\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\n   0.10.0rc0\n"}