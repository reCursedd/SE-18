{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16161", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16161/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16161/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16161/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16161", "id": 288917135, "node_id": "MDU6SXNzdWUyODg5MTcxMzU=", "number": 16161, "title": "tf.case raising IllegalArgumentError 'None of the conditions evaluated as True' when used with Dataset", "user": {"login": "andreas-eberle", "id": 9267365, "node_id": "MDQ6VXNlcjkyNjczNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/9267365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andreas-eberle", "html_url": "https://github.com/andreas-eberle", "followers_url": "https://api.github.com/users/andreas-eberle/followers", "following_url": "https://api.github.com/users/andreas-eberle/following{/other_user}", "gists_url": "https://api.github.com/users/andreas-eberle/gists{/gist_id}", "starred_url": "https://api.github.com/users/andreas-eberle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andreas-eberle/subscriptions", "organizations_url": "https://api.github.com/users/andreas-eberle/orgs", "repos_url": "https://api.github.com/users/andreas-eberle/repos", "events_url": "https://api.github.com/users/andreas-eberle/events{/privacy}", "received_events_url": "https://api.github.com/users/andreas-eberle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-01-16T14:01:26Z", "updated_at": "2018-01-17T19:29:17Z", "closed_at": "2018-01-17T19:01:54Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nWindows 10 64bit</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nvia pip</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\n1.4.0</li>\n<li><strong>Python version</strong>:<br>\n3.5</li>\n</ul>\n<p>When I use tf.case within a tf.data.Dataset, I get an IllegalArgumentError 'None of the conditions evaluated as True'. However, when I use the same code without the Dataset, it works fine. Furthermore, if I understand the error message correctly, it already tells me that one condition evaluated to true (see the end of the first line):</p>\n<pre><code>InvalidArgumentError (see above for traceback): assertion failed: [None of the conditions evaluated as True. Conditions: (Equal_3:0, Equal_4:0, Equal_5:0), Values:] [1 0 0]\n\t [[Node: case/If_0/Assert_1/AssertGuard/Assert = Assert[T=[DT_STRING, DT_BOOL], summarize=3](case/If_0/Assert_1/AssertGuard/Assert/Switch, case/If_0/Assert_1/AssertGuard/Assert/data_0, case/If_0/Assert_1/AssertGuard/Assert/Switch_1)]]\n\t [[Node: IteratorGetNext = IteratorGetNext[output_shapes=[[]], output_types=[DT_INT32], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](OneShotIterator)]]\n</code></pre>\n<p>The following code reproduces the issue:</p>\n<pre><code>import tensorflow as tf\n\n\ndef random_map(i):\n\trandom_int = tf.random_uniform([], minval=0, maxval=3, dtype=tf.int32)\n\trandom_int = tf.Print(random_int, [random_int, tf.equal(random_int, 0), tf.equal(random_int, 1), tf.equal(random_int, 2)], 'random_int')\n\n\tresult = tf.case([\n\t\t(tf.equal(random_int, 0), lambda: i * 10000),\n\t\t(tf.equal(random_int, 1), lambda: i * 20000),\n\t\t(tf.equal(random_int, 2), lambda: i * 30000)\n\t], exclusive=True)\n\n\treturn result\n\n\nprint('working =========================================================================')\nwith tf.Session() as sess:\n\tinput_pl = tf.placeholder(dtype=tf.int32)\n\tresult = random_map(input_pl)\n\tfor i in range(5):\n\t\tresult_value = sess.run(result, feed_dict={input_pl: i})\n\t\tprint(result_value)\n\nprint('not working =====================================================================')\nwith tf.Session() as sess:\n\tdataset = tf.data.Dataset.from_tensor_slices(tf.range(5))\n\tdataset = dataset.map(random_map)\n\titerator = dataset.make_one_shot_iterator()\n\tnext_result = iterator.get_next()\n\n\tfor i in range(5):\n\t\tresult_value = sess.run(next_result)\n\t\tprint(result_value)\n</code></pre>\n<p>I also found <a href=\"http://www.programfaqs.com/faq/tensorflow-case-error-invalid-argument-assertion-failed-none-of-the-conditions-evaluated-as-true/\" rel=\"nofollow\">this question</a>, which seems to be the same problem.</p>", "body_text": "System information\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nWindows 10 64bit\nTensorFlow installed from (source or binary):\nvia pip\nTensorFlow version (use command below):\n1.4.0\nPython version:\n3.5\n\nWhen I use tf.case within a tf.data.Dataset, I get an IllegalArgumentError 'None of the conditions evaluated as True'. However, when I use the same code without the Dataset, it works fine. Furthermore, if I understand the error message correctly, it already tells me that one condition evaluated to true (see the end of the first line):\nInvalidArgumentError (see above for traceback): assertion failed: [None of the conditions evaluated as True. Conditions: (Equal_3:0, Equal_4:0, Equal_5:0), Values:] [1 0 0]\n\t [[Node: case/If_0/Assert_1/AssertGuard/Assert = Assert[T=[DT_STRING, DT_BOOL], summarize=3](case/If_0/Assert_1/AssertGuard/Assert/Switch, case/If_0/Assert_1/AssertGuard/Assert/data_0, case/If_0/Assert_1/AssertGuard/Assert/Switch_1)]]\n\t [[Node: IteratorGetNext = IteratorGetNext[output_shapes=[[]], output_types=[DT_INT32], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](OneShotIterator)]]\n\nThe following code reproduces the issue:\nimport tensorflow as tf\n\n\ndef random_map(i):\n\trandom_int = tf.random_uniform([], minval=0, maxval=3, dtype=tf.int32)\n\trandom_int = tf.Print(random_int, [random_int, tf.equal(random_int, 0), tf.equal(random_int, 1), tf.equal(random_int, 2)], 'random_int')\n\n\tresult = tf.case([\n\t\t(tf.equal(random_int, 0), lambda: i * 10000),\n\t\t(tf.equal(random_int, 1), lambda: i * 20000),\n\t\t(tf.equal(random_int, 2), lambda: i * 30000)\n\t], exclusive=True)\n\n\treturn result\n\n\nprint('working =========================================================================')\nwith tf.Session() as sess:\n\tinput_pl = tf.placeholder(dtype=tf.int32)\n\tresult = random_map(input_pl)\n\tfor i in range(5):\n\t\tresult_value = sess.run(result, feed_dict={input_pl: i})\n\t\tprint(result_value)\n\nprint('not working =====================================================================')\nwith tf.Session() as sess:\n\tdataset = tf.data.Dataset.from_tensor_slices(tf.range(5))\n\tdataset = dataset.map(random_map)\n\titerator = dataset.make_one_shot_iterator()\n\tnext_result = iterator.get_next()\n\n\tfor i in range(5):\n\t\tresult_value = sess.run(next_result)\n\t\tprint(result_value)\n\nI also found this question, which seems to be the same problem.", "body": "### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows 10 64bit\r\n- **TensorFlow installed from (source or binary)**:\r\nvia pip\r\n- **TensorFlow version (use command below)**:\r\n1.4.0\r\n- **Python version**: \r\n3.5\r\n\r\nWhen I use tf.case within a tf.data.Dataset, I get an IllegalArgumentError 'None of the conditions evaluated as True'. However, when I use the same code without the Dataset, it works fine. Furthermore, if I understand the error message correctly, it already tells me that one condition evaluated to true (see the end of the first line):\r\n\r\n```\r\nInvalidArgumentError (see above for traceback): assertion failed: [None of the conditions evaluated as True. Conditions: (Equal_3:0, Equal_4:0, Equal_5:0), Values:] [1 0 0]\r\n\t [[Node: case/If_0/Assert_1/AssertGuard/Assert = Assert[T=[DT_STRING, DT_BOOL], summarize=3](case/If_0/Assert_1/AssertGuard/Assert/Switch, case/If_0/Assert_1/AssertGuard/Assert/data_0, case/If_0/Assert_1/AssertGuard/Assert/Switch_1)]]\r\n\t [[Node: IteratorGetNext = IteratorGetNext[output_shapes=[[]], output_types=[DT_INT32], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](OneShotIterator)]]\r\n```\r\n\r\nThe following code reproduces the issue:\r\n```\r\nimport tensorflow as tf\r\n\r\n\r\ndef random_map(i):\r\n\trandom_int = tf.random_uniform([], minval=0, maxval=3, dtype=tf.int32)\r\n\trandom_int = tf.Print(random_int, [random_int, tf.equal(random_int, 0), tf.equal(random_int, 1), tf.equal(random_int, 2)], 'random_int')\r\n\r\n\tresult = tf.case([\r\n\t\t(tf.equal(random_int, 0), lambda: i * 10000),\r\n\t\t(tf.equal(random_int, 1), lambda: i * 20000),\r\n\t\t(tf.equal(random_int, 2), lambda: i * 30000)\r\n\t], exclusive=True)\r\n\r\n\treturn result\r\n\r\n\r\nprint('working =========================================================================')\r\nwith tf.Session() as sess:\r\n\tinput_pl = tf.placeholder(dtype=tf.int32)\r\n\tresult = random_map(input_pl)\r\n\tfor i in range(5):\r\n\t\tresult_value = sess.run(result, feed_dict={input_pl: i})\r\n\t\tprint(result_value)\r\n\r\nprint('not working =====================================================================')\r\nwith tf.Session() as sess:\r\n\tdataset = tf.data.Dataset.from_tensor_slices(tf.range(5))\r\n\tdataset = dataset.map(random_map)\r\n\titerator = dataset.make_one_shot_iterator()\r\n\tnext_result = iterator.get_next()\r\n\r\n\tfor i in range(5):\r\n\t\tresult_value = sess.run(next_result)\r\n\t\tprint(result_value)\r\n```\r\n\r\nI also found [this question]( http://www.programfaqs.com/faq/tensorflow-case-error-invalid-argument-assertion-failed-none-of-the-conditions-evaluated-as-true/), which seems to be the same problem."}