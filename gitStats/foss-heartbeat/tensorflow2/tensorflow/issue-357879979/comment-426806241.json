{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/426806241", "html_url": "https://github.com/tensorflow/tensorflow/issues/22130#issuecomment-426806241", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22130", "id": 426806241, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjgwNjI0MQ==", "user": {"login": "Keno", "id": 1291671, "node_id": "MDQ6VXNlcjEyOTE2NzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1291671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Keno", "html_url": "https://github.com/Keno", "followers_url": "https://api.github.com/users/Keno/followers", "following_url": "https://api.github.com/users/Keno/following{/other_user}", "gists_url": "https://api.github.com/users/Keno/gists{/gist_id}", "starred_url": "https://api.github.com/users/Keno/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Keno/subscriptions", "organizations_url": "https://api.github.com/users/Keno/orgs", "repos_url": "https://api.github.com/users/Keno/repos", "events_url": "https://api.github.com/users/Keno/events{/privacy}", "received_events_url": "https://api.github.com/users/Keno/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-03T21:15:05Z", "updated_at": "2018-10-03T21:15:05Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Yep, I noticed <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/05812d761031b108b43560c90867b96dc4f030eb/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/05812d761031b108b43560c90867b96dc4f030eb\"><tt>05812d7</tt></a>. Great work, thank you! Something else I had lying around was</p>\n<pre><code>diff --git a/tensorflow/compiler/xla/service/hlo_instruction.cc b/tensorflow/compiler/xla/service/hlo_instruction.cc\nindex 6d13f85cbb..daa7cebb73 100644\n--- a/tensorflow/compiler/xla/service/hlo_instruction.cc\n+++ b/tensorflow/compiler/xla/service/hlo_instruction.cc\n@@ -285,6 +288,9 @@ StatusOr&lt;std::unique_ptr&lt;HloInstruction&gt;&gt; HloInstruction::CreateFromProto(\n       TF_RET_CHECK(proto.operand_ids_size() == 1)\n           &lt;&lt; \"GetTupleElement instruction should have 1 operand but sees \"\n           &lt;&lt; proto.operand_ids_size();\n+      TF_RET_CHECK(ShapeUtil::IsTuple(operands(0)-&gt;shape()))\n+          &lt;&lt; \"GetTupleElement instruction should operate on a tuple, got \"\n+          &lt;&lt; operands(0)-&gt;shape();\n       instruction = CreateGetTupleElement(proto.shape(), operands(0),\n                                           proto.tuple_index());\n</code></pre>\n<p>if either of you want to pick that up (or I can submit a PR if you'd prefer). I suspect the tuple_index needs to be validated there as well.</p>", "body_text": "Yep, I noticed 05812d7. Great work, thank you! Something else I had lying around was\ndiff --git a/tensorflow/compiler/xla/service/hlo_instruction.cc b/tensorflow/compiler/xla/service/hlo_instruction.cc\nindex 6d13f85cbb..daa7cebb73 100644\n--- a/tensorflow/compiler/xla/service/hlo_instruction.cc\n+++ b/tensorflow/compiler/xla/service/hlo_instruction.cc\n@@ -285,6 +288,9 @@ StatusOr<std::unique_ptr<HloInstruction>> HloInstruction::CreateFromProto(\n       TF_RET_CHECK(proto.operand_ids_size() == 1)\n           << \"GetTupleElement instruction should have 1 operand but sees \"\n           << proto.operand_ids_size();\n+      TF_RET_CHECK(ShapeUtil::IsTuple(operands(0)->shape()))\n+          << \"GetTupleElement instruction should operate on a tuple, got \"\n+          << operands(0)->shape();\n       instruction = CreateGetTupleElement(proto.shape(), operands(0),\n                                           proto.tuple_index());\n\nif either of you want to pick that up (or I can submit a PR if you'd prefer). I suspect the tuple_index needs to be validated there as well.", "body": "Yep, I noticed 05812d761031b108b43560c90867b96dc4f030eb. Great work, thank you! Something else I had lying around was \r\n```\r\ndiff --git a/tensorflow/compiler/xla/service/hlo_instruction.cc b/tensorflow/compiler/xla/service/hlo_instruction.cc\r\nindex 6d13f85cbb..daa7cebb73 100644\r\n--- a/tensorflow/compiler/xla/service/hlo_instruction.cc\r\n+++ b/tensorflow/compiler/xla/service/hlo_instruction.cc\r\n@@ -285,6 +288,9 @@ StatusOr<std::unique_ptr<HloInstruction>> HloInstruction::CreateFromProto(\r\n       TF_RET_CHECK(proto.operand_ids_size() == 1)\r\n           << \"GetTupleElement instruction should have 1 operand but sees \"\r\n           << proto.operand_ids_size();\r\n+      TF_RET_CHECK(ShapeUtil::IsTuple(operands(0)->shape()))\r\n+          << \"GetTupleElement instruction should operate on a tuple, got \"\r\n+          << operands(0)->shape();\r\n       instruction = CreateGetTupleElement(proto.shape(), operands(0),\r\n                                           proto.tuple_index());\r\n```\r\nif either of you want to pick that up (or I can submit a PR if you'd prefer). I suspect the tuple_index needs to be validated there as well. "}