{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/319451250", "html_url": "https://github.com/tensorflow/tensorflow/issues/11823#issuecomment-319451250", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11823", "id": 319451250, "node_id": "MDEyOklzc3VlQ29tbWVudDMxOTQ1MTI1MA==", "user": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-01T18:09:59Z", "updated_at": "2017-08-01T18:09:59Z", "author_association": "MEMBER", "body_html": "<p>I'm able to reproduce locally with <code>--sync=True</code>, by running the three terminal commands in three different terminal windows:</p>\n<pre><code>CUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"worker\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\n</code></pre>\n<pre><code>CUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"ps\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\n</code></pre>\n<pre><code>CUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"master\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\n</code></pre>\n<p>I consistently get the \"Object was never used\" error on the master after the first evaluation.</p>\n<p>The stack trace in the error message (from the <a href=\"https://github.com/tensorflow/tensorflow/issues/11823#issue-246125815\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/11823/hovercard\">first comment</a>) is hard to read since its printed as a Python list. The stack trace, with line breaks, is</p>\n<pre><code>File \"cifar10_main.py\", line 538, in &lt;module&gt;\n    tf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"cifar10_main.py\", line 518, in main\n    hooks), run_config=config)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/learn_runner.py\", line 210, in run\n    return _execute_schedule(experiment, schedule)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/learn_runner.py\", line 47, in _execute_schedule\n    return task()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 501, in train_and_evaluate\n    hooks=self._eval_hooks)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 681, in _call_evaluate\n    hooks=hooks)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 292, in evaluate\n    name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 638, in _evaluate_model\n    features, labels, model_fn_lib.ModeKeys.EVAL)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 545, in _call_model_fn\n    features=features, labels=labels, **kwargs)\nFile \"cifar10_main.py\", line 331, in _resnet_model_fn\n    gradvars, global_step=tf.train.get_global_step())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/sync_replicas_optimizer.py\", line 252, in apply_gradients\n    variables.global_variables())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 170, in wrapped\n    return _add_should_use_warning(fn(*args, **kwargs))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 139, in _add_should_use_warning\n    wrapped = TFShouldUseWarningWrapper(x)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 96, in __init__\n    stack = [s.strip() for s in traceback.format_stack()]\n</code></pre>\n<p>Still waiting for <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=184424\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ali01\">@ali01</a> to respond.</p>", "body_text": "I'm able to reproduce locally with --sync=True, by running the three terminal commands in three different terminal windows:\nCUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"worker\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\n\nCUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"ps\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\n\nCUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"master\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\n\nI consistently get the \"Object was never used\" error on the master after the first evaluation.\nThe stack trace in the error message (from the first comment) is hard to read since its printed as a Python list. The stack trace, with line breaks, is\nFile \"cifar10_main.py\", line 538, in <module>\n    tf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"cifar10_main.py\", line 518, in main\n    hooks), run_config=config)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/learn_runner.py\", line 210, in run\n    return _execute_schedule(experiment, schedule)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/learn_runner.py\", line 47, in _execute_schedule\n    return task()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 501, in train_and_evaluate\n    hooks=self._eval_hooks)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 681, in _call_evaluate\n    hooks=hooks)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 292, in evaluate\n    name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 638, in _evaluate_model\n    features, labels, model_fn_lib.ModeKeys.EVAL)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 545, in _call_model_fn\n    features=features, labels=labels, **kwargs)\nFile \"cifar10_main.py\", line 331, in _resnet_model_fn\n    gradvars, global_step=tf.train.get_global_step())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/sync_replicas_optimizer.py\", line 252, in apply_gradients\n    variables.global_variables())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 170, in wrapped\n    return _add_should_use_warning(fn(*args, **kwargs))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 139, in _add_should_use_warning\n    wrapped = TFShouldUseWarningWrapper(x)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 96, in __init__\n    stack = [s.strip() for s in traceback.format_stack()]\n\nStill waiting for @ali01 to respond.", "body": "I'm able to reproduce locally with `--sync=True`, by running the three terminal commands in three different terminal windows:\r\n```\r\nCUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"worker\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\r\n```\r\n```\r\nCUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"ps\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\r\n```\r\n```\r\nCUDA_VISIBLE_DEVICES= TF_CONFIG='{\"environment\": \"cloud\", \"cluster\": {\"worker\": [\"localhost:12347\"], \"ps\": [\"localhost:12346\"], \"master\": [\"localhost:12345\"]}, \"task\": {\"index\": 0, \"type\": \"master\"}, \"model_dir\": \"/tmp/model\"}' python cifar10_main.py --run_experiment=True --num_workers=2 --train_batch_size=64 --num_gpus=0 --data_dir ~/cifar-10-batches-bin --model_dir=/tmp/model --is_cpu_ps=True --sync=True\r\n```\r\n\r\nI consistently get the \"Object was never used\" error on the master after the first evaluation.\r\n\r\nThe stack trace in the error message (from the [first comment](https://github.com/tensorflow/tensorflow/issues/11823#issue-246125815)) is hard to read since its printed as a Python list. The stack trace, with line breaks, is\r\n```\r\nFile \"cifar10_main.py\", line 538, in <module>\r\n    tf.app.run()\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\nFile \"cifar10_main.py\", line 518, in main\r\n    hooks), run_config=config)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/learn_runner.py\", line 210, in run\r\n    return _execute_schedule(experiment, schedule)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/learn_runner.py\", line 47, in _execute_schedule\r\n    return task()\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 501, in train_and_evaluate\r\n    hooks=self._eval_hooks)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/experiment.py\", line 681, in _call_evaluate\r\n    hooks=hooks)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 292, in evaluate\r\n    name=name)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 638, in _evaluate_model\r\n    features, labels, model_fn_lib.ModeKeys.EVAL)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 545, in _call_model_fn\r\n    features=features, labels=labels, **kwargs)\r\nFile \"cifar10_main.py\", line 331, in _resnet_model_fn\r\n    gradvars, global_step=tf.train.get_global_step())\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/sync_replicas_optimizer.py\", line 252, in apply_gradients\r\n    variables.global_variables())\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 170, in wrapped\r\n    return _add_should_use_warning(fn(*args, **kwargs))\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 139, in _add_should_use_warning\r\n    wrapped = TFShouldUseWarningWrapper(x)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/tf_should_use.py\", line 96, in __init__\r\n    stack = [s.strip() for s in traceback.format_stack()]\r\n```\r\n\r\nStill waiting for @ali01 to respond."}