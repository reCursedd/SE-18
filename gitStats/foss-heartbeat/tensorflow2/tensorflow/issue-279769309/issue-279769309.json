{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15156", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15156/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15156/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15156/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15156", "id": 279769309, "node_id": "MDU6SXNzdWUyNzk3NjkzMDk=", "number": 15156, "title": "Tensorflow set_random_seed", "user": {"login": "gauss-clb", "id": 11674304, "node_id": "MDQ6VXNlcjExNjc0MzA0", "avatar_url": "https://avatars2.githubusercontent.com/u/11674304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gauss-clb", "html_url": "https://github.com/gauss-clb", "followers_url": "https://api.github.com/users/gauss-clb/followers", "following_url": "https://api.github.com/users/gauss-clb/following{/other_user}", "gists_url": "https://api.github.com/users/gauss-clb/gists{/gist_id}", "starred_url": "https://api.github.com/users/gauss-clb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gauss-clb/subscriptions", "organizations_url": "https://api.github.com/users/gauss-clb/orgs", "repos_url": "https://api.github.com/users/gauss-clb/repos", "events_url": "https://api.github.com/users/gauss-clb/events{/privacy}", "received_events_url": "https://api.github.com/users/gauss-clb/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2017-12-06T14:19:43Z", "updated_at": "2018-02-08T14:58:53Z", "closed_at": "2018-02-08T14:58:53Z", "author_association": "NONE", "body_html": "<p>I use <code>tf.set_random_seed</code> to set the seed of graph, and run programs many times, but the result is different.<br>\nIs it a bug or precision problem?</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\nslim <span class=\"pl-k\">=</span>tf.contrib.slim\n\ntf.set_random_seed(<span class=\"pl-c1\">0</span>)\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">vgg16</span>(<span class=\"pl-smi\">inputs</span>):\n  <span class=\"pl-k\">with</span> slim.arg_scope([slim.conv2d, slim.fully_connected],\n                      <span class=\"pl-v\">activation_fn</span><span class=\"pl-k\">=</span>tf.nn.relu,\n                      <span class=\"pl-v\">weights_initializer</span><span class=\"pl-k\">=</span>tf.truncated_normal_initializer(<span class=\"pl-c1\">0.0</span>, <span class=\"pl-c1\">0.01</span>),\n                      <span class=\"pl-v\">weights_regularizer</span><span class=\"pl-k\">=</span>slim.l2_regularizer(<span class=\"pl-c1\">0.0005</span>)):\n    net <span class=\"pl-k\">=</span> slim.repeat(inputs, <span class=\"pl-c1\">2</span>, slim.conv2d, <span class=\"pl-c1\">64</span>, [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>conv1<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.max_pool2d(net, [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>pool1<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.repeat(net, <span class=\"pl-c1\">2</span>, slim.conv2d, <span class=\"pl-c1\">128</span>, [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>conv2<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.max_pool2d(net, [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>pool2<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.repeat(net, <span class=\"pl-c1\">3</span>, slim.conv2d, <span class=\"pl-c1\">256</span>, [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>conv3<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.max_pool2d(net, [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>pool3<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.repeat(net, <span class=\"pl-c1\">3</span>, slim.conv2d, <span class=\"pl-c1\">512</span>, [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>conv4<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.max_pool2d(net, [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>pool4<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.repeat(net, <span class=\"pl-c1\">3</span>, slim.conv2d, <span class=\"pl-c1\">512</span>, [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>conv5<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.max_pool2d(net, [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>], <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>pool5<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.flatten(net)\n    net <span class=\"pl-k\">=</span> slim.fully_connected(net, <span class=\"pl-c1\">4096</span>, <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>fc6<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.dropout(net, <span class=\"pl-c1\">0.5</span>, <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>dropout6<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.fully_connected(net, <span class=\"pl-c1\">4096</span>, <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>fc7<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.dropout(net, <span class=\"pl-c1\">0.5</span>, <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>dropout7<span class=\"pl-pds\">'</span></span>)\n    net <span class=\"pl-k\">=</span> slim.fully_connected(net, <span class=\"pl-c1\">1000</span>, <span class=\"pl-v\">activation_fn</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>, <span class=\"pl-v\">scope</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>fc8<span class=\"pl-pds\">'</span></span>)\n  <span class=\"pl-k\">return</span> net\n\noutputs <span class=\"pl-k\">=</span> vgg16(tf.random_normal([<span class=\"pl-c1\">32</span>, <span class=\"pl-c1\">224</span>, <span class=\"pl-c1\">224</span>, <span class=\"pl-c1\">3</span>]))\nloss <span class=\"pl-k\">=</span> tf.reduce_mean(tf.square(outputs<span class=\"pl-k\">-</span>tf.random_normal([<span class=\"pl-c1\">32</span>, <span class=\"pl-c1\">1000</span>])))\nloss <span class=\"pl-k\">=</span> tf.Print(loss, [loss])\noptimizer <span class=\"pl-k\">=</span> tf.train.GradientDescentOptimizer(<span class=\"pl-c1\">0.001</span>)\ntrain_op <span class=\"pl-k\">=</span> optimizer.minimize(loss)\n\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n    tf.global_variables_initializer().run()\n    <span class=\"pl-k\">for</span> i <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">10</span>):\n        sess.run([loss, train_op])</pre></div>\n<p>Sometimes it prints</p>\n<pre><code>2017-12-06 22:12:46.008551: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00103784]\n2017-12-06 22:12:48.309682: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01074851]\n2017-12-06 22:12:49.039724: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00621808]\n2017-12-06 22:12:49.683761: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00629878]\n2017-12-06 22:12:50.326798: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.999040961]\n2017-12-06 22:12:50.973835: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.991326749]\n2017-12-06 22:12:51.621872: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01098168]\n2017-12-06 22:12:52.266909: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.989544928]\n2017-12-06 22:12:52.911945: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01077247]\n2017-12-06 22:12:53.558982: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00654614]\n</code></pre>\n<p>Or</p>\n<pre><code>2017-12-06 22:14:15.614676: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00103784]\n2017-12-06 22:14:17.945809: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01074851]\n2017-12-06 22:14:18.633848: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00621808]\n2017-12-06 22:14:19.283886: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00629878]\n2017-12-06 22:14:19.932923: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.999040902]\n2017-12-06 22:14:20.582960: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.99132669]\n2017-12-06 22:14:21.231997: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01098168]\n2017-12-06 22:14:21.878034: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.989544928]\n2017-12-06 22:14:22.525071: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01077247]\n2017-12-06 22:14:23.137106: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00654614]\n</code></pre>\n<p>The fifth and sixth float number are a little different.</p>\n<p>If it is the precision problem, the output of program will be different while running on different situation.</p>\n<p>If I use<code> resnet_v1.resnet_v1_101</code>, the difference becomes bigger.<br>\nSee below</p>\n<pre><code>2017-12-06 22:36:10.263869: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.38138771]\n2017-12-06 22:36:10.957909: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37634754]\n2017-12-06 22:36:11.511941: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37431192]\n2017-12-06 22:36:12.065973: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.32495236]\n2017-12-06 22:36:12.618004: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.31184864]\n2017-12-06 22:36:13.171036: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26968479]\n2017-12-06 22:36:13.726067: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26032281]\n2017-12-06 22:36:14.282099: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.21301842]\n2017-12-06 22:36:14.831131: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.25101829]\n2017-12-06 22:36:15.386162: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.14982963]\n</code></pre>\n<p>and</p>\n<pre><code>017-12-06 22:36:46.220926: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.38138771]\n2017-12-06 22:36:46.913966: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.3763473]\n2017-12-06 22:36:47.466997: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37354136]\n2017-12-06 22:36:48.022029: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.32750821]\n2017-12-06 22:36:48.571060: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.30615568]\n2017-12-06 22:36:49.126092: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26913476]\n2017-12-06 22:36:49.682124: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26520848]\n2017-12-06 22:36:50.238156: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.21404171]\n2017-12-06 22:36:50.793188: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.25153565]\n2017-12-06 22:36:51.347219: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.14605141]\n</code></pre>", "body_text": "I use tf.set_random_seed to set the seed of graph, and run programs many times, but the result is different.\nIs it a bug or precision problem?\nimport tensorflow as tf\nslim =tf.contrib.slim\n\ntf.set_random_seed(0)\n\ndef vgg16(inputs):\n  with slim.arg_scope([slim.conv2d, slim.fully_connected],\n                      activation_fn=tf.nn.relu,\n                      weights_initializer=tf.truncated_normal_initializer(0.0, 0.01),\n                      weights_regularizer=slim.l2_regularizer(0.0005)):\n    net = slim.repeat(inputs, 2, slim.conv2d, 64, [3, 3], scope='conv1')\n    net = slim.max_pool2d(net, [2, 2], scope='pool1')\n    net = slim.repeat(net, 2, slim.conv2d, 128, [3, 3], scope='conv2')\n    net = slim.max_pool2d(net, [2, 2], scope='pool2')\n    net = slim.repeat(net, 3, slim.conv2d, 256, [3, 3], scope='conv3')\n    net = slim.max_pool2d(net, [2, 2], scope='pool3')\n    net = slim.repeat(net, 3, slim.conv2d, 512, [3, 3], scope='conv4')\n    net = slim.max_pool2d(net, [2, 2], scope='pool4')\n    net = slim.repeat(net, 3, slim.conv2d, 512, [3, 3], scope='conv5')\n    net = slim.max_pool2d(net, [2, 2], scope='pool5')\n    net = slim.flatten(net)\n    net = slim.fully_connected(net, 4096, scope='fc6')\n    net = slim.dropout(net, 0.5, scope='dropout6')\n    net = slim.fully_connected(net, 4096, scope='fc7')\n    net = slim.dropout(net, 0.5, scope='dropout7')\n    net = slim.fully_connected(net, 1000, activation_fn=None, scope='fc8')\n  return net\n\noutputs = vgg16(tf.random_normal([32, 224, 224, 3]))\nloss = tf.reduce_mean(tf.square(outputs-tf.random_normal([32, 1000])))\nloss = tf.Print(loss, [loss])\noptimizer = tf.train.GradientDescentOptimizer(0.001)\ntrain_op = optimizer.minimize(loss)\n\nwith tf.Session() as sess:\n    tf.global_variables_initializer().run()\n    for i in range(10):\n        sess.run([loss, train_op])\nSometimes it prints\n2017-12-06 22:12:46.008551: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00103784]\n2017-12-06 22:12:48.309682: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01074851]\n2017-12-06 22:12:49.039724: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00621808]\n2017-12-06 22:12:49.683761: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00629878]\n2017-12-06 22:12:50.326798: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.999040961]\n2017-12-06 22:12:50.973835: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.991326749]\n2017-12-06 22:12:51.621872: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01098168]\n2017-12-06 22:12:52.266909: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.989544928]\n2017-12-06 22:12:52.911945: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01077247]\n2017-12-06 22:12:53.558982: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00654614]\n\nOr\n2017-12-06 22:14:15.614676: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00103784]\n2017-12-06 22:14:17.945809: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01074851]\n2017-12-06 22:14:18.633848: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00621808]\n2017-12-06 22:14:19.283886: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00629878]\n2017-12-06 22:14:19.932923: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.999040902]\n2017-12-06 22:14:20.582960: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.99132669]\n2017-12-06 22:14:21.231997: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01098168]\n2017-12-06 22:14:21.878034: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.989544928]\n2017-12-06 22:14:22.525071: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01077247]\n2017-12-06 22:14:23.137106: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00654614]\n\nThe fifth and sixth float number are a little different.\nIf it is the precision problem, the output of program will be different while running on different situation.\nIf I use resnet_v1.resnet_v1_101, the difference becomes bigger.\nSee below\n2017-12-06 22:36:10.263869: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.38138771]\n2017-12-06 22:36:10.957909: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37634754]\n2017-12-06 22:36:11.511941: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37431192]\n2017-12-06 22:36:12.065973: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.32495236]\n2017-12-06 22:36:12.618004: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.31184864]\n2017-12-06 22:36:13.171036: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26968479]\n2017-12-06 22:36:13.726067: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26032281]\n2017-12-06 22:36:14.282099: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.21301842]\n2017-12-06 22:36:14.831131: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.25101829]\n2017-12-06 22:36:15.386162: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.14982963]\n\nand\n017-12-06 22:36:46.220926: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.38138771]\n2017-12-06 22:36:46.913966: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.3763473]\n2017-12-06 22:36:47.466997: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37354136]\n2017-12-06 22:36:48.022029: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.32750821]\n2017-12-06 22:36:48.571060: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.30615568]\n2017-12-06 22:36:49.126092: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26913476]\n2017-12-06 22:36:49.682124: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26520848]\n2017-12-06 22:36:50.238156: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.21404171]\n2017-12-06 22:36:50.793188: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.25153565]\n2017-12-06 22:36:51.347219: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.14605141]", "body": "I use `tf.set_random_seed` to set the seed of graph, and run programs many times, but the result is different.\r\nIs it a bug or precision problem?\r\n\r\n```python\r\nimport tensorflow as tf\r\nslim =tf.contrib.slim\r\n\r\ntf.set_random_seed(0)\r\n\r\ndef vgg16(inputs):\r\n  with slim.arg_scope([slim.conv2d, slim.fully_connected],\r\n                      activation_fn=tf.nn.relu,\r\n                      weights_initializer=tf.truncated_normal_initializer(0.0, 0.01),\r\n                      weights_regularizer=slim.l2_regularizer(0.0005)):\r\n    net = slim.repeat(inputs, 2, slim.conv2d, 64, [3, 3], scope='conv1')\r\n    net = slim.max_pool2d(net, [2, 2], scope='pool1')\r\n    net = slim.repeat(net, 2, slim.conv2d, 128, [3, 3], scope='conv2')\r\n    net = slim.max_pool2d(net, [2, 2], scope='pool2')\r\n    net = slim.repeat(net, 3, slim.conv2d, 256, [3, 3], scope='conv3')\r\n    net = slim.max_pool2d(net, [2, 2], scope='pool3')\r\n    net = slim.repeat(net, 3, slim.conv2d, 512, [3, 3], scope='conv4')\r\n    net = slim.max_pool2d(net, [2, 2], scope='pool4')\r\n    net = slim.repeat(net, 3, slim.conv2d, 512, [3, 3], scope='conv5')\r\n    net = slim.max_pool2d(net, [2, 2], scope='pool5')\r\n    net = slim.flatten(net)\r\n    net = slim.fully_connected(net, 4096, scope='fc6')\r\n    net = slim.dropout(net, 0.5, scope='dropout6')\r\n    net = slim.fully_connected(net, 4096, scope='fc7')\r\n    net = slim.dropout(net, 0.5, scope='dropout7')\r\n    net = slim.fully_connected(net, 1000, activation_fn=None, scope='fc8')\r\n  return net\r\n\r\noutputs = vgg16(tf.random_normal([32, 224, 224, 3]))\r\nloss = tf.reduce_mean(tf.square(outputs-tf.random_normal([32, 1000])))\r\nloss = tf.Print(loss, [loss])\r\noptimizer = tf.train.GradientDescentOptimizer(0.001)\r\ntrain_op = optimizer.minimize(loss)\r\n\r\nwith tf.Session() as sess:\r\n    tf.global_variables_initializer().run()\r\n    for i in range(10):\r\n        sess.run([loss, train_op])\r\n```\r\n\r\nSometimes it prints\r\n```\r\n2017-12-06 22:12:46.008551: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00103784]\r\n2017-12-06 22:12:48.309682: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01074851]\r\n2017-12-06 22:12:49.039724: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00621808]\r\n2017-12-06 22:12:49.683761: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00629878]\r\n2017-12-06 22:12:50.326798: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.999040961]\r\n2017-12-06 22:12:50.973835: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.991326749]\r\n2017-12-06 22:12:51.621872: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01098168]\r\n2017-12-06 22:12:52.266909: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.989544928]\r\n2017-12-06 22:12:52.911945: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01077247]\r\n2017-12-06 22:12:53.558982: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00654614]\r\n```\r\nOr\r\n\r\n```\r\n2017-12-06 22:14:15.614676: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00103784]\r\n2017-12-06 22:14:17.945809: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01074851]\r\n2017-12-06 22:14:18.633848: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00621808]\r\n2017-12-06 22:14:19.283886: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00629878]\r\n2017-12-06 22:14:19.932923: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.999040902]\r\n2017-12-06 22:14:20.582960: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.99132669]\r\n2017-12-06 22:14:21.231997: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01098168]\r\n2017-12-06 22:14:21.878034: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [0.989544928]\r\n2017-12-06 22:14:22.525071: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.01077247]\r\n2017-12-06 22:14:23.137106: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [1.00654614]\r\n```\r\n\r\nThe fifth and sixth float number are a little different.\r\n\r\nIf it is the precision problem, the output of program will be different while running on different situation.\r\n\r\nIf I use` resnet_v1.resnet_v1_101`, the difference becomes bigger.\r\nSee below\r\n```\r\n2017-12-06 22:36:10.263869: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.38138771]\r\n2017-12-06 22:36:10.957909: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37634754]\r\n2017-12-06 22:36:11.511941: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37431192]\r\n2017-12-06 22:36:12.065973: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.32495236]\r\n2017-12-06 22:36:12.618004: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.31184864]\r\n2017-12-06 22:36:13.171036: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26968479]\r\n2017-12-06 22:36:13.726067: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26032281]\r\n2017-12-06 22:36:14.282099: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.21301842]\r\n2017-12-06 22:36:14.831131: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.25101829]\r\n2017-12-06 22:36:15.386162: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.14982963]\r\n```\r\nand\r\n```\r\n017-12-06 22:36:46.220926: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.38138771]\r\n2017-12-06 22:36:46.913966: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.3763473]\r\n2017-12-06 22:36:47.466997: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.37354136]\r\n2017-12-06 22:36:48.022029: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.32750821]\r\n2017-12-06 22:36:48.571060: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.30615568]\r\n2017-12-06 22:36:49.126092: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26913476]\r\n2017-12-06 22:36:49.682124: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.26520848]\r\n2017-12-06 22:36:50.238156: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.21404171]\r\n2017-12-06 22:36:50.793188: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.25153565]\r\n2017-12-06 22:36:51.347219: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\r\n\\PY\\35\\tensorflow\\core\\kernels\\logging_ops.cc:79] [3.14605141]\r\n``` \r\n"}