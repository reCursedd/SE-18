{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/440651282", "html_url": "https://github.com/tensorflow/tensorflow/issues/22697#issuecomment-440651282", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22697", "id": 440651282, "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDY1MTI4Mg==", "user": {"login": "stetelepta", "id": 1556129, "node_id": "MDQ6VXNlcjE1NTYxMjk=", "avatar_url": "https://avatars1.githubusercontent.com/u/1556129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stetelepta", "html_url": "https://github.com/stetelepta", "followers_url": "https://api.github.com/users/stetelepta/followers", "following_url": "https://api.github.com/users/stetelepta/following{/other_user}", "gists_url": "https://api.github.com/users/stetelepta/gists{/gist_id}", "starred_url": "https://api.github.com/users/stetelepta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stetelepta/subscriptions", "organizations_url": "https://api.github.com/users/stetelepta/orgs", "repos_url": "https://api.github.com/users/stetelepta/repos", "events_url": "https://api.github.com/users/stetelepta/events{/privacy}", "received_events_url": "https://api.github.com/users/stetelepta/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-21T12:49:44Z", "updated_at": "2018-11-21T12:49:44Z", "author_association": "NONE", "body_html": "<p>I've had the same problem and found that since Tensorflow 1.12.0 you can <a href=\"https://github.com/tensorflow/tensorflow/releases\">directly export Keras models to the SavedModel format</a>.</p>\n<p>Using this new feature, I can successfully save and load my Mobilenet models.</p>\n<p>Note that if you save models like this, Tensorflow recommends an optimizer from <code>tf.train</code>, instead of the Keras optimizer.</p>\n<pre><code>import tensorflow as tf\nmodel = tf.keras.applications.MobileNet()\nmodel.compile(optimizer=tf.train.AdamOptimizer(), loss='categorical_crossentropy')\noutput_path = tf.contrib.saved_model.save_keras_model(model, './tmp_dir')\nloaded_model = tf.contrib.saved_model.load_keras_model(output_path)\n</code></pre>", "body_text": "I've had the same problem and found that since Tensorflow 1.12.0 you can directly export Keras models to the SavedModel format.\nUsing this new feature, I can successfully save and load my Mobilenet models.\nNote that if you save models like this, Tensorflow recommends an optimizer from tf.train, instead of the Keras optimizer.\nimport tensorflow as tf\nmodel = tf.keras.applications.MobileNet()\nmodel.compile(optimizer=tf.train.AdamOptimizer(), loss='categorical_crossentropy')\noutput_path = tf.contrib.saved_model.save_keras_model(model, './tmp_dir')\nloaded_model = tf.contrib.saved_model.load_keras_model(output_path)", "body": "I've had the same problem and found that since Tensorflow 1.12.0 you can [directly export Keras models to the SavedModel format](https://github.com/tensorflow/tensorflow/releases).\r\n\r\nUsing this new feature, I can successfully save and load my Mobilenet models. \r\n\r\nNote that if you save models like this, Tensorflow recommends an optimizer from `tf.train`, instead of the Keras optimizer.\r\n\r\n```\r\nimport tensorflow as tf\r\nmodel = tf.keras.applications.MobileNet()\r\nmodel.compile(optimizer=tf.train.AdamOptimizer(), loss='categorical_crossentropy')\r\noutput_path = tf.contrib.saved_model.save_keras_model(model, './tmp_dir')\r\nloaded_model = tf.contrib.saved_model.load_keras_model(output_path)\r\n```"}