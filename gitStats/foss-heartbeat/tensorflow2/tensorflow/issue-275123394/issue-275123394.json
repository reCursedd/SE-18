{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14697", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14697/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14697/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14697/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14697", "id": 275123394, "node_id": "MDU6SXNzdWUyNzUxMjMzOTQ=", "number": 14697, "title": "tf.train.Scaffold does't accept global_step, and therefore only one checkpoint (0) is saved", "user": {"login": "millskyle", "id": 7488568, "node_id": "MDQ6VXNlcjc0ODg1Njg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7488568?v=4", "gravatar_id": "", "url": "https://api.github.com/users/millskyle", "html_url": "https://github.com/millskyle", "followers_url": "https://api.github.com/users/millskyle/followers", "following_url": "https://api.github.com/users/millskyle/following{/other_user}", "gists_url": "https://api.github.com/users/millskyle/gists{/gist_id}", "starred_url": "https://api.github.com/users/millskyle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/millskyle/subscriptions", "organizations_url": "https://api.github.com/users/millskyle/orgs", "repos_url": "https://api.github.com/users/millskyle/repos", "events_url": "https://api.github.com/users/millskyle/events{/privacy}", "received_events_url": "https://api.github.com/users/millskyle/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-11-19T01:14:08Z", "updated_at": "2017-12-01T02:16:01Z", "closed_at": "2017-12-01T02:16:01Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Disclaimer: Issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"235351244\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10661\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10661/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10661\">#10661</a> might be related.</p>\n<p>When I create a Scaffold object and attempt to use it in a MonitoredTrainingSession, there is no ability to specify the global step.  As a consequence (I think), only one checkpoint is created, labeled \"model.ckpt-0\".</p>\n<p>As I understand it, the code below (taken from a custom class I've written...hence the <code>self</code>s) should save a new checkpoint every 10 seconds, but only actually creates a single checkpoint at the start of training, and then never again.</p>\n<pre><code>self.GLOBAL_STEP = tf.train.get_or_create_global_step()\nself.init_op = tf.global_variables_initializer()       \nself.Saver = tf.train.Saver()\n\nself.Scaffold = tf.train.Scaffold( init_op=self.init_op,\n                                   saver=self.Saver\n                               #   global_step=self.GLOBAL_STEP  \n                                       )\n\nself.sess = tf.train.MonitoredTrainingSession( master='',\n                                               is_chief=True,\n                                               scaffold = self.Scaffold,\n                                               checkpoint_dir='./chkpt/',\n                                               save_checkpoint_secs=10,\n                                                   )\n</code></pre>\n<p>If I uncomment the <code>global_step=...</code> line above, I get an error (as expected) since <code>Scaffold.__init__()</code> doesn't take a global_step argument, however shouldn't it?</p>", "body_text": "Disclaimer: Issue #10661 might be related.\nWhen I create a Scaffold object and attempt to use it in a MonitoredTrainingSession, there is no ability to specify the global step.  As a consequence (I think), only one checkpoint is created, labeled \"model.ckpt-0\".\nAs I understand it, the code below (taken from a custom class I've written...hence the selfs) should save a new checkpoint every 10 seconds, but only actually creates a single checkpoint at the start of training, and then never again.\nself.GLOBAL_STEP = tf.train.get_or_create_global_step()\nself.init_op = tf.global_variables_initializer()       \nself.Saver = tf.train.Saver()\n\nself.Scaffold = tf.train.Scaffold( init_op=self.init_op,\n                                   saver=self.Saver\n                               #   global_step=self.GLOBAL_STEP  \n                                       )\n\nself.sess = tf.train.MonitoredTrainingSession( master='',\n                                               is_chief=True,\n                                               scaffold = self.Scaffold,\n                                               checkpoint_dir='./chkpt/',\n                                               save_checkpoint_secs=10,\n                                                   )\n\nIf I uncomment the global_step=... line above, I get an error (as expected) since Scaffold.__init__() doesn't take a global_step argument, however shouldn't it?", "body": "Disclaimer: Issue #10661 might be related. \r\n\r\nWhen I create a Scaffold object and attempt to use it in a MonitoredTrainingSession, there is no ability to specify the global step.  As a consequence (I think), only one checkpoint is created, labeled \"model.ckpt-0\". \r\n\r\nAs I understand it, the code below (taken from a custom class I've written...hence the `self`s) should save a new checkpoint every 10 seconds, but only actually creates a single checkpoint at the start of training, and then never again.\r\n\r\n    self.GLOBAL_STEP = tf.train.get_or_create_global_step()\r\n    self.init_op = tf.global_variables_initializer()       \r\n    self.Saver = tf.train.Saver()\r\n\r\n    self.Scaffold = tf.train.Scaffold( init_op=self.init_op,\r\n                                       saver=self.Saver\r\n                                   #   global_step=self.GLOBAL_STEP  \r\n                                           )\r\n\r\n    self.sess = tf.train.MonitoredTrainingSession( master='',\r\n                                                   is_chief=True,\r\n                                                   scaffold = self.Scaffold,\r\n                                                   checkpoint_dir='./chkpt/',\r\n                                                   save_checkpoint_secs=10,\r\n                                                       )\r\n\r\nIf I uncomment the `global_step=...` line above, I get an error (as expected) since `Scaffold.__init__()` doesn't take a global_step argument, however shouldn't it?"}