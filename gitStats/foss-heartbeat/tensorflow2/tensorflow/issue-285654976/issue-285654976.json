{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15810", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15810/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15810/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15810/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15810", "id": 285654976, "node_id": "MDU6SXNzdWUyODU2NTQ5NzY=", "number": 15810, "title": "Calling variable property of DropoutWrapper gives Error: AttributeError: 'DropoutWrapper' object has no attribute 'trainable'", "user": {"login": "michaelkhan3", "id": 4420471, "node_id": "MDQ6VXNlcjQ0MjA0NzE=", "avatar_url": "https://avatars2.githubusercontent.com/u/4420471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelkhan3", "html_url": "https://github.com/michaelkhan3", "followers_url": "https://api.github.com/users/michaelkhan3/followers", "following_url": "https://api.github.com/users/michaelkhan3/following{/other_user}", "gists_url": "https://api.github.com/users/michaelkhan3/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelkhan3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelkhan3/subscriptions", "organizations_url": "https://api.github.com/users/michaelkhan3/orgs", "repos_url": "https://api.github.com/users/michaelkhan3/repos", "events_url": "https://api.github.com/users/michaelkhan3/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelkhan3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-01-03T10:59:59Z", "updated_at": "2018-03-16T17:58:43Z", "closed_at": "2018-02-21T20:59:56Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Using docker container minimaxir/keras-cntk:cpu-compiled (<a href=\"https://hub.docker.com/r/minimaxir/keras-cntk/tags/\" rel=\"nofollow\">https://hub.docker.com/r/minimaxir/keras-cntk/tags/</a>)</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.2.1 also tested on 1.4</li>\n<li><strong>Python version</strong>: 3.5.2</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>:</li>\n<li><strong>GPU model and memory</strong>:</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I was trying to access the weights and biases of an BasicLSTM cell I created. The BasicLSTM cell also has a DropoutWrapper and when trying to access the variables property the below error is thrown.<br>\n<code>AttributeError: 'DropoutWrapper' object has no attribute 'trainable'</code></p>\n<p>Someone tried to help me with the error on stackoverflow (second half of this <a href=\"https://stackoverflow.com/a/47643427/1169493\" rel=\"nofollow\">answer</a>) and noticed that while variables is implemented in Layer.</p>\n<p>I will quote his very helpful response below:</p>\n<blockquote>\n<p>Although variables is documented for most (all?) RNN classes, it does break for DropoutWrapper. The property has been documented since r1.2, but accessing the property causes an exception in 1.2 and 1.4 (and looks like 1.3, but untested). Specifically,</p>\n<p>from tensorflow.contrib import rnn<br>\n...<br>\nlstm_cell = rnn.BasicLSTMCell(num_hidden, forget_bias=1.0)<br>\nwrapped_cell = rnn.DropoutWrapper(lstm_cell)<br>\noutputs, states = rnn.static_rnn(wrapped_cell, x, dtype=tf.float32)<br>\nprint(\"LSTM vars!\", lstm_cell.variables)<br>\nprint(\"Wrapped vars!\", wrapped_cell.variables)<br>\nwill throw AttributeError: 'DropoutWrapper' object has no attribute 'trainable'. From the traceback (or a long stare at the DropoutWrapper source), I noticed that variables is implemented in DropoutWrapper's super RNNCell's super Layer. Dizzy yet? Indeed, we find the documented variables property here. It returns the (documented) weights property. The weights property returns the (documented) self.trainable_weights + self.non_trainable_weights properties. And finally the root of the problem:</p>\n</blockquote>\n<pre><code> @property\n def trainable_weights(self):\n     return self._trainable_weights if self.trainable else []\n \n @property\n def non_trainable_weights(self):\n     if self.trainable:\n         return self._non_trainable_weights\n     else:\n        return self._trainable_weights + self._non_trainable_weights\n</code></pre>\n<blockquote>\n<p>That is, variables does not work for a DropoutWrapper instance. Neither will trainable_weights or non_trainable_weights sinceself.trainable is not defined.</p>\n<p>One step deeper, Layer.<strong>init</strong> defaults self.trainable to True. Where that property gets removed, deled, unset, whatever from a DropoutWrapper object, I cannot tell.</p>\n</blockquote>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Using docker container minimaxir/keras-cntk:cpu-compiled (https://hub.docker.com/r/minimaxir/keras-cntk/tags/)\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.2.1 also tested on 1.4\nPython version: 3.5.2\nBazel version (if compiling from source):\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version:\nGPU model and memory:\nExact command to reproduce:\n\nDescribe the problem\nI was trying to access the weights and biases of an BasicLSTM cell I created. The BasicLSTM cell also has a DropoutWrapper and when trying to access the variables property the below error is thrown.\nAttributeError: 'DropoutWrapper' object has no attribute 'trainable'\nSomeone tried to help me with the error on stackoverflow (second half of this answer) and noticed that while variables is implemented in Layer.\nI will quote his very helpful response below:\n\nAlthough variables is documented for most (all?) RNN classes, it does break for DropoutWrapper. The property has been documented since r1.2, but accessing the property causes an exception in 1.2 and 1.4 (and looks like 1.3, but untested). Specifically,\nfrom tensorflow.contrib import rnn\n...\nlstm_cell = rnn.BasicLSTMCell(num_hidden, forget_bias=1.0)\nwrapped_cell = rnn.DropoutWrapper(lstm_cell)\noutputs, states = rnn.static_rnn(wrapped_cell, x, dtype=tf.float32)\nprint(\"LSTM vars!\", lstm_cell.variables)\nprint(\"Wrapped vars!\", wrapped_cell.variables)\nwill throw AttributeError: 'DropoutWrapper' object has no attribute 'trainable'. From the traceback (or a long stare at the DropoutWrapper source), I noticed that variables is implemented in DropoutWrapper's super RNNCell's super Layer. Dizzy yet? Indeed, we find the documented variables property here. It returns the (documented) weights property. The weights property returns the (documented) self.trainable_weights + self.non_trainable_weights properties. And finally the root of the problem:\n\n @property\n def trainable_weights(self):\n     return self._trainable_weights if self.trainable else []\n \n @property\n def non_trainable_weights(self):\n     if self.trainable:\n         return self._non_trainable_weights\n     else:\n        return self._trainable_weights + self._non_trainable_weights\n\n\nThat is, variables does not work for a DropoutWrapper instance. Neither will trainable_weights or non_trainable_weights sinceself.trainable is not defined.\nOne step deeper, Layer.init defaults self.trainable to True. Where that property gets removed, deled, unset, whatever from a DropoutWrapper object, I cannot tell.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Using docker container minimaxir/keras-cntk:cpu-compiled (https://hub.docker.com/r/minimaxir/keras-cntk/tags/)\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.2.1 also tested on 1.4\r\n- **Python version**: 3.5.2\r\n- **Bazel version (if compiling from source)**: \r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nI was trying to access the weights and biases of an BasicLSTM cell I created. The BasicLSTM cell also has a DropoutWrapper and when trying to access the variables property the below error is thrown.\r\n`AttributeError: 'DropoutWrapper' object has no attribute 'trainable'`\r\n\r\nSomeone tried to help me with the error on stackoverflow (second half of this [answer](https://stackoverflow.com/a/47643427/1169493)) and noticed that while variables is implemented in Layer. \r\n\r\nI will quote his very helpful response below:\r\n\r\n> Although variables is documented for most (all?) RNN classes, it does break for DropoutWrapper. The property has been documented since r1.2, but accessing the property causes an exception in 1.2 and 1.4 (and looks like 1.3, but untested). Specifically,\r\n> \r\n> from tensorflow.contrib import rnn\r\n> ...\r\n> lstm_cell = rnn.BasicLSTMCell(num_hidden, forget_bias=1.0)\r\n> wrapped_cell = rnn.DropoutWrapper(lstm_cell)\r\n> outputs, states = rnn.static_rnn(wrapped_cell, x, dtype=tf.float32)\r\n> print(\"LSTM vars!\", lstm_cell.variables)\r\n> print(\"Wrapped vars!\", wrapped_cell.variables)\r\n> will throw AttributeError: 'DropoutWrapper' object has no attribute 'trainable'. From the traceback (or a long stare at the DropoutWrapper source), I noticed that variables is implemented in DropoutWrapper's super RNNCell's super Layer. Dizzy yet? Indeed, we find the documented variables property here. It returns the (documented) weights property. The weights property returns the (documented) self.trainable_weights + self.non_trainable_weights properties. And finally the root of the problem:\r\n\r\n```\r\n @property\r\n def trainable_weights(self):\r\n     return self._trainable_weights if self.trainable else []\r\n \r\n @property\r\n def non_trainable_weights(self):\r\n     if self.trainable:\r\n         return self._non_trainable_weights\r\n     else:\r\n        return self._trainable_weights + self._non_trainable_weights\r\n```\r\n\r\n> That is, variables does not work for a DropoutWrapper instance. Neither will trainable_weights or non_trainable_weights sinceself.trainable is not defined.\r\n> \r\n> One step deeper, Layer.__init__ defaults self.trainable to True. Where that property gets removed, deled, unset, whatever from a DropoutWrapper object, I cannot tell.\r\n\r\n  "}