{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/338129995", "html_url": "https://github.com/tensorflow/tensorflow/issues/22#issuecomment-338129995", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22", "id": 338129995, "node_id": "MDEyOklzc3VlQ29tbWVudDMzODEyOTk5NQ==", "user": {"login": "lamia482", "id": 20201985, "node_id": "MDQ6VXNlcjIwMjAxOTg1", "avatar_url": "https://avatars2.githubusercontent.com/u/20201985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamia482", "html_url": "https://github.com/lamia482", "followers_url": "https://api.github.com/users/lamia482/followers", "following_url": "https://api.github.com/users/lamia482/following{/other_user}", "gists_url": "https://api.github.com/users/lamia482/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamia482/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamia482/subscriptions", "organizations_url": "https://api.github.com/users/lamia482/orgs", "repos_url": "https://api.github.com/users/lamia482/repos", "events_url": "https://api.github.com/users/lamia482/events{/privacy}", "received_events_url": "https://api.github.com/users/lamia482/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-20T07:38:41Z", "updated_at": "2017-10-20T07:38:41Z", "author_association": "NONE", "body_html": "<p>Hi,<br>\nI was building tensorflow APIs on Ubuntu16.04 x64 for my Android device with GPU(Mali-T720) enabled,</p>\n<p>My OS info:<br>\nUbuntu 16.04 x64<br>\nComputer GPU: NVIDIA 1080Ti<br>\nCUDA 8.0<br>\nCUDNN 5.1 ( though I do not use cuda or cudnn for building )<br>\nbazel 0.5.2<br>\nComputeCpp CE 0.3.2</p>\n<p>my build.sh is:<br>\n'<br>\nbazel build -c opt --config=sycl //tensorflow/contrib/android:libtensorflow_cc.so --cxxopt=\"-<br>\nstd=c++11\" --cxxopt=\"-DTENSORFLOW_DISABLE_META\" --verbose_failures --<br>\ncrosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --<br>\ncpu=armeabi-v7a<br>\n'<br>\nbefore build. I  export LD_LIBRARY_PATH=my_sycl_lib_path=$LD_LIBRARY_PATH, build without ' --config=sycl ' is fine and I got the correct libtensorflow_cc.so, but with ' --config=sycl ', the final result turned out missing -lComputeCpp without any other compile errors</p>\n<p>Full log like this:</p>\n<p>ERROR: /home/e0024/workspace/tensorflow/tensorflow/contrib/android/BUILD:102:1: Linking of rule '//tensorflow/contrib/android:libtensorflow.so' failed: link_dynamic_library.sh failed: error executing command<br>\n(cd /home/e0024/.cache/bazel/_bazel_e0024/783dad02ec856015f56356584726dd10/execroot/org_tensorflow &amp;&amp; <br>\nexec env - <br>\nCOMPUTECPP_TOOLKIT_PATH=/home/e0024/workspace/source/computeCppForSYCL1.2 <br>\nHOST_CXX_COMPILER=/usr/bin/g++ <br>\nHOST_C_COMPILER=/usr/bin/gcc <br>\nLD_LIBRARY_PATH=/home/e0024/workspace/source/computeCppForSYCL1.2/lib:/home/e0024/workspace/caffe/build/lib:/home/e0024/workspace/cudnn/lib64: <br>\nPATH=/home/e0024/bin:/home/e0024/.local/bin:/home/e0024/workspace/Anaconda2/bin:/opt/cuda:/home/e0024/workspace/source/protoc-3.3.0-linux-x86_64/bin:/home/e0024/workspace/bazel/output:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin <br>\nPWD=/proc/self/cwd <br>\nPYTHON_BIN_PATH=/home/e0024/workspace/Anaconda2/bin/python <br>\nPYTHON_LIB_PATH=/home/e0024/workspace/Anaconda2/lib/python2.7/site-packages <br>\nTF_NEED_CUDA=0 <br>\nTF_NEED_OPENCL=1 <br>\nexternal/bazel_tools/tools/cpp/link_dynamic_library.sh no ignored ignored ignored external/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcc -shared -o bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/contrib/android/libtensorflow.so '-Wl,-rpath,$ORIGIN/../../../_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib' -Lbazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/c/libc_api.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/kernels/libandroid_tensorflow_kernels.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib_lite.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libprotos_all_cc.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf_lite.a -Wl,-no-whole-archive -lComputeCpp external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi-v7a/libgnustl_static.a external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi-v7a/libsupc++.a -landroid -llog -lm -z defs -s -Wl,--gc-sections '-Wl,-soname=libtensorflow.so' -Wl,--version-script tensorflow/c/version_script.lds -lz -static-libgcc -no-canonical-prefixes '-march=armv7-a' -Wl,--fix-cortex-a8 '--sysroot=external/androidndk/ndk/platforms/android-14/arch-arm'): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.<br>\nexternal/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9/../../../../arm-linux-androideabi/bin/ld: warning: skipping incompatible bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib/libComputeCpp.so while searching for ComputeCpp<br>\nexternal/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9/../../../../arm-linux-androideabi/bin/ld: error: cannot find -lComputeCpp<br>\ncollect2: error: ld returned 1 exit status<br>\nTarget //tensorflow/contrib/android:libtensorflow.so failed to build<br>\nINFO: Elapsed time: 617.736s, Critical Path: 54.66s</p>\n<p>uhm.... I wanna build tensorflow APIs in the arch of arm with GPU(Mali-T720) enabled,<br>\nAppreciated if someone could leave some experiences or suggestions here. Thx a looooot.</p>", "body_text": "Hi,\nI was building tensorflow APIs on Ubuntu16.04 x64 for my Android device with GPU(Mali-T720) enabled,\nMy OS info:\nUbuntu 16.04 x64\nComputer GPU: NVIDIA 1080Ti\nCUDA 8.0\nCUDNN 5.1 ( though I do not use cuda or cudnn for building )\nbazel 0.5.2\nComputeCpp CE 0.3.2\nmy build.sh is:\n'\nbazel build -c opt --config=sycl //tensorflow/contrib/android:libtensorflow_cc.so --cxxopt=\"-\nstd=c++11\" --cxxopt=\"-DTENSORFLOW_DISABLE_META\" --verbose_failures --\ncrosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --\ncpu=armeabi-v7a\n'\nbefore build. I  export LD_LIBRARY_PATH=my_sycl_lib_path=$LD_LIBRARY_PATH, build without ' --config=sycl ' is fine and I got the correct libtensorflow_cc.so, but with ' --config=sycl ', the final result turned out missing -lComputeCpp without any other compile errors\nFull log like this:\nERROR: /home/e0024/workspace/tensorflow/tensorflow/contrib/android/BUILD:102:1: Linking of rule '//tensorflow/contrib/android:libtensorflow.so' failed: link_dynamic_library.sh failed: error executing command\n(cd /home/e0024/.cache/bazel/_bazel_e0024/783dad02ec856015f56356584726dd10/execroot/org_tensorflow && \nexec env - \nCOMPUTECPP_TOOLKIT_PATH=/home/e0024/workspace/source/computeCppForSYCL1.2 \nHOST_CXX_COMPILER=/usr/bin/g++ \nHOST_C_COMPILER=/usr/bin/gcc \nLD_LIBRARY_PATH=/home/e0024/workspace/source/computeCppForSYCL1.2/lib:/home/e0024/workspace/caffe/build/lib:/home/e0024/workspace/cudnn/lib64: \nPATH=/home/e0024/bin:/home/e0024/.local/bin:/home/e0024/workspace/Anaconda2/bin:/opt/cuda:/home/e0024/workspace/source/protoc-3.3.0-linux-x86_64/bin:/home/e0024/workspace/bazel/output:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \nPWD=/proc/self/cwd \nPYTHON_BIN_PATH=/home/e0024/workspace/Anaconda2/bin/python \nPYTHON_LIB_PATH=/home/e0024/workspace/Anaconda2/lib/python2.7/site-packages \nTF_NEED_CUDA=0 \nTF_NEED_OPENCL=1 \nexternal/bazel_tools/tools/cpp/link_dynamic_library.sh no ignored ignored ignored external/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcc -shared -o bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/contrib/android/libtensorflow.so '-Wl,-rpath,$ORIGIN/../../../_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib' -Lbazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/c/libc_api.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/kernels/libandroid_tensorflow_kernels.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib_lite.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libprotos_all_cc.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf_lite.a -Wl,-no-whole-archive -lComputeCpp external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi-v7a/libgnustl_static.a external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi-v7a/libsupc++.a -landroid -llog -lm -z defs -s -Wl,--gc-sections '-Wl,-soname=libtensorflow.so' -Wl,--version-script tensorflow/c/version_script.lds -lz -static-libgcc -no-canonical-prefixes '-march=armv7-a' -Wl,--fix-cortex-a8 '--sysroot=external/androidndk/ndk/platforms/android-14/arch-arm'): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nexternal/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9/../../../../arm-linux-androideabi/bin/ld: warning: skipping incompatible bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib/libComputeCpp.so while searching for ComputeCpp\nexternal/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9/../../../../arm-linux-androideabi/bin/ld: error: cannot find -lComputeCpp\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/contrib/android:libtensorflow.so failed to build\nINFO: Elapsed time: 617.736s, Critical Path: 54.66s\nuhm.... I wanna build tensorflow APIs in the arch of arm with GPU(Mali-T720) enabled,\nAppreciated if someone could leave some experiences or suggestions here. Thx a looooot.", "body": "Hi, \r\n  I was building tensorflow APIs on Ubuntu16.04 x64 for my Android device with GPU(Mali-T720) enabled, \r\n\r\nMy OS info:\r\nUbuntu 16.04 x64\r\nComputer GPU: NVIDIA 1080Ti\r\nCUDA 8.0\r\nCUDNN 5.1 ( though I do not use cuda or cudnn for building )\r\nbazel 0.5.2\r\nComputeCpp CE 0.3.2\r\n\r\nmy build.sh is:\r\n'\r\n bazel build -c opt --config=sycl //tensorflow/contrib/android:libtensorflow_cc.so --cxxopt=\"-\r\n  std=c++11\" --cxxopt=\"-DTENSORFLOW_DISABLE_META\" --verbose_failures --\r\n  crosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --\r\n  cpu=armeabi-v7a \r\n'\r\n  before build. I  export LD_LIBRARY_PATH=my_sycl_lib_path=$LD_LIBRARY_PATH, build without ' --config=sycl ' is fine and I got the correct libtensorflow_cc.so, but with ' --config=sycl ', the final result turned out missing -lComputeCpp without any other compile errors\r\n\r\n  Full log like this:\r\n\r\nERROR: /home/e0024/workspace/tensorflow/tensorflow/contrib/android/BUILD:102:1: Linking of rule '//tensorflow/contrib/android:libtensorflow.so' failed: link_dynamic_library.sh failed: error executing command \r\n  (cd /home/e0024/.cache/bazel/_bazel_e0024/783dad02ec856015f56356584726dd10/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    COMPUTECPP_TOOLKIT_PATH=/home/e0024/workspace/source/computeCppForSYCL1.2 \\\r\n    HOST_CXX_COMPILER=/usr/bin/g++ \\\r\n    HOST_C_COMPILER=/usr/bin/gcc \\\r\n    LD_LIBRARY_PATH=/home/e0024/workspace/source/computeCppForSYCL1.2/lib:/home/e0024/workspace/caffe/build/lib:/home/e0024/workspace/cudnn/lib64: \\\r\n    PATH=/home/e0024/bin:/home/e0024/.local/bin:/home/e0024/workspace/Anaconda2/bin:/opt/cuda:/home/e0024/workspace/source/protoc-3.3.0-linux-x86_64/bin:/home/e0024/workspace/bazel/output:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/home/e0024/workspace/Anaconda2/bin/python \\\r\n    PYTHON_LIB_PATH=/home/e0024/workspace/Anaconda2/lib/python2.7/site-packages \\\r\n    TF_NEED_CUDA=0 \\\r\n    TF_NEED_OPENCL=1 \\\r\n  external/bazel_tools/tools/cpp/link_dynamic_library.sh no ignored ignored ignored external/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcc -shared -o bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/contrib/android/libtensorflow.so '-Wl,-rpath,$ORIGIN/../../../_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib' -Lbazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/c/libc_api.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/kernels/libandroid_tensorflow_kernels.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib_lite.lo -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/tensorflow/core/libprotos_all_cc.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf.a -Wl,-no-whole-archive -Wl,-whole-archive bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf_lite.a -Wl,-no-whole-archive -lComputeCpp external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi-v7a/libgnustl_static.a external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi-v7a/libsupc++.a -landroid -llog -lm -z defs -s -Wl,--gc-sections '-Wl,-soname=libtensorflow.so' -Wl,--version-script tensorflow/c/version_script.lds -lz -static-libgcc -no-canonical-prefixes '-march=armv7-a' -Wl,--fix-cortex-a8 '--sysroot=external/androidndk/ndk/platforms/android-14/arch-arm'): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\r\nexternal/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9/../../../../arm-linux-androideabi/bin/ld: warning: skipping incompatible bazel-out/arm-linux-androideabi-4.9-v7a-gnu-libstdcpp-opt/bin/_solib_armeabi-v7a/_U@local_Uconfig_Usycl_S_Ssycl_Csyclrt___Uexternal_Slocal_Uconfig_Usycl_Ssycl_Slib/libComputeCpp.so while searching for ComputeCpp\r\nexternal/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9/../../../../arm-linux-androideabi/bin/ld: error: cannot find -lComputeCpp\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/contrib/android:libtensorflow.so failed to build\r\nINFO: Elapsed time: 617.736s, Critical Path: 54.66s\r\n\r\n  uhm.... I wanna build tensorflow APIs in the arch of arm with GPU(Mali-T720) enabled, \r\nAppreciated if someone could leave some experiences or suggestions here. Thx a looooot.\r\n\r\n\r\n\r\n\r\n"}