{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/355005044", "html_url": "https://github.com/tensorflow/tensorflow/issues/13844#issuecomment-355005044", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13844", "id": 355005044, "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTAwNTA0NA==", "user": {"login": "timonbimon", "id": 14793026, "node_id": "MDQ6VXNlcjE0NzkzMDI2", "avatar_url": "https://avatars3.githubusercontent.com/u/14793026?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timonbimon", "html_url": "https://github.com/timonbimon", "followers_url": "https://api.github.com/users/timonbimon/followers", "following_url": "https://api.github.com/users/timonbimon/following{/other_user}", "gists_url": "https://api.github.com/users/timonbimon/gists{/gist_id}", "starred_url": "https://api.github.com/users/timonbimon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timonbimon/subscriptions", "organizations_url": "https://api.github.com/users/timonbimon/orgs", "repos_url": "https://api.github.com/users/timonbimon/repos", "events_url": "https://api.github.com/users/timonbimon/events{/privacy}", "received_events_url": "https://api.github.com/users/timonbimon/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-03T12:52:42Z", "updated_at": "2018-01-03T12:52:42Z", "author_association": "NONE", "body_html": "<p>The same issue came up for me too.<br>\nWhen running a toy example and using a Saver to save a small graph to an S3 bucket it works, but when trying to write a Faster R-CNN (through the export_inference_graph.py from the Object Detection API) to S3, I get the following error (I used the latest nightly build with <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6932348\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yongtang\">@yongtang</a>'s AWS logging):</p>\n<pre><code>2018-01-03 12:24:08.336668: I tensorflow/core/platform/s3/aws_logging.cc:53] Creating HttpClient with max connections2 and scheme http\n2018-01-03 12:24:08.336680: I tensorflow/core/platform/s3/aws_logging.cc:53] Initializing CurlHandleContainer with size 2\n2018-01-03 12:24:08.336688: I tensorflow/core/platform/s3/aws_logging.cc:53] Creating Instance with default EC2MetadataClient and refresh rate 900000\n2018-01-03 12:24:08.336738: I tensorflow/core/platform/s3/aws_logging.cc:53] Successfully reloaded configuration.\n2018-01-03 12:24:08.336763: I tensorflow/core/platform/s3/aws_logging.cc:53] Initializing CurlHandleContainer with size 25\n2018-01-03 12:24:08.336906: I tensorflow/core/platform/s3/aws_logging.cc:53] Pool grown by 2\n2018-01-03 12:24:08.336924: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:24:08.458925: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:24:11.461615: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\n2018-01-03 12:24:11.461669: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\n2018-01-03 12:24:11.461681: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 0 ms before attempting again.\n2018-01-03 12:24:11.461953: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:24:14.474854: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\n2018-01-03 12:24:14.474919: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\n2018-01-03 12:24:14.474932: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 50 ms before attempting again.\n2018-01-03 12:24:14.525228: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n...\n2018-01-03 12:24:51.335497: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 12800 ms before attempting again.\n2018-01-03 12:25:04.135817: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:25:07.149093: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\n2018-01-03 12:25:07.149164: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\n2018-01-03 12:25:07.149200: I tensorflow/core/platform/s3/aws_logging.cc:53] Cleaning up CurlHandleContainer.\n2018-01-03 12:25:07.149214: I tensorflow/core/platform/s3/aws_logging.cc:53] Cleaning up CurlHandleContainer.\n2018-01-03 12:25:07.149567: W tensorflow/core/framework/op_kernel.cc:1198] Internal: : Unable to connect to endpoint\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1350, in _do_call\n    return fn(*args)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1329, in _run_fn\n    status, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/errors_impl.py\", line 473, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InternalError: : Unable to connect to endpoint\n\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\n  File \"object_detection/export_inference_graph.py\", line 119, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 124, in run\n    _sys.exit(main(argv))\n  File \"object_detection/export_inference_graph.py\", line 115, in main\n    FLAGS.output_directory, input_shape)\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 427, in export_inference_graph\n    input_shape, optimize_graph, output_collection_name)\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 375, in _export_inference_graph\n    trained_checkpoint_prefix=checkpoint_to_use)\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 321, in _write_graph_and_checkpoint\n    saver.save(sess, model_path)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/saver.py\", line 1593, in save\n    {self.saver_def.filename_tensor_name: checkpoint_file})\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 895, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1128, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1344, in _do_run\n    options, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1363, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: : Unable to connect to endpoint\n</code></pre>", "body_text": "The same issue came up for me too.\nWhen running a toy example and using a Saver to save a small graph to an S3 bucket it works, but when trying to write a Faster R-CNN (through the export_inference_graph.py from the Object Detection API) to S3, I get the following error (I used the latest nightly build with @yongtang's AWS logging):\n2018-01-03 12:24:08.336668: I tensorflow/core/platform/s3/aws_logging.cc:53] Creating HttpClient with max connections2 and scheme http\n2018-01-03 12:24:08.336680: I tensorflow/core/platform/s3/aws_logging.cc:53] Initializing CurlHandleContainer with size 2\n2018-01-03 12:24:08.336688: I tensorflow/core/platform/s3/aws_logging.cc:53] Creating Instance with default EC2MetadataClient and refresh rate 900000\n2018-01-03 12:24:08.336738: I tensorflow/core/platform/s3/aws_logging.cc:53] Successfully reloaded configuration.\n2018-01-03 12:24:08.336763: I tensorflow/core/platform/s3/aws_logging.cc:53] Initializing CurlHandleContainer with size 25\n2018-01-03 12:24:08.336906: I tensorflow/core/platform/s3/aws_logging.cc:53] Pool grown by 2\n2018-01-03 12:24:08.336924: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:24:08.458925: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:24:11.461615: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\n2018-01-03 12:24:11.461669: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\n2018-01-03 12:24:11.461681: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 0 ms before attempting again.\n2018-01-03 12:24:11.461953: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:24:14.474854: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\n2018-01-03 12:24:14.474919: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\n2018-01-03 12:24:14.474932: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 50 ms before attempting again.\n2018-01-03 12:24:14.525228: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n...\n2018-01-03 12:24:51.335497: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 12800 ms before attempting again.\n2018-01-03 12:25:04.135817: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\n2018-01-03 12:25:07.149093: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\n2018-01-03 12:25:07.149164: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\n2018-01-03 12:25:07.149200: I tensorflow/core/platform/s3/aws_logging.cc:53] Cleaning up CurlHandleContainer.\n2018-01-03 12:25:07.149214: I tensorflow/core/platform/s3/aws_logging.cc:53] Cleaning up CurlHandleContainer.\n2018-01-03 12:25:07.149567: W tensorflow/core/framework/op_kernel.cc:1198] Internal: : Unable to connect to endpoint\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1350, in _do_call\n    return fn(*args)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1329, in _run_fn\n    status, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/errors_impl.py\", line 473, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InternalError: : Unable to connect to endpoint\n\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\n  File \"object_detection/export_inference_graph.py\", line 119, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 124, in run\n    _sys.exit(main(argv))\n  File \"object_detection/export_inference_graph.py\", line 115, in main\n    FLAGS.output_directory, input_shape)\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 427, in export_inference_graph\n    input_shape, optimize_graph, output_collection_name)\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 375, in _export_inference_graph\n    trained_checkpoint_prefix=checkpoint_to_use)\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 321, in _write_graph_and_checkpoint\n    saver.save(sess, model_path)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/saver.py\", line 1593, in save\n    {self.saver_def.filename_tensor_name: checkpoint_file})\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 895, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1128, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1344, in _do_run\n    options, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1363, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: : Unable to connect to endpoint", "body": "The same issue came up for me too.\r\nWhen running a toy example and using a Saver to save a small graph to an S3 bucket it works, but when trying to write a Faster R-CNN (through the export_inference_graph.py from the Object Detection API) to S3, I get the following error (I used the latest nightly build with @yongtang's AWS logging):\r\n\r\n```\r\n2018-01-03 12:24:08.336668: I tensorflow/core/platform/s3/aws_logging.cc:53] Creating HttpClient with max connections2 and scheme http\r\n2018-01-03 12:24:08.336680: I tensorflow/core/platform/s3/aws_logging.cc:53] Initializing CurlHandleContainer with size 2\r\n2018-01-03 12:24:08.336688: I tensorflow/core/platform/s3/aws_logging.cc:53] Creating Instance with default EC2MetadataClient and refresh rate 900000\r\n2018-01-03 12:24:08.336738: I tensorflow/core/platform/s3/aws_logging.cc:53] Successfully reloaded configuration.\r\n2018-01-03 12:24:08.336763: I tensorflow/core/platform/s3/aws_logging.cc:53] Initializing CurlHandleContainer with size 25\r\n2018-01-03 12:24:08.336906: I tensorflow/core/platform/s3/aws_logging.cc:53] Pool grown by 2\r\n2018-01-03 12:24:08.336924: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\r\n2018-01-03 12:24:08.458925: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\r\n2018-01-03 12:24:11.461615: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\r\n2018-01-03 12:24:11.461669: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\r\n2018-01-03 12:24:11.461681: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 0 ms before attempting again.\r\n2018-01-03 12:24:11.461953: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\r\n2018-01-03 12:24:14.474854: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\r\n2018-01-03 12:24:14.474919: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\r\n2018-01-03 12:24:14.474932: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 50 ms before attempting again.\r\n2018-01-03 12:24:14.525228: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\r\n...\r\n2018-01-03 12:24:51.335497: W tensorflow/core/platform/s3/aws_logging.cc:56] Request failed, now waiting 12800 ms before attempting again.\r\n2018-01-03 12:25:04.135817: I tensorflow/core/platform/s3/aws_logging.cc:53] Connection has been released. Continuing.\r\n2018-01-03 12:25:07.149093: E tensorflow/core/platform/s3/aws_logging.cc:59] Curl returned error code 28\r\n2018-01-03 12:25:07.149164: W tensorflow/core/platform/s3/aws_logging.cc:56] If the signature check failed. This could be because of a time skew. Attempting to adjust the signer.\r\n2018-01-03 12:25:07.149200: I tensorflow/core/platform/s3/aws_logging.cc:53] Cleaning up CurlHandleContainer.\r\n2018-01-03 12:25:07.149214: I tensorflow/core/platform/s3/aws_logging.cc:53] Cleaning up CurlHandleContainer.\r\n2018-01-03 12:25:07.149567: W tensorflow/core/framework/op_kernel.cc:1198] Internal: : Unable to connect to endpoint\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1350, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1329, in _run_fn\r\n    status, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/errors_impl.py\", line 473, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.InternalError: : Unable to connect to endpoint\r\n\r\nDuring handling of the above exception, another exception occurred:\r\nTraceback (most recent call last):\r\n  File \"object_detection/export_inference_graph.py\", line 119, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 124, in run\r\n    _sys.exit(main(argv))\r\n  File \"object_detection/export_inference_graph.py\", line 115, in main\r\n    FLAGS.output_directory, input_shape)\r\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 427, in export_inference_graph\r\n    input_shape, optimize_graph, output_collection_name)\r\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 375, in _export_inference_graph\r\n    trained_checkpoint_prefix=checkpoint_to_use)\r\n  File \"/home/ubuntu/train_and_serve/object_detection/exporter.py\", line 321, in _write_graph_and_checkpoint\r\n    saver.save(sess, model_path)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/saver.py\", line 1593, in save\r\n    {self.saver_def.filename_tensor_name: checkpoint_file})\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 895, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1128, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1344, in _do_run\r\n    options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1363, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: : Unable to connect to endpoint\r\n```\r\n"}