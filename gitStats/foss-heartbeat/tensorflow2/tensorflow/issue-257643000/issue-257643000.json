{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13030", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13030/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13030/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13030/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13030", "id": 257643000, "node_id": "MDU6SXNzdWUyNTc2NDMwMDA=", "number": 13030, "title": "Crash when load Fine-tune model on Android", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-09-14T08:53:49Z", "updated_at": "2018-02-26T13:11:31Z", "closed_at": "2017-09-15T13:55:36Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.3.0</li>\n<li><strong>Python version</strong>: 2.7.12</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.5.4</li>\n<li><strong>CUDA/cuDNN version</strong>:  8.0.61</li>\n<li><strong>GPU model and memory</strong>: NVIDIA Corporation Device 1b06</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<p>How I do Fine-tune :</p>\n<pre><code>\n# Convert imagenet data to TFrecord ( No bounding box , just for classification ) \npython build_image_data.py \\\n--train_directory='imagenet/train' \\\n--validation_directory='imagenet/train' \\\n--labels_file='imagenet/labels.txt' \\\n--output_directory='imagenet/tfrecord' \n\n# Train from checkpoint\npython train_image_classifier.py \\\n    --dataset_dir=.../imagenet/tfrecord \\\n    --train_dir=.../imagenet/train_logs \\\n    --checkpoint_path=.../checkpoint/mobilenet_v1_0.50_224.ckpt \\\n    --model_name=mobilenet_v1_050 \\\n    --dataset_name=flowers \\                       ( _NUM_CLASSES and sizes has been modified )\n    --dataset_split_name=train \\\n    --max_number_of_steps=10000 \\\n    --checkpoint_exclude_scopes=MobilenetV1/Logits \\\n    --trainable_scopes=MobilenetV1/Logits \\\n\n# Produce .pb file (use .pbtxt)\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n--input_graph=.../imagenet/train_logs/graph.pbtxt \\\n--input_checkpoint=.../imagenet/train_logs/model.ckpt-10000 \\\n--output_graph=.../imagenet/train_logs/frozen_graph.pb \\\n--output_node_names=MobilenetV1/Predictions/Reshape_1\n\n# Removes parts of a graph that are only needed for training\nbazel-bin/tensorflow/python/tools/optimize_for_inference \\\n--input=.../imagenet/train_logs/frozen_graph.pb \\\n--output=.../imagenet/train_logs/optimized_graph.pb \\\n--frozen_graph=True \\\n--input_names='prefetch_queue/fifo_queue' \\\n--output_names='MobilenetV1/Predictions/Reshape_1'\n\n</code></pre>\n<h3>Describe the problem</h3>\n<p>Hi , I am doing some fine-tune with mobilenet , I got some trouble at beginning since the input node \" prefetch_queue/fifo_queue \" , which Op \"FIFOQueueV2\" is disabled on Android , but I think it's okay  after using \"bazel-bin/tensorflow/python/tools/optimize_for_inference\" . ( I am not sure about it or I still need to customize my own TF library like mentioned <a href=\"https://github.com/tensorflow/tensorflow/issues/8454\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8454/hovercard\">here</a> ? )</p>\n<p>But now there is a new problem , after modify the parameter at \"ClassifierActivity.java\" like this :<br>\n( input_name and output_name is from summarize_graph tool )</p>\n<pre><code>\n  private static final int INPUT_SIZE = 224;\n  private static final int IMAGE_MEAN = 117;\n  private static final float IMAGE_STD = 1;\n  private static final String INPUT_NAME = \"prefetch_queue/fifo_queue\";\n  private static final String OUTPUT_NAME = \"MobilenetV1/Predictions/Reshape_1\";\n\n  private static final String MODEL_FILE = \"file:///android_asset/tensorflow_inception_graph.pb\";\n  private static final String LABEL_FILE =\n      \"file:///android_asset/imagenet_comp_graph_label_strings.txt\";\n\n</code></pre>\n<p>and implement the demo on android , the TF Classify can be launched , but crash when press the volume key to turn on the debug mode.</p>\n<p>the crash prints the following log :</p>\n<h3>Source code / logs</h3>\n<p>Error Message from adb logcat</p>\n<pre><code>E/InputEventSender( 4197): Exception dispatching finished signal.\nE/MessageQueue-JNI( 4197): Exception in MessageQueue callback: handleReceiveCallback\nE/MessageQueue-JNI( 4197): java.lang.NullPointerException: Attempt to invoke interface method 'void org.tensorflow.demo.Classifier.enableStatLogging(boolean)' on a null object reference\nE/MessageQueue-JNI( 4197):      at org.tensorflow.demo.ClassifierActivity.onSetDebug(ClassifierActivity.java:183)\nE/MessageQueue-JNI( 4197):      at org.tensorflow.demo.CameraActivity.onKeyDown(CameraActivity.java:381)\nE/MessageQueue-JNI( 4197):      at android.view.KeyEvent.dispatch(KeyEvent.java:2758)\nE/MessageQueue-JNI( 4197):      at android.app.Activity.dispatchKeyEvent(Activity.java:2755)\nE/MessageQueue-JNI( 4197):      at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:2380)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:4556)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4512)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4190)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4247)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4223)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:4393)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:2285)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:1909)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:1900)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:2262)\nE/MessageQueue-JNI( 4197):      at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:141)\nE/MessageQueue-JNI( 4197):      at android.os.MessageQueue.nativePollOnce(Native Method)\nE/MessageQueue-JNI( 4197):      at android.os.MessageQueue.next(MessageQueue.java:148)\nE/MessageQueue-JNI( 4197):      at android.os.Looper.loop(Looper.java:151)\nE/MessageQueue-JNI( 4197):      at android.app.ActivityThread.main(ActivityThread.java:5631)\nE/MessageQueue-JNI( 4197):      at java.lang.reflect.Method.invoke(Native Method)\nE/MessageQueue-JNI( 4197):      at java.lang.reflect.Method.invoke(Method.java:372)\nE/MessageQueue-JNI( 4197):      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)\nE/MessageQueue-JNI( 4197):      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)\nE/AndroidRuntime( 4197): FATAL EXCEPTION: main\nE/AndroidRuntime( 4197): Process: org.tensorflow.demo, PID: 4197\nE/AndroidRuntime( 4197): java.lang.NullPointerException: Attempt to invoke interface method 'void org.tensorflow.demo.Classifier.enableStatLogging(boolean)' on a null object reference\nE/AndroidRuntime( 4197):        at org.tensorflow.demo.ClassifierActivity.onSetDebug(ClassifierActivity.java:183)\nE/AndroidRuntime( 4197):        at org.tensorflow.demo.CameraActivity.onKeyDown(CameraActivity.java:381)\nE/AndroidRuntime( 4197):        at android.view.KeyEvent.dispatch(KeyEvent.java:2758)\nE/AndroidRuntime( 4197):        at android.app.Activity.dispatchKeyEvent(Activity.java:2755)\nE/AndroidRuntime( 4197):        at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:2380)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:4556)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4512)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4190)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4247)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4223)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:4393)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:2285)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:1909)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:1900)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:2262)\nE/AndroidRuntime( 4197):        at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:141)\nE/AndroidRuntime( 4197):        at android.os.MessageQueue.nativePollOnce(Native Method)\nE/AndroidRuntime( 4197):        at android.os.MessageQueue.next(MessageQueue.java:148)\nE/AndroidRuntime( 4197):        at android.os.Looper.loop(Looper.java:151)\nE/AndroidRuntime( 4197):        at android.app.ActivityThread.main(ActivityThread.java:5631)\nE/AndroidRuntime( 4197):        at java.lang.reflect.Method.invoke(Native Method)\nE/AndroidRuntime( 4197):        at java.lang.reflect.Method.invoke(Method.java:372)\nE/AndroidRuntime( 4197):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)\nE/AndroidRuntime( 4197):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)\n\n</code></pre>\n<p>I am not sure which part result in this , if any further information is needed , please tell me , thank you !</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.3.0\nPython version: 2.7.12\nBazel version (if compiling from source): 0.5.4\nCUDA/cuDNN version:  8.0.61\nGPU model and memory: NVIDIA Corporation Device 1b06\nExact command to reproduce:\n\nHow I do Fine-tune :\n\n# Convert imagenet data to TFrecord ( No bounding box , just for classification ) \npython build_image_data.py \\\n--train_directory='imagenet/train' \\\n--validation_directory='imagenet/train' \\\n--labels_file='imagenet/labels.txt' \\\n--output_directory='imagenet/tfrecord' \n\n# Train from checkpoint\npython train_image_classifier.py \\\n    --dataset_dir=.../imagenet/tfrecord \\\n    --train_dir=.../imagenet/train_logs \\\n    --checkpoint_path=.../checkpoint/mobilenet_v1_0.50_224.ckpt \\\n    --model_name=mobilenet_v1_050 \\\n    --dataset_name=flowers \\                       ( _NUM_CLASSES and sizes has been modified )\n    --dataset_split_name=train \\\n    --max_number_of_steps=10000 \\\n    --checkpoint_exclude_scopes=MobilenetV1/Logits \\\n    --trainable_scopes=MobilenetV1/Logits \\\n\n# Produce .pb file (use .pbtxt)\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n--input_graph=.../imagenet/train_logs/graph.pbtxt \\\n--input_checkpoint=.../imagenet/train_logs/model.ckpt-10000 \\\n--output_graph=.../imagenet/train_logs/frozen_graph.pb \\\n--output_node_names=MobilenetV1/Predictions/Reshape_1\n\n# Removes parts of a graph that are only needed for training\nbazel-bin/tensorflow/python/tools/optimize_for_inference \\\n--input=.../imagenet/train_logs/frozen_graph.pb \\\n--output=.../imagenet/train_logs/optimized_graph.pb \\\n--frozen_graph=True \\\n--input_names='prefetch_queue/fifo_queue' \\\n--output_names='MobilenetV1/Predictions/Reshape_1'\n\n\nDescribe the problem\nHi , I am doing some fine-tune with mobilenet , I got some trouble at beginning since the input node \" prefetch_queue/fifo_queue \" , which Op \"FIFOQueueV2\" is disabled on Android , but I think it's okay  after using \"bazel-bin/tensorflow/python/tools/optimize_for_inference\" . ( I am not sure about it or I still need to customize my own TF library like mentioned here ? )\nBut now there is a new problem , after modify the parameter at \"ClassifierActivity.java\" like this :\n( input_name and output_name is from summarize_graph tool )\n\n  private static final int INPUT_SIZE = 224;\n  private static final int IMAGE_MEAN = 117;\n  private static final float IMAGE_STD = 1;\n  private static final String INPUT_NAME = \"prefetch_queue/fifo_queue\";\n  private static final String OUTPUT_NAME = \"MobilenetV1/Predictions/Reshape_1\";\n\n  private static final String MODEL_FILE = \"file:///android_asset/tensorflow_inception_graph.pb\";\n  private static final String LABEL_FILE =\n      \"file:///android_asset/imagenet_comp_graph_label_strings.txt\";\n\n\nand implement the demo on android , the TF Classify can be launched , but crash when press the volume key to turn on the debug mode.\nthe crash prints the following log :\nSource code / logs\nError Message from adb logcat\nE/InputEventSender( 4197): Exception dispatching finished signal.\nE/MessageQueue-JNI( 4197): Exception in MessageQueue callback: handleReceiveCallback\nE/MessageQueue-JNI( 4197): java.lang.NullPointerException: Attempt to invoke interface method 'void org.tensorflow.demo.Classifier.enableStatLogging(boolean)' on a null object reference\nE/MessageQueue-JNI( 4197):      at org.tensorflow.demo.ClassifierActivity.onSetDebug(ClassifierActivity.java:183)\nE/MessageQueue-JNI( 4197):      at org.tensorflow.demo.CameraActivity.onKeyDown(CameraActivity.java:381)\nE/MessageQueue-JNI( 4197):      at android.view.KeyEvent.dispatch(KeyEvent.java:2758)\nE/MessageQueue-JNI( 4197):      at android.app.Activity.dispatchKeyEvent(Activity.java:2755)\nE/MessageQueue-JNI( 4197):      at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:2380)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:4556)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4512)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4190)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4247)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4223)\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:4393)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:2285)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:1909)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:1900)\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:2262)\nE/MessageQueue-JNI( 4197):      at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:141)\nE/MessageQueue-JNI( 4197):      at android.os.MessageQueue.nativePollOnce(Native Method)\nE/MessageQueue-JNI( 4197):      at android.os.MessageQueue.next(MessageQueue.java:148)\nE/MessageQueue-JNI( 4197):      at android.os.Looper.loop(Looper.java:151)\nE/MessageQueue-JNI( 4197):      at android.app.ActivityThread.main(ActivityThread.java:5631)\nE/MessageQueue-JNI( 4197):      at java.lang.reflect.Method.invoke(Native Method)\nE/MessageQueue-JNI( 4197):      at java.lang.reflect.Method.invoke(Method.java:372)\nE/MessageQueue-JNI( 4197):      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)\nE/MessageQueue-JNI( 4197):      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)\nE/AndroidRuntime( 4197): FATAL EXCEPTION: main\nE/AndroidRuntime( 4197): Process: org.tensorflow.demo, PID: 4197\nE/AndroidRuntime( 4197): java.lang.NullPointerException: Attempt to invoke interface method 'void org.tensorflow.demo.Classifier.enableStatLogging(boolean)' on a null object reference\nE/AndroidRuntime( 4197):        at org.tensorflow.demo.ClassifierActivity.onSetDebug(ClassifierActivity.java:183)\nE/AndroidRuntime( 4197):        at org.tensorflow.demo.CameraActivity.onKeyDown(CameraActivity.java:381)\nE/AndroidRuntime( 4197):        at android.view.KeyEvent.dispatch(KeyEvent.java:2758)\nE/AndroidRuntime( 4197):        at android.app.Activity.dispatchKeyEvent(Activity.java:2755)\nE/AndroidRuntime( 4197):        at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:2380)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:4556)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4512)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4190)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4247)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4223)\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:4393)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:2285)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:1909)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:1900)\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:2262)\nE/AndroidRuntime( 4197):        at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:141)\nE/AndroidRuntime( 4197):        at android.os.MessageQueue.nativePollOnce(Native Method)\nE/AndroidRuntime( 4197):        at android.os.MessageQueue.next(MessageQueue.java:148)\nE/AndroidRuntime( 4197):        at android.os.Looper.loop(Looper.java:151)\nE/AndroidRuntime( 4197):        at android.app.ActivityThread.main(ActivityThread.java:5631)\nE/AndroidRuntime( 4197):        at java.lang.reflect.Method.invoke(Native Method)\nE/AndroidRuntime( 4197):        at java.lang.reflect.Method.invoke(Method.java:372)\nE/AndroidRuntime( 4197):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)\nE/AndroidRuntime( 4197):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)\n\n\nI am not sure which part result in this , if any further information is needed , please tell me , thank you !", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.3.0\r\n- **Python version**: 2.7.12\r\n- **Bazel version (if compiling from source)**: 0.5.4\r\n- **CUDA/cuDNN version**:  8.0.61\r\n- **GPU model and memory**: NVIDIA Corporation Device 1b06\r\n- **Exact command to reproduce**: \r\n\r\nHow I do Fine-tune : \r\n```\r\n\r\n# Convert imagenet data to TFrecord ( No bounding box , just for classification ) \r\npython build_image_data.py \\\r\n--train_directory='imagenet/train' \\\r\n--validation_directory='imagenet/train' \\\r\n--labels_file='imagenet/labels.txt' \\\r\n--output_directory='imagenet/tfrecord' \r\n\r\n# Train from checkpoint\r\npython train_image_classifier.py \\\r\n    --dataset_dir=.../imagenet/tfrecord \\\r\n    --train_dir=.../imagenet/train_logs \\\r\n    --checkpoint_path=.../checkpoint/mobilenet_v1_0.50_224.ckpt \\\r\n    --model_name=mobilenet_v1_050 \\\r\n    --dataset_name=flowers \\                       ( _NUM_CLASSES and sizes has been modified )\r\n    --dataset_split_name=train \\\r\n    --max_number_of_steps=10000 \\\r\n    --checkpoint_exclude_scopes=MobilenetV1/Logits \\\r\n    --trainable_scopes=MobilenetV1/Logits \\\r\n\r\n# Produce .pb file (use .pbtxt)\r\nbazel-bin/tensorflow/python/tools/freeze_graph \\\r\n--input_graph=.../imagenet/train_logs/graph.pbtxt \\\r\n--input_checkpoint=.../imagenet/train_logs/model.ckpt-10000 \\\r\n--output_graph=.../imagenet/train_logs/frozen_graph.pb \\\r\n--output_node_names=MobilenetV1/Predictions/Reshape_1\r\n\r\n# Removes parts of a graph that are only needed for training\r\nbazel-bin/tensorflow/python/tools/optimize_for_inference \\\r\n--input=.../imagenet/train_logs/frozen_graph.pb \\\r\n--output=.../imagenet/train_logs/optimized_graph.pb \\\r\n--frozen_graph=True \\\r\n--input_names='prefetch_queue/fifo_queue' \\\r\n--output_names='MobilenetV1/Predictions/Reshape_1'\r\n\r\n```\r\n### Describe the problem\r\n\r\nHi , I am doing some fine-tune with mobilenet , I got some trouble at beginning since the input node \" prefetch_queue/fifo_queue \" , which Op \"FIFOQueueV2\" is disabled on Android , but I think it's okay  after using \"bazel-bin/tensorflow/python/tools/optimize_for_inference\" . ( I am not sure about it or I still need to customize my own TF library like mentioned [here](https://github.com/tensorflow/tensorflow/issues/8454) ? )\r\n\r\nBut now there is a new problem , after modify the parameter at \"ClassifierActivity.java\" like this : \r\n( input_name and output_name is from summarize_graph tool )\r\n```\r\n\r\n  private static final int INPUT_SIZE = 224;\r\n  private static final int IMAGE_MEAN = 117;\r\n  private static final float IMAGE_STD = 1;\r\n  private static final String INPUT_NAME = \"prefetch_queue/fifo_queue\";\r\n  private static final String OUTPUT_NAME = \"MobilenetV1/Predictions/Reshape_1\";\r\n\r\n  private static final String MODEL_FILE = \"file:///android_asset/tensorflow_inception_graph.pb\";\r\n  private static final String LABEL_FILE =\r\n      \"file:///android_asset/imagenet_comp_graph_label_strings.txt\";\r\n\r\n```\r\n\r\nand implement the demo on android , the TF Classify can be launched , but crash when press the volume key to turn on the debug mode. \r\n\r\nthe crash prints the following log :\r\n### Source code / logs\r\n\r\nError Message from adb logcat\r\n```\r\nE/InputEventSender( 4197): Exception dispatching finished signal.\r\nE/MessageQueue-JNI( 4197): Exception in MessageQueue callback: handleReceiveCallback\r\nE/MessageQueue-JNI( 4197): java.lang.NullPointerException: Attempt to invoke interface method 'void org.tensorflow.demo.Classifier.enableStatLogging(boolean)' on a null object reference\r\nE/MessageQueue-JNI( 4197):      at org.tensorflow.demo.ClassifierActivity.onSetDebug(ClassifierActivity.java:183)\r\nE/MessageQueue-JNI( 4197):      at org.tensorflow.demo.CameraActivity.onKeyDown(CameraActivity.java:381)\r\nE/MessageQueue-JNI( 4197):      at android.view.KeyEvent.dispatch(KeyEvent.java:2758)\r\nE/MessageQueue-JNI( 4197):      at android.app.Activity.dispatchKeyEvent(Activity.java:2755)\r\nE/MessageQueue-JNI( 4197):      at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:2380)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:4556)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4512)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4190)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4247)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4223)\r\nE/MessageQueue-JNI( 4197):      at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:4393)\r\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:2285)\r\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:1909)\r\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:1900)\r\nE/MessageQueue-JNI( 4197):      at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:2262)\r\nE/MessageQueue-JNI( 4197):      at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:141)\r\nE/MessageQueue-JNI( 4197):      at android.os.MessageQueue.nativePollOnce(Native Method)\r\nE/MessageQueue-JNI( 4197):      at android.os.MessageQueue.next(MessageQueue.java:148)\r\nE/MessageQueue-JNI( 4197):      at android.os.Looper.loop(Looper.java:151)\r\nE/MessageQueue-JNI( 4197):      at android.app.ActivityThread.main(ActivityThread.java:5631)\r\nE/MessageQueue-JNI( 4197):      at java.lang.reflect.Method.invoke(Native Method)\r\nE/MessageQueue-JNI( 4197):      at java.lang.reflect.Method.invoke(Method.java:372)\r\nE/MessageQueue-JNI( 4197):      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)\r\nE/MessageQueue-JNI( 4197):      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)\r\nE/AndroidRuntime( 4197): FATAL EXCEPTION: main\r\nE/AndroidRuntime( 4197): Process: org.tensorflow.demo, PID: 4197\r\nE/AndroidRuntime( 4197): java.lang.NullPointerException: Attempt to invoke interface method 'void org.tensorflow.demo.Classifier.enableStatLogging(boolean)' on a null object reference\r\nE/AndroidRuntime( 4197):        at org.tensorflow.demo.ClassifierActivity.onSetDebug(ClassifierActivity.java:183)\r\nE/AndroidRuntime( 4197):        at org.tensorflow.demo.CameraActivity.onKeyDown(CameraActivity.java:381)\r\nE/AndroidRuntime( 4197):        at android.view.KeyEvent.dispatch(KeyEvent.java:2758)\r\nE/AndroidRuntime( 4197):        at android.app.Activity.dispatchKeyEvent(Activity.java:2755)\r\nE/AndroidRuntime( 4197):        at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:2380)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:4556)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:4512)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4190)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:4247)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:4061)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:4034)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:4087)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:4053)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:4223)\r\nE/AndroidRuntime( 4197):        at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:4393)\r\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:2285)\r\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:1909)\r\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:1900)\r\nE/AndroidRuntime( 4197):        at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:2262)\r\nE/AndroidRuntime( 4197):        at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:141)\r\nE/AndroidRuntime( 4197):        at android.os.MessageQueue.nativePollOnce(Native Method)\r\nE/AndroidRuntime( 4197):        at android.os.MessageQueue.next(MessageQueue.java:148)\r\nE/AndroidRuntime( 4197):        at android.os.Looper.loop(Looper.java:151)\r\nE/AndroidRuntime( 4197):        at android.app.ActivityThread.main(ActivityThread.java:5631)\r\nE/AndroidRuntime( 4197):        at java.lang.reflect.Method.invoke(Native Method)\r\nE/AndroidRuntime( 4197):        at java.lang.reflect.Method.invoke(Method.java:372)\r\nE/AndroidRuntime( 4197):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)\r\nE/AndroidRuntime( 4197):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)\r\n\r\n```\r\n\r\nI am not sure which part result in this , if any further information is needed , please tell me , thank you !\r\n\r\n"}