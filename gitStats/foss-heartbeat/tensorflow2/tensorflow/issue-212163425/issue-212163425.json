{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8131", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8131/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8131/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8131/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8131", "id": 212163425, "node_id": "MDU6SXNzdWUyMTIxNjM0MjU=", "number": 8131, "title": "Better document when to use tf.sparse_tensor_dense_matmul vs embedding lookup", "user": {"login": "rgabbard", "id": 7139661, "node_id": "MDQ6VXNlcjcxMzk2NjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/7139661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rgabbard", "html_url": "https://github.com/rgabbard", "followers_url": "https://api.github.com/users/rgabbard/followers", "following_url": "https://api.github.com/users/rgabbard/following{/other_user}", "gists_url": "https://api.github.com/users/rgabbard/gists{/gist_id}", "starred_url": "https://api.github.com/users/rgabbard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rgabbard/subscriptions", "organizations_url": "https://api.github.com/users/rgabbard/orgs", "repos_url": "https://api.github.com/users/rgabbard/repos", "events_url": "https://api.github.com/users/rgabbard/events{/privacy}", "received_events_url": "https://api.github.com/users/rgabbard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-03-06T15:50:58Z", "updated_at": "2017-05-01T18:02:19Z", "closed_at": "2017-05-01T16:22:27Z", "author_association": "NONE", "body_html": "<p><code>tf.sparse_tensor_dense_matmul</code> has a regular (non-sparse) tensor gradient (<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/sparse_grad.py#L153\">source</a>):</p>\n<div class=\"highlight highlight-source-python\"><pre>  <span class=\"pl-c\"><span class=\"pl-c\">#</span> gradient w.r.t. dense</span>\n  b_grad <span class=\"pl-k\">=</span> sparse_ops.sparse_tensor_dense_matmul(sp_t, grad,\n                                                 <span class=\"pl-v\">adjoint_a</span><span class=\"pl-k\">=</span><span class=\"pl-k\">not</span> adj_a)</pre></div>\n<p>where <code>sparse_ops.sparse_tensor_dense_matmul</code> returns a regular tensor.</p>\n<p>The <a href=\"https://www.tensorflow.org/api_docs/python/tf/sparse_tensor_dense_matmul\" rel=\"nofollow\">documentation</a> does not note this and it may be confusing for people coming from e.g. NLP where you frequently work with dense-sparse multiplications with sparse gradients.</p>\n<p>In many cases where you might naively think you want to use <code>tf.sparse_tensor_dense_matmul</code> you actually want to use <a href=\"https://www.tensorflow.org/api_docs/python/tf/nn/embedding_lookup_sparse\" rel=\"nofollow\"><code>tf.nn.embedding_lookup_sparse</code></a>, even if your task has nothing to do with embeddings.  It would be helpful if there were a cross-reference in the documentation to guide users in the right direction.</p>", "body_text": "tf.sparse_tensor_dense_matmul has a regular (non-sparse) tensor gradient (source):\n  # gradient w.r.t. dense\n  b_grad = sparse_ops.sparse_tensor_dense_matmul(sp_t, grad,\n                                                 adjoint_a=not adj_a)\nwhere sparse_ops.sparse_tensor_dense_matmul returns a regular tensor.\nThe documentation does not note this and it may be confusing for people coming from e.g. NLP where you frequently work with dense-sparse multiplications with sparse gradients.\nIn many cases where you might naively think you want to use tf.sparse_tensor_dense_matmul you actually want to use tf.nn.embedding_lookup_sparse, even if your task has nothing to do with embeddings.  It would be helpful if there were a cross-reference in the documentation to guide users in the right direction.", "body": "`tf.sparse_tensor_dense_matmul` has a regular (non-sparse) tensor gradient ([source](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/sparse_grad.py#L153)):\r\n\r\n```python\r\n  # gradient w.r.t. dense\r\n  b_grad = sparse_ops.sparse_tensor_dense_matmul(sp_t, grad,\r\n                                                 adjoint_a=not adj_a)\r\n```\r\n\r\nwhere `sparse_ops.sparse_tensor_dense_matmul` returns a regular tensor.\r\n\r\nThe [documentation](https://www.tensorflow.org/api_docs/python/tf/sparse_tensor_dense_matmul) does not note this and it may be confusing for people coming from e.g. NLP where you frequently work with dense-sparse multiplications with sparse gradients.  \r\n\r\nIn many cases where you might naively think you want to use `tf.sparse_tensor_dense_matmul` you actually want to use [`tf.nn.embedding_lookup_sparse`](https://www.tensorflow.org/api_docs/python/tf/nn/embedding_lookup_sparse), even if your task has nothing to do with embeddings.  It would be helpful if there were a cross-reference in the documentation to guide users in the right direction.\r\n"}