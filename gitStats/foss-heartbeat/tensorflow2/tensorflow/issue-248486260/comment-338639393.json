{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/338639393", "html_url": "https://github.com/tensorflow/tensorflow/issues/12084#issuecomment-338639393", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12084", "id": 338639393, "node_id": "MDEyOklzc3VlQ29tbWVudDMzODYzOTM5Mw==", "user": {"login": "cmvikas94", "id": 26220098, "node_id": "MDQ6VXNlcjI2MjIwMDk4", "avatar_url": "https://avatars2.githubusercontent.com/u/26220098?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cmvikas94", "html_url": "https://github.com/cmvikas94", "followers_url": "https://api.github.com/users/cmvikas94/followers", "following_url": "https://api.github.com/users/cmvikas94/following{/other_user}", "gists_url": "https://api.github.com/users/cmvikas94/gists{/gist_id}", "starred_url": "https://api.github.com/users/cmvikas94/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cmvikas94/subscriptions", "organizations_url": "https://api.github.com/users/cmvikas94/orgs", "repos_url": "https://api.github.com/users/cmvikas94/repos", "events_url": "https://api.github.com/users/cmvikas94/events{/privacy}", "received_events_url": "https://api.github.com/users/cmvikas94/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-23T12:13:50Z", "updated_at": "2017-10-23T12:13:50Z", "author_association": "NONE", "body_html": "<p>I am trying to run mobilenet model trained over imagenet on Android Tensorflow for object recognition and facing the issue as described below.</p>\n<pre><code> TensorFlowInferenceInterface: Failed to load model \n from 'file:///android_asset/mobilenet_imagenet.pb': java.io.IOException: \n Not a valid TensorFlow Graph serialization: \n NodeDef mentions attr 'data_format' not in Op&lt;name=DepthwiseConv2dNative;\n signature=input:T, filter:T -&gt; output:T; \n attr=T:type,allowed=[DT_FLOAT, DT_DOUBLE]; attr=strides:list(int); \n attr=padding:string,allowed=[\"SAME\", \"VALID\"]&gt;; \n NodeDef: conv_dw_1/depthwise = \n DepthwiseConv2dNative[T=DT_FLOAT, data_format=\"NHWC\", padding=\"SAME\", strides=[1, 1, 1, 1]]\n (conv1_relu/clip_by_value, conv_dw_1/depthwise_kernel/read)\n\n</code></pre>\n<p>I followed the tutorial as given in the <a href=\"https://blog.mindorks.com/android-tensorflow-machine-learning-example-ff0e9b2654cc\" rel=\"nofollow\">link</a> to integrate Tensorflow on Android. I could run basic CNN classifier custom trained (using python 2.7.12, Tensorflow 1.2 on Ubuntu 16.04) and it is working fine.</p>\n<p>I could successfully run Mobilenet trained over imagenet on python 2.7.12 on Ubuntu 16.04 using Tensorflow 1.2 and 1.3. Now when I try to run the same '.pb' model on Android it gives me the error as mentioned above.</p>\n<p>The code for initializing the model is as given below :</p>\n<div class=\"highlight highlight-source-java\"><pre><span class=\"pl-smi\">TensorFlowImageClassifier</span> c <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">TensorFlowImageClassifier</span>();\nc<span class=\"pl-k\">.</span>inferenceInterface <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">TensorFlowInferenceInterface</span>();\n<span class=\"pl-k\">if</span> (c<span class=\"pl-k\">.</span>inferenceInterface<span class=\"pl-k\">.</span>initializeTensorFlow(assetManager, modelFilename) <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">0</span>) {\n         <span class=\"pl-k\">throw</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">RuntimeException</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>TF initialization failed<span class=\"pl-pds\">\"</span></span>);\n}\n</pre></div>\n<p>Please suggest me solution or work around. Thank you</p>", "body_text": "I am trying to run mobilenet model trained over imagenet on Android Tensorflow for object recognition and facing the issue as described below.\n TensorFlowInferenceInterface: Failed to load model \n from 'file:///android_asset/mobilenet_imagenet.pb': java.io.IOException: \n Not a valid TensorFlow Graph serialization: \n NodeDef mentions attr 'data_format' not in Op<name=DepthwiseConv2dNative;\n signature=input:T, filter:T -> output:T; \n attr=T:type,allowed=[DT_FLOAT, DT_DOUBLE]; attr=strides:list(int); \n attr=padding:string,allowed=[\"SAME\", \"VALID\"]>; \n NodeDef: conv_dw_1/depthwise = \n DepthwiseConv2dNative[T=DT_FLOAT, data_format=\"NHWC\", padding=\"SAME\", strides=[1, 1, 1, 1]]\n (conv1_relu/clip_by_value, conv_dw_1/depthwise_kernel/read)\n\n\nI followed the tutorial as given in the link to integrate Tensorflow on Android. I could run basic CNN classifier custom trained (using python 2.7.12, Tensorflow 1.2 on Ubuntu 16.04) and it is working fine.\nI could successfully run Mobilenet trained over imagenet on python 2.7.12 on Ubuntu 16.04 using Tensorflow 1.2 and 1.3. Now when I try to run the same '.pb' model on Android it gives me the error as mentioned above.\nThe code for initializing the model is as given below :\nTensorFlowImageClassifier c = new TensorFlowImageClassifier();\nc.inferenceInterface = new TensorFlowInferenceInterface();\nif (c.inferenceInterface.initializeTensorFlow(assetManager, modelFilename) != 0) {\n         throw new RuntimeException(\"TF initialization failed\");\n}\n\nPlease suggest me solution or work around. Thank you", "body": "I am trying to run mobilenet model trained over imagenet on Android Tensorflow for object recognition and facing the issue as described below.\r\n\r\n```\r\n TensorFlowInferenceInterface: Failed to load model \r\n from 'file:///android_asset/mobilenet_imagenet.pb': java.io.IOException: \r\n Not a valid TensorFlow Graph serialization: \r\n NodeDef mentions attr 'data_format' not in Op<name=DepthwiseConv2dNative;\r\n signature=input:T, filter:T -> output:T; \r\n attr=T:type,allowed=[DT_FLOAT, DT_DOUBLE]; attr=strides:list(int); \r\n attr=padding:string,allowed=[\"SAME\", \"VALID\"]>; \r\n NodeDef: conv_dw_1/depthwise = \r\n DepthwiseConv2dNative[T=DT_FLOAT, data_format=\"NHWC\", padding=\"SAME\", strides=[1, 1, 1, 1]]\r\n (conv1_relu/clip_by_value, conv_dw_1/depthwise_kernel/read)\r\n\r\n```\r\nI followed the tutorial as given in the [link](https://blog.mindorks.com/android-tensorflow-machine-learning-example-ff0e9b2654cc) to integrate Tensorflow on Android. I could run basic CNN classifier custom trained (using python 2.7.12, Tensorflow 1.2 on Ubuntu 16.04) and it is working fine.\r\n\r\nI could successfully run Mobilenet trained over imagenet on python 2.7.12 on Ubuntu 16.04 using Tensorflow 1.2 and 1.3. Now when I try to run the same '.pb' model on Android it gives me the error as mentioned above.\r\n \r\nThe code for initializing the model is as given below :\r\n\r\n   ```Java\r\nTensorFlowImageClassifier c = new TensorFlowImageClassifier();\r\n   c.inferenceInterface = new TensorFlowInferenceInterface();\r\n   if (c.inferenceInterface.initializeTensorFlow(assetManager, modelFilename) != 0) {\r\n            throw new RuntimeException(\"TF initialization failed\");\r\n   }\r\n\r\n```\r\nPlease suggest me solution or work around. Thank you"}