{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15921", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15921/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15921/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15921/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15921", "id": 286538124, "node_id": "MDU6SXNzdWUyODY1MzgxMjQ=", "number": 15921, "title": "iOS: Op type not registered 'DecodeWav'", "user": {"login": "anton6", "id": 16119505, "node_id": "MDQ6VXNlcjE2MTE5NTA1", "avatar_url": "https://avatars1.githubusercontent.com/u/16119505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anton6", "html_url": "https://github.com/anton6", "followers_url": "https://api.github.com/users/anton6/followers", "following_url": "https://api.github.com/users/anton6/following{/other_user}", "gists_url": "https://api.github.com/users/anton6/gists{/gist_id}", "starred_url": "https://api.github.com/users/anton6/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anton6/subscriptions", "organizations_url": "https://api.github.com/users/anton6/orgs", "repos_url": "https://api.github.com/users/anton6/repos", "events_url": "https://api.github.com/users/anton6/events{/privacy}", "received_events_url": "https://api.github.com/users/anton6/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2018-01-07T02:55:51Z", "updated_at": "2018-01-31T19:36:01Z", "closed_at": "2018-01-31T19:36:01Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: I am trying to run graph model from Simple Audio Recognition example on iOS.</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Mac OS X 10.13</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Branch r1.4</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.4</li>\n<li><strong>Python version</strong>: 2.7</li>\n<li><strong>Bazel version (if compiling from source)</strong>: Build label: 0.9.0-homebrew</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A</li>\n<li><strong>GPU model and memory</strong>: N/A</li>\n<li><strong>Exact command to reproduce</strong>: N/A</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I am trying to run graph model from Simple Audio Recognition example on iOS. When I am calling <code>session-&gt;Create(tensorflow_graph)</code> with the graph I get the error: \"Could not create TensorFlow Graph: Not found: Op type not registered 'DecodeWav'...\".</p>\n<p>My initial thought is that because I am using TensorFlow-experimental (1.1.1) from pods, it's possible that this Op type is not registered. So I tried building it myself, which builds without errors with command: <code>tensorflow/contrib/makefile/build_all_ios.sh</code>. I then remove TensorFlow-experimental (1.1.1) from the project and link my own build of tensorflow, but I get the same error.</p>\n<p>I also found the following PR - <a href=\"https://github.com/tensorflow/tensorflow/pull/14421\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/14421/hovercard\">[iOS] Add optional Selective Registration of Ops #14421</a></p>\n<p>I tried building from master with the above PR merged like so:</p>\n<p>For iPhone 5:<br>\n<code>tensorflow/contrib/makefile/build_all_ios.sh -a armv7 -g /Users/anton/Development/tensorflow/tensorflow/examples/ios/simple/data/tensorflow_inception_graph_speech.pb</code></p>\n<p>For iPhone SE:<br>\n<code>tensorflow/contrib/makefile/build_all_ios.sh -a arm64 -g /Users/anton/Development/tensorflow/tensorflow/examples/ios/simple/data/tensorflow_inception_graph_speech.pb</code></p>\n<p>If I then go and check the file <code>/tensorflow/tensorflow/core/framework/ops_to_register.h</code> (auto-generated after above command) I can see that DecodeWav is listed among kernels and operations:</p>\n<pre><code>// This file was autogenerated by print_selective_registration_header.py\n#ifndef OPS_TO_REGISTER\n#define OPS_TO_REGISTER\n\n    namespace {\n      constexpr const char* skip(const char* x) {\n        return (*x) ? (*x == ' ' ? skip(x + 1) : x) : x;\n      }\n\n      constexpr bool isequal(const char* x, const char* y) {\n        return (*skip(x) &amp;&amp; *skip(y))\n                   ? (*skip(x) == *skip(y) &amp;&amp; isequal(skip(x) + 1, skip(y) + 1))\n                   : (!*skip(x) &amp;&amp; !*skip(y));\n      }\n\n      template&lt;int N&gt;\n      struct find_in {\n        static constexpr bool f(const char* x, const char* const y[N]) {\n          return isequal(x, y[0]) || find_in&lt;N - 1&gt;::f(x, y + 1);\n        }\n      };\n\n      template&lt;&gt;\n      struct find_in&lt;0&gt; {\n        static constexpr bool f(const char* x, const char* const y[]) {\n          return false;\n        }\n      };\n    }  // end namespace\n    constexpr const char* kNecessaryOpKernelClasses[] = {\n\"BinaryOp&lt; CPUDevice, functor::add&lt;float&gt;&gt;\",\n\"AudioSpectrogramOp\",\n\"ConstantOp\",\n\"Conv2DOp&lt;CPUDevice, float&gt;\",\n\"DecodeWavOp\",\n\"IdentityOp\",\n\"MatMulOp&lt;CPUDevice, float, false &gt;\",\n\"MaxPoolingOp&lt;CPUDevice, float&gt;\",\n\"MfccOp\",\n\"NoOp\",\n\"PlaceholderOp\",\n\"ReluOp&lt;CPUDevice, float&gt;\",\n\"ReshapeOp\",\n\"SoftmaxOp&lt;CPUDevice, float&gt;\",\n\"RecvOp\",\n\"SendOp\",\n};\n#define SHOULD_REGISTER_OP_KERNEL(clz) (find_in&lt;sizeof(kNecessaryOpKernelClasses) / sizeof(*kNecessaryOpKernelClasses)&gt;::f(clz, kNecessaryOpKernelClasses))\n\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\n  return false\n     || isequal(op, \"Add\")\n     || isequal(op, \"AudioSpectrogram\")\n     || isequal(op, \"Const\")\n     || isequal(op, \"Conv2D\")\n     || isequal(op, \"DecodeWav\")\n     || isequal(op, \"Identity\")\n     || isequal(op, \"MatMul\")\n     || isequal(op, \"MaxPool\")\n     || isequal(op, \"Mfcc\")\n     || isequal(op, \"NoOp\")\n     || isequal(op, \"Placeholder\")\n     || isequal(op, \"Relu\")\n     || isequal(op, \"Reshape\")\n     || isequal(op, \"Softmax\")\n     || isequal(op, \"_Recv\")\n     || isequal(op, \"_Send\")\n  ;\n}\n#define SHOULD_REGISTER_OP(op) ShouldRegisterOp(op)\n\n#define SHOULD_REGISTER_OP_GRADIENT false\n#endif\n\n</code></pre>\n<p>But when I try to run the graph model I still get same error message. I have removed the pod version, and I am 100% sure I am running my own build version of tensorflow on iOS.</p>\n<p>I can't tell if this is a bug or I am doing something wrong during the build process.</p>\n<p>Has anyone tried running any graph that uses DecodeWav on iOS?</p>\n<p>Thanks.</p>\n<h3>Source code / logs</h3>\n<p>Error: Could not create TensorFlow Graph: Not found: Op type not registered 'DecodeWav' in binary running on Antons-iPhone. Make sure the Op and Kernel are registered in the binary running in this process.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): I am trying to run graph model from Simple Audio Recognition example on iOS.\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac OS X 10.13\nTensorFlow installed from (source or binary): Branch r1.4\nTensorFlow version (use command below): 1.4\nPython version: 2.7\nBazel version (if compiling from source): Build label: 0.9.0-homebrew\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce: N/A\n\nDescribe the problem\nI am trying to run graph model from Simple Audio Recognition example on iOS. When I am calling session->Create(tensorflow_graph) with the graph I get the error: \"Could not create TensorFlow Graph: Not found: Op type not registered 'DecodeWav'...\".\nMy initial thought is that because I am using TensorFlow-experimental (1.1.1) from pods, it's possible that this Op type is not registered. So I tried building it myself, which builds without errors with command: tensorflow/contrib/makefile/build_all_ios.sh. I then remove TensorFlow-experimental (1.1.1) from the project and link my own build of tensorflow, but I get the same error.\nI also found the following PR - [iOS] Add optional Selective Registration of Ops #14421\nI tried building from master with the above PR merged like so:\nFor iPhone 5:\ntensorflow/contrib/makefile/build_all_ios.sh -a armv7 -g /Users/anton/Development/tensorflow/tensorflow/examples/ios/simple/data/tensorflow_inception_graph_speech.pb\nFor iPhone SE:\ntensorflow/contrib/makefile/build_all_ios.sh -a arm64 -g /Users/anton/Development/tensorflow/tensorflow/examples/ios/simple/data/tensorflow_inception_graph_speech.pb\nIf I then go and check the file /tensorflow/tensorflow/core/framework/ops_to_register.h (auto-generated after above command) I can see that DecodeWav is listed among kernels and operations:\n// This file was autogenerated by print_selective_registration_header.py\n#ifndef OPS_TO_REGISTER\n#define OPS_TO_REGISTER\n\n    namespace {\n      constexpr const char* skip(const char* x) {\n        return (*x) ? (*x == ' ' ? skip(x + 1) : x) : x;\n      }\n\n      constexpr bool isequal(const char* x, const char* y) {\n        return (*skip(x) && *skip(y))\n                   ? (*skip(x) == *skip(y) && isequal(skip(x) + 1, skip(y) + 1))\n                   : (!*skip(x) && !*skip(y));\n      }\n\n      template<int N>\n      struct find_in {\n        static constexpr bool f(const char* x, const char* const y[N]) {\n          return isequal(x, y[0]) || find_in<N - 1>::f(x, y + 1);\n        }\n      };\n\n      template<>\n      struct find_in<0> {\n        static constexpr bool f(const char* x, const char* const y[]) {\n          return false;\n        }\n      };\n    }  // end namespace\n    constexpr const char* kNecessaryOpKernelClasses[] = {\n\"BinaryOp< CPUDevice, functor::add<float>>\",\n\"AudioSpectrogramOp\",\n\"ConstantOp\",\n\"Conv2DOp<CPUDevice, float>\",\n\"DecodeWavOp\",\n\"IdentityOp\",\n\"MatMulOp<CPUDevice, float, false >\",\n\"MaxPoolingOp<CPUDevice, float>\",\n\"MfccOp\",\n\"NoOp\",\n\"PlaceholderOp\",\n\"ReluOp<CPUDevice, float>\",\n\"ReshapeOp\",\n\"SoftmaxOp<CPUDevice, float>\",\n\"RecvOp\",\n\"SendOp\",\n};\n#define SHOULD_REGISTER_OP_KERNEL(clz) (find_in<sizeof(kNecessaryOpKernelClasses) / sizeof(*kNecessaryOpKernelClasses)>::f(clz, kNecessaryOpKernelClasses))\n\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\n  return false\n     || isequal(op, \"Add\")\n     || isequal(op, \"AudioSpectrogram\")\n     || isequal(op, \"Const\")\n     || isequal(op, \"Conv2D\")\n     || isequal(op, \"DecodeWav\")\n     || isequal(op, \"Identity\")\n     || isequal(op, \"MatMul\")\n     || isequal(op, \"MaxPool\")\n     || isequal(op, \"Mfcc\")\n     || isequal(op, \"NoOp\")\n     || isequal(op, \"Placeholder\")\n     || isequal(op, \"Relu\")\n     || isequal(op, \"Reshape\")\n     || isequal(op, \"Softmax\")\n     || isequal(op, \"_Recv\")\n     || isequal(op, \"_Send\")\n  ;\n}\n#define SHOULD_REGISTER_OP(op) ShouldRegisterOp(op)\n\n#define SHOULD_REGISTER_OP_GRADIENT false\n#endif\n\n\nBut when I try to run the graph model I still get same error message. I have removed the pod version, and I am 100% sure I am running my own build version of tensorflow on iOS.\nI can't tell if this is a bug or I am doing something wrong during the build process.\nHas anyone tried running any graph that uses DecodeWav on iOS?\nThanks.\nSource code / logs\nError: Could not create TensorFlow Graph: Not found: Op type not registered 'DecodeWav' in binary running on Antons-iPhone. Make sure the Op and Kernel are registered in the binary running in this process.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: I am trying to run graph model from Simple Audio Recognition example on iOS.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Mac OS X 10.13\r\n- **TensorFlow installed from (source or binary)**: Branch r1.4\r\n- **TensorFlow version (use command below)**: 1.4\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: Build label: 0.9.0-homebrew\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\n\r\nI am trying to run graph model from Simple Audio Recognition example on iOS. When I am calling `session->Create(tensorflow_graph)` with the graph I get the error: \"Could not create TensorFlow Graph: Not found: Op type not registered 'DecodeWav'...\".\r\n\r\nMy initial thought is that because I am using TensorFlow-experimental (1.1.1) from pods, it's possible that this Op type is not registered. So I tried building it myself, which builds without errors with command: `tensorflow/contrib/makefile/build_all_ios.sh`. I then remove TensorFlow-experimental (1.1.1) from the project and link my own build of tensorflow, but I get the same error. \r\n\r\nI also found the following PR - [[iOS] Add optional Selective Registration of Ops #14421](https://github.com/tensorflow/tensorflow/pull/14421)\r\n\r\nI tried building from master with the above PR merged like so:\r\n \r\nFor iPhone 5:\r\n`tensorflow/contrib/makefile/build_all_ios.sh -a armv7 -g /Users/anton/Development/tensorflow/tensorflow/examples/ios/simple/data/tensorflow_inception_graph_speech.pb`\r\n\r\nFor iPhone SE:\r\n`tensorflow/contrib/makefile/build_all_ios.sh -a arm64 -g /Users/anton/Development/tensorflow/tensorflow/examples/ios/simple/data/tensorflow_inception_graph_speech.pb`\r\n\r\nIf I then go and check the file `/tensorflow/tensorflow/core/framework/ops_to_register.h` (auto-generated after above command) I can see that DecodeWav is listed among kernels and operations:\r\n\r\n```\r\n// This file was autogenerated by print_selective_registration_header.py\r\n#ifndef OPS_TO_REGISTER\r\n#define OPS_TO_REGISTER\r\n\r\n    namespace {\r\n      constexpr const char* skip(const char* x) {\r\n        return (*x) ? (*x == ' ' ? skip(x + 1) : x) : x;\r\n      }\r\n\r\n      constexpr bool isequal(const char* x, const char* y) {\r\n        return (*skip(x) && *skip(y))\r\n                   ? (*skip(x) == *skip(y) && isequal(skip(x) + 1, skip(y) + 1))\r\n                   : (!*skip(x) && !*skip(y));\r\n      }\r\n\r\n      template<int N>\r\n      struct find_in {\r\n        static constexpr bool f(const char* x, const char* const y[N]) {\r\n          return isequal(x, y[0]) || find_in<N - 1>::f(x, y + 1);\r\n        }\r\n      };\r\n\r\n      template<>\r\n      struct find_in<0> {\r\n        static constexpr bool f(const char* x, const char* const y[]) {\r\n          return false;\r\n        }\r\n      };\r\n    }  // end namespace\r\n    constexpr const char* kNecessaryOpKernelClasses[] = {\r\n\"BinaryOp< CPUDevice, functor::add<float>>\",\r\n\"AudioSpectrogramOp\",\r\n\"ConstantOp\",\r\n\"Conv2DOp<CPUDevice, float>\",\r\n\"DecodeWavOp\",\r\n\"IdentityOp\",\r\n\"MatMulOp<CPUDevice, float, false >\",\r\n\"MaxPoolingOp<CPUDevice, float>\",\r\n\"MfccOp\",\r\n\"NoOp\",\r\n\"PlaceholderOp\",\r\n\"ReluOp<CPUDevice, float>\",\r\n\"ReshapeOp\",\r\n\"SoftmaxOp<CPUDevice, float>\",\r\n\"RecvOp\",\r\n\"SendOp\",\r\n};\r\n#define SHOULD_REGISTER_OP_KERNEL(clz) (find_in<sizeof(kNecessaryOpKernelClasses) / sizeof(*kNecessaryOpKernelClasses)>::f(clz, kNecessaryOpKernelClasses))\r\n\r\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\r\n  return false\r\n     || isequal(op, \"Add\")\r\n     || isequal(op, \"AudioSpectrogram\")\r\n     || isequal(op, \"Const\")\r\n     || isequal(op, \"Conv2D\")\r\n     || isequal(op, \"DecodeWav\")\r\n     || isequal(op, \"Identity\")\r\n     || isequal(op, \"MatMul\")\r\n     || isequal(op, \"MaxPool\")\r\n     || isequal(op, \"Mfcc\")\r\n     || isequal(op, \"NoOp\")\r\n     || isequal(op, \"Placeholder\")\r\n     || isequal(op, \"Relu\")\r\n     || isequal(op, \"Reshape\")\r\n     || isequal(op, \"Softmax\")\r\n     || isequal(op, \"_Recv\")\r\n     || isequal(op, \"_Send\")\r\n  ;\r\n}\r\n#define SHOULD_REGISTER_OP(op) ShouldRegisterOp(op)\r\n\r\n#define SHOULD_REGISTER_OP_GRADIENT false\r\n#endif\r\n\r\n```\r\n\r\nBut when I try to run the graph model I still get same error message. I have removed the pod version, and I am 100% sure I am running my own build version of tensorflow on iOS.\r\n\r\nI can't tell if this is a bug or I am doing something wrong during the build process.\r\n\r\nHas anyone tried running any graph that uses DecodeWav on iOS?\r\n\r\nThanks.\r\n\r\n### Source code / logs\r\n\r\nError: Could not create TensorFlow Graph: Not found: Op type not registered 'DecodeWav' in binary running on Antons-iPhone. Make sure the Op and Kernel are registered in the binary running in this process.\r\n\r\n\r\n\r\n\r\n\r\n"}