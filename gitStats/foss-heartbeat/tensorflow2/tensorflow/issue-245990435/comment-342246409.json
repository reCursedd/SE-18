{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/342246409", "html_url": "https://github.com/tensorflow/tensorflow/issues/11812#issuecomment-342246409", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11812", "id": 342246409, "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjI0NjQwOQ==", "user": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-06T18:47:45Z", "updated_at": "2017-11-06T18:47:45Z", "author_association": "MEMBER", "body_html": "<p>It looks like <code>GridSearchCV</code> uses <code>joblib</code>. If it attempts to pickle a Keras model (and thus a TF graph) for use in different processes, then that is potentially not going to be possible safely (<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6510203\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/reedwm\">@reedwm</a> may be able to say more).</p>\n<blockquote>\n<p>If multiple TensorFlow processes are used, either per_process_gpu_memory_fraction or allow_growth should be passed to the TensorFlow Session in a ConfigProto to prevent one process from using all the GPU memory. Preferably, multiple TensorFlow processes wouldn't be used at the same time.</p>\n</blockquote>\n<p>It is possible to do this in Keras by creating your own session (with <code>per_process_gpu_memory_fraction</code> configured), then setting this session as the Keras session via <code>keras.backend.set_session(sess)</code>. Do this before creating your Keras model.</p>", "body_text": "It looks like GridSearchCV uses joblib. If it attempts to pickle a Keras model (and thus a TF graph) for use in different processes, then that is potentially not going to be possible safely (@reedwm may be able to say more).\n\nIf multiple TensorFlow processes are used, either per_process_gpu_memory_fraction or allow_growth should be passed to the TensorFlow Session in a ConfigProto to prevent one process from using all the GPU memory. Preferably, multiple TensorFlow processes wouldn't be used at the same time.\n\nIt is possible to do this in Keras by creating your own session (with per_process_gpu_memory_fraction configured), then setting this session as the Keras session via keras.backend.set_session(sess). Do this before creating your Keras model.", "body": "It looks like `GridSearchCV` uses `joblib`. If it attempts to pickle a Keras model (and thus a TF graph) for use in different processes, then that is potentially not going to be possible safely (@reedwm may be able to say more).\r\n\r\n> If multiple TensorFlow processes are used, either per_process_gpu_memory_fraction or allow_growth should be passed to the TensorFlow Session in a ConfigProto to prevent one process from using all the GPU memory. Preferably, multiple TensorFlow processes wouldn't be used at the same time.\r\n\r\nIt is possible to do this in Keras by creating your own session (with `per_process_gpu_memory_fraction` configured), then setting this session as the Keras session via `keras.backend.set_session(sess)`. Do this before creating your Keras model."}