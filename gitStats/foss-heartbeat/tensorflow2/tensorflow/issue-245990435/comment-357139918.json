{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/357139918", "html_url": "https://github.com/tensorflow/tensorflow/issues/11812#issuecomment-357139918", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11812", "id": 357139918, "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzEzOTkxOA==", "user": {"login": "kuntoro-adi", "id": 18701878, "node_id": "MDQ6VXNlcjE4NzAxODc4", "avatar_url": "https://avatars3.githubusercontent.com/u/18701878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kuntoro-adi", "html_url": "https://github.com/kuntoro-adi", "followers_url": "https://api.github.com/users/kuntoro-adi/followers", "following_url": "https://api.github.com/users/kuntoro-adi/following{/other_user}", "gists_url": "https://api.github.com/users/kuntoro-adi/gists{/gist_id}", "starred_url": "https://api.github.com/users/kuntoro-adi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kuntoro-adi/subscriptions", "organizations_url": "https://api.github.com/users/kuntoro-adi/orgs", "repos_url": "https://api.github.com/users/kuntoro-adi/repos", "events_url": "https://api.github.com/users/kuntoro-adi/events{/privacy}", "received_events_url": "https://api.github.com/users/kuntoro-adi/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-12T04:24:32Z", "updated_at": "2018-01-12T04:25:11Z", "author_association": "NONE", "body_html": "<p>Hi,<br>\nI experienced the same error when executing the code in tutorial <a href=\"https://www.tensorflow.org/get_started/get_started\" rel=\"nofollow\">tf.estimator</a></p>\n<p>Here's the error message</p>\n<pre><code>$ python tfestimator.py\nWARNING:tensorflow:Using temporary folder as model directory: C:\\Users\\&lt;username&gt;\\AppData\\Local\\Temp\\tmpdlwf3cjk\nTraceback (most recent call last):\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1327, in _do_call\n    return fn(*args)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1306, in _run_fn\n    status, run_metadata)\n  File \"C:\\Anaconda3\\lib\\contextlib.py\", line 88, in __exit__\n    next(self.gen)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=1, n=4\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"tfestimator.py\", line 29, in &lt;module&gt;\n    estimator.train(input_fn=input_fn, steps=1000)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 241, in train\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 686, in _train_model\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 518, in run\n    run_metadata=run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 862, in run\n    run_metadata=run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\n    return self._sess.run(*args, **kwargs)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 972, in run\n    run_metadata=run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\n    return self._sess.run(*args, **kwargs)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 895, in run\n    run_metadata_ptr)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1124, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1321, in _do_run\n    options, run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1340, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=1, n=4\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\n\nCaused by op 'linear/linear_model/x/weighted_sum', defined at:\n  File \"tfestimator.py\", line 29, in &lt;module&gt;\n    estimator.train(input_fn=input_fn, steps=1000)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 241, in train\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 630, in _train_model\n    model_fn_lib.ModeKeys.TRAIN)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 615, in _call_model_fn\n    model_fn_results = self._model_fn(features=features, **kwargs)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\canned\\linear.py\", line 316, in _model_fn\n    config=config)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\canned\\linear.py\", line 89, in _linear_model_fn\n    units=head.logits_dimension)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\feature_column\\feature_column.py\", line 321, in linear_model\n    column, builder, units, weight_collections, trainable))\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\feature_column\\feature_column.py\", line 1376, in _create_dense_column_weighted_sum\n    return math_ops.matmul(tensor, weight, name='weighted_sum')\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1844, in matmul\n    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1289, in _mat_mul\n    transpose_b=transpose_b, name=name)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\n    op_def=op_def)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInternalError (see above for traceback): Blas GEMV launch failed:  m=1, n=4\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\n\n2018-01-12 11:12:13.512132: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\n2018-01-12 11:12:13.512150: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\n2018-01-12 11:12:13.993976: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:955] Found device 0 with properties:\nname: GeForce 940MX\nmajor: 5 minor: 0 memoryClockRate (GHz) 1.2415\npciBusID 0000:01:00.0\nTotal memory: 2.00GiB\nFree memory: 1.66GiB\n2018-01-12 11:12:13.993992: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:976] DMA: 0\n2018-01-12 11:12:13.993996: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:986] 0:   Y\n2018-01-12 11:12:13.994018: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce 940MX, pci bus id: 0000:01:00.0)\n2018-01-12 11:12:17.243570: E C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:366] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\n2018-01-12 11:12:17.243585: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\stream_executor\\stream.cc:1756] attempting to perform BLAS operation using StreamExecutor without BLAS support\n</code></pre>\n<p>My apology, should I write a new issue?<br>\nThank you</p>", "body_text": "Hi,\nI experienced the same error when executing the code in tutorial tf.estimator\nHere's the error message\n$ python tfestimator.py\nWARNING:tensorflow:Using temporary folder as model directory: C:\\Users\\<username>\\AppData\\Local\\Temp\\tmpdlwf3cjk\nTraceback (most recent call last):\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1327, in _do_call\n    return fn(*args)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1306, in _run_fn\n    status, run_metadata)\n  File \"C:\\Anaconda3\\lib\\contextlib.py\", line 88, in __exit__\n    next(self.gen)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=1, n=4\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"tfestimator.py\", line 29, in <module>\n    estimator.train(input_fn=input_fn, steps=1000)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 241, in train\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 686, in _train_model\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 518, in run\n    run_metadata=run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 862, in run\n    run_metadata=run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\n    return self._sess.run(*args, **kwargs)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 972, in run\n    run_metadata=run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\n    return self._sess.run(*args, **kwargs)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 895, in run\n    run_metadata_ptr)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1124, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1321, in _do_run\n    options, run_metadata)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1340, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=1, n=4\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\n\nCaused by op 'linear/linear_model/x/weighted_sum', defined at:\n  File \"tfestimator.py\", line 29, in <module>\n    estimator.train(input_fn=input_fn, steps=1000)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 241, in train\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 630, in _train_model\n    model_fn_lib.ModeKeys.TRAIN)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 615, in _call_model_fn\n    model_fn_results = self._model_fn(features=features, **kwargs)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\canned\\linear.py\", line 316, in _model_fn\n    config=config)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\canned\\linear.py\", line 89, in _linear_model_fn\n    units=head.logits_dimension)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\feature_column\\feature_column.py\", line 321, in linear_model\n    column, builder, units, weight_collections, trainable))\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\feature_column\\feature_column.py\", line 1376, in _create_dense_column_weighted_sum\n    return math_ops.matmul(tensor, weight, name='weighted_sum')\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1844, in matmul\n    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1289, in _mat_mul\n    transpose_b=transpose_b, name=name)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\n    op_def=op_def)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInternalError (see above for traceback): Blas GEMV launch failed:  m=1, n=4\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\n\n2018-01-12 11:12:13.512132: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\n2018-01-12 11:12:13.512150: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\n2018-01-12 11:12:13.993976: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:955] Found device 0 with properties:\nname: GeForce 940MX\nmajor: 5 minor: 0 memoryClockRate (GHz) 1.2415\npciBusID 0000:01:00.0\nTotal memory: 2.00GiB\nFree memory: 1.66GiB\n2018-01-12 11:12:13.993992: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:976] DMA: 0\n2018-01-12 11:12:13.993996: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:986] 0:   Y\n2018-01-12 11:12:13.994018: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce 940MX, pci bus id: 0000:01:00.0)\n2018-01-12 11:12:17.243570: E C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:366] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\n2018-01-12 11:12:17.243585: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\stream_executor\\stream.cc:1756] attempting to perform BLAS operation using StreamExecutor without BLAS support\n\nMy apology, should I write a new issue?\nThank you", "body": "Hi, \r\nI experienced the same error when executing the code in tutorial [tf.estimator](https://www.tensorflow.org/get_started/get_started)\r\n\r\nHere's the error message\r\n\r\n```\r\n$ python tfestimator.py\r\nWARNING:tensorflow:Using temporary folder as model directory: C:\\Users\\<username>\\AppData\\Local\\Temp\\tmpdlwf3cjk\r\nTraceback (most recent call last):\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1327, in _do_call\r\n    return fn(*args)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1306, in _run_fn\r\n    status, run_metadata)\r\n  File \"C:\\Anaconda3\\lib\\contextlib.py\", line 88, in __exit__\r\n    next(self.gen)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=1, n=4\r\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"tfestimator.py\", line 29, in <module>\r\n    estimator.train(input_fn=input_fn, steps=1000)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 241, in train\r\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 686, in _train_model\r\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 518, in run\r\n    run_metadata=run_metadata)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 862, in run\r\n    run_metadata=run_metadata)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 972, in run\r\n    run_metadata=run_metadata)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 895, in run\r\n    run_metadata_ptr)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1124, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1321, in _do_run\r\n    options, run_metadata)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1340, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=1, n=4\r\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\r\n\r\nCaused by op 'linear/linear_model/x/weighted_sum', defined at:\r\n  File \"tfestimator.py\", line 29, in <module>\r\n    estimator.train(input_fn=input_fn, steps=1000)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 241, in train\r\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 630, in _train_model\r\n    model_fn_lib.ModeKeys.TRAIN)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 615, in _call_model_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\canned\\linear.py\", line 316, in _model_fn\r\n    config=config)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\canned\\linear.py\", line 89, in _linear_model_fn\r\n    units=head.logits_dimension)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\feature_column\\feature_column.py\", line 321, in linear_model\r\n    column, builder, units, weight_collections, trainable))\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\feature_column\\feature_column.py\", line 1376, in _create_dense_column_weighted_sum\r\n    return math_ops.matmul(tensor, weight, name='weighted_sum')\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1844, in matmul\r\n    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1289, in _mat_mul\r\n    transpose_b=transpose_b, name=name)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\r\n    op_def=op_def)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInternalError (see above for traceback): Blas GEMV launch failed:  m=1, n=4\r\n         [[Node: linear/linear_model/x/weighted_sum = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](linear/linear_model/x/Reshape, linear/linear_model/x/weights)]]\r\n\r\n2018-01-12 11:12:13.512132: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\r\n2018-01-12 11:12:13.512150: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\platform\\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\r\n2018-01-12 11:12:13.993976: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:955] Found device 0 with properties:\r\nname: GeForce 940MX\r\nmajor: 5 minor: 0 memoryClockRate (GHz) 1.2415\r\npciBusID 0000:01:00.0\r\nTotal memory: 2.00GiB\r\nFree memory: 1.66GiB\r\n2018-01-12 11:12:13.993992: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:976] DMA: 0\r\n2018-01-12 11:12:13.993996: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:986] 0:   Y\r\n2018-01-12 11:12:13.994018: I C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce 940MX, pci bus id: 0000:01:00.0)\r\n2018-01-12 11:12:17.243570: E C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:366] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2018-01-12 11:12:17.243585: W C:\\tf_jenkins\\home\\workspace\\rel-win\\M\\windows-gpu\\PY\\36\\tensorflow\\stream_executor\\stream.cc:1756] attempting to perform BLAS operation using StreamExecutor without BLAS support\r\n```\r\n\r\nMy apology, should I write a new issue?\r\nThank you\r\n\r\n"}