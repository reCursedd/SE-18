{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14818", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14818/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14818/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14818/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14818", "id": 276255170, "node_id": "MDU6SXNzdWUyNzYyNTUxNzA=", "number": 14818, "title": "Error when setting model_dir for tf.keras.estimator.estimator_from_model()", "user": {"login": "droidicus", "id": 6981482, "node_id": "MDQ6VXNlcjY5ODE0ODI=", "avatar_url": "https://avatars2.githubusercontent.com/u/6981482?v=4", "gravatar_id": "", "url": "https://api.github.com/users/droidicus", "html_url": "https://github.com/droidicus", "followers_url": "https://api.github.com/users/droidicus/followers", "following_url": "https://api.github.com/users/droidicus/following{/other_user}", "gists_url": "https://api.github.com/users/droidicus/gists{/gist_id}", "starred_url": "https://api.github.com/users/droidicus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/droidicus/subscriptions", "organizations_url": "https://api.github.com/users/droidicus/orgs", "repos_url": "https://api.github.com/users/droidicus/repos", "events_url": "https://api.github.com/users/droidicus/events{/privacy}", "received_events_url": "https://api.github.com/users/droidicus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2017-11-23T02:59:12Z", "updated_at": "2017-11-30T23:55:36Z", "closed_at": "2017-11-30T23:55:36Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: tf.VERSION = 1.4.0 tf.GIT_VERSION = v1.4.0-rc1-11-g130a514</li>\n<li><strong>Python version</strong>: 2.7.12</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: 8.0.61/6.0.21</li>\n<li><strong>GPU model and memory</strong>: NVIDIA Tesla M60 8 GB</li>\n<li><strong>Exact command to reproduce</strong>: See Below</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When trying to use an estimator that is derived from <code>tf.keras.estimator.estimator_from_model()</code> and training with <code>tf.estimator.train_and_evaluate()</code>, setting <code>model_dir</code> either in the <code>RunConfig</code> or in <code>tf.keras.estimator.model_to_estimator</code> causes a <code>NotFoundError</code> to be thrown. If the model_dir is not set, then a tmp directory is used as expected and the training is completed successfully.</p>\n<p>I also tested this with the canned estimator <code>tf.estimator.DNNRegressor</code>, and the settings were applied as expected when the RunConfig was passed to the estimator or the model_dir passed to the estimator directly.</p>\n<p>Below is code to demonstrate this issue.</p>\n<h3>Source code / logs</h3>\n<p>Minimal example, NotFoundError is thrown:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> os\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\ntf.logging.set_verbosity(tf.logging.<span class=\"pl-c1\">INFO</span>)\n\ninputs <span class=\"pl-k\">=</span> tf.keras.layers.Input(<span class=\"pl-v\">shape</span><span class=\"pl-k\">=</span>(<span class=\"pl-c1\">10</span>,))\noutputs <span class=\"pl-k\">=</span> tf.keras.layers.Dense(<span class=\"pl-c1\">10</span>)(inputs)\nmodel <span class=\"pl-k\">=</span> tf.keras.models.Model(inputs, outputs)\nmodel.compile(<span class=\"pl-v\">optimizer</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>sgd<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">loss</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>mse<span class=\"pl-pds\">'</span></span>)\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Both of these result in a NotFoundError</span>\nrun_config <span class=\"pl-k\">=</span> tf.estimator.RunConfig(<span class=\"pl-v\">model_dir</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>min_out<span class=\"pl-pds\">'</span></span>)\nest_keras <span class=\"pl-k\">=</span> tf.keras.estimator.model_to_estimator(<span class=\"pl-v\">keras_model</span><span class=\"pl-k\">=</span>model, <span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>run_config)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>est_keras = tf.keras.estimator.model_to_estimator(keras_model=model, model_dir='min_out')</span>\n\ninput_name <span class=\"pl-k\">=</span> model.input_names[<span class=\"pl-c1\">0</span>]\ndata <span class=\"pl-k\">=</span> np.random.rand(<span class=\"pl-c1\">1000</span>,<span class=\"pl-c1\">10</span>).astype(np.float32)\ntrain_input_fn <span class=\"pl-k\">=</span> tf.estimator.inputs.numpy_input_fn({input_name:data}, data, <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>, <span class=\"pl-v\">num_epochs</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>, <span class=\"pl-v\">shuffle</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">False</span>)\n\ntrain_spec <span class=\"pl-k\">=</span> tf.estimator.TrainSpec(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>train_input_fn, <span class=\"pl-v\">max_steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">1000</span>)\neval_spec <span class=\"pl-k\">=</span> tf.estimator.EvalSpec(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>train_input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>)\ntf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)</pre></div>\n<p>Error generated:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-ii\">$</span> python minimal_modeldir.py\n<span class=\"pl-c1\">INFO</span>:tensorflow:Using the Keras model <span class=\"pl-k\">from</span> memory.\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">44.540162</span>: I tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>platform<span class=\"pl-k\">/</span>cpu_feature_guard.cc:<span class=\"pl-c1\">137</span>] Your <span class=\"pl-c1\">CPU</span> supports instructions that this TensorFlow binary was <span class=\"pl-k\">not</span> compiled to use: <span class=\"pl-c1\">SSE4</span>.1 <span class=\"pl-c1\">SSE4</span>.2 <span class=\"pl-c1\">AVX</span> <span class=\"pl-c1\">AVX2</span> <span class=\"pl-c1\">FMA</span>\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">46.525335</span>: I tensorflow<span class=\"pl-k\">/</span>stream_executor<span class=\"pl-k\">/</span>cuda<span class=\"pl-k\">/</span>cuda_gpu_executor.cc:<span class=\"pl-c1\">892</span>] successful <span class=\"pl-c1\">NUMA</span> node read <span class=\"pl-k\">from</span> SysFS had negative value (<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>), but there must be at least one <span class=\"pl-c1\">NUMA</span> node, so returning <span class=\"pl-c1\">NUMA</span> node zero\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">46.525573</span>: I tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>common_runtime<span class=\"pl-k\">/</span>gpu<span class=\"pl-k\">/</span>gpu_device.cc:<span class=\"pl-c1\">1030</span>] Found device <span class=\"pl-c1\">0</span> <span class=\"pl-k\">with</span> properties:\nname: Tesla M60 major: <span class=\"pl-c1\">5</span> minor: <span class=\"pl-c1\">2</span> memoryClockRate(GHz): <span class=\"pl-c1\">1.1775</span>\npciBusID: <span class=\"pl-c1\">0000</span>:<span class=\"pl-c1\">00</span>:<span class=\"pl-ii\">1e</span>.0\ntotalMemory: <span class=\"pl-c1\">7.</span><span class=\"pl-ii\">43GiB</span> freeMemory: <span class=\"pl-c1\">7.</span><span class=\"pl-ii\">35GiB</span>\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">46.525595</span>: I tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>common_runtime<span class=\"pl-k\">/</span>gpu<span class=\"pl-k\">/</span>gpu_device.cc:<span class=\"pl-c1\">1120</span>] Creating TensorFlow device (<span class=\"pl-k\">/</span>device:<span class=\"pl-c1\">GPU</span>:<span class=\"pl-c1\">0</span>) <span class=\"pl-ii\">-&gt;</span> (device: <span class=\"pl-c1\">0</span>, name: Tesla M60, pci bus <span class=\"pl-c1\">id</span>: <span class=\"pl-c1\">0000</span>:<span class=\"pl-c1\">00</span>:<span class=\"pl-ii\">1e</span>.0, compute capability: <span class=\"pl-c1\">5.2</span>)\n<span class=\"pl-c1\">INFO</span>:tensorflow:Using config: {<span class=\"pl-s\"><span class=\"pl-pds\">'</span>_save_checkpoints_secs<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">600</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_session_config<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">None</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_keep_checkpoint_max<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">5</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_tf_random_seed<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">None</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_task_type<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>worker<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_is_chief<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">True</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_cluster_spec<span class=\"pl-pds\">'</span></span>: <span class=\"pl-k\">&lt;</span>tensorflow.python.training.server_lib.ClusterSpec <span class=\"pl-c1\">object</span> at <span class=\"pl-c1\"><span class=\"pl-k\">0x</span>7fa7fe724890</span><span class=\"pl-k\">&gt;</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_model_dir<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>min_out<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_num_worker_replicas<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">1</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_task_id<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">0</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_log_step_count_steps<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">100</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_master<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_save_checkpoints_steps<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">None</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_keep_checkpoint_every_n_hours<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">10000</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_service<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">None</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_save_summary_steps<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">100</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>_num_ps_replicas<span class=\"pl-pds\">'</span></span>: <span class=\"pl-c1\">0</span>}\n<span class=\"pl-c1\">INFO</span>:tensorflow:Running training <span class=\"pl-k\">and</span> evaluation locally (non<span class=\"pl-k\">-</span>distributed).\n<span class=\"pl-c1\">INFO</span>:tensorflow:Start train <span class=\"pl-k\">and</span> evaluate loop. The evaluate will happen after <span class=\"pl-c1\">600</span> secs (eval_spec.throttle_secs) <span class=\"pl-k\">or</span> training <span class=\"pl-k\">is</span> finished.\n<span class=\"pl-c1\">INFO</span>:tensorflow:Create CheckpointSaverHook.\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.048052</span>: I tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>common_runtime<span class=\"pl-k\">/</span>gpu<span class=\"pl-k\">/</span>gpu_device.cc:<span class=\"pl-c1\">1120</span>] Creating TensorFlow device (<span class=\"pl-k\">/</span>device:<span class=\"pl-c1\">GPU</span>:<span class=\"pl-c1\">0</span>) <span class=\"pl-ii\">-&gt;</span> (device: <span class=\"pl-c1\">0</span>, name: Tesla M60, pci bus <span class=\"pl-c1\">id</span>: <span class=\"pl-c1\">0000</span>:<span class=\"pl-c1\">00</span>:<span class=\"pl-ii\">1e</span>.0, compute capability: <span class=\"pl-c1\">5.2</span>)\n<span class=\"pl-c1\">INFO</span>:tensorflow:Restoring parameters <span class=\"pl-k\">from</span> min_out<span class=\"pl-k\">/</span>model.ckpt<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.076405</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key dense_1<span class=\"pl-k\">/</span>kernel <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.079173</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key <span class=\"pl-c1\">SGD</span><span class=\"pl-k\">/</span>iterations <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.079637</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key dense_1<span class=\"pl-k\">/</span>kernel <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n         [[Node: save<span class=\"pl-k\">/</span>RestoreV2_5 = RestoreV2[dtypes=[<span class=\"pl-c1\">DT_FLOAT</span>], _device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:CPU:0<span class=\"pl-pds\">\"</span></span>](_arg_save<span class=\"pl-k\">/</span>Const_0_0, save<span class=\"pl-k\">/</span>RestoreV2_5<span class=\"pl-k\">/</span>tensor_names, save<span class=\"pl-k\">/</span>RestoreV2_5<span class=\"pl-k\">/</span>shape_and_slices)]]\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.080045</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key <span class=\"pl-c1\">SGD</span><span class=\"pl-k\">/</span>lr <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.080601</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key <span class=\"pl-c1\">SGD</span><span class=\"pl-k\">/</span>decay <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.081693</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key dense_1<span class=\"pl-k\">/</span>bias <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.081871</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key training<span class=\"pl-k\">/</span><span class=\"pl-c1\">SGD</span><span class=\"pl-k\">/</span>Variable <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.082097</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key <span class=\"pl-c1\">SGD</span><span class=\"pl-k\">/</span>momentum <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n<span class=\"pl-c1\">2017</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">11</span><span class=\"pl-k\">-</span><span class=\"pl-c1\">22</span> <span class=\"pl-c1\">21</span>:<span class=\"pl-c1\">40</span>:<span class=\"pl-c1\">47.082403</span>: W tensorflow<span class=\"pl-k\">/</span>core<span class=\"pl-k\">/</span>framework<span class=\"pl-k\">/</span>op_kernel.cc:<span class=\"pl-c1\">1192</span>] Not found: Key training<span class=\"pl-k\">/</span><span class=\"pl-c1\">SGD</span><span class=\"pl-k\">/</span>Variable_1 <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>minimal_modeldir.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">23</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    tf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">430</span>, <span class=\"pl-k\">in</span> train_and_evaluate\n    executor.run_local()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">609</span>, <span class=\"pl-k\">in</span> run_local\n    hooks<span class=\"pl-k\">=</span>train_hooks)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">302</span>, <span class=\"pl-k\">in</span> train\n    loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._train_model(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">780</span>, <span class=\"pl-k\">in</span> _train_model\n    log_step_count_steps<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._config.log_step_count_steps) <span class=\"pl-k\">as</span> mon_sess:\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">368</span>, <span class=\"pl-k\">in</span> MonitoredTrainingSession\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">673</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">493</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    <span class=\"pl-c1\">self</span>._sess <span class=\"pl-k\">=</span> _RecoverableSession(<span class=\"pl-c1\">self</span>._coordinated_creator)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">851</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    _WrappedSession.<span class=\"pl-c1\">__init__</span>(<span class=\"pl-c1\">self</span>, <span class=\"pl-c1\">self</span>._create_session())\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">856</span>, <span class=\"pl-k\">in</span> _create_session\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._sess_creator.create_session()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">554</span>, <span class=\"pl-k\">in</span> create_session\n    <span class=\"pl-c1\">self</span>.tf_sess <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._session_creator.create_session()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">428</span>, <span class=\"pl-k\">in</span> create_session\n    init_fn<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._scaffold.init_fn)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">273</span>, <span class=\"pl-k\">in</span> prepare_session\n    config<span class=\"pl-k\">=</span>config)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">205</span>, <span class=\"pl-k\">in</span> _restore_checkpoint\n    saver.restore(sess, ckpt.model_checkpoint_path)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1666</span>, <span class=\"pl-k\">in</span> restore\n    {<span class=\"pl-c1\">self</span>.saver_def.filename_tensor_name: save_path})\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">889</span>, <span class=\"pl-k\">in</span> run\n    run_metadata_ptr)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1120</span>, <span class=\"pl-k\">in</span> _run\n    feed_dict_tensor, options, run_metadata)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1317</span>, <span class=\"pl-k\">in</span> _do_run\n    options, run_metadata)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1336</span>, <span class=\"pl-k\">in</span> _do_call\n    <span class=\"pl-k\">raise</span> <span class=\"pl-c1\">type</span>(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.NotFoundError: Key dense_1<span class=\"pl-k\">/</span>kernel <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n         [[Node: save<span class=\"pl-k\">/</span>RestoreV2_5 = RestoreV2[dtypes=[<span class=\"pl-c1\">DT_FLOAT</span>], _device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:CPU:0<span class=\"pl-pds\">\"</span></span>](_arg_save<span class=\"pl-k\">/</span>Const_0_0, save<span class=\"pl-k\">/</span>RestoreV2_5<span class=\"pl-k\">/</span>tensor_names, save<span class=\"pl-k\">/</span>RestoreV2_5<span class=\"pl-k\">/</span>shape_and_slices)]]\n         [[Node: save<span class=\"pl-k\">/</span>RestoreV2_2<span class=\"pl-k\">/</span>_9 = _Recv[client_terminated=false, recv_device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:GPU:0<span class=\"pl-pds\">\"</span></span>, send_device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:CPU:0<span class=\"pl-pds\">\"</span></span>, send_device_incarnation=<span class=\"pl-c1\">1</span>, tensor_name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>edge_30_save/RestoreV2_2<span class=\"pl-pds\">\"</span></span>, tensor_type=<span class=\"pl-c1\">DT_FLOAT</span>, _device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:GPU:0<span class=\"pl-pds\">\"</span></span>]()]]\n\nCaused by op <span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>save/RestoreV2_5<span class=\"pl-pds\">'</span></span>, defined at:\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>minimal_modeldir.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">23</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    tf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">430</span>, <span class=\"pl-k\">in</span> train_and_evaluate\n    executor.run_local()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">609</span>, <span class=\"pl-k\">in</span> run_local\n    hooks<span class=\"pl-k\">=</span>train_hooks)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">302</span>, <span class=\"pl-k\">in</span> train\n    loss <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._train_model(input_fn, hooks, saving_listeners)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">780</span>, <span class=\"pl-k\">in</span> _train_model\n    log_step_count_steps<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._config.log_step_count_steps) <span class=\"pl-k\">as</span> mon_sess:\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">368</span>, <span class=\"pl-k\">in</span> MonitoredTrainingSession\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">673</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    stop_grace_period_secs<span class=\"pl-k\">=</span>stop_grace_period_secs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">493</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    <span class=\"pl-c1\">self</span>._sess <span class=\"pl-k\">=</span> _RecoverableSession(<span class=\"pl-c1\">self</span>._coordinated_creator)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">851</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    _WrappedSession.<span class=\"pl-c1\">__init__</span>(<span class=\"pl-c1\">self</span>, <span class=\"pl-c1\">self</span>._create_session())\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">856</span>, <span class=\"pl-k\">in</span> _create_session\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">self</span>._sess_creator.create_session()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">554</span>, <span class=\"pl-k\">in</span> create_session\n    <span class=\"pl-c1\">self</span>.tf_sess <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._session_creator.create_session()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">419</span>, <span class=\"pl-k\">in</span> create_session\n    <span class=\"pl-c1\">self</span>._scaffold.finalize()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">212</span>, <span class=\"pl-k\">in</span> finalize\n    <span class=\"pl-c1\">self</span>._saver.build()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1227</span>, <span class=\"pl-k\">in</span> build\n    <span class=\"pl-c1\">self</span>._build(<span class=\"pl-c1\">self</span>._filename, <span class=\"pl-v\">build_save</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>, <span class=\"pl-v\">build_restore</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1263</span>, <span class=\"pl-k\">in</span> _build\n    build_save<span class=\"pl-k\">=</span>build_save, build_restore<span class=\"pl-k\">=</span>build_restore)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">745</span>, <span class=\"pl-k\">in</span> _build_internal\n    restore_sequentially, reshape)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">470</span>, <span class=\"pl-k\">in</span> _AddShardedRestoreOps\n    name<span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>restore_shard<span class=\"pl-pds\">\"</span></span>))\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">427</span>, <span class=\"pl-k\">in</span> _AddRestoreOps\n    tensors <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>.restore_op(filename_tensor, saveable, preferred_shard)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">267</span>, <span class=\"pl-k\">in</span> restore_op\n    [spec.tensor.dtype])[<span class=\"pl-c1\">0</span>])\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1021</span>, <span class=\"pl-k\">in</span> restore_v2\n    shape_and_slices<span class=\"pl-k\">=</span>shape_and_slices, dtypes<span class=\"pl-k\">=</span>dtypes, name<span class=\"pl-k\">=</span>name)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">787</span>, <span class=\"pl-k\">in</span> _apply_op_helper\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">2956</span>, <span class=\"pl-k\">in</span> create_op\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1470</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    <span class=\"pl-c1\">self</span>._traceback <span class=\"pl-k\">=</span> <span class=\"pl-c1\">self</span>._graph._extract_stack()  <span class=\"pl-c\"><span class=\"pl-c\">#</span> pylint: disable=protected-access</span>\n\nNotFoundError (see above <span class=\"pl-k\">for</span> traceback): Key dense_1<span class=\"pl-k\">/</span>kernel <span class=\"pl-k\">not</span> found <span class=\"pl-k\">in</span> checkpoint\n         [[Node: save<span class=\"pl-k\">/</span>RestoreV2_5 = RestoreV2[dtypes=[<span class=\"pl-c1\">DT_FLOAT</span>], _device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:CPU:0<span class=\"pl-pds\">\"</span></span>](_arg_save<span class=\"pl-k\">/</span>Const_0_0, save<span class=\"pl-k\">/</span>RestoreV2_5<span class=\"pl-k\">/</span>tensor_names, save<span class=\"pl-k\">/</span>RestoreV2_5<span class=\"pl-k\">/</span>shape_and_slices)]]\n         [[Node: save<span class=\"pl-k\">/</span>RestoreV2_2<span class=\"pl-k\">/</span>_9 = _Recv[client_terminated=false, recv_device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:GPU:0<span class=\"pl-pds\">\"</span></span>, send_device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:CPU:0<span class=\"pl-pds\">\"</span></span>, send_device_incarnation=<span class=\"pl-c1\">1</span>, tensor_name=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>edge_30_save/RestoreV2_2<span class=\"pl-pds\">\"</span></span>, tensor_type=<span class=\"pl-c1\">DT_FLOAT</span>, _device=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/job:localhost/replica:0/task:0/device:GPU:0<span class=\"pl-pds\">\"</span></span>]()]]</pre></div>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\nTensorFlow installed from (source or binary): binary\nTensorFlow version (use command below): tf.VERSION = 1.4.0 tf.GIT_VERSION = v1.4.0-rc1-11-g130a514\nPython version: 2.7.12\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version: 8.0.61/6.0.21\nGPU model and memory: NVIDIA Tesla M60 8 GB\nExact command to reproduce: See Below\n\nDescribe the problem\nWhen trying to use an estimator that is derived from tf.keras.estimator.estimator_from_model() and training with tf.estimator.train_and_evaluate(), setting model_dir either in the RunConfig or in tf.keras.estimator.model_to_estimator causes a NotFoundError to be thrown. If the model_dir is not set, then a tmp directory is used as expected and the training is completed successfully.\nI also tested this with the canned estimator tf.estimator.DNNRegressor, and the settings were applied as expected when the RunConfig was passed to the estimator or the model_dir passed to the estimator directly.\nBelow is code to demonstrate this issue.\nSource code / logs\nMinimal example, NotFoundError is thrown:\nimport os\nimport numpy as np\nimport tensorflow as tf\n\ntf.logging.set_verbosity(tf.logging.INFO)\n\ninputs = tf.keras.layers.Input(shape=(10,))\noutputs = tf.keras.layers.Dense(10)(inputs)\nmodel = tf.keras.models.Model(inputs, outputs)\nmodel.compile(optimizer='sgd', loss='mse')\n\n# Both of these result in a NotFoundError\nrun_config = tf.estimator.RunConfig(model_dir='min_out')\nest_keras = tf.keras.estimator.model_to_estimator(keras_model=model, config=run_config)\n#est_keras = tf.keras.estimator.model_to_estimator(keras_model=model, model_dir='min_out')\n\ninput_name = model.input_names[0]\ndata = np.random.rand(1000,10).astype(np.float32)\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn({input_name:data}, data, batch_size=10, num_epochs=None, shuffle=False)\n\ntrain_spec = tf.estimator.TrainSpec(input_fn=train_input_fn, max_steps=1000)\neval_spec = tf.estimator.EvalSpec(input_fn=train_input_fn, steps=10)\ntf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\nError generated:\n$ python minimal_modeldir.py\nINFO:tensorflow:Using the Keras model from memory.\n2017-11-22 21:40:44.540162: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA\n2017-11-22 21:40:46.525335: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-11-22 21:40:46.525573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: Tesla M60 major: 5 minor: 2 memoryClockRate(GHz): 1.1775\npciBusID: 0000:00:1e.0\ntotalMemory: 7.43GiB freeMemory: 7.35GiB\n2017-11-22 21:40:46.525595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla M60, pci bus id: 0000:00:1e.0, compute capability: 5.2)\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_tf_random_seed': None, '_task_type': 'worker', '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa7fe724890>, '_model_dir': 'min_out', '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_master': '', '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_save_summary_steps': 100, '_num_ps_replicas': 0}\nINFO:tensorflow:Running training and evaluation locally (non-distributed).\nINFO:tensorflow:Start train and evaluate loop. The evaluate will happen after 600 secs (eval_spec.throttle_secs) or training is finished.\nINFO:tensorflow:Create CheckpointSaverHook.\n2017-11-22 21:40:47.048052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla M60, pci bus id: 0000:00:1e.0, compute capability: 5.2)\nINFO:tensorflow:Restoring parameters from min_out/model.ckpt-1\n2017-11-22 21:40:47.076405: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key dense_1/kernel not found in checkpoint\n2017-11-22 21:40:47.079173: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/iterations not found in checkpoint\n2017-11-22 21:40:47.079637: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key dense_1/kernel not found in checkpoint\n         [[Node: save/RestoreV2_5 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2_5/tensor_names, save/RestoreV2_5/shape_and_slices)]]\n2017-11-22 21:40:47.080045: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/lr not found in checkpoint\n2017-11-22 21:40:47.080601: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/decay not found in checkpoint\n2017-11-22 21:40:47.081693: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key dense_1/bias not found in checkpoint\n2017-11-22 21:40:47.081871: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key training/SGD/Variable not found in checkpoint\n2017-11-22 21:40:47.082097: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/momentum not found in checkpoint\n2017-11-22 21:40:47.082403: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key training/SGD/Variable_1 not found in checkpoint\nTraceback (most recent call last):\n  File \"minimal_modeldir.py\", line 23, in <module>\n    tf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 430, in train_and_evaluate\n    executor.run_local()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 609, in run_local\n    hooks=train_hooks)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 780, in _train_model\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 368, in MonitoredTrainingSession\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 673, in __init__\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 493, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 851, in __init__\n    _WrappedSession.__init__(self, self._create_session())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 856, in _create_session\n    return self._sess_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 554, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 428, in create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 273, in prepare_session\n    config=config)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 205, in _restore_checkpoint\n    saver.restore(sess, ckpt.model_checkpoint_path)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1666, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 889, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1120, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\n    options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.NotFoundError: Key dense_1/kernel not found in checkpoint\n         [[Node: save/RestoreV2_5 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2_5/tensor_names, save/RestoreV2_5/shape_and_slices)]]\n         [[Node: save/RestoreV2_2/_9 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_30_save/RestoreV2_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\n\nCaused by op u'save/RestoreV2_5', defined at:\n  File \"minimal_modeldir.py\", line 23, in <module>\n    tf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 430, in train_and_evaluate\n    executor.run_local()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 609, in run_local\n    hooks=train_hooks)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 780, in _train_model\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 368, in MonitoredTrainingSession\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 673, in __init__\n    stop_grace_period_secs=stop_grace_period_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 493, in __init__\n    self._sess = _RecoverableSession(self._coordinated_creator)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 851, in __init__\n    _WrappedSession.__init__(self, self._create_session())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 856, in _create_session\n    return self._sess_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 554, in create_session\n    self.tf_sess = self._session_creator.create_session()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 419, in create_session\n    self._scaffold.finalize()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 212, in finalize\n    self._saver.build()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1227, in build\n    self._build(self._filename, build_save=True, build_restore=True)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1263, in _build\n    build_save=build_save, build_restore=build_restore)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 745, in _build_internal\n    restore_sequentially, reshape)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 470, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 427, in _AddRestoreOps\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 267, in restore_op\n    [spec.tensor.dtype])[0])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 1021, in restore_v2\n    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nNotFoundError (see above for traceback): Key dense_1/kernel not found in checkpoint\n         [[Node: save/RestoreV2_5 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2_5/tensor_names, save/RestoreV2_5/shape_and_slices)]]\n         [[Node: save/RestoreV2_2/_9 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_30_save/RestoreV2_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: tf.VERSION = 1.4.0 tf.GIT_VERSION = v1.4.0-rc1-11-g130a514\r\n- **Python version**: 2.7.12\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: 8.0.61/6.0.21\r\n- **GPU model and memory**: NVIDIA Tesla M60 8 GB\r\n- **Exact command to reproduce**: See Below\r\n\r\n### Describe the problem\r\nWhen trying to use an estimator that is derived from ```tf.keras.estimator.estimator_from_model()``` and training with ```tf.estimator.train_and_evaluate()```, setting ```model_dir``` either in the ```RunConfig``` or in ```tf.keras.estimator.model_to_estimator``` causes a ```NotFoundError``` to be thrown. If the model_dir is not set, then a tmp directory is used as expected and the training is completed successfully.\r\n\r\nI also tested this with the canned estimator ```tf.estimator.DNNRegressor```, and the settings were applied as expected when the RunConfig was passed to the estimator or the model_dir passed to the estimator directly.\r\n\r\nBelow is code to demonstrate this issue. \r\n\r\n### Source code / logs\r\nMinimal example, NotFoundError is thrown:\r\n```python\r\nimport os\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\ntf.logging.set_verbosity(tf.logging.INFO)\r\n\r\ninputs = tf.keras.layers.Input(shape=(10,))\r\noutputs = tf.keras.layers.Dense(10)(inputs)\r\nmodel = tf.keras.models.Model(inputs, outputs)\r\nmodel.compile(optimizer='sgd', loss='mse')\r\n\r\n# Both of these result in a NotFoundError\r\nrun_config = tf.estimator.RunConfig(model_dir='min_out')\r\nest_keras = tf.keras.estimator.model_to_estimator(keras_model=model, config=run_config)\r\n#est_keras = tf.keras.estimator.model_to_estimator(keras_model=model, model_dir='min_out')\r\n\r\ninput_name = model.input_names[0]\r\ndata = np.random.rand(1000,10).astype(np.float32)\r\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn({input_name:data}, data, batch_size=10, num_epochs=None, shuffle=False)\r\n\r\ntrain_spec = tf.estimator.TrainSpec(input_fn=train_input_fn, max_steps=1000)\r\neval_spec = tf.estimator.EvalSpec(input_fn=train_input_fn, steps=10)\r\ntf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\r\n```\r\n\r\nError generated:\r\n```python\r\n$ python minimal_modeldir.py\r\nINFO:tensorflow:Using the Keras model from memory.\r\n2017-11-22 21:40:44.540162: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA\r\n2017-11-22 21:40:46.525335: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2017-11-22 21:40:46.525573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\r\nname: Tesla M60 major: 5 minor: 2 memoryClockRate(GHz): 1.1775\r\npciBusID: 0000:00:1e.0\r\ntotalMemory: 7.43GiB freeMemory: 7.35GiB\r\n2017-11-22 21:40:46.525595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla M60, pci bus id: 0000:00:1e.0, compute capability: 5.2)\r\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_tf_random_seed': None, '_task_type': 'worker', '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa7fe724890>, '_model_dir': 'min_out', '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_master': '', '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_save_summary_steps': 100, '_num_ps_replicas': 0}\r\nINFO:tensorflow:Running training and evaluation locally (non-distributed).\r\nINFO:tensorflow:Start train and evaluate loop. The evaluate will happen after 600 secs (eval_spec.throttle_secs) or training is finished.\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\n2017-11-22 21:40:47.048052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla M60, pci bus id: 0000:00:1e.0, compute capability: 5.2)\r\nINFO:tensorflow:Restoring parameters from min_out/model.ckpt-1\r\n2017-11-22 21:40:47.076405: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key dense_1/kernel not found in checkpoint\r\n2017-11-22 21:40:47.079173: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/iterations not found in checkpoint\r\n2017-11-22 21:40:47.079637: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key dense_1/kernel not found in checkpoint\r\n         [[Node: save/RestoreV2_5 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2_5/tensor_names, save/RestoreV2_5/shape_and_slices)]]\r\n2017-11-22 21:40:47.080045: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/lr not found in checkpoint\r\n2017-11-22 21:40:47.080601: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/decay not found in checkpoint\r\n2017-11-22 21:40:47.081693: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key dense_1/bias not found in checkpoint\r\n2017-11-22 21:40:47.081871: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key training/SGD/Variable not found in checkpoint\r\n2017-11-22 21:40:47.082097: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key SGD/momentum not found in checkpoint\r\n2017-11-22 21:40:47.082403: W tensorflow/core/framework/op_kernel.cc:1192] Not found: Key training/SGD/Variable_1 not found in checkpoint\r\nTraceback (most recent call last):\r\n  File \"minimal_modeldir.py\", line 23, in <module>\r\n    tf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 430, in train_and_evaluate\r\n    executor.run_local()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 609, in run_local\r\n    hooks=train_hooks)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 780, in _train_model\r\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 368, in MonitoredTrainingSession\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 673, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 493, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 851, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 856, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 554, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 428, in create_session\r\n    init_fn=self._scaffold.init_fn)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 273, in prepare_session\r\n    config=config)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 205, in _restore_checkpoint\r\n    saver.restore(sess, ckpt.model_checkpoint_path)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1666, in restore\r\n    {self.saver_def.filename_tensor_name: save_path})\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 889, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1120, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\r\n    options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.NotFoundError: Key dense_1/kernel not found in checkpoint\r\n         [[Node: save/RestoreV2_5 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2_5/tensor_names, save/RestoreV2_5/shape_and_slices)]]\r\n         [[Node: save/RestoreV2_2/_9 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_30_save/RestoreV2_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\r\n\r\nCaused by op u'save/RestoreV2_5', defined at:\r\n  File \"minimal_modeldir.py\", line 23, in <module>\r\n    tf.estimator.train_and_evaluate(est_keras, train_spec, eval_spec)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 430, in train_and_evaluate\r\n    executor.run_local()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 609, in run_local\r\n    hooks=train_hooks)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 780, in _train_model\r\n    log_step_count_steps=self._config.log_step_count_steps) as mon_sess:\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 368, in MonitoredTrainingSession\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 673, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 493, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 851, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 856, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 554, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 419, in create_session\r\n    self._scaffold.finalize()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 212, in finalize\r\n    self._saver.build()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1227, in build\r\n    self._build(self._filename, build_save=True, build_restore=True)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1263, in _build\r\n    build_save=build_save, build_restore=build_restore)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 745, in _build_internal\r\n    restore_sequentially, reshape)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 470, in _AddShardedRestoreOps\r\n    name=\"restore_shard\"))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 427, in _AddRestoreOps\r\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 267, in restore_op\r\n    [spec.tensor.dtype])[0])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 1021, in restore_v2\r\n    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nNotFoundError (see above for traceback): Key dense_1/kernel not found in checkpoint\r\n         [[Node: save/RestoreV2_5 = RestoreV2[dtypes=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2_5/tensor_names, save/RestoreV2_5/shape_and_slices)]]\r\n         [[Node: save/RestoreV2_2/_9 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_30_save/RestoreV2_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\r\n```\r\n"}