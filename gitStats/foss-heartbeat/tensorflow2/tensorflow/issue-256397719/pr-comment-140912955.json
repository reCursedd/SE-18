{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/140912955", "pull_request_review_id": 65052389, "id": 140912955, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0MDkxMjk1NQ==", "diff_hunk": "@@ -46,9 +53,99 @@\n  * example usage.\n  */\n public class TensorFlowInferenceInterface {\n-  private static final String TAG = \"TensorFlowInferenceInterface\";\n+  private static final String TAG = \"TensorFlowInferenceInt\";\n   private static final String ASSET_FILE_PREFIX = \"file:///android_asset/\";\n \n+  /**\n+   * Copies raw resource to a cache file.\n+   *\n+   * @return File reference to cache file.\n+   */\n+  private File createCacheFile(Context context, int resourceId, String filename)\n+      throws IOException {\n+    File cacheFile = new File(context.getCacheDir(), filename);\n+\n+    if (cacheFile.createNewFile() == false) {", "path": "tensorflow/contrib/android/java/org/tensorflow/contrib/android/TensorFlowInferenceInterface.java", "position": 41, "original_position": 46, "commit_id": "6cd443476753209accef4f1f0e6c89f04ac5166d", "original_commit_id": "4b12af447a8b57987a3cba434fb2ac149ce038cf", "user": {"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}, "body": "My major reservation is that this commit only seems to speed up loading from res. It might be nice to support this functionality, but up until this point we've suggested assets/ as the place to place pb files. So it will be a bit more difficult for users to switch to the new method, and possibly confuse things unless well documented. How much faster is it actually to copy from res? Also, why does it give you an OOM error when mapping from the cache dir, but not from assets/?\r\n\r\nIt should be possible to mmap files directly from assets with the nocompressextensions directive in bazel. In which case the copy is not even necessary. Can you tell if this is the case?", "created_at": "2017-09-25T22:12:16Z", "updated_at": "2017-09-25T22:12:16Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/12922#discussion_r140912955", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/12922", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/140912955"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/12922#discussion_r140912955"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/12922"}}, "body_html": "<p>My major reservation is that this commit only seems to speed up loading from res. It might be nice to support this functionality, but up until this point we've suggested assets/ as the place to place pb files. So it will be a bit more difficult for users to switch to the new method, and possibly confuse things unless well documented. How much faster is it actually to copy from res? Also, why does it give you an OOM error when mapping from the cache dir, but not from assets/?</p>\n<p>It should be possible to mmap files directly from assets with the nocompressextensions directive in bazel. In which case the copy is not even necessary. Can you tell if this is the case?</p>", "body_text": "My major reservation is that this commit only seems to speed up loading from res. It might be nice to support this functionality, but up until this point we've suggested assets/ as the place to place pb files. So it will be a bit more difficult for users to switch to the new method, and possibly confuse things unless well documented. How much faster is it actually to copy from res? Also, why does it give you an OOM error when mapping from the cache dir, but not from assets/?\nIt should be possible to mmap files directly from assets with the nocompressextensions directive in bazel. In which case the copy is not even necessary. Can you tell if this is the case?", "in_reply_to_id": 139271759}