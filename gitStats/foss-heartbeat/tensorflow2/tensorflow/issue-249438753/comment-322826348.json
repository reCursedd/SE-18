{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/322826348", "html_url": "https://github.com/tensorflow/tensorflow/issues/12186#issuecomment-322826348", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12186", "id": 322826348, "node_id": "MDEyOklzc3VlQ29tbWVudDMyMjgyNjM0OA==", "user": {"login": "tfboyd", "id": 23486130, "node_id": "MDQ6VXNlcjIzNDg2MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/23486130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfboyd", "html_url": "https://github.com/tfboyd", "followers_url": "https://api.github.com/users/tfboyd/followers", "following_url": "https://api.github.com/users/tfboyd/following{/other_user}", "gists_url": "https://api.github.com/users/tfboyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfboyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfboyd/subscriptions", "organizations_url": "https://api.github.com/users/tfboyd/orgs", "repos_url": "https://api.github.com/users/tfboyd/repos", "events_url": "https://api.github.com/users/tfboyd/events{/privacy}", "received_events_url": "https://api.github.com/users/tfboyd/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-16T16:27:03Z", "updated_at": "2017-08-16T16:27:03Z", "author_association": "MEMBER", "body_html": "<p>I think your config is still not correct but with out the debug info I do not know.  In your first post your passed BLOCK_TIME=2 but the config printed BLOCK_TIME=20  Please share the entire output and make sure to print out the MKL configs.   I should have included the print config in the command.</p>\n<p>If I had to make an educated guess I would guess with synthetic data: 60-100 images/sec.  22 images/sec suggests something is wrong as I get that with 2xBroadwell.   Intel was getting ~60 images/sec with VGG (not sure how many layers so that is a bit of an unknown) but that is is informing my guess.</p>\n<p>I am happy to keep helping but I need a few things.</p>\n<ul>\n<li>Make sure set_envars.py (my last comment linked the line to remove) is not being called, that is overwriting your env variables from the commandline</li>\n<li>include the full console logs and make sure to set <code>KMP_SETTINGS=1</code></li>\n</ul>\n<p>On the plus side if you figure this out you will be familiar with the important  MKL environment variables.</p>", "body_text": "I think your config is still not correct but with out the debug info I do not know.  In your first post your passed BLOCK_TIME=2 but the config printed BLOCK_TIME=20  Please share the entire output and make sure to print out the MKL configs.   I should have included the print config in the command.\nIf I had to make an educated guess I would guess with synthetic data: 60-100 images/sec.  22 images/sec suggests something is wrong as I get that with 2xBroadwell.   Intel was getting ~60 images/sec with VGG (not sure how many layers so that is a bit of an unknown) but that is is informing my guess.\nI am happy to keep helping but I need a few things.\n\nMake sure set_envars.py (my last comment linked the line to remove) is not being called, that is overwriting your env variables from the commandline\ninclude the full console logs and make sure to set KMP_SETTINGS=1\n\nOn the plus side if you figure this out you will be familiar with the important  MKL environment variables.", "body": "I think your config is still not correct but with out the debug info I do not know.  In your first post your passed BLOCK_TIME=2 but the config printed BLOCK_TIME=20  Please share the entire output and make sure to print out the MKL configs.   I should have included the print config in the command.  \r\n\r\nIf I had to make an educated guess I would guess with synthetic data: 60-100 images/sec.  22 images/sec suggests something is wrong as I get that with 2xBroadwell.   Intel was getting ~60 images/sec with VGG (not sure how many layers so that is a bit of an unknown) but that is is informing my guess.  \r\n\r\nI am happy to keep helping but I need a few things.  \r\n- Make sure set_envars.py (my last comment linked the line to remove) is not being called, that is overwriting your env variables from the commandline\r\n- include the full console logs and make sure to set `KMP_SETTINGS=1`\r\n\r\nOn the plus side if you figure this out you will be familiar with the important  MKL environment variables.\r\n\r\n\r\n\r\n\r\n"}