{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/369648622", "html_url": "https://github.com/tensorflow/tensorflow/pull/17338#issuecomment-369648622", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17338", "id": 369648622, "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTY0ODYyMg==", "user": {"login": "alanhdu", "id": 1914111, "node_id": "MDQ6VXNlcjE5MTQxMTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1914111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanhdu", "html_url": "https://github.com/alanhdu", "followers_url": "https://api.github.com/users/alanhdu/followers", "following_url": "https://api.github.com/users/alanhdu/following{/other_user}", "gists_url": "https://api.github.com/users/alanhdu/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanhdu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanhdu/subscriptions", "organizations_url": "https://api.github.com/users/alanhdu/orgs", "repos_url": "https://api.github.com/users/alanhdu/repos", "events_url": "https://api.github.com/users/alanhdu/events{/privacy}", "received_events_url": "https://api.github.com/users/alanhdu/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-01T16:29:50Z", "updated_at": "2018-03-01T16:30:34Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5117188\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/protoget\">@protoget</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6510203\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/reedwm\">@reedwm</a> I have tested that this PR works as expected. <code>tf.nn.conv1d</code> handles that conversion:</p>\n<p><div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/6fdb9ad1baf7686a75f9e660178f7ac595e7fc2e/tensorflow/python/ops/nn_ops.py#L2428-L2435\">tensorflow/tensorflow/python/ops/nn_ops.py</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n        Lines 2428 to 2435\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/6fdb9ad1baf7686a75f9e660178f7ac595e7fc2e\">6fdb9ad</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L2428\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2428\"></td>\n          <td id=\"LC2428\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">if</span> data_format <span class=\"pl-k\">is</span> <span class=\"pl-c1\">None</span> <span class=\"pl-k\">or</span> data_format <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NHWC<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">or</span> data_format <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NWC<span class=\"pl-pds\">\"</span></span>: </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2429\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2429\"></td>\n          <td id=\"LC2429\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   data_format <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NHWC<span class=\"pl-pds\">\"</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2430\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2430\"></td>\n          <td id=\"LC2430\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   spatial_start_dim <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2431\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2431\"></td>\n          <td id=\"LC2431\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   strides <span class=\"pl-k\">=</span> [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, stride, <span class=\"pl-c1\">1</span>] </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2432\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2432\"></td>\n          <td id=\"LC2432\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">elif</span> data_format <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NCHW<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">or</span> data_format <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NCW<span class=\"pl-pds\">\"</span></span>: </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2433\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2433\"></td>\n          <td id=\"LC2433\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   data_format <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>NCHW<span class=\"pl-pds\">\"</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2434\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2434\"></td>\n          <td id=\"LC2434\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   spatial_start_dim <span class=\"pl-k\">=</span> <span class=\"pl-c1\">2</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L2435\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"2435\"></td>\n          <td id=\"LC2435\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\">   strides <span class=\"pl-k\">=</span> [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, stride] </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p><code>NCHW</code> and <code>NHWC</code> are explicitly deprecated, so as-is <code>tf.layers.conv1d</code> (which uses the function I'm modifying) raises a deprecation warning no matter what you do.</p>", "body_text": "@protoget @reedwm I have tested that this PR works as expected. tf.nn.conv1d handles that conversion:\n\n  \n    \n      tensorflow/tensorflow/python/ops/nn_ops.py\n    \n    \n        Lines 2428 to 2435\n      in\n      6fdb9ad\n    \n    \n    \n    \n\n        \n          \n           if data_format is None or data_format == \"NHWC\" or data_format == \"NWC\": \n        \n\n        \n          \n             data_format = \"NHWC\" \n        \n\n        \n          \n             spatial_start_dim = 1 \n        \n\n        \n          \n             strides = [1, 1, stride, 1] \n        \n\n        \n          \n           elif data_format == \"NCHW\" or data_format == \"NCW\": \n        \n\n        \n          \n             data_format = \"NCHW\" \n        \n\n        \n          \n             spatial_start_dim = 2 \n        \n\n        \n          \n             strides = [1, 1, 1, stride] \n        \n    \n  \n\n\nNCHW and NHWC are explicitly deprecated, so as-is tf.layers.conv1d (which uses the function I'm modifying) raises a deprecation warning no matter what you do.", "body": "@protoget @reedwm I have tested that this PR works as expected. `tf.nn.conv1d` handles that conversion:\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/6fdb9ad1baf7686a75f9e660178f7ac595e7fc2e/tensorflow/python/ops/nn_ops.py#L2428-L2435\r\n\r\n`NCHW` and `NHWC` are explicitly deprecated, so as-is `tf.layers.conv1d` (which uses the function I'm modifying) raises a deprecation warning no matter what you do.\r\n\r\n"}