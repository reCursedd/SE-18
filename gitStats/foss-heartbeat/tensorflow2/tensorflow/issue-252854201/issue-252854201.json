{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12593", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12593/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12593/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12593/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12593", "id": 252854201, "node_id": "MDU6SXNzdWUyNTI4NTQyMDE=", "number": 12593, "title": "Android Demo - Bug - Exception in TF Detect activity", "user": {"login": "rsd-raul", "id": 6963554, "node_id": "MDQ6VXNlcjY5NjM1NTQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/6963554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsd-raul", "html_url": "https://github.com/rsd-raul", "followers_url": "https://api.github.com/users/rsd-raul/followers", "following_url": "https://api.github.com/users/rsd-raul/following{/other_user}", "gists_url": "https://api.github.com/users/rsd-raul/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsd-raul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsd-raul/subscriptions", "organizations_url": "https://api.github.com/users/rsd-raul/orgs", "repos_url": "https://api.github.com/users/rsd-raul/repos", "events_url": "https://api.github.com/users/rsd-raul/events{/privacy}", "received_events_url": "https://api.github.com/users/rsd-raul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2017-08-25T10:04:11Z", "updated_at": "2017-10-11T20:53:36Z", "closed_at": "2017-09-21T22:03:59Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nAt build.gradle (Module: android)<br>\ndef nativeBuildSystem = 'none'<br>\nAt CameraActivity.java:<br>\nuseCamera2API = true;<br>\nSuggested by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3376817\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrewharp\">@andrewharp</a> at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"251504903\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12431\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12431/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12431\">#12431</a></li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nWindows version: 10 Pro<br>\nAndroid version: 6.0.1<br>\nDemo version: commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/18e45909619643ad6005db26bcb6b08d5f8ff05b/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/18e45909619643ad6005db26bcb6b08d5f8ff05b\"><tt>18e4590</tt></a></li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nx</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\nx</li>\n<li><strong>Python version</strong>:<br>\nx</li>\n<li><strong>Bazel version (if compiling from source)</strong>:<br>\nx</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\nx</li>\n<li><strong>GPU model and memory</strong>:<br>\nx</li>\n<li><strong>Exact command to reproduce</strong>:<br>\nx</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Running the activity TF Detect after installing the project with Android Studio results in an IllegalArgumentException being thrown.</p>\n<p>The problem has been noticed before with other configurations at issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"251504903\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12431\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12431/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12431\">#12431</a> and pull request <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"236547816\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10771\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/10771/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/10771\">#10771</a> and tested recently by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=14268320\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ArtsiomCh\">@ArtsiomCh</a>  using CMake and Ubuntu.</p>\n<h3>Source code / logs</h3>\n<pre><code>08-25 11:46:10.596 9185-9185/? I/art: Late-enabling -Xcheck:jni\n08-25 11:46:10.636 9185-9185/? D/TidaProvider: TidaProvider()\n08-25 11:46:10.722 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onCreate org.tensorflow.demo.DetectorActivity@df7138f\n08-25 11:46:10.749 9185-9185/org.tensorflow.demo I/CameraManagerGlobal: Connecting to camera service\n08-25 11:46:10.784 9185-9185/org.tensorflow.demo I/tensorflow: CameraActivity: Camera API lv2?: true\n08-25 11:46:10.788 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onStart org.tensorflow.demo.DetectorActivity@df7138f\n08-25 11:46:10.788 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onResume org.tensorflow.demo.DetectorActivity@df7138f\n08-25 11:46:10.796 9185-9217/org.tensorflow.demo D/OpenGLRenderer: Use EGL_SWAP_BEHAVIOR_PRESERVED: true\n08-25 11:46:10.801 9185-9185/org.tensorflow.demo D/ActivityThreadInjector: clearCachedDrawables.\n08-25 11:46:10.840 9185-9217/org.tensorflow.demo I/Adreno: QUALCOMM build                   : a7823f5, I59a6815413\n                                                           Build Date                       : 09/23/16\n                                                           OpenGL ES Shader Compiler Version: XE031.07.00.00\n                                                           Local Branch                     : mybranch22028469\n                                                           Remote Branch                    : quic/LA.BR.1.3.3_rb2.26\n                                                           Remote Branch                    : NONE\n                                                           Reconstruct Branch               : NOTHING\n08-25 11:46:10.846 9185-9217/org.tensorflow.demo I/OpenGLRenderer: Initialized EGL, version 1.4\n08-25 11:46:10.858 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Desired size: 640x480, min size: 480x480\n08-25 11:46:10.858 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Valid preview sizes: [1280x960, 1280x720, 864x480, 640x640, 800x480, 720x480, 640x480, 480x640]\n08-25 11:46:10.859 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Rejected preview sizes: [832x468, 768x432, 576x432, 640x360, 480x360, 480x320, 384x288, 352x288, 320x240, 240x320, 240x160, 176x144]\n08-25 11:46:10.859 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Exact size match found.\n08-25 11:46:10.861 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: ???\n08-25 11:46:10.861 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: person\n... Etc.\n08-25 11:46:10.863 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: hair drier\n08-25 11:46:10.863 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: toothbrush\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Checking to see if TensorFlow native methods are already loaded\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo E/art: No implementation found for long org.tensorflow.contrib.android.RunStats.allocate() (tried Java_org_tensorflow_contrib_android_RunStats_allocate and Java_org_tensorflow_contrib_android_RunStats_allocate__)\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: TensorFlow native methods not found, attempting to load via tensorflow_inference\n08-25 11:46:10.896 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Successfully loaded TensorFlow native methods (RunStats error may be ignored)\n08-25 11:46:12.133 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Model load took 1213ms, TensorFlow version: 1.2.0\n08-25 11:46:12.136 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Successfully loaded model from 'file:///android_asset/ssd_mobilenet_v1_android_export.pb'\n08-25 11:46:12.137 9185-9185/org.tensorflow.demo I/tensorflow: DetectorActivity: Sensor orientation: 90, Screen orientation: 0\n08-25 11:46:12.137 9185-9185/org.tensorflow.demo I/tensorflow: DetectorActivity: Initializing at size 640x480\n08-25 11:46:12.139 9185-9185/org.tensorflow.demo W/tensorflow: ImageUtils: Native library not found, native RGB -&gt; YUV conversion may be unavailable.\n08-25 11:46:12.148 9185-9185/org.tensorflow.demo I/CameraManager: Using legacy camera HAL.\n08-25 11:46:12.280 9185-9216/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Opening camera preview: 640x480\n08-25 11:46:12.285 9185-9216/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state CONFIGURING\n08-25 11:46:12.286 9185-9217/org.tensorflow.demo E/HAL: hw_get_module_by_class: module name gralloc\n08-25 11:46:12.286 9185-9290/org.tensorflow.demo I/RequestThread-0: Configure outputs: 2 surfaces configured.\n08-25 11:46:12.286 9185-9217/org.tensorflow.demo E/HAL: hw_get_module_by_class: module name gralloc\n08-25 11:46:12.286 9185-9290/org.tensorflow.demo D/Camera: app passed NULL surface\n08-25 11:46:12.297 9185-9185/org.tensorflow.demo I/Choreographer: Skipped 85 frames!  The application may be doing too much work on its main thread.\n08-25 11:46:12.309 9185-9216/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state IDLE\n08-25 11:46:12.313 9185-9216/org.tensorflow.demo I/RequestQueue: Repeating capture request set.\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: convertRequestMetadata - control.awbRegions setting is not supported, ignoring value\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: Only received metering rectangles with weight 0.\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: Only received metering rectangles with weight 0.\n08-25 11:46:12.493 9185-9291/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state CAPTURING\n08-25 11:46:12.515 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 0 at size 307200\n08-25 11:46:12.516 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 1 at size 153599\n08-25 11:46:12.516 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 2 at size 153599\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo E/tensorflow: ObjectTracker: libtensorflow_demo.so not found, tracking unavailable\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo I/tensorflow: MultiBoxTracker: Initializing ObjectTracker: 640x480\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo E/tensorflow: ObjectTracker: Native object tracking support not found. See tensorflow/examples/android/README.md for details.\n08-25 11:46:12.525 9185-9216/org.tensorflow.demo E/tensorflow: MultiBoxTracker: Object tracking support not found. See tensorflow/examples/android/README.md for details.\n08-25 11:46:12.544 9185-9216/org.tensorflow.demo E/art: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420ToARGB8888(byte[], byte[], byte[], int[], int, int, int, int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420ToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420ToARGB8888___3B_3B_3B_3IIIIIIZ)\n08-25 11:46:12.545 9185-9216/org.tensorflow.demo W/tensorflow: ImageUtils: Native YUV -&gt; RGB implementation not found, falling back to Java implementation\n08-25 11:46:12.717 9185-9217/org.tensorflow.demo V/RenderScript: 0x558f6c1290 Launching thread(s), CPUs 6\n08-25 11:46:13.060 9185-9215/org.tensorflow.demo E/TensorFlowInferenceInterface: Failed to run TensorFlow inference with inputs:[image_tensor], outputs:[detection_boxes, detection_scores, detection_classes, num_detections]\n                                                                                 \n                                                                                 --------- beginning of crash\n08-25 11:46:13.060 9185-9215/org.tensorflow.demo E/AndroidRuntime: FATAL EXCEPTION: inference\n                                                                   Process: org.tensorflow.demo, PID: 9185\n                                                                   java.lang.IllegalArgumentException: No OpKernel was registered to support Op 'Switch' with these attrs.  Registered devices: [CPU], Registered kernels:\n                                                                     device='CPU'; T in [DT_FLOAT]\n                                                                     device='CPU'; T in [DT_INT32]\n                                                                     device='GPU'; T in [DT_STRING]\n                                                                     device='GPU'; T in [DT_BOOL]\n                                                                     device='GPU'; T in [DT_INT32]\n                                                                     device='GPU'; T in [DT_FLOAT]\n                                                                   \n                                                                   \t [[Node: Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/cond/Switch = Switch[T=DT_BOOL](Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/Greater, Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/Greater)]]\n                                                                       at org.tensorflow.Session.run(Native Method)\n                                                                       at org.tensorflow.Session.access$100(Session.java:48)\n                                                                       at org.tensorflow.Session$Runner.runHelper(Session.java:295)\n                                                                       at org.tensorflow.Session$Runner.run(Session.java:245)\n                                                                       at org.tensorflow.contrib.android.TensorFlowInferenceInterface.run(TensorFlowInferenceInterface.java:142)\n                                                                       at org.tensorflow.demo.TensorFlowObjectDetectionAPIModel.recognizeImage(TensorFlowObjectDetectionAPIModel.java:158)\n                                                                       at org.tensorflow.demo.DetectorActivity$3.run(DetectorActivity.java:340)\n                                                                       at android.os.Handler.handleCallback(Handler.java:742)\n                                                                       at android.os.Handler.dispatchMessage(Handler.java:95)\n                                                                       at android.os.Looper.loop(Looper.java:154)\n                                                                       at android.os.HandlerThread.run(HandlerThread.java:61)\n08-25 11:46:13.061 9185-9215/org.tensorflow.demo E/MQSEventManagerDelegate: failed to get MQSService.\n08-25 11:46:13.080 9185-9185/org.tensorflow.demo I/RequestQueue: Repeating capture request cancelled.\n08-25 11:46:13.194 9185-9327/org.tensorflow.demo E/BufferQueueProducer: [SurfaceTexture-1-9185-1] cancelBuffer: BufferQueue has been abandoned\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nAt build.gradle (Module: android)\ndef nativeBuildSystem = 'none'\nAt CameraActivity.java:\nuseCamera2API = true;\nSuggested by @andrewharp at #12431\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nWindows version: 10 Pro\nAndroid version: 6.0.1\nDemo version: commit 18e4590\nTensorFlow installed from (source or binary):\nx\nTensorFlow version (use command below):\nx\nPython version:\nx\nBazel version (if compiling from source):\nx\nCUDA/cuDNN version:\nx\nGPU model and memory:\nx\nExact command to reproduce:\nx\n\nDescribe the problem\nRunning the activity TF Detect after installing the project with Android Studio results in an IllegalArgumentException being thrown.\nThe problem has been noticed before with other configurations at issue #12431 and pull request #10771 and tested recently by @ArtsiomCh  using CMake and Ubuntu.\nSource code / logs\n08-25 11:46:10.596 9185-9185/? I/art: Late-enabling -Xcheck:jni\n08-25 11:46:10.636 9185-9185/? D/TidaProvider: TidaProvider()\n08-25 11:46:10.722 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onCreate org.tensorflow.demo.DetectorActivity@df7138f\n08-25 11:46:10.749 9185-9185/org.tensorflow.demo I/CameraManagerGlobal: Connecting to camera service\n08-25 11:46:10.784 9185-9185/org.tensorflow.demo I/tensorflow: CameraActivity: Camera API lv2?: true\n08-25 11:46:10.788 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onStart org.tensorflow.demo.DetectorActivity@df7138f\n08-25 11:46:10.788 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onResume org.tensorflow.demo.DetectorActivity@df7138f\n08-25 11:46:10.796 9185-9217/org.tensorflow.demo D/OpenGLRenderer: Use EGL_SWAP_BEHAVIOR_PRESERVED: true\n08-25 11:46:10.801 9185-9185/org.tensorflow.demo D/ActivityThreadInjector: clearCachedDrawables.\n08-25 11:46:10.840 9185-9217/org.tensorflow.demo I/Adreno: QUALCOMM build                   : a7823f5, I59a6815413\n                                                           Build Date                       : 09/23/16\n                                                           OpenGL ES Shader Compiler Version: XE031.07.00.00\n                                                           Local Branch                     : mybranch22028469\n                                                           Remote Branch                    : quic/LA.BR.1.3.3_rb2.26\n                                                           Remote Branch                    : NONE\n                                                           Reconstruct Branch               : NOTHING\n08-25 11:46:10.846 9185-9217/org.tensorflow.demo I/OpenGLRenderer: Initialized EGL, version 1.4\n08-25 11:46:10.858 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Desired size: 640x480, min size: 480x480\n08-25 11:46:10.858 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Valid preview sizes: [1280x960, 1280x720, 864x480, 640x640, 800x480, 720x480, 640x480, 480x640]\n08-25 11:46:10.859 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Rejected preview sizes: [832x468, 768x432, 576x432, 640x360, 480x360, 480x320, 384x288, 352x288, 320x240, 240x320, 240x160, 176x144]\n08-25 11:46:10.859 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Exact size match found.\n08-25 11:46:10.861 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: ???\n08-25 11:46:10.861 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: person\n... Etc.\n08-25 11:46:10.863 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: hair drier\n08-25 11:46:10.863 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: toothbrush\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Checking to see if TensorFlow native methods are already loaded\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo E/art: No implementation found for long org.tensorflow.contrib.android.RunStats.allocate() (tried Java_org_tensorflow_contrib_android_RunStats_allocate and Java_org_tensorflow_contrib_android_RunStats_allocate__)\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: TensorFlow native methods not found, attempting to load via tensorflow_inference\n08-25 11:46:10.896 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Successfully loaded TensorFlow native methods (RunStats error may be ignored)\n08-25 11:46:12.133 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Model load took 1213ms, TensorFlow version: 1.2.0\n08-25 11:46:12.136 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Successfully loaded model from 'file:///android_asset/ssd_mobilenet_v1_android_export.pb'\n08-25 11:46:12.137 9185-9185/org.tensorflow.demo I/tensorflow: DetectorActivity: Sensor orientation: 90, Screen orientation: 0\n08-25 11:46:12.137 9185-9185/org.tensorflow.demo I/tensorflow: DetectorActivity: Initializing at size 640x480\n08-25 11:46:12.139 9185-9185/org.tensorflow.demo W/tensorflow: ImageUtils: Native library not found, native RGB -> YUV conversion may be unavailable.\n08-25 11:46:12.148 9185-9185/org.tensorflow.demo I/CameraManager: Using legacy camera HAL.\n08-25 11:46:12.280 9185-9216/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Opening camera preview: 640x480\n08-25 11:46:12.285 9185-9216/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state CONFIGURING\n08-25 11:46:12.286 9185-9217/org.tensorflow.demo E/HAL: hw_get_module_by_class: module name gralloc\n08-25 11:46:12.286 9185-9290/org.tensorflow.demo I/RequestThread-0: Configure outputs: 2 surfaces configured.\n08-25 11:46:12.286 9185-9217/org.tensorflow.demo E/HAL: hw_get_module_by_class: module name gralloc\n08-25 11:46:12.286 9185-9290/org.tensorflow.demo D/Camera: app passed NULL surface\n08-25 11:46:12.297 9185-9185/org.tensorflow.demo I/Choreographer: Skipped 85 frames!  The application may be doing too much work on its main thread.\n08-25 11:46:12.309 9185-9216/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state IDLE\n08-25 11:46:12.313 9185-9216/org.tensorflow.demo I/RequestQueue: Repeating capture request set.\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: convertRequestMetadata - control.awbRegions setting is not supported, ignoring value\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: Only received metering rectangles with weight 0.\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: Only received metering rectangles with weight 0.\n08-25 11:46:12.493 9185-9291/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state CAPTURING\n08-25 11:46:12.515 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 0 at size 307200\n08-25 11:46:12.516 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 1 at size 153599\n08-25 11:46:12.516 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 2 at size 153599\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo E/tensorflow: ObjectTracker: libtensorflow_demo.so not found, tracking unavailable\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo I/tensorflow: MultiBoxTracker: Initializing ObjectTracker: 640x480\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo E/tensorflow: ObjectTracker: Native object tracking support not found. See tensorflow/examples/android/README.md for details.\n08-25 11:46:12.525 9185-9216/org.tensorflow.demo E/tensorflow: MultiBoxTracker: Object tracking support not found. See tensorflow/examples/android/README.md for details.\n08-25 11:46:12.544 9185-9216/org.tensorflow.demo E/art: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420ToARGB8888(byte[], byte[], byte[], int[], int, int, int, int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420ToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420ToARGB8888___3B_3B_3B_3IIIIIIZ)\n08-25 11:46:12.545 9185-9216/org.tensorflow.demo W/tensorflow: ImageUtils: Native YUV -> RGB implementation not found, falling back to Java implementation\n08-25 11:46:12.717 9185-9217/org.tensorflow.demo V/RenderScript: 0x558f6c1290 Launching thread(s), CPUs 6\n08-25 11:46:13.060 9185-9215/org.tensorflow.demo E/TensorFlowInferenceInterface: Failed to run TensorFlow inference with inputs:[image_tensor], outputs:[detection_boxes, detection_scores, detection_classes, num_detections]\n                                                                                 \n                                                                                 --------- beginning of crash\n08-25 11:46:13.060 9185-9215/org.tensorflow.demo E/AndroidRuntime: FATAL EXCEPTION: inference\n                                                                   Process: org.tensorflow.demo, PID: 9185\n                                                                   java.lang.IllegalArgumentException: No OpKernel was registered to support Op 'Switch' with these attrs.  Registered devices: [CPU], Registered kernels:\n                                                                     device='CPU'; T in [DT_FLOAT]\n                                                                     device='CPU'; T in [DT_INT32]\n                                                                     device='GPU'; T in [DT_STRING]\n                                                                     device='GPU'; T in [DT_BOOL]\n                                                                     device='GPU'; T in [DT_INT32]\n                                                                     device='GPU'; T in [DT_FLOAT]\n                                                                   \n                                                                   \t [[Node: Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/cond/Switch = Switch[T=DT_BOOL](Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/Greater, Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/Greater)]]\n                                                                       at org.tensorflow.Session.run(Native Method)\n                                                                       at org.tensorflow.Session.access$100(Session.java:48)\n                                                                       at org.tensorflow.Session$Runner.runHelper(Session.java:295)\n                                                                       at org.tensorflow.Session$Runner.run(Session.java:245)\n                                                                       at org.tensorflow.contrib.android.TensorFlowInferenceInterface.run(TensorFlowInferenceInterface.java:142)\n                                                                       at org.tensorflow.demo.TensorFlowObjectDetectionAPIModel.recognizeImage(TensorFlowObjectDetectionAPIModel.java:158)\n                                                                       at org.tensorflow.demo.DetectorActivity$3.run(DetectorActivity.java:340)\n                                                                       at android.os.Handler.handleCallback(Handler.java:742)\n                                                                       at android.os.Handler.dispatchMessage(Handler.java:95)\n                                                                       at android.os.Looper.loop(Looper.java:154)\n                                                                       at android.os.HandlerThread.run(HandlerThread.java:61)\n08-25 11:46:13.061 9185-9215/org.tensorflow.demo E/MQSEventManagerDelegate: failed to get MQSService.\n08-25 11:46:13.080 9185-9185/org.tensorflow.demo I/RequestQueue: Repeating capture request cancelled.\n08-25 11:46:13.194 9185-9327/org.tensorflow.demo E/BufferQueueProducer: [SurfaceTexture-1-9185-1] cancelBuffer: BufferQueue has been abandoned", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nAt build.gradle (Module: android)\r\ndef nativeBuildSystem = 'none'\r\nAt CameraActivity.java:\r\nuseCamera2API = true;\r\nSuggested by @andrewharp at #12431\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows version: 10 Pro\r\nAndroid version: 6.0.1\r\nDemo version: commit 18e4590\r\n- **TensorFlow installed from (source or binary)**:\r\nx\r\n- **TensorFlow version (use command below)**:\r\nx\r\n- **Python version**:\r\nx \r\n- **Bazel version (if compiling from source)**:\r\nx\r\n- **CUDA/cuDNN version**:\r\nx\r\n- **GPU model and memory**:\r\nx\r\n- **Exact command to reproduce**:\r\nx\r\n\r\n### Describe the problem\r\nRunning the activity TF Detect after installing the project with Android Studio results in an IllegalArgumentException being thrown.\r\n\r\nThe problem has been noticed before with other configurations at issue #12431 and pull request #10771 and tested recently by @ArtsiomCh  using CMake and Ubuntu.\r\n\r\n### Source code / logs\r\n```\r\n08-25 11:46:10.596 9185-9185/? I/art: Late-enabling -Xcheck:jni\r\n08-25 11:46:10.636 9185-9185/? D/TidaProvider: TidaProvider()\r\n08-25 11:46:10.722 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onCreate org.tensorflow.demo.DetectorActivity@df7138f\r\n08-25 11:46:10.749 9185-9185/org.tensorflow.demo I/CameraManagerGlobal: Connecting to camera service\r\n08-25 11:46:10.784 9185-9185/org.tensorflow.demo I/tensorflow: CameraActivity: Camera API lv2?: true\r\n08-25 11:46:10.788 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onStart org.tensorflow.demo.DetectorActivity@df7138f\r\n08-25 11:46:10.788 9185-9185/org.tensorflow.demo D/tensorflow: CameraActivity: onResume org.tensorflow.demo.DetectorActivity@df7138f\r\n08-25 11:46:10.796 9185-9217/org.tensorflow.demo D/OpenGLRenderer: Use EGL_SWAP_BEHAVIOR_PRESERVED: true\r\n08-25 11:46:10.801 9185-9185/org.tensorflow.demo D/ActivityThreadInjector: clearCachedDrawables.\r\n08-25 11:46:10.840 9185-9217/org.tensorflow.demo I/Adreno: QUALCOMM build                   : a7823f5, I59a6815413\r\n                                                           Build Date                       : 09/23/16\r\n                                                           OpenGL ES Shader Compiler Version: XE031.07.00.00\r\n                                                           Local Branch                     : mybranch22028469\r\n                                                           Remote Branch                    : quic/LA.BR.1.3.3_rb2.26\r\n                                                           Remote Branch                    : NONE\r\n                                                           Reconstruct Branch               : NOTHING\r\n08-25 11:46:10.846 9185-9217/org.tensorflow.demo I/OpenGLRenderer: Initialized EGL, version 1.4\r\n08-25 11:46:10.858 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Desired size: 640x480, min size: 480x480\r\n08-25 11:46:10.858 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Valid preview sizes: [1280x960, 1280x720, 864x480, 640x640, 800x480, 720x480, 640x480, 480x640]\r\n08-25 11:46:10.859 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Rejected preview sizes: [832x468, 768x432, 576x432, 640x360, 480x360, 480x320, 384x288, 352x288, 320x240, 240x320, 240x160, 176x144]\r\n08-25 11:46:10.859 9185-9185/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Exact size match found.\r\n08-25 11:46:10.861 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: ???\r\n08-25 11:46:10.861 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: person\r\n... Etc.\r\n08-25 11:46:10.863 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: hair drier\r\n08-25 11:46:10.863 9185-9185/org.tensorflow.demo W/tensorflow: TensorFlowObjectDetectionAPIModel: toothbrush\r\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Checking to see if TensorFlow native methods are already loaded\r\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo E/art: No implementation found for long org.tensorflow.contrib.android.RunStats.allocate() (tried Java_org_tensorflow_contrib_android_RunStats_allocate and Java_org_tensorflow_contrib_android_RunStats_allocate__)\r\n08-25 11:46:10.864 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: TensorFlow native methods not found, attempting to load via tensorflow_inference\r\n08-25 11:46:10.896 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Successfully loaded TensorFlow native methods (RunStats error may be ignored)\r\n08-25 11:46:12.133 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Model load took 1213ms, TensorFlow version: 1.2.0\r\n08-25 11:46:12.136 9185-9185/org.tensorflow.demo I/TensorFlowInferenceInterface: Successfully loaded model from 'file:///android_asset/ssd_mobilenet_v1_android_export.pb'\r\n08-25 11:46:12.137 9185-9185/org.tensorflow.demo I/tensorflow: DetectorActivity: Sensor orientation: 90, Screen orientation: 0\r\n08-25 11:46:12.137 9185-9185/org.tensorflow.demo I/tensorflow: DetectorActivity: Initializing at size 640x480\r\n08-25 11:46:12.139 9185-9185/org.tensorflow.demo W/tensorflow: ImageUtils: Native library not found, native RGB -> YUV conversion may be unavailable.\r\n08-25 11:46:12.148 9185-9185/org.tensorflow.demo I/CameraManager: Using legacy camera HAL.\r\n08-25 11:46:12.280 9185-9216/org.tensorflow.demo I/tensorflow: CameraConnectionFragment: Opening camera preview: 640x480\r\n08-25 11:46:12.285 9185-9216/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state CONFIGURING\r\n08-25 11:46:12.286 9185-9217/org.tensorflow.demo E/HAL: hw_get_module_by_class: module name gralloc\r\n08-25 11:46:12.286 9185-9290/org.tensorflow.demo I/RequestThread-0: Configure outputs: 2 surfaces configured.\r\n08-25 11:46:12.286 9185-9217/org.tensorflow.demo E/HAL: hw_get_module_by_class: module name gralloc\r\n08-25 11:46:12.286 9185-9290/org.tensorflow.demo D/Camera: app passed NULL surface\r\n08-25 11:46:12.297 9185-9185/org.tensorflow.demo I/Choreographer: Skipped 85 frames!  The application may be doing too much work on its main thread.\r\n08-25 11:46:12.309 9185-9216/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state IDLE\r\n08-25 11:46:12.313 9185-9216/org.tensorflow.demo I/RequestQueue: Repeating capture request set.\r\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: convertRequestMetadata - control.awbRegions setting is not supported, ignoring value\r\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: Only received metering rectangles with weight 0.\r\n08-25 11:46:12.314 9185-9290/org.tensorflow.demo W/LegacyRequestMapper: Only received metering rectangles with weight 0.\r\n08-25 11:46:12.493 9185-9291/org.tensorflow.demo I/CameraDeviceState: Legacy camera service transitioning to state CAPTURING\r\n08-25 11:46:12.515 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 0 at size 307200\r\n08-25 11:46:12.516 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 1 at size 153599\r\n08-25 11:46:12.516 9185-9216/org.tensorflow.demo D/tensorflow: CameraActivity: Initializing buffer 2 at size 153599\r\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo E/tensorflow: ObjectTracker: libtensorflow_demo.so not found, tracking unavailable\r\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo I/tensorflow: MultiBoxTracker: Initializing ObjectTracker: 640x480\r\n08-25 11:46:12.517 9185-9216/org.tensorflow.demo E/tensorflow: ObjectTracker: Native object tracking support not found. See tensorflow/examples/android/README.md for details.\r\n08-25 11:46:12.525 9185-9216/org.tensorflow.demo E/tensorflow: MultiBoxTracker: Object tracking support not found. See tensorflow/examples/android/README.md for details.\r\n08-25 11:46:12.544 9185-9216/org.tensorflow.demo E/art: No implementation found for void org.tensorflow.demo.env.ImageUtils.convertYUV420ToARGB8888(byte[], byte[], byte[], int[], int, int, int, int, int, boolean) (tried Java_org_tensorflow_demo_env_ImageUtils_convertYUV420ToARGB8888 and Java_org_tensorflow_demo_env_ImageUtils_convertYUV420ToARGB8888___3B_3B_3B_3IIIIIIZ)\r\n08-25 11:46:12.545 9185-9216/org.tensorflow.demo W/tensorflow: ImageUtils: Native YUV -> RGB implementation not found, falling back to Java implementation\r\n08-25 11:46:12.717 9185-9217/org.tensorflow.demo V/RenderScript: 0x558f6c1290 Launching thread(s), CPUs 6\r\n08-25 11:46:13.060 9185-9215/org.tensorflow.demo E/TensorFlowInferenceInterface: Failed to run TensorFlow inference with inputs:[image_tensor], outputs:[detection_boxes, detection_scores, detection_classes, num_detections]\r\n                                                                                 \r\n                                                                                 --------- beginning of crash\r\n08-25 11:46:13.060 9185-9215/org.tensorflow.demo E/AndroidRuntime: FATAL EXCEPTION: inference\r\n                                                                   Process: org.tensorflow.demo, PID: 9185\r\n                                                                   java.lang.IllegalArgumentException: No OpKernel was registered to support Op 'Switch' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n                                                                     device='CPU'; T in [DT_FLOAT]\r\n                                                                     device='CPU'; T in [DT_INT32]\r\n                                                                     device='GPU'; T in [DT_STRING]\r\n                                                                     device='GPU'; T in [DT_BOOL]\r\n                                                                     device='GPU'; T in [DT_INT32]\r\n                                                                     device='GPU'; T in [DT_FLOAT]\r\n                                                                   \r\n                                                                   \t [[Node: Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/cond/Switch = Switch[T=DT_BOOL](Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/Greater, Postprocessor/BatchMultiClassNonMaxSuppression/map/while/PadOrClipBoxList/Greater)]]\r\n                                                                       at org.tensorflow.Session.run(Native Method)\r\n                                                                       at org.tensorflow.Session.access$100(Session.java:48)\r\n                                                                       at org.tensorflow.Session$Runner.runHelper(Session.java:295)\r\n                                                                       at org.tensorflow.Session$Runner.run(Session.java:245)\r\n                                                                       at org.tensorflow.contrib.android.TensorFlowInferenceInterface.run(TensorFlowInferenceInterface.java:142)\r\n                                                                       at org.tensorflow.demo.TensorFlowObjectDetectionAPIModel.recognizeImage(TensorFlowObjectDetectionAPIModel.java:158)\r\n                                                                       at org.tensorflow.demo.DetectorActivity$3.run(DetectorActivity.java:340)\r\n                                                                       at android.os.Handler.handleCallback(Handler.java:742)\r\n                                                                       at android.os.Handler.dispatchMessage(Handler.java:95)\r\n                                                                       at android.os.Looper.loop(Looper.java:154)\r\n                                                                       at android.os.HandlerThread.run(HandlerThread.java:61)\r\n08-25 11:46:13.061 9185-9215/org.tensorflow.demo E/MQSEventManagerDelegate: failed to get MQSService.\r\n08-25 11:46:13.080 9185-9185/org.tensorflow.demo I/RequestQueue: Repeating capture request cancelled.\r\n08-25 11:46:13.194 9185-9327/org.tensorflow.demo E/BufferQueueProducer: [SurfaceTexture-1-9185-1] cancelBuffer: BufferQueue has been abandoned\r\n```"}