{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/292577893", "html_url": "https://github.com/tensorflow/tensorflow/issues/8665#issuecomment-292577893", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8665", "id": 292577893, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjU3Nzg5Mw==", "user": {"login": "ngoel17", "id": 8811128, "node_id": "MDQ6VXNlcjg4MTExMjg=", "avatar_url": "https://avatars1.githubusercontent.com/u/8811128?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ngoel17", "html_url": "https://github.com/ngoel17", "followers_url": "https://api.github.com/users/ngoel17/followers", "following_url": "https://api.github.com/users/ngoel17/following{/other_user}", "gists_url": "https://api.github.com/users/ngoel17/gists{/gist_id}", "starred_url": "https://api.github.com/users/ngoel17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ngoel17/subscriptions", "organizations_url": "https://api.github.com/users/ngoel17/orgs", "repos_url": "https://api.github.com/users/ngoel17/repos", "events_url": "https://api.github.com/users/ngoel17/events{/privacy}", "received_events_url": "https://api.github.com/users/ngoel17/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-07T16:03:26Z", "updated_at": "2017-04-07T16:03:26Z", "author_association": "NONE", "body_html": "<p><a href=\"https://github.com/tensorflow/tensorflow/files/906064/Freezing_problem.zip\">Freezing_problem.zip</a><br>\nWe have a similar problem related to saving the operations as constants while freezing using the algorithm in the attached files.<br>\nThe problem can be easily replicated by trying to freeze the graphs generated by the toy example in textsum <a href=\"https://github.com/tensorflow/models/tree/master/textsum\">https://github.com/tensorflow/models/tree/master/textsum</a> .</p>\n<p>Models are trained with the following command:<br>\nbazel-bin/textsum/seq2seq_attention     --mode=train     --article_key=article     --abstract_key=abstract     --data_path=textsum/data/data     --vocab_path=textsum/data/vocab     --log_root=textsum/log_root     --train_dir=textsum/log_root/train</p>\n<p>Then freeze_2_textsum.py is called with the following syntax:<br>\npython freeze_2_textsum.py  <br>\nCommand in our case was:<br>\npython freeze_2_textsum.py --model_folder=./log_root/  --outputnodes=global_step</p>\n<p>In this case, we are able to find the saved constants in the frozen_model.pb file.<br>\nBut when we try the same syntax for the trained graph in our project, we could not find the constants in the frozen model.pb file, while the freeze_2_textsum.py script prints the log message that \"13 ops were converted to constants\"<br>\nThis problem leads to the following error while running the session in our test script:<br>\n\"Attempting to use uninitialized value model/generate_embedding_RNN_output/BiRNN/BW/BasicLSTMCell/Linear/Bias\"<br>\ncmd line for test script:</p>\n<p>python test_tf_frozen_txtsum.py </p>", "body_text": "Freezing_problem.zip\nWe have a similar problem related to saving the operations as constants while freezing using the algorithm in the attached files.\nThe problem can be easily replicated by trying to freeze the graphs generated by the toy example in textsum https://github.com/tensorflow/models/tree/master/textsum .\nModels are trained with the following command:\nbazel-bin/textsum/seq2seq_attention     --mode=train     --article_key=article     --abstract_key=abstract     --data_path=textsum/data/data     --vocab_path=textsum/data/vocab     --log_root=textsum/log_root     --train_dir=textsum/log_root/train\nThen freeze_2_textsum.py is called with the following syntax:\npython freeze_2_textsum.py  \nCommand in our case was:\npython freeze_2_textsum.py --model_folder=./log_root/  --outputnodes=global_step\nIn this case, we are able to find the saved constants in the frozen_model.pb file.\nBut when we try the same syntax for the trained graph in our project, we could not find the constants in the frozen model.pb file, while the freeze_2_textsum.py script prints the log message that \"13 ops were converted to constants\"\nThis problem leads to the following error while running the session in our test script:\n\"Attempting to use uninitialized value model/generate_embedding_RNN_output/BiRNN/BW/BasicLSTMCell/Linear/Bias\"\ncmd line for test script:\npython test_tf_frozen_txtsum.py", "body": "\r\n[Freezing_problem.zip](https://github.com/tensorflow/tensorflow/files/906064/Freezing_problem.zip)\r\nWe have a similar problem related to saving the operations as constants while freezing using the algorithm in the attached files.\r\nThe problem can be easily replicated by trying to freeze the graphs generated by the toy example in textsum https://github.com/tensorflow/models/tree/master/textsum . \r\n\r\nModels are trained with the following command:\r\nbazel-bin/textsum/seq2seq_attention     --mode=train     --article_key=article     --abstract_key=abstract     --data_path=textsum/data/data     --vocab_path=textsum/data/vocab     --log_root=textsum/log_root     --train_dir=textsum/log_root/train\r\n\r\nThen freeze_2_textsum.py is called with the following syntax:\r\npython freeze_2_textsum.py <model-folder> <outputnodename-string>\r\nCommand in our case was:\r\npython freeze_2_textsum.py --model_folder=./log_root/  --outputnodes=global_step\r\n\r\nIn this case, we are able to find the saved constants in the frozen_model.pb file.\r\nBut when we try the same syntax for the trained graph in our project, we could not find the constants in the frozen model.pb file, while the freeze_2_textsum.py script prints the log message that \"13 ops were converted to constants\"\r\nThis problem leads to the following error while running the session in our test script:\r\n\"Attempting to use uninitialized value model/generate_embedding_RNN_output/BiRNN/BW/BasicLSTMCell/Linear/Bias\"\r\ncmd line for test script:\r\n\r\npython test_tf_frozen_txtsum.py <path to frozen model.pb>\r\n"}