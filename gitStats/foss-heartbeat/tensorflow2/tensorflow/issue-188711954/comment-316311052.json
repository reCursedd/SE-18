{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/316311052", "html_url": "https://github.com/tensorflow/tensorflow/issues/5538#issuecomment-316311052", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5538", "id": 316311052, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNjMxMTA1Mg==", "user": {"login": "zuowang", "id": 10447352, "node_id": "MDQ6VXNlcjEwNDQ3MzUy", "avatar_url": "https://avatars2.githubusercontent.com/u/10447352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zuowang", "html_url": "https://github.com/zuowang", "followers_url": "https://api.github.com/users/zuowang/followers", "following_url": "https://api.github.com/users/zuowang/following{/other_user}", "gists_url": "https://api.github.com/users/zuowang/gists{/gist_id}", "starred_url": "https://api.github.com/users/zuowang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zuowang/subscriptions", "organizations_url": "https://api.github.com/users/zuowang/orgs", "repos_url": "https://api.github.com/users/zuowang/repos", "events_url": "https://api.github.com/users/zuowang/events{/privacy}", "received_events_url": "https://api.github.com/users/zuowang/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-19T08:25:15Z", "updated_at": "2017-07-19T08:25:15Z", "author_association": "NONE", "body_html": "<p>solved by modifying /usr/lib/python2.7/site-packages/wheel/archive.py:46</p>\n<div class=\"highlight highlight-source-diff\"><pre>    # XXX support bz2, xz when available\n    zip = zipfile.ZipFile(open(zip_filename, \"wb+\"), \"w\",\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>                         compression=zipfile.ZIP_DEFLATED)</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>                         compression=zipfile.ZIP_DEFLATED, allowZip64=True)</span>\n\n    score = {'WHEEL': 1, 'METADATA': 2, 'RECORD': 3}\n    deferred = []\n\n    def writefile(path, date_time):\n        st = os.stat(path)\n        if date_time is None:\n            mtime = time.gmtime(st.st_mtime)\n            date_time = mtime[0:6]\n        zinfo = zipfile.ZipInfo(path, date_time)\n        zinfo.external_attr = st.st_mode &lt;&lt; 16\n        zinfo.compress_type = zipfile.ZIP_DEFLATED\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>       with open(path, 'rb') as fp:</span>\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>            zip.writestr(zinfo, fp.read())</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>       zip.write(path, arcname=zinfo.filename, compress_type=zipfile.ZIP_DEFLATED)</span>\n        log.info(\"adding '%s'\" % path)</pre></div>", "body_text": "solved by modifying /usr/lib/python2.7/site-packages/wheel/archive.py:46\n    # XXX support bz2, xz when available\n    zip = zipfile.ZipFile(open(zip_filename, \"wb+\"), \"w\",\n-                         compression=zipfile.ZIP_DEFLATED)\n+                         compression=zipfile.ZIP_DEFLATED, allowZip64=True)\n\n    score = {'WHEEL': 1, 'METADATA': 2, 'RECORD': 3}\n    deferred = []\n\n    def writefile(path, date_time):\n        st = os.stat(path)\n        if date_time is None:\n            mtime = time.gmtime(st.st_mtime)\n            date_time = mtime[0:6]\n        zinfo = zipfile.ZipInfo(path, date_time)\n        zinfo.external_attr = st.st_mode << 16\n        zinfo.compress_type = zipfile.ZIP_DEFLATED\n-       with open(path, 'rb') as fp:\n-            zip.writestr(zinfo, fp.read())\n+       zip.write(path, arcname=zinfo.filename, compress_type=zipfile.ZIP_DEFLATED)\n        log.info(\"adding '%s'\" % path)", "body": "solved by modifying /usr/lib/python2.7/site-packages/wheel/archive.py:46\r\n```diff\r\n    # XXX support bz2, xz when available\r\n    zip = zipfile.ZipFile(open(zip_filename, \"wb+\"), \"w\",\r\n-                         compression=zipfile.ZIP_DEFLATED)\r\n+                         compression=zipfile.ZIP_DEFLATED, allowZip64=True)\r\n\r\n    score = {'WHEEL': 1, 'METADATA': 2, 'RECORD': 3}\r\n    deferred = []\r\n\r\n    def writefile(path, date_time):\r\n        st = os.stat(path)\r\n        if date_time is None:\r\n            mtime = time.gmtime(st.st_mtime)\r\n            date_time = mtime[0:6]\r\n        zinfo = zipfile.ZipInfo(path, date_time)\r\n        zinfo.external_attr = st.st_mode << 16\r\n        zinfo.compress_type = zipfile.ZIP_DEFLATED\r\n-       with open(path, 'rb') as fp:\r\n-            zip.writestr(zinfo, fp.read())\r\n+       zip.write(path, arcname=zinfo.filename, compress_type=zipfile.ZIP_DEFLATED)\r\n        log.info(\"adding '%s'\" % path)\r\n```"}