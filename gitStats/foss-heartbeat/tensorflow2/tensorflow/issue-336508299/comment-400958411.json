{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/400958411", "html_url": "https://github.com/tensorflow/tensorflow/issues/20370#issuecomment-400958411", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20370", "id": 400958411, "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDk1ODQxMQ==", "user": {"login": "martin-gorner", "id": 959847, "node_id": "MDQ6VXNlcjk1OTg0Nw==", "avatar_url": "https://avatars0.githubusercontent.com/u/959847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martin-gorner", "html_url": "https://github.com/martin-gorner", "followers_url": "https://api.github.com/users/martin-gorner/followers", "following_url": "https://api.github.com/users/martin-gorner/following{/other_user}", "gists_url": "https://api.github.com/users/martin-gorner/gists{/gist_id}", "starred_url": "https://api.github.com/users/martin-gorner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martin-gorner/subscriptions", "organizations_url": "https://api.github.com/users/martin-gorner/orgs", "repos_url": "https://api.github.com/users/martin-gorner/repos", "events_url": "https://api.github.com/users/martin-gorner/events{/privacy}", "received_events_url": "https://api.github.com/users/martin-gorner/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-28T08:38:54Z", "updated_at": "2018-06-28T08:38:54Z", "author_association": "NONE", "body_html": "<p>I managed to remove the offending instruction but the code failed in a different place:</p>\n<p>Traceback (most recent call last): File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main \"<strong>main</strong>\", fname, loader, pkg_name) File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code exec code in run_globals File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 188, in  main(sys.argv) File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 184, in main start_training(output_dir, hparams, **otherargs) File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 131, in start_training tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 439, in train_and_evaluate executor.run() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 546, in run getattr(self, task_to_run)() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 601, in run_master self._start_distributed_training(saving_listeners=saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 739, in _start_distributed_training saving_listeners=saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 363, in train loss = self._train_model(input_fn, hooks, saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 841, in _train_model return self._train_model_distributed(input_fn, hooks, saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 977, in _train_model_distributed saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1056, in _train_with_estimator_spec log_step_count_steps=self._config.log_step_count_steps) as mon_sess: File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 405, in MonitoredTrainingSession stop_grace_period_secs=stop_grace_period_secs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 816, in <strong>init</strong> stop_grace_period_secs=stop_grace_period_secs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 539, in <strong>init</strong> self._sess = _RecoverableSession(self._coordinated_creator) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 1002, in <strong>init</strong> _WrappedSession.<strong>init</strong>(self, self._create_session()) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 1007, in _create_session return self._sess_creator.create_session() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 696, in create_session self.tf_sess = self._session_creator.create_session() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 467, in create_session init_fn=self._scaffold.init_fn) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 285, in prepare_session sess.run(init_op, feed_dict=init_feed_dict) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 900, in run run_metadata_ptr) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run feed_dict_tensor, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call raise type(e)(node_def, op, message) InvalidArgumentError: Cannot assign a device for operation 'concat_97': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. Registered kernels: device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT64] device='GPU'; T in [DT_COMPLEX128] device='GPU'; T in [DT_COMPLEX64] device='GPU'; T in [DT_UINT8] device='GPU'; T in [DT_BFLOAT16] device='GPU'; T in [DT_DOUBLE] device='GPU'; T in [DT_FLOAT] device='GPU'; T in [DT_HALF] device='CPU'; T in [DT_QINT32] device='CPU'; T in [DT_QINT16] device='CPU'; T in [DT_QUINT16] device='CPU'; T in [DT_QINT8] device='CPU'; T in [DT_QUINT8] device='CPU'; T in [DT_STRING] device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_COMPLEX128] device='CPU'; T in [DT_COMPLEX64] device='CPU'; T in [DT_DOUBLE] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_BFLOAT16] device='CPU'; T in [DT_HALF] device='CPU'; T in [DT_INT8] device='CPU'; T in [DT_UINT8] device='CPU'; T in [DT_INT16] device='CPU'; T in [DT_UINT16] device='CPU'; T in [DT_INT32] device='CPU'; T in [DT_INT64] [[Node: concat_97 = ConcatV2[N=2, T=DT_STRING, Tidx=DT_INT32, _device=\"/device:GPU:0\"](report_uninitialized_variables/boolean_mask/GatherV2, report_uninitialized_resources/Const, concat_97/axis)]] Caused by op u'concat_97', defined at: File \"/usr/lib/python2.7/threading.py\", line 774, in __bootstrap self.__bootstrap_inner() File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner self.run() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 465, in run self.main_result = self.main_fn(*self.main_args, **self.main_kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1139, in create_per_tower_ready_op 'ready_op', ops.GraphKeys.READY_OP, default_ready_op) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 264, in get_or_default op = default_constructor() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1136, in default_ready_op ], 0) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1189, in concat return gen_array_ops.concat_v2(values=values, axis=axis, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 953, in concat_v2 \"ConcatV2\", values=values, axis=axis, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1718, in <strong>init</strong> self._traceback = self._graph._extract_stack() # pylint: disable=protected-access InvalidArgumentError (see above for traceback): Cannot assign a device for operation 'concat_97': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. Registered kernels: device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT64] device='GPU'; T in [DT_COMPLEX128] device='GPU'; T in [DT_COMPLEX64] device='GPU'; T in [DT_UINT8] device='GPU'; T in [DT_BFLOAT16] device='GPU'; T in [DT_DOUBLE] device='GPU'; T in [DT_FLOAT] device='GPU'; T in [DT_HALF] device='CPU'; T in [DT_QINT32] device='CPU'; T in [DT_QINT16] device='CPU'; T in [DT_QUINT16] device='CPU'; T in [DT_QINT8] device='CPU'; T in [DT_QUINT8] device='CPU'; T in [DT_STRING] device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_COMPLEX128] device='CPU'; T in [DT_COMPLEX64] device='CPU'; T in [DT_DOUBLE] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_BFLOAT16] device='CPU'; T in [DT_HALF] device='CPU'; T in [DT_INT8] device='CPU'; T in [DT_UINT8] device='CPU'; T in [DT_INT16] device='CPU'; T in [DT_UINT16] device='CPU'; T in [DT_INT32] device='CPU'; T in [DT_INT64] [[Node: concat_97 = ConcatV2[N=2, T=DT_STRING, Tidx=DT_INT32, _device=\"/device:GPU:0\"](report_uninitialized_variables/boolean_mask/GatherV2, report_uninitialized_resources/Const, concat_97/axis)]]</p>", "body_text": "I managed to remove the offending instruction but the code failed in a different place:\nTraceback (most recent call last): File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main \"main\", fname, loader, pkg_name) File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code exec code in run_globals File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 188, in  main(sys.argv) File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 184, in main start_training(output_dir, hparams, **otherargs) File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 131, in start_training tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 439, in train_and_evaluate executor.run() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 546, in run getattr(self, task_to_run)() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 601, in run_master self._start_distributed_training(saving_listeners=saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 739, in _start_distributed_training saving_listeners=saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 363, in train loss = self._train_model(input_fn, hooks, saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 841, in _train_model return self._train_model_distributed(input_fn, hooks, saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 977, in _train_model_distributed saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1056, in _train_with_estimator_spec log_step_count_steps=self._config.log_step_count_steps) as mon_sess: File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 405, in MonitoredTrainingSession stop_grace_period_secs=stop_grace_period_secs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 816, in init stop_grace_period_secs=stop_grace_period_secs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 539, in init self._sess = _RecoverableSession(self._coordinated_creator) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 1002, in init _WrappedSession.init(self, self._create_session()) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 1007, in _create_session return self._sess_creator.create_session() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 696, in create_session self.tf_sess = self._session_creator.create_session() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 467, in create_session init_fn=self._scaffold.init_fn) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 285, in prepare_session sess.run(init_op, feed_dict=init_feed_dict) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 900, in run run_metadata_ptr) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run feed_dict_tensor, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call raise type(e)(node_def, op, message) InvalidArgumentError: Cannot assign a device for operation 'concat_97': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. Registered kernels: device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT64] device='GPU'; T in [DT_COMPLEX128] device='GPU'; T in [DT_COMPLEX64] device='GPU'; T in [DT_UINT8] device='GPU'; T in [DT_BFLOAT16] device='GPU'; T in [DT_DOUBLE] device='GPU'; T in [DT_FLOAT] device='GPU'; T in [DT_HALF] device='CPU'; T in [DT_QINT32] device='CPU'; T in [DT_QINT16] device='CPU'; T in [DT_QUINT16] device='CPU'; T in [DT_QINT8] device='CPU'; T in [DT_QUINT8] device='CPU'; T in [DT_STRING] device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_COMPLEX128] device='CPU'; T in [DT_COMPLEX64] device='CPU'; T in [DT_DOUBLE] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_BFLOAT16] device='CPU'; T in [DT_HALF] device='CPU'; T in [DT_INT8] device='CPU'; T in [DT_UINT8] device='CPU'; T in [DT_INT16] device='CPU'; T in [DT_UINT16] device='CPU'; T in [DT_INT32] device='CPU'; T in [DT_INT64] [[Node: concat_97 = ConcatV2[N=2, T=DT_STRING, Tidx=DT_INT32, _device=\"/device:GPU:0\"](report_uninitialized_variables/boolean_mask/GatherV2, report_uninitialized_resources/Const, concat_97/axis)]] Caused by op u'concat_97', defined at: File \"/usr/lib/python2.7/threading.py\", line 774, in __bootstrap self.__bootstrap_inner() File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner self.run() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 465, in run self.main_result = self.main_fn(*self.main_args, **self.main_kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1139, in create_per_tower_ready_op 'ready_op', ops.GraphKeys.READY_OP, default_ready_op) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 264, in get_or_default op = default_constructor() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1136, in default_ready_op ], 0) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1189, in concat return gen_array_ops.concat_v2(values=values, axis=axis, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 953, in concat_v2 \"ConcatV2\", values=values, axis=axis, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1718, in init self._traceback = self._graph._extract_stack() # pylint: disable=protected-access InvalidArgumentError (see above for traceback): Cannot assign a device for operation 'concat_97': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. Registered kernels: device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT64] device='GPU'; T in [DT_COMPLEX128] device='GPU'; T in [DT_COMPLEX64] device='GPU'; T in [DT_UINT8] device='GPU'; T in [DT_BFLOAT16] device='GPU'; T in [DT_DOUBLE] device='GPU'; T in [DT_FLOAT] device='GPU'; T in [DT_HALF] device='CPU'; T in [DT_QINT32] device='CPU'; T in [DT_QINT16] device='CPU'; T in [DT_QUINT16] device='CPU'; T in [DT_QINT8] device='CPU'; T in [DT_QUINT8] device='CPU'; T in [DT_STRING] device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_COMPLEX128] device='CPU'; T in [DT_COMPLEX64] device='CPU'; T in [DT_DOUBLE] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_BFLOAT16] device='CPU'; T in [DT_HALF] device='CPU'; T in [DT_INT8] device='CPU'; T in [DT_UINT8] device='CPU'; T in [DT_INT16] device='CPU'; T in [DT_UINT16] device='CPU'; T in [DT_INT32] device='CPU'; T in [DT_INT64] [[Node: concat_97 = ConcatV2[N=2, T=DT_STRING, Tidx=DT_INT32, _device=\"/device:GPU:0\"](report_uninitialized_variables/boolean_mask/GatherV2, report_uninitialized_resources/Const, concat_97/axis)]]", "body": "I managed to remove the offending instruction but the code failed in a different place:\r\n\r\nTraceback (most recent call last): File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main \"__main__\", fname, loader, pkg_name) File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code exec code in run_globals File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 188, in <module> main(sys.argv) File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 184, in main start_training(output_dir, hparams, **otherargs) File \"/root/.local/lib/python2.7/site-packages/trainer_yolo/main.py\", line 131, in start_training tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 439, in train_and_evaluate executor.run() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 546, in run getattr(self, task_to_run)() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 601, in run_master self._start_distributed_training(saving_listeners=saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/training.py\", line 739, in _start_distributed_training saving_listeners=saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 363, in train loss = self._train_model(input_fn, hooks, saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 841, in _train_model return self._train_model_distributed(input_fn, hooks, saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 977, in _train_model_distributed saving_listeners) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1056, in _train_with_estimator_spec log_step_count_steps=self._config.log_step_count_steps) as mon_sess: File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 405, in MonitoredTrainingSession stop_grace_period_secs=stop_grace_period_secs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 816, in __init__ stop_grace_period_secs=stop_grace_period_secs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 539, in __init__ self._sess = _RecoverableSession(self._coordinated_creator) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 1002, in __init__ _WrappedSession.__init__(self, self._create_session()) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 1007, in _create_session return self._sess_creator.create_session() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 696, in create_session self.tf_sess = self._session_creator.create_session() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 467, in create_session init_fn=self._scaffold.init_fn) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 285, in prepare_session sess.run(init_op, feed_dict=init_feed_dict) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 900, in run run_metadata_ptr) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run feed_dict_tensor, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call raise type(e)(node_def, op, message) InvalidArgumentError: Cannot assign a device for operation 'concat_97': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. Registered kernels: device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT64] device='GPU'; T in [DT_COMPLEX128] device='GPU'; T in [DT_COMPLEX64] device='GPU'; T in [DT_UINT8] device='GPU'; T in [DT_BFLOAT16] device='GPU'; T in [DT_DOUBLE] device='GPU'; T in [DT_FLOAT] device='GPU'; T in [DT_HALF] device='CPU'; T in [DT_QINT32] device='CPU'; T in [DT_QINT16] device='CPU'; T in [DT_QUINT16] device='CPU'; T in [DT_QINT8] device='CPU'; T in [DT_QUINT8] device='CPU'; T in [DT_STRING] device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_COMPLEX128] device='CPU'; T in [DT_COMPLEX64] device='CPU'; T in [DT_DOUBLE] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_BFLOAT16] device='CPU'; T in [DT_HALF] device='CPU'; T in [DT_INT8] device='CPU'; T in [DT_UINT8] device='CPU'; T in [DT_INT16] device='CPU'; T in [DT_UINT16] device='CPU'; T in [DT_INT32] device='CPU'; T in [DT_INT64] [[Node: concat_97 = ConcatV2[N=2, T=DT_STRING, Tidx=DT_INT32, _device=\"/device:GPU:0\"](report_uninitialized_variables/boolean_mask/GatherV2, report_uninitialized_resources/Const, concat_97/axis)]] Caused by op u'concat_97', defined at: File \"/usr/lib/python2.7/threading.py\", line 774, in __bootstrap self.__bootstrap_inner() File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner self.run() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 465, in run self.main_result = self.main_fn(*self.main_args, **self.main_kwargs) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1139, in create_per_tower_ready_op 'ready_op', ops.GraphKeys.READY_OP, default_ready_op) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/monitored_session.py\", line 264, in get_or_default op = default_constructor() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/estimator/estimator.py\", line 1136, in default_ready_op ], 0) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1189, in concat return gen_array_ops.concat_v2(values=values, axis=axis, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 953, in concat_v2 \"ConcatV2\", values=values, axis=axis, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1718, in __init__ self._traceback = self._graph._extract_stack() # pylint: disable=protected-access InvalidArgumentError (see above for traceback): Cannot assign a device for operation 'concat_97': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. Registered kernels: device='GPU'; T in [DT_INT32] device='GPU'; T in [DT_BOOL] device='GPU'; T in [DT_INT64] device='GPU'; T in [DT_COMPLEX128] device='GPU'; T in [DT_COMPLEX64] device='GPU'; T in [DT_UINT8] device='GPU'; T in [DT_BFLOAT16] device='GPU'; T in [DT_DOUBLE] device='GPU'; T in [DT_FLOAT] device='GPU'; T in [DT_HALF] device='CPU'; T in [DT_QINT32] device='CPU'; T in [DT_QINT16] device='CPU'; T in [DT_QUINT16] device='CPU'; T in [DT_QINT8] device='CPU'; T in [DT_QUINT8] device='CPU'; T in [DT_STRING] device='CPU'; T in [DT_BOOL] device='CPU'; T in [DT_COMPLEX128] device='CPU'; T in [DT_COMPLEX64] device='CPU'; T in [DT_DOUBLE] device='CPU'; T in [DT_FLOAT] device='CPU'; T in [DT_BFLOAT16] device='CPU'; T in [DT_HALF] device='CPU'; T in [DT_INT8] device='CPU'; T in [DT_UINT8] device='CPU'; T in [DT_INT16] device='CPU'; T in [DT_UINT16] device='CPU'; T in [DT_INT32] device='CPU'; T in [DT_INT64] [[Node: concat_97 = ConcatV2[N=2, T=DT_STRING, Tidx=DT_INT32, _device=\"/device:GPU:0\"](report_uninitialized_variables/boolean_mask/GatherV2, report_uninitialized_resources/Const, concat_97/axis)]]"}