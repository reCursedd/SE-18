{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10609", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10609/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10609/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10609/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10609", "id": 234991150, "node_id": "MDU6SXNzdWUyMzQ5OTExNTA=", "number": 10609, "title": "Reshape cannot infer the missing input size for an empty tensor unless all specified", "user": {"login": "Yc174", "id": 28732582, "node_id": "MDQ6VXNlcjI4NzMyNTgy", "avatar_url": "https://avatars1.githubusercontent.com/u/28732582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Yc174", "html_url": "https://github.com/Yc174", "followers_url": "https://api.github.com/users/Yc174/followers", "following_url": "https://api.github.com/users/Yc174/following{/other_user}", "gists_url": "https://api.github.com/users/Yc174/gists{/gist_id}", "starred_url": "https://api.github.com/users/Yc174/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Yc174/subscriptions", "organizations_url": "https://api.github.com/users/Yc174/orgs", "repos_url": "https://api.github.com/users/Yc174/repos", "events_url": "https://api.github.com/users/Yc174/events{/privacy}", "received_events_url": "https://api.github.com/users/Yc174/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-06-10T09:17:31Z", "updated_at": "2018-09-14T23:49:55Z", "closed_at": "2017-06-12T22:31:33Z", "author_association": "NONE", "body_html": "<p>I trained faster-rcnn on coco dataset, when iter =11410, it appears a problem:<br>\nimage: COCO_train2014_000000076146.jpg iter: 11410 / 200000, total loss: 3.3490, rpn_loss_cls: 0.7608, rpn_loss_box: 1.0145, loss_cls: 0.7640, loss_box: 0.8098, lr: 0.001000<br>\nspeed: 0.327s / iter<br>\n2017-06-08 22:59:42.143627: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: <strong>Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero</strong><br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]<br>\n2017-06-08 22:59:42.143670: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: <strong>Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero</strong><br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]<br>\n2017-06-08 22:59:42.143965: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero<br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]<br>\n2017-06-08 22:59:42.144042: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero<br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]<br>\n2017-06-08 22:59:42.145758: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero<br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]<br>\nTraceback (most recent call last):<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in<br>\nrestore=bool(int(args.restore)))<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net<br>\nsw.train_model(sess, max_iters, restore=restore)<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 255, in train_model<br>\ncls_prob, bbox_pred, rois = sess.run(fetches=fetch_list, feed_dict=feed_dict)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 778, in run<br>\nrun_metadata_ptr)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 982, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1032, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1052, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: <strong>Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero</strong><br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]</p>\n<p>Caused by op u'gradients/TopKV2_grad/Reshape', defined at:<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in<br>\nrestore=bool(int(args.restore)))<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net<br>\nsw.train_model(sess, max_iters, restore=restore)<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 142, in train_model<br>\ngrads, norm = tf.clip_by_global_norm(tf.gradients(loss, tvars), 10.0)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 560, in gradients<br>\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 368, in _MaybeCompile<br>\nreturn grad_fn() # Exit early<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 560, in<br>\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_grad.py\", line 577, in _TopKGrad<br>\nind_2d = array_ops.reshape(op.outputs[1], array_ops.stack([-1, ind_lastdim]))<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2510, in reshape<br>\nname=name)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 768, in apply_op<br>\nop_def=op_def)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2336, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1228, in init<br>\nself._traceback = _extract_stack()</p>\n<p>...which was originally created as op u'TopKV2', defined at:<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in<br>\nrestore=bool(int(args.restore)))<br>\n[elided 0 identical lines from previous traceback]<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net<br>\nsw.train_model(sess, max_iters, restore=restore)<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 112, in train_model<br>\nself.net.build_loss(ohem=cfg.TRAIN.OHEM)<br>\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/networks/network.py\", line 643, in build_loss<br>\nrpn_cross_entropy_n_neg, _ = tf.nn.top_k(rpn_cross_entropy_n_neg, k=top_k)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 1998, in top_k<br>\nreturn gen_nn_ops._top_kv2(input, k=k, sorted=sorted, name=name)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 2502, in _top_kv2<br>\nname=name)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 768, in apply_op<br>\nop_def=op_def)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2336, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1228, in init<br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): <strong>Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero</strong><br>\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]</p>\n<p>Process finished with exit code 1</p>\n<p>Does anyone meet the same things? Or this is a bug of tensorflow. It's really a strange problem.</p>", "body_text": "I trained faster-rcnn on coco dataset, when iter =11410, it appears a problem:\nimage: COCO_train2014_000000076146.jpg iter: 11410 / 200000, total loss: 3.3490, rpn_loss_cls: 0.7608, rpn_loss_box: 1.0145, loss_cls: 0.7640, loss_box: 0.8098, lr: 0.001000\nspeed: 0.327s / iter\n2017-06-08 22:59:42.143627: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\n2017-06-08 22:59:42.143670: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\n2017-06-08 22:59:42.143965: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\n2017-06-08 22:59:42.144042: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\n2017-06-08 22:59:42.145758: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\nTraceback (most recent call last):\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in\nrestore=bool(int(args.restore)))\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net\nsw.train_model(sess, max_iters, restore=restore)\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 255, in train_model\ncls_prob, bbox_pred, rois = sess.run(fetches=fetch_list, feed_dict=feed_dict)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 778, in run\nrun_metadata_ptr)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 982, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1032, in _do_run\ntarget_list, options, run_metadata)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1052, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\nCaused by op u'gradients/TopKV2_grad/Reshape', defined at:\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in\nrestore=bool(int(args.restore)))\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net\nsw.train_model(sess, max_iters, restore=restore)\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 142, in train_model\ngrads, norm = tf.clip_by_global_norm(tf.gradients(loss, tvars), 10.0)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 560, in gradients\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 368, in _MaybeCompile\nreturn grad_fn() # Exit early\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 560, in\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_grad.py\", line 577, in _TopKGrad\nind_2d = array_ops.reshape(op.outputs[1], array_ops.stack([-1, ind_lastdim]))\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2510, in reshape\nname=name)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 768, in apply_op\nop_def=op_def)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2336, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1228, in init\nself._traceback = _extract_stack()\n...which was originally created as op u'TopKV2', defined at:\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in\nrestore=bool(int(args.restore)))\n[elided 0 identical lines from previous traceback]\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net\nsw.train_model(sess, max_iters, restore=restore)\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 112, in train_model\nself.net.build_loss(ohem=cfg.TRAIN.OHEM)\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/networks/network.py\", line 643, in build_loss\nrpn_cross_entropy_n_neg, _ = tf.nn.top_k(rpn_cross_entropy_n_neg, k=top_k)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 1998, in top_k\nreturn gen_nn_ops._top_kv2(input, k=k, sorted=sorted, name=name)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 2502, in _top_kv2\nname=name)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 768, in apply_op\nop_def=op_def)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2336, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1228, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\nProcess finished with exit code 1\nDoes anyone meet the same things? Or this is a bug of tensorflow. It's really a strange problem.", "body": "I trained faster-rcnn on coco dataset, when iter =11410, it appears a problem:\r\nimage: COCO_train2014_000000076146.jpg iter: 11410 / 200000, total loss: 3.3490, rpn_loss_cls: 0.7608, rpn_loss_box: 1.0145, loss_cls: 0.7640, loss_box: 0.8098, lr: 0.001000\r\nspeed: 0.327s / iter\r\n2017-06-08 22:59:42.143627: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: **Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero**\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\n2017-06-08 22:59:42.143670: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: **Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero**\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\n2017-06-08 22:59:42.143965: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\n2017-06-08 22:59:42.144042: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\n2017-06-08 22:59:42.145758: W tensorflow/core/framework/op_kernel.cc:1152] Invalid argument: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\nTraceback (most recent call last):\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in \r\nrestore=bool(int(args.restore)))\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net\r\nsw.train_model(sess, max_iters, restore=restore)\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 255, in train_model\r\ncls_prob, bbox_pred, rois = sess.run(fetches=fetch_list, feed_dict=feed_dict)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 778, in run\r\nrun_metadata_ptr)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 982, in _run\r\nfeed_dict_string, options, run_metadata)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1032, in _do_run\r\ntarget_list, options, run_metadata)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1052, in _do_call\r\nraise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: **Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero**\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\n\r\nCaused by op u'gradients/TopKV2_grad/Reshape', defined at:\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in \r\nrestore=bool(int(args.restore)))\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net\r\nsw.train_model(sess, max_iters, restore=restore)\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 142, in train_model\r\ngrads, norm = tf.clip_by_global_norm(tf.gradients(loss, tvars), 10.0)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 560, in gradients\r\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 368, in _MaybeCompile\r\nreturn grad_fn() # Exit early\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py\", line 560, in \r\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_grad.py\", line 577, in _TopKGrad\r\nind_2d = array_ops.reshape(op.outputs[1], array_ops.stack([-1, ind_lastdim]))\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2510, in reshape\r\nname=name)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 768, in apply_op\r\nop_def=op_def)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2336, in create_op\r\noriginal_op=self._default_original_op, op_def=op_def)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1228, in init\r\nself._traceback = _extract_stack()\r\n\r\n...which was originally created as op u'TopKV2', defined at:\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/train_net.py\", line 132, in \r\nrestore=bool(int(args.restore)))\r\n[elided 0 identical lines from previous traceback]\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 400, in train_net\r\nsw.train_model(sess, max_iters, restore=restore)\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/fast_rcnn/train.py\", line 112, in train_model\r\nself.net.build_loss(ohem=cfg.TRAIN.OHEM)\r\nFile \"/home/yanchao/TFFRCNN/faster_rcnn/../lib/networks/network.py\", line 643, in build_loss\r\nrpn_cross_entropy_n_neg, _ = tf.nn.top_k(rpn_cross_entropy_n_neg, k=top_k)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 1998, in top_k\r\nreturn gen_nn_ops._top_kv2(input, k=k, sorted=sorted, name=name)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 2502, in _top_kv2\r\nname=name)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 768, in apply_op\r\nop_def=op_def)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2336, in create_op\r\noriginal_op=self._default_original_op, op_def=op_def)\r\nFile \"/home/yanchao/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1228, in init\r\nself._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): **Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero**\r\n[[Node: gradients/TopKV2_grad/Reshape = Reshape[T=DT_INT32, Tshape=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TopKV2/_131, gradients/TopKV2_grad/stack)]]\r\n\r\nProcess finished with exit code 1\r\n\r\nDoes anyone meet the same things? Or this is a bug of tensorflow. It's really a strange problem."}