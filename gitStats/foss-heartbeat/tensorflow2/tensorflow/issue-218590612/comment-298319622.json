{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/298319622", "html_url": "https://github.com/tensorflow/tensorflow/issues/8879#issuecomment-298319622", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8879", "id": 298319622, "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODMxOTYyMg==", "user": {"login": "0fork", "id": 1594723, "node_id": "MDQ6VXNlcjE1OTQ3MjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/1594723?v=4", "gravatar_id": "", "url": "https://api.github.com/users/0fork", "html_url": "https://github.com/0fork", "followers_url": "https://api.github.com/users/0fork/followers", "following_url": "https://api.github.com/users/0fork/following{/other_user}", "gists_url": "https://api.github.com/users/0fork/gists{/gist_id}", "starred_url": "https://api.github.com/users/0fork/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/0fork/subscriptions", "organizations_url": "https://api.github.com/users/0fork/orgs", "repos_url": "https://api.github.com/users/0fork/repos", "events_url": "https://api.github.com/users/0fork/events{/privacy}", "received_events_url": "https://api.github.com/users/0fork/received_events", "type": "User", "site_admin": false}, "created_at": "2017-05-01T11:09:49Z", "updated_at": "2017-05-01T11:09:49Z", "author_association": "NONE", "body_html": "<p>I'm having this issue and can't figure out why it's happening because Theano works. The interesting thing is that I've to run theano with sudo or pygpu can't find cudnn handle either. If I try to run this TF script with sudo I crash immediately with the good old <code>Library not loaded: @rpath/libcudnn.5.dylib</code> that I can't seem to make go away no matter what tricks I try.</p>\n<p>I'm on MacOS 10.12 with 1080ti, CUDA 8 and cudnn 5.1.</p>\n<p>The log is pretty much the same as above:</p>\n<pre><code>2017-05-01 13:58:31.475182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:887] Found device 0 with properties:\nname: GeForce GTX 1080 Ti\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.683\npciBusID 0000:01:00.0\nTotal memory: 11.00GiB\nFree memory: 8.84GiB\n2017-05-01 13:58:31.475192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:908] DMA: 0\n2017-05-01 13:58:31.475195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:918] 0:   Y\n2017-05-01 13:58:31.475202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)\n2017-05-01 13:59:08.504593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)\n---------------------------------\nRun id: resnet_cifar10\nLog directory: /tmp/tflearn_logs/\n---------------------------------\nPreprocessing... Calculating mean over all dataset (this may take long)...\nMean: [ 0.49139968  0.48215841  0.44653091] (To avoid repetitive computation, add it to argument 'mean' of `add_featurewise_zero_center`)\n---------------------------------\nTraining samples: 50000\nValidation samples: 10000\n--\n2017-05-01 13:59:34.352806: E tensorflow/stream_executor/cuda/cuda_dnn.cc:359] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\n2017-05-01 13:59:34.352824: E tensorflow/stream_executor/cuda/cuda_dnn.cc:326] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\n2017-05-01 13:59:34.352831: F tensorflow/core/kernels/conv_ops.cc:659] Check failed: stream-&gt;parent()-&gt;GetConvolveAlgorithms(&amp;algorithms)\n</code></pre>\n<p>I tested the out of memory angle but it doesn't seem to be the issue because if I set TF to have <code>config.allow_soft_placement = True</code> and <code>config.gpu_options.allow_growth = True</code>, and watch cuda-smi executing I can see I've over 8GB of memory left once it crashes.</p>", "body_text": "I'm having this issue and can't figure out why it's happening because Theano works. The interesting thing is that I've to run theano with sudo or pygpu can't find cudnn handle either. If I try to run this TF script with sudo I crash immediately with the good old Library not loaded: @rpath/libcudnn.5.dylib that I can't seem to make go away no matter what tricks I try.\nI'm on MacOS 10.12 with 1080ti, CUDA 8 and cudnn 5.1.\nThe log is pretty much the same as above:\n2017-05-01 13:58:31.475182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:887] Found device 0 with properties:\nname: GeForce GTX 1080 Ti\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.683\npciBusID 0000:01:00.0\nTotal memory: 11.00GiB\nFree memory: 8.84GiB\n2017-05-01 13:58:31.475192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:908] DMA: 0\n2017-05-01 13:58:31.475195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:918] 0:   Y\n2017-05-01 13:58:31.475202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)\n2017-05-01 13:59:08.504593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)\n---------------------------------\nRun id: resnet_cifar10\nLog directory: /tmp/tflearn_logs/\n---------------------------------\nPreprocessing... Calculating mean over all dataset (this may take long)...\nMean: [ 0.49139968  0.48215841  0.44653091] (To avoid repetitive computation, add it to argument 'mean' of `add_featurewise_zero_center`)\n---------------------------------\nTraining samples: 50000\nValidation samples: 10000\n--\n2017-05-01 13:59:34.352806: E tensorflow/stream_executor/cuda/cuda_dnn.cc:359] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\n2017-05-01 13:59:34.352824: E tensorflow/stream_executor/cuda/cuda_dnn.cc:326] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\n2017-05-01 13:59:34.352831: F tensorflow/core/kernels/conv_ops.cc:659] Check failed: stream->parent()->GetConvolveAlgorithms(&algorithms)\n\nI tested the out of memory angle but it doesn't seem to be the issue because if I set TF to have config.allow_soft_placement = True and config.gpu_options.allow_growth = True, and watch cuda-smi executing I can see I've over 8GB of memory left once it crashes.", "body": "I'm having this issue and can't figure out why it's happening because Theano works. The interesting thing is that I've to run theano with sudo or pygpu can't find cudnn handle either. If I try to run this TF script with sudo I crash immediately with the good old `Library not loaded: @rpath/libcudnn.5.dylib` that I can't seem to make go away no matter what tricks I try.\r\n\r\nI'm on MacOS 10.12 with 1080ti, CUDA 8 and cudnn 5.1.\r\n\r\nThe log is pretty much the same as above:\r\n```\r\n2017-05-01 13:58:31.475182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:887] Found device 0 with properties:\r\nname: GeForce GTX 1080 Ti\r\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.683\r\npciBusID 0000:01:00.0\r\nTotal memory: 11.00GiB\r\nFree memory: 8.84GiB\r\n2017-05-01 13:58:31.475192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:908] DMA: 0\r\n2017-05-01 13:58:31.475195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:918] 0:   Y\r\n2017-05-01 13:58:31.475202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)\r\n2017-05-01 13:59:08.504593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0)\r\n---------------------------------\r\nRun id: resnet_cifar10\r\nLog directory: /tmp/tflearn_logs/\r\n---------------------------------\r\nPreprocessing... Calculating mean over all dataset (this may take long)...\r\nMean: [ 0.49139968  0.48215841  0.44653091] (To avoid repetitive computation, add it to argument 'mean' of `add_featurewise_zero_center`)\r\n---------------------------------\r\nTraining samples: 50000\r\nValidation samples: 10000\r\n--\r\n2017-05-01 13:59:34.352806: E tensorflow/stream_executor/cuda/cuda_dnn.cc:359] could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2017-05-01 13:59:34.352824: E tensorflow/stream_executor/cuda/cuda_dnn.cc:326] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\r\n2017-05-01 13:59:34.352831: F tensorflow/core/kernels/conv_ops.cc:659] Check failed: stream->parent()->GetConvolveAlgorithms(&algorithms)\r\n```\r\n\r\nI tested the out of memory angle but it doesn't seem to be the issue because if I set TF to have `config.allow_soft_placement = True` and `config.gpu_options.allow_growth = True`, and watch cuda-smi executing I can see I've over 8GB of memory left once it crashes."}