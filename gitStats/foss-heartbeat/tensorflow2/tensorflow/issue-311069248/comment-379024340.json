{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/379024340", "html_url": "https://github.com/tensorflow/tensorflow/issues/18226#issuecomment-379024340", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18226", "id": 379024340, "node_id": "MDEyOklzc3VlQ29tbWVudDM3OTAyNDM0MA==", "user": {"login": "panfengli", "id": 18660165, "node_id": "MDQ6VXNlcjE4NjYwMTY1", "avatar_url": "https://avatars2.githubusercontent.com/u/18660165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/panfengli", "html_url": "https://github.com/panfengli", "followers_url": "https://api.github.com/users/panfengli/followers", "following_url": "https://api.github.com/users/panfengli/following{/other_user}", "gists_url": "https://api.github.com/users/panfengli/gists{/gist_id}", "starred_url": "https://api.github.com/users/panfengli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/panfengli/subscriptions", "organizations_url": "https://api.github.com/users/panfengli/orgs", "repos_url": "https://api.github.com/users/panfengli/repos", "events_url": "https://api.github.com/users/panfengli/events{/privacy}", "received_events_url": "https://api.github.com/users/panfengli/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-05T18:00:43Z", "updated_at": "2018-04-05T18:02:16Z", "author_association": "NONE", "body_html": "<p>Update (from <a href=\"https://stackoverflow.com/questions/49641098/tensorflow-dataset-batch-not-showing-the-real-batch-size\" rel=\"nofollow\">here</a>)</p>\n<p>Currently, to get a fully-defined static shape on the batched tensors, you need to tell TensorFlow explicitly to \"drop\" any \"remainder\" if the batch size does not divide the total number of elements evenly. To do this, replace the following line:</p>\n<pre><code>dataset = dataset.batch(opt.batchsize)\n</code></pre>\n<p>...with an application of <code>tf.contrib.data.batch_and_drop_remainder()</code>:</p>\n<pre><code>dataset = dataset.apply(tf.contrib.data.batch_and_drop_remainder(opt.batchsize))\n</code></pre>\n<p>I was wondering whether the similar function could be added to the <code>tf.data API</code>, which might help users who need a fully-defined static shape on the batched tensors.</p>\n<p>By the way, whether <code>tf.py_func</code> could add a new argument which specifies the data's shape.</p>", "body_text": "Update (from here)\nCurrently, to get a fully-defined static shape on the batched tensors, you need to tell TensorFlow explicitly to \"drop\" any \"remainder\" if the batch size does not divide the total number of elements evenly. To do this, replace the following line:\ndataset = dataset.batch(opt.batchsize)\n\n...with an application of tf.contrib.data.batch_and_drop_remainder():\ndataset = dataset.apply(tf.contrib.data.batch_and_drop_remainder(opt.batchsize))\n\nI was wondering whether the similar function could be added to the tf.data API, which might help users who need a fully-defined static shape on the batched tensors.\nBy the way, whether tf.py_func could add a new argument which specifies the data's shape.", "body": "Update (from [here](https://stackoverflow.com/questions/49641098/tensorflow-dataset-batch-not-showing-the-real-batch-size))\r\n\r\nCurrently, to get a fully-defined static shape on the batched tensors, you need to tell TensorFlow explicitly to \"drop\" any \"remainder\" if the batch size does not divide the total number of elements evenly. To do this, replace the following line:\r\n```\r\ndataset = dataset.batch(opt.batchsize)\r\n```\r\n...with an application of `tf.contrib.data.batch_and_drop_remainder()`:\r\n```\r\ndataset = dataset.apply(tf.contrib.data.batch_and_drop_remainder(opt.batchsize))\r\n```\r\n\r\nI was wondering whether the similar function could be added to the `tf.data API`, which might help users who need a fully-defined static shape on the batched tensors.\r\n\r\nBy the way, whether `tf.py_func` could add a new argument which specifies the data's shape."}