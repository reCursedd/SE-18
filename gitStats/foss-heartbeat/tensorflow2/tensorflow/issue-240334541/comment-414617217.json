{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/414617217", "html_url": "https://github.com/tensorflow/tensorflow/issues/11265#issuecomment-414617217", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11265", "id": 414617217, "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDYxNzIxNw==", "user": {"login": "wanghaiyun139", "id": 29390551, "node_id": "MDQ6VXNlcjI5MzkwNTUx", "avatar_url": "https://avatars2.githubusercontent.com/u/29390551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wanghaiyun139", "html_url": "https://github.com/wanghaiyun139", "followers_url": "https://api.github.com/users/wanghaiyun139/followers", "following_url": "https://api.github.com/users/wanghaiyun139/following{/other_user}", "gists_url": "https://api.github.com/users/wanghaiyun139/gists{/gist_id}", "starred_url": "https://api.github.com/users/wanghaiyun139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wanghaiyun139/subscriptions", "organizations_url": "https://api.github.com/users/wanghaiyun139/orgs", "repos_url": "https://api.github.com/users/wanghaiyun139/repos", "events_url": "https://api.github.com/users/wanghaiyun139/events{/privacy}", "received_events_url": "https://api.github.com/users/wanghaiyun139/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-21T09:47:19Z", "updated_at": "2018-08-21T09:47:19Z", "author_association": "NONE", "body_html": "<blockquote>\n<blockquote>\n<blockquote>\n<p>rpn_loss_cls: 0.164899<br>\nrpn_loss_box: 0.052974<br>\nloss_cls: 0.539121<br>\nloss_box: 0.132027<br>\nlr: 0.000100<br>\nspeed: 20.228s / iter<br>\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class4_3.PNG<br>\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class3_93.PNG<br>\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class2_50.PNG<br>\nd:\\tf-faster-rcnn-windows\\lib\\layer_utils\\proposal_target_layer.py(138)_sample_rois()<br>\n-&gt; keep_inds = np.append(fg_inds, bg_inds)<br>\n(Pdb) c<br>\nTraceback (most recent call last):<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1323, in _do_call<br>\nreturn fn(*args)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1302, in _run_fn<br>\nstatus, run_metadata)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 473, in <strong>exit</strong><br>\nc_api.TF_GetCode(self.status.status))<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Incompatible shapes: [0,44] vs. [128,44]<br>\n[[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]</p>\n</blockquote>\n</blockquote>\n</blockquote>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in <br>\nmax_iters=args.max_iters)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 377, in train_net<br>\nsw.train_model(sess, max_iters)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 294, in train_model<br>\nself.net.train_step(sess, blobs, train_op)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 497, in train_step<br>\nfeed_dict=feed_dict)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 889, in run<br>\nrun_metadata_ptr)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1120, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1317, in _do_run<br>\noptions, run_metadata)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1336, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Incompatible shapes: [0,44] vs. [128,44]<br>\n[[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]</p>\n<p>Caused by op 'gradients/LOSS_default/mul_9_grad/mul_1', defined at:<br>\nFile \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in <br>\nmax_iters=args.max_iters)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 377, in train_net<br>\nsw.train_model(sess, max_iters)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 248, in train_model<br>\nlr, train_op = self.construct_graph(sess)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 131, in construct_graph<br>\ngvs = self.optimizer.compute_gradients(loss)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 414, in compute_gradients<br>\ncolocate_gradients_with_ops=colocate_gradients_with_ops)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 581, in gradients<br>\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 353, in _MaybeCompile<br>\nreturn grad_fn()  # Exit early<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 581, in <br>\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_grad.py\", line 747, in _MulGrad<br>\narray_ops.reshape(math_ops.reduce_sum(x * grad, ry), sy))<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 894, in binary_op_wrapper<br>\nreturn func(x, y, name=name)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1117, in _mul_dispatch<br>\nreturn gen_math_ops._mul(x, y, name=name)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 2725, in _mul<br>\n\"Mul\", x=x, y=y, name=name)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper<br>\nop_def=op_def)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2956, in create_op<br>\nop_def=op_def)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1470, in <strong>init</strong><br>\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access</p>\n<p>...which was originally created as op 'LOSS_default/mul_9', defined at:<br>\nFile \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in <br>\nmax_iters=args.max_iters)<br>\n[elided 1 identical lines from previous traceback]<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 248, in train_model<br>\nlr, train_op = self.construct_graph(sess)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 123, in construct_graph<br>\nanchor_ratios=cfg.ANCHOR_RATIOS)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 434, in create_architecture<br>\nself._add_losses()<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 308, in _add_losses<br>\nloss_box = self._smooth_l1_loss(bbox_pred, bbox_targets, bbox_inside_weights, bbox_outside_weights)<br>\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 272, in _smooth_l1_loss<br>\nout_loss_box = bbox_outside_weights * in_loss_box<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 894, in binary_op_wrapper<br>\nreturn func(x, y, name=name)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1117, in _mul_dispatch<br>\nreturn gen_math_ops._mul(x, y, name=name)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 2725, in _mul<br>\n\"Mul\", x=x, y=y, name=name)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper<br>\nop_def=op_def)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2956, in create_op<br>\nop_def=op_def)<br>\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1470, in <strong>init</strong><br>\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access</p>\n<p>InvalidArgumentError (see above for traceback): Incompatible shapes: [0,44] vs. [128,44]<br>\n[[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]</p>", "body_text": "rpn_loss_cls: 0.164899\nrpn_loss_box: 0.052974\nloss_cls: 0.539121\nloss_box: 0.132027\nlr: 0.000100\nspeed: 20.228s / iter\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class4_3.PNG\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class3_93.PNG\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class2_50.PNG\nd:\\tf-faster-rcnn-windows\\lib\\layer_utils\\proposal_target_layer.py(138)_sample_rois()\n-> keep_inds = np.append(fg_inds, bg_inds)\n(Pdb) c\nTraceback (most recent call last):\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1323, in _do_call\nreturn fn(*args)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1302, in _run_fn\nstatus, run_metadata)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 473, in exit\nc_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Incompatible shapes: [0,44] vs. [128,44]\n[[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]\n\n\n\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in \nmax_iters=args.max_iters)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 377, in train_net\nsw.train_model(sess, max_iters)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 294, in train_model\nself.net.train_step(sess, blobs, train_op)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 497, in train_step\nfeed_dict=feed_dict)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 889, in run\nrun_metadata_ptr)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1120, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1317, in _do_run\noptions, run_metadata)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1336, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Incompatible shapes: [0,44] vs. [128,44]\n[[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]\nCaused by op 'gradients/LOSS_default/mul_9_grad/mul_1', defined at:\nFile \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in \nmax_iters=args.max_iters)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 377, in train_net\nsw.train_model(sess, max_iters)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 248, in train_model\nlr, train_op = self.construct_graph(sess)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 131, in construct_graph\ngvs = self.optimizer.compute_gradients(loss)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 414, in compute_gradients\ncolocate_gradients_with_ops=colocate_gradients_with_ops)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 581, in gradients\ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 353, in _MaybeCompile\nreturn grad_fn()  # Exit early\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 581, in \ngrad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_grad.py\", line 747, in _MulGrad\narray_ops.reshape(math_ops.reduce_sum(x * grad, ry), sy))\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 894, in binary_op_wrapper\nreturn func(x, y, name=name)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1117, in _mul_dispatch\nreturn gen_math_ops._mul(x, y, name=name)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 2725, in _mul\n\"Mul\", x=x, y=y, name=name)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\nop_def=op_def)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2956, in create_op\nop_def=op_def)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1470, in init\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n...which was originally created as op 'LOSS_default/mul_9', defined at:\nFile \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in \nmax_iters=args.max_iters)\n[elided 1 identical lines from previous traceback]\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 248, in train_model\nlr, train_op = self.construct_graph(sess)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\model\\train_val.py\", line 123, in construct_graph\nanchor_ratios=cfg.ANCHOR_RATIOS)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 434, in create_architecture\nself._add_losses()\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 308, in _add_losses\nloss_box = self._smooth_l1_loss(bbox_pred, bbox_targets, bbox_inside_weights, bbox_outside_weights)\nFile \"D:\\tf-faster-rcnn-windows\\tools..\\lib\\nets\\network.py\", line 272, in _smooth_l1_loss\nout_loss_box = bbox_outside_weights * in_loss_box\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 894, in binary_op_wrapper\nreturn func(x, y, name=name)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1117, in _mul_dispatch\nreturn gen_math_ops._mul(x, y, name=name)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 2725, in _mul\n\"Mul\", x=x, y=y, name=name)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\nop_def=op_def)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2956, in create_op\nop_def=op_def)\nFile \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1470, in init\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\nInvalidArgumentError (see above for traceback): Incompatible shapes: [0,44] vs. [128,44]\n[[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]", "body": " >>> rpn_loss_cls: 0.164899\r\n >>> rpn_loss_box: 0.052974\r\n >>> loss_cls: 0.539121\r\n >>> loss_box: 0.132027\r\n >>> lr: 0.000100\r\nspeed: 20.228s / iter\r\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class4_3.PNG\r\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class3_93.PNG\r\nimage: D:\\tf-faster-rcnn-windows\\data\\VOCdevkit2007\\VOC2007\\JPEGImages\\class2_50.PNG\r\n> d:\\tf-faster-rcnn-windows\\lib\\layer_utils\\proposal_target_layer.py(138)_sample_rois()\r\n-> keep_inds = np.append(fg_inds, bg_inds)\r\n(Pdb) c\r\nTraceback (most recent call last):\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1323, in _do_call\r\n    return fn(*args)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1302, in _run_fn\r\n    status, run_metadata)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 473, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Incompatible shapes: [0,44] vs. [128,44]\r\n\t [[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in <module>\r\n    max_iters=args.max_iters)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 377, in train_net\r\n    sw.train_model(sess, max_iters)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 294, in train_model\r\n    self.net.train_step(sess, blobs, train_op)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\nets\\network.py\", line 497, in train_step\r\n    feed_dict=feed_dict)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 889, in run\r\n    run_metadata_ptr)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1120, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1317, in _do_run\r\n    options, run_metadata)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1336, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Incompatible shapes: [0,44] vs. [128,44]\r\n\t [[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]\r\n\r\nCaused by op 'gradients/LOSS_default/mul_9_grad/mul_1', defined at:\r\n  File \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in <module>\r\n    max_iters=args.max_iters)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 377, in train_net\r\n    sw.train_model(sess, max_iters)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 248, in train_model\r\n    lr, train_op = self.construct_graph(sess)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 131, in construct_graph\r\n    gvs = self.optimizer.compute_gradients(loss)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 414, in compute_gradients\r\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 581, in gradients\r\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 353, in _MaybeCompile\r\n    return grad_fn()  # Exit early\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 581, in <lambda>\r\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_grad.py\", line 747, in _MulGrad\r\n    array_ops.reshape(math_ops.reduce_sum(x * grad, ry), sy))\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 894, in binary_op_wrapper\r\n    return func(x, y, name=name)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1117, in _mul_dispatch\r\n    return gen_math_ops._mul(x, y, name=name)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 2725, in _mul\r\n    \"Mul\", x=x, y=y, name=name)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2956, in create_op\r\n    op_def=op_def)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1470, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\n...which was originally created as op 'LOSS_default/mul_9', defined at:\r\n  File \"D:/tf-faster-rcnn-windows/tools/trainval_net.py\", line 143, in <module>\r\n    max_iters=args.max_iters)\r\n[elided 1 identical lines from previous traceback]\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 248, in train_model\r\n    lr, train_op = self.construct_graph(sess)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\model\\train_val.py\", line 123, in construct_graph\r\n    anchor_ratios=cfg.ANCHOR_RATIOS)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\nets\\network.py\", line 434, in create_architecture\r\n    self._add_losses()\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\nets\\network.py\", line 308, in _add_losses\r\n    loss_box = self._smooth_l1_loss(bbox_pred, bbox_targets, bbox_inside_weights, bbox_outside_weights)\r\n  File \"D:\\tf-faster-rcnn-windows\\tools\\..\\lib\\nets\\network.py\", line 272, in _smooth_l1_loss\r\n    out_loss_box = bbox_outside_weights * in_loss_box\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 894, in binary_op_wrapper\r\n    return func(x, y, name=name)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1117, in _mul_dispatch\r\n    return gen_math_ops._mul(x, y, name=name)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 2725, in _mul\r\n    \"Mul\", x=x, y=y, name=name)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2956, in create_op\r\n    op_def=op_def)\r\n  File \"D:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1470, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): Incompatible shapes: [0,44] vs. [128,44]\r\n\t [[Node: gradients/LOSS_default/mul_9_grad/mul_1 = Mul[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](vgg_16_1/rpn_rois/proposal_target:5, gradients/LOSS_default/Sum_1_grad/Tile)]]"}