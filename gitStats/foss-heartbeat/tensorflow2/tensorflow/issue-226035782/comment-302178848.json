{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/302178848", "html_url": "https://github.com/tensorflow/tensorflow/issues/9634#issuecomment-302178848", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9634", "id": 302178848, "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjE3ODg0OA==", "user": {"login": "jthestness", "id": 28744304, "node_id": "MDQ6VXNlcjI4NzQ0MzA0", "avatar_url": "https://avatars0.githubusercontent.com/u/28744304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jthestness", "html_url": "https://github.com/jthestness", "followers_url": "https://api.github.com/users/jthestness/followers", "following_url": "https://api.github.com/users/jthestness/following{/other_user}", "gists_url": "https://api.github.com/users/jthestness/gists{/gist_id}", "starred_url": "https://api.github.com/users/jthestness/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jthestness/subscriptions", "organizations_url": "https://api.github.com/users/jthestness/orgs", "repos_url": "https://api.github.com/users/jthestness/repos", "events_url": "https://api.github.com/users/jthestness/events{/privacy}", "received_events_url": "https://api.github.com/users/jthestness/received_events", "type": "User", "site_admin": false}, "created_at": "2017-05-17T18:11:19Z", "updated_at": "2017-05-23T05:06:57Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I could not get <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"226994008\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9751\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/9751/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/9751\">#9751</a> to work, but was able to fix this a different way without changing the relative include path in <code>tensorflow/stream_executor/cuda/cuda_dnn.cc</code>:</p>\n<div class=\"highlight highlight-source-diff\"><pre>index 6994db0..dad0d83 100644\n<span class=\"pl-md\">--- a/third_party/gpus/cuda_configure.bzl</span>\n<span class=\"pl-mi1\">+++ b/third_party/gpus/cuda_configure.bzl</span>\n<span class=\"pl-mdr\">@@ -875,8 +875,8 @@</span> def _create_cuda_repository(repository_ctx):\n   included_files = _read_dir(repository_ctx, cuda_include_path).replace(\n       cuda_include_path, '').splitlines()\n   if '/cudnn.h' not in included_files:\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>    genrules.append(_symlink_genrule_for_dir(repository_ctx, None, \"\",</span>\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>        \"cudnn-include\", [cudnn_header_dir + \"/cudnn.h\"], [\"include/cudnn.h\"]))</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>    genrules.append(_symlink_genrule_for_dir(repository_ctx, cudnn_header_dir,</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>        \"include\", \"cudnn-include\"))</span>\n   else:\n     genrules.append(\n             'filegroup(\\n' +</pre></div>\n<p>Will continue testing to decide whether to open an alternative PR</p>\n<p>EDIT: Tested and PR created here: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"230586534\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10126\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/10126/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/10126\">#10126</a></p>", "body_text": "I could not get #9751 to work, but was able to fix this a different way without changing the relative include path in tensorflow/stream_executor/cuda/cuda_dnn.cc:\nindex 6994db0..dad0d83 100644\n--- a/third_party/gpus/cuda_configure.bzl\n+++ b/third_party/gpus/cuda_configure.bzl\n@@ -875,8 +875,8 @@ def _create_cuda_repository(repository_ctx):\n   included_files = _read_dir(repository_ctx, cuda_include_path).replace(\n       cuda_include_path, '').splitlines()\n   if '/cudnn.h' not in included_files:\n-    genrules.append(_symlink_genrule_for_dir(repository_ctx, None, \"\",\n-        \"cudnn-include\", [cudnn_header_dir + \"/cudnn.h\"], [\"include/cudnn.h\"]))\n+    genrules.append(_symlink_genrule_for_dir(repository_ctx, cudnn_header_dir,\n+        \"include\", \"cudnn-include\"))\n   else:\n     genrules.append(\n             'filegroup(\\n' +\nWill continue testing to decide whether to open an alternative PR\nEDIT: Tested and PR created here: #10126", "body": "I could not get #9751 to work, but was able to fix this a different way without changing the relative include path in `tensorflow/stream_executor/cuda/cuda_dnn.cc`:\r\n```diff --git a/third_party/gpus/cuda_configure.bzl b/third_party/gpus/cuda_configure.bzl\r\nindex 6994db0..dad0d83 100644\r\n--- a/third_party/gpus/cuda_configure.bzl\r\n+++ b/third_party/gpus/cuda_configure.bzl\r\n@@ -875,8 +875,8 @@ def _create_cuda_repository(repository_ctx):\r\n   included_files = _read_dir(repository_ctx, cuda_include_path).replace(\r\n       cuda_include_path, '').splitlines()\r\n   if '/cudnn.h' not in included_files:\r\n-    genrules.append(_symlink_genrule_for_dir(repository_ctx, None, \"\",\r\n-        \"cudnn-include\", [cudnn_header_dir + \"/cudnn.h\"], [\"include/cudnn.h\"]))\r\n+    genrules.append(_symlink_genrule_for_dir(repository_ctx, cudnn_header_dir,\r\n+        \"include\", \"cudnn-include\"))\r\n   else:\r\n     genrules.append(\r\n             'filegroup(\\n' +\r\n```\r\n\r\nWill continue testing to decide whether to open an alternative PR\r\n\r\nEDIT: Tested and PR created here: #10126"}