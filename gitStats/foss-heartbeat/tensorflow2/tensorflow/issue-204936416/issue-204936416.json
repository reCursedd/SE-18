{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7223", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7223/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7223/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7223/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7223", "id": 204936416, "node_id": "MDU6SXNzdWUyMDQ5MzY0MTY=", "number": 7223, "title": "OS/X doesn't compile Tensorflow", "user": {"login": "DavidNorman", "id": 606831, "node_id": "MDQ6VXNlcjYwNjgzMQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/606831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DavidNorman", "html_url": "https://github.com/DavidNorman", "followers_url": "https://api.github.com/users/DavidNorman/followers", "following_url": "https://api.github.com/users/DavidNorman/following{/other_user}", "gists_url": "https://api.github.com/users/DavidNorman/gists{/gist_id}", "starred_url": "https://api.github.com/users/DavidNorman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DavidNorman/subscriptions", "organizations_url": "https://api.github.com/users/DavidNorman/orgs", "repos_url": "https://api.github.com/users/DavidNorman/repos", "events_url": "https://api.github.com/users/DavidNorman/events{/privacy}", "received_events_url": "https://api.github.com/users/DavidNorman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2017-02-02T17:08:12Z", "updated_at": "2017-02-15T10:47:47Z", "closed_at": "2017-02-15T10:47:47Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Not sure of the exact circumstances of this, but I get an undefined symbol when trying to load the _pywrap_tensorflow.so.</p>\n<p>The symbol is __cpu_model.</p>\n<p>There is a discussion here about it: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"203004250\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/numpy/numpy/issues/8530\" data-hovercard-type=\"issue\" data-hovercard-url=\"/numpy/numpy/issues/8530/hovercard\" href=\"https://github.com/numpy/numpy/issues/8530\">numpy/numpy#8530</a></p>\n<p>It seems that the file crc32c_accelerate.cc calls the compiler function <code>__builtin_cpu_supports</code>.  While there is a test for the presence of this at the top of the file, there might be a bug in llvm/clang where this function references a symbol called __cpu_model, which isn't compiled into the final .so file.</p>\n<p>As a test, I compiled:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nmain() {\n  if (__builtin_cpu_supports(\"sse4.2\")) {\n    puts(\"a\");\n  }\n}\n</code></pre>\n<p>and I received:</p>\n<pre><code>Undefined symbols for architecture x86_64:\n  \"___cpu_model\", referenced from:\n      _main in t-2e30e2.o\nld: symbol(s) not found for architecture x86_64\n</code></pre>\n<p>My version of clang is:</p>\n<pre><code>Apple LLVM version 7.3.0 (clang-703.0.31)\nTarget: x86_64-apple-darwin15.6.0\n</code></pre>", "body_text": "Not sure of the exact circumstances of this, but I get an undefined symbol when trying to load the _pywrap_tensorflow.so.\nThe symbol is __cpu_model.\nThere is a discussion here about it: numpy/numpy#8530\nIt seems that the file crc32c_accelerate.cc calls the compiler function __builtin_cpu_supports.  While there is a test for the presence of this at the top of the file, there might be a bug in llvm/clang where this function references a symbol called __cpu_model, which isn't compiled into the final .so file.\nAs a test, I compiled:\n#include <stdio.h>\n\nmain() {\n  if (__builtin_cpu_supports(\"sse4.2\")) {\n    puts(\"a\");\n  }\n}\n\nand I received:\nUndefined symbols for architecture x86_64:\n  \"___cpu_model\", referenced from:\n      _main in t-2e30e2.o\nld: symbol(s) not found for architecture x86_64\n\nMy version of clang is:\nApple LLVM version 7.3.0 (clang-703.0.31)\nTarget: x86_64-apple-darwin15.6.0", "body": "Not sure of the exact circumstances of this, but I get an undefined symbol when trying to load the _pywrap_tensorflow.so.\r\n\r\nThe symbol is __cpu_model.  \r\n\r\nThere is a discussion here about it: https://github.com/numpy/numpy/issues/8530\r\n\r\nIt seems that the file crc32c_accelerate.cc calls the compiler function `__builtin_cpu_supports`.  While there is a test for the presence of this at the top of the file, there might be a bug in llvm/clang where this function references a symbol called __cpu_model, which isn't compiled into the final .so file.\r\n\r\nAs a test, I compiled:\r\n```\r\n#include <stdio.h>\r\n\r\nmain() {\r\n  if (__builtin_cpu_supports(\"sse4.2\")) {\r\n    puts(\"a\");\r\n  }\r\n}\r\n```\r\n\r\nand I received:\r\n```\r\nUndefined symbols for architecture x86_64:\r\n  \"___cpu_model\", referenced from:\r\n      _main in t-2e30e2.o\r\nld: symbol(s) not found for architecture x86_64\r\n```\r\n\r\nMy version of clang is:\r\n```\r\nApple LLVM version 7.3.0 (clang-703.0.31)\r\nTarget: x86_64-apple-darwin15.6.0\r\n```\r\n\r\n"}