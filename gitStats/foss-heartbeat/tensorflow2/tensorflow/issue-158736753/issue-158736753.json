{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2690", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2690/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2690/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2690/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2690", "id": 158736753, "node_id": "MDU6SXNzdWUxNTg3MzY3NTM=", "number": 2690, "title": "Shape inference for Reverse doesn't support unknown shape", "user": {"login": "yaroslavvb", "id": 23068, "node_id": "MDQ6VXNlcjIzMDY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaroslavvb", "html_url": "https://github.com/yaroslavvb", "followers_url": "https://api.github.com/users/yaroslavvb/followers", "following_url": "https://api.github.com/users/yaroslavvb/following{/other_user}", "gists_url": "https://api.github.com/users/yaroslavvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaroslavvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaroslavvb/subscriptions", "organizations_url": "https://api.github.com/users/yaroslavvb/orgs", "repos_url": "https://api.github.com/users/yaroslavvb/repos", "events_url": "https://api.github.com/users/yaroslavvb/events{/privacy}", "received_events_url": "https://api.github.com/users/yaroslavvb/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-06-06T17:56:46Z", "updated_at": "2017-07-05T04:35:14Z", "closed_at": "2016-06-07T04:21:20Z", "author_association": "CONTRIBUTOR", "body_html": "<p>This crashes</p>\n<pre><code>import tensorflow as tf\ndims = tf.placeholder(tf.bool)\ntensor = tf.placeholder(tf.int32)\nresult = tf.reverse(tensor, dims)\nprint(result.get_shape())\n\n</code></pre>\n<p>Stack trace</p>\n<pre><code>\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/contrib/immediate/python/immediate/env_extra_test.py\", line 39, in testReverse\n    result = tf.reverse(tensor, dims)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/gen_array_ops.py\", line 1405, in reverse\n    name=name)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/op_def_library.py\", line 704, in apply_op\n    op_def=op_def)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 2251, in create_op\n    set_shapes_for_outputs(ret)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 1696, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/array_ops.py\", line 631, in _ReverseShape\n    input_shape = op.inputs[0].get_shape().with_rank(dims_shape[0])\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py\", line 639, in with_rank\n    return self.merge_with(unknown_shape(ndims=rank))\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py\", line 816, in unknown_shape\n    return TensorShape([Dimension(None)] * ndims)\nTypeError: __index__ returned non-(int,long) (type NoneType)\n&gt; /Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py(816)unknown_shape()\n-&gt; return TensorShape([Dimension(None)] * ndims)\n\n</code></pre>", "body_text": "This crashes\nimport tensorflow as tf\ndims = tf.placeholder(tf.bool)\ntensor = tf.placeholder(tf.int32)\nresult = tf.reverse(tensor, dims)\nprint(result.get_shape())\n\n\nStack trace\n\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/contrib/immediate/python/immediate/env_extra_test.py\", line 39, in testReverse\n    result = tf.reverse(tensor, dims)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/gen_array_ops.py\", line 1405, in reverse\n    name=name)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/op_def_library.py\", line 704, in apply_op\n    op_def=op_def)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 2251, in create_op\n    set_shapes_for_outputs(ret)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 1696, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/array_ops.py\", line 631, in _ReverseShape\n    input_shape = op.inputs[0].get_shape().with_rank(dims_shape[0])\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py\", line 639, in with_rank\n    return self.merge_with(unknown_shape(ndims=rank))\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py\", line 816, in unknown_shape\n    return TensorShape([Dimension(None)] * ndims)\nTypeError: __index__ returned non-(int,long) (type NoneType)\n> /Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py(816)unknown_shape()\n-> return TensorShape([Dimension(None)] * ndims)", "body": "This crashes\n\n```\nimport tensorflow as tf\ndims = tf.placeholder(tf.bool)\ntensor = tf.placeholder(tf.int32)\nresult = tf.reverse(tensor, dims)\nprint(result.get_shape())\n\n```\n\nStack trace\n\n```\n\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/contrib/immediate/python/immediate/env_extra_test.py\", line 39, in testReverse\n    result = tf.reverse(tensor, dims)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/gen_array_ops.py\", line 1405, in reverse\n    name=name)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/op_def_library.py\", line 704, in apply_op\n    op_def=op_def)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 2251, in create_op\n    set_shapes_for_outputs(ret)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py\", line 1696, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/ops/array_ops.py\", line 631, in _ReverseShape\n    input_shape = op.inputs[0].get_shape().with_rank(dims_shape[0])\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py\", line 639, in with_rank\n    return self.merge_with(unknown_shape(ndims=rank))\n  File \"/Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py\", line 816, in unknown_shape\n    return TensorShape([Dimension(None)] * ndims)\nTypeError: __index__ returned non-(int,long) (type NoneType)\n> /Users/yaroslavvb/tfimmediate_macbook/tensorflow/bazel-bin/tensorflow/contrib/immediate/env_extra_test.runfiles/org_tensorflow/tensorflow/python/framework/tensor_shape.py(816)unknown_shape()\n-> return TensorShape([Dimension(None)] * ndims)\n\n```\n"}