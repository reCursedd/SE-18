{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/366211509", "html_url": "https://github.com/tensorflow/tensorflow/issues/12683#issuecomment-366211509", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12683", "id": 366211509, "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjIxMTUwOQ==", "user": {"login": "hzhangxyz", "id": 11623447, "node_id": "MDQ6VXNlcjExNjIzNDQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/11623447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hzhangxyz", "html_url": "https://github.com/hzhangxyz", "followers_url": "https://api.github.com/users/hzhangxyz/followers", "following_url": "https://api.github.com/users/hzhangxyz/following{/other_user}", "gists_url": "https://api.github.com/users/hzhangxyz/gists{/gist_id}", "starred_url": "https://api.github.com/users/hzhangxyz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hzhangxyz/subscriptions", "organizations_url": "https://api.github.com/users/hzhangxyz/orgs", "repos_url": "https://api.github.com/users/hzhangxyz/repos", "events_url": "https://api.github.com/users/hzhangxyz/events{/privacy}", "received_events_url": "https://api.github.com/users/hzhangxyz/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-16T11:28:04Z", "updated_at": "2018-02-16T11:34:44Z", "author_association": "NONE", "body_html": "<p>well, lastest tensorflow doesn't have this problem for this code indeed. but the following code still reproduces the similar core dump.</p>\n<pre><code>import tensorflow as tf\nimport sys\nD = 2\nA = tf.random_normal(shape=[D, D, 2], dtype=tf.float32,name=\"A\")\nB = tf.random_normal(shape=[D, D, 2], dtype=tf.float32, name=\"B\")\nif len(sys.argv)%2:\n    fun = tf.random_normal\nelse:\n    fun = tf.ones\nE = fun(shape=[D], dtype=tf.float32, name=\"EBA\")\nH = tf.reshape(tf.constant([[0.25,0,0,0],[0,-0.25,0.5,0],[0,0.5,-0.25,0],[0,0,0,0.25]],\n                           dtype=tf.float32),[2,2,2,2],name=\"Hamiltonian\")\nEA = tf.multiply(A,tf.reshape(E,[D,1,1]))\nAB = tf.tensordot(EA,B,[[1],[0]],name=\"AB\")\nS, U, V = tf.svd(tf.reshape(AB,[2*D,2*D]))\nUU = tf.transpose(tf.multiply(tf.reshape(U[:,:D],[D,2,D]),tf.reshape(E,[D,1,1])),[0,2,1],name=\"nA\")\ndata = UU / tf.reduce_max(UU)\nconfig = tf.ConfigProto()\nif len(sys.argv)&gt;2:\n    config.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\nsess.run(tf.global_variables_initializer())\nprint sess.run(data)\n</code></pre>\n<p>the only difference is changing tf.ones to tf.random_normal.</p>\n<p>all of <code>python2 main.py</code>, <code>python2 main.py -</code>, <code>python2 main.py - - -</code> run correctly<br>\nbut <code>python2 main.py - -</code> still core dump</p>\n<p>tf version: (<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/56422034fe039d7e8a57392957ed0c8b4b4efe56/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/56422034fe039d7e8a57392957ed0c8b4b4efe56\"><tt>5642203</tt></a>)</p>", "body_text": "well, lastest tensorflow doesn't have this problem for this code indeed. but the following code still reproduces the similar core dump.\nimport tensorflow as tf\nimport sys\nD = 2\nA = tf.random_normal(shape=[D, D, 2], dtype=tf.float32,name=\"A\")\nB = tf.random_normal(shape=[D, D, 2], dtype=tf.float32, name=\"B\")\nif len(sys.argv)%2:\n    fun = tf.random_normal\nelse:\n    fun = tf.ones\nE = fun(shape=[D], dtype=tf.float32, name=\"EBA\")\nH = tf.reshape(tf.constant([[0.25,0,0,0],[0,-0.25,0.5,0],[0,0.5,-0.25,0],[0,0,0,0.25]],\n                           dtype=tf.float32),[2,2,2,2],name=\"Hamiltonian\")\nEA = tf.multiply(A,tf.reshape(E,[D,1,1]))\nAB = tf.tensordot(EA,B,[[1],[0]],name=\"AB\")\nS, U, V = tf.svd(tf.reshape(AB,[2*D,2*D]))\nUU = tf.transpose(tf.multiply(tf.reshape(U[:,:D],[D,2,D]),tf.reshape(E,[D,1,1])),[0,2,1],name=\"nA\")\ndata = UU / tf.reduce_max(UU)\nconfig = tf.ConfigProto()\nif len(sys.argv)>2:\n    config.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\nsess.run(tf.global_variables_initializer())\nprint sess.run(data)\n\nthe only difference is changing tf.ones to tf.random_normal.\nall of python2 main.py, python2 main.py -, python2 main.py - - - run correctly\nbut python2 main.py - - still core dump\ntf version: (5642203)", "body": "well, lastest tensorflow doesn't have this problem for this code indeed. but the following code still reproduces the similar core dump.\r\n\r\n```\r\nimport tensorflow as tf\r\nimport sys\r\nD = 2\r\nA = tf.random_normal(shape=[D, D, 2], dtype=tf.float32,name=\"A\")\r\nB = tf.random_normal(shape=[D, D, 2], dtype=tf.float32, name=\"B\")\r\nif len(sys.argv)%2:\r\n    fun = tf.random_normal\r\nelse:\r\n    fun = tf.ones\r\nE = fun(shape=[D], dtype=tf.float32, name=\"EBA\")\r\nH = tf.reshape(tf.constant([[0.25,0,0,0],[0,-0.25,0.5,0],[0,0.5,-0.25,0],[0,0,0,0.25]],\r\n                           dtype=tf.float32),[2,2,2,2],name=\"Hamiltonian\")\r\nEA = tf.multiply(A,tf.reshape(E,[D,1,1]))\r\nAB = tf.tensordot(EA,B,[[1],[0]],name=\"AB\")\r\nS, U, V = tf.svd(tf.reshape(AB,[2*D,2*D]))\r\nUU = tf.transpose(tf.multiply(tf.reshape(U[:,:D],[D,2,D]),tf.reshape(E,[D,1,1])),[0,2,1],name=\"nA\")\r\ndata = UU / tf.reduce_max(UU)\r\nconfig = tf.ConfigProto()\r\nif len(sys.argv)>2:\r\n    config.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\r\nsess = tf.Session(config=config)\r\nsess.run(tf.global_variables_initializer())\r\nprint sess.run(data)\r\n```\r\n\r\nthe only difference is changing tf.ones to tf.random_normal.\r\n\r\nall of `python2 main.py`, `python2 main.py -`, `python2 main.py - - -` run correctly\r\nbut `python2 main.py - -` still core dump\r\n\r\ntf version: (56422034fe)"}