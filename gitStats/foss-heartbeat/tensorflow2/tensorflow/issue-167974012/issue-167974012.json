{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3540", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3540/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3540/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3540/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3540", "id": 167974012, "node_id": "MDU6SXNzdWUxNjc5NzQwMTI=", "number": 3540, "title": "Variable.assign throws expection randomly", "user": {"login": "mbz", "id": 1122127, "node_id": "MDQ6VXNlcjExMjIxMjc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1122127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbz", "html_url": "https://github.com/mbz", "followers_url": "https://api.github.com/users/mbz/followers", "following_url": "https://api.github.com/users/mbz/following{/other_user}", "gists_url": "https://api.github.com/users/mbz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbz/subscriptions", "organizations_url": "https://api.github.com/users/mbz/orgs", "repos_url": "https://api.github.com/users/mbz/repos", "events_url": "https://api.github.com/users/mbz/events{/privacy}", "received_events_url": "https://api.github.com/users/mbz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2016-07-27T22:43:12Z", "updated_at": "2016-07-29T20:40:57Z", "closed_at": "2016-07-29T20:40:57Z", "author_association": "NONE", "body_html": "<p>I'm trying to copy weights between two graphs which are running in two different processes simply by fetching the values from one, sending them to the second process and assigning the values there.</p>\n<p>The code I have is pretty simple and straight forward:</p>\n<pre><code>def get_all_variable_values(self):\n    vars = list(self.sess.graph.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES))\n    names = [v.name for v in vars]\n    values = self.sess.run(vars)\n    return dict(zip(names, values))\n\ndef set_all_variable_values(self, update_dict):\n    for var in self.sess.graph.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES):\n        self.sess.run(var.assign(update_dict[var.name]))\n</code></pre>\n<p>But time to time (seems to be completely random), the following exception happens.<br>\nI also tried replacing <code>Variable.assign</code> with <code>tf.assign</code> and the same problem happens.</p>\n<p>Any idea why?</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 715, in _do_call\n    return fn(*args)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 697, in _run_fn\n    status, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/errors.py\", line 450, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors.NotFoundError: FetchOutputs node Assign_404:0: not found\n\nDuring handling of the above exception, another exception occurred.\n\nTraceback (most recent call last):\n  File \"/home/mbz/anaconda3/lib/python3.5/threading.py\", line 914, in _bootstrap_inner\n    self.run()\n  File \"/home/mbz/anaconda3/lib/python3.5/threading.py\", line 862, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/home/mbz/projects/pacman_multi_gpu/ProcessServer.py\", line 50, in update_model\n    self.model.set_all_variable_values(update_dict)\n  File \"/home/mbz/projects/pacman_multi_gpu/NetworkVP.py\", line 258, in set_all_variable_values\n    self.sess.run(var.assign(update_dict[var.name]))\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 372, in run\n    run_metadata_ptr)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 636, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 708, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 728, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.NotFoundError: FetchOutputs node Assign_404:0: not found\n\n</code></pre>", "body_text": "I'm trying to copy weights between two graphs which are running in two different processes simply by fetching the values from one, sending them to the second process and assigning the values there.\nThe code I have is pretty simple and straight forward:\ndef get_all_variable_values(self):\n    vars = list(self.sess.graph.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES))\n    names = [v.name for v in vars]\n    values = self.sess.run(vars)\n    return dict(zip(names, values))\n\ndef set_all_variable_values(self, update_dict):\n    for var in self.sess.graph.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES):\n        self.sess.run(var.assign(update_dict[var.name]))\n\nBut time to time (seems to be completely random), the following exception happens.\nI also tried replacing Variable.assign with tf.assign and the same problem happens.\nAny idea why?\nTraceback (most recent call last):\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 715, in _do_call\n    return fn(*args)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 697, in _run_fn\n    status, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/errors.py\", line 450, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors.NotFoundError: FetchOutputs node Assign_404:0: not found\n\nDuring handling of the above exception, another exception occurred.\n\nTraceback (most recent call last):\n  File \"/home/mbz/anaconda3/lib/python3.5/threading.py\", line 914, in _bootstrap_inner\n    self.run()\n  File \"/home/mbz/anaconda3/lib/python3.5/threading.py\", line 862, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/home/mbz/projects/pacman_multi_gpu/ProcessServer.py\", line 50, in update_model\n    self.model.set_all_variable_values(update_dict)\n  File \"/home/mbz/projects/pacman_multi_gpu/NetworkVP.py\", line 258, in set_all_variable_values\n    self.sess.run(var.assign(update_dict[var.name]))\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 372, in run\n    run_metadata_ptr)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 636, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 708, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 728, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.NotFoundError: FetchOutputs node Assign_404:0: not found", "body": "I'm trying to copy weights between two graphs which are running in two different processes simply by fetching the values from one, sending them to the second process and assigning the values there.\n\nThe code I have is pretty simple and straight forward:\n\n```\ndef get_all_variable_values(self):\n    vars = list(self.sess.graph.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES))\n    names = [v.name for v in vars]\n    values = self.sess.run(vars)\n    return dict(zip(names, values))\n\ndef set_all_variable_values(self, update_dict):\n    for var in self.sess.graph.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES):\n        self.sess.run(var.assign(update_dict[var.name]))\n```\n\nBut time to time (seems to be completely random), the following exception happens.\nI also tried replacing `Variable.assign` with `tf.assign` and the same problem happens.\n\nAny idea why?\n\n```\nTraceback (most recent call last):\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 715, in _do_call\n    return fn(*args)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 697, in _run_fn\n    status, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/errors.py\", line 450, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors.NotFoundError: FetchOutputs node Assign_404:0: not found\n\nDuring handling of the above exception, another exception occurred.\n\nTraceback (most recent call last):\n  File \"/home/mbz/anaconda3/lib/python3.5/threading.py\", line 914, in _bootstrap_inner\n    self.run()\n  File \"/home/mbz/anaconda3/lib/python3.5/threading.py\", line 862, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/home/mbz/projects/pacman_multi_gpu/ProcessServer.py\", line 50, in update_model\n    self.model.set_all_variable_values(update_dict)\n  File \"/home/mbz/projects/pacman_multi_gpu/NetworkVP.py\", line 258, in set_all_variable_values\n    self.sess.run(var.assign(update_dict[var.name]))\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 372, in run\n    run_metadata_ptr)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 636, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 708, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/mbz/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 728, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.NotFoundError: FetchOutputs node Assign_404:0: not found\n\n```\n"}