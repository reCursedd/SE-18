{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7760", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7760/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7760/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7760/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7760", "id": 209354297, "node_id": "MDU6SXNzdWUyMDkzNTQyOTc=", "number": 7760, "title": "The GPU docker image doesn't work in CentOS 7", "user": {"login": "tobegit3hub", "id": 2715000, "node_id": "MDQ6VXNlcjI3MTUwMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/2715000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobegit3hub", "html_url": "https://github.com/tobegit3hub", "followers_url": "https://api.github.com/users/tobegit3hub/followers", "following_url": "https://api.github.com/users/tobegit3hub/following{/other_user}", "gists_url": "https://api.github.com/users/tobegit3hub/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobegit3hub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobegit3hub/subscriptions", "organizations_url": "https://api.github.com/users/tobegit3hub/orgs", "repos_url": "https://api.github.com/users/tobegit3hub/repos", "events_url": "https://api.github.com/users/tobegit3hub/events{/privacy}", "received_events_url": "https://api.github.com/users/tobegit3hub/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2017-02-22T05:10:11Z", "updated_at": "2017-02-23T09:40:06Z", "closed_at": "2017-02-23T09:40:06Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>Environment info</h3>\n<p>Operating System: CentOS 7.0</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):</p>\n<pre><code># ls /usr/local/cuda/lib64/libcuda*\n/usr/local/cuda/lib64/libcudadevrt.a    /usr/local/cuda/lib64/libcudart.so.8.0\n/usr/local/cuda/lib64/libcudart.so      /usr/local/cuda/lib64/libcudart.so.8.0.27\n/usr/local/cuda/lib64/libcudart.so.7.5  /usr/local/cuda/lib64/libcudart_static.a\n</code></pre>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<p>Refer to <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/tools/docker/README.md\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/tools/docker/README.md</a> , we change the path of cuda files for CentOS and run with the following commands.</p>\n<pre><code>export CUDA_SO=$(\\ls /usr/local/cuda/lib64/libcuda* | xargs -I{} echo '-v {}:{}')\nexport DEVICES=$(\\ls /dev/nvidia* | xargs -I{} echo '--device {}:{}')\ndocker run -it -p 8888:8888 $CUDA_SO $DEVICES gcr.io/tensorflow/tensorflow:latest-gpu bash\n</code></pre>\n<p>Now it can find the GPU devices but fail to init cuda library.</p>\n<h3>Logs or other output that would be helpful</h3>\n<p>(If logs are large, please upload as attachment or provide link).</p>\n<pre><code>root@f8e47e56d59d:/notebooks# python test_tensorflow.py\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:119] Couldn't open CUDA library libcuda.so.1. LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f8e47e56d59d\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: Not found: was unable to find libcuda.so DSO loaded into this program\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:363] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  361.77  Sun Jul 17 21:18:18 PDT 2016\nGCC version:  gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC)\n\"\"\"\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 361.77.0\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1092] LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1093] failed to find libcuda.so on this system: Failed precondition: could not dlopen DSO: libcuda.so.1; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally\nE tensorflow/stream_executor/cuda/cuda_driver.cc:509] failed call to cuInit: CUDA_ERROR_NO_DEVICE\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:158] retrieving CUDA diagnostic information for host: f8e47e56d59d\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f8e47e56d59d\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: Not found: was unable to find libcuda.so DSO loaded into this program\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:363] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  361.77  Sun Jul 17 21:18:18 PDT 2016\nGCC version:  gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC)\n\"\"\"\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 361.77.0\nWARNING:tensorflow:From a.py:20 in &lt;module&gt;.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\nInstructions for updating:\nUse `tf.global_variables_initializer` instead.\nEpoch: 1, w: -0.844658732414, b: 9.68447113037\nEpoch: 2, w: 0.321342378855, b: 10.4512624741\nEpoch: 3, w: 1.12122178078, b: 10.3018264771\nEpoch: 4, w: 1.55480694771, b: 10.155872345\nEpoch: 5, w: 1.77876627445, b: 10.0725793839\nEpoch: 6, w: 1.89310014248, b: 10.0290489197\nEpoch: 7, w: 1.95129656792, b: 10.0067615509\nEpoch: 8, w: 1.98089802265, b: 9.99540710449\nEpoch: 9, w: 1.99595046043, b: 9.98963069916\nEpoch: 10, w: 2.00360536575, b: 9.98669433594\n</code></pre>", "body_text": "Environment info\nOperating System: CentOS 7.0\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\n# ls /usr/local/cuda/lib64/libcuda*\n/usr/local/cuda/lib64/libcudadevrt.a    /usr/local/cuda/lib64/libcudart.so.8.0\n/usr/local/cuda/lib64/libcudart.so      /usr/local/cuda/lib64/libcudart.so.8.0.27\n/usr/local/cuda/lib64/libcudart.so.7.5  /usr/local/cuda/lib64/libcudart_static.a\n\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nRefer to https://github.com/tensorflow/tensorflow/blob/master/tensorflow/tools/docker/README.md , we change the path of cuda files for CentOS and run with the following commands.\nexport CUDA_SO=$(\\ls /usr/local/cuda/lib64/libcuda* | xargs -I{} echo '-v {}:{}')\nexport DEVICES=$(\\ls /dev/nvidia* | xargs -I{} echo '--device {}:{}')\ndocker run -it -p 8888:8888 $CUDA_SO $DEVICES gcr.io/tensorflow/tensorflow:latest-gpu bash\n\nNow it can find the GPU devices but fail to init cuda library.\nLogs or other output that would be helpful\n(If logs are large, please upload as attachment or provide link).\nroot@f8e47e56d59d:/notebooks# python test_tensorflow.py\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:119] Couldn't open CUDA library libcuda.so.1. LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f8e47e56d59d\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: Not found: was unable to find libcuda.so DSO loaded into this program\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:363] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  361.77  Sun Jul 17 21:18:18 PDT 2016\nGCC version:  gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC)\n\"\"\"\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 361.77.0\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1092] LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1093] failed to find libcuda.so on this system: Failed precondition: could not dlopen DSO: libcuda.so.1; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally\nE tensorflow/stream_executor/cuda/cuda_driver.cc:509] failed call to cuInit: CUDA_ERROR_NO_DEVICE\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:158] retrieving CUDA diagnostic information for host: f8e47e56d59d\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f8e47e56d59d\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: Not found: was unable to find libcuda.so DSO loaded into this program\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:363] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  361.77  Sun Jul 17 21:18:18 PDT 2016\nGCC version:  gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC)\n\"\"\"\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 361.77.0\nWARNING:tensorflow:From a.py:20 in <module>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\nInstructions for updating:\nUse `tf.global_variables_initializer` instead.\nEpoch: 1, w: -0.844658732414, b: 9.68447113037\nEpoch: 2, w: 0.321342378855, b: 10.4512624741\nEpoch: 3, w: 1.12122178078, b: 10.3018264771\nEpoch: 4, w: 1.55480694771, b: 10.155872345\nEpoch: 5, w: 1.77876627445, b: 10.0725793839\nEpoch: 6, w: 1.89310014248, b: 10.0290489197\nEpoch: 7, w: 1.95129656792, b: 10.0067615509\nEpoch: 8, w: 1.98089802265, b: 9.99540710449\nEpoch: 9, w: 1.99595046043, b: 9.98963069916\nEpoch: 10, w: 2.00360536575, b: 9.98669433594", "body": "### Environment info\r\nOperating System: CentOS 7.0\r\n\r\nInstalled version of CUDA and cuDNN: \r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n\r\n```\r\n# ls /usr/local/cuda/lib64/libcuda*\r\n/usr/local/cuda/lib64/libcudadevrt.a    /usr/local/cuda/lib64/libcudart.so.8.0\r\n/usr/local/cuda/lib64/libcudart.so      /usr/local/cuda/lib64/libcudart.so.8.0.27\r\n/usr/local/cuda/lib64/libcudart.so.7.5  /usr/local/cuda/lib64/libcudart_static.a\r\n```\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n\r\nRefer to https://github.com/tensorflow/tensorflow/blob/master/tensorflow/tools/docker/README.md , we change the path of cuda files for CentOS and run with the following commands.\r\n\r\n```\r\nexport CUDA_SO=$(\\ls /usr/local/cuda/lib64/libcuda* | xargs -I{} echo '-v {}:{}')\r\nexport DEVICES=$(\\ls /dev/nvidia* | xargs -I{} echo '--device {}:{}')\r\ndocker run -it -p 8888:8888 $CUDA_SO $DEVICES gcr.io/tensorflow/tensorflow:latest-gpu bash\r\n```\r\n\r\nNow it can find the GPU devices but fail to init cuda library.\r\n\r\n### Logs or other output that would be helpful\r\n(If logs are large, please upload as attachment or provide link).\r\n\r\n```\r\nroot@f8e47e56d59d:/notebooks# python test_tensorflow.py\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally\r\nI tensorflow/stream_executor/dso_loader.cc:119] Couldn't open CUDA library libcuda.so.1. LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f8e47e56d59d\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: Not found: was unable to find libcuda.so DSO loaded into this program\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:363] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  361.77  Sun Jul 17 21:18:18 PDT 2016\r\nGCC version:  gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC)\r\n\"\"\"\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 361.77.0\r\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1092] LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:\r\nI tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1093] failed to find libcuda.so on this system: Failed precondition: could not dlopen DSO: libcuda.so.1; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally\r\nE tensorflow/stream_executor/cuda/cuda_driver.cc:509] failed call to cuInit: CUDA_ERROR_NO_DEVICE\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:158] retrieving CUDA diagnostic information for host: f8e47e56d59d\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f8e47e56d59d\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: Not found: was unable to find libcuda.so DSO loaded into this program\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:363] driver version file contents: \"\"\"NVRM version: NVIDIA UNIX x86_64 Kernel Module  361.77  Sun Jul 17 21:18:18 PDT 2016\r\nGCC version:  gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC)\r\n\"\"\"\r\nI tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 361.77.0\r\nWARNING:tensorflow:From a.py:20 in <module>.: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.\r\nInstructions for updating:\r\nUse `tf.global_variables_initializer` instead.\r\nEpoch: 1, w: -0.844658732414, b: 9.68447113037\r\nEpoch: 2, w: 0.321342378855, b: 10.4512624741\r\nEpoch: 3, w: 1.12122178078, b: 10.3018264771\r\nEpoch: 4, w: 1.55480694771, b: 10.155872345\r\nEpoch: 5, w: 1.77876627445, b: 10.0725793839\r\nEpoch: 6, w: 1.89310014248, b: 10.0290489197\r\nEpoch: 7, w: 1.95129656792, b: 10.0067615509\r\nEpoch: 8, w: 1.98089802265, b: 9.99540710449\r\nEpoch: 9, w: 1.99595046043, b: 9.98963069916\r\nEpoch: 10, w: 2.00360536575, b: 9.98669433594\r\n```"}