{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/472", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/472/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/472/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/472/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/472", "id": 121599911, "node_id": "MDU6SXNzdWUxMjE1OTk5MTE=", "number": 472, "title": "bazel test numpy issue: RuntimeError: module compiled against API version a but this version of numpy is 7", "user": {"login": "yjernite", "id": 10469459, "node_id": "MDQ6VXNlcjEwNDY5NDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/10469459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yjernite", "html_url": "https://github.com/yjernite", "followers_url": "https://api.github.com/users/yjernite/followers", "following_url": "https://api.github.com/users/yjernite/following{/other_user}", "gists_url": "https://api.github.com/users/yjernite/gists{/gist_id}", "starred_url": "https://api.github.com/users/yjernite/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yjernite/subscriptions", "organizations_url": "https://api.github.com/users/yjernite/orgs", "repos_url": "https://api.github.com/users/yjernite/repos", "events_url": "https://api.github.com/users/yjernite/events{/privacy}", "received_events_url": "https://api.github.com/users/yjernite/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2015-12-10T23:14:17Z", "updated_at": "2017-01-05T07:19:52Z", "closed_at": "2016-02-19T07:59:46Z", "author_association": "NONE", "body_html": "<p>Hello everyone,</p>\n<p>I just wrote my own op, and finally got it to compile, but I'm having trouble running bazel test. Specifically, I get the following error:</p>\n<blockquote>\n<p>RuntimeError: module compiled against API version a but this version of numpy is 7</p>\n</blockquote>\n<p>I am surprised as I was able to compile tensorflow with bazel, and import it without any problems. Any ideas as to what might be causing this? My test is the following:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n<span class=\"pl-k\">class</span> <span class=\"pl-en\">ChainCRFTest</span>(<span class=\"pl-e\">tf</span>.<span class=\"pl-e\">test</span>.<span class=\"pl-e\">TestCase</span>):\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">testChainCRF</span>(<span class=\"pl-smi\"><span class=\"pl-smi\">self</span></span>):\n        <span class=\"pl-k\">with</span> <span class=\"pl-c1\">self</span>.test_session():\n            pre_pots <span class=\"pl-k\">=</span> [[[<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1</span>], [<span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>], [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>]],\n                        [[<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">1</span>], [<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>], [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>]],\n                        [[<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>], [<span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>], [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">2</span>]],\n                        [[<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">1</span>], [<span class=\"pl-c1\">4</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>], [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>]]]\n            potentials <span class=\"pl-k\">=</span> tf.convert_to_tensor(pre_pots, tf.float32)\n            result <span class=\"pl-k\">=</span> tf.user_ops.chain_crf(potentials)\n            <span class=\"pl-c1\">print</span>(result.eval()) <span class=\"pl-c\"><span class=\"pl-c\">#</span> <span class=\"pl-k\">TODO</span></span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> bazel test tensorflow/python:chain_crf_op_test --verbose_failures</span></pre></div>\n<p>And the full error:</p>\n<pre><code>$ cat /home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/testlogs/tensorflow/python/chain_crf_op_test/test.log\nexec ${PAGER:-/usr/bin/less} \"$0\" || exit 1\n-----------------------------------------------------------------------------\nRuntimeError: module compiled against API version a but this version of numpy is 7\nTraceback (most recent call last):\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/kernel_tests/chain_crf_op_test.py\", line 1, in &lt;module&gt;\n    import tensorflow as tf\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/__init__.py\", line 23, in &lt;module&gt;\n    from tensorflow.python import *\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/__init__.py\", line 50, in &lt;module&gt;\n    from tensorflow.python.framework.framework_lib import *\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/framework_lib.py\", line 62, in &lt;module&gt;\n    from tensorflow.python.framework.ops import Graph\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/ops.py\", line 40, in &lt;module&gt;\n    from tensorflow.python.framework import versions\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/versions.py\", line 24, in &lt;module&gt;\n    from tensorflow.python import pywrap_tensorflow\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/pywrap_tensorflow.py\", line 26, in &lt;module&gt;\n    _pywrap_tensorflow = swig_import_helper()\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/pywrap_tensorflow.py\", line 22, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\nImportError: numpy.core.multiarray failed to import\n</code></pre>\n<p>Thanks in advance,<br>\nYacine</p>", "body_text": "Hello everyone,\nI just wrote my own op, and finally got it to compile, but I'm having trouble running bazel test. Specifically, I get the following error:\n\nRuntimeError: module compiled against API version a but this version of numpy is 7\n\nI am surprised as I was able to compile tensorflow with bazel, and import it without any problems. Any ideas as to what might be causing this? My test is the following:\nimport tensorflow as tf\n\nclass ChainCRFTest(tf.test.TestCase):\n    def testChainCRF(self):\n        with self.test_session():\n            pre_pots = [[[1, 3, 1], [4, 1, 2], [2, 1, 1]],\n                        [[2, 2, 1], [3, 1, 1], [1, 2, 3]],\n                        [[3, 1, 1], [2, 1, 2], [1, 3, 2]],\n                        [[1, 2, 1], [4, 1, 3], [1, 1, 1]]]\n            potentials = tf.convert_to_tensor(pre_pots, tf.float32)\n            result = tf.user_ops.chain_crf(potentials)\n            print(result.eval()) # TODO\n\n# bazel test tensorflow/python:chain_crf_op_test --verbose_failures\nAnd the full error:\n$ cat /home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/testlogs/tensorflow/python/chain_crf_op_test/test.log\nexec ${PAGER:-/usr/bin/less} \"$0\" || exit 1\n-----------------------------------------------------------------------------\nRuntimeError: module compiled against API version a but this version of numpy is 7\nTraceback (most recent call last):\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/kernel_tests/chain_crf_op_test.py\", line 1, in <module>\n    import tensorflow as tf\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/__init__.py\", line 23, in <module>\n    from tensorflow.python import *\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/__init__.py\", line 50, in <module>\n    from tensorflow.python.framework.framework_lib import *\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/framework_lib.py\", line 62, in <module>\n    from tensorflow.python.framework.ops import Graph\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/ops.py\", line 40, in <module>\n    from tensorflow.python.framework import versions\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/versions.py\", line 24, in <module>\n    from tensorflow.python import pywrap_tensorflow\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/pywrap_tensorflow.py\", line 26, in <module>\n    _pywrap_tensorflow = swig_import_helper()\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/pywrap_tensorflow.py\", line 22, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\nImportError: numpy.core.multiarray failed to import\n\nThanks in advance,\nYacine", "body": "Hello everyone,\n\n  I just wrote my own op, and finally got it to compile, but I'm having trouble running bazel test. Specifically, I get the following error:\n\n> RuntimeError: module compiled against API version a but this version of numpy is 7\n\nI am surprised as I was able to compile tensorflow with bazel, and import it without any problems. Any ideas as to what might be causing this? My test is the following:\n\n``` python\nimport tensorflow as tf\n\nclass ChainCRFTest(tf.test.TestCase):\n    def testChainCRF(self):\n        with self.test_session():\n            pre_pots = [[[1, 3, 1], [4, 1, 2], [2, 1, 1]],\n                        [[2, 2, 1], [3, 1, 1], [1, 2, 3]],\n                        [[3, 1, 1], [2, 1, 2], [1, 3, 2]],\n                        [[1, 2, 1], [4, 1, 3], [1, 1, 1]]]\n            potentials = tf.convert_to_tensor(pre_pots, tf.float32)\n            result = tf.user_ops.chain_crf(potentials)\n            print(result.eval()) # TODO\n\n# bazel test tensorflow/python:chain_crf_op_test --verbose_failures\n```\n\nAnd the full error:\n\n```\n$ cat /home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/testlogs/tensorflow/python/chain_crf_op_test/test.log\nexec ${PAGER:-/usr/bin/less} \"$0\" || exit 1\n-----------------------------------------------------------------------------\nRuntimeError: module compiled against API version a but this version of numpy is 7\nTraceback (most recent call last):\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/kernel_tests/chain_crf_op_test.py\", line 1, in <module>\n    import tensorflow as tf\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/__init__.py\", line 23, in <module>\n    from tensorflow.python import *\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/__init__.py\", line 50, in <module>\n    from tensorflow.python.framework.framework_lib import *\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/framework_lib.py\", line 62, in <module>\n    from tensorflow.python.framework.ops import Graph\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/ops.py\", line 40, in <module>\n    from tensorflow.python.framework import versions\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/framework/versions.py\", line 24, in <module>\n    from tensorflow.python import pywrap_tensorflow\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/pywrap_tensorflow.py\", line 26, in <module>\n    _pywrap_tensorflow = swig_import_helper()\n  File \"/home/jernite/.cache/bazel/_bazel_jernite/f9fe393f3882802b0a658bd50e054d61/tensorflow/bazel-out/local_linux-fastbuild/bin/tensorflow/python/chain_crf_op_test.runfiles/tensorflow/python/pywrap_tensorflow.py\", line 22, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow', fp, pathname, description)\nImportError: numpy.core.multiarray failed to import\n```\n\nThanks in advance,\nYacine\n"}