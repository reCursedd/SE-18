{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6032", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6032/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6032/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6032/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6032", "id": 193039333, "node_id": "MDU6SXNzdWUxOTMwMzkzMzM=", "number": 6032, "title": "freeze_graph not working in v0.11.0 . giving V2 error", "user": {"login": "dhwajraj", "id": 9861437, "node_id": "MDQ6VXNlcjk4NjE0Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/9861437?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhwajraj", "html_url": "https://github.com/dhwajraj", "followers_url": "https://api.github.com/users/dhwajraj/followers", "following_url": "https://api.github.com/users/dhwajraj/following{/other_user}", "gists_url": "https://api.github.com/users/dhwajraj/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhwajraj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhwajraj/subscriptions", "organizations_url": "https://api.github.com/users/dhwajraj/orgs", "repos_url": "https://api.github.com/users/dhwajraj/repos", "events_url": "https://api.github.com/users/dhwajraj/events{/privacy}", "received_events_url": "https://api.github.com/users/dhwajraj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-12-02T05:47:26Z", "updated_at": "2016-12-07T06:35:09Z", "closed_at": "2016-12-05T21:18:40Z", "author_association": "NONE", "body_html": "<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"192315976\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5938\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5938/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5938\">#5938</a><br>\n<a href=\"https://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow</a><br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"189671732\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5639\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5639/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5639\">#5639</a><br>\n<a href=\"https://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow</a></p>\n<h3>Environment info</h3>\n<p>Operating System: CentOS (AWS p2.xlarge)</p>\n<p>Installed version of CUDA and cuDNN:  cuda 8.0 , cudnn 5.1.5<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):</p>\n<pre><code>/usr/local/cuda-8.0/lib64/libcudadevrt.a\n/usr/local/cuda-8.0/lib64/libcudart.so\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.44\n/usr/local/cuda-8.0/lib64/libcudart_static.a\n/usr/local/cuda-8.0/lib64/libcudnn.so\n/usr/local/cuda-8.0/lib64/libcudnn.so.5\n/usr/local/cuda-8.0/lib64/libcudnn.so.5.1.5\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\n</code></pre>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>A link to the pip package you installed:</li>\n<li>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.</li>\n</ol>\n<pre><code>0.11.0\n</code></pre>\n<p>If installed from source, provide</p>\n<ol>\n<li>The commit hash (<code>git rev-parse HEAD</code>)</li>\n</ol>\n<pre><code>https://github.com/tensorflow/tensorflow/archive/v0.11.0.zip\n</code></pre>\n<ol start=\"2\">\n<li>The output of <code>bazel version</code></li>\n</ol>\n<pre><code>Build label: 0.3.2\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\nBuild timestamp: 1475861110\nBuild timestamp as int: 1475861110\n</code></pre>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<p>I trained my convolution network on v0.11.0 and then running freeze_graph on the same tensorflow v0.11.0 . freeze_graph does not work.</p>\n<pre><code>saving model:\nsaver = tf.train.Saver(tf.all_variables(), max_to_keep=100)\nsaver.save(sess, checkpoint_prefix, global_step=current_step)\n\nwriting graph:\ntf.train.write_graph(sess.graph.as_graph_def(), checkpoint_prefix, \"graph\"+str(nn)+\".pb\", as_text=False)\n\nrunning freeze_graph:\ntensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=graph4000 --input_checkpoint=runs/1479444509/checkpoints/model-4000 --output_graph=my.pb --output_node_names=output0/predictions0,accuracy0/accuracy0,output0/scores0,output0/Softmax --input_binary=True --clear_devices=True --initializer_nodes=embedding/W\n\n</code></pre>\n<h3>What other attempted solutions have you tried?</h3>\n<h3>Logs or other output that would be helpful</h3>\n<pre><code>tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=graph4000 --input_checkpoint=runs/1479444509/checkpoints/model-4000 --output_graph=my.pb --output_node_names=output0/predictions0,accuracy0/accuracy0,output0/scores0,output0/Softmax --input_binary=True --clear_devices=True --initializer_nodes=embedding/W\nTraceback (most recent call last):\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 134, in &lt;module&gt;\n    tf.app.run()\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 131, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 103, in freeze_graph\n    _ = tf.import_graph_def(input_graph_def, name=\"\")\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 258, in import_graph_def\n    op_def = op_dict[node.op]\nKeyError: u'RestoreV2'\n</code></pre>", "body_text": "What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n#5938\nhttps://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow\n#5639\nhttps://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow\nEnvironment info\nOperating System: CentOS (AWS p2.xlarge)\nInstalled version of CUDA and cuDNN:  cuda 8.0 , cudnn 5.1.5\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\n/usr/local/cuda-8.0/lib64/libcudadevrt.a\n/usr/local/cuda-8.0/lib64/libcudart.so\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.44\n/usr/local/cuda-8.0/lib64/libcudart_static.a\n/usr/local/cuda-8.0/lib64/libcudnn.so\n/usr/local/cuda-8.0/lib64/libcudnn.so.5\n/usr/local/cuda-8.0/lib64/libcudnn.so.5.1.5\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\n\nIf installed from binary pip package, provide:\n\nA link to the pip package you installed:\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\n\n0.11.0\n\nIf installed from source, provide\n\nThe commit hash (git rev-parse HEAD)\n\nhttps://github.com/tensorflow/tensorflow/archive/v0.11.0.zip\n\n\nThe output of bazel version\n\nBuild label: 0.3.2\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\nBuild timestamp: 1475861110\nBuild timestamp as int: 1475861110\n\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nI trained my convolution network on v0.11.0 and then running freeze_graph on the same tensorflow v0.11.0 . freeze_graph does not work.\nsaving model:\nsaver = tf.train.Saver(tf.all_variables(), max_to_keep=100)\nsaver.save(sess, checkpoint_prefix, global_step=current_step)\n\nwriting graph:\ntf.train.write_graph(sess.graph.as_graph_def(), checkpoint_prefix, \"graph\"+str(nn)+\".pb\", as_text=False)\n\nrunning freeze_graph:\ntensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=graph4000 --input_checkpoint=runs/1479444509/checkpoints/model-4000 --output_graph=my.pb --output_node_names=output0/predictions0,accuracy0/accuracy0,output0/scores0,output0/Softmax --input_binary=True --clear_devices=True --initializer_nodes=embedding/W\n\n\nWhat other attempted solutions have you tried?\nLogs or other output that would be helpful\ntensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=graph4000 --input_checkpoint=runs/1479444509/checkpoints/model-4000 --output_graph=my.pb --output_node_names=output0/predictions0,accuracy0/accuracy0,output0/scores0,output0/Softmax --input_binary=True --clear_devices=True --initializer_nodes=embedding/W\nTraceback (most recent call last):\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 134, in <module>\n    tf.app.run()\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 131, in main\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 103, in freeze_graph\n    _ = tf.import_graph_def(input_graph_def, name=\"\")\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 258, in import_graph_def\n    op_def = op_dict[node.op]\nKeyError: u'RestoreV2'", "body": "### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nhttps://github.com/tensorflow/tensorflow/issues/5938\r\nhttps://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow\r\nhttps://github.com/tensorflow/tensorflow/issues/5639\r\nhttps://stackoverflow.com/questions/40616430/load-exported-model-in-tensorflow\r\n\r\n### Environment info\r\nOperating System: CentOS (AWS p2.xlarge)\r\n\r\nInstalled version of CUDA and cuDNN:  cuda 8.0 , cudnn 5.1.5\r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n```\r\n/usr/local/cuda-8.0/lib64/libcudadevrt.a\r\n/usr/local/cuda-8.0/lib64/libcudart.so\r\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0\r\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.44\r\n/usr/local/cuda-8.0/lib64/libcudart_static.a\r\n/usr/local/cuda-8.0/lib64/libcudnn.so\r\n/usr/local/cuda-8.0/lib64/libcudnn.so.5\r\n/usr/local/cuda-8.0/lib64/libcudnn.so.5.1.5\r\n/usr/local/cuda-8.0/lib64/libcudnn_static.a\r\n```\r\n\r\nIf installed from binary pip package, provide:\r\n\r\n1. A link to the pip package you installed:\r\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`. \r\n```\r\n0.11.0\r\n```\r\nIf installed from source, provide \r\n\r\n1. The commit hash (`git rev-parse HEAD`)\r\n```\r\nhttps://github.com/tensorflow/tensorflow/archive/v0.11.0.zip\r\n```\r\n2. The output of `bazel version`\r\n```\r\nBuild label: 0.3.2\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\r\nBuild timestamp: 1475861110\r\nBuild timestamp as int: 1475861110\r\n```\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\nI trained my convolution network on v0.11.0 and then running freeze_graph on the same tensorflow v0.11.0 . freeze_graph does not work.\r\n```\r\nsaving model:\r\nsaver = tf.train.Saver(tf.all_variables(), max_to_keep=100)\r\nsaver.save(sess, checkpoint_prefix, global_step=current_step)\r\n\r\nwriting graph:\r\ntf.train.write_graph(sess.graph.as_graph_def(), checkpoint_prefix, \"graph\"+str(nn)+\".pb\", as_text=False)\r\n\r\nrunning freeze_graph:\r\ntensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=graph4000 --input_checkpoint=runs/1479444509/checkpoints/model-4000 --output_graph=my.pb --output_node_names=output0/predictions0,accuracy0/accuracy0,output0/scores0,output0/Softmax --input_binary=True --clear_devices=True --initializer_nodes=embedding/W\r\n\r\n```\r\n\r\n\r\n### What other attempted solutions have you tried?\r\n\r\n\r\n### Logs or other output that would be helpful\r\n```\r\ntensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=graph4000 --input_checkpoint=runs/1479444509/checkpoints/model-4000 --output_graph=my.pb --output_node_names=output0/predictions0,accuracy0/accuracy0,output0/scores0,output0/Softmax --input_binary=True --clear_devices=True --initializer_nodes=embedding/W\r\nTraceback (most recent call last):\r\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 134, in <module>\r\n    tf.app.run()\r\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 30, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 131, in main\r\n    FLAGS.output_graph, FLAGS.clear_devices, FLAGS.initializer_nodes)\r\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 103, in freeze_graph\r\n    _ = tf.import_graph_def(input_graph_def, name=\"\")\r\n  File \"/data3/tensorflow-0.11.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 258, in import_graph_def\r\n    op_def = op_dict[node.op]\r\nKeyError: u'RestoreV2'\r\n```"}