{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/305447243", "html_url": "https://github.com/tensorflow/tensorflow/issues/10348#issuecomment-305447243", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10348", "id": 305447243, "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTQ0NzI0Mw==", "user": {"login": "jubjamie", "id": 25011496, "node_id": "MDQ6VXNlcjI1MDExNDk2", "avatar_url": "https://avatars3.githubusercontent.com/u/25011496?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jubjamie", "html_url": "https://github.com/jubjamie", "followers_url": "https://api.github.com/users/jubjamie/followers", "following_url": "https://api.github.com/users/jubjamie/following{/other_user}", "gists_url": "https://api.github.com/users/jubjamie/gists{/gist_id}", "starred_url": "https://api.github.com/users/jubjamie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jubjamie/subscriptions", "organizations_url": "https://api.github.com/users/jubjamie/orgs", "repos_url": "https://api.github.com/users/jubjamie/repos", "events_url": "https://api.github.com/users/jubjamie/events{/privacy}", "received_events_url": "https://api.github.com/users/jubjamie/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-01T09:57:21Z", "updated_at": "2017-06-01T09:57:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3376817\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrewharp\">@andrewharp</a> Curiously i'm not getting the same behaviour from my 6P today. However the Pixel C is giving me trouble. It looks like it's to do with how the camera feed is displayed as it is being cropped and squished but the overlay goes on as if it hasn't it.<br>\nUsing the debug view is fine and shows that the camera preview feed is being cropped as I can see much more in the debug view than the main view.</p>\n<p>I also have a feeling that this cropping may happen because I have to force the rotation on the Pixel C as it reports the rotation to be 3 deg. I have to manually set sensorOrientation to 90 for it to capture images the correct way up.<br>\nScreenshots:</p>\n<ol>\n<li>The target centred.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/25011496/26674284/de942f76-46b7-11e7-8e90-2eaa6cd583a5.png\"><img src=\"https://cloud.githubusercontent.com/assets/25011496/26674284/de942f76-46b7-11e7-8e90-2eaa6cd583a5.png\" alt=\"screenshot_20170601-102936\" style=\"max-width:100%;\"></a></li>\n<li>The target off-centre. See how the overlay \"drifts\". It looks like it's because the image preview camera feed has been cropped and stretched past the screen.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/25011496/26674287/e2561566-46b7-11e7-8703-026001e8367f.png\"><img src=\"https://cloud.githubusercontent.com/assets/25011496/26674287/e2561566-46b7-11e7-8703-026001e8367f.png\" alt=\"screenshot_20170601-102952\" style=\"max-width:100%;\"></a></li>\n<li>With debug on this time.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/25011496/26674291/e56d9116-46b7-11e7-882b-6b7ac044cdb2.png\"><img src=\"https://cloud.githubusercontent.com/assets/25011496/26674291/e56d9116-46b7-11e7-882b-6b7ac044cdb2.png\" alt=\"screenshot_20170601-103004\" style=\"max-width:100%;\"></a></li>\n<li>Notice how in the debug window we see that there is some grass to the left of the target. However in our preview window we see that the image is cut of right up to the target. However, we can see that the yellow overlay looks likes it's in the right position if we were given the debug view.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/25011496/26674297/eaaa2d10-46b7-11e7-9374-01502d8a7755.png\"><img src=\"https://cloud.githubusercontent.com/assets/25011496/26674297/eaaa2d10-46b7-11e7-9374-01502d8a7755.png\" alt=\"screenshot_20170601-103018\" style=\"max-width:100%;\"></a></li>\n</ol>\n<p>I believe that there is a problem with how the camera view is created and that it's partly to do with the screenOrientation. For some reason the Pixel C will report a rotation of 3 (in the debug view) and have the image rotated by 90 (or 87) degrees when using the default app. The only solution I have found to get the app to \"see\" pictures in the correct orientation is to change sensorOrientation to this:</p>\n<p><code>sensorOrientation = 90;</code></p>\n<p>Instead of the default found <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/DetectorActivity.java#L159\">here</a>.</p>\n<p>While this appears to be partly caused by the hardware (we have tried on two different Pixel C's) there is also some kind of bug with how the camera feed is drawn. I'm really struggling to understand how it's done in the code so hopefully you can help.</p>\n<p>Thanks</p>", "body_text": "@andrewharp Curiously i'm not getting the same behaviour from my 6P today. However the Pixel C is giving me trouble. It looks like it's to do with how the camera feed is displayed as it is being cropped and squished but the overlay goes on as if it hasn't it.\nUsing the debug view is fine and shows that the camera preview feed is being cropped as I can see much more in the debug view than the main view.\nI also have a feeling that this cropping may happen because I have to force the rotation on the Pixel C as it reports the rotation to be 3 deg. I have to manually set sensorOrientation to 90 for it to capture images the correct way up.\nScreenshots:\n\nThe target centred.\n\nThe target off-centre. See how the overlay \"drifts\". It looks like it's because the image preview camera feed has been cropped and stretched past the screen.\n\nWith debug on this time.\n\nNotice how in the debug window we see that there is some grass to the left of the target. However in our preview window we see that the image is cut of right up to the target. However, we can see that the yellow overlay looks likes it's in the right position if we were given the debug view.\n\n\nI believe that there is a problem with how the camera view is created and that it's partly to do with the screenOrientation. For some reason the Pixel C will report a rotation of 3 (in the debug view) and have the image rotated by 90 (or 87) degrees when using the default app. The only solution I have found to get the app to \"see\" pictures in the correct orientation is to change sensorOrientation to this:\nsensorOrientation = 90;\nInstead of the default found here.\nWhile this appears to be partly caused by the hardware (we have tried on two different Pixel C's) there is also some kind of bug with how the camera feed is drawn. I'm really struggling to understand how it's done in the code so hopefully you can help.\nThanks", "body": "@andrewharp Curiously i'm not getting the same behaviour from my 6P today. However the Pixel C is giving me trouble. It looks like it's to do with how the camera feed is displayed as it is being cropped and squished but the overlay goes on as if it hasn't it.\r\nUsing the debug view is fine and shows that the camera preview feed is being cropped as I can see much more in the debug view than the main view.\r\n\r\nI also have a feeling that this cropping may happen because I have to force the rotation on the Pixel C as it reports the rotation to be 3 deg. I have to manually set sensorOrientation to 90 for it to capture images the correct way up.\r\nScreenshots:\r\n1) The target centred.\r\n![screenshot_20170601-102936](https://cloud.githubusercontent.com/assets/25011496/26674284/de942f76-46b7-11e7-8e90-2eaa6cd583a5.png)\r\n2) The target off-centre. See how the overlay \"drifts\". It looks like it's because the image preview camera feed has been cropped and stretched past the screen.\r\n![screenshot_20170601-102952](https://cloud.githubusercontent.com/assets/25011496/26674287/e2561566-46b7-11e7-8703-026001e8367f.png)\r\n3) With debug on this time.\r\n![screenshot_20170601-103004](https://cloud.githubusercontent.com/assets/25011496/26674291/e56d9116-46b7-11e7-882b-6b7ac044cdb2.png)\r\n4) Notice how in the debug window we see that there is some grass to the left of the target. However in our preview window we see that the image is cut of right up to the target. However, we can see that the yellow overlay looks likes it's in the right position if we were given the debug view.\r\n![screenshot_20170601-103018](https://cloud.githubusercontent.com/assets/25011496/26674297/eaaa2d10-46b7-11e7-9374-01502d8a7755.png)\r\n\r\nI believe that there is a problem with how the camera view is created and that it's partly to do with the screenOrientation. For some reason the Pixel C will report a rotation of 3 (in the debug view) and have the image rotated by 90 (or 87) degrees when using the default app. The only solution I have found to get the app to \"see\" pictures in the correct orientation is to change sensorOrientation to this:\r\n\r\n`sensorOrientation = 90;`\r\n\r\nInstead of the default found [here](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/DetectorActivity.java#L159).\r\n\r\nWhile this appears to be partly caused by the hardware (we have tried on two different Pixel C's) there is also some kind of bug with how the camera feed is drawn. I'm really struggling to understand how it's done in the code so hopefully you can help.\r\n\r\nThanks"}