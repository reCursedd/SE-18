{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/337486825", "html_url": "https://github.com/tensorflow/tensorflow/pull/157#issuecomment-337486825", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/157", "id": 337486825, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzQ4NjgyNQ==", "user": {"login": "mobyIsMe", "id": 9191594, "node_id": "MDQ6VXNlcjkxOTE1OTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/9191594?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mobyIsMe", "html_url": "https://github.com/mobyIsMe", "followers_url": "https://api.github.com/users/mobyIsMe/followers", "following_url": "https://api.github.com/users/mobyIsMe/following{/other_user}", "gists_url": "https://api.github.com/users/mobyIsMe/gists{/gist_id}", "starred_url": "https://api.github.com/users/mobyIsMe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mobyIsMe/subscriptions", "organizations_url": "https://api.github.com/users/mobyIsMe/orgs", "repos_url": "https://api.github.com/users/mobyIsMe/repos", "events_url": "https://api.github.com/users/mobyIsMe/events{/privacy}", "received_events_url": "https://api.github.com/users/mobyIsMe/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-18T07:38:17Z", "updated_at": "2017-10-18T07:38:45Z", "author_association": "NONE", "body_html": "<p>I also get the OOM issue while with this reason:<br>\nHere is the logs outputs from the terminal and the GPU usage status. My device is Ubuntu 14.04, GCC 4.8.4, Linux 2, python 2.7.6, GTX 1080(8G memory,total 4 GPUS in my linux server). Could anyone help me?</p>\n<pre><code>tensorflow/core/common_runtime/bfc_allocator.cc:275] Ran out of memory trying to allocate 256.0KiB.  See logs for memory state.\nW tensorflow/core/framework/op_kernel.cc:993] Resource exhausted: OOM when allocating tensor with shape[128,512]\nTraceback (most recent call last):\n  File \"mnist_mlp.py\", line 64, in &lt;module&gt;\n    validation_data=(x_test, y_test))\n  File \"/usr/local/lib/python2.7/dist-packages/keras/models.py\", line 845, in fit\n    initial_epoch=initial_epoch)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/training.py\", line 1485, in fit\n    initial_epoch=initial_epoch)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/training.py\", line 1140, in _fit_loop\n    outs = f(ins_batch)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2073, in __call__\n    feed_dict=feed_dict)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[128,512]\n\t [[Node: dropout_1/cond/dropout/random_uniform/RandomUniform = RandomUniform[T=DT_INT32, dtype=DT_FLOAT, seed=87654321, seed2=4432543, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](dropout_1/cond/dropout/Shape)]]\n\t [[Node: Mean_3/_33 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_546_Mean_3\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nCaused by op u'dropout_1/cond/dropout/random_uniform/RandomUniform', defined at:\n  File \"mnist_mlp.py\", line 49, in &lt;module&gt;\n    model.add(Dropout(0.2))\n  File \"/usr/local/lib/python2.7/dist-packages/keras/models.py\", line 455, in add\n    output_tensor = layer(self.outputs[0])\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py\", line 554, in __call__\n    output = self.call(inputs, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/layers/core.py\", line 111, in call\n    training=training)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2421, in in_train_phase\n    x = switch(training, x, alt)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2380, in switch\n    else_expression_fn)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py\", line 1738, in cond\n    orig_res, res_t = context_t.BuildCondBranch(fn1)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py\", line 1639, in BuildCondBranch\n    r = fn()\n  File \"/usr/local/lib/python2.7/dist-packages/keras/layers/core.py\", line 109, in dropped_inputs\n    seed=self.seed)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2681, in dropout\n    return tf.nn.dropout(x * 1., retain_prob, noise_shape, seed=seed)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 1936, in dropout\n    dtype=x.dtype)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/random_ops.py\", line 244, in random_uniform\n    seed2=seed2)\nEvery 2.0s: nvidia-smi                    878cb24ce8b6: Wed Oct 18 07:26:58 2017\n\nWed Oct 18 07:26:58 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 86%   86C    P2   156W / 200W |   7789MiB /  8112MiB |     94%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 97%   93C    P2   129W / 200W |   7791MiB /  8113MiB |     98%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   85C    P2   184W / 200W |   7791MiB /  8113MiB |     98%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 47%   63C    P2   145W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\nEvery 2.0s: nvidia-smi                     878cb24ce8b6: Wed Oct 18 07:26:58 2017\n\nWed Oct 18 07:26:58 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 86%   87C    P2   131W / 200W |   7789MiB /  8112MiB |     98%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 97%   93C    P2   124W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   85C    P2   102W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 47%   64C    P2   123W / 200W |   7791MiB /  8113MiB |     92%      Default |\n+-------------------------------+----------------------+----------------------+\n\nEvery 2.0s: nvidia-smi                                             878cb24ce8b6: Wed Oct 18 07:26:59 2017\n\nWed Oct 18 07:26:59 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 86%   86C    P2   138W / 200W |   7789MiB /  8112MiB |     96%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 97%   92C    P2   135W / 200W |   7791MiB /  8113MiB |     75%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   85C    P2   100W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 47%   63C    P2   120W / 200W |   7791MiB /  8113MiB |     93%      Default |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\nEvery 2.0s: nvidia-smi                                                           878cb24ce8b6: Wed Oct 18 07:29:25 2017\n\nWed Oct 18 07:29:25 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 85%   84C    P2   118W / 200W |   7789MiB /  8112MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 96%   90C    P2   121W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   87C    P2   132W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 46%   62C    P2   136W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n</code></pre>", "body_text": "I also get the OOM issue while with this reason:\nHere is the logs outputs from the terminal and the GPU usage status. My device is Ubuntu 14.04, GCC 4.8.4, Linux 2, python 2.7.6, GTX 1080(8G memory,total 4 GPUS in my linux server). Could anyone help me?\ntensorflow/core/common_runtime/bfc_allocator.cc:275] Ran out of memory trying to allocate 256.0KiB.  See logs for memory state.\nW tensorflow/core/framework/op_kernel.cc:993] Resource exhausted: OOM when allocating tensor with shape[128,512]\nTraceback (most recent call last):\n  File \"mnist_mlp.py\", line 64, in <module>\n    validation_data=(x_test, y_test))\n  File \"/usr/local/lib/python2.7/dist-packages/keras/models.py\", line 845, in fit\n    initial_epoch=initial_epoch)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/training.py\", line 1485, in fit\n    initial_epoch=initial_epoch)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/training.py\", line 1140, in _fit_loop\n    outs = f(ins_batch)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2073, in __call__\n    feed_dict=feed_dict)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[128,512]\n\t [[Node: dropout_1/cond/dropout/random_uniform/RandomUniform = RandomUniform[T=DT_INT32, dtype=DT_FLOAT, seed=87654321, seed2=4432543, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](dropout_1/cond/dropout/Shape)]]\n\t [[Node: Mean_3/_33 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_546_Mean_3\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\n\nCaused by op u'dropout_1/cond/dropout/random_uniform/RandomUniform', defined at:\n  File \"mnist_mlp.py\", line 49, in <module>\n    model.add(Dropout(0.2))\n  File \"/usr/local/lib/python2.7/dist-packages/keras/models.py\", line 455, in add\n    output_tensor = layer(self.outputs[0])\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py\", line 554, in __call__\n    output = self.call(inputs, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/layers/core.py\", line 111, in call\n    training=training)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2421, in in_train_phase\n    x = switch(training, x, alt)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2380, in switch\n    else_expression_fn)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py\", line 1738, in cond\n    orig_res, res_t = context_t.BuildCondBranch(fn1)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py\", line 1639, in BuildCondBranch\n    r = fn()\n  File \"/usr/local/lib/python2.7/dist-packages/keras/layers/core.py\", line 109, in dropped_inputs\n    seed=self.seed)\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2681, in dropout\n    return tf.nn.dropout(x * 1., retain_prob, noise_shape, seed=seed)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 1936, in dropout\n    dtype=x.dtype)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/random_ops.py\", line 244, in random_uniform\n    seed2=seed2)\nEvery 2.0s: nvidia-smi                    878cb24ce8b6: Wed Oct 18 07:26:58 2017\n\nWed Oct 18 07:26:58 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 86%   86C    P2   156W / 200W |   7789MiB /  8112MiB |     94%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 97%   93C    P2   129W / 200W |   7791MiB /  8113MiB |     98%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   85C    P2   184W / 200W |   7791MiB /  8113MiB |     98%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 47%   63C    P2   145W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\nEvery 2.0s: nvidia-smi                     878cb24ce8b6: Wed Oct 18 07:26:58 2017\n\nWed Oct 18 07:26:58 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 86%   87C    P2   131W / 200W |   7789MiB /  8112MiB |     98%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 97%   93C    P2   124W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   85C    P2   102W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 47%   64C    P2   123W / 200W |   7791MiB /  8113MiB |     92%      Default |\n+-------------------------------+----------------------+----------------------+\n\nEvery 2.0s: nvidia-smi                                             878cb24ce8b6: Wed Oct 18 07:26:59 2017\n\nWed Oct 18 07:26:59 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 86%   86C    P2   138W / 200W |   7789MiB /  8112MiB |     96%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 97%   92C    P2   135W / 200W |   7791MiB /  8113MiB |     75%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   85C    P2   100W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 47%   63C    P2   120W / 200W |   7791MiB /  8113MiB |     93%      Default |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\nEvery 2.0s: nvidia-smi                                                           878cb24ce8b6: Wed Oct 18 07:29:25 2017\n\nWed Oct 18 07:29:25 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\n| 85%   84C    P2   118W / 200W |   7789MiB /  8112MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\n| 96%   90C    P2   121W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\n| 86%   87C    P2   132W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\n| 46%   62C    P2   136W / 200W |   7791MiB /  8113MiB |     99%      Default |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |", "body": "I also get the OOM issue while with this reason:\r\nHere is the logs outputs from the terminal and the GPU usage status. My device is Ubuntu 14.04, GCC 4.8.4, Linux 2, python 2.7.6, GTX 1080(8G memory,total 4 GPUS in my linux server). Could anyone help me?\r\n\r\n```\r\ntensorflow/core/common_runtime/bfc_allocator.cc:275] Ran out of memory trying to allocate 256.0KiB.  See logs for memory state.\r\nW tensorflow/core/framework/op_kernel.cc:993] Resource exhausted: OOM when allocating tensor with shape[128,512]\r\nTraceback (most recent call last):\r\n  File \"mnist_mlp.py\", line 64, in <module>\r\n    validation_data=(x_test, y_test))\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/models.py\", line 845, in fit\r\n    initial_epoch=initial_epoch)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/training.py\", line 1485, in fit\r\n    initial_epoch=initial_epoch)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/training.py\", line 1140, in _fit_loop\r\n    outs = f(ins_batch)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2073, in __call__\r\n    feed_dict=feed_dict)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[128,512]\r\n\t [[Node: dropout_1/cond/dropout/random_uniform/RandomUniform = RandomUniform[T=DT_INT32, dtype=DT_FLOAT, seed=87654321, seed2=4432543, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](dropout_1/cond/dropout/Shape)]]\r\n\t [[Node: Mean_3/_33 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_546_Mean_3\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\nCaused by op u'dropout_1/cond/dropout/random_uniform/RandomUniform', defined at:\r\n  File \"mnist_mlp.py\", line 49, in <module>\r\n    model.add(Dropout(0.2))\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/models.py\", line 455, in add\r\n    output_tensor = layer(self.outputs[0])\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py\", line 554, in __call__\r\n    output = self.call(inputs, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/layers/core.py\", line 111, in call\r\n    training=training)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2421, in in_train_phase\r\n    x = switch(training, x, alt)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2380, in switch\r\n    else_expression_fn)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py\", line 1738, in cond\r\n    orig_res, res_t = context_t.BuildCondBranch(fn1)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py\", line 1639, in BuildCondBranch\r\n    r = fn()\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/layers/core.py\", line 109, in dropped_inputs\r\n    seed=self.seed)\r\n  File \"/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py\", line 2681, in dropout\r\n    return tf.nn.dropout(x * 1., retain_prob, noise_shape, seed=seed)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 1936, in dropout\r\n    dtype=x.dtype)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/random_ops.py\", line 244, in random_uniform\r\n    seed2=seed2)\r\nEvery 2.0s: nvidia-smi                    878cb24ce8b6: Wed Oct 18 07:26:58 2017\r\n\r\nWed Oct 18 07:26:58 2017\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\r\n| 86%   86C    P2   156W / 200W |   7789MiB /  8112MiB |     94%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\r\n| 97%   93C    P2   129W / 200W |   7791MiB /  8113MiB |     98%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\r\n| 86%   85C    P2   184W / 200W |   7791MiB /  8113MiB |     98%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\r\n| 47%   63C    P2   145W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\nEvery 2.0s: nvidia-smi                     878cb24ce8b6: Wed Oct 18 07:26:58 2017\r\n\r\nWed Oct 18 07:26:58 2017\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\r\n| 86%   87C    P2   131W / 200W |   7789MiB /  8112MiB |     98%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\r\n| 97%   93C    P2   124W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\r\n| 86%   85C    P2   102W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\r\n| 47%   64C    P2   123W / 200W |   7791MiB /  8113MiB |     92%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\nEvery 2.0s: nvidia-smi                                             878cb24ce8b6: Wed Oct 18 07:26:59 2017\r\n\r\nWed Oct 18 07:26:59 2017\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\r\n| 86%   86C    P2   138W / 200W |   7789MiB /  8112MiB |     96%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\r\n| 97%   92C    P2   135W / 200W |   7791MiB /  8113MiB |     75%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\r\n| 86%   85C    P2   100W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\r\n| 47%   63C    P2   120W / 200W |   7791MiB /  8113MiB |     93%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID  Type  Process name                               Usage      |\r\nEvery 2.0s: nvidia-smi                                                           878cb24ce8b6: Wed Oct 18 07:29:25 2017\r\n\r\nWed Oct 18 07:29:25 2017\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.39                 Driver Version: 367.48                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1080    Off  | 0000:05:00.0     Off |                  N/A |\r\n| 85%   84C    P2   118W / 200W |   7789MiB /  8112MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX 1080    Off  | 0000:06:00.0     Off |                  N/A |\r\n| 96%   90C    P2   121W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  GeForce GTX 1080    Off  | 0000:09:00.0     Off |                  N/A |\r\n| 86%   87C    P2   132W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  GeForce GTX 1080    Off  | 0000:0A:00.0     Off |                  N/A |\r\n| 46%   62C    P2   136W / 200W |   7791MiB /  8113MiB |     99%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID  Type  Process name                               Usage      |\r\n```"}