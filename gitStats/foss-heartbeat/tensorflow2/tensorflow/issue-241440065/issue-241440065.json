{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11371", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11371/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11371/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11371/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11371", "id": 241440065, "node_id": "MDU6SXNzdWUyNDE0NDAwNjU=", "number": 11371, "title": "Placeholder with shape=(None, 1024) gives an error when used with tf.cond", "user": {"login": "zeis", "id": 1945427, "node_id": "MDQ6VXNlcjE5NDU0Mjc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1945427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zeis", "html_url": "https://github.com/zeis", "followers_url": "https://api.github.com/users/zeis/followers", "following_url": "https://api.github.com/users/zeis/following{/other_user}", "gists_url": "https://api.github.com/users/zeis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zeis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zeis/subscriptions", "organizations_url": "https://api.github.com/users/zeis/orgs", "repos_url": "https://api.github.com/users/zeis/repos", "events_url": "https://api.github.com/users/zeis/events{/privacy}", "received_events_url": "https://api.github.com/users/zeis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-07-08T09:59:04Z", "updated_at": "2017-07-23T16:54:00Z", "closed_at": "2017-07-13T20:49:06Z", "author_association": "NONE", "body_html": "<p>I'm using TensorFlow v1.2.0. Here is a simple example that shows the problem.<br>\nIf a dimension of a placeholder is None I get the following error:</p>\n<pre><code>InvalidArgumentError (see above for traceback): Shape [-1,1024] has negative dimensions\n\t [[Node: cond/Placeholder = Placeholder[dtype=DT_FLOAT, shape=[?,1024], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](^cond/switch_t)]]\n</code></pre>\n<p>If I set the shape to None or to (1024, 1024) it gives no error.</p>\n<pre><code>import numpy as np\nimport tensorflow as tf\n\nrand_array = np.random.rand(1024, 1024)\n\nx_c = tf.constant(rand_array, dtype=tf.float32)\n\npy_flag = False\nflag = tf.constant(py_flag, tf.bool)\n\ndef pl():\n    return tf.placeholder(dtype=tf.float32, shape=(None, 1024))\n\nx = tf.cond(flag, pl, lambda: x_c)\n\ny = tf.matmul(x, x)\n\nwith tf.Session() as sess:\n    if py_flag:\n        print(sess.run(y, feed_dict={x: rand_array}))\n    else:\n        print(sess.run(y))\n</code></pre>", "body_text": "I'm using TensorFlow v1.2.0. Here is a simple example that shows the problem.\nIf a dimension of a placeholder is None I get the following error:\nInvalidArgumentError (see above for traceback): Shape [-1,1024] has negative dimensions\n\t [[Node: cond/Placeholder = Placeholder[dtype=DT_FLOAT, shape=[?,1024], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](^cond/switch_t)]]\n\nIf I set the shape to None or to (1024, 1024) it gives no error.\nimport numpy as np\nimport tensorflow as tf\n\nrand_array = np.random.rand(1024, 1024)\n\nx_c = tf.constant(rand_array, dtype=tf.float32)\n\npy_flag = False\nflag = tf.constant(py_flag, tf.bool)\n\ndef pl():\n    return tf.placeholder(dtype=tf.float32, shape=(None, 1024))\n\nx = tf.cond(flag, pl, lambda: x_c)\n\ny = tf.matmul(x, x)\n\nwith tf.Session() as sess:\n    if py_flag:\n        print(sess.run(y, feed_dict={x: rand_array}))\n    else:\n        print(sess.run(y))", "body": "I'm using TensorFlow v1.2.0. Here is a simple example that shows the problem.\r\nIf a dimension of a placeholder is None I get the following error:\r\n\r\n```\r\nInvalidArgumentError (see above for traceback): Shape [-1,1024] has negative dimensions\r\n\t [[Node: cond/Placeholder = Placeholder[dtype=DT_FLOAT, shape=[?,1024], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](^cond/switch_t)]]\r\n```\r\n\r\nIf I set the shape to None or to (1024, 1024) it gives no error. \r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nrand_array = np.random.rand(1024, 1024)\r\n\r\nx_c = tf.constant(rand_array, dtype=tf.float32)\r\n\r\npy_flag = False\r\nflag = tf.constant(py_flag, tf.bool)\r\n\r\ndef pl():\r\n    return tf.placeholder(dtype=tf.float32, shape=(None, 1024))\r\n\r\nx = tf.cond(flag, pl, lambda: x_c)\r\n\r\ny = tf.matmul(x, x)\r\n\r\nwith tf.Session() as sess:\r\n    if py_flag:\r\n        print(sess.run(y, feed_dict={x: rand_array}))\r\n    else:\r\n        print(sess.run(y))\r\n```"}