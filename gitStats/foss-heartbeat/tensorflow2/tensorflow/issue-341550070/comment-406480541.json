{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/406480541", "html_url": "https://github.com/tensorflow/tensorflow/issues/20842#issuecomment-406480541", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20842", "id": 406480541, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjQ4MDU0MQ==", "user": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-20T03:43:39Z", "updated_at": "2018-07-20T03:43:39Z", "author_association": "NONE", "body_html": "<p>Thanks for the code, I'm getting the same behavior on my end. It looks like <code>tf.keras</code> is incrementing the name of the layer unconditionally every time a layer of the same type is created. As per the release note you mentioned, this might be intended behavior, I'll check with other members of the team and get back.</p>\n<p>In the meantime, one way to have variable sharing with <code>tf.keras</code> is to create the layer once and then call it multiple times:</p>\n<div class=\"highlight highlight-source-python\"><pre>conv <span class=\"pl-k\">=</span> tf.keras.Conv3D(<span class=\"pl-c1\">32</span>, (<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>))\n\nout <span class=\"pl-k\">=</span> conv(x)\nout_2 <span class=\"pl-k\">=</span> conv(y) <span class=\"pl-c\"><span class=\"pl-c\">#</span> this will share variables with the first call</span></pre></div>", "body_text": "Thanks for the code, I'm getting the same behavior on my end. It looks like tf.keras is incrementing the name of the layer unconditionally every time a layer of the same type is created. As per the release note you mentioned, this might be intended behavior, I'll check with other members of the team and get back.\nIn the meantime, one way to have variable sharing with tf.keras is to create the layer once and then call it multiple times:\nconv = tf.keras.Conv3D(32, (3, 3, 3))\n\nout = conv(x)\nout_2 = conv(y) # this will share variables with the first call", "body": "Thanks for the code, I'm getting the same behavior on my end. It looks like `tf.keras` is incrementing the name of the layer unconditionally every time a layer of the same type is created. As per the release note you mentioned, this might be intended behavior, I'll check with other members of the team and get back. \r\n\r\nIn the meantime, one way to have variable sharing with `tf.keras` is to create the layer once and then call it multiple times:\r\n\r\n```python\r\nconv = tf.keras.Conv3D(32, (3, 3, 3))\r\n\r\nout = conv(x)\r\nout_2 = conv(y) # this will share variables with the first call\r\n```\r\n"}