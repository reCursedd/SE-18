{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3706", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3706/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3706/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3706/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3706", "id": 170100111, "node_id": "MDU6SXNzdWUxNzAxMDAxMTE=", "number": 3706, "title": "Error: the tensor's graph is different from the session's graph", "user": {"login": "umerebryx", "id": 13097984, "node_id": "MDQ6VXNlcjEzMDk3OTg0", "avatar_url": "https://avatars2.githubusercontent.com/u/13097984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/umerebryx", "html_url": "https://github.com/umerebryx", "followers_url": "https://api.github.com/users/umerebryx/followers", "following_url": "https://api.github.com/users/umerebryx/following{/other_user}", "gists_url": "https://api.github.com/users/umerebryx/gists{/gist_id}", "starred_url": "https://api.github.com/users/umerebryx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/umerebryx/subscriptions", "organizations_url": "https://api.github.com/users/umerebryx/orgs", "repos_url": "https://api.github.com/users/umerebryx/repos", "events_url": "https://api.github.com/users/umerebryx/events{/privacy}", "received_events_url": "https://api.github.com/users/umerebryx/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-09T07:32:47Z", "updated_at": "2016-08-09T16:25:22Z", "closed_at": "2016-08-09T16:25:22Z", "author_association": "NONE", "body_html": "<p>I am using my previously trained models to generate deep dream images as decscribe in one of the <a href=\"https://render.githubusercontent.com/view/ipynb?commit=0685152a02f1fd4dbd711a023c1ccea5a8b8262b&amp;enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f74656e736f72666c6f772f74656e736f72666c6f772f303638353135326130326631666434646264373131613032336331636365613561386238323632622f74656e736f72666c6f772f6578616d706c65732f7475746f7269616c732f64656570647265616d2f64656570647265616d2e6970796e62&amp;nwo=tensorflow%2Ftensorflow&amp;path=tensorflow%2Fexamples%2Ftutorials%2Fdeepdream%2Fdeepdream.ipynb&amp;repository_id=45717250#deepdream\" rel=\"nofollow\">tutorials</a>. But when I try to call the render_deepdream method I am getting below error:</p>\n<blockquote>\n<p>I tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0<br>\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:806] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: Tesla K80, pci bus id: 0000:83:00.0)</p>\n<h1>Succesfully loaded model from /data/model_cache/model.ckpt-39 at step=39.</h1>\n<p>(3648, 5472)<br>\nTraceback (most recent call last):<br>\nFile \"imagenet_eval.py\", line 46, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run<br>\nsys.exit(main(sys.argv))<br>\nFile \"imagenet_eval.py\", line 42, in main<br>\ninception_eval.evaluate(dataset)<br>\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 192, in evaluate<br>\n_eval_once(saver, summary_writer, top_1_op, top_5_op, summary_op)<br>\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 156, in _eval_once<br>\nrender_deepdream(tf.square(T('inception_v3/mixed_8x8x2048b/concat',graph)), img0=img0, session=sess)<br>\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 94, in render_deepdream<br>\nlo = resize(img, np.int32(np.float32(hw)/octave_scale), session=session)<br>\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 66, in wrapper<br>\nreturn out.eval(dict(zip(placeholders, args)), session=kw.get('session'))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 555, in eval<br>\nreturn _eval_using_default_session(self, feed_dict, self.graph, session)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3495, in _eval_using_default_session<br>\nraise ValueError(\"Cannot use the given session to evaluate tensor: \"<br>\nValueError: Cannot use the given session to evaluate tensor: the tensor's graph is different from the session's graph.</p>\n</blockquote>\n<hr>\n<p>Below is the code that is causing the issue:</p>\n<pre><code>def tffunc(*argtypes):\n    '''Helper that transforms TF-graph generating function into a regular one.\n    See \"resize\" function below.\n    '''\n    placeholders = list(map(tf.placeholder, argtypes))\n    def wrap(f):\n        out = f(*placeholders)\n        def wrapper(*args, **kw):\n            #from IPython import embed\n            #embed()\n            return out.eval(dict(zip(placeholders, args)), session=kw.get('session'))\n        return wrapper\n    return wrap\n\ndef resize(img, size):\n    img = tf.expand_dims(img, 0)\n    return tf.image.resize_bilinear(img, size)[0,:,:,:]\nresize = tffunc(np.float32, np.int32)(resize)\n</code></pre>\n<p>This is the line causing issue: <a href=\"https://github.com/umerebryx/Inference/blob/master/inference_eval.py#L60\">https://github.com/umerebryx/Inference/blob/master/inference_eval.py#L60</a><br>\nYou can also view full code in above mentioned repo. Any help would be much appreciated as I am stuck at this for days now. Thanks in advance.</p>", "body_text": "I am using my previously trained models to generate deep dream images as decscribe in one of the tutorials. But when I try to call the render_deepdream method I am getting below error:\n\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:806] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:83:00.0)\nSuccesfully loaded model from /data/model_cache/model.ckpt-39 at step=39.\n(3648, 5472)\nTraceback (most recent call last):\nFile \"imagenet_eval.py\", line 46, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\nsys.exit(main(sys.argv))\nFile \"imagenet_eval.py\", line 42, in main\ninception_eval.evaluate(dataset)\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 192, in evaluate\n_eval_once(saver, summary_writer, top_1_op, top_5_op, summary_op)\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 156, in _eval_once\nrender_deepdream(tf.square(T('inception_v3/mixed_8x8x2048b/concat',graph)), img0=img0, session=sess)\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 94, in render_deepdream\nlo = resize(img, np.int32(np.float32(hw)/octave_scale), session=session)\nFile \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 66, in wrapper\nreturn out.eval(dict(zip(placeholders, args)), session=kw.get('session'))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 555, in eval\nreturn _eval_using_default_session(self, feed_dict, self.graph, session)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3495, in _eval_using_default_session\nraise ValueError(\"Cannot use the given session to evaluate tensor: \"\nValueError: Cannot use the given session to evaluate tensor: the tensor's graph is different from the session's graph.\n\n\nBelow is the code that is causing the issue:\ndef tffunc(*argtypes):\n    '''Helper that transforms TF-graph generating function into a regular one.\n    See \"resize\" function below.\n    '''\n    placeholders = list(map(tf.placeholder, argtypes))\n    def wrap(f):\n        out = f(*placeholders)\n        def wrapper(*args, **kw):\n            #from IPython import embed\n            #embed()\n            return out.eval(dict(zip(placeholders, args)), session=kw.get('session'))\n        return wrapper\n    return wrap\n\ndef resize(img, size):\n    img = tf.expand_dims(img, 0)\n    return tf.image.resize_bilinear(img, size)[0,:,:,:]\nresize = tffunc(np.float32, np.int32)(resize)\n\nThis is the line causing issue: https://github.com/umerebryx/Inference/blob/master/inference_eval.py#L60\nYou can also view full code in above mentioned repo. Any help would be much appreciated as I am stuck at this for days now. Thanks in advance.", "body": "I am using my previously trained models to generate deep dream images as decscribe in one of the [tutorials](https://render.githubusercontent.com/view/ipynb?commit=0685152a02f1fd4dbd711a023c1ccea5a8b8262b&enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f74656e736f72666c6f772f74656e736f72666c6f772f303638353135326130326631666434646264373131613032336331636365613561386238323632622f74656e736f72666c6f772f6578616d706c65732f7475746f7269616c732f64656570647265616d2f64656570647265616d2e6970796e62&nwo=tensorflow%2Ftensorflow&path=tensorflow%2Fexamples%2Ftutorials%2Fdeepdream%2Fdeepdream.ipynb&repository_id=45717250#deepdream). But when I try to call the render_deepdream method I am getting below error:\n\n> I tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 \n> I tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y \n> I tensorflow/core/common_runtime/gpu/gpu_device.cc:806] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:83:00.0)\n> # Succesfully loaded model from /data/model_cache/model.ckpt-39 at step=39.\n> \n> (3648, 5472)\n> Traceback (most recent call last):\n>   File \"imagenet_eval.py\", line 46, in <module>\n>     tf.app.run()\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\n>     sys.exit(main(sys.argv))\n>   File \"imagenet_eval.py\", line 42, in main\n>     inception_eval.evaluate(dataset)\n>   File \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 192, in evaluate\n>     _eval_once(saver, summary_writer, top_1_op, top_5_op, summary_op)\n>   File \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 156, in _eval_once\n>     render_deepdream(tf.square(T('inception_v3/mixed_8x8x2048b/concat',graph)), img0=img0, session=sess)\n>   File \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 94, in render_deepdream\n>     lo = resize(img, np.int32(np.float32(hw)/octave_scale), session=session)\n>   File \"/home/ubuntu/experiment/models/inception/inception/inception_eval.py\", line 66, in wrapper\n>     return out.eval(dict(zip(placeholders, args)), session=kw.get('session'))\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 555, in eval\n>     return _eval_using_default_session(self, feed_dict, self.graph, session)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3495, in _eval_using_default_session\n>     raise ValueError(\"Cannot use the given session to evaluate tensor: \"\n> ValueError: Cannot use the given session to evaluate tensor: the tensor's graph is different from the session's graph.\n\n---\n\nBelow is the code that is causing the issue:\n\n```\ndef tffunc(*argtypes):\n    '''Helper that transforms TF-graph generating function into a regular one.\n    See \"resize\" function below.\n    '''\n    placeholders = list(map(tf.placeholder, argtypes))\n    def wrap(f):\n        out = f(*placeholders)\n        def wrapper(*args, **kw):\n            #from IPython import embed\n            #embed()\n            return out.eval(dict(zip(placeholders, args)), session=kw.get('session'))\n        return wrapper\n    return wrap\n\ndef resize(img, size):\n    img = tf.expand_dims(img, 0)\n    return tf.image.resize_bilinear(img, size)[0,:,:,:]\nresize = tffunc(np.float32, np.int32)(resize)\n```\n\nThis is the line causing issue: https://github.com/umerebryx/Inference/blob/master/inference_eval.py#L60\nYou can also view full code in above mentioned repo. Any help would be much appreciated as I am stuck at this for days now. Thanks in advance. \n"}