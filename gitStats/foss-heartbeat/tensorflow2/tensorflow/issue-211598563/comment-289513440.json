{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/289513440", "html_url": "https://github.com/tensorflow/tensorflow/issues/8043#issuecomment-289513440", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8043", "id": 289513440, "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTUxMzQ0MA==", "user": {"login": "honkentuber", "id": 19861701, "node_id": "MDQ6VXNlcjE5ODYxNzAx", "avatar_url": "https://avatars0.githubusercontent.com/u/19861701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/honkentuber", "html_url": "https://github.com/honkentuber", "followers_url": "https://api.github.com/users/honkentuber/followers", "following_url": "https://api.github.com/users/honkentuber/following{/other_user}", "gists_url": "https://api.github.com/users/honkentuber/gists{/gist_id}", "starred_url": "https://api.github.com/users/honkentuber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/honkentuber/subscriptions", "organizations_url": "https://api.github.com/users/honkentuber/orgs", "repos_url": "https://api.github.com/users/honkentuber/repos", "events_url": "https://api.github.com/users/honkentuber/events{/privacy}", "received_events_url": "https://api.github.com/users/honkentuber/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-27T16:49:36Z", "updated_at": "2017-03-27T16:51:02Z", "author_association": "NONE", "body_html": "<div class=\"email-fragment\">I believe the problem here is that the streaming_mean function doesn't take\na label argument, so it's mistaking labels for weights. You can\nreplace metric_ops.streaming_mean\nwith:\n\ndef _predictions_streaming_mean(labels, predictions, weights):\n  return metric_ops.streaming_mean(values=predictions, weights=weights)</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Fri, Mar 24, 2017 at 11:24 PM, Andr\u00e9s Huertas Suarez &lt; ***@***.***&gt; wrote:\n Hi !\n\n i'm having the same issue. but changing the shape of the label tensor\n didn't work . i define my metrics as:\n\n METRICS = {\n     'loss' : metric_spec.MetricSpec (\n         metric_fn = metric_ops.streaming_mean ,\n         prediction_key = 'loss' ,\n         weight_key = None ,\n         label_key = None\n     )\n }\n\n and pass it to the eval_metrics argument, creating a Experiment object.\n but i i run it i get the same error,\n *ValueError: weights can not be broadcast to values. values.rank=0.\n weights.rank=2*\n\n i'm using a batch size of 2 ( for debuging ) . But i find it really weird\n because i specify *weight_key = None*, and by checking the code, it says\n that in that case the weights arre just 1. Some how a \"weights\" parameter\n is reaching streaming_mean , even if i said that i dont want it to be\n weigthed.\n The output of my *input_fn* is a list [ images , labels ]\n\n So.. what i'm doing wrong?\n Thanks in advance :)\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"211598563\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8043\" href=\"https://github.com/tensorflow/tensorflow/issues/8043#issuecomment-289192348\">#8043 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AS8QxfM22FXVRRT_MZ2hetHFbhmze1NUks5rpLM3gaJpZM4MR4Ij\">https://github.com/notifications/unsubscribe-auth/AS8QxfM22FXVRRT_MZ2hetHFbhmze1NUks5rpLM3gaJpZM4MR4Ij</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "I believe the problem here is that the streaming_mean function doesn't take\na label argument, so it's mistaking labels for weights. You can\nreplace metric_ops.streaming_mean\nwith:\n\ndef _predictions_streaming_mean(labels, predictions, weights):\n  return metric_ops.streaming_mean(values=predictions, weights=weights)\n\u2026\nOn Fri, Mar 24, 2017 at 11:24 PM, Andr\u00e9s Huertas Suarez < ***@***.***> wrote:\n Hi !\n\n i'm having the same issue. but changing the shape of the label tensor\n didn't work . i define my metrics as:\n\n METRICS = {\n     'loss' : metric_spec.MetricSpec (\n         metric_fn = metric_ops.streaming_mean ,\n         prediction_key = 'loss' ,\n         weight_key = None ,\n         label_key = None\n     )\n }\n\n and pass it to the eval_metrics argument, creating a Experiment object.\n but i i run it i get the same error,\n *ValueError: weights can not be broadcast to values. values.rank=0.\n weights.rank=2*\n\n i'm using a batch size of 2 ( for debuging ) . But i find it really weird\n because i specify *weight_key = None*, and by checking the code, it says\n that in that case the weights arre just 1. Some how a \"weights\" parameter\n is reaching streaming_mean , even if i said that i dont want it to be\n weigthed.\n The output of my *input_fn* is a list [ images , labels ]\n\n So.. what i'm doing wrong?\n Thanks in advance :)\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#8043 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AS8QxfM22FXVRRT_MZ2hetHFbhmze1NUks5rpLM3gaJpZM4MR4Ij>\n .", "body": "I believe the problem here is that the streaming_mean function doesn't take\r\na label argument, so it's mistaking labels for weights. You can\r\nreplace metric_ops.streaming_mean\r\nwith:\r\n\r\ndef _predictions_streaming_mean(labels, predictions, weights):\r\n  return metric_ops.streaming_mean(values=predictions, weights=weights)\r\n\r\nOn Fri, Mar 24, 2017 at 11:24 PM, Andr\u00e9s Huertas Suarez <\r\nnotifications@github.com> wrote:\r\n\r\n> Hi !\r\n>\r\n> i'm having the same issue. but changing the shape of the label tensor\r\n> didn't work . i define my metrics as:\r\n>\r\n> METRICS = {\r\n>     'loss' : metric_spec.MetricSpec (\r\n>         metric_fn = metric_ops.streaming_mean ,\r\n>         prediction_key = 'loss' ,\r\n>         weight_key = None ,\r\n>         label_key = None\r\n>     )\r\n> }\r\n>\r\n> and pass it to the eval_metrics argument, creating a Experiment object.\r\n> but i i run it i get the same error,\r\n> *ValueError: weights can not be broadcast to values. values.rank=0.\r\n> weights.rank=2*\r\n>\r\n> i'm using a batch size of 2 ( for debuging ) . But i find it really weird\r\n> because i specify *weight_key = None*, and by checking the code, it says\r\n> that in that case the weights arre just 1. Some how a \"weights\" parameter\r\n> is reaching streaming_mean , even if i said that i dont want it to be\r\n> weigthed.\r\n> The output of my *input_fn* is a list [ images , labels ]\r\n>\r\n> So.. what i'm doing wrong?\r\n> Thanks in advance :)\r\n>\r\n> \u2014\r\n> You are receiving this because you were mentioned.\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/tensorflow/tensorflow/issues/8043#issuecomment-289192348>,\r\n> or mute the thread\r\n> <https://github.com/notifications/unsubscribe-auth/AS8QxfM22FXVRRT_MZ2hetHFbhmze1NUks5rpLM3gaJpZM4MR4Ij>\r\n> .\r\n>\r\n"}