{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15364", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15364/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15364/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15364/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15364", "id": 282074096, "node_id": "MDU6SXNzdWUyODIwNzQwOTY=", "number": 15364, "title": "[BUG] Default MaxPoolingOp/AvgPoolingOp only supports NHWC", "user": {"login": "LucasMahieu", "id": 12006816, "node_id": "MDQ6VXNlcjEyMDA2ODE2", "avatar_url": "https://avatars3.githubusercontent.com/u/12006816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LucasMahieu", "html_url": "https://github.com/LucasMahieu", "followers_url": "https://api.github.com/users/LucasMahieu/followers", "following_url": "https://api.github.com/users/LucasMahieu/following{/other_user}", "gists_url": "https://api.github.com/users/LucasMahieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/LucasMahieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LucasMahieu/subscriptions", "organizations_url": "https://api.github.com/users/LucasMahieu/orgs", "repos_url": "https://api.github.com/users/LucasMahieu/repos", "events_url": "https://api.github.com/users/LucasMahieu/events{/privacy}", "received_events_url": "https://api.github.com/users/LucasMahieu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "wolffg", "id": 874510, "node_id": "MDQ6VXNlcjg3NDUxMA==", "avatar_url": "https://avatars2.githubusercontent.com/u/874510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wolffg", "html_url": "https://github.com/wolffg", "followers_url": "https://api.github.com/users/wolffg/followers", "following_url": "https://api.github.com/users/wolffg/following{/other_user}", "gists_url": "https://api.github.com/users/wolffg/gists{/gist_id}", "starred_url": "https://api.github.com/users/wolffg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wolffg/subscriptions", "organizations_url": "https://api.github.com/users/wolffg/orgs", "repos_url": "https://api.github.com/users/wolffg/repos", "events_url": "https://api.github.com/users/wolffg/events{/privacy}", "received_events_url": "https://api.github.com/users/wolffg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wolffg", "id": 874510, "node_id": "MDQ6VXNlcjg3NDUxMA==", "avatar_url": "https://avatars2.githubusercontent.com/u/874510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wolffg", "html_url": "https://github.com/wolffg", "followers_url": "https://api.github.com/users/wolffg/followers", "following_url": "https://api.github.com/users/wolffg/following{/other_user}", "gists_url": "https://api.github.com/users/wolffg/gists{/gist_id}", "starred_url": "https://api.github.com/users/wolffg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wolffg/subscriptions", "organizations_url": "https://api.github.com/users/wolffg/orgs", "repos_url": "https://api.github.com/users/wolffg/repos", "events_url": "https://api.github.com/users/wolffg/events{/privacy}", "received_events_url": "https://api.github.com/users/wolffg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2017-12-14T11:49:45Z", "updated_at": "2018-11-22T18:53:08Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux CentOS 7</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: pip install tensorflow with virtualEnv</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.4.0</li>\n<li><strong>Python version</strong>: 2.7.5</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\na <span class=\"pl-k\">=</span> tf.nn.max_pool(np.random.rand(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">10</span>,<span class=\"pl-c1\">10</span>), [<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">2</span>], [<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>], <span class=\"pl-s\"><span class=\"pl-pds\">'</span>VALID<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">data_format</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>NCHW<span class=\"pl-pds\">'</span></span>)\nsess<span class=\"pl-k\">=</span>tf.InteractiveSession()\nsess.run(a)</pre></div>\n<h3>Describe the problem</h3>\n<p>When I try to run a node of type max or avg pool with data_format : 'NCHW' I got an error.<br>\nThis seems to be a bug because the TF docs affirms that :</p>\n<blockquote>\n<p>data_format: A string. 'NHWC', 'NCHW' and 'NCHW_VECT_C' are supported.</p>\n</blockquote>\n<h3>Error logs</h3>\n<p>With max:</p>\n<blockquote>\n<p>2017-12-14 12:40:23.250331: E tensorflow/core/common_runtime/executor.cc:643] Executor failed to create kernel. Invalid argument: Default MaxPoolingOp only supports NHWC.<br>\n[[Node: MaxPool = MaxPool<a href=\"MaxPool/input\">T=DT_DOUBLE, data_format=\"NCHW\", ksize=[1, 1, 2, 2], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n</blockquote>\n<p>With Avg:</p>\n<blockquote>\n<p>tensorflow.python.framework.errors_impl.InvalidArgumentError: Default AvgPoolingOp only supports NHWC.<br>\n[[Node: AvgPool_1 = AvgPool<a href=\"AvgPool_1/input\">T=DT_FLOAT, data_format=\"NCHW\", ksize=[1, 1, 2, 2], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n</blockquote>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux CentOS 7\nTensorFlow installed from (source or binary): pip install tensorflow with virtualEnv\nTensorFlow version (use command below): 1.4.0\nPython version: 2.7.5\nExact command to reproduce:\n\nimport numpy as np\nimport tensorflow as tf\na = tf.nn.max_pool(np.random.rand(1, 1,10,10), [1,1,2,2], [1,1,1,1], 'VALID', data_format='NCHW')\nsess=tf.InteractiveSession()\nsess.run(a)\nDescribe the problem\nWhen I try to run a node of type max or avg pool with data_format : 'NCHW' I got an error.\nThis seems to be a bug because the TF docs affirms that :\n\ndata_format: A string. 'NHWC', 'NCHW' and 'NCHW_VECT_C' are supported.\n\nError logs\nWith max:\n\n2017-12-14 12:40:23.250331: E tensorflow/core/common_runtime/executor.cc:643] Executor failed to create kernel. Invalid argument: Default MaxPoolingOp only supports NHWC.\n[[Node: MaxPool = MaxPoolT=DT_DOUBLE, data_format=\"NCHW\", ksize=[1, 1, 2, 2], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\n\nWith Avg:\n\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Default AvgPoolingOp only supports NHWC.\n[[Node: AvgPool_1 = AvgPoolT=DT_FLOAT, data_format=\"NCHW\", ksize=[1, 1, 2, 2], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux CentOS 7\r\n- **TensorFlow installed from (source or binary)**: pip install tensorflow with virtualEnv\r\n- **TensorFlow version (use command below)**: 1.4.0\r\n- **Python version**: 2.7.5\r\n- **Exact command to reproduce**:\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\na = tf.nn.max_pool(np.random.rand(1, 1,10,10), [1,1,2,2], [1,1,1,1], 'VALID', data_format='NCHW')\r\nsess=tf.InteractiveSession()\r\nsess.run(a)\r\n```\r\n### Describe the problem\r\nWhen I try to run a node of type max or avg pool with data_format : 'NCHW' I got an error.\r\nThis seems to be a bug because the TF docs affirms that : \r\n> data_format: A string. 'NHWC', 'NCHW' and 'NCHW_VECT_C' are supported.\r\n\r\n### Error logs\r\nWith max:\r\n> 2017-12-14 12:40:23.250331: E tensorflow/core/common_runtime/executor.cc:643] Executor failed to create kernel. Invalid argument: Default MaxPoolingOp only supports NHWC.\r\n>                 [[Node: MaxPool = MaxPool[T=DT_DOUBLE, data_format=\"NCHW\", ksize=[1, 1, 2, 2], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](MaxPool/input)]]\r\n\r\nWith Avg:\r\n> tensorflow.python.framework.errors_impl.InvalidArgumentError: Default AvgPoolingOp only supports NHWC.\r\n         [[Node: AvgPool_1 = AvgPool[T=DT_FLOAT, data_format=\"NCHW\", ksize=[1, 1, 2, 2], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](AvgPool_1/input)]]\r\n"}