{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10522", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10522/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10522/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10522/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/10522", "id": 234453420, "node_id": "MDExOlB1bGxSZXF1ZXN0MTI0NTk2ODUx", "number": 10522, "title": "np.float64(\"np.inf\").astype(np.int32) is negative on x86 but positive on ppc64le", "user": {"login": "sandipmgiri", "id": 16284232, "node_id": "MDQ6VXNlcjE2Mjg0MjMy", "avatar_url": "https://avatars0.githubusercontent.com/u/16284232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandipmgiri", "html_url": "https://github.com/sandipmgiri", "followers_url": "https://api.github.com/users/sandipmgiri/followers", "following_url": "https://api.github.com/users/sandipmgiri/following{/other_user}", "gists_url": "https://api.github.com/users/sandipmgiri/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandipmgiri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandipmgiri/subscriptions", "organizations_url": "https://api.github.com/users/sandipmgiri/orgs", "repos_url": "https://api.github.com/users/sandipmgiri/repos", "events_url": "https://api.github.com/users/sandipmgiri/events{/privacy}", "received_events_url": "https://api.github.com/users/sandipmgiri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "fef2c0", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "prb12", "id": 11547801, "node_id": "MDQ6VXNlcjExNTQ3ODAx", "avatar_url": "https://avatars1.githubusercontent.com/u/11547801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prb12", "html_url": "https://github.com/prb12", "followers_url": "https://api.github.com/users/prb12/followers", "following_url": "https://api.github.com/users/prb12/following{/other_user}", "gists_url": "https://api.github.com/users/prb12/gists{/gist_id}", "starred_url": "https://api.github.com/users/prb12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prb12/subscriptions", "organizations_url": "https://api.github.com/users/prb12/orgs", "repos_url": "https://api.github.com/users/prb12/repos", "events_url": "https://api.github.com/users/prb12/events{/privacy}", "received_events_url": "https://api.github.com/users/prb12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "prb12", "id": 11547801, "node_id": "MDQ6VXNlcjExNTQ3ODAx", "avatar_url": "https://avatars1.githubusercontent.com/u/11547801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prb12", "html_url": "https://github.com/prb12", "followers_url": "https://api.github.com/users/prb12/followers", "following_url": "https://api.github.com/users/prb12/following{/other_user}", "gists_url": "https://api.github.com/users/prb12/gists{/gist_id}", "starred_url": "https://api.github.com/users/prb12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prb12/subscriptions", "organizations_url": "https://api.github.com/users/prb12/orgs", "repos_url": "https://api.github.com/users/prb12/repos", "events_url": "https://api.github.com/users/prb12/events{/privacy}", "received_events_url": "https://api.github.com/users/prb12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2017-06-08T08:46:11Z", "updated_at": "2017-06-30T10:01:42Z", "closed_at": "2017-06-30T00:19:15Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/10522", "html_url": "https://github.com/tensorflow/tensorflow/pull/10522", "diff_url": "https://github.com/tensorflow/tensorflow/pull/10522.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/10522.patch"}, "body_html": "<ul>\n<li>\n<p>np.float64(\"np.inf\").astype(np.int32) is negative on x86 but positive on ppc64le, that is the reason we<br>\nadded this special case for ppc64le</p>\n</li>\n<li>\n<p>Discussed with numpy community and they mentioned as follows -</p>\n</li>\n</ul>\n<ol>\n<li>Doing this cast incurs undefined behaviour, so it's hard to say which platform is incorrect here.<br>\nI'd argue that we should just issue a warning and leave the platform-specific behaviour.</li>\n<li>This is also true of any C program that tries to cast float to int. If the author of a python package<br>\nincluded a C extension that does this cast, they still have the problem.<br>\nThe same argument you use for \"we should fix this is numpy, not in the user package\" can be<br>\napplied to \"we should fix this in C, not in numpy\". Presumably for speed reasons, that argument was<br>\nrejected during the  design of C.<br>\nHaving said that, we already diverge from C behaviour in some place (eg, integer promotion for<br>\narithmetic and comparison), so it wouldn't be unreasonable  to add special casing here.</li>\n</ol>\n<p>Numpy link to relevant discussion - <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"225672370\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/numpy/numpy/issues/9040\" data-hovercard-type=\"issue\" data-hovercard-url=\"/numpy/numpy/issues/9040/hovercard\" href=\"https://github.com/numpy/numpy/issues/9040\">numpy/numpy#9040</a><br>\nAlso discussed this on Tensorflow , link to relevant discussion - <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"223364361\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9360\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9360/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9360\">#9360</a></p>", "body_text": "np.float64(\"np.inf\").astype(np.int32) is negative on x86 but positive on ppc64le, that is the reason we\nadded this special case for ppc64le\n\n\nDiscussed with numpy community and they mentioned as follows -\n\n\n\nDoing this cast incurs undefined behaviour, so it's hard to say which platform is incorrect here.\nI'd argue that we should just issue a warning and leave the platform-specific behaviour.\nThis is also true of any C program that tries to cast float to int. If the author of a python package\nincluded a C extension that does this cast, they still have the problem.\nThe same argument you use for \"we should fix this is numpy, not in the user package\" can be\napplied to \"we should fix this in C, not in numpy\". Presumably for speed reasons, that argument was\nrejected during the  design of C.\nHaving said that, we already diverge from C behaviour in some place (eg, integer promotion for\narithmetic and comparison), so it wouldn't be unreasonable  to add special casing here.\n\nNumpy link to relevant discussion - numpy/numpy#9040\nAlso discussed this on Tensorflow , link to relevant discussion - #9360", "body": "- np.float64(\"np.inf\").astype(np.int32) is negative on x86 but positive on ppc64le, that is the reason we \r\n  added this special case for ppc64le\r\n\r\n- Discussed with numpy community and they mentioned as follows -\r\n1) Doing this cast incurs undefined behaviour, so it's hard to say which platform is incorrect here.\r\n    I'd argue that we should just issue a warning and leave the platform-specific behaviour.\r\n2) This is also true of any C program that tries to cast float to int. If the author of a python package \r\n    included a C extension that does this cast, they still have the problem. \r\n   The same argument you use for \"we should fix this is numpy, not in the user package\" can be \r\n    applied to \"we should fix this in C, not in numpy\". Presumably for speed reasons, that argument was \r\n    rejected during the  design of C.\r\n    Having said that, we already diverge from C behaviour in some place (eg, integer promotion for \r\n    arithmetic and comparison), so it wouldn't be unreasonable  to add special casing here.\r\n    \r\nNumpy link to relevant discussion - https://github.com/numpy/numpy/issues/9040\r\nAlso discussed this on Tensorflow , link to relevant discussion - https://github.com/tensorflow/tensorflow/issues/9360\r\n"}