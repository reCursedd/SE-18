{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18421", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18421/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18421/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18421/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18421", "id": 313356611, "node_id": "MDU6SXNzdWUzMTMzNTY2MTE=", "number": 18421, "title": "Cannot apply convolution twice", "user": {"login": "tsoernes", "id": 6782404, "node_id": "MDQ6VXNlcjY3ODI0MDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/6782404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tsoernes", "html_url": "https://github.com/tsoernes", "followers_url": "https://api.github.com/users/tsoernes/followers", "following_url": "https://api.github.com/users/tsoernes/following{/other_user}", "gists_url": "https://api.github.com/users/tsoernes/gists{/gist_id}", "starred_url": "https://api.github.com/users/tsoernes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tsoernes/subscriptions", "organizations_url": "https://api.github.com/users/tsoernes/orgs", "repos_url": "https://api.github.com/users/tsoernes/repos", "events_url": "https://api.github.com/users/tsoernes/events{/privacy}", "received_events_url": "https://api.github.com/users/tsoernes/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-04-11T14:45:25Z", "updated_at": "2018-04-12T01:55:51Z", "closed_at": "2018-04-12T01:55:51Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Fedora 27</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>: Source</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>: b'v1.3.0-rc1-3011-gd86448938' 1.3.0</p>\n</li>\n<li>\n<p><strong>Python version</strong>: 3.6.4</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>: N/A</p>\n</li>\n<li>\n<p><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>: N/A</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>: N/A</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:</p>\n</li>\n</ul>\n<pre><code>import tensorflow as tf\n\nsess = tf.Session()\ninp1 = tf.ones((1, 2, 2, 5))\ninp2 = tf.zeros((1, 2, 2, 5))\n\nconv_layer = tf.layers.Conv2D(\n    filters=2,\n    kernel_size=2,\n    padding='SAME',\n    kernel_initializer=tf.glorot_uniform_initializer(),\n    name=\"vconv\")\ndense_layer = tf.layers.Dense(units=1, use_bias=False, activation=None)\n\ntdout1 = dense_layer.apply(inp1)\ntdout2 = dense_layer.apply(inp2)\nsess.run(tf.global_variables_initializer())\n# This works:\nprint(sess.run((tdout1, tdout2)))\n\ntcout1 = conv_layer.apply(inp1)\ntcout2 = conv_layer.apply(inp2)\nsess.run(tf.global_variables_initializer())\n# This does not work:\nprint(sess.run((tcout1, tcout2)))\n# ValueError: cannot add op with name vconv/convolution as that name is already used\n</code></pre>\n<p>Throws:</p>\n<pre><code>Traceback (most recent call last):\n  File \"div/tf_2conv.py\", line 16, in &lt;module&gt;\n    tcout2 = conv_layer.apply(inp2)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 659, in apply\n    return self.__call__(inputs, *args, **kwargs)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 563, in __call__\n    outputs = self.call(inputs, *args, **kwargs)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/convolutional.py\", line 171, in call\n    outputs = self._convolution_op(inputs, self.kernel)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 835, in __call__\n    return self.conv_op(inp, filter)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 499, in __call__\n    return self.call(inp, filter)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 187, in __call__\n    name=self.name)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 631, in conv2d\n    data_format=data_format, name=name)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2941, in create_op\n    self._add_op(ret)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2595, in _add_op\n    \"is already used\" % op.name)\nValueError: cannot add op with name vconv/convolution as that name is already used\n</code></pre>", "body_text": "System information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Fedora 27\n\n\nTensorFlow installed from (source or binary): Source\n\n\nTensorFlow version (use command below): b'v1.3.0-rc1-3011-gd86448938' 1.3.0\n\n\nPython version: 3.6.4\n\n\nBazel version (if compiling from source): N/A\n\n\nGCC/Compiler version (if compiling from source): N/A\n\n\nCUDA/cuDNN version: N/A\n\n\nGPU model and memory: N/A\n\n\nExact command to reproduce:\n\n\nimport tensorflow as tf\n\nsess = tf.Session()\ninp1 = tf.ones((1, 2, 2, 5))\ninp2 = tf.zeros((1, 2, 2, 5))\n\nconv_layer = tf.layers.Conv2D(\n    filters=2,\n    kernel_size=2,\n    padding='SAME',\n    kernel_initializer=tf.glorot_uniform_initializer(),\n    name=\"vconv\")\ndense_layer = tf.layers.Dense(units=1, use_bias=False, activation=None)\n\ntdout1 = dense_layer.apply(inp1)\ntdout2 = dense_layer.apply(inp2)\nsess.run(tf.global_variables_initializer())\n# This works:\nprint(sess.run((tdout1, tdout2)))\n\ntcout1 = conv_layer.apply(inp1)\ntcout2 = conv_layer.apply(inp2)\nsess.run(tf.global_variables_initializer())\n# This does not work:\nprint(sess.run((tcout1, tcout2)))\n# ValueError: cannot add op with name vconv/convolution as that name is already used\n\nThrows:\nTraceback (most recent call last):\n  File \"div/tf_2conv.py\", line 16, in <module>\n    tcout2 = conv_layer.apply(inp2)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 659, in apply\n    return self.__call__(inputs, *args, **kwargs)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 563, in __call__\n    outputs = self.call(inputs, *args, **kwargs)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/convolutional.py\", line 171, in call\n    outputs = self._convolution_op(inputs, self.kernel)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 835, in __call__\n    return self.conv_op(inp, filter)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 499, in __call__\n    return self.call(inp, filter)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 187, in __call__\n    name=self.name)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 631, in conv2d\n    data_format=data_format, name=name)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2941, in create_op\n    self._add_op(ret)\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2595, in _add_op\n    \"is already used\" % op.name)\nValueError: cannot add op with name vconv/convolution as that name is already used", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Fedora 27\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: b'v1.3.0-rc1-3011-gd86448938' 1.3.0\r\n\r\n- **Python version**: 3.6.4\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**:\r\n```\r\nimport tensorflow as tf\r\n\r\nsess = tf.Session()\r\ninp1 = tf.ones((1, 2, 2, 5))\r\ninp2 = tf.zeros((1, 2, 2, 5))\r\n\r\nconv_layer = tf.layers.Conv2D(\r\n    filters=2,\r\n    kernel_size=2,\r\n    padding='SAME',\r\n    kernel_initializer=tf.glorot_uniform_initializer(),\r\n    name=\"vconv\")\r\ndense_layer = tf.layers.Dense(units=1, use_bias=False, activation=None)\r\n\r\ntdout1 = dense_layer.apply(inp1)\r\ntdout2 = dense_layer.apply(inp2)\r\nsess.run(tf.global_variables_initializer())\r\n# This works:\r\nprint(sess.run((tdout1, tdout2)))\r\n\r\ntcout1 = conv_layer.apply(inp1)\r\ntcout2 = conv_layer.apply(inp2)\r\nsess.run(tf.global_variables_initializer())\r\n# This does not work:\r\nprint(sess.run((tcout1, tcout2)))\r\n# ValueError: cannot add op with name vconv/convolution as that name is already used\r\n```\r\nThrows:\r\n```\r\nTraceback (most recent call last):\r\n  File \"div/tf_2conv.py\", line 16, in <module>\r\n    tcout2 = conv_layer.apply(inp2)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 659, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 563, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/layers/convolutional.py\", line 171, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 835, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 499, in __call__\r\n    return self.call(inp, filter)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 187, in __call__\r\n    name=self.name)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 631, in conv2d\r\n    data_format=data_format, name=name)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2941, in create_op\r\n    self._add_op(ret)\r\n  File \"/home/torstein/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2595, in _add_op\r\n    \"is already used\" % op.name)\r\nValueError: cannot add op with name vconv/convolution as that name is already used\r\n```\r\n"}