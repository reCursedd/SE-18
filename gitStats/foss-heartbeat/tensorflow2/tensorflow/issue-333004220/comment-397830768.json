{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/397830768", "html_url": "https://github.com/tensorflow/tensorflow/pull/20078#issuecomment-397830768", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20078", "id": 397830768, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzgzMDc2OA==", "user": {"login": "aylusltd", "id": 965390, "node_id": "MDQ6VXNlcjk2NTM5MA==", "avatar_url": "https://avatars2.githubusercontent.com/u/965390?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aylusltd", "html_url": "https://github.com/aylusltd", "followers_url": "https://api.github.com/users/aylusltd/followers", "following_url": "https://api.github.com/users/aylusltd/following{/other_user}", "gists_url": "https://api.github.com/users/aylusltd/gists{/gist_id}", "starred_url": "https://api.github.com/users/aylusltd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aylusltd/subscriptions", "organizations_url": "https://api.github.com/users/aylusltd/orgs", "repos_url": "https://api.github.com/users/aylusltd/repos", "events_url": "https://api.github.com/users/aylusltd/events{/privacy}", "received_events_url": "https://api.github.com/users/aylusltd/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-16T18:27:28Z", "updated_at": "2018-06-16T18:27:28Z", "author_association": "NONE", "body_html": "<div class=\"email-fragment\">Good call, maybe the try block should be kept where it was and just\nduplicated inside save.</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Sat, Jun 16, 2018, 2:24 PM Shanqing Cai ***@***.***&gt; wrote:\n ***@***.**** commented on this pull request.\n ------------------------------\n\n In tensorflow/python/keras/engine/saving.py\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"333004220\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/20078\" href=\"https://github.com/tensorflow/tensorflow/pull/20078#discussion_r195909118\">#20078 (comment)</a>&gt;\n :\n\n &gt; @@ -73,8 +66,11 @@ def save_model(model, filepath, overwrite=True, include_optimizer=True):\n    Raises:\n        ImportError: if h5py is not available.\n    \"\"\"\n -\n -  if h5py is None:\n +  # pylint: disable=g-import-not-at-top\n +  try:\n +    import h5py\n +    HDF5_OBJECT_HEADER_LIMIT = 64512\n\n HDF5_OBJECT_HEADER_LIMIT used to be a module-wide global variable. Now it\n is private to this function. Won't this cause problems for functions that\n use it?\n\n \u2014\n You are receiving this because you authored the thread.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"333004220\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/20078\" href=\"https://github.com/tensorflow/tensorflow/pull/20078#pullrequestreview-129369649\">#20078 (review)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AA67DrayjjNlMjtlohUCfpl0RVsMd6g2ks5t9U1qgaJpZM4Uqj-m\">https://github.com/notifications/unsubscribe-auth/AA67DrayjjNlMjtlohUCfpl0RVsMd6g2ks5t9U1qgaJpZM4Uqj-m</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Good call, maybe the try block should be kept where it was and just\nduplicated inside save.\n\u2026\nOn Sat, Jun 16, 2018, 2:24 PM Shanqing Cai ***@***.***> wrote:\n ***@***.**** commented on this pull request.\n ------------------------------\n\n In tensorflow/python/keras/engine/saving.py\n <#20078 (comment)>\n :\n\n > @@ -73,8 +66,11 @@ def save_model(model, filepath, overwrite=True, include_optimizer=True):\n    Raises:\n        ImportError: if h5py is not available.\n    \"\"\"\n -\n -  if h5py is None:\n +  # pylint: disable=g-import-not-at-top\n +  try:\n +    import h5py\n +    HDF5_OBJECT_HEADER_LIMIT = 64512\n\n HDF5_OBJECT_HEADER_LIMIT used to be a module-wide global variable. Now it\n is private to this function. Won't this cause problems for functions that\n use it?\n\n \u2014\n You are receiving this because you authored the thread.\n Reply to this email directly, view it on GitHub\n <#20078 (review)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AA67DrayjjNlMjtlohUCfpl0RVsMd6g2ks5t9U1qgaJpZM4Uqj-m>\n .", "body": "Good call, maybe the try block should be kept where it was and just\nduplicated inside save.\n\nOn Sat, Jun 16, 2018, 2:24 PM Shanqing Cai <notifications@github.com> wrote:\n\n> *@caisq* commented on this pull request.\n> ------------------------------\n>\n> In tensorflow/python/keras/engine/saving.py\n> <https://github.com/tensorflow/tensorflow/pull/20078#discussion_r195909118>\n> :\n>\n> > @@ -73,8 +66,11 @@ def save_model(model, filepath, overwrite=True, include_optimizer=True):\n>    Raises:\n>        ImportError: if h5py is not available.\n>    \"\"\"\n> -\n> -  if h5py is None:\n> +  # pylint: disable=g-import-not-at-top\n> +  try:\n> +    import h5py\n> +    HDF5_OBJECT_HEADER_LIMIT = 64512\n>\n> HDF5_OBJECT_HEADER_LIMIT used to be a module-wide global variable. Now it\n> is private to this function. Won't this cause problems for functions that\n> use it?\n>\n> \u2014\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/20078#pullrequestreview-129369649>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AA67DrayjjNlMjtlohUCfpl0RVsMd6g2ks5t9U1qgaJpZM4Uqj-m>\n> .\n>\n"}