{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/373744131", "html_url": "https://github.com/tensorflow/tensorflow/issues/10125#issuecomment-373744131", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10125", "id": 373744131, "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzc0NDEzMQ==", "user": {"login": "llan-ml", "id": 22030149, "node_id": "MDQ6VXNlcjIyMDMwMTQ5", "avatar_url": "https://avatars0.githubusercontent.com/u/22030149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llan-ml", "html_url": "https://github.com/llan-ml", "followers_url": "https://api.github.com/users/llan-ml/followers", "following_url": "https://api.github.com/users/llan-ml/following{/other_user}", "gists_url": "https://api.github.com/users/llan-ml/gists{/gist_id}", "starred_url": "https://api.github.com/users/llan-ml/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llan-ml/subscriptions", "organizations_url": "https://api.github.com/users/llan-ml/orgs", "repos_url": "https://api.github.com/users/llan-ml/repos", "events_url": "https://api.github.com/users/llan-ml/events{/privacy}", "received_events_url": "https://api.github.com/users/llan-ml/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-16T15:12:48Z", "updated_at": "2018-03-17T03:12:29Z", "author_association": "NONE", "body_html": "<p>Thanks for your explanations <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=25035016\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/discoveredcheck\">@discoveredcheck</a>.</p>\n<p>On the other hand, to enable weight normalization for dense and convolutional layers, can we just add the weight normalization in the <code>self.build()</code> method of <code>tf.Layer</code>.<br>\nFor example, in the scenario of <code>Dense</code> layer, we can add weight normalization by modifying <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/layers/core.py#L132\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/layers/core.py#L132</a> as follows:</p>\n<pre>kernel = self.add_variable(\"kernel\", ...)\nif self._weight_norm:\n    g = self.add_variable(\"wn/g\", ...)\n    self.kernel = nn_impl.l2_normalize(kernel, axis=0) * g\nelse:\n    self.kernel = kernel\n</pre>\n<p>Similar modifications could be also made for <code>tensorflow.python.layers.convolutional._Conv</code>.<br>\nDo you have any suggestions?</p>", "body_text": "Thanks for your explanations @discoveredcheck.\nOn the other hand, to enable weight normalization for dense and convolutional layers, can we just add the weight normalization in the self.build() method of tf.Layer.\nFor example, in the scenario of Dense layer, we can add weight normalization by modifying https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/layers/core.py#L132 as follows:\nkernel = self.add_variable(\"kernel\", ...)\nif self._weight_norm:\n    g = self.add_variable(\"wn/g\", ...)\n    self.kernel = nn_impl.l2_normalize(kernel, axis=0) * g\nelse:\n    self.kernel = kernel\n\nSimilar modifications could be also made for tensorflow.python.layers.convolutional._Conv.\nDo you have any suggestions?", "body": "Thanks for your explanations @discoveredcheck. \r\n\r\nOn the other hand, to enable weight normalization for dense and convolutional layers, can we just add the weight normalization in the `self.build()` method of `tf.Layer`.\r\nFor example, in the scenario of `Dense` layer, we can add weight normalization by modifying https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/layers/core.py#L132 as follows:\r\n<pre>\r\nkernel = self.add_variable(\"kernel\", ...)\r\nif self._weight_norm:\r\n    g = self.add_variable(\"wn/g\", ...)\r\n    self.kernel = nn_impl.l2_normalize(kernel, axis=0) * g\r\nelse:\r\n    self.kernel = kernel\r\n</pre>\r\nSimilar modifications could be also made for `tensorflow.python.layers.convolutional._Conv`.\r\nDo you have any suggestions?"}