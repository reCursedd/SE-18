{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/272689942", "html_url": "https://github.com/tensorflow/tensorflow/issues/6846#issuecomment-272689942", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6846", "id": 272689942, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY4OTk0Mg==", "user": {"login": "foxik", "id": 560016, "node_id": "MDQ6VXNlcjU2MDAxNg==", "avatar_url": "https://avatars0.githubusercontent.com/u/560016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/foxik", "html_url": "https://github.com/foxik", "followers_url": "https://api.github.com/users/foxik/followers", "following_url": "https://api.github.com/users/foxik/following{/other_user}", "gists_url": "https://api.github.com/users/foxik/gists{/gist_id}", "starred_url": "https://api.github.com/users/foxik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/foxik/subscriptions", "organizations_url": "https://api.github.com/users/foxik/orgs", "repos_url": "https://api.github.com/users/foxik/repos", "events_url": "https://api.github.com/users/foxik/events{/privacy}", "received_events_url": "https://api.github.com/users/foxik/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-15T11:44:48Z", "updated_at": "2017-01-15T11:44:48Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I have encountered the issue before.</p>\n<p>The problem is that if <code>weights</code> has unknown shape (for example if it is <code>[None]</code>), the following line (referenced current head):<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/333dc32ff79af21484695157f3d141dc776f7c02/tensorflow/contrib/losses/python/losses/loss_ops.py#L424\">tensorflow/tensorflow/contrib/losses/python/losses/loss_ops.py</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 424\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/333dc32ff79af21484695157f3d141dc776f7c02\">333dc32</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L424\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"424\"></td>\n          <td id=\"LC424\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> weights <span class=\"pl-k\">=</span> array_ops.squeeze(weights) </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<br>\ncauses the resulting shape to be <code>None</code> (because the number of dimensions after the <code>squeeze</code> is unknown at construction time). Then the code in <code>compute_weighted_loss</code> throws an error.</p>\n<p>The solution is to remove the referenced line (you can see that it is not in <code>softmax_cross_entropy</code> call), because it interferes with the code for dealing with different shapes of <code>weights</code> present in <code>compute_weighted_loss</code>.</p>", "body_text": "I have encountered the issue before.\nThe problem is that if weights has unknown shape (for example if it is [None]), the following line (referenced current head):\n\n  \n    \n      tensorflow/tensorflow/contrib/losses/python/losses/loss_ops.py\n    \n    \n         Line 424\n      in\n      333dc32\n    \n    \n    \n    \n\n        \n          \n           weights = array_ops.squeeze(weights) \n        \n    \n  \n\n\ncauses the resulting shape to be None (because the number of dimensions after the squeeze is unknown at construction time). Then the code in compute_weighted_loss throws an error.\nThe solution is to remove the referenced line (you can see that it is not in softmax_cross_entropy call), because it interferes with the code for dealing with different shapes of weights present in compute_weighted_loss.", "body": "I have encountered the issue before.\r\n\r\nThe problem is that if `weights` has unknown shape (for example if it is `[None]`), the following line (referenced current head):\r\nhttps://github.com/tensorflow/tensorflow/blob/333dc32ff79af21484695157f3d141dc776f7c02/tensorflow/contrib/losses/python/losses/loss_ops.py#L424\r\ncauses the resulting shape to be `None` (because the number of dimensions after the `squeeze` is unknown at construction time). Then the code in `compute_weighted_loss` throws an error.\r\n\r\nThe solution is to remove the referenced line (you can see that it is not in `softmax_cross_entropy` call), because it interferes with the code for dealing with different shapes of `weights` present in `compute_weighted_loss`."}