{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19858", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19858/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19858/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19858/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19858", "id": 330663969, "node_id": "MDU6SXNzdWUzMzA2NjM5Njk=", "number": 19858, "title": "tf.einsum does not support spaces in equation", "user": {"login": "fortuin", "id": 24525710, "node_id": "MDQ6VXNlcjI0NTI1NzEw", "avatar_url": "https://avatars0.githubusercontent.com/u/24525710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fortuin", "html_url": "https://github.com/fortuin", "followers_url": "https://api.github.com/users/fortuin/followers", "following_url": "https://api.github.com/users/fortuin/following{/other_user}", "gists_url": "https://api.github.com/users/fortuin/gists{/gist_id}", "starred_url": "https://api.github.com/users/fortuin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fortuin/subscriptions", "organizations_url": "https://api.github.com/users/fortuin/orgs", "repos_url": "https://api.github.com/users/fortuin/repos", "events_url": "https://api.github.com/users/fortuin/events{/privacy}", "received_events_url": "https://api.github.com/users/fortuin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-06-08T13:44:01Z", "updated_at": "2018-06-13T22:32:14Z", "closed_at": "2018-06-13T22:32:14Z", "author_association": "CONTRIBUTOR", "body_html": "<p>In the numpy implementation, the <code>einsum</code> function supports spaces in the equations, but in TensorFlow it does not. I believe that spaces make the equations more readable.<br>\nFor instance in this example, the numpy function call works well, while the TF function call throws a kind of cryptic ValueError:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\nX <span class=\"pl-k\">=</span> np.random.random(<span class=\"pl-v\">size</span><span class=\"pl-k\">=</span>(<span class=\"pl-c1\">100</span>,<span class=\"pl-c1\">100</span>))\nX_tensor <span class=\"pl-k\">=</span> tf.constant(X)\n\neinsum_example_np <span class=\"pl-k\">=</span> np.einsum(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ij, jk -&gt; ik<span class=\"pl-pds\">\"</span></span>, X, X)\n\neinsum_example_tf <span class=\"pl-k\">=</span> tf.einsum(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ij, jk -&gt; ik<span class=\"pl-pds\">\"</span></span>, X_tensor, X_tensor)</pre></div>\n<p>By changing the last line to <code>einsum_example_tf = tf.einsum(\"ij,jk-&gt;ik\", X_tensor, X_tensor)</code> it can be made to work.<br>\nI think that this behavior can be confusing to people who are used to the handling of einsum equations in the numpy implementation. I would suggest to make the TF implementation also support spaces. This could probably be done by just stripping all spaces from the input to the equation argument.</p>", "body_text": "In the numpy implementation, the einsum function supports spaces in the equations, but in TensorFlow it does not. I believe that spaces make the equations more readable.\nFor instance in this example, the numpy function call works well, while the TF function call throws a kind of cryptic ValueError:\nimport numpy as np\nimport tensorflow as tf\n\nX = np.random.random(size=(100,100))\nX_tensor = tf.constant(X)\n\neinsum_example_np = np.einsum(\"ij, jk -> ik\", X, X)\n\neinsum_example_tf = tf.einsum(\"ij, jk -> ik\", X_tensor, X_tensor)\nBy changing the last line to einsum_example_tf = tf.einsum(\"ij,jk->ik\", X_tensor, X_tensor) it can be made to work.\nI think that this behavior can be confusing to people who are used to the handling of einsum equations in the numpy implementation. I would suggest to make the TF implementation also support spaces. This could probably be done by just stripping all spaces from the input to the equation argument.", "body": "In the numpy implementation, the `einsum` function supports spaces in the equations, but in TensorFlow it does not. I believe that spaces make the equations more readable.\r\nFor instance in this example, the numpy function call works well, while the TF function call throws a kind of cryptic ValueError:\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nX = np.random.random(size=(100,100))\r\nX_tensor = tf.constant(X)\r\n\r\neinsum_example_np = np.einsum(\"ij, jk -> ik\", X, X)\r\n\r\neinsum_example_tf = tf.einsum(\"ij, jk -> ik\", X_tensor, X_tensor)\r\n```\r\n\r\nBy changing the last line to `einsum_example_tf = tf.einsum(\"ij,jk->ik\", X_tensor, X_tensor)` it can be made to work.\r\nI think that this behavior can be confusing to people who are used to the handling of einsum equations in the numpy implementation. I would suggest to make the TF implementation also support spaces. This could probably be done by just stripping all spaces from the input to the equation argument."}