{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7008", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7008/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7008/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7008/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7008", "id": 202413139, "node_id": "MDU6SXNzdWUyMDI0MTMxMzk=", "number": 7008, "title": "Exported Tensorflow Model not Preserving Placeholder Shape", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-01-22T21:55:22Z", "updated_at": "2017-06-16T18:53:05Z", "closed_at": "2017-06-16T18:47:11Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I am using exporter from tensorflow.contrib.session_bundle to save out my model:</p>\n<pre><code>x = tf.placeholder(tf.float32, (None,) + (100, 200) + (1,))\n....\nsaver = tf_saver.Saver(sharded=True)\nmodel_exporter = exporter.Exporter(saver)\nmodel_exporter.init(\n    sess.graph.as_graph_def(),\n    named_graph_signatures={\n        'inputs': exporter.generic_signature({'images': x}),\n        'outputs': exporter.generic_signature({'classes': y})})\n</code></pre>\n<p>and then I load the model back in (session_bundle from tensorflow.contrib.session_bundle):</p>\n<pre><code>sess, meta_graph_def = session_bundle.load_session_bundle_from_path(input)\n</code></pre>\n<p>However when I inspect the Placeholder tensor corresponding to the input x, I see no shape information:</p>\n<pre><code>&gt; sess.graph.get_tensor_by_name(input_name)\n&lt;tf.Tensor 'Placeholder:0' shape=&lt;unknown&gt; dtype=float32&gt;\n</code></pre>\n<p>Is this by design or is there some bug causing the shape to be lost?</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>Report from SO: <a href=\"http://stackoverflow.com/questions/40733752/exported-tensorflow-model-not-preserving-placeholder-shape\" rel=\"nofollow\">http://stackoverflow.com/questions/40733752/exported-tensorflow-model-not-preserving-placeholder-shape</a></p>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nUsing <code>gcr.io/tensorflow/tensorflow:latest-devel-gpu</code> docker iamge</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):</p>\n<pre><code># ls -al /usr/local/cuda/lib64/libcud*\n-rw-r--r-- 1 root root    558720 Sep 14 23:02 /usr/local/cuda/lib64/libcudadevrt.a\nlrwxrwxrwx 1 root root        16 Sep 14 23:05 /usr/local/cuda/lib64/libcudart.so -&gt; libcudart.so.8.0\nlrwxrwxrwx 1 root root        19 Sep 14 23:05 /usr/local/cuda/lib64/libcudart.so.8.0 -&gt; libcudart.so.8.0.44\n-rw-r--r-- 1 root root    415432 Sep 14 23:02 /usr/local/cuda/lib64/libcudart.so.8.0.44\n-rw-r--r-- 1 root root    775162 Sep 14 23:02 /usr/local/cuda/lib64/libcudart_static.a\nlrwxrwxrwx 1 1000 users       13 Jul 27 05:55 /usr/local/cuda/lib64/libcudnn.so -&gt; libcudnn.so.5\nlrwxrwxrwx 1 1000 users       17 Jul 27 05:55 /usr/local/cuda/lib64/libcudnn.so.5 -&gt; libcudnn.so.5.1.5\n-rwxrwxr-x 1 1000 users 79337624 Jul 27 05:53 /usr/local/cuda/lib64/libcudnn.so.5.1.5\n-rw-rw-r-- 1 1000 users 69756172 Jul 27 05:53 /usr/local/cuda/lib64/libcudnn_static.a\n</code></pre>\n<p>If installed from source, provide</p>\n<ol>\n<li>The commit hash (<code>git rev-parse HEAD</code>)</li>\n</ol>\n<pre><code>4d924e796368163eff11a8151e8505715345f58d\n</code></pre>\n<ol start=\"2\">\n<li>The output of <code>bazel version</code></li>\n</ol>\n<pre><code># bazel version\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nExtracting Bazel installation...\nBuild label: 0.3.2\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\nBuild timestamp: 1475861110\nBuild timestamp as int: 1475861110\n</code></pre>", "body_text": "I am using exporter from tensorflow.contrib.session_bundle to save out my model:\nx = tf.placeholder(tf.float32, (None,) + (100, 200) + (1,))\n....\nsaver = tf_saver.Saver(sharded=True)\nmodel_exporter = exporter.Exporter(saver)\nmodel_exporter.init(\n    sess.graph.as_graph_def(),\n    named_graph_signatures={\n        'inputs': exporter.generic_signature({'images': x}),\n        'outputs': exporter.generic_signature({'classes': y})})\n\nand then I load the model back in (session_bundle from tensorflow.contrib.session_bundle):\nsess, meta_graph_def = session_bundle.load_session_bundle_from_path(input)\n\nHowever when I inspect the Placeholder tensor corresponding to the input x, I see no shape information:\n> sess.graph.get_tensor_by_name(input_name)\n<tf.Tensor 'Placeholder:0' shape=<unknown> dtype=float32>\n\nIs this by design or is there some bug causing the shape to be lost?\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nReport from SO: http://stackoverflow.com/questions/40733752/exported-tensorflow-model-not-preserving-placeholder-shape\nEnvironment info\nOperating System:\nUsing gcr.io/tensorflow/tensorflow:latest-devel-gpu docker iamge\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\n# ls -al /usr/local/cuda/lib64/libcud*\n-rw-r--r-- 1 root root    558720 Sep 14 23:02 /usr/local/cuda/lib64/libcudadevrt.a\nlrwxrwxrwx 1 root root        16 Sep 14 23:05 /usr/local/cuda/lib64/libcudart.so -> libcudart.so.8.0\nlrwxrwxrwx 1 root root        19 Sep 14 23:05 /usr/local/cuda/lib64/libcudart.so.8.0 -> libcudart.so.8.0.44\n-rw-r--r-- 1 root root    415432 Sep 14 23:02 /usr/local/cuda/lib64/libcudart.so.8.0.44\n-rw-r--r-- 1 root root    775162 Sep 14 23:02 /usr/local/cuda/lib64/libcudart_static.a\nlrwxrwxrwx 1 1000 users       13 Jul 27 05:55 /usr/local/cuda/lib64/libcudnn.so -> libcudnn.so.5\nlrwxrwxrwx 1 1000 users       17 Jul 27 05:55 /usr/local/cuda/lib64/libcudnn.so.5 -> libcudnn.so.5.1.5\n-rwxrwxr-x 1 1000 users 79337624 Jul 27 05:53 /usr/local/cuda/lib64/libcudnn.so.5.1.5\n-rw-rw-r-- 1 1000 users 69756172 Jul 27 05:53 /usr/local/cuda/lib64/libcudnn_static.a\n\nIf installed from source, provide\n\nThe commit hash (git rev-parse HEAD)\n\n4d924e796368163eff11a8151e8505715345f58d\n\n\nThe output of bazel version\n\n# bazel version\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nExtracting Bazel installation...\nBuild label: 0.3.2\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\nBuild timestamp: 1475861110\nBuild timestamp as int: 1475861110", "body": "I am using exporter from tensorflow.contrib.session_bundle to save out my model:\r\n\r\n```\r\nx = tf.placeholder(tf.float32, (None,) + (100, 200) + (1,))\r\n....\r\nsaver = tf_saver.Saver(sharded=True)\r\nmodel_exporter = exporter.Exporter(saver)\r\nmodel_exporter.init(\r\n    sess.graph.as_graph_def(),\r\n    named_graph_signatures={\r\n        'inputs': exporter.generic_signature({'images': x}),\r\n        'outputs': exporter.generic_signature({'classes': y})})\r\n```\r\nand then I load the model back in (session_bundle from tensorflow.contrib.session_bundle):\r\n\r\n```\r\nsess, meta_graph_def = session_bundle.load_session_bundle_from_path(input)\r\n```\r\nHowever when I inspect the Placeholder tensor corresponding to the input x, I see no shape information:\r\n```\r\n> sess.graph.get_tensor_by_name(input_name)\r\n<tf.Tensor 'Placeholder:0' shape=<unknown> dtype=float32>\r\n```\r\nIs this by design or is there some bug causing the shape to be lost?\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nReport from SO: http://stackoverflow.com/questions/40733752/exported-tensorflow-model-not-preserving-placeholder-shape\r\n\r\n### Environment info\r\nOperating System:\r\nUsing `gcr.io/tensorflow/tensorflow:latest-devel-gpu` docker iamge\r\n\r\nInstalled version of CUDA and cuDNN: \r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n```\r\n# ls -al /usr/local/cuda/lib64/libcud*\r\n-rw-r--r-- 1 root root    558720 Sep 14 23:02 /usr/local/cuda/lib64/libcudadevrt.a\r\nlrwxrwxrwx 1 root root        16 Sep 14 23:05 /usr/local/cuda/lib64/libcudart.so -> libcudart.so.8.0\r\nlrwxrwxrwx 1 root root        19 Sep 14 23:05 /usr/local/cuda/lib64/libcudart.so.8.0 -> libcudart.so.8.0.44\r\n-rw-r--r-- 1 root root    415432 Sep 14 23:02 /usr/local/cuda/lib64/libcudart.so.8.0.44\r\n-rw-r--r-- 1 root root    775162 Sep 14 23:02 /usr/local/cuda/lib64/libcudart_static.a\r\nlrwxrwxrwx 1 1000 users       13 Jul 27 05:55 /usr/local/cuda/lib64/libcudnn.so -> libcudnn.so.5\r\nlrwxrwxrwx 1 1000 users       17 Jul 27 05:55 /usr/local/cuda/lib64/libcudnn.so.5 -> libcudnn.so.5.1.5\r\n-rwxrwxr-x 1 1000 users 79337624 Jul 27 05:53 /usr/local/cuda/lib64/libcudnn.so.5.1.5\r\n-rw-rw-r-- 1 1000 users 69756172 Jul 27 05:53 /usr/local/cuda/lib64/libcudnn_static.a\r\n```\r\n\r\nIf installed from source, provide \r\n\r\n1. The commit hash (`git rev-parse HEAD`)\r\n```\r\n4d924e796368163eff11a8151e8505715345f58d\r\n```\r\n2. The output of `bazel version`\r\n```\r\n# bazel version\r\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\r\nExtracting Bazel installation...\r\nBuild label: 0.3.2\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\r\nBuild timestamp: 1475861110\r\nBuild timestamp as int: 1475861110\r\n```\r\n"}