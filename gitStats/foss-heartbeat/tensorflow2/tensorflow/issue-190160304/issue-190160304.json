{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5676", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5676/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5676/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5676/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5676", "id": 190160304, "node_id": "MDU6SXNzdWUxOTAxNjAzMDQ=", "number": 5676, "title": "UnicodeDecodeError when reading from tfrecords", "user": {"login": "CRSilkworth", "id": 12122869, "node_id": "MDQ6VXNlcjEyMTIyODY5", "avatar_url": "https://avatars0.githubusercontent.com/u/12122869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CRSilkworth", "html_url": "https://github.com/CRSilkworth", "followers_url": "https://api.github.com/users/CRSilkworth/followers", "following_url": "https://api.github.com/users/CRSilkworth/following{/other_user}", "gists_url": "https://api.github.com/users/CRSilkworth/gists{/gist_id}", "starred_url": "https://api.github.com/users/CRSilkworth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CRSilkworth/subscriptions", "organizations_url": "https://api.github.com/users/CRSilkworth/orgs", "repos_url": "https://api.github.com/users/CRSilkworth/repos", "events_url": "https://api.github.com/users/CRSilkworth/events{/privacy}", "received_events_url": "https://api.github.com/users/CRSilkworth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "saxenasaurabh", "id": 3967488, "node_id": "MDQ6VXNlcjM5Njc0ODg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3967488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saxenasaurabh", "html_url": "https://github.com/saxenasaurabh", "followers_url": "https://api.github.com/users/saxenasaurabh/followers", "following_url": "https://api.github.com/users/saxenasaurabh/following{/other_user}", "gists_url": "https://api.github.com/users/saxenasaurabh/gists{/gist_id}", "starred_url": "https://api.github.com/users/saxenasaurabh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saxenasaurabh/subscriptions", "organizations_url": "https://api.github.com/users/saxenasaurabh/orgs", "repos_url": "https://api.github.com/users/saxenasaurabh/repos", "events_url": "https://api.github.com/users/saxenasaurabh/events{/privacy}", "received_events_url": "https://api.github.com/users/saxenasaurabh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "saxenasaurabh", "id": 3967488, "node_id": "MDQ6VXNlcjM5Njc0ODg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3967488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saxenasaurabh", "html_url": "https://github.com/saxenasaurabh", "followers_url": "https://api.github.com/users/saxenasaurabh/followers", "following_url": "https://api.github.com/users/saxenasaurabh/following{/other_user}", "gists_url": "https://api.github.com/users/saxenasaurabh/gists{/gist_id}", "starred_url": "https://api.github.com/users/saxenasaurabh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saxenasaurabh/subscriptions", "organizations_url": "https://api.github.com/users/saxenasaurabh/orgs", "repos_url": "https://api.github.com/users/saxenasaurabh/repos", "events_url": "https://api.github.com/users/saxenasaurabh/events{/privacy}", "received_events_url": "https://api.github.com/users/saxenasaurabh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 22, "created_at": "2016-11-17T20:50:08Z", "updated_at": "2018-02-28T20:50:43Z", "closed_at": "2018-02-28T20:50:43Z", "author_association": "NONE", "body_html": "<p>All I'm really trying to do is read a large array from a tfrecords file. I can do it so long that it's below a 8million ints but above that I get a unicode error, which doesn't seem to make much sense to me. Also, it worth noting that this script works using r0.9. I have about 64GB of ram on my computer so I doubt it's a memory issue.</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>None</p>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nLinux Mint 18 Sarah (GNU/Linux 4.4.0-47-generic x86_64)</p>\n<p>Installed version of CUDA and cuDNN:<br>\nnot installed</p>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>\n<p>A link to the pip package you installed:<br>\n<a href=\"https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.11.0-cp27-none-linux_x86_64.whl\" rel=\"nofollow\">https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.11.0-cp27-none-linux_x86_64.whl</a></p>\n</li>\n<li>\n<p>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.<br>\npython -c \"import tensorflow; print(tensorflow.<strong>version</strong>)\"</p>\n</li>\n</ol>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<pre><code>import tensorflow as tf\nimport numpy as np\n\ndim_size = 9000000\n\n# Create the array\narray = np.zeros([dim_size], dtype=int)\n\nexample = tf.train.Example(\n    features = tf.train.Features(\n        feature = {\n            'array': tf.train.Feature(\n                bytes_list= tf.train.BytesList(value=[array.tostring()])\n            )\n        }\n    )\n)\n\n# Write the example to disk\nwriter = tf.python_io.TFRecordWriter('temp.tfrecords')\nwriter.write(example.SerializeToString())\nwriter.close()\n\n# Define input pipeline\nqueue = tf.train.string_input_producer(['temp.tfrecords'], shuffle=False, num_epochs=1)\nreader = tf.TFRecordReader()\n_, se = reader.read(queue)\n\n#Define the parsed dict\nparsed = tf.parse_single_example(\n    serialized=se,\n    features={\n        \"array\":tf.FixedLenFeature([], tf.string),\n    }\n)\n\n# Decode the example\ntens = tf.decode_raw(parsed['array'], tf.int64)\n\n# Define the init op.\ninit_op = tf.group(\n    tf.initialize_all_variables(),\n    tf.initialize_local_variables()\n)\nwith tf.Session() as sess:\n    sess.run(init_op)\n    # Define coordinator and threads\n    coord = tf.train.Coordinator()\n    threads = tf.train.start_queue_runners(coord=coord, sess=sess)\n\n    # Run the reading operation\n    print sess.run([tens])\n    coord.request_stop()\n    coord.join(threads)\n</code></pre>\n<h3>What other attempted solutions have you tried?</h3>\n<p>This works using r0.9 and it also works if you lower the dim_size below 800000. So it seems to be an issue with the size and r0.11. I also get the same results if I use a float array as opposed to an int.</p>\n<h3>Logs or other output that would be helpful</h3>\n<pre><code>W tensorflow/core/framework/op_kernel.cc:968] Invalid argument: Could not parse example input, value: '\n?\u012a\"\n?\u012a\"\narray?\u012a\"\n?\u012a\"\n?\u012a\"\nTraceback (most recent call last):\n  File \"temp.py\", line 52, in &lt;module&gt;\n    print sess.run([tens])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 717, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 915, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 972, in _do_call\n    return fn(*args)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 954, in _run_fn\n    status, run_metadata)\n  File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n    self.gen.next()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/errors.py\", line 462, in raise_exception_on_not_ok_status\n    compat.as_text(pywrap_tensorflow.TF_Message(status)),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/compat.py\", line 82, in as_text\n    return bytes_or_text.decode('utf-8')\n  File \"/usr/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x9b in position 40: invalid start byte\n</code></pre>", "body_text": "All I'm really trying to do is read a large array from a tfrecords file. I can do it so long that it's below a 8million ints but above that I get a unicode error, which doesn't seem to make much sense to me. Also, it worth noting that this script works using r0.9. I have about 64GB of ram on my computer so I doubt it's a memory issue.\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nNone\nEnvironment info\nOperating System:\nLinux Mint 18 Sarah (GNU/Linux 4.4.0-47-generic x86_64)\nInstalled version of CUDA and cuDNN:\nnot installed\nIf installed from binary pip package, provide:\n\n\nA link to the pip package you installed:\nhttps://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.11.0-cp27-none-linux_x86_64.whl\n\n\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\npython -c \"import tensorflow; print(tensorflow.version)\"\n\n\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nimport tensorflow as tf\nimport numpy as np\n\ndim_size = 9000000\n\n# Create the array\narray = np.zeros([dim_size], dtype=int)\n\nexample = tf.train.Example(\n    features = tf.train.Features(\n        feature = {\n            'array': tf.train.Feature(\n                bytes_list= tf.train.BytesList(value=[array.tostring()])\n            )\n        }\n    )\n)\n\n# Write the example to disk\nwriter = tf.python_io.TFRecordWriter('temp.tfrecords')\nwriter.write(example.SerializeToString())\nwriter.close()\n\n# Define input pipeline\nqueue = tf.train.string_input_producer(['temp.tfrecords'], shuffle=False, num_epochs=1)\nreader = tf.TFRecordReader()\n_, se = reader.read(queue)\n\n#Define the parsed dict\nparsed = tf.parse_single_example(\n    serialized=se,\n    features={\n        \"array\":tf.FixedLenFeature([], tf.string),\n    }\n)\n\n# Decode the example\ntens = tf.decode_raw(parsed['array'], tf.int64)\n\n# Define the init op.\ninit_op = tf.group(\n    tf.initialize_all_variables(),\n    tf.initialize_local_variables()\n)\nwith tf.Session() as sess:\n    sess.run(init_op)\n    # Define coordinator and threads\n    coord = tf.train.Coordinator()\n    threads = tf.train.start_queue_runners(coord=coord, sess=sess)\n\n    # Run the reading operation\n    print sess.run([tens])\n    coord.request_stop()\n    coord.join(threads)\n\nWhat other attempted solutions have you tried?\nThis works using r0.9 and it also works if you lower the dim_size below 800000. So it seems to be an issue with the size and r0.11. I also get the same results if I use a float array as opposed to an int.\nLogs or other output that would be helpful\nW tensorflow/core/framework/op_kernel.cc:968] Invalid argument: Could not parse example input, value: '\n?\u012a\"\n?\u012a\"\narray?\u012a\"\n?\u012a\"\n?\u012a\"\nTraceback (most recent call last):\n  File \"temp.py\", line 52, in <module>\n    print sess.run([tens])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 717, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 915, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 972, in _do_call\n    return fn(*args)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 954, in _run_fn\n    status, run_metadata)\n  File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n    self.gen.next()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/errors.py\", line 462, in raise_exception_on_not_ok_status\n    compat.as_text(pywrap_tensorflow.TF_Message(status)),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/compat.py\", line 82, in as_text\n    return bytes_or_text.decode('utf-8')\n  File \"/usr/lib/python2.7/encodings/utf_8.py\", line 16, in decode\n    return codecs.utf_8_decode(input, errors, True)\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x9b in position 40: invalid start byte", "body": "All I'm really trying to do is read a large array from a tfrecords file. I can do it so long that it's below a 8million ints but above that I get a unicode error, which doesn't seem to make much sense to me. Also, it worth noting that this script works using r0.9. I have about 64GB of ram on my computer so I doubt it's a memory issue. \r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nNone\r\n\r\n### Environment info\r\nOperating System:\r\nLinux Mint 18 Sarah (GNU/Linux 4.4.0-47-generic x86_64)\r\n\r\nInstalled version of CUDA and cuDNN: \r\nnot installed\r\n\r\nIf installed from binary pip package, provide:\r\n\r\n1. A link to the pip package you installed:\r\nhttps://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.11.0-cp27-none-linux_x86_64.whl\r\n\r\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\r\npython -c \"import tensorflow; print(tensorflow.__version__)\"\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\ndim_size = 9000000\r\n\r\n# Create the array\r\narray = np.zeros([dim_size], dtype=int)\r\n\r\nexample = tf.train.Example(\r\n    features = tf.train.Features(\r\n        feature = {\r\n            'array': tf.train.Feature(\r\n                bytes_list= tf.train.BytesList(value=[array.tostring()])\r\n            )\r\n        }\r\n    )\r\n)\r\n\r\n# Write the example to disk\r\nwriter = tf.python_io.TFRecordWriter('temp.tfrecords')\r\nwriter.write(example.SerializeToString())\r\nwriter.close()\r\n\r\n# Define input pipeline\r\nqueue = tf.train.string_input_producer(['temp.tfrecords'], shuffle=False, num_epochs=1)\r\nreader = tf.TFRecordReader()\r\n_, se = reader.read(queue)\r\n\r\n#Define the parsed dict\r\nparsed = tf.parse_single_example(\r\n    serialized=se,\r\n    features={\r\n        \"array\":tf.FixedLenFeature([], tf.string),\r\n    }\r\n)\r\n\r\n# Decode the example\r\ntens = tf.decode_raw(parsed['array'], tf.int64)\r\n\r\n# Define the init op.\r\ninit_op = tf.group(\r\n    tf.initialize_all_variables(),\r\n    tf.initialize_local_variables()\r\n)\r\nwith tf.Session() as sess:\r\n    sess.run(init_op)\r\n    # Define coordinator and threads\r\n    coord = tf.train.Coordinator()\r\n    threads = tf.train.start_queue_runners(coord=coord, sess=sess)\r\n\r\n    # Run the reading operation\r\n    print sess.run([tens])\r\n    coord.request_stop()\r\n    coord.join(threads)\r\n```\r\n\r\n### What other attempted solutions have you tried?\r\nThis works using r0.9 and it also works if you lower the dim_size below 800000. So it seems to be an issue with the size and r0.11. I also get the same results if I use a float array as opposed to an int. \r\n\r\n### Logs or other output that would be helpful\r\n```\r\nW tensorflow/core/framework/op_kernel.cc:968] Invalid argument: Could not parse example input, value: '\r\n?\u012a\"\r\n?\u012a\"\r\narray?\u012a\"\r\n?\u012a\"\r\n?\u012a\"\r\nTraceback (most recent call last):\r\n  File \"temp.py\", line 52, in <module>\r\n    print sess.run([tens])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 717, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 915, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 972, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 954, in _run_fn\r\n    status, run_metadata)\r\n  File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\r\n    self.gen.next()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/errors.py\", line 462, in raise_exception_on_not_ok_status\r\n    compat.as_text(pywrap_tensorflow.TF_Message(status)),\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/compat.py\", line 82, in as_text\r\n    return bytes_or_text.decode('utf-8')\r\n  File \"/usr/lib/python2.7/encodings/utf_8.py\", line 16, in decode\r\n    return codecs.utf_8_decode(input, errors, True)\r\nUnicodeDecodeError: 'utf8' codec can't decode byte 0x9b in position 40: invalid start byte\r\n```\r\n"}