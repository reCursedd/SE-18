{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/339602960", "html_url": "https://github.com/tensorflow/tensorflow/issues/13101#issuecomment-339602960", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13101", "id": 339602960, "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTYwMjk2MA==", "user": {"login": "tillahoffmann", "id": 966348, "node_id": "MDQ6VXNlcjk2NjM0OA==", "avatar_url": "https://avatars2.githubusercontent.com/u/966348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tillahoffmann", "html_url": "https://github.com/tillahoffmann", "followers_url": "https://api.github.com/users/tillahoffmann/followers", "following_url": "https://api.github.com/users/tillahoffmann/following{/other_user}", "gists_url": "https://api.github.com/users/tillahoffmann/gists{/gist_id}", "starred_url": "https://api.github.com/users/tillahoffmann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tillahoffmann/subscriptions", "organizations_url": "https://api.github.com/users/tillahoffmann/orgs", "repos_url": "https://api.github.com/users/tillahoffmann/repos", "events_url": "https://api.github.com/users/tillahoffmann/events{/privacy}", "received_events_url": "https://api.github.com/users/tillahoffmann/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-26T09:12:31Z", "updated_at": "2017-10-26T09:12:31Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a>, <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1072079\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jsimsa\">@jsimsa</a>, thank you for the updates.</p>\n<p>I have changed the line</p>\n<div class=\"highlight highlight-source-python\"><pre>batches <span class=\"pl-k\">=</span> dataset.batch(<span class=\"pl-c1\">BATCH_SIZE</span>).prefetch(<span class=\"pl-c1\">PREFETCH_FACTOR</span> <span class=\"pl-k\">*</span> <span class=\"pl-c1\">BATCH_SIZE</span>)</pre></div>\n<p>to</p>\n<div class=\"highlight highlight-source-python\"><pre>batches <span class=\"pl-k\">=</span> dataset.apply(map_and_batch(<span class=\"pl-k\">lambda</span> <span class=\"pl-smi\">a</span>, <span class=\"pl-smi\">b</span>: (a, b), <span class=\"pl-c1\">BATCH_SIZE</span>)).prefetch(<span class=\"pl-c1\">PREFETCH_FACTOR</span> <span class=\"pl-k\">*</span> <span class=\"pl-c1\">BATCH_SIZE</span>)</pre></div>\n<p>in the <a href=\"https://gist.github.com/tillahoffmann/53f902212c1c511e6c3d45abb5f37b9b\">notebook</a> linked <a href=\"https://github.com/tensorflow/tensorflow/issues/13101#issuecomment-334788891\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/13101/hovercard\">above</a>. But the code hangs indefinitely when I try to train.</p>", "body_text": "@mrry, @jsimsa, thank you for the updates.\nI have changed the line\nbatches = dataset.batch(BATCH_SIZE).prefetch(PREFETCH_FACTOR * BATCH_SIZE)\nto\nbatches = dataset.apply(map_and_batch(lambda a, b: (a, b), BATCH_SIZE)).prefetch(PREFETCH_FACTOR * BATCH_SIZE)\nin the notebook linked above. But the code hangs indefinitely when I try to train.", "body": "@mrry, @jsimsa, thank you for the updates.\r\n\r\nI have changed the line\r\n```python\r\nbatches = dataset.batch(BATCH_SIZE).prefetch(PREFETCH_FACTOR * BATCH_SIZE)\r\n```\r\nto\r\n```python\r\nbatches = dataset.apply(map_and_batch(lambda a, b: (a, b), BATCH_SIZE)).prefetch(PREFETCH_FACTOR * BATCH_SIZE)\r\n```\r\nin the [notebook](https://gist.github.com/tillahoffmann/53f902212c1c511e6c3d45abb5f37b9b) linked [above](https://github.com/tensorflow/tensorflow/issues/13101#issuecomment-334788891). But the code hangs indefinitely when I try to train."}