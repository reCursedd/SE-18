{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/290799958", "html_url": "https://github.com/tensorflow/tensorflow/issues/8854#issuecomment-290799958", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8854", "id": 290799958, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDc5OTk1OA==", "user": {"login": "brandondutra", "id": 21314536, "node_id": "MDQ6VXNlcjIxMzE0NTM2", "avatar_url": "https://avatars0.githubusercontent.com/u/21314536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brandondutra", "html_url": "https://github.com/brandondutra", "followers_url": "https://api.github.com/users/brandondutra/followers", "following_url": "https://api.github.com/users/brandondutra/following{/other_user}", "gists_url": "https://api.github.com/users/brandondutra/gists{/gist_id}", "starred_url": "https://api.github.com/users/brandondutra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brandondutra/subscriptions", "organizations_url": "https://api.github.com/users/brandondutra/orgs", "repos_url": "https://api.github.com/users/brandondutra/repos", "events_url": "https://api.github.com/users/brandondutra/events{/privacy}", "received_events_url": "https://api.github.com/users/brandondutra/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-31T19:00:06Z", "updated_at": "2017-03-31T19:00:06Z", "author_association": "NONE", "body_html": "<p>This is awesome! Thank you for your help. I took your script and ran it, but I ran into an issue:</p>\n<p><code>google.protobuf.message.DecodeError: Error parsing message</code></p>\n<p>Because the error is in parsing the message, I looked into tensorflow protos. I modified your script, and got it working on my saved_model.pb file.</p>\n<pre><code>import tensorflow as tf\nimport sys\nfrom tensorflow.python.platform import gfile\n\nfrom tensorflow.core.protobuf import saved_model_pb2\nfrom tensorflow.python.util import compat\n\nwith tf.Session() as sess:\n    model_filename ='saved_model.pb'\n    with gfile.FastGFile(model_filename, 'rb') as f:\n\n      \tdata = compat.as_bytes(f.read())\n      \tsm = saved_model_pb2.SavedModel()\n      \tsm.ParseFromString(data)\n      \t#print(sm)\n      \tif 1 != len(sm.meta_graphs):\n      \t\tprint('More than one graph found. Not sure which to write')\n      \t\tsys.exit(1)\n\n      \t#graph_def = tf.GraphDef()\n        #graph_def.ParseFromString(sm.meta_graphs[0])\n        g_in = tf.import_graph_def(sm.meta_graphs[0].graph_def)\nLOGDIR='YOUR_LOG_LOCATION'\ntrain_writer = tf.summary.FileWriter(LOGDIR)\ntrain_writer.add_graph(sess.graph)\n</code></pre>\n<p>Again, thank you!</p>", "body_text": "This is awesome! Thank you for your help. I took your script and ran it, but I ran into an issue:\ngoogle.protobuf.message.DecodeError: Error parsing message\nBecause the error is in parsing the message, I looked into tensorflow protos. I modified your script, and got it working on my saved_model.pb file.\nimport tensorflow as tf\nimport sys\nfrom tensorflow.python.platform import gfile\n\nfrom tensorflow.core.protobuf import saved_model_pb2\nfrom tensorflow.python.util import compat\n\nwith tf.Session() as sess:\n    model_filename ='saved_model.pb'\n    with gfile.FastGFile(model_filename, 'rb') as f:\n\n      \tdata = compat.as_bytes(f.read())\n      \tsm = saved_model_pb2.SavedModel()\n      \tsm.ParseFromString(data)\n      \t#print(sm)\n      \tif 1 != len(sm.meta_graphs):\n      \t\tprint('More than one graph found. Not sure which to write')\n      \t\tsys.exit(1)\n\n      \t#graph_def = tf.GraphDef()\n        #graph_def.ParseFromString(sm.meta_graphs[0])\n        g_in = tf.import_graph_def(sm.meta_graphs[0].graph_def)\nLOGDIR='YOUR_LOG_LOCATION'\ntrain_writer = tf.summary.FileWriter(LOGDIR)\ntrain_writer.add_graph(sess.graph)\n\nAgain, thank you!", "body": "This is awesome! Thank you for your help. I took your script and ran it, but I ran into an issue:\r\n\r\n`google.protobuf.message.DecodeError: Error parsing message`\r\n\r\nBecause the error is in parsing the message, I looked into tensorflow protos. I modified your script, and got it working on my saved_model.pb file.\r\n\r\n\r\n```\r\nimport tensorflow as tf\r\nimport sys\r\nfrom tensorflow.python.platform import gfile\r\n\r\nfrom tensorflow.core.protobuf import saved_model_pb2\r\nfrom tensorflow.python.util import compat\r\n\r\nwith tf.Session() as sess:\r\n    model_filename ='saved_model.pb'\r\n    with gfile.FastGFile(model_filename, 'rb') as f:\r\n\r\n      \tdata = compat.as_bytes(f.read())\r\n      \tsm = saved_model_pb2.SavedModel()\r\n      \tsm.ParseFromString(data)\r\n      \t#print(sm)\r\n      \tif 1 != len(sm.meta_graphs):\r\n      \t\tprint('More than one graph found. Not sure which to write')\r\n      \t\tsys.exit(1)\r\n\r\n      \t#graph_def = tf.GraphDef()\r\n        #graph_def.ParseFromString(sm.meta_graphs[0])\r\n        g_in = tf.import_graph_def(sm.meta_graphs[0].graph_def)\r\nLOGDIR='YOUR_LOG_LOCATION'\r\ntrain_writer = tf.summary.FileWriter(LOGDIR)\r\ntrain_writer.add_graph(sess.graph)\r\n```\r\n\r\nAgain, thank you!"}