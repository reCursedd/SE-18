{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15152", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15152/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15152/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15152/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15152", "id": 279721423, "node_id": "MDU6SXNzdWUyNzk3MjE0MjM=", "number": 15152, "title": "Strange Dataset API behaviour", "user": {"login": "sofeikov", "id": 6204851, "node_id": "MDQ6VXNlcjYyMDQ4NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6204851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sofeikov", "html_url": "https://github.com/sofeikov", "followers_url": "https://api.github.com/users/sofeikov/followers", "following_url": "https://api.github.com/users/sofeikov/following{/other_user}", "gists_url": "https://api.github.com/users/sofeikov/gists{/gist_id}", "starred_url": "https://api.github.com/users/sofeikov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sofeikov/subscriptions", "organizations_url": "https://api.github.com/users/sofeikov/orgs", "repos_url": "https://api.github.com/users/sofeikov/repos", "events_url": "https://api.github.com/users/sofeikov/events{/privacy}", "received_events_url": "https://api.github.com/users/sofeikov/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-12-06T11:38:01Z", "updated_at": "2017-12-07T05:13:24Z", "closed_at": "2017-12-07T05:13:24Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nyes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nLinux Ubuntu 14.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nbinary</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\nv1.4.0-rc1-11-g130a514 1.4.0</li>\n<li><strong>Python version</strong>:<br>\nsys.version_info(major=3, minor=4, micro=3, releaselevel='final', serial=0)</li>\n<li><strong>Bazel version (if compiling from source)</strong>:<br>\nn/a</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:<br>\nn/a</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\nCuda 8.0</li>\n<li><strong>GPU model and memory</strong>:<br>\nTitan XP 12Gb</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I get very strange behaviour of image read function. See attached screenshot from tensorboard. This is NOT a tensorboard problem as I get images as they are from Dataset object.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/6204851/33659749-37586c4e-da79-11e7-8977-7d8f6da31c2d.png\"><img src=\"https://user-images.githubusercontent.com/6204851/33659749-37586c4e-da79-11e7-8977-7d8f6da31c2d.png\" alt=\"kodak_messed\" style=\"max-width:100%;\"></a></p>\n<p>Source images are fine, I have attached a zip archive with source images:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1534996/Kodak.zip\">Kodak.zip</a></p>\n<pre><code>import glob\nimport tensorflow as tf\n\ndef simply_read_image(image_path):\n    image_string = tf.read_file(image_path)\n    image_source = tf.image.decode_png(image_string, channels=3)\n    image_source = tf.image.convert_image_dtype(image_source, dtype=tf.float32)\n    return image_source\n\nvalidation_files = glob.glob(os.path.join(validation_folder, '*.png'))\n\ndataset = tf.data.Dataset.from_tensor_slices(validation_files)\ndataset = dataset.map(simply_read_image).batch(len(validation_files)).repeat(30)\n\nnext_element = iterator.get_next()\n\n    with tf.Session() as s:\n        for i in range(30):\n            im = s.run(next_element)\n            for j in range(25):\n                current_image = im[j]\n                pass\n\n</code></pre>\n<p>Any <code> current_image</code> with portrait orientation seems to be read incorrectly.</p>\n<h3>Source code / logs</h3>\n<p>There are no logs that could help</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nyes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nLinux Ubuntu 14.04\nTensorFlow installed from (source or binary):\nbinary\nTensorFlow version (use command below):\nv1.4.0-rc1-11-g130a514 1.4.0\nPython version:\nsys.version_info(major=3, minor=4, micro=3, releaselevel='final', serial=0)\nBazel version (if compiling from source):\nn/a\nGCC/Compiler version (if compiling from source):\nn/a\nCUDA/cuDNN version:\nCuda 8.0\nGPU model and memory:\nTitan XP 12Gb\nExact command to reproduce:\n\nDescribe the problem\nI get very strange behaviour of image read function. See attached screenshot from tensorboard. This is NOT a tensorboard problem as I get images as they are from Dataset object.\n\nSource images are fine, I have attached a zip archive with source images:\nKodak.zip\nimport glob\nimport tensorflow as tf\n\ndef simply_read_image(image_path):\n    image_string = tf.read_file(image_path)\n    image_source = tf.image.decode_png(image_string, channels=3)\n    image_source = tf.image.convert_image_dtype(image_source, dtype=tf.float32)\n    return image_source\n\nvalidation_files = glob.glob(os.path.join(validation_folder, '*.png'))\n\ndataset = tf.data.Dataset.from_tensor_slices(validation_files)\ndataset = dataset.map(simply_read_image).batch(len(validation_files)).repeat(30)\n\nnext_element = iterator.get_next()\n\n    with tf.Session() as s:\n        for i in range(30):\n            im = s.run(next_element)\n            for j in range(25):\n                current_image = im[j]\n                pass\n\n\nAny  current_image with portrait orientation seems to be read incorrectly.\nSource code / logs\nThere are no logs that could help", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nyes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nLinux Ubuntu 14.04\r\n- **TensorFlow installed from (source or binary)**:\r\nbinary\r\n- **TensorFlow version (use command below)**:\r\nv1.4.0-rc1-11-g130a514 1.4.0\r\n- **Python version**: \r\nsys.version_info(major=3, minor=4, micro=3, releaselevel='final', serial=0)\r\n- **Bazel version (if compiling from source)**:\r\nn/a\r\n- **GCC/Compiler version (if compiling from source)**:\r\nn/a\r\n- **CUDA/cuDNN version**:\r\nCuda 8.0 \r\n- **GPU model and memory**:\r\nTitan XP 12Gb\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nI get very strange behaviour of image read function. See attached screenshot from tensorboard. This is NOT a tensorboard problem as I get images as they are from Dataset object.\r\n![kodak_messed](https://user-images.githubusercontent.com/6204851/33659749-37586c4e-da79-11e7-8977-7d8f6da31c2d.png)\r\n\r\nSource images are fine, I have attached a zip archive with source images:\r\n[Kodak.zip](https://github.com/tensorflow/tensorflow/files/1534996/Kodak.zip)\r\n\r\n```\r\nimport glob\r\nimport tensorflow as tf\r\n\r\ndef simply_read_image(image_path):\r\n    image_string = tf.read_file(image_path)\r\n    image_source = tf.image.decode_png(image_string, channels=3)\r\n    image_source = tf.image.convert_image_dtype(image_source, dtype=tf.float32)\r\n    return image_source\r\n\r\nvalidation_files = glob.glob(os.path.join(validation_folder, '*.png'))\r\n\r\ndataset = tf.data.Dataset.from_tensor_slices(validation_files)\r\ndataset = dataset.map(simply_read_image).batch(len(validation_files)).repeat(30)\r\n\r\nnext_element = iterator.get_next()\r\n\r\n    with tf.Session() as s:\r\n        for i in range(30):\r\n            im = s.run(next_element)\r\n            for j in range(25):\r\n                current_image = im[j]\r\n                pass\r\n\r\n```\r\nAny ` current_image` with portrait orientation seems to be read incorrectly. \r\n### Source code / logs\r\nThere are no logs that could help"}