{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/259495293", "html_url": "https://github.com/tensorflow/tensorflow/issues/5289#issuecomment-259495293", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5289", "id": 259495293, "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTQ5NTI5Mw==", "user": {"login": "nroth1", "id": 4693141, "node_id": "MDQ6VXNlcjQ2OTMxNDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/4693141?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nroth1", "html_url": "https://github.com/nroth1", "followers_url": "https://api.github.com/users/nroth1/followers", "following_url": "https://api.github.com/users/nroth1/following{/other_user}", "gists_url": "https://api.github.com/users/nroth1/gists{/gist_id}", "starred_url": "https://api.github.com/users/nroth1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nroth1/subscriptions", "organizations_url": "https://api.github.com/users/nroth1/orgs", "repos_url": "https://api.github.com/users/nroth1/repos", "events_url": "https://api.github.com/users/nroth1/events{/privacy}", "received_events_url": "https://api.github.com/users/nroth1/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-09T18:58:40Z", "updated_at": "2016-11-09T20:35:17Z", "author_association": "NONE", "body_html": "<p>So I am still able to occasionally reproduce the freezing. This only occurs when a save operation and a session.run operation occur at roughly the same time. I see the  following backtrace (abbreviated to just show the tensorflow call where the deadlock happens), which seems to indicate that the hang is happening when tflow tries to acquire a lock in ops.py:</p>\n<p>`<br>\n***  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 717, in run  run_metadata_ptr)</p>\n<p>***  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 869, in _run  allow_operation=False)</p>\n<p>***  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2457, in as_graph_element  with self._lock:`</p>\n<p>Any idea on why we would see deadlock there? Or what else could be holding that graph lock. As before, the save op seems to successfully terminate.</p>\n<p>For what it is worth, I had a very similar version of this code running before I updated to the latest tensorflow (was all the way back on .8) , and did not observe this behavior.</p>\n<p>Thanks a bunch for the time and help!</p>", "body_text": "So I am still able to occasionally reproduce the freezing. This only occurs when a save operation and a session.run operation occur at roughly the same time. I see the  following backtrace (abbreviated to just show the tensorflow call where the deadlock happens), which seems to indicate that the hang is happening when tflow tries to acquire a lock in ops.py:\n`\n***  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 717, in run  run_metadata_ptr)\n***  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 869, in _run  allow_operation=False)\n***  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2457, in as_graph_element  with self._lock:`\nAny idea on why we would see deadlock there? Or what else could be holding that graph lock. As before, the save op seems to successfully terminate.\nFor what it is worth, I had a very similar version of this code running before I updated to the latest tensorflow (was all the way back on .8) , and did not observe this behavior.\nThanks a bunch for the time and help!", "body": "So I am still able to occasionally reproduce the freezing. This only occurs when a save operation and a session.run operation occur at roughly the same time. I see the  following backtrace (abbreviated to just show the tensorflow call where the deadlock happens), which seems to indicate that the hang is happening when tflow tries to acquire a lock in ops.py:\n\n`\n**\\*  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 717, in run  run_metadata_ptr)\n\n**\\*  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 869, in _run  allow_operation=False)\n\n**\\*  File: \"/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2457, in as_graph_element  with self._lock:`\n\nAny idea on why we would see deadlock there? Or what else could be holding that graph lock. As before, the save op seems to successfully terminate. \n\nFor what it is worth, I had a very similar version of this code running before I updated to the latest tensorflow (was all the way back on .8) , and did not observe this behavior. \n\nThanks a bunch for the time and help!\n"}