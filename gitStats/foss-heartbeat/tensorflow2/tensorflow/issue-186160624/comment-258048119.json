{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/258048119", "html_url": "https://github.com/tensorflow/tensorflow/issues/5289#issuecomment-258048119", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5289", "id": 258048119, "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODA0ODExOQ==", "user": {"login": "nroth1", "id": 4693141, "node_id": "MDQ6VXNlcjQ2OTMxNDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/4693141?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nroth1", "html_url": "https://github.com/nroth1", "followers_url": "https://api.github.com/users/nroth1/followers", "following_url": "https://api.github.com/users/nroth1/following{/other_user}", "gists_url": "https://api.github.com/users/nroth1/gists{/gist_id}", "starred_url": "https://api.github.com/users/nroth1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nroth1/subscriptions", "organizations_url": "https://api.github.com/users/nroth1/orgs", "repos_url": "https://api.github.com/users/nroth1/repos", "events_url": "https://api.github.com/users/nroth1/events{/privacy}", "received_events_url": "https://api.github.com/users/nroth1/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-03T01:40:14Z", "updated_at": "2016-11-03T02:01:15Z", "author_association": "NONE", "body_html": "<p>So, I have been able to isolate the issue to roughly when I call save on a session at the same time that I call session.run(my_op). Interestingly, it is the session.run call that hangs, not the saver. When I do so, I get the following backtrace:</p>\n<p>\"<br>\n2592 _wrap_TF_Run(<em>object</em>, <em>object</em>)  (in _pywrap_tensorflow.so) + 1301  [0x106599365]</p>\n<p>2592 tensorflow::TF_Run_wrapper(TF_Session_, TF_Buffer const_, <em>object</em>, tensorflow::gtl::InlinedVector&lt;char const_, 8&gt; const&amp;, tensorflow::gtl::InlinedVector&lt;char const*, 8&gt; const&amp;, TF_Status_, tensorflow::gtl::InlinedVector&lt;<em>object</em>, 8&gt;<em>, TF_Buffer</em>)  (in _pywrap_tensorflow.so) + 55  [0x1065b25e7]</p>\n<p>2592 tensorflow::TF_Run_wrapper_helper(TF_Session_, char const_, TF_Buffer const_, <em>object</em>, tensorflow::gtl::InlinedVector&lt;char const*, 8&gt; const&amp;, tensorflow::gtl::InlinedVector&lt;char const*, 8&gt; const&amp;, TF_Status_, tensorflow::gtl::InlinedVector&lt;<em>object</em>, 8&gt;<em>, TF_Buffer</em>)  (in _pywrap_tensorflow.so) + 4930  [0x1065b1492]</p>\n<p>2592 PyEval_RestoreThread  (in Python) + 62  [0x10577defa]<br>\n2592 PyThread_acquire_lock  (in Python) + 101  [0x1057ad790]<br>\n2592 _pthread_cond_wait  (in libsystem_pthread.dylib) + 712  [0x7fffaed7c97a]</p>\n<p>\"</p>\n<p>I also saw a system log stating:</p>\n<p>'pthread_cond_wait: Resource busy'</p>\n<p>It looks like the session run call is trying to acquire a lock? Is that expected?</p>\n<p>Is it not safe to a save a session at the same time it is evaluating some other op? I can't find this discussed explicitly in the docs. Thanks again so much for the help!</p>", "body_text": "So, I have been able to isolate the issue to roughly when I call save on a session at the same time that I call session.run(my_op). Interestingly, it is the session.run call that hangs, not the saver. When I do so, I get the following backtrace:\n\"\n2592 _wrap_TF_Run(object, object)  (in _pywrap_tensorflow.so) + 1301  [0x106599365]\n2592 tensorflow::TF_Run_wrapper(TF_Session_, TF_Buffer const_, object, tensorflow::gtl::InlinedVector<char const_, 8> const&, tensorflow::gtl::InlinedVector<char const*, 8> const&, TF_Status_, tensorflow::gtl::InlinedVector<object, 8>, TF_Buffer)  (in _pywrap_tensorflow.so) + 55  [0x1065b25e7]\n2592 tensorflow::TF_Run_wrapper_helper(TF_Session_, char const_, TF_Buffer const_, object, tensorflow::gtl::InlinedVector<char const*, 8> const&, tensorflow::gtl::InlinedVector<char const*, 8> const&, TF_Status_, tensorflow::gtl::InlinedVector<object, 8>, TF_Buffer)  (in _pywrap_tensorflow.so) + 4930  [0x1065b1492]\n2592 PyEval_RestoreThread  (in Python) + 62  [0x10577defa]\n2592 PyThread_acquire_lock  (in Python) + 101  [0x1057ad790]\n2592 _pthread_cond_wait  (in libsystem_pthread.dylib) + 712  [0x7fffaed7c97a]\n\"\nI also saw a system log stating:\n'pthread_cond_wait: Resource busy'\nIt looks like the session run call is trying to acquire a lock? Is that expected?\nIs it not safe to a save a session at the same time it is evaluating some other op? I can't find this discussed explicitly in the docs. Thanks again so much for the help!", "body": "So, I have been able to isolate the issue to roughly when I call save on a session at the same time that I call session.run(my_op). Interestingly, it is the session.run call that hangs, not the saver. When I do so, I get the following backtrace: \n\n\"\n2592 _wrap_TF_Run(_object_, _object_)  (in _pywrap_tensorflow.so) + 1301  [0x106599365]\n\n2592 tensorflow::TF_Run_wrapper(TF_Session_, TF_Buffer const_, _object_, tensorflow::gtl::InlinedVector<char const_, 8> const&, tensorflow::gtl::InlinedVector<char const*, 8> const&, TF_Status_, tensorflow::gtl::InlinedVector<_object_, 8>_, TF_Buffer_)  (in _pywrap_tensorflow.so) + 55  [0x1065b25e7]\n\n2592 tensorflow::TF_Run_wrapper_helper(TF_Session_, char const_, TF_Buffer const_, _object_, tensorflow::gtl::InlinedVector<char const*, 8> const&, tensorflow::gtl::InlinedVector<char const*, 8> const&, TF_Status_, tensorflow::gtl::InlinedVector<_object_, 8>_, TF_Buffer_)  (in _pywrap_tensorflow.so) + 4930  [0x1065b1492]\n\n2592 PyEval_RestoreThread  (in Python) + 62  [0x10577defa]\n                                                                                                                                                                                                             2592 PyThread_acquire_lock  (in Python) + 101  [0x1057ad790]\n                                                                                                                                                                                                               2592 _pthread_cond_wait  (in libsystem_pthread.dylib) + 712  [0x7fffaed7c97a]\n\n\"\n\nI also saw a system log stating: \n\n'pthread_cond_wait: Resource busy'\n\nIt looks like the session run call is trying to acquire a lock? Is that expected? \n\nIs it not safe to a save a session at the same time it is evaluating some other op? I can't find this discussed explicitly in the docs. Thanks again so much for the help!\n"}