{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8154", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8154/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8154/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8154/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8154", "id": 212332631, "node_id": "MDU6SXNzdWUyMTIzMzI2MzE=", "number": 8154, "title": "Error while tf.image.crop_and_resize ", "user": {"login": "SumithRZT", "id": 15686562, "node_id": "MDQ6VXNlcjE1Njg2NTYy", "avatar_url": "https://avatars3.githubusercontent.com/u/15686562?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SumithRZT", "html_url": "https://github.com/SumithRZT", "followers_url": "https://api.github.com/users/SumithRZT/followers", "following_url": "https://api.github.com/users/SumithRZT/following{/other_user}", "gists_url": "https://api.github.com/users/SumithRZT/gists{/gist_id}", "starred_url": "https://api.github.com/users/SumithRZT/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SumithRZT/subscriptions", "organizations_url": "https://api.github.com/users/SumithRZT/orgs", "repos_url": "https://api.github.com/users/SumithRZT/repos", "events_url": "https://api.github.com/users/SumithRZT/events{/privacy}", "received_events_url": "https://api.github.com/users/SumithRZT/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-03-07T05:12:42Z", "updated_at": "2017-03-08T05:05:00Z", "closed_at": "2017-03-07T18:53:31Z", "author_association": "NONE", "body_html": "<p>I am trying to crop and resize an image with a list of co-ordinates using tf.image.crop_and_resize()<br>\nbut am getting the following error:</p>\n<h3>TypeError: Expected binary or unicode string, got 960,</h3>\n<p>Below is the code which I am using</p>\n<div class=\"highlight highlight-source-python\"><pre>ori_image <span class=\"pl-k\">=</span> Image.open(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/home/sumith/imagepyramids/1.jpg<span class=\"pl-pds\">'</span></span>)\nimg_data <span class=\"pl-k\">=</span> np.asarray(ori_image)\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n  sess.run(init)\n  im_string <span class=\"pl-k\">=</span> sess.run(tf.image.encode_jpeg(img_data, <span class=\"pl-v\">format</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>rgb<span class=\"pl-pds\">\"</span></span>))\n  img_data_tensor <span class=\"pl-k\">=</span> [im_string, img_data.shape[<span class=\"pl-c1\">0</span>], img_data.shape[<span class=\"pl-c1\">1</span>], <span class=\"pl-c1\">3</span>]\n  cropped_list <span class=\"pl-k\">=</span> sess.run(tf.image.crop_and_resize(<span class=\"pl-v\">image</span><span class=\"pl-k\">=</span>img_data_tensor, <span class=\"pl-v\">boxes</span><span class=\"pl-k\">=</span>extracted_data,\n                                                   <span class=\"pl-v\">crop_size</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">40</span>, <span class=\"pl-c1\">36</span>], <span class=\"pl-v\">box_ind</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">20</span>]))</pre></div>\n<p>and I am getting the above said error. The complete stack trace is given below.</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home/sumith/PycharmProjects/fddb/tryouts_3.py\", line 87, in &lt;module&gt;\n    crop_size=[40, 36], box_ind=[20]))\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/ops/gen_image_ops.py\", line 151, in crop_and_resize\n    name=name)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\n    raise err\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/op_def_library.py\", line 490, in apply_op\n    preferred_dtype=default_dtype)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/tensor_util.py\", line 441, in make_tensor_proto\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/tensor_util.py\", line 441, in &lt;listcomp&gt;\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/util/compat.py\", line 65, in as_bytes\n    (bytes_or_text,))\nTypeError: Expected binary or unicode string, got 960\n</code></pre>\n<p>I am passing a string returned by tf.image.encode_jpeg still it is not working. Can I get any help ?</p>", "body_text": "I am trying to crop and resize an image with a list of co-ordinates using tf.image.crop_and_resize()\nbut am getting the following error:\nTypeError: Expected binary or unicode string, got 960,\nBelow is the code which I am using\nori_image = Image.open('/home/sumith/imagepyramids/1.jpg')\nimg_data = np.asarray(ori_image)\nwith tf.Session() as sess:\n  sess.run(init)\n  im_string = sess.run(tf.image.encode_jpeg(img_data, format=\"rgb\"))\n  img_data_tensor = [im_string, img_data.shape[0], img_data.shape[1], 3]\n  cropped_list = sess.run(tf.image.crop_and_resize(image=img_data_tensor, boxes=extracted_data,\n                                                   crop_size=[40, 36], box_ind=[20]))\nand I am getting the above said error. The complete stack trace is given below.\nTraceback (most recent call last):\n  File \"/home/sumith/PycharmProjects/fddb/tryouts_3.py\", line 87, in <module>\n    crop_size=[40, 36], box_ind=[20]))\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/ops/gen_image_ops.py\", line 151, in crop_and_resize\n    name=name)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\n    raise err\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/op_def_library.py\", line 490, in apply_op\n    preferred_dtype=default_dtype)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/tensor_util.py\", line 441, in make_tensor_proto\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/tensor_util.py\", line 441, in <listcomp>\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/util/compat.py\", line 65, in as_bytes\n    (bytes_or_text,))\nTypeError: Expected binary or unicode string, got 960\n\nI am passing a string returned by tf.image.encode_jpeg still it is not working. Can I get any help ?", "body": "I am trying to crop and resize an image with a list of co-ordinates using tf.image.crop_and_resize() \r\nbut am getting the following error:\r\n### TypeError: Expected binary or unicode string, got 960, \r\nBelow is the code which I am using\r\n\r\n```python\r\nori_image = Image.open('/home/sumith/imagepyramids/1.jpg')\r\nimg_data = np.asarray(ori_image)\r\nwith tf.Session() as sess:\r\n  sess.run(init)\r\n  im_string = sess.run(tf.image.encode_jpeg(img_data, format=\"rgb\"))\r\n  img_data_tensor = [im_string, img_data.shape[0], img_data.shape[1], 3]\r\n  cropped_list = sess.run(tf.image.crop_and_resize(image=img_data_tensor, boxes=extracted_data,\r\n                                                   crop_size=[40, 36], box_ind=[20]))\r\n```\r\n\r\nand I am getting the above said error. The complete stack trace is given below.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/sumith/PycharmProjects/fddb/tryouts_3.py\", line 87, in <module>\r\n    crop_size=[40, 36], box_ind=[20]))\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/ops/gen_image_ops.py\", line 151, in crop_and_resize\r\n    name=name)\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/op_def_library.py\", line 493, in apply_op\r\n    raise err\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/op_def_library.py\", line 490, in apply_op\r\n    preferred_dtype=default_dtype)\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\r\n    return constant(v, dtype=dtype, name=name)\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\r\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/tensor_util.py\", line 441, in make_tensor_proto\r\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/framework/tensor_util.py\", line 441, in <listcomp>\r\n    tensor_proto.string_val.extend([compat.as_bytes(x) for x in proto_values])\r\n  File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/util/compat.py\", line 65, in as_bytes\r\n    (bytes_or_text,))\r\nTypeError: Expected binary or unicode string, got 960\r\n```\r\n\r\nI am passing a string returned by tf.image.encode_jpeg still it is not working. Can I get any help ? "}