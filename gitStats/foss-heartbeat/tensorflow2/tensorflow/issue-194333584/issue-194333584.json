{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6190", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6190/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6190/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6190/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6190", "id": 194333584, "node_id": "MDU6SXNzdWUxOTQzMzM1ODQ=", "number": 6190, "title": "Hanging when Matching Filenames in 0.12", "user": {"login": "fab-jul", "id": 3440923, "node_id": "MDQ6VXNlcjM0NDA5MjM=", "avatar_url": "https://avatars0.githubusercontent.com/u/3440923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fab-jul", "html_url": "https://github.com/fab-jul", "followers_url": "https://api.github.com/users/fab-jul/followers", "following_url": "https://api.github.com/users/fab-jul/following{/other_user}", "gists_url": "https://api.github.com/users/fab-jul/gists{/gist_id}", "starred_url": "https://api.github.com/users/fab-jul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fab-jul/subscriptions", "organizations_url": "https://api.github.com/users/fab-jul/orgs", "repos_url": "https://api.github.com/users/fab-jul/repos", "events_url": "https://api.github.com/users/fab-jul/events{/privacy}", "received_events_url": "https://api.github.com/users/fab-jul/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-12-08T13:18:30Z", "updated_at": "2016-12-08T13:59:55Z", "closed_at": "2016-12-08T13:59:55Z", "author_association": "NONE", "body_html": "<p>I have a network which uses <code>tf.train.shuffle_batch</code> with a <code>tf.train.string_input_produces</code>. The network worked in 0.11, but hangs in 0.12.</p>\n<p>Disclaimer: I don't have access to 0.11 anymore and I changed some other stuff, but I'm fairly sure that the important bit is still the same.</p>\n<p>Hanging means: I don't get further than the \"Creating TensorFlow device\" message.</p>\n<p>The reason I'm thinking it's due to the queue is because after enabling the <code>log_device_placement</code> flag, the last output I'm seeing is</p>\n<pre><code>I tensorflow/core/common_runtime/simple_placer.cc:827] \n    matching_filenames/MatchingFiles/pattern\n</code></pre>\n<p>Also, using a barebowns graph like</p>\n<pre><code>a = tf.constant(4)\nb = tf.constant(2)\ns = tf.Session()\ns.run(a + b)\n</code></pre>\n<p>works, so I don't think it is due to my TensorFlow installation.</p>\n<p>The hang is reproducible for me. I don't know how to enable further logging but would be glad to do so.</p>\n<hr>\n<p>The code to create the queue is as follows, basically it's the same as <a href=\"https://www.tensorflow.org/versions/r0.12/how_tos/reading_data/index.html\" rel=\"nofollow\">in the tutorial</a></p>\n<pre><code>filenames = tf.train.match_filenames_once(filenames_glob)\nfilename_queue = tf.train.string_input_producer(\n    filenames, num_epochs=num_epochs, shuffle=shuffle)\nimage = _read_pngs(filename_queue)\n\nmin_after_dequeue = 100\ncapacity = min_after_dequeue + 1 * batch_size\n\nreturn tf.train.shuffle_batch(\n    [image],\n    batch_size=batch_size, capacity=capacity,\n    min_after_dequeue=min_after_dequeue,\n    seed=666, name=name)\n</code></pre>", "body_text": "I have a network which uses tf.train.shuffle_batch with a tf.train.string_input_produces. The network worked in 0.11, but hangs in 0.12.\nDisclaimer: I don't have access to 0.11 anymore and I changed some other stuff, but I'm fairly sure that the important bit is still the same.\nHanging means: I don't get further than the \"Creating TensorFlow device\" message.\nThe reason I'm thinking it's due to the queue is because after enabling the log_device_placement flag, the last output I'm seeing is\nI tensorflow/core/common_runtime/simple_placer.cc:827] \n    matching_filenames/MatchingFiles/pattern\n\nAlso, using a barebowns graph like\na = tf.constant(4)\nb = tf.constant(2)\ns = tf.Session()\ns.run(a + b)\n\nworks, so I don't think it is due to my TensorFlow installation.\nThe hang is reproducible for me. I don't know how to enable further logging but would be glad to do so.\n\nThe code to create the queue is as follows, basically it's the same as in the tutorial\nfilenames = tf.train.match_filenames_once(filenames_glob)\nfilename_queue = tf.train.string_input_producer(\n    filenames, num_epochs=num_epochs, shuffle=shuffle)\nimage = _read_pngs(filename_queue)\n\nmin_after_dequeue = 100\ncapacity = min_after_dequeue + 1 * batch_size\n\nreturn tf.train.shuffle_batch(\n    [image],\n    batch_size=batch_size, capacity=capacity,\n    min_after_dequeue=min_after_dequeue,\n    seed=666, name=name)", "body": "I have a network which uses `tf.train.shuffle_batch` with a `tf.train.string_input_produces`. The network worked in 0.11, but hangs in 0.12. \r\n\r\nDisclaimer: I don't have access to 0.11 anymore and I changed some other stuff, but I'm fairly sure that the important bit is still the same.\r\n\r\nHanging means: I don't get further than the \"Creating TensorFlow device\" message.\r\n\r\nThe reason I'm thinking it's due to the queue is because after enabling the `log_device_placement` flag, the last output I'm seeing is\r\n\r\n    I tensorflow/core/common_runtime/simple_placer.cc:827] \r\n        matching_filenames/MatchingFiles/pattern\r\n\r\nAlso, using a barebowns graph like\r\n\r\n```\r\na = tf.constant(4)\r\nb = tf.constant(2)\r\ns = tf.Session()\r\ns.run(a + b)\r\n```\r\n\r\nworks, so I don't think it is due to my TensorFlow installation.\r\n\r\nThe hang is reproducible for me. I don't know how to enable further logging but would be glad to do so.\r\n\r\n---\r\n\r\nThe code to create the queue is as follows, basically it's the same as [in the tutorial](https://www.tensorflow.org/versions/r0.12/how_tos/reading_data/index.html)\r\n\r\n```\r\nfilenames = tf.train.match_filenames_once(filenames_glob)\r\nfilename_queue = tf.train.string_input_producer(\r\n    filenames, num_epochs=num_epochs, shuffle=shuffle)\r\nimage = _read_pngs(filename_queue)\r\n\r\nmin_after_dequeue = 100\r\ncapacity = min_after_dequeue + 1 * batch_size\r\n\r\nreturn tf.train.shuffle_batch(\r\n    [image],\r\n    batch_size=batch_size, capacity=capacity,\r\n    min_after_dequeue=min_after_dequeue,\r\n    seed=666, name=name)\r\n```"}