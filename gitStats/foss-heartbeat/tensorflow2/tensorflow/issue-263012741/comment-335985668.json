{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/335985668", "html_url": "https://github.com/tensorflow/tensorflow/issues/13500#issuecomment-335985668", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13500", "id": 335985668, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTk4NTY2OA==", "user": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-12T00:27:03Z", "updated_at": "2017-10-12T00:27:03Z", "author_association": "MEMBER", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=12166108\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/MartinZZZ\">@MartinZZZ</a> This is slightly confusing.</p>\n<p>Note that the info log <code>Your CPU supports...</code> is actually coming from the invocation of the <code>tfcompile</code> tool, which generates the header and object file, and is a side-effect of how we perform the compilation re-using underlying TensorFlow infrastructure.  It's not actually trying to warn you that the generated code is missing support for SIMD.</p>\n<p>The reason I know this is because the first part of the info log says:</p>\n<pre><code>From Executing genrule //tensorflow/compiler/aot/tests:gen_test_graph_tfmatmul\n</code></pre>\n<p>The genrule above corresponds to this bazel genrule, which is created by the tf_library build macro:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/263d025fb6dee974eefb30a51372188fb856d6cc/tensorflow/compiler/aot/tfcompile.bzl#L134\">tensorflow/tensorflow/compiler/aot/tfcompile.bzl</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 134\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/263d025fb6dee974eefb30a51372188fb856d6cc\">263d025</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L134\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"134\"></td>\n          <td id=\"LC134\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>gen_<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> name), </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p>I'm suspecting that you saw this info log in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"262658135\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/13482\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/13482/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/13482\">#13482</a> because you were running <code>tfcompile</code> manually; if instead you let blaze run it, via the <code>tf_library</code> macro, these info logs won't be visible.</p>\n<p>That said, note that by default tfcompile doesn't assume any target-specific features (SIMD, etc).  If there are specific features you'd like to enable, you need to set them via the following tfcompile flags:</p>\n<pre><code>\t--target_cpu=\"\"                  \tstring\tTarget cpu, similar to the clang -mcpu flag.  http://clang.llvm.org/docs/CrossCompilation.html#cpu-fpu-abi\n\t--target_features=\"\"             \tstring\tTarget features, e.g. +avx2, +neon, etc.\n</code></pre>\n<p>These may be specified in your <code>tf_library</code> build rule using the <code>tfcompile_flags</code> argument:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/263d025fb6dee974eefb30a51372188fb856d6cc/tensorflow/compiler/aot/tfcompile.bzl#L25\">tensorflow/tensorflow/compiler/aot/tfcompile.bzl</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 25\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/263d025fb6dee974eefb30a51372188fb856d6cc\">263d025</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L25\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"25\"></td>\n          <td id=\"LC25\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-smi\">tfcompile_flags</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>, </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>", "body_text": "@MartinZZZ This is slightly confusing.\nNote that the info log Your CPU supports... is actually coming from the invocation of the tfcompile tool, which generates the header and object file, and is a side-effect of how we perform the compilation re-using underlying TensorFlow infrastructure.  It's not actually trying to warn you that the generated code is missing support for SIMD.\nThe reason I know this is because the first part of the info log says:\nFrom Executing genrule //tensorflow/compiler/aot/tests:gen_test_graph_tfmatmul\n\nThe genrule above corresponds to this bazel genrule, which is created by the tf_library build macro:\n\n  \n    \n      tensorflow/tensorflow/compiler/aot/tfcompile.bzl\n    \n    \n         Line 134\n      in\n      263d025\n    \n    \n    \n    \n\n        \n          \n           name=(\"gen_\" + name), \n        \n    \n  \n\n\nI'm suspecting that you saw this info log in #13482 because you were running tfcompile manually; if instead you let blaze run it, via the tf_library macro, these info logs won't be visible.\nThat said, note that by default tfcompile doesn't assume any target-specific features (SIMD, etc).  If there are specific features you'd like to enable, you need to set them via the following tfcompile flags:\n\t--target_cpu=\"\"                  \tstring\tTarget cpu, similar to the clang -mcpu flag.  http://clang.llvm.org/docs/CrossCompilation.html#cpu-fpu-abi\n\t--target_features=\"\"             \tstring\tTarget features, e.g. +avx2, +neon, etc.\n\nThese may be specified in your tf_library build rule using the tfcompile_flags argument:\n\n  \n    \n      tensorflow/tensorflow/compiler/aot/tfcompile.bzl\n    \n    \n         Line 25\n      in\n      263d025\n    \n    \n    \n    \n\n        \n          \n           tfcompile_flags=None,", "body": "@MartinZZZ This is slightly confusing.\r\n\r\nNote that the info log `Your CPU supports...` is actually coming from the invocation of the `tfcompile` tool, which generates the header and object file, and is a side-effect of how we perform the compilation re-using underlying TensorFlow infrastructure.  It's not actually trying to warn you that the generated code is missing support for SIMD.\r\n\r\nThe reason I know this is because the first part of the info log says:\r\n```\r\nFrom Executing genrule //tensorflow/compiler/aot/tests:gen_test_graph_tfmatmul\r\n```\r\n\r\nThe genrule above corresponds to this bazel genrule, which is created by the tf_library build macro:\r\nhttps://github.com/tensorflow/tensorflow/blob/263d025fb6dee974eefb30a51372188fb856d6cc/tensorflow/compiler/aot/tfcompile.bzl#L134\r\n\r\nI'm suspecting that you saw this info log in #13482 because you were running `tfcompile` manually; if instead you let blaze run it, via the `tf_library` macro, these info logs won't be visible.\r\n\r\nThat said, note that by default tfcompile doesn't assume any target-specific features (SIMD, etc).  If there are specific features you'd like to enable, you need to set them via the following tfcompile flags:\r\n```\r\n\t--target_cpu=\"\"                  \tstring\tTarget cpu, similar to the clang -mcpu flag.  http://clang.llvm.org/docs/CrossCompilation.html#cpu-fpu-abi\r\n\t--target_features=\"\"             \tstring\tTarget features, e.g. +avx2, +neon, etc.\r\n```\r\n\r\nThese may be specified in your `tf_library` build rule using the `tfcompile_flags` argument:\r\nhttps://github.com/tensorflow/tensorflow/blob/263d025fb6dee974eefb30a51372188fb856d6cc/tensorflow/compiler/aot/tfcompile.bzl#L25"}