{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2619", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2619/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2619/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2619/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2619", "id": 158080702, "node_id": "MDU6SXNzdWUxNTgwODA3MDI=", "number": 2619, "title": "tf.image.decode_png returns wrong values for uint16 images", "user": {"login": "beopst", "id": 10264378, "node_id": "MDQ6VXNlcjEwMjY0Mzc4", "avatar_url": "https://avatars2.githubusercontent.com/u/10264378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/beopst", "html_url": "https://github.com/beopst", "followers_url": "https://api.github.com/users/beopst/followers", "following_url": "https://api.github.com/users/beopst/following{/other_user}", "gists_url": "https://api.github.com/users/beopst/gists{/gist_id}", "starred_url": "https://api.github.com/users/beopst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/beopst/subscriptions", "organizations_url": "https://api.github.com/users/beopst/orgs", "repos_url": "https://api.github.com/users/beopst/repos", "events_url": "https://api.github.com/users/beopst/events{/privacy}", "received_events_url": "https://api.github.com/users/beopst/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "dave-andersen", "id": 827870, "node_id": "MDQ6VXNlcjgyNzg3MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/827870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dave-andersen", "html_url": "https://github.com/dave-andersen", "followers_url": "https://api.github.com/users/dave-andersen/followers", "following_url": "https://api.github.com/users/dave-andersen/following{/other_user}", "gists_url": "https://api.github.com/users/dave-andersen/gists{/gist_id}", "starred_url": "https://api.github.com/users/dave-andersen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dave-andersen/subscriptions", "organizations_url": "https://api.github.com/users/dave-andersen/orgs", "repos_url": "https://api.github.com/users/dave-andersen/repos", "events_url": "https://api.github.com/users/dave-andersen/events{/privacy}", "received_events_url": "https://api.github.com/users/dave-andersen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dave-andersen", "id": 827870, "node_id": "MDQ6VXNlcjgyNzg3MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/827870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dave-andersen", "html_url": "https://github.com/dave-andersen", "followers_url": "https://api.github.com/users/dave-andersen/followers", "following_url": "https://api.github.com/users/dave-andersen/following{/other_user}", "gists_url": "https://api.github.com/users/dave-andersen/gists{/gist_id}", "starred_url": "https://api.github.com/users/dave-andersen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dave-andersen/subscriptions", "organizations_url": "https://api.github.com/users/dave-andersen/orgs", "repos_url": "https://api.github.com/users/dave-andersen/repos", "events_url": "https://api.github.com/users/dave-andersen/events{/privacy}", "received_events_url": "https://api.github.com/users/dave-andersen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2016-06-02T07:59:37Z", "updated_at": "2017-02-09T22:02:15Z", "closed_at": "2016-06-15T05:52:24Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>Environment info</h3>\n<p>Operating System: Ubuntu 14.04</p>\n<p>Installed version of CUDA and cuDNN: CUDA 7.5, cuDNN R4</p>\n<p>If installed from sources, provide the commit hash: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/d8eb4bb6470d4cb3d0f67f2111a39fa50f1c28e5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/d8eb4bb6470d4cb3d0f67f2111a39fa50f1c28e5\"><tt>d8eb4bb</tt></a></p>\n<h3>Steps to reproduce</h3>\n<p>Please see the below code. After saving numpy array as uint16 png image, I loaded it using tf.image.decode_png. It returns different values from the original array.</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">from</span> skimage <span class=\"pl-k\">import</span> io\n\noriginal <span class=\"pl-k\">=</span> np.array([[<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">4096</span>],[<span class=\"pl-c1\">15000</span>,<span class=\"pl-c1\">30000</span>]],<span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>np.uint16)\nio.imsave(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>test.png<span class=\"pl-pds\">'</span></span>,original)\n\nsk_im <span class=\"pl-k\">=</span> io.imread(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>test.png<span class=\"pl-pds\">'</span></span>)\n\nimage <span class=\"pl-k\">=</span> tf.image.decode_png(tf.read_file(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>test.png<span class=\"pl-pds\">'</span></span>),<span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.uint16)\nsess <span class=\"pl-k\">=</span> tf.Session()\ntf_im <span class=\"pl-k\">=</span> sess.run(image)\n\n<span class=\"pl-c1\">print</span> sk_im\n<span class=\"pl-c1\">print</span> tf_im</pre></div>\n<p>Results are</p>\n<pre><code>sk_im = [[1, 4096], [15000, 30000]] #same as original\ntf_im[:,:,0] = [[256, 16], [38970, 12405]]\n</code></pre>\n<p>I checked the function works properly in case of uint8 png image.</p>", "body_text": "Environment info\nOperating System: Ubuntu 14.04\nInstalled version of CUDA and cuDNN: CUDA 7.5, cuDNN R4\nIf installed from sources, provide the commit hash: d8eb4bb\nSteps to reproduce\nPlease see the below code. After saving numpy array as uint16 png image, I loaded it using tf.image.decode_png. It returns different values from the original array.\nimport numpy as np\nimport tensorflow as tf\nfrom skimage import io\n\noriginal = np.array([[1,4096],[15000,30000]],dtype=np.uint16)\nio.imsave('test.png',original)\n\nsk_im = io.imread('test.png')\n\nimage = tf.image.decode_png(tf.read_file('test.png'),dtype=tf.uint16)\nsess = tf.Session()\ntf_im = sess.run(image)\n\nprint sk_im\nprint tf_im\nResults are\nsk_im = [[1, 4096], [15000, 30000]] #same as original\ntf_im[:,:,0] = [[256, 16], [38970, 12405]]\n\nI checked the function works properly in case of uint8 png image.", "body": "### Environment info\n\nOperating System: Ubuntu 14.04\n\nInstalled version of CUDA and cuDNN: CUDA 7.5, cuDNN R4\n\nIf installed from sources, provide the commit hash: d8eb4bb6470d4cb3d0f67f2111a39fa50f1c28e5\n### Steps to reproduce\n\nPlease see the below code. After saving numpy array as uint16 png image, I loaded it using tf.image.decode_png. It returns different values from the original array. \n\n``` python\nimport numpy as np\nimport tensorflow as tf\nfrom skimage import io\n\noriginal = np.array([[1,4096],[15000,30000]],dtype=np.uint16)\nio.imsave('test.png',original)\n\nsk_im = io.imread('test.png')\n\nimage = tf.image.decode_png(tf.read_file('test.png'),dtype=tf.uint16)\nsess = tf.Session()\ntf_im = sess.run(image)\n\nprint sk_im\nprint tf_im\n```\n\nResults are\n\n```\nsk_im = [[1, 4096], [15000, 30000]] #same as original\ntf_im[:,:,0] = [[256, 16], [38970, 12405]]\n```\n\nI checked the function works properly in case of uint8 png image.\n"}