{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/352953251", "html_url": "https://github.com/tensorflow/tensorflow/issues/13351#issuecomment-352953251", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13351", "id": 352953251, "node_id": "MDEyOklzc3VlQ29tbWVudDM1Mjk1MzI1MQ==", "user": {"login": "yaroslavvb", "id": 23068, "node_id": "MDQ6VXNlcjIzMDY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaroslavvb", "html_url": "https://github.com/yaroslavvb", "followers_url": "https://api.github.com/users/yaroslavvb/followers", "following_url": "https://api.github.com/users/yaroslavvb/following{/other_user}", "gists_url": "https://api.github.com/users/yaroslavvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaroslavvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaroslavvb/subscriptions", "organizations_url": "https://api.github.com/users/yaroslavvb/orgs", "repos_url": "https://api.github.com/users/yaroslavvb/repos", "events_url": "https://api.github.com/users/yaroslavvb/events{/privacy}", "received_events_url": "https://api.github.com/users/yaroslavvb/received_events", "type": "User", "site_admin": false}, "created_at": "2017-12-20T03:15:20Z", "updated_at": "2017-12-20T03:15:20Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Just tested with tf nightly and it's still broken. I believe this bug is also responsible for deadlock during data-dependent init in tim's models.</p>\n<p>To reproduce:</p>\n<pre><code>pip install tf-nightly\nwget https://raw.githubusercontent.com/yaroslavvb/stuff/2c716e7abde25018ccfeeeff96c6397fef4f33ba/tf_initializer_bug_report.py\n\npython tf_initializer_bug_report.py\n...\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'Wf_holder' with dtype float and shape [307328]\n\t [[Node: Wf_holder = Placeholder[dtype=DT_FLOAT, shape=[307328], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\n\n</code></pre>\n<p>If you comment out the top block, which essentially reverts <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/07adc2ea910de715d31e16a019fcbcccb575e931/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/07adc2ea910de715d31e16a019fcbcccb575e931\"><tt>07adc2e</tt></a> then things work again and you see following output</p>\n<pre><code>Running training.\nStep 0 loss 35.58, target decrease -7.771, actual decrease, -4.621 ratio 0.59 grad norm: 22.97 pregrad norm: 77563.16\nStep 3 loss 25.41, target decrease -0.841, actual decrease, -0.740 ratio 0.88 grad norm: 1.72 pregrad norm: 1541.23\nStep 6 loss 23.99, target decrease -0.204, actual decrease, -0.189 ratio 0.93 grad norm: 0.43 pregrad norm: 295.30\n\n</code></pre>", "body_text": "Just tested with tf nightly and it's still broken. I believe this bug is also responsible for deadlock during data-dependent init in tim's models.\nTo reproduce:\npip install tf-nightly\nwget https://raw.githubusercontent.com/yaroslavvb/stuff/2c716e7abde25018ccfeeeff96c6397fef4f33ba/tf_initializer_bug_report.py\n\npython tf_initializer_bug_report.py\n...\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'Wf_holder' with dtype float and shape [307328]\n\t [[Node: Wf_holder = Placeholder[dtype=DT_FLOAT, shape=[307328], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\n\n\nIf you comment out the top block, which essentially reverts 07adc2e then things work again and you see following output\nRunning training.\nStep 0 loss 35.58, target decrease -7.771, actual decrease, -4.621 ratio 0.59 grad norm: 22.97 pregrad norm: 77563.16\nStep 3 loss 25.41, target decrease -0.841, actual decrease, -0.740 ratio 0.88 grad norm: 1.72 pregrad norm: 1541.23\nStep 6 loss 23.99, target decrease -0.204, actual decrease, -0.189 ratio 0.93 grad norm: 0.43 pregrad norm: 295.30", "body": "Just tested with tf nightly and it's still broken. I believe this bug is also responsible for deadlock during data-dependent init in tim's models.\r\n\r\nTo reproduce:\r\n```\r\npip install tf-nightly\r\nwget https://raw.githubusercontent.com/yaroslavvb/stuff/2c716e7abde25018ccfeeeff96c6397fef4f33ba/tf_initializer_bug_report.py\r\n\r\npython tf_initializer_bug_report.py\r\n...\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'Wf_holder' with dtype float and shape [307328]\r\n\t [[Node: Wf_holder = Placeholder[dtype=DT_FLOAT, shape=[307328], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\n```\r\n\r\nIf you comment out the top block, which essentially reverts https://github.com/tensorflow/tensorflow/commit/07adc2ea910de715d31e16a019fcbcccb575e931 then things work again and you see following output\r\n\r\n```\r\nRunning training.\r\nStep 0 loss 35.58, target decrease -7.771, actual decrease, -4.621 ratio 0.59 grad norm: 22.97 pregrad norm: 77563.16\r\nStep 3 loss 25.41, target decrease -0.841, actual decrease, -0.740 ratio 0.88 grad norm: 1.72 pregrad norm: 1541.23\r\nStep 6 loss 23.99, target decrease -0.204, actual decrease, -0.189 ratio 0.93 grad norm: 0.43 pregrad norm: 295.30\r\n\r\n```\r\n"}