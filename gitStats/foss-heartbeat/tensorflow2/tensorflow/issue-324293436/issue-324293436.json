{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19372", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19372/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19372/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19372/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19372", "id": 324293436, "node_id": "MDU6SXNzdWUzMjQyOTM0MzY=", "number": 19372, "title": "Can not allocate memory for the interpreter in Tensorflow_lite. When i initialize the Interpreter Object in android.", "user": {"login": "1icas", "id": 20149552, "node_id": "MDQ6VXNlcjIwMTQ5NTUy", "avatar_url": "https://avatars2.githubusercontent.com/u/20149552?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1icas", "html_url": "https://github.com/1icas", "followers_url": "https://api.github.com/users/1icas/followers", "following_url": "https://api.github.com/users/1icas/following{/other_user}", "gists_url": "https://api.github.com/users/1icas/gists{/gist_id}", "starred_url": "https://api.github.com/users/1icas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1icas/subscriptions", "organizations_url": "https://api.github.com/users/1icas/orgs", "repos_url": "https://api.github.com/users/1icas/repos", "events_url": "https://api.github.com/users/1icas/events{/privacy}", "received_events_url": "https://api.github.com/users/1icas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-05-18T07:03:40Z", "updated_at": "2018-08-09T03:19:31Z", "closed_at": "2018-08-04T00:28:08Z", "author_association": "NONE", "body_html": "<hr>\n<h3>System information</h3>\n<p>TensorFlow version :1.8.0</p>\n<h3>Describe the problem</h3>\n<p>Purpose:Convert a custom model to a quantize tensorflow lite model.</p>\n<p><a href=\"https://drive.google.com/file/d/1XV1FZa0ChoJGuR8n-gxK4Ry67CVn5aVm/view?usp=sharing\" rel=\"nofollow\">This is the model structure</a><br>\nThe model structure is similar to mobilenet_v1</p>\n<p><em>Step\uff1a</em></p>\n<ol>\n<li>\n<p>Quantize Training (add tf.contrib.quantize.create_training_graph() in my code\uff09</p>\n</li>\n<li>\n<p>Generate .pb (add tf.contrib.quantize.create_eval_graph() in my code)</p>\n</li>\n<li>\n<p>Use the toco to convert my pb file to tflite. The command:<br>\nbazel-bin/tensorflow/contrib/lite/toco/toco <br>\n--input_file=/home/admin_pc/model_test/output_224_qg.pb <br>\n--output_file=/home/admin_pc/model_test/mobilenet_qg.tflite <br>\n--input_fromat=TENSORFLOW_GRAPHDEF <br>\n--output_format=TFLITE <br>\n--inference_type=QUANTIZED_UINT8 <br>\n--input_array=image <br>\n--output_array=Openpose/concat_stage7 <br>\n--input_shape=1,224,224,3 <br>\n--std_value=128 --mean_value=128</p>\n<p>It was succeed. But some warning occured,just like this:<br>\ntensorflow/contrib/lite/toco/graph_transformations/hardcode_min_max.cc:120] Tweaking the MinMax of the output array of {Concatenation operator with output Openpose/MConv_Stage2_concat}, because we want all inputs and outputs of a Concatenation operator to have the same MinMax so that it can be implemented as a pure byte-copy, no arithmetic.<br>\ntensorflow/contrib/lite/toco/graph_transformations/hardcode_min_max.cc:105] Tweaking the MinMax of array Conv2d_3_pool, which is an input to {Concatenation operator with output feat_concat}, because we want all inputs and outputs of a Concatenation operator to have the same MinMax so that it can be implemented as a pure byte-copy, no arithmetic.</p>\n</li>\n<li>\n<p>I add the quantize tflite to my android project. And run,some error occured when i init the Interpreter.<br>\njava.lang.NullPointerException: Can not allocate memory for the interpreter</p>\n</li>\n</ol>\n<p>I don't know it's a bug or my fault.</p>", "body_text": "System information\nTensorFlow version :1.8.0\nDescribe the problem\nPurpose:Convert a custom model to a quantize tensorflow lite model.\nThis is the model structure\nThe model structure is similar to mobilenet_v1\nStep\uff1a\n\n\nQuantize Training (add tf.contrib.quantize.create_training_graph() in my code\uff09\n\n\nGenerate .pb (add tf.contrib.quantize.create_eval_graph() in my code)\n\n\nUse the toco to convert my pb file to tflite. The command:\nbazel-bin/tensorflow/contrib/lite/toco/toco \n--input_file=/home/admin_pc/model_test/output_224_qg.pb \n--output_file=/home/admin_pc/model_test/mobilenet_qg.tflite \n--input_fromat=TENSORFLOW_GRAPHDEF \n--output_format=TFLITE \n--inference_type=QUANTIZED_UINT8 \n--input_array=image \n--output_array=Openpose/concat_stage7 \n--input_shape=1,224,224,3 \n--std_value=128 --mean_value=128\nIt was succeed. But some warning occured,just like this:\ntensorflow/contrib/lite/toco/graph_transformations/hardcode_min_max.cc:120] Tweaking the MinMax of the output array of {Concatenation operator with output Openpose/MConv_Stage2_concat}, because we want all inputs and outputs of a Concatenation operator to have the same MinMax so that it can be implemented as a pure byte-copy, no arithmetic.\ntensorflow/contrib/lite/toco/graph_transformations/hardcode_min_max.cc:105] Tweaking the MinMax of array Conv2d_3_pool, which is an input to {Concatenation operator with output feat_concat}, because we want all inputs and outputs of a Concatenation operator to have the same MinMax so that it can be implemented as a pure byte-copy, no arithmetic.\n\n\nI add the quantize tflite to my android project. And run,some error occured when i init the Interpreter.\njava.lang.NullPointerException: Can not allocate memory for the interpreter\n\n\nI don't know it's a bug or my fault.", "body": "\r\n------------------------\r\n\r\n### System information\r\nTensorFlow version :1.8.0\r\n\r\n### Describe the problem\r\nPurpose:Convert a custom model to a quantize tensorflow lite model.\r\n\r\n[This is the model structure](https://drive.google.com/file/d/1XV1FZa0ChoJGuR8n-gxK4Ry67CVn5aVm/view?usp=sharing)\r\nThe model structure is similar to mobilenet_v1\r\n\r\n_Step\uff1a_\r\n1. Quantize Training (add tf.contrib.quantize.create_training_graph() in my code\uff09\r\n\r\n2. Generate .pb (add tf.contrib.quantize.create_eval_graph() in my code)\r\n\r\n3. Use the toco to convert my pb file to tflite. The command:\r\nbazel-bin/tensorflow/contrib/lite/toco/toco \\\r\n--input_file=/home/admin_pc/model_test/output_224_qg.pb \\\r\n--output_file=/home/admin_pc/model_test/mobilenet_qg.tflite \\\r\n--input_fromat=TENSORFLOW_GRAPHDEF \\\r\n--output_format=TFLITE \\\r\n--inference_type=QUANTIZED_UINT8 \\\r\n--input_array=image \\\r\n--output_array=Openpose/concat_stage7 \\\r\n--input_shape=1,224,224,3 \\\r\n--std_value=128 --mean_value=128 \r\n\r\n    It was succeed. But some warning occured,just like this:\r\n    tensorflow/contrib/lite/toco/graph_transformations/hardcode_min_max.cc:120] Tweaking the MinMax of the output array of {Concatenation operator with output Openpose/MConv_Stage2_concat}, because we want all inputs and outputs of a Concatenation operator to have the same MinMax so that it can be implemented as a pure byte-copy, no arithmetic.\r\n    tensorflow/contrib/lite/toco/graph_transformations/hardcode_min_max.cc:105] Tweaking the MinMax of array Conv2d_3_pool, which is an input to {Concatenation operator with output feat_concat}, because we want all inputs and outputs of a Concatenation operator to have the same MinMax so that it can be implemented as a pure byte-copy, no arithmetic.\r\n\r\n4. I add the quantize tflite to my android project. And run,some error occured when i init the Interpreter.\r\njava.lang.NullPointerException: Can not allocate memory for the interpreter\r\n\r\nI don't know it's a bug or my fault.\r\n"}