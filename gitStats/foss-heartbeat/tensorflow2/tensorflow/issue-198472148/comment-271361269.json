{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/271361269", "html_url": "https://github.com/tensorflow/tensorflow/pull/6615#issuecomment-271361269", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6615", "id": 271361269, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTM2MTI2OQ==", "user": {"login": "vrv", "id": 463737, "node_id": "MDQ6VXNlcjQ2MzczNw==", "avatar_url": "https://avatars0.githubusercontent.com/u/463737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vrv", "html_url": "https://github.com/vrv", "followers_url": "https://api.github.com/users/vrv/followers", "following_url": "https://api.github.com/users/vrv/following{/other_user}", "gists_url": "https://api.github.com/users/vrv/gists{/gist_id}", "starred_url": "https://api.github.com/users/vrv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vrv/subscriptions", "organizations_url": "https://api.github.com/users/vrv/orgs", "repos_url": "https://api.github.com/users/vrv/repos", "events_url": "https://api.github.com/users/vrv/events{/privacy}", "received_events_url": "https://api.github.com/users/vrv/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-09T18:17:32Z", "updated_at": "2017-01-09T18:17:32Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Okay, about to submit a fix and some more tests -- should be available later today if our pushing process goes well.</p>\n<p>Basically, CanAssignToDevice was only checking that the device type was valid, not that the device was in the list generated by the placer (which uses the user's device spec).  The change I am submitting, makes CanAssignToDevice check that the consumer's device is in the list of the potential devices.</p>\n<p>The reason timeline_test failed is that the consumer was on /cpu:1, the producer was on /cpu:2 (explicit), and because the device types were the same, it moved producer to /cpu:1, which causes the test to fail.  With this change, the producer will always remain on /cpu:2.</p>\n<p>Lastly, the check for assigned_devices / continuing could be removed without breaking any test, but is an optimization (there is no need to do more work to check for metadata / generators when you know the device has been assigned already), so I just added a comment to make it more clear.</p>\n<p>After it gets pushed, we can merge this PR and things should get better.</p>", "body_text": "Okay, about to submit a fix and some more tests -- should be available later today if our pushing process goes well.\nBasically, CanAssignToDevice was only checking that the device type was valid, not that the device was in the list generated by the placer (which uses the user's device spec).  The change I am submitting, makes CanAssignToDevice check that the consumer's device is in the list of the potential devices.\nThe reason timeline_test failed is that the consumer was on /cpu:1, the producer was on /cpu:2 (explicit), and because the device types were the same, it moved producer to /cpu:1, which causes the test to fail.  With this change, the producer will always remain on /cpu:2.\nLastly, the check for assigned_devices / continuing could be removed without breaking any test, but is an optimization (there is no need to do more work to check for metadata / generators when you know the device has been assigned already), so I just added a comment to make it more clear.\nAfter it gets pushed, we can merge this PR and things should get better.", "body": "Okay, about to submit a fix and some more tests -- should be available later today if our pushing process goes well.\r\n\r\nBasically, CanAssignToDevice was only checking that the device type was valid, not that the device was in the list generated by the placer (which uses the user's device spec).  The change I am submitting, makes CanAssignToDevice check that the consumer's device is in the list of the potential devices.\r\n\r\nThe reason timeline_test failed is that the consumer was on /cpu:1, the producer was on /cpu:2 (explicit), and because the device types were the same, it moved producer to /cpu:1, which causes the test to fail.  With this change, the producer will always remain on /cpu:2.\r\n\r\nLastly, the check for assigned_devices / continuing could be removed without breaking any test, but is an optimization (there is no need to do more work to check for metadata / generators when you know the device has been assigned already), so I just added a comment to make it more clear.\r\n\r\nAfter it gets pushed, we can merge this PR and things should get better."}