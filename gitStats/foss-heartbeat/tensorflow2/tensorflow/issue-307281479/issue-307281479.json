{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17896", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17896/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17896/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17896/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/17896", "id": 307281479, "node_id": "MDExOlB1bGxSZXF1ZXN0MTc2NTAzOTE1", "number": 17896, "title": "Fix dataset resampling bug introduced by a bug in datasets itself. fixes #16606", "user": {"login": "joel-shor", "id": 6020988, "node_id": "MDQ6VXNlcjYwMjA5ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6020988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joel-shor", "html_url": "https://github.com/joel-shor", "followers_url": "https://api.github.com/users/joel-shor/followers", "following_url": "https://api.github.com/users/joel-shor/following{/other_user}", "gists_url": "https://api.github.com/users/joel-shor/gists{/gist_id}", "starred_url": "https://api.github.com/users/joel-shor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joel-shor/subscriptions", "organizations_url": "https://api.github.com/users/joel-shor/orgs", "repos_url": "https://api.github.com/users/joel-shor/repos", "events_url": "https://api.github.com/users/joel-shor/events{/privacy}", "received_events_url": "https://api.github.com/users/joel-shor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-21T14:59:03Z", "updated_at": "2018-03-21T22:11:34Z", "closed_at": "2018-03-21T22:11:34Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17896", "html_url": "https://github.com/tensorflow/tensorflow/pull/17896", "diff_url": "https://github.com/tensorflow/tensorflow/pull/17896.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/17896.patch"}, "body_html": "<p>Fixes github issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"292960118\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/16606\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/16606/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/16606\">#16606</a>.</p>\n<p>This is a correctly-formatted version of PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"306824261\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/17858\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/17858/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/17858\">#17858</a>.</p>\n<p>The core issue is that in the case of certain random Tensors, the<br>\nfollowing two lines aren't the same:</p>\n<pre><code>rand_0s_and_1s_ds = ...\ngather_ds = rand_0s_and_1s_ds.map(lambda i: tf.gather([0, 1], i))\ntup_ds = tf.data.Dataset.zip(gather_ds, rand_0s_and_1s_ds)\n</code></pre>\n<pre><code>rand_0s_and_1s_ds = ...\ntup_ds = rand_0s_and_1s_ds.map(lambda i: (tf.gather([0, 1], i), i))\nNote that this does NOT fix the underlying issue of drawing multiple\nsampes from the underlying distribution.\n</code></pre>\n<p>Tested:<br>\nWith the new test, bazel test :resample_test fails before and succeeds<br>\nafter.</p>", "body_text": "Fixes github issue #16606.\nThis is a correctly-formatted version of PR #17858.\nThe core issue is that in the case of certain random Tensors, the\nfollowing two lines aren't the same:\nrand_0s_and_1s_ds = ...\ngather_ds = rand_0s_and_1s_ds.map(lambda i: tf.gather([0, 1], i))\ntup_ds = tf.data.Dataset.zip(gather_ds, rand_0s_and_1s_ds)\n\nrand_0s_and_1s_ds = ...\ntup_ds = rand_0s_and_1s_ds.map(lambda i: (tf.gather([0, 1], i), i))\nNote that this does NOT fix the underlying issue of drawing multiple\nsampes from the underlying distribution.\n\nTested:\nWith the new test, bazel test :resample_test fails before and succeeds\nafter.", "body": "Fixes github issue #16606.\r\n\r\nThis is a correctly-formatted version of PR #17858.\r\n\r\nThe core issue is that in the case of certain random Tensors, the\r\nfollowing two lines aren't the same:\r\n\r\n```\r\nrand_0s_and_1s_ds = ...\r\ngather_ds = rand_0s_and_1s_ds.map(lambda i: tf.gather([0, 1], i))\r\ntup_ds = tf.data.Dataset.zip(gather_ds, rand_0s_and_1s_ds)\r\n```\r\n\r\n```\r\nrand_0s_and_1s_ds = ...\r\ntup_ds = rand_0s_and_1s_ds.map(lambda i: (tf.gather([0, 1], i), i))\r\nNote that this does NOT fix the underlying issue of drawing multiple\r\nsampes from the underlying distribution.\r\n```\r\n\r\nTested:\r\nWith the new test, bazel test :resample_test fails before and succeeds\r\nafter."}