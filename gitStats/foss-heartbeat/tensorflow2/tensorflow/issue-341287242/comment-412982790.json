{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/412982790", "html_url": "https://github.com/tensorflow/tensorflow/pull/20809#issuecomment-412982790", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20809", "id": 412982790, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMjk4Mjc5MA==", "user": {"login": "Mostafa-Alaa", "id": 6504541, "node_id": "MDQ6VXNlcjY1MDQ1NDE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6504541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mostafa-Alaa", "html_url": "https://github.com/Mostafa-Alaa", "followers_url": "https://api.github.com/users/Mostafa-Alaa/followers", "following_url": "https://api.github.com/users/Mostafa-Alaa/following{/other_user}", "gists_url": "https://api.github.com/users/Mostafa-Alaa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mostafa-Alaa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mostafa-Alaa/subscriptions", "organizations_url": "https://api.github.com/users/Mostafa-Alaa/orgs", "repos_url": "https://api.github.com/users/Mostafa-Alaa/repos", "events_url": "https://api.github.com/users/Mostafa-Alaa/events{/privacy}", "received_events_url": "https://api.github.com/users/Mostafa-Alaa/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-14T19:08:41Z", "updated_at": "2018-08-14T19:08:41Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=710255\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fchollet\">@fchollet</a> Thank you for the review.</p>\n<p>For the first part I think it might not be the best to add the type check before a cast for a couple of reasons</p>\n<ol>\n<li>It would add a lot of redundant code before each cast.</li>\n<li>Type checking using <code>x.dtype != target_dtype</code> would work if <code>x</code> is a tensor but will fail for python lists, tuples, scalars.</li>\n</ol>\n<p>A better design would be to add the type check in the cast function itself which already takes place as per <a href=\"https://github.com/tensorflow/tensorflow/blob/r1.10/tensorflow/python/ops/math_ops.py#L654\">here</a> if <code>x</code> is a tensor, so the unnecessary cast ops wouldn't be a problem, the case where an unnecessary cast op might emerge if <code>x</code> is not a tensor and a <code>convert_to_tensor</code> call might be sufficient is already a <code>TODO</code>.</p>\n<p>Kindly correct me if I missed something, as for the second part I'll add it right away.</p>", "body_text": "@fchollet Thank you for the review.\nFor the first part I think it might not be the best to add the type check before a cast for a couple of reasons\n\nIt would add a lot of redundant code before each cast.\nType checking using x.dtype != target_dtype would work if x is a tensor but will fail for python lists, tuples, scalars.\n\nA better design would be to add the type check in the cast function itself which already takes place as per here if x is a tensor, so the unnecessary cast ops wouldn't be a problem, the case where an unnecessary cast op might emerge if x is not a tensor and a convert_to_tensor call might be sufficient is already a TODO.\nKindly correct me if I missed something, as for the second part I'll add it right away.", "body": "@fchollet Thank you for the review.\r\n\r\nFor the first part I think it might not be the best to add the type check before a cast for a couple of reasons\r\n  1) It would add a lot of redundant code before each cast.\r\n  2) Type checking using ```x.dtype != target_dtype``` would work if ```x``` is a tensor but will fail for python lists, tuples, scalars.\r\n\r\nA better design would be to add the type check in the cast function itself which already takes place as per [here](https://github.com/tensorflow/tensorflow/blob/r1.10/tensorflow/python/ops/math_ops.py#L654) if ```x``` is a tensor, so the unnecessary cast ops wouldn't be a problem, the case where an unnecessary cast op might emerge if ```x``` is not a tensor and a ```convert_to_tensor``` call might be sufficient is already a ```TODO```.\r\n\r\nKindly correct me if I missed something, as for the second part I'll add it right away."}