{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/267011889", "html_url": "https://github.com/tensorflow/tensorflow/issues/6072#issuecomment-267011889", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6072", "id": 267011889, "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzAxMTg4OQ==", "user": {"login": "robotnc", "id": 18507467, "node_id": "MDQ6VXNlcjE4NTA3NDY3", "avatar_url": "https://avatars1.githubusercontent.com/u/18507467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robotnc", "html_url": "https://github.com/robotnc", "followers_url": "https://api.github.com/users/robotnc/followers", "following_url": "https://api.github.com/users/robotnc/following{/other_user}", "gists_url": "https://api.github.com/users/robotnc/gists{/gist_id}", "starred_url": "https://api.github.com/users/robotnc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robotnc/subscriptions", "organizations_url": "https://api.github.com/users/robotnc/orgs", "repos_url": "https://api.github.com/users/robotnc/repos", "events_url": "https://api.github.com/users/robotnc/events{/privacy}", "received_events_url": "https://api.github.com/users/robotnc/received_events", "type": "User", "site_admin": false}, "created_at": "2016-12-14T11:32:55Z", "updated_at": "2016-12-14T11:34:17Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1034716\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zhangyaobit\">@zhangyaobit</a> I succeed to run the code, and hope to know more detail about the weights structure.<br>\nMy model is two layer LSTM with 128cells each, now I use params_to_cannoical(params) get the weights. The weights include 16 tensors inside, which I can see it like this:</p>\n<p>weights = [W0,W1,W2,W3, ... W15], total 16 tensors in a list</p>\n<p>I assume that the first 8 tensors are for layer-0, and the last 8 tensors are for layer-1.<br>\nHowever in each layer, we have 8 matrixes which are</p>\n<p>W_f,W_o,W_c,W_i,R_f,R_o,R_c,R_i (f: forget gate, o: output gate, c: saved status, i: input gate)</p>\n<p>So the question is what is the correct order(f, o, c, i) of these matrixes?<br>\nFinally I need to convert the weights to be compatible with tf.nn.rnn_cell.BasicLSTMCell.</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/18507467/21179737/5ff2233c-c230-11e6-8b57-6a73e92dfab0.png\"><img src=\"https://cloud.githubusercontent.com/assets/18507467/21179737/5ff2233c-c230-11e6-8b57-6a73e92dfab0.png\" alt=\"cudnn_lstm\" style=\"max-width:100%;\"></a></p>", "body_text": "@zhangyaobit I succeed to run the code, and hope to know more detail about the weights structure.\nMy model is two layer LSTM with 128cells each, now I use params_to_cannoical(params) get the weights. The weights include 16 tensors inside, which I can see it like this:\nweights = [W0,W1,W2,W3, ... W15], total 16 tensors in a list\nI assume that the first 8 tensors are for layer-0, and the last 8 tensors are for layer-1.\nHowever in each layer, we have 8 matrixes which are\nW_f,W_o,W_c,W_i,R_f,R_o,R_c,R_i (f: forget gate, o: output gate, c: saved status, i: input gate)\nSo the question is what is the correct order(f, o, c, i) of these matrixes?\nFinally I need to convert the weights to be compatible with tf.nn.rnn_cell.BasicLSTMCell.", "body": "@zhangyaobit I succeed to run the code, and hope to know more detail about the weights structure.\r\nMy model is two layer LSTM with 128cells each, now I use params_to_cannoical(params) get the weights. The weights include 16 tensors inside, which I can see it like this:\r\n\r\n  weights = [W0,W1,W2,W3, ... W15], total 16 tensors in a list\r\n\r\nI assume that the first 8 tensors are for layer-0, and the last 8 tensors are for layer-1.\r\nHowever in each layer, we have 8 matrixes which are \r\n\r\n  W_f,W_o,W_c,W_i,R_f,R_o,R_c,R_i (f: forget gate, o: output gate, c: saved status, i: input gate)\r\n\r\nSo the question is what is the correct order(f, o, c, i) of these matrixes?\r\nFinally I need to convert the weights to be compatible with tf.nn.rnn_cell.BasicLSTMCell.\r\n\r\n![cudnn_lstm](https://cloud.githubusercontent.com/assets/18507467/21179737/5ff2233c-c230-11e6-8b57-6a73e92dfab0.png)\r\n"}