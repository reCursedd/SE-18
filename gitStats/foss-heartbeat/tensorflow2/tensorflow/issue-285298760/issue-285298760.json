{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15766", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15766/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15766/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15766/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15766", "id": 285298760, "node_id": "MDU6SXNzdWUyODUyOTg3NjA=", "number": 15766, "title": "tf.assert_equal raises incorrect traceback in Eager mode", "user": {"login": "matthew-z", "id": 5741303, "node_id": "MDQ6VXNlcjU3NDEzMDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/5741303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthew-z", "html_url": "https://github.com/matthew-z", "followers_url": "https://api.github.com/users/matthew-z/followers", "following_url": "https://api.github.com/users/matthew-z/following{/other_user}", "gists_url": "https://api.github.com/users/matthew-z/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthew-z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthew-z/subscriptions", "organizations_url": "https://api.github.com/users/matthew-z/orgs", "repos_url": "https://api.github.com/users/matthew-z/repos", "events_url": "https://api.github.com/users/matthew-z/events{/privacy}", "received_events_url": "https://api.github.com/users/matthew-z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "iganichev", "id": 9123400, "node_id": "MDQ6VXNlcjkxMjM0MDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9123400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iganichev", "html_url": "https://github.com/iganichev", "followers_url": "https://api.github.com/users/iganichev/followers", "following_url": "https://api.github.com/users/iganichev/following{/other_user}", "gists_url": "https://api.github.com/users/iganichev/gists{/gist_id}", "starred_url": "https://api.github.com/users/iganichev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iganichev/subscriptions", "organizations_url": "https://api.github.com/users/iganichev/orgs", "repos_url": "https://api.github.com/users/iganichev/repos", "events_url": "https://api.github.com/users/iganichev/events{/privacy}", "received_events_url": "https://api.github.com/users/iganichev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "iganichev", "id": 9123400, "node_id": "MDQ6VXNlcjkxMjM0MDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9123400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iganichev", "html_url": "https://github.com/iganichev", "followers_url": "https://api.github.com/users/iganichev/followers", "following_url": "https://api.github.com/users/iganichev/following{/other_user}", "gists_url": "https://api.github.com/users/iganichev/gists{/gist_id}", "starred_url": "https://api.github.com/users/iganichev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iganichev/subscriptions", "organizations_url": "https://api.github.com/users/iganichev/orgs", "repos_url": "https://api.github.com/users/iganichev/repos", "events_url": "https://api.github.com/users/iganichev/events{/privacy}", "received_events_url": "https://api.github.com/users/iganichev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-01-01T09:43:43Z", "updated_at": "2018-01-05T14:05:19Z", "closed_at": "2018-01-05T14:05:19Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:  No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 16.04.1 LTS</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: pip binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.5.0-dev20171227</li>\n<li><strong>Python version</strong>: 3.5.0</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>: None</li>\n<li><strong>GPU model and memory</strong>: None</li>\n<li><strong>Exact command to reproduce</strong>: python main.py</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>In eager mode, tf.assert_equal only shows <code>[]</code> in traceback message when two inputs are different. However, in graph mode, it does show different values in the message.</p>\n<h3>Source code / logs</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> tensorflow.contrib.eager <span class=\"pl-k\">as</span> tfe\n\ntfe.enable_eager_execution()\n\nx <span class=\"pl-k\">=</span> tf.constant([<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">3</span>])\ny <span class=\"pl-k\">=</span> tf.constant([<span class=\"pl-c1\">3</span>,<span class=\"pl-c1\">2</span>,<span class=\"pl-c1\">1</span>])\n\n<span class=\"pl-k\">with</span> tf.control_dependencies([tf.assert_equal(x, y)]):\n    output <span class=\"pl-k\">=</span> tf.reduce_sum(x)\n</pre></div>\n<p>Eager Mode Traceback:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/Users/matt/PycharmProjects/scratch/main.py\", line 9, in &lt;module&gt;\n    with tf.control_dependencies([tf.assert_equal(x, y)]):\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 376, in assert_equal\n    summary_msg)))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: \nCondition x == y did not hold.\nIndices of first 0 different values:\n[]\nCorresponding x values:\n[]\nCorresponding y values:\n[]\n</code></pre>\n<p>Graph Mode Traceback:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/Users/matt/PycharmProjects/scratch/main.py\", line 9, in &lt;module&gt;\n    with tf.control_dependencies([tf.assert_equal(x, y)]):\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 391, in assert_equal\n    _assert_static(condition_static, data)\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 104, in _assert_static\n    message='\\n'.join(data_static))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: \nCondition x == y did not hold element-wise:\nx (Const:0) = \n[1 2 3]\ny (Const_1:0) = \n[3 2 1]\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):  No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04.1 LTS\nTensorFlow installed from (source or binary): pip binary\nTensorFlow version (use command below): 1.5.0-dev20171227\nPython version: 3.5.0\nBazel version (if compiling from source):\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version: None\nGPU model and memory: None\nExact command to reproduce: python main.py\n\nDescribe the problem\nIn eager mode, tf.assert_equal only shows [] in traceback message when two inputs are different. However, in graph mode, it does show different values in the message.\nSource code / logs\nimport tensorflow as tf\nimport tensorflow.contrib.eager as tfe\n\ntfe.enable_eager_execution()\n\nx = tf.constant([1,2,3])\ny = tf.constant([3,2,1])\n\nwith tf.control_dependencies([tf.assert_equal(x, y)]):\n    output = tf.reduce_sum(x)\n\nEager Mode Traceback:\nTraceback (most recent call last):\n  File \"/Users/matt/PycharmProjects/scratch/main.py\", line 9, in <module>\n    with tf.control_dependencies([tf.assert_equal(x, y)]):\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 376, in assert_equal\n    summary_msg)))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: \nCondition x == y did not hold.\nIndices of first 0 different values:\n[]\nCorresponding x values:\n[]\nCorresponding y values:\n[]\n\nGraph Mode Traceback:\nTraceback (most recent call last):\n  File \"/Users/matt/PycharmProjects/scratch/main.py\", line 9, in <module>\n    with tf.control_dependencies([tf.assert_equal(x, y)]):\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 391, in assert_equal\n    _assert_static(condition_static, data)\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 104, in _assert_static\n    message='\\n'.join(data_static))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: \nCondition x == y did not hold element-wise:\nx (Const:0) = \n[1 2 3]\ny (Const_1:0) = \n[3 2 1]", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:  No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04.1 LTS\r\n- **TensorFlow installed from (source or binary)**: pip binary\r\n- **TensorFlow version (use command below)**: 1.5.0-dev20171227\r\n- **Python version**: 3.5.0\r\n- **Bazel version (if compiling from source)**: \r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: None\r\n- **GPU model and memory**: None\r\n- **Exact command to reproduce**: python main.py\r\n\r\n\r\n### Describe the problem\r\n\r\nIn eager mode, tf.assert_equal only shows `[]` in traceback message when two inputs are different. However, in graph mode, it does show different values in the message. \r\n\r\n### Source code / logs\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.eager as tfe\r\n\r\ntfe.enable_eager_execution()\r\n\r\nx = tf.constant([1,2,3])\r\ny = tf.constant([3,2,1])\r\n\r\nwith tf.control_dependencies([tf.assert_equal(x, y)]):\r\n    output = tf.reduce_sum(x)\r\n\r\n```\r\n\r\n\r\nEager Mode Traceback:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/matt/PycharmProjects/scratch/main.py\", line 9, in <module>\r\n    with tf.control_dependencies([tf.assert_equal(x, y)]):\r\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 376, in assert_equal\r\n    summary_msg)))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: \r\nCondition x == y did not hold.\r\nIndices of first 0 different values:\r\n[]\r\nCorresponding x values:\r\n[]\r\nCorresponding y values:\r\n[]\r\n```\r\n\r\n\r\nGraph Mode Traceback:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/matt/PycharmProjects/scratch/main.py\", line 9, in <module>\r\n    with tf.control_dependencies([tf.assert_equal(x, y)]):\r\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 391, in assert_equal\r\n    _assert_static(condition_static, data)\r\n  File \"/usr/local/var/pyenv/versions/anaconda3-4.1.1/lib/python3.6/site-packages/tensorflow/python/ops/check_ops.py\", line 104, in _assert_static\r\n    message='\\n'.join(data_static))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: \r\nCondition x == y did not hold element-wise:\r\nx (Const:0) = \r\n[1 2 3]\r\ny (Const_1:0) = \r\n[3 2 1]\r\n```\r\n"}