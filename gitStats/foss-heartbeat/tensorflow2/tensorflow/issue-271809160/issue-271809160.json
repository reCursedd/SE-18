{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14320", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14320/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14320/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14320/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14320", "id": 271809160, "node_id": "MDU6SXNzdWUyNzE4MDkxNjA=", "number": 14320, "title": "Supervisor does not initialize parameters", "user": {"login": "AlexWang90", "id": 8745241, "node_id": "MDQ6VXNlcjg3NDUyNDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/8745241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlexWang90", "html_url": "https://github.com/AlexWang90", "followers_url": "https://api.github.com/users/AlexWang90/followers", "following_url": "https://api.github.com/users/AlexWang90/following{/other_user}", "gists_url": "https://api.github.com/users/AlexWang90/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlexWang90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlexWang90/subscriptions", "organizations_url": "https://api.github.com/users/AlexWang90/orgs", "repos_url": "https://api.github.com/users/AlexWang90/repos", "events_url": "https://api.github.com/users/AlexWang90/events{/privacy}", "received_events_url": "https://api.github.com/users/AlexWang90/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-11-07T12:09:30Z", "updated_at": "2017-11-07T17:37:37Z", "closed_at": "2017-11-07T17:37:36Z", "author_association": "NONE", "body_html": "<p>Hi\uff0c<br>\nIt throws an exception when I tried to initialize parameters with tf.train.Supervisor where the net is contructed with tensorlayer. The code is like this:</p>\n<pre><code>    init_op = tf.global_variables_initializer()\n    saver = tf.train.Saver()\n    config = tf.ConfigProto()\n    config.gpu_options.allow_growth = True\n    sv = tf.train.Supervisor(logdir=FLAGS.summary_dir, save_summaries_secs=0, saver=None)\n    with sv.managed_session(config=config) as sess:\n           init_ = sess.run(init_op)\n           net.print_params()\n           net.print_layers()\n            tl.layers.print_all_variables()\n</code></pre>\n<p>and the exception is:</p>\n<pre><code>Cannot evaluate tensor using `eval()`: No default session is registered. Use `with sess.as_default()` or pass an explicit session to `eval(session=sess)`\nTraceback (most recent call last):\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorlayer/layers.py\", line 309, in print_params\n    val = p.eval()\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py\", line 463, in eval\n    return self._variable.eval(session=session)\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 606, in eval\n    return _eval_using_default_session(self, feed_dict, self.graph, session)\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3914, in _eval_using_default_session\n    raise ValueError(\"Cannot evaluate tensor using `eval()`: No default \"\nValueError: Cannot evaluate tensor using `eval()`: No default session is registered. Use `with sess.as_default()` or pass an explicit session to `eval(session=sess)`\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"MainEntryPtb.py\", line 65, in &lt;module&gt;\n    train_rnn(FLAGS)\n  File \"/home/recsys/wangjian/learntf/TFTemplate/examples/ptb.py\", line 122, in train_rnn\n    net.print_params()\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorlayer/layers.py\", line 313, in print_params\n    raise Exception(\"Hint: print params details after tl.layers.initialize_global_variables(sess) or use network.print_params(False).\")\nException: Hint: print params details after tl.layers.initialize_global_variables(sess) or use network.print_params(False).\n</code></pre>\n<p>It seems that when I run initialize op <code>init_ = sess.run(init_op)</code>  it does not really work.</p>\n<p>I use tensorflow v1.2.1 and python3.6</p>", "body_text": "Hi\uff0c\nIt throws an exception when I tried to initialize parameters with tf.train.Supervisor where the net is contructed with tensorlayer. The code is like this:\n    init_op = tf.global_variables_initializer()\n    saver = tf.train.Saver()\n    config = tf.ConfigProto()\n    config.gpu_options.allow_growth = True\n    sv = tf.train.Supervisor(logdir=FLAGS.summary_dir, save_summaries_secs=0, saver=None)\n    with sv.managed_session(config=config) as sess:\n           init_ = sess.run(init_op)\n           net.print_params()\n           net.print_layers()\n            tl.layers.print_all_variables()\n\nand the exception is:\nCannot evaluate tensor using `eval()`: No default session is registered. Use `with sess.as_default()` or pass an explicit session to `eval(session=sess)`\nTraceback (most recent call last):\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorlayer/layers.py\", line 309, in print_params\n    val = p.eval()\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py\", line 463, in eval\n    return self._variable.eval(session=session)\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 606, in eval\n    return _eval_using_default_session(self, feed_dict, self.graph, session)\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3914, in _eval_using_default_session\n    raise ValueError(\"Cannot evaluate tensor using `eval()`: No default \"\nValueError: Cannot evaluate tensor using `eval()`: No default session is registered. Use `with sess.as_default()` or pass an explicit session to `eval(session=sess)`\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"MainEntryPtb.py\", line 65, in <module>\n    train_rnn(FLAGS)\n  File \"/home/recsys/wangjian/learntf/TFTemplate/examples/ptb.py\", line 122, in train_rnn\n    net.print_params()\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorlayer/layers.py\", line 313, in print_params\n    raise Exception(\"Hint: print params details after tl.layers.initialize_global_variables(sess) or use network.print_params(False).\")\nException: Hint: print params details after tl.layers.initialize_global_variables(sess) or use network.print_params(False).\n\nIt seems that when I run initialize op init_ = sess.run(init_op)  it does not really work.\nI use tensorflow v1.2.1 and python3.6", "body": "Hi\uff0c \r\n      It throws an exception when I tried to initialize parameters with tf.train.Supervisor where the net is contructed with tensorlayer. The code is like this:\r\n \r\n```\r\n    init_op = tf.global_variables_initializer()\r\n    saver = tf.train.Saver()\r\n    config = tf.ConfigProto()\r\n    config.gpu_options.allow_growth = True\r\n    sv = tf.train.Supervisor(logdir=FLAGS.summary_dir, save_summaries_secs=0, saver=None)\r\n    with sv.managed_session(config=config) as sess:\r\n           init_ = sess.run(init_op)\r\n           net.print_params()\r\n           net.print_layers()\r\n            tl.layers.print_all_variables()\r\n```\r\nand the exception is:\r\n\r\n```\r\nCannot evaluate tensor using `eval()`: No default session is registered. Use `with sess.as_default()` or pass an explicit session to `eval(session=sess)`\r\nTraceback (most recent call last):\r\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorlayer/layers.py\", line 309, in print_params\r\n    val = p.eval()\r\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/ops/variables.py\", line 463, in eval\r\n    return self._variable.eval(session=session)\r\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 606, in eval\r\n    return _eval_using_default_session(self, feed_dict, self.graph, session)\r\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3914, in _eval_using_default_session\r\n    raise ValueError(\"Cannot evaluate tensor using `eval()`: No default \"\r\nValueError: Cannot evaluate tensor using `eval()`: No default session is registered. Use `with sess.as_default()` or pass an explicit session to `eval(session=sess)`\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"MainEntryPtb.py\", line 65, in <module>\r\n    train_rnn(FLAGS)\r\n  File \"/home/recsys/wangjian/learntf/TFTemplate/examples/ptb.py\", line 122, in train_rnn\r\n    net.print_params()\r\n  File \"/home/recsys/anaconda3/envs/tf1.2/lib/python3.6/site-packages/tensorlayer/layers.py\", line 313, in print_params\r\n    raise Exception(\"Hint: print params details after tl.layers.initialize_global_variables(sess) or use network.print_params(False).\")\r\nException: Hint: print params details after tl.layers.initialize_global_variables(sess) or use network.print_params(False).\r\n```\r\n\r\nIt seems that when I run initialize op `init_ = sess.run(init_op)`  it does not really work.\r\n\r\nI use tensorflow v1.2.1 and python3.6"}