{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12501", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12501/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12501/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12501/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12501", "id": 252090268, "node_id": "MDU6SXNzdWUyNTIwOTAyNjg=", "number": 12501, "title": "EditDistance crashes under C++ environment", "user": {"login": "rasitsimsek", "id": 30691148, "node_id": "MDQ6VXNlcjMwNjkxMTQ4", "avatar_url": "https://avatars1.githubusercontent.com/u/30691148?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rasitsimsek", "html_url": "https://github.com/rasitsimsek", "followers_url": "https://api.github.com/users/rasitsimsek/followers", "following_url": "https://api.github.com/users/rasitsimsek/following{/other_user}", "gists_url": "https://api.github.com/users/rasitsimsek/gists{/gist_id}", "starred_url": "https://api.github.com/users/rasitsimsek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rasitsimsek/subscriptions", "organizations_url": "https://api.github.com/users/rasitsimsek/orgs", "repos_url": "https://api.github.com/users/rasitsimsek/repos", "events_url": "https://api.github.com/users/rasitsimsek/events{/privacy}", "received_events_url": "https://api.github.com/users/rasitsimsek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-08-22T21:09:26Z", "updated_at": "2017-09-21T08:14:47Z", "closed_at": "2017-09-21T08:09:33Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Windows 10</strong>:</li>\n<li><strong>TensorFlow installed from source</strong>:</li>\n<li><strong>TensorFlow version 1.3-rc2</strong>:</li>\n<li><strong>Python version 3.5</strong>:</li>\n<li><strong>VisualStudio 2017</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I have created a C++ example with EditDistance and linked a debug version of tensorflow.dll which is created from tensorflow source.  The compiled EditDistance example crashed at <strong>session.Run( outputs, &amp;output_tensor );</strong>. I have tried in this example also in the tensorflow environment it crashes also. It seems the EditDistance operator doesn't work under C++. I have searched another EditDistance examples but it seems nobody has tested it outside the python environment.</p>\n<h3>Source code / logs</h3>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;unordered_set&gt;\n\n#include \"tensorflow/cc/client/client_session.h\"\n#include \"tensorflow/cc/ops/standard_ops.h\"\n#include \"tensorflow/core/framework/tensor.h\"\n#include \"tensorflow/core/lib/gtl/edit_distance.h\"\n#include \"tensorflow/core/util/sparse/sparse_tensor.h\"\n#include \"tensorflow/core/protobuf/config.pb.h\"\n\nusing namespace std;\n</code></pre>\n<pre><code>int main( int argc, char *argv[] )\n</code></pre>\n<pre><code>{\n           using namespace tensorflow;\n           using namespace tensorflow::ops;\n           using namespace tensorflow::gtl;\n           Scope root = Scope::NewRootScope();\n</code></pre>\n<pre><code>       std::vector&lt;Tensor&gt; output_tensor;\n       ClientSession session( root );\n\n\n       Tensor hypho2_ix( DT_INT64, TensorShape( { static_cast&lt;int64_t&gt;( 4 ), 3 } ) );\n       Tensor hypho2_vals( DT_STRING, TensorShape( {static_cast&lt;int64_t&gt;( 4 )} ) );\n\n       makeIndex( {\"bear\"}, hypho2_ix );\n       makeChar ( {\"bear\"}, hypho2_vals );\n\n       Tensor truth2_ix( DT_INT64, TensorShape( { static_cast&lt;int64_t&gt;( 5 ), 3 } ) );\n       Tensor truth2_vals( DT_STRING, TensorShape( {static_cast&lt;int64_t&gt;( 5 )} ) );\n\n       makeIndex( { \"beers\" }, truth2_ix );\n       makeChar ( { \"beers\" }, truth2_vals );\n\n       // Declaration of edit distance\n       auto address_dist = EditDistance( root\n                               , hypho2_ix\n                               , hypho2_vals\n                               , {3,1,1}// {static_cast&lt;int64_t&gt;(1),3}//test_address_shape\n                               , truth2_ix\n                               , truth2_vals\n                               , {3,1,1} //ref_address_shape\n                               , EditDistance::Normalize(false) );\n\n                                  const std::vector&lt;Output&gt; outputs = {address_dist};\n       session.Run( outputs, &amp;output_tensor );\n }   \n    void makeIndex( const std::vector&lt;string&gt;&amp; rsoStringVector, tensorflow::Tensor&amp; roIndexTensor )\n    {\n       auto ix_t = roIndexTensor.matrix&lt;int64_t&gt;();\n       std::size_t stCounter = 0;\n       for( std::size_t stX = 0; stX &lt; rsoStringVector.size() ; stX++ )\n       {\n          const std::string&amp; rsString = rsoStringVector[ stX ];\n          for( std::size_t stY = 0; stY &lt; rsString.size(); stY++ )\n          {\n             ix_t( stCounter, 0 ) = stX;\n             ix_t( stCounter, 1 ) = 0;\n             ix_t( stCounter, 2 ) = stY;\n             stCounter++;\n          }\n       }\n    }\n\n    void makeChar( const std::vector&lt;std::string&gt;&amp; rsoStringVector, tensorflow::Tensor&amp; roCharTensor )\n    {\n       auto vals_t = roCharTensor.vec&lt;std::string&gt;();\n\n       int64_t i64Index = 0;\n       for( std::size_t stX = 0; stX &lt; rsoStringVector.size(); stX++ )\n       {\n          const std::string&amp; rsString = rsoStringVector[ stX ];\n          for( std::size_t stY = 0; stY &lt; rsString.size(); stY++ )\n          {\n             vals_t( i64Index++ ) = ( rsString[ stY ] );\n          }\n       }\n    }\n</code></pre>", "body_text": "System information\n\nWindows 10:\nTensorFlow installed from source:\nTensorFlow version 1.3-rc2:\nPython version 3.5:\nVisualStudio 2017:\n\nDescribe the problem\nI have created a C++ example with EditDistance and linked a debug version of tensorflow.dll which is created from tensorflow source.  The compiled EditDistance example crashed at session.Run( outputs, &output_tensor );. I have tried in this example also in the tensorflow environment it crashes also. It seems the EditDistance operator doesn't work under C++. I have searched another EditDistance examples but it seems nobody has tested it outside the python environment.\nSource code / logs\n#include <iostream>\n#include <vector>\n#include <string>\n#include <unordered_set>\n\n#include \"tensorflow/cc/client/client_session.h\"\n#include \"tensorflow/cc/ops/standard_ops.h\"\n#include \"tensorflow/core/framework/tensor.h\"\n#include \"tensorflow/core/lib/gtl/edit_distance.h\"\n#include \"tensorflow/core/util/sparse/sparse_tensor.h\"\n#include \"tensorflow/core/protobuf/config.pb.h\"\n\nusing namespace std;\n\nint main( int argc, char *argv[] )\n\n{\n           using namespace tensorflow;\n           using namespace tensorflow::ops;\n           using namespace tensorflow::gtl;\n           Scope root = Scope::NewRootScope();\n\n       std::vector<Tensor> output_tensor;\n       ClientSession session( root );\n\n\n       Tensor hypho2_ix( DT_INT64, TensorShape( { static_cast<int64_t>( 4 ), 3 } ) );\n       Tensor hypho2_vals( DT_STRING, TensorShape( {static_cast<int64_t>( 4 )} ) );\n\n       makeIndex( {\"bear\"}, hypho2_ix );\n       makeChar ( {\"bear\"}, hypho2_vals );\n\n       Tensor truth2_ix( DT_INT64, TensorShape( { static_cast<int64_t>( 5 ), 3 } ) );\n       Tensor truth2_vals( DT_STRING, TensorShape( {static_cast<int64_t>( 5 )} ) );\n\n       makeIndex( { \"beers\" }, truth2_ix );\n       makeChar ( { \"beers\" }, truth2_vals );\n\n       // Declaration of edit distance\n       auto address_dist = EditDistance( root\n                               , hypho2_ix\n                               , hypho2_vals\n                               , {3,1,1}// {static_cast<int64_t>(1),3}//test_address_shape\n                               , truth2_ix\n                               , truth2_vals\n                               , {3,1,1} //ref_address_shape\n                               , EditDistance::Normalize(false) );\n\n                                  const std::vector<Output> outputs = {address_dist};\n       session.Run( outputs, &output_tensor );\n }   \n    void makeIndex( const std::vector<string>& rsoStringVector, tensorflow::Tensor& roIndexTensor )\n    {\n       auto ix_t = roIndexTensor.matrix<int64_t>();\n       std::size_t stCounter = 0;\n       for( std::size_t stX = 0; stX < rsoStringVector.size() ; stX++ )\n       {\n          const std::string& rsString = rsoStringVector[ stX ];\n          for( std::size_t stY = 0; stY < rsString.size(); stY++ )\n          {\n             ix_t( stCounter, 0 ) = stX;\n             ix_t( stCounter, 1 ) = 0;\n             ix_t( stCounter, 2 ) = stY;\n             stCounter++;\n          }\n       }\n    }\n\n    void makeChar( const std::vector<std::string>& rsoStringVector, tensorflow::Tensor& roCharTensor )\n    {\n       auto vals_t = roCharTensor.vec<std::string>();\n\n       int64_t i64Index = 0;\n       for( std::size_t stX = 0; stX < rsoStringVector.size(); stX++ )\n       {\n          const std::string& rsString = rsoStringVector[ stX ];\n          for( std::size_t stY = 0; stY < rsString.size(); stY++ )\n          {\n             vals_t( i64Index++ ) = ( rsString[ stY ] );\n          }\n       }\n    }", "body": "### System information\r\n- **Windows 10**:\r\n- **TensorFlow installed from source**:\r\n- **TensorFlow version 1.3-rc2**:\r\n- **Python version 3.5**:\r\n- **VisualStudio 2017**:\r\n\r\n### Describe the problem\r\nI have created a C++ example with EditDistance and linked a debug version of tensorflow.dll which is created from tensorflow source.  The compiled EditDistance example crashed at **session.Run( outputs, &output_tensor );**. I have tried in this example also in the tensorflow environment it crashes also. It seems the EditDistance operator doesn't work under C++. I have searched another EditDistance examples but it seems nobody has tested it outside the python environment.\r\n\r\n### Source code / logs\r\n```\r\n#include <iostream>\r\n#include <vector>\r\n#include <string>\r\n#include <unordered_set>\r\n\r\n#include \"tensorflow/cc/client/client_session.h\"\r\n#include \"tensorflow/cc/ops/standard_ops.h\"\r\n#include \"tensorflow/core/framework/tensor.h\"\r\n#include \"tensorflow/core/lib/gtl/edit_distance.h\"\r\n#include \"tensorflow/core/util/sparse/sparse_tensor.h\"\r\n#include \"tensorflow/core/protobuf/config.pb.h\"\r\n\r\nusing namespace std;\r\n```\r\n\r\n    int main( int argc, char *argv[] )\r\n```\r\n{\r\n           using namespace tensorflow;\r\n           using namespace tensorflow::ops;\r\n           using namespace tensorflow::gtl;\r\n           Scope root = Scope::NewRootScope();\r\n```\r\n\r\n           std::vector<Tensor> output_tensor;\r\n           ClientSession session( root );\r\n\r\n\r\n           Tensor hypho2_ix( DT_INT64, TensorShape( { static_cast<int64_t>( 4 ), 3 } ) );\r\n           Tensor hypho2_vals( DT_STRING, TensorShape( {static_cast<int64_t>( 4 )} ) );\r\n\r\n           makeIndex( {\"bear\"}, hypho2_ix );\r\n           makeChar ( {\"bear\"}, hypho2_vals );\r\n\r\n           Tensor truth2_ix( DT_INT64, TensorShape( { static_cast<int64_t>( 5 ), 3 } ) );\r\n           Tensor truth2_vals( DT_STRING, TensorShape( {static_cast<int64_t>( 5 )} ) );\r\n\r\n           makeIndex( { \"beers\" }, truth2_ix );\r\n           makeChar ( { \"beers\" }, truth2_vals );\r\n\r\n           // Declaration of edit distance\r\n           auto address_dist = EditDistance( root\r\n                                   , hypho2_ix\r\n                                   , hypho2_vals\r\n                                   , {3,1,1}// {static_cast<int64_t>(1),3}//test_address_shape\r\n                                   , truth2_ix\r\n                                   , truth2_vals\r\n                                   , {3,1,1} //ref_address_shape\r\n                                   , EditDistance::Normalize(false) );\r\n\r\n                                      const std::vector<Output> outputs = {address_dist};\r\n           session.Run( outputs, &output_tensor );\r\n     }   \r\n        void makeIndex( const std::vector<string>& rsoStringVector, tensorflow::Tensor& roIndexTensor )\r\n        {\r\n           auto ix_t = roIndexTensor.matrix<int64_t>();\r\n           std::size_t stCounter = 0;\r\n           for( std::size_t stX = 0; stX < rsoStringVector.size() ; stX++ )\r\n           {\r\n              const std::string& rsString = rsoStringVector[ stX ];\r\n              for( std::size_t stY = 0; stY < rsString.size(); stY++ )\r\n              {\r\n                 ix_t( stCounter, 0 ) = stX;\r\n                 ix_t( stCounter, 1 ) = 0;\r\n                 ix_t( stCounter, 2 ) = stY;\r\n                 stCounter++;\r\n              }\r\n           }\r\n        }\r\n\r\n        void makeChar( const std::vector<std::string>& rsoStringVector, tensorflow::Tensor& roCharTensor )\r\n        {\r\n           auto vals_t = roCharTensor.vec<std::string>();\r\n\r\n           int64_t i64Index = 0;\r\n           for( std::size_t stX = 0; stX < rsoStringVector.size(); stX++ )\r\n           {\r\n              const std::string& rsString = rsoStringVector[ stX ];\r\n              for( std::size_t stY = 0; stY < rsString.size(); stY++ )\r\n              {\r\n                 vals_t( i64Index++ ) = ( rsString[ stY ] );\r\n              }\r\n           }\r\n        }\r\n"}