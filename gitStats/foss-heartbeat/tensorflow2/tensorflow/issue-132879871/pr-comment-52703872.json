{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/52703872", "pull_request_review_id": null, "id": 52703872, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAzODcy", "diff_hunk": "@@ -120,15 +128,20 @@ fi\n EXTRA_PARAMS=\"\"\n \n # Determine if Docker is available\n-MAIN_CMD=${DOCKER_MAIN_CMD}\n if [[ -z \"$(which docker)\" ]]; then\n+  DO_DOCKER=0\n+\n   echo \"It appears that Docker is not available on this system. \"\\\n \"Will perform build without Docker.\"\n-  echo \"In addition, the additional option flags will be applied to the build:\"\n+  echo \"Also, the additional option flags will be applied to the build:\"\n   echo \"  ${NO_DOCKER_OPT_FLAG}\"\n-  MAIN_CMD=${NO_DOCKER_MAIN_CMD}\n+  MAIN_CMD=\"${NO_DOCKER_MAIN_CMD} ${CTYPE}\"\n   OPT_FLAG=\"${OPT_FLAG} ${NO_DOCKER_OPT_FLAG}\"\n \n+  # Perform bazel clean in non-Docker environments to ensure a clean build\n+  echo \"Also, \\\"${BAZEL_CLEAN_CMD}\\\" will be performed prior to \"\\\n+\"the main build step\"\n+  DO_BAZEL_CLEAN=1", "path": "tensorflow/tools/ci_build/ci_parameterized_build.sh", "position": null, "original_position": 43, "commit_id": "d73c0e67a5ebe3dbf1c3e40ac8f27820d1e59765", "original_commit_id": "4a2be82dab7b2d7d5e5816d8850b0bf8446bbd0c", "user": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "body": "@jendap Yes, that would slow things down. But I see your point. I guess the Bazel caching somehow didn't work when the folder is mapped from outside Docker to inside, which is the main reason why we haven't needed to do bazel clean for Docker builds? @martinwicke has their been any changes regarding the caching recently? \n", "created_at": "2016-02-12T04:10:57Z", "updated_at": "2016-02-12T22:36:18Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/1051#discussion_r52703872", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1051", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/52703872"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/1051#discussion_r52703872"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1051"}}, "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=567848\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jendap\">@jendap</a> Yes, that would slow things down. But I see your point. I guess the Bazel caching somehow didn't work when the folder is mapped from outside Docker to inside, which is the main reason why we haven't needed to do bazel clean for Docker builds? <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=577277\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/martinwicke\">@martinwicke</a> has their been any changes regarding the caching recently?</p>", "body_text": "@jendap Yes, that would slow things down. But I see your point. I guess the Bazel caching somehow didn't work when the folder is mapped from outside Docker to inside, which is the main reason why we haven't needed to do bazel clean for Docker builds? @martinwicke has their been any changes regarding the caching recently?"}