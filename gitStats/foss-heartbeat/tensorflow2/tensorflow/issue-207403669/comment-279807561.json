{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/279807561", "html_url": "https://github.com/tensorflow/tensorflow/pull/7487#issuecomment-279807561", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7487", "id": 279807561, "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTgwNzU2MQ==", "user": {"login": "drasmuss", "id": 1952220, "node_id": "MDQ6VXNlcjE5NTIyMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1952220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drasmuss", "html_url": "https://github.com/drasmuss", "followers_url": "https://api.github.com/users/drasmuss/followers", "following_url": "https://api.github.com/users/drasmuss/following{/other_user}", "gists_url": "https://api.github.com/users/drasmuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/drasmuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drasmuss/subscriptions", "organizations_url": "https://api.github.com/users/drasmuss/orgs", "repos_url": "https://api.github.com/users/drasmuss/repos", "events_url": "https://api.github.com/users/drasmuss/events{/privacy}", "received_events_url": "https://api.github.com/users/drasmuss/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-14T19:21:47Z", "updated_at": "2017-02-14T19:21:47Z", "author_association": "CONTRIBUTOR", "body_html": "<p>One option would be to just change the definition of <code>dynamic_stitch</code> to not allow duplicate indices, since that is how it seems to be used a lot of the time.</p>\n<p>However, one of the important uses of <code>dynamic_stitch</code> (from my perspective anyway) is that it's the only way I can find to do sparse updates on tensors that both runs on the GPU and has a gradient implementation (as suggested by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a> here <a href=\"http://stackoverflow.com/questions/37061808/how-does-tensorflow-indexing-work\" rel=\"nofollow\">http://stackoverflow.com/questions/37061808/how-does-tensorflow-indexing-work</a>). And that use case would be made less efficient if we don't allow duplicate indices (for the same reason that the gradient is less efficient here, since we'd need to manually compute the non-duplicate indices).</p>\n<p>So if we're going to be adding new ops anyway, perhaps the best solution would be to add an op that does those sparse updates (the equivalent of <code>scatter_update</code>, but for tensors) to cover that use case, and then restrict the definition of <code>dynamic_stitch</code> to unique indices to handle the other use cases (without sacrificing performance).</p>", "body_text": "One option would be to just change the definition of dynamic_stitch to not allow duplicate indices, since that is how it seems to be used a lot of the time.\nHowever, one of the important uses of dynamic_stitch (from my perspective anyway) is that it's the only way I can find to do sparse updates on tensors that both runs on the GPU and has a gradient implementation (as suggested by @yaroslavvb here http://stackoverflow.com/questions/37061808/how-does-tensorflow-indexing-work). And that use case would be made less efficient if we don't allow duplicate indices (for the same reason that the gradient is less efficient here, since we'd need to manually compute the non-duplicate indices).\nSo if we're going to be adding new ops anyway, perhaps the best solution would be to add an op that does those sparse updates (the equivalent of scatter_update, but for tensors) to cover that use case, and then restrict the definition of dynamic_stitch to unique indices to handle the other use cases (without sacrificing performance).", "body": "One option would be to just change the definition of `dynamic_stitch` to not allow duplicate indices, since that is how it seems to be used a lot of the time.\r\n\r\nHowever, one of the important uses of `dynamic_stitch` (from my perspective anyway) is that it's the only way I can find to do sparse updates on tensors that both runs on the GPU and has a gradient implementation (as suggested by @yaroslavvb here http://stackoverflow.com/questions/37061808/how-does-tensorflow-indexing-work). And that use case would be made less efficient if we don't allow duplicate indices (for the same reason that the gradient is less efficient here, since we'd need to manually compute the non-duplicate indices).\r\n\r\nSo if we're going to be adding new ops anyway, perhaps the best solution would be to add an op that does those sparse updates (the equivalent of `scatter_update`, but for tensors) to cover that use case, and then restrict the definition of `dynamic_stitch` to unique indices to handle the other use cases (without sacrificing performance)."}