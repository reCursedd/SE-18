{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/429459498", "html_url": "https://github.com/tensorflow/tensorflow/issues/22395#issuecomment-429459498", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22395", "id": 429459498, "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTQ1OTQ5OA==", "user": {"login": "annarev", "id": 22060313, "node_id": "MDQ6VXNlcjIyMDYwMzEz", "avatar_url": "https://avatars0.githubusercontent.com/u/22060313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/annarev", "html_url": "https://github.com/annarev", "followers_url": "https://api.github.com/users/annarev/followers", "following_url": "https://api.github.com/users/annarev/following{/other_user}", "gists_url": "https://api.github.com/users/annarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/annarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/annarev/subscriptions", "organizations_url": "https://api.github.com/users/annarev/orgs", "repos_url": "https://api.github.com/users/annarev/repos", "events_url": "https://api.github.com/users/annarev/events{/privacy}", "received_events_url": "https://api.github.com/users/annarev/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-12T20:55:27Z", "updated_at": "2018-10-12T20:55:27Z", "author_association": "MEMBER", "body_html": "<p>Thank you <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4171702\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/meteorcloudy\">@meteorcloudy</a>!</p>\n<p>hm passing --action_env PYTHONPATH= works for me. I tried the following:</p>\n<ol>\n<li>Setup virtualenv \"venv\" and install pip dependencies <em>except keras_applications</em></li>\n<li>Setup virtualenv \"venv1\" and install <em>only keras_applications</em></li>\n<li>Then I activate \"venv\" and run:</li>\n</ol>\n<pre><code>bazel test tensorflow/tools/api/tests:api_compatibility_test --nocache_test_results\n</code></pre>\n<p>It fails because keras_applications is not found, as expected.</p>\n<ol start=\"4\">\n<li>Then, I run the same but pass PYTHONPATH that points to venv1 site-packages:</li>\n</ol>\n<pre><code>bazel test --action_env PYTHONPATH=\"&lt;path to venv1&gt;/venv1/lib/python2.7/site-packages\" tensorflow/tools/api/tests:api_compatibility_test --nocache_test_results\n</code></pre>\n<p>This command passes.</p>\n<p>In case relevant, this is my setup:</p>\n<pre><code>virtualenv venv1\nsource venv1/bin/activate\npip install keras_applications==1.0.4\ndeactivate\n\nvirtualenv venv\nsource venv/bin/activate\npip install --upgrade setuptools==39.1.0\npip install keras_preprocessing==1.0.2\npip install --upgrade six mock portpicker scipy sklearn grpcio\npip install numpy==1.14.5\npip uninstall keras_applications\n\ngit clone https://github.com/tensorflow/tensorflow.git\ncd tensorflow/\nexport TF_NEED_CUDA=0\nyes \"\" | python configure.py\n</code></pre>", "body_text": "Thank you @meteorcloudy!\nhm passing --action_env PYTHONPATH= works for me. I tried the following:\n\nSetup virtualenv \"venv\" and install pip dependencies except keras_applications\nSetup virtualenv \"venv1\" and install only keras_applications\nThen I activate \"venv\" and run:\n\nbazel test tensorflow/tools/api/tests:api_compatibility_test --nocache_test_results\n\nIt fails because keras_applications is not found, as expected.\n\nThen, I run the same but pass PYTHONPATH that points to venv1 site-packages:\n\nbazel test --action_env PYTHONPATH=\"<path to venv1>/venv1/lib/python2.7/site-packages\" tensorflow/tools/api/tests:api_compatibility_test --nocache_test_results\n\nThis command passes.\nIn case relevant, this is my setup:\nvirtualenv venv1\nsource venv1/bin/activate\npip install keras_applications==1.0.4\ndeactivate\n\nvirtualenv venv\nsource venv/bin/activate\npip install --upgrade setuptools==39.1.0\npip install keras_preprocessing==1.0.2\npip install --upgrade six mock portpicker scipy sklearn grpcio\npip install numpy==1.14.5\npip uninstall keras_applications\n\ngit clone https://github.com/tensorflow/tensorflow.git\ncd tensorflow/\nexport TF_NEED_CUDA=0\nyes \"\" | python configure.py", "body": "Thank you @meteorcloudy!\r\n\r\nhm passing --action_env PYTHONPATH=<pythonpath value> works for me. I tried the following:\r\n1. Setup virtualenv \"venv\" and install pip dependencies *except keras_applications*\r\n2. Setup virtualenv \"venv1\" and install *only keras_applications*\r\n3. Then I activate \"venv\" and run:\r\n```\r\nbazel test tensorflow/tools/api/tests:api_compatibility_test --nocache_test_results\r\n```\r\nIt fails because keras_applications is not found, as expected.\r\n\r\n4. Then, I run the same but pass PYTHONPATH that points to venv1 site-packages:\r\n```\r\nbazel test --action_env PYTHONPATH=\"<path to venv1>/venv1/lib/python2.7/site-packages\" tensorflow/tools/api/tests:api_compatibility_test --nocache_test_results\r\n```\r\nThis command passes.\r\n\r\n\r\n\r\nIn case relevant, this is my setup:\r\n```\r\nvirtualenv venv1\r\nsource venv1/bin/activate\r\npip install keras_applications==1.0.4\r\ndeactivate\r\n\r\nvirtualenv venv\r\nsource venv/bin/activate\r\npip install --upgrade setuptools==39.1.0\r\npip install keras_preprocessing==1.0.2\r\npip install --upgrade six mock portpicker scipy sklearn grpcio\r\npip install numpy==1.14.5\r\npip uninstall keras_applications\r\n\r\ngit clone https://github.com/tensorflow/tensorflow.git\r\ncd tensorflow/\r\nexport TF_NEED_CUDA=0\r\nyes \"\" | python configure.py\r\n```\r\n"}