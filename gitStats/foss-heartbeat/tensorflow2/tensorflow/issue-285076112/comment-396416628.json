{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/396416628", "html_url": "https://github.com/tensorflow/tensorflow/issues/15717#issuecomment-396416628", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15717", "id": 396416628, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjQxNjYyOA==", "user": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-11T23:19:08Z", "updated_at": "2018-06-11T23:19:08Z", "author_association": "MEMBER", "body_html": "<p>Whenever you run a session with a new combination of fetches for the first time, there is a lot of extra work in initializing data structures and optimizing the graph. Also, IIRC, you are correct in that the constant is retransferred from the CPU to the GPU for every new combination of fetches (although that may have been fixed by now).</p>\n<p>So, when timing a session.run call, make sure you previously ran with the exact same fetches. That is why your problem went away when running <code>s.run((_mul_const_a.op))</code> and <code>s.run((_mul_random_a.op))</code> as two separate session.run() calls, but you still had the problem when running those two ops as part of a single call.</p>", "body_text": "Whenever you run a session with a new combination of fetches for the first time, there is a lot of extra work in initializing data structures and optimizing the graph. Also, IIRC, you are correct in that the constant is retransferred from the CPU to the GPU for every new combination of fetches (although that may have been fixed by now).\nSo, when timing a session.run call, make sure you previously ran with the exact same fetches. That is why your problem went away when running s.run((_mul_const_a.op)) and s.run((_mul_random_a.op)) as two separate session.run() calls, but you still had the problem when running those two ops as part of a single call.", "body": "Whenever you run a session with a new combination of fetches for the first time, there is a lot of extra work in initializing data structures and optimizing the graph. Also, IIRC, you are correct in that the constant is retransferred from the CPU to the GPU for every new combination of fetches (although that may have been fixed by now).\r\n\r\nSo, when timing a session.run call, make sure you previously ran with the exact same fetches. That is why your problem went away when running `s.run((_mul_const_a.op))` and `s.run((_mul_random_a.op))` as two separate session.run() calls, but you still had the problem when running those two ops as part of a single call."}