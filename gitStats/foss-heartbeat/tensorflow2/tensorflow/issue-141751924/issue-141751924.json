{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1538", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1538/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1538/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1538/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1538", "id": 141751924, "node_id": "MDU6SXNzdWUxNDE3NTE5MjQ=", "number": 1538, "title": "Why does one graph affects the cost of the other graph althongh the two graphs do not have any relationship?", "user": {"login": "MisayaZ", "id": 16910475, "node_id": "MDQ6VXNlcjE2OTEwNDc1", "avatar_url": "https://avatars2.githubusercontent.com/u/16910475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MisayaZ", "html_url": "https://github.com/MisayaZ", "followers_url": "https://api.github.com/users/MisayaZ/followers", "following_url": "https://api.github.com/users/MisayaZ/following{/other_user}", "gists_url": "https://api.github.com/users/MisayaZ/gists{/gist_id}", "starred_url": "https://api.github.com/users/MisayaZ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MisayaZ/subscriptions", "organizations_url": "https://api.github.com/users/MisayaZ/orgs", "repos_url": "https://api.github.com/users/MisayaZ/repos", "events_url": "https://api.github.com/users/MisayaZ/events{/privacy}", "received_events_url": "https://api.github.com/users/MisayaZ/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-03-18T01:50:53Z", "updated_at": "2016-05-16T18:26:52Z", "closed_at": "2016-05-16T18:26:52Z", "author_association": "NONE", "body_html": "<p>I have got a strange problem, the first code is as below:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">with</span> tf.device(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/gpu:0<span class=\"pl-pds\">'</span></span>):\n    local3_value <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>local3.npy<span class=\"pl-pds\">\"</span></span>)\n    weights4 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>weights4.npy<span class=\"pl-pds\">\"</span></span>)\n    biases4 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>biases4.npy<span class=\"pl-pds\">\"</span></span>)\n    weights3 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>weights4.npy<span class=\"pl-pds\">\"</span></span>)\n    biases3 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>biases4.npy<span class=\"pl-pds\">\"</span></span>)\n    <span class=\"pl-k\">with</span> tf.variable_scope(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>local3<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> scope:\n        local3 <span class=\"pl-k\">=</span> tf.matmul(local3_value, weights3)\n    <span class=\"pl-k\">with</span> tf.variable_scope(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>local4<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> scope:\n        local4 <span class=\"pl-k\">=</span> tf.nn.relu(tf.matmul(local3_value, weights4)<span class=\"pl-k\">+</span>biases4, <span class=\"pl-v\">name</span> <span class=\"pl-k\">=</span> scope.name)\n\n    <span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>tf.ConfigProto(<span class=\"pl-v\">log_device_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>))<span class=\"pl-k\">as</span> sess:\n        sess.run(local3)\n        start_time  <span class=\"pl-k\">=</span> time.time()\n        predictions <span class=\"pl-k\">=</span> sess.run(local4)\n        duration <span class=\"pl-k\">=</span> time.time() <span class=\"pl-k\">-</span> start_time\n    <span class=\"pl-c1\">print</span>(duration)</pre></div>\n<p>The duration is 0.244572162628</p>\n<p>The second code is as below:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">with</span> tf.device(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/gpu:0<span class=\"pl-pds\">'</span></span>):\n    local3_value <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>local3.npy<span class=\"pl-pds\">\"</span></span>)\n    weights4 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>weights4.npy<span class=\"pl-pds\">\"</span></span>)\n    biases4 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>biases4.npy<span class=\"pl-pds\">\"</span></span>)\n    weights3 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>weights4.npy<span class=\"pl-pds\">\"</span></span>)\n    biases3 <span class=\"pl-k\">=</span> np.load(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>biases4.npy<span class=\"pl-pds\">\"</span></span>)\n    <span class=\"pl-k\">with</span> tf.variable_scope(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>local3<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> scope:\n        local3 <span class=\"pl-k\">=</span> tf.nn.softplus(weights3)\n    <span class=\"pl-k\">with</span> tf.variable_scope(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>local4<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> scope:\n        local4 <span class=\"pl-k\">=</span> tf.nn.relu(tf.matmul(local3_value, weights4)<span class=\"pl-k\">+</span>biases4, <span class=\"pl-v\">name</span> <span class=\"pl-k\">=</span> scope.name)\n\n\n    <span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>tf.ConfigProto(<span class=\"pl-v\">log_device_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>))<span class=\"pl-k\">as</span> sess:\n        sess.run(local3)\n        start_time  <span class=\"pl-k\">=</span> time.time()\n        predictions <span class=\"pl-k\">=</span> sess.run(local4)\n        duration <span class=\"pl-k\">=</span> time.time() <span class=\"pl-k\">-</span> start_time\n        <span class=\"pl-c1\">print</span>(duration)</pre></div>\n<p>The duration is 0.0679910182953</p>\n<p>The only difference between these two codes is the local3 layer. Why the graph of local3 affects the cost of graph of loca4? These two graphs do not have any relationship.</p>", "body_text": "I have got a strange problem, the first code is as below:\nwith tf.device('/gpu:0'):\n    local3_value = np.load(\"local3.npy\")\n    weights4 = np.load(\"weights4.npy\")\n    biases4 = np.load(\"biases4.npy\")\n    weights3 = np.load(\"weights4.npy\")\n    biases3 = np.load(\"biases4.npy\")\n    with tf.variable_scope('local3') as scope:\n        local3 = tf.matmul(local3_value, weights3)\n    with tf.variable_scope('local4') as scope:\n        local4 = tf.nn.relu(tf.matmul(local3_value, weights4)+biases4, name = scope.name)\n\n    with tf.Session(config=tf.ConfigProto(log_device_placement=True))as sess:\n        sess.run(local3)\n        start_time  = time.time()\n        predictions = sess.run(local4)\n        duration = time.time() - start_time\n    print(duration)\nThe duration is 0.244572162628\nThe second code is as below:\nwith tf.device('/gpu:0'):\n    local3_value = np.load(\"local3.npy\")\n    weights4 = np.load(\"weights4.npy\")\n    biases4 = np.load(\"biases4.npy\")\n    weights3 = np.load(\"weights4.npy\")\n    biases3 = np.load(\"biases4.npy\")\n    with tf.variable_scope('local3') as scope:\n        local3 = tf.nn.softplus(weights3)\n    with tf.variable_scope('local4') as scope:\n        local4 = tf.nn.relu(tf.matmul(local3_value, weights4)+biases4, name = scope.name)\n\n\n    with tf.Session(config=tf.ConfigProto(log_device_placement=True))as sess:\n        sess.run(local3)\n        start_time  = time.time()\n        predictions = sess.run(local4)\n        duration = time.time() - start_time\n        print(duration)\nThe duration is 0.0679910182953\nThe only difference between these two codes is the local3 layer. Why the graph of local3 affects the cost of graph of loca4? These two graphs do not have any relationship.", "body": "I have got a strange problem, the first code is as below:\n\n``` python\nwith tf.device('/gpu:0'):\n    local3_value = np.load(\"local3.npy\")\n    weights4 = np.load(\"weights4.npy\")\n    biases4 = np.load(\"biases4.npy\")\n    weights3 = np.load(\"weights4.npy\")\n    biases3 = np.load(\"biases4.npy\")\n    with tf.variable_scope('local3') as scope:\n        local3 = tf.matmul(local3_value, weights3)\n    with tf.variable_scope('local4') as scope:\n        local4 = tf.nn.relu(tf.matmul(local3_value, weights4)+biases4, name = scope.name)\n\n    with tf.Session(config=tf.ConfigProto(log_device_placement=True))as sess:\n        sess.run(local3)\n        start_time  = time.time()\n        predictions = sess.run(local4)\n        duration = time.time() - start_time\n    print(duration)\n```\n\nThe duration is 0.244572162628\n\nThe second code is as below:\n\n``` python\nwith tf.device('/gpu:0'):\n    local3_value = np.load(\"local3.npy\")\n    weights4 = np.load(\"weights4.npy\")\n    biases4 = np.load(\"biases4.npy\")\n    weights3 = np.load(\"weights4.npy\")\n    biases3 = np.load(\"biases4.npy\")\n    with tf.variable_scope('local3') as scope:\n        local3 = tf.nn.softplus(weights3)\n    with tf.variable_scope('local4') as scope:\n        local4 = tf.nn.relu(tf.matmul(local3_value, weights4)+biases4, name = scope.name)\n\n\n    with tf.Session(config=tf.ConfigProto(log_device_placement=True))as sess:\n        sess.run(local3)\n        start_time  = time.time()\n        predictions = sess.run(local4)\n        duration = time.time() - start_time\n        print(duration)\n```\n\nThe duration is 0.0679910182953\n\nThe only difference between these two codes is the local3 layer. Why the graph of local3 affects the cost of graph of loca4? These two graphs do not have any relationship.\n"}