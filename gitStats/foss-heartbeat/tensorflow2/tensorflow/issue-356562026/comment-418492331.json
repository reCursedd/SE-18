{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/418492331", "html_url": "https://github.com/tensorflow/tensorflow/issues/22033#issuecomment-418492331", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22033", "id": 418492331, "node_id": "MDEyOklzc3VlQ29tbWVudDQxODQ5MjMzMQ==", "user": {"login": "ChrisSwinchatt", "id": 1572288, "node_id": "MDQ6VXNlcjE1NzIyODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1572288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisSwinchatt", "html_url": "https://github.com/ChrisSwinchatt", "followers_url": "https://api.github.com/users/ChrisSwinchatt/followers", "following_url": "https://api.github.com/users/ChrisSwinchatt/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisSwinchatt/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisSwinchatt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisSwinchatt/subscriptions", "organizations_url": "https://api.github.com/users/ChrisSwinchatt/orgs", "repos_url": "https://api.github.com/users/ChrisSwinchatt/repos", "events_url": "https://api.github.com/users/ChrisSwinchatt/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisSwinchatt/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-04T19:39:13Z", "updated_at": "2018-09-04T19:40:17Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=29100818\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/omalleyt12\">@omalleyt12</a></p>\n<p>I did, please take a look at my Gist: <a href=\"https://gist.github.com/ChrisSwinchatt/97304761e9f875dfd34e3339891a5475\">https://gist.github.com/ChrisSwinchatt/97304761e9f875dfd34e3339891a5475</a></p>\n<p>The bug is not triggered if you add:</p>\n<div class=\"highlight highlight-source-python\"><pre>    <span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>tf.ConfigProto(<span class=\"pl-v\">device_count</span><span class=\"pl-k\">=</span>{<span class=\"pl-s\"><span class=\"pl-pds\">'</span>GPU<span class=\"pl-pds\">'</span></span>:<span class=\"pl-c1\">0</span>})) <span class=\"pl-k\">as</span> session:\n        K.set_session(session)\n        <span class=\"pl-c\"><span class=\"pl-c\">#</span> ...</span></pre></div>\n<p>Which is what leads me to believe this is a TensorFlow-GPU (or one of its client libs) problem.</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3474655\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/bignamehyp\">@bignamehyp</a><br>\nI think I did include all the (relevant) information in the issue template. I'm not in need of support because I have found that training on CPU alleviates the problem. I just think it's something you should be aware of in case there is a bug in TensorFlow. Of course, it's possible it's actually a bug in CUDA, CUDNN, the drivers, Windows, etc. or even my hardware, but just in case.</p>\n<p><strong>The bug is that when training on GPU and creating a second (or third, or fourth, or <em>N</em>th) model, its accuracy on the first batch/epoch will be either ~0% or ~70% and never really improve.</strong> The first model works as expected but this obviously isn't good for model selection/cross validation where we're obliged to make several models.</p>\n<p>Please let me know if any other information will help you.</p>", "body_text": "@omalleyt12\nI did, please take a look at my Gist: https://gist.github.com/ChrisSwinchatt/97304761e9f875dfd34e3339891a5475\nThe bug is not triggered if you add:\n    with tf.Session(config=tf.ConfigProto(device_count={'GPU':0})) as session:\n        K.set_session(session)\n        # ...\nWhich is what leads me to believe this is a TensorFlow-GPU (or one of its client libs) problem.\n@bignamehyp\nI think I did include all the (relevant) information in the issue template. I'm not in need of support because I have found that training on CPU alleviates the problem. I just think it's something you should be aware of in case there is a bug in TensorFlow. Of course, it's possible it's actually a bug in CUDA, CUDNN, the drivers, Windows, etc. or even my hardware, but just in case.\nThe bug is that when training on GPU and creating a second (or third, or fourth, or Nth) model, its accuracy on the first batch/epoch will be either ~0% or ~70% and never really improve. The first model works as expected but this obviously isn't good for model selection/cross validation where we're obliged to make several models.\nPlease let me know if any other information will help you.", "body": "@omalleyt12 \r\n\r\nI did, please take a look at my Gist: https://gist.github.com/ChrisSwinchatt/97304761e9f875dfd34e3339891a5475\r\n\r\nThe bug is not triggered if you add:\r\n```python\r\n    with tf.Session(config=tf.ConfigProto(device_count={'GPU':0})) as session:\r\n        K.set_session(session)\r\n        # ...\r\n```\r\n\r\nWhich is what leads me to believe this is a TensorFlow-GPU (or one of its client libs) problem.\r\n\r\n@bignamehyp \r\nI think I did include all the (relevant) information in the issue template. I'm not in need of support because I have found that training on CPU alleviates the problem. I just think it's something you should be aware of in case there is a bug in TensorFlow. Of course, it's possible it's actually a bug in CUDA, CUDNN, the drivers, Windows, etc. or even my hardware, but just in case.\r\n\r\n**The bug is that when training on GPU and creating a second (or third, or fourth, or *N*th) model, its accuracy on the first batch/epoch will be either ~0% or ~70% and never really improve.** The first model works as expected but this obviously isn't good for model selection/cross validation where we're obliged to make several models.\r\n\r\nPlease let me know if any other information will help you."}