{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/379912890", "html_url": "https://github.com/tensorflow/tensorflow/issues/8904#issuecomment-379912890", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8904", "id": 379912890, "node_id": "MDEyOklzc3VlQ29tbWVudDM3OTkxMjg5MA==", "user": {"login": "petrosmol", "id": 22332205, "node_id": "MDQ6VXNlcjIyMzMyMjA1", "avatar_url": "https://avatars0.githubusercontent.com/u/22332205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrosmol", "html_url": "https://github.com/petrosmol", "followers_url": "https://api.github.com/users/petrosmol/followers", "following_url": "https://api.github.com/users/petrosmol/following{/other_user}", "gists_url": "https://api.github.com/users/petrosmol/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrosmol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrosmol/subscriptions", "organizations_url": "https://api.github.com/users/petrosmol/orgs", "repos_url": "https://api.github.com/users/petrosmol/repos", "events_url": "https://api.github.com/users/petrosmol/events{/privacy}", "received_events_url": "https://api.github.com/users/petrosmol/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-09T22:25:58Z", "updated_at": "2018-04-09T22:25:58Z", "author_association": "MEMBER", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15832113\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/Lidaguo\">@Lidaguo</a><br>\nHard to tell what is going on without seeing code. But both labels and logits should work with unspecified shape. For instance the following code should work:</p>\n<p>import numpy as np</p>\n<p>BATCH_SIZE = None<br>\nNUM_CLASSES = None</p>\n<p>logits_np = np.array([[1.2, -1.4, -1.0], [1.4, 1.8, 4.0], [0.5, 1.3, -1.0]])<br>\nlabels_np = np.array([0, 2, 1], dtype=np.int32)<br>\nlogits = tf.placeholder(<br>\ntf.float32, shape=(BATCH_SIZE, NUM_CLASSES), name='logits')<br>\nlabels = tf.placeholder(tf.int32, shape=[BATCH_SIZE,], name='labels')<br>\nloss = tf.contrib.kernel_methods.sparse_multiclass_hinge_loss(labels, logits)</p>\n<p>with tf.Session() as sess:<br>\nloss_eval = sess.run(loss, feed_dict={logits: logits_np, labels: labels_np})<br>\nprint(loss_eval)</p>\n<p>Initial version of kernel_methods/python/losses.py was not working with unknown shape though. This was fixed end of 2017 (see <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/2dce1ee2e37e314772467bfa150b57b8d4311598#diff-c7afce59582d7278b51608c8024bf615/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/2dce1ee2e37e314772467bfa150b57b8d4311598#diff-c7afce59582d7278b51608c8024bf615\"><tt>2dce1ee</tt>#diff-c7afce59582d7278b51608c8024bf615</a>)</p>\n<p>So, you might need to upgrade to a more recent version of tf or patch these changes locally.</p>", "body_text": "@Lidaguo\nHard to tell what is going on without seeing code. But both labels and logits should work with unspecified shape. For instance the following code should work:\nimport numpy as np\nBATCH_SIZE = None\nNUM_CLASSES = None\nlogits_np = np.array([[1.2, -1.4, -1.0], [1.4, 1.8, 4.0], [0.5, 1.3, -1.0]])\nlabels_np = np.array([0, 2, 1], dtype=np.int32)\nlogits = tf.placeholder(\ntf.float32, shape=(BATCH_SIZE, NUM_CLASSES), name='logits')\nlabels = tf.placeholder(tf.int32, shape=[BATCH_SIZE,], name='labels')\nloss = tf.contrib.kernel_methods.sparse_multiclass_hinge_loss(labels, logits)\nwith tf.Session() as sess:\nloss_eval = sess.run(loss, feed_dict={logits: logits_np, labels: labels_np})\nprint(loss_eval)\nInitial version of kernel_methods/python/losses.py was not working with unknown shape though. This was fixed end of 2017 (see 2dce1ee#diff-c7afce59582d7278b51608c8024bf615)\nSo, you might need to upgrade to a more recent version of tf or patch these changes locally.", "body": "@Lidaguo \r\nHard to tell what is going on without seeing code. But both labels and logits should work with unspecified shape. For instance the following code should work:\r\n\r\nimport numpy as np\r\n\r\nBATCH_SIZE = None\r\nNUM_CLASSES = None\r\n\r\nlogits_np = np.array([[1.2, -1.4, -1.0], [1.4, 1.8, 4.0], [0.5, 1.3, -1.0]])\r\nlabels_np = np.array([0, 2, 1], dtype=np.int32)\r\nlogits = tf.placeholder(\r\n    tf.float32, shape=(BATCH_SIZE, NUM_CLASSES), name='logits')\r\nlabels = tf.placeholder(tf.int32, shape=[BATCH_SIZE,], name='labels')\r\nloss = tf.contrib.kernel_methods.sparse_multiclass_hinge_loss(labels, logits)\r\n\r\nwith tf.Session() as sess:\r\n  loss_eval = sess.run(loss, feed_dict={logits: logits_np, labels: labels_np})\r\n  print(loss_eval)\r\n\r\nInitial version of kernel_methods/python/losses.py was not working with unknown shape though. This was fixed end of 2017 (see https://github.com/tensorflow/tensorflow/commit/2dce1ee2e37e314772467bfa150b57b8d4311598#diff-c7afce59582d7278b51608c8024bf615)\r\n\r\nSo, you might need to upgrade to a more recent version of tf or patch these changes locally."}