{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/409838706", "html_url": "https://github.com/tensorflow/tensorflow/issues/16374#issuecomment-409838706", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16374", "id": 409838706, "node_id": "MDEyOklzc3VlQ29tbWVudDQwOTgzODcwNg==", "user": {"login": "AliceDinh", "id": 20389638, "node_id": "MDQ6VXNlcjIwMzg5NjM4", "avatar_url": "https://avatars2.githubusercontent.com/u/20389638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AliceDinh", "html_url": "https://github.com/AliceDinh", "followers_url": "https://api.github.com/users/AliceDinh/followers", "following_url": "https://api.github.com/users/AliceDinh/following{/other_user}", "gists_url": "https://api.github.com/users/AliceDinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/AliceDinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AliceDinh/subscriptions", "organizations_url": "https://api.github.com/users/AliceDinh/orgs", "repos_url": "https://api.github.com/users/AliceDinh/repos", "events_url": "https://api.github.com/users/AliceDinh/events{/privacy}", "received_events_url": "https://api.github.com/users/AliceDinh/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-02T07:50:41Z", "updated_at": "2018-08-02T07:50:41Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3603839\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ushnish\">@ushnish</a> hi, I am following the instructions at:<br>\n<a href=\"https://codelabs.developers.google.com/codelabs/tensorflow-for-poets-2-tflite/#2\" rel=\"nofollow\">https://codelabs.developers.google.com/codelabs/tensorflow-for-poets-2-tflite/#2</a><br>\nFor CentOS, I have installed Bazel successfully when using your suggestions:</p>\n<pre><code>bazel build tensorflow/contrib/lite/toco:toco\nbazel-bin/tensorflow/contrib/lite/toco/toco --help\n</code></pre>\n<p>but when I run the command to convert model to TFLite:</p>\n<pre><code>IMAGE_SIZE=224\ntoco \\\n  --input_file=tf_files/retrained_graph.pb \\\n  --output_file=tf_files/optimized_graph.lite \\\n  --input_format=TENSORFLOW_GRAPHDEF \\\n  --output_format=TFLITE \\\n  --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\n  --input_array=input \\\n  --output_array=final_result \\\n  --inference_type=FLOAT \\\n  --input_data_type=FLOAT\n</code></pre>\n<p>I got error:</p>\n<pre><code>[nhandt@dev-bigdata02 tensorflow]$ toco \\\n&gt;   --input_file=retrained_graph.pb \\\n&gt;   --output_file=optimized_graph.lite \\\n&gt;   --input_format=TENSORFLOW_GRAPHDEF \\\n&gt;   --output_format=TFLITE \\\n&gt;   --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\n&gt;   --input_array=input \\\n&gt;   --output_array=final_result \\\n&gt;   --inference_type=FLOAT \\\n&gt;   --input_data_type=FLOAT\n/home/nhandt/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\nTOCO from pip install is currently not working on command line.\nPlease use the python TOCO API or use\nbazel run tensorflow/contrib/lite:toco -- &lt;args&gt; from a TensorFlow source dir.\n</code></pre>\n<p>Then I changed to run toco from source dir:</p>\n<pre><code>[nhandt@dev-bigdata02 tensorflow]$ IMAGE_SIZE=224\n[nhandt@dev-bigdata02 tensorflow]$ bazel run tensorflow/contrib/lite:toco \\\n&gt;   --input_file=retrained_graph.pb \\\n&gt;   --output_file=optimized_graph.lite \\\n&gt;   --input_format=TENSORFLOW_GRAPHDEF \\\n&gt;   --output_format=TFLITE \\\n&gt;   --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\n&gt;   --input_array=input \\\n&gt;   --output_array=final_result \\\n&gt;   --inference_type=FLOAT \\\n&gt;   --input_data_type=FLOAT\n</code></pre>\n<p><strong>ERROR: Unrecognized option: --input_file=retrained_graph.pb</strong><br>\nretrained_graph.pb is under tensorflow directory: tensorflow/retrained_graph.pb<br>\nPlease advise me how to run this script with toco. Thanks</p>", "body_text": "@ushnish hi, I am following the instructions at:\nhttps://codelabs.developers.google.com/codelabs/tensorflow-for-poets-2-tflite/#2\nFor CentOS, I have installed Bazel successfully when using your suggestions:\nbazel build tensorflow/contrib/lite/toco:toco\nbazel-bin/tensorflow/contrib/lite/toco/toco --help\n\nbut when I run the command to convert model to TFLite:\nIMAGE_SIZE=224\ntoco \\\n  --input_file=tf_files/retrained_graph.pb \\\n  --output_file=tf_files/optimized_graph.lite \\\n  --input_format=TENSORFLOW_GRAPHDEF \\\n  --output_format=TFLITE \\\n  --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\n  --input_array=input \\\n  --output_array=final_result \\\n  --inference_type=FLOAT \\\n  --input_data_type=FLOAT\n\nI got error:\n[nhandt@dev-bigdata02 tensorflow]$ toco \\\n>   --input_file=retrained_graph.pb \\\n>   --output_file=optimized_graph.lite \\\n>   --input_format=TENSORFLOW_GRAPHDEF \\\n>   --output_format=TFLITE \\\n>   --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\n>   --input_array=input \\\n>   --output_array=final_result \\\n>   --inference_type=FLOAT \\\n>   --input_data_type=FLOAT\n/home/nhandt/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\nTOCO from pip install is currently not working on command line.\nPlease use the python TOCO API or use\nbazel run tensorflow/contrib/lite:toco -- <args> from a TensorFlow source dir.\n\nThen I changed to run toco from source dir:\n[nhandt@dev-bigdata02 tensorflow]$ IMAGE_SIZE=224\n[nhandt@dev-bigdata02 tensorflow]$ bazel run tensorflow/contrib/lite:toco \\\n>   --input_file=retrained_graph.pb \\\n>   --output_file=optimized_graph.lite \\\n>   --input_format=TENSORFLOW_GRAPHDEF \\\n>   --output_format=TFLITE \\\n>   --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\n>   --input_array=input \\\n>   --output_array=final_result \\\n>   --inference_type=FLOAT \\\n>   --input_data_type=FLOAT\n\nERROR: Unrecognized option: --input_file=retrained_graph.pb\nretrained_graph.pb is under tensorflow directory: tensorflow/retrained_graph.pb\nPlease advise me how to run this script with toco. Thanks", "body": "@ushnish hi, I am following the instructions at:\r\nhttps://codelabs.developers.google.com/codelabs/tensorflow-for-poets-2-tflite/#2\r\nFor CentOS, I have installed Bazel successfully when using your suggestions:\r\n```\r\nbazel build tensorflow/contrib/lite/toco:toco\r\nbazel-bin/tensorflow/contrib/lite/toco/toco --help\r\n```\r\nbut when I run the command to convert model to TFLite:\r\n```\r\nIMAGE_SIZE=224\r\ntoco \\\r\n  --input_file=tf_files/retrained_graph.pb \\\r\n  --output_file=tf_files/optimized_graph.lite \\\r\n  --input_format=TENSORFLOW_GRAPHDEF \\\r\n  --output_format=TFLITE \\\r\n  --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\r\n  --input_array=input \\\r\n  --output_array=final_result \\\r\n  --inference_type=FLOAT \\\r\n  --input_data_type=FLOAT\r\n```\r\nI got error: \r\n\r\n```\r\n[nhandt@dev-bigdata02 tensorflow]$ toco \\\r\n>   --input_file=retrained_graph.pb \\\r\n>   --output_file=optimized_graph.lite \\\r\n>   --input_format=TENSORFLOW_GRAPHDEF \\\r\n>   --output_format=TFLITE \\\r\n>   --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\r\n>   --input_array=input \\\r\n>   --output_array=final_result \\\r\n>   --inference_type=FLOAT \\\r\n>   --input_data_type=FLOAT\r\n/home/nhandt/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\nTOCO from pip install is currently not working on command line.\r\nPlease use the python TOCO API or use\r\nbazel run tensorflow/contrib/lite:toco -- <args> from a TensorFlow source dir.\r\n```\r\nThen I changed to run toco from source dir:\r\n\r\n```\r\n[nhandt@dev-bigdata02 tensorflow]$ IMAGE_SIZE=224\r\n[nhandt@dev-bigdata02 tensorflow]$ bazel run tensorflow/contrib/lite:toco \\\r\n>   --input_file=retrained_graph.pb \\\r\n>   --output_file=optimized_graph.lite \\\r\n>   --input_format=TENSORFLOW_GRAPHDEF \\\r\n>   --output_format=TFLITE \\\r\n>   --input_shape=1,${IMAGE_SIZE},${IMAGE_SIZE},3 \\\r\n>   --input_array=input \\\r\n>   --output_array=final_result \\\r\n>   --inference_type=FLOAT \\\r\n>   --input_data_type=FLOAT\r\n```\r\n**ERROR: Unrecognized option: --input_file=retrained_graph.pb**\r\nretrained_graph.pb is under tensorflow directory: tensorflow/retrained_graph.pb\r\nPlease advise me how to run this script with toco. Thanks\r\n"}