{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12080", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12080/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12080/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12080/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12080", "id": 248415623, "node_id": "MDU6SXNzdWUyNDg0MTU2MjM=", "number": 12080, "title": "distribute tensorflow programe failed when increase worker number", "user": {"login": "chengdianxuezi", "id": 10277403, "node_id": "MDQ6VXNlcjEwMjc3NDAz", "avatar_url": "https://avatars1.githubusercontent.com/u/10277403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chengdianxuezi", "html_url": "https://github.com/chengdianxuezi", "followers_url": "https://api.github.com/users/chengdianxuezi/followers", "following_url": "https://api.github.com/users/chengdianxuezi/following{/other_user}", "gists_url": "https://api.github.com/users/chengdianxuezi/gists{/gist_id}", "starred_url": "https://api.github.com/users/chengdianxuezi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chengdianxuezi/subscriptions", "organizations_url": "https://api.github.com/users/chengdianxuezi/orgs", "repos_url": "https://api.github.com/users/chengdianxuezi/repos", "events_url": "https://api.github.com/users/chengdianxuezi/events{/privacy}", "received_events_url": "https://api.github.com/users/chengdianxuezi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-08-07T13:42:02Z", "updated_at": "2017-11-14T20:17:32Z", "closed_at": "2017-11-14T20:16:58Z", "author_association": "NONE", "body_html": "<p>I run a distribute tensorflow programe with 5 ps and 20 workers. It work normal\u3002<br>\nwhen I increase the worker number to 50, the programe fail. the error log as follow.<br>\nI don't know how to debug this problem</p>\n<p>2017-08-07 03:51:42.191472: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077902.191300911\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}<br>\n2017-08-07 03:51:42.735190: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077902.735079403\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}<br>\n2017-08-07 03:51:43.224557: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077903.224418940\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}<br>\n2017-08-07 03:51:43.630253: I tensorflow/core/distributed_runtime/master.cc:203] CreateSession still waiting for response from worker: /job:ps/replica:0/task:1<br>\n2017-08-07 03:51:43.630305: I tensorflow/core/distributed_runtime/master.cc:203] CreateSession still waiting for response from worker: /job:ps/replica:0/task:4<br>\n2017-08-07 03:51:45.901058: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077905.900893611\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}<br>\n2017-08-07 03:51:49.926346: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077909.926169663\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}<br>\nTraceback (most recent call last):<br>\nFile \"/home/xiangqin.oxq/tensorflow/train_ps.py\", line 117, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"/home/xiangqin.oxq/tensorflow/train_ps.py\", line 106, in main<br>\nwith sv.prepare_or_wait_for_session(server.target, config=sess_config, max_wait_secs=600) as sess:<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 714, in prepare_or_wait_for_session<br>\nmax_wait_secs=max_wait_secs)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 384, in wait_for_session<br>\nsess)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 467, in _try_run_local_init_op<br>\nsess.run(self._local_init_op)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 786, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 994, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1044, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1064, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1502077902.191300911\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}</p>", "body_text": "I run a distribute tensorflow programe with 5 ps and 20 workers. It work normal\u3002\nwhen I increase the worker number to 50, the programe fail. the error log as follow.\nI don't know how to debug this problem\n2017-08-07 03:51:42.191472: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077902.191300911\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\n2017-08-07 03:51:42.735190: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077902.735079403\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\n2017-08-07 03:51:43.224557: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077903.224418940\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\n2017-08-07 03:51:43.630253: I tensorflow/core/distributed_runtime/master.cc:203] CreateSession still waiting for response from worker: /job:ps/replica:0/task:1\n2017-08-07 03:51:43.630305: I tensorflow/core/distributed_runtime/master.cc:203] CreateSession still waiting for response from worker: /job:ps/replica:0/task:4\n2017-08-07 03:51:45.901058: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077905.900893611\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\n2017-08-07 03:51:49.926346: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077909.926169663\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\nTraceback (most recent call last):\nFile \"/home/xiangqin.oxq/tensorflow/train_ps.py\", line 117, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"/home/xiangqin.oxq/tensorflow/train_ps.py\", line 106, in main\nwith sv.prepare_or_wait_for_session(server.target, config=sess_config, max_wait_secs=600) as sess:\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 714, in prepare_or_wait_for_session\nmax_wait_secs=max_wait_secs)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 384, in wait_for_session\nsess)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 467, in _try_run_local_init_op\nsess.run(self._local_init_op)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 786, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 994, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1044, in _do_run\ntarget_list, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1064, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1502077902.191300911\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}", "body": "I run a distribute tensorflow programe with 5 ps and 20 workers. It work normal\u3002\r\nwhen I increase the worker number to 50, the programe fail. the error log as follow. \r\nI don't know how to debug this problem\r\n\r\n2017-08-07 03:51:42.191472: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077902.191300911\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\r\n2017-08-07 03:51:42.735190: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077902.735079403\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\r\n2017-08-07 03:51:43.224557: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077903.224418940\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\r\n2017-08-07 03:51:43.630253: I tensorflow/core/distributed_runtime/master.cc:203] CreateSession still waiting for response from worker: /job:ps/replica:0/task:1\r\n2017-08-07 03:51:43.630305: I tensorflow/core/distributed_runtime/master.cc:203] CreateSession still waiting for response from worker: /job:ps/replica:0/task:4\r\n2017-08-07 03:51:45.901058: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077905.900893611\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\r\n2017-08-07 03:51:49.926346: E tensorflow/core/distributed_runtime/master.cc:251] Master init: Unavailable: {\"created\":\"@1502077909.926169663\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\r\nTraceback (most recent call last):\r\nFile \"/home/xiangqin.oxq/tensorflow/train_ps.py\", line 117, in <module>\r\ntf.app.run()\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\nFile \"/home/xiangqin.oxq/tensorflow/train_ps.py\", line 106, in main\r\nwith sv.prepare_or_wait_for_session(server.target, config=sess_config, max_wait_secs=600) as sess:\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 714, in prepare_or_wait_for_session\r\nmax_wait_secs=max_wait_secs)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 384, in wait_for_session\r\nsess)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 467, in _try_run_local_init_op\r\nsess.run(self._local_init_op)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 786, in run\r\nrun_metadata_ptr)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 994, in _run\r\nfeed_dict_string, options, run_metadata)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1044, in _do_run\r\ntarget_list, options, run_metadata)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1064, in _do_call\r\nraise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnavailableError: {\"created\":\"@1502077902.191300911\",\"description\":\"OS Error\",\"errno\":104,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_posix.c\",\"file_line\":229,\"grpc_status\":14,\"os_error\":\"Connection reset by peer\",\"syscall\":\"recvmsg\"}\r\n"}