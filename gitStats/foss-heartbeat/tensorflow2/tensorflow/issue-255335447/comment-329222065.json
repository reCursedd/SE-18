{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/329222065", "html_url": "https://github.com/tensorflow/tensorflow/issues/12824#issuecomment-329222065", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12824", "id": 329222065, "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTIyMjA2NQ==", "user": {"login": "jamiebaggott", "id": 12777748, "node_id": "MDQ6VXNlcjEyNzc3NzQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/12777748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamiebaggott", "html_url": "https://github.com/jamiebaggott", "followers_url": "https://api.github.com/users/jamiebaggott/followers", "following_url": "https://api.github.com/users/jamiebaggott/following{/other_user}", "gists_url": "https://api.github.com/users/jamiebaggott/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamiebaggott/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamiebaggott/subscriptions", "organizations_url": "https://api.github.com/users/jamiebaggott/orgs", "repos_url": "https://api.github.com/users/jamiebaggott/repos", "events_url": "https://api.github.com/users/jamiebaggott/events{/privacy}", "received_events_url": "https://api.github.com/users/jamiebaggott/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-13T16:25:25Z", "updated_at": "2017-09-13T16:25:25Z", "author_association": "NONE", "body_html": "<p>This may not be a smaller sample of code, but they are individual files that can be run, although you may need to run them a number of times as the errors aren't produced every time.</p>\n<p>In the below gist, there is a file named <code>image.go</code> and <code>image2.go</code>; these files are the same apart from the fact that <code>image</code> shares <code>tfSession</code> between 10 workers, whereas <code>image2</code> creates a new session for each worker. Due to that, the memory used when running <code>image</code> is ~750MB, whereas for <code>image2</code> it is ~5GB.</p>\n<p>To run these files, they need to be in a directory where there is an image named <code>image.png</code>, and where the pre-trained InceptionV3 model is in a directory named <code>inception3</code>. This can be found gzipped here: <a href=\"https://storage.googleapis.com/download.tensorflow.org/models/inception_v3_2016_08_28_frozen.pb.tar.gz\" rel=\"nofollow\">https://storage.googleapis.com/download.tensorflow.org/models/inception_v3_2016_08_28_frozen.pb.tar.gz</a></p>\n<p>The log files with 2 in their name correspond to <code>image2</code>, and those that do not correspond to <code>image</code>. <code>tf_error.log</code> and <code>tf_error2.log</code> are errors that are caused by running <code>tfSession</code> in the <code>ImageWorker</code> function, whereas <code>tf_error_alt.log</code> and <code>tf_error2_alt.log</code> are errors that are caused by creating or running the session in the <code>MakeTensorFromImage</code> function.</p>\n<p><a href=\"https://gist.github.com/jamiebaggott/f540c2fbeadd89219127a8e0669bd462\">https://gist.github.com/jamiebaggott/f540c2fbeadd89219127a8e0669bd462</a></p>\n<p>If you require any more information, please let me know.</p>", "body_text": "This may not be a smaller sample of code, but they are individual files that can be run, although you may need to run them a number of times as the errors aren't produced every time.\nIn the below gist, there is a file named image.go and image2.go; these files are the same apart from the fact that image shares tfSession between 10 workers, whereas image2 creates a new session for each worker. Due to that, the memory used when running image is ~750MB, whereas for image2 it is ~5GB.\nTo run these files, they need to be in a directory where there is an image named image.png, and where the pre-trained InceptionV3 model is in a directory named inception3. This can be found gzipped here: https://storage.googleapis.com/download.tensorflow.org/models/inception_v3_2016_08_28_frozen.pb.tar.gz\nThe log files with 2 in their name correspond to image2, and those that do not correspond to image. tf_error.log and tf_error2.log are errors that are caused by running tfSession in the ImageWorker function, whereas tf_error_alt.log and tf_error2_alt.log are errors that are caused by creating or running the session in the MakeTensorFromImage function.\nhttps://gist.github.com/jamiebaggott/f540c2fbeadd89219127a8e0669bd462\nIf you require any more information, please let me know.", "body": "This may not be a smaller sample of code, but they are individual files that can be run, although you may need to run them a number of times as the errors aren't produced every time.\r\n\r\nIn the below gist, there is a file named `image.go` and `image2.go`; these files are the same apart from the fact that `image` shares `tfSession` between 10 workers, whereas `image2` creates a new session for each worker. Due to that, the memory used when running `image` is ~750MB, whereas for `image2` it is ~5GB.\r\n\r\nTo run these files, they need to be in a directory where there is an image named `image.png`, and where the pre-trained InceptionV3 model is in a directory named `inception3`. This can be found gzipped here: https://storage.googleapis.com/download.tensorflow.org/models/inception_v3_2016_08_28_frozen.pb.tar.gz\r\n\r\nThe log files with 2 in their name correspond to `image2`, and those that do not correspond to `image`. `tf_error.log` and `tf_error2.log` are errors that are caused by running `tfSession` in the `ImageWorker` function, whereas `tf_error_alt.log` and `tf_error2_alt.log` are errors that are caused by creating or running the session in the `MakeTensorFromImage` function.\r\n\r\nhttps://gist.github.com/jamiebaggott/f540c2fbeadd89219127a8e0669bd462\r\n\r\nIf you require any more information, please let me know."}