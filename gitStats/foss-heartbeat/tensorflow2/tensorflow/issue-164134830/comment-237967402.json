{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/237967402", "html_url": "https://github.com/tensorflow/tensorflow/issues/3208#issuecomment-237967402", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3208", "id": 237967402, "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzk2NzQwMg==", "user": {"login": "hendrycks", "id": 11670606, "node_id": "MDQ6VXNlcjExNjcwNjA2", "avatar_url": "https://avatars3.githubusercontent.com/u/11670606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hendrycks", "html_url": "https://github.com/hendrycks", "followers_url": "https://api.github.com/users/hendrycks/followers", "following_url": "https://api.github.com/users/hendrycks/following{/other_user}", "gists_url": "https://api.github.com/users/hendrycks/gists{/gist_id}", "starred_url": "https://api.github.com/users/hendrycks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hendrycks/subscriptions", "organizations_url": "https://api.github.com/users/hendrycks/orgs", "repos_url": "https://api.github.com/users/hendrycks/repos", "events_url": "https://api.github.com/users/hendrycks/events{/privacy}", "received_events_url": "https://api.github.com/users/hendrycks/received_events", "type": "User", "site_admin": false}, "created_at": "2016-08-05T21:12:30Z", "updated_at": "2016-08-05T21:14:03Z", "author_association": "NONE", "body_html": "<p>I get a similar error when I have a map_fn modifying a variable, and the map_fn is inside of a cond, but this may not be informative if map_fn uses while (I haven't checked).</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 454, in apply_op\n    as_ref=input_arg.is_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 180, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 163, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 346, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")\nValueError: None values not supported.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"cifar10_shallow.py\", line 161, in &lt;module&gt;\n    optimizer = tf.train.AdamOptimizer(learning_rate=lr).minimize(loss, global_step=global_step)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/training/optimizer.py\", line 193, in minimize\n    grad_loss=grad_loss)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/training/optimizer.py\", line 250, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gradients.py\", line 484, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/tensor_array_grad.py\", line 115, in _TensorArrayWriteGrad\n    grad = g.read(index)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/tensor_array_ops.py\", line 191, in read\n    dtype=self._dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 1344, in _tensor_array_read\n    flow_in=flow_in, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2298, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1236, in __init__\n    self._control_flow_context.AddOp(self)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1493, in AddOp\n    self._AddOpInternal(op)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1513, in _AddOpInternal\n    self.AddValue(x)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1452, in AddValue\n    real_val = grad_ctxt.grad_state.GetRealValue(val)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 788, in GetRealValue\n    real_value = self.AddBackPropAccumulatedValue(history_value, value)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 737, in AddBackPropAccumulatedValue\n    history_value = _SwitchRefOrTensor(history_value, pred)[branch]\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 325, in _SwitchRefOrTensor\n    return ref_switch(data, pred, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_control_flow_ops.py\", line 341, in ref_switch\n    result = _op_def_lib.apply_op(\"RefSwitch\", data=data, pred=pred, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 458, in apply_op\n    as_ref=input_arg.is_ref).dtype.name\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 180, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 163, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 346, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")\n</code></pre>", "body_text": "I get a similar error when I have a map_fn modifying a variable, and the map_fn is inside of a cond, but this may not be informative if map_fn uses while (I haven't checked).\nTraceback (most recent call last):\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 454, in apply_op\n    as_ref=input_arg.is_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 180, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 163, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 346, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")\nValueError: None values not supported.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"cifar10_shallow.py\", line 161, in <module>\n    optimizer = tf.train.AdamOptimizer(learning_rate=lr).minimize(loss, global_step=global_step)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/training/optimizer.py\", line 193, in minimize\n    grad_loss=grad_loss)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/training/optimizer.py\", line 250, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gradients.py\", line 484, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/tensor_array_grad.py\", line 115, in _TensorArrayWriteGrad\n    grad = g.read(index)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/tensor_array_ops.py\", line 191, in read\n    dtype=self._dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 1344, in _tensor_array_read\n    flow_in=flow_in, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2298, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1236, in __init__\n    self._control_flow_context.AddOp(self)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1493, in AddOp\n    self._AddOpInternal(op)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1513, in _AddOpInternal\n    self.AddValue(x)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1452, in AddValue\n    real_val = grad_ctxt.grad_state.GetRealValue(val)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 788, in GetRealValue\n    real_value = self.AddBackPropAccumulatedValue(history_value, value)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 737, in AddBackPropAccumulatedValue\n    history_value = _SwitchRefOrTensor(history_value, pred)[branch]\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 325, in _SwitchRefOrTensor\n    return ref_switch(data, pred, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_control_flow_ops.py\", line 341, in ref_switch\n    result = _op_def_lib.apply_op(\"RefSwitch\", data=data, pred=pred, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 458, in apply_op\n    as_ref=input_arg.is_ref).dtype.name\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 180, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 163, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 346, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")", "body": "I get a similar error when I have a map_fn modifying a variable, and the map_fn is inside of a cond, but this may not be informative if map_fn uses while (I haven't checked).\n\n```\nTraceback (most recent call last):\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 454, in apply_op\n    as_ref=input_arg.is_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 180, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 163, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 346, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")\nValueError: None values not supported.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"cifar10_shallow.py\", line 161, in <module>\n    optimizer = tf.train.AdamOptimizer(learning_rate=lr).minimize(loss, global_step=global_step)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/training/optimizer.py\", line 193, in minimize\n    grad_loss=grad_loss)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/training/optimizer.py\", line 250, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gradients.py\", line 484, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/tensor_array_grad.py\", line 115, in _TensorArrayWriteGrad\n    grad = g.read(index)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/tensor_array_ops.py\", line 191, in read\n    dtype=self._dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 1344, in _tensor_array_read\n    flow_in=flow_in, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2298, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1236, in __init__\n    self._control_flow_context.AddOp(self)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1493, in AddOp\n    self._AddOpInternal(op)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1513, in _AddOpInternal\n    self.AddValue(x)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1452, in AddValue\n    real_val = grad_ctxt.grad_state.GetRealValue(val)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 788, in GetRealValue\n    real_value = self.AddBackPropAccumulatedValue(history_value, value)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 737, in AddBackPropAccumulatedValue\n    history_value = _SwitchRefOrTensor(history_value, pred)[branch]\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 325, in _SwitchRefOrTensor\n    return ref_switch(data, pred, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_control_flow_ops.py\", line 341, in ref_switch\n    result = _op_def_lib.apply_op(\"RefSwitch\", data=data, pred=pred, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 458, in apply_op\n    as_ref=input_arg.is_ref).dtype.name\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 180, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/constant_op.py\", line 163, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape))\n  File \"/home-nfs/dan/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/tensor_util.py\", line 346, in make_tensor_proto\n    raise ValueError(\"None values not supported.\")\n```\n"}