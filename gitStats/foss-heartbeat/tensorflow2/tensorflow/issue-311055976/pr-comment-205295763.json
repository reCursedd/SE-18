{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/205295763", "pull_request_review_id": 140539282, "id": 205295763, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTI5NTc2Mw==", "diff_hunk": "@@ -0,0 +1,126 @@\n+package(default_visibility = [\"//tensorflow:__subpackages__\"])\n+\n+licenses([\"notice\"])  # Apache 2.0\n+\n+exports_files([\"LICENSE\"])\n+\n+load(\"//tensorflow:tensorflow.bzl\", \"tf_custom_op_py_library\")\n+load(\"//tensorflow:tensorflow.bzl\", \"tf_custom_op_library\")\n+load(\"//tensorflow:tensorflow.bzl\", \"cc_header_only_library\")\n+load(\"//tensorflow:tensorflow.bzl\", \"tf_gen_op_wrapper_py\")\n+load(\"//tensorflow:tensorflow.bzl\", \"tf_gen_op_libs\")\n+\n+tf_custom_op_py_library(\n+    name = \"avro\",\n+    srcs = glob([\"python/*.py\"]),\n+    dso = [\":python/_avro_record_dataset.so\",\n+           \":python/_parse_avro_record.so\",\n+           \":python/libavro.so\"\n+    ],\n+    kernels = [\n+        \":avro_record_dataset_op_lib\",\n+        \":parse_avro_record_op_lib\",\n+    ],\n+    deps = [\n+         \":avro_record_dataset\",\n+         \":parse_avro_record\",\n+    ],\n+    srcs_version = \"PY2\",\n+    visibility = [\"//visibility:public\"],\n+)\n+\n+# Tensorflow will link to libavro.so correctly, but it will leave it an external bazel\n+# directory, which won't exist in the generated pip package. Therefore, we copy libavro.so\n+# into the same directory -- of the pip package.\n+# TODO(fraudies): Remove this copy rule;\n+genrule(", "path": "tensorflow/contrib/avro/BUILD", "position": null, "original_position": 36, "commit_id": "bdf790d5c888e59d593230286edaaf5314daaee5", "original_commit_id": "d1be9e544357e72eb37f6adb626670f745e79a9b", "user": {"login": "fraudies", "id": 1770877, "node_id": "MDQ6VXNlcjE3NzA4Nzc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1770877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fraudies", "html_url": "https://github.com/fraudies", "followers_url": "https://api.github.com/users/fraudies/followers", "following_url": "https://api.github.com/users/fraudies/following{/other_user}", "gists_url": "https://api.github.com/users/fraudies/gists{/gist_id}", "starred_url": "https://api.github.com/users/fraudies/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fraudies/subscriptions", "organizations_url": "https://api.github.com/users/fraudies/orgs", "repos_url": "https://api.github.com/users/fraudies/repos", "events_url": "https://api.github.com/users/fraudies/events{/privacy}", "received_events_url": "https://api.github.com/users/fraudies/received_events", "type": "User", "site_admin": false}, "body": "At the moment we place libavro.so alongside the python code to make sure it appears in the \".\" folder during execution; which is by default on the library path.\r\n\r\nNote: The above strategy allows us to be independent of the environment setup during execution. We don't need to assume libavro.so is present on the execution system. But libavro.so must be present on the build system.\r\n\r\n@galv Do you have any preference about leaving or deleting this copy?", "created_at": "2018-07-25T23:52:51Z", "updated_at": "2018-10-22T21:28:38Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/18224#discussion_r205295763", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/18224", "author_association": "NONE", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/205295763"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/18224#discussion_r205295763"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/18224"}}, "body_html": "<p>At the moment we place libavro.so alongside the python code to make sure it appears in the \".\" folder during execution; which is by default on the library path.</p>\n<p>Note: The above strategy allows us to be independent of the environment setup during execution. We don't need to assume libavro.so is present on the execution system. But libavro.so must be present on the build system.</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=4767568\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/galv\">@galv</a> Do you have any preference about leaving or deleting this copy?</p>", "body_text": "At the moment we place libavro.so alongside the python code to make sure it appears in the \".\" folder during execution; which is by default on the library path.\nNote: The above strategy allows us to be independent of the environment setup during execution. We don't need to assume libavro.so is present on the execution system. But libavro.so must be present on the build system.\n@galv Do you have any preference about leaving or deleting this copy?"}