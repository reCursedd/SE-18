{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5988", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5988/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5988/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5988/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5988", "id": 192629852, "node_id": "MDU6SXNzdWUxOTI2Mjk4NTI=", "number": 5988, "title": "fused_batch_norm throws ValueError for partially known 2D-Tensor", "user": {"login": "abred", "id": 1835958, "node_id": "MDQ6VXNlcjE4MzU5NTg=", "avatar_url": "https://avatars3.githubusercontent.com/u/1835958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abred", "html_url": "https://github.com/abred", "followers_url": "https://api.github.com/users/abred/followers", "following_url": "https://api.github.com/users/abred/following{/other_user}", "gists_url": "https://api.github.com/users/abred/gists{/gist_id}", "starred_url": "https://api.github.com/users/abred/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abred/subscriptions", "organizations_url": "https://api.github.com/users/abred/orgs", "repos_url": "https://api.github.com/users/abred/repos", "events_url": "https://api.github.com/users/abred/events{/privacy}", "received_events_url": "https://api.github.com/users/abred/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "zhangyaobit", "id": 1034716, "node_id": "MDQ6VXNlcjEwMzQ3MTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1034716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhangyaobit", "html_url": "https://github.com/zhangyaobit", "followers_url": "https://api.github.com/users/zhangyaobit/followers", "following_url": "https://api.github.com/users/zhangyaobit/following{/other_user}", "gists_url": "https://api.github.com/users/zhangyaobit/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhangyaobit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhangyaobit/subscriptions", "organizations_url": "https://api.github.com/users/zhangyaobit/orgs", "repos_url": "https://api.github.com/users/zhangyaobit/repos", "events_url": "https://api.github.com/users/zhangyaobit/events{/privacy}", "received_events_url": "https://api.github.com/users/zhangyaobit/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "zhangyaobit", "id": 1034716, "node_id": "MDQ6VXNlcjEwMzQ3MTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1034716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhangyaobit", "html_url": "https://github.com/zhangyaobit", "followers_url": "https://api.github.com/users/zhangyaobit/followers", "following_url": "https://api.github.com/users/zhangyaobit/following{/other_user}", "gists_url": "https://api.github.com/users/zhangyaobit/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhangyaobit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhangyaobit/subscriptions", "organizations_url": "https://api.github.com/users/zhangyaobit/orgs", "repos_url": "https://api.github.com/users/zhangyaobit/repos", "events_url": "https://api.github.com/users/zhangyaobit/events{/privacy}", "received_events_url": "https://api.github.com/users/zhangyaobit/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2016-11-30T17:32:33Z", "updated_at": "2017-03-21T03:10:14Z", "closed_at": "2017-03-21T03:10:14Z", "author_association": "NONE", "body_html": "<p>I'm trying to use the new fused_batch_norm layer (as I also have this problem <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"165262856\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3290\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3290/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3290\">#3290</a>)<br>\nUsing it for 4D Tensors works fine so far (as in: it doens't crash)<br>\nHowever, when using 2D Tensors ([None, X]) I get this error:</p>\n<blockquote>\n<p>Traceback (most recent call last):<br>\n...<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 177, in func_with_args<br>\nreturn func(*args, **current_args)<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 467, in batch_norm<br>\nscope=scope)<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 350, in _fused_batch_norm<br>\noutputs = array_ops.reshape(outputs, original_shape)<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2448, in reshape<br>\nname=name)<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 503, in apply_op<br>\nas_ref=input_arg.is_ref).dtype.name<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor<br>\nret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)<br>\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.py\", line 194, in _tensor_shape_tensor_conversion_function<br>\n\"Cannot convert a partially known TensorShape to a Tensor: %s\" % s)<br>\nValueError: Cannot convert a partially known TensorShape to a Tensor: (?, 256)</p>\n</blockquote>\n<p>Same code works for the normal batch_norm layer.<br>\nAlso works if I reshape it manually to [None, 1, 1, X] before calling fused_batch_norm</p>\n<p>Cuda 8.0, cuDNN 5.1, tf r0.12</p>", "body_text": "I'm trying to use the new fused_batch_norm layer (as I also have this problem #3290)\nUsing it for 4D Tensors works fine so far (as in: it doens't crash)\nHowever, when using 2D Tensors ([None, X]) I get this error:\n\nTraceback (most recent call last):\n...\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 177, in func_with_args\nreturn func(*args, **current_args)\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 467, in batch_norm\nscope=scope)\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 350, in _fused_batch_norm\noutputs = array_ops.reshape(outputs, original_shape)\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2448, in reshape\nname=name)\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 503, in apply_op\nas_ref=input_arg.is_ref).dtype.name\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\nret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\nFile \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.py\", line 194, in _tensor_shape_tensor_conversion_function\n\"Cannot convert a partially known TensorShape to a Tensor: %s\" % s)\nValueError: Cannot convert a partially known TensorShape to a Tensor: (?, 256)\n\nSame code works for the normal batch_norm layer.\nAlso works if I reshape it manually to [None, 1, 1, X] before calling fused_batch_norm\nCuda 8.0, cuDNN 5.1, tf r0.12", "body": "I'm trying to use the new fused_batch_norm layer (as I also have this problem #3290)\r\nUsing it for 4D Tensors works fine so far (as in: it doens't crash)\r\nHowever, when using 2D Tensors ([None, X]) I get this error:\r\n\r\n\r\n> Traceback (most recent call last):\r\n...\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 177, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 467, in batch_norm\r\n    scope=scope)\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 350, in _fused_batch_norm\r\n    outputs = array_ops.reshape(outputs, original_shape)\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 2448, in reshape\r\n    name=name)\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 503, in apply_op\r\n    as_ref=input_arg.is_ref).dtype.name\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 669, in convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/home/userName/.local/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.py\", line 194, in _tensor_shape_tensor_conversion_function\r\n    \"Cannot convert a partially known TensorShape to a Tensor: %s\" % s)\r\nValueError: Cannot convert a partially known TensorShape to a Tensor: (?, 256)\r\n\r\nSame code works for the normal batch_norm layer.\r\nAlso works if I reshape it manually to [None, 1, 1, X] before calling fused_batch_norm\r\n\r\nCuda 8.0, cuDNN 5.1, tf r0.12"}