{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14811", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14811/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14811/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14811/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14811", "id": 276217057, "node_id": "MDU6SXNzdWUyNzYyMTcwNTc=", "number": 14811, "title": "VERBS and OpenMPI not building anymore without CUDA ?", "user": {"login": "eLvErDe", "id": 1586757, "node_id": "MDQ6VXNlcjE1ODY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1586757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eLvErDe", "html_url": "https://github.com/eLvErDe", "followers_url": "https://api.github.com/users/eLvErDe/followers", "following_url": "https://api.github.com/users/eLvErDe/following{/other_user}", "gists_url": "https://api.github.com/users/eLvErDe/gists{/gist_id}", "starred_url": "https://api.github.com/users/eLvErDe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eLvErDe/subscriptions", "organizations_url": "https://api.github.com/users/eLvErDe/orgs", "repos_url": "https://api.github.com/users/eLvErDe/repos", "events_url": "https://api.github.com/users/eLvErDe/events{/privacy}", "received_events_url": "https://api.github.com/users/eLvErDe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2017-11-22T22:05:58Z", "updated_at": "2018-10-11T19:56:30Z", "closed_at": "2018-01-18T22:08:41Z", "author_association": "NONE", "body_html": "<p>Hello,</p>\n<p>When activating MPI or VERBS without CUDA, build fails with the following error:</p>\n<pre><code>ERROR: /build/python-tensorflow-cuda-1.4.0/tensorflow/contrib/verbs/BUILD:133:1: C++ compilation of rule '//tensorflow/contrib/verbs:rdma' failed (Exit 1): gcc failed: error executing command \n  (cd /tmp/tmp.plGX4Xhgql/.cache/bazel/_bazel_pbuilder/436710022b7d9d872ccd97b57710586f/execroot/org_tensorflow &amp;&amp; \\\n  exec env - \\\n    LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/libfakeroot:/usr/lib64/libfakeroot:/usr/lib32/libfakeroot \\\n    PATH=/usr/sbin:/usr/bin:/sbin:/bin \\\n    PWD=/proc/self/cwd \\\n    PYTHON_BIN_PATH=/usr/bin/python3.4 \\\n    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages/ \\\n    TF_NEED_CUDA=0 \\\n    TF_NEED_OPENCL=0 \\\n  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -mavx -msse4.1 -msse4.2 '-std=c++0x' -mavx -msse4.1 -msse4.2 -MD -MF bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.d '-frandom-seed=bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DTENSORFLOW_USE_JEMALLOC -DSNAPPY -DTENSORFLOW_USE_VERBS -iquote . -iquote bazel-out/local-py3-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/local-py3-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/local-py3-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/local-py3-opt/genfiles/external/local_config_sycl -iquote external/nsync -iquote bazel-out/local-py3-opt/genfiles/external/nsync -iquote external/jemalloc -iquote bazel-out/local-py3-opt/genfiles/external/jemalloc -iquote external/gif_archive -iquote bazel-out/local-py3-opt/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/local-py3-opt/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/local-py3-opt/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/local-py3-opt/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/local-py3-opt/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/local-py3-opt/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/local-py3-opt/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/local-py3-opt/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/local-py3-opt/genfiles/external/zlib_archive -iquote external/curl -iquote bazel-out/local-py3-opt/genfiles/external/curl -iquote external/boringssl -iquote bazel-out/local-py3-opt/genfiles/external/boringssl -iquote external/jsoncpp_git -iquote bazel-out/local-py3-opt/genfiles/external/jsoncpp_git -iquote external/grpc -iquote bazel-out/local-py3-opt/genfiles/external/grpc -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/local-py3-opt/genfiles/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/local-py3-opt/genfiles/external/nsync/public -isystem external/jemalloc/include -isystem bazel-out/local-py3-opt/genfiles/external/jemalloc/include -isystem external/gif_archive/lib -isystem bazel-out/local-py3-opt/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/local-py3-opt/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/local-py3-opt/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/local-py3-opt/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/local-py3-opt/genfiles/external/zlib_archive -isystem external/curl/include -isystem bazel-out/local-py3-opt/genfiles/external/curl/include -isystem external/boringssl/src/include -isystem bazel-out/local-py3-opt/genfiles/external/boringssl/src/include -isystem external/jsoncpp_git/include -isystem bazel-out/local-py3-opt/genfiles/external/jsoncpp_git/include -isystem external/grpc/include -isystem bazel-out/local-py3-opt/genfiles/external/grpc/include -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/contrib/verbs/rdma.cc -o bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.o).\nIn file included from ./tensorflow/core/platform/stream_executor.h:26:0,\n                 from ./tensorflow/core/common_runtime/gpu/gpu_util.h:23,\n                 from tensorflow/contrib/verbs/rdma.cc:23:\n./tensorflow/stream_executor/dso_loader.h:32:30: fatal error: cuda/cuda_config.h: No such file or directory\n #include \"cuda/cuda_config.h\"\n</code></pre>\n<p>Is that expected ?</p>\n<p>Thanks</p>", "body_text": "Hello,\nWhen activating MPI or VERBS without CUDA, build fails with the following error:\nERROR: /build/python-tensorflow-cuda-1.4.0/tensorflow/contrib/verbs/BUILD:133:1: C++ compilation of rule '//tensorflow/contrib/verbs:rdma' failed (Exit 1): gcc failed: error executing command \n  (cd /tmp/tmp.plGX4Xhgql/.cache/bazel/_bazel_pbuilder/436710022b7d9d872ccd97b57710586f/execroot/org_tensorflow && \\\n  exec env - \\\n    LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/libfakeroot:/usr/lib64/libfakeroot:/usr/lib32/libfakeroot \\\n    PATH=/usr/sbin:/usr/bin:/sbin:/bin \\\n    PWD=/proc/self/cwd \\\n    PYTHON_BIN_PATH=/usr/bin/python3.4 \\\n    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages/ \\\n    TF_NEED_CUDA=0 \\\n    TF_NEED_OPENCL=0 \\\n  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -mavx -msse4.1 -msse4.2 '-std=c++0x' -mavx -msse4.1 -msse4.2 -MD -MF bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.d '-frandom-seed=bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DTENSORFLOW_USE_JEMALLOC -DSNAPPY -DTENSORFLOW_USE_VERBS -iquote . -iquote bazel-out/local-py3-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/local-py3-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/local-py3-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/local-py3-opt/genfiles/external/local_config_sycl -iquote external/nsync -iquote bazel-out/local-py3-opt/genfiles/external/nsync -iquote external/jemalloc -iquote bazel-out/local-py3-opt/genfiles/external/jemalloc -iquote external/gif_archive -iquote bazel-out/local-py3-opt/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/local-py3-opt/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/local-py3-opt/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/local-py3-opt/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/local-py3-opt/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/local-py3-opt/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/local-py3-opt/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/local-py3-opt/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/local-py3-opt/genfiles/external/zlib_archive -iquote external/curl -iquote bazel-out/local-py3-opt/genfiles/external/curl -iquote external/boringssl -iquote bazel-out/local-py3-opt/genfiles/external/boringssl -iquote external/jsoncpp_git -iquote bazel-out/local-py3-opt/genfiles/external/jsoncpp_git -iquote external/grpc -iquote bazel-out/local-py3-opt/genfiles/external/grpc -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/local-py3-opt/genfiles/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/local-py3-opt/genfiles/external/nsync/public -isystem external/jemalloc/include -isystem bazel-out/local-py3-opt/genfiles/external/jemalloc/include -isystem external/gif_archive/lib -isystem bazel-out/local-py3-opt/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/local-py3-opt/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/local-py3-opt/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/local-py3-opt/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/local-py3-opt/genfiles/external/zlib_archive -isystem external/curl/include -isystem bazel-out/local-py3-opt/genfiles/external/curl/include -isystem external/boringssl/src/include -isystem bazel-out/local-py3-opt/genfiles/external/boringssl/src/include -isystem external/jsoncpp_git/include -isystem bazel-out/local-py3-opt/genfiles/external/jsoncpp_git/include -isystem external/grpc/include -isystem bazel-out/local-py3-opt/genfiles/external/grpc/include -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/contrib/verbs/rdma.cc -o bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.o).\nIn file included from ./tensorflow/core/platform/stream_executor.h:26:0,\n                 from ./tensorflow/core/common_runtime/gpu/gpu_util.h:23,\n                 from tensorflow/contrib/verbs/rdma.cc:23:\n./tensorflow/stream_executor/dso_loader.h:32:30: fatal error: cuda/cuda_config.h: No such file or directory\n #include \"cuda/cuda_config.h\"\n\nIs that expected ?\nThanks", "body": "Hello,\r\n\r\nWhen activating MPI or VERBS without CUDA, build fails with the following error:\r\n\r\n```\r\nERROR: /build/python-tensorflow-cuda-1.4.0/tensorflow/contrib/verbs/BUILD:133:1: C++ compilation of rule '//tensorflow/contrib/verbs:rdma' failed (Exit 1): gcc failed: error executing command \r\n  (cd /tmp/tmp.plGX4Xhgql/.cache/bazel/_bazel_pbuilder/436710022b7d9d872ccd97b57710586f/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/libfakeroot:/usr/lib64/libfakeroot:/usr/lib32/libfakeroot \\\r\n    PATH=/usr/sbin:/usr/bin:/sbin:/bin \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/usr/bin/python3.4 \\\r\n    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages/ \\\r\n    TF_NEED_CUDA=0 \\\r\n    TF_NEED_OPENCL=0 \\\r\n  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -mavx -msse4.1 -msse4.2 '-std=c++0x' -mavx -msse4.1 -msse4.2 -MD -MF bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.d '-frandom-seed=bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DTENSORFLOW_USE_JEMALLOC -DSNAPPY -DTENSORFLOW_USE_VERBS -iquote . -iquote bazel-out/local-py3-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/local-py3-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/local-py3-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/local-py3-opt/genfiles/external/local_config_sycl -iquote external/nsync -iquote bazel-out/local-py3-opt/genfiles/external/nsync -iquote external/jemalloc -iquote bazel-out/local-py3-opt/genfiles/external/jemalloc -iquote external/gif_archive -iquote bazel-out/local-py3-opt/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/local-py3-opt/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/local-py3-opt/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/local-py3-opt/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/local-py3-opt/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/local-py3-opt/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/local-py3-opt/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/local-py3-opt/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/local-py3-opt/genfiles/external/zlib_archive -iquote external/curl -iquote bazel-out/local-py3-opt/genfiles/external/curl -iquote external/boringssl -iquote bazel-out/local-py3-opt/genfiles/external/boringssl -iquote external/jsoncpp_git -iquote bazel-out/local-py3-opt/genfiles/external/jsoncpp_git -iquote external/grpc -iquote bazel-out/local-py3-opt/genfiles/external/grpc -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/local-py3-opt/genfiles/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/local-py3-opt/genfiles/external/nsync/public -isystem external/jemalloc/include -isystem bazel-out/local-py3-opt/genfiles/external/jemalloc/include -isystem external/gif_archive/lib -isystem bazel-out/local-py3-opt/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/local-py3-opt/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/local-py3-opt/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/local-py3-opt/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/local-py3-opt/genfiles/external/zlib_archive -isystem external/curl/include -isystem bazel-out/local-py3-opt/genfiles/external/curl/include -isystem external/boringssl/src/include -isystem bazel-out/local-py3-opt/genfiles/external/boringssl/src/include -isystem external/jsoncpp_git/include -isystem bazel-out/local-py3-opt/genfiles/external/jsoncpp_git/include -isystem external/grpc/include -isystem bazel-out/local-py3-opt/genfiles/external/grpc/include -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/contrib/verbs/rdma.cc -o bazel-out/local-py3-opt/bin/tensorflow/contrib/verbs/_objs/rdma/tensorflow/contrib/verbs/rdma.pic.o).\r\nIn file included from ./tensorflow/core/platform/stream_executor.h:26:0,\r\n                 from ./tensorflow/core/common_runtime/gpu/gpu_util.h:23,\r\n                 from tensorflow/contrib/verbs/rdma.cc:23:\r\n./tensorflow/stream_executor/dso_loader.h:32:30: fatal error: cuda/cuda_config.h: No such file or directory\r\n #include \"cuda/cuda_config.h\"\r\n```\r\n\r\nIs that expected ?\r\n\r\nThanks"}