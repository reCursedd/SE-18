{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3102", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3102/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3102/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3102/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3102", "id": 162934838, "node_id": "MDU6SXNzdWUxNjI5MzQ4Mzg=", "number": 3102, "title": "Constant operation \"forgets\" about incoming shape", "user": {"login": "omoindrot", "id": 13662086, "node_id": "MDQ6VXNlcjEzNjYyMDg2", "avatar_url": "https://avatars3.githubusercontent.com/u/13662086?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omoindrot", "html_url": "https://github.com/omoindrot", "followers_url": "https://api.github.com/users/omoindrot/followers", "following_url": "https://api.github.com/users/omoindrot/following{/other_user}", "gists_url": "https://api.github.com/users/omoindrot/gists{/gist_id}", "starred_url": "https://api.github.com/users/omoindrot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omoindrot/subscriptions", "organizations_url": "https://api.github.com/users/omoindrot/orgs", "repos_url": "https://api.github.com/users/omoindrot/repos", "events_url": "https://api.github.com/users/omoindrot/events{/privacy}", "received_events_url": "https://api.github.com/users/omoindrot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-06-29T14:08:32Z", "updated_at": "2016-07-01T18:55:34Z", "closed_at": "2016-07-01T18:55:34Z", "author_association": "CONTRIBUTOR", "body_html": "<h2>Feature request</h2>\n<p>Following this question in StackOverflow: <a href=\"http://stackoverflow.com/questions/37881917/why-cant-tensorflow-determine-the-shape-of-this-expression/37882501#37882501\" rel=\"nofollow\">Why can't tensorflow determine the shape of this expression</a>.</p>\n<p>When using a constant tensor (<code>tf.zeros</code>, <code>tf.ones</code>, <code>tf.constant</code>...), if one of the input dimension is unknown, the operation will forget every dimension of the input.<br>\nThe code will be clearer:</p>\n<div class=\"highlight highlight-source-python\"><pre>input_tensor <span class=\"pl-k\">=</span> tf.placeholder(tf.float32, [<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">32</span>])\nbatch_size <span class=\"pl-k\">=</span> tf.shape(input_tensor)[<span class=\"pl-c1\">0</span>]\n\nres <span class=\"pl-k\">=</span> tf.zeros((batch_size, <span class=\"pl-c1\">128</span>))\n<span class=\"pl-c1\">print</span> res.get_shape()  <span class=\"pl-c\"><span class=\"pl-c\">#</span> prints (?, ?) WHEREAS one could expect (?, 128)</span></pre></div>\n<p>The easy fix is to set the output shape by hand:</p>\n<div class=\"highlight highlight-source-python\"><pre>res.set_shape([<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">128</span>])\n<span class=\"pl-c1\">print</span> res.get_shape()  <span class=\"pl-c\"><span class=\"pl-c\">#</span> prints (?, 128)</span></pre></div>\n<p>However, this could be done directly in the TensorFlow code. Otherwise, it may confuse users that think their shape is fully defined.</p>", "body_text": "Feature request\nFollowing this question in StackOverflow: Why can't tensorflow determine the shape of this expression.\nWhen using a constant tensor (tf.zeros, tf.ones, tf.constant...), if one of the input dimension is unknown, the operation will forget every dimension of the input.\nThe code will be clearer:\ninput_tensor = tf.placeholder(tf.float32, [None, 32])\nbatch_size = tf.shape(input_tensor)[0]\n\nres = tf.zeros((batch_size, 128))\nprint res.get_shape()  # prints (?, ?) WHEREAS one could expect (?, 128)\nThe easy fix is to set the output shape by hand:\nres.set_shape([None, 128])\nprint res.get_shape()  # prints (?, 128)\nHowever, this could be done directly in the TensorFlow code. Otherwise, it may confuse users that think their shape is fully defined.", "body": "## Feature request\n\nFollowing this question in StackOverflow: [Why can't tensorflow determine the shape of this expression](http://stackoverflow.com/questions/37881917/why-cant-tensorflow-determine-the-shape-of-this-expression/37882501#37882501).\n\nWhen using a constant tensor (`tf.zeros`, `tf.ones`, `tf.constant`...), if one of the input dimension is unknown, the operation will forget every dimension of the input.  \nThe code will be clearer:\n\n``` python\ninput_tensor = tf.placeholder(tf.float32, [None, 32])\nbatch_size = tf.shape(input_tensor)[0]\n\nres = tf.zeros((batch_size, 128))\nprint res.get_shape()  # prints (?, ?) WHEREAS one could expect (?, 128)\n```\n\nThe easy fix is to set the output shape by hand:\n\n``` python\nres.set_shape([None, 128])\nprint res.get_shape()  # prints (?, 128)\n```\n\nHowever, this could be done directly in the TensorFlow code. Otherwise, it may confuse users that think their shape is fully defined.\n"}