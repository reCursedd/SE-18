{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21045", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21045/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21045/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21045/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21045", "id": 343503413, "node_id": "MDU6SXNzdWUzNDM1MDM0MTM=", "number": 21045, "title": "Building TensorFlow failed", "user": {"login": "timur-st94", "id": 25498216, "node_id": "MDQ6VXNlcjI1NDk4MjE2", "avatar_url": "https://avatars1.githubusercontent.com/u/25498216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timur-st94", "html_url": "https://github.com/timur-st94", "followers_url": "https://api.github.com/users/timur-st94/followers", "following_url": "https://api.github.com/users/timur-st94/following{/other_user}", "gists_url": "https://api.github.com/users/timur-st94/gists{/gist_id}", "starred_url": "https://api.github.com/users/timur-st94/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timur-st94/subscriptions", "organizations_url": "https://api.github.com/users/timur-st94/orgs", "repos_url": "https://api.github.com/users/timur-st94/repos", "events_url": "https://api.github.com/users/timur-st94/events{/privacy}", "received_events_url": "https://api.github.com/users/timur-st94/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "angersson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angersson", "html_url": "https://github.com/angersson", "followers_url": "https://api.github.com/users/angersson/followers", "following_url": "https://api.github.com/users/angersson/following{/other_user}", "gists_url": "https://api.github.com/users/angersson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angersson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angersson/subscriptions", "organizations_url": "https://api.github.com/users/angersson/orgs", "repos_url": "https://api.github.com/users/angersson/repos", "events_url": "https://api.github.com/users/angersson/events{/privacy}", "received_events_url": "https://api.github.com/users/angersson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angersson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angersson", "html_url": "https://github.com/angersson", "followers_url": "https://api.github.com/users/angersson/followers", "following_url": "https://api.github.com/users/angersson/following{/other_user}", "gists_url": "https://api.github.com/users/angersson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angersson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angersson/subscriptions", "organizations_url": "https://api.github.com/users/angersson/orgs", "repos_url": "https://api.github.com/users/angersson/repos", "events_url": "https://api.github.com/users/angersson/events{/privacy}", "received_events_url": "https://api.github.com/users/angersson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2018-07-23T06:27:57Z", "updated_at": "2018-10-22T05:15:39Z", "closed_at": "2018-08-02T07:33:42Z", "author_association": "NONE", "body_html": "<h3>Issue</h3>\n<p>I'm trying to build the .so file using bazel<br>\n<code>bazel build -c opt //tensorflow/contrib/android:libtensorflow_inference.so --crosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --cpu=armeabi-v7a</code><br>\nGetting an error:</p>\n<pre><code>tensorflow/core/BUILD:2306:1: C++ compilation of rule '//tensorflow/core:protos_all_proto_cc_impl' failed (Exit 1)\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:52:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/mutex.h:33:\nIn file included from external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/mutex:35:\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/bits/c++0x_warning.h:32:2: error: This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n#error This file requires compiler and library support for the \\\n ^\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:52:\nexternal/protobuf_archive/src/google/protobuf/stubs/mutex.h:58:8: error: no type named 'mutex' in namespace 'std'\n  std::mutex mu_;\n\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:53:\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:346:25: error: no type named 'remove_reference' in namespace 'std'\n  typedef typename std::remove_reference&lt;T&gt;::type base_type;\n \nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:346:41: error: expected member name or ';' after declaration specifiers\n  typedef typename std::remove_reference&lt;T&gt;::type base_type;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:347:17: error: unknown type name 'base_type'\n  typedef const base_type&amp; type;\n                \nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:401:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference&lt;P1&gt;::type p1_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:401:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference&lt;P1&gt;::type p1_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:402:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference&lt;P2&gt;::type p2_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:402:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference&lt;P2&gt;::type p2_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:403:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference&lt;P3&gt;::type p3_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:403:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference&lt;P3&gt;::type p3_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:404:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference&lt;P4&gt;::type p4_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:404:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference&lt;P4&gt;::type p4_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:405:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference&lt;P5&gt;::type p5_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:405:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference&lt;P5&gt;::type p5_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:383:9: error: member initializer 'p1_' does not name a non-static data member or base class\n        p1_(p1),\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:384:9: error: member initializer 'p2_' does not name a non-static data member or base class\n        p2_(p2),\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:385:9: error: member initializer 'p3_' does not name a non-static data member or base class\n        p3_(p3),\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:386:9: error: member initializer 'p4_' does not name a non-static data member or base class\n        p4_(p4)\n</code></pre>\n<h3>System information</h3>\n<p>OS:<br>\nmacOS High Sierra 10.13.3</p>\n<p>bazel:<br>\n<code>Build label: 0.15.0-homebrew Build target: bazel-out/darwin-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar Build time: Tue Jun 26 12:42:27 2018 (1530016947) Build timestamp: 1530016947 Build timestamp as int: 1530016947</code></p>\n<p>ndk:<br>\nandroid-ndk-r16b</p>\n<p>I looked similar problems, like <a href=\"https://github.com/bazelbuild/bazel/issues/3924\" data-hovercard-type=\"issue\" data-hovercard-url=\"/bazelbuild/bazel/issues/3924/hovercard\">#3924</a> or <a href=\"https://github.com/tensorflow/tensorflow/issues/17046\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/17046/hovercard\">#17046</a>, but unfortunately did not find a solution for himself.</p>\n<p>Thank you in advance.</p>", "body_text": "Issue\nI'm trying to build the .so file using bazel\nbazel build -c opt //tensorflow/contrib/android:libtensorflow_inference.so --crosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --cpu=armeabi-v7a\nGetting an error:\ntensorflow/core/BUILD:2306:1: C++ compilation of rule '//tensorflow/core:protos_all_proto_cc_impl' failed (Exit 1)\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:52:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/mutex.h:33:\nIn file included from external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/mutex:35:\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/bits/c++0x_warning.h:32:2: error: This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n#error This file requires compiler and library support for the \\\n ^\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:52:\nexternal/protobuf_archive/src/google/protobuf/stubs/mutex.h:58:8: error: no type named 'mutex' in namespace 'std'\n  std::mutex mu_;\n\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:53:\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:346:25: error: no type named 'remove_reference' in namespace 'std'\n  typedef typename std::remove_reference<T>::type base_type;\n \nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:346:41: error: expected member name or ';' after declaration specifiers\n  typedef typename std::remove_reference<T>::type base_type;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:347:17: error: unknown type name 'base_type'\n  typedef const base_type& type;\n                \nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:401:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference<P1>::type p1_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:401:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference<P1>::type p1_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:402:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference<P2>::type p2_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:402:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference<P2>::type p2_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:403:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference<P3>::type p3_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:403:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference<P3>::type p3_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:404:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference<P4>::type p4_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:404:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference<P4>::type p4_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:405:17: error: no type named 'remove_reference' in namespace 'std'\n  typename std::remove_reference<P5>::type p5_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:405:33: error: expected member name or ';' after declaration specifiers\n  typename std::remove_reference<P5>::type p5_;\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:383:9: error: member initializer 'p1_' does not name a non-static data member or base class\n        p1_(p1),\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:384:9: error: member initializer 'p2_' does not name a non-static data member or base class\n        p2_(p2),\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:385:9: error: member initializer 'p3_' does not name a non-static data member or base class\n        p3_(p3),\n\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:386:9: error: member initializer 'p4_' does not name a non-static data member or base class\n        p4_(p4)\n\nSystem information\nOS:\nmacOS High Sierra 10.13.3\nbazel:\nBuild label: 0.15.0-homebrew Build target: bazel-out/darwin-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar Build time: Tue Jun 26 12:42:27 2018 (1530016947) Build timestamp: 1530016947 Build timestamp as int: 1530016947\nndk:\nandroid-ndk-r16b\nI looked similar problems, like #3924 or #17046, but unfortunately did not find a solution for himself.\nThank you in advance.", "body": "### Issue\r\nI'm trying to build the .so file using bazel\r\n`bazel build -c opt //tensorflow/contrib/android:libtensorflow_inference.so --crosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --cpu=armeabi-v7a`  \r\nGetting an error:\r\n\r\n```\r\ntensorflow/core/BUILD:2306:1: C++ compilation of rule '//tensorflow/core:protos_all_proto_cc_impl' failed (Exit 1)\r\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\r\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\r\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:52:\r\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/mutex.h:33:\r\nIn file included from external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/mutex:35:\r\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/bits/c++0x_warning.h:32:2: error: This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\r\n#error This file requires compiler and library support for the \\\r\n ^\r\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\r\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\r\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:52:\r\nexternal/protobuf_archive/src/google/protobuf/stubs/mutex.h:58:8: error: no type named 'mutex' in namespace 'std'\r\n  std::mutex mu_;\r\n\r\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.cc:4:\r\nIn file included from bazel-out/armeabi-v7a-opt/genfiles/tensorflow/core/framework/tensor_shape.pb.h:9:\r\nIn file included from external/protobuf_archive/src/google/protobuf/stubs/common.h:53:\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:346:25: error: no type named 'remove_reference' in namespace 'std'\r\n  typedef typename std::remove_reference<T>::type base_type;\r\n \r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:346:41: error: expected member name or ';' after declaration specifiers\r\n  typedef typename std::remove_reference<T>::type base_type;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:347:17: error: unknown type name 'base_type'\r\n  typedef const base_type& type;\r\n                \r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:401:17: error: no type named 'remove_reference' in namespace 'std'\r\n  typename std::remove_reference<P1>::type p1_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:401:33: error: expected member name or ';' after declaration specifiers\r\n  typename std::remove_reference<P1>::type p1_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:402:17: error: no type named 'remove_reference' in namespace 'std'\r\n  typename std::remove_reference<P2>::type p2_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:402:33: error: expected member name or ';' after declaration specifiers\r\n  typename std::remove_reference<P2>::type p2_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:403:17: error: no type named 'remove_reference' in namespace 'std'\r\n  typename std::remove_reference<P3>::type p3_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:403:33: error: expected member name or ';' after declaration specifiers\r\n  typename std::remove_reference<P3>::type p3_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:404:17: error: no type named 'remove_reference' in namespace 'std'\r\n  typename std::remove_reference<P4>::type p4_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:404:33: error: expected member name or ';' after declaration specifiers\r\n  typename std::remove_reference<P4>::type p4_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:405:17: error: no type named 'remove_reference' in namespace 'std'\r\n  typename std::remove_reference<P5>::type p5_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:405:33: error: expected member name or ';' after declaration specifiers\r\n  typename std::remove_reference<P5>::type p5_;\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:383:9: error: member initializer 'p1_' does not name a non-static data member or base class\r\n        p1_(p1),\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:384:9: error: member initializer 'p2_' does not name a non-static data member or base class\r\n        p2_(p2),\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:385:9: error: member initializer 'p3_' does not name a non-static data member or base class\r\n        p3_(p3),\r\n\r\nexternal/protobuf_archive/src/google/protobuf/stubs/callback.h:386:9: error: member initializer 'p4_' does not name a non-static data member or base class\r\n        p4_(p4)\r\n```\r\n\r\n### System information\r\nOS:\r\n macOS High Sierra 10.13.3\r\n\r\nbazel: \r\n`Build label: 0.15.0-homebrew\r\nBuild target: bazel-out/darwin-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Tue Jun 26 12:42:27 2018 (1530016947)\r\nBuild timestamp: 1530016947\r\nBuild timestamp as int: 1530016947`\r\n\r\nndk:\r\nandroid-ndk-r16b\r\n\r\nI looked similar problems, like [#3924](https://github.com/bazelbuild/bazel/issues/3924) or [#17046](https://github.com/tensorflow/tensorflow/issues/17046), but unfortunately did not find a solution for himself. \r\n\r\nThank you in advance.\r\n"}