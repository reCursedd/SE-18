{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/386973717", "html_url": "https://github.com/tensorflow/tensorflow/pull/15606#issuecomment-386973717", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15606", "id": 386973717, "node_id": "MDEyOklzc3VlQ29tbWVudDM4Njk3MzcxNw==", "user": {"login": "markdryan", "id": 984073, "node_id": "MDQ6VXNlcjk4NDA3Mw==", "avatar_url": "https://avatars3.githubusercontent.com/u/984073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markdryan", "html_url": "https://github.com/markdryan", "followers_url": "https://api.github.com/users/markdryan/followers", "following_url": "https://api.github.com/users/markdryan/following{/other_user}", "gists_url": "https://api.github.com/users/markdryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/markdryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markdryan/subscriptions", "organizations_url": "https://api.github.com/users/markdryan/orgs", "repos_url": "https://api.github.com/users/markdryan/repos", "events_url": "https://api.github.com/users/markdryan/events{/privacy}", "received_events_url": "https://api.github.com/users/markdryan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-07T06:49:10Z", "updated_at": "2018-05-07T06:49:10Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I've done some testing with an AVX512 enabled tensorflow build over the last few days.  I can confirm that this patch is still needed but it is not enough by itself to prevent alignment crashes.  Setting EIGEN_MAX_ALIGN_BYTES to 64, as mentioned above, is also required.  In addition, a third patch is needed to prevent some compiler unit test failures, as has also been mentioned above.  I've submitted a new PR ( <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"320691978\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/19121\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/tensorflow/tensorflow/pull/19121/hovercard\" href=\"https://github.com/tensorflow/tensorflow/pull/19121\">#19121</a> ) that contains fenrus75's original commit + 2 new commits to set EIGEN_MAX_ALIGN_BYTES and to fix the unit tests.</p>\n<p>Even with these patches, AVX512 enabled builds still don't work very well.  I'm seeing a lot of unit tests failures.  These seem to be caused by errors in floating point calculations resulting in NaNs.  I haven't investigated the calculation errors yet but I have noticed that the <a href=\"https://github.com/tensorflow/models/tree/master/samples/core/get_started\">getting started example</a> also fails with reports of NaNs after the first iteration.  I'll take a look at this later this week.</p>", "body_text": "I've done some testing with an AVX512 enabled tensorflow build over the last few days.  I can confirm that this patch is still needed but it is not enough by itself to prevent alignment crashes.  Setting EIGEN_MAX_ALIGN_BYTES to 64, as mentioned above, is also required.  In addition, a third patch is needed to prevent some compiler unit test failures, as has also been mentioned above.  I've submitted a new PR ( #19121 ) that contains fenrus75's original commit + 2 new commits to set EIGEN_MAX_ALIGN_BYTES and to fix the unit tests.\nEven with these patches, AVX512 enabled builds still don't work very well.  I'm seeing a lot of unit tests failures.  These seem to be caused by errors in floating point calculations resulting in NaNs.  I haven't investigated the calculation errors yet but I have noticed that the getting started example also fails with reports of NaNs after the first iteration.  I'll take a look at this later this week.", "body": "I've done some testing with an AVX512 enabled tensorflow build over the last few days.  I can confirm that this patch is still needed but it is not enough by itself to prevent alignment crashes.  Setting EIGEN_MAX_ALIGN_BYTES to 64, as mentioned above, is also required.  In addition, a third patch is needed to prevent some compiler unit test failures, as has also been mentioned above.  I've submitted a new PR ( https://github.com/tensorflow/tensorflow/pull/19121 ) that contains fenrus75's original commit + 2 new commits to set EIGEN_MAX_ALIGN_BYTES and to fix the unit tests.\r\n\r\nEven with these patches, AVX512 enabled builds still don't work very well.  I'm seeing a lot of unit tests failures.  These seem to be caused by errors in floating point calculations resulting in NaNs.  I haven't investigated the calculation errors yet but I have noticed that the [getting started example](https://github.com/tensorflow/models/tree/master/samples/core/get_started) also fails with reports of NaNs after the first iteration.  I'll take a look at this later this week."}