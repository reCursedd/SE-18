{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/231704127", "html_url": "https://github.com/tensorflow/tensorflow/issues/212#issuecomment-231704127", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/212", "id": 231704127, "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTcwNDEyNw==", "user": {"login": "suraj1990", "id": 5551707, "node_id": "MDQ6VXNlcjU1NTE3MDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/5551707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suraj1990", "html_url": "https://github.com/suraj1990", "followers_url": "https://api.github.com/users/suraj1990/followers", "following_url": "https://api.github.com/users/suraj1990/following{/other_user}", "gists_url": "https://api.github.com/users/suraj1990/gists{/gist_id}", "starred_url": "https://api.github.com/users/suraj1990/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suraj1990/subscriptions", "organizations_url": "https://api.github.com/users/suraj1990/orgs", "repos_url": "https://api.github.com/users/suraj1990/repos", "events_url": "https://api.github.com/users/suraj1990/events{/privacy}", "received_events_url": "https://api.github.com/users/suraj1990/received_events", "type": "User", "site_admin": false}, "created_at": "2016-07-11T10:59:32Z", "updated_at": "2016-07-11T11:07:32Z", "author_association": "NONE", "body_html": "<p>I am running into a similar error. I have trained two models. en-fr and fr-en models. The fr-en model has different vocab size compared to the en-fr model. The first model is being loaded properly. It crashes while loading the second one. I have trained both the models separately. Please check the log file attached to see the error logs. kindly tell me the right way to go ahead.</p>\n<pre><code>`global en_fr_sess\n\nif en_fr_sess==None:\n  en_fr_sess = tf.Session()\n\nglobal en_fr_model\nglobal en_fr_en_vocab_path\nglobal en_fr_fr_vocab_path\n\n  en_fr_model = create_model(en_fr_sess, True)\n  en_fr_model.batch_size = 1  \n  fr_en_model = fr_en_create_model(en_fr_sess, True)\n  fr_en_model.batch_size = 1`\n</code></pre>\n<p>below are the two methods create_model and fr_en_create_model</p>\n<pre><code>`def create_model(session, forward_only):\n\n    model = seq2seq_model.Seq2SeqModel(\n    FLAGS.en_vocab_size, FLAGS.fr_vocab_size, _buckets,\n    FLAGS.size, FLAGS.num_layers, FLAGS.max_gradient_norm, FLAGS.batch_size,\n    FLAGS.learning_rate, FLAGS.learning_rate_decay_factor,\n    forward_only=forward_only)\n    ckpt = tf.train.get_checkpoint_state(FLAGS.train_dir)\n    if ckpt and tf.gfile.Exists(ckpt.model_checkpoint_path):\n      print(\"Reading model parameters from %s\" % ckpt.model_checkpoint_path)\n      model.saver.restore(session, ckpt.model_checkpoint_path)\n    else:\n       print(\"Created model with fresh parameters.\")\n    session.run(tf.initialize_all_variables())\n    return model\n\n def fr_en_create_model(session, forward_only):\n\n      model = seq2seq_model.Seq2SeqModel(\n      380, 380, _buckets,\n      FLAGS.size, FLAGS.num_layers, FLAGS.max_gradient_norm, FLAGS.batch_size,\n      FLAGS.learning_rate, FLAGS.learning_rate_decay_factor,\n      forward_only=forward_only)\n      ckpt = tf.train.get_checkpoint_state(\"./password_data/train/\")\n      if ckpt and tf.gfile.Exists(ckpt.model_checkpoint_path):\n        print(\"Reading model parameters from %s\" % ckpt.model_checkpoint_path)\n        model.saver.restore(session, ckpt.model_checkpoint_path)\n      else:\n        print(\"Created model with fresh parameters.\")\n      session.run(tf.initialize_all_variables())\n      return model`\n</code></pre>\n<p><a href=\"https://github.com/tensorflow/tensorflow/files/356916/out.txt\">out.txt</a></p>", "body_text": "I am running into a similar error. I have trained two models. en-fr and fr-en models. The fr-en model has different vocab size compared to the en-fr model. The first model is being loaded properly. It crashes while loading the second one. I have trained both the models separately. Please check the log file attached to see the error logs. kindly tell me the right way to go ahead.\n`global en_fr_sess\n\nif en_fr_sess==None:\n  en_fr_sess = tf.Session()\n\nglobal en_fr_model\nglobal en_fr_en_vocab_path\nglobal en_fr_fr_vocab_path\n\n  en_fr_model = create_model(en_fr_sess, True)\n  en_fr_model.batch_size = 1  \n  fr_en_model = fr_en_create_model(en_fr_sess, True)\n  fr_en_model.batch_size = 1`\n\nbelow are the two methods create_model and fr_en_create_model\n`def create_model(session, forward_only):\n\n    model = seq2seq_model.Seq2SeqModel(\n    FLAGS.en_vocab_size, FLAGS.fr_vocab_size, _buckets,\n    FLAGS.size, FLAGS.num_layers, FLAGS.max_gradient_norm, FLAGS.batch_size,\n    FLAGS.learning_rate, FLAGS.learning_rate_decay_factor,\n    forward_only=forward_only)\n    ckpt = tf.train.get_checkpoint_state(FLAGS.train_dir)\n    if ckpt and tf.gfile.Exists(ckpt.model_checkpoint_path):\n      print(\"Reading model parameters from %s\" % ckpt.model_checkpoint_path)\n      model.saver.restore(session, ckpt.model_checkpoint_path)\n    else:\n       print(\"Created model with fresh parameters.\")\n    session.run(tf.initialize_all_variables())\n    return model\n\n def fr_en_create_model(session, forward_only):\n\n      model = seq2seq_model.Seq2SeqModel(\n      380, 380, _buckets,\n      FLAGS.size, FLAGS.num_layers, FLAGS.max_gradient_norm, FLAGS.batch_size,\n      FLAGS.learning_rate, FLAGS.learning_rate_decay_factor,\n      forward_only=forward_only)\n      ckpt = tf.train.get_checkpoint_state(\"./password_data/train/\")\n      if ckpt and tf.gfile.Exists(ckpt.model_checkpoint_path):\n        print(\"Reading model parameters from %s\" % ckpt.model_checkpoint_path)\n        model.saver.restore(session, ckpt.model_checkpoint_path)\n      else:\n        print(\"Created model with fresh parameters.\")\n      session.run(tf.initialize_all_variables())\n      return model`\n\nout.txt", "body": "I am running into a similar error. I have trained two models. en-fr and fr-en models. The fr-en model has different vocab size compared to the en-fr model. The first model is being loaded properly. It crashes while loading the second one. I have trained both the models separately. Please check the log file attached to see the error logs. kindly tell me the right way to go ahead.\n\n```\n`global en_fr_sess\n\nif en_fr_sess==None:\n  en_fr_sess = tf.Session()\n\nglobal en_fr_model\nglobal en_fr_en_vocab_path\nglobal en_fr_fr_vocab_path\n\n  en_fr_model = create_model(en_fr_sess, True)\n  en_fr_model.batch_size = 1  \n  fr_en_model = fr_en_create_model(en_fr_sess, True)\n  fr_en_model.batch_size = 1`\n```\n\nbelow are the two methods create_model and fr_en_create_model\n\n```\n`def create_model(session, forward_only):\n\n    model = seq2seq_model.Seq2SeqModel(\n    FLAGS.en_vocab_size, FLAGS.fr_vocab_size, _buckets,\n    FLAGS.size, FLAGS.num_layers, FLAGS.max_gradient_norm, FLAGS.batch_size,\n    FLAGS.learning_rate, FLAGS.learning_rate_decay_factor,\n    forward_only=forward_only)\n    ckpt = tf.train.get_checkpoint_state(FLAGS.train_dir)\n    if ckpt and tf.gfile.Exists(ckpt.model_checkpoint_path):\n      print(\"Reading model parameters from %s\" % ckpt.model_checkpoint_path)\n      model.saver.restore(session, ckpt.model_checkpoint_path)\n    else:\n       print(\"Created model with fresh parameters.\")\n    session.run(tf.initialize_all_variables())\n    return model\n\n def fr_en_create_model(session, forward_only):\n\n      model = seq2seq_model.Seq2SeqModel(\n      380, 380, _buckets,\n      FLAGS.size, FLAGS.num_layers, FLAGS.max_gradient_norm, FLAGS.batch_size,\n      FLAGS.learning_rate, FLAGS.learning_rate_decay_factor,\n      forward_only=forward_only)\n      ckpt = tf.train.get_checkpoint_state(\"./password_data/train/\")\n      if ckpt and tf.gfile.Exists(ckpt.model_checkpoint_path):\n        print(\"Reading model parameters from %s\" % ckpt.model_checkpoint_path)\n        model.saver.restore(session, ckpt.model_checkpoint_path)\n      else:\n        print(\"Created model with fresh parameters.\")\n      session.run(tf.initialize_all_variables())\n      return model`\n```\n\n[out.txt](https://github.com/tensorflow/tensorflow/files/356916/out.txt)\n"}