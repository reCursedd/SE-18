{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12291", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12291/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12291/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12291/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12291", "id": 250269192, "node_id": "MDU6SXNzdWUyNTAyNjkxOTI=", "number": 12291, "title": "Tensorflow Bug (load avg rises very high, cannot kill process, system freeze)", "user": {"login": "dlaj", "id": 31033366, "node_id": "MDQ6VXNlcjMxMDMzMzY2", "avatar_url": "https://avatars2.githubusercontent.com/u/31033366?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dlaj", "html_url": "https://github.com/dlaj", "followers_url": "https://api.github.com/users/dlaj/followers", "following_url": "https://api.github.com/users/dlaj/following{/other_user}", "gists_url": "https://api.github.com/users/dlaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/dlaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dlaj/subscriptions", "organizations_url": "https://api.github.com/users/dlaj/orgs", "repos_url": "https://api.github.com/users/dlaj/repos", "events_url": "https://api.github.com/users/dlaj/events{/privacy}", "received_events_url": "https://api.github.com/users/dlaj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-15T09:44:32Z", "updated_at": "2017-08-25T09:53:51Z", "closed_at": "2017-08-25T09:53:51Z", "author_association": "NONE", "body_html": "<p>The following script run.sh will increase load avg to several 100 (it takes usually 100 iterations)</p>\n<p>run.sh</p>\n<pre><code>#!/bin/bash\nvar=0\nwhile :\ndo\n        echo \"round ---&gt;\" $((var++))\n        python testTF.py\n        sleep 3\ndone\n</code></pre>\n<p>testTF.py</p>\n<pre><code>#!/usr/bin/python\n# -*- coding: utf-8 -*-\n\nimport os\nos.environ['CUDA_VISIBLE_DEVICES'] = '0'\n\n\nimport tensorflow as tf\nprint(\"START SESSION...\")\nsession = tf.Session()\nprint(\"...SESSION DONE\")\n\n</code></pre>\n<p>The error started to appear in Ubuntu 14.04 (where it freezes the workstation).<br>\nUpdating to Ubuntu 16.04 makes the workstation more responsible, but a reboot is still necessary.<br>\nobservations:</p>\n<ul>\n<li>I can not kill the PID of the python process when the load avg rises</li>\n<li>changing to python3 did not resolve the issue</li>\n<li>compiling tf (1.3.0) from source did not resolve the issue</li>\n</ul>\n<p>== cat /etc/issue ===============================================<br>\nLinux bipower6 4.4.0-89-generic <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"116241798\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/112\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/112/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/112\">#112</a>-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux<br>\nVERSION=\"16.04.3 LTS (Xenial Xerus)\"<br>\nVERSION_ID=\"16.04\"<br>\nVERSION_CODENAME=xenial</p>\n<p>== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609<br>\nCopyright (C) 2015 Free Software Foundation, Inc.<br>\nThis is free software; see the source for copying conditions.  There is NO<br>\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n<p>== uname -a =====================================================<br>\nLinux bipower6 4.4.0-89-generic <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"116241798\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/112\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/112/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/112\">#112</a>-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</p>\n<p>== check pips ===================================================<br>\nnumpy (1.13.1)<br>\nprotobuf (3.3.0)<br>\ntensorflow-gpu (1.2.1)</p>\n<p>== check for virtualenv =========================================<br>\nTrue</p>\n<p>== tensorflow import ============================================<br>\ntf.VERSION = 1.2.1<br>\ntf.GIT_VERSION = v1.2.0-5-g435cdfc<br>\ntf.COMPILER_VERSION = v1.2.0-5-g435cdfc<br>\nSanity check: array([1], dtype=int32)</p>\n<p>== env ==========================================================<br>\nLD_LIBRARY_PATH /home/a/torch/install/lib:/home/a/torch/install/lib::/usr/local/cuda-8.0/lib64:/usr/local/cuda-8.0/:/usr/local/lib/:/usr/local/cuda-8.0/lib64:/usr/local/cuda-8.0/:/usr/local/lib/<br>\nDYLD_LIBRARY_PATH /home/a/torch/install/lib:/home/a/torch/install/lib:</p>\n<p>== nvidia-smi ===================================================<br>\nTue Aug 15 11:25:32 2017<br>\n+-----------------------------------------------------------------------------+<br>\n| NVIDIA-SMI 375.66                 Driver Version: 375.66                    |<br>\n|-------------------------------+----------------------+----------------------+<br>\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |<br>\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |<br>\n|===============================+======================+======================|<br>\n|   0  GeForce GTX 1080    Off  | 0000:02:00.0     Off |                  N/A |<br>\n| 29%   44C    P0    41W / 180W |      0MiB /  8114MiB |      0%      Default |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   1  TITAN X (Pascal)    Off  | 0000:04:00.0     Off |                  N/A |<br>\n|  0%   52C    P0    56W / 250W |      0MiB / 12189MiB |      2%      Default |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   2  Tesla P40           Off  | 0000:83:00.0     Off |                    0 |<br>\n| N/A   69C    P0   128W / 250W |  21897MiB / 22912MiB |     93%      Default |<br>\n+-------------------------------+----------------------+----------------------+</p>\n<p>+-----------------------------------------------------------------------------+<br>\n| Processes:                                                       GPU Memory |<br>\n|  GPU       PID  Type  Process name                               Usage      |<br>\n|=============================================================================|<br>\n|    2     89766    C   /home/a/dl/bin/python                        21895MiB |<br>\n+-----------------------------------------------------------------------------+</p>\n<p>== cuda libs  ===================================================<br>\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7<br>\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7<br>\n/usr/local/cuda-8.0/lib64/libcudart_static.a<br>\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61<br>\n/usr/local/cuda-7.5/doc/man/man7/libcudart.so.7<br>\n/usr/local/cuda-7.5/doc/man/man7/libcudart.7<br>\n/usr/local/cuda-7.5/lib/libcudart_static.a<br>\n/usr/local/cuda-7.5/lib/libcudart.so.7.5.18<br>\n/usr/local/cuda-7.5/lib64/libcudart_static.a<br>\n/usr/local/cuda-7.5/lib64/libcudart.so.7.5.18<br>\n(END)</p>", "body_text": "The following script run.sh will increase load avg to several 100 (it takes usually 100 iterations)\nrun.sh\n#!/bin/bash\nvar=0\nwhile :\ndo\n        echo \"round --->\" $((var++))\n        python testTF.py\n        sleep 3\ndone\n\ntestTF.py\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\n\nimport os\nos.environ['CUDA_VISIBLE_DEVICES'] = '0'\n\n\nimport tensorflow as tf\nprint(\"START SESSION...\")\nsession = tf.Session()\nprint(\"...SESSION DONE\")\n\n\nThe error started to appear in Ubuntu 14.04 (where it freezes the workstation).\nUpdating to Ubuntu 16.04 makes the workstation more responsible, but a reboot is still necessary.\nobservations:\n\nI can not kill the PID of the python process when the load avg rises\nchanging to python3 did not resolve the issue\ncompiling tf (1.3.0) from source did not resolve the issue\n\n== cat /etc/issue ===============================================\nLinux bipower6 4.4.0-89-generic #112-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"16.04.3 LTS (Xenial Xerus)\"\nVERSION_ID=\"16.04\"\nVERSION_CODENAME=xenial\n== are we in docker =============================================\nNo\n== compiler =====================================================\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n== uname -a =====================================================\nLinux bipower6 4.4.0-89-generic #112-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n== check pips ===================================================\nnumpy (1.13.1)\nprotobuf (3.3.0)\ntensorflow-gpu (1.2.1)\n== check for virtualenv =========================================\nTrue\n== tensorflow import ============================================\ntf.VERSION = 1.2.1\ntf.GIT_VERSION = v1.2.0-5-g435cdfc\ntf.COMPILER_VERSION = v1.2.0-5-g435cdfc\nSanity check: array([1], dtype=int32)\n== env ==========================================================\nLD_LIBRARY_PATH /home/a/torch/install/lib:/home/a/torch/install/lib::/usr/local/cuda-8.0/lib64:/usr/local/cuda-8.0/:/usr/local/lib/:/usr/local/cuda-8.0/lib64:/usr/local/cuda-8.0/:/usr/local/lib/\nDYLD_LIBRARY_PATH /home/a/torch/install/lib:/home/a/torch/install/lib:\n== nvidia-smi ===================================================\nTue Aug 15 11:25:32 2017\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 375.66                 Driver Version: 375.66                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 1080    Off  | 0000:02:00.0     Off |                  N/A |\n| 29%   44C    P0    41W / 180W |      0MiB /  8114MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n|   1  TITAN X (Pascal)    Off  | 0000:04:00.0     Off |                  N/A |\n|  0%   52C    P0    56W / 250W |      0MiB / 12189MiB |      2%      Default |\n+-------------------------------+----------------------+----------------------+\n|   2  Tesla P40           Off  | 0000:83:00.0     Off |                    0 |\n| N/A   69C    P0   128W / 250W |  21897MiB / 22912MiB |     93%      Default |\n+-------------------------------+----------------------+----------------------+\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n|=============================================================================|\n|    2     89766    C   /home/a/dl/bin/python                        21895MiB |\n+-----------------------------------------------------------------------------+\n== cuda libs  ===================================================\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\n/usr/local/cuda-8.0/lib64/libcudart_static.a\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61\n/usr/local/cuda-7.5/doc/man/man7/libcudart.so.7\n/usr/local/cuda-7.5/doc/man/man7/libcudart.7\n/usr/local/cuda-7.5/lib/libcudart_static.a\n/usr/local/cuda-7.5/lib/libcudart.so.7.5.18\n/usr/local/cuda-7.5/lib64/libcudart_static.a\n/usr/local/cuda-7.5/lib64/libcudart.so.7.5.18\n(END)", "body": "The following script run.sh will increase load avg to several 100 (it takes usually 100 iterations)\r\n\r\nrun.sh\r\n```\r\n#!/bin/bash\r\nvar=0\r\nwhile :\r\ndo\r\n        echo \"round --->\" $((var++))\r\n        python testTF.py\r\n        sleep 3\r\ndone\r\n```\r\n\r\ntestTF.py\r\n```\r\n#!/usr/bin/python\r\n# -*- coding: utf-8 -*-\r\n\r\nimport os\r\nos.environ['CUDA_VISIBLE_DEVICES'] = '0'\r\n\r\n\r\nimport tensorflow as tf\r\nprint(\"START SESSION...\")\r\nsession = tf.Session()\r\nprint(\"...SESSION DONE\")\r\n\r\n```\r\n\r\nThe error started to appear in Ubuntu 14.04 (where it freezes the workstation).\r\nUpdating to Ubuntu 16.04 makes the workstation more responsible, but a reboot is still necessary.\r\nobservations:\r\n* I can not kill the PID of the python process when the load avg rises\r\n* changing to python3 did not resolve the issue\r\n* compiling tf (1.3.0) from source did not resolve the issue\r\n\r\n== cat /etc/issue ===============================================\r\nLinux bipower6 4.4.0-89-generic #112-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"16.04.3 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux bipower6 4.4.0-89-generic #112-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.1)\r\nprotobuf (3.3.0)\r\ntensorflow-gpu (1.2.1)\r\n\r\n== check for virtualenv =========================================\r\nTrue\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.2.1\r\ntf.GIT_VERSION = v1.2.0-5-g435cdfc\r\ntf.COMPILER_VERSION = v1.2.0-5-g435cdfc\r\nSanity check: array([1], dtype=int32)\r\n\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /home/a/torch/install/lib:/home/a/torch/install/lib::/usr/local/cuda-8.0/lib64:/usr/local/cuda-8.0/:/usr/local/lib/:/usr/local/cuda-8.0/lib64:/usr/local/cuda-8.0/:/usr/local/lib/\r\nDYLD_LIBRARY_PATH /home/a/torch/install/lib:/home/a/torch/install/lib:\r\n\r\n== nvidia-smi ===================================================\r\nTue Aug 15 11:25:32 2017\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 375.66                 Driver Version: 375.66                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1080    Off  | 0000:02:00.0     Off |                  N/A |\r\n| 29%   44C    P0    41W / 180W |      0MiB /  8114MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  TITAN X (Pascal)    Off  | 0000:04:00.0     Off |                  N/A |\r\n|  0%   52C    P0    56W / 250W |      0MiB / 12189MiB |      2%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  Tesla P40           Off  | 0000:83:00.0     Off |                    0 |\r\n| N/A   69C    P0   128W / 250W |  21897MiB / 22912MiB |     93%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID  Type  Process name                               Usage      |\r\n|=============================================================================|\r\n|    2     89766    C   /home/a/dl/bin/python                        21895MiB |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\r\n/usr/local/cuda-8.0/lib64/libcudart_static.a\r\n/usr/local/cuda-8.0/lib64/libcudart.so.8.0.61\r\n/usr/local/cuda-7.5/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-7.5/doc/man/man7/libcudart.7\r\n/usr/local/cuda-7.5/lib/libcudart_static.a\r\n/usr/local/cuda-7.5/lib/libcudart.so.7.5.18\r\n/usr/local/cuda-7.5/lib64/libcudart_static.a\r\n/usr/local/cuda-7.5/lib64/libcudart.so.7.5.18\r\n(END)\r\n\r\n\r\n"}