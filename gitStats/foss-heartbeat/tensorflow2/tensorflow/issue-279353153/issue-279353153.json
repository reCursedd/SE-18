{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15125", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15125/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15125/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15125/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/15125", "id": 279353153, "node_id": "MDExOlB1bGxSZXF1ZXN0MTU2NDQ2ODgy", "number": 15125, "title": "Improve the Windows Bazel build", "user": {"login": "meteorcloudy", "id": 4171702, "node_id": "MDQ6VXNlcjQxNzE3MDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/4171702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meteorcloudy", "html_url": "https://github.com/meteorcloudy", "followers_url": "https://api.github.com/users/meteorcloudy/followers", "following_url": "https://api.github.com/users/meteorcloudy/following{/other_user}", "gists_url": "https://api.github.com/users/meteorcloudy/gists{/gist_id}", "starred_url": "https://api.github.com/users/meteorcloudy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meteorcloudy/subscriptions", "organizations_url": "https://api.github.com/users/meteorcloudy/orgs", "repos_url": "https://api.github.com/users/meteorcloudy/repos", "events_url": "https://api.github.com/users/meteorcloudy/events{/privacy}", "received_events_url": "https://api.github.com/users/meteorcloudy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "fef2c0", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-12-05T12:13:31Z", "updated_at": "2018-03-05T15:18:58Z", "closed_at": "2017-12-06T18:51:56Z", "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/15125", "html_url": "https://github.com/tensorflow/tensorflow/pull/15125", "diff_url": "https://github.com/tensorflow/tensorflow/pull/15125.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/15125.patch"}, "body_html": "<p>In this PR, we are making following improvements:</p>\n<ol>\n<li>\n<p>Remove unnecessary environment variables.<br>\n<code>BAZEL_VS</code>: Bazel can detect Visual C++ installation<br>\n<code>BAZEL_PYTHON</code>: Not needed anymore since we don't use wrapper scripts.<br>\n<code>NO_MSVC_WRAPPER</code>: Already using wrapper-free CROSSTOOL by default.<br>\n<code>USE_DYNAMIC_CRT</code>: Bazel already links to dynamic msvcrt by default.</p>\n</li>\n<li>\n<p>Remove the <code>$BUILD_OPT</code> variable in <code>bazel_test_lib.sh</code>. Add these options in <code>configure.py</code>, this way our users don't have to remember them every time.</p>\n</li>\n<li>\n<p>Remove <code>bazel clean --expunge</code>. With Bazel 0.8.0, I'm quite confident to remove this so that we can benefit from cache.</p>\n</li>\n<li>\n<p>When <code>--define=no_tensorflow_py_deps=true</code>, we let <code>py_test</code> depend on a marker file for all dependencies of the pip package. By doing this, even without <code>bazel clean</code>, <code>py_test</code> also gets to rerun as long as the pip package changes.</p>\n</li>\n<li>\n<p>Filter out <code>external/org_tensorflow</code> directory, when creating the pip package.</p>\n</li>\n</ol>", "body_text": "In this PR, we are making following improvements:\n\n\nRemove unnecessary environment variables.\nBAZEL_VS: Bazel can detect Visual C++ installation\nBAZEL_PYTHON: Not needed anymore since we don't use wrapper scripts.\nNO_MSVC_WRAPPER: Already using wrapper-free CROSSTOOL by default.\nUSE_DYNAMIC_CRT: Bazel already links to dynamic msvcrt by default.\n\n\nRemove the $BUILD_OPT variable in bazel_test_lib.sh. Add these options in configure.py, this way our users don't have to remember them every time.\n\n\nRemove bazel clean --expunge. With Bazel 0.8.0, I'm quite confident to remove this so that we can benefit from cache.\n\n\nWhen --define=no_tensorflow_py_deps=true, we let py_test depend on a marker file for all dependencies of the pip package. By doing this, even without bazel clean, py_test also gets to rerun as long as the pip package changes.\n\n\nFilter out external/org_tensorflow directory, when creating the pip package.", "body": "In this PR, we are making following improvements:\r\n\r\n1. Remove unnecessary environment variables.\r\n    `BAZEL_VS`: Bazel can detect Visual C++ installation\r\n    `BAZEL_PYTHON`: Not needed anymore since we don't use wrapper scripts.\r\n    `NO_MSVC_WRAPPER`: Already using wrapper-free CROSSTOOL by default.\r\n    `USE_DYNAMIC_CRT`: Bazel already links to dynamic msvcrt by default.\r\n\r\n2. Remove the `$BUILD_OPT` variable in `bazel_test_lib.sh`. Add these options in `configure.py`, this way our users don't have to remember them every time.\r\n\r\n3. Remove `bazel clean --expunge`. With Bazel 0.8.0, I'm quite confident to remove this so that we can benefit from cache.\r\n\r\n4. When `--define=no_tensorflow_py_deps=true`, we let `py_test` depend on a marker file for all dependencies of the pip package. By doing this, even without `bazel clean`, `py_test` also gets to rerun as long as the pip package changes.\r\n\r\n5. Filter out `external/org_tensorflow` directory, when creating the pip package."}