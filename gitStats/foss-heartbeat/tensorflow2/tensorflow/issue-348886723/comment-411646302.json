{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/411646302", "html_url": "https://github.com/tensorflow/tensorflow/issues/21487#issuecomment-411646302", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21487", "id": 411646302, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTY0NjMwMg==", "user": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-09T06:00:47Z", "updated_at": "2018-08-09T06:00:47Z", "author_association": "MEMBER", "body_html": "<p>Well I just managed to reproduce the problem using your script. It turns out the error was caused by another problem: the device is not set in the engine and the converter will use default cuda malloc for memory allocation during the conversion. I'll fix it.</p>\n<p>As a work around, it should work if you add <code>with graph.device('gpu:0')</code> when building your model for training. Or you may read the <code>./log/freeze_graph.pb</code>, import it inside a <code>with graph.device('gpu:0')</code> context, write it out as a new <code>./log/freeze_graph.pb</code>, and use the new one to do the conversion.</p>", "body_text": "Well I just managed to reproduce the problem using your script. It turns out the error was caused by another problem: the device is not set in the engine and the converter will use default cuda malloc for memory allocation during the conversion. I'll fix it.\nAs a work around, it should work if you add with graph.device('gpu:0') when building your model for training. Or you may read the ./log/freeze_graph.pb, import it inside a with graph.device('gpu:0') context, write it out as a new ./log/freeze_graph.pb, and use the new one to do the conversion.", "body": "Well I just managed to reproduce the problem using your script. It turns out the error was caused by another problem: the device is not set in the engine and the converter will use default cuda malloc for memory allocation during the conversion. I'll fix it.\r\n\r\nAs a work around, it should work if you add `with graph.device('gpu:0')` when building your model for training. Or you may read the `./log/freeze_graph.pb`, import it inside a `with graph.device('gpu:0')` context, write it out as a new `./log/freeze_graph.pb`, and use the new one to do the conversion."}