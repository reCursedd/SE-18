{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5435", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5435/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5435/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5435/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5435", "id": 187619835, "node_id": "MDU6SXNzdWUxODc2MTk4MzU=", "number": 5435, "title": "User defined op without input + control dependencies causes op execution error", "user": {"login": "skydoorkai", "id": 16055370, "node_id": "MDQ6VXNlcjE2MDU1Mzcw", "avatar_url": "https://avatars2.githubusercontent.com/u/16055370?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skydoorkai", "html_url": "https://github.com/skydoorkai", "followers_url": "https://api.github.com/users/skydoorkai/followers", "following_url": "https://api.github.com/users/skydoorkai/following{/other_user}", "gists_url": "https://api.github.com/users/skydoorkai/gists{/gist_id}", "starred_url": "https://api.github.com/users/skydoorkai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skydoorkai/subscriptions", "organizations_url": "https://api.github.com/users/skydoorkai/orgs", "repos_url": "https://api.github.com/users/skydoorkai/repos", "events_url": "https://api.github.com/users/skydoorkai/events{/privacy}", "received_events_url": "https://api.github.com/users/skydoorkai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-11-07T03:50:31Z", "updated_at": "2016-11-27T21:07:18Z", "closed_at": "2016-11-27T21:07:18Z", "author_association": "NONE", "body_html": "<ol>\n<li>\n<p>Define a user-defined op without input, with 1 output:<br>\nREGISTER_OP(\"MyOp\")<br>\n.Output(\"output: T\")<br>\n.Attr(.....)</p>\n</li>\n<li>\n<p>in python code:<br>\nop1 = my_op(attrs)</p>\n</li>\n</ol>\n<p>with tf.control_dependencies([op1]):<br>\nop2 = otherOp</p>\n<p>This runs OK, both op1 and op2 execute once:<br>\nsess.run(op2)</p>\n<p>This is WRONG:<br>\nsess.run([op1, op2])<br>\nop1 will execute 2 times.</p>\n<p>If adding an input for MyOp, op1 will execute only once as expected for<br>\nsess.run([op1, op2])</p>", "body_text": "Define a user-defined op without input, with 1 output:\nREGISTER_OP(\"MyOp\")\n.Output(\"output: T\")\n.Attr(.....)\n\n\nin python code:\nop1 = my_op(attrs)\n\n\nwith tf.control_dependencies([op1]):\nop2 = otherOp\nThis runs OK, both op1 and op2 execute once:\nsess.run(op2)\nThis is WRONG:\nsess.run([op1, op2])\nop1 will execute 2 times.\nIf adding an input for MyOp, op1 will execute only once as expected for\nsess.run([op1, op2])", "body": "1. Define a user-defined op without input, with 1 output:\r\nREGISTER_OP(\"MyOp\")\r\n  .Output(\"output: T\")\r\n  .Attr(.....)\r\n\r\n2. in python code:\r\nop1 = my_op(attrs)\r\n\r\nwith tf.control_dependencies([op1]):\r\n  op2 = otherOp\r\n\r\nThis runs OK, both op1 and op2 execute once:\r\nsess.run(op2)\r\n\r\n\r\nThis is WRONG:\r\nsess.run([op1, op2])\r\nop1 will execute 2 times.\r\n\r\nIf adding an input for MyOp, op1 will execute only once as expected for \r\n sess.run([op1, op2])"}