{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/231734133", "pull_request_review_id": 172768511, "id": 231734133, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTczNDEzMw==", "diff_hunk": "@@ -60,28 +60,34 @@ def _interpolate_bilinear(grid,\n       msg = 'Grid must be 4 dimensional. Received size: '\n       raise ValueError(msg + str(grid.get_shape()))\n \n-    batch_size, height, width, channels = shape\n+    batch_size, height, width, channels = \\\n+      array_ops.shape(grid)[0], \\\n+      array_ops.shape(grid)[1], \\\n+      array_ops.shape(grid)[2], \\\n+      array_ops.shape(grid)[3]\n+    shape = [batch_size, height, width, channels]\n     query_type = query_points.dtype\n     grid_type = grid.dtype\n \n-    if (query_points.shape.rank != 3 or\n-        query_points.shape.dims[2].value != 2):\n-      msg = ('Query points must be 3 dimensional and size 2 in dim 2. Received '\n-             'size: ')\n-      raise ValueError(msg + str(query_points.get_shape()))\n-\n-    _, num_queries, _ = query_points.get_shape().as_list()\n-\n-    if height < 2 or width < 2:\n-      msg = 'Grid must be at least batch_size x 2 x 2 in size. Received size: '\n-      raise ValueError(msg + str(grid.get_shape()))\n-\n-    alphas = []\n-    floors = []\n-    ceils = []\n-\n-    index_order = [0, 1] if indexing == 'ij' else [1, 0]\n-    unstacked_query_points = array_ops.unstack(query_points, axis=2)\n+    with ops.control_dependencies([\n+        check_ops.assert_equal(len(query_points.get_shape()), 3, message=\n+                               'Query points must be 3 dimensional'),\n+        check_ops.assert_equal(array_ops.shape(query_points)[2], 2, message=\n+                               'Query points must be size 2 in dim 2.')]):\n+      num_queries = array_ops.shape(query_points)[1]\n+\n+    with ops.control_dependencies([\n+        check_ops.assert_greater_equal(height, 2, message=\n+                                       'Grid must be at least batch_size'\n+                                       'x 2 x 2 in size.'),", "path": "tensorflow/contrib/image/python/ops/dense_image_warp.py", "position": null, "original_position": 51, "commit_id": "917bd04d77a6872e8ecf31bbe0a1143dc98b6e8c", "original_commit_id": "2711e155b9d4ce280efe52d00d65a2b52c5be473", "user": {"login": "fcole", "id": 508398, "node_id": "MDQ6VXNlcjUwODM5OA==", "avatar_url": "https://avatars2.githubusercontent.com/u/508398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fcole", "html_url": "https://github.com/fcole", "followers_url": "https://api.github.com/users/fcole/followers", "following_url": "https://api.github.com/users/fcole/following{/other_user}", "gists_url": "https://api.github.com/users/fcole/gists{/gist_id}", "starred_url": "https://api.github.com/users/fcole/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fcole/subscriptions", "organizations_url": "https://api.github.com/users/fcole/orgs", "repos_url": "https://api.github.com/users/fcole/repos", "events_url": "https://api.github.com/users/fcole/events{/privacy}", "received_events_url": "https://api.github.com/users/fcole/received_events", "type": "User", "site_admin": false}, "body": "Since the condition is broken into two pieces, might as well change the message to something like \"Grid height must be at least 2\"", "created_at": "2018-11-08T00:57:25Z", "updated_at": "2018-11-08T06:54:54Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/23394#discussion_r231734133", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/23394", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/231734133"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/23394#discussion_r231734133"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/23394"}}, "body_html": "<p>Since the condition is broken into two pieces, might as well change the message to something like \"Grid height must be at least 2\"</p>", "body_text": "Since the condition is broken into two pieces, might as well change the message to something like \"Grid height must be at least 2\""}