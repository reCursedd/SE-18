{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/206684340", "pull_request_review_id": 142146478, "id": 206684340, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjY4NDM0MA==", "diff_hunk": "@@ -1330,8 +1706,10 @@ class MklFusedBatchNormGradOp : public OpKernel {\n     dnn_shape_diff_src.SetMklTensor(false);\n     AllocateOutputSetMklShape(context, kDiffSrcIndex, diff_src_tensor,\n                               tf_shape_src, dnn_shape_diff_src);\n-    for (size_t i = 0; i < (*diff_src_tensor)->shape().num_elements(); i++)\n-      (*diff_src_tensor)->flat<T>().data()[i] = 0;\n+    int num_elements = (*diff_src_tensor)->shape().num_elements();\n+    auto diff_src_data = (*diff_src_tensor)->flat<T>().data();\n+    for (size_t i = 0; i < num_elements; i++)", "path": "tensorflow/core/kernels/mkl_fused_batch_norm_op.cc", "position": null, "original_position": 1075, "commit_id": "8e2f587b95cda1f67deaa4ae315c7540444919f5", "original_commit_id": "abfc8525faee0c0587f454ccd928674c1538bb6f", "user": {"login": "gzmkl", "id": 29215195, "node_id": "MDQ6VXNlcjI5MjE1MTk1", "avatar_url": "https://avatars0.githubusercontent.com/u/29215195?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gzmkl", "html_url": "https://github.com/gzmkl", "followers_url": "https://api.github.com/users/gzmkl/followers", "following_url": "https://api.github.com/users/gzmkl/following{/other_user}", "gists_url": "https://api.github.com/users/gzmkl/gists{/gist_id}", "starred_url": "https://api.github.com/users/gzmkl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gzmkl/subscriptions", "organizations_url": "https://api.github.com/users/gzmkl/orgs", "repos_url": "https://api.github.com/users/gzmkl/repos", "events_url": "https://api.github.com/users/gzmkl/events{/privacy}", "received_events_url": "https://api.github.com/users/gzmkl/received_events", "type": "User", "site_admin": false}, "body": "I have done code refactoring for multiple places in mkl_fused_batch_norm_op.cc. \r\n\r\nTo avoid potential merge conflicts, I did not apply this code change recommendation to\r\nsource files not related to this PR. \r\n\r\nWe will include this suggestion, along with others (such as changing signature of Execute()\r\nwith proper const or non-const argument declarations), to create a separate \"code clean up\"\r\nPR. \r\n\r\nThanks!", "created_at": "2018-07-31T21:09:00Z", "updated_at": "2018-07-31T21:09:00Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/19402#discussion_r206684340", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/19402", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/206684340"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/19402#discussion_r206684340"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/19402"}}, "body_html": "<p>I have done code refactoring for multiple places in mkl_fused_batch_norm_op.cc.</p>\n<p>To avoid potential merge conflicts, I did not apply this code change recommendation to<br>\nsource files not related to this PR.</p>\n<p>We will include this suggestion, along with others (such as changing signature of Execute()<br>\nwith proper const or non-const argument declarations), to create a separate \"code clean up\"<br>\nPR.</p>\n<p>Thanks!</p>", "body_text": "I have done code refactoring for multiple places in mkl_fused_batch_norm_op.cc.\nTo avoid potential merge conflicts, I did not apply this code change recommendation to\nsource files not related to this PR.\nWe will include this suggestion, along with others (such as changing signature of Execute()\nwith proper const or non-const argument declarations), to create a separate \"code clean up\"\nPR.\nThanks!", "in_reply_to_id": 206586211}