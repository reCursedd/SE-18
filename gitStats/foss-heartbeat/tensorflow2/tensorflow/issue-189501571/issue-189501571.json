{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5628", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5628/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5628/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5628/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5628", "id": 189501571, "node_id": "MDU6SXNzdWUxODk1MDE1NzE=", "number": 5628, "title": "Checkpoint SNAPPY compression, incompatible for inference?", "user": {"login": "petteriTeikari", "id": 1060514, "node_id": "MDQ6VXNlcjEwNjA1MTQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1060514?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petteriTeikari", "html_url": "https://github.com/petteriTeikari", "followers_url": "https://api.github.com/users/petteriTeikari/followers", "following_url": "https://api.github.com/users/petteriTeikari/following{/other_user}", "gists_url": "https://api.github.com/users/petteriTeikari/gists{/gist_id}", "starred_url": "https://api.github.com/users/petteriTeikari/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petteriTeikari/subscriptions", "organizations_url": "https://api.github.com/users/petteriTeikari/orgs", "repos_url": "https://api.github.com/users/petteriTeikari/repos", "events_url": "https://api.github.com/users/petteriTeikari/events{/privacy}", "received_events_url": "https://api.github.com/users/petteriTeikari/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "alexalemi", "id": 487667, "node_id": "MDQ6VXNlcjQ4NzY2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/487667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexalemi", "html_url": "https://github.com/alexalemi", "followers_url": "https://api.github.com/users/alexalemi/followers", "following_url": "https://api.github.com/users/alexalemi/following{/other_user}", "gists_url": "https://api.github.com/users/alexalemi/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexalemi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexalemi/subscriptions", "organizations_url": "https://api.github.com/users/alexalemi/orgs", "repos_url": "https://api.github.com/users/alexalemi/repos", "events_url": "https://api.github.com/users/alexalemi/events{/privacy}", "received_events_url": "https://api.github.com/users/alexalemi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alexalemi", "id": 487667, "node_id": "MDQ6VXNlcjQ4NzY2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/487667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexalemi", "html_url": "https://github.com/alexalemi", "followers_url": "https://api.github.com/users/alexalemi/followers", "following_url": "https://api.github.com/users/alexalemi/following{/other_user}", "gists_url": "https://api.github.com/users/alexalemi/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexalemi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexalemi/subscriptions", "organizations_url": "https://api.github.com/users/alexalemi/orgs", "repos_url": "https://api.github.com/users/alexalemi/repos", "events_url": "https://api.github.com/users/alexalemi/events{/privacy}", "received_events_url": "https://api.github.com/users/alexalemi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-11-15T20:44:01Z", "updated_at": "2017-06-16T16:43:52Z", "closed_at": "2017-06-16T16:43:52Z", "author_association": "NONE", "body_html": "<p>As referenced in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"143838193\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1669\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1669/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1669\">#1669</a>, I got the same error when trying to restore from self-finetuned checkpoint</p>\n<blockquote>\n<p>\"Data loss: Unable to open table file /tmp/model.ckpt-4971: Data loss: corrupted compressed block contents: perhaps your file is in a different file format and you need to use a different restore operator? It's likely that your checkpoint file has been compressed with SNAPPY.\"</p>\n</blockquote>\n<p>I fine-tuned the checkpoint <code>inception_resnet_v2_2016_08_30.ckpt</code> for my own images TF-Slim (modified <a href=\"https://github.com/tensorflow/models/blob/master/slim/scripts/finetune_inception_v3_on_flowers.sh\">finetune_inception_v3_on_flowers.sh</a>). The fine-tuning seems to go well, and I get good performance for the test error. But when I try to do inference using the newly created checkpoint I got the above-mentioned same error, the same error happening with with <code>inspect_checkpoint</code> -tool.</p>\n<p>The demo inference from there works fine as well: <a href=\"https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb\">https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb</a></p>\n<p>In other words, how to save the checkpoints with compatible compression? And how is it possible to save checkpoints on my computer (Ubuntu 14.04, TF 0.11.0rc2, CUDA 8.0) which are not possible to open a moment later?</p>", "body_text": "As referenced in #1669, I got the same error when trying to restore from self-finetuned checkpoint\n\n\"Data loss: Unable to open table file /tmp/model.ckpt-4971: Data loss: corrupted compressed block contents: perhaps your file is in a different file format and you need to use a different restore operator? It's likely that your checkpoint file has been compressed with SNAPPY.\"\n\nI fine-tuned the checkpoint inception_resnet_v2_2016_08_30.ckpt for my own images TF-Slim (modified finetune_inception_v3_on_flowers.sh). The fine-tuning seems to go well, and I get good performance for the test error. But when I try to do inference using the newly created checkpoint I got the above-mentioned same error, the same error happening with with inspect_checkpoint -tool.\nThe demo inference from there works fine as well: https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb\nIn other words, how to save the checkpoints with compatible compression? And how is it possible to save checkpoints on my computer (Ubuntu 14.04, TF 0.11.0rc2, CUDA 8.0) which are not possible to open a moment later?", "body": "As referenced in [https://github.com/tensorflow/tensorflow/issues/1669](https://github.com/tensorflow/tensorflow/issues/1669), I got the same error when trying to restore from self-finetuned checkpoint\r\n\r\n> \"Data loss: Unable to open table file /tmp/model.ckpt-4971: Data loss: corrupted compressed block contents: perhaps your file is in a different file format and you need to use a different restore operator? It's likely that your checkpoint file has been compressed with SNAPPY.\"\r\n\r\nI fine-tuned the checkpoint `inception_resnet_v2_2016_08_30.ckpt` for my own images TF-Slim (modified [finetune_inception_v3_on_flowers.sh](https://github.com/tensorflow/models/blob/master/slim/scripts/finetune_inception_v3_on_flowers.sh)). The fine-tuning seems to go well, and I get good performance for the test error. But when I try to do inference using the newly created checkpoint I got the above-mentioned same error, the same error happening with with `inspect_checkpoint` -tool.\r\n\r\nThe demo inference from there works fine as well: [https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb](https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb)\r\n\r\nIn other words, how to save the checkpoints with compatible compression? And how is it possible to save checkpoints on my computer (Ubuntu 14.04, TF 0.11.0rc2, CUDA 8.0) which are not possible to open a moment later?"}