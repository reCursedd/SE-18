{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2407", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2407/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2407/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2407/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2407", "id": 155290062, "node_id": "MDU6SXNzdWUxNTUyOTAwNjI=", "number": 2407, "title": "TF learn has a problem with discontinuous categorical outputs", "user": {"login": "vinhqdang", "id": 4891112, "node_id": "MDQ6VXNlcjQ4OTExMTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/4891112?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vinhqdang", "html_url": "https://github.com/vinhqdang", "followers_url": "https://api.github.com/users/vinhqdang/followers", "following_url": "https://api.github.com/users/vinhqdang/following{/other_user}", "gists_url": "https://api.github.com/users/vinhqdang/gists{/gist_id}", "starred_url": "https://api.github.com/users/vinhqdang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vinhqdang/subscriptions", "organizations_url": "https://api.github.com/users/vinhqdang/orgs", "repos_url": "https://api.github.com/users/vinhqdang/repos", "events_url": "https://api.github.com/users/vinhqdang/events{/privacy}", "received_events_url": "https://api.github.com/users/vinhqdang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2016-05-17T15:30:54Z", "updated_at": "2016-06-07T16:11:27Z", "closed_at": "2016-06-07T16:11:26Z", "author_association": "NONE", "body_html": "<p>I have a <code>train.csv</code> which looks like:</p>\n<pre><code>v1,v2,v3\n5,4,10\n1,2,5\n4,5,20\n1,11,50\n1,12,20\n</code></pre>\n<p>and <code>test.csv</code>:</p>\n<pre><code>v1,v2\n4,5\n2,3\n2,4\n5,6\n</code></pre>\n<p>The idea is: the output variable (<code>v3</code>) can take four values:  <code>5,10,20,50</code> and nothing more. It is classification task.</p>\n<p>Then code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n<span class=\"pl-k\">import</span> pandas <span class=\"pl-k\">as</span> pd\n<span class=\"pl-k\">from</span> tensorflow.contrib <span class=\"pl-k\">import</span> learn\n\n<span class=\"pl-c1\">print</span> (<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Reading data<span class=\"pl-pds\">\"</span></span>)\n\ndf_train <span class=\"pl-k\">=</span> pd.read_csv(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>train.csv<span class=\"pl-pds\">\"</span></span>)\ndf_test <span class=\"pl-k\">=</span> pd.read_csv(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>test.csv<span class=\"pl-pds\">\"</span></span>)\n\n<span class=\"pl-c1\">print</span> (<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Dividing to train and test set<span class=\"pl-pds\">\"</span></span>)\n\ny_train <span class=\"pl-k\">=</span> df_train [<span class=\"pl-s\"><span class=\"pl-pds\">'</span>v3<span class=\"pl-pds\">'</span></span>]\nX_train <span class=\"pl-k\">=</span> df_train [[<span class=\"pl-s\"><span class=\"pl-pds\">'</span>v1<span class=\"pl-pds\">'</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">'</span>v2<span class=\"pl-pds\">'</span></span>]]\n\nX_test <span class=\"pl-k\">=</span> df_test[[<span class=\"pl-s\"><span class=\"pl-pds\">'</span>v1<span class=\"pl-pds\">'</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">'</span>v2<span class=\"pl-pds\">'</span></span>]]\n\nclassifier_1 <span class=\"pl-k\">=</span> learn.TensorFlowDNNClassifier(\n     <span class=\"pl-v\">hidden_units</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">20</span>, <span class=\"pl-c1\">10</span>], \n     <span class=\"pl-v\">n_classes</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">4</span>, \n     <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">128</span>, \n     <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">500</span>, \n     <span class=\"pl-v\">learning_rate</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0.05</span>)\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> fit</span>\n<span class=\"pl-c1\">print</span> (<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Fitting<span class=\"pl-pds\">\"</span></span>)\nclassifier_1.fit(X_train, y_train)</pre></div>\n<p>Then I have a problem:</p>\n<pre><code>Traceback (most recent call last):\n  File \"sample.py\", line 26, in &lt;module&gt;\n    classifier_1.fit(X_train, y_train)\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 254, in fit\n    feed_params_fn=self._data_feeder.get_feed_params)\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/trainer.py\", line 49, in train\n    feed_dict = feed_dict_fn()\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/io/data_feeder.py\", line 281, in _feed_dict_fn\n    out.itemset((i, self.y[sample]), 1.0)\nIndexError: index 5 is out of bounds for axis 1 with size 4\n</code></pre>\n<p>I think the issue is because the absolute value of output value (<code>5</code>) is larger than the number of classes (<code>4</code>)</p>", "body_text": "I have a train.csv which looks like:\nv1,v2,v3\n5,4,10\n1,2,5\n4,5,20\n1,11,50\n1,12,20\n\nand test.csv:\nv1,v2\n4,5\n2,3\n2,4\n5,6\n\nThe idea is: the output variable (v3) can take four values:  5,10,20,50 and nothing more. It is classification task.\nThen code:\nimport numpy as np\nimport pandas as pd\nfrom tensorflow.contrib import learn\n\nprint (\"Reading data\")\n\ndf_train = pd.read_csv(\"train.csv\")\ndf_test = pd.read_csv(\"test.csv\")\n\nprint (\"Dividing to train and test set\")\n\ny_train = df_train ['v3']\nX_train = df_train [['v1','v2']]\n\nX_test = df_test[['v1','v2']]\n\nclassifier_1 = learn.TensorFlowDNNClassifier(\n     hidden_units=[20, 10], \n     n_classes=4, \n     batch_size=128, \n     steps=500, \n     learning_rate=0.05)\n\n# fit\nprint (\"Fitting\")\nclassifier_1.fit(X_train, y_train)\nThen I have a problem:\nTraceback (most recent call last):\n  File \"sample.py\", line 26, in <module>\n    classifier_1.fit(X_train, y_train)\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 254, in fit\n    feed_params_fn=self._data_feeder.get_feed_params)\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/trainer.py\", line 49, in train\n    feed_dict = feed_dict_fn()\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/io/data_feeder.py\", line 281, in _feed_dict_fn\n    out.itemset((i, self.y[sample]), 1.0)\nIndexError: index 5 is out of bounds for axis 1 with size 4\n\nI think the issue is because the absolute value of output value (5) is larger than the number of classes (4)", "body": "I have a `train.csv` which looks like:\n\n```\nv1,v2,v3\n5,4,10\n1,2,5\n4,5,20\n1,11,50\n1,12,20\n```\n\nand `test.csv`:\n\n```\nv1,v2\n4,5\n2,3\n2,4\n5,6\n```\n\nThe idea is: the output variable (`v3`) can take four values:  `5,10,20,50` and nothing more. It is classification task.\n\nThen code:\n\n``` python\nimport numpy as np\nimport pandas as pd\nfrom tensorflow.contrib import learn\n\nprint (\"Reading data\")\n\ndf_train = pd.read_csv(\"train.csv\")\ndf_test = pd.read_csv(\"test.csv\")\n\nprint (\"Dividing to train and test set\")\n\ny_train = df_train ['v3']\nX_train = df_train [['v1','v2']]\n\nX_test = df_test[['v1','v2']]\n\nclassifier_1 = learn.TensorFlowDNNClassifier(\n     hidden_units=[20, 10], \n     n_classes=4, \n     batch_size=128, \n     steps=500, \n     learning_rate=0.05)\n\n# fit\nprint (\"Fitting\")\nclassifier_1.fit(X_train, y_train)\n```\n\nThen I have a problem:\n\n```\nTraceback (most recent call last):\n  File \"sample.py\", line 26, in <module>\n    classifier_1.fit(X_train, y_train)\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 254, in fit\n    feed_params_fn=self._data_feeder.get_feed_params)\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/trainer.py\", line 49, in train\n    feed_dict = feed_dict_fn()\n  File \"/Users/qdang/anaconda/envs/tensorflow/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/io/data_feeder.py\", line 281, in _feed_dict_fn\n    out.itemset((i, self.y[sample]), 1.0)\nIndexError: index 5 is out of bounds for axis 1 with size 4\n```\n\nI think the issue is because the absolute value of output value (`5`) is larger than the number of classes (`4`)\n"}