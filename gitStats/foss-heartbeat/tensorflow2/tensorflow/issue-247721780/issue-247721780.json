{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12003", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12003/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12003/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12003/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12003", "id": 247721780, "node_id": "MDU6SXNzdWUyNDc3MjE3ODA=", "number": 12003, "title": "top_k doesn't order lower index first if two elements are equals", "user": {"login": "louishenrifranc", "id": 14858778, "node_id": "MDQ6VXNlcjE0ODU4Nzc4", "avatar_url": "https://avatars0.githubusercontent.com/u/14858778?v=4", "gravatar_id": "", "url": "https://api.github.com/users/louishenrifranc", "html_url": "https://github.com/louishenrifranc", "followers_url": "https://api.github.com/users/louishenrifranc/followers", "following_url": "https://api.github.com/users/louishenrifranc/following{/other_user}", "gists_url": "https://api.github.com/users/louishenrifranc/gists{/gist_id}", "starred_url": "https://api.github.com/users/louishenrifranc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/louishenrifranc/subscriptions", "organizations_url": "https://api.github.com/users/louishenrifranc/orgs", "repos_url": "https://api.github.com/users/louishenrifranc/repos", "events_url": "https://api.github.com/users/louishenrifranc/events{/privacy}", "received_events_url": "https://api.github.com/users/louishenrifranc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, {"login": "poxvoculi", "id": 15676913, "node_id": "MDQ6VXNlcjE1Njc2OTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15676913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poxvoculi", "html_url": "https://github.com/poxvoculi", "followers_url": "https://api.github.com/users/poxvoculi/followers", "following_url": "https://api.github.com/users/poxvoculi/following{/other_user}", "gists_url": "https://api.github.com/users/poxvoculi/gists{/gist_id}", "starred_url": "https://api.github.com/users/poxvoculi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poxvoculi/subscriptions", "organizations_url": "https://api.github.com/users/poxvoculi/orgs", "repos_url": "https://api.github.com/users/poxvoculi/repos", "events_url": "https://api.github.com/users/poxvoculi/events{/privacy}", "received_events_url": "https://api.github.com/users/poxvoculi/received_events", "type": "User", "site_admin": false}, {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2017-08-03T14:18:13Z", "updated_at": "2017-08-31T12:36:07Z", "closed_at": "2017-08-29T16:57:46Z", "author_association": "NONE", "body_html": "<h1>Bug</h1>\n<p>If two elements are equal, <code>top_k</code> is not ordering them by index value.</p>\n<h1>Reproducing the error</h1>\n<p>Here is the command I am running</p>\n<pre><code>import tensorflow as tf\nsess = tf.Session()\n sess.run(tf.nn.top_k(tf.convert_to_tensor([0, 0, 0, 0]), k=3))\n</code></pre>\n<p>And here is the output for Tensorflow 1.3.0-rc0</p>\n<pre><code>TopKV2(values=array([0, 0, 0], dtype=int32), indices=array([1, 3, 0], dtype=int32))\n</code></pre>\n<p>compared to version 1.2.1</p>\n<pre><code>TopKV2(values=array([0, 0, 0]), indices=array([0, 1, 2]))\n</code></pre>\n<h1>Setup</h1>\n<p>Running <code>tf_env_collect.sh</code>:</p>\n<pre><code>\n== cat /etc/issue ===============================================\nLinux 0187adfde6c8 4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\nVERSION_ID=\"16.04\"\nVERSION_CODENAME=xenial\n\n== are we in docker =============================================\nYes\n\n== compiler =====================================================\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\n== uname -a =====================================================\nLinux 0187adfde6c8 4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.12.1)\nprotobuf (3.3.0)\ntensorflow (1.3.0rc0)\ntensorflow-tensorboard (0.1.2)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.3.0-rc0\ntf.GIT_VERSION = b'unknown'\ntf.COMPILER_VERSION = b'unknown'\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\ntf_env_collect.sh: line 90: nvidia-smi: command not found\n\n== cuda libs  ===================================================\n</code></pre>", "body_text": "Bug\nIf two elements are equal, top_k is not ordering them by index value.\nReproducing the error\nHere is the command I am running\nimport tensorflow as tf\nsess = tf.Session()\n sess.run(tf.nn.top_k(tf.convert_to_tensor([0, 0, 0, 0]), k=3))\n\nAnd here is the output for Tensorflow 1.3.0-rc0\nTopKV2(values=array([0, 0, 0], dtype=int32), indices=array([1, 3, 0], dtype=int32))\n\ncompared to version 1.2.1\nTopKV2(values=array([0, 0, 0]), indices=array([0, 1, 2]))\n\nSetup\nRunning tf_env_collect.sh:\n\n== cat /etc/issue ===============================================\nLinux 0187adfde6c8 4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\nVERSION_ID=\"16.04\"\nVERSION_CODENAME=xenial\n\n== are we in docker =============================================\nYes\n\n== compiler =====================================================\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\n== uname -a =====================================================\nLinux 0187adfde6c8 4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.12.1)\nprotobuf (3.3.0)\ntensorflow (1.3.0rc0)\ntensorflow-tensorboard (0.1.2)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.3.0-rc0\ntf.GIT_VERSION = b'unknown'\ntf.COMPILER_VERSION = b'unknown'\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\ntf_env_collect.sh: line 90: nvidia-smi: command not found\n\n== cuda libs  ===================================================", "body": "# Bug\r\nIf two elements are equal, ```top_k``` is not ordering them by index value.\r\n\r\n# Reproducing the error\r\nHere is the command I am running\r\n```\r\nimport tensorflow as tf\r\nsess = tf.Session()\r\n sess.run(tf.nn.top_k(tf.convert_to_tensor([0, 0, 0, 0]), k=3))\r\n```\r\n\r\nAnd here is the output for Tensorflow 1.3.0-rc0\r\n```\r\nTopKV2(values=array([0, 0, 0], dtype=int32), indices=array([1, 3, 0], dtype=int32))\r\n```\r\ncompared to version 1.2.1\r\n```\r\nTopKV2(values=array([0, 0, 0]), indices=array([0, 1, 2]))\r\n```\r\n\r\n# Setup\r\nRunning ```tf_env_collect.sh```:\r\n```\r\n\r\n== cat /etc/issue ===============================================\r\nLinux 0187adfde6c8 4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"16.04.2 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nYes\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux 0187adfde6c8 4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.12.1)\r\nprotobuf (3.3.0)\r\ntensorflow (1.3.0rc0)\r\ntensorflow-tensorboard (0.1.2)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.3.0-rc0\r\ntf.GIT_VERSION = b'unknown'\r\ntf.COMPILER_VERSION = b'unknown'\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\ntf_env_collect.sh: line 90: nvidia-smi: command not found\r\n\r\n== cuda libs  ===================================================\r\n```\r\n"}