{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/391776881", "html_url": "https://github.com/tensorflow/tensorflow/issues/18473#issuecomment-391776881", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18473", "id": 391776881, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTc3Njg4MQ==", "user": {"login": "advaza", "id": 28333746, "node_id": "MDQ6VXNlcjI4MzMzNzQ2", "avatar_url": "https://avatars3.githubusercontent.com/u/28333746?v=4", "gravatar_id": "", "url": "https://api.github.com/users/advaza", "html_url": "https://github.com/advaza", "followers_url": "https://api.github.com/users/advaza/followers", "following_url": "https://api.github.com/users/advaza/following{/other_user}", "gists_url": "https://api.github.com/users/advaza/gists{/gist_id}", "starred_url": "https://api.github.com/users/advaza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/advaza/subscriptions", "organizations_url": "https://api.github.com/users/advaza/orgs", "repos_url": "https://api.github.com/users/advaza/repos", "events_url": "https://api.github.com/users/advaza/events{/privacy}", "received_events_url": "https://api.github.com/users/advaza/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-24T16:26:09Z", "updated_at": "2018-05-24T16:26:35Z", "author_association": "NONE", "body_html": "<p>Hi Igor <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=234070\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/isaprykin\">@isaprykin</a> !</p>\n<p>I just changed the code and removed slim but still the same error occurs.<br>\nI will update the configuration settings, code, and traceback.</p>\n<p><strong>System information</strong></p>\n<p><strong>OS Platform and Distribution:</strong> Linux Ubuntu 16.04.3 LTS<br>\n<strong>TensorFlow installed from:</strong> pip<br>\n<strong>TensorFlow version:</strong> tensorflow-gpu==1.8.0rc0<br>\n<strong>Python version:</strong> 3.5<br>\n<strong>Bazel version:</strong> N/A<br>\n<strong>GCC/Compiler version:</strong> N/A<br>\n<strong>CUDA/cuDNN version:</strong> 9/7<br>\n<strong>GPU model and memory:</strong> 8 GPUs of Tesla K80, memory 488, GPU memory 96<br>\n<strong>CPUs:</strong> 32</p>\n<p>Code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> glob, os\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Initialization of args - arguments parser.</span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">init</span>():\n    <span class=\"pl-k\">pass</span>\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">distribution_strategy</span>(<span class=\"pl-smi\">num_gpus</span>):\n\n    <span class=\"pl-k\">if</span> num_gpus <span class=\"pl-k\">==</span> <span class=\"pl-c1\">1</span>:\n        <span class=\"pl-k\">return</span> tf.contrib.distribute.OneDeviceStrategy(<span class=\"pl-v\">device</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>/gpu:0<span class=\"pl-pds\">'</span></span>)\n    <span class=\"pl-k\">elif</span> num_gpus <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">1</span>:\n        <span class=\"pl-k\">return</span> tf.contrib.distribute.MirroredStrategy(<span class=\"pl-v\">num_gpus</span><span class=\"pl-k\">=</span>num_gpus)\n    <span class=\"pl-k\">else</span>:\n        <span class=\"pl-k\">return</span> <span class=\"pl-c1\">None</span>\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">input_fn</span>():\n\n    <span class=\"pl-k\">with</span> tf.device(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/cpu:0<span class=\"pl-pds\">'</span></span>):\n\n        dataset <span class=\"pl-k\">=</span> tf.data.TFRecordDataset(\n            glob.glob(os.path.join(args.train_data_dir, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>train*<span class=\"pl-pds\">'</span></span>))\n        )\n        dataset <span class=\"pl-k\">=</span> dataset.map(\n                    <span class=\"pl-k\">lambda</span> <span class=\"pl-smi\">x</span>: parse_and_preprocess_image(x, args.image_size),\n                    <span class=\"pl-v\">num_parallel_calls</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">2</span>,\n        )\n        dataset <span class=\"pl-k\">=</span> dataset.repeat()\n        dataset <span class=\"pl-k\">=</span> dataset.batch(<span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">4</span>)\n        dataset <span class=\"pl-k\">=</span> dataset.prefetch(<span class=\"pl-c1\">1</span>)\n\n        <span class=\"pl-k\">return</span> dataset\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">model_fn</span>(<span class=\"pl-smi\">features</span>):\n\n    train_images_batch <span class=\"pl-k\">=</span> features\n    res <span class=\"pl-k\">=</span> tf.layers.conv2d(<span class=\"pl-v\">inputs</span><span class=\"pl-k\">=</span>train_images_batch, <span class=\"pl-v\">filters</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">3</span>, <span class=\"pl-v\">kernel_size</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">9</span>,<span class=\"pl-c1\">9</span>], \n                           <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>conv1<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">padding</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>same<span class=\"pl-pds\">'</span></span>)\n    loss <span class=\"pl-k\">=</span> tf.reduce_mean((train_images_batch <span class=\"pl-k\">-</span> res) <span class=\"pl-k\">**</span> <span class=\"pl-c1\">2</span>)\n    optimizer <span class=\"pl-k\">=</span> tf.train.AdamOptimizer(<span class=\"pl-c1\">0.001</span>)\n    train_op <span class=\"pl-k\">=</span> optimizer.minimize(loss, <span class=\"pl-v\">global_step</span><span class=\"pl-k\">=</span>tf.train.get_global_step())\n    <span class=\"pl-k\">return</span> tf.estimator.EstimatorSpec(\n        <span class=\"pl-v\">mode</span><span class=\"pl-k\">=</span>tf.estimator.ModeKeys.<span class=\"pl-c1\">TRAIN</span>,\n        <span class=\"pl-v\">loss</span><span class=\"pl-k\">=</span>loss, <span class=\"pl-v\">train_op</span><span class=\"pl-k\">=</span>train_op)\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">train</span>():\n\n    config <span class=\"pl-k\">=</span> tf.estimator.RunConfig(\n        <span class=\"pl-v\">model_dir</span><span class=\"pl-k\">=</span>args.log_dir,\n        <span class=\"pl-v\">train_distribute</span><span class=\"pl-k\">=</span>distribution_strategy(args.num_gpus),\n    )\n\n    estimator <span class=\"pl-k\">=</span> tf.estimator.Estimator(<span class=\"pl-v\">model_fn</span><span class=\"pl-k\">=</span>model_fn, <span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>config)\n\n    <span class=\"pl-k\">if</span> args.print_log:\n        tf.logging.set_verbosity(tf.logging.<span class=\"pl-c1\">INFO</span>)\n\n    estimator.train(\n            <span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn,\n            <span class=\"pl-v\">max_steps</span><span class=\"pl-k\">=</span>args.train_steps,\n        )\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">main</span>():\n\n    init()\n    train()\n\n\n<span class=\"pl-k\">if</span> <span class=\"pl-c1\">__name__</span> <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>__main__<span class=\"pl-pds\">'</span></span>:\n    main()    </pre></div>\n<p>Traceback:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1322, in _do_call\n    return fn(*args)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1307, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\n    run_metadata)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Creating a partition for /device:CPU:5 which doesn't exist in the list of available devices. Available devices: /device:CPU:0,/device:GPU:0,/device:GPU:1,/device:GPU:2,/device:GPU:3,/device:GPU:4,/device:GPU:5,/device:GPU:6,/device:GPU:7\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"conditional_instance_norm/cin/bug.py\", line 90, in &lt;module&gt;\n    main()\n  File \"conditional_instance_norm/cin/bug.py\", line 86, in main\n    train()\n  File \"conditional_instance_norm/cin/bug.py\", line 78, in train\n    max_steps=args.train_steps,\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 363, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 841, in _train_model\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 977, in _train_model_distributed\n    saving_listeners)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1059, in _train_with_estimator_spec\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 567, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1043, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1134, in run\n    raise six.reraise(*original_exc_info)\n  File \"/usr/local/lib/python3.5/dist-packages/six.py\", line 693, in reraise\n    raise value\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1119, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1191, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 971, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 900, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\n    run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Creating a partition for /device:CPU:5 which doesn't exist in the list of available devices. Available devices: /device:CPU:0,/device:GPU:0,/device:GPU:1,/device:GPU:2,/device:GPU:3,/device:GPU:4,/device:GPU:5,/device:GPU:6,/device:GPU:7\n</code></pre>\n<p>Logging:</p>\n<pre><code>/usr/local/lib/python3.5/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\n2018-05-24 15:29:03.599841: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-05-24 15:29:05.183779: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.185180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:17.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.312107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.313326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:18.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.430032: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.431248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:19.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.550047: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.551240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1a.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.673337: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.674512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 4 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1b.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.799709: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.800834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 5 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1c.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.930817: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.931936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 6 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1d.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:06.063970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:06.065079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 7 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1e.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:06.073436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-05-24 15:29:08.181500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-05-24 15:29:08.181554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\n2018-05-24 15:29:08.181568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\n2018-05-24 15:29:08.181580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\n2018-05-24 15:29:08.181590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\n2018-05-24 15:29:08.181601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\n2018-05-24 15:29:08.181613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\n2018-05-24 15:29:08.181619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\n2018-05-24 15:29:08.181630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\n2018-05-24 15:29:08.181636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\n2018-05-24 15:29:08.183932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:0 with 10761 MB memory) -&gt; physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\n2018-05-24 15:29:08.376594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:1 with 10761 MB memory) -&gt; physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\n2018-05-24 15:29:08.569150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:2 with 10761 MB memory) -&gt; physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\n2018-05-24 15:29:08.761061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:3 with 10761 MB memory) -&gt; physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\n2018-05-24 15:29:08.953221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:4 with 10761 MB memory) -&gt; physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\n2018-05-24 15:29:09.145282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:5 with 10761 MB memory) -&gt; physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\n2018-05-24 15:29:09.337138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:6 with 10761 MB memory) -&gt; physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\n2018-05-24 15:29:09.529156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:7 with 10761 MB memory) -&gt; physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0\nINFO:tensorflow:Configured nccl all-reduce.\n2018-05-24 15:29:09.904275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-05-24 15:29:09.904611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-05-24 15:29:09.904631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\n2018-05-24 15:29:09.904638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\n2018-05-24 15:29:09.904650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\n2018-05-24 15:29:09.904661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\n2018-05-24 15:29:09.904672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\n2018-05-24 15:29:09.904687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\n2018-05-24 15:29:09.904692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\n2018-05-24 15:29:09.904703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\n2018-05-24 15:29:09.904714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\n2018-05-24 15:29:09.905948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -&gt; physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\n2018-05-24 15:29:09.906051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10761 MB memory) -&gt; physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\n2018-05-24 15:29:09.906144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10761 MB memory) -&gt; physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\n2018-05-24 15:29:09.906222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10761 MB memory) -&gt; physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\n2018-05-24 15:29:09.906309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 10761 MB memory) -&gt; physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\n2018-05-24 15:29:09.906395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 10761 MB memory) -&gt; physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\n2018-05-24 15:29:09.906490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 10761 MB memory) -&gt; physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\n2018-05-24 15:29:09.906587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 10761 MB memory) -&gt; physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:batch_all_reduce invoked for batches size = 2 with algorithm = nccl and num_packs = 1\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Create CheckpointSaverHook.\nINFO:tensorflow:Graph was finalized.\n2018-05-24 15:29:11.580453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-05-24 15:29:11.580794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-05-24 15:29:11.580813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\n2018-05-24 15:29:11.580825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\n2018-05-24 15:29:11.580833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\n2018-05-24 15:29:11.580838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\n2018-05-24 15:29:11.580850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\n2018-05-24 15:29:11.580864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\n2018-05-24 15:29:11.580878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\n2018-05-24 15:29:11.580888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\n2018-05-24 15:29:11.580899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\n2018-05-24 15:29:11.582151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -&gt; physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\n2018-05-24 15:29:11.582255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10761 MB memory) -&gt; physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\n2018-05-24 15:29:11.582341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10761 MB memory) -&gt; physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\n2018-05-24 15:29:11.582425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10761 MB memory) -&gt; physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\n2018-05-24 15:29:11.582521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 10761 MB memory) -&gt; physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\n2018-05-24 15:29:11.582607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 10761 MB memory) -&gt; physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\n2018-05-24 15:29:11.582689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 10761 MB memory) -&gt; physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\n2018-05-24 15:29:11.582770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 10761 MB memory) -&gt; physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\nINFO:tensorflow:Running local_init_op.\nINFO:tensorflow:Done running local_init_op.\n</code></pre>\n<p>Thanks!</p>", "body_text": "Hi Igor @isaprykin !\nI just changed the code and removed slim but still the same error occurs.\nI will update the configuration settings, code, and traceback.\nSystem information\nOS Platform and Distribution: Linux Ubuntu 16.04.3 LTS\nTensorFlow installed from: pip\nTensorFlow version: tensorflow-gpu==1.8.0rc0\nPython version: 3.5\nBazel version: N/A\nGCC/Compiler version: N/A\nCUDA/cuDNN version: 9/7\nGPU model and memory: 8 GPUs of Tesla K80, memory 488, GPU memory 96\nCPUs: 32\nCode:\nimport glob, os\nimport tensorflow as tf\n\n\n# Initialization of args - arguments parser.\ndef init():\n    pass\n\n\ndef distribution_strategy(num_gpus):\n\n    if num_gpus == 1:\n        return tf.contrib.distribute.OneDeviceStrategy(device='/gpu:0')\n    elif num_gpus > 1:\n        return tf.contrib.distribute.MirroredStrategy(num_gpus=num_gpus)\n    else:\n        return None\n\n\ndef input_fn():\n\n    with tf.device('/cpu:0'):\n\n        dataset = tf.data.TFRecordDataset(\n            glob.glob(os.path.join(args.train_data_dir, 'train*'))\n        )\n        dataset = dataset.map(\n                    lambda x: parse_and_preprocess_image(x, args.image_size),\n                    num_parallel_calls=2,\n        )\n        dataset = dataset.repeat()\n        dataset = dataset.batch(batch_size=4)\n        dataset = dataset.prefetch(1)\n\n        return dataset\n\n\ndef model_fn(features):\n\n    train_images_batch = features\n    res = tf.layers.conv2d(inputs=train_images_batch, filters=3, kernel_size=[9,9], \n                           name='conv1', padding='same')\n    loss = tf.reduce_mean((train_images_batch - res) ** 2)\n    optimizer = tf.train.AdamOptimizer(0.001)\n    train_op = optimizer.minimize(loss, global_step=tf.train.get_global_step())\n    return tf.estimator.EstimatorSpec(\n        mode=tf.estimator.ModeKeys.TRAIN,\n        loss=loss, train_op=train_op)\n\n\ndef train():\n\n    config = tf.estimator.RunConfig(\n        model_dir=args.log_dir,\n        train_distribute=distribution_strategy(args.num_gpus),\n    )\n\n    estimator = tf.estimator.Estimator(model_fn=model_fn, config=config)\n\n    if args.print_log:\n        tf.logging.set_verbosity(tf.logging.INFO)\n\n    estimator.train(\n            input_fn=input_fn,\n            max_steps=args.train_steps,\n        )\n\n\ndef main():\n\n    init()\n    train()\n\n\nif __name__ == '__main__':\n    main()    \nTraceback:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1322, in _do_call\n    return fn(*args)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1307, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\n    run_metadata)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Creating a partition for /device:CPU:5 which doesn't exist in the list of available devices. Available devices: /device:CPU:0,/device:GPU:0,/device:GPU:1,/device:GPU:2,/device:GPU:3,/device:GPU:4,/device:GPU:5,/device:GPU:6,/device:GPU:7\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"conditional_instance_norm/cin/bug.py\", line 90, in <module>\n    main()\n  File \"conditional_instance_norm/cin/bug.py\", line 86, in main\n    train()\n  File \"conditional_instance_norm/cin/bug.py\", line 78, in train\n    max_steps=args.train_steps,\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 363, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 841, in _train_model\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 977, in _train_model_distributed\n    saving_listeners)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1059, in _train_with_estimator_spec\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 567, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1043, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1134, in run\n    raise six.reraise(*original_exc_info)\n  File \"/usr/local/lib/python3.5/dist-packages/six.py\", line 693, in reraise\n    raise value\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1119, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1191, in run\n    run_metadata=run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 971, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 900, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\n    run_metadata)\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Creating a partition for /device:CPU:5 which doesn't exist in the list of available devices. Available devices: /device:CPU:0,/device:GPU:0,/device:GPU:1,/device:GPU:2,/device:GPU:3,/device:GPU:4,/device:GPU:5,/device:GPU:6,/device:GPU:7\n\nLogging:\n/usr/local/lib/python3.5/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\n  from ._conv import register_converters as _register_converters\n2018-05-24 15:29:03.599841: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-05-24 15:29:05.183779: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.185180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:17.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.312107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.313326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:18.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.430032: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.431248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:19.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.550047: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.551240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1a.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.673337: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.674512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 4 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1b.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.799709: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.800834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 5 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1c.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:05.930817: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:05.931936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 6 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1d.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:06.063970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-05-24 15:29:06.065079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 7 with properties:\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1e.0\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\n2018-05-24 15:29:06.073436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-05-24 15:29:08.181500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-05-24 15:29:08.181554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\n2018-05-24 15:29:08.181568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\n2018-05-24 15:29:08.181580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\n2018-05-24 15:29:08.181590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\n2018-05-24 15:29:08.181601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\n2018-05-24 15:29:08.181613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\n2018-05-24 15:29:08.181619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\n2018-05-24 15:29:08.181630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\n2018-05-24 15:29:08.181636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\n2018-05-24 15:29:08.183932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\n2018-05-24 15:29:08.376594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:1 with 10761 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\n2018-05-24 15:29:08.569150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:2 with 10761 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\n2018-05-24 15:29:08.761061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:3 with 10761 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\n2018-05-24 15:29:08.953221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:4 with 10761 MB memory) -> physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\n2018-05-24 15:29:09.145282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:5 with 10761 MB memory) -> physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\n2018-05-24 15:29:09.337138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:6 with 10761 MB memory) -> physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\n2018-05-24 15:29:09.529156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:7 with 10761 MB memory) -> physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0\nINFO:tensorflow:Configured nccl all-reduce.\n2018-05-24 15:29:09.904275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-05-24 15:29:09.904611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-05-24 15:29:09.904631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\n2018-05-24 15:29:09.904638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\n2018-05-24 15:29:09.904650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\n2018-05-24 15:29:09.904661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\n2018-05-24 15:29:09.904672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\n2018-05-24 15:29:09.904687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\n2018-05-24 15:29:09.904692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\n2018-05-24 15:29:09.904703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\n2018-05-24 15:29:09.904714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\n2018-05-24 15:29:09.905948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\n2018-05-24 15:29:09.906051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10761 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\n2018-05-24 15:29:09.906144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10761 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\n2018-05-24 15:29:09.906222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10761 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\n2018-05-24 15:29:09.906309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 10761 MB memory) -> physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\n2018-05-24 15:29:09.906395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 10761 MB memory) -> physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\n2018-05-24 15:29:09.906490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 10761 MB memory) -> physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\n2018-05-24 15:29:09.906587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 10761 MB memory) -> physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:Calling model_fn.\nINFO:tensorflow:batch_all_reduce invoked for batches size = 2 with algorithm = nccl and num_packs = 1\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Done calling model_fn.\nINFO:tensorflow:Create CheckpointSaverHook.\nINFO:tensorflow:Graph was finalized.\n2018-05-24 15:29:11.580453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\n2018-05-24 15:29:11.580794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-05-24 15:29:11.580813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\n2018-05-24 15:29:11.580825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\n2018-05-24 15:29:11.580833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\n2018-05-24 15:29:11.580838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\n2018-05-24 15:29:11.580850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\n2018-05-24 15:29:11.580864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\n2018-05-24 15:29:11.580878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\n2018-05-24 15:29:11.580888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\n2018-05-24 15:29:11.580899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\n2018-05-24 15:29:11.582151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\n2018-05-24 15:29:11.582255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10761 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\n2018-05-24 15:29:11.582341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10761 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\n2018-05-24 15:29:11.582425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10761 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\n2018-05-24 15:29:11.582521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 10761 MB memory) -> physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\n2018-05-24 15:29:11.582607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 10761 MB memory) -> physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\n2018-05-24 15:29:11.582689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 10761 MB memory) -> physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\n2018-05-24 15:29:11.582770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 10761 MB memory) -> physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\nINFO:tensorflow:Running local_init_op.\nINFO:tensorflow:Done running local_init_op.\n\nThanks!", "body": "Hi Igor @isaprykin !\r\n\r\nI just changed the code and removed slim but still the same error occurs. \r\nI will update the configuration settings, code, and traceback.\r\n\r\n**System information**\r\n\r\n**OS Platform and Distribution:** Linux Ubuntu 16.04.3 LTS\r\n**TensorFlow installed from:** pip\r\n**TensorFlow version:** tensorflow-gpu==1.8.0rc0\r\n**Python version:** 3.5\r\n**Bazel version:** N/A\r\n**GCC/Compiler version:** N/A\r\n**CUDA/cuDNN version:** 9/7\r\n**GPU model and memory:** 8 GPUs of Tesla K80, memory 488, GPU memory 96\r\n**CPUs:** 32\r\n\r\nCode:\r\n```python\r\nimport glob, os\r\nimport tensorflow as tf\r\n\r\n\r\n# Initialization of args - arguments parser.\r\ndef init():\r\n    pass\r\n\r\n\r\ndef distribution_strategy(num_gpus):\r\n\r\n    if num_gpus == 1:\r\n        return tf.contrib.distribute.OneDeviceStrategy(device='/gpu:0')\r\n    elif num_gpus > 1:\r\n        return tf.contrib.distribute.MirroredStrategy(num_gpus=num_gpus)\r\n    else:\r\n        return None\r\n\r\n\r\ndef input_fn():\r\n\r\n    with tf.device('/cpu:0'):\r\n\r\n        dataset = tf.data.TFRecordDataset(\r\n            glob.glob(os.path.join(args.train_data_dir, 'train*'))\r\n        )\r\n        dataset = dataset.map(\r\n                    lambda x: parse_and_preprocess_image(x, args.image_size),\r\n                    num_parallel_calls=2,\r\n        )\r\n        dataset = dataset.repeat()\r\n        dataset = dataset.batch(batch_size=4)\r\n        dataset = dataset.prefetch(1)\r\n\r\n        return dataset\r\n\r\n\r\ndef model_fn(features):\r\n\r\n    train_images_batch = features\r\n    res = tf.layers.conv2d(inputs=train_images_batch, filters=3, kernel_size=[9,9], \r\n                           name='conv1', padding='same')\r\n    loss = tf.reduce_mean((train_images_batch - res) ** 2)\r\n    optimizer = tf.train.AdamOptimizer(0.001)\r\n    train_op = optimizer.minimize(loss, global_step=tf.train.get_global_step())\r\n    return tf.estimator.EstimatorSpec(\r\n        mode=tf.estimator.ModeKeys.TRAIN,\r\n        loss=loss, train_op=train_op)\r\n\r\n\r\ndef train():\r\n\r\n    config = tf.estimator.RunConfig(\r\n        model_dir=args.log_dir,\r\n        train_distribute=distribution_strategy(args.num_gpus),\r\n    )\r\n\r\n    estimator = tf.estimator.Estimator(model_fn=model_fn, config=config)\r\n\r\n    if args.print_log:\r\n        tf.logging.set_verbosity(tf.logging.INFO)\r\n\r\n    estimator.train(\r\n            input_fn=input_fn,\r\n            max_steps=args.train_steps,\r\n        )\r\n\r\n\r\ndef main():\r\n\r\n    init()\r\n    train()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()    \r\n```\r\n\r\nTraceback:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1322, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1307, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Creating a partition for /device:CPU:5 which doesn't exist in the list of available devices. Available devices: /device:CPU:0,/device:GPU:0,/device:GPU:1,/device:GPU:2,/device:GPU:3,/device:GPU:4,/device:GPU:5,/device:GPU:6,/device:GPU:7\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"conditional_instance_norm/cin/bug.py\", line 90, in <module>\r\n    main()\r\n  File \"conditional_instance_norm/cin/bug.py\", line 86, in main\r\n    train()\r\n  File \"conditional_instance_norm/cin/bug.py\", line 78, in train\r\n    max_steps=args.train_steps,\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 363, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 841, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 977, in _train_model_distributed\r\n    saving_listeners)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1059, in _train_with_estimator_spec\r\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 567, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1043, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1134, in run\r\n    raise six.reraise(*original_exc_info)\r\n  File \"/usr/local/lib/python3.5/dist-packages/six.py\", line 693, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1119, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 1191, in run\r\n    run_metadata=run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/monitored_session.py\", line 971, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 900, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\r\n    run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Creating a partition for /device:CPU:5 which doesn't exist in the list of available devices. Available devices: /device:CPU:0,/device:GPU:0,/device:GPU:1,/device:GPU:2,/device:GPU:3,/device:GPU:4,/device:GPU:5,/device:GPU:6,/device:GPU:7\r\n```\r\n\r\nLogging:\r\n```\r\n/usr/local/lib/python3.5/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\n2018-05-24 15:29:03.599841: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-05-24 15:29:05.183779: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.185180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:17.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:05.312107: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.313326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:18.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:05.430032: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.431248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:19.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:05.550047: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.551240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1a.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:05.673337: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.674512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 4 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1b.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:05.799709: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.800834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 5 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1c.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:05.930817: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:05.931936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 6 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1d.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:06.063970: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-05-24 15:29:06.065079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 7 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1e.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-05-24 15:29:06.073436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\r\n2018-05-24 15:29:08.181500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-05-24 15:29:08.181554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\r\n2018-05-24 15:29:08.181568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\r\n2018-05-24 15:29:08.181580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\r\n2018-05-24 15:29:08.181590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\r\n2018-05-24 15:29:08.181601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\r\n2018-05-24 15:29:08.181613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\r\n2018-05-24 15:29:08.181619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\r\n2018-05-24 15:29:08.181630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\r\n2018-05-24 15:29:08.181636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\r\n2018-05-24 15:29:08.183932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\r\n2018-05-24 15:29:08.376594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:1 with 10761 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\r\n2018-05-24 15:29:08.569150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:2 with 10761 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\r\n2018-05-24 15:29:08.761061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:3 with 10761 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\r\n2018-05-24 15:29:08.953221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:4 with 10761 MB memory) -> physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.145282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:5 with 10761 MB memory) -> physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.337138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:6 with 10761 MB memory) -> physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.529156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/device:GPU:7 with 10761 MB memory) -> physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0\r\nINFO:tensorflow:Configured nccl all-reduce.\r\n2018-05-24 15:29:09.904275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\r\n2018-05-24 15:29:09.904611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-05-24 15:29:09.904631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\r\n2018-05-24 15:29:09.904638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\r\n2018-05-24 15:29:09.904650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\r\n2018-05-24 15:29:09.904661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\r\n2018-05-24 15:29:09.904672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\r\n2018-05-24 15:29:09.904687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\r\n2018-05-24 15:29:09.904692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\r\n2018-05-24 15:29:09.904703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\r\n2018-05-24 15:29:09.904714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\r\n2018-05-24 15:29:09.905948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10761 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10761 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10761 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 10761 MB memory) -> physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 10761 MB memory) -> physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 10761 MB memory) -> physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\r\n2018-05-24 15:29:09.906587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 10761 MB memory) -> physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:batch_all_reduce invoked for batches size = 2 with algorithm = nccl and num_packs = 1\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\n2018-05-24 15:29:11.580453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7\r\n2018-05-24 15:29:11.580794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-05-24 15:29:11.580813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 4 5 6 7\r\n2018-05-24 15:29:11.580825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y Y Y Y Y\r\n2018-05-24 15:29:11.580833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y Y Y Y Y\r\n2018-05-24 15:29:11.580838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y Y Y Y Y\r\n2018-05-24 15:29:11.580850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N Y Y Y Y\r\n2018-05-24 15:29:11.580864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 4:   Y Y Y Y N Y Y Y\r\n2018-05-24 15:29:11.580878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 5:   Y Y Y Y Y N Y Y\r\n2018-05-24 15:29:11.580888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 6:   Y Y Y Y Y Y N Y\r\n2018-05-24 15:29:11.580899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 7:   Y Y Y Y Y Y Y N\r\n2018-05-24 15:29:11.582151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:17.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10761 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:00:18.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10761 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:00:19.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10761 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:00:1a.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 10761 MB memory) -> physical GPU (device: 4, name: Tesla K80, pci bus id: 0000:00:1b.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 10761 MB memory) -> physical GPU (device: 5, name: Tesla K80, pci bus id: 0000:00:1c.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 10761 MB memory) -> physical GPU (device: 6, name: Tesla K80, pci bus id: 0000:00:1d.0, compute capability: 3.7)\r\n2018-05-24 15:29:11.582770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 10761 MB memory) -> physical GPU (device: 7, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\n```\r\n\r\nThanks!\r\n\r\n\r\n"}