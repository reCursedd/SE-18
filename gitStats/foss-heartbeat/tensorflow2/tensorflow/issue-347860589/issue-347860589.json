{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21403", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21403/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21403/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21403/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21403", "id": 347860589, "node_id": "MDU6SXNzdWUzNDc4NjA1ODk=", "number": 21403, "title": "Crash during folder creation from Estimator exporter.py in Python 3.6", "user": {"login": "apacha", "id": 594497, "node_id": "MDQ6VXNlcjU5NDQ5Nw==", "avatar_url": "https://avatars1.githubusercontent.com/u/594497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apacha", "html_url": "https://github.com/apacha", "followers_url": "https://api.github.com/users/apacha/followers", "following_url": "https://api.github.com/users/apacha/following{/other_user}", "gists_url": "https://api.github.com/users/apacha/gists{/gist_id}", "starred_url": "https://api.github.com/users/apacha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apacha/subscriptions", "organizations_url": "https://api.github.com/users/apacha/orgs", "repos_url": "https://api.github.com/users/apacha/repos", "events_url": "https://api.github.com/users/apacha/events{/privacy}", "received_events_url": "https://api.github.com/users/apacha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": {"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-08-06T10:08:45Z", "updated_at": "2018-11-14T19:24:33Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Windows 10</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.8.0 and 1.9.0</li>\n<li><strong>Python version</strong>: 3.6</li>\n<li><strong>GPU model and memory</strong>: GTX 1080 Ti</li>\n<li><strong>Exact command to reproduce</strong>: See <a href=\"https://github.com/tensorflow/models/issues/4996#issue-347431961\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/models/issues/4996/hovercard\">here</a></li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When exporting of a snapshot during training with Estimator, <a href=\"https://github.com/tensorflow/tensorflow/blob/e70f94ee089abbb9eb70361b5cdef55aa9beb18b/tensorflow/python/estimator/export/export.py#L600\"><code>export.py</code></a> creates an invalid path with Python 3.6, due to handling of strings as bytes (!!!).</p>\n<p>In <a href=\"https://github.com/tensorflow/tensorflow/blob/e70f94ee089abbb9eb70361b5cdef55aa9beb18b/tensorflow/python/estimator/estimator.py#L779\"><code>estimator.py</code></a>, the following string is generated for the variable <code>export_dir</code>: <code>b'C:/Users/Alex/pet-train\\\\export\\\\Servo\\\\1533549311'</code>, which is afterwards corrupted by the <code>get_temp_export_dir</code> command, which defaces it into <code>b\"C:/Users/Alex/pet-train\\\\export\\\\Servo\\\\temp-b'1533549311'\"</code> which further down the road causes the program to crash with the following exception:</p>\n<pre><code>Traceback (most recent call last):\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1664, in &lt;module&gt;\n    main()\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1658, in main\n    globals = debugger.run(setup['file'], None, None, is_module)\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1068, in run\n    pydev_imports.execfile(file, globals, locals)  # execute the script\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\n  File \"C:/Users/Alex/Repositories/MusicObjectDetector-TF2/research/object_detection/model_main.py\", line 101, in &lt;module&gt;\n    tf.app.run()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 126, in run\n    _sys.exit(main(argv))\n  File \"C:/Users/Alex/Repositories/MusicObjectDetector-TF2/research/object_detection/model_main.py\", line 97, in main\n    tf.estimator.train_and_evaluate(estimator, train_spec, eval_specs[0])\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 439, in train_and_evaluate\n    executor.run()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 518, in run\n    self.run_local()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 657, in run_local\n    eval_result = evaluator.evaluate_and_export()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 858, in evaluate_and_export\n    self._export_eval_result(eval_result, is_the_final_export)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 889, in _export_eval_result\n    is_the_final_export=is_the_final_export)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\exporter.py\", line 177, in export\n    is_the_final_export)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\exporter.py\", line 123, in export\n    strip_default_attrs=self._strip_default_attrs)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 644, in export_savedmodel\n    builder = saved_model_builder.SavedModelBuilder(temp_export_dir)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\saved_model\\builder_impl.py\", line 92, in __init__\n    file_io.recursive_create_dir(self._export_dir)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\lib\\io\\file_io.py\", line 374, in recursive_create_dir\n    pywrap_tensorflow.RecursivelyCreateDir(compat.as_bytes(dirname), status)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 519, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.NotFoundError: Failed to create a directory: C:/Users/Alex/pet-train\\export\\Servo\\temp-b'1533549311'; No such file or directory\n\nProcess finished with exit code -1\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\nTensorFlow installed from (source or binary): binary\nTensorFlow version (use command below): 1.8.0 and 1.9.0\nPython version: 3.6\nGPU model and memory: GTX 1080 Ti\nExact command to reproduce: See here\n\nDescribe the problem\nWhen exporting of a snapshot during training with Estimator, export.py creates an invalid path with Python 3.6, due to handling of strings as bytes (!!!).\nIn estimator.py, the following string is generated for the variable export_dir: b'C:/Users/Alex/pet-train\\\\export\\\\Servo\\\\1533549311', which is afterwards corrupted by the get_temp_export_dir command, which defaces it into b\"C:/Users/Alex/pet-train\\\\export\\\\Servo\\\\temp-b'1533549311'\" which further down the road causes the program to crash with the following exception:\nTraceback (most recent call last):\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1664, in <module>\n    main()\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1658, in main\n    globals = debugger.run(setup['file'], None, None, is_module)\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1068, in run\n    pydev_imports.execfile(file, globals, locals)  # execute the script\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\n  File \"C:/Users/Alex/Repositories/MusicObjectDetector-TF2/research/object_detection/model_main.py\", line 101, in <module>\n    tf.app.run()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 126, in run\n    _sys.exit(main(argv))\n  File \"C:/Users/Alex/Repositories/MusicObjectDetector-TF2/research/object_detection/model_main.py\", line 97, in main\n    tf.estimator.train_and_evaluate(estimator, train_spec, eval_specs[0])\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 439, in train_and_evaluate\n    executor.run()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 518, in run\n    self.run_local()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 657, in run_local\n    eval_result = evaluator.evaluate_and_export()\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 858, in evaluate_and_export\n    self._export_eval_result(eval_result, is_the_final_export)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 889, in _export_eval_result\n    is_the_final_export=is_the_final_export)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\exporter.py\", line 177, in export\n    is_the_final_export)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\exporter.py\", line 123, in export\n    strip_default_attrs=self._strip_default_attrs)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 644, in export_savedmodel\n    builder = saved_model_builder.SavedModelBuilder(temp_export_dir)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\saved_model\\builder_impl.py\", line 92, in __init__\n    file_io.recursive_create_dir(self._export_dir)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\lib\\io\\file_io.py\", line 374, in recursive_create_dir\n    pywrap_tensorflow.RecursivelyCreateDir(compat.as_bytes(dirname), status)\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 519, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.NotFoundError: Failed to create a directory: C:/Users/Alex/pet-train\\export\\Servo\\temp-b'1533549311'; No such file or directory\n\nProcess finished with exit code -1", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.8.0 and 1.9.0\r\n- **Python version**: 3.6\r\n- **GPU model and memory**: GTX 1080 Ti\r\n- **Exact command to reproduce**: See [here](https://github.com/tensorflow/models/issues/4996#issue-347431961)\r\n\r\n### Describe the problem\r\nWhen exporting of a snapshot during training with Estimator, [`export.py`](https://github.com/tensorflow/tensorflow/blob/e70f94ee089abbb9eb70361b5cdef55aa9beb18b/tensorflow/python/estimator/export/export.py#L600) creates an invalid path with Python 3.6, due to handling of strings as bytes (!!!). \r\n\r\nIn [`estimator.py`](https://github.com/tensorflow/tensorflow/blob/e70f94ee089abbb9eb70361b5cdef55aa9beb18b/tensorflow/python/estimator/estimator.py#L779), the following string is generated for the variable `export_dir`: `b'C:/Users/Alex/pet-train\\\\export\\\\Servo\\\\1533549311'`, which is afterwards corrupted by the `get_temp_export_dir` command, which defaces it into `b\"C:/Users/Alex/pet-train\\\\export\\\\Servo\\\\temp-b'1533549311'\"` which further down the road causes the program to crash with the following exception:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1664, in <module>\r\n    main()\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1658, in main\r\n    globals = debugger.run(setup['file'], None, None, is_module)\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\pydevd.py\", line 1068, in run\r\n    pydev_imports.execfile(file, globals, locals)  # execute the script\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2018.1.2\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"C:/Users/Alex/Repositories/MusicObjectDetector-TF2/research/object_detection/model_main.py\", line 101, in <module>\r\n    tf.app.run()\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 126, in run\r\n    _sys.exit(main(argv))\r\n  File \"C:/Users/Alex/Repositories/MusicObjectDetector-TF2/research/object_detection/model_main.py\", line 97, in main\r\n    tf.estimator.train_and_evaluate(estimator, train_spec, eval_specs[0])\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 439, in train_and_evaluate\r\n    executor.run()\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 518, in run\r\n    self.run_local()\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 657, in run_local\r\n    eval_result = evaluator.evaluate_and_export()\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 858, in evaluate_and_export\r\n    self._export_eval_result(eval_result, is_the_final_export)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\training.py\", line 889, in _export_eval_result\r\n    is_the_final_export=is_the_final_export)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\exporter.py\", line 177, in export\r\n    is_the_final_export)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\exporter.py\", line 123, in export\r\n    strip_default_attrs=self._strip_default_attrs)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\estimator\\estimator.py\", line 644, in export_savedmodel\r\n    builder = saved_model_builder.SavedModelBuilder(temp_export_dir)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\saved_model\\builder_impl.py\", line 92, in __init__\r\n    file_io.recursive_create_dir(self._export_dir)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\lib\\io\\file_io.py\", line 374, in recursive_create_dir\r\n    pywrap_tensorflow.RecursivelyCreateDir(compat.as_bytes(dirname), status)\r\n  File \"C:\\Programmieren\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 519, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.NotFoundError: Failed to create a directory: C:/Users/Alex/pet-train\\export\\Servo\\temp-b'1533549311'; No such file or directory\r\n\r\nProcess finished with exit code -1\r\n```\r\n"}