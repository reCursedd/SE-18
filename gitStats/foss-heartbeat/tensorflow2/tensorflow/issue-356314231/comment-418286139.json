{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/418286139", "html_url": "https://github.com/tensorflow/tensorflow/issues/22013#issuecomment-418286139", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22013", "id": 418286139, "node_id": "MDEyOklzc3VlQ29tbWVudDQxODI4NjEzOQ==", "user": {"login": "mpekalski", "id": 2975068, "node_id": "MDQ6VXNlcjI5NzUwNjg=", "avatar_url": "https://avatars1.githubusercontent.com/u/2975068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpekalski", "html_url": "https://github.com/mpekalski", "followers_url": "https://api.github.com/users/mpekalski/followers", "following_url": "https://api.github.com/users/mpekalski/following{/other_user}", "gists_url": "https://api.github.com/users/mpekalski/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpekalski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpekalski/subscriptions", "organizations_url": "https://api.github.com/users/mpekalski/orgs", "repos_url": "https://api.github.com/users/mpekalski/repos", "events_url": "https://api.github.com/users/mpekalski/events{/privacy}", "received_events_url": "https://api.github.com/users/mpekalski/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-04T08:33:16Z", "updated_at": "2018-09-04T08:33:16Z", "author_association": "NONE", "body_html": "<p>I've managed to get gdb working, looks like the issue is with inferring shape in <code>scatter_nd_update</code></p>\n<pre><code>0x00007fffcd5f912f in tensorflow::shape_inference::ScatterNdUpdateShape(tensorflow::shape_inference::InferenceContext*) ()\n   from /opt/conda/lib/python3.6/site-packages/tensorflow/python/../libtensorflow_framework.so\n</code></pre>\n<p>Full log</p>\n<pre><code># gdb python3\nGNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1                                              Copyright (C) 2016 Free Software Foundation, Inc.                                         License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt; py\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"gdb py\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from python3...done.\n(gdb) run bug.py\nStarting program: /opt/conda/bin/python3 bug.py\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7ffff31fa700 (LWP 606)]\n[New Thread 0x7ffff09f9700 (LWP 607)]\n[New Thread 0x7fffee1f8700 (LWP 608)]\n[New Thread 0x7fffeb9f7700 (LWP 609)]\n[New Thread 0x7fffe91f6700 (LWP 610)]\n[New Thread 0x7fffe69f5700 (LWP 611)]\n[New Thread 0x7fffe41f4700 (LWP 612)]\n[Thread 0x7fffe41f4700 (LWP 612) exited]\n[Thread 0x7fffe69f5700 (LWP 611) exited]\n[Thread 0x7fffe91f6700 (LWP 610) exited]\n[Thread 0x7fffeb9f7700 (LWP 609) exited]\n[Thread 0x7fffee1f8700 (LWP 608) exited]\n[Thread 0x7ffff09f9700 (LWP 607) exited]\n[Thread 0x7ffff31fa700 (LWP 606) exited]\n/opt/conda/lib/python3.6/importlib/_bootstrap.py:205: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\n  return f(*args, **kwds)\n/opt/conda/lib/python3.6/importlib/_bootstrap.py:205: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\n  return f(*args, **kwds)\n[New Thread 0x7fffe41f4700 (LWP 617)]\nDS1 SCOPE =============\ngraph: &lt;tensorflow.python.framework.ops.Graph object at 0x7ffff6789160&gt;\nscope: scope_0/scope_1\n name: scope_0/scope_1/x:0\n  var: &lt;tf.Variable 'scope_0/scope_1/x:0' shape=() dtype=float32&gt;\n[New Thread 0x7fffe69f5700 (LWP 618)]\ninitial scope:\nDS1 SCOPE =============\ngraph: &lt;tensorflow.python.framework.ops.Graph object at 0x7ffff6789160&gt;\nscope: scope_0/scope_1\n name: scope_0/scope_1/x_1:0\n  var: &lt;tf.Variable 'scope_0/scope_1/x_1:0' shape=() dtype=float32&gt;\n=============\n&lt;tf.Variable 'scope_0/scope_1/x_1:0' shape=() dtype=float32&gt;\nTensor(\"arg0:0\", shape=(), dtype=int32)\n[New Thread 0x7fffe91f6700 (LWP 619)]\n[New Thread 0x7fffeb9f7700 (LWP 620)]\n[New Thread 0x7fff871ff700 (LWP 621)]\n[New Thread 0x7fff869fe700 (LWP 622)]\n[New Thread 0x7fff861fd700 (LWP 623)]\n[New Thread 0x7fff859fc700 (LWP 624)]\n[New Thread 0x7fff851fb700 (LWP 625)]\n[New Thread 0x7fff849fa700 (LWP 626)]\n[New Thread 0x7fff5fdff700 (LWP 627)]\n[New Thread 0x7fff5f5fe700 (LWP 628)]\n[New Thread 0x7fff5edfd700 (LWP 629)]\n[New Thread 0x7fff5e5fc700 (LWP 630)]\n2018-09-04 08:28:02.088839: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-09-04 08:28:02.089267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.721\npciBusID: 0000:01:00.0\ntotalMemory: 10.92GiB freeMemory: 10.20GiB\n2018-09-04 08:28:02.089287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-04 08:28:02.089297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-04 08:28:02.089303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\n2018-09-04 08:28:02.089307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\n2018-09-04 08:28:02.089464: I tensorflow/core/common_runtime/process_util.cc:69] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.\n[New Thread 0x7fff5ddfb700 (LWP 631)]\n[New Thread 0x7fff5d5fa700 (LWP 632)]\n[New Thread 0x7fff5cdf9700 (LWP 633)]\n[Thread 0x7fff5cdf9700 (LWP 633) exited]\n[New Thread 0x7fff5cdf9700 (LWP 634)]\n[Thread 0x7fff5cdf9700 (LWP 634) exited]\n[New Thread 0x7fff5cdf9700 (LWP 635)]\n[Thread 0x7fff5cdf9700 (LWP 635) exited]\n[New Thread 0x7fff5cdf9700 (LWP 636)]\n[Thread 0x7fff5cdf9700 (LWP 636) exited]\n[New Thread 0x7fff5cdf9700 (LWP 637)]\n[Thread 0x7fff5cdf9700 (LWP 637) exited]\n[New Thread 0x7fff5cdf9700 (LWP 638)]\n[Thread 0x7fff5cdf9700 (LWP 638) exited]\n[New Thread 0x7fff5cdf9700 (LWP 639)]\n[Thread 0x7fff5cdf9700 (LWP 639) exited]\n[New Thread 0x7fff5cdf9700 (LWP 640)]\n[Thread 0x7fff5cdf9700 (LWP 640) exited]\n\nThread 1 \"python3\" received signal SIGSEGV, Segmentation fault.\n0x00007fffcd5f912f in tensorflow::shape_inference::ScatterNdUpdateShape(tensorflow::shape_inference::InferenceContext*) ()\n   from /opt/conda/lib/python3.6/site-packages/tensorflow/python/../libtensorflow_framework.so\n(gdb)\n</code></pre>", "body_text": "I've managed to get gdb working, looks like the issue is with inferring shape in scatter_nd_update\n0x00007fffcd5f912f in tensorflow::shape_inference::ScatterNdUpdateShape(tensorflow::shape_inference::InferenceContext*) ()\n   from /opt/conda/lib/python3.6/site-packages/tensorflow/python/../libtensorflow_framework.so\n\nFull log\n# gdb python3\nGNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1                                              Copyright (C) 2016 Free Software Foundation, Inc.                                         License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html> py\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"gdb py\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from python3...done.\n(gdb) run bug.py\nStarting program: /opt/conda/bin/python3 bug.py\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7ffff31fa700 (LWP 606)]\n[New Thread 0x7ffff09f9700 (LWP 607)]\n[New Thread 0x7fffee1f8700 (LWP 608)]\n[New Thread 0x7fffeb9f7700 (LWP 609)]\n[New Thread 0x7fffe91f6700 (LWP 610)]\n[New Thread 0x7fffe69f5700 (LWP 611)]\n[New Thread 0x7fffe41f4700 (LWP 612)]\n[Thread 0x7fffe41f4700 (LWP 612) exited]\n[Thread 0x7fffe69f5700 (LWP 611) exited]\n[Thread 0x7fffe91f6700 (LWP 610) exited]\n[Thread 0x7fffeb9f7700 (LWP 609) exited]\n[Thread 0x7fffee1f8700 (LWP 608) exited]\n[Thread 0x7ffff09f9700 (LWP 607) exited]\n[Thread 0x7ffff31fa700 (LWP 606) exited]\n/opt/conda/lib/python3.6/importlib/_bootstrap.py:205: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\n  return f(*args, **kwds)\n/opt/conda/lib/python3.6/importlib/_bootstrap.py:205: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\n  return f(*args, **kwds)\n[New Thread 0x7fffe41f4700 (LWP 617)]\nDS1 SCOPE =============\ngraph: <tensorflow.python.framework.ops.Graph object at 0x7ffff6789160>\nscope: scope_0/scope_1\n name: scope_0/scope_1/x:0\n  var: <tf.Variable 'scope_0/scope_1/x:0' shape=() dtype=float32>\n[New Thread 0x7fffe69f5700 (LWP 618)]\ninitial scope:\nDS1 SCOPE =============\ngraph: <tensorflow.python.framework.ops.Graph object at 0x7ffff6789160>\nscope: scope_0/scope_1\n name: scope_0/scope_1/x_1:0\n  var: <tf.Variable 'scope_0/scope_1/x_1:0' shape=() dtype=float32>\n=============\n<tf.Variable 'scope_0/scope_1/x_1:0' shape=() dtype=float32>\nTensor(\"arg0:0\", shape=(), dtype=int32)\n[New Thread 0x7fffe91f6700 (LWP 619)]\n[New Thread 0x7fffeb9f7700 (LWP 620)]\n[New Thread 0x7fff871ff700 (LWP 621)]\n[New Thread 0x7fff869fe700 (LWP 622)]\n[New Thread 0x7fff861fd700 (LWP 623)]\n[New Thread 0x7fff859fc700 (LWP 624)]\n[New Thread 0x7fff851fb700 (LWP 625)]\n[New Thread 0x7fff849fa700 (LWP 626)]\n[New Thread 0x7fff5fdff700 (LWP 627)]\n[New Thread 0x7fff5f5fe700 (LWP 628)]\n[New Thread 0x7fff5edfd700 (LWP 629)]\n[New Thread 0x7fff5e5fc700 (LWP 630)]\n2018-09-04 08:28:02.088839: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-09-04 08:28:02.089267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.721\npciBusID: 0000:01:00.0\ntotalMemory: 10.92GiB freeMemory: 10.20GiB\n2018-09-04 08:28:02.089287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-04 08:28:02.089297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-04 08:28:02.089303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\n2018-09-04 08:28:02.089307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\n2018-09-04 08:28:02.089464: I tensorflow/core/common_runtime/process_util.cc:69] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.\n[New Thread 0x7fff5ddfb700 (LWP 631)]\n[New Thread 0x7fff5d5fa700 (LWP 632)]\n[New Thread 0x7fff5cdf9700 (LWP 633)]\n[Thread 0x7fff5cdf9700 (LWP 633) exited]\n[New Thread 0x7fff5cdf9700 (LWP 634)]\n[Thread 0x7fff5cdf9700 (LWP 634) exited]\n[New Thread 0x7fff5cdf9700 (LWP 635)]\n[Thread 0x7fff5cdf9700 (LWP 635) exited]\n[New Thread 0x7fff5cdf9700 (LWP 636)]\n[Thread 0x7fff5cdf9700 (LWP 636) exited]\n[New Thread 0x7fff5cdf9700 (LWP 637)]\n[Thread 0x7fff5cdf9700 (LWP 637) exited]\n[New Thread 0x7fff5cdf9700 (LWP 638)]\n[Thread 0x7fff5cdf9700 (LWP 638) exited]\n[New Thread 0x7fff5cdf9700 (LWP 639)]\n[Thread 0x7fff5cdf9700 (LWP 639) exited]\n[New Thread 0x7fff5cdf9700 (LWP 640)]\n[Thread 0x7fff5cdf9700 (LWP 640) exited]\n\nThread 1 \"python3\" received signal SIGSEGV, Segmentation fault.\n0x00007fffcd5f912f in tensorflow::shape_inference::ScatterNdUpdateShape(tensorflow::shape_inference::InferenceContext*) ()\n   from /opt/conda/lib/python3.6/site-packages/tensorflow/python/../libtensorflow_framework.so\n(gdb)", "body": "I've managed to get gdb working, looks like the issue is with inferring shape in `scatter_nd_update`\r\n```\r\n0x00007fffcd5f912f in tensorflow::shape_inference::ScatterNdUpdateShape(tensorflow::shape_inference::InferenceContext*) ()\r\n   from /opt/conda/lib/python3.6/site-packages/tensorflow/python/../libtensorflow_framework.so\r\n```\r\n\r\nFull log \r\n```\r\n# gdb python3\r\nGNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1                                              Copyright (C) 2016 Free Software Foundation, Inc.                                         License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html> py\r\nThis is free software: you are free to change and redistribute it.\r\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"gdb py\r\nand \"show warranty\" for details.\r\nThis GDB was configured as \"x86_64-linux-gnu\".\r\nType \"show configuration\" for configuration details.\r\nFor bug reporting instructions, please see:\r\n<http://www.gnu.org/software/gdb/bugs/>.\r\nFind the GDB manual and other documentation resources online at:\r\n<http://www.gnu.org/software/gdb/documentation/>.\r\nFor help, type \"help\".\r\nType \"apropos word\" to search for commands related to \"word\"...\r\nReading symbols from python3...done.\r\n(gdb) run bug.py\r\nStarting program: /opt/conda/bin/python3 bug.py\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\r\n[New Thread 0x7ffff31fa700 (LWP 606)]\r\n[New Thread 0x7ffff09f9700 (LWP 607)]\r\n[New Thread 0x7fffee1f8700 (LWP 608)]\r\n[New Thread 0x7fffeb9f7700 (LWP 609)]\r\n[New Thread 0x7fffe91f6700 (LWP 610)]\r\n[New Thread 0x7fffe69f5700 (LWP 611)]\r\n[New Thread 0x7fffe41f4700 (LWP 612)]\r\n[Thread 0x7fffe41f4700 (LWP 612) exited]\r\n[Thread 0x7fffe69f5700 (LWP 611) exited]\r\n[Thread 0x7fffe91f6700 (LWP 610) exited]\r\n[Thread 0x7fffeb9f7700 (LWP 609) exited]\r\n[Thread 0x7fffee1f8700 (LWP 608) exited]\r\n[Thread 0x7ffff09f9700 (LWP 607) exited]\r\n[Thread 0x7ffff31fa700 (LWP 606) exited]\r\n/opt/conda/lib/python3.6/importlib/_bootstrap.py:205: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n/opt/conda/lib/python3.6/importlib/_bootstrap.py:205: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88\r\n  return f(*args, **kwds)\r\n[New Thread 0x7fffe41f4700 (LWP 617)]\r\nDS1 SCOPE =============\r\ngraph: <tensorflow.python.framework.ops.Graph object at 0x7ffff6789160>\r\nscope: scope_0/scope_1\r\n name: scope_0/scope_1/x:0\r\n  var: <tf.Variable 'scope_0/scope_1/x:0' shape=() dtype=float32>\r\n[New Thread 0x7fffe69f5700 (LWP 618)]\r\ninitial scope:\r\nDS1 SCOPE =============\r\ngraph: <tensorflow.python.framework.ops.Graph object at 0x7ffff6789160>\r\nscope: scope_0/scope_1\r\n name: scope_0/scope_1/x_1:0\r\n  var: <tf.Variable 'scope_0/scope_1/x_1:0' shape=() dtype=float32>\r\n=============\r\n<tf.Variable 'scope_0/scope_1/x_1:0' shape=() dtype=float32>\r\nTensor(\"arg0:0\", shape=(), dtype=int32)\r\n[New Thread 0x7fffe91f6700 (LWP 619)]\r\n[New Thread 0x7fffeb9f7700 (LWP 620)]\r\n[New Thread 0x7fff871ff700 (LWP 621)]\r\n[New Thread 0x7fff869fe700 (LWP 622)]\r\n[New Thread 0x7fff861fd700 (LWP 623)]\r\n[New Thread 0x7fff859fc700 (LWP 624)]\r\n[New Thread 0x7fff851fb700 (LWP 625)]\r\n[New Thread 0x7fff849fa700 (LWP 626)]\r\n[New Thread 0x7fff5fdff700 (LWP 627)]\r\n[New Thread 0x7fff5f5fe700 (LWP 628)]\r\n[New Thread 0x7fff5edfd700 (LWP 629)]\r\n[New Thread 0x7fff5e5fc700 (LWP 630)]\r\n2018-09-04 08:28:02.088839: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-09-04 08:28:02.089267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:\r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.721\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.20GiB\r\n2018-09-04 08:28:02.089287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-04 08:28:02.089297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-04 08:28:02.089303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\r\n2018-09-04 08:28:02.089307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\r\n2018-09-04 08:28:02.089464: I tensorflow/core/common_runtime/process_util.cc:69] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.\r\n[New Thread 0x7fff5ddfb700 (LWP 631)]\r\n[New Thread 0x7fff5d5fa700 (LWP 632)]\r\n[New Thread 0x7fff5cdf9700 (LWP 633)]\r\n[Thread 0x7fff5cdf9700 (LWP 633) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 634)]\r\n[Thread 0x7fff5cdf9700 (LWP 634) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 635)]\r\n[Thread 0x7fff5cdf9700 (LWP 635) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 636)]\r\n[Thread 0x7fff5cdf9700 (LWP 636) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 637)]\r\n[Thread 0x7fff5cdf9700 (LWP 637) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 638)]\r\n[Thread 0x7fff5cdf9700 (LWP 638) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 639)]\r\n[Thread 0x7fff5cdf9700 (LWP 639) exited]\r\n[New Thread 0x7fff5cdf9700 (LWP 640)]\r\n[Thread 0x7fff5cdf9700 (LWP 640) exited]\r\n\r\nThread 1 \"python3\" received signal SIGSEGV, Segmentation fault.\r\n0x00007fffcd5f912f in tensorflow::shape_inference::ScatterNdUpdateShape(tensorflow::shape_inference::InferenceContext*) ()\r\n   from /opt/conda/lib/python3.6/site-packages/tensorflow/python/../libtensorflow_framework.so\r\n(gdb)\r\n```"}