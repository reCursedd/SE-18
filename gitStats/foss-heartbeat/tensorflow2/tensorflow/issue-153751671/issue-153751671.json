{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2289", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2289/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2289/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2289/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2289", "id": 153751671, "node_id": "MDU6SXNzdWUxNTM3NTE2NzE=", "number": 2289, "title": "Broadcasting ops on numpy arrays creates tons of ops", "user": {"login": "sesse", "id": 238700, "node_id": "MDQ6VXNlcjIzODcwMA==", "avatar_url": "https://avatars0.githubusercontent.com/u/238700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sesse", "html_url": "https://github.com/sesse", "followers_url": "https://api.github.com/users/sesse/followers", "following_url": "https://api.github.com/users/sesse/following{/other_user}", "gists_url": "https://api.github.com/users/sesse/gists{/gist_id}", "starred_url": "https://api.github.com/users/sesse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sesse/subscriptions", "organizations_url": "https://api.github.com/users/sesse/orgs", "repos_url": "https://api.github.com/users/sesse/repos", "events_url": "https://api.github.com/users/sesse/events{/privacy}", "received_events_url": "https://api.github.com/users/sesse/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2016-05-09T10:59:00Z", "updated_at": "2016-06-16T00:24:46Z", "closed_at": "2016-06-16T00:24:46Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>I had a little toy project where I took in some data from numpy:</p>\n<pre><code>x_data = np.zeros([18145, 3], np.float32)\nb_init = np.zeros([1, 3], np.float32)\nb_init[0][0] = 16.0\nb_init[0][1] = 128.0\nb_init[0][2] = 128.0\nW_init = np.zeros([3, 3], np.float32)\n\n[fill in x_data here]\n\nW = tf.Variable(W_init)\nb = tf.Variable(b_init)\ny = tf.matmul(x_data - b, W)\n</code></pre>\n<p>This took a <em>lot</em> of time and memory to set up (several minutes), and it was nowhere obvious why.</p>\n<p>It eventually turned out that the broadcasting on the subtraction is what's causing the issue; it creates one op per line in x_data. I needed to write</p>\n<pre><code>y = tf.matmul(tf.constant(x_data) - b, W)\n</code></pre>\n<p>to make it fast.</p>\n<p>Shouldn't this be the default behavior?</p>", "body_text": "Hi,\nI had a little toy project where I took in some data from numpy:\nx_data = np.zeros([18145, 3], np.float32)\nb_init = np.zeros([1, 3], np.float32)\nb_init[0][0] = 16.0\nb_init[0][1] = 128.0\nb_init[0][2] = 128.0\nW_init = np.zeros([3, 3], np.float32)\n\n[fill in x_data here]\n\nW = tf.Variable(W_init)\nb = tf.Variable(b_init)\ny = tf.matmul(x_data - b, W)\n\nThis took a lot of time and memory to set up (several minutes), and it was nowhere obvious why.\nIt eventually turned out that the broadcasting on the subtraction is what's causing the issue; it creates one op per line in x_data. I needed to write\ny = tf.matmul(tf.constant(x_data) - b, W)\n\nto make it fast.\nShouldn't this be the default behavior?", "body": "Hi,\n\nI had a little toy project where I took in some data from numpy:\n\n```\nx_data = np.zeros([18145, 3], np.float32)\nb_init = np.zeros([1, 3], np.float32)\nb_init[0][0] = 16.0\nb_init[0][1] = 128.0\nb_init[0][2] = 128.0\nW_init = np.zeros([3, 3], np.float32)\n\n[fill in x_data here]\n\nW = tf.Variable(W_init)\nb = tf.Variable(b_init)\ny = tf.matmul(x_data - b, W)\n```\n\nThis took a _lot_ of time and memory to set up (several minutes), and it was nowhere obvious why.\n\nIt eventually turned out that the broadcasting on the subtraction is what's causing the issue; it creates one op per line in x_data. I needed to write\n\n```\ny = tf.matmul(tf.constant(x_data) - b, W)\n```\n\nto make it fast.\n\nShouldn't this be the default behavior?\n"}