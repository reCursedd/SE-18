{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9437", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9437/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9437/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9437/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9437", "id": 224127767, "node_id": "MDU6SXNzdWUyMjQxMjc3Njc=", "number": 9437, "title": "Docs generation is broken in Python 3.5", "user": {"login": "admcrae", "id": 11247551, "node_id": "MDQ6VXNlcjExMjQ3NTUx", "avatar_url": "https://avatars3.githubusercontent.com/u/11247551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/admcrae", "html_url": "https://github.com/admcrae", "followers_url": "https://api.github.com/users/admcrae/followers", "following_url": "https://api.github.com/users/admcrae/following{/other_user}", "gists_url": "https://api.github.com/users/admcrae/gists{/gist_id}", "starred_url": "https://api.github.com/users/admcrae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/admcrae/subscriptions", "organizations_url": "https://api.github.com/users/admcrae/orgs", "repos_url": "https://api.github.com/users/admcrae/repos", "events_url": "https://api.github.com/users/admcrae/events{/privacy}", "received_events_url": "https://api.github.com/users/admcrae/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-04-25T12:55:08Z", "updated_at": "2018-03-01T20:42:32Z", "closed_at": "2017-06-16T21:12:07Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code</strong>: No</li>\n<li><strong>OS Platform and Distribution</strong>: Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from</strong>: Source</li>\n<li><strong>TensorFlow version</strong>: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/b6bafadd51a471daa7157f515598e08e8f9f1611/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/b6bafadd51a471daa7157f515598e08e8f9f1611\"><tt>b6bafad</tt></a></li>\n<li><strong>Bazel version</strong>: 0.4.5</li>\n<li><strong>Exact command to reproduce</strong>: <code>bazel run -- //tensorflow/tools/docs:generate --src_dir=tensorflow/docs_src --output_dir=/tmp/tf_docs</code></li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Problem 1: Since python 3.5, <code>namedtuple</code> objects have no <code>__dict__</code> property. See <a href=\"http://stackoverflow.com/questions/34166469/did-something-about-namedtuple-change-in-3-5-1\" rel=\"nofollow\">here</a> and <a href=\"http://bugs.python.org/issue24931\" rel=\"nofollow\">here</a> for more details. This problem is easily fixed by changing all instances of <code>h3.format(**info.__dict__)</code> to <code>h3.format(**info._asdict())</code> in <a href=\"https://github.com/tensorflow/tensorflow/blob/b6bafadd51a471daa7157f515598e08e8f9f1611/tensorflow/tools/docs/pretty_docs.py\"><code>pretty_docs.py</code></a>.</p>\n<p>Problem 2: The codegen library used by the docs generator is 5 years old and doesn't work with python 3.5 (the problem I'm getting is identical to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"113231821\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/berkerpeksag/astor/issues/48\" data-hovercard-type=\"issue\" data-hovercard-url=\"/berkerpeksag/astor/issues/48/hovercard\" href=\"https://github.com/berkerpeksag/astor/issues/48\">berkerpeksag/astor#48</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"111668947\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/alecthomas/importmagic/issues/25\" data-hovercard-type=\"issue\" data-hovercard-url=\"/alecthomas/importmagic/issues/25/hovercard\" href=\"https://github.com/alecthomas/importmagic/issues/25\">alecthomas/importmagic#25</a>).</p>\n<h3>Source code / logs</h3>\n<p>Initial stack trace:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate.py\", line 49, in &lt;module&gt;\n    sys.exit(doc_generator.build(flags))\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 473, in build\n    write_docs(output_dir, parser_config, yaml_toc=self.yaml_toc)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 127, in write_docs\n    f.write(pretty_docs.build_md_page(page_info))\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/pretty_docs.py\", line 39, in build_md_page\n    return _build_class_page(page_info)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/pretty_docs.py\", line 126, in _build_class_page\n    parts.append(h3.format(**method_info.__dict__))\nAttributeError: '_MethodInfo' object has no attribute '__dict__'\nERROR: Non-zero return code '1' from command: Process exited with status 1.\n</code></pre>\n<p>Stack trace after fixing dictionary problem:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate.py\", line 49, in &lt;module&gt;\n    sys.exit(doc_generator.build(flags))\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 473, in build\n    write_docs(output_dir, parser_config, yaml_toc=self.yaml_toc)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 119, in write_docs\n    page_info = parser.docs_for_object(full_name, py_object, parser_config)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 1201, in docs_for_object\n    page_info.set_signature(py_object, parser_config.reverse_index)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 797, in set_signature\n    self._signature = _generate_signature(function, reverse_index)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 638, in _generate_signature\n    default_text = codegen.to_source(ast_default)\n  File \"/home/amcrae/workspace/tf_docs/venv/lib/python3.5/site-packages/codegen.py\", line 68, in to_source\n    generator.visit(node)\n  File \"/usr/lib/python3.5/ast.py\", line 245, in visit\n    return visitor(node)\n  File \"/home/amcrae/workspace/tf_docs/venv/lib/python3.5/site-packages/codegen.py\", line 386, in visit_Call\n    if node.starargs is not None:\nAttributeError: 'Call' object has no attribute 'starargs'\nERROR: Non-zero return code '1' from command: Process exited with status 1.\n</code></pre>\n<p>UPDATE: Command for fixing dictionary issue is</p>\n<pre><code>sed -i -e 's/__dict__/_asdict()/' tensorflow/tools/docs/pretty_docs.py\n</code></pre>", "body_text": "System information\n\nHave I written custom code: No\nOS Platform and Distribution: Ubuntu 16.04\nTensorFlow installed from: Source\nTensorFlow version: b6bafad\nBazel version: 0.4.5\nExact command to reproduce: bazel run -- //tensorflow/tools/docs:generate --src_dir=tensorflow/docs_src --output_dir=/tmp/tf_docs\n\nDescribe the problem\nProblem 1: Since python 3.5, namedtuple objects have no __dict__ property. See here and here for more details. This problem is easily fixed by changing all instances of h3.format(**info.__dict__) to h3.format(**info._asdict()) in pretty_docs.py.\nProblem 2: The codegen library used by the docs generator is 5 years old and doesn't work with python 3.5 (the problem I'm getting is identical to berkerpeksag/astor#48 and alecthomas/importmagic#25).\nSource code / logs\nInitial stack trace:\nTraceback (most recent call last):\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate.py\", line 49, in <module>\n    sys.exit(doc_generator.build(flags))\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 473, in build\n    write_docs(output_dir, parser_config, yaml_toc=self.yaml_toc)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 127, in write_docs\n    f.write(pretty_docs.build_md_page(page_info))\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/pretty_docs.py\", line 39, in build_md_page\n    return _build_class_page(page_info)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/pretty_docs.py\", line 126, in _build_class_page\n    parts.append(h3.format(**method_info.__dict__))\nAttributeError: '_MethodInfo' object has no attribute '__dict__'\nERROR: Non-zero return code '1' from command: Process exited with status 1.\n\nStack trace after fixing dictionary problem:\nTraceback (most recent call last):\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate.py\", line 49, in <module>\n    sys.exit(doc_generator.build(flags))\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 473, in build\n    write_docs(output_dir, parser_config, yaml_toc=self.yaml_toc)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 119, in write_docs\n    page_info = parser.docs_for_object(full_name, py_object, parser_config)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 1201, in docs_for_object\n    page_info.set_signature(py_object, parser_config.reverse_index)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 797, in set_signature\n    self._signature = _generate_signature(function, reverse_index)\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 638, in _generate_signature\n    default_text = codegen.to_source(ast_default)\n  File \"/home/amcrae/workspace/tf_docs/venv/lib/python3.5/site-packages/codegen.py\", line 68, in to_source\n    generator.visit(node)\n  File \"/usr/lib/python3.5/ast.py\", line 245, in visit\n    return visitor(node)\n  File \"/home/amcrae/workspace/tf_docs/venv/lib/python3.5/site-packages/codegen.py\", line 386, in visit_Call\n    if node.starargs is not None:\nAttributeError: 'Call' object has no attribute 'starargs'\nERROR: Non-zero return code '1' from command: Process exited with status 1.\n\nUPDATE: Command for fixing dictionary issue is\nsed -i -e 's/__dict__/_asdict()/' tensorflow/tools/docs/pretty_docs.py", "body": "### System information\r\n- **Have I written custom code**: No\r\n- **OS Platform and Distribution**: Ubuntu 16.04\r\n- **TensorFlow installed from**: Source\r\n- **TensorFlow version**: b6bafadd51a471daa7157f515598e08e8f9f1611\r\n- **Bazel version**: 0.4.5\r\n- **Exact command to reproduce**: `bazel run -- //tensorflow/tools/docs:generate --src_dir=tensorflow/docs_src --output_dir=/tmp/tf_docs`\r\n\r\n### Describe the problem\r\nProblem 1: Since python 3.5, `namedtuple` objects have no `__dict__` property. See [here](http://stackoverflow.com/questions/34166469/did-something-about-namedtuple-change-in-3-5-1) and [here](http://bugs.python.org/issue24931) for more details. This problem is easily fixed by changing all instances of `h3.format(**info.__dict__)` to `h3.format(**info._asdict())` in [`pretty_docs.py`](https://github.com/tensorflow/tensorflow/blob/b6bafadd51a471daa7157f515598e08e8f9f1611/tensorflow/tools/docs/pretty_docs.py).\r\n\r\nProblem 2: The codegen library used by the docs generator is 5 years old and doesn't work with python 3.5 (the problem I'm getting is identical to https://github.com/berkerpeksag/astor/issues/48 and https://github.com/alecthomas/importmagic/issues/25).\r\n\r\n### Source code / logs\r\nInitial stack trace:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate.py\", line 49, in <module>\r\n    sys.exit(doc_generator.build(flags))\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 473, in build\r\n    write_docs(output_dir, parser_config, yaml_toc=self.yaml_toc)\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 127, in write_docs\r\n    f.write(pretty_docs.build_md_page(page_info))\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/pretty_docs.py\", line 39, in build_md_page\r\n    return _build_class_page(page_info)\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/pretty_docs.py\", line 126, in _build_class_page\r\n    parts.append(h3.format(**method_info.__dict__))\r\nAttributeError: '_MethodInfo' object has no attribute '__dict__'\r\nERROR: Non-zero return code '1' from command: Process exited with status 1.\r\n```\r\n\r\nStack trace after fixing dictionary problem:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate.py\", line 49, in <module>\r\n    sys.exit(doc_generator.build(flags))\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 473, in build\r\n    write_docs(output_dir, parser_config, yaml_toc=self.yaml_toc)\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/generate_lib.py\", line 119, in write_docs\r\n    page_info = parser.docs_for_object(full_name, py_object, parser_config)\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 1201, in docs_for_object\r\n    page_info.set_signature(py_object, parser_config.reverse_index)\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 797, in set_signature\r\n    self._signature = _generate_signature(function, reverse_index)\r\n  File \"/home/amcrae/.cache/bazel/_bazel_amcrae/c5da01ed82406ffc0f71b490859f88cc/execroot/tf_docs/bazel-out/local-py3-opt/bin/tensorflow/tools/docs/generate.runfiles/org_tensorflow/tensorflow/tools/docs/parser.py\", line 638, in _generate_signature\r\n    default_text = codegen.to_source(ast_default)\r\n  File \"/home/amcrae/workspace/tf_docs/venv/lib/python3.5/site-packages/codegen.py\", line 68, in to_source\r\n    generator.visit(node)\r\n  File \"/usr/lib/python3.5/ast.py\", line 245, in visit\r\n    return visitor(node)\r\n  File \"/home/amcrae/workspace/tf_docs/venv/lib/python3.5/site-packages/codegen.py\", line 386, in visit_Call\r\n    if node.starargs is not None:\r\nAttributeError: 'Call' object has no attribute 'starargs'\r\nERROR: Non-zero return code '1' from command: Process exited with status 1.\r\n```\r\n\r\nUPDATE: Command for fixing dictionary issue is \r\n```\r\nsed -i -e 's/__dict__/_asdict()/' tensorflow/tools/docs/pretty_docs.py\r\n```"}