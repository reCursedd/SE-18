{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/305827777", "html_url": "https://github.com/tensorflow/tensorflow/issues/10256#issuecomment-305827777", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10256", "id": 305827777, "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTgyNzc3Nw==", "user": {"login": "Utumno", "id": 1365079, "node_id": "MDQ6VXNlcjEzNjUwNzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/1365079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Utumno", "html_url": "https://github.com/Utumno", "followers_url": "https://api.github.com/users/Utumno/followers", "following_url": "https://api.github.com/users/Utumno/following{/other_user}", "gists_url": "https://api.github.com/users/Utumno/gists{/gist_id}", "starred_url": "https://api.github.com/users/Utumno/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Utumno/subscriptions", "organizations_url": "https://api.github.com/users/Utumno/orgs", "repos_url": "https://api.github.com/users/Utumno/repos", "events_url": "https://api.github.com/users/Utumno/events{/privacy}", "received_events_url": "https://api.github.com/users/Utumno/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-02T15:49:04Z", "updated_at": "2017-06-02T15:49:23Z", "author_association": "NONE", "body_html": "<blockquote>\n<p>I think the errors would be avoided if you add num_epochs=1 to the tf.train.string_input_producer() arguments.</p>\n</blockquote>\n<p>Indeed:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> os\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\ndata_dir <span class=\"pl-k\">=</span> <span class=\"pl-sr\"><span class=\"pl-k\">r</span><span class=\"pl-pds\">\"</span>C:<span class=\"pl-c1\">\\D</span>ropbox<span class=\"pl-cce\">\\e</span>clipse_workspaces<span class=\"pl-cce\">\\p</span>ython<span class=\"pl-cce\">\\n</span>n_nielsen<span class=\"pl-cce\">\\.</span>git<span class=\"pl-cce\">\\i</span>nfo<span class=\"pl-pds\">\"</span></span>\nfilenames <span class=\"pl-k\">=</span> [os.path.join(data_dir, f) <span class=\"pl-k\">for</span> f <span class=\"pl-k\">in</span> os.listdir(data_dir)]\nqueue <span class=\"pl-k\">=</span> tf.train.string_input_producer(filenames, <span class=\"pl-v\">capacity</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">3</span>, <span class=\"pl-v\">num_epochs</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">1</span>)\n\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n    sess.run(tf.global_variables_initializer())\n    sess.run(tf.local_variables_initializer()) <span class=\"pl-c\"><span class=\"pl-c\">#</span> I had to add this too</span>\n    tf.train.start_queue_runners(<span class=\"pl-v\">sess</span><span class=\"pl-k\">=</span>sess)\n    <span class=\"pl-k\">for</span> _ <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">len</span>(filenames)):\n        <span class=\"pl-c1\">print</span>(queue.dequeue().eval())</pre></div>\n<p>Note however the error is only printed for small directories (couple items) in my system - for larger ones I get the warning:</p>\n<blockquote>\n<p>W c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\kernels\\queue_base.cc:294] _0_input_producer: Skipping cancelled enqueue attempt with queue not closed</p>\n</blockquote>\n<p>It's benign as you say but maybe there is something there worth investigating</p>\n<p>Thanks!</p>", "body_text": "I think the errors would be avoided if you add num_epochs=1 to the tf.train.string_input_producer() arguments.\n\nIndeed:\nimport os\nimport tensorflow as tf\n\ndata_dir = r\"C:\\Dropbox\\eclipse_workspaces\\python\\nn_nielsen\\.git\\info\"\nfilenames = [os.path.join(data_dir, f) for f in os.listdir(data_dir)]\nqueue = tf.train.string_input_producer(filenames, capacity=3, num_epochs=1)\n\nwith tf.Session() as sess:\n    sess.run(tf.global_variables_initializer())\n    sess.run(tf.local_variables_initializer()) # I had to add this too\n    tf.train.start_queue_runners(sess=sess)\n    for _ in range(len(filenames)):\n        print(queue.dequeue().eval())\nNote however the error is only printed for small directories (couple items) in my system - for larger ones I get the warning:\n\nW c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\kernels\\queue_base.cc:294] _0_input_producer: Skipping cancelled enqueue attempt with queue not closed\n\nIt's benign as you say but maybe there is something there worth investigating\nThanks!", "body": ">  I think the errors would be avoided if you add num_epochs=1 to the tf.train.string_input_producer() arguments.\r\n\r\nIndeed:\r\n\r\n```python\r\nimport os\r\nimport tensorflow as tf\r\n\r\ndata_dir = r\"C:\\Dropbox\\eclipse_workspaces\\python\\nn_nielsen\\.git\\info\"\r\nfilenames = [os.path.join(data_dir, f) for f in os.listdir(data_dir)]\r\nqueue = tf.train.string_input_producer(filenames, capacity=3, num_epochs=1)\r\n\r\nwith tf.Session() as sess:\r\n    sess.run(tf.global_variables_initializer())\r\n    sess.run(tf.local_variables_initializer()) # I had to add this too\r\n    tf.train.start_queue_runners(sess=sess)\r\n    for _ in range(len(filenames)):\r\n        print(queue.dequeue().eval())\r\n```\r\n\r\nNote however the error is only printed for small directories (couple items) in my system - for larger ones I get the warning:\r\n\r\n> W c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\kernels\\queue_base.cc:294] _0_input_producer: Skipping cancelled enqueue attempt with queue not closed\r\n\r\nIt's benign as you say but maybe there is something there worth investigating\r\n\r\nThanks!"}