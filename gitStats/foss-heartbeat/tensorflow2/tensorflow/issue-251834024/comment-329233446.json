{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/329233446", "html_url": "https://github.com/tensorflow/tensorflow/issues/12474#issuecomment-329233446", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12474", "id": 329233446, "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTIzMzQ0Ng==", "user": {"login": "renganxu", "id": 3160803, "node_id": "MDQ6VXNlcjMxNjA4MDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/3160803?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renganxu", "html_url": "https://github.com/renganxu", "followers_url": "https://api.github.com/users/renganxu/followers", "following_url": "https://api.github.com/users/renganxu/following{/other_user}", "gists_url": "https://api.github.com/users/renganxu/gists{/gist_id}", "starred_url": "https://api.github.com/users/renganxu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renganxu/subscriptions", "organizations_url": "https://api.github.com/users/renganxu/orgs", "repos_url": "https://api.github.com/users/renganxu/repos", "events_url": "https://api.github.com/users/renganxu/events{/privacy}", "received_events_url": "https://api.github.com/users/renganxu/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-13T17:05:43Z", "updated_at": "2017-09-13T17:05:43Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23486130\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tfboyd\">@tfboyd</a>, how did you benchmark the performance of P100 and V100? I used the benchmarks mentioned in <a href=\"https://www.tensorflow.org/performance/benchmarks\" rel=\"nofollow\">https://www.tensorflow.org/performance/benchmarks</a>. But it seems the performance results are incorrect. With real imagenet dataset, I got 905 images/sec with 1 P100 and 1234 images/sec with 4 P100. But that benchmark website has 219 images/sec with 1 P100 and 852 images/sec. So there are huge difference here.</p>\n<p>My command to run the benchmark is:<br>\n<code> export CUDA_VISIBLE_DEVICES=0</code><br>\n<code>python tf_cnn_benchmarks.py \\</code><br>\n<code> --model_name=resnet50 \\</code><br>\n<code> --batch_size=64 \\</code><br>\n<code>--num_batches=2000 \\</code><br>\n<code> --num_gpus=1 \\</code><br>\n<code> --data_dir=/cm/shared/scratch/database/tensorflow \\</code><br>\n<code>--data_name=\"imagenet\"</code></p>\n<p>Is there anything wrong with my command? Also that benchmark website has similar performance with synthetic data, but if I remove \"--data_dir\", the performance is 12866 images/sec which is incorrect. Any comments and suggestions are appreciated!</p>\n<p>Thanks,<br>\nRengan</p>", "body_text": "Hi @tfboyd, how did you benchmark the performance of P100 and V100? I used the benchmarks mentioned in https://www.tensorflow.org/performance/benchmarks. But it seems the performance results are incorrect. With real imagenet dataset, I got 905 images/sec with 1 P100 and 1234 images/sec with 4 P100. But that benchmark website has 219 images/sec with 1 P100 and 852 images/sec. So there are huge difference here.\nMy command to run the benchmark is:\n export CUDA_VISIBLE_DEVICES=0\npython tf_cnn_benchmarks.py \\\n --model_name=resnet50 \\\n --batch_size=64 \\\n--num_batches=2000 \\\n --num_gpus=1 \\\n --data_dir=/cm/shared/scratch/database/tensorflow \\\n--data_name=\"imagenet\"\nIs there anything wrong with my command? Also that benchmark website has similar performance with synthetic data, but if I remove \"--data_dir\", the performance is 12866 images/sec which is incorrect. Any comments and suggestions are appreciated!\nThanks,\nRengan", "body": "Hi @tfboyd, how did you benchmark the performance of P100 and V100? I used the benchmarks mentioned in https://www.tensorflow.org/performance/benchmarks. But it seems the performance results are incorrect. With real imagenet dataset, I got 905 images/sec with 1 P100 and 1234 images/sec with 4 P100. But that benchmark website has 219 images/sec with 1 P100 and 852 images/sec. So there are huge difference here. \r\n\r\nMy command to run the benchmark is:\r\n`` export CUDA_VISIBLE_DEVICES=0``\r\n``python tf_cnn_benchmarks.py \\``\r\n   `` --model_name=resnet50 \\``\r\n   `` --batch_size=64 \\``\r\n    ``--num_batches=2000 \\``\r\n   `` --num_gpus=1 \\``\r\n   `` --data_dir=/cm/shared/scratch/database/tensorflow \\``\r\n    ``--data_name=\"imagenet\"``\r\n\r\nIs there anything wrong with my command? Also that benchmark website has similar performance with synthetic data, but if I remove \"--data_dir\", the performance is 12866 images/sec which is incorrect. Any comments and suggestions are appreciated!\r\n\r\nThanks,\r\nRengan"}