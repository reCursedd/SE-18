{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/267424937", "html_url": "https://github.com/tensorflow/tensorflow/issues/1021#issuecomment-267424937", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1021", "id": 267424937, "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzQyNDkzNw==", "user": {"login": "ulgus", "id": 23620296, "node_id": "MDQ6VXNlcjIzNjIwMjk2", "avatar_url": "https://avatars2.githubusercontent.com/u/23620296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ulgus", "html_url": "https://github.com/ulgus", "followers_url": "https://api.github.com/users/ulgus/followers", "following_url": "https://api.github.com/users/ulgus/following{/other_user}", "gists_url": "https://api.github.com/users/ulgus/gists{/gist_id}", "starred_url": "https://api.github.com/users/ulgus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ulgus/subscriptions", "organizations_url": "https://api.github.com/users/ulgus/orgs", "repos_url": "https://api.github.com/users/ulgus/repos", "events_url": "https://api.github.com/users/ulgus/events{/privacy}", "received_events_url": "https://api.github.com/users/ulgus/received_events", "type": "User", "site_admin": false}, "created_at": "2016-12-15T19:46:33Z", "updated_at": "2016-12-15T19:47:04Z", "author_association": "NONE", "body_html": "<p>I (kind of) got it to work with inception_eval:<br>\n<a href=\"https://github.com/tensorflow/models/blob/master/inception/inception/inception_eval.py\">https://github.com/tensorflow/models/blob/master/inception/inception/inception_eval.py</a></p>\n<p>inception_eval contains a method inference() which I used:</p>\n<pre><code>from inception import inception_model as inception\nimage = ... # some image\nsome_images = np.array(10 * [image]).astype('float32') # stack 10 images into an array\nimage_tensor = tf.constant(some_images)\ninception.inference(image_tensor, 1001) # works with 10 images\n</code></pre>\n<p>The problem: Internally, this code sets up the whole flow graph <em>every time</em> you call inference(), i.e. there is no elegant placeholder mechanism. This leads to quite a bit of overhead: On my Tesla K40, it takes 7 seconds to setup the network and then 28 seconds for to bulk-process 500 images.</p>", "body_text": "I (kind of) got it to work with inception_eval:\nhttps://github.com/tensorflow/models/blob/master/inception/inception/inception_eval.py\ninception_eval contains a method inference() which I used:\nfrom inception import inception_model as inception\nimage = ... # some image\nsome_images = np.array(10 * [image]).astype('float32') # stack 10 images into an array\nimage_tensor = tf.constant(some_images)\ninception.inference(image_tensor, 1001) # works with 10 images\n\nThe problem: Internally, this code sets up the whole flow graph every time you call inference(), i.e. there is no elegant placeholder mechanism. This leads to quite a bit of overhead: On my Tesla K40, it takes 7 seconds to setup the network and then 28 seconds for to bulk-process 500 images.", "body": "I (kind of) got it to work with inception_eval:\r\nhttps://github.com/tensorflow/models/blob/master/inception/inception/inception_eval.py \r\n\r\ninception_eval contains a method inference() which I used:\r\n```\r\nfrom inception import inception_model as inception\r\nimage = ... # some image\r\nsome_images = np.array(10 * [image]).astype('float32') # stack 10 images into an array\r\nimage_tensor = tf.constant(some_images)\r\ninception.inference(image_tensor, 1001) # works with 10 images\r\n```\r\n\r\nThe problem: Internally, this code sets up the whole flow graph *every time* you call inference(), i.e. there is no elegant placeholder mechanism. This leads to quite a bit of overhead: On my Tesla K40, it takes 7 seconds to setup the network and then 28 seconds for to bulk-process 500 images.\r\n\r\n \r\n\r\n\r\n"}