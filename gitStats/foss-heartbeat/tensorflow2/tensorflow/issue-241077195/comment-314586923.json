{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/314586923", "html_url": "https://github.com/tensorflow/tensorflow/issues/11334#issuecomment-314586923", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11334", "id": 314586923, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDU4NjkyMw==", "user": {"login": "faifai21", "id": 4616968, "node_id": "MDQ6VXNlcjQ2MTY5Njg=", "avatar_url": "https://avatars1.githubusercontent.com/u/4616968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/faifai21", "html_url": "https://github.com/faifai21", "followers_url": "https://api.github.com/users/faifai21/followers", "following_url": "https://api.github.com/users/faifai21/following{/other_user}", "gists_url": "https://api.github.com/users/faifai21/gists{/gist_id}", "starred_url": "https://api.github.com/users/faifai21/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/faifai21/subscriptions", "organizations_url": "https://api.github.com/users/faifai21/orgs", "repos_url": "https://api.github.com/users/faifai21/repos", "events_url": "https://api.github.com/users/faifai21/events{/privacy}", "received_events_url": "https://api.github.com/users/faifai21/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-11T22:11:13Z", "updated_at": "2017-07-11T22:11:33Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16018\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/asimshankar\">@asimshankar</a> I pulled in the latest master and built against commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/99a38ffd9d77c55ca6d0c373c6d4b72686284ac5/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/99a38ffd9d77c55ca6d0c373c6d4b72686284ac5\"><tt>99a38ff</tt></a>. The memory leak is still occurring though.</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3376817\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrewharp\">@andrewharp</a> It seems like memory is increasing by ~0.1 MB per inference pass, which makes sense as each input array is around 110kb. As well, increasing the size of the input array does cause the memory leak to increase:</p>\n<ul>\n<li>With an input array of 96*96*3, each input array was 110kb. Memory usage was increasing at ~0.5 mb per sec. With 4.41 inputs processed per sec, it can be inferred that memory was increasing by ~0.11 mb per run.</li>\n<li>With an input array of 120*120*3, each input array was 172kb. Memory usage was increasing at 0.7 mb per sec. Since input size was increased, we were processing slightly less inputs per sec than before. Assuming we were processing 4.1 inputs per sec now, we can infer that each run increased memory by ~0.17mb.</li>\n</ul>\n<p>I was unable to increase input size by anymore, as that caused BufferOverflow exceptions with FloatBuffer as the input array was copied over when creating the Tensor.</p>", "body_text": "@asimshankar I pulled in the latest master and built against commit 99a38ff. The memory leak is still occurring though.\n@andrewharp It seems like memory is increasing by ~0.1 MB per inference pass, which makes sense as each input array is around 110kb. As well, increasing the size of the input array does cause the memory leak to increase:\n\nWith an input array of 96*96*3, each input array was 110kb. Memory usage was increasing at ~0.5 mb per sec. With 4.41 inputs processed per sec, it can be inferred that memory was increasing by ~0.11 mb per run.\nWith an input array of 120*120*3, each input array was 172kb. Memory usage was increasing at 0.7 mb per sec. Since input size was increased, we were processing slightly less inputs per sec than before. Assuming we were processing 4.1 inputs per sec now, we can infer that each run increased memory by ~0.17mb.\n\nI was unable to increase input size by anymore, as that caused BufferOverflow exceptions with FloatBuffer as the input array was copied over when creating the Tensor.", "body": "@asimshankar I pulled in the latest master and built against commit https://github.com/tensorflow/tensorflow/commit/99a38ffd9d77c55ca6d0c373c6d4b72686284ac5. The memory leak is still occurring though.\r\n\r\n@andrewharp It seems like memory is increasing by ~0.1 MB per inference pass, which makes sense as each input array is around 110kb. As well, increasing the size of the input array does cause the memory leak to increase:\r\n\r\n- With an input array of 96\\*96\\*3, each input array was 110kb. Memory usage was increasing at ~0.5 mb per sec. With 4.41 inputs processed per sec, it can be inferred that memory was increasing by ~0.11 mb per run.\r\n- With an input array of 120\\*120\\*3, each input array was 172kb. Memory usage was increasing at 0.7 mb per sec. Since input size was increased, we were processing slightly less inputs per sec than before. Assuming we were processing 4.1 inputs per sec now, we can infer that each run increased memory by ~0.17mb.\r\n\r\nI was unable to increase input size by anymore, as that caused BufferOverflow exceptions with FloatBuffer as the input array was copied over when creating the Tensor. "}