{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/331215569", "html_url": "https://github.com/tensorflow/tensorflow/issues/13202#issuecomment-331215569", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13202", "id": 331215569, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTIxNTU2OQ==", "user": {"login": "PhilJd", "id": 16101605, "node_id": "MDQ6VXNlcjE2MTAxNjA1", "avatar_url": "https://avatars2.githubusercontent.com/u/16101605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilJd", "html_url": "https://github.com/PhilJd", "followers_url": "https://api.github.com/users/PhilJd/followers", "following_url": "https://api.github.com/users/PhilJd/following{/other_user}", "gists_url": "https://api.github.com/users/PhilJd/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilJd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilJd/subscriptions", "organizations_url": "https://api.github.com/users/PhilJd/orgs", "repos_url": "https://api.github.com/users/PhilJd/repos", "events_url": "https://api.github.com/users/PhilJd/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilJd/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-21T16:47:26Z", "updated_at": "2017-09-21T16:47:54Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I'm experiencing the same with the normal <code>tf.Session</code> and also while using the C API directly. The following code keeps the memory on the GPU allocated until it exits.</p>\n<pre><code>#include &lt;tensorflow/c/c_api.h&gt;\n#include &lt;unistd.h&gt;  // usleep\n\n\nint main() {\n    TF_Graph* graph = TF_NewGraph();\n    TF_SessionOptions* options = TF_NewSessionOptions();\n    TF_Status* status = TF_NewStatus();\n    TF_Session* sess = TF_NewSession(graph, options, status);\n    TF_CloseSession(sess, status);\n    TF_DeleteSession(sess, status);\n    TF_DeleteSessionOptions(options);\n    TF_DeleteGraph(graph);\n    TF_DeleteStatus(status);\n    usleep(5000000);  // gpu resources are still allocated here\n}\n</code></pre>\n<p>I'm running Ubuntu 16.04, cudnn 6.0, cuda 8.0, tensorflow-master build is 2 hours old.</p>", "body_text": "I'm experiencing the same with the normal tf.Session and also while using the C API directly. The following code keeps the memory on the GPU allocated until it exits.\n#include <tensorflow/c/c_api.h>\n#include <unistd.h>  // usleep\n\n\nint main() {\n    TF_Graph* graph = TF_NewGraph();\n    TF_SessionOptions* options = TF_NewSessionOptions();\n    TF_Status* status = TF_NewStatus();\n    TF_Session* sess = TF_NewSession(graph, options, status);\n    TF_CloseSession(sess, status);\n    TF_DeleteSession(sess, status);\n    TF_DeleteSessionOptions(options);\n    TF_DeleteGraph(graph);\n    TF_DeleteStatus(status);\n    usleep(5000000);  // gpu resources are still allocated here\n}\n\nI'm running Ubuntu 16.04, cudnn 6.0, cuda 8.0, tensorflow-master build is 2 hours old.", "body": "I'm experiencing the same with the normal `tf.Session` and also while using the C API directly. The following code keeps the memory on the GPU allocated until it exits.\r\n```\r\n#include <tensorflow/c/c_api.h>\r\n#include <unistd.h>  // usleep\r\n\r\n\r\nint main() {\r\n    TF_Graph* graph = TF_NewGraph();\r\n    TF_SessionOptions* options = TF_NewSessionOptions();\r\n    TF_Status* status = TF_NewStatus();\r\n    TF_Session* sess = TF_NewSession(graph, options, status);\r\n    TF_CloseSession(sess, status);\r\n    TF_DeleteSession(sess, status);\r\n    TF_DeleteSessionOptions(options);\r\n    TF_DeleteGraph(graph);\r\n    TF_DeleteStatus(status);\r\n    usleep(5000000);  // gpu resources are still allocated here\r\n}\r\n```\r\n\r\nI'm running Ubuntu 16.04, cudnn 6.0, cuda 8.0, tensorflow-master build is 2 hours old."}