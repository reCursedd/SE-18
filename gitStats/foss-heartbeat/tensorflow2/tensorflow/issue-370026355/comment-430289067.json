{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/430289067", "html_url": "https://github.com/tensorflow/tensorflow/issues/22979#issuecomment-430289067", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22979", "id": 430289067, "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDI4OTA2Nw==", "user": {"login": "kami93", "id": 20102, "node_id": "MDQ6VXNlcjIwMTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/20102?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kami93", "html_url": "https://github.com/kami93", "followers_url": "https://api.github.com/users/kami93/followers", "following_url": "https://api.github.com/users/kami93/following{/other_user}", "gists_url": "https://api.github.com/users/kami93/gists{/gist_id}", "starred_url": "https://api.github.com/users/kami93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kami93/subscriptions", "organizations_url": "https://api.github.com/users/kami93/orgs", "repos_url": "https://api.github.com/users/kami93/repos", "events_url": "https://api.github.com/users/kami93/events{/privacy}", "received_events_url": "https://api.github.com/users/kami93/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-16T15:44:44Z", "updated_at": "2018-10-16T15:44:44Z", "author_association": "NONE", "body_html": "<blockquote>\n<p>Please take a look at keras documentation for <a href=\"https://keras.io/getting-started/faq/#handling-custom-layers-or-other-custom-objects-in-saved-models\" rel=\"nofollow\">handling custom layers (or other custom objects) in saved models</a> if haven't already.</p>\n</blockquote>\n<p>Wow thank you. The custom object scoping resolved my problem.<br>\nex) Make, compile and fit the keras model with custom object under the custom object scope</p>\n<blockquote>\n<p>with tf.keras.utils.custom_object_scope({'StackedSTLSTMCells':STLSTM.StackedSTLSTMCells,<br>\n'STLSTMCell':STLSTM.STLSTMCell}):</p>\n</blockquote>\n<blockquote>\n<p>predRNN = keras.Sequential([<br>\nSTLSTM.STLSTM2D(cells, return_sequences=True, input_shape=(TOTAL_LEN, IMG_SIZE, IMG_SIZE, 1)),<br>\nkeras.layers.Reshape(target_shape=(IMG_SIZE*TOTAL_LEN, IMG_SIZE, FILTERS)),<br>\nkeras.layers.Conv2D(filters=1, kernel_size=1),<br>\nkeras.layers.Reshape(target_shape=(TOTAL_LEN, IMG_SIZE, IMG_SIZE, 1))<br>\n])</p>\n</blockquote>", "body_text": "Please take a look at keras documentation for handling custom layers (or other custom objects) in saved models if haven't already.\n\nWow thank you. The custom object scoping resolved my problem.\nex) Make, compile and fit the keras model with custom object under the custom object scope\n\nwith tf.keras.utils.custom_object_scope({'StackedSTLSTMCells':STLSTM.StackedSTLSTMCells,\n'STLSTMCell':STLSTM.STLSTMCell}):\n\n\npredRNN = keras.Sequential([\nSTLSTM.STLSTM2D(cells, return_sequences=True, input_shape=(TOTAL_LEN, IMG_SIZE, IMG_SIZE, 1)),\nkeras.layers.Reshape(target_shape=(IMG_SIZE*TOTAL_LEN, IMG_SIZE, FILTERS)),\nkeras.layers.Conv2D(filters=1, kernel_size=1),\nkeras.layers.Reshape(target_shape=(TOTAL_LEN, IMG_SIZE, IMG_SIZE, 1))\n])", "body": "> Please take a look at keras documentation for [handling custom layers (or other custom objects) in saved models](https://keras.io/getting-started/faq/#handling-custom-layers-or-other-custom-objects-in-saved-models) if haven't already.\r\n\r\nWow thank you. The custom object scoping resolved my problem.\r\nex) Make, compile and fit the keras model with custom object under the custom object scope\r\n> with tf.keras.utils.custom_object_scope({'StackedSTLSTMCells':STLSTM.StackedSTLSTMCells,\r\n>                                                                  'STLSTMCell':STLSTM.STLSTMCell}):\r\n\r\n>    predRNN = keras.Sequential([\r\n>      STLSTM.STLSTM2D(cells, return_sequences=True, input_shape=(TOTAL_LEN, IMG_SIZE, IMG_SIZE, 1)),\r\n>      keras.layers.Reshape(target_shape=(IMG_SIZE*TOTAL_LEN, IMG_SIZE, FILTERS)),\r\n>      keras.layers.Conv2D(filters=1, kernel_size=1),\r\n>      keras.layers.Reshape(target_shape=(TOTAL_LEN, IMG_SIZE, IMG_SIZE, 1))\r\n>   ])"}