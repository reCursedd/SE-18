{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4519", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4519/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4519/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4519/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4519", "id": 178440675, "node_id": "MDU6SXNzdWUxNzg0NDA2NzU=", "number": 4519, "title": "raw_rnn", "user": {"login": "alrojo", "id": 12167999, "node_id": "MDQ6VXNlcjEyMTY3OTk5", "avatar_url": "https://avatars1.githubusercontent.com/u/12167999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alrojo", "html_url": "https://github.com/alrojo", "followers_url": "https://api.github.com/users/alrojo/followers", "following_url": "https://api.github.com/users/alrojo/following{/other_user}", "gists_url": "https://api.github.com/users/alrojo/gists{/gist_id}", "starred_url": "https://api.github.com/users/alrojo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alrojo/subscriptions", "organizations_url": "https://api.github.com/users/alrojo/orgs", "repos_url": "https://api.github.com/users/alrojo/repos", "events_url": "https://api.github.com/users/alrojo/events{/privacy}", "received_events_url": "https://api.github.com/users/alrojo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-09-21T19:28:02Z", "updated_at": "2016-09-22T01:22:23Z", "closed_at": "2016-09-21T22:21:37Z", "author_association": "CONTRIBUTOR", "body_html": "<p>For <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1794715\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ebrevdo\">@ebrevdo</a> on his new <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L1018\">raw_rnn implementation</a>.</p>\n<p>In your <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L1064\">example</a></p>\n<p>When you define <code>next_input</code> as the following:</p>\n<div class=\"highlight highlight-source-python\"><pre>elements_finished <span class=\"pl-k\">=</span> (time <span class=\"pl-k\">&gt;=</span> sequence_length)\n<span class=\"pl-c1\">...</span>\nnext_input <span class=\"pl-k\">=</span> tf.cond(\n    finished,\n    <span class=\"pl-k\">lambda</span>: tf.zeros([batch_size, input_depth], <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32),\n    <span class=\"pl-k\">lambda</span>: inputs_ta.read(time))</pre></div>\n<p>Why make it return an zero input? Will this not cause the last state to be computed incorrectly (with zeros as input)?</p>\n<p>Alternatively the zero input can be removed, by rewriting it the following way</p>\n<div class=\"highlight highlight-source-python\"><pre>elements_finished <span class=\"pl-k\">=</span> (time <span class=\"pl-k\">&gt;=</span> (sequence_length<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>))\n<span class=\"pl-c1\">...</span>\nnext_input <span class=\"pl-k\">=</span> inputs_ta.read(time)</pre></div>\n<p>Thanks</p>", "body_text": "For @ebrevdo on his new raw_rnn implementation.\nIn your example\nWhen you define next_input as the following:\nelements_finished = (time >= sequence_length)\n...\nnext_input = tf.cond(\n    finished,\n    lambda: tf.zeros([batch_size, input_depth], dtype=tf.float32),\n    lambda: inputs_ta.read(time))\nWhy make it return an zero input? Will this not cause the last state to be computed incorrectly (with zeros as input)?\nAlternatively the zero input can be removed, by rewriting it the following way\nelements_finished = (time >= (sequence_length-1))\n...\nnext_input = inputs_ta.read(time)\nThanks", "body": "For @ebrevdo on his new [raw_rnn implementation](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L1018).\n\nIn your [example](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/rnn.py#L1064)\n\nWhen you define `next_input` as the following:\n\n``` python\nelements_finished = (time >= sequence_length)\n...\nnext_input = tf.cond(\n    finished,\n    lambda: tf.zeros([batch_size, input_depth], dtype=tf.float32),\n    lambda: inputs_ta.read(time))\n```\n\nWhy make it return an zero input? Will this not cause the last state to be computed incorrectly (with zeros as input)?\n\nAlternatively the zero input can be removed, by rewriting it the following way\n\n``` python\nelements_finished = (time >= (sequence_length-1))\n...\nnext_input = inputs_ta.read(time)\n```\n\nThanks\n"}