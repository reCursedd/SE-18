{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22795", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22795/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22795/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22795/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22795", "id": 367439141, "node_id": "MDU6SXNzdWUzNjc0MzkxNDE=", "number": 22795, "title": "System freezes after decreasing batch size when using CuDNNLSTM", "user": {"login": "twolodzko", "id": 3750140, "node_id": "MDQ6VXNlcjM3NTAxNDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/3750140?v=4", "gravatar_id": "", "url": "https://api.github.com/users/twolodzko", "html_url": "https://github.com/twolodzko", "followers_url": "https://api.github.com/users/twolodzko/followers", "following_url": "https://api.github.com/users/twolodzko/following{/other_user}", "gists_url": "https://api.github.com/users/twolodzko/gists{/gist_id}", "starred_url": "https://api.github.com/users/twolodzko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/twolodzko/subscriptions", "organizations_url": "https://api.github.com/users/twolodzko/orgs", "repos_url": "https://api.github.com/users/twolodzko/repos", "events_url": "https://api.github.com/users/twolodzko/events{/privacy}", "received_events_url": "https://api.github.com/users/twolodzko/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-10-06T09:07:47Z", "updated_at": "2018-10-24T18:20:50Z", "closed_at": "2018-10-23T14:22:09Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 18.04</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>: No</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Yes (conda)</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.10.0</li>\n<li><strong>Python version</strong>: 3.6.6</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>: 10.0, V10.0.130</li>\n<li><strong>GPU model and memory</strong>: GeForce GTX 1070</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>While executing rather simple model in Keras/TensorFlow with three <code>keras.layers.CuDNNLSTM</code> layers, some skip connections, <code>Embedding</code> and <code>Dense</code> layers with &lt;10 GB data read from numpy arrays, my system has frozen after using smaller batch size. When using batches of size 512 or larger everything was fine, when decreasing it to 256 system freezes (still screen, mouse and keyboard non responsive) after just a few dozen of iterations (not epochs). This happened several times in a row, with no single success, so I stopped experimenting further. Once I waited for 10 minutes to see if anything changes, but with no success. Everything went fine when using smaller batches and regular <code>keras.layers.LSTM</code> layers. Additionally, I used <code>nvidia-smi</code> and <code>top</code> monitoring tools and didn't notice anything strange before the crashes, but I might have missed something because of screen freezes. RAM and GPU usage in seconds before crushes was fine, far from limits.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\nTensorFlow installed from (source or binary): Yes (conda)\nTensorFlow version (use command below): 1.10.0\nPython version: 3.6.6\nBazel version (if compiling from source):\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version: 10.0, V10.0.130\nGPU model and memory: GeForce GTX 1070\nExact command to reproduce:\n\nDescribe the problem\nWhile executing rather simple model in Keras/TensorFlow with three keras.layers.CuDNNLSTM layers, some skip connections, Embedding and Dense layers with <10 GB data read from numpy arrays, my system has frozen after using smaller batch size. When using batches of size 512 or larger everything was fine, when decreasing it to 256 system freezes (still screen, mouse and keyboard non responsive) after just a few dozen of iterations (not epochs). This happened several times in a row, with no single success, so I stopped experimenting further. Once I waited for 10 minutes to see if anything changes, but with no success. Everything went fine when using smaller batches and regular keras.layers.LSTM layers. Additionally, I used nvidia-smi and top monitoring tools and didn't notice anything strange before the crashes, but I might have missed something because of screen freezes. RAM and GPU usage in seconds before crushes was fine, far from limits.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No\r\n- **TensorFlow installed from (source or binary)**: Yes (conda)\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 3.6.6\r\n- **Bazel version (if compiling from source)**: \r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: 10.0, V10.0.130\r\n- **GPU model and memory**: GeForce GTX 1070 \r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nWhile executing rather simple model in Keras/TensorFlow with three `keras.layers.CuDNNLSTM` layers, some skip connections, `Embedding` and `Dense` layers with <10 GB data read from numpy arrays, my system has frozen after using smaller batch size. When using batches of size 512 or larger everything was fine, when decreasing it to 256 system freezes (still screen, mouse and keyboard non responsive) after just a few dozen of iterations (not epochs). This happened several times in a row, with no single success, so I stopped experimenting further. Once I waited for 10 minutes to see if anything changes, but with no success. Everything went fine when using smaller batches and regular `keras.layers.LSTM` layers. Additionally, I used `nvidia-smi` and `top` monitoring tools and didn't notice anything strange before the crashes, but I might have missed something because of screen freezes. RAM and GPU usage in seconds before crushes was fine, far from limits."}