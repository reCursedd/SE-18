{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/304045480", "html_url": "https://github.com/tensorflow/tensorflow/issues/7246#issuecomment-304045480", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7246", "id": 304045480, "node_id": "MDEyOklzc3VlQ29tbWVudDMwNDA0NTQ4MA==", "user": {"login": "dylanrandle", "id": 14814084, "node_id": "MDQ6VXNlcjE0ODE0MDg0", "avatar_url": "https://avatars1.githubusercontent.com/u/14814084?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dylanrandle", "html_url": "https://github.com/dylanrandle", "followers_url": "https://api.github.com/users/dylanrandle/followers", "following_url": "https://api.github.com/users/dylanrandle/following{/other_user}", "gists_url": "https://api.github.com/users/dylanrandle/gists{/gist_id}", "starred_url": "https://api.github.com/users/dylanrandle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dylanrandle/subscriptions", "organizations_url": "https://api.github.com/users/dylanrandle/orgs", "repos_url": "https://api.github.com/users/dylanrandle/repos", "events_url": "https://api.github.com/users/dylanrandle/events{/privacy}", "received_events_url": "https://api.github.com/users/dylanrandle/received_events", "type": "User", "site_admin": false}, "created_at": "2017-05-25T15:49:30Z", "updated_at": "2017-05-26T21:55:53Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15736910\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zheng-xq\">@zheng-xq</a> and <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a>,<br>\nI am also having the same problem. I am running a 2 layer bidirectional LSTM with 128 nodes in each layer, as well as some fully connected layers after. I am training in batch mode as well (16 inputs/batch) and EVERY batch I see this in the console:</p>\n<p>I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2243 get requests, put_count=4572 evicted_count=2000 eviction_rate=0.437445 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:06.663221: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 12011 get requests, put_count=24340 evicted_count=12000 eviction_rate=0.493016 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:06.901503: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 21738 get requests, put_count=44067 evicted_count=22000 eviction_rate=0.49924 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:07.138803: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 31460 get requests, put_count=63789 evicted_count=32000 eviction_rate=0.501654 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:07.377981: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 41184 get requests, put_count=83513 evicted_count=42000 eviction_rate=0.502916 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:07.617605: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 50905 get requests, put_count=103234 evicted_count=52000 eviction_rate=0.50371 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:07.857844: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 60626 get requests, put_count=122955 evicted_count=62000 eviction_rate=0.50425 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:08.094322: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 70348 get requests, put_count=142677 evicted_count=72000 eviction_rate=0.504636 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:08.331157: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 80122 get requests, put_count=162451 evicted_count=82000 eviction_rate=0.504768 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:08.565842: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 89849 get requests, put_count=182178 evicted_count=92000 eviction_rate=0.505001 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:08.770882: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 99570 get requests, put_count=201899 evicted_count=102000 eviction_rate=0.505203 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:09.042809: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 107869 get requests, put_count=220198 evicted_count=112000 eviction_rate=0.508633 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:09.277130: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 117596 get requests, put_count=239925 evicted_count=122000 eviction_rate=0.508492 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:09.500336: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 127318 get requests, put_count=259647 evicted_count=132000 eviction_rate=0.508383 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:09.732960: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 137042 get requests, put_count=279371 evicted_count=142000 eviction_rate=0.508285 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:09.965206: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 146763 get requests, put_count=299092 evicted_count=152000 eviction_rate=0.508205 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:10.199228: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 156484 get requests, put_count=318813 evicted_count=162000 eviction_rate=0.508135 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:10.430862: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 166206 get requests, put_count=338535 evicted_count=172000 eviction_rate=0.508072 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:10.661903: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 175980 get requests, put_count=358309 evicted_count=182000 eviction_rate=0.507941 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:10.892090: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 185707 get requests, put_count=378036 evicted_count=192000 eviction_rate=0.507888 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:11.122478: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 195428 get requests, put_count=397757 evicted_count=202000 eviction_rate=0.507848 and unsatisfied allocation rate=0<br>\n2017-05-25 15:46:11.354941: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 205154 get requests, put_count=417483 evicted_count=212000 eviction_rate=0.507805 and unsatisfied allocation rate=0</p>\n<p>Because of this the code runs very slow. I'm running on:<br>\nOS:Ubuntu 16.04.1 LTS<br>\nCUDA: 8.0<br>\nCUDNN: 5.1<br>\nTensorflow: 1.1<br>\nNvidia drivers: 375.51<br>\nGPU: Tesla K80</p>\n<p>As an additional note: the GPU is only being utilized about 60% during training. There doesn't seem to be a bottleneck on CPU because we have 4 cores and they are 70% idle.</p>\n<p>Thank you SO much for your help.</p>\n<p>Best,<br>\nDylan</p>", "body_text": "Hi @zheng-xq and @yaroslavvb,\nI am also having the same problem. I am running a 2 layer bidirectional LSTM with 128 nodes in each layer, as well as some fully connected layers after. I am training in batch mode as well (16 inputs/batch) and EVERY batch I see this in the console:\nI tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2243 get requests, put_count=4572 evicted_count=2000 eviction_rate=0.437445 and unsatisfied allocation rate=0\n2017-05-25 15:46:06.663221: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 12011 get requests, put_count=24340 evicted_count=12000 eviction_rate=0.493016 and unsatisfied allocation rate=0\n2017-05-25 15:46:06.901503: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 21738 get requests, put_count=44067 evicted_count=22000 eviction_rate=0.49924 and unsatisfied allocation rate=0\n2017-05-25 15:46:07.138803: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 31460 get requests, put_count=63789 evicted_count=32000 eviction_rate=0.501654 and unsatisfied allocation rate=0\n2017-05-25 15:46:07.377981: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 41184 get requests, put_count=83513 evicted_count=42000 eviction_rate=0.502916 and unsatisfied allocation rate=0\n2017-05-25 15:46:07.617605: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 50905 get requests, put_count=103234 evicted_count=52000 eviction_rate=0.50371 and unsatisfied allocation rate=0\n2017-05-25 15:46:07.857844: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 60626 get requests, put_count=122955 evicted_count=62000 eviction_rate=0.50425 and unsatisfied allocation rate=0\n2017-05-25 15:46:08.094322: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 70348 get requests, put_count=142677 evicted_count=72000 eviction_rate=0.504636 and unsatisfied allocation rate=0\n2017-05-25 15:46:08.331157: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 80122 get requests, put_count=162451 evicted_count=82000 eviction_rate=0.504768 and unsatisfied allocation rate=0\n2017-05-25 15:46:08.565842: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 89849 get requests, put_count=182178 evicted_count=92000 eviction_rate=0.505001 and unsatisfied allocation rate=0\n2017-05-25 15:46:08.770882: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 99570 get requests, put_count=201899 evicted_count=102000 eviction_rate=0.505203 and unsatisfied allocation rate=0\n2017-05-25 15:46:09.042809: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 107869 get requests, put_count=220198 evicted_count=112000 eviction_rate=0.508633 and unsatisfied allocation rate=0\n2017-05-25 15:46:09.277130: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 117596 get requests, put_count=239925 evicted_count=122000 eviction_rate=0.508492 and unsatisfied allocation rate=0\n2017-05-25 15:46:09.500336: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 127318 get requests, put_count=259647 evicted_count=132000 eviction_rate=0.508383 and unsatisfied allocation rate=0\n2017-05-25 15:46:09.732960: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 137042 get requests, put_count=279371 evicted_count=142000 eviction_rate=0.508285 and unsatisfied allocation rate=0\n2017-05-25 15:46:09.965206: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 146763 get requests, put_count=299092 evicted_count=152000 eviction_rate=0.508205 and unsatisfied allocation rate=0\n2017-05-25 15:46:10.199228: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 156484 get requests, put_count=318813 evicted_count=162000 eviction_rate=0.508135 and unsatisfied allocation rate=0\n2017-05-25 15:46:10.430862: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 166206 get requests, put_count=338535 evicted_count=172000 eviction_rate=0.508072 and unsatisfied allocation rate=0\n2017-05-25 15:46:10.661903: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 175980 get requests, put_count=358309 evicted_count=182000 eviction_rate=0.507941 and unsatisfied allocation rate=0\n2017-05-25 15:46:10.892090: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 185707 get requests, put_count=378036 evicted_count=192000 eviction_rate=0.507888 and unsatisfied allocation rate=0\n2017-05-25 15:46:11.122478: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 195428 get requests, put_count=397757 evicted_count=202000 eviction_rate=0.507848 and unsatisfied allocation rate=0\n2017-05-25 15:46:11.354941: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 205154 get requests, put_count=417483 evicted_count=212000 eviction_rate=0.507805 and unsatisfied allocation rate=0\nBecause of this the code runs very slow. I'm running on:\nOS:Ubuntu 16.04.1 LTS\nCUDA: 8.0\nCUDNN: 5.1\nTensorflow: 1.1\nNvidia drivers: 375.51\nGPU: Tesla K80\nAs an additional note: the GPU is only being utilized about 60% during training. There doesn't seem to be a bottleneck on CPU because we have 4 cores and they are 70% idle.\nThank you SO much for your help.\nBest,\nDylan", "body": "Hi @zheng-xq and @yaroslavvb,\r\nI am also having the same problem. I am running a 2 layer bidirectional LSTM with 128 nodes in each layer, as well as some fully connected layers after. I am training in batch mode as well (16 inputs/batch) and EVERY batch I see this in the console:\r\n\r\nI tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2243 get requests, put_count=4572 evicted_count=2000 eviction_rate=0.437445 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:06.663221: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 12011 get requests, put_count=24340 evicted_count=12000 eviction_rate=0.493016 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:06.901503: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 21738 get requests, put_count=44067 evicted_count=22000 eviction_rate=0.49924 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:07.138803: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 31460 get requests, put_count=63789 evicted_count=32000 eviction_rate=0.501654 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:07.377981: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 41184 get requests, put_count=83513 evicted_count=42000 eviction_rate=0.502916 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:07.617605: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 50905 get requests, put_count=103234 evicted_count=52000 eviction_rate=0.50371 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:07.857844: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 60626 get requests, put_count=122955 evicted_count=62000 eviction_rate=0.50425 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:08.094322: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 70348 get requests, put_count=142677 evicted_count=72000 eviction_rate=0.504636 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:08.331157: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 80122 get requests, put_count=162451 evicted_count=82000 eviction_rate=0.504768 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:08.565842: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 89849 get requests, put_count=182178 evicted_count=92000 eviction_rate=0.505001 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:08.770882: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 99570 get requests, put_count=201899 evicted_count=102000 eviction_rate=0.505203 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:09.042809: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 107869 get requests, put_count=220198 evicted_count=112000 eviction_rate=0.508633 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:09.277130: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 117596 get requests, put_count=239925 evicted_count=122000 eviction_rate=0.508492 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:09.500336: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 127318 get requests, put_count=259647 evicted_count=132000 eviction_rate=0.508383 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:09.732960: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 137042 get requests, put_count=279371 evicted_count=142000 eviction_rate=0.508285 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:09.965206: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 146763 get requests, put_count=299092 evicted_count=152000 eviction_rate=0.508205 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:10.199228: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 156484 get requests, put_count=318813 evicted_count=162000 eviction_rate=0.508135 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:10.430862: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 166206 get requests, put_count=338535 evicted_count=172000 eviction_rate=0.508072 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:10.661903: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 175980 get requests, put_count=358309 evicted_count=182000 eviction_rate=0.507941 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:10.892090: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 185707 get requests, put_count=378036 evicted_count=192000 eviction_rate=0.507888 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:11.122478: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 195428 get requests, put_count=397757 evicted_count=202000 eviction_rate=0.507848 and unsatisfied allocation rate=0\r\n2017-05-25 15:46:11.354941: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 205154 get requests, put_count=417483 evicted_count=212000 eviction_rate=0.507805 and unsatisfied allocation rate=0\r\n\r\nBecause of this the code runs very slow. I'm running on:\r\nOS:Ubuntu 16.04.1 LTS\r\nCUDA: 8.0\r\nCUDNN: 5.1\r\nTensorflow: 1.1\r\nNvidia drivers: 375.51\r\nGPU: Tesla K80\r\n\r\nAs an additional note: the GPU is only being utilized about 60% during training. There doesn't seem to be a bottleneck on CPU because we have 4 cores and they are 70% idle. \r\n\r\nThank you SO much for your help. \r\n\r\nBest,\r\nDylan"}