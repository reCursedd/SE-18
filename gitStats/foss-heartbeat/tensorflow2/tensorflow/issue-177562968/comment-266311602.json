{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/266311602", "html_url": "https://github.com/tensorflow/tensorflow/issues/4423#issuecomment-266311602", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4423", "id": 266311602, "node_id": "MDEyOklzc3VlQ29tbWVudDI2NjMxMTYwMg==", "user": {"login": "yuanbyu", "id": 2342391, "node_id": "MDQ6VXNlcjIzNDIzOTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/2342391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuanbyu", "html_url": "https://github.com/yuanbyu", "followers_url": "https://api.github.com/users/yuanbyu/followers", "following_url": "https://api.github.com/users/yuanbyu/following{/other_user}", "gists_url": "https://api.github.com/users/yuanbyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuanbyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuanbyu/subscriptions", "organizations_url": "https://api.github.com/users/yuanbyu/orgs", "repos_url": "https://api.github.com/users/yuanbyu/repos", "events_url": "https://api.github.com/users/yuanbyu/events{/privacy}", "received_events_url": "https://api.github.com/users/yuanbyu/received_events", "type": "User", "site_admin": false}, "created_at": "2016-12-11T22:03:30Z", "updated_at": "2016-12-11T22:03:30Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Your set_shape() line implicitly adds something (i.e., tf.equal(tf.shape(a)[1], 1) is True) that the current TensorFlow is not able to infer. So tf.gradients tries to generate the gradient code for the false branch of the code because it can't statically determine that it is infeasible. Obviously this would cause the shape inference to fail. In general, don't use set_shape to make shapes more concrete when you need to compute gradients.</p>", "body_text": "Your set_shape() line implicitly adds something (i.e., tf.equal(tf.shape(a)[1], 1) is True) that the current TensorFlow is not able to infer. So tf.gradients tries to generate the gradient code for the false branch of the code because it can't statically determine that it is infeasible. Obviously this would cause the shape inference to fail. In general, don't use set_shape to make shapes more concrete when you need to compute gradients.", "body": "Your set_shape() line implicitly adds something (i.e., tf.equal(tf.shape(a)[1], 1) is True) that the current TensorFlow is not able to infer. So tf.gradients tries to generate the gradient code for the false branch of the code because it can't statically determine that it is infeasible. Obviously this would cause the shape inference to fail. In general, don't use set_shape to make shapes more concrete when you need to compute gradients."}