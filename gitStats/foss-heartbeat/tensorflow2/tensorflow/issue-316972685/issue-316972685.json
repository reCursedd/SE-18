{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18807", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18807/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18807/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18807/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18807", "id": 316972685, "node_id": "MDU6SXNzdWUzMTY5NzI2ODU=", "number": 18807, "title": "OpKernel not registered, despite being listed in OpRegistry", "user": {"login": "sadlerjw", "id": 2762244, "node_id": "MDQ6VXNlcjI3NjIyNDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/2762244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sadlerjw", "html_url": "https://github.com/sadlerjw", "followers_url": "https://api.github.com/users/sadlerjw/followers", "following_url": "https://api.github.com/users/sadlerjw/following{/other_user}", "gists_url": "https://api.github.com/users/sadlerjw/gists{/gist_id}", "starred_url": "https://api.github.com/users/sadlerjw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sadlerjw/subscriptions", "organizations_url": "https://api.github.com/users/sadlerjw/orgs", "repos_url": "https://api.github.com/users/sadlerjw/repos", "events_url": "https://api.github.com/users/sadlerjw/events{/privacy}", "received_events_url": "https://api.github.com/users/sadlerjw/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-04-23T20:34:00Z", "updated_at": "2018-11-14T19:17:34Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:macOS High Sierra 10.13.3</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.7.0</li>\n<li><strong>Python version</strong>: 2.7.14</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.12.0-homebrew</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: Xcode 9.3: Apple LLVM version 9.1.0 (clang-902.0.39.1)</li>\n<li><strong>CUDA/cuDNN version</strong>: n/a</li>\n<li><strong>GPU model and memory</strong>: n/a</li>\n<li><strong>Exact command to reproduce</strong>: <code>tensorflow/contrib/makefile/build_all_ios.sh -g /path/to/model.p</code></li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I have a ListDiff op in my model; as such, the generated <code>ops_to_register</code> file includes the following bits (edited way down to fit nicely):</p>\n<div class=\"highlight highlight-source-c\"><pre>constexpr <span class=\"pl-k\">inline</span> <span class=\"pl-k\">bool</span> <span class=\"pl-en\">ShouldRegisterOp</span>(<span class=\"pl-k\">const</span> <span class=\"pl-k\">char</span> op[]) {\n  <span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>\n     || <span class=\"pl-c1\">isequal</span>(op, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ListDiff<span class=\"pl-pds\">\"</span></span>)\n  ;\n}</pre></div>\n<div class=\"highlight highlight-source-c\"><pre>constexpr <span class=\"pl-k\">const</span> <span class=\"pl-k\">char</span>* <span class=\"pl-c1\">kNecessaryOpKernelClasses</span>[] = {\n  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ListDiffOp&lt;::tensorflow::int32, int32&gt;<span class=\"pl-pds\">\"</span></span>,\n};</pre></div>\n<p>However, when I try to load the model, it gives:</p>\n<pre><code>Error adding graph to session: No OpKernel was registered to support Op 'ListDiff' with these attrs.  Registered devices: [CPU], Registered kernels:\n  &lt;no registered kernels&gt;\n\n\t [[Node: rgb_to_grayscale/Tensordot/ListDiff = ListDiff[T=DT_INT32, out_idx=DT_INT32](rgb_to_grayscale/Tensordot/range, rgb_to_grayscale/Tensordot/add_1)]]\n</code></pre>\n<p>If I print the full list of registered ops via <code>tensorflow::OpRegistry::Global()-&gt;DebugString(false)</code>, the line for ListDiff is (line breaks added for readability):</p>\n<pre><code>Op&lt;\n    name=ListDiff; \n    signature=x:T, y:T -&gt; out:T, idx:out_idx; \n    attr=T:type; \n    attr=out_idx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]\n&gt;\n</code></pre>\n<p>The only thing I can think of here is that <code>T:type</code> has no allowable values (I would expect to see <code>DT_INT32</code> given my <code>ops_to_register.h</code> file). However in a working build before I added <code>ListDiff</code>,  I had a few ops that has no listed allowable values (<code>Reshape</code> and <code>Squeeze</code>, in this case). I've read through the code that registers the <code>ListDiff</code> op and couldn't find anything out of the ordinary, but I'm a fairly novice Tensorflower.</p>\n<p>Possibly related to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"285202754\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/15732\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/15732/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/15732\">#15732</a>?</p>\n<h3>Source code / logs</h3>\n<p>N/A</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):macOS High Sierra 10.13.3\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.7.0\nPython version: 2.7.14\nBazel version (if compiling from source): 0.12.0-homebrew\nGCC/Compiler version (if compiling from source): Xcode 9.3: Apple LLVM version 9.1.0 (clang-902.0.39.1)\nCUDA/cuDNN version: n/a\nGPU model and memory: n/a\nExact command to reproduce: tensorflow/contrib/makefile/build_all_ios.sh -g /path/to/model.p\n\nDescribe the problem\nI have a ListDiff op in my model; as such, the generated ops_to_register file includes the following bits (edited way down to fit nicely):\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\n  return false\n     || isequal(op, \"ListDiff\")\n  ;\n}\nconstexpr const char* kNecessaryOpKernelClasses[] = {\n  \"ListDiffOp<::tensorflow::int32, int32>\",\n};\nHowever, when I try to load the model, it gives:\nError adding graph to session: No OpKernel was registered to support Op 'ListDiff' with these attrs.  Registered devices: [CPU], Registered kernels:\n  <no registered kernels>\n\n\t [[Node: rgb_to_grayscale/Tensordot/ListDiff = ListDiff[T=DT_INT32, out_idx=DT_INT32](rgb_to_grayscale/Tensordot/range, rgb_to_grayscale/Tensordot/add_1)]]\n\nIf I print the full list of registered ops via tensorflow::OpRegistry::Global()->DebugString(false), the line for ListDiff is (line breaks added for readability):\nOp<\n    name=ListDiff; \n    signature=x:T, y:T -> out:T, idx:out_idx; \n    attr=T:type; \n    attr=out_idx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]\n>\n\nThe only thing I can think of here is that T:type has no allowable values (I would expect to see DT_INT32 given my ops_to_register.h file). However in a working build before I added ListDiff,  I had a few ops that has no listed allowable values (Reshape and Squeeze, in this case). I've read through the code that registers the ListDiff op and couldn't find anything out of the ordinary, but I'm a fairly novice Tensorflower.\nPossibly related to #15732?\nSource code / logs\nN/A", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:macOS High Sierra 10.13.3\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.7.0\r\n- **Python version**: 2.7.14\r\n- **Bazel version (if compiling from source)**: 0.12.0-homebrew\r\n- **GCC/Compiler version (if compiling from source)**: Xcode 9.3: Apple LLVM version 9.1.0 (clang-902.0.39.1)\r\n- **CUDA/cuDNN version**: n/a\r\n- **GPU model and memory**: n/a\r\n- **Exact command to reproduce**: `tensorflow/contrib/makefile/build_all_ios.sh -g /path/to/model.p`\r\n\r\n### Describe the problem\r\nI have a ListDiff op in my model; as such, the generated `ops_to_register` file includes the following bits (edited way down to fit nicely):\r\n\r\n```c\r\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\r\n  return false\r\n     || isequal(op, \"ListDiff\")\r\n  ;\r\n}\r\n```\r\n```c\r\nconstexpr const char* kNecessaryOpKernelClasses[] = {\r\n  \"ListDiffOp<::tensorflow::int32, int32>\",\r\n};\r\n```\r\n\r\nHowever, when I try to load the model, it gives:\r\n```\r\nError adding graph to session: No OpKernel was registered to support Op 'ListDiff' with these attrs.  Registered devices: [CPU], Registered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[Node: rgb_to_grayscale/Tensordot/ListDiff = ListDiff[T=DT_INT32, out_idx=DT_INT32](rgb_to_grayscale/Tensordot/range, rgb_to_grayscale/Tensordot/add_1)]]\r\n```\r\n\r\nIf I print the full list of registered ops via `tensorflow::OpRegistry::Global()->DebugString(false)`, the line for ListDiff is (line breaks added for readability):\r\n\r\n```\r\nOp<\r\n    name=ListDiff; \r\n    signature=x:T, y:T -> out:T, idx:out_idx; \r\n    attr=T:type; \r\n    attr=out_idx:type,default=DT_INT32,allowed=[DT_INT32, DT_INT64]\r\n>\r\n```\r\n\r\nThe only thing I can think of here is that `T:type` has no allowable values (I would expect to see `DT_INT32` given my `ops_to_register.h` file). However in a working build before I added `ListDiff`,  I had a few ops that has no listed allowable values (`Reshape` and `Squeeze`, in this case). I've read through the code that registers the `ListDiff` op and couldn't find anything out of the ordinary, but I'm a fairly novice Tensorflower.\r\n\r\nPossibly related to #15732?\r\n\r\n### Source code / logs\r\nN/A\r\n"}