{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/216052421", "html_url": "https://github.com/tensorflow/tensorflow/issues/367#issuecomment-216052421", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/367", "id": 216052421, "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjA1MjQyMQ==", "user": {"login": "c0g", "id": 1376357, "node_id": "MDQ6VXNlcjEzNzYzNTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1376357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c0g", "html_url": "https://github.com/c0g", "followers_url": "https://api.github.com/users/c0g/followers", "following_url": "https://api.github.com/users/c0g/following{/other_user}", "gists_url": "https://api.github.com/users/c0g/gists{/gist_id}", "starred_url": "https://api.github.com/users/c0g/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c0g/subscriptions", "organizations_url": "https://api.github.com/users/c0g/orgs", "repos_url": "https://api.github.com/users/c0g/repos", "events_url": "https://api.github.com/users/c0g/events{/privacy}", "received_events_url": "https://api.github.com/users/c0g/received_events", "type": "User", "site_admin": false}, "created_at": "2016-05-01T16:10:57Z", "updated_at": "2016-05-03T10:42:47Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6596998\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/alexggmatthews\">@alexggmatthews</a> said to post here when I had something to show and to tag <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16907534\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rmlarsen\">@rmlarsen</a> and <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a> - hi guys!</p>\n<p>I've been working on making a CUDA version of Alex's code. I now have the following ops implemented in <a href=\"https://github.com/c0g/tensorflow/tree/master/tensorflow/core/user_ops\">my fork</a>:</p>\n<ul>\n<li>get_diag (get_diag*)</li>\n<li>tril (triangle*)</li>\n<li>cholesky (gpu_cholesky*)</li>\n<li>cholesky_grad (gpu_cholgrad*)</li>\n</ul>\n<p>There is still a lot left to do, but the algorithms are all there and I believe they numerically match Alex's code. I will be adding python wrappers and tests over the coming days, as well as tidying up source files and trying to get it all to build with Bazel.</p>\n<p>Meantime, I have a few questions:</p>\n<h3>streams</h3>\n<p>Is it correct to call standard CUDA kernels and operations on the op's stream by launching with <code>context-&gt;eigen_device&lt;Device&gt;().stream()</code>?</p>\n<h3>stream.ThenLaunch()</h3>\n<p>I think there is a way to launch kernels directly on a tensorflow stream - but there's not much information on TypedKernel or Kernel that I can find. Do I need to worry about this?</p>\n<h3>cusolver:</h3>\n<p>I use cusolver for the cholesky op. This isn't yet wrapped in Stream.h so I'm linking/calling it raw. This adds a dependency on linking cusolver into the framework, and maybe wrapping it as you guys have wrapped cublas.</p>\n<p><strong>edit:</strong> I will also work on reflecting the style/formatting recommendations made on Alex's code.</p>", "body_text": "@alexggmatthews said to post here when I had something to show and to tag @rmlarsen and @yaroslavvb - hi guys!\nI've been working on making a CUDA version of Alex's code. I now have the following ops implemented in my fork:\n\nget_diag (get_diag*)\ntril (triangle*)\ncholesky (gpu_cholesky*)\ncholesky_grad (gpu_cholgrad*)\n\nThere is still a lot left to do, but the algorithms are all there and I believe they numerically match Alex's code. I will be adding python wrappers and tests over the coming days, as well as tidying up source files and trying to get it all to build with Bazel.\nMeantime, I have a few questions:\nstreams\nIs it correct to call standard CUDA kernels and operations on the op's stream by launching with context->eigen_device<Device>().stream()?\nstream.ThenLaunch()\nI think there is a way to launch kernels directly on a tensorflow stream - but there's not much information on TypedKernel or Kernel that I can find. Do I need to worry about this?\ncusolver:\nI use cusolver for the cholesky op. This isn't yet wrapped in Stream.h so I'm linking/calling it raw. This adds a dependency on linking cusolver into the framework, and maybe wrapping it as you guys have wrapped cublas.\nedit: I will also work on reflecting the style/formatting recommendations made on Alex's code.", "body": "@alexggmatthews said to post here when I had something to show and to tag @rmlarsen and @yaroslavvb - hi guys!\n\nI've been working on making a CUDA version of Alex's code. I now have the following ops implemented in [my fork](https://github.com/c0g/tensorflow/tree/master/tensorflow/core/user_ops):\n- get_diag (get_diag*)\n- tril (triangle*)\n- cholesky (gpu_cholesky*)\n- cholesky_grad (gpu_cholgrad*)\n\nThere is still a lot left to do, but the algorithms are all there and I believe they numerically match Alex's code. I will be adding python wrappers and tests over the coming days, as well as tidying up source files and trying to get it all to build with Bazel.\n\nMeantime, I have a few questions:\n\n### streams\n\nIs it correct to call standard CUDA kernels and operations on the op's stream by launching with `context->eigen_device<Device>().stream()`?\n\n### stream.ThenLaunch()\n\nI think there is a way to launch kernels directly on a tensorflow stream - but there's not much information on TypedKernel or Kernel that I can find. Do I need to worry about this?\n\n### cusolver:\n\nI use cusolver for the cholesky op. This isn't yet wrapped in Stream.h so I'm linking/calling it raw. This adds a dependency on linking cusolver into the framework, and maybe wrapping it as you guys have wrapped cublas.\n\n**edit:** I will also work on reflecting the style/formatting recommendations made on Alex's code.\n"}