{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9102", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9102/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9102/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9102/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9102", "id": 220623588, "node_id": "MDU6SXNzdWUyMjA2MjM1ODg=", "number": 9102, "title": "Problems freezing the graph", "user": {"login": "ngoel17", "id": 8811128, "node_id": "MDQ6VXNlcjg4MTExMjg=", "avatar_url": "https://avatars1.githubusercontent.com/u/8811128?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ngoel17", "html_url": "https://github.com/ngoel17", "followers_url": "https://api.github.com/users/ngoel17/followers", "following_url": "https://api.github.com/users/ngoel17/following{/other_user}", "gists_url": "https://api.github.com/users/ngoel17/gists{/gist_id}", "starred_url": "https://api.github.com/users/ngoel17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ngoel17/subscriptions", "organizations_url": "https://api.github.com/users/ngoel17/orgs", "repos_url": "https://api.github.com/users/ngoel17/repos", "events_url": "https://api.github.com/users/ngoel17/events{/privacy}", "received_events_url": "https://api.github.com/users/ngoel17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-04-10T12:06:33Z", "updated_at": "2017-04-11T11:05:55Z", "closed_at": "2017-04-10T19:54:32Z", "author_association": "NONE", "body_html": "<ul>\n<li><em>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)?</em>:<br>\nPlease see below for how to replicate the problems. Zip attachment contains two pieces of very small code.</li>\n<li><em>TensorFlow installed from (source or binary)?</em>:<br>\nbinary - 1.1</li>\n<li><em>TensorFlow version</em>:<br>\n1.1</li>\n<li><em>Bazel version (if compiling from source)</em>:<br>\nNot applicable</li>\n<li><em>CUDA/cuDNN version</em>:<br>\nRecent but not latest.  8.0, V8.0.44</li>\n<li><em>GPU Model and Memory</em>:<br>\nTesla K20 4 GB</li>\n<li><em>Exact command to reproduce</em>:<br>\nSee below....</li>\n</ul>\n<h3>Describe the problem clearly</h3>\n<p>We have a problem related to saving the operations as constants while freezing using the algorithm in the attached files.<br>\nThe problem can be easily replicated by trying to freeze the graphs generated by the toy example in textsum <a href=\"https://github.com/tensorflow/models/tree/master/textsum\">https://github.com/tensorflow/models/tree/master/textsum</a> .</p>\n<p>Models are trained with the following command:<br>\nbazel-bin/textsum/seq2seq_attention --mode=train --article_key=article --abstract_key=abstract --data_path=textsum/data/data --vocab_path=textsum/data/vocab --log_root=textsum/log_root --train_dir=textsum/log_root/train</p>\n<p>Then freeze_2_textsum.py is called with the following syntax:<br>\npython freeze_2_textsum.py<br>\nCommand in our case was:<br>\npython freeze_2_textsum.py --model_folder=./log_root/ --outputnodes=global_step</p>\n<p>In this case, we are able to find the saved constants in the frozen_model.pb file.<br>\nBut when we try the same syntax for the trained graph in our project, we could not find the constants in the frozen model.pb file, while the freeze_2_textsum.py script prints the log message that \"13 ops were converted to constants\"<br>\nThis problem leads to the following error while running the session in our test script:<br>\n\"Attempting to use uninitialized value model/generate_embedding_RNN_output/BiRNN/BW/BasicLSTMCell/Linear/Bias\"<br>\ncmd line for test script:</p>\n<p>python test_tf_frozen_txtsum.py</p>\n<h3>Source Code / Logs</h3>\n<p><a href=\"https://github.com/tensorflow/tensorflow/files/909961/Freezing_problem.zip\">Freezing_problem.zip</a></p>", "body_text": "Have I written custom code (as opposed to using a stock example script provided in TensorFlow)?:\nPlease see below for how to replicate the problems. Zip attachment contains two pieces of very small code.\nTensorFlow installed from (source or binary)?:\nbinary - 1.1\nTensorFlow version:\n1.1\nBazel version (if compiling from source):\nNot applicable\nCUDA/cuDNN version:\nRecent but not latest.  8.0, V8.0.44\nGPU Model and Memory:\nTesla K20 4 GB\nExact command to reproduce:\nSee below....\n\nDescribe the problem clearly\nWe have a problem related to saving the operations as constants while freezing using the algorithm in the attached files.\nThe problem can be easily replicated by trying to freeze the graphs generated by the toy example in textsum https://github.com/tensorflow/models/tree/master/textsum .\nModels are trained with the following command:\nbazel-bin/textsum/seq2seq_attention --mode=train --article_key=article --abstract_key=abstract --data_path=textsum/data/data --vocab_path=textsum/data/vocab --log_root=textsum/log_root --train_dir=textsum/log_root/train\nThen freeze_2_textsum.py is called with the following syntax:\npython freeze_2_textsum.py\nCommand in our case was:\npython freeze_2_textsum.py --model_folder=./log_root/ --outputnodes=global_step\nIn this case, we are able to find the saved constants in the frozen_model.pb file.\nBut when we try the same syntax for the trained graph in our project, we could not find the constants in the frozen model.pb file, while the freeze_2_textsum.py script prints the log message that \"13 ops were converted to constants\"\nThis problem leads to the following error while running the session in our test script:\n\"Attempting to use uninitialized value model/generate_embedding_RNN_output/BiRNN/BW/BasicLSTMCell/Linear/Bias\"\ncmd line for test script:\npython test_tf_frozen_txtsum.py\nSource Code / Logs\nFreezing_problem.zip", "body": "- *Have I written custom code (as opposed to using a stock example script provided in TensorFlow)?*:\r\n   Please see below for how to replicate the problems. Zip attachment contains two pieces of very small code.\r\n- *TensorFlow installed from (source or binary)?*:\r\n   binary - 1.1\r\n- *TensorFlow version*:\r\n     1.1\r\n- *Bazel version (if compiling from source)*:\r\n      Not applicable\r\n- *CUDA/cuDNN version*:\r\n       Recent but not latest.  8.0, V8.0.44 \r\n- *GPU Model and Memory*:\r\n   Tesla K20 4 GB\r\n- *Exact command to reproduce*:\r\n   See below....\r\n### Describe the problem clearly\r\nWe have a problem related to saving the operations as constants while freezing using the algorithm in the attached files.\r\nThe problem can be easily replicated by trying to freeze the graphs generated by the toy example in textsum https://github.com/tensorflow/models/tree/master/textsum .\r\n\r\nModels are trained with the following command:\r\nbazel-bin/textsum/seq2seq_attention --mode=train --article_key=article --abstract_key=abstract --data_path=textsum/data/data --vocab_path=textsum/data/vocab --log_root=textsum/log_root --train_dir=textsum/log_root/train\r\n\r\nThen freeze_2_textsum.py is called with the following syntax:\r\npython freeze_2_textsum.py \r\nCommand in our case was:\r\npython freeze_2_textsum.py --model_folder=./log_root/ --outputnodes=global_step\r\n\r\nIn this case, we are able to find the saved constants in the frozen_model.pb file.\r\nBut when we try the same syntax for the trained graph in our project, we could not find the constants in the frozen model.pb file, while the freeze_2_textsum.py script prints the log message that \"13 ops were converted to constants\"\r\nThis problem leads to the following error while running the session in our test script:\r\n\"Attempting to use uninitialized value model/generate_embedding_RNN_output/BiRNN/BW/BasicLSTMCell/Linear/Bias\"\r\ncmd line for test script:\r\n\r\npython test_tf_frozen_txtsum.py\r\n\r\n\r\n### Source Code / Logs\r\n\r\n[Freezing_problem.zip](https://github.com/tensorflow/tensorflow/files/909961/Freezing_problem.zip)\r\n"}