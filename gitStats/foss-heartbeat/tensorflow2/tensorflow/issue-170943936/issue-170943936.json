{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3776", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3776/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3776/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3776/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3776", "id": 170943936, "node_id": "MDU6SXNzdWUxNzA5NDM5MzY=", "number": 3776, "title": "error with wide_n_deep_tutorial.py", "user": {"login": "tranlm", "id": 2287800, "node_id": "MDQ6VXNlcjIyODc4MDA=", "avatar_url": "https://avatars1.githubusercontent.com/u/2287800?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tranlm", "html_url": "https://github.com/tranlm", "followers_url": "https://api.github.com/users/tranlm/followers", "following_url": "https://api.github.com/users/tranlm/following{/other_user}", "gists_url": "https://api.github.com/users/tranlm/gists{/gist_id}", "starred_url": "https://api.github.com/users/tranlm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tranlm/subscriptions", "organizations_url": "https://api.github.com/users/tranlm/orgs", "repos_url": "https://api.github.com/users/tranlm/repos", "events_url": "https://api.github.com/users/tranlm/events{/privacy}", "received_events_url": "https://api.github.com/users/tranlm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-12T19:37:50Z", "updated_at": "2016-09-02T17:39:45Z", "closed_at": "2016-09-02T17:39:45Z", "author_association": "NONE", "body_html": "<p>I'm running into problems when trying to run the wide and deep tutorial code example. Here's my info:</p>\n<h3>Environment info</h3>\n<p>Operating System: OSX 10.11.4</p>\n<p>Installed version of CUDA and cuDNN: CUDA-7.5,<br>\n-rwxr-xr-x@ 2 root  wheel      8280 Apr 12 23:02 /usr/local/cuda/lib/libcuda.1.dylib<br>\n-rwxr-xr-x@ 2 root  wheel      8280 Apr 12 23:02 /usr/local/cuda/lib/libcuda.dylib<br>\nlrwxr-xr-x@ 1 root  wheel        45 Apr 12 23:03 /usr/local/cuda/lib/libcudadevrt.a -&gt; /Developer/NVIDIA/CUDA-7.5/lib/libcudadevrt.a<br>\nlrwxr-xr-x@ 1 root  wheel        50 Apr 12 23:03 /usr/local/cuda/lib/libcudart.7.5.dylib -&gt; /Developer/NVIDIA/CUDA-7.5/lib/libcudart.7.5.dylib<br>\nlrwxr-xr-x@ 1 root  wheel        46 Apr 12 23:03 /usr/local/cuda/lib/libcudart.dylib -&gt; /Developer/NVIDIA/CUDA-7.5/lib/libcudart.dylib<br>\nlrwxr-xr-x@ 1 root  wheel        49 Apr 12 23:03 /usr/local/cuda/lib/libcudart_static.a -&gt; /Developer/NVIDIA/CUDA-7.5/lib/libcudart_static.a<br>\n-rwxr-xr-x@ 1 root  admin  58270280 Aug  2 21:26 /usr/local/cuda/lib/libcudnn.5.dylib<br>\n-rwxr-xr-x@ 1 root  admin  58270280 Aug  2 21:26 /usr/local/cuda/lib/libcudnn.dylib<br>\n-rw-r--r--@ 1 root  admin  55551064 Aug  2 21:26 /usr/local/cuda/lib/libcudnn_static.a</p>\n<h3>Steps to reproduce</h3>\n<ol>\n<li>Open the script, set the \"model_type\" FLAG to \"deep\" or to \"wide_n_deep\", and run interactively with an open Python compiler.</li>\n</ol>\n<h3>What have you tried?</h3>\n<ol>\n<li>Running it with FLAGS.model_type = \"wide\" works fine.</li>\n</ol>\n<h3>Logs or other output that would be helpful</h3>\n<p>Here is the log from running it with FLAGS.model_type = \"deep\"</p>\n<pre><code>Training data is downloaded to /var/folders/_x/ssxr2t2144v_2vr8w0yywpvw0000gn/T/tmpbVSoKV\nTest data is downloaded to /var/folders/_x/ssxr2t2144v_2vr8w0yywpvw0000gn/T/tmp8ojlXf\nmodel directory = .\nWARNING:tensorflow:Setting feature info to {'hours_per_week': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'workclass': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'relationship': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'gender': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'age': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'marital_status': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'race': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'education_num': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'native_country': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'capital_loss': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'education': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'capital_gain': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'occupation': TensorSignature(dtype=tf.string, shape=None, is_sparse=True)}\nWARNING:tensorflow:Setting targets info to TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:839] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nE tensorflow/core/client/tensor_c_api.cc:485] Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\n     [[Node: save/Assign_22/_84 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_179_save/Assign_22\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"&lt;stdin&gt;\", line 23, in train_and_eval\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 240, in fit\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 276, in _supervised_train\n    scaffold=scaffold) as super_sess:\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 212, in __init__\n    self._sess = recoverable_session.RecoverableSession(self._create_session)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/recoverable_session.py\", line 46, in __init__\n    WrappedSession.__init__(self, sess_factory())\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 232, in _create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 164, in prepare_session\n    max_wait_secs=max_wait_secs, config=config)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 224, in recover_session\n    saver.restore(sess, ckpt.model_checkpoint_path)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1129, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.NotFoundError: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\n     [[Node: save/Assign_22/_84 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_179_save/Assign_22\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\nCaused by op u'save/restore_slice_12', defined at:\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"&lt;stdin&gt;\", line 23, in train_and_eval\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 240, in fit\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 252, in _supervised_train\n    keep_checkpoint_max=keep_checkpoint_max)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 152, in __init__\n    lambda: training_saver.Saver(sharded=True,\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 164, in _get_or_default\n    op = default_constructor()\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 153, in &lt;lambda&gt;\n    max_to_keep=keep_checkpoint_max))\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 861, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 515, in build\n    filename_tensor, per_device, restore_sequentially, reshape)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 312, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 272, in _AddRestoreOps\n    values = self.restore_op(filename_tensor, vs, preferred_shard)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 187, in restore_op\n    preferred_shard=preferred_shard)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/io_ops.py\", line 203, in _restore_slice\n    preferred_shard, name=name)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 359, in _restore_slice\n    preferred_shard=preferred_shard, name=name)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n\n</code></pre>", "body_text": "I'm running into problems when trying to run the wide and deep tutorial code example. Here's my info:\nEnvironment info\nOperating System: OSX 10.11.4\nInstalled version of CUDA and cuDNN: CUDA-7.5,\n-rwxr-xr-x@ 2 root  wheel      8280 Apr 12 23:02 /usr/local/cuda/lib/libcuda.1.dylib\n-rwxr-xr-x@ 2 root  wheel      8280 Apr 12 23:02 /usr/local/cuda/lib/libcuda.dylib\nlrwxr-xr-x@ 1 root  wheel        45 Apr 12 23:03 /usr/local/cuda/lib/libcudadevrt.a -> /Developer/NVIDIA/CUDA-7.5/lib/libcudadevrt.a\nlrwxr-xr-x@ 1 root  wheel        50 Apr 12 23:03 /usr/local/cuda/lib/libcudart.7.5.dylib -> /Developer/NVIDIA/CUDA-7.5/lib/libcudart.7.5.dylib\nlrwxr-xr-x@ 1 root  wheel        46 Apr 12 23:03 /usr/local/cuda/lib/libcudart.dylib -> /Developer/NVIDIA/CUDA-7.5/lib/libcudart.dylib\nlrwxr-xr-x@ 1 root  wheel        49 Apr 12 23:03 /usr/local/cuda/lib/libcudart_static.a -> /Developer/NVIDIA/CUDA-7.5/lib/libcudart_static.a\n-rwxr-xr-x@ 1 root  admin  58270280 Aug  2 21:26 /usr/local/cuda/lib/libcudnn.5.dylib\n-rwxr-xr-x@ 1 root  admin  58270280 Aug  2 21:26 /usr/local/cuda/lib/libcudnn.dylib\n-rw-r--r--@ 1 root  admin  55551064 Aug  2 21:26 /usr/local/cuda/lib/libcudnn_static.a\nSteps to reproduce\n\nOpen the script, set the \"model_type\" FLAG to \"deep\" or to \"wide_n_deep\", and run interactively with an open Python compiler.\n\nWhat have you tried?\n\nRunning it with FLAGS.model_type = \"wide\" works fine.\n\nLogs or other output that would be helpful\nHere is the log from running it with FLAGS.model_type = \"deep\"\nTraining data is downloaded to /var/folders/_x/ssxr2t2144v_2vr8w0yywpvw0000gn/T/tmpbVSoKV\nTest data is downloaded to /var/folders/_x/ssxr2t2144v_2vr8w0yywpvw0000gn/T/tmp8ojlXf\nmodel directory = .\nWARNING:tensorflow:Setting feature info to {'hours_per_week': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'workclass': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'relationship': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'gender': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'age': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'marital_status': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'race': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'education_num': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'native_country': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'capital_loss': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'education': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'capital_gain': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'occupation': TensorSignature(dtype=tf.string, shape=None, is_sparse=True)}\nWARNING:tensorflow:Setting targets info to TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:839] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nE tensorflow/core/client/tensor_c_api.cc:485] Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\n     [[Node: save/Assign_22/_84 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_179_save/Assign_22\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 23, in train_and_eval\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 240, in fit\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 276, in _supervised_train\n    scaffold=scaffold) as super_sess:\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 212, in __init__\n    self._sess = recoverable_session.RecoverableSession(self._create_session)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/recoverable_session.py\", line 46, in __init__\n    WrappedSession.__init__(self, sess_factory())\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 232, in _create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 164, in prepare_session\n    max_wait_secs=max_wait_secs, config=config)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 224, in recover_session\n    saver.restore(sess, ckpt.model_checkpoint_path)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1129, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.NotFoundError: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\n     [[Node: save/Assign_22/_84 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_179_save/Assign_22\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\nCaused by op u'save/restore_slice_12', defined at:\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 23, in train_and_eval\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 240, in fit\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 252, in _supervised_train\n    keep_checkpoint_max=keep_checkpoint_max)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 152, in __init__\n    lambda: training_saver.Saver(sharded=True,\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 164, in _get_or_default\n    op = default_constructor()\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 153, in <lambda>\n    max_to_keep=keep_checkpoint_max))\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 861, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 515, in build\n    filename_tensor, per_device, restore_sequentially, reshape)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 312, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 272, in _AddRestoreOps\n    values = self.restore_op(filename_tensor, vs, preferred_shard)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 187, in restore_op\n    preferred_shard=preferred_shard)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/io_ops.py\", line 203, in _restore_slice\n    preferred_shard, name=name)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 359, in _restore_slice\n    preferred_shard=preferred_shard, name=name)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()", "body": "I'm running into problems when trying to run the wide and deep tutorial code example. Here's my info:\n### Environment info\n\nOperating System: OSX 10.11.4 \n\nInstalled version of CUDA and cuDNN: CUDA-7.5,\n-rwxr-xr-x@ 2 root  wheel      8280 Apr 12 23:02 /usr/local/cuda/lib/libcuda.1.dylib\n-rwxr-xr-x@ 2 root  wheel      8280 Apr 12 23:02 /usr/local/cuda/lib/libcuda.dylib\nlrwxr-xr-x@ 1 root  wheel        45 Apr 12 23:03 /usr/local/cuda/lib/libcudadevrt.a -> /Developer/NVIDIA/CUDA-7.5/lib/libcudadevrt.a\nlrwxr-xr-x@ 1 root  wheel        50 Apr 12 23:03 /usr/local/cuda/lib/libcudart.7.5.dylib -> /Developer/NVIDIA/CUDA-7.5/lib/libcudart.7.5.dylib\nlrwxr-xr-x@ 1 root  wheel        46 Apr 12 23:03 /usr/local/cuda/lib/libcudart.dylib -> /Developer/NVIDIA/CUDA-7.5/lib/libcudart.dylib\nlrwxr-xr-x@ 1 root  wheel        49 Apr 12 23:03 /usr/local/cuda/lib/libcudart_static.a -> /Developer/NVIDIA/CUDA-7.5/lib/libcudart_static.a\n-rwxr-xr-x@ 1 root  admin  58270280 Aug  2 21:26 /usr/local/cuda/lib/libcudnn.5.dylib\n-rwxr-xr-x@ 1 root  admin  58270280 Aug  2 21:26 /usr/local/cuda/lib/libcudnn.dylib\n-rw-r--r--@ 1 root  admin  55551064 Aug  2 21:26 /usr/local/cuda/lib/libcudnn_static.a\n### Steps to reproduce\n1. Open the script, set the \"model_type\" FLAG to \"deep\" or to \"wide_n_deep\", and run interactively with an open Python compiler.\n### What have you tried?\n1. Running it with FLAGS.model_type = \"wide\" works fine. \n### Logs or other output that would be helpful\n\nHere is the log from running it with FLAGS.model_type = \"deep\"\n\n```\nTraining data is downloaded to /var/folders/_x/ssxr2t2144v_2vr8w0yywpvw0000gn/T/tmpbVSoKV\nTest data is downloaded to /var/folders/_x/ssxr2t2144v_2vr8w0yywpvw0000gn/T/tmp8ojlXf\nmodel directory = .\nWARNING:tensorflow:Setting feature info to {'hours_per_week': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'workclass': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'relationship': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'gender': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'age': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'marital_status': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'race': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'education_num': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'native_country': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'capital_loss': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'education': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), 'capital_gain': TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False), 'occupation': TensorSignature(dtype=tf.string, shape=None, is_sparse=True)}\nWARNING:tensorflow:Setting targets info to TensorSignature(dtype=tf.int64, shape=TensorShape([Dimension(32561)]), is_sparse=False)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:839] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GT 750M, pci bus id: 0000:01:00.0)\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nW tensorflow/core/framework/op_kernel.cc:936] Not found: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\nE tensorflow/core/client/tensor_c_api.cc:485] Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\n     [[Node: save/Assign_22/_84 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_179_save/Assign_22\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 23, in train_and_eval\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 240, in fit\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 276, in _supervised_train\n    scaffold=scaffold) as super_sess:\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 212, in __init__\n    self._sess = recoverable_session.RecoverableSession(self._create_session)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/recoverable_session.py\", line 46, in __init__\n    WrappedSession.__init__(self, sess_factory())\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 232, in _create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 164, in prepare_session\n    max_wait_secs=max_wait_secs, config=config)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/session_manager.py\", line 224, in recover_session\n    saver.restore(sess, ckpt.model_checkpoint_path)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1129, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.NotFoundError: Tensor name \"hiddenlayer_1/biases/Adagrad\" not found in checkpoint files ./model.ckpt-200-?????-of-00001\n     [[Node: save/restore_slice_12 = RestoreSlice[dt=DT_FLOAT, preferred_shard=0, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice_12/tensor_name, save/restore_slice_12/shape_and_slice)]]\n     [[Node: save/Assign_22/_84 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_179_save/Assign_22\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\nCaused by op u'save/restore_slice_12', defined at:\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 23, in train_and_eval\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 240, in fit\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 252, in _supervised_train\n    keep_checkpoint_max=keep_checkpoint_max)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 152, in __init__\n    lambda: training_saver.Saver(sharded=True,\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 164, in _get_or_default\n    op = default_constructor()\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 153, in <lambda>\n    max_to_keep=keep_checkpoint_max))\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 861, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 515, in build\n    filename_tensor, per_device, restore_sequentially, reshape)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 312, in _AddShardedRestoreOps\n    name=\"restore_shard\"))\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 272, in _AddRestoreOps\n    values = self.restore_op(filename_tensor, vs, preferred_shard)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 187, in restore_op\n    preferred_shard=preferred_shard)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/io_ops.py\", line 203, in _restore_slice\n    preferred_shard, name=name)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 359, in _restore_slice\n    preferred_shard=preferred_shard, name=name)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n\n```\n"}