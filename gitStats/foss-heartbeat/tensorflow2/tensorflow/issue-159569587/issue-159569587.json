{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2777", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2777/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2777/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2777/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2777", "id": 159569587, "node_id": "MDU6SXNzdWUxNTk1Njk1ODc=", "number": 2777, "title": "tensorflow - KeyError in nearest", "user": {"login": "RahulKulhari", "id": 1268006, "node_id": "MDQ6VXNlcjEyNjgwMDY=", "avatar_url": "https://avatars1.githubusercontent.com/u/1268006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RahulKulhari", "html_url": "https://github.com/RahulKulhari", "followers_url": "https://api.github.com/users/RahulKulhari/followers", "following_url": "https://api.github.com/users/RahulKulhari/following{/other_user}", "gists_url": "https://api.github.com/users/RahulKulhari/gists{/gist_id}", "starred_url": "https://api.github.com/users/RahulKulhari/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RahulKulhari/subscriptions", "organizations_url": "https://api.github.com/users/RahulKulhari/orgs", "repos_url": "https://api.github.com/users/RahulKulhari/repos", "events_url": "https://api.github.com/users/RahulKulhari/events{/privacy}", "received_events_url": "https://api.github.com/users/RahulKulhari/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-06-10T06:40:52Z", "updated_at": "2016-07-09T03:33:09Z", "closed_at": "2016-07-09T03:33:09Z", "author_association": "NONE", "body_html": "<p>when i am running this code on small corpus i am getting key error because that key is not in dict and corpus vocab is also not that huge.</p>\n<pre><code>sim = similarity.eval()\nfor i in xrange(valid_size):\n                valid_word = reverse_dictionary[valid_examples[i]]\n                print(\"--\",valid_word)\n                top_k = 5 # number of nearest neighbors\n\n                nearest = (-sim[i, :]).argsort()[1:top_k+1]\n                print(nearest)\n                log_str = \"Nearest to %s:\" % valid_word\n                print(log_str)\n                for k in xrange(top_k):\n\n                  close_word = reverse_dictionary[nearest[k]]\n</code></pre>\n<p>My output are like this:</p>\n<pre><code>Average loss at step  0 :  139.830688477\n[[ 0.01613899 -0.06088334 -0.043384   ...,  0.02021606 -0.10094199\n   0.16063547]\n [ 1.00000012  0.10277888 -0.20193034 ..., -0.04780241  0.07802841\n   0.13258868]\n [ 0.09824251 -0.17075592  0.10143445 ...,  0.09903113 -0.08740355\n  -0.00371696]\n ..., \n [-0.01591019  0.02056946  0.09188825 ..., -0.0506176   0.07684846\n   0.06354721]\n [-0.06749535  0.0028128  -0.09138335 ...,  0.09473826  0.04847325\n  -0.00853895]\n [ 0.01795161  0.01850585  0.04632751 ...,  0.11854959  0.11196665\n  -0.00684015]]\n16\n[-0.01613899  0.06088334  0.043384   ..., -0.02021606  0.10094199\n -0.16063547]\n&lt;type 'numpy.ndarray'&gt;\n[ 31 113 118 ..., 650 353 233]\n-- using\n[113 118 555 298 150]\nNearest to using:\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n&lt;ipython-input-129-cf006e08ddb8&gt; in &lt;module&gt;()\n     87                 for k in xrange(top_k):\n     88 \n---&gt; 89                   close_word = reverse_dictionary[nearest[k]]\n     90                   log_str = \"%s %s,\" % (log_str, close_word)\n     91                 print(log_str)\n\nKeyError: 555\n</code></pre>\n<p>vocab_length  = 1155<br>\nbatch_size = 16<br>\nembedding_size = 128<br>\nskip_window = 5<br>\nnum_skips = 4</p>\n<p>valid_size = 16<br>\nvalid_window = 100<br>\nvalid_examples = np.random.choice(valid_window, valid_size, replace=False)<br>\nnum_sampled =64</p>\n<p>Can anybody help please?</p>", "body_text": "when i am running this code on small corpus i am getting key error because that key is not in dict and corpus vocab is also not that huge.\nsim = similarity.eval()\nfor i in xrange(valid_size):\n                valid_word = reverse_dictionary[valid_examples[i]]\n                print(\"--\",valid_word)\n                top_k = 5 # number of nearest neighbors\n\n                nearest = (-sim[i, :]).argsort()[1:top_k+1]\n                print(nearest)\n                log_str = \"Nearest to %s:\" % valid_word\n                print(log_str)\n                for k in xrange(top_k):\n\n                  close_word = reverse_dictionary[nearest[k]]\n\nMy output are like this:\nAverage loss at step  0 :  139.830688477\n[[ 0.01613899 -0.06088334 -0.043384   ...,  0.02021606 -0.10094199\n   0.16063547]\n [ 1.00000012  0.10277888 -0.20193034 ..., -0.04780241  0.07802841\n   0.13258868]\n [ 0.09824251 -0.17075592  0.10143445 ...,  0.09903113 -0.08740355\n  -0.00371696]\n ..., \n [-0.01591019  0.02056946  0.09188825 ..., -0.0506176   0.07684846\n   0.06354721]\n [-0.06749535  0.0028128  -0.09138335 ...,  0.09473826  0.04847325\n  -0.00853895]\n [ 0.01795161  0.01850585  0.04632751 ...,  0.11854959  0.11196665\n  -0.00684015]]\n16\n[-0.01613899  0.06088334  0.043384   ..., -0.02021606  0.10094199\n -0.16063547]\n<type 'numpy.ndarray'>\n[ 31 113 118 ..., 650 353 233]\n-- using\n[113 118 555 298 150]\nNearest to using:\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n<ipython-input-129-cf006e08ddb8> in <module>()\n     87                 for k in xrange(top_k):\n     88 \n---> 89                   close_word = reverse_dictionary[nearest[k]]\n     90                   log_str = \"%s %s,\" % (log_str, close_word)\n     91                 print(log_str)\n\nKeyError: 555\n\nvocab_length  = 1155\nbatch_size = 16\nembedding_size = 128\nskip_window = 5\nnum_skips = 4\nvalid_size = 16\nvalid_window = 100\nvalid_examples = np.random.choice(valid_window, valid_size, replace=False)\nnum_sampled =64\nCan anybody help please?", "body": "when i am running this code on small corpus i am getting key error because that key is not in dict and corpus vocab is also not that huge.\n\n```\nsim = similarity.eval()\nfor i in xrange(valid_size):\n                valid_word = reverse_dictionary[valid_examples[i]]\n                print(\"--\",valid_word)\n                top_k = 5 # number of nearest neighbors\n\n                nearest = (-sim[i, :]).argsort()[1:top_k+1]\n                print(nearest)\n                log_str = \"Nearest to %s:\" % valid_word\n                print(log_str)\n                for k in xrange(top_k):\n\n                  close_word = reverse_dictionary[nearest[k]]\n```\n\nMy output are like this:\n\n```\nAverage loss at step  0 :  139.830688477\n[[ 0.01613899 -0.06088334 -0.043384   ...,  0.02021606 -0.10094199\n   0.16063547]\n [ 1.00000012  0.10277888 -0.20193034 ..., -0.04780241  0.07802841\n   0.13258868]\n [ 0.09824251 -0.17075592  0.10143445 ...,  0.09903113 -0.08740355\n  -0.00371696]\n ..., \n [-0.01591019  0.02056946  0.09188825 ..., -0.0506176   0.07684846\n   0.06354721]\n [-0.06749535  0.0028128  -0.09138335 ...,  0.09473826  0.04847325\n  -0.00853895]\n [ 0.01795161  0.01850585  0.04632751 ...,  0.11854959  0.11196665\n  -0.00684015]]\n16\n[-0.01613899  0.06088334  0.043384   ..., -0.02021606  0.10094199\n -0.16063547]\n<type 'numpy.ndarray'>\n[ 31 113 118 ..., 650 353 233]\n-- using\n[113 118 555 298 150]\nNearest to using:\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n<ipython-input-129-cf006e08ddb8> in <module>()\n     87                 for k in xrange(top_k):\n     88 \n---> 89                   close_word = reverse_dictionary[nearest[k]]\n     90                   log_str = \"%s %s,\" % (log_str, close_word)\n     91                 print(log_str)\n\nKeyError: 555\n```\n\nvocab_length  = 1155\nbatch_size = 16\nembedding_size = 128  \nskip_window = 5  \nnum_skips = 4         \n\nvalid_size = 16  \nvalid_window = 100  \nvalid_examples = np.random.choice(valid_window, valid_size, replace=False)\nnum_sampled =64   \n\nCan anybody help please?\n"}