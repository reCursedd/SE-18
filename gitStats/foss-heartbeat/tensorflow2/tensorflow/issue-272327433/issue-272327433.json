{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14380", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14380/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14380/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14380/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14380", "id": 272327433, "node_id": "MDU6SXNzdWUyNzIzMjc0MzM=", "number": 14380, "title": "Bazel Build Fails with \"undeclared inclusion(s) in rule '@nccl_archive//:nccl'\"", "user": {"login": "johnsrude", "id": 15482785, "node_id": "MDQ6VXNlcjE1NDgyNzg1", "avatar_url": "https://avatars1.githubusercontent.com/u/15482785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johnsrude", "html_url": "https://github.com/johnsrude", "followers_url": "https://api.github.com/users/johnsrude/followers", "following_url": "https://api.github.com/users/johnsrude/following{/other_user}", "gists_url": "https://api.github.com/users/johnsrude/gists{/gist_id}", "starred_url": "https://api.github.com/users/johnsrude/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johnsrude/subscriptions", "organizations_url": "https://api.github.com/users/johnsrude/orgs", "repos_url": "https://api.github.com/users/johnsrude/repos", "events_url": "https://api.github.com/users/johnsrude/events{/privacy}", "received_events_url": "https://api.github.com/users/johnsrude/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284463744, "node_id": "MDU6TGFiZWwyODQ0NjM3NDQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cuda", "name": "cuda", "color": "f7c6c7", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 34, "created_at": "2017-11-08T19:53:04Z", "updated_at": "2018-02-09T06:42:31Z", "closed_at": "2018-01-04T07:18:49Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<p>The environment used is:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1455194/tf_env.txt\">tf_env.txt</a></p>\n<p>The branch downloaded is tensorflow-master branch</p>\n<p>When I run the configure script the configuration is<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1455688/tf_configure.bazelrc.txt\">.tf_configure.bazelrc</a></p>\n<h3>Describe the problem</h3>\n<p>When I run</p>\n<pre><code>bazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<p>The build fails with the error</p>\n<pre lang=\"&quot;/home/kevin/.cache/bazel/_bazel_kevin/1bfc1cc47be0eab35fef533f37af7359/external/nccl_archive/BUILD:33:1:\" data-meta=\"undeclared inclusion(s) in rule '@nccl_archive//:nccl':\"><code>this rule is missing dependency declarations for the following files included by 'external/nccl_archive/src/core.cu.cc':\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h'\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/syslimits.h'\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stddef.h'\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stdarg.h'\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nFAILED: Build did NOT complete successfully\n</code></pre>\n<p>but the files are present:</p>\n<pre><code>ls /usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h\n/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h\n</code></pre>\n<p>There appears to be a problem with bazel build with MKL enabled.  I have been able to compile this with MKL disabled. MKL for Ubuntu should be supported, yes?</p>", "body_text": "System information\nThe environment used is:\ntf_env.txt\nThe branch downloaded is tensorflow-master branch\nWhen I run the configure script the configuration is\n.tf_configure.bazelrc\nDescribe the problem\nWhen I run\nbazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package\n\nThe build fails with the error\nthis rule is missing dependency declarations for the following files included by 'external/nccl_archive/src/core.cu.cc':\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h'\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/syslimits.h'\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stddef.h'\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stdarg.h'\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nFAILED: Build did NOT complete successfully\n\nbut the files are present:\nls /usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h\n/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h\n\nThere appears to be a problem with bazel build with MKL enabled.  I have been able to compile this with MKL disabled. MKL for Ubuntu should be supported, yes?", "body": "### System information\r\nThe environment used is:\r\n[tf_env.txt](https://github.com/tensorflow/tensorflow/files/1455194/tf_env.txt)\r\n\r\nThe branch downloaded is tensorflow-master branch\r\n\r\nWhen I run the configure script the configuration is\r\n[.tf_configure.bazelrc](https://github.com/tensorflow/tensorflow/files/1455688/tf_configure.bazelrc.txt)\r\n \r\n\r\n### Describe the problem\r\nWhen I run\r\n```\r\nbazel build --config=opt --config=cuda --config=mkl //tensorflow/tools/pip_package:build_pip_package\r\n```\r\nThe build fails with the error\r\n``` \"/home/kevin/.cache/bazel/_bazel_kevin/1bfc1cc47be0eab35fef533f37af7359/external/nccl_archive/BUILD:33:1: undeclared inclusion(s) in rule '@nccl_archive//:nccl':\r\nthis rule is missing dependency declarations for the following files included by 'external/nccl_archive/src/core.cu.cc':\r\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h'\r\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/syslimits.h'\r\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stddef.h'\r\n  '/usr/lib/gcc/x86_64-linux-gnu/4.9/include/stdarg.h'\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nFAILED: Build did NOT complete successfully\r\n```\r\nbut the files are present:\r\n```\r\nls /usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h\r\n/usr/lib/gcc/x86_64-linux-gnu/4.9/include-fixed/limits.h\r\n```\r\nThere appears to be a problem with bazel build with MKL enabled.  I have been able to compile this with MKL disabled. MKL for Ubuntu should be supported, yes?"}