{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15257", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15257/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15257/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15257/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15257", "id": 280878994, "node_id": "MDU6SXNzdWUyODA4Nzg5OTQ=", "number": 15257, "title": "can't read my own tfrecords and face FailedPreconditionError", "user": {"login": "LvJC", "id": 19641694, "node_id": "MDQ6VXNlcjE5NjQxNjk0", "avatar_url": "https://avatars1.githubusercontent.com/u/19641694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LvJC", "html_url": "https://github.com/LvJC", "followers_url": "https://api.github.com/users/LvJC/followers", "following_url": "https://api.github.com/users/LvJC/following{/other_user}", "gists_url": "https://api.github.com/users/LvJC/gists{/gist_id}", "starred_url": "https://api.github.com/users/LvJC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LvJC/subscriptions", "organizations_url": "https://api.github.com/users/LvJC/orgs", "repos_url": "https://api.github.com/users/LvJC/repos", "events_url": "https://api.github.com/users/LvJC/events{/privacy}", "received_events_url": "https://api.github.com/users/LvJC/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-12-11T02:53:22Z", "updated_at": "2018-02-06T08:42:14Z", "closed_at": "2018-02-06T08:42:14Z", "author_association": "NONE", "body_html": "<p>Please go to Stack Overflow for help and support:</p>\n<h3>System information</h3>\n<ul>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 1604</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: conda tensorflow</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.3.0</li>\n<li><strong>Python version</strong>: 2.7</li>\n<li>**Bazel version: N/A</li>\n<li>**CUDA/cuDNN version: N/A</li>\n<li>**GPU model and memory: N/A</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I'm tryting to read my own datasets. And there exists FailedPreconditionError.<br>\nBut my <code> test.records</code> are in the right directory, I don't know why it ocurred.</p>\n<h3>Source code / logs</h3>\n<p>these are the console error.</p>\n<pre><code>INFO:tensorflow:Error reported to Coordinator: &lt;class 'tensorflow.python.framework.errors_impl.FailedPreconditionError'&gt;, /home/tju/0_lvjc/deepnet348/data/tfrecords\n\t [[Node: ReaderReadV2 = ReaderReadV2[_device=\"/job:localhost/replica:0/task:0/cpu:0\"](TFRecordReaderV2, input_producer)]]\nTraceback (most recent call last):\n  File \"/home/tju/Downloads/pycharm-community-2017.2.4/helpers/pydev/pydev_run_in_console.py\", line 37, in run_file\n    pydev_imports.execfile(file, globals, locals)  # execute the script\n  File \"/home/tju/0_lvjc/deepnet348/data_input.py\", line 199, in &lt;module&gt;\n    coord.join(threads)\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\n    six.reraise(*self._exc_info_to_raise)\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 238, in _run\n    enqueue_callable()\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1235, in _single_operation_run\n    target_list_as_strings, status, None)\n  File \"/home/tju/anaconda2/lib/python2.7/contextlib.py\", line 24, in __exit__\n    self.gen.next()\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\n</code></pre>\n<p>these are my codes.</p>\n<pre><code>#%% Convert data to TFRecord\n\nfile_dir='/home/tju/0_lvjc/datasets/SALICON/train_images/*.jpg'\nlabel_dir='/home/tju/0_lvjc/datasets/SALICON/salicon17_maps/train/*.png'\n\ntfrecords_file = '/home/tju/0_lvjc/deepnet348/data/tfrecords'\nBATCH_SIZE = 5\n\n\n#Convert test data: you just need to run it ONCE !\nname_test = 'test'\nimages, labels = get_file(file_dir, label_dir)\nconvert_to_tfrecord(images, labels, save_dir=tfrecords_file, name=name_test)\n\n\n#%% TO test train.tfrecord file\n\ndef plot_images(images, labels):\n    '''plot one batch size\n    '''\n    for i in np.arange(0, BATCH_SIZE):\n        plt.subplot(5, 5, i + 1)\n        plt.axis('off')\n        plt.title(chr(ord('A') + labels[i] - 1), fontsize = 14)\n        plt.subplots_adjust(top=1.5)\n        plt.imshow(images[i])\n    plt.show()\n\n\n\nimage_batch, label_batch = read_and_decode(tfrecords_file, batch_size=BATCH_SIZE)\n\nwith tf.Session()  as sess:\n    \n    i = 0\n    coord = tf.train.Coordinator()\n    threads = tf.train.start_queue_runners(coord=coord)\n    \n    try:\n        while not coord.should_stop() and i&lt;1:\n            # just plot one batch size\n            image, label = sess.run([image_batch, label_batch])\n            plot_images(image, label)\n            i+=1\n            \n    except tf.errors.OutOfRangeError:\n        print('done!')\n    finally:\n        coord.request_stop()\n    coord.join(threads)\n\n</code></pre>", "body_text": "Please go to Stack Overflow for help and support:\nSystem information\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 1604\nTensorFlow installed from (source or binary): conda tensorflow\nTensorFlow version (use command below): 1.3.0\nPython version: 2.7\n**Bazel version: N/A\n**CUDA/cuDNN version: N/A\n**GPU model and memory: N/A\n\nDescribe the problem\nI'm tryting to read my own datasets. And there exists FailedPreconditionError.\nBut my  test.records are in the right directory, I don't know why it ocurred.\nSource code / logs\nthese are the console error.\nINFO:tensorflow:Error reported to Coordinator: <class 'tensorflow.python.framework.errors_impl.FailedPreconditionError'>, /home/tju/0_lvjc/deepnet348/data/tfrecords\n\t [[Node: ReaderReadV2 = ReaderReadV2[_device=\"/job:localhost/replica:0/task:0/cpu:0\"](TFRecordReaderV2, input_producer)]]\nTraceback (most recent call last):\n  File \"/home/tju/Downloads/pycharm-community-2017.2.4/helpers/pydev/pydev_run_in_console.py\", line 37, in run_file\n    pydev_imports.execfile(file, globals, locals)  # execute the script\n  File \"/home/tju/0_lvjc/deepnet348/data_input.py\", line 199, in <module>\n    coord.join(threads)\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\n    six.reraise(*self._exc_info_to_raise)\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 238, in _run\n    enqueue_callable()\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1235, in _single_operation_run\n    target_list_as_strings, status, None)\n  File \"/home/tju/anaconda2/lib/python2.7/contextlib.py\", line 24, in __exit__\n    self.gen.next()\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\n\nthese are my codes.\n#%% Convert data to TFRecord\n\nfile_dir='/home/tju/0_lvjc/datasets/SALICON/train_images/*.jpg'\nlabel_dir='/home/tju/0_lvjc/datasets/SALICON/salicon17_maps/train/*.png'\n\ntfrecords_file = '/home/tju/0_lvjc/deepnet348/data/tfrecords'\nBATCH_SIZE = 5\n\n\n#Convert test data: you just need to run it ONCE !\nname_test = 'test'\nimages, labels = get_file(file_dir, label_dir)\nconvert_to_tfrecord(images, labels, save_dir=tfrecords_file, name=name_test)\n\n\n#%% TO test train.tfrecord file\n\ndef plot_images(images, labels):\n    '''plot one batch size\n    '''\n    for i in np.arange(0, BATCH_SIZE):\n        plt.subplot(5, 5, i + 1)\n        plt.axis('off')\n        plt.title(chr(ord('A') + labels[i] - 1), fontsize = 14)\n        plt.subplots_adjust(top=1.5)\n        plt.imshow(images[i])\n    plt.show()\n\n\n\nimage_batch, label_batch = read_and_decode(tfrecords_file, batch_size=BATCH_SIZE)\n\nwith tf.Session()  as sess:\n    \n    i = 0\n    coord = tf.train.Coordinator()\n    threads = tf.train.start_queue_runners(coord=coord)\n    \n    try:\n        while not coord.should_stop() and i<1:\n            # just plot one batch size\n            image, label = sess.run([image_batch, label_batch])\n            plot_images(image, label)\n            i+=1\n            \n    except tf.errors.OutOfRangeError:\n        print('done!')\n    finally:\n        coord.request_stop()\n    coord.join(threads)", "body": "Please go to Stack Overflow for help and support:\r\n\r\n### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 1604\r\n- **TensorFlow installed from (source or binary)**: conda tensorflow\r\n- **TensorFlow version (use command below)**: 1.3.0\r\n- **Python version**: 2.7\r\n- **Bazel version: N/A\r\n- **CUDA/cuDNN version: N/A\r\n- **GPU model and memory: N/A\r\n\r\n### Describe the problem\r\nI'm tryting to read my own datasets. And there exists FailedPreconditionError.\r\nBut my ` test.records` are in the right directory, I don't know why it ocurred.\r\n\r\n### Source code / logs\r\nthese are the console error.\r\n```\r\nINFO:tensorflow:Error reported to Coordinator: <class 'tensorflow.python.framework.errors_impl.FailedPreconditionError'>, /home/tju/0_lvjc/deepnet348/data/tfrecords\r\n\t [[Node: ReaderReadV2 = ReaderReadV2[_device=\"/job:localhost/replica:0/task:0/cpu:0\"](TFRecordReaderV2, input_producer)]]\r\nTraceback (most recent call last):\r\n  File \"/home/tju/Downloads/pycharm-community-2017.2.4/helpers/pydev/pydev_run_in_console.py\", line 37, in run_file\r\n    pydev_imports.execfile(file, globals, locals)  # execute the script\r\n  File \"/home/tju/0_lvjc/deepnet348/data_input.py\", line 199, in <module>\r\n    coord.join(threads)\r\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\r\n    six.reraise(*self._exc_info_to_raise)\r\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 238, in _run\r\n    enqueue_callable()\r\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1235, in _single_operation_run\r\n    target_list_as_strings, status, None)\r\n  File \"/home/tju/anaconda2/lib/python2.7/contextlib.py\", line 24, in __exit__\r\n    self.gen.next()\r\n  File \"/home/tju/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py\", line 466, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\n```\r\n\r\nthese are my codes.\r\n```\r\n#%% Convert data to TFRecord\r\n\r\nfile_dir='/home/tju/0_lvjc/datasets/SALICON/train_images/*.jpg'\r\nlabel_dir='/home/tju/0_lvjc/datasets/SALICON/salicon17_maps/train/*.png'\r\n\r\ntfrecords_file = '/home/tju/0_lvjc/deepnet348/data/tfrecords'\r\nBATCH_SIZE = 5\r\n\r\n\r\n#Convert test data: you just need to run it ONCE !\r\nname_test = 'test'\r\nimages, labels = get_file(file_dir, label_dir)\r\nconvert_to_tfrecord(images, labels, save_dir=tfrecords_file, name=name_test)\r\n\r\n\r\n#%% TO test train.tfrecord file\r\n\r\ndef plot_images(images, labels):\r\n    '''plot one batch size\r\n    '''\r\n    for i in np.arange(0, BATCH_SIZE):\r\n        plt.subplot(5, 5, i + 1)\r\n        plt.axis('off')\r\n        plt.title(chr(ord('A') + labels[i] - 1), fontsize = 14)\r\n        plt.subplots_adjust(top=1.5)\r\n        plt.imshow(images[i])\r\n    plt.show()\r\n\r\n\r\n\r\nimage_batch, label_batch = read_and_decode(tfrecords_file, batch_size=BATCH_SIZE)\r\n\r\nwith tf.Session()  as sess:\r\n    \r\n    i = 0\r\n    coord = tf.train.Coordinator()\r\n    threads = tf.train.start_queue_runners(coord=coord)\r\n    \r\n    try:\r\n        while not coord.should_stop() and i<1:\r\n            # just plot one batch size\r\n            image, label = sess.run([image_batch, label_batch])\r\n            plot_images(image, label)\r\n            i+=1\r\n            \r\n    except tf.errors.OutOfRangeError:\r\n        print('done!')\r\n    finally:\r\n        coord.request_stop()\r\n    coord.join(threads)\r\n\r\n```"}