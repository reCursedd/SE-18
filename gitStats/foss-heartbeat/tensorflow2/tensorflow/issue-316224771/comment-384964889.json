{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/384964889", "html_url": "https://github.com/tensorflow/tensorflow/pull/18730#issuecomment-384964889", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18730", "id": 384964889, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDk2NDg4OQ==", "user": {"login": "joel-shor", "id": 6020988, "node_id": "MDQ6VXNlcjYwMjA5ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6020988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joel-shor", "html_url": "https://github.com/joel-shor", "followers_url": "https://api.github.com/users/joel-shor/followers", "following_url": "https://api.github.com/users/joel-shor/following{/other_user}", "gists_url": "https://api.github.com/users/joel-shor/gists{/gist_id}", "starred_url": "https://api.github.com/users/joel-shor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joel-shor/subscriptions", "organizations_url": "https://api.github.com/users/joel-shor/orgs", "repos_url": "https://api.github.com/users/joel-shor/repos", "events_url": "https://api.github.com/users/joel-shor/events{/privacy}", "received_events_url": "https://api.github.com/users/joel-shor/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-27T13:08:37Z", "updated_at": "2018-04-27T13:08:37Z", "author_association": "CONTRIBUTOR", "body_html": "<div class=\"email-fragment\">Done! PTAL</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Fri, Apr 27, 2018, 2:41 AM Derek Murray ***@***.***&gt; wrote:\n ***@***.**** requested changes on this pull request.\n\n Just a couple of minor changes left.\n ------------------------------\n\n In tensorflow/contrib/data/python/ops/resampling.py\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"316224771\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/18730\" href=\"https://github.com/tensorflow/tensorflow/pull/18730#discussion_r184559610\">#18730 (comment)</a>&gt;\n :\n\n &gt;\n    return _apply_fn\n\n\n -def _calculate_acceptance_probs(initial_probs, target_probs):\n -  \"\"\"Calculate the per-class acceptance rates.\n +def _get_prob_original_static(initial_dist_t, target_dist_t):\n +  \"\"\"Returns the static probability of sampling from the original.\n +\n +  For some reason, `tensor_util.constant_value(prob_of_original)` of a ratio\n\n For some reason, [...].\n\n The reason is that tensor_util.constant_value() only implements a handful\n of ops, and returns None when it encounters an op that it hasn't\n implemented. Please update the comment to make it seem less mysterious!\n ------------------------------\n\n In tensorflow/contrib/data/python/kernel_tests/resample_test.py\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"316224771\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/18730\" href=\"https://github.com/tensorflow/tensorflow/pull/18730#discussion_r184559789\">#18730 (comment)</a>&gt;\n :\n\n &gt;\n -  def _testDistribution(self, initial_known):\n +  with test_obj.test_session() as sess:\n +    start_time = time.time()\n +    for _ in xrange(num_to_sample):\n +      sess.run(get_next)\n +    end_time = time.time()\n +\n +  return end_time - start_time\n +\n +\n +class ResampleTest(test.TestCase, parameterized.TestCase):\n +\n +  @parameterized.named_parameters(\n +      (\"InitialnDistributionKnown\", True),\n\n Typo: \"Initialn\" -&gt; \"Initial\"\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"316224771\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/18730\" href=\"https://github.com/tensorflow/tensorflow/pull/18730#pullrequestreview-115782670\">#18730 (review)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AFvffP_gwOxIho9ESWrlP3KG9xJD2nJWks5tslsbgaJpZM4TdR7l\">https://github.com/notifications/unsubscribe-auth/AFvffP_gwOxIho9ESWrlP3KG9xJD2nJWks5tslsbgaJpZM4TdR7l</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Done! PTAL\n\u2026\nOn Fri, Apr 27, 2018, 2:41 AM Derek Murray ***@***.***> wrote:\n ***@***.**** requested changes on this pull request.\n\n Just a couple of minor changes left.\n ------------------------------\n\n In tensorflow/contrib/data/python/ops/resampling.py\n <#18730 (comment)>\n :\n\n >\n    return _apply_fn\n\n\n -def _calculate_acceptance_probs(initial_probs, target_probs):\n -  \"\"\"Calculate the per-class acceptance rates.\n +def _get_prob_original_static(initial_dist_t, target_dist_t):\n +  \"\"\"Returns the static probability of sampling from the original.\n +\n +  For some reason, `tensor_util.constant_value(prob_of_original)` of a ratio\n\n For some reason, [...].\n\n The reason is that tensor_util.constant_value() only implements a handful\n of ops, and returns None when it encounters an op that it hasn't\n implemented. Please update the comment to make it seem less mysterious!\n ------------------------------\n\n In tensorflow/contrib/data/python/kernel_tests/resample_test.py\n <#18730 (comment)>\n :\n\n >\n -  def _testDistribution(self, initial_known):\n +  with test_obj.test_session() as sess:\n +    start_time = time.time()\n +    for _ in xrange(num_to_sample):\n +      sess.run(get_next)\n +    end_time = time.time()\n +\n +  return end_time - start_time\n +\n +\n +class ResampleTest(test.TestCase, parameterized.TestCase):\n +\n +  @parameterized.named_parameters(\n +      (\"InitialnDistributionKnown\", True),\n\n Typo: \"Initialn\" -> \"Initial\"\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#18730 (review)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AFvffP_gwOxIho9ESWrlP3KG9xJD2nJWks5tslsbgaJpZM4TdR7l>\n .", "body": "Done! PTAL\n\nOn Fri, Apr 27, 2018, 2:41 AM Derek Murray <notifications@github.com> wrote:\n\n> *@mrry* requested changes on this pull request.\n>\n> Just a couple of minor changes left.\n> ------------------------------\n>\n> In tensorflow/contrib/data/python/ops/resampling.py\n> <https://github.com/tensorflow/tensorflow/pull/18730#discussion_r184559610>\n> :\n>\n> >\n>    return _apply_fn\n>\n>\n> -def _calculate_acceptance_probs(initial_probs, target_probs):\n> -  \"\"\"Calculate the per-class acceptance rates.\n> +def _get_prob_original_static(initial_dist_t, target_dist_t):\n> +  \"\"\"Returns the static probability of sampling from the original.\n> +\n> +  For some reason, `tensor_util.constant_value(prob_of_original)` of a ratio\n>\n> For some reason, [...].\n>\n> The reason is that tensor_util.constant_value() only implements a handful\n> of ops, and returns None when it encounters an op that it hasn't\n> implemented. Please update the comment to make it seem less mysterious!\n> ------------------------------\n>\n> In tensorflow/contrib/data/python/kernel_tests/resample_test.py\n> <https://github.com/tensorflow/tensorflow/pull/18730#discussion_r184559789>\n> :\n>\n> >\n> -  def _testDistribution(self, initial_known):\n> +  with test_obj.test_session() as sess:\n> +    start_time = time.time()\n> +    for _ in xrange(num_to_sample):\n> +      sess.run(get_next)\n> +    end_time = time.time()\n> +\n> +  return end_time - start_time\n> +\n> +\n> +class ResampleTest(test.TestCase, parameterized.TestCase):\n> +\n> +  @parameterized.named_parameters(\n> +      (\"InitialnDistributionKnown\", True),\n>\n> Typo: \"Initialn\" -> \"Initial\"\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/18730#pullrequestreview-115782670>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AFvffP_gwOxIho9ESWrlP3KG9xJD2nJWks5tslsbgaJpZM4TdR7l>\n> .\n>\n"}