{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11847", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11847/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11847/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11847/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11847", "id": 246332766, "node_id": "MDU6SXNzdWUyNDYzMzI3NjY=", "number": 11847, "title": "Bug: Op type not registered 'BlockLSTM' in binary", "user": {"login": "ShapingView", "id": 20456847, "node_id": "MDQ6VXNlcjIwNDU2ODQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/20456847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ShapingView", "html_url": "https://github.com/ShapingView", "followers_url": "https://api.github.com/users/ShapingView/followers", "following_url": "https://api.github.com/users/ShapingView/following{/other_user}", "gists_url": "https://api.github.com/users/ShapingView/gists{/gist_id}", "starred_url": "https://api.github.com/users/ShapingView/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ShapingView/subscriptions", "organizations_url": "https://api.github.com/users/ShapingView/orgs", "repos_url": "https://api.github.com/users/ShapingView/repos", "events_url": "https://api.github.com/users/ShapingView/events{/privacy}", "received_events_url": "https://api.github.com/users/ShapingView/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2017-07-28T12:25:41Z", "updated_at": "2018-08-08T16:50:57Z", "closed_at": "2018-01-18T19:24:19Z", "author_association": "NONE", "body_html": "<h3>Describe the problem</h3>\n<p>I want to load and run a single tensorflow model within another C++ project. To do this, I defined the <code>tensorflow_all</code> library in <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/BUILD\"><code>tensorflow/BUILD</code></a> which should include all the necessary dependencies. (Details below)</p>\n<p>When loading the tensorflow model via the C++ API (<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/cc/saved_model/loader.h#L50\">LoadSavedModel</a>), the following runtime error occurs:</p>\n<pre><code>2017-07-28 13:36:41.875493: I tensorflow/cc/saved_model/loader.cc:284] Loading SavedModel: fail. Took 43550 microseconds.\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  Not found: Op type not registered 'BlockLSTM' in binary running on myMachine. \n  Make sure the Op and Kernel are registered in the binary running in this process.\n</code></pre>\n<p>I found that the BlockLSTM Op is registered in <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/rnn/ops/lstm_ops.cc#L179\"><code>tensorflow/contrib/rnn/ops/lstm_ops.cc</code></a>.<br>\nHowever, I could not find a way to include the operation BlockLSTM in my C++ library <code>tensorflow_all</code>.</p>\n<p>Bear with me if this is actually not a bug (or even a feature request). I am still getting started with tensorflow.</p>\n<p>Since my implementation is part of another larger project, it is currently difficult for me to give an easy to reproduce example. However, if this is necessary, I will do it as soon as I find the time.</p>\n<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:</p>\n<p>Yes, a colleague of mine trained a tensorflow graph which uses the BlockLSTM Op from <code>tensorflow/contrib/rnn/</code> using the python API.</p>\n<p>As mentioned before, I added code to the <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/BUILD\"><code>tensorflow/BUILD</code></a> to create a library <code>tensorflow_all</code>. This library is used to load the graph externally.</p>\n<pre lang=\"bazel\"><code> cc_binary(\n \tname = \"libtensorflow_all.so\",\n \tlinkshared = 1,\n \tlinkopts = [\"-Wl,--version-script=tensorflow/tf_version_script.lds\"],\n \tdeps = [\n \t\t\"//tensorflow/cc:cc_ops\",\n \t\t\"//tensorflow/cc:client_session\",\n \t\t\"//tensorflow/cc/saved_model:loader\",\n \t\t\"//tensorflow/cc/saved_model:tag_constants\",\n \t\t\"//tensorflow/core:all_kernels\",\n \t\t\"//tensorflow/core:framework_internal\",\n \t\t\"//tensorflow/core:tensorflow\",\n \t\t\"//tensorflow/contrib:contrib_kernels\",\n \t\t\"//tensorflow/contrib:contrib_ops_op_lib\",\n \t],\n )\n</code></pre>\n<p>I was hoping that <code>BlockLSTM</code> was included in <code>\"//tensorflow/contrib:contrib_ops_op_lib\"</code>, but that appears not to be the case.</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 16.04.2 LTS</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>: source</p>\n</li>\n<li>\n<p><strong>TensorFlow version</strong>: Master branch (commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/bb88ec7ecc4dc7ba72548a5115fb86e20b14de5b/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/bb88ec7ecc4dc7ba72548a5115fb86e20b14de5b\"><tt>bb88ec7</tt></a>)</p>\n</li>\n<li>\n<p><strong>Python version</strong>: 3.5</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>: 0.4.5</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>: 5.1</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>: GeForce GTX 980, 4GB</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>: Sorry. Not that easy to reproduce.</p>\n</li>\n</ul>", "body_text": "Describe the problem\nI want to load and run a single tensorflow model within another C++ project. To do this, I defined the tensorflow_all library in tensorflow/BUILD which should include all the necessary dependencies. (Details below)\nWhen loading the tensorflow model via the C++ API (LoadSavedModel), the following runtime error occurs:\n2017-07-28 13:36:41.875493: I tensorflow/cc/saved_model/loader.cc:284] Loading SavedModel: fail. Took 43550 microseconds.\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  Not found: Op type not registered 'BlockLSTM' in binary running on myMachine. \n  Make sure the Op and Kernel are registered in the binary running in this process.\n\nI found that the BlockLSTM Op is registered in tensorflow/contrib/rnn/ops/lstm_ops.cc.\nHowever, I could not find a way to include the operation BlockLSTM in my C++ library tensorflow_all.\nBear with me if this is actually not a bug (or even a feature request). I am still getting started with tensorflow.\nSince my implementation is part of another larger project, it is currently difficult for me to give an easy to reproduce example. However, if this is necessary, I will do it as soon as I find the time.\nSystem information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes, a colleague of mine trained a tensorflow graph which uses the BlockLSTM Op from tensorflow/contrib/rnn/ using the python API.\nAs mentioned before, I added code to the tensorflow/BUILD to create a library tensorflow_all. This library is used to load the graph externally.\n cc_binary(\n \tname = \"libtensorflow_all.so\",\n \tlinkshared = 1,\n \tlinkopts = [\"-Wl,--version-script=tensorflow/tf_version_script.lds\"],\n \tdeps = [\n \t\t\"//tensorflow/cc:cc_ops\",\n \t\t\"//tensorflow/cc:client_session\",\n \t\t\"//tensorflow/cc/saved_model:loader\",\n \t\t\"//tensorflow/cc/saved_model:tag_constants\",\n \t\t\"//tensorflow/core:all_kernels\",\n \t\t\"//tensorflow/core:framework_internal\",\n \t\t\"//tensorflow/core:tensorflow\",\n \t\t\"//tensorflow/contrib:contrib_kernels\",\n \t\t\"//tensorflow/contrib:contrib_ops_op_lib\",\n \t],\n )\n\nI was hoping that BlockLSTM was included in \"//tensorflow/contrib:contrib_ops_op_lib\", but that appears not to be the case.\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04.2 LTS\n\n\nTensorFlow installed from (source or binary): source\n\n\nTensorFlow version: Master branch (commit bb88ec7)\n\n\nPython version: 3.5\n\n\nBazel version (if compiling from source): 0.4.5\n\n\nCUDA/cuDNN version: 5.1\n\n\nGPU model and memory: GeForce GTX 980, 4GB\n\n\nExact command to reproduce: Sorry. Not that easy to reproduce.", "body": "### Describe the problem\r\nI want to load and run a single tensorflow model within another C++ project. To do this, I defined the `tensorflow_all` library in [`tensorflow/BUILD`] which should include all the necessary dependencies. (Details below)\r\n\r\nWhen loading the tensorflow model via the C++ API ([LoadSavedModel]), the following runtime error occurs:\r\n\r\n[LoadSavedModel]: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/cc/saved_model/loader.h#L50\r\n\r\n```\r\n2017-07-28 13:36:41.875493: I tensorflow/cc/saved_model/loader.cc:284] Loading SavedModel: fail. Took 43550 microseconds.\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  Not found: Op type not registered 'BlockLSTM' in binary running on myMachine. \r\n  Make sure the Op and Kernel are registered in the binary running in this process.\r\n```\r\n\r\nI found that the BlockLSTM Op is registered in [`tensorflow/contrib/rnn/ops/lstm_ops.cc`].\r\nHowever, I could not find a way to include the operation BlockLSTM in my C++ library `tensorflow_all`.\r\n\r\n[`tensorflow/contrib/rnn/ops/lstm_ops.cc`]: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/rnn/ops/lstm_ops.cc#L179\r\n\r\nBear with me if this is actually not a bug (or even a feature request). I am still getting started with tensorflow. \r\n\r\nSince my implementation is part of another larger project, it is currently difficult for me to give an easy to reproduce example. However, if this is necessary, I will do it as soon as I find the time.\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n\r\n\tYes, a colleague of mine trained a tensorflow graph which uses the BlockLSTM Op from `tensorflow/contrib/rnn/` using the python API. \r\n\r\n\tAs mentioned before, I added code to the [`tensorflow/BUILD`] to create a library `tensorflow_all`. This library is used to load the graph externally.\r\n\r\n\t[`tensorflow/BUILD`]: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/BUILD\r\n\r\n\t```bazel\r\n\tcc_binary(\r\n\t\tname = \"libtensorflow_all.so\",\r\n\t\tlinkshared = 1,\r\n\t\tlinkopts = [\"-Wl,--version-script=tensorflow/tf_version_script.lds\"],\r\n\t\tdeps = [\r\n\t\t\t\"//tensorflow/cc:cc_ops\",\r\n\t\t\t\"//tensorflow/cc:client_session\",\r\n\t\t\t\"//tensorflow/cc/saved_model:loader\",\r\n\t\t\t\"//tensorflow/cc/saved_model:tag_constants\",\r\n\t\t\t\"//tensorflow/core:all_kernels\",\r\n\t\t\t\"//tensorflow/core:framework_internal\",\r\n\t\t\t\"//tensorflow/core:tensorflow\",\r\n\t\t\t\"//tensorflow/contrib:contrib_kernels\",\r\n\t\t\t\"//tensorflow/contrib:contrib_ops_op_lib\",\r\n\t\t],\r\n\t)\r\n\t```\r\n\tI was hoping that `BlockLSTM` was included in `\"//tensorflow/contrib:contrib_ops_op_lib\"`, but that appears not to be the case.\r\n\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04.2 LTS\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version**: Master branch (commit bb88ec7ecc4dc7ba72548a5115fb86e20b14de5b)\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**: 0.4.5\r\n- **CUDA/cuDNN version**: 5.1\r\n- **GPU model and memory**: GeForce GTX 980, 4GB \r\n- **Exact command to reproduce**: Sorry. Not that easy to reproduce.\r\n"}