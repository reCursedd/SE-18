{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5869", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5869/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5869/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5869/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5869", "id": 191775622, "node_id": "MDU6SXNzdWUxOTE3NzU2MjI=", "number": 5869, "title": "Model Exporting Does not Use optimize_for_inference_lib", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-11-25T23:42:25Z", "updated_at": "2018-02-07T23:41:32Z", "closed_at": "2018-02-07T23:41:31Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Looking at the code in master, It looks like neither <a href=\"https://github.com/tensorflow/tensorflow/blob/eea96fc81bb1ae22eeb1d2141e47e182cecb7608/tensorflow/python/training/saver.py\"><code>tensorflow.python.training.saver</code></a> nor <a href=\"https://github.com/tensorflow/tensorflow/blob/eea96fc81bb1ae22eeb1d2141e47e182cecb7608/tensorflow/contrib/session_bundle/exporter.py\"><code>tensorflow.contrib.session_bundle.exporter</code></a> use <a href=\"https://github.com/tensorflow/tensorflow/blob/df871edcff2faf643975b9863100ed41b6da9c3f/tensorflow/python/tools/optimize_for_inference_lib.py\"><code>optimize_for_inference_lib</code></a> which is described as:</p>\n<blockquote>\n<p>There are several common transformations ... that help reduce the amount of computation needed when the network is used only for inference.</p>\n</blockquote>\n<p>Further these optimizations are not mentioned / suggested in the tensorflow serving docs:</p>\n<ul>\n<li><a href=\"https://tensorflow.github.io/serving/\" rel=\"nofollow\">https://tensorflow.github.io/serving/</a></li>\n<li><a href=\"https://github.com/tensorflow/tensorflow/blob/55cb1b37133e6c0409a708a763fccf566580a90a/tensorflow/contrib/session_bundle/README.md\">https://github.com/tensorflow/tensorflow/blob/55cb1b37133e6c0409a708a763fccf566580a90a/tensorflow/contrib/session_bundle/README.md</a></li>\n</ul>\n<p>Arguable the serving logic could be changed to <a href=\"https://github.com/tensorflow/tensorflow/blob/5a5a25ea3ebef623e07fb9a46419a9df377a37a5/tensorflow/g3doc/how_tos/tool_developers/index.md#freezing\">use frozen models</a> (see <a href=\"https://github.com/tensorflow/tensorflow/blob/df871edcff2faf643975b9863100ed41b6da9c3f/tensorflow/python/tools/freeze_graph.py\"><code>freeze_graph</code></a>) which calls <code>convert_variables_to_constants</code>.</p>", "body_text": "Looking at the code in master, It looks like neither tensorflow.python.training.saver nor tensorflow.contrib.session_bundle.exporter use optimize_for_inference_lib which is described as:\n\nThere are several common transformations ... that help reduce the amount of computation needed when the network is used only for inference.\n\nFurther these optimizations are not mentioned / suggested in the tensorflow serving docs:\n\nhttps://tensorflow.github.io/serving/\nhttps://github.com/tensorflow/tensorflow/blob/55cb1b37133e6c0409a708a763fccf566580a90a/tensorflow/contrib/session_bundle/README.md\n\nArguable the serving logic could be changed to use frozen models (see freeze_graph) which calls convert_variables_to_constants.", "body": "Looking at the code in master, It looks like neither [`tensorflow.python.training.saver`](https://github.com/tensorflow/tensorflow/blob/eea96fc81bb1ae22eeb1d2141e47e182cecb7608/tensorflow/python/training/saver.py) nor [`tensorflow.contrib.session_bundle.exporter`](https://github.com/tensorflow/tensorflow/blob/eea96fc81bb1ae22eeb1d2141e47e182cecb7608/tensorflow/contrib/session_bundle/exporter.py) use [`optimize_for_inference_lib`](https://github.com/tensorflow/tensorflow/blob/df871edcff2faf643975b9863100ed41b6da9c3f/tensorflow/python/tools/optimize_for_inference_lib.py) which is described as:\r\n>There are several common transformations ... that help reduce the amount of computation needed when the network is used only for inference.\r\n\r\nFurther these optimizations are not mentioned / suggested in the tensorflow serving docs:\r\n* https://tensorflow.github.io/serving/\r\n* https://github.com/tensorflow/tensorflow/blob/55cb1b37133e6c0409a708a763fccf566580a90a/tensorflow/contrib/session_bundle/README.md\r\n\r\nArguable the serving logic could be changed to [use frozen models](https://github.com/tensorflow/tensorflow/blob/5a5a25ea3ebef623e07fb9a46419a9df377a37a5/tensorflow/g3doc/how_tos/tool_developers/index.md#freezing) (see [`freeze_graph`](https://github.com/tensorflow/tensorflow/blob/df871edcff2faf643975b9863100ed41b6da9c3f/tensorflow/python/tools/freeze_graph.py)) which calls `convert_variables_to_constants`."}