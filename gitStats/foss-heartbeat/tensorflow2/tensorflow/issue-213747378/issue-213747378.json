{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8350", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8350/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8350/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8350/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8350", "id": 213747378, "node_id": "MDU6SXNzdWUyMTM3NDczNzg=", "number": 8350, "title": "Not able to run tensorflow with OpenBLAS support", "user": {"login": "palvi68", "id": 23055810, "node_id": "MDQ6VXNlcjIzMDU1ODEw", "avatar_url": "https://avatars3.githubusercontent.com/u/23055810?v=4", "gravatar_id": "", "url": "https://api.github.com/users/palvi68", "html_url": "https://github.com/palvi68", "followers_url": "https://api.github.com/users/palvi68/followers", "following_url": "https://api.github.com/users/palvi68/following{/other_user}", "gists_url": "https://api.github.com/users/palvi68/gists{/gist_id}", "starred_url": "https://api.github.com/users/palvi68/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/palvi68/subscriptions", "organizations_url": "https://api.github.com/users/palvi68/orgs", "repos_url": "https://api.github.com/users/palvi68/repos", "events_url": "https://api.github.com/users/palvi68/events{/privacy}", "received_events_url": "https://api.github.com/users/palvi68/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-03-13T12:05:28Z", "updated_at": "2018-10-24T20:53:26Z", "closed_at": "2018-10-24T20:53:26Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>Im trying to use OpenBLAS for gemm operations instead of EIGEN with tensorflow.<br>\nI have followed the steps given in<br>\n<a href=\"http://eigen.tuxfamily.org/dox-devel/TopicUsingBlasLapack.html\" rel=\"nofollow\">http://eigen.tuxfamily.org/dox-devel/TopicUsingBlasLapack.html</a></p>\n<p>and compiled the tensoflow android demo application with -DEIGEN_USE_BLAS support and have linked the libopenblas.a to EIGEN by placing the OpenBLAS headers and static library in eigen_archive along with BUILD file.<br>\n<strong><strong>The BUILD File of OpenBLAS is as follows</strong>:</strong></p>\n<p>licenses([\"notice\"])</p>\n<p>cc_library(<br>\nname = \"openblas\",<br>\nhdrs = glob([\"include/*.h\"]),<br>\nsrcs = [\"lib/libopenblas.a\"],<br>\nvisibility = [\"//visibility:public\"],<br>\n)</p>\n<p>The BUILD file of EIGEN has been appended to include and link the openblas library as follows:<br>\ncc_library(<br>\nname = \"eigen\",<br>\nhdrs = EIGEN_MPL2_HEADER_FILES,<br>\ndefines = [<br>\n# This define (mostly) guarantees we don't link any problematic<br>\n# code. We use it, but we do not rely on it, as evidenced above.<br>\n\"EIGEN_MPL2_ONLY\",<br>\n],<br>\nincludes = [\".\"],<br>\ncopts = [\"-IOpenBLAS/include\"],<br>\ndeps = [\"//OpenBLAS:openblas\"],<br>\nvisibility = [\"//visibility:public\"],<br>\n)</p>\n<p>The build is given as follows:<br>\nbazel build --copt=-DEIGEN_USE_BLAS --fat_apk_cpu=arm64-v8a //tensorflow/examples/android:tensorflow_demo --verbose_failures</p>\n<p>The Build is completed successfully and im able to run the apks installed on the target. But the print statements which i have put in OpenBLAS and Eigen/src/Core/products/GeneralMatrixMatrix_BLAS.h using android logging LOGI or LOGD doesnt get displayed in logcat of the device.</p>\n<p>The Build fails if i dont link the openblas library in EIGEN BUILD file and use  -DEIGEN_USE_BLAS, which shows that libopenblas is getting linked to EIGEN.</p>\n<p>Can you please suggest what is the problem in the above procedure ?<br>\nHow can we validate OpenBLAS is actually getting used?</p>", "body_text": "Hi,\nIm trying to use OpenBLAS for gemm operations instead of EIGEN with tensorflow.\nI have followed the steps given in\nhttp://eigen.tuxfamily.org/dox-devel/TopicUsingBlasLapack.html\nand compiled the tensoflow android demo application with -DEIGEN_USE_BLAS support and have linked the libopenblas.a to EIGEN by placing the OpenBLAS headers and static library in eigen_archive along with BUILD file.\nThe BUILD File of OpenBLAS is as follows:\nlicenses([\"notice\"])\ncc_library(\nname = \"openblas\",\nhdrs = glob([\"include/*.h\"]),\nsrcs = [\"lib/libopenblas.a\"],\nvisibility = [\"//visibility:public\"],\n)\nThe BUILD file of EIGEN has been appended to include and link the openblas library as follows:\ncc_library(\nname = \"eigen\",\nhdrs = EIGEN_MPL2_HEADER_FILES,\ndefines = [\n# This define (mostly) guarantees we don't link any problematic\n# code. We use it, but we do not rely on it, as evidenced above.\n\"EIGEN_MPL2_ONLY\",\n],\nincludes = [\".\"],\ncopts = [\"-IOpenBLAS/include\"],\ndeps = [\"//OpenBLAS:openblas\"],\nvisibility = [\"//visibility:public\"],\n)\nThe build is given as follows:\nbazel build --copt=-DEIGEN_USE_BLAS --fat_apk_cpu=arm64-v8a //tensorflow/examples/android:tensorflow_demo --verbose_failures\nThe Build is completed successfully and im able to run the apks installed on the target. But the print statements which i have put in OpenBLAS and Eigen/src/Core/products/GeneralMatrixMatrix_BLAS.h using android logging LOGI or LOGD doesnt get displayed in logcat of the device.\nThe Build fails if i dont link the openblas library in EIGEN BUILD file and use  -DEIGEN_USE_BLAS, which shows that libopenblas is getting linked to EIGEN.\nCan you please suggest what is the problem in the above procedure ?\nHow can we validate OpenBLAS is actually getting used?", "body": "Hi,\r\n\r\nIm trying to use OpenBLAS for gemm operations instead of EIGEN with tensorflow.\r\nI have followed the steps given in \r\nhttp://eigen.tuxfamily.org/dox-devel/TopicUsingBlasLapack.html\r\n\r\nand compiled the tensoflow android demo application with -DEIGEN_USE_BLAS support and have linked the libopenblas.a to EIGEN by placing the OpenBLAS headers and static library in eigen_archive along with BUILD file.\r\n****The BUILD File of OpenBLAS is as follows**:**\r\n\r\nlicenses([\"notice\"])\r\n\r\n cc_library(\r\n      name = \"openblas\",\r\n      hdrs = glob([\"include/*.h\"]),\r\n      srcs = [\"lib/libopenblas.a\"],\r\n      visibility = [\"//visibility:public\"],\r\n  )\r\n\r\nThe BUILD file of EIGEN has been appended to include and link the openblas library as follows:\r\n cc_library(\r\n     name = \"eigen\",\r\n     hdrs = EIGEN_MPL2_HEADER_FILES,\r\n     defines = [\r\n         # This define (mostly) guarantees we don't link any problematic\r\n         # code. We use it, but we do not rely on it, as evidenced above.\r\n         \"EIGEN_MPL2_ONLY\",\r\n     ],\r\n     includes = [\".\"],\r\n     copts = [\"-IOpenBLAS/include\"],\r\n     deps = [\"//OpenBLAS:openblas\"],\r\n     visibility = [\"//visibility:public\"],\r\n )\r\n\r\nThe build is given as follows:\r\nbazel build --copt=-DEIGEN_USE_BLAS --fat_apk_cpu=arm64-v8a //tensorflow/examples/android:tensorflow_demo --verbose_failures\r\n\r\nThe Build is completed successfully and im able to run the apks installed on the target. But the print statements which i have put in OpenBLAS and Eigen/src/Core/products/GeneralMatrixMatrix_BLAS.h using android logging LOGI or LOGD doesnt get displayed in logcat of the device.\r\n\r\nThe Build fails if i dont link the openblas library in EIGEN BUILD file and use  -DEIGEN_USE_BLAS, which shows that libopenblas is getting linked to EIGEN.\r\n\r\nCan you please suggest what is the problem in the above procedure ?\r\nHow can we validate OpenBLAS is actually getting used?"}