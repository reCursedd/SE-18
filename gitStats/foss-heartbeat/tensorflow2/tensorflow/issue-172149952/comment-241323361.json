{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/241323361", "html_url": "https://github.com/tensorflow/tensorflow/issues/3926#issuecomment-241323361", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3926", "id": 241323361, "node_id": "MDEyOklzc3VlQ29tbWVudDI0MTMyMzM2MQ==", "user": {"login": "kalle", "id": 370192, "node_id": "MDQ6VXNlcjM3MDE5Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/370192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kalle", "html_url": "https://github.com/kalle", "followers_url": "https://api.github.com/users/kalle/followers", "following_url": "https://api.github.com/users/kalle/following{/other_user}", "gists_url": "https://api.github.com/users/kalle/gists{/gist_id}", "starred_url": "https://api.github.com/users/kalle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kalle/subscriptions", "organizations_url": "https://api.github.com/users/kalle/orgs", "repos_url": "https://api.github.com/users/kalle/repos", "events_url": "https://api.github.com/users/kalle/events{/privacy}", "received_events_url": "https://api.github.com/users/kalle/received_events", "type": "User", "site_admin": false}, "created_at": "2016-08-22T06:18:35Z", "updated_at": "2016-08-22T07:02:42Z", "author_association": "NONE", "body_html": "<p>Yes, I guess that is was I'm saying.</p>\n<p>I added the print outs and nothing got printed out. But when I changed this lines in <code>optimizer.Optimizer.apply_gradients()</code></p>\n<div class=\"highlight highlight-source-python\"><pre>update_ops <span class=\"pl-k\">=</span> []</pre></div>\n<p>to</p>\n<div class=\"highlight highlight-source-python\"><pre>update_ops <span class=\"pl-k\">=</span> <span class=\"pl-c1\">list</span>(ops.get_collection(ops.GraphKeys.<span class=\"pl-c1\">UPDATE_OPS</span>))</pre></div>\n<p>the batch normalizer did learn the distribution of its input (and got correctly restored)! I don't know if this is the correct place to fetch the <code>UPDATE_OPS</code> or if there needs to be more checks or whatever.</p>\n<p>The <a href=\"https://www.tensorflow.org/versions/r0.10/api_docs/python/contrib.layers.html#optimize_loss\" rel=\"nofollow\"><code>optimize_loss()</code></a> function manually adds a dependency to <code>UPDATE_OPS</code> so I guess that is one way of solving it (and I'll probably go with the <code>optimize_loss()</code> anyway).</p>", "body_text": "Yes, I guess that is was I'm saying.\nI added the print outs and nothing got printed out. But when I changed this lines in optimizer.Optimizer.apply_gradients()\nupdate_ops = []\nto\nupdate_ops = list(ops.get_collection(ops.GraphKeys.UPDATE_OPS))\nthe batch normalizer did learn the distribution of its input (and got correctly restored)! I don't know if this is the correct place to fetch the UPDATE_OPS or if there needs to be more checks or whatever.\nThe optimize_loss() function manually adds a dependency to UPDATE_OPS so I guess that is one way of solving it (and I'll probably go with the optimize_loss() anyway).", "body": "Yes, I guess that is was I'm saying.\n\nI added the print outs and nothing got printed out. But when I changed this lines in `optimizer.Optimizer.apply_gradients()`\n\n``` python\nupdate_ops = []\n```\n\nto\n\n``` python\nupdate_ops = list(ops.get_collection(ops.GraphKeys.UPDATE_OPS))\n```\n\nthe batch normalizer did learn the distribution of its input (and got correctly restored)! I don't know if this is the correct place to fetch the `UPDATE_OPS` or if there needs to be more checks or whatever.\n\nThe [`optimize_loss()`](https://www.tensorflow.org/versions/r0.10/api_docs/python/contrib.layers.html#optimize_loss) function manually adds a dependency to `UPDATE_OPS` so I guess that is one way of solving it (and I'll probably go with the `optimize_loss()` anyway).\n"}