{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23345", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23345/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23345/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23345/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23345", "id": 374929841, "node_id": "MDU6SXNzdWUzNzQ5Mjk4NDE=", "number": 23345, "title": "how to use DATASET to replace function feed_dict,because it is so slow", "user": {"login": "OverrideSkywalker", "id": 27858412, "node_id": "MDQ6VXNlcjI3ODU4NDEy", "avatar_url": "https://avatars0.githubusercontent.com/u/27858412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OverrideSkywalker", "html_url": "https://github.com/OverrideSkywalker", "followers_url": "https://api.github.com/users/OverrideSkywalker/followers", "following_url": "https://api.github.com/users/OverrideSkywalker/following{/other_user}", "gists_url": "https://api.github.com/users/OverrideSkywalker/gists{/gist_id}", "starred_url": "https://api.github.com/users/OverrideSkywalker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OverrideSkywalker/subscriptions", "organizations_url": "https://api.github.com/users/OverrideSkywalker/orgs", "repos_url": "https://api.github.com/users/OverrideSkywalker/repos", "events_url": "https://api.github.com/users/OverrideSkywalker/events{/privacy}", "received_events_url": "https://api.github.com/users/OverrideSkywalker/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-29T09:40:35Z", "updated_at": "2018-11-06T05:16:06Z", "closed_at": "2018-11-06T05:15:42Z", "author_association": "NONE", "body_html": "<p>when I learn a tensorflow project,find one line code:</p>\n<p><code>cls_prob, box_pred = sess.run([output_cls_prob, output_box_pred], feed_dict={input_img: blob})</code></p>\n<p>But, this line code It took a lot of time. (use CPU need 15 seconds...\u252d\u252e\ufe4f\u252d\u252e)</p>\n<p>By consulting information, I find use function 'dataset' could solve this problem which took a lot of time, How should I use it?</p>\n<p>source of 'blob':</p>\n<p><code>img = cv2.imread('./imgs/001.jpg') img_scale = float(600) / min(img_data.shape[0], img_data.shape[1]) if np.round(img_scale * max(img_data.shape[0], img_data.shape[1])) &gt; 1200: img_scale = float(1200) / max(img_data.shape[0], img_data.shape[1]) img_data = cv2.resize(img_data, None, None, fx=img_scale, fy=img_scale, interpolation=cv2.INTER_LINEAR) img_orig = img_data.astype(np.float32, copy=True) blob = np.zeros((1, img_data.shape[0], img_data.shape[1], 3),dtype=np.float32) blob[0, 0:img_data.shape[0], 0:img_data.shape[1], :] = img_orig</code></p>\n<p>source of 'output_cls_prob'&amp;'output_box_pred'&amp;'input_img':</p>\n<p><code># Actually,read PB model... input_img = sess.graph.get_tensor_by_name('Placeholder:0') output_cls_prob = sess.graph.get_tensor_by_name('Reshape_2:0') output_box_pred = sess.graph.get_tensor_by_name('rpn_bbox_pred/Reshape_1:0')</code></p>\n<p>Parameter type\uff1a</p>\n<blockquote>\n<p>blob\uff1atype 'numpy.ndarray'</p>\n<p>output_cls_prob\uff1aclass 'tensorflow.python.framework.ops.Tensor'</p>\n<p>output_box_pred\uff1aclass 'tensorflow.python.framework.ops.Tensor'</p>\n<p>input_img\uff1aclass 'tensorflow.python.framework.ops.Tensor'</p>\n</blockquote>\n<p>These codes are used for model computation.The model has been trained.</p>\n<p>If you see the same problem on Stack Overflow\uff0cYes, yes, that's what I asked myself.(^o^)/~</p>", "body_text": "when I learn a tensorflow project,find one line code:\ncls_prob, box_pred = sess.run([output_cls_prob, output_box_pred], feed_dict={input_img: blob})\nBut, this line code It took a lot of time. (use CPU need 15 seconds...\u252d\u252e\ufe4f\u252d\u252e)\nBy consulting information, I find use function 'dataset' could solve this problem which took a lot of time, How should I use it?\nsource of 'blob':\nimg = cv2.imread('./imgs/001.jpg') img_scale = float(600) / min(img_data.shape[0], img_data.shape[1]) if np.round(img_scale * max(img_data.shape[0], img_data.shape[1])) > 1200: img_scale = float(1200) / max(img_data.shape[0], img_data.shape[1]) img_data = cv2.resize(img_data, None, None, fx=img_scale, fy=img_scale, interpolation=cv2.INTER_LINEAR) img_orig = img_data.astype(np.float32, copy=True) blob = np.zeros((1, img_data.shape[0], img_data.shape[1], 3),dtype=np.float32) blob[0, 0:img_data.shape[0], 0:img_data.shape[1], :] = img_orig\nsource of 'output_cls_prob'&'output_box_pred'&'input_img':\n# Actually,read PB model... input_img = sess.graph.get_tensor_by_name('Placeholder:0') output_cls_prob = sess.graph.get_tensor_by_name('Reshape_2:0') output_box_pred = sess.graph.get_tensor_by_name('rpn_bbox_pred/Reshape_1:0')\nParameter type\uff1a\n\nblob\uff1atype 'numpy.ndarray'\noutput_cls_prob\uff1aclass 'tensorflow.python.framework.ops.Tensor'\noutput_box_pred\uff1aclass 'tensorflow.python.framework.ops.Tensor'\ninput_img\uff1aclass 'tensorflow.python.framework.ops.Tensor'\n\nThese codes are used for model computation.The model has been trained.\nIf you see the same problem on Stack Overflow\uff0cYes, yes, that's what I asked myself.(^o^)/~", "body": "when I learn a tensorflow project,find one line code:\r\n\r\n`cls_prob, box_pred = sess.run([output_cls_prob, output_box_pred], feed_dict={input_img: blob})`\r\n\r\nBut, this line code It took a lot of time. (use CPU need 15 seconds...\u252d\u252e\ufe4f\u252d\u252e)\r\n\r\nBy consulting information, I find use function 'dataset' could solve this problem which took a lot of time, How should I use it?\r\n\r\nsource of 'blob':\r\n\r\n`img = cv2.imread('./imgs/001.jpg')\r\nimg_scale = float(600) / min(img_data.shape[0], img_data.shape[1])\r\nif np.round(img_scale * max(img_data.shape[0], img_data.shape[1])) > 1200:\r\n    img_scale = float(1200) / max(img_data.shape[0], img_data.shape[1])\r\nimg_data = cv2.resize(img_data, None, None, fx=img_scale, fy=img_scale, interpolation=cv2.INTER_LINEAR)\r\nimg_orig = img_data.astype(np.float32, copy=True)\r\nblob = np.zeros((1, img_data.shape[0], img_data.shape[1], 3),dtype=np.float32)\r\nblob[0, 0:img_data.shape[0], 0:img_data.shape[1], :] = img_orig`\r\n\r\nsource of 'output_cls_prob'&'output_box_pred'&'input_img':\r\n\r\n`# Actually,read PB model...\r\ninput_img = sess.graph.get_tensor_by_name('Placeholder:0')\r\noutput_cls_prob = sess.graph.get_tensor_by_name('Reshape_2:0')\r\noutput_box_pred = sess.graph.get_tensor_by_name('rpn_bbox_pred/Reshape_1:0')`\r\n\r\nParameter type\uff1a\r\n\r\n> blob\uff1atype 'numpy.ndarray'\r\n> \r\n> output_cls_prob\uff1aclass 'tensorflow.python.framework.ops.Tensor'\r\n> \r\n> output_box_pred\uff1aclass 'tensorflow.python.framework.ops.Tensor'\r\n> \r\n> input_img\uff1aclass 'tensorflow.python.framework.ops.Tensor'\r\n\r\nThese codes are used for model computation.The model has been trained.\r\n\r\nIf you see the same problem on Stack Overflow\uff0cYes, yes, that's what I asked myself.\\(^o^)/~\r\n"}