{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/279548915", "html_url": "https://github.com/tensorflow/tensorflow/issues/7306#issuecomment-279548915", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7306", "id": 279548915, "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTU0ODkxNQ==", "user": {"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-13T22:47:59Z", "updated_at": "2017-02-13T22:47:59Z", "author_association": "MEMBER", "body_html": "<p>Okay so one bug clearly is that the tell() method (<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/lib/io/file_io.py#L147\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/lib/io/file_io.py#L147</a>) needs to do a _preread_check() and not just check for _read_check_passed. That should fix the problem with Tell().</p>\n<p>It should look like...</p>\n<p>def tell(self):<br>\n\"\"\"Returns the current position in the file.\"\"\"<br>\nself._preread_check()<br>\nreturn self._read_buf.Tell()</p>\n<p>I'll send out that fix.</p>\n<p>This still doesn't solve the problem that you experienced earlier (I think).. I agree with <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a> that the file sizes somehow are the culprit...</p>\n<p>FYI the pywrap_tensorflow method comes from file_io.i (SWIG wrapping the c++ interface).</p>\n<p>The C++ implementation is in core/platform/env.cc core/platform/file_system.cc. Hopefully this might help you debug more if you want to dig into it further.</p>\n<p>When you read it one byte at a time.. where did it crash?</p>", "body_text": "Okay so one bug clearly is that the tell() method (https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/lib/io/file_io.py#L147) needs to do a _preread_check() and not just check for _read_check_passed. That should fix the problem with Tell().\nIt should look like...\ndef tell(self):\n\"\"\"Returns the current position in the file.\"\"\"\nself._preread_check()\nreturn self._read_buf.Tell()\nI'll send out that fix.\nThis still doesn't solve the problem that you experienced earlier (I think).. I agree with @mrry that the file sizes somehow are the culprit...\nFYI the pywrap_tensorflow method comes from file_io.i (SWIG wrapping the c++ interface).\nThe C++ implementation is in core/platform/env.cc core/platform/file_system.cc. Hopefully this might help you debug more if you want to dig into it further.\nWhen you read it one byte at a time.. where did it crash?", "body": "Okay so one bug clearly is that the tell() method (https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/lib/io/file_io.py#L147) needs to do a _preread_check() and not just check for _read_check_passed. That should fix the problem with Tell().\r\n\r\nIt should look like...\r\n\r\ndef tell(self):\r\n    \"\"\"Returns the current position in the file.\"\"\"\r\n    self._preread_check()\r\n    return self._read_buf.Tell()\r\n\r\nI'll send out that fix.\r\n\r\nThis still doesn't solve the problem that you experienced earlier (I think).. I agree with @mrry that the file sizes somehow are the culprit...\r\n\r\nFYI the pywrap_tensorflow method comes from file_io.i (SWIG wrapping the c++ interface).\r\n\r\nThe C++ implementation is in core/platform/env.cc core/platform/file_system.cc. Hopefully this might help you debug more if you want to dig into it further. \r\n\r\nWhen you read it one byte at a time.. where did it crash? "}