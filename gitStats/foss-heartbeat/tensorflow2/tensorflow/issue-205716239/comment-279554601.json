{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/279554601", "html_url": "https://github.com/tensorflow/tensorflow/issues/7306#issuecomment-279554601", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7306", "id": 279554601, "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTU1NDYwMQ==", "user": {"login": "mawah", "id": 17458994, "node_id": "MDQ6VXNlcjE3NDU4OTk0", "avatar_url": "https://avatars3.githubusercontent.com/u/17458994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mawah", "html_url": "https://github.com/mawah", "followers_url": "https://api.github.com/users/mawah/followers", "following_url": "https://api.github.com/users/mawah/following{/other_user}", "gists_url": "https://api.github.com/users/mawah/gists{/gist_id}", "starred_url": "https://api.github.com/users/mawah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mawah/subscriptions", "organizations_url": "https://api.github.com/users/mawah/orgs", "repos_url": "https://api.github.com/users/mawah/repos", "events_url": "https://api.github.com/users/mawah/events{/privacy}", "received_events_url": "https://api.github.com/users/mawah/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-13T23:13:10Z", "updated_at": "2017-02-13T23:13:10Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=144114\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rohan100jain\">@rohan100jain</a> and <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=192142\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mrry\">@mrry</a> ,<br>\nI added a call to <code>f._preread_check()</code>. Even so, looks like the <code>for</code> loop crashes while trying to read the first byte:</p>\n<pre><code>import tensorflow as tf\nwith tf.gfile.Open('labels.txt', 'r') as f:\n    f._preread_check()\n    print('Result of f.tell(): {}'.format(f.tell()))\n    for _ in range(10):\n        print(f.read(n=1))\n</code></pre>\n<p>Output:</p>\n<pre><code>Result of f.tell(): 0\n---------------------------------------------------------------------------\nOutOfRangeError                           Traceback (most recent call last)\n&lt;ipython-input-15-ae33091a7083&gt; in &lt;module&gt;()\n      5     print('Result of f.tell(): {}'.format(f.tell()))\n      6     for _ in range(10):\n----&gt; 7         print(f.read(n=1))\n\nC:\\Anaconda\\envs\\py35\\lib\\site-packages\\tensorflow\\python\\lib\\io\\file_io.py in read(self, n)\n    110       else:\n    111         length = n\n--&gt; 112       return pywrap_tensorflow.ReadFromStream(self._read_buf, length, status)\n    113 \n    114   def seek(self, position):\n\nC:\\Anaconda\\envs\\py35\\lib\\contextlib.py in __exit__(self, type, value, traceback)\n     64         if type is None:\n     65             try:\n---&gt; 66                 next(self.gen)\n     67             except StopIteration:\n     68                 return\n\nC:\\Anaconda\\envs\\py35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\n    467           None, None,\n    468           compat.as_text(pywrap_tensorflow.TF_Message(status)),\n--&gt; 469           pywrap_tensorflow.TF_GetCode(status))\n    470   finally:\n    471     pywrap_tensorflow.TF_DeleteStatus(status)\n\nOutOfRangeError: reached end of file\n</code></pre>", "body_text": "Hi @rohan100jain and @mrry ,\nI added a call to f._preread_check(). Even so, looks like the for loop crashes while trying to read the first byte:\nimport tensorflow as tf\nwith tf.gfile.Open('labels.txt', 'r') as f:\n    f._preread_check()\n    print('Result of f.tell(): {}'.format(f.tell()))\n    for _ in range(10):\n        print(f.read(n=1))\n\nOutput:\nResult of f.tell(): 0\n---------------------------------------------------------------------------\nOutOfRangeError                           Traceback (most recent call last)\n<ipython-input-15-ae33091a7083> in <module>()\n      5     print('Result of f.tell(): {}'.format(f.tell()))\n      6     for _ in range(10):\n----> 7         print(f.read(n=1))\n\nC:\\Anaconda\\envs\\py35\\lib\\site-packages\\tensorflow\\python\\lib\\io\\file_io.py in read(self, n)\n    110       else:\n    111         length = n\n--> 112       return pywrap_tensorflow.ReadFromStream(self._read_buf, length, status)\n    113 \n    114   def seek(self, position):\n\nC:\\Anaconda\\envs\\py35\\lib\\contextlib.py in __exit__(self, type, value, traceback)\n     64         if type is None:\n     65             try:\n---> 66                 next(self.gen)\n     67             except StopIteration:\n     68                 return\n\nC:\\Anaconda\\envs\\py35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\n    467           None, None,\n    468           compat.as_text(pywrap_tensorflow.TF_Message(status)),\n--> 469           pywrap_tensorflow.TF_GetCode(status))\n    470   finally:\n    471     pywrap_tensorflow.TF_DeleteStatus(status)\n\nOutOfRangeError: reached end of file", "body": "Hi @rohan100jain and @mrry ,\r\nI added a call to `f._preread_check()`. Even so, looks like the `for` loop crashes while trying to read the first byte:\r\n```\r\nimport tensorflow as tf\r\nwith tf.gfile.Open('labels.txt', 'r') as f:\r\n    f._preread_check()\r\n    print('Result of f.tell(): {}'.format(f.tell()))\r\n    for _ in range(10):\r\n        print(f.read(n=1))\r\n```\r\nOutput:\r\n```\r\nResult of f.tell(): 0\r\n---------------------------------------------------------------------------\r\nOutOfRangeError                           Traceback (most recent call last)\r\n<ipython-input-15-ae33091a7083> in <module>()\r\n      5     print('Result of f.tell(): {}'.format(f.tell()))\r\n      6     for _ in range(10):\r\n----> 7         print(f.read(n=1))\r\n\r\nC:\\Anaconda\\envs\\py35\\lib\\site-packages\\tensorflow\\python\\lib\\io\\file_io.py in read(self, n)\r\n    110       else:\r\n    111         length = n\r\n--> 112       return pywrap_tensorflow.ReadFromStream(self._read_buf, length, status)\r\n    113 \r\n    114   def seek(self, position):\r\n\r\nC:\\Anaconda\\envs\\py35\\lib\\contextlib.py in __exit__(self, type, value, traceback)\r\n     64         if type is None:\r\n     65             try:\r\n---> 66                 next(self.gen)\r\n     67             except StopIteration:\r\n     68                 return\r\n\r\nC:\\Anaconda\\envs\\py35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\r\n    467           None, None,\r\n    468           compat.as_text(pywrap_tensorflow.TF_Message(status)),\r\n--> 469           pywrap_tensorflow.TF_GetCode(status))\r\n    470   finally:\r\n    471     pywrap_tensorflow.TF_DeleteStatus(status)\r\n\r\nOutOfRangeError: reached end of file\r\n```"}