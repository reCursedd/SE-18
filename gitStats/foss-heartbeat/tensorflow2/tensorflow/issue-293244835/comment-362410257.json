{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/362410257", "html_url": "https://github.com/tensorflow/tensorflow/issues/16627#issuecomment-362410257", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16627", "id": 362410257, "node_id": "MDEyOklzc3VlQ29tbWVudDM2MjQxMDI1Nw==", "user": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-01T21:37:53Z", "updated_at": "2018-02-01T21:37:53Z", "author_association": "CONTRIBUTOR", "body_html": "<div class=\"email-fragment\">Could it be a grappler issue?</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Thu, Feb 1, 2018, 1:07 PM John Ingraham ***@***.***&gt; wrote:\n I just encountered a similar bug and a weird workaround when upgrading to\n 1.5 on a different codebase. While trying to diagnose that problem by\n injecting various Print ops around the graph I found a bizarre fix: if you\n wrap the placeholder with a tf.identity() (or Print()) and then feed to\n that tensor rather than the placeholder, it stops hanging.\n\n I just tried it and, sure enough, replacing the line in the above code\n\n x_var = tf.placeholder(dtype=tf.float32, shape=(None, None, None, 512))\n\n with\n\n x_var = tf.identity(tf.placeholder(dtype=tf.float32, shape=(None, None,\n None, 512)))\n\n fixes the memory hang problem for me on a K80 instance with Tensorflow\n 1.5. And, since that tensor still gets fed, it does not seem to affect\n downstream computation.\n\n Not sure what is common between the codebases, but for what it's worth the\n one I am working on also involves a combination of conv layers, a\n tf.while_loop, and placeholders with multiple unknown dimensions.\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"293244835\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/16627\" href=\"https://github.com/tensorflow/tensorflow/issues/16627#issuecomment-362401867\">#16627 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/ABtimzgdJCug1oEyNTbQ39o14OkWeUN_ks5tQieZgaJpZM4R0WeN\">https://github.com/notifications/unsubscribe-auth/ABtimzgdJCug1oEyNTbQ39o14OkWeUN_ks5tQieZgaJpZM4R0WeN</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Could it be a grappler issue?\n\u2026\nOn Thu, Feb 1, 2018, 1:07 PM John Ingraham ***@***.***> wrote:\n I just encountered a similar bug and a weird workaround when upgrading to\n 1.5 on a different codebase. While trying to diagnose that problem by\n injecting various Print ops around the graph I found a bizarre fix: if you\n wrap the placeholder with a tf.identity() (or Print()) and then feed to\n that tensor rather than the placeholder, it stops hanging.\n\n I just tried it and, sure enough, replacing the line in the above code\n\n x_var = tf.placeholder(dtype=tf.float32, shape=(None, None, None, 512))\n\n with\n\n x_var = tf.identity(tf.placeholder(dtype=tf.float32, shape=(None, None,\n None, 512)))\n\n fixes the memory hang problem for me on a K80 instance with Tensorflow\n 1.5. And, since that tensor still gets fed, it does not seem to affect\n downstream computation.\n\n Not sure what is common between the codebases, but for what it's worth the\n one I am working on also involves a combination of conv layers, a\n tf.while_loop, and placeholders with multiple unknown dimensions.\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#16627 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/ABtimzgdJCug1oEyNTbQ39o14OkWeUN_ks5tQieZgaJpZM4R0WeN>\n .", "body": "Could it be a grappler issue?\n\nOn Thu, Feb 1, 2018, 1:07 PM John Ingraham <notifications@github.com> wrote:\n\n> I just encountered a similar bug and a weird workaround when upgrading to\n> 1.5 on a different codebase. While trying to diagnose that problem by\n> injecting various Print ops around the graph I found a bizarre fix: if you\n> wrap the placeholder with a tf.identity() (or Print()) and then feed to\n> that tensor rather than the placeholder, it stops hanging.\n>\n> I just tried it and, sure enough, replacing the line in the above code\n>\n> x_var = tf.placeholder(dtype=tf.float32, shape=(None, None, None, 512))\n>\n> with\n>\n> x_var = tf.identity(tf.placeholder(dtype=tf.float32, shape=(None, None,\n> None, 512)))\n>\n> fixes the memory hang problem for me on a K80 instance with Tensorflow\n> 1.5. And, since that tensor still gets fed, it does not seem to affect\n> downstream computation.\n>\n> Not sure what is common between the codebases, but for what it's worth the\n> one I am working on also involves a combination of conv layers, a\n> tf.while_loop, and placeholders with multiple unknown dimensions.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/16627#issuecomment-362401867>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtimzgdJCug1oEyNTbQ39o14OkWeUN_ks5tQieZgaJpZM4R0WeN>\n> .\n>\n"}