{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18769", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18769/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18769/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18769/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18769", "id": 316552208, "node_id": "MDU6SXNzdWUzMTY1NTIyMDg=", "number": 18769, "title": "InvalidArgumentError for save/restore of variables (same version, same OS, same directory)", "user": {"login": "rothn", "id": 4665783, "node_id": "MDQ6VXNlcjQ2NjU3ODM=", "avatar_url": "https://avatars3.githubusercontent.com/u/4665783?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rothn", "html_url": "https://github.com/rothn", "followers_url": "https://api.github.com/users/rothn/followers", "following_url": "https://api.github.com/users/rothn/following{/other_user}", "gists_url": "https://api.github.com/users/rothn/gists{/gist_id}", "starred_url": "https://api.github.com/users/rothn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rothn/subscriptions", "organizations_url": "https://api.github.com/users/rothn/orgs", "repos_url": "https://api.github.com/users/rothn/repos", "events_url": "https://api.github.com/users/rothn/events{/privacy}", "received_events_url": "https://api.github.com/users/rothn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": {"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 18, "created_at": "2018-04-22T06:03:46Z", "updated_at": "2018-11-22T04:24:28Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>I get an InvalidArgumentError with no further information when I try to save and then restore parts of my model later to continue training it (due to needing my laptop for class).</p>\n<p>Initialization:<br>\nsaver = tf.train.Saver({\"embeddings\": embeddings, \"weights\": nce_weights, \"biases\": nce_biases})</p>\n<p>Save:<br>\nsaver.save(sess, model_checkpoint_path)</p>\n<p>Load:<br>\nsaver.restore(sess, model_checkpoint_path)</p>\n<pre><code>2018-04-21 22:45:00.143245: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Invalid argument: /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\nTraceback (most recent call last):\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1327, in _do_call\n    return fn(*args)\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1312, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1420, in _call_tf_sessionrun\n    status, run_metadata)\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\n... &lt;contains sensitive info&gt; ...\n\nInvalidArgumentError (see above for traceback): /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n</code></pre>\n<p><strong>Clarification requested by tensorflowbutler</strong><br>\n<em>Have I written custom code:</em><br>\nYes, I modified this code (<a href=\"https://github.com/PacktPublishing/TensorFlow-Machine-Learning-Cookbook/blob/master/Chapter%2007/doc2vec.py\">https://github.com/PacktPublishing/TensorFlow-Machine-Learning-Cookbook/blob/master/Chapter%2007/doc2vec.py</a>) to work with TensorFlow 1.7 and to use the same embeddings variable for documents as for words with average instead of concatenation. I also updated the saved variables to include nce_weights and nce_biases so that training may be resumed.<br>\n<em>OS Platform and Distribution</em><br>\nMacOS 10.13.4 (17E199)<br>\n<em>TensorFlow installed from</em><br>\npip on VirtualEnv, according to instructions (<a href=\"https://www.tensorflow.org/install/install_mac\" rel=\"nofollow\">https://www.tensorflow.org/install/install_mac</a>)<br>\n<em>TensorFlow version</em><br>\n1.7<br>\n<em>Bazel version</em><br>\nNA<br>\n<em>CUDA/cuDNN version</em><br>\nNA<br>\n<em>GPU model and memory</em><br>\nNA<br>\n<em>Exact command to reproduce</em><br>\nsaver = tf.train.Saver({\"embeddings\": embeddings, \"weights\": nce_weights, \"biases\": nce_biases})<br>\nsaver.restore(sess, \"../trained_model/saved_stuff\")</p>", "body_text": "I get an InvalidArgumentError with no further information when I try to save and then restore parts of my model later to continue training it (due to needing my laptop for class).\nInitialization:\nsaver = tf.train.Saver({\"embeddings\": embeddings, \"weights\": nce_weights, \"biases\": nce_biases})\nSave:\nsaver.save(sess, model_checkpoint_path)\nLoad:\nsaver.restore(sess, model_checkpoint_path)\n2018-04-21 22:45:00.143245: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Invalid argument: /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\nTraceback (most recent call last):\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1327, in _do_call\n    return fn(*args)\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1312, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1420, in _call_tf_sessionrun\n    status, run_metadata)\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\n... <contains sensitive info> ...\n\nInvalidArgumentError (see above for traceback): /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\n\nClarification requested by tensorflowbutler\nHave I written custom code:\nYes, I modified this code (https://github.com/PacktPublishing/TensorFlow-Machine-Learning-Cookbook/blob/master/Chapter%2007/doc2vec.py) to work with TensorFlow 1.7 and to use the same embeddings variable for documents as for words with average instead of concatenation. I also updated the saved variables to include nce_weights and nce_biases so that training may be resumed.\nOS Platform and Distribution\nMacOS 10.13.4 (17E199)\nTensorFlow installed from\npip on VirtualEnv, according to instructions (https://www.tensorflow.org/install/install_mac)\nTensorFlow version\n1.7\nBazel version\nNA\nCUDA/cuDNN version\nNA\nGPU model and memory\nNA\nExact command to reproduce\nsaver = tf.train.Saver({\"embeddings\": embeddings, \"weights\": nce_weights, \"biases\": nce_biases})\nsaver.restore(sess, \"../trained_model/saved_stuff\")", "body": "I get an InvalidArgumentError with no further information when I try to save and then restore parts of my model later to continue training it (due to needing my laptop for class).\r\n\r\nInitialization:\r\nsaver = tf.train.Saver({\"embeddings\": embeddings, \"weights\": nce_weights, \"biases\": nce_biases})\r\n\r\nSave:\r\nsaver.save(sess, model_checkpoint_path)\r\n\r\nLoad:\r\nsaver.restore(sess, model_checkpoint_path)\r\n\r\n```\r\n2018-04-21 22:45:00.143245: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Invalid argument: /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\r\nTraceback (most recent call last):\r\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1327, in _do_call\r\n    return fn(*args)\r\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1312, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1420, in _call_tf_sessionrun\r\n    status, run_metadata)\r\n  File \"/Users/nroth/tf_python/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\r\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\r\n\r\n... <contains sensitive info> ...\r\n\r\nInvalidArgumentError (see above for traceback): /Users/nroth/Documents/****/trained_model/****embeddings.ckpt.data-00000-of-00001; Invalid argument\r\n\t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]\r\n```\r\n\r\n**Clarification requested by tensorflowbutler**\r\n_Have I written custom code:_\r\nYes, I modified this code (https://github.com/PacktPublishing/TensorFlow-Machine-Learning-Cookbook/blob/master/Chapter%2007/doc2vec.py) to work with TensorFlow 1.7 and to use the same embeddings variable for documents as for words with average instead of concatenation. I also updated the saved variables to include nce_weights and nce_biases so that training may be resumed.\r\n_OS Platform and Distribution_\r\nMacOS 10.13.4 (17E199)\r\n_TensorFlow installed from_\r\npip on VirtualEnv, according to instructions (https://www.tensorflow.org/install/install_mac)\r\n_TensorFlow version_\r\n1.7\r\n_Bazel version_\r\nNA\r\n_CUDA/cuDNN version_\r\nNA\r\n_GPU model and memory_\r\nNA\r\n_Exact command to reproduce_\r\nsaver = tf.train.Saver({\"embeddings\": embeddings, \"weights\": nce_weights, \"biases\": nce_biases})\r\nsaver.restore(sess, \"../trained_model/saved_stuff\")"}