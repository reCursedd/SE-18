{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/436993640", "html_url": "https://github.com/tensorflow/tensorflow/issues/18769#issuecomment-436993640", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18769", "id": 436993640, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjk5MzY0MA==", "user": {"login": "shkarupa-alex", "id": 1289725, "node_id": "MDQ6VXNlcjEyODk3MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1289725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shkarupa-alex", "html_url": "https://github.com/shkarupa-alex", "followers_url": "https://api.github.com/users/shkarupa-alex/followers", "following_url": "https://api.github.com/users/shkarupa-alex/following{/other_user}", "gists_url": "https://api.github.com/users/shkarupa-alex/gists{/gist_id}", "starred_url": "https://api.github.com/users/shkarupa-alex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shkarupa-alex/subscriptions", "organizations_url": "https://api.github.com/users/shkarupa-alex/orgs", "repos_url": "https://api.github.com/users/shkarupa-alex/repos", "events_url": "https://api.github.com/users/shkarupa-alex/events{/privacy}", "received_events_url": "https://api.github.com/users/shkarupa-alex/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-08T13:29:12Z", "updated_at": "2018-11-08T13:35:22Z", "author_association": "NONE", "body_html": "<blockquote>\n<p>We can put &gt;2GB in checkpoints now. <a href=\"https://github.com/tensorflow/tensorflow/commit/b8c86c3bbd8271ed968087f24e7fb704103bc733#diff-f4340b63dcfb03e060905682f7471faa\">b8c86c3#diff-f4340b63dcfb03e060905682f7471faa</a> fixes an int32 size issue for string dtypes. I don't see a similar issue for Tensors, and this error doesn't look like it's a length/checksum issue. From \"OP_REQUIRES failed at save_restore_v2_ops.cc:184\" and reading the exceptions in the function it's calling, it looks vaguely like this could be complaining about a dtype mismatch? But that could just be the first thing that doesn't match if the whole file is corrupted for some reason.</p>\n<p>Can someone distill their issue into a snippet I can run, e.g. with fill()? I ran the following and it seems to work:</p>\n<pre><code>import tensorflow as tf\nfrom tensorflow.python.ops import io_ops\n\ndef main(_):\n  tf.enable_eager_execution()\n  large = tf.fill([10] * 9 + [5], value=tf.constant(1., dtype=tf.float32))\n  path = '/some/network/path'\n  io_ops.save_v2([path], [\"a\"], [\"\"], [large])\n  restored = io_ops.restore_v2(path, [\"a\"], [\"\"], [tf.float32])\n  print(tf.reduce_sum(restored))\n\nif __name__ == '__main__':\n  tf.app.run()\n</code></pre>\n<p>Prints:</p>\n<p><code>tf.Tensor(5e+09, shape=(), dtype=float32)</code></p>\n</blockquote>\n<p>I've tried this snippet on Mac OS X 10.14.1 + TF 1.12.0<br>\nGot such error:</p>\n<blockquote>\n<p>restored = io_ops.restore_v2(path, [\"a\"], [\"\"], [tf.float32])<br>\n2018-11-08 17:27:05.767089: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Invalid argument: /Users/alex/HDD/Develop/tmp.data-00000-of-00001; Invalid argument<br>\nTraceback (most recent call last):<br>\nFile \"\", line 1, in <br>\nFile \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1486, in restore_v2<br>\nctx=_ctx)<br>\nFile \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1511, in restore_v2_eager_fallback<br>\nattrs=_attrs, ctx=_ctx, name=name)<br>\nFile \"/usr/local/lib/python3.6/site-packages/tensorflow/python/eager/execute.py\", line 66, in quick_execute<br>\nsix.raise_from(core._status_to_exception(e.code, message), None)<br>\nFile \"\", line 3, in raise_from<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: /Users/alex/HDD/Develop/tmp.data-00000-of-00001; Invalid argument [Op:RestoreV2]</p>\n</blockquote>", "body_text": "We can put >2GB in checkpoints now. b8c86c3#diff-f4340b63dcfb03e060905682f7471faa fixes an int32 size issue for string dtypes. I don't see a similar issue for Tensors, and this error doesn't look like it's a length/checksum issue. From \"OP_REQUIRES failed at save_restore_v2_ops.cc:184\" and reading the exceptions in the function it's calling, it looks vaguely like this could be complaining about a dtype mismatch? But that could just be the first thing that doesn't match if the whole file is corrupted for some reason.\nCan someone distill their issue into a snippet I can run, e.g. with fill()? I ran the following and it seems to work:\nimport tensorflow as tf\nfrom tensorflow.python.ops import io_ops\n\ndef main(_):\n  tf.enable_eager_execution()\n  large = tf.fill([10] * 9 + [5], value=tf.constant(1., dtype=tf.float32))\n  path = '/some/network/path'\n  io_ops.save_v2([path], [\"a\"], [\"\"], [large])\n  restored = io_ops.restore_v2(path, [\"a\"], [\"\"], [tf.float32])\n  print(tf.reduce_sum(restored))\n\nif __name__ == '__main__':\n  tf.app.run()\n\nPrints:\ntf.Tensor(5e+09, shape=(), dtype=float32)\n\nI've tried this snippet on Mac OS X 10.14.1 + TF 1.12.0\nGot such error:\n\nrestored = io_ops.restore_v2(path, [\"a\"], [\"\"], [tf.float32])\n2018-11-08 17:27:05.767089: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Invalid argument: /Users/alex/HDD/Develop/tmp.data-00000-of-00001; Invalid argument\nTraceback (most recent call last):\nFile \"\", line 1, in \nFile \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1486, in restore_v2\nctx=_ctx)\nFile \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1511, in restore_v2_eager_fallback\nattrs=_attrs, ctx=_ctx, name=name)\nFile \"/usr/local/lib/python3.6/site-packages/tensorflow/python/eager/execute.py\", line 66, in quick_execute\nsix.raise_from(core._status_to_exception(e.code, message), None)\nFile \"\", line 3, in raise_from\ntensorflow.python.framework.errors_impl.InvalidArgumentError: /Users/alex/HDD/Develop/tmp.data-00000-of-00001; Invalid argument [Op:RestoreV2]", "body": "> We can put >2GB in checkpoints now. [b8c86c3#diff-f4340b63dcfb03e060905682f7471faa](https://github.com/tensorflow/tensorflow/commit/b8c86c3bbd8271ed968087f24e7fb704103bc733#diff-f4340b63dcfb03e060905682f7471faa) fixes an int32 size issue for string dtypes. I don't see a similar issue for Tensors, and this error doesn't look like it's a length/checksum issue. From \"OP_REQUIRES failed at save_restore_v2_ops.cc:184\" and reading the exceptions in the function it's calling, it looks vaguely like this could be complaining about a dtype mismatch? But that could just be the first thing that doesn't match if the whole file is corrupted for some reason.\r\n> \r\n> Can someone distill their issue into a snippet I can run, e.g. with fill()? I ran the following and it seems to work:\r\n> \r\n> ```\r\n> import tensorflow as tf\r\n> from tensorflow.python.ops import io_ops\r\n> \r\n> def main(_):\r\n>   tf.enable_eager_execution()\r\n>   large = tf.fill([10] * 9 + [5], value=tf.constant(1., dtype=tf.float32))\r\n>   path = '/some/network/path'\r\n>   io_ops.save_v2([path], [\"a\"], [\"\"], [large])\r\n>   restored = io_ops.restore_v2(path, [\"a\"], [\"\"], [tf.float32])\r\n>   print(tf.reduce_sum(restored))\r\n> \r\n> if __name__ == '__main__':\r\n>   tf.app.run()\r\n> ```\r\n> Prints:\r\n> \r\n> `tf.Tensor(5e+09, shape=(), dtype=float32)`\r\n\r\nI've tried this snippet on Mac OS X 10.14.1 + TF 1.12.0\r\nGot such error:\r\n\r\n> restored = io_ops.restore_v2(path, [\"a\"], [\"\"], [tf.float32])\r\n> 2018-11-08 17:27:05.767089: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at save_restore_v2_ops.cc:184 : Invalid argument: /Users/alex/HDD/Develop/tmp.data-00000-of-00001; Invalid argument\r\n> Traceback (most recent call last):\r\n>   File \"<stdin>\", line 1, in <module>\r\n>   File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1486, in restore_v2\r\n>     ctx=_ctx)\r\n>   File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1511, in restore_v2_eager_fallback\r\n>     attrs=_attrs, ctx=_ctx, name=name)\r\n>   File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/eager/execute.py\", line 66, in quick_execute\r\n>     six.raise_from(core._status_to_exception(e.code, message), None)\r\n>   File \"<string>\", line 3, in raise_from\r\n> tensorflow.python.framework.errors_impl.InvalidArgumentError: /Users/alex/HDD/Develop/tmp.data-00000-of-00001; Invalid argument [Op:RestoreV2]"}