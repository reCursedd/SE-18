{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/433206134", "html_url": "https://github.com/tensorflow/tensorflow/issues/216#issuecomment-433206134", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/216", "id": 433206134, "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzIwNjEzNA==", "user": {"login": "rueberger", "id": 8816362, "node_id": "MDQ6VXNlcjg4MTYzNjI=", "avatar_url": "https://avatars2.githubusercontent.com/u/8816362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rueberger", "html_url": "https://github.com/rueberger", "followers_url": "https://api.github.com/users/rueberger/followers", "following_url": "https://api.github.com/users/rueberger/following{/other_user}", "gists_url": "https://api.github.com/users/rueberger/gists{/gist_id}", "starred_url": "https://api.github.com/users/rueberger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rueberger/subscriptions", "organizations_url": "https://api.github.com/users/rueberger/orgs", "repos_url": "https://api.github.com/users/rueberger/repos", "events_url": "https://api.github.com/users/rueberger/events{/privacy}", "received_events_url": "https://api.github.com/users/rueberger/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-25T21:07:50Z", "updated_at": "2018-10-25T21:09:49Z", "author_association": "NONE", "body_html": "<p>Has there been any progress with this? I too find this to be a highly desirable feature.</p>\n<p>Couldn't it easily be implemented with tensordot and a transposition?   Like this:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">broadcasted_matmul</span>(<span class=\"pl-smi\">A</span>, <span class=\"pl-smi\">B</span>):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"</span> Matmul with fast broadcasting</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">    Args:</span>\n<span class=\"pl-s\">      A - [n, m]</span>\n<span class=\"pl-s\">      B - [batch_size, m, k]</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">    Returns:</span>\n<span class=\"pl-s\">      AB - [batch_size, n, k]</span>\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"</span></span>\n    <span class=\"pl-c\"><span class=\"pl-c\">#</span> [n, batch_size, k]</span>\n    <span class=\"pl-c1\">AB</span> <span class=\"pl-k\">=</span> tf.tensordot(A, B, <span class=\"pl-v\">axes</span><span class=\"pl-k\">=</span>[[<span class=\"pl-c1\">1</span>], [<span class=\"pl-c1\">1</span>]])\n    <span class=\"pl-c\"><span class=\"pl-c\">#</span> [batch_size, n, k]</span>\n    <span class=\"pl-k\">return</span> tf.tranpose(<span class=\"pl-c1\">AB</span>, [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">2</span>])</pre></div>", "body_text": "Has there been any progress with this? I too find this to be a highly desirable feature.\nCouldn't it easily be implemented with tensordot and a transposition?   Like this:\ndef broadcasted_matmul(A, B):\n    \"\"\" Matmul with fast broadcasting\n\n    Args:\n      A - [n, m]\n      B - [batch_size, m, k]\n\n    Returns:\n      AB - [batch_size, n, k]\n    \"\"\"\n    # [n, batch_size, k]\n    AB = tf.tensordot(A, B, axes=[[1], [1]])\n    # [batch_size, n, k]\n    return tf.tranpose(AB, [1, 0, 2])", "body": "Has there been any progress with this? I too find this to be a highly desirable feature. \r\n\r\nCouldn't it easily be implemented with tensordot and a transposition?   Like this:\r\n\r\n```python\r\ndef broadcasted_matmul(A, B):\r\n    \"\"\" Matmul with fast broadcasting\r\n\r\n    Args:\r\n      A - [n, m]\r\n      B - [batch_size, m, k]\r\n\r\n    Returns:\r\n      AB - [batch_size, n, k]\r\n    \"\"\"\r\n    # [n, batch_size, k]\r\n    AB = tf.tensordot(A, B, axes=[[1], [1]])\r\n    # [batch_size, n, k]\r\n    return tf.tranpose(AB, [1, 0, 2])\r\n```"}