{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12786", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12786/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12786/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12786/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/12786", "id": 254900430, "node_id": "MDExOlB1bGxSZXF1ZXN0MTM5MDYxNjYy", "number": 12786, "title": "Tensor roll op implementation", "user": {"login": "kobejean", "id": 3527868, "node_id": "MDQ6VXNlcjM1Mjc4Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/3527868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kobejean", "html_url": "https://github.com/kobejean", "followers_url": "https://api.github.com/users/kobejean/followers", "following_url": "https://api.github.com/users/kobejean/following{/other_user}", "gists_url": "https://api.github.com/users/kobejean/gists{/gist_id}", "starred_url": "https://api.github.com/users/kobejean/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kobejean/subscriptions", "organizations_url": "https://api.github.com/users/kobejean/orgs", "repos_url": "https://api.github.com/users/kobejean/repos", "events_url": "https://api.github.com/users/kobejean/events{/privacy}", "received_events_url": "https://api.github.com/users/kobejean/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "fef2c0", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2017-09-03T21:02:21Z", "updated_at": "2017-12-20T06:25:47Z", "closed_at": "2017-11-28T19:47:48Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/12786", "html_url": "https://github.com/tensorflow/tensorflow/pull/12786", "diff_url": "https://github.com/tensorflow/tensorflow/pull/12786.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/12786.patch"}, "body_html": "<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #10761.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"236454067\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10761\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10761/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10761\">#10761</a><br>\nAdded a tf.roll op that works similarly to numpy's np.roll. This was a feature requested in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"236454067\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10761\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10761/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10761\">#10761</a> and was marked as contributions welcome.</p>\n<h3>Usage:</h3>\n<p>Rolls the elements of a tensor by the offsets of <code>shift</code> along the dimensions<br>\nof <code>axis</code>. Elements that roll passed the last position will wrap around<br>\nto the first.<br>\nFor example:</p>\n<pre><code># 't' is [0, 1, 2, 3, 4]\nroll(t, shift=2, axis=0) ==&gt; [3, 4, 0, 1, 2]\n# shifting along multiple dimensions\n# 't' is [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]\nroll(t, shift=[1, -2], axis=[0, 1]) ==&gt; [[7, 8, 9, 5, 6], [2, 3, 4, 0, 1]]\n# shifting along the same axis multiple times\n# 't' is [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]\nroll(t, shift=[2, -3], axis=[1, 1]) ==&gt; [[1, 2, 3, 4, 0], [6, 7, 8, 9, 5]]\n</code></pre>\n<p>shift: <code>shift[i]</code> specifies the number of places by which elements are shifted<br>\nalong the dimension specified by <code>axis[i]</code>. Negative shifts will roll the<br>\nelements in the opposite direction.<br>\naxis: <code>axis[i]</code> specifies the dimension that the shift <code>shift[i]</code> should occur.<br>\nif the same axis is referenced more than once, the total shift for that axis<br>\nwill be the sum of all the shifts that belong to that axis.<br>\noutput: Has the same shape and size as the input. The elements are shifted by<br>\nthe offsets of <code>shift</code> along the dimensions of <code>axis</code>.</p>\n<h3>Unit tests:</h3>\n<pre><code>Running main() from test_main.cc\n[==========] Running 14 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 14 tests from RollOpTest\n[ RUN      ] RollOpTest.ScalarIndices\n2017-09-03 14:43:12.697389: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\n[       OK ] RollOpTest.ScalarIndices (10 ms)\n[ RUN      ] RollOpTest.ScalarIndices_Complex\n[       OK ] RollOpTest.ScalarIndices_Complex (0 ms)\n[ RUN      ] RollOpTest.Simple_TwoD32\n[       OK ] RollOpTest.Simple_TwoD32 (0 ms)\n[ RUN      ] RollOpTest.Simple_ThreeD32\n[       OK ] RollOpTest.Simple_ThreeD32 (0 ms)\n[ RUN      ] RollOpTest.Simple_TwoD64\n[       OK ] RollOpTest.Simple_TwoD64 (0 ms)\n[ RUN      ] RollOpTest.Simple_ThreeD64\n[       OK ] RollOpTest.Simple_ThreeD64 (0 ms)\n[ RUN      ] RollOpTest.ZeroShift_ThreeD32\n[       OK ] RollOpTest.ZeroShift_ThreeD32 (0 ms)\n[ RUN      ] RollOpTest.ZeroSize_ThreeD32\n[       OK ] RollOpTest.ZeroSize_ThreeD32 (0 ms)\n[ RUN      ] RollOpTest.DuplicateShifts_TwoD32\n[       OK ] RollOpTest.DuplicateShifts_TwoD32 (1 ms)\n[ RUN      ] RollOpTest.Error_InputMustBeVectorOrHigher\n[       OK ] RollOpTest.Error_InputMustBeVectorOrHigher (0 ms)\n[ RUN      ] RollOpTest.Error_AxisMustBeScalarOrVector\n[       OK ] RollOpTest.Error_AxisMustBeScalarOrVector (0 ms)\n[ RUN      ] RollOpTest.Error_ShiftMustBeScalarOrVector\n[       OK ] RollOpTest.Error_ShiftMustBeScalarOrVector (0 ms)\n[ RUN      ] RollOpTest.Error_ShiftAndAxisMustBeSameSize\n[       OK ] RollOpTest.Error_ShiftAndAxisMustBeSameSize (0 ms)\n[ RUN      ] RollOpTest.Error_AxisOutOfRange\n[       OK ] RollOpTest.Error_AxisOutOfRange (0 ms)\n[----------] 14 tests from RollOpTest (11 ms total)\n\n[----------] Global test environment tear-down\n[==========] 14 tests from 1 test case ran. (11 ms total)\n[  PASSED  ] 14 tests.\n</code></pre>\n<h3>Benchmarks:</h3>\n<pre><code>Running main() from test_main.cc\nBenchmark                     Time(ns) Iterations\n-------------------------------------------------\n2017-09-03 14:44:03.626696: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\nBM_cpu_roll_outer/256/256        50332      15930\t 5208.3MB/s 1302.1M items/s\nBM_cpu_roll_outer/512/512       123096       4603\t 8518.3MB/s 2129.6M items/s\nBM_cpu_roll_outer/1024/1024     689598       1085\t 6082.2MB/s 1520.6M items/s\nBM_cpu_roll_outer/2048/2048    5394380        100\t 3110.1MB/s 777.5M items/s\nBM_cpu_roll_all/256/256          42984      16130\t 6098.7MB/s 1524.7M items/s\nBM_cpu_roll_all/512/512          96114       6405\t 10909.7MB/s 2727.4M items/s\nBM_cpu_roll_all/1024/1024       622506       1000\t 6737.8MB/s 1684.4M items/s\nBM_cpu_roll_all/2048/2048      5073920        100\t 3306.6MB/s 826.6M items/s\n</code></pre>\n<p>I also tried to implement this op for the GPU but gave up on it after struggling with it for a week. This is the error I received:</p>\n<pre><code>2017-09-03 20:21:33.871843: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-09-03 20:21:33.872374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Found device 0 with properties: \nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1e.0\ntotalMemory: 11.17GiB freeMemory: 11.11GiB\n2017-09-03 20:21:33.872433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1055] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\n2017-09-03 20:21:35.386734: E tensorflow/stream_executor/cuda/cuda_driver.cc:1110] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_ADDRESS :: No stack trace available\n2017-09-03 20:21:35.386839: F tensorflow/core/common_runtime/kernel_benchmark_testlib.cc:164] Non-OK-status: device_-&gt;Sync() status: Internal: GPU sync failed\nAborted (core dumped)\n</code></pre>\n<p>If anyone has a clue of what might be the problem, I'd appreciate the help. The code for the gpu implementation is on this branch on my fork: <a class=\"commit-link\" href=\"https://github.com/tensorflow/tensorflow/compare/master...kobejean:roll-op-gpu\"><tt>master...kobejean:roll-op-gpu</tt></a></p>\n<p>Thanks!</p>", "body_text": "Closes #10761\nAdded a tf.roll op that works similarly to numpy's np.roll. This was a feature requested in #10761 and was marked as contributions welcome.\nUsage:\nRolls the elements of a tensor by the offsets of shift along the dimensions\nof axis. Elements that roll passed the last position will wrap around\nto the first.\nFor example:\n# 't' is [0, 1, 2, 3, 4]\nroll(t, shift=2, axis=0) ==> [3, 4, 0, 1, 2]\n# shifting along multiple dimensions\n# 't' is [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]\nroll(t, shift=[1, -2], axis=[0, 1]) ==> [[7, 8, 9, 5, 6], [2, 3, 4, 0, 1]]\n# shifting along the same axis multiple times\n# 't' is [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]\nroll(t, shift=[2, -3], axis=[1, 1]) ==> [[1, 2, 3, 4, 0], [6, 7, 8, 9, 5]]\n\nshift: shift[i] specifies the number of places by which elements are shifted\nalong the dimension specified by axis[i]. Negative shifts will roll the\nelements in the opposite direction.\naxis: axis[i] specifies the dimension that the shift shift[i] should occur.\nif the same axis is referenced more than once, the total shift for that axis\nwill be the sum of all the shifts that belong to that axis.\noutput: Has the same shape and size as the input. The elements are shifted by\nthe offsets of shift along the dimensions of axis.\nUnit tests:\nRunning main() from test_main.cc\n[==========] Running 14 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 14 tests from RollOpTest\n[ RUN      ] RollOpTest.ScalarIndices\n2017-09-03 14:43:12.697389: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\n[       OK ] RollOpTest.ScalarIndices (10 ms)\n[ RUN      ] RollOpTest.ScalarIndices_Complex\n[       OK ] RollOpTest.ScalarIndices_Complex (0 ms)\n[ RUN      ] RollOpTest.Simple_TwoD32\n[       OK ] RollOpTest.Simple_TwoD32 (0 ms)\n[ RUN      ] RollOpTest.Simple_ThreeD32\n[       OK ] RollOpTest.Simple_ThreeD32 (0 ms)\n[ RUN      ] RollOpTest.Simple_TwoD64\n[       OK ] RollOpTest.Simple_TwoD64 (0 ms)\n[ RUN      ] RollOpTest.Simple_ThreeD64\n[       OK ] RollOpTest.Simple_ThreeD64 (0 ms)\n[ RUN      ] RollOpTest.ZeroShift_ThreeD32\n[       OK ] RollOpTest.ZeroShift_ThreeD32 (0 ms)\n[ RUN      ] RollOpTest.ZeroSize_ThreeD32\n[       OK ] RollOpTest.ZeroSize_ThreeD32 (0 ms)\n[ RUN      ] RollOpTest.DuplicateShifts_TwoD32\n[       OK ] RollOpTest.DuplicateShifts_TwoD32 (1 ms)\n[ RUN      ] RollOpTest.Error_InputMustBeVectorOrHigher\n[       OK ] RollOpTest.Error_InputMustBeVectorOrHigher (0 ms)\n[ RUN      ] RollOpTest.Error_AxisMustBeScalarOrVector\n[       OK ] RollOpTest.Error_AxisMustBeScalarOrVector (0 ms)\n[ RUN      ] RollOpTest.Error_ShiftMustBeScalarOrVector\n[       OK ] RollOpTest.Error_ShiftMustBeScalarOrVector (0 ms)\n[ RUN      ] RollOpTest.Error_ShiftAndAxisMustBeSameSize\n[       OK ] RollOpTest.Error_ShiftAndAxisMustBeSameSize (0 ms)\n[ RUN      ] RollOpTest.Error_AxisOutOfRange\n[       OK ] RollOpTest.Error_AxisOutOfRange (0 ms)\n[----------] 14 tests from RollOpTest (11 ms total)\n\n[----------] Global test environment tear-down\n[==========] 14 tests from 1 test case ran. (11 ms total)\n[  PASSED  ] 14 tests.\n\nBenchmarks:\nRunning main() from test_main.cc\nBenchmark                     Time(ns) Iterations\n-------------------------------------------------\n2017-09-03 14:44:03.626696: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\nBM_cpu_roll_outer/256/256        50332      15930\t 5208.3MB/s 1302.1M items/s\nBM_cpu_roll_outer/512/512       123096       4603\t 8518.3MB/s 2129.6M items/s\nBM_cpu_roll_outer/1024/1024     689598       1085\t 6082.2MB/s 1520.6M items/s\nBM_cpu_roll_outer/2048/2048    5394380        100\t 3110.1MB/s 777.5M items/s\nBM_cpu_roll_all/256/256          42984      16130\t 6098.7MB/s 1524.7M items/s\nBM_cpu_roll_all/512/512          96114       6405\t 10909.7MB/s 2727.4M items/s\nBM_cpu_roll_all/1024/1024       622506       1000\t 6737.8MB/s 1684.4M items/s\nBM_cpu_roll_all/2048/2048      5073920        100\t 3306.6MB/s 826.6M items/s\n\nI also tried to implement this op for the GPU but gave up on it after struggling with it for a week. This is the error I received:\n2017-09-03 20:21:33.871843: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-09-03 20:21:33.872374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Found device 0 with properties: \nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\npciBusID: 0000:00:1e.0\ntotalMemory: 11.17GiB freeMemory: 11.11GiB\n2017-09-03 20:21:33.872433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1055] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\n2017-09-03 20:21:35.386734: E tensorflow/stream_executor/cuda/cuda_driver.cc:1110] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_ADDRESS :: No stack trace available\n2017-09-03 20:21:35.386839: F tensorflow/core/common_runtime/kernel_benchmark_testlib.cc:164] Non-OK-status: device_->Sync() status: Internal: GPU sync failed\nAborted (core dumped)\n\nIf anyone has a clue of what might be the problem, I'd appreciate the help. The code for the gpu implementation is on this branch on my fork: master...kobejean:roll-op-gpu\nThanks!", "body": "Closes #10761\r\nAdded a tf.roll op that works similarly to numpy's np.roll. This was a feature requested in #10761 and was marked as contributions welcome.\r\n\r\n### Usage:\r\n\r\nRolls the elements of a tensor by the offsets of `shift` along the dimensions\r\nof `axis`. Elements that roll passed the last position will wrap around\r\nto the first.\r\nFor example:\r\n```\r\n# 't' is [0, 1, 2, 3, 4]\r\nroll(t, shift=2, axis=0) ==> [3, 4, 0, 1, 2]\r\n# shifting along multiple dimensions\r\n# 't' is [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]\r\nroll(t, shift=[1, -2], axis=[0, 1]) ==> [[7, 8, 9, 5, 6], [2, 3, 4, 0, 1]]\r\n# shifting along the same axis multiple times\r\n# 't' is [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9]]\r\nroll(t, shift=[2, -3], axis=[1, 1]) ==> [[1, 2, 3, 4, 0], [6, 7, 8, 9, 5]]\r\n```\r\nshift: `shift[i]` specifies the number of places by which elements are shifted\r\n  along the dimension specified by `axis[i]`. Negative shifts will roll the\r\n  elements in the opposite direction.\r\naxis: `axis[i]` specifies the dimension that the shift `shift[i]` should occur.\r\n  if the same axis is referenced more than once, the total shift for that axis\r\n  will be the sum of all the shifts that belong to that axis.\r\noutput: Has the same shape and size as the input. The elements are shifted by\r\n  the offsets of `shift` along the dimensions of `axis`.\r\n\r\n### Unit tests:\r\n```\r\nRunning main() from test_main.cc\r\n[==========] Running 14 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 14 tests from RollOpTest\r\n[ RUN      ] RollOpTest.ScalarIndices\r\n2017-09-03 14:43:12.697389: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\r\n[       OK ] RollOpTest.ScalarIndices (10 ms)\r\n[ RUN      ] RollOpTest.ScalarIndices_Complex\r\n[       OK ] RollOpTest.ScalarIndices_Complex (0 ms)\r\n[ RUN      ] RollOpTest.Simple_TwoD32\r\n[       OK ] RollOpTest.Simple_TwoD32 (0 ms)\r\n[ RUN      ] RollOpTest.Simple_ThreeD32\r\n[       OK ] RollOpTest.Simple_ThreeD32 (0 ms)\r\n[ RUN      ] RollOpTest.Simple_TwoD64\r\n[       OK ] RollOpTest.Simple_TwoD64 (0 ms)\r\n[ RUN      ] RollOpTest.Simple_ThreeD64\r\n[       OK ] RollOpTest.Simple_ThreeD64 (0 ms)\r\n[ RUN      ] RollOpTest.ZeroShift_ThreeD32\r\n[       OK ] RollOpTest.ZeroShift_ThreeD32 (0 ms)\r\n[ RUN      ] RollOpTest.ZeroSize_ThreeD32\r\n[       OK ] RollOpTest.ZeroSize_ThreeD32 (0 ms)\r\n[ RUN      ] RollOpTest.DuplicateShifts_TwoD32\r\n[       OK ] RollOpTest.DuplicateShifts_TwoD32 (1 ms)\r\n[ RUN      ] RollOpTest.Error_InputMustBeVectorOrHigher\r\n[       OK ] RollOpTest.Error_InputMustBeVectorOrHigher (0 ms)\r\n[ RUN      ] RollOpTest.Error_AxisMustBeScalarOrVector\r\n[       OK ] RollOpTest.Error_AxisMustBeScalarOrVector (0 ms)\r\n[ RUN      ] RollOpTest.Error_ShiftMustBeScalarOrVector\r\n[       OK ] RollOpTest.Error_ShiftMustBeScalarOrVector (0 ms)\r\n[ RUN      ] RollOpTest.Error_ShiftAndAxisMustBeSameSize\r\n[       OK ] RollOpTest.Error_ShiftAndAxisMustBeSameSize (0 ms)\r\n[ RUN      ] RollOpTest.Error_AxisOutOfRange\r\n[       OK ] RollOpTest.Error_AxisOutOfRange (0 ms)\r\n[----------] 14 tests from RollOpTest (11 ms total)\r\n\r\n[----------] Global test environment tear-down\r\n[==========] 14 tests from 1 test case ran. (11 ms total)\r\n[  PASSED  ] 14 tests.\r\n```\r\n\r\n### Benchmarks:\r\n```\r\nRunning main() from test_main.cc\r\nBenchmark                     Time(ns) Iterations\r\n-------------------------------------------------\r\n2017-09-03 14:44:03.626696: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA\r\nBM_cpu_roll_outer/256/256        50332      15930\t 5208.3MB/s 1302.1M items/s\r\nBM_cpu_roll_outer/512/512       123096       4603\t 8518.3MB/s 2129.6M items/s\r\nBM_cpu_roll_outer/1024/1024     689598       1085\t 6082.2MB/s 1520.6M items/s\r\nBM_cpu_roll_outer/2048/2048    5394380        100\t 3110.1MB/s 777.5M items/s\r\nBM_cpu_roll_all/256/256          42984      16130\t 6098.7MB/s 1524.7M items/s\r\nBM_cpu_roll_all/512/512          96114       6405\t 10909.7MB/s 2727.4M items/s\r\nBM_cpu_roll_all/1024/1024       622506       1000\t 6737.8MB/s 1684.4M items/s\r\nBM_cpu_roll_all/2048/2048      5073920        100\t 3306.6MB/s 826.6M items/s\r\n```\r\n\r\nI also tried to implement this op for the GPU but gave up on it after struggling with it for a week. This is the error I received:\r\n```\r\n2017-09-03 20:21:33.871843: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2017-09-03 20:21:33.872374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Found device 0 with properties: \r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1e.0\r\ntotalMemory: 11.17GiB freeMemory: 11.11GiB\r\n2017-09-03 20:21:33.872433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1055] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\n2017-09-03 20:21:35.386734: E tensorflow/stream_executor/cuda/cuda_driver.cc:1110] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_ADDRESS :: No stack trace available\r\n2017-09-03 20:21:35.386839: F tensorflow/core/common_runtime/kernel_benchmark_testlib.cc:164] Non-OK-status: device_->Sync() status: Internal: GPU sync failed\r\nAborted (core dumped)\r\n```\r\nIf anyone has a clue of what might be the problem, I'd appreciate the help. The code for the gpu implementation is on this branch on my fork: https://github.com/tensorflow/tensorflow/compare/master...kobejean:roll-op-gpu \r\n\r\nThanks!"}