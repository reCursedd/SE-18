{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/272441127", "html_url": "https://github.com/tensorflow/tensorflow/issues/152#issuecomment-272441127", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/152", "id": 272441127, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjQ0MTEyNw==", "user": {"login": "casiciaco", "id": 2345400, "node_id": "MDQ6VXNlcjIzNDU0MDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/2345400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/casiciaco", "html_url": "https://github.com/casiciaco", "followers_url": "https://api.github.com/users/casiciaco/followers", "following_url": "https://api.github.com/users/casiciaco/following{/other_user}", "gists_url": "https://api.github.com/users/casiciaco/gists{/gist_id}", "starred_url": "https://api.github.com/users/casiciaco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/casiciaco/subscriptions", "organizations_url": "https://api.github.com/users/casiciaco/orgs", "repos_url": "https://api.github.com/users/casiciaco/repos", "events_url": "https://api.github.com/users/casiciaco/events{/privacy}", "received_events_url": "https://api.github.com/users/casiciaco/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-13T13:19:42Z", "updated_at": "2017-01-13T13:19:42Z", "author_association": "NONE", "body_html": "<p>Actually, this also fails in the above example:</p>\n<pre><code> CUDA_VISIBLE_DEVICES=1 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so.7.5 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so.7.5 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so.7.5 locally\nE tensorflow/core/common_runtime/direct_session.cc:135] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_INVALID_DEVICE\n...\ntensorflow.python.framework.errors_impl.InternalError: Failed to create session.\n</code></pre>\n<p>but</p>\n<pre><code>CUDA_VISIBLE_DEVICES=8 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\n</code></pre>\n<p>and</p>\n<pre><code>CUDA_VISIBLE_DEVICES=15 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\n</code></pre>\n<p>work.</p>\n<p>Note that the same happens with the new ConfigProto options: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"147834996\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1888\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1888/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1888\">#1888</a></p>\n<pre><code>python2.7 -c \"import tensorflow as tf; config_proto = tf.ConfigProto(); config_proto.gpu_options.visible_device_list=\\\"1\\\"; tf.Session(config=config_proto)\"\n</code></pre>\n<p>doesn't work but</p>\n<pre><code>python2.7 -c \"import tensorflow as tf; config_proto = tf.ConfigProto(); config_proto.gpu_options.visible_device_list=\\\"8\\\"; tf.Session(config=config_proto)\"\n</code></pre>\n<p>works.</p>", "body_text": "Actually, this also fails in the above example:\n CUDA_VISIBLE_DEVICES=1 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so.7.5 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so.7.5 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so.7.5 locally\nE tensorflow/core/common_runtime/direct_session.cc:135] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_INVALID_DEVICE\n...\ntensorflow.python.framework.errors_impl.InternalError: Failed to create session.\n\nbut\nCUDA_VISIBLE_DEVICES=8 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\n\nand\nCUDA_VISIBLE_DEVICES=15 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\n\nwork.\nNote that the same happens with the new ConfigProto options: #1888\npython2.7 -c \"import tensorflow as tf; config_proto = tf.ConfigProto(); config_proto.gpu_options.visible_device_list=\\\"1\\\"; tf.Session(config=config_proto)\"\n\ndoesn't work but\npython2.7 -c \"import tensorflow as tf; config_proto = tf.ConfigProto(); config_proto.gpu_options.visible_device_list=\\\"8\\\"; tf.Session(config=config_proto)\"\n\nworks.", "body": "Actually, this also fails in the above example:\r\n```\r\n CUDA_VISIBLE_DEVICES=1 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so.7.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so.7.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so.7.5 locally\r\nE tensorflow/core/common_runtime/direct_session.cc:135] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_INVALID_DEVICE\r\n...\r\ntensorflow.python.framework.errors_impl.InternalError: Failed to create session.\r\n```\r\nbut\r\n```\r\nCUDA_VISIBLE_DEVICES=8 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\r\n```\r\nand\r\n```\r\nCUDA_VISIBLE_DEVICES=15 python2.7 -c \"import tensorflow as tf;tf.InteractiveSession()\"\r\n```\r\nwork.\r\n\r\nNote that the same happens with the new ConfigProto options: https://github.com/tensorflow/tensorflow/issues/1888\r\n```\r\npython2.7 -c \"import tensorflow as tf; config_proto = tf.ConfigProto(); config_proto.gpu_options.visible_device_list=\\\"1\\\"; tf.Session(config=config_proto)\"\r\n```\r\ndoesn't work but\r\n```\r\npython2.7 -c \"import tensorflow as tf; config_proto = tf.ConfigProto(); config_proto.gpu_options.visible_device_list=\\\"8\\\"; tf.Session(config=config_proto)\"\r\n``` \r\nworks."}