{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23085", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23085/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23085/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23085/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23085", "id": 371734751, "node_id": "MDU6SXNzdWUzNzE3MzQ3NTE=", "number": 23085, "title": "Problem when try to decode some bmp images with tf.image.decode_bmp", "user": {"login": "VenkateshSatagopan", "id": 43298706, "node_id": "MDQ6VXNlcjQzMjk4NzA2", "avatar_url": "https://avatars3.githubusercontent.com/u/43298706?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VenkateshSatagopan", "html_url": "https://github.com/VenkateshSatagopan", "followers_url": "https://api.github.com/users/VenkateshSatagopan/followers", "following_url": "https://api.github.com/users/VenkateshSatagopan/following{/other_user}", "gists_url": "https://api.github.com/users/VenkateshSatagopan/gists{/gist_id}", "starred_url": "https://api.github.com/users/VenkateshSatagopan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VenkateshSatagopan/subscriptions", "organizations_url": "https://api.github.com/users/VenkateshSatagopan/orgs", "repos_url": "https://api.github.com/users/VenkateshSatagopan/repos", "events_url": "https://api.github.com/users/VenkateshSatagopan/events{/privacy}", "received_events_url": "https://api.github.com/users/VenkateshSatagopan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false}], "state": "open", "locked": false, "assignee": {"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-10-18T22:14:56Z", "updated_at": "2018-11-10T15:28:46Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><em>Please make sure that this is a bug. As per our <a href=\"https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md\">GitHub Policy</a>, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em></p>\n<p><strong>System information</strong></p>\n<ul>\n<li>Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No</li>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04</li>\n<li>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:NA</li>\n<li>TensorFlow installed from (source or binary): PIP</li>\n<li>TensorFlow version (use command below):1.12</li>\n<li>Python version:3.6</li>\n<li>Bazel version (if compiling from source):No</li>\n<li>GCC/Compiler version (if compiling from source):</li>\n<li>CUDA/cuDNN version NO</li>\n<li>GPU model and memory: Not using GPU</li>\n</ul>\n<p>You can collect some of this information using our environment capture <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\">script</a><br>\nYou can also obtain the TensorFlow version with<br>\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"</p>\n<p><strong>Describe the current behavior</strong><br>\nHi,<br>\nI have written a python script to read bmp image from local drive using tensorflow and trying to display the image.</p>\n<p>First case:<br>\nI am getting error when i try to use the<br>\nbelow command - tf.image.decode_bmp(image_string,channels=3)</p>\n<p>The error is as below:</p>\n<p>Traceback (most recent call last):<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call<br>\nreturn fn(*args)<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn<br>\noptions, feed_dict, fetch_list, target_list, run_metadata)<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun<br>\nrun_metadata)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: channels attribute 3 does not match bits per pixel from file 4<br>\n[[{{node DecodeBmp}} = DecodeBmp<a href=\"ReadFile\">channels=3</a>]]<br>\n[[{{node IteratorGetNext}} = IteratorGetNext<a href=\"OneShotIterator\">output_shapes=[[?,?,3]], output_types=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"/home/venkatesh/Desktop/Image_processing_thesis/Thesis_deep_learning/problem_tensorfile.py\", line 38, in <br>\nres = sess.run(patches)<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 929, in run<br>\nrun_metadata_ptr)<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1152, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run<br>\nrun_metadata)<br>\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: channels attribute 3 does not match bits per pixel from file 4<br>\n[[{{node DecodeBmp}} = DecodeBmp<a href=\"ReadFile\">channels=3</a>]]<br>\n[[node IteratorGetNext (defined at /home/venkatesh/Desktop/Image_processing_thesis/Thesis_deep_learning/problem_tensorfile.py:35)  = IteratorGetNext<a href=\"OneShotIterator\">output_shapes=[[?,?,3]], output_types=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n<p>Process finished with exit code 1</p>\n<p>Second case:<br>\nIf i use the command tf.image.decode_bmp(image_string) instead of tf.image.decode_bmp(image_string,channels=3)</p>\n<p>I am not getting error but when i see the shape , it's showing the no of channels =4 and not 3.  I want to know why I am getting shape =4 for the second case and why getting error for some images for the first case.</p>\n<p>For example consider 00001.bmp Image(attached in attachments) size:<br>\nHeight=351<br>\nWidth=572<br>\nchannels=3<br>\nis getting shape(351,572,4) for the second case.</p>\n<p>Additionally<br>\nAll the images works fine without tensorflow<br>\nFor example: I used scipy to read the image and try to print the shapes of all images in which the no of channels are 3 and not 4.</p>\n<p>The image which i used is one of the images form waterloo exploratory dataset. In the first 50 images i have faced the above issue for 5 images and tf.image.decode_bmp works for remaining 45 images.</p>\n<p>Please use the below link if you like to download the waterloo exploratory dataset :<br>\n<a href=\"url\">https://ece.uwaterloo.ca/~k29ma/exploration/</a><br>\n<strong>Describe the expected behavior</strong><br>\nRequires information about why the above error is getting displayed for some of bmp images.</p>\n<p><strong>Code to reproduce the issue</strong><br>\nimport tensorflow as tf<br>\nimport numpy as np<br>\nfrom scipy import misc<br>\nimport glob<br>\nimport os<br>\n#Command to extract all file names<br>\nlist_ground_truth=glob.glob(\"Truth_Images/*.bmp\")</p>\n<p>num_parallel_calls=4</p>\n<p>def parse_fn(filename):<br>\n\"\"\"Decode the jpeg image from the filename and convert to [0, 1].\"\"\"<br>\nimage_string = tf.read_file(filename)<br>\nimage_decoded = tf.image.decode_bmp(image_string,channels=3)<br>\n#print(image_decoded.get_shape().dims)<br>\n# This will convert to float values in [0, 1]<br>\nimage = tf.image.convert_image_dtype(image_decoded, tf.float32)<br>\nreturn image</p>\n<h1>Create a dataset</h1>\n<p>dataset = (tf.data.Dataset.from_tensor_slices(list_ground_truth)<br>\n.map(parse_fn, num_parallel_calls=num_parallel_calls)<br>\n.prefetch(1))</p>\n<p>iterator = dataset.make_one_shot_iterator()<br>\npatches = iterator.get_next()<br>\nsess = tf.Session()<br>\nres = sess.run(patches)<br>\nprint(res.shape)<br>\nmisc.imshow(res)<br>\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.</p>\n<ol>\n<li>Load the above script.</li>\n<li>Change the location in the below command to where the image file which i have attached<br>\nlist_ground_truth=glob.glob(\"Truth_Images/*.bmp\")<br>\n3.Run the script and if it runs without error.</li>\n</ol>\n<p><a href=\"https://github.com/tensorflow/tensorflow/files/2493751/problem_files.zip\">problem_files.zip</a></p>\n<p><strong>Other info / logs</strong><br>\nAdditional information:<br>\nI am trying the process as part of initial data preparation for training a convolutional network. To make it simple i have removed the unnecessary steps for recreating the issue.</p>\n<p>Thanks,<br>\nVenkatesh.S<br>\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.</p>", "body_text": "Please make sure that this is a bug. As per our GitHub Policy, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:NA\nTensorFlow installed from (source or binary): PIP\nTensorFlow version (use command below):1.12\nPython version:3.6\nBazel version (if compiling from source):No\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version NO\nGPU model and memory: Not using GPU\n\nYou can collect some of this information using our environment capture script\nYou can also obtain the TensorFlow version with\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\nDescribe the current behavior\nHi,\nI have written a python script to read bmp image from local drive using tensorflow and trying to display the image.\nFirst case:\nI am getting error when i try to use the\nbelow command - tf.image.decode_bmp(image_string,channels=3)\nThe error is as below:\nTraceback (most recent call last):\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\nreturn fn(*args)\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\noptions, feed_dict, fetch_list, target_list, run_metadata)\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\nrun_metadata)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: channels attribute 3 does not match bits per pixel from file 4\n[[{{node DecodeBmp}} = DecodeBmpchannels=3]]\n[[{{node IteratorGetNext}} = IteratorGetNextoutput_shapes=[[?,?,3]], output_types=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"/home/venkatesh/Desktop/Image_processing_thesis/Thesis_deep_learning/problem_tensorfile.py\", line 38, in \nres = sess.run(patches)\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 929, in run\nrun_metadata_ptr)\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\nrun_metadata)\nFile \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: channels attribute 3 does not match bits per pixel from file 4\n[[{{node DecodeBmp}} = DecodeBmpchannels=3]]\n[[node IteratorGetNext (defined at /home/venkatesh/Desktop/Image_processing_thesis/Thesis_deep_learning/problem_tensorfile.py:35)  = IteratorGetNextoutput_shapes=[[?,?,3]], output_types=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\nProcess finished with exit code 1\nSecond case:\nIf i use the command tf.image.decode_bmp(image_string) instead of tf.image.decode_bmp(image_string,channels=3)\nI am not getting error but when i see the shape , it's showing the no of channels =4 and not 3.  I want to know why I am getting shape =4 for the second case and why getting error for some images for the first case.\nFor example consider 00001.bmp Image(attached in attachments) size:\nHeight=351\nWidth=572\nchannels=3\nis getting shape(351,572,4) for the second case.\nAdditionally\nAll the images works fine without tensorflow\nFor example: I used scipy to read the image and try to print the shapes of all images in which the no of channels are 3 and not 4.\nThe image which i used is one of the images form waterloo exploratory dataset. In the first 50 images i have faced the above issue for 5 images and tf.image.decode_bmp works for remaining 45 images.\nPlease use the below link if you like to download the waterloo exploratory dataset :\nhttps://ece.uwaterloo.ca/~k29ma/exploration/\nDescribe the expected behavior\nRequires information about why the above error is getting displayed for some of bmp images.\nCode to reproduce the issue\nimport tensorflow as tf\nimport numpy as np\nfrom scipy import misc\nimport glob\nimport os\n#Command to extract all file names\nlist_ground_truth=glob.glob(\"Truth_Images/*.bmp\")\nnum_parallel_calls=4\ndef parse_fn(filename):\n\"\"\"Decode the jpeg image from the filename and convert to [0, 1].\"\"\"\nimage_string = tf.read_file(filename)\nimage_decoded = tf.image.decode_bmp(image_string,channels=3)\n#print(image_decoded.get_shape().dims)\n# This will convert to float values in [0, 1]\nimage = tf.image.convert_image_dtype(image_decoded, tf.float32)\nreturn image\nCreate a dataset\ndataset = (tf.data.Dataset.from_tensor_slices(list_ground_truth)\n.map(parse_fn, num_parallel_calls=num_parallel_calls)\n.prefetch(1))\niterator = dataset.make_one_shot_iterator()\npatches = iterator.get_next()\nsess = tf.Session()\nres = sess.run(patches)\nprint(res.shape)\nmisc.imshow(res)\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\n\nLoad the above script.\nChange the location in the below command to where the image file which i have attached\nlist_ground_truth=glob.glob(\"Truth_Images/*.bmp\")\n3.Run the script and if it runs without error.\n\nproblem_files.zip\nOther info / logs\nAdditional information:\nI am trying the process as part of initial data preparation for training a convolutional network. To make it simple i have removed the unnecessary steps for recreating the issue.\nThanks,\nVenkatesh.S\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:NA\r\n- TensorFlow installed from (source or binary): PIP\r\n- TensorFlow version (use command below):1.12\r\n- Python version:3.6\r\n- Bazel version (if compiling from source):No\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version NO\r\n- GPU model and memory: Not using GPU\r\n\r\n\r\nYou can collect some of this information using our environment capture [script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n**Describe the current behavior**\r\nHi,\r\nI have written a python script to read bmp image from local drive using tensorflow and trying to display the image. \r\n\r\nFirst case:\r\nI am getting error when i try to use the \r\nbelow command - tf.image.decode_bmp(image_string,channels=3)\r\n\r\nThe error is as below:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: channels attribute 3 does not match bits per pixel from file 4\r\n\t [[{{node DecodeBmp}} = DecodeBmp[channels=3](ReadFile)]]\r\n\t [[{{node IteratorGetNext}} = IteratorGetNext[output_shapes=[[?,?,3]], output_types=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](OneShotIterator)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/venkatesh/Desktop/Image_processing_thesis/Thesis_deep_learning/problem_tensorfile.py\", line 38, in <module>\r\n    res = sess.run(patches)\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/venkatesh/anaconda3/envs/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: channels attribute 3 does not match bits per pixel from file 4\r\n\t [[{{node DecodeBmp}} = DecodeBmp[channels=3](ReadFile)]]\r\n\t [[node IteratorGetNext (defined at /home/venkatesh/Desktop/Image_processing_thesis/Thesis_deep_learning/problem_tensorfile.py:35)  = IteratorGetNext[output_shapes=[[?,?,3]], output_types=[DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](OneShotIterator)]]\r\n\r\nProcess finished with exit code 1\r\n\r\nSecond case:\r\nIf i use the command tf.image.decode_bmp(image_string) instead of tf.image.decode_bmp(image_string,channels=3) \r\n\r\nI am not getting error but when i see the shape , it's showing the no of channels =4 and not 3.  I want to know why I am getting shape =4 for the second case and why getting error for some images for the first case.\r\n\r\nFor example consider 00001.bmp Image(attached in attachments) size:\r\nHeight=351\r\nWidth=572\r\nchannels=3\r\nis getting shape(351,572,4) for the second case.\r\n\r\nAdditionally\r\nAll the images works fine without tensorflow\r\nFor example: I used scipy to read the image and try to print the shapes of all images in which the no of channels are 3 and not 4.\r\n\r\nThe image which i used is one of the images form waterloo exploratory dataset. In the first 50 images i have faced the above issue for 5 images and tf.image.decode_bmp works for remaining 45 images.\r\n\r\nPlease use the below link if you like to download the waterloo exploratory dataset :\r\n[https://ece.uwaterloo.ca/~k29ma/exploration/](url)\r\n**Describe the expected behavior**\r\nRequires information about why the above error is getting displayed for some of bmp images.\r\n\r\n**Code to reproduce the issue**\r\nimport tensorflow as tf\r\nimport numpy as np\r\nfrom scipy import misc\r\nimport glob\r\nimport os\r\n#Command to extract all file names\r\nlist_ground_truth=glob.glob(\"Truth_Images/*.bmp\")  \r\n\r\nnum_parallel_calls=4\r\n\r\ndef parse_fn(filename):\r\n    \"\"\"Decode the jpeg image from the filename and convert to [0, 1].\"\"\"\r\n    image_string = tf.read_file(filename)\r\n    image_decoded = tf.image.decode_bmp(image_string,channels=3)\r\n    #print(image_decoded.get_shape().dims)\r\n    # This will convert to float values in [0, 1]\r\n    image = tf.image.convert_image_dtype(image_decoded, tf.float32)\r\n    return image\r\n\r\n\r\n# Create a dataset\r\ndataset = (tf.data.Dataset.from_tensor_slices(list_ground_truth)\r\n           .map(parse_fn, num_parallel_calls=num_parallel_calls)\r\n           .prefetch(1))\r\n\r\n\r\niterator = dataset.make_one_shot_iterator()\r\npatches = iterator.get_next()\r\nsess = tf.Session()\r\nres = sess.run(patches)\r\nprint(res.shape)\r\nmisc.imshow(res)\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n1. Load the above script. \r\n2. Change the location in the below command to where the image file which i have attached \r\nlist_ground_truth=glob.glob(\"Truth_Images/*.bmp\")  \r\n3.Run the script and if it runs without error.\r\n\r\n[problem_files.zip](https://github.com/tensorflow/tensorflow/files/2493751/problem_files.zip)\r\n\r\n**Other info / logs**\r\nAdditional information:\r\nI am trying the process as part of initial data preparation for training a convolutional network. To make it simple i have removed the unnecessary steps for recreating the issue.\r\n\r\nThanks,\r\nVenkatesh.S\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}