{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2167", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2167/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2167/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2167/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2167", "id": 151852141, "node_id": "MDU6SXNzdWUxNTE4NTIxNDE=", "number": 2167, "title": "Dropout in skflow has a problem when save & restore the model because the graph collection is not loaded.", "user": {"login": "imcomking", "id": 4004593, "node_id": "MDQ6VXNlcjQwMDQ1OTM=", "avatar_url": "https://avatars0.githubusercontent.com/u/4004593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imcomking", "html_url": "https://github.com/imcomking", "followers_url": "https://api.github.com/users/imcomking/followers", "following_url": "https://api.github.com/users/imcomking/following{/other_user}", "gists_url": "https://api.github.com/users/imcomking/gists{/gist_id}", "starred_url": "https://api.github.com/users/imcomking/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imcomking/subscriptions", "organizations_url": "https://api.github.com/users/imcomking/orgs", "repos_url": "https://api.github.com/users/imcomking/repos", "events_url": "https://api.github.com/users/imcomking/events{/privacy}", "received_events_url": "https://api.github.com/users/imcomking/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2016-04-29T12:12:04Z", "updated_at": "2016-10-07T22:36:53Z", "closed_at": "2016-10-07T22:36:53Z", "author_association": "NONE", "body_html": "<p>\u25b6 Operating System:<br>\nubunutu 14.04 LTS</p>\n<p>\u25b6 Installed version of CUDA and cuDNN:<br>\nCUDA 7.5.18 / cuDNN 7.0(v4)<br>\nNVIDIA-SMI 352.39     Driver Version: 352.39<br>\nGeForce GTX TITAN X</p>\n<p>\u25b6 I installed tensorflow with next command line. And that is a link of tensorflow Github, 'Linux GPU, python 2' whl file.</p>\n<p>sudo pip install --upgrade <a href=\"http://ci.tensorflow.org/view/Nightly/job/nigntly-matrix-linux-gpu/TF_BUILD_CONTAINER_TYPE=GPU,TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON2,label=gpu-working/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-0.8.0-cp27-none-linux_x86_64.whl\" rel=\"nofollow\">http://ci.tensorflow.org/view/Nightly/job/nigntly-matrix-linux-gpu/TF_BUILD_CONTAINER_TYPE=GPU,TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON2,label=gpu-working/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-0.8.0-cp27-none-linux_x86_64.whl</a></p>\n<p>\u25b6 TensorFlow version: 0.8.0<br>\n(outputs of python -c \"import tensorflow; print(tensorflow.<strong>version</strong>)\" )</p>\n<hr>\n<h3>Steps to reproduce</h3>\n<ol>\n<li>Save and Restore a tfmodel modifying [tensorflow/tensorflow/examples/skflow/mnist.py]<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/4004593/14917371/a93e2882-0e59-11e6-8ff0-8154c0cd318f.png\"><img src=\"https://cloud.githubusercontent.com/assets/4004593/14917371/a93e2882-0e59-11e6-8ff0-8154c0cd318f.png\" alt=\"image\" style=\"max-width:100%;\"></a></li>\n<li>And see the accuracy is not deterministic but stochastic after restored.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/4004593/14917401/d8e70342-0e59-11e6-86f6-aa778b66ede2.png\"><img src=\"https://cloud.githubusercontent.com/assets/4004593/14917401/d8e70342-0e59-11e6-86f6-aa778b66ede2.png\" alt=\"image\" style=\"max-width:100%;\"></a></li>\n</ol>\n<h3>What have you tried?</h3>\n<p>When I try to predict MNIST data after save() and restore() the 'tfmodel' with skflow function, the dropout shows stochastic outcomes. And when I remove the dropout, there is no stochasticity.</p>\n<hr>\n<p>I guess when the model has been restored, the collections of a graph about DROPOUT are may not properly loaded. So some codes on<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/4004593/14917208/dcbbfcc6-0e58-11e6-8b4f-8188a99fda8a.png\"><img src=\"https://cloud.githubusercontent.com/assets/4004593/14917208/dcbbfcc6-0e58-11e6-8b4f-8188a99fda8a.png\" alt=\"image\" style=\"max-width:100%;\"></a><br>\n\u25b6 feed_dict = {prob: 1.0 for prob in dropouts}<br>\nthe function of \"_predict()\" at [tensorflow/contrib/learn/python/learn/estimators/base.py] may dont' work.</p>\n<p>If you run following code after restore tfmodel, then you will see that there is no 'droputs' key.<br>\n\u25b6 print (classifier._graph.get_all_collection_keys())</p>", "body_text": "\u25b6 Operating System:\nubunutu 14.04 LTS\n\u25b6 Installed version of CUDA and cuDNN:\nCUDA 7.5.18 / cuDNN 7.0(v4)\nNVIDIA-SMI 352.39     Driver Version: 352.39\nGeForce GTX TITAN X\n\u25b6 I installed tensorflow with next command line. And that is a link of tensorflow Github, 'Linux GPU, python 2' whl file.\nsudo pip install --upgrade http://ci.tensorflow.org/view/Nightly/job/nigntly-matrix-linux-gpu/TF_BUILD_CONTAINER_TYPE=GPU,TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON2,label=gpu-working/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-0.8.0-cp27-none-linux_x86_64.whl\n\u25b6 TensorFlow version: 0.8.0\n(outputs of python -c \"import tensorflow; print(tensorflow.version)\" )\n\nSteps to reproduce\n\nSave and Restore a tfmodel modifying [tensorflow/tensorflow/examples/skflow/mnist.py]\n\nAnd see the accuracy is not deterministic but stochastic after restored.\n\n\nWhat have you tried?\nWhen I try to predict MNIST data after save() and restore() the 'tfmodel' with skflow function, the dropout shows stochastic outcomes. And when I remove the dropout, there is no stochasticity.\n\nI guess when the model has been restored, the collections of a graph about DROPOUT are may not properly loaded. So some codes on\n\n\u25b6 feed_dict = {prob: 1.0 for prob in dropouts}\nthe function of \"_predict()\" at [tensorflow/contrib/learn/python/learn/estimators/base.py] may dont' work.\nIf you run following code after restore tfmodel, then you will see that there is no 'droputs' key.\n\u25b6 print (classifier._graph.get_all_collection_keys())", "body": "\u25b6 Operating System: \nubunutu 14.04 LTS\n\n\u25b6 Installed version of CUDA and cuDNN: \nCUDA 7.5.18 / cuDNN 7.0(v4)\nNVIDIA-SMI 352.39     Driver Version: 352.39\nGeForce GTX TITAN X\n\n\u25b6 I installed tensorflow with next command line. And that is a link of tensorflow Github, 'Linux GPU, python 2' whl file.\n\nsudo pip install --upgrade http://ci.tensorflow.org/view/Nightly/job/nigntly-matrix-linux-gpu/TF_BUILD_CONTAINER_TYPE=GPU,TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON2,label=gpu-working/lastSuccessfulBuild/artifact/pip_test/whl/tensorflow-0.8.0-cp27-none-linux_x86_64.whl\n\n\u25b6 TensorFlow version: 0.8.0\n(outputs of python -c \"import tensorflow; print(tensorflow.**version**)\" )\n\n---\n### Steps to reproduce\n1. Save and Restore a tfmodel modifying [tensorflow/tensorflow/examples/skflow/mnist.py] \n   ![image](https://cloud.githubusercontent.com/assets/4004593/14917371/a93e2882-0e59-11e6-8ff0-8154c0cd318f.png)\n2. And see the accuracy is not deterministic but stochastic after restored.\n   ![image](https://cloud.githubusercontent.com/assets/4004593/14917401/d8e70342-0e59-11e6-86f6-aa778b66ede2.png)\n### What have you tried?\n\nWhen I try to predict MNIST data after save() and restore() the 'tfmodel' with skflow function, the dropout shows stochastic outcomes. And when I remove the dropout, there is no stochasticity. \n\n---\n\nI guess when the model has been restored, the collections of a graph about DROPOUT are may not properly loaded. So some codes on\n![image](https://cloud.githubusercontent.com/assets/4004593/14917208/dcbbfcc6-0e58-11e6-8b4f-8188a99fda8a.png)\n    \u25b6 feed_dict = {prob: 1.0 for prob in dropouts}\nthe function of \"_predict()\" at [tensorflow/contrib/learn/python/learn/estimators/base.py] may dont' work. \n\nIf you run following code after restore tfmodel, then you will see that there is no 'droputs' key.\n    \u25b6 print (classifier._graph.get_all_collection_keys())\n"}