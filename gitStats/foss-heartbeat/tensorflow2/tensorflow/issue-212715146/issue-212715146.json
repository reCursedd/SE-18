{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8194", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8194/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8194/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8194/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8194", "id": 212715146, "node_id": "MDU6SXNzdWUyMTI3MTUxNDY=", "number": 8194, "title": " NaN loss during training in GMM", "user": {"login": "mahatosourav91", "id": 25343161, "node_id": "MDQ6VXNlcjI1MzQzMTYx", "avatar_url": "https://avatars0.githubusercontent.com/u/25343161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mahatosourav91", "html_url": "https://github.com/mahatosourav91", "followers_url": "https://api.github.com/users/mahatosourav91/followers", "following_url": "https://api.github.com/users/mahatosourav91/following{/other_user}", "gists_url": "https://api.github.com/users/mahatosourav91/gists{/gist_id}", "starred_url": "https://api.github.com/users/mahatosourav91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mahatosourav91/subscriptions", "organizations_url": "https://api.github.com/users/mahatosourav91/orgs", "repos_url": "https://api.github.com/users/mahatosourav91/repos", "events_url": "https://api.github.com/users/mahatosourav91/events{/privacy}", "received_events_url": "https://api.github.com/users/mahatosourav91/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "agarwal-ashish", "id": 19335798, "node_id": "MDQ6VXNlcjE5MzM1Nzk4", "avatar_url": "https://avatars3.githubusercontent.com/u/19335798?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agarwal-ashish", "html_url": "https://github.com/agarwal-ashish", "followers_url": "https://api.github.com/users/agarwal-ashish/followers", "following_url": "https://api.github.com/users/agarwal-ashish/following{/other_user}", "gists_url": "https://api.github.com/users/agarwal-ashish/gists{/gist_id}", "starred_url": "https://api.github.com/users/agarwal-ashish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agarwal-ashish/subscriptions", "organizations_url": "https://api.github.com/users/agarwal-ashish/orgs", "repos_url": "https://api.github.com/users/agarwal-ashish/repos", "events_url": "https://api.github.com/users/agarwal-ashish/events{/privacy}", "received_events_url": "https://api.github.com/users/agarwal-ashish/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "agarwal-ashish", "id": 19335798, "node_id": "MDQ6VXNlcjE5MzM1Nzk4", "avatar_url": "https://avatars3.githubusercontent.com/u/19335798?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agarwal-ashish", "html_url": "https://github.com/agarwal-ashish", "followers_url": "https://api.github.com/users/agarwal-ashish/followers", "following_url": "https://api.github.com/users/agarwal-ashish/following{/other_user}", "gists_url": "https://api.github.com/users/agarwal-ashish/gists{/gist_id}", "starred_url": "https://api.github.com/users/agarwal-ashish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agarwal-ashish/subscriptions", "organizations_url": "https://api.github.com/users/agarwal-ashish/orgs", "repos_url": "https://api.github.com/users/agarwal-ashish/repos", "events_url": "https://api.github.com/users/agarwal-ashish/events{/privacy}", "received_events_url": "https://api.github.com/users/agarwal-ashish/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-03-08T12:00:11Z", "updated_at": "2017-03-21T22:55:25Z", "closed_at": "2017-03-21T22:55:25Z", "author_association": "NONE", "body_html": "<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>Github issue :- <a href=\"https://github.com/tensorflow/tensorflow/issues/7784\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7784/hovercard\">7784 </a><br>\nStackoverflow question :- <a href=\"http://stackoverflow.com/questions/42551421/tensorflow-gmm-errortensorflowmodel-diverged-with-loss-nan\" rel=\"nofollow\">here</a> and <a href=\"http://stackoverflow.com/questions/42505293/input-is-not-invertible-node-matrixinverse-2-matrixinverset-dt-float-adjoi\" rel=\"nofollow\">here</a></p>\n<h3>Environment info</h3>\n<p>Operating System: Windows 10 / Ubuntu 16.04<br>\nInstalled version of CUDA and cuDNN:  NO</p>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>A link to the pip package you installed:</li>\n<li>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>. 1.0 and from <a href=\"https://github.com/mahatosourav91/tensorflow/tree/pseudo_matrix_inverse\">here </a></li>\n</ol>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<p>If using 1.0</p>\n<pre><code>from tensorflow.contrib.factorization.python.ops import gmm as gmm_lib \nimport random \nimport numpy as np \nx = np.array([[random.random() for i in range(100)] for j in range(1000)] , dtype=np.float32) \ngmm = gmm_lib.GMM(128,random_seed=0) \ngmm.fit(x)\n</code></pre>\n<p>If using master branch</p>\n<pre><code>from tensorflow.contrib.factorization.python.ops import gmm as gmm_lib\nfrom tensorflow.python.framework import constant_op\nfrom tensorflow.python.framework import dtypes\nfrom tensorflow.python.ops import array_ops\nfrom tensorflow.python.ops import random_ops\nimport random\nimport numpy as np\n\n\ndef input_fn(points, batch_size=None):\n    num_points = points.shape[0]\n    batch_size = batch_size or num_points\n    def _fn():\n        x = constant_op.constant(points)\n        if batch_size == num_points:\n            return x, None\n        indices = random_ops.random_uniform(constant_op.constant([batch_size]),\n                                            minval=0, maxval=num_points - 1,\n                                            dtype=dtypes.int32,\n                                            seed=10)\n        return array_ops.gather(x, indices), None\n\n    return _fn\n\nx = np.array([[random.random() for i in range(100)] for j in range(1000)], dtype=np.float32)\ngmm = gmm_lib.GMM(50, random_seed=0)\ngmm.fit(input_fn=input_fn(x), max_steps=1)\ny = list(gmm.predict_assignments(input_fn=input_fn(x)))\n</code></pre>\n<h3>What other attempted solutions have you tried?</h3>\n<p>As per the discusion happened in <a href=\"https://github.com/tensorflow/tensorflow/issues/7784#issuecomment-283115625\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7784/hovercard\">here</a>. I tried to fix the issue of matrix inversion</p>\n<pre><code>InvalidArgumentError (see above for traceback): Input is not invertible.\n\t [[Node: MatrixInverse_2 = MatrixInverse[T=DT_FLOAT, adjoint=false, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add_138)]]\n</code></pre>\n<p>I have modified<a href=\"https://github.com/mahatosourav91/tensorflow/blob/pseudo_matrix_inverse/tensorflow/contrib/factorization/python/ops/gmm_ops.py\"> gmm_ops.py </a> and <a href=\"https://github.com/mahatosourav91/tensorflow/blob/pseudo_matrix_inverse/tensorflow/python/ops/linalg_ops.py\">linalg_ops.py</a> here<br>\nBut even after calculating pseudo matrix inverse I am getting a new error mentioned <a href=\"https://github.com/tensorflow/tensorflow/issues/7784#issuecomment-283346222\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7784/hovercard\">here</a></p>\n<h3>Logs or other output that would be helpful</h3>\n<pre><code>ERROR:tensorflow:Model diverged with loss = NaN.\nTraceback (most recent call last):\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2881, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"&lt;ipython-input-2-7be5ab638a15&gt;\", line 15, in &lt;module&gt;\n    gmm.fit(input_fn=input_fn(x), max_steps=300)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 281, in new_func\n    return func(*args, **kwargs)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 418, in fit\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 968, in _train_model\n    return loss\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\contextlib.py\", line 77, in __exit__\n    self.gen.throw(type, value, traceback)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3623, in get_controller\n    yield default\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 968, in _train_model\n    return loss\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\contextlib.py\", line 77, in __exit__\n    self.gen.throw(type, value, traceback)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3049, in device\n    yield\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 966, in _train_model\n    _, loss = mon_sess.run([model_fn_ops.train_op, model_fn_ops.loss])\n  File \"C:\\Users\\gidnri6\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 483, in run\n    run_metadata=run_metadata)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\n    run_metadata=run_metadata)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 775, in run\n    return self._sess.run(*args, **kwargs)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 936, in run\n    run_metadata=run_metadata))\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\basic_session_run_hooks.py\", line 481, in after_run\n    raise NanLossDuringTrainingError\ntensorflow.python.training.basic_session_run_hooks.NanLossDuringTrainingError: NaN loss during training.\n</code></pre>", "body_text": "What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nGithub issue :- 7784 \nStackoverflow question :- here and here\nEnvironment info\nOperating System: Windows 10 / Ubuntu 16.04\nInstalled version of CUDA and cuDNN:  NO\nIf installed from binary pip package, provide:\n\nA link to the pip package you installed:\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\". 1.0 and from here \n\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nIf using 1.0\nfrom tensorflow.contrib.factorization.python.ops import gmm as gmm_lib \nimport random \nimport numpy as np \nx = np.array([[random.random() for i in range(100)] for j in range(1000)] , dtype=np.float32) \ngmm = gmm_lib.GMM(128,random_seed=0) \ngmm.fit(x)\n\nIf using master branch\nfrom tensorflow.contrib.factorization.python.ops import gmm as gmm_lib\nfrom tensorflow.python.framework import constant_op\nfrom tensorflow.python.framework import dtypes\nfrom tensorflow.python.ops import array_ops\nfrom tensorflow.python.ops import random_ops\nimport random\nimport numpy as np\n\n\ndef input_fn(points, batch_size=None):\n    num_points = points.shape[0]\n    batch_size = batch_size or num_points\n    def _fn():\n        x = constant_op.constant(points)\n        if batch_size == num_points:\n            return x, None\n        indices = random_ops.random_uniform(constant_op.constant([batch_size]),\n                                            minval=0, maxval=num_points - 1,\n                                            dtype=dtypes.int32,\n                                            seed=10)\n        return array_ops.gather(x, indices), None\n\n    return _fn\n\nx = np.array([[random.random() for i in range(100)] for j in range(1000)], dtype=np.float32)\ngmm = gmm_lib.GMM(50, random_seed=0)\ngmm.fit(input_fn=input_fn(x), max_steps=1)\ny = list(gmm.predict_assignments(input_fn=input_fn(x)))\n\nWhat other attempted solutions have you tried?\nAs per the discusion happened in here. I tried to fix the issue of matrix inversion\nInvalidArgumentError (see above for traceback): Input is not invertible.\n\t [[Node: MatrixInverse_2 = MatrixInverse[T=DT_FLOAT, adjoint=false, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add_138)]]\n\nI have modified gmm_ops.py  and linalg_ops.py here\nBut even after calculating pseudo matrix inverse I am getting a new error mentioned here\nLogs or other output that would be helpful\nERROR:tensorflow:Model diverged with loss = NaN.\nTraceback (most recent call last):\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2881, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-2-7be5ab638a15>\", line 15, in <module>\n    gmm.fit(input_fn=input_fn(x), max_steps=300)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 281, in new_func\n    return func(*args, **kwargs)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 418, in fit\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 968, in _train_model\n    return loss\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\contextlib.py\", line 77, in __exit__\n    self.gen.throw(type, value, traceback)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3623, in get_controller\n    yield default\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 968, in _train_model\n    return loss\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\contextlib.py\", line 77, in __exit__\n    self.gen.throw(type, value, traceback)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3049, in device\n    yield\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 966, in _train_model\n    _, loss = mon_sess.run([model_fn_ops.train_op, model_fn_ops.loss])\n  File \"C:\\Users\\gidnri6\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 483, in run\n    run_metadata=run_metadata)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\n    run_metadata=run_metadata)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 775, in run\n    return self._sess.run(*args, **kwargs)\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 936, in run\n    run_metadata=run_metadata))\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\basic_session_run_hooks.py\", line 481, in after_run\n    raise NanLossDuringTrainingError\ntensorflow.python.training.basic_session_run_hooks.NanLossDuringTrainingError: NaN loss during training.", "body": "### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\nGithub issue :- [7784 ](https://github.com/tensorflow/tensorflow/issues/7784)\r\nStackoverflow question :- [here](http://stackoverflow.com/questions/42551421/tensorflow-gmm-errortensorflowmodel-diverged-with-loss-nan) and [here](http://stackoverflow.com/questions/42505293/input-is-not-invertible-node-matrixinverse-2-matrixinverset-dt-float-adjoi)\r\n### Environment info\r\nOperating System: Windows 10 / Ubuntu 16.04\r\nInstalled version of CUDA and cuDNN:  NO\r\n\r\nIf installed from binary pip package, provide:\r\n\r\n1. A link to the pip package you installed: \r\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`. 1.0 and from [here ](https://github.com/mahatosourav91/tensorflow/tree/pseudo_matrix_inverse)\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\nIf using 1.0 \r\n```\r\nfrom tensorflow.contrib.factorization.python.ops import gmm as gmm_lib \r\nimport random \r\nimport numpy as np \r\nx = np.array([[random.random() for i in range(100)] for j in range(1000)] , dtype=np.float32) \r\ngmm = gmm_lib.GMM(128,random_seed=0) \r\ngmm.fit(x)\r\n```\r\n\r\nIf using master branch\r\n```\r\nfrom tensorflow.contrib.factorization.python.ops import gmm as gmm_lib\r\nfrom tensorflow.python.framework import constant_op\r\nfrom tensorflow.python.framework import dtypes\r\nfrom tensorflow.python.ops import array_ops\r\nfrom tensorflow.python.ops import random_ops\r\nimport random\r\nimport numpy as np\r\n\r\n\r\ndef input_fn(points, batch_size=None):\r\n    num_points = points.shape[0]\r\n    batch_size = batch_size or num_points\r\n    def _fn():\r\n        x = constant_op.constant(points)\r\n        if batch_size == num_points:\r\n            return x, None\r\n        indices = random_ops.random_uniform(constant_op.constant([batch_size]),\r\n                                            minval=0, maxval=num_points - 1,\r\n                                            dtype=dtypes.int32,\r\n                                            seed=10)\r\n        return array_ops.gather(x, indices), None\r\n\r\n    return _fn\r\n\r\nx = np.array([[random.random() for i in range(100)] for j in range(1000)], dtype=np.float32)\r\ngmm = gmm_lib.GMM(50, random_seed=0)\r\ngmm.fit(input_fn=input_fn(x), max_steps=1)\r\ny = list(gmm.predict_assignments(input_fn=input_fn(x)))\r\n```\r\n### What other attempted solutions have you tried?\r\nAs per the discusion happened in [here](https://github.com/tensorflow/tensorflow/issues/7784#issuecomment-283115625). I tried to fix the issue of matrix inversion \r\n```\r\nInvalidArgumentError (see above for traceback): Input is not invertible.\r\n\t [[Node: MatrixInverse_2 = MatrixInverse[T=DT_FLOAT, adjoint=false, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add_138)]]\r\n```\r\n I have modified[ gmm_ops.py ](https://github.com/mahatosourav91/tensorflow/blob/pseudo_matrix_inverse/tensorflow/contrib/factorization/python/ops/gmm_ops.py) and [linalg_ops.py](https://github.com/mahatosourav91/tensorflow/blob/pseudo_matrix_inverse/tensorflow/python/ops/linalg_ops.py) here\r\nBut even after calculating pseudo matrix inverse I am getting a new error mentioned [here](https://github.com/tensorflow/tensorflow/issues/7784#issuecomment-283346222)\r\n\r\n### Logs or other output that would be helpful\r\n```\r\nERROR:tensorflow:Model diverged with loss = NaN.\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2881, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-7be5ab638a15>\", line 15, in <module>\r\n    gmm.fit(input_fn=input_fn(x), max_steps=300)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 281, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 418, in fit\r\n    loss = self._train_model(input_fn=input_fn, hooks=hooks)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 968, in _train_model\r\n    return loss\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\contextlib.py\", line 77, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3623, in get_controller\r\n    yield default\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 968, in _train_model\r\n    return loss\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\contextlib.py\", line 77, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3049, in device\r\n    yield\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\contrib\\learn\\python\\learn\\estimators\\estimator.py\", line 966, in _train_model\r\n    _, loss = mon_sess.run([model_fn_ops.train_op, model_fn_ops.loss])\r\n  File \"C:\\Users\\gidnri6\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 483, in run\r\n    run_metadata=run_metadata)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 818, in run\r\n    run_metadata=run_metadata)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 775, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\monitored_session.py\", line 936, in run\r\n    run_metadata=run_metadata))\r\n  File \"C:\\Users\\#####\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\basic_session_run_hooks.py\", line 481, in after_run\r\n    raise NanLossDuringTrainingError\r\ntensorflow.python.training.basic_session_run_hooks.NanLossDuringTrainingError: NaN loss during training.\r\n```\r\n\r\n"}