{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12185", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12185/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12185/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12185/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12185", "id": 249426714, "node_id": "MDU6SXNzdWUyNDk0MjY3MTQ=", "number": 12185, "title": "`numpy >= 1.11.0` is not sufficient (repro script included)", "user": {"login": "wchargin", "id": 4317806, "node_id": "MDQ6VXNlcjQzMTc4MDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4317806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wchargin", "html_url": "https://github.com/wchargin", "followers_url": "https://api.github.com/users/wchargin/followers", "following_url": "https://api.github.com/users/wchargin/following{/other_user}", "gists_url": "https://api.github.com/users/wchargin/gists{/gist_id}", "starred_url": "https://api.github.com/users/wchargin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wchargin/subscriptions", "organizations_url": "https://api.github.com/users/wchargin/orgs", "repos_url": "https://api.github.com/users/wchargin/repos", "events_url": "https://api.github.com/users/wchargin/events{/privacy}", "received_events_url": "https://api.github.com/users/wchargin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-08-10T17:53:28Z", "updated_at": "2017-08-15T01:42:08Z", "closed_at": "2017-08-15T01:42:08Z", "author_association": "MEMBER", "body_html": "<p>Our pip package includes a dependency on <a href=\"https://github.com/tensorflow/tensorflow/blob/ed7d08eaf92cb9dbc96a09ec6e08d0a93b70a61b/tensorflow/tools/pip_package/setup.py#L35\"><code>numpy &gt;= 1.11.0</code></a>. However, when <code>numpy</code> version 1.11.0 is already installed and then the user installs TensorFlow, TensorFlow fails to load with the following error:</p>\n<pre><code>SystemError: initialization of _pywrap_tensorflow_internal raised unreported exception\n</code></pre>\n<p>The root cause is:</p>\n<pre><code>RuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\n</code></pre>\n<p>This problem occurs on <strong>Python 3 only</strong> (I only tested Python 3.4).</p>\n<p>This is a regression from build 582 to build 583. I include a repro script below.</p>\n<div class=\"highlight highlight-source-shell\"><pre>$ cat examine.sh\n<span class=\"pl-c\"><span class=\"pl-c\">#!</span>/bin/sh</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> USAGE: ./examine.sh JENKINS_BUILD_ID</span>\n<span class=\"pl-c1\">set</span> -eu\nvirtualenv=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-s\"><span class=\"pl-pds\">$(</span>mktemp -d<span class=\"pl-pds\">)</span></span><span class=\"pl-pds\">\"</span></span>\nvirtualenv <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${virtualenv}</span><span class=\"pl-pds\">\"</span></span> -p python3\n<span class=\"pl-c1\">.</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${virtualenv}</span>/bin/activate<span class=\"pl-pds\">\"</span></span>\npip install numpy==1.11.0\nbuild_id=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$1</span><span class=\"pl-pds\">\"</span></span>\nNIGHTLY_URL=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/<span class=\"pl-smi\">${build_id}</span>/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl<span class=\"pl-pds\">\"</span></span>\npip install <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${NIGHTLY_URL}</span><span class=\"pl-pds\">\"</span></span>\npython -c <span class=\"pl-s\"><span class=\"pl-pds\">'</span>import tensorflow<span class=\"pl-pds\">'</span></span>\n<span class=\"pl-c1\">printf</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>Done; everything checks out.\\n<span class=\"pl-pds\">'</span></span></pre></div>\n<p>Removing the <code>pip install numpy==1.11.0</code>, or subsequently removing it with <code>pip uninstall -y numpy==1.11.0</code>, or installing TensorFlow with <code>pip install -I \"${NIGHTLY_URL}</code> all fix the issue.</p>\n<p>The change log for those two builds is <a class=\"commit-link\" href=\"https://github.com/tensorflow/tensorflow/compare/349932f4400d15d610f7b6e51923c6a60ddd186b...dff1062bbf53cd8890d8d43ea815c90ba4555ba4\"><tt>349932f...dff1062</tt></a>, but nothing in there looks particularly suspicious. Perhaps something changed on the Jenkins side?</p>\n<p>Here is the result of the repro script on builds 582 and 583:</p>\n<div class=\"highlight highlight-source-shell\"><pre>$ ./examine.sh 582\nRunning virtualenv with interpreter /usr/bin/python3\nUsing base prefix <span class=\"pl-s\"><span class=\"pl-pds\">'</span>/usr<span class=\"pl-pds\">'</span></span>\nNew python executable <span class=\"pl-k\">in</span> /tmp/tmp.IS6cENR7vo/bin/python3\nAlso creating executable <span class=\"pl-k\">in</span> /tmp/tmp.IS6cENR7vo/bin/python\nInstalling setuptools, pip, wheel...done.\nCollecting numpy==1.11.0\n  Using cached numpy-1.11.0-cp34-cp34m-manylinux1_x86_64.whl\nInstalling collected packages: numpy\nSuccessfully installed numpy-1.11.0\nCollecting tensorflow==1.head from https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/582/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\n  Downloading https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/582/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl (46.5MB)\n    100% <span class=\"pl-k\">|</span>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588<span class=\"pl-k\">|</span> 46.5MB 33kB/s \nCollecting six<span class=\"pl-k\">&gt;</span>=1.10.0 (from tensorflow==1.head)\n  Using cached six-1.10.0-py2.py3-none-any.whl\nCollecting protobuf<span class=\"pl-k\">&gt;</span>=3.3.0 (from tensorflow==1.head)\n  Using cached protobuf-3.3.0-cp34-cp34m-manylinux1_x86_64.whl\nRequirement already satisfied: numpy<span class=\"pl-k\">&gt;</span>=1.11.0 <span class=\"pl-k\">in</span> ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from tensorflow==1.head)\nCollecting tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0 (from tensorflow==1.head)\n  Using cached tensorflow_tensorboard-0.1.2-py3-none-any.whl\nRequirement already satisfied: wheel<span class=\"pl-k\">&gt;</span>=0.26 <span class=\"pl-k\">in</span> ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from tensorflow==1.head)\nRequirement already satisfied: setuptools <span class=\"pl-k\">in</span> ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from protobuf<span class=\"pl-k\">&gt;</span>=3.3.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nCollecting werkzeug<span class=\"pl-k\">&gt;</span>=0.11.10 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\n  Using cached Werkzeug-0.12.2-py2.py3-none-any.whl\nCollecting markdown==2.2.0 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nCollecting bleach==1.5.0 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\n  Using cached bleach-1.5.0-py2.py3-none-any.whl\nCollecting html5lib==0.9999999 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nInstalling collected packages: six, protobuf, werkzeug, markdown, html5lib, bleach, tensorflow-tensorboard, tensorflow\nSuccessfully installed bleach-1.5.0 html5lib-0.9999999 markdown-2.2.0 protobuf-3.3.0 six-1.10.0 tensorflow-1.3.0rc2 tensorflow-tensorboard-0.1.2 werkzeug-0.12.2\nDone<span class=\"pl-k\">;</span> everything checks out.\n\n$ ./examine.sh 583\nRunning virtualenv with interpreter /usr/bin/python3\nUsing base prefix <span class=\"pl-s\"><span class=\"pl-pds\">'</span>/usr<span class=\"pl-pds\">'</span></span>\nNew python executable <span class=\"pl-k\">in</span> /tmp/tmp.Iwv3luN526/bin/python3\nAlso creating executable <span class=\"pl-k\">in</span> /tmp/tmp.Iwv3luN526/bin/python\nInstalling setuptools, pip, wheel...done.\nCollecting numpy==1.11.0\n  Using cached numpy-1.11.0-cp34-cp34m-manylinux1_x86_64.whl\nInstalling collected packages: numpy\nSuccessfully installed numpy-1.11.0\nCollecting tensorflow==1.head from https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/583/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\n  Downloading https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/583/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl (46.4MB)\n    100% <span class=\"pl-k\">|</span>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588<span class=\"pl-k\">|</span> 46.4MB 32kB/s \nRequirement already satisfied: numpy<span class=\"pl-k\">&gt;</span>=1.11.0 <span class=\"pl-k\">in</span> ./tmp.Iwv3luN526/lib/python3.4/site-packages (from tensorflow==1.head)\nCollecting protobuf<span class=\"pl-k\">&gt;</span>=3.3.0 (from tensorflow==1.head)\n  Using cached protobuf-3.3.0-cp34-cp34m-manylinux1_x86_64.whl\nRequirement already satisfied: wheel<span class=\"pl-k\">&gt;</span>=0.26 <span class=\"pl-k\">in</span> ./tmp.Iwv3luN526/lib/python3.4/site-packages (from tensorflow==1.head)\nCollecting autograd<span class=\"pl-k\">&gt;</span>=1.1.11 (from tensorflow==1.head)\nCollecting six<span class=\"pl-k\">&gt;</span>=1.10.0 (from tensorflow==1.head)\n  Using cached six-1.10.0-py2.py3-none-any.whl\nCollecting tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0 (from tensorflow==1.head)\n  Using cached tensorflow_tensorboard-0.1.2-py3-none-any.whl\nRequirement already satisfied: setuptools <span class=\"pl-k\">in</span> ./tmp.Iwv3luN526/lib/python3.4/site-packages (from protobuf<span class=\"pl-k\">&gt;</span>=3.3.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nCollecting scipy<span class=\"pl-k\">&gt;</span>=0.17 (from autograd<span class=\"pl-k\">&gt;</span>=1.1.11-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\n  Using cached scipy-0.19.1-cp34-cp34m-manylinux1_x86_64.whl\nCollecting future<span class=\"pl-k\">&gt;</span>=0.15.2 (from autograd<span class=\"pl-k\">&gt;</span>=1.1.11-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nCollecting werkzeug<span class=\"pl-k\">&gt;</span>=0.11.10 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\n  Using cached Werkzeug-0.12.2-py2.py3-none-any.whl\nCollecting markdown==2.2.0 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nCollecting html5lib==0.9999999 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\nCollecting bleach==1.5.0 (from tensorflow-tensorboard<span class=\"pl-k\">&lt;</span>0.2.0,<span class=\"pl-k\">&gt;</span>=0.1.0-<span class=\"pl-k\">&gt;</span>tensorflow==1.head)\n  Using cached bleach-1.5.0-py2.py3-none-any.whl\nInstalling collected packages: six, protobuf, scipy, future, autograd, werkzeug, markdown, html5lib, bleach, tensorflow-tensorboard, tensorflow\nSuccessfully installed autograd-1.1.11 bleach-1.5.0 future-0.16.0 html5lib-0.9999999 markdown-2.2.0 protobuf-3.3.0 scipy-0.19.1 six-1.10.0 tensorflow-1.3.0rc2 tensorflow-tensorboard-0.1.2 werkzeug-0.12.2\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\nTraceback (most recent call last):\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>&lt;string&gt;<span class=\"pl-pds\">\"</span></span>, line 1, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/__init__.py<span class=\"pl-pds\">\"</span></span>, line 24, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    from tensorflow.python import <span class=\"pl-k\">*</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/__init__.py<span class=\"pl-pds\">\"</span></span>, line 49, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    from tensorflow.python import pywrap_tensorflow\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow.py<span class=\"pl-pds\">\"</span></span>, line 41, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    from tensorflow.python.pywrap_tensorflow_internal import <span class=\"pl-k\">*</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow_internal.py<span class=\"pl-pds\">\"</span></span>, line 28, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    _pywrap_tensorflow_internal = <span class=\"pl-en\">swig_import_helper</span>()\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow_internal.py<span class=\"pl-pds\">\"</span></span>, line 24, <span class=\"pl-k\">in</span> swig_import_helper\n    _mod = imp.load_module(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>_pywrap_tensorflow_internal<span class=\"pl-pds\">'</span></span>, fp, pathname, description)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/tmp.Iwv3luN526/lib/python3.4/imp.py<span class=\"pl-pds\">\"</span></span>, line 243, <span class=\"pl-k\">in</span> load_module\n    <span class=\"pl-k\">return</span> load_dynamic(name, filename, file)\nSystemError: initialization of _pywrap_tensorflow_internal raised unreported exception</pre></div>", "body_text": "Our pip package includes a dependency on numpy >= 1.11.0. However, when numpy version 1.11.0 is already installed and then the user installs TensorFlow, TensorFlow fails to load with the following error:\nSystemError: initialization of _pywrap_tensorflow_internal raised unreported exception\n\nThe root cause is:\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\n\nThis problem occurs on Python 3 only (I only tested Python 3.4).\nThis is a regression from build 582 to build 583. I include a repro script below.\n$ cat examine.sh\n#!/bin/sh\n# USAGE: ./examine.sh JENKINS_BUILD_ID\nset -eu\nvirtualenv=\"$(mktemp -d)\"\nvirtualenv \"${virtualenv}\" -p python3\n. \"${virtualenv}/bin/activate\"\npip install numpy==1.11.0\nbuild_id=\"$1\"\nNIGHTLY_URL=\"https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/${build_id}/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\"\npip install \"${NIGHTLY_URL}\"\npython -c 'import tensorflow'\nprintf 'Done; everything checks out.\\n'\nRemoving the pip install numpy==1.11.0, or subsequently removing it with pip uninstall -y numpy==1.11.0, or installing TensorFlow with pip install -I \"${NIGHTLY_URL} all fix the issue.\nThe change log for those two builds is 349932f...dff1062, but nothing in there looks particularly suspicious. Perhaps something changed on the Jenkins side?\nHere is the result of the repro script on builds 582 and 583:\n$ ./examine.sh 582\nRunning virtualenv with interpreter /usr/bin/python3\nUsing base prefix '/usr'\nNew python executable in /tmp/tmp.IS6cENR7vo/bin/python3\nAlso creating executable in /tmp/tmp.IS6cENR7vo/bin/python\nInstalling setuptools, pip, wheel...done.\nCollecting numpy==1.11.0\n  Using cached numpy-1.11.0-cp34-cp34m-manylinux1_x86_64.whl\nInstalling collected packages: numpy\nSuccessfully installed numpy-1.11.0\nCollecting tensorflow==1.head from https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/582/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\n  Downloading https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/582/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl (46.5MB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 46.5MB 33kB/s \nCollecting six>=1.10.0 (from tensorflow==1.head)\n  Using cached six-1.10.0-py2.py3-none-any.whl\nCollecting protobuf>=3.3.0 (from tensorflow==1.head)\n  Using cached protobuf-3.3.0-cp34-cp34m-manylinux1_x86_64.whl\nRequirement already satisfied: numpy>=1.11.0 in ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from tensorflow==1.head)\nCollecting tensorflow-tensorboard<0.2.0,>=0.1.0 (from tensorflow==1.head)\n  Using cached tensorflow_tensorboard-0.1.2-py3-none-any.whl\nRequirement already satisfied: wheel>=0.26 in ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from tensorflow==1.head)\nRequirement already satisfied: setuptools in ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from protobuf>=3.3.0->tensorflow==1.head)\nCollecting werkzeug>=0.11.10 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\n  Using cached Werkzeug-0.12.2-py2.py3-none-any.whl\nCollecting markdown==2.2.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\nCollecting bleach==1.5.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\n  Using cached bleach-1.5.0-py2.py3-none-any.whl\nCollecting html5lib==0.9999999 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\nInstalling collected packages: six, protobuf, werkzeug, markdown, html5lib, bleach, tensorflow-tensorboard, tensorflow\nSuccessfully installed bleach-1.5.0 html5lib-0.9999999 markdown-2.2.0 protobuf-3.3.0 six-1.10.0 tensorflow-1.3.0rc2 tensorflow-tensorboard-0.1.2 werkzeug-0.12.2\nDone; everything checks out.\n\n$ ./examine.sh 583\nRunning virtualenv with interpreter /usr/bin/python3\nUsing base prefix '/usr'\nNew python executable in /tmp/tmp.Iwv3luN526/bin/python3\nAlso creating executable in /tmp/tmp.Iwv3luN526/bin/python\nInstalling setuptools, pip, wheel...done.\nCollecting numpy==1.11.0\n  Using cached numpy-1.11.0-cp34-cp34m-manylinux1_x86_64.whl\nInstalling collected packages: numpy\nSuccessfully installed numpy-1.11.0\nCollecting tensorflow==1.head from https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/583/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\n  Downloading https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/583/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl (46.4MB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 46.4MB 32kB/s \nRequirement already satisfied: numpy>=1.11.0 in ./tmp.Iwv3luN526/lib/python3.4/site-packages (from tensorflow==1.head)\nCollecting protobuf>=3.3.0 (from tensorflow==1.head)\n  Using cached protobuf-3.3.0-cp34-cp34m-manylinux1_x86_64.whl\nRequirement already satisfied: wheel>=0.26 in ./tmp.Iwv3luN526/lib/python3.4/site-packages (from tensorflow==1.head)\nCollecting autograd>=1.1.11 (from tensorflow==1.head)\nCollecting six>=1.10.0 (from tensorflow==1.head)\n  Using cached six-1.10.0-py2.py3-none-any.whl\nCollecting tensorflow-tensorboard<0.2.0,>=0.1.0 (from tensorflow==1.head)\n  Using cached tensorflow_tensorboard-0.1.2-py3-none-any.whl\nRequirement already satisfied: setuptools in ./tmp.Iwv3luN526/lib/python3.4/site-packages (from protobuf>=3.3.0->tensorflow==1.head)\nCollecting scipy>=0.17 (from autograd>=1.1.11->tensorflow==1.head)\n  Using cached scipy-0.19.1-cp34-cp34m-manylinux1_x86_64.whl\nCollecting future>=0.15.2 (from autograd>=1.1.11->tensorflow==1.head)\nCollecting werkzeug>=0.11.10 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\n  Using cached Werkzeug-0.12.2-py2.py3-none-any.whl\nCollecting markdown==2.2.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\nCollecting html5lib==0.9999999 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\nCollecting bleach==1.5.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\n  Using cached bleach-1.5.0-py2.py3-none-any.whl\nInstalling collected packages: six, protobuf, scipy, future, autograd, werkzeug, markdown, html5lib, bleach, tensorflow-tensorboard, tensorflow\nSuccessfully installed autograd-1.1.11 bleach-1.5.0 future-0.16.0 html5lib-0.9999999 markdown-2.2.0 protobuf-3.3.0 scipy-0.19.1 six-1.10.0 tensorflow-1.3.0rc2 tensorflow-tensorboard-0.1.2 werkzeug-0.12.2\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/__init__.py\", line 24, in <module>\n    from tensorflow.python import *\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/__init__.py\", line 49, in <module>\n    from tensorflow.python import pywrap_tensorflow\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 41, in <module>\n    from tensorflow.python.pywrap_tensorflow_internal import *\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 28, in <module>\n    _pywrap_tensorflow_internal = swig_import_helper()\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/imp.py\", line 243, in load_module\n    return load_dynamic(name, filename, file)\nSystemError: initialization of _pywrap_tensorflow_internal raised unreported exception", "body": "Our pip package includes a dependency on [`numpy >= 1.11.0`][1]. However, when `numpy` version 1.11.0 is already installed and then the user installs TensorFlow, TensorFlow fails to load with the following error:\r\n```\r\nSystemError: initialization of _pywrap_tensorflow_internal raised unreported exception\r\n```\r\nThe root cause is:\r\n```\r\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\r\n```\r\n\r\nThis problem occurs on **Python 3 only** (I only tested Python 3.4).\r\n\r\nThis is a regression from build 582 to build 583. I include a repro script below.\r\n```sh\r\n$ cat examine.sh\r\n#!/bin/sh\r\n# USAGE: ./examine.sh JENKINS_BUILD_ID\r\nset -eu\r\nvirtualenv=\"$(mktemp -d)\"\r\nvirtualenv \"${virtualenv}\" -p python3\r\n. \"${virtualenv}/bin/activate\"\r\npip install numpy==1.11.0\r\nbuild_id=\"$1\"\r\nNIGHTLY_URL=\"https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/${build_id}/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\"\r\npip install \"${NIGHTLY_URL}\"\r\npython -c 'import tensorflow'\r\nprintf 'Done; everything checks out.\\n'\r\n```\r\nRemoving the `pip install numpy==1.11.0`, or subsequently removing it with `pip uninstall -y numpy==1.11.0`, or installing TensorFlow with `pip install -I \"${NIGHTLY_URL}` all fix the issue.\r\n\r\nThe change log for those two builds is 349932f4400d15d610f7b6e51923c6a60ddd186b...dff1062bbf53cd8890d8d43ea815c90ba4555ba4, but nothing in there looks particularly suspicious. Perhaps something changed on the Jenkins side?\r\n\r\nHere is the result of the repro script on builds 582 and 583:\r\n```sh\r\n$ ./examine.sh 582\r\nRunning virtualenv with interpreter /usr/bin/python3\r\nUsing base prefix '/usr'\r\nNew python executable in /tmp/tmp.IS6cENR7vo/bin/python3\r\nAlso creating executable in /tmp/tmp.IS6cENR7vo/bin/python\r\nInstalling setuptools, pip, wheel...done.\r\nCollecting numpy==1.11.0\r\n  Using cached numpy-1.11.0-cp34-cp34m-manylinux1_x86_64.whl\r\nInstalling collected packages: numpy\r\nSuccessfully installed numpy-1.11.0\r\nCollecting tensorflow==1.head from https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/582/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\r\n  Downloading https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/582/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl (46.5MB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 46.5MB 33kB/s \r\nCollecting six>=1.10.0 (from tensorflow==1.head)\r\n  Using cached six-1.10.0-py2.py3-none-any.whl\r\nCollecting protobuf>=3.3.0 (from tensorflow==1.head)\r\n  Using cached protobuf-3.3.0-cp34-cp34m-manylinux1_x86_64.whl\r\nRequirement already satisfied: numpy>=1.11.0 in ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from tensorflow==1.head)\r\nCollecting tensorflow-tensorboard<0.2.0,>=0.1.0 (from tensorflow==1.head)\r\n  Using cached tensorflow_tensorboard-0.1.2-py3-none-any.whl\r\nRequirement already satisfied: wheel>=0.26 in ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from tensorflow==1.head)\r\nRequirement already satisfied: setuptools in ./tmp.IS6cENR7vo/lib/python3.4/site-packages (from protobuf>=3.3.0->tensorflow==1.head)\r\nCollecting werkzeug>=0.11.10 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\n  Using cached Werkzeug-0.12.2-py2.py3-none-any.whl\r\nCollecting markdown==2.2.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\nCollecting bleach==1.5.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\n  Using cached bleach-1.5.0-py2.py3-none-any.whl\r\nCollecting html5lib==0.9999999 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\nInstalling collected packages: six, protobuf, werkzeug, markdown, html5lib, bleach, tensorflow-tensorboard, tensorflow\r\nSuccessfully installed bleach-1.5.0 html5lib-0.9999999 markdown-2.2.0 protobuf-3.3.0 six-1.10.0 tensorflow-1.3.0rc2 tensorflow-tensorboard-0.1.2 werkzeug-0.12.2\r\nDone; everything checks out.\r\n\r\n$ ./examine.sh 583\r\nRunning virtualenv with interpreter /usr/bin/python3\r\nUsing base prefix '/usr'\r\nNew python executable in /tmp/tmp.Iwv3luN526/bin/python3\r\nAlso creating executable in /tmp/tmp.Iwv3luN526/bin/python\r\nInstalling setuptools, pip, wheel...done.\r\nCollecting numpy==1.11.0\r\n  Using cached numpy-1.11.0-cp34-cp34m-manylinux1_x86_64.whl\r\nInstalling collected packages: numpy\r\nSuccessfully installed numpy-1.11.0\r\nCollecting tensorflow==1.head from https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/583/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl\r\n  Downloading https://ci.tensorflow.org/view/Nightly/job/nightly-matrix-cpu/TF_BUILD_IS_OPT=OPT,TF_BUILD_IS_PIP=PIP,TF_BUILD_PYTHON_VERSION=PYTHON3,label=cpu-slave/583/artifact/pip_test/whl/tensorflow-1.head-cp34-cp34m-linux_x86_64.whl (46.4MB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 46.4MB 32kB/s \r\nRequirement already satisfied: numpy>=1.11.0 in ./tmp.Iwv3luN526/lib/python3.4/site-packages (from tensorflow==1.head)\r\nCollecting protobuf>=3.3.0 (from tensorflow==1.head)\r\n  Using cached protobuf-3.3.0-cp34-cp34m-manylinux1_x86_64.whl\r\nRequirement already satisfied: wheel>=0.26 in ./tmp.Iwv3luN526/lib/python3.4/site-packages (from tensorflow==1.head)\r\nCollecting autograd>=1.1.11 (from tensorflow==1.head)\r\nCollecting six>=1.10.0 (from tensorflow==1.head)\r\n  Using cached six-1.10.0-py2.py3-none-any.whl\r\nCollecting tensorflow-tensorboard<0.2.0,>=0.1.0 (from tensorflow==1.head)\r\n  Using cached tensorflow_tensorboard-0.1.2-py3-none-any.whl\r\nRequirement already satisfied: setuptools in ./tmp.Iwv3luN526/lib/python3.4/site-packages (from protobuf>=3.3.0->tensorflow==1.head)\r\nCollecting scipy>=0.17 (from autograd>=1.1.11->tensorflow==1.head)\r\n  Using cached scipy-0.19.1-cp34-cp34m-manylinux1_x86_64.whl\r\nCollecting future>=0.15.2 (from autograd>=1.1.11->tensorflow==1.head)\r\nCollecting werkzeug>=0.11.10 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\n  Using cached Werkzeug-0.12.2-py2.py3-none-any.whl\r\nCollecting markdown==2.2.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\nCollecting html5lib==0.9999999 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\nCollecting bleach==1.5.0 (from tensorflow-tensorboard<0.2.0,>=0.1.0->tensorflow==1.head)\r\n  Using cached bleach-1.5.0-py2.py3-none-any.whl\r\nInstalling collected packages: six, protobuf, scipy, future, autograd, werkzeug, markdown, html5lib, bleach, tensorflow-tensorboard, tensorflow\r\nSuccessfully installed autograd-1.1.11 bleach-1.5.0 future-0.16.0 html5lib-0.9999999 markdown-2.2.0 protobuf-3.3.0 scipy-0.19.1 six-1.10.0 tensorflow-1.3.0rc2 tensorflow-tensorboard-0.1.2 werkzeug-0.12.2\r\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\r\nRuntimeError: module compiled against API version 0xb but this version of numpy is 0xa\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/__init__.py\", line 24, in <module>\r\n    from tensorflow.python import *\r\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/__init__.py\", line 49, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow.py\", line 41, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/site-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n  File \"/tmp/tmp.Iwv3luN526/lib/python3.4/imp.py\", line 243, in load_module\r\n    return load_dynamic(name, filename, file)\r\nSystemError: initialization of _pywrap_tensorflow_internal raised unreported exception\r\n```\r\n\r\n[1]: https://github.com/tensorflow/tensorflow/blob/ed7d08eaf92cb9dbc96a09ec6e08d0a93b70a61b/tensorflow/tools/pip_package/setup.py#L35"}