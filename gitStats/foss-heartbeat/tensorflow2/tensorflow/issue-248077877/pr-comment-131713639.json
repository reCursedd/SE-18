{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/131713639", "pull_request_review_id": 54719742, "id": 131713639, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzMTcxMzYzOQ==", "diff_hunk": "@@ -1087,15 +1067,13 @@ void MklLayoutRewritePass::GetNodeProducingMklTensor(std::unique_ptr<Graph>* g,\n   CHECK_NOTNULL(n);\n   CHECK_NOTNULL(mkl_node);\n   CHECK_NOTNULL(mkl_node_output_slot);\n-  if (IsRewrittenNode(n)) {\n-    // If we have visited this node and rewritten it, then it will generate\n-    // an edge that will receive Mkl tensor from a node.\n-    // First, let's assert that this op is Mkl layer.\n-    DataType T;\n-    TF_CHECK_OK(GetNodeAttr(n->def(), \"T\", &T));\n-    // If this op has been rewritten, then its name must have been same as\n-    // Mkl op.\n-    CHECK_EQ(mkl_op_registry::IsMklOp(n->type_string(), T), true);\n+\n+  // If this is an MKL op, then it will create extra output for MKL layout.\n+  DataType T;\n+  if (GetNodeAttr(n->def(), \"T\", &T).ok() &&\n+      mkl_op_registry::IsMklOp(n->type_string(), T)) {", "path": "tensorflow/core/graph/mkl_layout_pass.cc", "position": 45, "original_position": 45, "commit_id": "b35b3d1c5b234426d7b830a7137c20bf0ac5ce69", "original_commit_id": "b35b3d1c5b234426d7b830a7137c20bf0ac5ce69", "user": {"login": "nhasabni", "id": 22304502, "node_id": "MDQ6VXNlcjIyMzA0NTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/22304502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nhasabni", "html_url": "https://github.com/nhasabni", "followers_url": "https://api.github.com/users/nhasabni/followers", "following_url": "https://api.github.com/users/nhasabni/following{/other_user}", "gists_url": "https://api.github.com/users/nhasabni/gists{/gist_id}", "starred_url": "https://api.github.com/users/nhasabni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nhasabni/subscriptions", "organizations_url": "https://api.github.com/users/nhasabni/orgs", "repos_url": "https://api.github.com/users/nhasabni/repos", "events_url": "https://api.github.com/users/nhasabni/events{/privacy}", "received_events_url": "https://api.github.com/users/nhasabni/received_events", "type": "User", "site_admin": false}, "body": "No, there is no performance penalty. IsMklOk function is just a simple predicate, so it is not at all slow.", "created_at": "2017-08-07T17:21:37Z", "updated_at": "2017-08-07T17:21:37Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/12044#discussion_r131713639", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/12044", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/131713639"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/12044#discussion_r131713639"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/12044"}}, "body_html": "<p>No, there is no performance penalty. IsMklOk function is just a simple predicate, so it is not at all slow.</p>", "body_text": "No, there is no performance penalty. IsMklOk function is just a simple predicate, so it is not at all slow.", "in_reply_to_id": 131712733}