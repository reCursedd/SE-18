{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22889", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22889/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22889/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22889/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22889", "id": 369009531, "node_id": "MDU6SXNzdWUzNjkwMDk1MzE=", "number": 22889, "title": "train with multi-gpu with MirroredStrategy will hang-up", "user": {"login": "honeytidy", "id": 1021165, "node_id": "MDQ6VXNlcjEwMjExNjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/1021165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/honeytidy", "html_url": "https://github.com/honeytidy", "followers_url": "https://api.github.com/users/honeytidy/followers", "following_url": "https://api.github.com/users/honeytidy/following{/other_user}", "gists_url": "https://api.github.com/users/honeytidy/gists{/gist_id}", "starred_url": "https://api.github.com/users/honeytidy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/honeytidy/subscriptions", "organizations_url": "https://api.github.com/users/honeytidy/orgs", "repos_url": "https://api.github.com/users/honeytidy/repos", "events_url": "https://api.github.com/users/honeytidy/events{/privacy}", "received_events_url": "https://api.github.com/users/honeytidy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false}], "state": "open", "locked": false, "assignee": {"login": "seemuch", "id": 2233625, "node_id": "MDQ6VXNlcjIyMzM2MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2233625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seemuch", "html_url": "https://github.com/seemuch", "followers_url": "https://api.github.com/users/seemuch/followers", "following_url": "https://api.github.com/users/seemuch/following{/other_user}", "gists_url": "https://api.github.com/users/seemuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/seemuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seemuch/subscriptions", "organizations_url": "https://api.github.com/users/seemuch/orgs", "repos_url": "https://api.github.com/users/seemuch/repos", "events_url": "https://api.github.com/users/seemuch/events{/privacy}", "received_events_url": "https://api.github.com/users/seemuch/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "seemuch", "id": 2233625, "node_id": "MDQ6VXNlcjIyMzM2MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2233625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seemuch", "html_url": "https://github.com/seemuch", "followers_url": "https://api.github.com/users/seemuch/followers", "following_url": "https://api.github.com/users/seemuch/following{/other_user}", "gists_url": "https://api.github.com/users/seemuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/seemuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seemuch/subscriptions", "organizations_url": "https://api.github.com/users/seemuch/orgs", "repos_url": "https://api.github.com/users/seemuch/repos", "events_url": "https://api.github.com/users/seemuch/events{/privacy}", "received_events_url": "https://api.github.com/users/seemuch/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-10-11T08:33:40Z", "updated_at": "2018-11-16T07:04:29Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<p>Have I written custom code: N/A<br>\nOS Platform and Distribution: CentOS Linux release 7.3.1611<br>\nTensorFlow installed from:  (pip install tf-nightly-gpu)<br>\nTensorFlow version: Tensorflow('v1.9.0-rc2-5345-g57d31aa599', '1.12.0-dev20181005')<br>\nBazel version: N/A<br>\nGPU model and memory: Tesla P40 24G<br>\nExact command to reproduce: N/A<br>\nMobile device: N/A<br>\nCUDA/cuDNN version: cuda 9.0 with cudnn7.1.4</p>\n<p>I train with tensorflow for multi-gpu with MirroredStrategy and estimator. I got the problem:<br>\nwhen I set the distribute mode with the following code it will got stuck after runing some training steps:</p>\n<pre><code>distribution = tf.contrib.distribute.MirroredStrategy()\nconfig = tf.estimator.RunConfig(train_distribute=distribution)\nestimator = tf.estimator.Estimator(model_fn=mymodel_fn, model_dir='logs',\n        config=config)\n</code></pre>\n<p>bug when I run without distribute mode like this:</p>\n<pre><code>distribution = tf.contrib.distribute.MirroredStrategy()\nconfig = tf.estimator.RunConfig()\nestimator = tf.estimator.Estimator(model_fn=mymodel_fn, model_dir='logs',\n        config=config)\n</code></pre>\n<p>It runs ok. Why?<br>\nIs that a bug of MirroredStrategy?</p>", "body_text": "System information\nHave I written custom code: N/A\nOS Platform and Distribution: CentOS Linux release 7.3.1611\nTensorFlow installed from:  (pip install tf-nightly-gpu)\nTensorFlow version: Tensorflow('v1.9.0-rc2-5345-g57d31aa599', '1.12.0-dev20181005')\nBazel version: N/A\nGPU model and memory: Tesla P40 24G\nExact command to reproduce: N/A\nMobile device: N/A\nCUDA/cuDNN version: cuda 9.0 with cudnn7.1.4\nI train with tensorflow for multi-gpu with MirroredStrategy and estimator. I got the problem:\nwhen I set the distribute mode with the following code it will got stuck after runing some training steps:\ndistribution = tf.contrib.distribute.MirroredStrategy()\nconfig = tf.estimator.RunConfig(train_distribute=distribution)\nestimator = tf.estimator.Estimator(model_fn=mymodel_fn, model_dir='logs',\n        config=config)\n\nbug when I run without distribute mode like this:\ndistribution = tf.contrib.distribute.MirroredStrategy()\nconfig = tf.estimator.RunConfig()\nestimator = tf.estimator.Estimator(model_fn=mymodel_fn, model_dir='logs',\n        config=config)\n\nIt runs ok. Why?\nIs that a bug of MirroredStrategy?", "body": "### System information\r\nHave I written custom code: N/A\r\nOS Platform and Distribution: CentOS Linux release 7.3.1611\r\nTensorFlow installed from:  (pip install tf-nightly-gpu)\r\nTensorFlow version: Tensorflow('v1.9.0-rc2-5345-g57d31aa599', '1.12.0-dev20181005')\r\nBazel version: N/A\r\nGPU model and memory: Tesla P40 24G\r\nExact command to reproduce: N/A\r\nMobile device: N/A\r\nCUDA/cuDNN version: cuda 9.0 with cudnn7.1.4\r\n\r\nI train with tensorflow for multi-gpu with MirroredStrategy and estimator. I got the problem:\r\nwhen I set the distribute mode with the following code it will got stuck after runing some training steps:\r\n```\r\ndistribution = tf.contrib.distribute.MirroredStrategy()\r\nconfig = tf.estimator.RunConfig(train_distribute=distribution)\r\nestimator = tf.estimator.Estimator(model_fn=mymodel_fn, model_dir='logs',\r\n        config=config)\r\n```\r\nbug when I run without distribute mode like this:\r\n```\r\ndistribution = tf.contrib.distribute.MirroredStrategy()\r\nconfig = tf.estimator.RunConfig()\r\nestimator = tf.estimator.Estimator(model_fn=mymodel_fn, model_dir='logs',\r\n        config=config)\r\n```\r\nIt runs ok. Why? \r\nIs that a bug of MirroredStrategy?\r\n"}