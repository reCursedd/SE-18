{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12589", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12589/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12589/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12589/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12589", "id": 252849962, "node_id": "MDU6SXNzdWUyNTI4NDk5NjI=", "number": 12589, "title": "ValueError: graph_def is invalid at node u'a/Assign': Input tensor 'a:0' Cannot convert a tensor of type string to an input of type string_ref.", "user": {"login": "jiqiujia", "id": 8109984, "node_id": "MDQ6VXNlcjgxMDk5ODQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/8109984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiqiujia", "html_url": "https://github.com/jiqiujia", "followers_url": "https://api.github.com/users/jiqiujia/followers", "following_url": "https://api.github.com/users/jiqiujia/following{/other_user}", "gists_url": "https://api.github.com/users/jiqiujia/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiqiujia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiqiujia/subscriptions", "organizations_url": "https://api.github.com/users/jiqiujia/orgs", "repos_url": "https://api.github.com/users/jiqiujia/repos", "events_url": "https://api.github.com/users/jiqiujia/events{/privacy}", "received_events_url": "https://api.github.com/users/jiqiujia/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-08-25T09:46:31Z", "updated_at": "2017-12-05T02:01:44Z", "closed_at": "2017-12-05T02:01:44Z", "author_association": "NONE", "body_html": "<p>I want to change the input directory for validation using <code>input_map</code> in tf.train.import_meta_graph. Here is the demo code</p>\n<p>For training:</p>\n<pre><code>from tensorflow.core.framework import variable_pb2\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.ops import variables\nfrom tensorflow.python.framework.ops import register_proto_function\n\nregister_proto_function(\n    ops.GraphKeys.LOCAL_VARIABLES,\n    proto_type=variable_pb2.VariableDef,\n    to_proto=variables.Variable.to_proto,\n    from_proto=variables.Variable.from_proto)\na = tf.train.match_filenames_once('data/wxtrain/*', name='a')\nwith tf.Session() as ss:\n    ss.run(tf.group(tf.local_variables_initializer(),tf.global_variables_initializer()))\n    saver = tf.train.Saver(tf.local_variables())\n    saver.save(ss, 'log/model.ckpt')\n    print(ss.run(a, feed_dict={a:'1.'}))\n</code></pre>\n<p>For testing:</p>\n<pre><code>from tensorflow.core.framework import variable_pb2\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.ops import variables\nfrom tensorflow.python.framework.ops import register_proto_function\n\nregister_proto_function(\n    ops.GraphKeys.LOCAL_VARIABLES,\n    proto_type=variable_pb2.VariableDef,\n    to_proto=variables.Variable.to_proto,\n    from_proto=variables.Variable.from_proto)\nnewa = tf.train.match_filenames_once('data/wxtest/*', name='newa')\nlatest = tf.train.latest_checkpoint('log/')\nsaver = tf.train.import_meta_graph(latest+'.meta', \n                                   input_map={'a:0':newa},\n                                   import_scope='import')\nwith tf.Session() as ss:\n    ss.run(tf.group(tf.local_variables_initializer(),tf.global_variables_initializer()))\n    saver.restore(ss, latest)\n    print(\"resume \", latest)\n    print(ss.run(newa, feed_dict={newa:'2.'}))\n</code></pre>\n<p>However, I encounter the following errors:</p>\n<blockquote>\n<p>ValueError: graph_def is invalid at node u'a/Assign': Input tensor 'a:0' Cannot convert a tensor of type string to an input of type string_ref.</p>\n</blockquote>\n<p>I use tensorflow 1.2. It seems to be a bug.</p>", "body_text": "I want to change the input directory for validation using input_map in tf.train.import_meta_graph. Here is the demo code\nFor training:\nfrom tensorflow.core.framework import variable_pb2\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.ops import variables\nfrom tensorflow.python.framework.ops import register_proto_function\n\nregister_proto_function(\n    ops.GraphKeys.LOCAL_VARIABLES,\n    proto_type=variable_pb2.VariableDef,\n    to_proto=variables.Variable.to_proto,\n    from_proto=variables.Variable.from_proto)\na = tf.train.match_filenames_once('data/wxtrain/*', name='a')\nwith tf.Session() as ss:\n    ss.run(tf.group(tf.local_variables_initializer(),tf.global_variables_initializer()))\n    saver = tf.train.Saver(tf.local_variables())\n    saver.save(ss, 'log/model.ckpt')\n    print(ss.run(a, feed_dict={a:'1.'}))\n\nFor testing:\nfrom tensorflow.core.framework import variable_pb2\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.ops import variables\nfrom tensorflow.python.framework.ops import register_proto_function\n\nregister_proto_function(\n    ops.GraphKeys.LOCAL_VARIABLES,\n    proto_type=variable_pb2.VariableDef,\n    to_proto=variables.Variable.to_proto,\n    from_proto=variables.Variable.from_proto)\nnewa = tf.train.match_filenames_once('data/wxtest/*', name='newa')\nlatest = tf.train.latest_checkpoint('log/')\nsaver = tf.train.import_meta_graph(latest+'.meta', \n                                   input_map={'a:0':newa},\n                                   import_scope='import')\nwith tf.Session() as ss:\n    ss.run(tf.group(tf.local_variables_initializer(),tf.global_variables_initializer()))\n    saver.restore(ss, latest)\n    print(\"resume \", latest)\n    print(ss.run(newa, feed_dict={newa:'2.'}))\n\nHowever, I encounter the following errors:\n\nValueError: graph_def is invalid at node u'a/Assign': Input tensor 'a:0' Cannot convert a tensor of type string to an input of type string_ref.\n\nI use tensorflow 1.2. It seems to be a bug.", "body": "I want to change the input directory for validation using `input_map` in tf.train.import_meta_graph. Here is the demo code\r\n\r\nFor training:\r\n```\r\nfrom tensorflow.core.framework import variable_pb2\r\nfrom tensorflow.python.framework import ops\r\nfrom tensorflow.python.ops import variables\r\nfrom tensorflow.python.framework.ops import register_proto_function\r\n\r\nregister_proto_function(\r\n    ops.GraphKeys.LOCAL_VARIABLES,\r\n    proto_type=variable_pb2.VariableDef,\r\n    to_proto=variables.Variable.to_proto,\r\n    from_proto=variables.Variable.from_proto)\r\na = tf.train.match_filenames_once('data/wxtrain/*', name='a')\r\nwith tf.Session() as ss:\r\n    ss.run(tf.group(tf.local_variables_initializer(),tf.global_variables_initializer()))\r\n    saver = tf.train.Saver(tf.local_variables())\r\n    saver.save(ss, 'log/model.ckpt')\r\n    print(ss.run(a, feed_dict={a:'1.'}))\r\n```\r\nFor testing:\r\n```\r\nfrom tensorflow.core.framework import variable_pb2\r\nfrom tensorflow.python.framework import ops\r\nfrom tensorflow.python.ops import variables\r\nfrom tensorflow.python.framework.ops import register_proto_function\r\n\r\nregister_proto_function(\r\n    ops.GraphKeys.LOCAL_VARIABLES,\r\n    proto_type=variable_pb2.VariableDef,\r\n    to_proto=variables.Variable.to_proto,\r\n    from_proto=variables.Variable.from_proto)\r\nnewa = tf.train.match_filenames_once('data/wxtest/*', name='newa')\r\nlatest = tf.train.latest_checkpoint('log/')\r\nsaver = tf.train.import_meta_graph(latest+'.meta', \r\n                                   input_map={'a:0':newa},\r\n                                   import_scope='import')\r\nwith tf.Session() as ss:\r\n    ss.run(tf.group(tf.local_variables_initializer(),tf.global_variables_initializer()))\r\n    saver.restore(ss, latest)\r\n    print(\"resume \", latest)\r\n    print(ss.run(newa, feed_dict={newa:'2.'}))\r\n```\r\nHowever, I encounter the following errors:\r\n\r\n> ValueError: graph_def is invalid at node u'a/Assign': Input tensor 'a:0' Cannot convert a tensor of type string to an input of type string_ref.\r\n\r\nI use tensorflow 1.2. It seems to be a bug."}