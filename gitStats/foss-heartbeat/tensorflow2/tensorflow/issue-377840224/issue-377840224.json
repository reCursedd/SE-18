{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23554", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23554/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23554/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23554/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23554", "id": 377840224, "node_id": "MDU6SXNzdWUzNzc4NDAyMjQ=", "number": 23554, "title": "Build of tensorflow==1.12.0 on broadwell fails", "user": {"login": "ziky90", "id": 1810839, "node_id": "MDQ6VXNlcjE4MTA4Mzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1810839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ziky90", "html_url": "https://github.com/ziky90", "followers_url": "https://api.github.com/users/ziky90/followers", "following_url": "https://api.github.com/users/ziky90/following{/other_user}", "gists_url": "https://api.github.com/users/ziky90/gists{/gist_id}", "starred_url": "https://api.github.com/users/ziky90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ziky90/subscriptions", "organizations_url": "https://api.github.com/users/ziky90/orgs", "repos_url": "https://api.github.com/users/ziky90/repos", "events_url": "https://api.github.com/users/ziky90/events{/privacy}", "received_events_url": "https://api.github.com/users/ziky90/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-11-06T13:12:12Z", "updated_at": "2018-11-18T11:32:05Z", "closed_at": "2018-11-08T10:06:09Z", "author_association": "CONTRIBUTOR", "body_html": "<p><strong>System information</strong></p>\n<ul>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04</li>\n<li>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A</li>\n<li>TensorFlow installed from (source or binary): source</li>\n<li>TensorFlow version: 1.12.0</li>\n<li>Python version: 3.6.5</li>\n<li>Installed using virtualenv? pip? conda?: no</li>\n<li>Bazel version (if compiling from source): 0.19.0</li>\n<li>GCC/Compiler version (if compiling from source): 7.3</li>\n<li>CUDA/cuDNN version: N/A</li>\n<li>GPU model and memory: N/A</li>\n</ul>\n<p><strong>Describe the problem</strong><br>\nI'm unable to build tensorflow for CPU from source.<br>\nI'm using command <code>bazel build --verbose_failures -c opt --copt=-march=native --copt=-mfpmath=both -k //tensorflow/tools/pip_package:build_pip_package</code><br>\nFor tensorflow==1.12.0 I'm getting:</p>\n<pre><code>INFO: From Compiling tensorflow/contrib/lite/toco/import_tensorflow.cc:\nIn file included from external/gemmlowp/fixedpoint/fixedpoint.h:874:0,\n                 from ./tensorflow/contrib/lite/kernels/internal/common.h:48,\n                 from ./tensorflow/contrib/lite/toco/runtime/types.h:18,\n                 from ./tensorflow/contrib/lite/toco/model.h:28,\n                 from ./tensorflow/contrib/lite/toco/import_tensorflow.h:20,\n                 from tensorflow/contrib/lite/toco/import_tensorflow.cc:15:\nexternal/gemmlowp/fixedpoint/./fixedpoint_sse.h:43:39: warning: ignoring attributes on template argument '__m128i {aka __vector(2) long long int}' [-Wignored-attributes]\n struct FixedPointRawTypeTraits&lt;__m128i&gt; {\n                                       ^\nINFO: From Compiling tensorflow/python/framework/fast_tensor_util.cpp:\nIn file included from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/ndarraytypes.h:1821:0,\n                 from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/ndarrayobject.h:18,\n                 from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/arrayobject.h:4,\n                 from bazel-out/k8-fastbuild/genfiles/tensorflow/python/framework/fast_tensor_util.cpp:581:\nbazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/npy_1_7_deprecated_api.h:15:2: warning: #warning \"Using deprecated NumPy API, disable it by \" \"#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-Wcpp]\n #warning \"Using deprecated NumPy API, disable it by \" \\\n  ^~~~~~~\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 4582.121s, Critical Path: 791.83s, Remote (0.00% of the time): [queue: 0.00%, setup: 0.00%, process: 0.00%]\nINFO: 7555 processes: 4 local, 7551 processwrapper-sandbox.\nFAILED: Build did NOT complete successfully\nFAILED: Build did NOT complete successfully\n</code></pre>\n<p><strong>Provide the exact sequence of commands / steps that you executed before running into the problem</strong></p>\n<pre><code>export CC_OPT_FLAGS=\"-march=native\"\n./configure\nbazel build -c opt --copt=-march=native --copt=-mfpmath=both -k //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<p>I'm trying this on the GCE, 32 core broadwell machine in the <code>us-central1-f</code> zone.</p>\n<p><strong>Any other info / logs</strong><br>\nI've also tried to build the package by:</p>\n<pre><code>export CC_OPT_FLAGS=\"-march=native\"\n./configure\nbazel build --verbose_failures --config=opt -k //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<p>Getting exactly the sameproblem.</p>\n<p><strong>EDIT:</strong><br>\nI've tried exactly the same bazel build command with tensorflow==1.11.0 and everything works well. Unfortunately I'd like to use tensorflow==1.12.0 this way. Are there some specific things I've to change for building tensorflow==1.12.0?</p>\n<p><strong>EDIT2:</strong><br>\nAfter a bit of searching and trying different stuff, such as installing <code>libc-ares-dev</code>. I was able to find in the stack trace following error:</p>\n<pre><code>ERROR: /tensorflow/tensorflow/python/BUILD:3865:1: Linking of rule '//tensorflow/python:_pywrap_tensorflow_internal.so' failed (Exit 1) gcc failed: error executing command /usr/bin/gcc -shared -o bazel-out/host/bin/tensorflow/python/_pywrap_tensorflow_internal.so -Wl,--version-script bazel-out/host/bin/tensorflow/python/pywrap_tensorflow_internal_versionscript.lds ... (remaining 66 argument(s) skipped)\n\nUse --sandbox_debug to see verbose messages from the sandbox\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_begin'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_next'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_find'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_read'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_istream_from_buffer'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_varint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_tag'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_skip_field'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_make_string_substream'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_close_string_substream'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_noinit'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_delimited'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_svarint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_fixed32'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_fixed64'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_ostream_from_buffer'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_write'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_varint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_svarint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_fixed32'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_fixed64'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_tag'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_tag_for_field'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_get_encoded_size'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_string'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_submessage'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_delimited'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\n</code></pre>", "body_text": "System information\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\nTensorFlow installed from (source or binary): source\nTensorFlow version: 1.12.0\nPython version: 3.6.5\nInstalled using virtualenv? pip? conda?: no\nBazel version (if compiling from source): 0.19.0\nGCC/Compiler version (if compiling from source): 7.3\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\n\nDescribe the problem\nI'm unable to build tensorflow for CPU from source.\nI'm using command bazel build --verbose_failures -c opt --copt=-march=native --copt=-mfpmath=both -k //tensorflow/tools/pip_package:build_pip_package\nFor tensorflow==1.12.0 I'm getting:\nINFO: From Compiling tensorflow/contrib/lite/toco/import_tensorflow.cc:\nIn file included from external/gemmlowp/fixedpoint/fixedpoint.h:874:0,\n                 from ./tensorflow/contrib/lite/kernels/internal/common.h:48,\n                 from ./tensorflow/contrib/lite/toco/runtime/types.h:18,\n                 from ./tensorflow/contrib/lite/toco/model.h:28,\n                 from ./tensorflow/contrib/lite/toco/import_tensorflow.h:20,\n                 from tensorflow/contrib/lite/toco/import_tensorflow.cc:15:\nexternal/gemmlowp/fixedpoint/./fixedpoint_sse.h:43:39: warning: ignoring attributes on template argument '__m128i {aka __vector(2) long long int}' [-Wignored-attributes]\n struct FixedPointRawTypeTraits<__m128i> {\n                                       ^\nINFO: From Compiling tensorflow/python/framework/fast_tensor_util.cpp:\nIn file included from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/ndarraytypes.h:1821:0,\n                 from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/ndarrayobject.h:18,\n                 from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/arrayobject.h:4,\n                 from bazel-out/k8-fastbuild/genfiles/tensorflow/python/framework/fast_tensor_util.cpp:581:\nbazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/npy_1_7_deprecated_api.h:15:2: warning: #warning \"Using deprecated NumPy API, disable it by \" \"#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-Wcpp]\n #warning \"Using deprecated NumPy API, disable it by \" \\\n  ^~~~~~~\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 4582.121s, Critical Path: 791.83s, Remote (0.00% of the time): [queue: 0.00%, setup: 0.00%, process: 0.00%]\nINFO: 7555 processes: 4 local, 7551 processwrapper-sandbox.\nFAILED: Build did NOT complete successfully\nFAILED: Build did NOT complete successfully\n\nProvide the exact sequence of commands / steps that you executed before running into the problem\nexport CC_OPT_FLAGS=\"-march=native\"\n./configure\nbazel build -c opt --copt=-march=native --copt=-mfpmath=both -k //tensorflow/tools/pip_package:build_pip_package\n\nI'm trying this on the GCE, 32 core broadwell machine in the us-central1-f zone.\nAny other info / logs\nI've also tried to build the package by:\nexport CC_OPT_FLAGS=\"-march=native\"\n./configure\nbazel build --verbose_failures --config=opt -k //tensorflow/tools/pip_package:build_pip_package\n\nGetting exactly the sameproblem.\nEDIT:\nI've tried exactly the same bazel build command with tensorflow==1.11.0 and everything works well. Unfortunately I'd like to use tensorflow==1.12.0 this way. Are there some specific things I've to change for building tensorflow==1.12.0?\nEDIT2:\nAfter a bit of searching and trying different stuff, such as installing libc-ares-dev. I was able to find in the stack trace following error:\nERROR: /tensorflow/tensorflow/python/BUILD:3865:1: Linking of rule '//tensorflow/python:_pywrap_tensorflow_internal.so' failed (Exit 1) gcc failed: error executing command /usr/bin/gcc -shared -o bazel-out/host/bin/tensorflow/python/_pywrap_tensorflow_internal.so -Wl,--version-script bazel-out/host/bin/tensorflow/python/pywrap_tensorflow_internal_versionscript.lds ... (remaining 66 argument(s) skipped)\n\nUse --sandbox_debug to see verbose messages from the sandbox\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_begin'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_next'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_find'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_read'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_istream_from_buffer'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_varint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_tag'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_skip_field'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_make_string_substream'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_close_string_substream'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_noinit'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_delimited'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_svarint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_fixed32'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_fixed64'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_ostream_from_buffer'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_write'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_varint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_svarint'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_fixed32'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_fixed64'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_tag'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_tag_for_field'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_get_encoded_size'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_string'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_submessage'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_delimited'\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 1.12.0\r\n- Python version: 3.6.5\r\n- Installed using virtualenv? pip? conda?: no\r\n- Bazel version (if compiling from source): 0.19.0\r\n- GCC/Compiler version (if compiling from source): 7.3\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n\r\n\r\n**Describe the problem**\r\nI'm unable to build tensorflow for CPU from source.\r\nI'm using command `bazel build --verbose_failures -c opt --copt=-march=native --copt=-mfpmath=both -k //tensorflow/tools/pip_package:build_pip_package`\r\nFor tensorflow==1.12.0 I'm getting:\r\n```\r\nINFO: From Compiling tensorflow/contrib/lite/toco/import_tensorflow.cc:\r\nIn file included from external/gemmlowp/fixedpoint/fixedpoint.h:874:0,\r\n                 from ./tensorflow/contrib/lite/kernels/internal/common.h:48,\r\n                 from ./tensorflow/contrib/lite/toco/runtime/types.h:18,\r\n                 from ./tensorflow/contrib/lite/toco/model.h:28,\r\n                 from ./tensorflow/contrib/lite/toco/import_tensorflow.h:20,\r\n                 from tensorflow/contrib/lite/toco/import_tensorflow.cc:15:\r\nexternal/gemmlowp/fixedpoint/./fixedpoint_sse.h:43:39: warning: ignoring attributes on template argument '__m128i {aka __vector(2) long long int}' [-Wignored-attributes]\r\n struct FixedPointRawTypeTraits<__m128i> {\r\n                                       ^\r\nINFO: From Compiling tensorflow/python/framework/fast_tensor_util.cpp:\r\nIn file included from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/ndarraytypes.h:1821:0,\r\n                 from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/ndarrayobject.h:18,\r\n                 from bazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/arrayobject.h:4,\r\n                 from bazel-out/k8-fastbuild/genfiles/tensorflow/python/framework/fast_tensor_util.cpp:581:\r\nbazel-out/k8-fastbuild/genfiles/external/local_config_python/numpy_include/numpy/npy_1_7_deprecated_api.h:15:2: warning: #warning \"Using deprecated NumPy API, disable it by \" \"#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-Wcpp]\r\n #warning \"Using deprecated NumPy API, disable it by \" \\\r\n  ^~~~~~~\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 4582.121s, Critical Path: 791.83s, Remote (0.00% of the time): [queue: 0.00%, setup: 0.00%, process: 0.00%]\r\nINFO: 7555 processes: 4 local, 7551 processwrapper-sandbox.\r\nFAILED: Build did NOT complete successfully\r\nFAILED: Build did NOT complete successfully\r\n```\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n```\r\nexport CC_OPT_FLAGS=\"-march=native\"\r\n./configure\r\nbazel build -c opt --copt=-march=native --copt=-mfpmath=both -k //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n\r\nI'm trying this on the GCE, 32 core broadwell machine in the `us-central1-f` zone.\r\n\r\n**Any other info / logs**\r\nI've also tried to build the package by:\r\n```\r\nexport CC_OPT_FLAGS=\"-march=native\"\r\n./configure\r\nbazel build --verbose_failures --config=opt -k //tensorflow/tools/pip_package:build_pip_package\r\n```\r\nGetting exactly the sameproblem.\r\n\r\n**EDIT:**\r\nI've tried exactly the same bazel build command with tensorflow==1.11.0 and everything works well. Unfortunately I'd like to use tensorflow==1.12.0 this way. Are there some specific things I've to change for building tensorflow==1.12.0?\r\n\r\n**EDIT2:**\r\nAfter a bit of searching and trying different stuff, such as installing `libc-ares-dev`. I was able to find in the stack trace following error:\r\n```\r\nERROR: /tensorflow/tensorflow/python/BUILD:3865:1: Linking of rule '//tensorflow/python:_pywrap_tensorflow_internal.so' failed (Exit 1) gcc failed: error executing command /usr/bin/gcc -shared -o bazel-out/host/bin/tensorflow/python/_pywrap_tensorflow_internal.so -Wl,--version-script bazel-out/host/bin/tensorflow/python/pywrap_tensorflow_internal_versionscript.lds ... (remaining 66 argument(s) skipped)\r\n\r\nUse --sandbox_debug to see verbose messages from the sandbox\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_begin'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_next'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_common.pic.o: multiple definition of 'pb_field_iter_find'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_common.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_read'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_istream_from_buffer'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_varint'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_tag'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_skip_field'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_make_string_substream'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_close_string_substream'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_noinit'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_delimited'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_svarint'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_fixed32'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_decode.pic.o: multiple definition of 'pb_decode_fixed64'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_decode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_ostream_from_buffer'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_write'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_varint'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_svarint'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_fixed32'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_fixed64'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_tag'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_tag_for_field'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_get_encoded_size'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_string'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_submessage'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\n/usr/bin/ld.gold: error: bazel-out/host/bin/external/grpc/_objs/grpc_nanopb/pb_encode.pic.o: multiple definition of 'pb_encode_delimited'\r\n/usr/bin/ld.gold: bazel-out/host/bin/external/grpc/third_party/nanopb/_objs/nanopb/pb_encode.pic.o: previous definition here\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n```"}