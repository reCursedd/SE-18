{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8151", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8151/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8151/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8151/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8151", "id": 212309993, "node_id": "MDU6SXNzdWUyMTIzMDk5OTM=", "number": 8151, "title": "Calling Generic conv with data_format='NCHW' Leads to Segfault", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "zheng-xq", "id": 15736910, "node_id": "MDQ6VXNlcjE1NzM2OTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/15736910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zheng-xq", "html_url": "https://github.com/zheng-xq", "followers_url": "https://api.github.com/users/zheng-xq/followers", "following_url": "https://api.github.com/users/zheng-xq/following{/other_user}", "gists_url": "https://api.github.com/users/zheng-xq/gists{/gist_id}", "starred_url": "https://api.github.com/users/zheng-xq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zheng-xq/subscriptions", "organizations_url": "https://api.github.com/users/zheng-xq/orgs", "repos_url": "https://api.github.com/users/zheng-xq/repos", "events_url": "https://api.github.com/users/zheng-xq/events{/privacy}", "received_events_url": "https://api.github.com/users/zheng-xq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "zheng-xq", "id": 15736910, "node_id": "MDQ6VXNlcjE1NzM2OTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/15736910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zheng-xq", "html_url": "https://github.com/zheng-xq", "followers_url": "https://api.github.com/users/zheng-xq/followers", "following_url": "https://api.github.com/users/zheng-xq/following{/other_user}", "gists_url": "https://api.github.com/users/zheng-xq/gists{/gist_id}", "starred_url": "https://api.github.com/users/zheng-xq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zheng-xq/subscriptions", "organizations_url": "https://api.github.com/users/zheng-xq/orgs", "repos_url": "https://api.github.com/users/zheng-xq/repos", "events_url": "https://api.github.com/users/zheng-xq/events{/privacy}", "received_events_url": "https://api.github.com/users/zheng-xq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2017-03-07T02:14:57Z", "updated_at": "2018-03-16T00:53:32Z", "closed_at": "2017-06-16T17:51:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Running on 1.0.0.2 Docker image, this code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">from</span> tensorflow.python.ops <span class=\"pl-k\">import</span> nn_ops\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n\nimages <span class=\"pl-k\">=</span> np.ones((<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">15</span>,<span class=\"pl-c1\">1</span>)).astype(np.float32)\nfilters <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">*</span> np.ones((<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>), np.float32)\n\n<span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span>):\n  output <span class=\"pl-k\">=</span> nn_ops.conv2d(\n      images,\n      filters,\n      <span class=\"pl-v\">strides</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">1</span>],\n      <span class=\"pl-v\">padding</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>VALID<span class=\"pl-pds\">'</span></span>,\n      <span class=\"pl-v\">data_format</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>NCHW<span class=\"pl-pds\">'</span></span>,\n  ).eval()</pre></div>\n<p>yields:</p>\n<pre><code>F tensorflow/core/kernels/conv_ops.cc:65] Check failed: data_format == FORMAT_NHWC Generic conv implementation only supports NHWC te\nnsor format for now.\nAborted (core dumped)\n</code></pre>\n<p>While it does print a helpful error message, it then proceeds to core dump.</p>\n<p>I also see this issue on macOS</p>", "body_text": "Running on 1.0.0.2 Docker image, this code:\nfrom tensorflow.python.ops import nn_ops\nimport tensorflow as tf\nimport numpy as np\n\nimages = np.ones((1,1,15,1)).astype(np.float32)\nfilters = 1 * np.ones((1,1,1,1), np.float32)\n\nwith tf.Session(''):\n  output = nn_ops.conv2d(\n      images,\n      filters,\n      strides=[1,1,1,1],\n      padding='VALID',\n      data_format='NCHW',\n  ).eval()\nyields:\nF tensorflow/core/kernels/conv_ops.cc:65] Check failed: data_format == FORMAT_NHWC Generic conv implementation only supports NHWC te\nnsor format for now.\nAborted (core dumped)\n\nWhile it does print a helpful error message, it then proceeds to core dump.\nI also see this issue on macOS", "body": "Running on 1.0.0.2 Docker image, this code:\r\n```python\r\n\r\nfrom tensorflow.python.ops import nn_ops\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nimages = np.ones((1,1,15,1)).astype(np.float32)\r\nfilters = 1 * np.ones((1,1,1,1), np.float32)\r\n\r\nwith tf.Session(''):\r\n  output = nn_ops.conv2d(\r\n      images,\r\n      filters,\r\n      strides=[1,1,1,1],\r\n      padding='VALID',\r\n      data_format='NCHW',\r\n  ).eval()\r\n```\r\nyields:\r\n```\r\nF tensorflow/core/kernels/conv_ops.cc:65] Check failed: data_format == FORMAT_NHWC Generic conv implementation only supports NHWC te\r\nnsor format for now.\r\nAborted (core dumped)\r\n```\r\nWhile it does print a helpful error message, it then proceeds to core dump.\r\n\r\nI also see this issue on macOS"}