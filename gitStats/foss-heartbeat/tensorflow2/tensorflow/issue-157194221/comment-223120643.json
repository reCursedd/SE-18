{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/223120643", "html_url": "https://github.com/tensorflow/tensorflow/issues/2536#issuecomment-223120643", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2536", "id": 223120643, "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzEyMDY0Mw==", "user": {"login": "ivdorelian", "id": 2019410, "node_id": "MDQ6VXNlcjIwMTk0MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/2019410?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivdorelian", "html_url": "https://github.com/ivdorelian", "followers_url": "https://api.github.com/users/ivdorelian/followers", "following_url": "https://api.github.com/users/ivdorelian/following{/other_user}", "gists_url": "https://api.github.com/users/ivdorelian/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivdorelian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivdorelian/subscriptions", "organizations_url": "https://api.github.com/users/ivdorelian/orgs", "repos_url": "https://api.github.com/users/ivdorelian/repos", "events_url": "https://api.github.com/users/ivdorelian/events{/privacy}", "received_events_url": "https://api.github.com/users/ivdorelian/received_events", "type": "User", "site_admin": false}, "created_at": "2016-06-01T20:51:16Z", "updated_at": "2016-06-01T20:51:16Z", "author_association": "NONE", "body_html": "<p>I have this:</p>\n<pre><code>genrule(\n    name = \"configure\",\n    srcs = glob(\n        [\"**/*\"],\n        exclude = [prefix_dir + \"/config.h\"],\n    ),\n    outs = [prefix_dir + \"/config.h\"],\n    cmd = \"\\n\".join([\n       \"export LD_LIBRARY_PATH='/home/mateinfo/vlad/bin/zlibdev/lib'\",\n       \"export CPATH='/home/mateinfo/vlad/bin/zlibdev/include'\",\n       \"export PKG_CONFIG_PATH='/home/mateinfo/vlad/bin/zlibdev/lib/pkgconfig'\",\n        \"pushd external/png_archive/\" + prefix_dir,\n        \"workdir=$$(mktemp -d -t tmp.XXXXXXXXXX)\",\n        \"cp -a * $$workdir\",\n        \"pushd $$workdir\",\n        \"./configure --enable-shared=no --with-pic=no\",\n        \"popd\",\n        \"popd\",\n        \"cp $$workdir/config.h $(@D)\",\n        \"rm -rf $$workdir\",\n    ]),\n)\n</code></pre>\n<p>But the same error appears. If I run:</p>\n<p><code>bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package</code></p>\n<p>Then I get:</p>\n<pre><code>ERROR: /home/mateinfo/vlad/.cache/bazel/_bazel_vlad/6607a39fc04ec931b523fac975ff3100/external/grpc/BUILD:485:1: C++ compilation of rule '@grpc//:grpc_unsecure' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object ... (remaining 40 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nexternal/grpc/src/core/compression/message_compress.c:41:18: fatal error: zlib.h: No such file or directory\n #include &lt;zlib.h&gt;\n                  ^\ncompilation terminated.\n</code></pre>\n<p>zlib.h is in the CPATH location:</p>\n<pre><code>[vlad@headnode ~]$ ls /home/mateinfo/vlad/bin/zlibdev/include\nzconf.h  zlib.h\n</code></pre>\n<p>Have I edited the cmd line wrong?</p>", "body_text": "I have this:\ngenrule(\n    name = \"configure\",\n    srcs = glob(\n        [\"**/*\"],\n        exclude = [prefix_dir + \"/config.h\"],\n    ),\n    outs = [prefix_dir + \"/config.h\"],\n    cmd = \"\\n\".join([\n       \"export LD_LIBRARY_PATH='/home/mateinfo/vlad/bin/zlibdev/lib'\",\n       \"export CPATH='/home/mateinfo/vlad/bin/zlibdev/include'\",\n       \"export PKG_CONFIG_PATH='/home/mateinfo/vlad/bin/zlibdev/lib/pkgconfig'\",\n        \"pushd external/png_archive/\" + prefix_dir,\n        \"workdir=$$(mktemp -d -t tmp.XXXXXXXXXX)\",\n        \"cp -a * $$workdir\",\n        \"pushd $$workdir\",\n        \"./configure --enable-shared=no --with-pic=no\",\n        \"popd\",\n        \"popd\",\n        \"cp $$workdir/config.h $(@D)\",\n        \"rm -rf $$workdir\",\n    ]),\n)\n\nBut the same error appears. If I run:\nbazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\nThen I get:\nERROR: /home/mateinfo/vlad/.cache/bazel/_bazel_vlad/6607a39fc04ec931b523fac975ff3100/external/grpc/BUILD:485:1: C++ compilation of rule '@grpc//:grpc_unsecure' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object ... (remaining 40 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nexternal/grpc/src/core/compression/message_compress.c:41:18: fatal error: zlib.h: No such file or directory\n #include <zlib.h>\n                  ^\ncompilation terminated.\n\nzlib.h is in the CPATH location:\n[vlad@headnode ~]$ ls /home/mateinfo/vlad/bin/zlibdev/include\nzconf.h  zlib.h\n\nHave I edited the cmd line wrong?", "body": "I have this:\n\n```\ngenrule(\n    name = \"configure\",\n    srcs = glob(\n        [\"**/*\"],\n        exclude = [prefix_dir + \"/config.h\"],\n    ),\n    outs = [prefix_dir + \"/config.h\"],\n    cmd = \"\\n\".join([\n       \"export LD_LIBRARY_PATH='/home/mateinfo/vlad/bin/zlibdev/lib'\",\n       \"export CPATH='/home/mateinfo/vlad/bin/zlibdev/include'\",\n       \"export PKG_CONFIG_PATH='/home/mateinfo/vlad/bin/zlibdev/lib/pkgconfig'\",\n        \"pushd external/png_archive/\" + prefix_dir,\n        \"workdir=$$(mktemp -d -t tmp.XXXXXXXXXX)\",\n        \"cp -a * $$workdir\",\n        \"pushd $$workdir\",\n        \"./configure --enable-shared=no --with-pic=no\",\n        \"popd\",\n        \"popd\",\n        \"cp $$workdir/config.h $(@D)\",\n        \"rm -rf $$workdir\",\n    ]),\n)\n```\n\nBut the same error appears. If I run:\n\n`bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package`\n\nThen I get:\n\n```\nERROR: /home/mateinfo/vlad/.cache/bazel/_bazel_vlad/6607a39fc04ec931b523fac975ff3100/external/grpc/BUILD:485:1: C++ compilation of rule '@grpc//:grpc_unsecure' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object ... (remaining 40 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nexternal/grpc/src/core/compression/message_compress.c:41:18: fatal error: zlib.h: No such file or directory\n #include <zlib.h>\n                  ^\ncompilation terminated.\n```\n\nzlib.h is in the CPATH location:\n\n```\n[vlad@headnode ~]$ ls /home/mateinfo/vlad/bin/zlibdev/include\nzconf.h  zlib.h\n```\n\nHave I edited the cmd line wrong?\n"}