{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/278548190", "html_url": "https://github.com/tensorflow/tensorflow/issues/7159#issuecomment-278548190", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7159", "id": 278548190, "node_id": "MDEyOklzc3VlQ29tbWVudDI3ODU0ODE5MA==", "user": {"login": "hakimka", "id": 3639143, "node_id": "MDQ6VXNlcjM2MzkxNDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/3639143?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hakimka", "html_url": "https://github.com/hakimka", "followers_url": "https://api.github.com/users/hakimka/followers", "following_url": "https://api.github.com/users/hakimka/following{/other_user}", "gists_url": "https://api.github.com/users/hakimka/gists{/gist_id}", "starred_url": "https://api.github.com/users/hakimka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hakimka/subscriptions", "organizations_url": "https://api.github.com/users/hakimka/orgs", "repos_url": "https://api.github.com/users/hakimka/repos", "events_url": "https://api.github.com/users/hakimka/events{/privacy}", "received_events_url": "https://api.github.com/users/hakimka/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-09T05:03:56Z", "updated_at": "2017-02-09T05:03:56Z", "author_association": "NONE", "body_html": "<p>I have the similar issue on AWS</p>\n<h3>simple code to create/save a model</h3>\n<p>import tensorflow as tf<br>\nimport sys<br>\nimport numpy as np</p>\n<p>w1 =  tf.Variable(tf.random_normal((2,2)), name=\"w1\")<br>\nw2 =  tf.Variable(tf.random_normal((2,2)), name=\"w2\")<br>\nb1 =  tf.Variable(tf.random_uniform([2],0,100, dtype = tf.int32, seed = 10), name=\"b1\")<br>\nb2 =  tf.Variable(tf.random_uniform([2],0,100, dtype = tf.int32, seed = 1), name=\"b2\")</p>\n<p>saver = tf.train.Saver()<br>\nsess = tf.Session()<br>\nsess.run(tf.initialize_all_variables())</p>\n<p>print sess.run(w1)<br>\nprint sess.run(w2)<br>\nprint sess.run(b1)<br>\nprint sess.run(b2)</p>\n<p>saver.save(sess, 'modW1W2')<br>\nsess.close()</p>\n<h3>a simple script to restore</h3>\n<p>import tensorflow as tf<br>\nimport sys<br>\nimport numpy as np</p>\n<p>w1 =  tf.Variable(tf.zeros((2,2)), name=\"w1\")<br>\nw2 =  tf.Variable(tf.zeros((2,2)), name=\"w2\")<br>\nb1 =  tf.Variable(tf.zeros(2), name=\"b1\")<br>\nb2 =  tf.Variable(tf.zeros(2), name=\"b2\")</p>\n<p>model_saver = tf.train.Saver()<br>\nwith tf.Session() as session:<br>\nmodel_saver.restore(session, 'modW1W2.meta')<br>\nprint(\"Model restored.\")<br>\nprint('Initialized')</p>\n<p>=======================================</p>\n<h3>The error I am getting</h3>\n<p>DataLossErrorTraceback (most recent call last)<br>\n in ()<br>\n12 model_saver = tf.train.Saver()<br>\n13 with tf.Session() as session:<br>\n---&gt; 14     model_saver.restore(session, 'modW1W2.meta')<br>\n15     print(\"Model restored.\")<br>\n16     print('Initialized')</p>\n<p>/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.pyc in restore(self, sess, save_path)<br>\n1343<br>\n1344     sess.run(self.saver_def.restore_op_name,<br>\n-&gt; 1345              {self.saver_def.filename_tensor_name: save_path})<br>\n1346<br>\n1347   <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3434126\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/staticmethod\">@staticmethod</a></p>\n<p>/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict, options, run_metadata)<br>\n715     try:<br>\n716       result = self._run(None, fetches, feed_dict, options_ptr,<br>\n--&gt; 717                          run_metadata_ptr)<br>\n718       if run_metadata:<br>\n719         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)</p>\n<p>/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict, options, run_metadata)<br>\n913     if final_fetches or final_targets:<br>\n914       results = self._do_run(handle, final_targets, final_fetches,<br>\n--&gt; 915                              feed_dict_string, options, run_metadata)<br>\n916     else:<br>\n917       results = []</p>\n<p>/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)<br>\n963     if handle is None:<br>\n964       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,<br>\n--&gt; 965                            target_list, options, run_metadata)<br>\n966     else:<br>\n967       return self._do_call(_prun_fn, self._session, handle, feed_dict,</p>\n<p>/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)<br>\n983         except KeyError:<br>\n984           pass<br>\n--&gt; 985       raise type(e)(node_def, op, message)<br>\n986<br>\n987   def _extend_graph(self):</p>\n<p>DataLossError: Unable to open table file modW1W2.meta: Data loss: not an sstable (bad magic number): perhaps your file is in a different file format and you need to use a different restore operator?<br>\n[[Node: save/restore_slice = RestoreSlice[dt=DT_FLOAT, preferred_shard=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice/tensor_name, save/restore_slice/shape_and_slice)]]<br>\n[[Node: save/restore_slice_2/_7 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_21_save/restore_slice_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"</a>]]</p>\n<p>Caused by op u'save/restore_slice', defined at:<br>\nFile \"/usr/lib/python2.7/runpy.py\", line 162, in _run_module_as_main<br>\n\"<strong>main</strong>\", fname, loader, pkg_name)<br>\nFile \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code<br>\nexec code in run_globals<br>\nFile \"/home/ubuntu/tensorflow/lib/python2.7/site-packages/ipykernel/<strong>main</strong>.py\", line 3, in <br>\napp.launch_new_instance()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance<br>\napp.start()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 474, in start<br>\nioloop.IOLoop.instance().start()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 177, in start<br>\nsuper(ZMQIOLoop, self).start()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/ioloop.py\", line 887, in start<br>\nhandler_func(fd_obj, events)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper<br>\nreturn fn(*args, **kwargs)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events<br>\nself._handle_recv()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv<br>\nself._run_callback(callback, msg)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback<br>\ncallback(*args, **kwargs)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper<br>\nreturn fn(*args, **kwargs)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 276, in dispatcher<br>\nreturn self.dispatch_shell(stream, msg)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 228, in dispatch_shell<br>\nhandler(stream, idents, msg)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 390, in execute_request<br>\nuser_expressions, allow_stdin)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 196, in do_execute<br>\nres = shell.run_cell(code, store_history=store_history, silent=silent)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 501, in run_cell<br>\nreturn super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2717, in run_cell<br>\ninteractivity=interactivity, compiler=compiler, result=result)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2821, in run_ast_nodes<br>\nif self.run_code(code, result):<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_code<br>\nexec(code_obj, self.user_global_ns, self.user_ns)<br>\nFile \"\", line 12, in <br>\nmodel_saver = tf.train.Saver()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 986, in <strong>init</strong><br>\nself.build()<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1015, in build<br>\nrestore_sequentially=self._restore_sequentially)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 620, in build<br>\nrestore_sequentially, reshape)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 357, in _AddRestoreOps<br>\ntensors = self.restore_op(filename_tensor, saveable, preferred_shard)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 270, in restore_op<br>\npreferred_shard=preferred_shard))<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/io_ops.py\", line 204, in _restore_slice<br>\npreferred_shard, name=name)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 359, in _restore_slice<br>\npreferred_shard=preferred_shard, name=name)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op<br>\nop_def=op_def)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1298, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>DataLossError (see above for traceback): Unable to open table file modW1W2.meta: Data loss: not an sstable (bad magic number): perhaps your file is in a different file format and you need to use a different restore operator?<br>\n[[Node: save/restore_slice = RestoreSlice[dt=DT_FLOAT, preferred_shard=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice/tensor_name, save/restore_slice/shape_and_slice)]]<br>\n[[Node: save/restore_slice_2/_7 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_21_save/restore_slice_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"</a>]]</p>", "body_text": "I have the similar issue on AWS\nsimple code to create/save a model\nimport tensorflow as tf\nimport sys\nimport numpy as np\nw1 =  tf.Variable(tf.random_normal((2,2)), name=\"w1\")\nw2 =  tf.Variable(tf.random_normal((2,2)), name=\"w2\")\nb1 =  tf.Variable(tf.random_uniform([2],0,100, dtype = tf.int32, seed = 10), name=\"b1\")\nb2 =  tf.Variable(tf.random_uniform([2],0,100, dtype = tf.int32, seed = 1), name=\"b2\")\nsaver = tf.train.Saver()\nsess = tf.Session()\nsess.run(tf.initialize_all_variables())\nprint sess.run(w1)\nprint sess.run(w2)\nprint sess.run(b1)\nprint sess.run(b2)\nsaver.save(sess, 'modW1W2')\nsess.close()\na simple script to restore\nimport tensorflow as tf\nimport sys\nimport numpy as np\nw1 =  tf.Variable(tf.zeros((2,2)), name=\"w1\")\nw2 =  tf.Variable(tf.zeros((2,2)), name=\"w2\")\nb1 =  tf.Variable(tf.zeros(2), name=\"b1\")\nb2 =  tf.Variable(tf.zeros(2), name=\"b2\")\nmodel_saver = tf.train.Saver()\nwith tf.Session() as session:\nmodel_saver.restore(session, 'modW1W2.meta')\nprint(\"Model restored.\")\nprint('Initialized')\n=======================================\nThe error I am getting\nDataLossErrorTraceback (most recent call last)\n in ()\n12 model_saver = tf.train.Saver()\n13 with tf.Session() as session:\n---> 14     model_saver.restore(session, 'modW1W2.meta')\n15     print(\"Model restored.\")\n16     print('Initialized')\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.pyc in restore(self, sess, save_path)\n1343\n1344     sess.run(self.saver_def.restore_op_name,\n-> 1345              {self.saver_def.filename_tensor_name: save_path})\n1346\n1347   @staticmethod\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n715     try:\n716       result = self._run(None, fetches, feed_dict, options_ptr,\n--> 717                          run_metadata_ptr)\n718       if run_metadata:\n719         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict, options, run_metadata)\n913     if final_fetches or final_targets:\n914       results = self._do_run(handle, final_targets, final_fetches,\n--> 915                              feed_dict_string, options, run_metadata)\n916     else:\n917       results = []\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n963     if handle is None:\n964       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n--> 965                            target_list, options, run_metadata)\n966     else:\n967       return self._do_call(_prun_fn, self._session, handle, feed_dict,\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\n983         except KeyError:\n984           pass\n--> 985       raise type(e)(node_def, op, message)\n986\n987   def _extend_graph(self):\nDataLossError: Unable to open table file modW1W2.meta: Data loss: not an sstable (bad magic number): perhaps your file is in a different file format and you need to use a different restore operator?\n[[Node: save/restore_slice = RestoreSlice[dt=DT_FLOAT, preferred_shard=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice/tensor_name, save/restore_slice/shape_and_slice)]]\n[[Node: save/restore_slice_2/_7 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_21_save/restore_slice_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]]\nCaused by op u'save/restore_slice', defined at:\nFile \"/usr/lib/python2.7/runpy.py\", line 162, in _run_module_as_main\n\"main\", fname, loader, pkg_name)\nFile \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\nexec code in run_globals\nFile \"/home/ubuntu/tensorflow/lib/python2.7/site-packages/ipykernel/main.py\", line 3, in \napp.launch_new_instance()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\napp.start()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 474, in start\nioloop.IOLoop.instance().start()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 177, in start\nsuper(ZMQIOLoop, self).start()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/ioloop.py\", line 887, in start\nhandler_func(fd_obj, events)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\nreturn fn(*args, **kwargs)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\nself._handle_recv()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\nself._run_callback(callback, msg)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\ncallback(*args, **kwargs)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\nreturn fn(*args, **kwargs)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 276, in dispatcher\nreturn self.dispatch_shell(stream, msg)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 228, in dispatch_shell\nhandler(stream, idents, msg)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 390, in execute_request\nuser_expressions, allow_stdin)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 196, in do_execute\nres = shell.run_cell(code, store_history=store_history, silent=silent)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 501, in run_cell\nreturn super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2717, in run_cell\ninteractivity=interactivity, compiler=compiler, result=result)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2821, in run_ast_nodes\nif self.run_code(code, result):\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_code\nexec(code_obj, self.user_global_ns, self.user_ns)\nFile \"\", line 12, in \nmodel_saver = tf.train.Saver()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 986, in init\nself.build()\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1015, in build\nrestore_sequentially=self._restore_sequentially)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 620, in build\nrestore_sequentially, reshape)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 357, in _AddRestoreOps\ntensors = self.restore_op(filename_tensor, saveable, preferred_shard)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 270, in restore_op\npreferred_shard=preferred_shard))\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/io_ops.py\", line 204, in _restore_slice\npreferred_shard, name=name)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 359, in _restore_slice\npreferred_shard=preferred_shard, name=name)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\nop_def=op_def)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1298, in init\nself._traceback = _extract_stack()\nDataLossError (see above for traceback): Unable to open table file modW1W2.meta: Data loss: not an sstable (bad magic number): perhaps your file is in a different file format and you need to use a different restore operator?\n[[Node: save/restore_slice = RestoreSlice[dt=DT_FLOAT, preferred_shard=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice/tensor_name, save/restore_slice/shape_and_slice)]]\n[[Node: save/restore_slice_2/_7 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_21_save/restore_slice_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]]", "body": "I have the similar issue on AWS\r\n\r\n### simple code to create/save a model\r\nimport tensorflow as tf\r\nimport sys\r\nimport numpy as np\r\n\r\n\r\nw1 =  tf.Variable(tf.random_normal((2,2)), name=\"w1\")\r\nw2 =  tf.Variable(tf.random_normal((2,2)), name=\"w2\")\r\nb1 =  tf.Variable(tf.random_uniform([2],0,100, dtype = tf.int32, seed = 10), name=\"b1\")\r\nb2 =  tf.Variable(tf.random_uniform([2],0,100, dtype = tf.int32, seed = 1), name=\"b2\")\r\n\r\nsaver = tf.train.Saver()\r\nsess = tf.Session()\r\nsess.run(tf.initialize_all_variables())\r\n\r\nprint sess.run(w1)\r\nprint sess.run(w2)\r\nprint sess.run(b1)\r\nprint sess.run(b2)\r\n\r\nsaver.save(sess, 'modW1W2')\r\nsess.close()\r\n\r\n### a simple script to restore\r\nimport tensorflow as tf\r\nimport sys\r\nimport numpy as np\r\n\r\nw1 =  tf.Variable(tf.zeros((2,2)), name=\"w1\")\r\nw2 =  tf.Variable(tf.zeros((2,2)), name=\"w2\")\r\nb1 =  tf.Variable(tf.zeros(2), name=\"b1\")\r\nb2 =  tf.Variable(tf.zeros(2), name=\"b2\")\r\n\r\nmodel_saver = tf.train.Saver()\r\nwith tf.Session() as session:\r\n    model_saver.restore(session, 'modW1W2.meta')\r\n    print(\"Model restored.\") \r\n    print('Initialized')\r\n\r\n\r\n=======================================\r\n\r\n### The error I am getting\r\n\r\nDataLossErrorTraceback (most recent call last)\r\n<ipython-input-1-e2eb1ef816ae> in <module>()\r\n     12 model_saver = tf.train.Saver()\r\n     13 with tf.Session() as session:\r\n---> 14     model_saver.restore(session, 'modW1W2.meta')\r\n     15     print(\"Model restored.\")\r\n     16     print('Initialized')\r\n\r\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.pyc in restore(self, sess, save_path)\r\n   1343 \r\n   1344     sess.run(self.saver_def.restore_op_name,\r\n-> 1345              {self.saver_def.filename_tensor_name: save_path})\r\n   1346 \r\n   1347   @staticmethod\r\n\r\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict, options, run_metadata)\r\n    715     try:\r\n    716       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 717                          run_metadata_ptr)\r\n    718       if run_metadata:\r\n    719         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n    913     if final_fetches or final_targets:\r\n    914       results = self._do_run(handle, final_targets, final_fetches,\r\n--> 915                              feed_dict_string, options, run_metadata)\r\n    916     else:\r\n    917       results = []\r\n\r\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n    963     if handle is None:\r\n    964       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\r\n--> 965                            target_list, options, run_metadata)\r\n    966     else:\r\n    967       return self._do_call(_prun_fn, self._session, handle, feed_dict,\r\n\r\n/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\r\n    983         except KeyError:\r\n    984           pass\r\n--> 985       raise type(e)(node_def, op, message)\r\n    986 \r\n    987   def _extend_graph(self):\r\n\r\nDataLossError: Unable to open table file modW1W2.meta: Data loss: not an sstable (bad magic number): perhaps your file is in a different file format and you need to use a different restore operator?\r\n\t [[Node: save/restore_slice = RestoreSlice[dt=DT_FLOAT, preferred_shard=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice/tensor_name, save/restore_slice/shape_and_slice)]]\r\n\t [[Node: save/restore_slice_2/_7 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_21_save/restore_slice_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n\r\nCaused by op u'save/restore_slice', defined at:\r\n  File \"/usr/lib/python2.7/runpy.py\", line 162, in _run_module_as_main\r\n    \"__main__\", fname, loader, pkg_name)\r\n  File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\r\n    exec code in run_globals\r\n  File \"/home/ubuntu/tensorflow/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in <module>\r\n    app.launch_new_instance()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 474, in start\r\n    ioloop.IOLoop.instance().start()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 177, in start\r\n    super(ZMQIOLoop, self).start()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/ioloop.py\", line 887, in start\r\n    handler_func(fd_obj, events)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\r\n    self._handle_recv()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 276, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 228, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 390, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 196, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 501, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2717, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2821, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-1-e2eb1ef816ae>\", line 12, in <module>\r\n    model_saver = tf.train.Saver()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 986, in __init__\r\n    self.build()\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1015, in build\r\n    restore_sequentially=self._restore_sequentially)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 620, in build\r\n    restore_sequentially, reshape)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 357, in _AddRestoreOps\r\n    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 270, in restore_op\r\n    preferred_shard=preferred_shard))\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/io_ops.py\", line 204, in _restore_slice\r\n    preferred_shard, name=name)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 359, in _restore_slice\r\n    preferred_shard=preferred_shard, name=name)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\r\n    op_def=op_def)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/home/ubuntu/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1298, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nDataLossError (see above for traceback): Unable to open table file modW1W2.meta: Data loss: not an sstable (bad magic number): perhaps your file is in a different file format and you need to use a different restore operator?\r\n\t [[Node: save/restore_slice = RestoreSlice[dt=DT_FLOAT, preferred_shard=-1, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save/Const_0, save/restore_slice/tensor_name, save/restore_slice/shape_and_slice)]]\r\n\t [[Node: save/restore_slice_2/_7 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_21_save/restore_slice_2\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n"}