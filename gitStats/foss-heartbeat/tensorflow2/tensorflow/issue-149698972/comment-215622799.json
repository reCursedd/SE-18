{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/215622799", "html_url": "https://github.com/tensorflow/tensorflow/issues/2034#issuecomment-215622799", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2034", "id": 215622799, "node_id": "MDEyOklzc3VlQ29tbWVudDIxNTYyMjc5OQ==", "user": {"login": "stephenroller", "id": 31896, "node_id": "MDQ6VXNlcjMxODk2", "avatar_url": "https://avatars2.githubusercontent.com/u/31896?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stephenroller", "html_url": "https://github.com/stephenroller", "followers_url": "https://api.github.com/users/stephenroller/followers", "following_url": "https://api.github.com/users/stephenroller/following{/other_user}", "gists_url": "https://api.github.com/users/stephenroller/gists{/gist_id}", "starred_url": "https://api.github.com/users/stephenroller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stephenroller/subscriptions", "organizations_url": "https://api.github.com/users/stephenroller/orgs", "repos_url": "https://api.github.com/users/stephenroller/repos", "events_url": "https://api.github.com/users/stephenroller/events{/privacy}", "received_events_url": "https://api.github.com/users/stephenroller/received_events", "type": "User", "site_admin": false}, "created_at": "2016-04-29T04:14:05Z", "updated_at": "2016-04-29T04:14:05Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a> thanks</p>\n<p>Really seems like the logic around _import_array() in initialization is wrong. Perhaps there's a missing <code>#define NO_IMPORT_ARRAY</code> somewhere? I've been messing around with adding it, moving <code>#include \"numpy.h\"</code> higher up before other includes, but no luck so far. Maybe only with Numpy 1.11?</p>\n<p>(Running CentOS 6.7, GCC 4.9.1 compiled by sysadmins, bazel self compiled, TF self compiled, Python self compiled, cuda 7.5, cudnn 5.0, Numpy 1.11.0 from pip install)<br>\nStack trace:</p>\n<pre><code>#0  0x00002aaadcff3200 in PyArray_API ()\n   from /work/01813/roller/maverick/packages/python/lib/python2.7/site-packages/numpy/core/multiarray.so\n#1  0x00002aaaecd67e54 in _import_array ()\n    at /opt/_internal/cpython-2.7.11-ucs2/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1633\n#2  initspecfun () at build/src.linux-x86_64-2.7/scipy/special/specfunmodule.c:5830\n#3  0x00000000004d3858 in _PyImport_LoadDynamicModule ()\n#4  0x00000000004d0f89 in import_submodule ()\n#5  0x00000000004d1255 in ensure_fromlist ()\n#6  0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#7  0x00000000004af654 in builtin___import__ ()\n#8  0x00000000004232ea in PyObject_Call ()\n#9  0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#10 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#11 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#12 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#13 0x00000000004d01de in load_source_module ()\n#14 0x00000000004d0f89 in import_submodule ()\n#15 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#16 0x00000000004af654 in builtin___import__ ()\n#17 0x00000000004232ea in PyObject_Call ()\n#18 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#19 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#20 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#21 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#22 0x00000000004d01de in load_source_module ()\n#23 0x00000000004d14fc in load_package ()\n#24 0x00000000004d0f89 in import_submodule ()\n#25 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#26 0x00000000004af654 in builtin___import__ ()\n#27 0x00000000004232ea in PyObject_Call ()\n#28 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#29 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#30 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#31 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#32 0x00000000004d01de in load_source_module ()\n#33 0x00000000004d0f89 in import_submodule ()\n#34 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#35 0x00000000004af654 in builtin___import__ ()\n#36 0x00000000004232ea in PyObject_Call ()\n#37 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#38 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#39 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#40 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#41 0x00000000004d01de in load_source_module ()\n#42 0x00000000004d0f89 in import_submodule ()\n#43 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#44 0x00000000004af654 in builtin___import__ ()\n#45 0x00000000004232ea in PyObject_Call ()\n#46 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#47 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#48 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#49 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#50 0x00000000004d01de in load_source_module ()\n#51 0x00000000004d14fc in load_package ()\n#52 0x00000000004d0f89 in import_submodule ()\n#53 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#54 0x00000000004af654 in builtin___import__ ()\n#55 0x00000000004232ea in PyObject_Call ()\n#56 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#57 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#58 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#59 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#60 0x00000000004d01de in load_source_module ()\n#61 0x00000000004d0f89 in import_submodule ()\n#62 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#63 0x00000000004af654 in builtin___import__ ()\n#64 0x00000000004232ea in PyObject_Call ()\n#65 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#66 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#67 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#68 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#69 0x00000000004d01de in load_source_module ()\n#70 0x00000000004d14fc in load_package ()\n#71 0x00000000004d0f89 in import_submodule ()\n#72 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#73 0x00000000004af654 in builtin___import__ ()\n#74 0x00000000004232ea in PyObject_Call ()\n#75 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#76 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#77 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#78 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#79 0x00000000004d01de in load_source_module ()\n#80 0x00000000004d0f89 in import_submodule ()\n#81 0x00000000004d1255 in ensure_fromlist ()\n#82 0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#83 0x00000000004af654 in builtin___import__ ()\n#84 0x00000000004232ea in PyObject_Call ()\n#85 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#86 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#87 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#88 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#89 0x00000000004d01de in load_source_module ()\n#90 0x00000000004d0f89 in import_submodule ()\n#91 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#92 0x00000000004af654 in builtin___import__ ()\n#93 0x00000000004232ea in PyObject_Call ()\n#94 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#95 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#96 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#97 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#98 0x00000000004d01de in load_source_module ()\n#99 0x00000000004d14fc in load_package ()\n#100 0x00000000004d0f89 in import_submodule ()\n#101 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#102 0x00000000004af654 in builtin___import__ ()\n#103 0x00000000004232ea in PyObject_Call ()\n#104 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#105 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#106 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#107 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#108 0x00000000004d01de in load_source_module ()\n#109 0x00000000004d14fc in load_package ()\n#110 0x00000000004d0f89 in import_submodule ()\n#111 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#112 0x00000000004af654 in builtin___import__ ()\n#113 0x00000000004232ea in PyObject_Call ()\n#114 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#115 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#116 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#117 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#118 0x00000000004d01de in load_source_module ()\n#119 0x00000000004d14fc in load_package ()\n#120 0x00000000004d0f89 in import_submodule ()\n#121 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#122 0x00000000004af654 in builtin___import__ ()\n#123 0x00000000004232ea in PyObject_Call ()\n#124 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#125 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#126 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#127 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#128 0x00000000004d01de in load_source_module ()\n#129 0x00000000004d14fc in load_package ()\n#130 0x00000000004d0f89 in import_submodule ()\n#131 0x00000000004d1255 in ensure_fromlist ()\n#132 0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#133 0x00000000004af654 in builtin___import__ ()\n#134 0x00000000004232ea in PyObject_Call ()\n#135 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#136 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#137 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#138 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#139 0x00000000004d01de in load_source_module ()\n#140 0x00000000004d14fc in load_package ()\n#141 0x00000000004d0f89 in import_submodule ()\n#142 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#143 0x00000000004af654 in builtin___import__ ()\n#144 0x00000000004232ea in PyObject_Call ()\n#145 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#146 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#147 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#148 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#149 0x00000000004d01de in load_source_module ()\n#150 0x00000000004d14fc in load_package ()\n#151 0x00000000004d0f89 in import_submodule ()\n#152 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#153 0x00000000004af654 in builtin___import__ ()\n#154 0x00000000004232ea in PyObject_Call ()\n#155 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#156 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#157 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#158 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#159 0x00000000004d01de in load_source_module ()\n#160 0x00000000004d14fc in load_package ()\n#161 0x00000000004d0f89 in import_submodule ()\n#162 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#163 0x00000000004af654 in builtin___import__ ()\n#164 0x00000000004232ea in PyObject_Call ()\n#165 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#166 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#167 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#168 0x00000000004e430f in PyRun_SimpleStringFlags () at Python/pythonrun.c:1370\n#169 0x0000000000415b90 in Py_Main ()\n#170 0x000000389b41ed5d in __libc_start_main () from /lib64/libc.so.6\n#171 0x0000000000415179 in _start ()\n</code></pre>", "body_text": "@yaroslavvb thanks\nReally seems like the logic around _import_array() in initialization is wrong. Perhaps there's a missing #define NO_IMPORT_ARRAY somewhere? I've been messing around with adding it, moving #include \"numpy.h\" higher up before other includes, but no luck so far. Maybe only with Numpy 1.11?\n(Running CentOS 6.7, GCC 4.9.1 compiled by sysadmins, bazel self compiled, TF self compiled, Python self compiled, cuda 7.5, cudnn 5.0, Numpy 1.11.0 from pip install)\nStack trace:\n#0  0x00002aaadcff3200 in PyArray_API ()\n   from /work/01813/roller/maverick/packages/python/lib/python2.7/site-packages/numpy/core/multiarray.so\n#1  0x00002aaaecd67e54 in _import_array ()\n    at /opt/_internal/cpython-2.7.11-ucs2/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1633\n#2  initspecfun () at build/src.linux-x86_64-2.7/scipy/special/specfunmodule.c:5830\n#3  0x00000000004d3858 in _PyImport_LoadDynamicModule ()\n#4  0x00000000004d0f89 in import_submodule ()\n#5  0x00000000004d1255 in ensure_fromlist ()\n#6  0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#7  0x00000000004af654 in builtin___import__ ()\n#8  0x00000000004232ea in PyObject_Call ()\n#9  0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#10 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#11 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#12 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#13 0x00000000004d01de in load_source_module ()\n#14 0x00000000004d0f89 in import_submodule ()\n#15 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#16 0x00000000004af654 in builtin___import__ ()\n#17 0x00000000004232ea in PyObject_Call ()\n#18 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#19 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#20 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#21 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#22 0x00000000004d01de in load_source_module ()\n#23 0x00000000004d14fc in load_package ()\n#24 0x00000000004d0f89 in import_submodule ()\n#25 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#26 0x00000000004af654 in builtin___import__ ()\n#27 0x00000000004232ea in PyObject_Call ()\n#28 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#29 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#30 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#31 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#32 0x00000000004d01de in load_source_module ()\n#33 0x00000000004d0f89 in import_submodule ()\n#34 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#35 0x00000000004af654 in builtin___import__ ()\n#36 0x00000000004232ea in PyObject_Call ()\n#37 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#38 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#39 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#40 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#41 0x00000000004d01de in load_source_module ()\n#42 0x00000000004d0f89 in import_submodule ()\n#43 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#44 0x00000000004af654 in builtin___import__ ()\n#45 0x00000000004232ea in PyObject_Call ()\n#46 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#47 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#48 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#49 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#50 0x00000000004d01de in load_source_module ()\n#51 0x00000000004d14fc in load_package ()\n#52 0x00000000004d0f89 in import_submodule ()\n#53 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#54 0x00000000004af654 in builtin___import__ ()\n#55 0x00000000004232ea in PyObject_Call ()\n#56 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#57 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#58 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#59 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#60 0x00000000004d01de in load_source_module ()\n#61 0x00000000004d0f89 in import_submodule ()\n#62 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#63 0x00000000004af654 in builtin___import__ ()\n#64 0x00000000004232ea in PyObject_Call ()\n#65 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#66 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#67 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#68 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#69 0x00000000004d01de in load_source_module ()\n#70 0x00000000004d14fc in load_package ()\n#71 0x00000000004d0f89 in import_submodule ()\n#72 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#73 0x00000000004af654 in builtin___import__ ()\n#74 0x00000000004232ea in PyObject_Call ()\n#75 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#76 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#77 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#78 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#79 0x00000000004d01de in load_source_module ()\n#80 0x00000000004d0f89 in import_submodule ()\n#81 0x00000000004d1255 in ensure_fromlist ()\n#82 0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#83 0x00000000004af654 in builtin___import__ ()\n#84 0x00000000004232ea in PyObject_Call ()\n#85 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#86 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#87 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#88 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#89 0x00000000004d01de in load_source_module ()\n#90 0x00000000004d0f89 in import_submodule ()\n#91 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#92 0x00000000004af654 in builtin___import__ ()\n#93 0x00000000004232ea in PyObject_Call ()\n#94 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#95 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#96 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#97 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#98 0x00000000004d01de in load_source_module ()\n#99 0x00000000004d14fc in load_package ()\n#100 0x00000000004d0f89 in import_submodule ()\n#101 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#102 0x00000000004af654 in builtin___import__ ()\n#103 0x00000000004232ea in PyObject_Call ()\n#104 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#105 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#106 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#107 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#108 0x00000000004d01de in load_source_module ()\n#109 0x00000000004d14fc in load_package ()\n#110 0x00000000004d0f89 in import_submodule ()\n#111 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#112 0x00000000004af654 in builtin___import__ ()\n#113 0x00000000004232ea in PyObject_Call ()\n#114 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#115 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#116 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#117 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#118 0x00000000004d01de in load_source_module ()\n#119 0x00000000004d14fc in load_package ()\n#120 0x00000000004d0f89 in import_submodule ()\n#121 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#122 0x00000000004af654 in builtin___import__ ()\n#123 0x00000000004232ea in PyObject_Call ()\n#124 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#125 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#126 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#127 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#128 0x00000000004d01de in load_source_module ()\n#129 0x00000000004d14fc in load_package ()\n#130 0x00000000004d0f89 in import_submodule ()\n#131 0x00000000004d1255 in ensure_fromlist ()\n#132 0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#133 0x00000000004af654 in builtin___import__ ()\n#134 0x00000000004232ea in PyObject_Call ()\n#135 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#136 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#137 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#138 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#139 0x00000000004d01de in load_source_module ()\n#140 0x00000000004d14fc in load_package ()\n#141 0x00000000004d0f89 in import_submodule ()\n#142 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#143 0x00000000004af654 in builtin___import__ ()\n#144 0x00000000004232ea in PyObject_Call ()\n#145 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#146 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#147 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#148 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#149 0x00000000004d01de in load_source_module ()\n#150 0x00000000004d14fc in load_package ()\n#151 0x00000000004d0f89 in import_submodule ()\n#152 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#153 0x00000000004af654 in builtin___import__ ()\n#154 0x00000000004232ea in PyObject_Call ()\n#155 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#156 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#157 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#158 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#159 0x00000000004d01de in load_source_module ()\n#160 0x00000000004d14fc in load_package ()\n#161 0x00000000004d0f89 in import_submodule ()\n#162 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#163 0x00000000004af654 in builtin___import__ ()\n#164 0x00000000004232ea in PyObject_Call ()\n#165 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#166 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#167 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#168 0x00000000004e430f in PyRun_SimpleStringFlags () at Python/pythonrun.c:1370\n#169 0x0000000000415b90 in Py_Main ()\n#170 0x000000389b41ed5d in __libc_start_main () from /lib64/libc.so.6\n#171 0x0000000000415179 in _start ()", "body": "@yaroslavvb thanks\n\nReally seems like the logic around _import_array() in initialization is wrong. Perhaps there's a missing `#define NO_IMPORT_ARRAY` somewhere? I've been messing around with adding it, moving `#include \"numpy.h\"` higher up before other includes, but no luck so far. Maybe only with Numpy 1.11?\n\n(Running CentOS 6.7, GCC 4.9.1 compiled by sysadmins, bazel self compiled, TF self compiled, Python self compiled, cuda 7.5, cudnn 5.0, Numpy 1.11.0 from pip install)\nStack trace:\n\n```\n#0  0x00002aaadcff3200 in PyArray_API ()\n   from /work/01813/roller/maverick/packages/python/lib/python2.7/site-packages/numpy/core/multiarray.so\n#1  0x00002aaaecd67e54 in _import_array ()\n    at /opt/_internal/cpython-2.7.11-ucs2/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1633\n#2  initspecfun () at build/src.linux-x86_64-2.7/scipy/special/specfunmodule.c:5830\n#3  0x00000000004d3858 in _PyImport_LoadDynamicModule ()\n#4  0x00000000004d0f89 in import_submodule ()\n#5  0x00000000004d1255 in ensure_fromlist ()\n#6  0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#7  0x00000000004af654 in builtin___import__ ()\n#8  0x00000000004232ea in PyObject_Call ()\n#9  0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#10 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#11 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#12 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#13 0x00000000004d01de in load_source_module ()\n#14 0x00000000004d0f89 in import_submodule ()\n#15 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#16 0x00000000004af654 in builtin___import__ ()\n#17 0x00000000004232ea in PyObject_Call ()\n#18 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#19 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#20 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#21 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#22 0x00000000004d01de in load_source_module ()\n#23 0x00000000004d14fc in load_package ()\n#24 0x00000000004d0f89 in import_submodule ()\n#25 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#26 0x00000000004af654 in builtin___import__ ()\n#27 0x00000000004232ea in PyObject_Call ()\n#28 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#29 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#30 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#31 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#32 0x00000000004d01de in load_source_module ()\n#33 0x00000000004d0f89 in import_submodule ()\n#34 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#35 0x00000000004af654 in builtin___import__ ()\n#36 0x00000000004232ea in PyObject_Call ()\n#37 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#38 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#39 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#40 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#41 0x00000000004d01de in load_source_module ()\n#42 0x00000000004d0f89 in import_submodule ()\n#43 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#44 0x00000000004af654 in builtin___import__ ()\n#45 0x00000000004232ea in PyObject_Call ()\n#46 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#47 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#48 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#49 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#50 0x00000000004d01de in load_source_module ()\n#51 0x00000000004d14fc in load_package ()\n#52 0x00000000004d0f89 in import_submodule ()\n#53 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#54 0x00000000004af654 in builtin___import__ ()\n#55 0x00000000004232ea in PyObject_Call ()\n#56 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#57 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#58 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#59 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#60 0x00000000004d01de in load_source_module ()\n#61 0x00000000004d0f89 in import_submodule ()\n#62 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#63 0x00000000004af654 in builtin___import__ ()\n#64 0x00000000004232ea in PyObject_Call ()\n#65 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#66 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#67 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#68 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#69 0x00000000004d01de in load_source_module ()\n#70 0x00000000004d14fc in load_package ()\n#71 0x00000000004d0f89 in import_submodule ()\n#72 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#73 0x00000000004af654 in builtin___import__ ()\n#74 0x00000000004232ea in PyObject_Call ()\n#75 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#76 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#77 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#78 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#79 0x00000000004d01de in load_source_module ()\n#80 0x00000000004d0f89 in import_submodule ()\n#81 0x00000000004d1255 in ensure_fromlist ()\n#82 0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#83 0x00000000004af654 in builtin___import__ ()\n#84 0x00000000004232ea in PyObject_Call ()\n#85 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#86 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#87 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#88 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#89 0x00000000004d01de in load_source_module ()\n#90 0x00000000004d0f89 in import_submodule ()\n#91 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#92 0x00000000004af654 in builtin___import__ ()\n#93 0x00000000004232ea in PyObject_Call ()\n#94 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#95 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#96 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#97 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#98 0x00000000004d01de in load_source_module ()\n#99 0x00000000004d14fc in load_package ()\n#100 0x00000000004d0f89 in import_submodule ()\n#101 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#102 0x00000000004af654 in builtin___import__ ()\n#103 0x00000000004232ea in PyObject_Call ()\n#104 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#105 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#106 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#107 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#108 0x00000000004d01de in load_source_module ()\n#109 0x00000000004d14fc in load_package ()\n#110 0x00000000004d0f89 in import_submodule ()\n#111 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#112 0x00000000004af654 in builtin___import__ ()\n#113 0x00000000004232ea in PyObject_Call ()\n#114 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#115 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#116 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#117 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#118 0x00000000004d01de in load_source_module ()\n#119 0x00000000004d14fc in load_package ()\n#120 0x00000000004d0f89 in import_submodule ()\n#121 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#122 0x00000000004af654 in builtin___import__ ()\n#123 0x00000000004232ea in PyObject_Call ()\n#124 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#125 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#126 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#127 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#128 0x00000000004d01de in load_source_module ()\n#129 0x00000000004d14fc in load_package ()\n#130 0x00000000004d0f89 in import_submodule ()\n#131 0x00000000004d1255 in ensure_fromlist ()\n#132 0x00000000004d2120 in PyImport_ImportModuleLevel ()\n#133 0x00000000004af654 in builtin___import__ ()\n#134 0x00000000004232ea in PyObject_Call ()\n#135 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#136 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#137 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#138 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#139 0x00000000004d01de in load_source_module ()\n#140 0x00000000004d14fc in load_package ()\n#141 0x00000000004d0f89 in import_submodule ()\n#142 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#143 0x00000000004af654 in builtin___import__ ()\n#144 0x00000000004232ea in PyObject_Call ()\n#145 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#146 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#147 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#148 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#149 0x00000000004d01de in load_source_module ()\n#150 0x00000000004d14fc in load_package ()\n#151 0x00000000004d0f89 in import_submodule ()\n#152 0x00000000004d204b in PyImport_ImportModuleLevel ()\n#153 0x00000000004af654 in builtin___import__ ()\n#154 0x00000000004232ea in PyObject_Call ()\n#155 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#156 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#157 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#158 0x00000000004cfe98 in PyImport_ExecCodeModuleEx ()\n#159 0x00000000004d01de in load_source_module ()\n#160 0x00000000004d14fc in load_package ()\n#161 0x00000000004d0f89 in import_submodule ()\n#162 0x00000000004d1f9f in PyImport_ImportModuleLevel ()\n#163 0x00000000004af654 in builtin___import__ ()\n#164 0x00000000004232ea in PyObject_Call ()\n#165 0x00000000004b4b40 in PyEval_EvalFrameEx () at Python/ceval.c:4219\n#166 0x00000000004baf7b in PyEval_EvalCodeEx () at Python/ceval.c:3582\n#167 0x00000000004bb089 in PyEval_EvalCode () at Python/ceval.c:669\n#168 0x00000000004e430f in PyRun_SimpleStringFlags () at Python/pythonrun.c:1370\n#169 0x0000000000415b90 in Py_Main ()\n#170 0x000000389b41ed5d in __libc_start_main () from /lib64/libc.so.6\n#171 0x0000000000415179 in _start ()\n```\n"}