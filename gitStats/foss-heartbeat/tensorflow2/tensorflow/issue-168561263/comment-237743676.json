{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/237743676", "html_url": "https://github.com/tensorflow/tensorflow/issues/3596#issuecomment-237743676", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3596", "id": 237743676, "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzc0MzY3Ng==", "user": {"login": "luxiaolei", "id": 15217663, "node_id": "MDQ6VXNlcjE1MjE3NjYz", "avatar_url": "https://avatars1.githubusercontent.com/u/15217663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luxiaolei", "html_url": "https://github.com/luxiaolei", "followers_url": "https://api.github.com/users/luxiaolei/followers", "following_url": "https://api.github.com/users/luxiaolei/following{/other_user}", "gists_url": "https://api.github.com/users/luxiaolei/gists{/gist_id}", "starred_url": "https://api.github.com/users/luxiaolei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luxiaolei/subscriptions", "organizations_url": "https://api.github.com/users/luxiaolei/orgs", "repos_url": "https://api.github.com/users/luxiaolei/repos", "events_url": "https://api.github.com/users/luxiaolei/events{/privacy}", "received_events_url": "https://api.github.com/users/luxiaolei/received_events", "type": "User", "site_admin": false}, "created_at": "2016-08-05T03:00:56Z", "updated_at": "2016-08-05T03:00:56Z", "author_association": "NONE", "body_html": "<p>ok, i will try to replace with Estimator, may take a while, since I am quite new to tensorflow.</p>\n<p>And here is the message:</p>\n<pre><code>I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcurand.so locally\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpHNcq6t\nWARNING:tensorflow:Setting feature info to TensorSignature(dtype=tf.float32, shape=TensorShape([Dimension(None), Dimension(4)]), is_sparse=False)\nWARNING:tensorflow:Setting targets info to TensorSignature(dtype=tf.float32, shape=TensorShape([Dimension(None), Dimension(3)]), is_sparse=False)\nWARNING:tensorflow:dnn (from tensorflow.contrib.learn.python.learn.ops.dnn_ops) is deprecated and will be removed after 2016-08-01.\nInstructions for updating:\nPlease use tf.contrib.layers.stack instead.\nWARNING:tensorflow:learn.ops.dnn is deprecated,     please use contrib.layers.dnn.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:09:00.0\nTotal memory: 7.92GiB\nFree memory: 7.38GiB\nW tensorflow/stream_executor/cuda/cuda_driver.cc:572] creating context when one is currently active; existing: 0x3804080\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 1 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:06:00.0\nTotal memory: 7.92GiB\nFree memory: 7.70GiB\nW tensorflow/stream_executor/cuda/cuda_driver.cc:572] creating context when one is currently active; existing: 0x3e315d0\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 2 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:05:00.0\nTotal memory: 7.92GiB\nFree memory: 7.62GiB\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 1 2 \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 1:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 2:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:1) -&gt; (device: 1, name: GeForce GTX 1080, pci bus id: 0000:06:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:2) -&gt; (device: 2, name: GeForce GTX 1080, pci bus id: 0000:05:00.0)\nWARNING:tensorflow:dnn (from tensorflow.contrib.learn.python.learn.ops.dnn_ops) is deprecated and will be removed after 2016-08-01.\nInstructions for updating:\nPlease use tf.contrib.layers.stack instead.\nWARNING:tensorflow:learn.ops.dnn is deprecated,     please use contrib.layers.dnn.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:1) -&gt; (device: 1, name: GeForce GTX 1080, pci bus id: 0000:06:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:2) -&gt; (device: 2, name: GeForce GTX 1080, pci bus id: 0000:05:00.0)\nE tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nTraceback (most recent call last):\n  File \"multiple_gpu.py\", line 43, in &lt;module&gt;\n    score = metrics.accuracy_score(y_test, classifier.predict(X_test))\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 243, in predict\n    return self._predict(x, axis=axis, batch_size=batch_size)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 217, in _predict\n    feed_fn=predict_data_feeder.get_feed_dict_fn())\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 686, in _infer_model\n    restore_checkpoint_path=checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 680, in run_feeds\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 106, in _restore_from_checkpoint\n    saver.restore(session, checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1114, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nCaused by op u'save/ShardedFilename_2', defined at:\n  File \"multiple_gpu.py\", line 43, in &lt;module&gt;\n    score = metrics.accuracy_score(y_test, classifier.predict(X_test))\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 243, in predict\n    return self._predict(x, axis=axis, batch_size=batch_size)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 217, in _predict\n    feed_fn=predict_data_feeder.get_feed_dict_fn())\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 686, in _infer_model\n    restore_checkpoint_path=checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 680, in run_feeds\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 104, in _restore_from_checkpoint\n    saver = saver or _make_saver(graph)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 96, in _make_saver\n    max_to_keep=keep_checkpoint_max)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 854, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 512, in build\n    save_tensor = self._AddShardedSaveOps(filename_tensor, per_device)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 232, in _AddShardedSaveOps\n    filename_tensor, shard, num_shards_tensor)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 200, in sharded_filename\n    return gen_io_ops._sharded_filename(filename_tensor, shard, num_shards)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 460, in _sharded_filename\n    shard=shard, num_shards=num_shards, name=name)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2298, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n</code></pre>", "body_text": "ok, i will try to replace with Estimator, may take a while, since I am quite new to tensorflow.\nAnd here is the message:\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcurand.so locally\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpHNcq6t\nWARNING:tensorflow:Setting feature info to TensorSignature(dtype=tf.float32, shape=TensorShape([Dimension(None), Dimension(4)]), is_sparse=False)\nWARNING:tensorflow:Setting targets info to TensorSignature(dtype=tf.float32, shape=TensorShape([Dimension(None), Dimension(3)]), is_sparse=False)\nWARNING:tensorflow:dnn (from tensorflow.contrib.learn.python.learn.ops.dnn_ops) is deprecated and will be removed after 2016-08-01.\nInstructions for updating:\nPlease use tf.contrib.layers.stack instead.\nWARNING:tensorflow:learn.ops.dnn is deprecated,     please use contrib.layers.dnn.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:09:00.0\nTotal memory: 7.92GiB\nFree memory: 7.38GiB\nW tensorflow/stream_executor/cuda/cuda_driver.cc:572] creating context when one is currently active; existing: 0x3804080\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 1 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:06:00.0\nTotal memory: 7.92GiB\nFree memory: 7.70GiB\nW tensorflow/stream_executor/cuda/cuda_driver.cc:572] creating context when one is currently active; existing: 0x3e315d0\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 2 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:05:00.0\nTotal memory: 7.92GiB\nFree memory: 7.62GiB\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 1 2 \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 1:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 2:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:06:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:2) -> (device: 2, name: GeForce GTX 1080, pci bus id: 0000:05:00.0)\nWARNING:tensorflow:dnn (from tensorflow.contrib.learn.python.learn.ops.dnn_ops) is deprecated and will be removed after 2016-08-01.\nInstructions for updating:\nPlease use tf.contrib.layers.stack instead.\nWARNING:tensorflow:learn.ops.dnn is deprecated,     please use contrib.layers.dnn.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:06:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:2) -> (device: 2, name: GeForce GTX 1080, pci bus id: 0000:05:00.0)\nE tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nTraceback (most recent call last):\n  File \"multiple_gpu.py\", line 43, in <module>\n    score = metrics.accuracy_score(y_test, classifier.predict(X_test))\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 243, in predict\n    return self._predict(x, axis=axis, batch_size=batch_size)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 217, in _predict\n    feed_fn=predict_data_feeder.get_feed_dict_fn())\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 686, in _infer_model\n    restore_checkpoint_path=checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 680, in run_feeds\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 106, in _restore_from_checkpoint\n    saver.restore(session, checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1114, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nCaused by op u'save/ShardedFilename_2', defined at:\n  File \"multiple_gpu.py\", line 43, in <module>\n    score = metrics.accuracy_score(y_test, classifier.predict(X_test))\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 243, in predict\n    return self._predict(x, axis=axis, batch_size=batch_size)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 217, in _predict\n    feed_fn=predict_data_feeder.get_feed_dict_fn())\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 686, in _infer_model\n    restore_checkpoint_path=checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 680, in run_feeds\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 104, in _restore_from_checkpoint\n    saver = saver or _make_saver(graph)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 96, in _make_saver\n    max_to_keep=keep_checkpoint_max)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 854, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 512, in build\n    save_tensor = self._AddShardedSaveOps(filename_tensor, per_device)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 232, in _AddShardedSaveOps\n    filename_tensor, shard, num_shards_tensor)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 200, in sharded_filename\n    return gen_io_ops._sharded_filename(filename_tensor, shard, num_shards)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 460, in _sharded_filename\n    shard=shard, num_shards=num_shards, name=name)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2298, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()", "body": "ok, i will try to replace with Estimator, may take a while, since I am quite new to tensorflow.\n\nAnd here is the message: \n\n```\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcurand.so locally\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpHNcq6t\nWARNING:tensorflow:Setting feature info to TensorSignature(dtype=tf.float32, shape=TensorShape([Dimension(None), Dimension(4)]), is_sparse=False)\nWARNING:tensorflow:Setting targets info to TensorSignature(dtype=tf.float32, shape=TensorShape([Dimension(None), Dimension(3)]), is_sparse=False)\nWARNING:tensorflow:dnn (from tensorflow.contrib.learn.python.learn.ops.dnn_ops) is deprecated and will be removed after 2016-08-01.\nInstructions for updating:\nPlease use tf.contrib.layers.stack instead.\nWARNING:tensorflow:learn.ops.dnn is deprecated,     please use contrib.layers.dnn.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:09:00.0\nTotal memory: 7.92GiB\nFree memory: 7.38GiB\nW tensorflow/stream_executor/cuda/cuda_driver.cc:572] creating context when one is currently active; existing: 0x3804080\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 1 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:06:00.0\nTotal memory: 7.92GiB\nFree memory: 7.70GiB\nW tensorflow/stream_executor/cuda/cuda_driver.cc:572] creating context when one is currently active; existing: 0x3e315d0\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 2 with properties: \nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:05:00.0\nTotal memory: 7.92GiB\nFree memory: 7.62GiB\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 1 2 \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 1:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 2:   Y Y Y \nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:06:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:2) -> (device: 2, name: GeForce GTX 1080, pci bus id: 0000:05:00.0)\nWARNING:tensorflow:dnn (from tensorflow.contrib.learn.python.learn.ops.dnn_ops) is deprecated and will be removed after 2016-08-01.\nInstructions for updating:\nPlease use tf.contrib.layers.stack instead.\nWARNING:tensorflow:learn.ops.dnn is deprecated,     please use contrib.layers.dnn.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nWARNING:tensorflow:dropout (from tensorflow.contrib.learn.python.learn.ops.dropout_ops) is deprecated and will be removed after 2016-08-15.\nInstructions for updating:\nPlease use tf.contrib.layers.dropout instead.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce GTX 1080, pci bus id: 0000:06:00.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:2) -> (device: 2, name: GeForce GTX 1080, pci bus id: 0000:05:00.0)\nE tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nTraceback (most recent call last):\n  File \"multiple_gpu.py\", line 43, in <module>\n    score = metrics.accuracy_score(y_test, classifier.predict(X_test))\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 243, in predict\n    return self._predict(x, axis=axis, batch_size=batch_size)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 217, in _predict\n    feed_fn=predict_data_feeder.get_feed_dict_fn())\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 686, in _infer_model\n    restore_checkpoint_path=checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 680, in run_feeds\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 106, in _restore_from_checkpoint\n    saver.restore(session, checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1114, in restore\n    {self.saver_def.filename_tensor_name: save_path})\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nCaused by op u'save/ShardedFilename_2', defined at:\n  File \"multiple_gpu.py\", line 43, in <module>\n    score = metrics.accuracy_score(y_test, classifier.predict(X_test))\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 243, in predict\n    return self._predict(x, axis=axis, batch_size=batch_size)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 217, in _predict\n    feed_fn=predict_data_feeder.get_feed_dict_fn())\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 686, in _infer_model\n    restore_checkpoint_path=checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 680, in run_feeds\n    _restore_from_checkpoint(session, g, restore_checkpoint_path)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 104, in _restore_from_checkpoint\n    saver = saver or _make_saver(graph)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 96, in _make_saver\n    max_to_keep=keep_checkpoint_max)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 854, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 512, in build\n    save_tensor = self._AddShardedSaveOps(filename_tensor, per_device)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 232, in _AddShardedSaveOps\n    filename_tensor, shard, num_shards_tensor)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 200, in sharded_filename\n    return gen_io_ops._sharded_filename(filename_tensor, shard, num_shards)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 460, in _sharded_filename\n    shard=shard, num_shards=num_shards, name=name)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2298, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/xlws/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n```\n"}