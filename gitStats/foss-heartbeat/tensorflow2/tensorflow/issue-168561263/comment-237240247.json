{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/237240247", "html_url": "https://github.com/tensorflow/tensorflow/issues/3596#issuecomment-237240247", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3596", "id": 237240247, "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzI0MDI0Nw==", "user": {"login": "marcromeyn", "id": 3015785, "node_id": "MDQ6VXNlcjMwMTU3ODU=", "avatar_url": "https://avatars2.githubusercontent.com/u/3015785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcromeyn", "html_url": "https://github.com/marcromeyn", "followers_url": "https://api.github.com/users/marcromeyn/followers", "following_url": "https://api.github.com/users/marcromeyn/following{/other_user}", "gists_url": "https://api.github.com/users/marcromeyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcromeyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcromeyn/subscriptions", "organizations_url": "https://api.github.com/users/marcromeyn/orgs", "repos_url": "https://api.github.com/users/marcromeyn/repos", "events_url": "https://api.github.com/users/marcromeyn/events{/privacy}", "received_events_url": "https://api.github.com/users/marcromeyn/received_events", "type": "User", "site_admin": false}, "created_at": "2016-08-03T13:42:21Z", "updated_at": "2016-08-03T13:42:21Z", "author_association": "NONE", "body_html": "<p>Same error here!</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15676913\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/poxvoculi\">@poxvoculi</a> Also tried changing the deprecated stuff by doing:</p>\n<pre><code>with tf.device('/gpu:1'):\n        layers = tf.contrib.layers.stack(X, tf.contrib.layers.fully_connected, [32, 64, 128], scope='fc')\n    with tf.device('/gpu:2'):\n        return learn.models.logistic_regression(layers, y)\n</code></pre>\n<p>Leads to the same error though:<br>\n<code>I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GRID K520, pci bus id: 0000:00:03.0) I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:1) -&gt; (device: 1, name: GRID K520, pci bus id: 0000:00:04.0) I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:2) -&gt; (device: 2, name: GRID K520, pci bus id: 0000:00:05.0) I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:3) -&gt; (device: 3, name: GRID K520, pci bus id: 0000:00:06.0) E tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available. Colocation Debug Info: Colocation group had the following types and devices:  Identity: CPU  ShardedFilename: CPU  [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]] Traceback (most recent call last): File \"/home/ubuntu/retention/models/test.py\", line 40, in &lt;module&gt; classifier.fit(X_train, y_train) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 166, in fit monitors=monitors) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model max_steps=max_steps) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 276, in _supervised_train scaffold=scaffold) as super_sess: File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 212, in __init__ self._sess = recoverable_session.RecoverableSession(self._create_session) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/recoverable_session.py\", line 46, in __init__ WrappedSession.__init__(self, sess_factory()) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 232, in _create_session init_fn=self._scaffold.init_fn) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 164, in prepare_session max_wait_secs=max_wait_secs, config=config) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 203, in recover_session sess.run([self._local_init_op]) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run run_metadata_ptr) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run feed_dict_string, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run target_list, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call raise type(e)(node_def, op, message) tensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available. Colocation Debug Info: Colocation group had the following types and devices:  Identity: CPU  ShardedFilename: CPU  [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]] Caused by op u'save/ShardedFilename_2', defined at: File \"/home/ubuntu/retention/models/test.py\", line 40, in &lt;module&gt; classifier.fit(X_train, y_train) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 166, in fit monitors=monitors) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model max_steps=max_steps) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 252, in _supervised_train keep_checkpoint_max=keep_checkpoint_max) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 152, in __init__ lambda: training_saver.Saver(sharded=True, File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 164, in _get_or_default op = default_constructor() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 153, in &lt;lambda&gt; max_to_keep=keep_checkpoint_max)) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 861, in __init__ restore_sequentially=restore_sequentially) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 513, in build save_tensor = self._AddShardedSaveOps(filename_tensor, per_device) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 233, in _AddShardedSaveOps filename_tensor, shard, num_shards_tensor) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 201, in sharded_filename return gen_io_ops._sharded_filename(filename_tensor, shard, num_shards) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 460, in _sharded_filename shard=shard, num_shards=num_shards, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op original_op=self._default_original_op, op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__ self._traceback = _extract_stack()</code></p>", "body_text": "Same error here!\n@poxvoculi Also tried changing the deprecated stuff by doing:\nwith tf.device('/gpu:1'):\n        layers = tf.contrib.layers.stack(X, tf.contrib.layers.fully_connected, [32, 64, 128], scope='fc')\n    with tf.device('/gpu:2'):\n        return learn.models.logistic_regression(layers, y)\n\nLeads to the same error though:\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GRID K520, pci bus id: 0000:00:03.0) I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GRID K520, pci bus id: 0000:00:04.0) I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:2) -> (device: 2, name: GRID K520, pci bus id: 0000:00:05.0) I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:3) -> (device: 3, name: GRID K520, pci bus id: 0000:00:06.0) E tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available. Colocation Debug Info: Colocation group had the following types and devices:  Identity: CPU  ShardedFilename: CPU  [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]] Traceback (most recent call last): File \"/home/ubuntu/retention/models/test.py\", line 40, in <module> classifier.fit(X_train, y_train) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 166, in fit monitors=monitors) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model max_steps=max_steps) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 276, in _supervised_train scaffold=scaffold) as super_sess: File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 212, in __init__ self._sess = recoverable_session.RecoverableSession(self._create_session) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/recoverable_session.py\", line 46, in __init__ WrappedSession.__init__(self, sess_factory()) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 232, in _create_session init_fn=self._scaffold.init_fn) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 164, in prepare_session max_wait_secs=max_wait_secs, config=config) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 203, in recover_session sess.run([self._local_init_op]) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run run_metadata_ptr) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run feed_dict_string, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run target_list, options, run_metadata) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call raise type(e)(node_def, op, message) tensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available. Colocation Debug Info: Colocation group had the following types and devices:  Identity: CPU  ShardedFilename: CPU  [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]] Caused by op u'save/ShardedFilename_2', defined at: File \"/home/ubuntu/retention/models/test.py\", line 40, in <module> classifier.fit(X_train, y_train) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 166, in fit monitors=monitors) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model max_steps=max_steps) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 252, in _supervised_train keep_checkpoint_max=keep_checkpoint_max) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 152, in __init__ lambda: training_saver.Saver(sharded=True, File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 164, in _get_or_default op = default_constructor() File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 153, in <lambda> max_to_keep=keep_checkpoint_max)) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 861, in __init__ restore_sequentially=restore_sequentially) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 513, in build save_tensor = self._AddShardedSaveOps(filename_tensor, per_device) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 233, in _AddShardedSaveOps filename_tensor, shard, num_shards_tensor) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 201, in sharded_filename return gen_io_ops._sharded_filename(filename_tensor, shard, num_shards) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 460, in _sharded_filename shard=shard, num_shards=num_shards, name=name) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op original_op=self._default_original_op, op_def=op_def) File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__ self._traceback = _extract_stack()", "body": "Same error here!\n\n@poxvoculi Also tried changing the deprecated stuff by doing:\n\n```\nwith tf.device('/gpu:1'):\n        layers = tf.contrib.layers.stack(X, tf.contrib.layers.fully_connected, [32, 64, 128], scope='fc')\n    with tf.device('/gpu:2'):\n        return learn.models.logistic_regression(layers, y)\n```\n\nLeads to the same error though:\n`I tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GRID K520, pci bus id: 0000:00:03.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GRID K520, pci bus id: 0000:00:04.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:2) -> (device: 2, name: GRID K520, pci bus id: 0000:00:05.0)\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:840] Creating TensorFlow device (/gpu:3) -> (device: 3, name: GRID K520, pci bus id: 0000:00:06.0)\nE tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nTraceback (most recent call last):\n  File \"/home/ubuntu/retention/models/test.py\", line 40, in <module>\n    classifier.fit(X_train, y_train)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 166, in fit\n    monitors=monitors)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 276, in _supervised_train\n    scaffold=scaffold) as super_sess:\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 212, in __init__\n    self._sess = recoverable_session.RecoverableSession(self._create_session)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/recoverable_session.py\", line 46, in __init__\n    WrappedSession.__init__(self, sess_factory())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 232, in _create_session\n    init_fn=self._scaffold.init_fn)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 164, in prepare_session\n    max_wait_secs=max_wait_secs, config=config)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 203, in recover_session\n    sess.run([self._local_init_op])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'save/ShardedFilename_2': Could not satisfy explicit device specification '/device:GPU:2' because no supported kernel for GPU devices is available.\nColocation Debug Info:\nColocation group had the following types and devices: \nIdentity: CPU \nShardedFilename: CPU \n     [[Node: save/ShardedFilename_2 = ShardedFilename[_device=\"/device:GPU:2\"](save/Const, save/ShardedFilename_2/shard, save/num_shards)]]\nCaused by op u'save/ShardedFilename_2', defined at:\n  File \"/home/ubuntu/retention/models/test.py\", line 40, in <module>\n    classifier.fit(X_train, y_train)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/base.py\", line 166, in fit\n    monitors=monitors)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 578, in _train_model\n    max_steps=max_steps)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/graph_actions.py\", line 252, in _supervised_train\n    keep_checkpoint_max=keep_checkpoint_max)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 152, in __init__\n    lambda: training_saver.Saver(sharded=True,\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 164, in _get_or_default\n    op = default_constructor()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/learn/python/learn/supervised_session.py\", line 153, in <lambda>\n    max_to_keep=keep_checkpoint_max))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 861, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 513, in build\n    save_tensor = self._AddShardedSaveOps(filename_tensor, per_device)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 233, in _AddShardedSaveOps\n    filename_tensor, shard, num_shards_tensor)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 201, in sharded_filename\n    return gen_io_ops._sharded_filename(filename_tensor, shard, num_shards)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_io_ops.py\", line 460, in _sharded_filename\n    shard=shard, num_shards=num_shards, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()`\n"}