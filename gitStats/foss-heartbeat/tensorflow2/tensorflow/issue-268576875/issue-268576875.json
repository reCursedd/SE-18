{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13984", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13984/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13984/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13984/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13984", "id": 268576875, "node_id": "MDU6SXNzdWUyNjg1NzY4NzU=", "number": 13984, "title": "Issues importing external tf_library from project ", "user": {"login": "tadeegan", "id": 1289052, "node_id": "MDQ6VXNlcjEyODkwNTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1289052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tadeegan", "html_url": "https://github.com/tadeegan", "followers_url": "https://api.github.com/users/tadeegan/followers", "following_url": "https://api.github.com/users/tadeegan/following{/other_user}", "gists_url": "https://api.github.com/users/tadeegan/gists{/gist_id}", "starred_url": "https://api.github.com/users/tadeegan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tadeegan/subscriptions", "organizations_url": "https://api.github.com/users/tadeegan/orgs", "repos_url": "https://api.github.com/users/tadeegan/repos", "events_url": "https://api.github.com/users/tadeegan/events{/privacy}", "received_events_url": "https://api.github.com/users/tadeegan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2017-10-25T22:54:26Z", "updated_at": "2018-10-29T07:37:17Z", "closed_at": "2018-10-29T07:37:17Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 14</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>: Source (bazel)</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>:  1.2</p>\n</li>\n<li>\n<p><strong>Python version</strong>:</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>:<br>\nbazel version<br>\nBuild label: 0.7.0<br>\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar<br>\nBuild time: Wed Oct 18 14:27:19 2017 (1508336839)<br>\nBuild timestamp: 1508336839<br>\nBuild timestamp as int: 1508336839</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\n2x1080ti</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:</p>\n</li>\n</ul>\n<p>I import tensorflow with Bazel into my workspace with:</p>\n<pre><code>#WORKSPACE\npatched_http_archive(\n    name = \"org_tensorflow\",\n    urls = [\n        \"https://github.com/tensorflow/tensorflow/archive/v1.2.0.tar.gz\",\n    ],\n    sha256 = \"03dbf7548d1fc1c11ed58da5fa68616f795c819f868f43478cbcaa26abed374f\",\n    strip_prefix = \"tensorflow-1.2.0\",\n    patch_file = \"//tools/third_party:tensorflow_bazel054.patch\",\n)\n\nload('@org_tensorflow//tensorflow:workspace.bzl', 'tf_workspace')\n\ntf_workspace(path_prefix = \"\", tf_repo_name = \"org_tensorflow\")\n</code></pre>\n<p>I am able to correctly reference the tf_library from my BUILD file but it fails to resolve the //tensorflow/... targets because its relative to MY workspace which expects tensorflow targets to be under @org_tensorflow//tensorflow/...</p>\n<pre><code>\nload(\"@org_tensorflow//tensorflow/compiler/aot:tfcompile.bzl\", \"tf_library\")\n\ntf_library(...)\n</code></pre>\n<p>Get error:<br>\n<code>no such package 'tensorflow/compiler/tf2xla/kernels': BUILD file not found on package path and referenced by '//my/local/bazel/target:test_graph_tfmatmul'</code><br>\nSee the output of my bazel query:</p>\n<pre><code>cc_library(\n  name = \"test_graph_tfmatmul\",\n  generator_name = \"test_graph_tfmatmul\",\n  generator_function = \"tf_library\",\n  generator_location = \"ros/src/visual_orientation/bench/BUILD:13\",\n  deps = [\"//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32\", \"//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int64\", \"//tensorflow/compiler/tf2xla/kernels:index_ops_kernel_argmax_float_1d\", \"//tensorflow/compiler/tf2xla/kernels:index_ops_kernel_argmax_float_2d\", \"//tensorflow/compiler/aot:runtime\", \"//tensorflow/compiler/tf2xla:xla_local_runtime_context\", \"//tensorflow/compiler/xla/service/cpu:runtime_conv2d\", \"//tensorflow/compiler/xla/service/cpu:runtime_matmul\", \"//tensorflow/compiler/xla/service/cpu:runtime_single_threaded_conv2d\", \"//tensorflow/compiler/xla/service/cpu:runtime_single_threaded_matmul\", \"//tensorflow/compiler/xla:executable_run_options\", \"//third_party/eigen3:eigen3\", \"//tensorflow/core:framework_lite\"],\n  srcs = [\"//ros/src/visual_orientation/bench:test_graph_tfmatmul.o\"],\n  hdrs = [\"//ros/src/visual_orientation/bench:test_graph_tfmatmul.h\"],\n)\n</code></pre>\n<p>The deps reference //tensorflow/... which I do not have in my WORKSPACE.<br>\nbazel build @org_tensorflow//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32 succeeds<br>\nbazel build //tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32 fails</p>\n<p>Can the tf_library reference targets more inteligently or am I making a mistake? Example targets:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tfcompile.bzl#L313\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tfcompile.bzl#L313</a></p>", "body_text": "System information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 14\n\n\nTensorFlow installed from (source or binary): Source (bazel)\n\n\nTensorFlow version (use command below):  1.2\n\n\nPython version:\n\n\nBazel version (if compiling from source):\nbazel version\nBuild label: 0.7.0\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Wed Oct 18 14:27:19 2017 (1508336839)\nBuild timestamp: 1508336839\nBuild timestamp as int: 1508336839\n\n\nCUDA/cuDNN version:\n\n\nGPU model and memory:\n2x1080ti\n\n\nExact command to reproduce:\n\n\nI import tensorflow with Bazel into my workspace with:\n#WORKSPACE\npatched_http_archive(\n    name = \"org_tensorflow\",\n    urls = [\n        \"https://github.com/tensorflow/tensorflow/archive/v1.2.0.tar.gz\",\n    ],\n    sha256 = \"03dbf7548d1fc1c11ed58da5fa68616f795c819f868f43478cbcaa26abed374f\",\n    strip_prefix = \"tensorflow-1.2.0\",\n    patch_file = \"//tools/third_party:tensorflow_bazel054.patch\",\n)\n\nload('@org_tensorflow//tensorflow:workspace.bzl', 'tf_workspace')\n\ntf_workspace(path_prefix = \"\", tf_repo_name = \"org_tensorflow\")\n\nI am able to correctly reference the tf_library from my BUILD file but it fails to resolve the //tensorflow/... targets because its relative to MY workspace which expects tensorflow targets to be under @org_tensorflow//tensorflow/...\n\nload(\"@org_tensorflow//tensorflow/compiler/aot:tfcompile.bzl\", \"tf_library\")\n\ntf_library(...)\n\nGet error:\nno such package 'tensorflow/compiler/tf2xla/kernels': BUILD file not found on package path and referenced by '//my/local/bazel/target:test_graph_tfmatmul'\nSee the output of my bazel query:\ncc_library(\n  name = \"test_graph_tfmatmul\",\n  generator_name = \"test_graph_tfmatmul\",\n  generator_function = \"tf_library\",\n  generator_location = \"ros/src/visual_orientation/bench/BUILD:13\",\n  deps = [\"//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32\", \"//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int64\", \"//tensorflow/compiler/tf2xla/kernels:index_ops_kernel_argmax_float_1d\", \"//tensorflow/compiler/tf2xla/kernels:index_ops_kernel_argmax_float_2d\", \"//tensorflow/compiler/aot:runtime\", \"//tensorflow/compiler/tf2xla:xla_local_runtime_context\", \"//tensorflow/compiler/xla/service/cpu:runtime_conv2d\", \"//tensorflow/compiler/xla/service/cpu:runtime_matmul\", \"//tensorflow/compiler/xla/service/cpu:runtime_single_threaded_conv2d\", \"//tensorflow/compiler/xla/service/cpu:runtime_single_threaded_matmul\", \"//tensorflow/compiler/xla:executable_run_options\", \"//third_party/eigen3:eigen3\", \"//tensorflow/core:framework_lite\"],\n  srcs = [\"//ros/src/visual_orientation/bench:test_graph_tfmatmul.o\"],\n  hdrs = [\"//ros/src/visual_orientation/bench:test_graph_tfmatmul.h\"],\n)\n\nThe deps reference //tensorflow/... which I do not have in my WORKSPACE.\nbazel build @org_tensorflow//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32 succeeds\nbazel build //tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32 fails\nCan the tf_library reference targets more inteligently or am I making a mistake? Example targets:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tfcompile.bzl#L313", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 14\r\n- **TensorFlow installed from (source or binary)**: Source (bazel)\r\n- **TensorFlow version (use command below)**:  1.2\r\n- **Python version**: \r\n- **Bazel version (if compiling from source)**: \r\nbazel version\r\nBuild label: 0.7.0\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Wed Oct 18 14:27:19 2017 (1508336839)\r\nBuild timestamp: 1508336839\r\nBuild timestamp as int: 1508336839\r\n\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n2x1080ti\r\n- **Exact command to reproduce**:\r\n\r\n\r\nI import tensorflow with Bazel into my workspace with:\r\n```\r\n#WORKSPACE\r\npatched_http_archive(\r\n    name = \"org_tensorflow\",\r\n    urls = [\r\n        \"https://github.com/tensorflow/tensorflow/archive/v1.2.0.tar.gz\",\r\n    ],\r\n    sha256 = \"03dbf7548d1fc1c11ed58da5fa68616f795c819f868f43478cbcaa26abed374f\",\r\n    strip_prefix = \"tensorflow-1.2.0\",\r\n    patch_file = \"//tools/third_party:tensorflow_bazel054.patch\",\r\n)\r\n\r\nload('@org_tensorflow//tensorflow:workspace.bzl', 'tf_workspace')\r\n\r\ntf_workspace(path_prefix = \"\", tf_repo_name = \"org_tensorflow\")\r\n```\r\n\r\nI am able to correctly reference the tf_library from my BUILD file but it fails to resolve the //tensorflow/... targets because its relative to MY workspace which expects tensorflow targets to be under @org_tensorflow//tensorflow/...\r\n```\r\n\r\nload(\"@org_tensorflow//tensorflow/compiler/aot:tfcompile.bzl\", \"tf_library\")\r\n\r\ntf_library(...)\r\n```\r\n\r\nGet error:\r\n` no such package 'tensorflow/compiler/tf2xla/kernels': BUILD file not found on package path and referenced by '//my/local/bazel/target:test_graph_tfmatmul'\r\n`\r\nSee the output of my bazel query:\r\n```\r\ncc_library(\r\n  name = \"test_graph_tfmatmul\",\r\n  generator_name = \"test_graph_tfmatmul\",\r\n  generator_function = \"tf_library\",\r\n  generator_location = \"ros/src/visual_orientation/bench/BUILD:13\",\r\n  deps = [\"//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32\", \"//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int64\", \"//tensorflow/compiler/tf2xla/kernels:index_ops_kernel_argmax_float_1d\", \"//tensorflow/compiler/tf2xla/kernels:index_ops_kernel_argmax_float_2d\", \"//tensorflow/compiler/aot:runtime\", \"//tensorflow/compiler/tf2xla:xla_local_runtime_context\", \"//tensorflow/compiler/xla/service/cpu:runtime_conv2d\", \"//tensorflow/compiler/xla/service/cpu:runtime_matmul\", \"//tensorflow/compiler/xla/service/cpu:runtime_single_threaded_conv2d\", \"//tensorflow/compiler/xla/service/cpu:runtime_single_threaded_matmul\", \"//tensorflow/compiler/xla:executable_run_options\", \"//third_party/eigen3:eigen3\", \"//tensorflow/core:framework_lite\"],\r\n  srcs = [\"//ros/src/visual_orientation/bench:test_graph_tfmatmul.o\"],\r\n  hdrs = [\"//ros/src/visual_orientation/bench:test_graph_tfmatmul.h\"],\r\n)\r\n```\r\nThe deps reference //tensorflow/... which I do not have in my WORKSPACE. \r\nbazel build @org_tensorflow//tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32 succeeds\r\nbazel build //tensorflow/compiler/tf2xla/kernels:gather_op_kernel_float_int32 fails\r\n\r\nCan the tf_library reference targets more inteligently or am I making a mistake? Example targets:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tfcompile.bzl#L313\r\n\r\n"}