{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/283412259", "html_url": "https://github.com/tensorflow/tensorflow/issues/7162#issuecomment-283412259", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7162", "id": 283412259, "node_id": "MDEyOklzc3VlQ29tbWVudDI4MzQxMjI1OQ==", "user": {"login": "reuben", "id": 477142, "node_id": "MDQ6VXNlcjQ3NzE0Mg==", "avatar_url": "https://avatars3.githubusercontent.com/u/477142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reuben", "html_url": "https://github.com/reuben", "followers_url": "https://api.github.com/users/reuben/followers", "following_url": "https://api.github.com/users/reuben/following{/other_user}", "gists_url": "https://api.github.com/users/reuben/gists{/gist_id}", "starred_url": "https://api.github.com/users/reuben/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reuben/subscriptions", "organizations_url": "https://api.github.com/users/reuben/orgs", "repos_url": "https://api.github.com/users/reuben/repos", "events_url": "https://api.github.com/users/reuben/events{/privacy}", "received_events_url": "https://api.github.com/users/reuben/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-01T17:37:51Z", "updated_at": "2017-03-01T17:38:56Z", "author_association": "NONE", "body_html": "<p>Over in issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"210884146\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7949\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7949/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7949\">#7949</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=161459\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/petewarden\">@petewarden</a> suggested that I use the new transform_graph tool instead of quantize_graph.py, and that worked for weights quantization. On the other hand, when using that tool to quantize the graph, I run into a different problem:</p>\n<pre><code>Traceback (most recent call last):\n  File \"import.py\", line 19, in &lt;module&gt;\n    result = sess.run(y)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: The node 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul_eightbit/rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul/Enter/reshape' has inputs from different frames. The input 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul/Enter' is in frame 'rnn/while/rnn/while/'. The input 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul_eightbit/rnn/while/basic_lstm_cell/basic_lstm_cell/concat/reshape_dims' is in frame ''.\n</code></pre>\n<p>This, coincidentally, is the same problem I was running into originally over in issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"210884146\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/7949\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7949/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/7949\">#7949</a>.</p>\n<p>Updated code for reproducing this is in <a href=\"https://github.com/reuben/tf-export-test/tree/tf_issue_7162\">https://github.com/reuben/tf-export-test/tree/tf_issue_7162</a></p>", "body_text": "Over in issue #7949 @petewarden suggested that I use the new transform_graph tool instead of quantize_graph.py, and that worked for weights quantization. On the other hand, when using that tool to quantize the graph, I run into a different problem:\nTraceback (most recent call last):\n  File \"import.py\", line 19, in <module>\n    result = sess.run(y)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: The node 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul_eightbit/rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul/Enter/reshape' has inputs from different frames. The input 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul/Enter' is in frame 'rnn/while/rnn/while/'. The input 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul_eightbit/rnn/while/basic_lstm_cell/basic_lstm_cell/concat/reshape_dims' is in frame ''.\n\nThis, coincidentally, is the same problem I was running into originally over in issue #7949.\nUpdated code for reproducing this is in https://github.com/reuben/tf-export-test/tree/tf_issue_7162", "body": "Over in issue #7949 @petewarden suggested that I use the new transform_graph tool instead of quantize_graph.py, and that worked for weights quantization. On the other hand, when using that tool to quantize the graph, I run into a different problem:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"import.py\", line 19, in <module>\r\n    result = sess.run(y)\r\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/home/reuben/.virtualenvs/deepspeech/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: The node 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul_eightbit/rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul/Enter/reshape' has inputs from different frames. The input 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul/Enter' is in frame 'rnn/while/rnn/while/'. The input 'rnn/while/basic_lstm_cell/basic_lstm_cell/MatMul_eightbit/rnn/while/basic_lstm_cell/basic_lstm_cell/concat/reshape_dims' is in frame ''.\r\n```\r\n\r\nThis, coincidentally, is the same problem I was running into originally over in issue #7949.\r\n\r\nUpdated code for reproducing this is in https://github.com/reuben/tf-export-test/tree/tf_issue_7162"}