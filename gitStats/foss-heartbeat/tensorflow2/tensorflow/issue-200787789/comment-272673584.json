{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/272673584", "html_url": "https://github.com/tensorflow/tensorflow/issues/6845#issuecomment-272673584", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6845", "id": 272673584, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY3MzU4NA==", "user": {"login": "ericyue", "id": 918889, "node_id": "MDQ6VXNlcjkxODg4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/918889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericyue", "html_url": "https://github.com/ericyue", "followers_url": "https://api.github.com/users/ericyue/followers", "following_url": "https://api.github.com/users/ericyue/following{/other_user}", "gists_url": "https://api.github.com/users/ericyue/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericyue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericyue/subscriptions", "organizations_url": "https://api.github.com/users/ericyue/orgs", "repos_url": "https://api.github.com/users/ericyue/repos", "events_url": "https://api.github.com/users/ericyue/events{/privacy}", "received_events_url": "https://api.github.com/users/ericyue/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-15T04:46:21Z", "updated_at": "2017-01-15T04:59:13Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a>   I do as you said.<br>\nAfter I add <code>time.sleep</code> and increase <code>capacity</code> in tf.batch, the speed changed from 7k/s to 70k/s.<br>\nBut I find two things :</p>\n<ol>\n<li>the speed become slower with the time elapse.</li>\n</ol>\n<pre><code>[2017-01-15 12:54:40] time[  0.11] step[        30] speed[265345]\n[2017-01-15 12:54:40] time[  0.12] step[        60] speed[256539]\n[2017-01-15 12:54:40] time[  0.11] step[        90] speed[274768]\n[2017-01-15 12:54:40] time[  0.12] step[       120] speed[257424]\n[2017-01-15 12:54:40] time[  0.11] step[       150] speed[262851]\n[2017-01-15 12:54:41] time[  0.11] step[       180] speed[262207]\n[2017-01-15 12:54:41] time[  0.12] step[       210] speed[255981]\n[2017-01-15 12:54:41] time[  0.25] step[       240] speed[118329]\n[2017-01-15 12:54:42] time[  1.17] step[       270] speed[ 25723]\n[2017-01-15 12:54:46] time[  3.86] step[       300] speed[  7762]\n[2017-01-15 12:54:50] time[  3.99] step[       330] speed[  7524]\n</code></pre>\n<ol start=\"2\">\n<li>when I increase the thread number , the speed become slow.  the best number is  2.<br>\nMy server are 24cores cpu, and the disk read speed are only 400KB/s in average (see from iotop command )</li>\n</ol>\n<pre><code>[2017-01-15 12:56:04] time[  0.26] step[        30] speed[115136]\n[2017-01-15 12:56:04] time[  0.27] step[        60] speed[109339]\n[2017-01-15 12:56:04] time[  0.27] step[        90] speed[110254]\n[2017-01-15 12:56:05] time[  0.32] step[       120] speed[ 92811]\n[2017-01-15 12:56:05] time[  0.29] step[       150] speed[102403]\n[2017-01-15 12:56:05] time[  0.27] step[       180] speed[109489]\n[2017-01-15 12:56:07] time[  2.08] step[       210] speed[ 14409]\n[2017-01-15 12:56:12] time[  4.84] step[       240] speed[  6195]\n[2017-01-15 12:56:17] time[  4.75] step[       270] speed[  6316]\n[2017-01-15 12:56:22] time[  4.78] step[       300] speed[  6282]\n</code></pre>", "body_text": "@yaroslavvb   I do as you said.\nAfter I add time.sleep and increase capacity in tf.batch, the speed changed from 7k/s to 70k/s.\nBut I find two things :\n\nthe speed become slower with the time elapse.\n\n[2017-01-15 12:54:40] time[  0.11] step[        30] speed[265345]\n[2017-01-15 12:54:40] time[  0.12] step[        60] speed[256539]\n[2017-01-15 12:54:40] time[  0.11] step[        90] speed[274768]\n[2017-01-15 12:54:40] time[  0.12] step[       120] speed[257424]\n[2017-01-15 12:54:40] time[  0.11] step[       150] speed[262851]\n[2017-01-15 12:54:41] time[  0.11] step[       180] speed[262207]\n[2017-01-15 12:54:41] time[  0.12] step[       210] speed[255981]\n[2017-01-15 12:54:41] time[  0.25] step[       240] speed[118329]\n[2017-01-15 12:54:42] time[  1.17] step[       270] speed[ 25723]\n[2017-01-15 12:54:46] time[  3.86] step[       300] speed[  7762]\n[2017-01-15 12:54:50] time[  3.99] step[       330] speed[  7524]\n\n\nwhen I increase the thread number , the speed become slow.  the best number is  2.\nMy server are 24cores cpu, and the disk read speed are only 400KB/s in average (see from iotop command )\n\n[2017-01-15 12:56:04] time[  0.26] step[        30] speed[115136]\n[2017-01-15 12:56:04] time[  0.27] step[        60] speed[109339]\n[2017-01-15 12:56:04] time[  0.27] step[        90] speed[110254]\n[2017-01-15 12:56:05] time[  0.32] step[       120] speed[ 92811]\n[2017-01-15 12:56:05] time[  0.29] step[       150] speed[102403]\n[2017-01-15 12:56:05] time[  0.27] step[       180] speed[109489]\n[2017-01-15 12:56:07] time[  2.08] step[       210] speed[ 14409]\n[2017-01-15 12:56:12] time[  4.84] step[       240] speed[  6195]\n[2017-01-15 12:56:17] time[  4.75] step[       270] speed[  6316]\n[2017-01-15 12:56:22] time[  4.78] step[       300] speed[  6282]", "body": "@yaroslavvb   I do as you said.    \r\nAfter I add `time.sleep` and increase `capacity` in tf.batch, the speed changed from 7k/s to 70k/s. \r\nBut I find two things :   \r\n1) the speed become slower with the time elapse.  \r\n```\r\n[2017-01-15 12:54:40] time[  0.11] step[        30] speed[265345]\r\n[2017-01-15 12:54:40] time[  0.12] step[        60] speed[256539]\r\n[2017-01-15 12:54:40] time[  0.11] step[        90] speed[274768]\r\n[2017-01-15 12:54:40] time[  0.12] step[       120] speed[257424]\r\n[2017-01-15 12:54:40] time[  0.11] step[       150] speed[262851]\r\n[2017-01-15 12:54:41] time[  0.11] step[       180] speed[262207]\r\n[2017-01-15 12:54:41] time[  0.12] step[       210] speed[255981]\r\n[2017-01-15 12:54:41] time[  0.25] step[       240] speed[118329]\r\n[2017-01-15 12:54:42] time[  1.17] step[       270] speed[ 25723]\r\n[2017-01-15 12:54:46] time[  3.86] step[       300] speed[  7762]\r\n[2017-01-15 12:54:50] time[  3.99] step[       330] speed[  7524]\r\n```\r\n2) when I increase the thread number , the speed become slow.  the best number is  2.\r\nMy server are 24cores cpu, and the disk read speed are only 400KB/s in average (see from iotop command )\r\n```\r\n[2017-01-15 12:56:04] time[  0.26] step[        30] speed[115136]\r\n[2017-01-15 12:56:04] time[  0.27] step[        60] speed[109339]\r\n[2017-01-15 12:56:04] time[  0.27] step[        90] speed[110254]\r\n[2017-01-15 12:56:05] time[  0.32] step[       120] speed[ 92811]\r\n[2017-01-15 12:56:05] time[  0.29] step[       150] speed[102403]\r\n[2017-01-15 12:56:05] time[  0.27] step[       180] speed[109489]\r\n[2017-01-15 12:56:07] time[  2.08] step[       210] speed[ 14409]\r\n[2017-01-15 12:56:12] time[  4.84] step[       240] speed[  6195]\r\n[2017-01-15 12:56:17] time[  4.75] step[       270] speed[  6316]\r\n[2017-01-15 12:56:22] time[  4.78] step[       300] speed[  6282]\r\n```"}