{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/272642832", "html_url": "https://github.com/tensorflow/tensorflow/issues/6845#issuecomment-272642832", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6845", "id": 272642832, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY0MjgzMg==", "user": {"login": "yaroslavvb", "id": 23068, "node_id": "MDQ6VXNlcjIzMDY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaroslavvb", "html_url": "https://github.com/yaroslavvb", "followers_url": "https://api.github.com/users/yaroslavvb/followers", "following_url": "https://api.github.com/users/yaroslavvb/following{/other_user}", "gists_url": "https://api.github.com/users/yaroslavvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaroslavvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaroslavvb/subscriptions", "organizations_url": "https://api.github.com/users/yaroslavvb/orgs", "repos_url": "https://api.github.com/users/yaroslavvb/repos", "events_url": "https://api.github.com/users/yaroslavvb/events{/privacy}", "received_events_url": "https://api.github.com/users/yaroslavvb/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-14T18:24:06Z", "updated_at": "2017-01-14T18:26:59Z", "author_association": "CONTRIBUTOR", "body_html": "<p>It's not clear if it's a bug in TensorFlow or somewhere else....can you give a reproducible example? (ie, I can't run your example because it's missing the input files).</p>\n<p>Also, the time Dequeue op takes is surprisingly similar to the time in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"180785242\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/4740\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/4740/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/4740\">#4740</a> . The issue there was queue starvation. Python thread scheduler always scheduled compute thread ahead of data prefetching thread, so at every step the compute thread was blocked in Dequeue, and the time to context switch, read single example and switch back to compute was about 10 ms.</p>\n<p>Some explanation <a href=\"http://stackoverflow.com/a/39842628/419116\" rel=\"nofollow\">here</a></p>\n<p>Can you rule out queue starvation? (ie, increase queue size to fit the entire dataset, start queue runners, do time.sleep in main thread, and print(sess.run(queue.size())) to make sure queue is filled up before running computation)</p>", "body_text": "It's not clear if it's a bug in TensorFlow or somewhere else....can you give a reproducible example? (ie, I can't run your example because it's missing the input files).\nAlso, the time Dequeue op takes is surprisingly similar to the time in #4740 . The issue there was queue starvation. Python thread scheduler always scheduled compute thread ahead of data prefetching thread, so at every step the compute thread was blocked in Dequeue, and the time to context switch, read single example and switch back to compute was about 10 ms.\nSome explanation here\nCan you rule out queue starvation? (ie, increase queue size to fit the entire dataset, start queue runners, do time.sleep in main thread, and print(sess.run(queue.size())) to make sure queue is filled up before running computation)", "body": "It's not clear if it's a bug in TensorFlow or somewhere else....can you give a reproducible example? (ie, I can't run your example because it's missing the input files). \r\n\r\nAlso, the time Dequeue op takes is surprisingly similar to the time in https://github.com/tensorflow/tensorflow/issues/4740 . The issue there was queue starvation. Python thread scheduler always scheduled compute thread ahead of data prefetching thread, so at every step the compute thread was blocked in Dequeue, and the time to context switch, read single example and switch back to compute was about 10 ms.\r\n\r\nSome explanation [here](http://stackoverflow.com/a/39842628/419116)\r\n\r\nCan you rule out queue starvation? (ie, increase queue size to fit the entire dataset, start queue runners, do time.sleep in main thread, and print(sess.run(queue.size())) to make sure queue is filled up before running computation)"}