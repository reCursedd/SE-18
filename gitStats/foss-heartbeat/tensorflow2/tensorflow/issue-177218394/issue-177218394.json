{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4397", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4397/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4397/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4397/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4397", "id": 177218394, "node_id": "MDU6SXNzdWUxNzcyMTgzOTQ=", "number": 4397, "title": "Docker build devel-gpu build fails with 8.0-cudnn5-devel (Cannot find cudnn.h under .../lib)", "user": {"login": "pwaller", "id": 438648, "node_id": "MDQ6VXNlcjQzODY0OA==", "avatar_url": "https://avatars0.githubusercontent.com/u/438648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pwaller", "html_url": "https://github.com/pwaller", "followers_url": "https://api.github.com/users/pwaller/followers", "following_url": "https://api.github.com/users/pwaller/following{/other_user}", "gists_url": "https://api.github.com/users/pwaller/gists{/gist_id}", "starred_url": "https://api.github.com/users/pwaller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pwaller/subscriptions", "organizations_url": "https://api.github.com/users/pwaller/orgs", "repos_url": "https://api.github.com/users/pwaller/repos", "events_url": "https://api.github.com/users/pwaller/events{/privacy}", "received_events_url": "https://api.github.com/users/pwaller/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 29, "created_at": "2016-09-15T16:04:12Z", "updated_at": "2016-11-08T07:25:33Z", "closed_at": "2016-10-19T01:46:19Z", "author_association": "NONE", "body_html": "<p><strong>Summary</strong>: Why is it looking for the header file under the lib directory?</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<ul>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"172765666\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/3989\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/3989/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/3989\">#3989</a> (and references within)</li>\n</ul>\n<h3>Environment info</h3>\n<p>Operating System: Ubuntu 16.04. Docker 1.12.1.</p>\n<h3>If possible, provide a minimal reproducible example</h3>\n<ol>\n<li>Modify <a href=\"https://github.com/tensorflow/tensorflow/blob/4addf4b5806cd731949c6582a83f5824599cd1ef/tensorflow/tools/docker/Dockerfile.devel-gpu\">devel-gpu</a> to read \"<code>FROM nvidia/cuda:8.0-cudnn5-devel</code>\".</li>\n<li>Run <code>docker build -f Dockerfile.devel-gpu -t tf</code> from the <code>/tensorflow/tools/docker</code> directory. (HEAD @ <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/4addf4b5806cd731949c6582a83f5824599cd1ef/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/4addf4b5806cd731949c6582a83f5824599cd1ef\"><tt>4addf4b</tt></a> at time of posting)</li>\n</ol>\n<h3>What other attempted solutions have you tried?</h3>\n<p>None yet, I'm not sure how to poke Bazel. I will continue poking around after filing the issue.</p>\n<h3>Logs or other output that would be helpful</h3>\n<pre><code>$ docker build -f Dockerfile.devel-gpu -t tf .\n\n[snip]\n\nStep 23 : RUN ./configure &amp;&amp;     bazel build -c opt --config=cuda tensorflow/tools/pip_package:build_pip_package &amp;&amp;     bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &amp;&amp;     pip install --upgrade /tmp/pip/tensorflow-*.whl\n ---&gt; Running in 1f99527c7748\nNo Google Cloud Platform support will be enabled for TensorFlow\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nExtracting Bazel installation...\n____Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package '': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 412\n        _create_cuda_repository(repository_ctx)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 344, in _create_cuda_repository\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 233, in _find_cudnn_header_dir\n        fail(\"Cannot find cudnn.h under %s\" %...)\nCannot find cudnn.h under /usr/local/cuda-8.0/targets/x86_64-linux/lib.\nConfiguration finished\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nWARNING: Sandboxed execution is not supported on your system and thus hermeticity of actions cannot be guaranteed. See http://bazel.io/docs/bazel-user-manual.html#sandboxing for more information. You can turn off this warning via --ignore_unsupported_sandboxing.\nERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package '': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 412\n        _create_cuda_repository(repository_ctx)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 344, in _create_cuda_repository\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 233, in _find_cudnn_header_dir\n        fail(\"Cannot find cudnn.h under %s\" %...)\nCannot find cudnn.h under /usr/lib/x86_64-linux-gnu.\n____Elapsed time: 0.391s\nThe command '/bin/sh -c ./configure &amp;&amp;     bazel build -c opt --config=cuda tensorflow/tools/pip_package:build_pip_package &amp;&amp;     bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &amp;&amp;     pip install --upgrade /tmp/pip/tensorflow-*.whl' returned a non-zero code: 1\n</code></pre>", "body_text": "Summary: Why is it looking for the header file under the lib directory?\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n\n#3989 (and references within)\n\nEnvironment info\nOperating System: Ubuntu 16.04. Docker 1.12.1.\nIf possible, provide a minimal reproducible example\n\nModify devel-gpu to read \"FROM nvidia/cuda:8.0-cudnn5-devel\".\nRun docker build -f Dockerfile.devel-gpu -t tf from the /tensorflow/tools/docker directory. (HEAD @ 4addf4b at time of posting)\n\nWhat other attempted solutions have you tried?\nNone yet, I'm not sure how to poke Bazel. I will continue poking around after filing the issue.\nLogs or other output that would be helpful\n$ docker build -f Dockerfile.devel-gpu -t tf .\n\n[snip]\n\nStep 23 : RUN ./configure &&     bazel build -c opt --config=cuda tensorflow/tools/pip_package:build_pip_package &&     bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &&     pip install --upgrade /tmp/pip/tensorflow-*.whl\n ---> Running in 1f99527c7748\nNo Google Cloud Platform support will be enabled for TensorFlow\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nExtracting Bazel installation...\n____Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package '': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 412\n        _create_cuda_repository(repository_ctx)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 344, in _create_cuda_repository\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 233, in _find_cudnn_header_dir\n        fail(\"Cannot find cudnn.h under %s\" %...)\nCannot find cudnn.h under /usr/local/cuda-8.0/targets/x86_64-linux/lib.\nConfiguration finished\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nWARNING: Sandboxed execution is not supported on your system and thus hermeticity of actions cannot be guaranteed. See http://bazel.io/docs/bazel-user-manual.html#sandboxing for more information. You can turn off this warning via --ignore_unsupported_sandboxing.\nERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package '': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 412\n        _create_cuda_repository(repository_ctx)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 344, in _create_cuda_repository\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 233, in _find_cudnn_header_dir\n        fail(\"Cannot find cudnn.h under %s\" %...)\nCannot find cudnn.h under /usr/lib/x86_64-linux-gnu.\n____Elapsed time: 0.391s\nThe command '/bin/sh -c ./configure &&     bazel build -c opt --config=cuda tensorflow/tools/pip_package:build_pip_package &&     bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &&     pip install --upgrade /tmp/pip/tensorflow-*.whl' returned a non-zero code: 1", "body": "**Summary**: Why is it looking for the header file under the lib directory?\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n- https://github.com/tensorflow/tensorflow/issues/3989 (and references within)\n### Environment info\n\nOperating System: Ubuntu 16.04. Docker 1.12.1.\n### If possible, provide a minimal reproducible example\n1. Modify [devel-gpu](https://github.com/tensorflow/tensorflow/blob/4addf4b5806cd731949c6582a83f5824599cd1ef/tensorflow/tools/docker/Dockerfile.devel-gpu) to read \"`FROM nvidia/cuda:8.0-cudnn5-devel`\".\n2. Run `docker build -f Dockerfile.devel-gpu -t tf` from the `/tensorflow/tools/docker` directory. (HEAD @ 4addf4b5806cd731949c6582a83f5824599cd1ef at time of posting)\n### What other attempted solutions have you tried?\n\nNone yet, I'm not sure how to poke Bazel. I will continue poking around after filing the issue.\n### Logs or other output that would be helpful\n\n```\n$ docker build -f Dockerfile.devel-gpu -t tf .\n\n[snip]\n\nStep 23 : RUN ./configure &&     bazel build -c opt --config=cuda tensorflow/tools/pip_package:build_pip_package &&     bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &&     pip install --upgrade /tmp/pip/tensorflow-*.whl\n ---> Running in 1f99527c7748\nNo Google Cloud Platform support will be enabled for TensorFlow\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nExtracting Bazel installation...\n____Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package '': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 412\n        _create_cuda_repository(repository_ctx)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 344, in _create_cuda_repository\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 233, in _find_cudnn_header_dir\n        fail(\"Cannot find cudnn.h under %s\" %...)\nCannot find cudnn.h under /usr/local/cuda-8.0/targets/x86_64-linux/lib.\nConfiguration finished\nINFO: Reading 'startup' options from /root/.bazelrc: --batch\nWARNING: Sandboxed execution is not supported on your system and thus hermeticity of actions cannot be guaranteed. See http://bazel.io/docs/bazel-user-manual.html#sandboxing for more information. You can turn off this warning via --ignore_unsupported_sandboxing.\nERROR: com.google.devtools.build.lib.packages.BuildFileContainsErrorsException: error loading package '': Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 412\n        _create_cuda_repository(repository_ctx)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 344, in _create_cuda_repository\n        _find_cudnn_header_dir(repository_ctx, cudnn_install_base...)\n    File \"/tensorflow/third_party/gpus/cuda_configure.bzl\", line 233, in _find_cudnn_header_dir\n        fail(\"Cannot find cudnn.h under %s\" %...)\nCannot find cudnn.h under /usr/lib/x86_64-linux-gnu.\n____Elapsed time: 0.391s\nThe command '/bin/sh -c ./configure &&     bazel build -c opt --config=cuda tensorflow/tools/pip_package:build_pip_package &&     bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/pip &&     pip install --upgrade /tmp/pip/tensorflow-*.whl' returned a non-zero code: 1\n```\n"}