{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13473", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13473/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13473/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13473/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13473", "id": 262570439, "node_id": "MDU6SXNzdWUyNjI1NzA0Mzk=", "number": 13473, "title": "StochasticTensor strange behavior", "user": {"login": "denmoroz", "id": 5019624, "node_id": "MDQ6VXNlcjUwMTk2MjQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/5019624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/denmoroz", "html_url": "https://github.com/denmoroz", "followers_url": "https://api.github.com/users/denmoroz/followers", "following_url": "https://api.github.com/users/denmoroz/following{/other_user}", "gists_url": "https://api.github.com/users/denmoroz/gists{/gist_id}", "starred_url": "https://api.github.com/users/denmoroz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/denmoroz/subscriptions", "organizations_url": "https://api.github.com/users/denmoroz/orgs", "repos_url": "https://api.github.com/users/denmoroz/repos", "events_url": "https://api.github.com/users/denmoroz/events{/privacy}", "received_events_url": "https://api.github.com/users/denmoroz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-10-03T20:15:02Z", "updated_at": "2017-10-12T21:56:46Z", "closed_at": "2017-10-12T21:56:46Z", "author_association": "NONE", "body_html": "<p>I've noticed strange behavior of StochasticTensor. Please, look at this peace of code:</p>\n<pre><code>inputs = tf.placeholder(shape=(1, 10, ), name=\"inputs\", dtype=tf.float32)\n\noutputs = tf.layers.dense(inputs, units=10, use_bias=False, activation=tf.nn.sigmoid)\noutputs = st.StochasticTensor(distributions.Bernoulli(probs=outputs, dtype=tf.int32))\noutputs = tf.reshape(outputs, shape=(-1, ))\n\ninit_op = tf.group(\n    tf.global_variables_initializer(),\n    tf.local_variables_initializer()\n)\n\nwith tf.Session() as sess:\n    sess.run(init_op)\n    x = np.random.rand(1, 10)\n    \n    tf.set_random_seed(2017)\n    z1 = sess.run(outputs, feed_dict={inputs: x})\n    \n    tf.set_random_seed(2017)\n    z2 = sess.run(outputs, feed_dict={inputs: x})\n\nprint(z1)\nprint(z2)\n</code></pre>\n<p>As the result I get:<br>\n<code>[1 0 1 0 0 1 1 1 0 0] [0 1 0 1 0 1 0 1 1 1]</code></p>\n<p>But numpy sampling has another behavior:</p>\n<pre><code>    np.random.seed(2017)\n    x = np.random.randint(0, 10, size=10)\n\n    np.random.seed(2017)\n    y = np.random.randint(0, 10, size=10)\n\n    print(x)\n    print(y)\n</code></pre>\n<p>And (again) the result:<br>\n<code>[9 6 8 2 3 7 8 0 8 6] [9 6 8 2 3 7 8 0 8 6]</code></p>\n<p>Is it an issue?</p>\n<p>P.S.<br>\nTensorflow v1.3.0-rc2-20-g0787eee</p>", "body_text": "I've noticed strange behavior of StochasticTensor. Please, look at this peace of code:\ninputs = tf.placeholder(shape=(1, 10, ), name=\"inputs\", dtype=tf.float32)\n\noutputs = tf.layers.dense(inputs, units=10, use_bias=False, activation=tf.nn.sigmoid)\noutputs = st.StochasticTensor(distributions.Bernoulli(probs=outputs, dtype=tf.int32))\noutputs = tf.reshape(outputs, shape=(-1, ))\n\ninit_op = tf.group(\n    tf.global_variables_initializer(),\n    tf.local_variables_initializer()\n)\n\nwith tf.Session() as sess:\n    sess.run(init_op)\n    x = np.random.rand(1, 10)\n    \n    tf.set_random_seed(2017)\n    z1 = sess.run(outputs, feed_dict={inputs: x})\n    \n    tf.set_random_seed(2017)\n    z2 = sess.run(outputs, feed_dict={inputs: x})\n\nprint(z1)\nprint(z2)\n\nAs the result I get:\n[1 0 1 0 0 1 1 1 0 0] [0 1 0 1 0 1 0 1 1 1]\nBut numpy sampling has another behavior:\n    np.random.seed(2017)\n    x = np.random.randint(0, 10, size=10)\n\n    np.random.seed(2017)\n    y = np.random.randint(0, 10, size=10)\n\n    print(x)\n    print(y)\n\nAnd (again) the result:\n[9 6 8 2 3 7 8 0 8 6] [9 6 8 2 3 7 8 0 8 6]\nIs it an issue?\nP.S.\nTensorflow v1.3.0-rc2-20-g0787eee", "body": "I've noticed strange behavior of StochasticTensor. Please, look at this peace of code: \r\n\r\n    inputs = tf.placeholder(shape=(1, 10, ), name=\"inputs\", dtype=tf.float32)\r\n\r\n    outputs = tf.layers.dense(inputs, units=10, use_bias=False, activation=tf.nn.sigmoid)\r\n    outputs = st.StochasticTensor(distributions.Bernoulli(probs=outputs, dtype=tf.int32))\r\n    outputs = tf.reshape(outputs, shape=(-1, ))\r\n    \r\n    init_op = tf.group(\r\n        tf.global_variables_initializer(),\r\n        tf.local_variables_initializer()\r\n    )\r\n    \r\n    with tf.Session() as sess:\r\n        sess.run(init_op)\r\n        x = np.random.rand(1, 10)\r\n        \r\n        tf.set_random_seed(2017)\r\n        z1 = sess.run(outputs, feed_dict={inputs: x})\r\n        \r\n        tf.set_random_seed(2017)\r\n        z2 = sess.run(outputs, feed_dict={inputs: x})\r\n    \r\n    print(z1)\r\n    print(z2)\r\n\r\nAs the result I get:\r\n`\r\n[1 0 1 0 0 1 1 1 0 0]\r\n[0 1 0 1 0 1 0 1 1 1]\r\n`\r\n\r\nBut numpy sampling has another behavior:\r\n\r\n        np.random.seed(2017)\r\n        x = np.random.randint(0, 10, size=10)\r\n\r\n        np.random.seed(2017)\r\n        y = np.random.randint(0, 10, size=10)\r\n\r\n        print(x)\r\n        print(y)\r\n\r\nAnd (again) the result:\r\n`\r\n[9 6 8 2 3 7 8 0 8 6]\r\n[9 6 8 2 3 7 8 0 8 6]\r\n`\r\n\r\nIs it an issue?\r\n\r\nP.S.\r\nTensorflow v1.3.0-rc2-20-g0787eee"}