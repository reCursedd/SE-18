{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15336", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15336/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15336/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15336/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15336", "id": 281679048, "node_id": "MDU6SXNzdWUyODE2NzkwNDg=", "number": 15336, "title": "batch normalization layer which translated by toco cannot be run in TF Lite", "user": {"login": "Corea", "id": 1433166, "node_id": "MDQ6VXNlcjE0MzMxNjY=", "avatar_url": "https://avatars2.githubusercontent.com/u/1433166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Corea", "html_url": "https://github.com/Corea", "followers_url": "https://api.github.com/users/Corea/followers", "following_url": "https://api.github.com/users/Corea/following{/other_user}", "gists_url": "https://api.github.com/users/Corea/gists{/gist_id}", "starred_url": "https://api.github.com/users/Corea/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Corea/subscriptions", "organizations_url": "https://api.github.com/users/Corea/orgs", "repos_url": "https://api.github.com/users/Corea/repos", "events_url": "https://api.github.com/users/Corea/events{/privacy}", "received_events_url": "https://api.github.com/users/Corea/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2017-12-13T09:28:21Z", "updated_at": "2018-11-11T15:51:33Z", "closed_at": "2018-04-03T02:13:00Z", "author_association": "CONTRIBUTOR", "body_html": "<h2>Issue</h2>\n<p>Resolver for batch normalization layer(<code>ResolveBatchNormalization</code>) in toco has four inputs, which are input matrix, mean, multiplier, and offset respectively. Usually, input matrix has four dimensions (NHWC) while mean, multiplier, and offset only have 1 dimension for a channel. This resolver translates this 1 dimension vector to second input of <code>Mul</code> and <code>Add</code> layers in TF Lite. (first input of these layers is input matrix!) But the problem occurs <code>Mul</code> and <code>Add</code> layers in TF Lite have a process to check dimension of inputs. Need to fix this contradiction. :)</p>\n<h2>Codes related to this Issue</h2>\n<p><a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/toco/graph_transformations/resolve_batch_normalization.cc\">Resolver</a><br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/kernels/add.cc#L48\">Logic of checking dimension in add layer</a><br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/kernels/mul.cc#L48\">Logic of checking dimension in mul layer</a></p>", "body_text": "Issue\nResolver for batch normalization layer(ResolveBatchNormalization) in toco has four inputs, which are input matrix, mean, multiplier, and offset respectively. Usually, input matrix has four dimensions (NHWC) while mean, multiplier, and offset only have 1 dimension for a channel. This resolver translates this 1 dimension vector to second input of Mul and Add layers in TF Lite. (first input of these layers is input matrix!) But the problem occurs Mul and Add layers in TF Lite have a process to check dimension of inputs. Need to fix this contradiction. :)\nCodes related to this Issue\nResolver\nLogic of checking dimension in add layer\nLogic of checking dimension in mul layer", "body": "## Issue\r\nResolver for batch normalization layer(`ResolveBatchNormalization`) in toco has four inputs, which are input matrix, mean, multiplier, and offset respectively. Usually, input matrix has four dimensions (NHWC) while mean, multiplier, and offset only have 1 dimension for a channel. This resolver translates this 1 dimension vector to second input of `Mul` and `Add` layers in TF Lite. (first input of these layers is input matrix!) But the problem occurs `Mul` and `Add` layers in TF Lite have a process to check dimension of inputs. Need to fix this contradiction. :) \r\n\r\n\r\n## Codes related to this Issue\r\n[Resolver](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/toco/graph_transformations/resolve_batch_normalization.cc)\r\n[Logic of checking dimension in add layer](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/kernels/add.cc#L48)\r\n[Logic of checking dimension in mul layer](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/kernels/mul.cc#L48)\r\n"}