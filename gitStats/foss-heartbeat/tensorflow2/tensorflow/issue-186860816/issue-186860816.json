{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5357", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5357/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5357/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5357/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5357", "id": 186860816, "node_id": "MDU6SXNzdWUxODY4NjA4MTY=", "number": 5357, "title": "Bazel fails to clean", "user": {"login": "Randl", "id": 3028543, "node_id": "MDQ6VXNlcjMwMjg1NDM=", "avatar_url": "https://avatars0.githubusercontent.com/u/3028543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Randl", "html_url": "https://github.com/Randl", "followers_url": "https://api.github.com/users/Randl/followers", "following_url": "https://api.github.com/users/Randl/following{/other_user}", "gists_url": "https://api.github.com/users/Randl/gists{/gist_id}", "starred_url": "https://api.github.com/users/Randl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Randl/subscriptions", "organizations_url": "https://api.github.com/users/Randl/orgs", "repos_url": "https://api.github.com/users/Randl/repos", "events_url": "https://api.github.com/users/Randl/events{/privacy}", "received_events_url": "https://api.github.com/users/Randl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-11-02T17:03:57Z", "updated_at": "2016-11-03T12:27:50Z", "closed_at": "2016-11-03T12:27:50Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Bazel fails to clean with following message</p>\n<pre><code>WARNING: Output base '/home/username/.cache/bazel/_bazel_username/acf2af86672e1552dfd6edd47d54a950' is on NFS. This may lead to surprising failures and undetermined behavior.\n.\nINFO: Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.\nERROR: /home/username/.cache/bazel/_bazel_username/acf2af86672e1552dfd6edd47d54a950/server (Directory not empty).\n</code></pre>\n<p>Replacement of <code>bazel clean --expunge</code> with <code>bazel clean --expunge_async</code> <a href=\"https://github.com/tensorflow/tensorflow/blob/master/configure#L25\">here</a> fixes the issue.</p>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nUbuntu 16.04</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):</p>\n<pre><code>$ ls -l /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcud*\n-rw-r--r-- 1 root root 558720 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudadevrt.a\nlrwxrwxrwx 1 root root     16 Sep 15 02:05 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so -&gt; libcudart.so.8.0\nlrwxrwxrwx 1 root root     19 Sep 15 02:05 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0 -&gt; libcudart.so.8.0.44\n-rw-r--r-- 1 root root 415432 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.44\n-rw-r--r-- 1 root root 775162 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\n</code></pre>\n<ol>\n<li>The commit hash (<code>git rev-parse HEAD</code>)</li>\n</ol>\n<pre><code>$ git rev-parse HEAD\n7443479c9261b893d00c923bf53d924bbae9bc64\n</code></pre>\n<ol start=\"2\">\n<li>The output of <code>bazel version</code></li>\n</ol>\n<pre><code>$ bazel version\nWARNING: Output base '/home/username/.cache/bazel/_bazel_chaimb/acf2af86672e1552dfd6edd47d54a950' is on NFS. This may lead to surprising failures and undetermined behavior.\nBuild label: 0.3.2\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\nBuild timestamp: 1475861110\nBuild timestamp as int: 1475861110\n</code></pre>", "body_text": "Bazel fails to clean with following message\nWARNING: Output base '/home/username/.cache/bazel/_bazel_username/acf2af86672e1552dfd6edd47d54a950' is on NFS. This may lead to surprising failures and undetermined behavior.\n.\nINFO: Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.\nERROR: /home/username/.cache/bazel/_bazel_username/acf2af86672e1552dfd6edd47d54a950/server (Directory not empty).\n\nReplacement of bazel clean --expunge with bazel clean --expunge_async here fixes the issue.\nEnvironment info\nOperating System:\nUbuntu 16.04\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\n$ ls -l /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcud*\n-rw-r--r-- 1 root root 558720 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudadevrt.a\nlrwxrwxrwx 1 root root     16 Sep 15 02:05 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so -> libcudart.so.8.0\nlrwxrwxrwx 1 root root     19 Sep 15 02:05 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0 -> libcudart.so.8.0.44\n-rw-r--r-- 1 root root 415432 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.44\n-rw-r--r-- 1 root root 775162 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\n\n\nThe commit hash (git rev-parse HEAD)\n\n$ git rev-parse HEAD\n7443479c9261b893d00c923bf53d924bbae9bc64\n\n\nThe output of bazel version\n\n$ bazel version\nWARNING: Output base '/home/username/.cache/bazel/_bazel_chaimb/acf2af86672e1552dfd6edd47d54a950' is on NFS. This may lead to surprising failures and undetermined behavior.\nBuild label: 0.3.2\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\nBuild timestamp: 1475861110\nBuild timestamp as int: 1475861110", "body": "Bazel fails to clean with following message\r\n```\r\nWARNING: Output base '/home/username/.cache/bazel/_bazel_username/acf2af86672e1552dfd6edd47d54a950' is on NFS. This may lead to surprising failures and undetermined behavior.\r\n.\r\nINFO: Starting clean (this may take a while). Consider using --expunge_async if the clean takes more than several minutes.\r\nERROR: /home/username/.cache/bazel/_bazel_username/acf2af86672e1552dfd6edd47d54a950/server (Directory not empty).\r\n```\r\nReplacement of `bazel clean --expunge` with `bazel clean --expunge_async` [here](https://github.com/tensorflow/tensorflow/blob/master/configure#L25) fixes the issue.\r\n### Environment info\r\nOperating System:\r\nUbuntu 16.04\r\n\r\nInstalled version of CUDA and cuDNN: \r\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\r\n```\r\n$ ls -l /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcud*\r\n-rw-r--r-- 1 root root 558720 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudadevrt.a\r\nlrwxrwxrwx 1 root root     16 Sep 15 02:05 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so -> libcudart.so.8.0\r\nlrwxrwxrwx 1 root root     19 Sep 15 02:05 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0 -> libcudart.so.8.0.44\r\n-rw-r--r-- 1 root root 415432 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.44\r\n-rw-r--r-- 1 root root 775162 Sep 15 02:02 /usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\r\n``` \r\n\r\n1. The commit hash (`git rev-parse HEAD`)\r\n```\r\n$ git rev-parse HEAD\r\n7443479c9261b893d00c923bf53d924bbae9bc64\r\n```\r\n2. The output of `bazel version`\r\n```\r\n$ bazel version\r\nWARNING: Output base '/home/username/.cache/bazel/_bazel_chaimb/acf2af86672e1552dfd6edd47d54a950' is on NFS. This may lead to surprising failures and undetermined behavior.\r\nBuild label: 0.3.2\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Fri Oct 7 17:25:10 2016 (1475861110)\r\nBuild timestamp: 1475861110\r\nBuild timestamp as int: 1475861110\r\n```\r\n"}