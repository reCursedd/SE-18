{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/142074937", "pull_request_review_id": 66384438, "id": 142074937, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0MjA3NDkzNw==", "diff_hunk": "@@ -120,13 +120,79 @@ def tile_batch(t, multiplier, name=None):\n     return nest.map_structure(lambda t_: _tile_batch(t_, multiplier), t)\n \n \n-def _check_maybe(t):\n+def _map_function(fn, t):\n+  \"\"\"Maps the function fn on each element of the TensorArray t.\"\"\"\n+  loop_stop = lambda mapped, elems, i: (\n+      i == elems.size())\n+  loop_body = lambda mapped, elems, i: (\n+      mapped.write(i, fn(elems.read(i))), elems, i + 1)\n+  mapped = tensor_array_ops.TensorArray(t.dtype, size=0, dynamic_size=True)\n+  mapped, _, _ = control_flow_ops.while_loop(", "path": "tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py", "position": null, "original_position": 12, "commit_id": "d3eb228f1db2d60caf380833684944ce12203634", "original_commit_id": "4721842b35678ec10aea5ca603edb602059f7744", "user": {"login": "guillaumekln", "id": 4805513, "node_id": "MDQ6VXNlcjQ4MDU1MTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/4805513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guillaumekln", "html_url": "https://github.com/guillaumekln", "followers_url": "https://api.github.com/users/guillaumekln/followers", "following_url": "https://api.github.com/users/guillaumekln/following{/other_user}", "gists_url": "https://api.github.com/users/guillaumekln/gists{/gist_id}", "starred_url": "https://api.github.com/users/guillaumekln/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guillaumekln/subscriptions", "organizations_url": "https://api.github.com/users/guillaumekln/orgs", "repos_url": "https://api.github.com/users/guillaumekln/repos", "events_url": "https://api.github.com/users/guillaumekln/events{/privacy}", "received_events_url": "https://api.github.com/users/guillaumekln/received_events", "type": "User", "site_admin": false}, "body": "The idea is to keep the beams in the correct order at each timestep.\r\n\r\nI guess it could also be done at the end of the decoding but the implementation here is more generic than just alignment history. The `TensorArray` might not contain time-based series.", "created_at": "2017-10-02T08:08:22Z", "updated_at": "2018-03-17T07:09:51Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/13312#discussion_r142074937", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13312", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/142074937"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/13312#discussion_r142074937"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13312"}}, "body_html": "<p>The idea is to keep the beams in the correct order at each timestep.</p>\n<p>I guess it could also be done at the end of the decoding but the implementation here is more generic than just alignment history. The <code>TensorArray</code> might not contain time-based series.</p>", "body_text": "The idea is to keep the beams in the correct order at each timestep.\nI guess it could also be done at the end of the decoding but the implementation here is more generic than just alignment history. The TensorArray might not contain time-based series.", "in_reply_to_id": 141982194}