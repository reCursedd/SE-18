{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/158311174", "pull_request_review_id": 85102114, "id": 158311174, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE1ODMxMTE3NA==", "diff_hunk": "@@ -806,3 +873,22 @@ def _tensor_gather_helper(gather_indices, gather_from, batch_size,\n     output = array_ops.reshape(output, final_shape, name=\"output\")\n     output.set_shape(final_static_shape)\n     return output\n+\n+\n+def _maybe_sort_array_beams(t, parent_ids, sequence_length):\n+  \"\"\"Maybe sorts beams within a `TensorArray`.\n+\n+  Args:\n+    t: A `TensorArray` of size `max_time` that contains `Tensor`s of shape\n+      `[batch_size, beam_width, depth]`.\n+    parent_ids: The parent ids of shape `[max_time, batch_size, beam_width]`.\n+    sequence_length: The sequence length of shape `[batch_size, beam_width]`.\n+\n+  Returns:\n+    A `TensorArray` where beams are sorted in each `Tensor` or `t` itself if it\n+    is not a `TensorArray`.\n+  \"\"\"\n+  if isinstance(t, tensor_array_ops.TensorArray):", "path": "tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py", "position": null, "original_position": 136, "commit_id": "d3eb228f1db2d60caf380833684944ce12203634", "original_commit_id": "1c09f329b8ade55351ed96e1f2951031b599bb87", "user": {"login": "guillaumekln", "id": 4805513, "node_id": "MDQ6VXNlcjQ4MDU1MTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/4805513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guillaumekln", "html_url": "https://github.com/guillaumekln", "followers_url": "https://api.github.com/users/guillaumekln/followers", "following_url": "https://api.github.com/users/guillaumekln/following{/other_user}", "gists_url": "https://api.github.com/users/guillaumekln/gists{/gist_id}", "starred_url": "https://api.github.com/users/guillaumekln/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guillaumekln/subscriptions", "organizations_url": "https://api.github.com/users/guillaumekln/orgs", "repos_url": "https://api.github.com/users/guillaumekln/repos", "events_url": "https://api.github.com/users/guillaumekln/events{/privacy}", "received_events_url": "https://api.github.com/users/guillaumekln/received_events", "type": "User", "site_admin": false}, "body": "Currently, the assumptions are:\r\n\r\n1. the TensorArrays size is the time dimension\r\n2. the TensorArrays contain Tensors with the same shape assumption as Tensors that are directly in the cell state\r\n\r\n> Guard against it; enable by default, but if there's a failure raise a warning message that the user should disable the TensorArray sorting.\r\n\r\nDo you mean to try/catch the call to `gather_tree_from_array` and expose a flag to disable any post process on TensorArrays?", "created_at": "2017-12-21T15:52:55Z", "updated_at": "2018-03-17T07:09:51Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/13312#discussion_r158311174", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13312", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/158311174"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/13312#discussion_r158311174"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13312"}}, "body_html": "<p>Currently, the assumptions are:</p>\n<ol>\n<li>the TensorArrays size is the time dimension</li>\n<li>the TensorArrays contain Tensors with the same shape assumption as Tensors that are directly in the cell state</li>\n</ol>\n<blockquote>\n<p>Guard against it; enable by default, but if there's a failure raise a warning message that the user should disable the TensorArray sorting.</p>\n</blockquote>\n<p>Do you mean to try/catch the call to <code>gather_tree_from_array</code> and expose a flag to disable any post process on TensorArrays?</p>", "body_text": "Currently, the assumptions are:\n\nthe TensorArrays size is the time dimension\nthe TensorArrays contain Tensors with the same shape assumption as Tensors that are directly in the cell state\n\n\nGuard against it; enable by default, but if there's a failure raise a warning message that the user should disable the TensorArray sorting.\n\nDo you mean to try/catch the call to gather_tree_from_array and expose a flag to disable any post process on TensorArrays?", "in_reply_to_id": 158077431}