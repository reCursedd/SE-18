{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/353392012", "html_url": "https://github.com/tensorflow/tensorflow/pull/13312#issuecomment-353392012", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13312", "id": 353392012, "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzM5MjAxMg==", "user": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "created_at": "2017-12-21T16:17:37Z", "updated_at": "2017-12-21T16:17:37Z", "author_association": "CONTRIBUTOR", "body_html": "<div class=\"email-fragment\">Expose a flag to disable TensorArray reordering.</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Thu, Dec 21, 2017 at 7:53 AM, Guillaume Klein ***@***.***&gt; wrote:\n ***@***.**** commented on this pull request.\n ------------------------------\n\n In tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"260616654\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/13312\" href=\"https://github.com/tensorflow/tensorflow/pull/13312#discussion_r158311174\">#13312 (comment)</a>&gt;\n :\n\n &gt; +\n +\n +def _maybe_sort_array_beams(t, parent_ids, sequence_length):\n +  \"\"\"Maybe sorts beams within a `TensorArray`.\n +\n +  Args:\n +    t: A `TensorArray` of size `max_time` that contains `Tensor`s of shape\n +      `[batch_size, beam_width, depth]`.\n +    parent_ids: The parent ids of shape `[max_time, batch_size, beam_width]`.\n +    sequence_length: The sequence length of shape `[batch_size, beam_width]`.\n +\n +  Returns:\n +    A `TensorArray` where beams are sorted in each `Tensor` or `t` itself if it\n +    is not a `TensorArray`.\n +  \"\"\"\n +  if isinstance(t, tensor_array_ops.TensorArray):\n\n Currently, the assumptions are:\n\n    1. the TensorArrays size is the time dimension\n    2. the TensorArrays contain Tensors with the same shape assumption as\n    Tensors that are directly in the cell state\n\n Guard against it; enable by default, but if there's a failure raise a\n warning message that the user should disable the TensorArray sorting.\n\n Do you mean to try/catch the call to gather_tree_from_array and expose a\n flag to disable any post process on TensorArrays?\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"260616654\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/13312\" href=\"https://github.com/tensorflow/tensorflow/pull/13312#discussion_r158311174\">#13312 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/ABtim-SQNT66YoqoLtr3M4okRjk_e3-rks5tCn77gaJpZM4PkNmd\">https://github.com/notifications/unsubscribe-auth/ABtim-SQNT66YoqoLtr3M4okRjk_e3-rks5tCn77gaJpZM4PkNmd</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Expose a flag to disable TensorArray reordering.\n\u2026\nOn Thu, Dec 21, 2017 at 7:53 AM, Guillaume Klein ***@***.***> wrote:\n ***@***.**** commented on this pull request.\n ------------------------------\n\n In tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py\n <#13312 (comment)>\n :\n\n > +\n +\n +def _maybe_sort_array_beams(t, parent_ids, sequence_length):\n +  \"\"\"Maybe sorts beams within a `TensorArray`.\n +\n +  Args:\n +    t: A `TensorArray` of size `max_time` that contains `Tensor`s of shape\n +      `[batch_size, beam_width, depth]`.\n +    parent_ids: The parent ids of shape `[max_time, batch_size, beam_width]`.\n +    sequence_length: The sequence length of shape `[batch_size, beam_width]`.\n +\n +  Returns:\n +    A `TensorArray` where beams are sorted in each `Tensor` or `t` itself if it\n +    is not a `TensorArray`.\n +  \"\"\"\n +  if isinstance(t, tensor_array_ops.TensorArray):\n\n Currently, the assumptions are:\n\n    1. the TensorArrays size is the time dimension\n    2. the TensorArrays contain Tensors with the same shape assumption as\n    Tensors that are directly in the cell state\n\n Guard against it; enable by default, but if there's a failure raise a\n warning message that the user should disable the TensorArray sorting.\n\n Do you mean to try/catch the call to gather_tree_from_array and expose a\n flag to disable any post process on TensorArrays?\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#13312 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/ABtim-SQNT66YoqoLtr3M4okRjk_e3-rks5tCn77gaJpZM4PkNmd>\n .", "body": "Expose a flag to disable TensorArray reordering.\n\nOn Thu, Dec 21, 2017 at 7:53 AM, Guillaume Klein <notifications@github.com>\nwrote:\n\n> *@guillaumekln* commented on this pull request.\n> ------------------------------\n>\n> In tensorflow/contrib/seq2seq/python/ops/beam_search_decoder.py\n> <https://github.com/tensorflow/tensorflow/pull/13312#discussion_r158311174>\n> :\n>\n> > +\n> +\n> +def _maybe_sort_array_beams(t, parent_ids, sequence_length):\n> +  \"\"\"Maybe sorts beams within a `TensorArray`.\n> +\n> +  Args:\n> +    t: A `TensorArray` of size `max_time` that contains `Tensor`s of shape\n> +      `[batch_size, beam_width, depth]`.\n> +    parent_ids: The parent ids of shape `[max_time, batch_size, beam_width]`.\n> +    sequence_length: The sequence length of shape `[batch_size, beam_width]`.\n> +\n> +  Returns:\n> +    A `TensorArray` where beams are sorted in each `Tensor` or `t` itself if it\n> +    is not a `TensorArray`.\n> +  \"\"\"\n> +  if isinstance(t, tensor_array_ops.TensorArray):\n>\n> Currently, the assumptions are:\n>\n>    1. the TensorArrays size is the time dimension\n>    2. the TensorArrays contain Tensors with the same shape assumption as\n>    Tensors that are directly in the cell state\n>\n> Guard against it; enable by default, but if there's a failure raise a\n> warning message that the user should disable the TensorArray sorting.\n>\n> Do you mean to try/catch the call to gather_tree_from_array and expose a\n> flag to disable any post process on TensorArrays?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/pull/13312#discussion_r158311174>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim-SQNT66YoqoLtr3M4okRjk_e3-rks5tCn77gaJpZM4PkNmd>\n> .\n>\n"}