{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4603", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4603/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4603/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4603/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4603", "id": 179582425, "node_id": "MDU6SXNzdWUxNzk1ODI0MjU=", "number": 4603, "title": "import_meta_graph: ValueError: At least two variables have the same name: Variable_1", "user": {"login": "snbuchholz", "id": 2370438, "node_id": "MDQ6VXNlcjIzNzA0Mzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/2370438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/snbuchholz", "html_url": "https://github.com/snbuchholz", "followers_url": "https://api.github.com/users/snbuchholz/followers", "following_url": "https://api.github.com/users/snbuchholz/following{/other_user}", "gists_url": "https://api.github.com/users/snbuchholz/gists{/gist_id}", "starred_url": "https://api.github.com/users/snbuchholz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/snbuchholz/subscriptions", "organizations_url": "https://api.github.com/users/snbuchholz/orgs", "repos_url": "https://api.github.com/users/snbuchholz/repos", "events_url": "https://api.github.com/users/snbuchholz/events{/privacy}", "received_events_url": "https://api.github.com/users/snbuchholz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-09-27T18:57:51Z", "updated_at": "2016-09-28T07:43:34Z", "closed_at": "2016-09-27T22:35:06Z", "author_association": "NONE", "body_html": "<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>None</p>\n<h3>Environment info</h3>\n<p>Operating System: Ubuntu 16.04.1 LTS<br>\nInstalled version of CUDA and cuDNN: none<br>\npip package: <a href=\"https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0-cp27-none-linux_x86_64.whl\" rel=\"nofollow\">https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0-cp27-none-linux_x86_64.whl</a><br>\n$ python -c \"import tensorflow; print(tensorflow.<strong>version</strong>)\"<br>\n0.10.0</p>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<p>Using commands from <a href=\"https://www.tensorflow.org/versions/r0.9/get_started/index.html\" rel=\"nofollow\">https://www.tensorflow.org/versions/r0.9/get_started/index.html</a> to create a model:</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\nx_data = np.random.rand(100).astype(np.float32)\ny_data = x_data * 0.1 + 0.3\nW = tf.Variable(tf.random_uniform([1], -1.0, 1.0))\nb = tf.Variable(tf.zeros([1]))\ny = W * x_data + b\nloss = tf.reduce_mean(tf.square(y - y_data))\noptimizer = tf.train.GradientDescentOptimizer(0.5)\ntrain = optimizer.minimize(loss)\ninit = tf.initialize_all_variables()\nsess = tf.Session()\nsess.run(init)\nsess.run(train)\n</code></pre>\n<p>Then this works:</p>\n<pre><code>saver = tf.train.Saver()\nsaver.save(sess, 'my-model')\nsess = tf.Session()\nnew_saver = tf.train.import_meta_graph('my-model.meta')\n</code></pre>\n<p>But this doesn't:</p>\n<pre><code>tf.train.export_meta_graph(filename='my-model.meta')\nnew_saver = tf.train.import_meta_graph('my-model.meta')\n</code></pre>\n<p>Traceback (most recent call last):<br>\nFile \"\", line 1, in <br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1458, in import_meta_graph<br>\nreturn _import_meta_graph_def(read_meta_graph_file(meta_graph_or_file))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1386, in _import_meta_graph_def<br>\nreturn Saver()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 861, in <strong>init</strong><br>\nrestore_sequentially=restore_sequentially)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 502, in build<br>\nvars_to_save = self._ValidateAndSliceInputs(names_to_variables)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 399, in _ValidateAndSliceInputs<br>\nnames_to_variables = self._VarListToDict(names_to_variables)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 377, in _VarListToDict<br>\nname)<br>\nValueError: At least two variables have the same name: Variable_1</p>\n<p>What I actually want to use is this, which also does not work (same error):</p>\n<pre><code>meta_graph_def = tf.train.export_meta_graph()\nsaver = tf.train.import_meta_graph(meta_graph_def)\n</code></pre>\n<p>I need a solution that does not rely on the file system.<br>\nAm I doing something wrong?</p>\n<h3>What other attempted solutions have you tried?</h3>\n<p>I tried to look at the files to see where these duplicated names occur but did not find any.</p>", "body_text": "What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nNone\nEnvironment info\nOperating System: Ubuntu 16.04.1 LTS\nInstalled version of CUDA and cuDNN: none\npip package: https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0-cp27-none-linux_x86_64.whl\n$ python -c \"import tensorflow; print(tensorflow.version)\"\n0.10.0\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nUsing commands from https://www.tensorflow.org/versions/r0.9/get_started/index.html to create a model:\nimport tensorflow as tf\nimport numpy as np\nx_data = np.random.rand(100).astype(np.float32)\ny_data = x_data * 0.1 + 0.3\nW = tf.Variable(tf.random_uniform([1], -1.0, 1.0))\nb = tf.Variable(tf.zeros([1]))\ny = W * x_data + b\nloss = tf.reduce_mean(tf.square(y - y_data))\noptimizer = tf.train.GradientDescentOptimizer(0.5)\ntrain = optimizer.minimize(loss)\ninit = tf.initialize_all_variables()\nsess = tf.Session()\nsess.run(init)\nsess.run(train)\n\nThen this works:\nsaver = tf.train.Saver()\nsaver.save(sess, 'my-model')\nsess = tf.Session()\nnew_saver = tf.train.import_meta_graph('my-model.meta')\n\nBut this doesn't:\ntf.train.export_meta_graph(filename='my-model.meta')\nnew_saver = tf.train.import_meta_graph('my-model.meta')\n\nTraceback (most recent call last):\nFile \"\", line 1, in \nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1458, in import_meta_graph\nreturn _import_meta_graph_def(read_meta_graph_file(meta_graph_or_file))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1386, in _import_meta_graph_def\nreturn Saver()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 861, in init\nrestore_sequentially=restore_sequentially)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 502, in build\nvars_to_save = self._ValidateAndSliceInputs(names_to_variables)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 399, in _ValidateAndSliceInputs\nnames_to_variables = self._VarListToDict(names_to_variables)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 377, in _VarListToDict\nname)\nValueError: At least two variables have the same name: Variable_1\nWhat I actually want to use is this, which also does not work (same error):\nmeta_graph_def = tf.train.export_meta_graph()\nsaver = tf.train.import_meta_graph(meta_graph_def)\n\nI need a solution that does not rely on the file system.\nAm I doing something wrong?\nWhat other attempted solutions have you tried?\nI tried to look at the files to see where these duplicated names occur but did not find any.", "body": "### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n\nNone\n### Environment info\n\nOperating System: Ubuntu 16.04.1 LTS\nInstalled version of CUDA and cuDNN: none\npip package: https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0-cp27-none-linux_x86_64.whl\n$ python -c \"import tensorflow; print(tensorflow.**version**)\"\n0.10.0\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\n\nUsing commands from https://www.tensorflow.org/versions/r0.9/get_started/index.html to create a model:\n\n```\nimport tensorflow as tf\nimport numpy as np\nx_data = np.random.rand(100).astype(np.float32)\ny_data = x_data * 0.1 + 0.3\nW = tf.Variable(tf.random_uniform([1], -1.0, 1.0))\nb = tf.Variable(tf.zeros([1]))\ny = W * x_data + b\nloss = tf.reduce_mean(tf.square(y - y_data))\noptimizer = tf.train.GradientDescentOptimizer(0.5)\ntrain = optimizer.minimize(loss)\ninit = tf.initialize_all_variables()\nsess = tf.Session()\nsess.run(init)\nsess.run(train)\n```\n\nThen this works:\n\n```\nsaver = tf.train.Saver()\nsaver.save(sess, 'my-model')\nsess = tf.Session()\nnew_saver = tf.train.import_meta_graph('my-model.meta')\n```\n\nBut this doesn't:\n\n```\ntf.train.export_meta_graph(filename='my-model.meta')\nnew_saver = tf.train.import_meta_graph('my-model.meta')\n```\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1458, in import_meta_graph\n    return _import_meta_graph_def(read_meta_graph_file(meta_graph_or_file))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 1386, in _import_meta_graph_def\n    return Saver()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 861, in __init__\n    restore_sequentially=restore_sequentially)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 502, in build\n    vars_to_save = self._ValidateAndSliceInputs(names_to_variables)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 399, in _ValidateAndSliceInputs\n    names_to_variables = self._VarListToDict(names_to_variables)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py\", line 377, in _VarListToDict\n    name)\nValueError: At least two variables have the same name: Variable_1\n\nWhat I actually want to use is this, which also does not work (same error):\n\n```\nmeta_graph_def = tf.train.export_meta_graph()\nsaver = tf.train.import_meta_graph(meta_graph_def)\n```\n\nI need a solution that does not rely on the file system.\nAm I doing something wrong?\n### What other attempted solutions have you tried?\n\nI tried to look at the files to see where these duplicated names occur but did not find any.\n"}