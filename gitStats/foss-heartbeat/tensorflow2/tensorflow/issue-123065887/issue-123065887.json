{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/554", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/554/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/554/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/554/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/554", "id": 123065887, "node_id": "MDU6SXNzdWUxMjMwNjU4ODc=", "number": 554, "title": "Does the released Inception-v3 model only support forward pass with batch_size=1?", "user": {"login": "ffmpbgrnn", "id": 4504507, "node_id": "MDQ6VXNlcjQ1MDQ1MDc=", "avatar_url": "https://avatars0.githubusercontent.com/u/4504507?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ffmpbgrnn", "html_url": "https://github.com/ffmpbgrnn", "followers_url": "https://api.github.com/users/ffmpbgrnn/followers", "following_url": "https://api.github.com/users/ffmpbgrnn/following{/other_user}", "gists_url": "https://api.github.com/users/ffmpbgrnn/gists{/gist_id}", "starred_url": "https://api.github.com/users/ffmpbgrnn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ffmpbgrnn/subscriptions", "organizations_url": "https://api.github.com/users/ffmpbgrnn/orgs", "repos_url": "https://api.github.com/users/ffmpbgrnn/repos", "events_url": "https://api.github.com/users/ffmpbgrnn/events{/privacy}", "received_events_url": "https://api.github.com/users/ffmpbgrnn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-12-19T06:16:09Z", "updated_at": "2017-02-07T04:06:56Z", "closed_at": "2015-12-23T01:02:16Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi all,<br>\nI am new to TF. I am playing with Inception-v3 model and I found that I can only pass <code>batch_size=1</code> to the model. Here is my test code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow.python.platform\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">from</span> tensorflow.python.platform <span class=\"pl-k\">import</span> gfile\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n\n\n<span class=\"pl-k\">with</span> tf.device(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/cpu:0<span class=\"pl-pds\">\"</span></span>):\n    <span class=\"pl-k\">with</span> gfile.FastGFile(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/tmp/imagenet/classify_image_graph_def.pb<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>rb<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> f:\n        graph_def <span class=\"pl-k\">=</span> tf.GraphDef()\n        graph_def.ParseFromString(f.read())\n        _ <span class=\"pl-k\">=</span> tf.import_graph_def(graph_def, <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span>)\n\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n\n    array <span class=\"pl-k\">=</span> np.random.rand(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">299</span>, <span class=\"pl-c1\">299</span>, <span class=\"pl-c1\">3</span>)\n    image_data <span class=\"pl-k\">=</span> tf.convert_to_tensor(array, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32).eval()\n\n    test_tensor <span class=\"pl-k\">=</span> sess.graph.get_tensor_by_name(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>Mul:0<span class=\"pl-pds\">'</span></span>)\n    <span class=\"pl-c1\">print</span>(test_tensor.get_shape())\n    softmax_tensor <span class=\"pl-k\">=</span> sess.graph.get_tensor_by_name(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>softmax:0<span class=\"pl-pds\">'</span></span>)\n    predictions <span class=\"pl-k\">=</span> sess.run(softmax_tensor,\n                          {<span class=\"pl-s\"><span class=\"pl-pds\">'</span>Mul:0<span class=\"pl-pds\">'</span></span>: image_data})</pre></div>\n<p>If I change <code>array = np.random.rand(1, 299, 299, 3)</code> with <code>batch_size=2</code>, then TF would complain about the size mismatch.</p>\n<p>Am I doing something wrong? Any pointer would be of great help.</p>", "body_text": "Hi all,\nI am new to TF. I am playing with Inception-v3 model and I found that I can only pass batch_size=1 to the model. Here is my test code:\nimport tensorflow.python.platform\nimport tensorflow as tf\nfrom tensorflow.python.platform import gfile\nimport numpy as np\n\n\nwith tf.device(\"/cpu:0\"):\n    with gfile.FastGFile('/tmp/imagenet/classify_image_graph_def.pb', 'rb') as f:\n        graph_def = tf.GraphDef()\n        graph_def.ParseFromString(f.read())\n        _ = tf.import_graph_def(graph_def, name='')\n\nwith tf.Session() as sess:\n\n    array = np.random.rand(1, 299, 299, 3)\n    image_data = tf.convert_to_tensor(array, dtype=tf.float32).eval()\n\n    test_tensor = sess.graph.get_tensor_by_name('Mul:0')\n    print(test_tensor.get_shape())\n    softmax_tensor = sess.graph.get_tensor_by_name('softmax:0')\n    predictions = sess.run(softmax_tensor,\n                          {'Mul:0': image_data})\nIf I change array = np.random.rand(1, 299, 299, 3) with batch_size=2, then TF would complain about the size mismatch.\nAm I doing something wrong? Any pointer would be of great help.", "body": "Hi all,\nI am new to TF. I am playing with Inception-v3 model and I found that I can only pass `batch_size=1` to the model. Here is my test code:\n\n``` python\nimport tensorflow.python.platform\nimport tensorflow as tf\nfrom tensorflow.python.platform import gfile\nimport numpy as np\n\n\nwith tf.device(\"/cpu:0\"):\n    with gfile.FastGFile('/tmp/imagenet/classify_image_graph_def.pb', 'rb') as f:\n        graph_def = tf.GraphDef()\n        graph_def.ParseFromString(f.read())\n        _ = tf.import_graph_def(graph_def, name='')\n\nwith tf.Session() as sess:\n\n    array = np.random.rand(1, 299, 299, 3)\n    image_data = tf.convert_to_tensor(array, dtype=tf.float32).eval()\n\n    test_tensor = sess.graph.get_tensor_by_name('Mul:0')\n    print(test_tensor.get_shape())\n    softmax_tensor = sess.graph.get_tensor_by_name('softmax:0')\n    predictions = sess.run(softmax_tensor,\n                          {'Mul:0': image_data})\n```\n\nIf I change `array = np.random.rand(1, 299, 299, 3)` with `batch_size=2`, then TF would complain about the size mismatch.\n\nAm I doing something wrong? Any pointer would be of great help.\n"}