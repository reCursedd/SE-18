{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12525", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12525/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12525/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12525/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12525", "id": 252241584, "node_id": "MDU6SXNzdWUyNTIyNDE1ODQ=", "number": 12525, "title": "bug in DataFeeder constructor  ", "user": {"login": "lxyfirst", "id": 785367, "node_id": "MDQ6VXNlcjc4NTM2Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/785367?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lxyfirst", "html_url": "https://github.com/lxyfirst", "followers_url": "https://api.github.com/users/lxyfirst/followers", "following_url": "https://api.github.com/users/lxyfirst/following{/other_user}", "gists_url": "https://api.github.com/users/lxyfirst/gists{/gist_id}", "starred_url": "https://api.github.com/users/lxyfirst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lxyfirst/subscriptions", "organizations_url": "https://api.github.com/users/lxyfirst/orgs", "repos_url": "https://api.github.com/users/lxyfirst/repos", "events_url": "https://api.github.com/users/lxyfirst/events{/privacy}", "received_events_url": "https://api.github.com/users/lxyfirst/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-23T10:57:45Z", "updated_at": "2017-08-25T18:17:17Z", "closed_at": "2017-08-25T18:17:17Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>centos 7.0</li>\n<li>python 3.4</li>\n<li>tensorflow 1.2.1</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When I call tensorflow.contrib.learn.DNNRegressor.fit(x_train_dict , y_train,steps=1000)  , x_train_dict is dict  and y_train is array , the program throws the following exception:</p>\n<pre><code>File \"/home/star/yuce.ddxq.mobi/zhuge/management/commands/forecast_product_sale.py\", line 148, in tflearn_dnn_train2\n    regressor.fit(x_train_dict, y_train, steps=10000, batch_size=10)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/python/util/deprecation.py\", line 289, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 439, in fit\n    SKCompat(self).fit(x, y, batch_size, steps, max_steps, monitors)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1340, in fit\n    epochs=None)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 137, in _get_input_fn\n    epochs=epochs)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/learn_io/data_feeder.py\", line 152, in setup_train_data_feeder\n    x, y, n_classes, batch_size, shuffle=shuffle, epochs=epochs)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/learn_io/data_feeder.py\", line 326, in __init__\n    dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if x_is_dict else check_array(y, y.dtype)\nAttributeError: 'numpy.ndarray' object has no attribute 'items'\n</code></pre>\n<p>and the related code is:</p>\n<pre><code>   x_is_dict, y_is_dict = isinstance(x, dict), y is not None and isinstance(\n        y, dict)\n    if isinstance(y, list):\n      y = np.array(y)\n\n    self._x = dict([(k, check_array(v, v.dtype)) for k, v in list(x.items())\n                   ]) if x_is_dict else check_array(x, x.dtype)\n    self._y = None if y is None else \\\n      dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if x_is_dict else check_array(y, y.dtype)\n\n</code></pre>\n<p>the last line of the code seems wrong , it should use the y_is_dict instead of x_is_dict  ?<br>\nI change the code to :</p>\n<pre><code>dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if y_is_dict else check_array(y, y.dtype)\n</code></pre>\n<p>and then  it works .</p>", "body_text": "System information\n\ncentos 7.0\npython 3.4\ntensorflow 1.2.1\n\nDescribe the problem\nWhen I call tensorflow.contrib.learn.DNNRegressor.fit(x_train_dict , y_train,steps=1000)  , x_train_dict is dict  and y_train is array , the program throws the following exception:\nFile \"/home/star/yuce.ddxq.mobi/zhuge/management/commands/forecast_product_sale.py\", line 148, in tflearn_dnn_train2\n    regressor.fit(x_train_dict, y_train, steps=10000, batch_size=10)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/python/util/deprecation.py\", line 289, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 439, in fit\n    SKCompat(self).fit(x, y, batch_size, steps, max_steps, monitors)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1340, in fit\n    epochs=None)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 137, in _get_input_fn\n    epochs=epochs)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/learn_io/data_feeder.py\", line 152, in setup_train_data_feeder\n    x, y, n_classes, batch_size, shuffle=shuffle, epochs=epochs)\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/learn_io/data_feeder.py\", line 326, in __init__\n    dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if x_is_dict else check_array(y, y.dtype)\nAttributeError: 'numpy.ndarray' object has no attribute 'items'\n\nand the related code is:\n   x_is_dict, y_is_dict = isinstance(x, dict), y is not None and isinstance(\n        y, dict)\n    if isinstance(y, list):\n      y = np.array(y)\n\n    self._x = dict([(k, check_array(v, v.dtype)) for k, v in list(x.items())\n                   ]) if x_is_dict else check_array(x, x.dtype)\n    self._y = None if y is None else \\\n      dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if x_is_dict else check_array(y, y.dtype)\n\n\nthe last line of the code seems wrong , it should use the y_is_dict instead of x_is_dict  ?\nI change the code to :\ndict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if y_is_dict else check_array(y, y.dtype)\n\nand then  it works .", "body": "\r\n### System information\r\n- centos 7.0\r\n- python 3.4\r\n- tensorflow 1.2.1\r\n\r\n\r\n### Describe the problem\r\nWhen I call tensorflow.contrib.learn.DNNRegressor.fit(x_train_dict , y_train,steps=1000)  , x_train_dict is dict  and y_train is array , the program throws the following exception: \r\n```\r\nFile \"/home/star/yuce.ddxq.mobi/zhuge/management/commands/forecast_product_sale.py\", line 148, in tflearn_dnn_train2\r\n    regressor.fit(x_train_dict, y_train, steps=10000, batch_size=10)\r\n  File \"/usr/lib/python3.4/site-packages/tensorflow/python/util/deprecation.py\", line 289, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 439, in fit\r\n    SKCompat(self).fit(x, y, batch_size, steps, max_steps, monitors)\r\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 1340, in fit\r\n    epochs=None)\r\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 137, in _get_input_fn\r\n    epochs=epochs)\r\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/learn_io/data_feeder.py\", line 152, in setup_train_data_feeder\r\n    x, y, n_classes, batch_size, shuffle=shuffle, epochs=epochs)\r\n  File \"/usr/lib/python3.4/site-packages/tensorflow/contrib/learn/python/learn/learn_io/data_feeder.py\", line 326, in __init__\r\n    dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if x_is_dict else check_array(y, y.dtype)\r\nAttributeError: 'numpy.ndarray' object has no attribute 'items'\r\n```\r\nand the related code is:  \r\n```\r\n   x_is_dict, y_is_dict = isinstance(x, dict), y is not None and isinstance(\r\n        y, dict)\r\n    if isinstance(y, list):\r\n      y = np.array(y)\r\n\r\n    self._x = dict([(k, check_array(v, v.dtype)) for k, v in list(x.items())\r\n                   ]) if x_is_dict else check_array(x, x.dtype)\r\n    self._y = None if y is None else \\\r\n      dict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if x_is_dict else check_array(y, y.dtype)\r\n\r\n```\r\nthe last line of the code seems wrong , it should use the y_is_dict instead of x_is_dict  ? \r\nI change the code to : \r\n```\r\ndict([(k, check_array(v, v.dtype)) for k, v in list(y.items())]) if y_is_dict else check_array(y, y.dtype)\r\n```\r\nand then  it works .\r\n\r\n\r\n"}