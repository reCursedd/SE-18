{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9105", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9105/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9105/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9105/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9105", "id": 220693468, "node_id": "MDU6SXNzdWUyMjA2OTM0Njg=", "number": 9105, "title": "Blas SGEMM launch failed", "user": {"login": "JWarlock", "id": 26880977, "node_id": "MDQ6VXNlcjI2ODgwOTc3", "avatar_url": "https://avatars3.githubusercontent.com/u/26880977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JWarlock", "html_url": "https://github.com/JWarlock", "followers_url": "https://api.github.com/users/JWarlock/followers", "following_url": "https://api.github.com/users/JWarlock/following{/other_user}", "gists_url": "https://api.github.com/users/JWarlock/gists{/gist_id}", "starred_url": "https://api.github.com/users/JWarlock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JWarlock/subscriptions", "organizations_url": "https://api.github.com/users/JWarlock/orgs", "repos_url": "https://api.github.com/users/JWarlock/repos", "events_url": "https://api.github.com/users/JWarlock/events{/privacy}", "received_events_url": "https://api.github.com/users/JWarlock/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "bignamehyp", "id": 3474655, "node_id": "MDQ6VXNlcjM0NzQ2NTU=", "avatar_url": "https://avatars2.githubusercontent.com/u/3474655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bignamehyp", "html_url": "https://github.com/bignamehyp", "followers_url": "https://api.github.com/users/bignamehyp/followers", "following_url": "https://api.github.com/users/bignamehyp/following{/other_user}", "gists_url": "https://api.github.com/users/bignamehyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/bignamehyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bignamehyp/subscriptions", "organizations_url": "https://api.github.com/users/bignamehyp/orgs", "repos_url": "https://api.github.com/users/bignamehyp/repos", "events_url": "https://api.github.com/users/bignamehyp/events{/privacy}", "received_events_url": "https://api.github.com/users/bignamehyp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bignamehyp", "id": 3474655, "node_id": "MDQ6VXNlcjM0NzQ2NTU=", "avatar_url": "https://avatars2.githubusercontent.com/u/3474655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bignamehyp", "html_url": "https://github.com/bignamehyp", "followers_url": "https://api.github.com/users/bignamehyp/followers", "following_url": "https://api.github.com/users/bignamehyp/following{/other_user}", "gists_url": "https://api.github.com/users/bignamehyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/bignamehyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bignamehyp/subscriptions", "organizations_url": "https://api.github.com/users/bignamehyp/orgs", "repos_url": "https://api.github.com/users/bignamehyp/repos", "events_url": "https://api.github.com/users/bignamehyp/events{/privacy}", "received_events_url": "https://api.github.com/users/bignamehyp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2017-04-10T16:07:21Z", "updated_at": "2018-06-14T17:19:24Z", "closed_at": "2018-06-14T17:19:24Z", "author_association": "NONE", "body_html": "<p>I just installed  TensorFlow-GPU 1.0.1 on Win10 GTX GEFORCE 850M with CUDA 8.0 and Cudnn v5.1, Anaconda3 4.2.0 64bit<br>\nwhen I try to figure out if the installation was successful, I run the</p>\n<blockquote>\n<p>mnist_with_summaries.py<br>\nin<br>\n<a href=\"url\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/mnist/mnist_with_summaries.py</a></p>\n</blockquote>\n<p>When I run the code in Jupyter Notebook, it prints</p>\n<blockquote>\n<p>Accuracy at step 0: 0.068<br>\nAccuracy at step 10: 0.6795<br>\nAccuracy at step 20: 0.8062<br>\nAccuracy at step 30: 0.8455<br>\nAccuracy at step 40: 0.8737<br>\nAccuracy at step 50: 0.8735<br>\nAccuracy at step 60: 0.8851<br>\nAccuracy at step 70: 0.8815<br>\nAccuracy at step 80: 0.8863<br>\nAccuracy at step 90: 0.8918</p>\n</blockquote>\n<p>And the kernel just died.</p>\n<p>When I try to run the code in command prompt, I get following error:</p>\n<blockquote>\n<blockquote>\n<p>I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cublas64_80.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cudnn64_5.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cufft64_80.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library nvcuda.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library curand64_80.dll locally<br>\nExtracting /tmp/tensorflow/mnist/input_data\\train-images-idx3-ubyte.gz<br>\nExtracting /tmp/tensorflow/mnist/input_data\\train-labels-idx1-ubyte.gz<br>\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-images-idx3-ubyte.gz<br>\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-labels-idx1-ubyte.gz<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:885] Found device 0 with properties:<br>\nname: GeForce GTX 850M<br>\nmajor: 5 minor: 0 memoryClockRate (GHz) 0.9015<br>\npciBusID 0000:0a:00.0<br>\nTotal memory: 4.00GiB<br>\nFree memory: 3.35GiB<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:906] DMA: 0<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:916] 0:   Y<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:372] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED<br>\nW c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\stream.cc:1390] attempting to perform BLAS operation using StreamExecutor without BLAS support<br>\nTraceback (most recent call last):<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1022, in _do_call<br>\nreturn fn(*args)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1004, in _run_fn<br>\nstatus, run_metadata)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\contextlib.py\", line 66, in <strong>exit</strong><br>\nnext(self.gen)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status<br>\npywrap_tensorflow.TF_GetCode(status))<br>\ntensorflow.python.framework.errors_impl.InternalError: Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784<br>\n[[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]<br>\n[[Node: accuracy/accuracy/Mean/_49 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]</p>\n</blockquote>\n</blockquote>\n<blockquote>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"mnist_with_summaries.py\", line 209, in <br>\ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 44, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"mnist_with_summaries.py\", line 185, in main<br>\ntrain()<br>\nFile \"mnist_with_summaries.py\", line 160, in train<br>\nsummary, acc = sess.run([merged, accuracy], feed_dict=feed_dict(False))<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 767, in run<br>\nrun_metadata_ptr)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 965, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1015, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1035, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InternalError: Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784<br>\n[[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]<br>\n[[Node: accuracy/accuracy/Mean/_49 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]</p>\n</blockquote>\n<blockquote>\n<p>Caused by op 'layer1/Wx_plus_b/MatMul', defined at:<br>\nFile \"mnist_with_summaries.py\", line 209, in <br>\ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 44, in run<br>\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))<br>\nFile \"mnist_with_summaries.py\", line 185, in main<br>\ntrain()<br>\nFile \"mnist_with_summaries.py\", line 101, in train<br>\nhidden1 = nn_layer(x, 784, 500, 'layer1')<br>\nFile \"mnist_with_summaries.py\", line 95, in nn_layer<br>\npreactivate = tf.matmul(input_tensor, weights) + biases<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1765, in matmul<br>\na, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1454, in _mat_mul<br>\ntranspose_b=transpose_b, name=name)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op<br>\nop_def=op_def)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InternalError (see above for traceback): Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784<br>\n[[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]<br>\n[[Node: accuracy/accuracy/Mean/_49 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]<br>\nAnd this Internal error message appears three times.It shows that all dll files were successfully opened. ( too many error message, I just write down something I think useful. If anyone need more information, tell me).</p>\n</blockquote>\n<p>I found an answer on stackoverflow <a href=\"url\">http://stackoverflow.com/questions/41117740/tensorflow-crashes-with-cublas-status-alloc-failed</a>, and I add :</p>\n<pre><code>`config = tf.ConfigProto()\nconfig.gpu_options.allow_growth = True\nsession = tf.Session(config=config, ...)`\n</code></pre>\n<p>just after:<br>\n<code>if __name__ == '__main__':</code><br>\nthis time the error is:</p>\n<blockquote>\n<blockquote>\n<p>I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cublas64_80.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cudnn64_5.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cufft64_80.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library nvcuda.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library curand64_80.dll locally<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:885] Found device 0 with properties:<br>\nname: GeForce GTX 850M<br>\nmajor: 5 minor: 0 memoryClockRate (GHz) 0.9015<br>\npciBusID 0000:0a:00.0<br>\nTotal memory: 4.00GiB<br>\nFree memory: 3.35GiB<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:906] DMA: 0<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:916] 0:   Y<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)<br>\nExtracting /tmp/tensorflow/mnist/input_data\\train-images-idx3-ubyte.gz<br>\nExtracting /tmp/tensorflow/mnist/input_data\\train-labels-idx1-ubyte.gz<br>\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-images-idx3-ubyte.gz<br>\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-labels-idx1-ubyte.gz<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions<br>\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots<br>\nAccuracy at step 0: 0.0886<br>\nAccuracy at step 10: 0.6844<br>\nAccuracy at step 20: 0.7995<br>\nAccuracy at step 30: 0.8564<br>\nAccuracy at step 40: 0.876<br>\nAccuracy at step 50: 0.8819<br>\nAccuracy at step 60: 0.8892<br>\nAccuracy at step 70: 0.8881<br>\nAccuracy at step 80: 0.8843<br>\nAccuracy at step 90: 0.8912<br>\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:126] Couldn't open CUDA library cupti64_80.dll<br>\nF c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\platform\\default\\gpu\\cupti_wrapper.cc:59] Check failed: ::tensorflow::Status::OK() == (::tensorflow::Env::Default()-&gt;GetSymbolFromLibrary( GetDsoHandle(), kName, &amp;f)) (OK vs. Not found: cuptiActivityRegisterCallbacks not found)could not find cuptiActivityRegisterCallbacksin libcupti DSO</p>\n</blockquote>\n</blockquote>\n<p>I am totally lost. Could someone tell me why?</p>", "body_text": "I just installed  TensorFlow-GPU 1.0.1 on Win10 GTX GEFORCE 850M with CUDA 8.0 and Cudnn v5.1, Anaconda3 4.2.0 64bit\nwhen I try to figure out if the installation was successful, I run the\n\nmnist_with_summaries.py\nin\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/mnist/mnist_with_summaries.py\n\nWhen I run the code in Jupyter Notebook, it prints\n\nAccuracy at step 0: 0.068\nAccuracy at step 10: 0.6795\nAccuracy at step 20: 0.8062\nAccuracy at step 30: 0.8455\nAccuracy at step 40: 0.8737\nAccuracy at step 50: 0.8735\nAccuracy at step 60: 0.8851\nAccuracy at step 70: 0.8815\nAccuracy at step 80: 0.8863\nAccuracy at step 90: 0.8918\n\nAnd the kernel just died.\nWhen I try to run the code in command prompt, I get following error:\n\n\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cublas64_80.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cudnn64_5.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cufft64_80.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library nvcuda.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library curand64_80.dll locally\nExtracting /tmp/tensorflow/mnist/input_data\\train-images-idx3-ubyte.gz\nExtracting /tmp/tensorflow/mnist/input_data\\train-labels-idx1-ubyte.gz\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-images-idx3-ubyte.gz\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-labels-idx1-ubyte.gz\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:885] Found device 0 with properties:\nname: GeForce GTX 850M\nmajor: 5 minor: 0 memoryClockRate (GHz) 0.9015\npciBusID 0000:0a:00.0\nTotal memory: 4.00GiB\nFree memory: 3.35GiB\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:906] DMA: 0\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:916] 0:   Y\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:372] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\nW c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\stream.cc:1390] attempting to perform BLAS operation using StreamExecutor without BLAS support\nTraceback (most recent call last):\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1022, in _do_call\nreturn fn(*args)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1004, in _run_fn\nstatus, run_metadata)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\contextlib.py\", line 66, in exit\nnext(self.gen)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\npywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784\n[[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]\n[[Node: accuracy/accuracy/Mean/_49 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\n\n\n\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"mnist_with_summaries.py\", line 209, in \ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 44, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"mnist_with_summaries.py\", line 185, in main\ntrain()\nFile \"mnist_with_summaries.py\", line 160, in train\nsummary, acc = sess.run([merged, accuracy], feed_dict=feed_dict(False))\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 767, in run\nrun_metadata_ptr)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 965, in _run\nfeed_dict_string, options, run_metadata)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1015, in _do_run\ntarget_list, options, run_metadata)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1035, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784\n[[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]\n[[Node: accuracy/accuracy/Mean/_49 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\n\n\nCaused by op 'layer1/Wx_plus_b/MatMul', defined at:\nFile \"mnist_with_summaries.py\", line 209, in \ntf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 44, in run\n_sys.exit(main(_sys.argv[:1] + flags_passthrough))\nFile \"mnist_with_summaries.py\", line 185, in main\ntrain()\nFile \"mnist_with_summaries.py\", line 101, in train\nhidden1 = nn_layer(x, 784, 500, 'layer1')\nFile \"mnist_with_summaries.py\", line 95, in nn_layer\npreactivate = tf.matmul(input_tensor, weights) + biases\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1765, in matmul\na, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1454, in _mat_mul\ntranspose_b=transpose_b, name=name)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\nop_def=op_def)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in init\nself._traceback = _extract_stack()\nInternalError (see above for traceback): Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784\n[[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]\n[[Node: accuracy/accuracy/Mean/_49 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nAnd this Internal error message appears three times.It shows that all dll files were successfully opened. ( too many error message, I just write down something I think useful. If anyone need more information, tell me).\n\nI found an answer on stackoverflow http://stackoverflow.com/questions/41117740/tensorflow-crashes-with-cublas-status-alloc-failed, and I add :\n`config = tf.ConfigProto()\nconfig.gpu_options.allow_growth = True\nsession = tf.Session(config=config, ...)`\n\njust after:\nif __name__ == '__main__':\nthis time the error is:\n\n\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cublas64_80.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cudnn64_5.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cufft64_80.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library nvcuda.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library curand64_80.dll locally\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:885] Found device 0 with properties:\nname: GeForce GTX 850M\nmajor: 5 minor: 0 memoryClockRate (GHz) 0.9015\npciBusID 0000:0a:00.0\nTotal memory: 4.00GiB\nFree memory: 3.35GiB\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:906] DMA: 0\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:916] 0:   Y\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)\nExtracting /tmp/tensorflow/mnist/input_data\\train-images-idx3-ubyte.gz\nExtracting /tmp/tensorflow/mnist/input_data\\train-labels-idx1-ubyte.gz\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-images-idx3-ubyte.gz\nExtracting /tmp/tensorflow/mnist/input_data\\t10k-labels-idx1-ubyte.gz\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\nAccuracy at step 0: 0.0886\nAccuracy at step 10: 0.6844\nAccuracy at step 20: 0.7995\nAccuracy at step 30: 0.8564\nAccuracy at step 40: 0.876\nAccuracy at step 50: 0.8819\nAccuracy at step 60: 0.8892\nAccuracy at step 70: 0.8881\nAccuracy at step 80: 0.8843\nAccuracy at step 90: 0.8912\nI c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:126] Couldn't open CUDA library cupti64_80.dll\nF c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\platform\\default\\gpu\\cupti_wrapper.cc:59] Check failed: ::tensorflow::Status::OK() == (::tensorflow::Env::Default()->GetSymbolFromLibrary( GetDsoHandle(), kName, &f)) (OK vs. Not found: cuptiActivityRegisterCallbacks not found)could not find cuptiActivityRegisterCallbacksin libcupti DSO\n\n\nI am totally lost. Could someone tell me why?", "body": "I just installed  TensorFlow-GPU 1.0.1 on Win10 GTX GEFORCE 850M with CUDA 8.0 and Cudnn v5.1, Anaconda3 4.2.0 64bit\r\nwhen I try to figure out if the installation was successful, I run the \r\n\r\n> mnist_with_summaries.py\r\nin \r\n[https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/mnist/mnist_with_summaries.py](url)\r\n\r\nWhen I run the code in Jupyter Notebook, it prints \r\n\r\n> Accuracy at step 0: 0.068\r\nAccuracy at step 10: 0.6795\r\nAccuracy at step 20: 0.8062\r\nAccuracy at step 30: 0.8455\r\nAccuracy at step 40: 0.8737\r\nAccuracy at step 50: 0.8735\r\nAccuracy at step 60: 0.8851\r\nAccuracy at step 70: 0.8815\r\nAccuracy at step 80: 0.8863\r\nAccuracy at step 90: 0.8918\r\n\r\nAnd the kernel just died.\r\n\r\nWhen I try to run the code in command prompt, I get following error:\r\n\r\n> >I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cublas64_80.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cudnn64_5.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cufft64_80.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library nvcuda.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library curand64_80.dll locally\r\n> Extracting /tmp/tensorflow/mnist/input_data\\train-images-idx3-ubyte.gz\r\n> Extracting /tmp/tensorflow/mnist/input_data\\train-labels-idx1-ubyte.gz\r\n> Extracting /tmp/tensorflow/mnist/input_data\\t10k-images-idx3-ubyte.gz\r\n> Extracting /tmp/tensorflow/mnist/input_data\\t10k-labels-idx1-ubyte.gz\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:885] Found device 0 with properties:\r\n> name: GeForce GTX 850M\r\n> major: 5 minor: 0 memoryClockRate (GHz) 0.9015\r\n> pciBusID 0000:0a:00.0\r\n> Total memory: 4.00GiB\r\n> Free memory: 3.35GiB\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:906] DMA: 0\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:916] 0:   Y\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\cuda\\cuda_blas.cc:372] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> W c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\stream.cc:1390] attempting to perform BLAS operation using StreamExecutor without BLAS support\r\n> Traceback (most recent call last):\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1022, in _do_call\r\n>     return fn(*args)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1004, in _run_fn\r\n>     status, run_metadata)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\contextlib.py\", line 66, in __exit__\r\n>     next(self.gen)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\r\n>     pywrap_tensorflow.TF_GetCode(status))\r\n> tensorflow.python.framework.errors_impl.InternalError: Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784\r\n>          [[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]\r\n>          [[Node: accuracy/accuracy/Mean/_49 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\n> During handling of the above exception, another exception occurred:\r\n> \r\n> Traceback (most recent call last):\r\n>   File \"mnist_with_summaries.py\", line 209, in <module>\r\n>     tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 44, in run\r\n>     _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n>   File \"mnist_with_summaries.py\", line 185, in main\r\n>     train()\r\n>   File \"mnist_with_summaries.py\", line 160, in train\r\n>     summary, acc = sess.run([merged, accuracy], feed_dict=feed_dict(False))\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 767, in run\r\n>     run_metadata_ptr)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 965, in _run\r\n>     feed_dict_string, options, run_metadata)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1015, in _do_run\r\n>     target_list, options, run_metadata)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1035, in _do_call\r\n>     raise type(e)(node_def, op, message)\r\n> tensorflow.python.framework.errors_impl.InternalError: Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784\r\n>          [[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]\r\n>          [[Node: accuracy/accuracy/Mean/_49 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n> \r\n\r\n> Caused by op 'layer1/Wx_plus_b/MatMul', defined at:\r\n>   File \"mnist_with_summaries.py\", line 209, in <module>\r\n>     tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 44, in run\r\n>     _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n>   File \"mnist_with_summaries.py\", line 185, in main\r\n>     train()\r\n>   File \"mnist_with_summaries.py\", line 101, in train\r\n>     hidden1 = nn_layer(x, 784, 500, 'layer1')\r\n>   File \"mnist_with_summaries.py\", line 95, in nn_layer\r\n>     preactivate = tf.matmul(input_tensor, weights) + biases\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1765, in matmul\r\n>     a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1454, in _mat_mul\r\n>     transpose_b=transpose_b, name=name)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\r\n>     op_def=op_def)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\r\n>     original_op=self._default_original_op, op_def=op_def)\r\n>   File \"C:\\Users\\airfo\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in __init__\r\n>     self._traceback = _extract_stack()\r\n> \r\n> InternalError (see above for traceback): Blas SGEMM launch failed : a.shape=(10000, 784), b.shape=(784, 500), m=10000, n=500, k=784\r\n>          [[Node: layer1/Wx_plus_b/MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](_recv_input/x-input_0/_45, layer1/weights/Variable/read)]]\r\n>          [[Node: accuracy/accuracy/Mean/_49 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_69_accuracy/accuracy/Mean\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n> And this Internal error message appears three times.It shows that all dll files were successfully opened. ( too many error message, I just write down something I think useful. If anyone need more information, tell me).\r\n> \r\n\r\nI found an answer on stackoverflow [http://stackoverflow.com/questions/41117740/tensorflow-crashes-with-cublas-status-alloc-failed](url), and I add :\r\n```\r\n`config = tf.ConfigProto()\r\nconfig.gpu_options.allow_growth = True\r\nsession = tf.Session(config=config, ...)`\r\n```\r\njust after:\r\n`if __name__ == '__main__':`\r\nthis time the error is:\r\n\r\n> > I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cublas64_80.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cudnn64_5.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library cufft64_80.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library nvcuda.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:135] successfully opened CUDA library curand64_80.dll locally\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:885] Found device 0 with properties:\r\n> name: GeForce GTX 850M\r\n> major: 5 minor: 0 memoryClockRate (GHz) 0.9015\r\n> pciBusID 0000:0a:00.0\r\n> Total memory: 4.00GiB\r\n> Free memory: 3.35GiB\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:906] DMA: 0\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:916] 0:   Y\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)\r\n> Extracting /tmp/tensorflow/mnist/input_data\\train-images-idx3-ubyte.gz\r\n> Extracting /tmp/tensorflow/mnist/input_data\\train-labels-idx1-ubyte.gz\r\n> Extracting /tmp/tensorflow/mnist/input_data\\t10k-images-idx3-ubyte.gz\r\n> Extracting /tmp/tensorflow/mnist/input_data\\t10k-labels-idx1-ubyte.gz\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 850M, pci bus id: 0000:0a:00.0)\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\r\n> E c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\r\n> Accuracy at step 0: 0.0886\r\n> Accuracy at step 10: 0.6844\r\n> Accuracy at step 20: 0.7995\r\n> Accuracy at step 30: 0.8564\r\n> Accuracy at step 40: 0.876\r\n> Accuracy at step 50: 0.8819\r\n> Accuracy at step 60: 0.8892\r\n> Accuracy at step 70: 0.8881\r\n> Accuracy at step 80: 0.8843\r\n> Accuracy at step 90: 0.8912\r\n> I c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\stream_executor\\dso_loader.cc:126] Couldn't open CUDA library cupti64_80.dll\r\n> F c:\\tf_jenkins\\home\\workspace\\release-win\\device\\gpu\\os\\windows\\tensorflow\\core\\platform\\default\\gpu\\cupti_wrapper.cc:59] Check failed: ::tensorflow::Status::OK() == (::tensorflow::Env::Default()->GetSymbolFromLibrary( GetDsoHandle(), kName, &f)) (OK vs. Not found: cuptiActivityRegisterCallbacks not found)could not find cuptiActivityRegisterCallbacksin libcupti DSO\r\n\r\n I am totally lost. Could someone tell me why?"}