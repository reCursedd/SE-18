{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8485", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8485/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8485/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8485/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8485", "id": 214890664, "node_id": "MDU6SXNzdWUyMTQ4OTA2NjQ=", "number": 8485, "title": "AOT compilation doesn't work on MacOS", "user": {"login": "xuehanxiongsc", "id": 14209552, "node_id": "MDQ6VXNlcjE0MjA5NTUy", "avatar_url": "https://avatars3.githubusercontent.com/u/14209552?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xuehanxiongsc", "html_url": "https://github.com/xuehanxiongsc", "followers_url": "https://api.github.com/users/xuehanxiongsc/followers", "following_url": "https://api.github.com/users/xuehanxiongsc/following{/other_user}", "gists_url": "https://api.github.com/users/xuehanxiongsc/gists{/gist_id}", "starred_url": "https://api.github.com/users/xuehanxiongsc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xuehanxiongsc/subscriptions", "organizations_url": "https://api.github.com/users/xuehanxiongsc/orgs", "repos_url": "https://api.github.com/users/xuehanxiongsc/repos", "events_url": "https://api.github.com/users/xuehanxiongsc/events{/privacy}", "received_events_url": "https://api.github.com/users/xuehanxiongsc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2017-03-17T02:25:16Z", "updated_at": "2017-06-16T20:14:24Z", "closed_at": "2017-06-16T20:14:24Z", "author_association": "NONE", "body_html": "<p>I was trying to reproduce this <a href=\"https://www.tensorflow.org/versions/master/experimental/xla/tfcompile\" rel=\"nofollow\">example</a> on how to use AOT compilation. My graph is made by calling <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tests/make_test_graphs.py\">make_test_graphs.py</a> and I used <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tests/test_graph_tfmatmul.config.pbtxt\">test_graph_tfmatmul.config.pbtxt</a> as my config file. I failed at '<strong>Step 2: Use tf_library build macro to compile the subgraph</strong>'.<br>\nHere is the error message:<br>\nerror:/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: file: bazel-out/local-opt/genfiles/test_aot/test_graph_tfmatmul.o is not an object file (not allowed in a library)</p>\n<p>However, if I <code>bazel build</code> the same <code>tf_library</code> on a GCE instance, it compiles successfully. The only difference is that the Tensorflow on my GCE instance is cuda enabled. I think there may be a bug in AOT compilation in CPU-only mode.</p>\n<h3>Environment info</h3>\n<p>Operating System: macOS 10.12<br>\nProcessor: intel 'haswell'.<br>\nTensorflow version: 1.0.1 stable release<br>\nbazel version: 0.4.4</p>", "body_text": "I was trying to reproduce this example on how to use AOT compilation. My graph is made by calling make_test_graphs.py and I used test_graph_tfmatmul.config.pbtxt as my config file. I failed at 'Step 2: Use tf_library build macro to compile the subgraph'.\nHere is the error message:\nerror:/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: file: bazel-out/local-opt/genfiles/test_aot/test_graph_tfmatmul.o is not an object file (not allowed in a library)\nHowever, if I bazel build the same tf_library on a GCE instance, it compiles successfully. The only difference is that the Tensorflow on my GCE instance is cuda enabled. I think there may be a bug in AOT compilation in CPU-only mode.\nEnvironment info\nOperating System: macOS 10.12\nProcessor: intel 'haswell'.\nTensorflow version: 1.0.1 stable release\nbazel version: 0.4.4", "body": "I was trying to reproduce this [example](https://www.tensorflow.org/versions/master/experimental/xla/tfcompile) on how to use AOT compilation. My graph is made by calling [make_test_graphs.py](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tests/make_test_graphs.py) and I used [test_graph_tfmatmul.config.pbtxt](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/aot/tests/test_graph_tfmatmul.config.pbtxt) as my config file. I failed at '**Step 2: Use tf_library build macro to compile the subgraph**'. \r\nHere is the error message:\r\nerror:/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: file: bazel-out/local-opt/genfiles/test_aot/test_graph_tfmatmul.o is not an object file (not allowed in a library)\r\n\r\nHowever, if I `bazel build` the same `tf_library` on a GCE instance, it compiles successfully. The only difference is that the Tensorflow on my GCE instance is cuda enabled. I think there may be a bug in AOT compilation in CPU-only mode.\r\n\r\n### Environment info\r\nOperating System: macOS 10.12\r\nProcessor: intel 'haswell'.\r\nTensorflow version: 1.0.1 stable release\r\nbazel version: 0.4.4\r\n"}