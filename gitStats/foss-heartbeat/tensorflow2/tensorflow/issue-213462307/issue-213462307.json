{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8286", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8286/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8286/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8286/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8286", "id": 213462307, "node_id": "MDU6SXNzdWUyMTM0NjIzMDc=", "number": 8286, "title": "Pass NHWC Tensors to cuDNN Directly", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2017-03-10T21:55:35Z", "updated_at": "2018-10-08T15:46:16Z", "closed_at": "2017-03-10T22:38:07Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Currently when running <code>conv2d</code> on cuDNN with image data in <code>NHWC</code> format, TF <a href=\"https://github.com/tensorflow/tensorflow/blob/0be81439c91e297b078152dd0c266471b24bde7f/tensorflow/core/kernels/conv_ops.cc#L558-L575\">converts the input tensor from NHWC to NCHW</a>, runs the conv and then <a href=\"https://github.com/tensorflow/tensorflow/blob/0be81439c91e297b078152dd0c266471b24bde7f/tensorflow/core/kernels/conv_ops.cc#L711-L720\">converts the output tensor back from NHWC to NCHW</a>. However, cuDNN natively supports taking in data in <code>NHWC</code> format.</p>\n<p>Assuming this has not been tested and concluded to be optimal, my prior would be to allow Nvidia to handle the optimal execution of a conv2d on <code>NHWC</code> data rather trying to transpose within TF.</p>", "body_text": "Currently when running conv2d on cuDNN with image data in NHWC format, TF converts the input tensor from NHWC to NCHW, runs the conv and then converts the output tensor back from NHWC to NCHW. However, cuDNN natively supports taking in data in NHWC format.\nAssuming this has not been tested and concluded to be optimal, my prior would be to allow Nvidia to handle the optimal execution of a conv2d on NHWC data rather trying to transpose within TF.", "body": "Currently when running `conv2d` on cuDNN with image data in `NHWC` format, TF [converts the input tensor from NHWC to NCHW](https://github.com/tensorflow/tensorflow/blob/0be81439c91e297b078152dd0c266471b24bde7f/tensorflow/core/kernels/conv_ops.cc#L558-L575), runs the conv and then [converts the output tensor back from NHWC to NCHW](https://github.com/tensorflow/tensorflow/blob/0be81439c91e297b078152dd0c266471b24bde7f/tensorflow/core/kernels/conv_ops.cc#L711-L720). However, cuDNN natively supports taking in data in `NHWC` format. \r\n\r\nAssuming this has not been tested and concluded to be optimal, my prior would be to allow Nvidia to handle the optimal execution of a conv2d on `NHWC` data rather trying to transpose within TF."}