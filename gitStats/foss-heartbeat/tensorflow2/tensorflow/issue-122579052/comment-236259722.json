{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/236259722", "html_url": "https://github.com/tensorflow/tensorflow/issues/526#issuecomment-236259722", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/526", "id": 236259722, "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjI1OTcyMg==", "user": {"login": "henline", "id": 17771000, "node_id": "MDQ6VXNlcjE3NzcxMDAw", "avatar_url": "https://avatars2.githubusercontent.com/u/17771000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/henline", "html_url": "https://github.com/henline", "followers_url": "https://api.github.com/users/henline/followers", "following_url": "https://api.github.com/users/henline/following{/other_user}", "gists_url": "https://api.github.com/users/henline/gists{/gist_id}", "starred_url": "https://api.github.com/users/henline/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/henline/subscriptions", "organizations_url": "https://api.github.com/users/henline/orgs", "repos_url": "https://api.github.com/users/henline/repos", "events_url": "https://api.github.com/users/henline/events{/privacy}", "received_events_url": "https://api.github.com/users/henline/received_events", "type": "User", "site_admin": false}, "created_at": "2016-07-29T18:36:17Z", "updated_at": "2016-07-29T18:36:17Z", "author_association": "NONE", "body_html": "<p>Hi, I'm the owner of StreamExecutor. Sorry for arriving late to this discussion.</p>\n<p>I believe this problem is caused in all cases by GPUs with their compute mode set to EXCLUSIVE_THREAD (just as mentioned by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=2542360\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zxvix\">@zxvix</a>). The solution is to set the compute mode to DEFAULT or EXCLUSIVE_PROCESS, which can be done via one of the following commands:</p>\n<pre><code>$ nvidia-smi --compute-mode=0 # for DEFAULT\n$ nvidia-smi --compute-mode=3 # for EXCLUSIVE_PROCESS\n</code></pre>\n<p>The <code>nvidia-smi -q</code> command can also be used to query the current compute mode of the device.</p>\n<p>If anyone is seeing this error when the device compute mode is either DEFAULT or EXCLUSIVE_PROCESS, please let me know, because I don't think that should be possible.</p>\n<p>StreamExecutor will not work in either EXCLUSIVE_THREAD or PROHIBITED compute mode, but in response to <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3298747\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/danpovey\">@danpovey</a>'s question about shared clusters, EXCLUSIVE_PROCESS mode should be fine.</p>\n<p>There are no plans in StreamExecutor to support EXCLUSIVE_THREAD mode because it is listed as deprecated in the nvidia-smi help message. There are also no plans to support PROHIBITED mode because I think that mode prevents the creation of contexts, and StreamExecutor cannot function with that restriction.</p>\n<p>In response to <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3298747\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/danpovey\">@danpovey</a>'s suggestion about adding a better error message for this case, I think that's a good idea. I will work on getting a patch up to warn about the device compute mode if <code>cuCtxSetCurrent</code> fails and the compute mode is set to an unsupported setting.</p>", "body_text": "Hi, I'm the owner of StreamExecutor. Sorry for arriving late to this discussion.\nI believe this problem is caused in all cases by GPUs with their compute mode set to EXCLUSIVE_THREAD (just as mentioned by @zxvix). The solution is to set the compute mode to DEFAULT or EXCLUSIVE_PROCESS, which can be done via one of the following commands:\n$ nvidia-smi --compute-mode=0 # for DEFAULT\n$ nvidia-smi --compute-mode=3 # for EXCLUSIVE_PROCESS\n\nThe nvidia-smi -q command can also be used to query the current compute mode of the device.\nIf anyone is seeing this error when the device compute mode is either DEFAULT or EXCLUSIVE_PROCESS, please let me know, because I don't think that should be possible.\nStreamExecutor will not work in either EXCLUSIVE_THREAD or PROHIBITED compute mode, but in response to @danpovey's question about shared clusters, EXCLUSIVE_PROCESS mode should be fine.\nThere are no plans in StreamExecutor to support EXCLUSIVE_THREAD mode because it is listed as deprecated in the nvidia-smi help message. There are also no plans to support PROHIBITED mode because I think that mode prevents the creation of contexts, and StreamExecutor cannot function with that restriction.\nIn response to @danpovey's suggestion about adding a better error message for this case, I think that's a good idea. I will work on getting a patch up to warn about the device compute mode if cuCtxSetCurrent fails and the compute mode is set to an unsupported setting.", "body": "Hi, I'm the owner of StreamExecutor. Sorry for arriving late to this discussion.\n\nI believe this problem is caused in all cases by GPUs with their compute mode set to EXCLUSIVE_THREAD (just as mentioned by @zxvix). The solution is to set the compute mode to DEFAULT or EXCLUSIVE_PROCESS, which can be done via one of the following commands:\n\n```\n$ nvidia-smi --compute-mode=0 # for DEFAULT\n$ nvidia-smi --compute-mode=3 # for EXCLUSIVE_PROCESS\n```\n\nThe `nvidia-smi -q` command can also be used to query the current compute mode of the device.\n\nIf anyone is seeing this error when the device compute mode is either DEFAULT or EXCLUSIVE_PROCESS, please let me know, because I don't think that should be possible.\n\nStreamExecutor will not work in either EXCLUSIVE_THREAD or PROHIBITED compute mode, but in response to @danpovey's question about shared clusters, EXCLUSIVE_PROCESS mode should be fine.\n\nThere are no plans in StreamExecutor to support EXCLUSIVE_THREAD mode because it is listed as deprecated in the nvidia-smi help message. There are also no plans to support PROHIBITED mode because I think that mode prevents the creation of contexts, and StreamExecutor cannot function with that restriction.\n\nIn response to @danpovey's suggestion about adding a better error message for this case, I think that's a good idea. I will work on getting a patch up to warn about the device compute mode if `cuCtxSetCurrent` fails and the compute mode is set to an unsupported setting.\n"}