{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4781", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4781/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4781/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4781/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4781", "id": 181171560, "node_id": "MDU6SXNzdWUxODExNzE1NjA=", "number": 4781, "title": "`tf.scan` has Unexpected Behavior on Python CLI/Shell", "user": {"login": "craymichael", "id": 20629897, "node_id": "MDQ6VXNlcjIwNjI5ODk3", "avatar_url": "https://avatars2.githubusercontent.com/u/20629897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/craymichael", "html_url": "https://github.com/craymichael", "followers_url": "https://api.github.com/users/craymichael/followers", "following_url": "https://api.github.com/users/craymichael/following{/other_user}", "gists_url": "https://api.github.com/users/craymichael/gists{/gist_id}", "starred_url": "https://api.github.com/users/craymichael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/craymichael/subscriptions", "organizations_url": "https://api.github.com/users/craymichael/orgs", "repos_url": "https://api.github.com/users/craymichael/repos", "events_url": "https://api.github.com/users/craymichael/events{/privacy}", "received_events_url": "https://api.github.com/users/craymichael/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, {"login": "yuanbyu", "id": 2342391, "node_id": "MDQ6VXNlcjIzNDIzOTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/2342391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuanbyu", "html_url": "https://github.com/yuanbyu", "followers_url": "https://api.github.com/users/yuanbyu/followers", "following_url": "https://api.github.com/users/yuanbyu/following{/other_user}", "gists_url": "https://api.github.com/users/yuanbyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuanbyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuanbyu/subscriptions", "organizations_url": "https://api.github.com/users/yuanbyu/orgs", "repos_url": "https://api.github.com/users/yuanbyu/repos", "events_url": "https://api.github.com/users/yuanbyu/events{/privacy}", "received_events_url": "https://api.github.com/users/yuanbyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-10-05T14:30:30Z", "updated_at": "2016-12-11T00:24:25Z", "closed_at": "2016-12-11T00:24:25Z", "author_association": "NONE", "body_html": "<h3>Version Info</h3>\n<p>'0.10.0rc0'<br>\nOS: Ubuntu</p>\n<h3>Issue</h3>\n<p>While this doesn't affect runtime behavior, using the high level function <code>tf.scan</code> in the python shell results in unexpected behavior. Running the op whilst functional yields expected results. Running again with bad parameters (wrong dtype) raises exception, which is also expected. Running the original op again raises the same exception, which is not expected.</p>\n<h3>To Reproduce</h3>\n<p>Via python CLI, run a working <code>tf.scan</code> function, run one that doesn't work, then run the original.</p>\n<pre><code>&gt;&gt;&gt; import tensorflow as tf\n\n&gt;&gt;&gt; tf.Session().run(tf.scan(lambda a, x: [a[0] + 1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\n\n[array([0, 1, 2, 3, 4]), array([0, 0, 0, 0, 0])]\n\n&gt;&gt;&gt; tf.Session().run(tf.scan(lambda a, x: [1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\nE tensorflow/core/client/tensor_c_api.cc:485] Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\n\n&gt;&gt;&gt; tf.Session().run(tf.scan(lambda a, x: [a[0] + 1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\nE tensorflow/core/client/tensor_c_api.cc:485] Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\n</code></pre>", "body_text": "Version Info\n'0.10.0rc0'\nOS: Ubuntu\nIssue\nWhile this doesn't affect runtime behavior, using the high level function tf.scan in the python shell results in unexpected behavior. Running the op whilst functional yields expected results. Running again with bad parameters (wrong dtype) raises exception, which is also expected. Running the original op again raises the same exception, which is not expected.\nTo Reproduce\nVia python CLI, run a working tf.scan function, run one that doesn't work, then run the original.\n>>> import tensorflow as tf\n\n>>> tf.Session().run(tf.scan(lambda a, x: [a[0] + 1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\n\n[array([0, 1, 2, 3, 4]), array([0, 0, 0, 0, 0])]\n\n>>> tf.Session().run(tf.scan(lambda a, x: [1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\nE tensorflow/core/client/tensor_c_api.cc:485] Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\n\n>>> tf.Session().run(tf.scan(lambda a, x: [a[0] + 1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\nE tensorflow/core/client/tensor_c_api.cc:485] Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.", "body": "### Version Info\n\n'0.10.0rc0'\nOS: Ubuntu\n### Issue\n\nWhile this doesn't affect runtime behavior, using the high level function `tf.scan` in the python shell results in unexpected behavior. Running the op whilst functional yields expected results. Running again with bad parameters (wrong dtype) raises exception, which is also expected. Running the original op again raises the same exception, which is not expected.\n### To Reproduce\n\nVia python CLI, run a working `tf.scan` function, run one that doesn't work, then run the original.\n\n```\n>>> import tensorflow as tf\n\n>>> tf.Session().run(tf.scan(lambda a, x: [a[0] + 1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\n\n[array([0, 1, 2, 3, 4]), array([0, 0, 0, 0, 0])]\n\n>>> tf.Session().run(tf.scan(lambda a, x: [1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\nE tensorflow/core/client/tensor_c_api.cc:485] Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\n\n>>> tf.Session().run(tf.scan(lambda a, x: [a[0] + 1, tf.to_int64(0)], tf.constant([1,2,3,4,5],dtype=tf.int64), initializer=[tf.to_int64(-1), tf.to_int64(0)]))\nE tensorflow/core/client/tensor_c_api.cc:485] Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Input 1 of node scan_1/while/Merge_1 was passed int32 from scan_1/while/NextIteration_1:0 incompatible with expected int64.\n```\n"}