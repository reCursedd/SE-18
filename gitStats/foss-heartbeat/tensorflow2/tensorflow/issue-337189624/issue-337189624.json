{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20435", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20435/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20435/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20435/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20435", "id": 337189624, "node_id": "MDU6SXNzdWUzMzcxODk2MjQ=", "number": 20435, "title": "Feature request: can you add formula of LSTM to docs?", "user": {"login": "Mabinogiysk", "id": 12441989, "node_id": "MDQ6VXNlcjEyNDQxOTg5", "avatar_url": "https://avatars1.githubusercontent.com/u/12441989?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mabinogiysk", "html_url": "https://github.com/Mabinogiysk", "followers_url": "https://api.github.com/users/Mabinogiysk/followers", "following_url": "https://api.github.com/users/Mabinogiysk/following{/other_user}", "gists_url": "https://api.github.com/users/Mabinogiysk/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mabinogiysk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mabinogiysk/subscriptions", "organizations_url": "https://api.github.com/users/Mabinogiysk/orgs", "repos_url": "https://api.github.com/users/Mabinogiysk/repos", "events_url": "https://api.github.com/users/Mabinogiysk/events{/privacy}", "received_events_url": "https://api.github.com/users/Mabinogiysk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-06-30T05:47:34Z", "updated_at": "2018-10-30T13:06:20Z", "closed_at": "2018-10-30T13:05:31Z", "author_association": "NONE", "body_html": "<p>Have I written custom code\uff1a No<br>\nOS Platform and Distribution: Linux 16.04<br>\nTensorFlow installed from: pip install tensorflow-gpu<br>\nTensorFlow version: 1.8.0<br>\nCUDA/cuDNN version: 9.0</p>\n<h3>Describe the problem</h3>\n<p>Hi,<br>\nI have trained a bidirectional lstm(256 hidden units) model in pytorch and I want to transfer it to tensorflow.<br>\nIn pytorch,  each LSTM has two weights and two bias:</p>\n<pre><code>rnn.0.rnn.weight_ih_l0 torch.Size([1024, 512])\nrnn.0.rnn.weight_hh_l0 torch.Size([1024, 256])\nrnn.0.rnn.bias_ih_l0 torch.Size([1024])\nrnn.0.rnn.bias_hh_l0 torch.Size([1024])\n\nweight_ih_l[k] \u2013 the learnable input-hidden weights of the kth layer (W_ii|W_if|W_ig|W_io), of shape (4*hidden_size x input_size)\nweight_hh_l[k] \u2013 the learnable hidden-hidden weights of the kth layer (W_hi|W_hf|W_hg|W_ho), of shape (4*hidden_size x hidden_size)\nbias_ih_l[k] \u2013 the learnable input-hidden bias of the kth layer (b_ii|b_if|b_ig|b_io), of shape (4*hidden_size)\nbias_hh_l[k] \u2013 the learnable hidden-hidden bias of the kth layer (b_hi|b_hf|b_hg|b_ho), of shape (4*hidden_size)\n</code></pre>\n<p>However in tensorflow, each LSTM has only one weight and one bias:</p>\n<pre><code>&lt;tf.Variable 'RNN/BiLSTM1/stack_bidirectional_rnn/cell_0/bidirectional_rnn/fw/basic_lstm_cell/kernel:0' shape=(768, 1024) dtype=float32_ref&gt;,\n &lt;tf.Variable 'RNN/BiLSTM1/stack_bidirectional_rnn/cell_0/bidirectional_rnn/fw/basic_lstm_cell/bias:0' shape=(1024,) dtype=float32_ref&gt;,\n</code></pre>\n<p>I do not know how to convert the parameters in pytorch into tensorflow. Can you add some formula and weight structures of LSTM to docs as what they did in pytorch?<br>\nThanks!</p>", "body_text": "Have I written custom code\uff1a No\nOS Platform and Distribution: Linux 16.04\nTensorFlow installed from: pip install tensorflow-gpu\nTensorFlow version: 1.8.0\nCUDA/cuDNN version: 9.0\nDescribe the problem\nHi,\nI have trained a bidirectional lstm(256 hidden units) model in pytorch and I want to transfer it to tensorflow.\nIn pytorch,  each LSTM has two weights and two bias:\nrnn.0.rnn.weight_ih_l0 torch.Size([1024, 512])\nrnn.0.rnn.weight_hh_l0 torch.Size([1024, 256])\nrnn.0.rnn.bias_ih_l0 torch.Size([1024])\nrnn.0.rnn.bias_hh_l0 torch.Size([1024])\n\nweight_ih_l[k] \u2013 the learnable input-hidden weights of the kth layer (W_ii|W_if|W_ig|W_io), of shape (4*hidden_size x input_size)\nweight_hh_l[k] \u2013 the learnable hidden-hidden weights of the kth layer (W_hi|W_hf|W_hg|W_ho), of shape (4*hidden_size x hidden_size)\nbias_ih_l[k] \u2013 the learnable input-hidden bias of the kth layer (b_ii|b_if|b_ig|b_io), of shape (4*hidden_size)\nbias_hh_l[k] \u2013 the learnable hidden-hidden bias of the kth layer (b_hi|b_hf|b_hg|b_ho), of shape (4*hidden_size)\n\nHowever in tensorflow, each LSTM has only one weight and one bias:\n<tf.Variable 'RNN/BiLSTM1/stack_bidirectional_rnn/cell_0/bidirectional_rnn/fw/basic_lstm_cell/kernel:0' shape=(768, 1024) dtype=float32_ref>,\n <tf.Variable 'RNN/BiLSTM1/stack_bidirectional_rnn/cell_0/bidirectional_rnn/fw/basic_lstm_cell/bias:0' shape=(1024,) dtype=float32_ref>,\n\nI do not know how to convert the parameters in pytorch into tensorflow. Can you add some formula and weight structures of LSTM to docs as what they did in pytorch?\nThanks!", "body": "Have I written custom code\uff1a No\r\nOS Platform and Distribution: Linux 16.04\r\nTensorFlow installed from: pip install tensorflow-gpu\r\nTensorFlow version: 1.8.0\r\nCUDA/cuDNN version: 9.0\r\n\r\n### Describe the problem\r\nHi,\r\nI have trained a bidirectional lstm(256 hidden units) model in pytorch and I want to transfer it to tensorflow. \r\nIn pytorch,  each LSTM has two weights and two bias:\r\n```\r\nrnn.0.rnn.weight_ih_l0 torch.Size([1024, 512])\r\nrnn.0.rnn.weight_hh_l0 torch.Size([1024, 256])\r\nrnn.0.rnn.bias_ih_l0 torch.Size([1024])\r\nrnn.0.rnn.bias_hh_l0 torch.Size([1024])\r\n\r\nweight_ih_l[k] \u2013 the learnable input-hidden weights of the kth layer (W_ii|W_if|W_ig|W_io), of shape (4*hidden_size x input_size)\r\nweight_hh_l[k] \u2013 the learnable hidden-hidden weights of the kth layer (W_hi|W_hf|W_hg|W_ho), of shape (4*hidden_size x hidden_size)\r\nbias_ih_l[k] \u2013 the learnable input-hidden bias of the kth layer (b_ii|b_if|b_ig|b_io), of shape (4*hidden_size)\r\nbias_hh_l[k] \u2013 the learnable hidden-hidden bias of the kth layer (b_hi|b_hf|b_hg|b_ho), of shape (4*hidden_size)\r\n```\r\nHowever in tensorflow, each LSTM has only one weight and one bias:\r\n```\r\n<tf.Variable 'RNN/BiLSTM1/stack_bidirectional_rnn/cell_0/bidirectional_rnn/fw/basic_lstm_cell/kernel:0' shape=(768, 1024) dtype=float32_ref>,\r\n <tf.Variable 'RNN/BiLSTM1/stack_bidirectional_rnn/cell_0/bidirectional_rnn/fw/basic_lstm_cell/bias:0' shape=(1024,) dtype=float32_ref>,\r\n```\r\nI do not know how to convert the parameters in pytorch into tensorflow. Can you add some formula and weight structures of LSTM to docs as what they did in pytorch?\r\nThanks!\r\n\r\n"}