{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/338640123", "html_url": "https://github.com/tensorflow/tensorflow/issues/13777#issuecomment-338640123", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13777", "id": 338640123, "node_id": "MDEyOklzc3VlQ29tbWVudDMzODY0MDEyMw==", "user": {"login": "Nayana-ibm", "id": 20816038, "node_id": "MDQ6VXNlcjIwODE2MDM4", "avatar_url": "https://avatars0.githubusercontent.com/u/20816038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nayana-ibm", "html_url": "https://github.com/Nayana-ibm", "followers_url": "https://api.github.com/users/Nayana-ibm/followers", "following_url": "https://api.github.com/users/Nayana-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/Nayana-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nayana-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nayana-ibm/subscriptions", "organizations_url": "https://api.github.com/users/Nayana-ibm/orgs", "repos_url": "https://api.github.com/users/Nayana-ibm/repos", "events_url": "https://api.github.com/users/Nayana-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/Nayana-ibm/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-23T12:17:09Z", "updated_at": "2017-10-23T12:22:25Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Thanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7946809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gunan\">@gunan</a> for information.<br>\nI have added support for s390x in nsync code : BUILD as well as bazel/BUILD.bazel files. PFA code patch.<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1407028/nsync_s390x_patch.txt\">nsync_s390x_patch.txt</a></p>\n<p>Apart from above changes, I guess we also need to create platform specific sub-directory inside <code>nysnc/builds</code> for s390x by executing <code>tools/mkmakefile.sh</code> script.</p>\n<p>With above changes, I could resolve an error :  <code>Configurable attribute \"copts\" doesn't match this configuration</code>  However Tensorflow build again failed at:</p>\n<pre><code>ERROR: missing input file '@nsync//:platform/s390x/cputype.h'.\nERROR: /home/test/tensorflow/tensorflow/tools/pip_package/BUILD:139:1: //tensorflow/tools/pip_package:build_pip_package: missing input file '@nsync//:platform/s390x/cputype.h'.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nERROR: /home/test/tensorflow/tensorflow/tools/pip_package/BUILD:139:1 1 input file(s) do not exist.\n</code></pre>\n<p>Tensorflow uses nsync's platform-specific sub directories available inside <code>nsync/platform/</code> which has source code containing assembly instructions ( <a href=\"https://github.com/google/nsync/blob/master/platform/x86_64/cputype.h\">cputype.h</a> and <a href=\"https://github.com/google/nsync/blob/master/platform/x86_64/src/nsync_atm_x86_64.s\">nsync_atm_.s</a> )</p>\n<p>The file <code>cputype.h</code> declares a flag<code> ATM_LD_IS_ACQ_ST_IS_REL_</code> . I'm not sure what should be the value (0 or 1) of this flag for s390x.  For now, I have set this flag value to 1 and with this change Tensorflow build succeeds. However, need to confirm on this.</p>\n<p>Also, need information on what assembly instructions are required for s390x from file <code>nsync_atm_&lt;platform&gt;.s</code><br>\n<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7946809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gunan\">@gunan</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=10168793\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/m3bm3b\">@m3bm3b</a> Can you please check and let me know.</p>", "body_text": "Thanks @gunan for information.\nI have added support for s390x in nsync code : BUILD as well as bazel/BUILD.bazel files. PFA code patch.\nnsync_s390x_patch.txt\nApart from above changes, I guess we also need to create platform specific sub-directory inside nysnc/builds for s390x by executing tools/mkmakefile.sh script.\nWith above changes, I could resolve an error :  Configurable attribute \"copts\" doesn't match this configuration  However Tensorflow build again failed at:\nERROR: missing input file '@nsync//:platform/s390x/cputype.h'.\nERROR: /home/test/tensorflow/tensorflow/tools/pip_package/BUILD:139:1: //tensorflow/tools/pip_package:build_pip_package: missing input file '@nsync//:platform/s390x/cputype.h'.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nERROR: /home/test/tensorflow/tensorflow/tools/pip_package/BUILD:139:1 1 input file(s) do not exist.\n\nTensorflow uses nsync's platform-specific sub directories available inside nsync/platform/ which has source code containing assembly instructions ( cputype.h and nsync_atm_.s )\nThe file cputype.h declares a flag ATM_LD_IS_ACQ_ST_IS_REL_ . I'm not sure what should be the value (0 or 1) of this flag for s390x.  For now, I have set this flag value to 1 and with this change Tensorflow build succeeds. However, need to confirm on this.\nAlso, need information on what assembly instructions are required for s390x from file nsync_atm_<platform>.s\n@gunan @m3bm3b Can you please check and let me know.", "body": "\r\n\r\nThanks @gunan for information. \r\nI have added support for s390x in nsync code : BUILD as well as bazel/BUILD.bazel files. PFA code patch. \r\n[nsync_s390x_patch.txt](https://github.com/tensorflow/tensorflow/files/1407028/nsync_s390x_patch.txt)\r\n\r\nApart from above changes, I guess we also need to create platform specific sub-directory inside `nysnc/builds` for s390x by executing `tools/mkmakefile.sh` script. \r\n\r\nWith above changes, I could resolve an error :  `Configurable attribute \"copts\" doesn't match this configuration`  However Tensorflow build again failed at:\r\n\r\n```\r\nERROR: missing input file '@nsync//:platform/s390x/cputype.h'.\r\nERROR: /home/test/tensorflow/tensorflow/tools/pip_package/BUILD:139:1: //tensorflow/tools/pip_package:build_pip_package: missing input file '@nsync//:platform/s390x/cputype.h'.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nERROR: /home/test/tensorflow/tensorflow/tools/pip_package/BUILD:139:1 1 input file(s) do not exist.\r\n```\r\nTensorflow uses nsync's platform-specific sub directories available inside `nsync/platform/` which has source code containing assembly instructions ( [cputype.h](https://github.com/google/nsync/blob/master/platform/x86_64/cputype.h) and [nsync_atm_<platform>.s](https://github.com/google/nsync/blob/master/platform/x86_64/src/nsync_atm_x86_64.s) ) \r\n\r\nThe file `cputype.h` declares a flag` ATM_LD_IS_ACQ_ST_IS_REL_` . I'm not sure what should be the value (0 or 1) of this flag for s390x.  For now, I have set this flag value to 1 and with this change Tensorflow build succeeds. However, need to confirm on this. \r\n\r\nAlso, need information on what assembly instructions are required for s390x from file `nsync_atm_<platform>.s` \r\n@gunan @m3bm3b Can you please check and let me know. \r\n\r\n"}