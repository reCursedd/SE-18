{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/373686975", "html_url": "https://github.com/tensorflow/tensorflow/issues/16291#issuecomment-373686975", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16291", "id": 373686975, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzY4Njk3NQ==", "user": {"login": "Kejie-Wang", "id": 10304029, "node_id": "MDQ6VXNlcjEwMzA0MDI5", "avatar_url": "https://avatars0.githubusercontent.com/u/10304029?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kejie-Wang", "html_url": "https://github.com/Kejie-Wang", "followers_url": "https://api.github.com/users/Kejie-Wang/followers", "following_url": "https://api.github.com/users/Kejie-Wang/following{/other_user}", "gists_url": "https://api.github.com/users/Kejie-Wang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kejie-Wang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kejie-Wang/subscriptions", "organizations_url": "https://api.github.com/users/Kejie-Wang/orgs", "repos_url": "https://api.github.com/users/Kejie-Wang/repos", "events_url": "https://api.github.com/users/Kejie-Wang/events{/privacy}", "received_events_url": "https://api.github.com/users/Kejie-Wang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-16T11:32:15Z", "updated_at": "2018-03-16T11:34:36Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=26105061\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mattdingmeng\">@mattdingmeng</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=5453737\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tatatodd\">@tatatodd</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6732996\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ChengshuLi\">@ChengshuLi</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1797963\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jpapon\">@jpapon</a><br>\nFinally, I manage to solve it by adding a line <code>*protobuf*</code> into <code>tensorflow/tf_version_script.Ids</code>.</p>\n<pre><code>tensorflow {\n  global:\n    *tensorflow*;\n    *perftools*gputools*;\n    *TF_*;\n    *TFE_*;\n    *nsync_*;\n    *protobuf*;\n  local:\n    *;\n};\n</code></pre>\n<p>I have tested it works in tensorflow-1.5 by using <code>bazel build -c opt --config=cuda --config=monolithic --copt=-march=native --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" tensorflow:libtensorflow_cc.so</code> to compile. The <code>tf_version_scripts.Ids</code> used to control the exported symbols to prevent conflict with OpenCV (<a href=\"https://github.com/tensorflow/tensorflow/issues/1924\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1924/hovercard\">#1924</a>). I export the symbols about protobuf in the library but I am not sure whether this solution may cause other problems. Anyway, it works for me now.</p>", "body_text": "@mattdingmeng @tatatodd @ChengshuLi @jpapon\nFinally, I manage to solve it by adding a line *protobuf* into tensorflow/tf_version_script.Ids.\ntensorflow {\n  global:\n    *tensorflow*;\n    *perftools*gputools*;\n    *TF_*;\n    *TFE_*;\n    *nsync_*;\n    *protobuf*;\n  local:\n    *;\n};\n\nI have tested it works in tensorflow-1.5 by using bazel build -c opt --config=cuda --config=monolithic --copt=-march=native --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" tensorflow:libtensorflow_cc.so to compile. The tf_version_scripts.Ids used to control the exported symbols to prevent conflict with OpenCV (#1924). I export the symbols about protobuf in the library but I am not sure whether this solution may cause other problems. Anyway, it works for me now.", "body": "@mattdingmeng @tatatodd @ChengshuLi @jpapon \r\nFinally, I manage to solve it by adding a line `*protobuf*` into `tensorflow/tf_version_script.Ids`. \r\n```\r\ntensorflow {\r\n  global:\r\n    *tensorflow*;\r\n    *perftools*gputools*;\r\n    *TF_*;\r\n    *TFE_*;\r\n    *nsync_*;\r\n    *protobuf*;\r\n  local:\r\n    *;\r\n};\r\n```\r\nI have tested it works in tensorflow-1.5 by using `bazel build -c opt --config=cuda --config=monolithic --copt=-march=native --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" tensorflow:libtensorflow_cc.so` to compile. The `tf_version_scripts.Ids` used to control the exported symbols to prevent conflict with OpenCV ([#1924](https://github.com/tensorflow/tensorflow/issues/1924)). I export the symbols about protobuf in the library but I am not sure whether this solution may cause other problems. Anyway, it works for me now."}