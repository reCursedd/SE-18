{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22115", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22115/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22115/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22115/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22115", "id": 357719986, "node_id": "MDU6SXNzdWUzNTc3MTk5ODY=", "number": 22115, "title": "Feature Request: fp16 support for tf.contrib.image.transform on gpu", "user": {"login": "ZhouYuChen", "id": 3125695, "node_id": "MDQ6VXNlcjMxMjU2OTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/3125695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ZhouYuChen", "html_url": "https://github.com/ZhouYuChen", "followers_url": "https://api.github.com/users/ZhouYuChen/followers", "following_url": "https://api.github.com/users/ZhouYuChen/following{/other_user}", "gists_url": "https://api.github.com/users/ZhouYuChen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ZhouYuChen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ZhouYuChen/subscriptions", "organizations_url": "https://api.github.com/users/ZhouYuChen/orgs", "repos_url": "https://api.github.com/users/ZhouYuChen/repos", "events_url": "https://api.github.com/users/ZhouYuChen/events{/privacy}", "received_events_url": "https://api.github.com/users/ZhouYuChen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-06T15:52:39Z", "updated_at": "2018-10-01T17:57:37Z", "closed_at": "2018-10-01T17:57:37Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code</strong>: yes</li>\n<li><strong>OS Platform and Distribution</strong>: Linux Ubuntu 16.04</li>\n<li><strong>Mobile device</strong>: n/a</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: ('v1.10.0-0-g656e7a2b34', '1.10.0')</li>\n<li><strong>Python version</strong>: Python 2.7.12</li>\n<li><strong>Bazel version (if compiling from source)</strong>: n/a</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: n/a</li>\n<li><strong>CUDA/cuDNN version</strong>:  9.0  /  7.1.4.18-1</li>\n<li><strong>GPU model and memory</strong>: GeForce GTX 1080 8097MB</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p><code>tf.contrib.image.transform</code> does not support fp16 on GPU.</p>\n<h3>Source code / logs</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\nsession_config <span class=\"pl-k\">=</span> tf.ConfigProto(\n    <span class=\"pl-v\">allow_soft_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">False</span>,\n    <span class=\"pl-v\">log_device_placement</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\n\n<span class=\"pl-k\">with</span> tf.device(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/device:GPU:0<span class=\"pl-pds\">\"</span></span>):\n  images <span class=\"pl-k\">=</span>tf.random_normal([<span class=\"pl-c1\">512</span>,<span class=\"pl-c1\">512</span>], <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float16)\n  y <span class=\"pl-k\">=</span> tf.contrib.image.transform(images,[<span class=\"pl-c1\">1</span>]<span class=\"pl-k\">*</span><span class=\"pl-c1\">8</span>)\n  <span class=\"pl-k\">with</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>session_config) <span class=\"pl-k\">as</span> sess:\n    <span class=\"pl-c1\">print</span>(sess.run(y))</pre></div>\n<pre><code>Caused by op u'transform/ImageProjectiveTransform', defined at:\n  File \"./test.py\", line 11, in &lt;module&gt;\n    y = tf.contrib.image.transform(images,[1]*8)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/image_ops.py\", line 269, in transform\n    images, transforms, interpolation=interpolation.upper())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/ops/gen_image_ops.py\", line 235, in image_projective_transform\n    interpolation=interpolation, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'transform/ImageProjectiveTransform': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='GPU'; dtype in [DT_DOUBLE]\n  device='GPU'; dtype in [DT_FLOAT]\n  device='GPU'; dtype in [DT_INT64]\n  device='GPU'; dtype in [DT_INT32]\n  device='GPU'; dtype in [DT_UINT8]\n  device='CPU'; dtype in [DT_DOUBLE]\n  device='CPU'; dtype in [DT_FLOAT]\n  device='CPU'; dtype in [DT_HALF]\n  device='CPU'; dtype in [DT_INT64]\n  device='CPU'; dtype in [DT_INT32]\n  device='CPU'; dtype in [DT_UINT8]\n\n\t [[Node: transform/ImageProjectiveTransform = ImageProjectiveTransform[dtype=DT_HALF, interpolation=\"NEAREST\", _device=\"/device:GPU:0\"](transform/strided_slice, transform/strided_slice_1)]]\n</code></pre>", "body_text": "System information\n\nHave I written custom code: yes\nOS Platform and Distribution: Linux Ubuntu 16.04\nMobile device: n/a\nTensorFlow installed from (source or binary): binary\nTensorFlow version (use command below): ('v1.10.0-0-g656e7a2b34', '1.10.0')\nPython version: Python 2.7.12\nBazel version (if compiling from source): n/a\nGCC/Compiler version (if compiling from source): n/a\nCUDA/cuDNN version:  9.0  /  7.1.4.18-1\nGPU model and memory: GeForce GTX 1080 8097MB\nExact command to reproduce:\n\nDescribe the problem\ntf.contrib.image.transform does not support fp16 on GPU.\nSource code / logs\nimport tensorflow as tf\n\nsession_config = tf.ConfigProto(\n    allow_soft_placement=False,\n    log_device_placement=True)\n\nwith tf.device(\"/device:GPU:0\"):\n  images =tf.random_normal([512,512], dtype=tf.float16)\n  y = tf.contrib.image.transform(images,[1]*8)\n  with tf.Session(config=session_config) as sess:\n    print(sess.run(y))\nCaused by op u'transform/ImageProjectiveTransform', defined at:\n  File \"./test.py\", line 11, in <module>\n    y = tf.contrib.image.transform(images,[1]*8)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/image_ops.py\", line 269, in transform\n    images, transforms, interpolation=interpolation.upper())\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/ops/gen_image_ops.py\", line 235, in image_projective_transform\n    interpolation=interpolation, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'transform/ImageProjectiveTransform': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\nRegistered kernels:\n  device='GPU'; dtype in [DT_DOUBLE]\n  device='GPU'; dtype in [DT_FLOAT]\n  device='GPU'; dtype in [DT_INT64]\n  device='GPU'; dtype in [DT_INT32]\n  device='GPU'; dtype in [DT_UINT8]\n  device='CPU'; dtype in [DT_DOUBLE]\n  device='CPU'; dtype in [DT_FLOAT]\n  device='CPU'; dtype in [DT_HALF]\n  device='CPU'; dtype in [DT_INT64]\n  device='CPU'; dtype in [DT_INT32]\n  device='CPU'; dtype in [DT_UINT8]\n\n\t [[Node: transform/ImageProjectiveTransform = ImageProjectiveTransform[dtype=DT_HALF, interpolation=\"NEAREST\", _device=\"/device:GPU:0\"](transform/strided_slice, transform/strided_slice_1)]]", "body": "### System information\r\n- **Have I written custom code**: yes\r\n- **OS Platform and Distribution**: Linux Ubuntu 16.04\r\n- **Mobile device**: n/a\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: ('v1.10.0-0-g656e7a2b34', '1.10.0')\r\n- **Python version**: Python 2.7.12\r\n- **Bazel version (if compiling from source)**: n/a\r\n- **GCC/Compiler version (if compiling from source)**: n/a\r\n- **CUDA/cuDNN version**:  9.0  /  7.1.4.18-1\r\n- **GPU model and memory**: GeForce GTX 1080 8097MB\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\n`tf.contrib.image.transform` does not support fp16 on GPU. \r\n\r\n### Source code / logs\r\n```python\r\nimport tensorflow as tf\r\n\r\nsession_config = tf.ConfigProto(\r\n    allow_soft_placement=False,\r\n    log_device_placement=True)\r\n\r\nwith tf.device(\"/device:GPU:0\"):\r\n  images =tf.random_normal([512,512], dtype=tf.float16)\r\n  y = tf.contrib.image.transform(images,[1]*8)\r\n  with tf.Session(config=session_config) as sess:\r\n    print(sess.run(y))\r\n```\r\n \r\n```\r\nCaused by op u'transform/ImageProjectiveTransform', defined at:\r\n  File \"./test.py\", line 11, in <module>\r\n    y = tf.contrib.image.transform(images,[1]*8)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/python/ops/image_ops.py\", line 269, in transform\r\n    images, transforms, interpolation=interpolation.upper())\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/image/ops/gen_image_ops.py\", line 235, in image_projective_transform\r\n    interpolation=interpolation, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'transform/ImageProjectiveTransform': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\nRegistered kernels:\r\n  device='GPU'; dtype in [DT_DOUBLE]\r\n  device='GPU'; dtype in [DT_FLOAT]\r\n  device='GPU'; dtype in [DT_INT64]\r\n  device='GPU'; dtype in [DT_INT32]\r\n  device='GPU'; dtype in [DT_UINT8]\r\n  device='CPU'; dtype in [DT_DOUBLE]\r\n  device='CPU'; dtype in [DT_FLOAT]\r\n  device='CPU'; dtype in [DT_HALF]\r\n  device='CPU'; dtype in [DT_INT64]\r\n  device='CPU'; dtype in [DT_INT32]\r\n  device='CPU'; dtype in [DT_UINT8]\r\n\r\n\t [[Node: transform/ImageProjectiveTransform = ImageProjectiveTransform[dtype=DT_HALF, interpolation=\"NEAREST\", _device=\"/device:GPU:0\"](transform/strided_slice, transform/strided_slice_1)]]\r\n```\r\n"}