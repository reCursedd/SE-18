{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/389756328", "html_url": "https://github.com/tensorflow/tensorflow/issues/19286#issuecomment-389756328", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19286", "id": 389756328, "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTc1NjMyOA==", "user": {"login": "oscarriddle", "id": 13745902, "node_id": "MDQ6VXNlcjEzNzQ1OTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/13745902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oscarriddle", "html_url": "https://github.com/oscarriddle", "followers_url": "https://api.github.com/users/oscarriddle/followers", "following_url": "https://api.github.com/users/oscarriddle/following{/other_user}", "gists_url": "https://api.github.com/users/oscarriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/oscarriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oscarriddle/subscriptions", "organizations_url": "https://api.github.com/users/oscarriddle/orgs", "repos_url": "https://api.github.com/users/oscarriddle/repos", "events_url": "https://api.github.com/users/oscarriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/oscarriddle/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-17T06:13:13Z", "updated_at": "2018-05-17T06:13:13Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=667809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/karmel\">@karmel</a> ,<br>\nI tried to execute my code on tensorflow-gpu==1.8.0. After the server side is established, the client asks for a image classification request. Then I get below error, seems the session calling mechanism is changed?</p>\n<pre><code>[Thu May 17 14:01:59 2018]server start at 10000\n[Thu May 17 14:02:27 2018]extraction error!! RuntimeError('Attempted to use a closed Session.',)\n[Thu May 17 14:02:28 2018]extraction error!! RuntimeError('Attempted to use a closed Session.',)\nnew request method:GetFeatureByImgs size:1 cost:415\n</code></pre>\n<p>In my server, the inference is provided as internal method of a class. Server will initialize the class, and within the initialization, the desired model will be loaded and a session will be created. Then the session will be passed to a private variable by \"self.sess = sess\".</p>\n<p>Later when the client call a method function to do the inference, it will directly execute like:</p>\n<pre><code>output = self.sess.run(output_tensor, {input_tensor: img})\nreturn output\n</code></pre>\n<p>Not sure whether this session calling method is still useful, looks like a session will be immediately closed when getting out of its \"with tf.Session as sess\" block.</p>\n<p>Thanks,</p>", "body_text": "Hi @karmel ,\nI tried to execute my code on tensorflow-gpu==1.8.0. After the server side is established, the client asks for a image classification request. Then I get below error, seems the session calling mechanism is changed?\n[Thu May 17 14:01:59 2018]server start at 10000\n[Thu May 17 14:02:27 2018]extraction error!! RuntimeError('Attempted to use a closed Session.',)\n[Thu May 17 14:02:28 2018]extraction error!! RuntimeError('Attempted to use a closed Session.',)\nnew request method:GetFeatureByImgs size:1 cost:415\n\nIn my server, the inference is provided as internal method of a class. Server will initialize the class, and within the initialization, the desired model will be loaded and a session will be created. Then the session will be passed to a private variable by \"self.sess = sess\".\nLater when the client call a method function to do the inference, it will directly execute like:\noutput = self.sess.run(output_tensor, {input_tensor: img})\nreturn output\n\nNot sure whether this session calling method is still useful, looks like a session will be immediately closed when getting out of its \"with tf.Session as sess\" block.\nThanks,", "body": "Hi @karmel ,\r\nI tried to execute my code on tensorflow-gpu==1.8.0. After the server side is established, the client asks for a image classification request. Then I get below error, seems the session calling mechanism is changed?\r\n```\r\n[Thu May 17 14:01:59 2018]server start at 10000\r\n[Thu May 17 14:02:27 2018]extraction error!! RuntimeError('Attempted to use a closed Session.',)\r\n[Thu May 17 14:02:28 2018]extraction error!! RuntimeError('Attempted to use a closed Session.',)\r\nnew request method:GetFeatureByImgs size:1 cost:415\r\n```\r\nIn my server, the inference is provided as internal method of a class. Server will initialize the class, and within the initialization, the desired model will be loaded and a session will be created. Then the session will be passed to a private variable by \"self.sess = sess\". \r\n\r\nLater when the client call a method function to do the inference, it will directly execute like:\r\n```\r\noutput = self.sess.run(output_tensor, {input_tensor: img})\r\nreturn output\r\n```\r\nNot sure whether this session calling method is still useful, looks like a session will be immediately closed when getting out of its \"with tf.Session as sess\" block. \r\n\r\nThanks,"}