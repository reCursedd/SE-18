{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9226", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9226/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9226/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9226/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9226", "id": 221895741, "node_id": "MDU6SXNzdWUyMjE4OTU3NDE=", "number": 9226, "title": "Keras + tensorflow + P100 : cudaErrorNotSupported = 71 error", "user": {"login": "vlimant", "id": 4989875, "node_id": "MDQ6VXNlcjQ5ODk4NzU=", "avatar_url": "https://avatars3.githubusercontent.com/u/4989875?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vlimant", "html_url": "https://github.com/vlimant", "followers_url": "https://api.github.com/users/vlimant/followers", "following_url": "https://api.github.com/users/vlimant/following{/other_user}", "gists_url": "https://api.github.com/users/vlimant/gists{/gist_id}", "starred_url": "https://api.github.com/users/vlimant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vlimant/subscriptions", "organizations_url": "https://api.github.com/users/vlimant/orgs", "repos_url": "https://api.github.com/users/vlimant/repos", "events_url": "https://api.github.com/users/vlimant/events{/privacy}", "received_events_url": "https://api.github.com/users/vlimant/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-04-14T21:33:22Z", "updated_at": "2017-04-19T12:38:18Z", "closed_at": "2017-04-15T07:30:11Z", "author_association": "NONE", "body_html": "<p>Allow me please to cross post, upon sugestion, an error faced in using keras with tensorflow with machine equipped with P100 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"217948273\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/keras-team/keras/issues/6054\" data-hovercard-type=\"issue\" data-hovercard-url=\"/keras-team/keras/issues/6054/hovercard\" href=\"https://github.com/keras-team/keras/issues/6054\">keras-team/keras#6054</a><br>\nApologies if this has been reported already at some other place, I have been googling for it quite a bit, with my colleague without success.<br>\nWhile running the simple mnist example (<a href=\"https://github.com/fchollet/keras/blob/master/examples/mnist_cnn.py\">https://github.com/fchollet/keras/blob/master/examples/mnist_cnn.py</a>) with keras+tensorflow using P100 GPGPU we encounter an issue at the intersection of keras/tensorflow/cuda</p>\n<p>Using TensorFlow backend.<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:<br>\nname: Tesla P100-PCIE-16GB<br>\nmajor: 6 minor: 0 memoryClockRate (GHz) 1.3285<br>\npciBusID 0000:02:00.0<br>\nTotal memory: 15.89GiB<br>\nFree memory: 15.51GiB<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0: Y<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:02:00.0)<br>\nF tensorflow/core/common_runtime/gpu/gpu_device.cc:121] Check failed: err == cudaSuccess (71 vs. 0)<br>\nsrun: error: nid02011: task 0: Aborted<br>\nsrun: Terminating job step 1262138.0</p>\n<p>we are using keras 2.0.2, tensorflow 1.0.0. cuda 8.0.53.<br>\nWe seem to be having this issue both in python2.7.12 and python3.5.2 (keras 1.2 and 2.0 ...)<br>\nBare tensorflow runtest are going fine, which lead us to think that this is really at the intersection of keras/tensorflow/cuda.<br>\nThe same test runs fine on various machine with the same version of the software but with TitanX GPGPU.</p>\n<p>seem to be tracing this back to<br>\n<a href=\"https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/core/common_runtime/gpu/gpu_device.cc#L121\">https://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/core/common_runtime/gpu/gpu_device.cc#L121</a></p>\n<p><a href=\"http://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html#group__CUDART__TYPES_1g3f51e3575c2178246db0a94a430e0038\" rel=\"nofollow\">http://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html#group__CUDART__TYPES_1g3f51e3575c2178246db0a94a430e0038</a></p>\n<p>\"\"\"<br>\ncudaErrorNotSupported = 71<br>\nThis error indicates the attempted operation is not supported on the current system or device.<br>\n\"\"\"</p>\n<p>I am clueless on where to look next to solve this issue. I would greatly appreciate any feedback and guidance on this matter.</p>", "body_text": "Allow me please to cross post, upon sugestion, an error faced in using keras with tensorflow with machine equipped with P100 keras-team/keras#6054\nApologies if this has been reported already at some other place, I have been googling for it quite a bit, with my colleague without success.\nWhile running the simple mnist example (https://github.com/fchollet/keras/blob/master/examples/mnist_cnn.py) with keras+tensorflow using P100 GPGPU we encounter an issue at the intersection of keras/tensorflow/cuda\nUsing TensorFlow backend.\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\nname: Tesla P100-PCIE-16GB\nmajor: 6 minor: 0 memoryClockRate (GHz) 1.3285\npciBusID 0000:02:00.0\nTotal memory: 15.89GiB\nFree memory: 15.51GiB\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0: Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:02:00.0)\nF tensorflow/core/common_runtime/gpu/gpu_device.cc:121] Check failed: err == cudaSuccess (71 vs. 0)\nsrun: error: nid02011: task 0: Aborted\nsrun: Terminating job step 1262138.0\nwe are using keras 2.0.2, tensorflow 1.0.0. cuda 8.0.53.\nWe seem to be having this issue both in python2.7.12 and python3.5.2 (keras 1.2 and 2.0 ...)\nBare tensorflow runtest are going fine, which lead us to think that this is really at the intersection of keras/tensorflow/cuda.\nThe same test runs fine on various machine with the same version of the software but with TitanX GPGPU.\nseem to be tracing this back to\nhttps://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/core/common_runtime/gpu/gpu_device.cc#L121\nhttp://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html#group__CUDART__TYPES_1g3f51e3575c2178246db0a94a430e0038\n\"\"\"\ncudaErrorNotSupported = 71\nThis error indicates the attempted operation is not supported on the current system or device.\n\"\"\"\nI am clueless on where to look next to solve this issue. I would greatly appreciate any feedback and guidance on this matter.", "body": "Allow me please to cross post, upon sugestion, an error faced in using keras with tensorflow with machine equipped with P100 https://github.com/fchollet/keras/issues/6054\r\nApologies if this has been reported already at some other place, I have been googling for it quite a bit, with my colleague without success.\r\nWhile running the simple mnist example (https://github.com/fchollet/keras/blob/master/examples/mnist_cnn.py) with keras+tensorflow using P100 GPGPU we encounter an issue at the intersection of keras/tensorflow/cuda\r\n\r\nUsing TensorFlow backend.\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\r\nname: Tesla P100-PCIE-16GB\r\nmajor: 6 minor: 0 memoryClockRate (GHz) 1.3285\r\npciBusID 0000:02:00.0\r\nTotal memory: 15.89GiB\r\nFree memory: 15.51GiB\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0: Y\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:02:00.0)\r\nF tensorflow/core/common_runtime/gpu/gpu_device.cc:121] Check failed: err == cudaSuccess (71 vs. 0)\r\nsrun: error: nid02011: task 0: Aborted\r\nsrun: Terminating job step 1262138.0\r\n\r\nwe are using keras 2.0.2, tensorflow 1.0.0. cuda 8.0.53.\r\nWe seem to be having this issue both in python2.7.12 and python3.5.2 (keras 1.2 and 2.0 ...)\r\nBare tensorflow runtest are going fine, which lead us to think that this is really at the intersection of keras/tensorflow/cuda.\r\nThe same test runs fine on various machine with the same version of the software but with TitanX GPGPU.\r\n\r\n seem to be tracing this back to\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.0/tensorflow/core/common_runtime/gpu/gpu_device.cc#L121\r\n\r\nhttp://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html#group__CUDART__TYPES_1g3f51e3575c2178246db0a94a430e0038\r\n\r\n\"\"\"\r\ncudaErrorNotSupported = 71\r\nThis error indicates the attempted operation is not supported on the current system or device.\r\n\"\"\"\r\n\r\nI am clueless on where to look next to solve this issue. I would greatly appreciate any feedback and guidance on this matter.\r\n"}