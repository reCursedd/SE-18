{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/303718742", "html_url": "https://github.com/tensorflow/tensorflow/issues/8190#issuecomment-303718742", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8190", "id": 303718742, "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzcxODc0Mg==", "user": {"login": "maxfiedler", "id": 4192637, "node_id": "MDQ6VXNlcjQxOTI2Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/4192637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxfiedler", "html_url": "https://github.com/maxfiedler", "followers_url": "https://api.github.com/users/maxfiedler/followers", "following_url": "https://api.github.com/users/maxfiedler/following{/other_user}", "gists_url": "https://api.github.com/users/maxfiedler/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxfiedler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxfiedler/subscriptions", "organizations_url": "https://api.github.com/users/maxfiedler/orgs", "repos_url": "https://api.github.com/users/maxfiedler/repos", "events_url": "https://api.github.com/users/maxfiedler/events{/privacy}", "received_events_url": "https://api.github.com/users/maxfiedler/received_events", "type": "User", "site_admin": false}, "created_at": "2017-05-24T13:10:07Z", "updated_at": "2017-05-24T13:10:07Z", "author_association": "NONE", "body_html": "<p>I am using TF 1.1 on Ubuntu Xenial 16.04<br>\nand I am experiencing the same problem with the new tf.train.get_or_create_global_step() function<br>\nWhen I use it to create my global step variable I get on the following error on executing my MonitoredSession<br>\n<code>tensorflow.python.framework.errors_impl.DataLossError: Invalid size in bundle entry: key global_step/global_step; stored size 4; expected size 8 [[Node: save_1/RestoreV2 = RestoreV2[dtypes=[DT_INT64], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save_1/Const_0, save_1/RestoreV2/tensor_names, save_1/RestoreV2/shape_and_slices)]] [[Node: save_1/RestoreV2_4/_3 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_20_save_1/RestoreV2_4\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]] </code><br>\nWhen I manually change the dtype in the source of tf.train.get_or_create_global_step() to int32 the error does not show. But this obviously not how it is intended.</p>\n<p>So for now I will go back to creating the global step manually.</p>\n<p>Full error trace:<br>\n<code>line 107, in main step_counter_hook]) as sess: File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 627, in __init__ stop_grace_period_secs=stop_grace_period_secs) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 456, in __init__ self._sess = _RecoverableSession(self._coordinated_creator) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in __init__ _WrappedSession.__init__(self, self._create_session()) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 805, in _create_session return self._sess_creator.create_session() File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 517, in create_session self.tf_sess = self._session_creator.create_session() File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 393, in create_session init_fn=self._scaffold.init_fn) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 256, in prepare_session config=config) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 188, in _restore_checkpoint saver.restore(sess, ckpt.model_checkpoint_path) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1457, in restore {self.saver_def.filename_tensor_name: save_path}) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 778, in run run_metadata_ptr) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 982, in _run feed_dict_string, options, run_metadata) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1032, in _do_run target_list, options, run_metadata) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1052, in _do_call raise type(e)(node_def, op, message) tensorflow.python.framework.errors_impl.DataLossError: Invalid size in bundle entry: key global_step/global_step; stored size 4; expected size 8</code></p>", "body_text": "I am using TF 1.1 on Ubuntu Xenial 16.04\nand I am experiencing the same problem with the new tf.train.get_or_create_global_step() function\nWhen I use it to create my global step variable I get on the following error on executing my MonitoredSession\ntensorflow.python.framework.errors_impl.DataLossError: Invalid size in bundle entry: key global_step/global_step; stored size 4; expected size 8 [[Node: save_1/RestoreV2 = RestoreV2[dtypes=[DT_INT64], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save_1/Const_0, save_1/RestoreV2/tensor_names, save_1/RestoreV2/shape_and_slices)]] [[Node: save_1/RestoreV2_4/_3 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_20_save_1/RestoreV2_4\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]] \nWhen I manually change the dtype in the source of tf.train.get_or_create_global_step() to int32 the error does not show. But this obviously not how it is intended.\nSo for now I will go back to creating the global step manually.\nFull error trace:\nline 107, in main step_counter_hook]) as sess: File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 627, in __init__ stop_grace_period_secs=stop_grace_period_secs) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 456, in __init__ self._sess = _RecoverableSession(self._coordinated_creator) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in __init__ _WrappedSession.__init__(self, self._create_session()) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 805, in _create_session return self._sess_creator.create_session() File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 517, in create_session self.tf_sess = self._session_creator.create_session() File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 393, in create_session init_fn=self._scaffold.init_fn) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 256, in prepare_session config=config) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 188, in _restore_checkpoint saver.restore(sess, ckpt.model_checkpoint_path) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1457, in restore {self.saver_def.filename_tensor_name: save_path}) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 778, in run run_metadata_ptr) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 982, in _run feed_dict_string, options, run_metadata) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1032, in _do_run target_list, options, run_metadata) File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1052, in _do_call raise type(e)(node_def, op, message) tensorflow.python.framework.errors_impl.DataLossError: Invalid size in bundle entry: key global_step/global_step; stored size 4; expected size 8", "body": "I am using TF 1.1 on Ubuntu Xenial 16.04\r\nand I am experiencing the same problem with the new tf.train.get_or_create_global_step() function\r\nWhen I use it to create my global step variable I get on the following error on executing my MonitoredSession\r\n`tensorflow.python.framework.errors_impl.DataLossError: Invalid size in bundle entry: key global_step/global_step; stored size 4; expected size 8\r\n\t [[Node: save_1/RestoreV2 = RestoreV2[dtypes=[DT_INT64], _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_save_1/Const_0, save_1/RestoreV2/tensor_names, save_1/RestoreV2/shape_and_slices)]]\r\n\t [[Node: save_1/RestoreV2_4/_3 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=1, tensor_name=\"edge_20_save_1/RestoreV2_4\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/gpu:0\"]()]]\r\n`\r\nWhen I manually change the dtype in the source of tf.train.get_or_create_global_step() to int32 the error does not show. But this obviously not how it is intended. \r\n\r\nSo for now I will go back to creating the global step manually. \r\n\r\nFull error trace: \r\n`line 107, in main\r\n    step_counter_hook]) as sess:\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 627, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 456, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 800, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 805, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 517, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 393, in create_session\r\n    init_fn=self._scaffold.init_fn)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 256, in prepare_session\r\n    config=config)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 188, in _restore_checkpoint\r\n    saver.restore(sess, ckpt.model_checkpoint_path)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 1457, in restore\r\n    {self.saver_def.filename_tensor_name: save_path})\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 778, in run\r\n    run_metadata_ptr)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 982, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1032, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/home/mfiedler/.tensorflow-venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1052, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.DataLossError: Invalid size in bundle entry: key global_step/global_step; stored size 4; expected size 8`"}