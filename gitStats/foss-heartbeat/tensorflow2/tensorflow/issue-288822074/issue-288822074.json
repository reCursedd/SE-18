{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16150", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16150/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16150/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16150/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16150", "id": 288822074, "node_id": "MDU6SXNzdWUyODg4MjIwNzQ=", "number": 16150, "title": "Tensorflow Debugger with Multithreading", "user": {"login": "iliTheFallen", "id": 8805234, "node_id": "MDQ6VXNlcjg4MDUyMzQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/8805234?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iliTheFallen", "html_url": "https://github.com/iliTheFallen", "followers_url": "https://api.github.com/users/iliTheFallen/followers", "following_url": "https://api.github.com/users/iliTheFallen/following{/other_user}", "gists_url": "https://api.github.com/users/iliTheFallen/gists{/gist_id}", "starred_url": "https://api.github.com/users/iliTheFallen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iliTheFallen/subscriptions", "organizations_url": "https://api.github.com/users/iliTheFallen/orgs", "repos_url": "https://api.github.com/users/iliTheFallen/repos", "events_url": "https://api.github.com/users/iliTheFallen/events{/privacy}", "received_events_url": "https://api.github.com/users/iliTheFallen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-01-16T08:30:16Z", "updated_at": "2018-09-28T21:35:06Z", "closed_at": "2018-09-28T21:35:06Z", "author_association": "NONE", "body_html": "<h2>System information</h2>\n<ol>\n<li>OS Platform: Ubuntu 14.04</li>\n<li>TensorFlow installed from source : GPU-Version 1.14 branch</li>\n<li>cuDNN: 7.0</li>\n<li>Python version: 3.4</li>\n</ol>\n<p>--</p>\n<p>I'm using <strong>tf.Estimator</strong> together with <strong>numpy_input_fn</strong>. Moreover, I set all num_threads to 1. However, tfdbg somehow doesn't get along well with child threads auto-created by new estimator API.</p>\n<p>Here is how I defined Estimator:</p>\n<pre><code>def do_train(tr_data, vl_data):\n\n    # Create Estimator\n    sess_conf = tf.ConfigProto(allow_soft_placement=True, log_device_placement=False)\n    sess_conf.gpu_options.allow_growth = True\n    config = tf.estimator.RunConfig(model_dir=FLAGS.model_dir,  # CheckpointSaverHook\n                                    save_checkpoints_steps=100,  # CheckpointSaverHook\n                                    log_step_count_steps=10,  # SummarySaverHook\n                                    session_config=sess_conf)\n    music_classifier = tf.estimator.Estimator(model_fn,\n                                              config=config,\n                                              params={'max_seq': tr_data.max_seq})\n    # Prepare input data\n    tr_input_fn = tf.estimator.inputs.numpy_input_fn(\n        {'input_ph': tr_data.data, 'seq_len_ph': tr_data.seq_len},\n        batch_size=FLAGS.batch_size,\n        num_epochs=FLAGS.num_epochs,\n        num_threads=1,\n        shuffle=True\n    )\n    # Extra Hooks\n    logging_hook = tf.train.LoggingTensorHook(\n        tensors={'probabilities': 'probs_tensor'},\n        every_n_iter=10\n    )\n    debugging_hook = tf_debug.LocalCLIDebugHook(thread_name_filter=\"MainThread$\", dump_root=\"./dump\")\n    # Train\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\n</code></pre>\n<p>Although the code runs fine; whenever I run it in debug mode, it fails at executing run command on tfdbg command line. Following is the exception I got:</p>\n<pre><code>2018-01-16 10:25:26.587936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-01-16 10:25:26.588715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: \nname: GeForce GTX 1060 major: 6 minor: 1 memoryClockRate(GHz): 1.6705\npciBusID: 0000:01:00.0\ntotalMemory: 5.93GiB freeMemory: 5.38GiB\n2018-01-16 10:25:26.588732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: GeForce GTX 1060, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-01-16 10:25:41.373907: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\nTraceback (most recent call last):\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1323, in _do_call\n    return fn(*args)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1302, in _run_fn\n    status, run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/errors_impl.py\", line 473, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/lib/python3.4/runpy.py\", line 170, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib/python3.4/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 202, in &lt;module&gt;\n    tf.app.run(main=main)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 191, in main\n    do_train(tr_data, vl_data)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 169, in do_train\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 783, in _train_model\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 521, in run\n    run_metadata=run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 892, in run\n    run_metadata=run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 967, in run\n    raise six.reraise(*original_exc_info)\n  File \"/usr/local/lib/python3.4/dist-packages/six.py\", line 693, in reraise\n    raise value\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 952, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 1024, in run\n    run_metadata=run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 827, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 889, in run\n    run_metadata_ptr)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1120, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\n    options, run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\n\nCaused by op 'rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3', defined at:\n  File \"/usr/lib/python3.4/runpy.py\", line 170, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib/python3.4/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 202, in &lt;module&gt;\n    tf.app.run(main=main)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 191, in main\n    do_train(tr_data, vl_data)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 169, in do_train\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 711, in _train_model\n    features, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 694, in _call_model_fn\n    model_fn_results = self._model_fn(features=features, **kwargs)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 116, in model_fn\n    initializer=tf.glorot_normal_initializer())  # [BSxMTxOS], [BSxSS]\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 253, in dynamic_msa_rnn\n    dtype=tf.float32)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 614, in dynamic_rnn\n    dtype=dtype)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 777, in _dynamic_rnn_loop\n    swap_memory=swap_memory)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2816, in while_loop\n    result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2640, in BuildLoop\n    pred, body, original_loop_vars, loop_vars, shape_invariants)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2590, in _BuildLoop\n    body_result = body(*packed_vars_for_body)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 760, in _time_step\n    skip_conditionals=True)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 236, in _rnn_step\n    new_output, new_state = call_cell()\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 748, in &lt;lambda&gt;\n    call_cell = lambda: cell(input_t, state)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn_cell_impl.py\", line 183, in __call__\n    return super(RNNCell, self).__call__(inputs, state)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/layers/base.py\", line 575, in __call__\n    outputs = self.call(inputs, *args, **kwargs)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 204, in call\n    ms_analyzer = self._extract_features(inputs)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 151, in _extract_features\n    sub_sig = self._gen_sub_sig(inputs)  # BSxTxIN\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 105, in _gen_sub_sig\n    self.__ta_signal = self.__ta_signal.write(self.__time, inputs)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\n    return _add_should_use_warning(fn(*args, **kwargs))\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/tensor_array_ops.py\", line 310, in write\n    name=name)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 5038, in _tensor_array_write_v3\n    flow_in=flow_in, name=name)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\n    op_def=op_def)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\n</code></pre>\n<p>Thank you for your support in advance.</p>", "body_text": "System information\n\nOS Platform: Ubuntu 14.04\nTensorFlow installed from source : GPU-Version 1.14 branch\ncuDNN: 7.0\nPython version: 3.4\n\n--\nI'm using tf.Estimator together with numpy_input_fn. Moreover, I set all num_threads to 1. However, tfdbg somehow doesn't get along well with child threads auto-created by new estimator API.\nHere is how I defined Estimator:\ndef do_train(tr_data, vl_data):\n\n    # Create Estimator\n    sess_conf = tf.ConfigProto(allow_soft_placement=True, log_device_placement=False)\n    sess_conf.gpu_options.allow_growth = True\n    config = tf.estimator.RunConfig(model_dir=FLAGS.model_dir,  # CheckpointSaverHook\n                                    save_checkpoints_steps=100,  # CheckpointSaverHook\n                                    log_step_count_steps=10,  # SummarySaverHook\n                                    session_config=sess_conf)\n    music_classifier = tf.estimator.Estimator(model_fn,\n                                              config=config,\n                                              params={'max_seq': tr_data.max_seq})\n    # Prepare input data\n    tr_input_fn = tf.estimator.inputs.numpy_input_fn(\n        {'input_ph': tr_data.data, 'seq_len_ph': tr_data.seq_len},\n        batch_size=FLAGS.batch_size,\n        num_epochs=FLAGS.num_epochs,\n        num_threads=1,\n        shuffle=True\n    )\n    # Extra Hooks\n    logging_hook = tf.train.LoggingTensorHook(\n        tensors={'probabilities': 'probs_tensor'},\n        every_n_iter=10\n    )\n    debugging_hook = tf_debug.LocalCLIDebugHook(thread_name_filter=\"MainThread$\", dump_root=\"./dump\")\n    # Train\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\n\nAlthough the code runs fine; whenever I run it in debug mode, it fails at executing run command on tfdbg command line. Following is the exception I got:\n2018-01-16 10:25:26.587936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-01-16 10:25:26.588715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: \nname: GeForce GTX 1060 major: 6 minor: 1 memoryClockRate(GHz): 1.6705\npciBusID: 0000:01:00.0\ntotalMemory: 5.93GiB freeMemory: 5.38GiB\n2018-01-16 10:25:26.588732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 1060, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-01-16 10:25:41.373907: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\nTraceback (most recent call last):\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1323, in _do_call\n    return fn(*args)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1302, in _run_fn\n    status, run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/errors_impl.py\", line 473, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/lib/python3.4/runpy.py\", line 170, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib/python3.4/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 202, in <module>\n    tf.app.run(main=main)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 191, in main\n    do_train(tr_data, vl_data)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 169, in do_train\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 783, in _train_model\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 521, in run\n    run_metadata=run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 892, in run\n    run_metadata=run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 967, in run\n    raise six.reraise(*original_exc_info)\n  File \"/usr/local/lib/python3.4/dist-packages/six.py\", line 693, in reraise\n    raise value\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 952, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 1024, in run\n    run_metadata=run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 827, in run\n    return self._sess.run(*args, **kwargs)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 889, in run\n    run_metadata_ptr)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1120, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\n    options, run_metadata)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\n\nCaused by op 'rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3', defined at:\n  File \"/usr/lib/python3.4/runpy.py\", line 170, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/lib/python3.4/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 202, in <module>\n    tf.app.run(main=main)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 191, in main\n    do_train(tr_data, vl_data)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 169, in do_train\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\n    loss = self._train_model(input_fn, hooks, saving_listeners)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 711, in _train_model\n    features, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 694, in _call_model_fn\n    model_fn_results = self._model_fn(features=features, **kwargs)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 116, in model_fn\n    initializer=tf.glorot_normal_initializer())  # [BSxMTxOS], [BSxSS]\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 253, in dynamic_msa_rnn\n    dtype=tf.float32)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 614, in dynamic_rnn\n    dtype=dtype)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 777, in _dynamic_rnn_loop\n    swap_memory=swap_memory)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2816, in while_loop\n    result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2640, in BuildLoop\n    pred, body, original_loop_vars, loop_vars, shape_invariants)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2590, in _BuildLoop\n    body_result = body(*packed_vars_for_body)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 760, in _time_step\n    skip_conditionals=True)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 236, in _rnn_step\n    new_output, new_state = call_cell()\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 748, in <lambda>\n    call_cell = lambda: cell(input_t, state)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn_cell_impl.py\", line 183, in __call__\n    return super(RNNCell, self).__call__(inputs, state)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/layers/base.py\", line 575, in __call__\n    outputs = self.call(inputs, *args, **kwargs)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 204, in call\n    ms_analyzer = self._extract_features(inputs)\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 151, in _extract_features\n    sub_sig = self._gen_sub_sig(inputs)  # BSxTxIN\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 105, in _gen_sub_sig\n    self.__ta_signal = self.__ta_signal.write(self.__time, inputs)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\n    return _add_should_use_warning(fn(*args, **kwargs))\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/tensor_array_ops.py\", line 310, in write\n    name=name)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 5038, in _tensor_array_write_v3\n    flow_in=flow_in, name=name)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\n    op_def=op_def)\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\n\nThank you for your support in advance.", "body": "\r\n## System information\r\n\r\n1. OS Platform: Ubuntu 14.04 \r\n2. TensorFlow installed from source : GPU-Version 1.14 branch \r\n3. cuDNN: 7.0\r\n4. Python version: 3.4\r\n\r\n--\r\n\r\nI'm using **tf.Estimator** together with **numpy_input_fn**. Moreover, I set all num_threads to 1. However, tfdbg somehow doesn't get along well with child threads auto-created by new estimator API.\r\n\r\nHere is how I defined Estimator:\r\n\r\n```\r\ndef do_train(tr_data, vl_data):\r\n\r\n    # Create Estimator\r\n    sess_conf = tf.ConfigProto(allow_soft_placement=True, log_device_placement=False)\r\n    sess_conf.gpu_options.allow_growth = True\r\n    config = tf.estimator.RunConfig(model_dir=FLAGS.model_dir,  # CheckpointSaverHook\r\n                                    save_checkpoints_steps=100,  # CheckpointSaverHook\r\n                                    log_step_count_steps=10,  # SummarySaverHook\r\n                                    session_config=sess_conf)\r\n    music_classifier = tf.estimator.Estimator(model_fn,\r\n                                              config=config,\r\n                                              params={'max_seq': tr_data.max_seq})\r\n    # Prepare input data\r\n    tr_input_fn = tf.estimator.inputs.numpy_input_fn(\r\n        {'input_ph': tr_data.data, 'seq_len_ph': tr_data.seq_len},\r\n        batch_size=FLAGS.batch_size,\r\n        num_epochs=FLAGS.num_epochs,\r\n        num_threads=1,\r\n        shuffle=True\r\n    )\r\n    # Extra Hooks\r\n    logging_hook = tf.train.LoggingTensorHook(\r\n        tensors={'probabilities': 'probs_tensor'},\r\n        every_n_iter=10\r\n    )\r\n    debugging_hook = tf_debug.LocalCLIDebugHook(thread_name_filter=\"MainThread$\", dump_root=\"./dump\")\r\n    # Train\r\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\r\n```\r\n\r\n\r\nAlthough the code runs fine; whenever I run it in debug mode, it fails at executing run command on tfdbg command line. Following is the exception I got:\r\n\r\n```\r\n2018-01-16 10:25:26.587936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-01-16 10:25:26.588715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: \r\nname: GeForce GTX 1060 major: 6 minor: 1 memoryClockRate(GHz): 1.6705\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 5.93GiB freeMemory: 5.38GiB\r\n2018-01-16 10:25:26.588732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 1060, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-01-16 10:25:41.373907: W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\r\nTraceback (most recent call last):\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1323, in _do_call\r\n    return fn(*args)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1302, in _run_fn\r\n    status, run_metadata)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/errors_impl.py\", line 473, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\r\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.4/runpy.py\", line 170, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.4/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 202, in <module>\r\n    tf.app.run(main=main)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 191, in main\r\n    do_train(tr_data, vl_data)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 169, in do_train\r\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 783, in _train_model\r\n    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 521, in run\r\n    run_metadata=run_metadata)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 892, in run\r\n    run_metadata=run_metadata)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 967, in run\r\n    raise six.reraise(*original_exc_info)\r\n  File \"/usr/local/lib/python3.4/dist-packages/six.py\", line 693, in reraise\r\n    raise value\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 952, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 1024, in run\r\n    run_metadata=run_metadata)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/training/monitored_session.py\", line 827, in run\r\n    return self._sess.run(*args, **kwargs)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 889, in run\r\n    run_metadata_ptr)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1120, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\r\n    options, run_metadata)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\r\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\r\n\r\nCaused by op 'rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3', defined at:\r\n  File \"/usr/lib/python3.4/runpy.py\", line 170, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.4/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 202, in <module>\r\n    tf.app.run(main=main)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 191, in main\r\n    do_train(tr_data, vl_data)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 169, in do_train\r\n    music_classifier.train(tr_input_fn, hooks=[debugging_hook])\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 302, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 711, in _train_model\r\n    features, labels, model_fn_lib.ModeKeys.TRAIN, self.config)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/estimator/estimator.py\", line 694, in _call_model_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/music_modeling.py\", line 116, in model_fn\r\n    initializer=tf.glorot_normal_initializer())  # [BSxMTxOS], [BSxSS]\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 253, in dynamic_msa_rnn\r\n    dtype=tf.float32)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 614, in dynamic_rnn\r\n    dtype=dtype)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 777, in _dynamic_rnn_loop\r\n    swap_memory=swap_memory)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2816, in while_loop\r\n    result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2640, in BuildLoop\r\n    pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 2590, in _BuildLoop\r\n    body_result = body(*packed_vars_for_body)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 760, in _time_step\r\n    skip_conditionals=True)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 236, in _rnn_step\r\n    new_output, new_state = call_cell()\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn.py\", line 748, in <lambda>\r\n    call_cell = lambda: cell(input_t, state)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/rnn_cell_impl.py\", line 183, in __call__\r\n    return super(RNNCell, self).__call__(inputs, state)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/layers/base.py\", line 575, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 204, in call\r\n    ms_analyzer = self._extract_features(inputs)\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 151, in _extract_features\r\n    sub_sig = self._gen_sub_sig(inputs)  # BSxTxIN\r\n  File \"/home/ilithefallen/Documents/phdStudies/coding/temizelRepo/MultiScaleRNN/model/tf_msa_rnn.py\", line 105, in _gen_sub_sig\r\n    self.__ta_signal = self.__ta_signal.write(self.__time, inputs)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\r\n    return _add_should_use_warning(fn(*args, **kwargs))\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/tensor_array_ops.py\", line 310, in write\r\n    name=name)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/ops/gen_data_flow_ops.py\", line 5038, in _tensor_array_write_v3\r\n    flow_in=flow_in, name=name)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\r\n    op_def=op_def)\r\n  File \"/home/ilithefallen/tensorflow/lib/python3.4/site-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): TensorArray ta_signal_0: Tried to write to index 2434 but array is not resizeable and size is: 2434\r\n     [[Node: rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3 = TensorArrayWriteV3[T=DT_FLOAT, _class=[\"loc:@rnn/while/TensorArrayReadV3\"], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter, rnn/while/rnn/msarnn_cell/Identity/Enter/_259, rnn/while/TensorArrayReadV3, rnn/while/rnn/msarnn_cell/TensorArrayWrite/TensorArrayWriteV3/Enter_1, ^rnn/while/rnn/msarnn_cell/cond/Merge/_263)]]\r\n```\r\n\r\nThank you for your support in advance."}