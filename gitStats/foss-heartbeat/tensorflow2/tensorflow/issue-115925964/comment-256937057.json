{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/256937057", "html_url": "https://github.com/tensorflow/tensorflow/issues/17#issuecomment-256937057", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17", "id": 256937057, "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjkzNzA1Nw==", "user": {"login": "synap5e", "id": 2515062, "node_id": "MDQ6VXNlcjI1MTUwNjI=", "avatar_url": "https://avatars0.githubusercontent.com/u/2515062?v=4", "gravatar_id": "", "url": "https://api.github.com/users/synap5e", "html_url": "https://github.com/synap5e", "followers_url": "https://api.github.com/users/synap5e/followers", "following_url": "https://api.github.com/users/synap5e/following{/other_user}", "gists_url": "https://api.github.com/users/synap5e/gists{/gist_id}", "starred_url": "https://api.github.com/users/synap5e/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/synap5e/subscriptions", "organizations_url": "https://api.github.com/users/synap5e/orgs", "repos_url": "https://api.github.com/users/synap5e/repos", "events_url": "https://api.github.com/users/synap5e/events{/privacy}", "received_events_url": "https://api.github.com/users/synap5e/received_events", "type": "User", "site_admin": false}, "created_at": "2016-10-28T14:36:15Z", "updated_at": "2016-10-28T14:36:15Z", "author_association": "NONE", "body_html": "<p>I compiled tensorflow for python as per the instructions, but I get a crash originating from <code>cudnn</code> when using <code>tf.nn.conv2d</code> on my GPU.</p>\n<p>Sample code that causes the crash is</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\nsess <span class=\"pl-k\">=</span> tf.InteractiveSession()\nimage <span class=\"pl-k\">=</span> tf.placeholder(tf.float32, <span class=\"pl-v\">shape</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">1</span>], <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>image<span class=\"pl-pds\">'</span></span>)\nkernel <span class=\"pl-k\">=</span> tf.truncated_normal([<span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">5</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>], <span class=\"pl-v\">stddev</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">0.1</span>)\nconv <span class=\"pl-k\">=</span> tf.nn.conv2d(image, kernel, <span class=\"pl-v\">strides</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">1</span>], <span class=\"pl-v\">padding</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>SAME<span class=\"pl-pds\">'</span></span>)\nsess.run(tf.initialize_all_variables())\nsess.run(conv, <span class=\"pl-v\">feed_dict</span><span class=\"pl-k\">=</span>{image: [np.zeros((<span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">1</span>))]})</pre></div>\n<p>This causes the python process to crash and gives this output in the jupyter console</p>\n<pre><code>WARNING:root:kernel 800a0f42-d62b-4128-a61a-ba64ee725ca8 restarted\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cublas64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cudnn64_5.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cufft64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library nvcuda.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library curand64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:944] Found device 0 with properties:\nname: GeForce GTX 970\nmajor: 5 minor: 2 memoryClockRate (GHz) 1.3165\npciBusID 0000:01:00.0\nTotal memory: 4.00GiB\nFree memory: 3.31GiB\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:965] DMA: 0\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] 0:   Y\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1034] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0)\nE d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:662] Could not identify NUMA node of /job:localhost/replica:0/task:0/gpu:0, defaulting to 0.  Your kernel may not have been built with NUMA support.\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_NOT_INITIALIZED\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:392] error retrieving driver version: Permission denied: could not open driver version path for reading: /proc/driver/nvidia/version\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\nF d:\\tensorflow\\tensorflow\\tensorflow\\core\\kernels\\conv_ops.cc:532] Check failed: stream-&gt;parent()-&gt;GetConvolveAlgorithms(&amp;algorithms)\n</code></pre>\n<p>While messing around with the trying different versions of <code>cudnn64_5.dll</code> I was able to get the code to work once and confirmed that the GPU was being used, but even after trying all the versions of <code>cudnn</code>  that I downloaded I have had no luck making it work a second time.</p>", "body_text": "I compiled tensorflow for python as per the instructions, but I get a crash originating from cudnn when using tf.nn.conv2d on my GPU.\nSample code that causes the crash is\nimport tensorflow as tf\nimport numpy as np\nsess = tf.InteractiveSession()\nimage = tf.placeholder(tf.float32, shape=[None, 10, 10, 1], name='image')\nkernel = tf.truncated_normal([5, 5, 1, 1], stddev=0.1)\nconv = tf.nn.conv2d(image, kernel, strides=[1, 1, 1, 1], padding='SAME')\nsess.run(tf.initialize_all_variables())\nsess.run(conv, feed_dict={image: [np.zeros((10, 10, 1))]})\nThis causes the python process to crash and gives this output in the jupyter console\nWARNING:root:kernel 800a0f42-d62b-4128-a61a-ba64ee725ca8 restarted\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cublas64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cudnn64_5.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cufft64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library nvcuda.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library curand64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:944] Found device 0 with properties:\nname: GeForce GTX 970\nmajor: 5 minor: 2 memoryClockRate (GHz) 1.3165\npciBusID 0000:01:00.0\nTotal memory: 4.00GiB\nFree memory: 3.31GiB\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:965] DMA: 0\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] 0:   Y\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1034] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0)\nE d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:662] Could not identify NUMA node of /job:localhost/replica:0/task:0/gpu:0, defaulting to 0.  Your kernel may not have been built with NUMA support.\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_NOT_INITIALIZED\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:392] error retrieving driver version: Permission denied: could not open driver version path for reading: /proc/driver/nvidia/version\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\nF d:\\tensorflow\\tensorflow\\tensorflow\\core\\kernels\\conv_ops.cc:532] Check failed: stream->parent()->GetConvolveAlgorithms(&algorithms)\n\nWhile messing around with the trying different versions of cudnn64_5.dll I was able to get the code to work once and confirmed that the GPU was being used, but even after trying all the versions of cudnn  that I downloaded I have had no luck making it work a second time.", "body": "I compiled tensorflow for python as per the instructions, but I get a crash originating from `cudnn` when using `tf.nn.conv2d` on my GPU.\n\nSample code that causes the crash is\n\n``` python\nimport tensorflow as tf\nimport numpy as np\nsess = tf.InteractiveSession()\nimage = tf.placeholder(tf.float32, shape=[None, 10, 10, 1], name='image')\nkernel = tf.truncated_normal([5, 5, 1, 1], stddev=0.1)\nconv = tf.nn.conv2d(image, kernel, strides=[1, 1, 1, 1], padding='SAME')\nsess.run(tf.initialize_all_variables())\nsess.run(conv, feed_dict={image: [np.zeros((10, 10, 1))]})\n```\n\nThis causes the python process to crash and gives this output in the jupyter console\n\n```\nWARNING:root:kernel 800a0f42-d62b-4128-a61a-ba64ee725ca8 restarted\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cublas64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cudnn64_5.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library cufft64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library nvcuda.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\dso_loader.cc:125] successfully opened CUDA library curand64_80.dll locally\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:944] Found device 0 with properties:\nname: GeForce GTX 970\nmajor: 5 minor: 2 memoryClockRate (GHz) 1.3165\npciBusID 0000:01:00.0\nTotal memory: 4.00GiB\nFree memory: 3.31GiB\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:965] DMA: 0\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:975] 0:   Y\nI d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1034] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0)\nE d:\\tensorflow\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:662] Could not identify NUMA node of /job:localhost/replica:0/task:0/gpu:0, defaulting to 0.  Your kernel may not have been built with NUMA support.\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:385] could not create cudnn handle: CUDNN_STATUS_NOT_INITIALIZED\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:392] error retrieving driver version: Permission denied: could not open driver version path for reading: /proc/driver/nvidia/version\nE d:\\tensorflow\\tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_dnn.cc:352] could not destroy cudnn handle: CUDNN_STATUS_BAD_PARAM\nF d:\\tensorflow\\tensorflow\\tensorflow\\core\\kernels\\conv_ops.cc:532] Check failed: stream->parent()->GetConvolveAlgorithms(&algorithms)\n```\n\nWhile messing around with the trying different versions of `cudnn64_5.dll` I was able to get the code to work once and confirmed that the GPU was being used, but even after trying all the versions of `cudnn`  that I downloaded I have had no luck making it work a second time.\n"}