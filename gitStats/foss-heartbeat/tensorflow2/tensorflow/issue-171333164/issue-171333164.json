{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3838", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3838/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3838/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3838/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3838", "id": 171333164, "node_id": "MDU6SXNzdWUxNzEzMzMxNjQ=", "number": 3838, "title": "Tensorflow: cannot install custom user_op for roi_pooling", "user": {"login": "alfonsolink", "id": 17796678, "node_id": "MDQ6VXNlcjE3Nzk2Njc4", "avatar_url": "https://avatars2.githubusercontent.com/u/17796678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alfonsolink", "html_url": "https://github.com/alfonsolink", "followers_url": "https://api.github.com/users/alfonsolink/followers", "following_url": "https://api.github.com/users/alfonsolink/following{/other_user}", "gists_url": "https://api.github.com/users/alfonsolink/gists{/gist_id}", "starred_url": "https://api.github.com/users/alfonsolink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alfonsolink/subscriptions", "organizations_url": "https://api.github.com/users/alfonsolink/orgs", "repos_url": "https://api.github.com/users/alfonsolink/repos", "events_url": "https://api.github.com/users/alfonsolink/events{/privacy}", "received_events_url": "https://api.github.com/users/alfonsolink/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-16T06:14:13Z", "updated_at": "2016-08-17T09:15:53Z", "closed_at": "2016-08-17T09:15:53Z", "author_association": "NONE", "body_html": "<p>I experimented with a user-op for ROI_pooling in this fork: <a href=\"https://github.com/yuxng/tensorflow/\">https://github.com/yuxng/tensorflow/</a>,</p>\n<p>I tried several ways to make it work:</p>\n<p>Attempt 1:</p>\n<ol>\n<li>uninstalled tensorflow</li>\n<li>placed the roi_pooling files (roi_pooling_op.cc, roi_pooling_op_gpu.cu.cc, roi_pooling_op_gpu.h, roi_pooling_op_grad.py, roi_pooling_op_test.py) in //tensorflow/core/user_ops/ (without BUILD so that they get incorporated with the install)</li>\n<li>reinstalled tensorflow using bazel with bazel build -c opt --config=cuda ...</li>\n</ol>\n<p>I then get this error with attempt 1:</p>\n<p>ERROR: /home/fishdrop/tensorflow/tensorflow/cc/BUILD:116:1: Linking of rule '//tensorflow/cc:ops/user_ops_gen_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -o bazel-out/host/bin/tensorflow/cc/ops/user_ops_gen_cc ... (remaining 41 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.<br>\nbazel-out/host/bin/tensorflow/core/libuser_ops_op_lib.lo(roi_pooling_op.o): In function <code>RoiPoolGradOp&lt;Eigen::GpuDevice, float&gt;::Compute(tensorflow::OpKernelContext*)': roi_pooling_op.cc:(.text._ZN13RoiPoolGradOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE[_ZN13RoiPoolGradOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE]+0x3ea): undefined reference to</code>ROIPoolBackwardLaucher(float const_, float, int, int, int, int, int, int, int, float const_, float_, int const_, Eigen::GpuDevice const&amp;)'<br>\nbazel-out/host/bin/tensorflow/core/libuser_ops_op_lib.lo(roi_pooling_op.o): In function <code>RoiPoolOp&lt;Eigen::GpuDevice, float&gt;::Compute(tensorflow::OpKernelContext*)': roi_pooling_op.cc:(.text._ZN9RoiPoolOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE[_ZN9RoiPoolOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE]+0x392): undefined reference to</code>ROIPoolForwardLaucher(float const_, float, int, int, int, int, int, int, float const_, float_, int_, Eigen::GpuDevice const&amp;)'<br>\ncollect2: error: ld returned 1 exit status<br>\nTarget //tensorflow/cc:tutorials_example_trainer failed to build<br>\nUse --verbose_failures to see the command lines of failed build steps.<br>\nERROR: /home/fishdrop/tensorflow/tensorflow/cc/BUILD:116:1 Linking of rule '//tensorflow/cc:ops/user_ops_gen_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -o bazel-out/host/bin/tensorflow/cc/ops/user_ops_gen_cc ... (remaining 41 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.</p>\n<p>Attempt 2:</p>\n<ol>\n<li>re-install tensorflow</li>\n<li>place files (with BUILD) in //tensorflow/core/user_ops/</li>\n<li>use bazel build -c opt //tensorflow/core/user_ops:roi_pooling.so</li>\n</ol>\n<p>This successfully built roi_pooling.so, but when I tried to load the module with tf.load_op_library, I get this error:</p>\n<p>tensorflow.python.framework.errors.NotFoundError: /home/fishdrop/tensorflow/bazel-bin/tensorflow/core/user_ops/roi_pooling.so: undefined symbol: _Z21ROIPoolForwardLaucherPKffiiiiiiS0_PfPiRKN5Eigen9GpuDeviceE</p>\n<p>The error seems to be related with Eigen, but I read in this Link: <a href=\"http://stackoverflow.com/questions/38618960/tensorflow-how-to-insert-custom-input-to-existing-graph\" rel=\"nofollow\">http://stackoverflow.com/questions/38618960/tensorflow-how-to-insert-custom-input-to-existing-graph</a>, that the user_op is supposed to work..</p>\n<p>I am using Ubuntu 14.04 LTS, and I tried these procedures in both Tensorflow 0.10 and Tensorflow 0.08, and got the same errors.. Anyone who could help?</p>", "body_text": "I experimented with a user-op for ROI_pooling in this fork: https://github.com/yuxng/tensorflow/,\nI tried several ways to make it work:\nAttempt 1:\n\nuninstalled tensorflow\nplaced the roi_pooling files (roi_pooling_op.cc, roi_pooling_op_gpu.cu.cc, roi_pooling_op_gpu.h, roi_pooling_op_grad.py, roi_pooling_op_test.py) in //tensorflow/core/user_ops/ (without BUILD so that they get incorporated with the install)\nreinstalled tensorflow using bazel with bazel build -c opt --config=cuda ...\n\nI then get this error with attempt 1:\nERROR: /home/fishdrop/tensorflow/tensorflow/cc/BUILD:116:1: Linking of rule '//tensorflow/cc:ops/user_ops_gen_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -o bazel-out/host/bin/tensorflow/cc/ops/user_ops_gen_cc ... (remaining 41 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nbazel-out/host/bin/tensorflow/core/libuser_ops_op_lib.lo(roi_pooling_op.o): In function RoiPoolGradOp<Eigen::GpuDevice, float>::Compute(tensorflow::OpKernelContext*)': roi_pooling_op.cc:(.text._ZN13RoiPoolGradOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE[_ZN13RoiPoolGradOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE]+0x3ea): undefined reference toROIPoolBackwardLaucher(float const_, float, int, int, int, int, int, int, int, float const_, float_, int const_, Eigen::GpuDevice const&)'\nbazel-out/host/bin/tensorflow/core/libuser_ops_op_lib.lo(roi_pooling_op.o): In function RoiPoolOp<Eigen::GpuDevice, float>::Compute(tensorflow::OpKernelContext*)': roi_pooling_op.cc:(.text._ZN9RoiPoolOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE[_ZN9RoiPoolOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE]+0x392): undefined reference toROIPoolForwardLaucher(float const_, float, int, int, int, int, int, int, float const_, float_, int_, Eigen::GpuDevice const&)'\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nERROR: /home/fishdrop/tensorflow/tensorflow/cc/BUILD:116:1 Linking of rule '//tensorflow/cc:ops/user_ops_gen_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -o bazel-out/host/bin/tensorflow/cc/ops/user_ops_gen_cc ... (remaining 41 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nAttempt 2:\n\nre-install tensorflow\nplace files (with BUILD) in //tensorflow/core/user_ops/\nuse bazel build -c opt //tensorflow/core/user_ops:roi_pooling.so\n\nThis successfully built roi_pooling.so, but when I tried to load the module with tf.load_op_library, I get this error:\ntensorflow.python.framework.errors.NotFoundError: /home/fishdrop/tensorflow/bazel-bin/tensorflow/core/user_ops/roi_pooling.so: undefined symbol: _Z21ROIPoolForwardLaucherPKffiiiiiiS0_PfPiRKN5Eigen9GpuDeviceE\nThe error seems to be related with Eigen, but I read in this Link: http://stackoverflow.com/questions/38618960/tensorflow-how-to-insert-custom-input-to-existing-graph, that the user_op is supposed to work..\nI am using Ubuntu 14.04 LTS, and I tried these procedures in both Tensorflow 0.10 and Tensorflow 0.08, and got the same errors.. Anyone who could help?", "body": "I experimented with a user-op for ROI_pooling in this fork: https://github.com/yuxng/tensorflow/, \n\nI tried several ways to make it work:\n\nAttempt 1:\n\n1) uninstalled tensorflow\n2) placed the roi_pooling files (roi_pooling_op.cc, roi_pooling_op_gpu.cu.cc, roi_pooling_op_gpu.h, roi_pooling_op_grad.py, roi_pooling_op_test.py) in //tensorflow/core/user_ops/ (without BUILD so that they get incorporated with the install)\n3) reinstalled tensorflow using bazel with bazel build -c opt --config=cuda ...\n\nI then get this error with attempt 1: \n\nERROR: /home/fishdrop/tensorflow/tensorflow/cc/BUILD:116:1: Linking of rule '//tensorflow/cc:ops/user_ops_gen_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -o bazel-out/host/bin/tensorflow/cc/ops/user_ops_gen_cc ... (remaining 41 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nbazel-out/host/bin/tensorflow/core/libuser_ops_op_lib.lo(roi_pooling_op.o): In function `RoiPoolGradOp<Eigen::GpuDevice, float>::Compute(tensorflow::OpKernelContext*)':\nroi_pooling_op.cc:(.text._ZN13RoiPoolGradOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE[_ZN13RoiPoolGradOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE]+0x3ea): undefined reference to`ROIPoolBackwardLaucher(float const_, float, int, int, int, int, int, int, int, float const_, float_, int const_, Eigen::GpuDevice const&)'\nbazel-out/host/bin/tensorflow/core/libuser_ops_op_lib.lo(roi_pooling_op.o): In function `RoiPoolOp<Eigen::GpuDevice, float>::Compute(tensorflow::OpKernelContext*)':\nroi_pooling_op.cc:(.text._ZN9RoiPoolOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE[_ZN9RoiPoolOpIN5Eigen9GpuDeviceEfE7ComputeEPN10tensorflow15OpKernelContextE]+0x392): undefined reference to`ROIPoolForwardLaucher(float const_, float, int, int, int, int, int, int, float const_, float_, int_, Eigen::GpuDevice const&)'\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nERROR: /home/fishdrop/tensorflow/tensorflow/cc/BUILD:116:1 Linking of rule '//tensorflow/cc:ops/user_ops_gen_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -o bazel-out/host/bin/tensorflow/cc/ops/user_ops_gen_cc ... (remaining 41 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\n\nAttempt 2:\n\n1) re-install tensorflow\n2) place files (with BUILD) in //tensorflow/core/user_ops/\n3) use bazel build -c opt //tensorflow/core/user_ops:roi_pooling.so\n\nThis successfully built roi_pooling.so, but when I tried to load the module with tf.load_op_library, I get this error: \n\ntensorflow.python.framework.errors.NotFoundError: /home/fishdrop/tensorflow/bazel-bin/tensorflow/core/user_ops/roi_pooling.so: undefined symbol: _Z21ROIPoolForwardLaucherPKffiiiiiiS0_PfPiRKN5Eigen9GpuDeviceE\n\nThe error seems to be related with Eigen, but I read in this Link: http://stackoverflow.com/questions/38618960/tensorflow-how-to-insert-custom-input-to-existing-graph, that the user_op is supposed to work.. \n\nI am using Ubuntu 14.04 LTS, and I tried these procedures in both Tensorflow 0.10 and Tensorflow 0.08, and got the same errors.. Anyone who could help?\n"}