{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12557", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12557/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12557/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12557/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12557", "id": 252566579, "node_id": "MDU6SXNzdWUyNTI1NjY1Nzk=", "number": 12557, "title": "`indicator_column` raises a TypeError when `weighted_categorical_column` is used as its input.", "user": {"login": "facaiy", "id": 1112263, "node_id": "MDQ6VXNlcjExMTIyNjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/1112263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/facaiy", "html_url": "https://github.com/facaiy", "followers_url": "https://api.github.com/users/facaiy/followers", "following_url": "https://api.github.com/users/facaiy/following{/other_user}", "gists_url": "https://api.github.com/users/facaiy/gists{/gist_id}", "starred_url": "https://api.github.com/users/facaiy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/facaiy/subscriptions", "organizations_url": "https://api.github.com/users/facaiy/orgs", "repos_url": "https://api.github.com/users/facaiy/repos", "events_url": "https://api.github.com/users/facaiy/events{/privacy}", "received_events_url": "https://api.github.com/users/facaiy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-24T11:05:44Z", "updated_at": "2017-08-25T18:17:53Z", "closed_at": "2017-08-25T18:17:53Z", "author_association": "MEMBER", "body_html": "<h3>Describe the problem</h3>\n<p><code>indicator_column</code> raises a TypeError when <code>weighted_categorical_column</code> is used as its input.</p>\n<p>I have fixed the bug, and the PR is coming later.</p>\n<h3>Source code / logs</h3>\n<div class=\"highlight highlight-source-python\"><pre>    indicator_tensor <span class=\"pl-k\">=</span> _transform_features(features, [indicator])[indicator]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">377</span>, <span class=\"pl-k\">in</span> _transform_features\n    outputs[column] <span class=\"pl-k\">=</span> builder.get(column)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1533</span>, <span class=\"pl-k\">in</span> get\n    transformed <span class=\"pl-k\">=</span> column._transform_feature(<span class=\"pl-c1\">self</span>)  <span class=\"pl-c\"><span class=\"pl-c\">#</span> pylint: disable=protected-access</span>\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">2476</span>, <span class=\"pl-k\">in</span> _transform_feature\n    vocab_size<span class=\"pl-k\">=</span><span class=\"pl-c1\">self</span>._variable_shape[<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>])\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/ops/sparse_ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1140</span>, <span class=\"pl-k\">in</span> sparse_merge\n    <span class=\"pl-c1\">type</span>(vocab_size))\n<span class=\"pl-c1\">TypeError</span>: vocab_size has to be a Tensor <span class=\"pl-k\">or</span> Python <span class=\"pl-c1\">int</span>. Found <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">class</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>tensorflow.python.framework.tensor_shape.Dimension<span class=\"pl-pds\">'</span></span><span class=\"pl-k\">&gt;</span></pre></div>", "body_text": "Describe the problem\nindicator_column raises a TypeError when weighted_categorical_column is used as its input.\nI have fixed the bug, and the PR is coming later.\nSource code / logs\n    indicator_tensor = _transform_features(features, [indicator])[indicator]\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py\", line 377, in _transform_features\n    outputs[column] = builder.get(column)\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py\", line 1533, in get\n    transformed = column._transform_feature(self)  # pylint: disable=protected-access\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py\", line 2476, in _transform_feature\n    vocab_size=self._variable_shape[-1])\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/ops/sparse_ops.py\", line 1140, in sparse_merge\n    type(vocab_size))\nTypeError: vocab_size has to be a Tensor or Python int. Found <class 'tensorflow.python.framework.tensor_shape.Dimension'>", "body": "### Describe the problem\r\n\r\n`indicator_column` raises a TypeError when `weighted_categorical_column` is used as its input.\r\n\r\nI have fixed the bug, and the PR is coming later.\r\n\r\n\r\n### Source code / logs\r\n\r\n```python\r\n    indicator_tensor = _transform_features(features, [indicator])[indicator]\r\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py\", line 377, in _transform_features\r\n    outputs[column] = builder.get(column)\r\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py\", line 1533, in get\r\n    transformed = column._transform_feature(self)  # pylint: disable=protected-access\r\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/feature_column/feature_column.py\", line 2476, in _transform_feature\r\n    vocab_size=self._variable_shape[-1])\r\n  File \"/data1/users/facai/.cache/bazel/_bazel_facai/3338df3cdc4fd0e5fdd3f3ae6490e0be/execroot/tensorflow/bazel-out/local-opt/bin/tensorflow/python/feature_column/feature_column_test.runfiles/org_tensorflow/tensorflow/python/ops/sparse_ops.py\", line 1140, in sparse_merge\r\n    type(vocab_size))\r\nTypeError: vocab_size has to be a Tensor or Python int. Found <class 'tensorflow.python.framework.tensor_shape.Dimension'>\r\n```\r\n"}