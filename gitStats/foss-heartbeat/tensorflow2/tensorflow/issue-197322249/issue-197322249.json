{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6469", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6469/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6469/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6469/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6469", "id": 197322249, "node_id": "MDU6SXNzdWUxOTczMjIyNDk=", "number": 6469, "title": "ptb_rnn_lm.py error:tensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420] ", "user": {"login": "sharod", "id": 3380293, "node_id": "MDQ6VXNlcjMzODAyOTM=", "avatar_url": "https://avatars0.githubusercontent.com/u/3380293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sharod", "html_url": "https://github.com/sharod", "followers_url": "https://api.github.com/users/sharod/followers", "following_url": "https://api.github.com/users/sharod/following{/other_user}", "gists_url": "https://api.github.com/users/sharod/gists{/gist_id}", "starred_url": "https://api.github.com/users/sharod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sharod/subscriptions", "organizations_url": "https://api.github.com/users/sharod/orgs", "repos_url": "https://api.github.com/users/sharod/repos", "events_url": "https://api.github.com/users/sharod/events{/privacy}", "received_events_url": "https://api.github.com/users/sharod/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2016-12-23T07:00:10Z", "updated_at": "2017-02-17T10:07:46Z", "closed_at": "2017-01-05T19:13:34Z", "author_association": "NONE", "body_html": "<p>Getting the error:<br>\ntensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]</p>\n<p>The code is available here:<br>\n<a href=\"http://pastebin.com/FM6M43w7\" rel=\"nofollow\">http://pastebin.com/FM6M43w7</a></p>\n<p>I am giving the full error log here:</p>\n<p>Traceback (most recent call last):<br>\nFile \"ptb_word_lm.py\", line 364, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run<br>\nsys.exit(main(sys.argv[:1] + flags_passthrough))<br>\nFile \"ptb_word_lm.py\", line 350, in main<br>\nverbose=True)<br>\nFile \"ptb_word_lm.py\", line 279, in run_epoch<br>\nvals = session.run(fetches, feed_dict)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 717, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 915, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 985, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]<br>\n[[Node: Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits = SparseSoftmaxCrossEntropyWithLogits[T=DT_FLOAT, Tlabels=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](Train/Model/add, Train/Model/sequence_loss_by_example/Reshape/_129)]]<br>\n[[Node: Train/Model/truediv/_153 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_1023_Train/Model/truediv\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]</p>\n<p>Caused by op u'Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits', defined at:<br>\nFile \"ptb_word_lm.py\", line 364, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run<br>\nsys.exit(main(sys.argv[:1] + flags_passthrough))<br>\nFile \"ptb_word_lm.py\", line 326, in main<br>\nm = PTBModel(is_training=True, config=config, input_=train_input)<br>\nFile \"ptb_word_lm.py\", line 147, in <strong>init</strong><br>\n[tf.ones([batch_size * num_steps], dtype=data_type())])<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/seq2seq.py\", line 1017, in sequence_loss_by_example<br>\nlogit, target)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 764, in sparse_softmax_cross_entropy_with_logits<br>\nprecise_logits, labels, name=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1857, in _sparse_softmax_cross_entropy_with_logits<br>\nfeatures=features, labels=labels, name=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1298, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]<br>\n[[Node: Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits = SparseSoftmaxCrossEntropyWithLogits[T=DT_FLOAT, Tlabels=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](Train/Model/add, Train/Model/sequence_loss_by_example/Reshape/_129)]]<br>\n[[Node: Train/Model/truediv/_153 = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_1023_Train/Model/truediv\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]</p>", "body_text": "Getting the error:\ntensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]\nThe code is available here:\nhttp://pastebin.com/FM6M43w7\nI am giving the full error log here:\nTraceback (most recent call last):\nFile \"ptb_word_lm.py\", line 364, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\nsys.exit(main(sys.argv[:1] + flags_passthrough))\nFile \"ptb_word_lm.py\", line 350, in main\nverbose=True)\nFile \"ptb_word_lm.py\", line 279, in run_epoch\nvals = session.run(fetches, feed_dict)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 717, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 915, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _do_run\ntarget_list, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 985, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]\n[[Node: Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits = SparseSoftmaxCrossEntropyWithLogits[T=DT_FLOAT, Tlabels=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](Train/Model/add, Train/Model/sequence_loss_by_example/Reshape/_129)]]\n[[Node: Train/Model/truediv/_153 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_1023_Train/Model/truediv\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nCaused by op u'Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits', defined at:\nFile \"ptb_word_lm.py\", line 364, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\nsys.exit(main(sys.argv[:1] + flags_passthrough))\nFile \"ptb_word_lm.py\", line 326, in main\nm = PTBModel(is_training=True, config=config, input_=train_input)\nFile \"ptb_word_lm.py\", line 147, in init\n[tf.ones([batch_size * num_steps], dtype=data_type())])\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/seq2seq.py\", line 1017, in sequence_loss_by_example\nlogit, target)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 764, in sparse_softmax_cross_entropy_with_logits\nprecise_logits, labels, name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1857, in _sparse_softmax_cross_entropy_with_logits\nfeatures=features, labels=labels, name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\nop_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1298, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]\n[[Node: Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits = SparseSoftmaxCrossEntropyWithLogits[T=DT_FLOAT, Tlabels=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](Train/Model/add, Train/Model/sequence_loss_by_example/Reshape/_129)]]\n[[Node: Train/Model/truediv/_153 = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_1023_Train/Model/truediv\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]", "body": "Getting the error:\r\ntensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]\r\n\r\nThe code is available here:\r\n[http://pastebin.com/FM6M43w7](http://pastebin.com/FM6M43w7)\r\n\r\nI am giving the full error log here:\r\n\r\nTraceback (most recent call last):\r\n  File \"ptb_word_lm.py\", line 364, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"ptb_word_lm.py\", line 350, in main\r\n    verbose=True)\r\n  File \"ptb_word_lm.py\", line 279, in run_epoch\r\n    vals = session.run(fetches, feed_dict)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 717, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 915, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 965, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 985, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors.InvalidArgumentError: logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]\r\n\t [[Node: Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits = SparseSoftmaxCrossEntropyWithLogits[T=DT_FLOAT, Tlabels=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](Train/Model/add, Train/Model/sequence_loss_by_example/Reshape/_129)]]\r\n\t [[Node: Train/Model/truediv/_153 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_1023_Train/Model/truediv\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\nCaused by op u'Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits', defined at:\r\n  File \"ptb_word_lm.py\", line 364, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\r\n    sys.exit(main(sys.argv[:1] + flags_passthrough))\r\n  File \"ptb_word_lm.py\", line 326, in main\r\n    m = PTBModel(is_training=True, config=config, input_=train_input)\r\n  File \"ptb_word_lm.py\", line 147, in __init__\r\n    [tf.ones([batch_size * num_steps], dtype=data_type())])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/seq2seq.py\", line 1017, in sequence_loss_by_example\r\n    logit, target)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_ops.py\", line 764, in sparse_softmax_cross_entropy_with_logits\r\n    precise_logits, labels, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1857, in _sparse_softmax_cross_entropy_with_logits\r\n    features=features, labels=labels, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1298, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): logits and labels must have the same first dimension, got logits shape [400,10000] and labels shape [420]\r\n\t [[Node: Train/Model/sequence_loss_by_example/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits = SparseSoftmaxCrossEntropyWithLogits[T=DT_FLOAT, Tlabels=DT_INT32, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](Train/Model/add, Train/Model/sequence_loss_by_example/Reshape/_129)]]\r\n\t [[Node: Train/Model/truediv/_153 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/gpu:0\", send_device_incarnation=1, tensor_name=\"edge_1023_Train/Model/truediv\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/cpu:0\"]()]]\r\n\r\n\r\n"}