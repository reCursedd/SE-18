{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/696", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/696/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/696/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/696/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/696", "id": 125021662, "node_id": "MDU6SXNzdWUxMjUwMjE2NjI=", "number": 696, "title": "Serialize GraphKeys into GraphDef", "user": {"login": "jimfleming", "id": 226553, "node_id": "MDQ6VXNlcjIyNjU1Mw==", "avatar_url": "https://avatars3.githubusercontent.com/u/226553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimfleming", "html_url": "https://github.com/jimfleming", "followers_url": "https://api.github.com/users/jimfleming/followers", "following_url": "https://api.github.com/users/jimfleming/following{/other_user}", "gists_url": "https://api.github.com/users/jimfleming/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimfleming/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimfleming/subscriptions", "organizations_url": "https://api.github.com/users/jimfleming/orgs", "repos_url": "https://api.github.com/users/jimfleming/repos", "events_url": "https://api.github.com/users/jimfleming/events{/privacy}", "received_events_url": "https://api.github.com/users/jimfleming/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "sherrym", "id": 12770037, "node_id": "MDQ6VXNlcjEyNzcwMDM3", "avatar_url": "https://avatars0.githubusercontent.com/u/12770037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sherrym", "html_url": "https://github.com/sherrym", "followers_url": "https://api.github.com/users/sherrym/followers", "following_url": "https://api.github.com/users/sherrym/following{/other_user}", "gists_url": "https://api.github.com/users/sherrym/gists{/gist_id}", "starred_url": "https://api.github.com/users/sherrym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sherrym/subscriptions", "organizations_url": "https://api.github.com/users/sherrym/orgs", "repos_url": "https://api.github.com/users/sherrym/repos", "events_url": "https://api.github.com/users/sherrym/events{/privacy}", "received_events_url": "https://api.github.com/users/sherrym/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sherrym", "id": 12770037, "node_id": "MDQ6VXNlcjEyNzcwMDM3", "avatar_url": "https://avatars0.githubusercontent.com/u/12770037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sherrym", "html_url": "https://github.com/sherrym", "followers_url": "https://api.github.com/users/sherrym/followers", "following_url": "https://api.github.com/users/sherrym/following{/other_user}", "gists_url": "https://api.github.com/users/sherrym/gists{/gist_id}", "starred_url": "https://api.github.com/users/sherrym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sherrym/subscriptions", "organizations_url": "https://api.github.com/users/sherrym/orgs", "repos_url": "https://api.github.com/users/sherrym/repos", "events_url": "https://api.github.com/users/sherrym/events{/privacy}", "received_events_url": "https://api.github.com/users/sherrym/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2016-01-05T18:16:30Z", "updated_at": "2017-02-09T22:37:39Z", "closed_at": "2016-04-05T21:14:27Z", "author_association": "CONTRIBUTOR", "body_html": "<p>As I understand it, <code>GraphKeys.VARIABLES</code> and <code>GraphKeys.TRAINABLE_VARIABLES</code> (and other collections) are not serialized with the GraphDef. This means that in order to train a model that had previously been serialized we must recreate all of the variables (simply reifying a <code>GraphDef</code> doesn't perform the same init.)</p>\n<p>There seem to be two solutions here:</p>\n<ol>\n<li>To serialize these keys into their respective types on <code>GraphDef</code> so we can add the variables to their appropriate collections inside <code>import_graph_def</code>. (Seems easy enough?)</li>\n<li>To recreate the variables the same way, they're created with <code>tf.Variable</code> when calling <code>import_graph_def</code>. (Seems harder, maybe cleaner?)</li>\n</ol>\n<p>This is apparently on the roadmap per <a href=\"http://stackoverflow.com/a/33763208/307401\" rel=\"nofollow\">http://stackoverflow.com/a/33763208/307401</a> but I'd be happy to contribute a fix if someone can point me in the right direction.</p>\n<p>(The goal is to be able to train something I've previously serialized.)</p>\n<p>EDIT: This should also improve restoring <code>GraphDef</code> with <code>Saver</code> which is cumbersome.</p>", "body_text": "As I understand it, GraphKeys.VARIABLES and GraphKeys.TRAINABLE_VARIABLES (and other collections) are not serialized with the GraphDef. This means that in order to train a model that had previously been serialized we must recreate all of the variables (simply reifying a GraphDef doesn't perform the same init.)\nThere seem to be two solutions here:\n\nTo serialize these keys into their respective types on GraphDef so we can add the variables to their appropriate collections inside import_graph_def. (Seems easy enough?)\nTo recreate the variables the same way, they're created with tf.Variable when calling import_graph_def. (Seems harder, maybe cleaner?)\n\nThis is apparently on the roadmap per http://stackoverflow.com/a/33763208/307401 but I'd be happy to contribute a fix if someone can point me in the right direction.\n(The goal is to be able to train something I've previously serialized.)\nEDIT: This should also improve restoring GraphDef with Saver which is cumbersome.", "body": "As I understand it, `GraphKeys.VARIABLES` and `GraphKeys.TRAINABLE_VARIABLES` (and other collections) are not serialized with the GraphDef. This means that in order to train a model that had previously been serialized we must recreate all of the variables (simply reifying a `GraphDef` doesn't perform the same init.)\n\nThere seem to be two solutions here:\n1. To serialize these keys into their respective types on `GraphDef` so we can add the variables to their appropriate collections inside `import_graph_def`. (Seems easy enough?)\n2. To recreate the variables the same way, they're created with `tf.Variable` when calling `import_graph_def`. (Seems harder, maybe cleaner?)\n\nThis is apparently on the roadmap per http://stackoverflow.com/a/33763208/307401 but I'd be happy to contribute a fix if someone can point me in the right direction.\n\n(The goal is to be able to train something I've previously serialized.)\n\nEDIT: This should also improve restoring `GraphDef` with `Saver` which is cumbersome.\n"}