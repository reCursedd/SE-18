{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10142", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10142/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10142/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10142/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10142", "id": 230811217, "node_id": "MDU6SXNzdWUyMzA4MTEyMTc=", "number": 10142, "title": "tf.nn.softmax overflow due to exp(x)", "user": {"login": "weiliu620", "id": 6721243, "node_id": "MDQ6VXNlcjY3MjEyNDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6721243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiliu620", "html_url": "https://github.com/weiliu620", "followers_url": "https://api.github.com/users/weiliu620/followers", "following_url": "https://api.github.com/users/weiliu620/following{/other_user}", "gists_url": "https://api.github.com/users/weiliu620/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiliu620/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiliu620/subscriptions", "organizations_url": "https://api.github.com/users/weiliu620/orgs", "repos_url": "https://api.github.com/users/weiliu620/repos", "events_url": "https://api.github.com/users/weiliu620/events{/privacy}", "received_events_url": "https://api.github.com/users/weiliu620/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-05-23T19:03:12Z", "updated_at": "2018-03-05T11:56:48Z", "closed_at": "2017-09-15T12:45:23Z", "author_association": "NONE", "body_html": "<p>From reading the doc and code of <code>tf.nn.softmax</code>, it looks like this function naively call a <code>_softmax</code> function which may have the overflow problem if the x in exp(x) is too big. (underflow can happen, too)</p>\n<p>This is a typical problem of machine learning, and googling 'log sum exp' gives some information. TF even has a function <code>reduce_logsumexp</code> to calculate the value in a robust way.</p>\n<p>I think it makes sense that <code>nn.softmax</code> also use similar method of <code>reduce_logsumexp</code>. I ran into a loss  = NaN today and suspect this is the cause.</p>\n<p>Thanks,</p>", "body_text": "From reading the doc and code of tf.nn.softmax, it looks like this function naively call a _softmax function which may have the overflow problem if the x in exp(x) is too big. (underflow can happen, too)\nThis is a typical problem of machine learning, and googling 'log sum exp' gives some information. TF even has a function reduce_logsumexp to calculate the value in a robust way.\nI think it makes sense that nn.softmax also use similar method of reduce_logsumexp. I ran into a loss  = NaN today and suspect this is the cause.\nThanks,", "body": "From reading the doc and code of ```tf.nn.softmax```, it looks like this function naively call a ```_softmax``` function which may have the overflow problem if the x in exp(x) is too big. (underflow can happen, too)\r\n\r\nThis is a typical problem of machine learning, and googling 'log sum exp' gives some information. TF even has a function ```reduce_logsumexp``` to calculate the value in a robust way. \r\n\r\nI think it makes sense that ```nn.softmax``` also use similar method of ```reduce_logsumexp```. I ran into a loss  = NaN today and suspect this is the cause. \r\n\r\nThanks,\r\n"}