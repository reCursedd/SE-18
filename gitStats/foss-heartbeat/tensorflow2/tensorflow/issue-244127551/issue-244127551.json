{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11619", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11619/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11619/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11619/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11619", "id": 244127551, "node_id": "MDU6SXNzdWUyNDQxMjc1NTE=", "number": 11619, "title": "Feature request: tensordot GPU kernel", "user": {"login": "tklos96", "id": 24199059, "node_id": "MDQ6VXNlcjI0MTk5MDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/24199059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tklos96", "html_url": "https://github.com/tklos96", "followers_url": "https://api.github.com/users/tklos96/followers", "following_url": "https://api.github.com/users/tklos96/following{/other_user}", "gists_url": "https://api.github.com/users/tklos96/gists{/gist_id}", "starred_url": "https://api.github.com/users/tklos96/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tklos96/subscriptions", "organizations_url": "https://api.github.com/users/tklos96/orgs", "repos_url": "https://api.github.com/users/tklos96/repos", "events_url": "https://api.github.com/users/tklos96/events{/privacy}", "received_events_url": "https://api.github.com/users/tklos96/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-07-19T18:11:30Z", "updated_at": "2017-07-20T20:26:25Z", "closed_at": "2017-07-20T20:26:17Z", "author_association": "NONE", "body_html": "<p>Hi,</p>\n<p>I have two placeholder tensors with some matching axes that I would like to multiply element-wise and sum across. Implementation with tf.tensordot works perfectly on cpu, but it looks like there is no gpu kernel available for this op. Would it be possible to have one added? Or is there a workaround using simpler operations such as multiply and reduce_sum that are currently gpu-supported?</p>\n<p>Specifically I would like to be able to run something equivalent to the following on gpu:<br>\n<code>a=tf.placeholder(shape=[None,16,17,18]) #e.g.</code><br>\n<code>b=tf.placeholder(shape=[5,17,18,20]) </code><br>\n<code>c=tf.tensordot(a,b,axes=[[2,3],[1,2]])</code><br>\n<code>#shape of c: [None,16,5,20]</code></p>\n<p>When I run c in a session using tf.device('/gpu:0') I get the following error:<br>\n<code>InvalidArgumentError (see above for traceback): Cannot assign a device for operation 'Tensordot/ListDiff': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. [[Node: Tensordot/ListDiff = ListDiff[T=DT_INT32, out_idx=DT_INT32, _device=\"/device:GPU:0\"](Tensordot/range, Tensordot/add_1)]]</code></p>", "body_text": "Hi,\nI have two placeholder tensors with some matching axes that I would like to multiply element-wise and sum across. Implementation with tf.tensordot works perfectly on cpu, but it looks like there is no gpu kernel available for this op. Would it be possible to have one added? Or is there a workaround using simpler operations such as multiply and reduce_sum that are currently gpu-supported?\nSpecifically I would like to be able to run something equivalent to the following on gpu:\na=tf.placeholder(shape=[None,16,17,18]) #e.g.\nb=tf.placeholder(shape=[5,17,18,20]) \nc=tf.tensordot(a,b,axes=[[2,3],[1,2]])\n#shape of c: [None,16,5,20]\nWhen I run c in a session using tf.device('/gpu:0') I get the following error:\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation 'Tensordot/ListDiff': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available. [[Node: Tensordot/ListDiff = ListDiff[T=DT_INT32, out_idx=DT_INT32, _device=\"/device:GPU:0\"](Tensordot/range, Tensordot/add_1)]]", "body": "Hi,\r\n\r\nI have two placeholder tensors with some matching axes that I would like to multiply element-wise and sum across. Implementation with tf.tensordot works perfectly on cpu, but it looks like there is no gpu kernel available for this op. Would it be possible to have one added? Or is there a workaround using simpler operations such as multiply and reduce_sum that are currently gpu-supported?\r\n\r\nSpecifically I would like to be able to run something equivalent to the following on gpu:\r\n`a=tf.placeholder(shape=[None,16,17,18]) #e.g.`\r\n`b=tf.placeholder(shape=[5,17,18,20]) `\r\n`c=tf.tensordot(a,b,axes=[[2,3],[1,2]])`\r\n`#shape of c: [None,16,5,20]`\r\n\r\nWhen I run c in a session using tf.device('/gpu:0') I get the following error:\r\n`InvalidArgumentError (see above for traceback): Cannot assign a device for operation 'Tensordot/ListDiff': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\n\t [[Node: Tensordot/ListDiff = ListDiff[T=DT_INT32, out_idx=DT_INT32, _device=\"/device:GPU:0\"](Tensordot/range, Tensordot/add_1)]]`\r\n"}