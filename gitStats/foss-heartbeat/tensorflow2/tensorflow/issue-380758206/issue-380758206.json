{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23746", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23746/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23746/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23746/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23746", "id": 380758206, "node_id": "MDU6SXNzdWUzODA3NTgyMDY=", "number": 23746, "title": "\"Invalid loop structure\" for Cleverhans saliency map attack on Keras model with Dropout layers", "user": {"login": "AndrewFerr", "id": 3271094, "node_id": "MDQ6VXNlcjMyNzEwOTQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/3271094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AndrewFerr", "html_url": "https://github.com/AndrewFerr", "followers_url": "https://api.github.com/users/AndrewFerr/followers", "following_url": "https://api.github.com/users/AndrewFerr/following{/other_user}", "gists_url": "https://api.github.com/users/AndrewFerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/AndrewFerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AndrewFerr/subscriptions", "organizations_url": "https://api.github.com/users/AndrewFerr/orgs", "repos_url": "https://api.github.com/users/AndrewFerr/repos", "events_url": "https://api.github.com/users/AndrewFerr/events{/privacy}", "received_events_url": "https://api.github.com/users/AndrewFerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-11-14T15:43:28Z", "updated_at": "2018-11-15T01:38:08Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><strong>System information</strong></p>\n<ul>\n<li>Have I written custom code: Yes</li>\n<li>OS Platform and Distribution: Fedora 29</li>\n<li>TensorFlow installed from: source</li>\n<li>TensorFlow version: v1.11.0-0-gc19e29306c</li>\n<li>Python version: 3.6.6</li>\n<li>Bazel version: 0.19.1- (@non-git)</li>\n<li>GCC/Compiler version: 7.3.0</li>\n<li>CUDA/cuDNN version: 9.2</li>\n<li>GPU model and memory: GeForce GTX 1050 3.95GiB</li>\n</ul>\n<p><strong>Describe the current behavior</strong></p>\n<ul>\n<li>Prepared &amp; trained a Keras Sequential model based on <a href=\"https://github.com/keras-team/keras/blob/master/examples/cifar10_cnn.py\">this example script</a>, which contains Dropout layers</li>\n<li>Passed the trained model to a <a href=\"https://github.com/tensorflow/cleverhans/blob/master/cleverhans_tutorials/mnist_tutorial_keras_tf.py\">KerasModelWrapper</a>, a class provided by the <a href=\"https://github.com/tensorflow/cleverhans\">Cleverhans</a> library</li>\n<li>Instantiated a <a href=\"https://github.com/tensorflow/cleverhans/blob/master/cleverhans_tutorials/mnist_tutorial_jsma.py\">SaliencyMapMethod</a> attack object on the wrapped model, and attempted to craft an adversarial example with it</li>\n<li>TensorFlow encounters this error:</li>\n</ul>\n<pre><code>tensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while_1/while_context\": \"while_1/while_context\" vs \"\". The node giving this error: {{node while_1/gradients/while_1/model_4/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\n</code></pre>\n<ul>\n<li>Removing the Dropout layers from the Keras model prevents this error from occuring.</li>\n</ul>\n<p><strong>Describe the expected behavior</strong><br>\nWant the <code>generate_np</code> method of the SaliencyMapMethod object to return an adversarial example for the wrapped Keras model.</p>\n<p><strong>Code to reproduce the issue</strong></p>\n<pre><code>import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Activation, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.activations import relu, softmax\n\nimport cleverhans\nfrom cleverhans.attacks import SaliencyMapMethod\nfrom cleverhans.utils_keras import KerasModelWrapper\n\nimport numpy as np\n\ndataset = keras.datasets.cifar10\nnum_classes = 10\n\n(train_images, train_labels), (test_images, test_labels) = dataset.load_data()\ninput_shape = train_images.shape[1:]\n\ntrain_images = train_images.astype('float32') / 255.0\ntest_images  = test_images.astype('float32') / 255.0\n\ntrain_labels = keras.utils.to_categorical(train_labels, num_classes)\ntest_labels  = keras.utils.to_categorical(test_labels, num_classes)\n\nmodel = Sequential([\n    Conv2D(32, (3,3), padding='same', input_shape=input_shape, activation=relu),\n    Conv2D(32, (3,3), activation=relu),\n    MaxPooling2D(pool_size=(2,2)),\n    Dropout(0.25),\n\n    Conv2D(64, (3,3), padding='same', activation=relu),\n    Conv2D(64, (3,3), activation=relu),\n    MaxPooling2D(pool_size=(2, 2)),\n    Dropout(0.25),\n\n    Flatten(),\n    Dense(512, activation=relu),\n    Dropout(0.5),\n    Dense(num_classes, activation=softmax)\n])\n\nmodel.compile(optimizer=keras.optimizers.SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True),\n              loss=keras.losses.categorical_crossentropy,\n              metrics=[keras.metrics.categorical_accuracy])\n\nmodel.fit(train_images, train_labels)\n\njsma = SaliencyMapMethod(KerasModelWrapper(model), keras.backend.get_session())\njsma_params = {'theta': 1., 'gamma': 0.1,\n               'clip_min': 0., 'clip_max': 1.,\n               'y_target': None}\n\n# Generate adversarial examples for first test sample\nsample_ind = 0\nsamples = test_images[sample_ind:(sample_ind + 1)]\ncurrent_class = int(np.argmax(test_labels[sample_ind]))\nfor target in cleverhans.utils.other_classes(num_classes, current_class):\n    one_hot_target = np.zeros((1, num_classes), dtype=np.float32)\n    one_hot_target[0, target] = 1\n    jsma_params['y_target'] = one_hot_target\n    # Error happens here\n    adversarial_images = jsma.generate_np(samples, **jsma_params)\n    break\n</code></pre>\n<p><strong>Other info / logs</strong></p>\n<ul>\n<li>Keras version: 2.2.4 (from pip)</li>\n<li>Cleverhans version: 2.0.0-fe079e17fb307c71a4a413d8bd408d98 (from source, commit <a href=\"https://github.com/tensorflow/cleverhans/commit/0b22b1c523cd06efd93d3999c5118986819ac98e\">0b22b1c</a>)</li>\n<li>Full traceback of the error when running the above code:</li>\n</ul>\n<pre><code>Traceback (most recent call last):\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1292, in _do_call\n    return fn(*args)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1277, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1367, in _call_tf_sessionrun\n    run_metadata)\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while/while_context\": \"while/while_context\" vs \"\". The node giving this error: {{node while/gradients/while/model_1/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"crash.py\", line 62, in &lt;module&gt;\n    adversarial_images = jsma.generate_np(samples, **jsma_params)\n  File \"~/cleverhans/cleverhans/attacks.py\", line 203, in generate_np\n    return self.sess.run(x_adv, feed_dict)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 887, in run\n    run_metadata_ptr)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\n    run_metadata)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while/while_context\": \"while/while_context\" vs \"\". The node giving this error: {{node while/gradients/while/model_1/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\n</code></pre>", "body_text": "System information\n\nHave I written custom code: Yes\nOS Platform and Distribution: Fedora 29\nTensorFlow installed from: source\nTensorFlow version: v1.11.0-0-gc19e29306c\nPython version: 3.6.6\nBazel version: 0.19.1- (@non-git)\nGCC/Compiler version: 7.3.0\nCUDA/cuDNN version: 9.2\nGPU model and memory: GeForce GTX 1050 3.95GiB\n\nDescribe the current behavior\n\nPrepared & trained a Keras Sequential model based on this example script, which contains Dropout layers\nPassed the trained model to a KerasModelWrapper, a class provided by the Cleverhans library\nInstantiated a SaliencyMapMethod attack object on the wrapped model, and attempted to craft an adversarial example with it\nTensorFlow encounters this error:\n\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while_1/while_context\": \"while_1/while_context\" vs \"\". The node giving this error: {{node while_1/gradients/while_1/model_4/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\n\n\nRemoving the Dropout layers from the Keras model prevents this error from occuring.\n\nDescribe the expected behavior\nWant the generate_np method of the SaliencyMapMethod object to return an adversarial example for the wrapped Keras model.\nCode to reproduce the issue\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Activation, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.activations import relu, softmax\n\nimport cleverhans\nfrom cleverhans.attacks import SaliencyMapMethod\nfrom cleverhans.utils_keras import KerasModelWrapper\n\nimport numpy as np\n\ndataset = keras.datasets.cifar10\nnum_classes = 10\n\n(train_images, train_labels), (test_images, test_labels) = dataset.load_data()\ninput_shape = train_images.shape[1:]\n\ntrain_images = train_images.astype('float32') / 255.0\ntest_images  = test_images.astype('float32') / 255.0\n\ntrain_labels = keras.utils.to_categorical(train_labels, num_classes)\ntest_labels  = keras.utils.to_categorical(test_labels, num_classes)\n\nmodel = Sequential([\n    Conv2D(32, (3,3), padding='same', input_shape=input_shape, activation=relu),\n    Conv2D(32, (3,3), activation=relu),\n    MaxPooling2D(pool_size=(2,2)),\n    Dropout(0.25),\n\n    Conv2D(64, (3,3), padding='same', activation=relu),\n    Conv2D(64, (3,3), activation=relu),\n    MaxPooling2D(pool_size=(2, 2)),\n    Dropout(0.25),\n\n    Flatten(),\n    Dense(512, activation=relu),\n    Dropout(0.5),\n    Dense(num_classes, activation=softmax)\n])\n\nmodel.compile(optimizer=keras.optimizers.SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True),\n              loss=keras.losses.categorical_crossentropy,\n              metrics=[keras.metrics.categorical_accuracy])\n\nmodel.fit(train_images, train_labels)\n\njsma = SaliencyMapMethod(KerasModelWrapper(model), keras.backend.get_session())\njsma_params = {'theta': 1., 'gamma': 0.1,\n               'clip_min': 0., 'clip_max': 1.,\n               'y_target': None}\n\n# Generate adversarial examples for first test sample\nsample_ind = 0\nsamples = test_images[sample_ind:(sample_ind + 1)]\ncurrent_class = int(np.argmax(test_labels[sample_ind]))\nfor target in cleverhans.utils.other_classes(num_classes, current_class):\n    one_hot_target = np.zeros((1, num_classes), dtype=np.float32)\n    one_hot_target[0, target] = 1\n    jsma_params['y_target'] = one_hot_target\n    # Error happens here\n    adversarial_images = jsma.generate_np(samples, **jsma_params)\n    break\n\nOther info / logs\n\nKeras version: 2.2.4 (from pip)\nCleverhans version: 2.0.0-fe079e17fb307c71a4a413d8bd408d98 (from source, commit 0b22b1c)\nFull traceback of the error when running the above code:\n\nTraceback (most recent call last):\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1292, in _do_call\n    return fn(*args)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1277, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1367, in _call_tf_sessionrun\n    run_metadata)\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while/while_context\": \"while/while_context\" vs \"\". The node giving this error: {{node while/gradients/while/model_1/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"crash.py\", line 62, in <module>\n    adversarial_images = jsma.generate_np(samples, **jsma_params)\n  File \"~/cleverhans/cleverhans/attacks.py\", line 203, in generate_np\n    return self.sess.run(x_adv, feed_dict)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 887, in run\n    run_metadata_ptr)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\n    run_metadata)\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while/while_context\": \"while/while_context\" vs \"\". The node giving this error: {{node while/gradients/while/model_1/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: Fedora 29\r\n- TensorFlow installed from: source\r\n- TensorFlow version: v1.11.0-0-gc19e29306c\r\n- Python version: 3.6.6\r\n- Bazel version: 0.19.1- (@non-git)\r\n- GCC/Compiler version: 7.3.0\r\n- CUDA/cuDNN version: 9.2\r\n- GPU model and memory: GeForce GTX 1050 3.95GiB\r\n\r\n**Describe the current behavior**\r\n- Prepared & trained a Keras Sequential model based on [this example script](https://github.com/keras-team/keras/blob/master/examples/cifar10_cnn.py), which contains Dropout layers\r\n- Passed the trained model to a [KerasModelWrapper](https://github.com/tensorflow/cleverhans/blob/master/cleverhans_tutorials/mnist_tutorial_keras_tf.py), a class provided by the [Cleverhans](https://github.com/tensorflow/cleverhans) library\r\n- Instantiated a [SaliencyMapMethod](https://github.com/tensorflow/cleverhans/blob/master/cleverhans_tutorials/mnist_tutorial_jsma.py) attack object on the wrapped model, and attempted to craft an adversarial example with it\r\n- TensorFlow encounters this error:\r\n```\r\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while_1/while_context\": \"while_1/while_context\" vs \"\". The node giving this error: {{node while_1/gradients/while_1/model_4/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\r\n```\r\n- Removing the Dropout layers from the Keras model prevents this error from occuring.\r\n\r\n**Describe the expected behavior**\r\nWant the `generate_np` method of the SaliencyMapMethod object to return an adversarial example for the wrapped Keras model.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport keras\r\nfrom keras.models import Sequential\r\nfrom keras.layers import Dense, Dropout, Activation, Flatten\r\nfrom keras.layers import Conv2D, MaxPooling2D\r\nfrom keras.activations import relu, softmax\r\n\r\nimport cleverhans\r\nfrom cleverhans.attacks import SaliencyMapMethod\r\nfrom cleverhans.utils_keras import KerasModelWrapper\r\n\r\nimport numpy as np\r\n\r\ndataset = keras.datasets.cifar10\r\nnum_classes = 10\r\n\r\n(train_images, train_labels), (test_images, test_labels) = dataset.load_data()\r\ninput_shape = train_images.shape[1:]\r\n\r\ntrain_images = train_images.astype('float32') / 255.0\r\ntest_images  = test_images.astype('float32') / 255.0\r\n\r\ntrain_labels = keras.utils.to_categorical(train_labels, num_classes)\r\ntest_labels  = keras.utils.to_categorical(test_labels, num_classes)\r\n\r\nmodel = Sequential([\r\n    Conv2D(32, (3,3), padding='same', input_shape=input_shape, activation=relu),\r\n    Conv2D(32, (3,3), activation=relu),\r\n    MaxPooling2D(pool_size=(2,2)),\r\n    Dropout(0.25),\r\n\r\n    Conv2D(64, (3,3), padding='same', activation=relu),\r\n    Conv2D(64, (3,3), activation=relu),\r\n    MaxPooling2D(pool_size=(2, 2)),\r\n    Dropout(0.25),\r\n\r\n    Flatten(),\r\n    Dense(512, activation=relu),\r\n    Dropout(0.5),\r\n    Dense(num_classes, activation=softmax)\r\n])\r\n\r\nmodel.compile(optimizer=keras.optimizers.SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True),\r\n              loss=keras.losses.categorical_crossentropy,\r\n              metrics=[keras.metrics.categorical_accuracy])\r\n\r\nmodel.fit(train_images, train_labels)\r\n\r\njsma = SaliencyMapMethod(KerasModelWrapper(model), keras.backend.get_session())\r\njsma_params = {'theta': 1., 'gamma': 0.1,\r\n               'clip_min': 0., 'clip_max': 1.,\r\n               'y_target': None}\r\n\r\n# Generate adversarial examples for first test sample\r\nsample_ind = 0\r\nsamples = test_images[sample_ind:(sample_ind + 1)]\r\ncurrent_class = int(np.argmax(test_labels[sample_ind]))\r\nfor target in cleverhans.utils.other_classes(num_classes, current_class):\r\n    one_hot_target = np.zeros((1, num_classes), dtype=np.float32)\r\n    one_hot_target[0, target] = 1\r\n    jsma_params['y_target'] = one_hot_target\r\n    # Error happens here\r\n    adversarial_images = jsma.generate_np(samples, **jsma_params)\r\n    break\r\n```\r\n\r\n**Other info / logs**\r\n- Keras version: 2.2.4 (from pip)\r\n- Cleverhans version: 2.0.0-fe079e17fb307c71a4a413d8bd408d98 (from source, commit [0b22b1c](https://github.com/tensorflow/cleverhans/commit/0b22b1c523cd06efd93d3999c5118986819ac98e))\r\n- Full traceback of the error when running the above code:\r\n```\r\nTraceback (most recent call last):\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1292, in _do_call\r\n    return fn(*args)\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1277, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1367, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while/while_context\": \"while/while_context\" vs \"\". The node giving this error: {{node while/gradients/while/model_1/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"crash.py\", line 62, in <module>\r\n    adversarial_images = jsma.generate_np(samples, **jsma_params)\r\n  File \"~/cleverhans/cleverhans/attacks.py\", line 203, in generate_np\r\n    return self.sess.run(x_adv, feed_dict)\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 887, in run\r\n    run_metadata_ptr)\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\r\n    run_metadata)\r\n  File \"~/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: Invalid loop structure: Mismatched parent frames for \"while/while_context\": \"while/while_context\" vs \"\". The node giving this error: {{node while/gradients/while/model_1/dropout_1/cond/mul_grad/Shape/Enter}}This is an internal bug, please file a bug report with instructions on how to reproduce the error.\r\n```\r\n"}