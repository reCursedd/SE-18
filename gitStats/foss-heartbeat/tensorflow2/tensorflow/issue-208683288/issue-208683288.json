{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7657", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7657/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7657/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7657/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7657", "id": 208683288, "node_id": "MDU6SXNzdWUyMDg2ODMyODg=", "number": 7657, "title": "is_jpeg function only detects JFIF and not EXIF jpeg images in decode_image()", "user": {"login": "prats226", "id": 4567874, "node_id": "MDQ6VXNlcjQ1Njc4NzQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/4567874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prats226", "html_url": "https://github.com/prats226", "followers_url": "https://api.github.com/users/prats226/followers", "following_url": "https://api.github.com/users/prats226/following{/other_user}", "gists_url": "https://api.github.com/users/prats226/gists{/gist_id}", "starred_url": "https://api.github.com/users/prats226/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prats226/subscriptions", "organizations_url": "https://api.github.com/users/prats226/orgs", "repos_url": "https://api.github.com/users/prats226/repos", "events_url": "https://api.github.com/users/prats226/events{/privacy}", "received_events_url": "https://api.github.com/users/prats226/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-02-19T00:34:35Z", "updated_at": "2017-04-01T03:56:51Z", "closed_at": "2017-03-09T18:32:14Z", "author_association": "NONE", "body_html": "<p>I am using tf.image.decode_image() function to dynamically decode jpeg, png or gif on the fly. However inside decode_image(), it checks if passed tensor if jpeg image using this condition:</p>\n<p><code>is_jpeg = math_ops.equal(substr, b'\\xff\\xd8\\xff\\xe0', name='is_jpeg')</code></p>\n<p>EXIF files have a marker of 0xff<em>e1</em>, JFIF files have a marker of 0xff<em>e0</em>. So all code that relies on 0xffe0 to detect a JPEG file will miss all EXIF files.</p>\n<p>When I patched it to only match first 3 bytes, its working fine.</p>", "body_text": "I am using tf.image.decode_image() function to dynamically decode jpeg, png or gif on the fly. However inside decode_image(), it checks if passed tensor if jpeg image using this condition:\nis_jpeg = math_ops.equal(substr, b'\\xff\\xd8\\xff\\xe0', name='is_jpeg')\nEXIF files have a marker of 0xffe1, JFIF files have a marker of 0xffe0. So all code that relies on 0xffe0 to detect a JPEG file will miss all EXIF files.\nWhen I patched it to only match first 3 bytes, its working fine.", "body": "I am using tf.image.decode_image() function to dynamically decode jpeg, png or gif on the fly. However inside decode_image(), it checks if passed tensor if jpeg image using this condition:\r\n\r\n`is_jpeg = math_ops.equal(substr, b'\\xff\\xd8\\xff\\xe0', name='is_jpeg')`\r\n\r\nEXIF files have a marker of 0xff*e1*, JFIF files have a marker of 0xff*e0*. So all code that relies on 0xffe0 to detect a JPEG file will miss all EXIF files.\r\n\r\nWhen I patched it to only match first 3 bytes, its working fine."}