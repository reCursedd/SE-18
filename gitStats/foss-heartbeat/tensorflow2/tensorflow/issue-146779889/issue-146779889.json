{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1816", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1816/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1816/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1816/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1816", "id": 146779889, "node_id": "MDU6SXNzdWUxNDY3Nzk4ODk=", "number": 1816, "title": "`tf.reverse_sequence()` doesn't work with arguments of totally unknown shape.", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-04-08T00:38:20Z", "updated_at": "2017-02-09T22:02:18Z", "closed_at": "2016-04-08T20:49:12Z", "author_association": "CONTRIBUTOR", "body_html": "<p>From <a href=\"http://stackoverflow.com/questions/36480456/dynamic-rnn-and-array-ops-reverse-sequence-problems\" rel=\"nofollow\">Stack Overflow</a>:</p>\n<blockquote>\n<p>I am trying to reverse my inputs with array_ops.reverse_sequence() before sending it to dynamic_rnn(), the inference graph can be build with no problem, but when building the training graph, I got the following error:</p>\n<pre><code>  Traceback (most recent call last):\n  File \"bin/trainer.py\", line 158, in &lt;module&gt;\n    kmer_len=args.kmer_len)\n  File \"/home/ubuntu/GIT/IvyMike/ivymike/base_model.py\", line 193, in run_training\n    train_op = model.training(loss, learning_rate)\n  File \"/home/ubuntu/GIT/IvyMike/ivymike/base_model.py\", line 100, in training\n    train_op = optimizer.minimize(loss, global_step=global_step)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 190, in minimize\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 241, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 481, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 307, in _ReverseSequenceGrad\n    seq_lengths=seq_lengths),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 1143, in reverse_sequence\n    batch_dim=batch_dim, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 655, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2119, in create_op\n    set_shapes_for_outputs(ret)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1586, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1257, in _ReverseSequenceShape\n    (batch_dim, input_shape.ndims))\nTypeError: %d format: a number is required, not NoneType\n</code></pre>\n</blockquote>\n<p>The problem appears to arise when <code>input_shape.ndims</code> is <code>None</code> (which is a valid possibility).</p>", "body_text": "From Stack Overflow:\n\nI am trying to reverse my inputs with array_ops.reverse_sequence() before sending it to dynamic_rnn(), the inference graph can be build with no problem, but when building the training graph, I got the following error:\n  Traceback (most recent call last):\n  File \"bin/trainer.py\", line 158, in <module>\n    kmer_len=args.kmer_len)\n  File \"/home/ubuntu/GIT/IvyMike/ivymike/base_model.py\", line 193, in run_training\n    train_op = model.training(loss, learning_rate)\n  File \"/home/ubuntu/GIT/IvyMike/ivymike/base_model.py\", line 100, in training\n    train_op = optimizer.minimize(loss, global_step=global_step)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 190, in minimize\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 241, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 481, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 307, in _ReverseSequenceGrad\n    seq_lengths=seq_lengths),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 1143, in reverse_sequence\n    batch_dim=batch_dim, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 655, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2119, in create_op\n    set_shapes_for_outputs(ret)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1586, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1257, in _ReverseSequenceShape\n    (batch_dim, input_shape.ndims))\nTypeError: %d format: a number is required, not NoneType\n\n\nThe problem appears to arise when input_shape.ndims is None (which is a valid possibility).", "body": "From [Stack Overflow](http://stackoverflow.com/questions/36480456/dynamic-rnn-and-array-ops-reverse-sequence-problems):\n\n> I am trying to reverse my inputs with array_ops.reverse_sequence() before sending it to dynamic_rnn(), the inference graph can be build with no problem, but when building the training graph, I got the following error:\n> \n> ```\n>   Traceback (most recent call last):\n>   File \"bin/trainer.py\", line 158, in <module>\n>     kmer_len=args.kmer_len)\n>   File \"/home/ubuntu/GIT/IvyMike/ivymike/base_model.py\", line 193, in run_training\n>     train_op = model.training(loss, learning_rate)\n>   File \"/home/ubuntu/GIT/IvyMike/ivymike/base_model.py\", line 100, in training\n>     train_op = optimizer.minimize(loss, global_step=global_step)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 190, in minimize\n>     colocate_gradients_with_ops=colocate_gradients_with_ops)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 241, in compute_gradients\n>     colocate_gradients_with_ops=colocate_gradients_with_ops)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 481, in gradients\n>     in_grads = _AsList(grad_fn(op, *out_grads))\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 307, in _ReverseSequenceGrad\n>     seq_lengths=seq_lengths),\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 1143, in reverse_sequence\n>     batch_dim=batch_dim, name=name)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 655, in apply_op\n>     op_def=op_def)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2119, in create_op\n>     set_shapes_for_outputs(ret)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1586, in set_shapes_for_outputs\n>     shapes = shape_func(op)\n>   File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1257, in _ReverseSequenceShape\n>     (batch_dim, input_shape.ndims))\n> TypeError: %d format: a number is required, not NoneType\n> ```\n\nThe problem appears to arise when `input_shape.ndims` is `None` (which is a valid possibility).\n"}