{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/410096748", "html_url": "https://github.com/tensorflow/tensorflow/issues/21313#issuecomment-410096748", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21313", "id": 410096748, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDA5Njc0OA==", "user": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-02T23:15:48Z", "updated_at": "2018-08-02T23:15:48Z", "author_association": "MEMBER", "body_html": "<p>You could fake-return a SparseTensor by returning the tuple of its elements (index, values, and dense_shape) but this would likely fail because tf would be incapable of properly stacking the contents.</p>\n<p>tf.map_fn wasn't really designed for the thing you want, though. It expects the shapes of the outputs to be uniform so it can stack them.</p>\n<p>I think you should try implementing the behavior you want with tf.while_loop directly (tf.map_fn is just a thin wrapper over that anyway); maybe using tf.contrib.autograph to rewrite python code into an efficient while loop.</p>\n<p>Closing as intended behavior.</p>", "body_text": "You could fake-return a SparseTensor by returning the tuple of its elements (index, values, and dense_shape) but this would likely fail because tf would be incapable of properly stacking the contents.\ntf.map_fn wasn't really designed for the thing you want, though. It expects the shapes of the outputs to be uniform so it can stack them.\nI think you should try implementing the behavior you want with tf.while_loop directly (tf.map_fn is just a thin wrapper over that anyway); maybe using tf.contrib.autograph to rewrite python code into an efficient while loop.\nClosing as intended behavior.", "body": "You could fake-return a SparseTensor by returning the tuple of its elements (index, values, and dense_shape) but this would likely fail because tf would be incapable of properly stacking the contents.\r\n\r\ntf.map_fn wasn't really designed for the thing you want, though. It expects the shapes of the outputs to be uniform so it can stack them.\r\n\r\nI think you should try implementing the behavior you want with tf.while_loop directly (tf.map_fn is just a thin wrapper over that anyway); maybe using tf.contrib.autograph to rewrite python code into an efficient while loop.\r\n\r\nClosing as intended behavior."}