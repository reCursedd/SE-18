{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22363", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22363/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22363/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22363/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/22363", "id": 361513691, "node_id": "MDExOlB1bGxSZXF1ZXN0MjE2NDY3MjYx", "number": 22363, "title": "Fix Embedding layer to check invalid inputs", "user": {"login": "yanboliang", "id": 1962026, "node_id": "MDQ6VXNlcjE5NjIwMjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/1962026?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yanboliang", "html_url": "https://github.com/yanboliang", "followers_url": "https://api.github.com/users/yanboliang/followers", "following_url": "https://api.github.com/users/yanboliang/following{/other_user}", "gists_url": "https://api.github.com/users/yanboliang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yanboliang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yanboliang/subscriptions", "organizations_url": "https://api.github.com/users/yanboliang/orgs", "repos_url": "https://api.github.com/users/yanboliang/repos", "events_url": "https://api.github.com/users/yanboliang/events{/privacy}", "received_events_url": "https://api.github.com/users/yanboliang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "fef2c0", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-18T22:53:37Z", "updated_at": "2018-11-11T18:41:35Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22363", "html_url": "https://github.com/tensorflow/tensorflow/pull/22363", "diff_url": "https://github.com/tensorflow/tensorflow/pull/22363.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/22363.patch"}, "body_html": "<p>Bug: If users set <code>input_length</code> for <code>Embedding</code> layer incorrectly, it should throw exception(existing not). Otherwise, the downstream layers compute shape incorrect and throw confused exception.<br>\nI have fixed this at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"357347567\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/keras-team/keras/issues/11091\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/keras-team/keras/pull/11091/hovercard\" href=\"https://github.com/keras-team/keras/pull/11091\">keras-team/keras#11091</a>, but it's different from <code>tf.keras</code>. <code>keras-team/keras</code> makes this check in <code>compute_output_shape</code> which was executed always. But <code>tf.keras</code> only calls <code>compute_output_shape</code> in deferred mode, so we need to move this check to other place. Actually it makes more sense to move it to <code>_assert_input_compatibility</code> which is used to check the inputs legal, and would be run in all mode.</p>", "body_text": "Bug: If users set input_length for Embedding layer incorrectly, it should throw exception(existing not). Otherwise, the downstream layers compute shape incorrect and throw confused exception.\nI have fixed this at keras-team/keras#11091, but it's different from tf.keras. keras-team/keras makes this check in compute_output_shape which was executed always. But tf.keras only calls compute_output_shape in deferred mode, so we need to move this check to other place. Actually it makes more sense to move it to _assert_input_compatibility which is used to check the inputs legal, and would be run in all mode.", "body": "Bug: If users set ```input_length``` for ```Embedding``` layer incorrectly, it should throw exception(existing not). Otherwise, the downstream layers compute shape incorrect and throw confused exception.\r\nI have fixed this at https://github.com/keras-team/keras/pull/11091, but it's different from ```tf.keras```. ```keras-team/keras``` makes this check in ```compute_output_shape``` which was executed always. But ```tf.keras``` only calls ```compute_output_shape``` in deferred mode, so we need to move this check to other place. Actually it makes more sense to move it to ```_assert_input_compatibility``` which is used to check the inputs legal, and would be run in all mode.\r\n"}