{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/437975399", "html_url": "https://github.com/tensorflow/tensorflow/issues/23691#issuecomment-437975399", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23691", "id": 437975399, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzk3NTM5OQ==", "user": {"login": "Hoeze", "id": 1200058, "node_id": "MDQ6VXNlcjEyMDAwNTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1200058?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hoeze", "html_url": "https://github.com/Hoeze", "followers_url": "https://api.github.com/users/Hoeze/followers", "following_url": "https://api.github.com/users/Hoeze/following{/other_user}", "gists_url": "https://api.github.com/users/Hoeze/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hoeze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hoeze/subscriptions", "organizations_url": "https://api.github.com/users/Hoeze/orgs", "repos_url": "https://api.github.com/users/Hoeze/repos", "events_url": "https://api.github.com/users/Hoeze/events{/privacy}", "received_events_url": "https://api.github.com/users/Hoeze/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-12T18:03:25Z", "updated_at": "2018-11-12T18:03:40Z", "author_association": "NONE", "body_html": "<p>After some debugging I found out that this fails only after running some code I did not identify yet.</p>\n<p>Stack trace:</p>\n<div class=\"highlight highlight-source-python\"><pre>  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>[...]/tf/rsa/estimator.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">86</span>, <span class=\"pl-k\">in</span> map_fn_EM\n    updates<span class=\"pl-k\">=</span>tf.transpose(model.estimated_mixture_log_prob)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">296</span>, <span class=\"pl-k\">in</span> scatter_update\n    use_locking<span class=\"pl-k\">=</span>use_locking, name<span class=\"pl-k\">=</span>name)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1210</span>, <span class=\"pl-k\">in</span> scatter_update\n    use_locking<span class=\"pl-k\">=</span>use_locking, name<span class=\"pl-k\">=</span>name)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">787</span>, <span class=\"pl-k\">in</span> _apply_op_helper\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/function.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">738</span>, <span class=\"pl-k\">in</span> create_op\n    <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">488</span>, <span class=\"pl-k\">in</span> new_func\n    <span class=\"pl-k\">return</span> func(<span class=\"pl-k\">*</span>args, <span class=\"pl-k\">**</span>kwargs)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">3274</span>, <span class=\"pl-k\">in</span> create_op\n    op_def<span class=\"pl-k\">=</span>op_def)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">1748</span>, <span class=\"pl-k\">in</span> <span class=\"pl-c1\">__init__</span>\n    input_types))\n<span class=\"pl-c1\">TypeError</span>: In op <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ScatterUpdate<span class=\"pl-pds\">'</span></span>, <span class=\"pl-c1\">input</span> types ([tf.float64, tf.int32, tf.float64]) are <span class=\"pl-k\">not</span> compatible <span class=\"pl-k\">with</span> expected types ([tf.float64_ref, tf.int32, tf.float64])</pre></div>\n<p>The exact cause of the raised error in my code is the following:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"><span class=\"pl-c\">#</span> inputs</span>\n[<span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ScatterUpdate/Placeholder:0<span class=\"pl-pds\">'</span></span> shape=(<span class=\"pl-c1\">2221</span>, <span class=\"pl-c1\">3</span>) dtype=float64<span class=\"pl-k\">&gt;</span>,\n <span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>arg1:0<span class=\"pl-pds\">'</span></span> shape=(<span class=\"pl-ii\">?</span>,) dtype=int32<span class=\"pl-k\">&gt;</span>,\n <span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>transpose:0<span class=\"pl-pds\">'</span></span> shape=(<span class=\"pl-ii\">?</span>, <span class=\"pl-c1\">3</span>) dtype=float64<span class=\"pl-k\">&gt;</span>]\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> input_types</span>\n[tf.float64_ref, tf.int32, tf.float64]</pre></div>\n<p>=&gt; <code>tf.Tensor 'ScatterUpdate/Placeholder:0' shape=(2221, 3) dtype=float64</code> is not compatible with <code>tf.float64_ref</code>.</p>\n<p><code>inputs</code> gets created somewhere in <code>_apply_op_helper, op_def_library.py</code>.</p>", "body_text": "After some debugging I found out that this fails only after running some code I did not identify yet.\nStack trace:\n  File \"[...]/tf/rsa/estimator.py\", line 86, in map_fn_EM\n    updates=tf.transpose(model.estimated_mixture_log_prob)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py\", line 296, in scatter_update\n    use_locking=use_locking, name=name)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py\", line 1210, in scatter_update\n    use_locking=use_locking, name=name)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/function.py\", line 738, in create_op\n    **kwargs)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\n    op_def=op_def)\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1748, in __init__\n    input_types))\nTypeError: In op 'ScatterUpdate', input types ([tf.float64, tf.int32, tf.float64]) are not compatible with expected types ([tf.float64_ref, tf.int32, tf.float64])\nThe exact cause of the raised error in my code is the following:\n# inputs\n[<tf.Tensor 'ScatterUpdate/Placeholder:0' shape=(2221, 3) dtype=float64>,\n <tf.Tensor 'arg1:0' shape=(?,) dtype=int32>,\n <tf.Tensor 'transpose:0' shape=(?, 3) dtype=float64>]\n# input_types\n[tf.float64_ref, tf.int32, tf.float64]\n=> tf.Tensor 'ScatterUpdate/Placeholder:0' shape=(2221, 3) dtype=float64 is not compatible with tf.float64_ref.\ninputs gets created somewhere in _apply_op_helper, op_def_library.py.", "body": "After some debugging I found out that this fails only after running some code I did not identify yet.\r\n\r\n\r\nStack trace: \r\n```python\r\n  File \"[...]/tf/rsa/estimator.py\", line 86, in map_fn_EM\r\n    updates=tf.transpose(model.estimated_mixture_log_prob)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py\", line 296, in scatter_update\r\n    use_locking=use_locking, name=name)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py\", line 1210, in scatter_update\r\n    use_locking=use_locking, name=name)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/function.py\", line 738, in create_op\r\n    **kwargs)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/opt/miniconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1748, in __init__\r\n    input_types))\r\nTypeError: In op 'ScatterUpdate', input types ([tf.float64, tf.int32, tf.float64]) are not compatible with expected types ([tf.float64_ref, tf.int32, tf.float64])\r\n```\r\n\r\nThe exact cause of the raised error in my code is the following:\r\n```python\r\n# inputs\r\n[<tf.Tensor 'ScatterUpdate/Placeholder:0' shape=(2221, 3) dtype=float64>,\r\n <tf.Tensor 'arg1:0' shape=(?,) dtype=int32>,\r\n <tf.Tensor 'transpose:0' shape=(?, 3) dtype=float64>]\r\n# input_types\r\n[tf.float64_ref, tf.int32, tf.float64]\r\n```\r\n=> `tf.Tensor 'ScatterUpdate/Placeholder:0' shape=(2221, 3) dtype=float64` is not compatible with `tf.float64_ref`.\r\n\r\n`inputs` gets created somewhere in `_apply_op_helper, op_def_library.py`."}