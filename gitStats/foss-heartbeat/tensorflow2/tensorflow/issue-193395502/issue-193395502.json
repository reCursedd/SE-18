{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6070", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6070/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6070/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6070/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6070", "id": 193395502, "node_id": "MDU6SXNzdWUxOTMzOTU1MDI=", "number": 6070, "title": "tf.contrib.learn.LinearRegressor builds bad model for a data with one feature", "user": {"login": "b0noI", "id": 554101, "node_id": "MDQ6VXNlcjU1NDEwMQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/554101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b0noI", "html_url": "https://github.com/b0noI", "followers_url": "https://api.github.com/users/b0noI/followers", "following_url": "https://api.github.com/users/b0noI/following{/other_user}", "gists_url": "https://api.github.com/users/b0noI/gists{/gist_id}", "starred_url": "https://api.github.com/users/b0noI/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b0noI/subscriptions", "organizations_url": "https://api.github.com/users/b0noI/orgs", "repos_url": "https://api.github.com/users/b0noI/repos", "events_url": "https://api.github.com/users/b0noI/events{/privacy}", "received_events_url": "https://api.github.com/users/b0noI/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-12-05T02:03:26Z", "updated_at": "2016-12-05T17:51:43Z", "closed_at": "2016-12-05T17:51:43Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Reproduce steps:</p>\n<p><a href=\"http://%22https//vincentarelbundock.github.io/Rdatasets/csv/car/Davis.csv%22\" rel=\"nofollow\">csv with data</a>. Data includes weight and height values of some people. Overall learning process is very simple:</p>\n<pre><code>MAX_STEPS = 2000\n# ...\nfeatures = [tf.contrib.layers.real_valued_column(feature_name) for feature_name in FEATURES_COL]\n# ...\nlinear_regressor = tf.contrib.learn.LinearRegressor(feature_columns=features)\nlinear_regressor.fit(input_fn=prepare_input, max_steps=MAX_STEPS)\n</code></pre>\n<p>However, the model that is built by the regressor is, unexpectedly, bad. Result could be illustrated with the next picture:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/554101/20871476/1aaa1f42-ba4b-11e6-84cb-3bb5f3544f1a.png\"><img width=\"556\" alt=\"umbhj\" src=\"https://cloud.githubusercontent.com/assets/554101/20871476/1aaa1f42-ba4b-11e6-84cb-3bb5f3544f1a.png\" style=\"max-width:100%;\"></a><br>\nVisualization code(just in case):</p>\n<pre><code>plt.plot(height_and_weight_df_filtered[WEIGHT_COL], \n         linear_regressor.predict(input_fn=prepare_full_input), \n         color='blue',\n         linewidth=3)\n</code></pre>\n<p>Why I think the model is bad? Here is the same data been given to the LinearRegression class from the scikit-learn:</p>\n<pre><code>lr_updated = linear_model.LinearRegression()\nlr_updated.fit(weight_filtered_reshaped, height_filtered)\n</code></pre>\n<p>And the visualization:</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/554101/20871501/5949a3e4-ba4b-11e6-970c-d5afaf002b85.png\"><img width=\"548\" alt=\"gi1ui\" src=\"https://cloud.githubusercontent.com/assets/554101/20871501/5949a3e4-ba4b-11e6-970c-d5afaf002b85.png\" style=\"max-width:100%;\"></a></p>\n<p>Increasing amount of steps has no effect. I would assume I'm using regressor from the TensorFlow in a wrong way.</p>\n<p><a href=\"https://storage.googleapis.com/stackoverflow-b0noi/Intro%2Bwith%2BTensorFlow.ipynb\" rel=\"nofollow\">iPython notebook with the code.</a></p>\n<p>Env details</p>\n<ol>\n<li>A link to the pip package you installed:</li>\n<li>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.<br>\n0.11.0rc0</li>\n</ol>\n<h3>What other attempted solutions have you tried?</h3>\n<p>The issue was opened originally as a question on the <a href=\"http://stackoverflow.com/questions/40734394/tf-contrib-learn-linearregressor-builds-unexpectedly-bad-model-for-a-data-with-o\" rel=\"nofollow\">stackoverflow</a>.</p>", "body_text": "Reproduce steps:\ncsv with data. Data includes weight and height values of some people. Overall learning process is very simple:\nMAX_STEPS = 2000\n# ...\nfeatures = [tf.contrib.layers.real_valued_column(feature_name) for feature_name in FEATURES_COL]\n# ...\nlinear_regressor = tf.contrib.learn.LinearRegressor(feature_columns=features)\nlinear_regressor.fit(input_fn=prepare_input, max_steps=MAX_STEPS)\n\nHowever, the model that is built by the regressor is, unexpectedly, bad. Result could be illustrated with the next picture:\n\nVisualization code(just in case):\nplt.plot(height_and_weight_df_filtered[WEIGHT_COL], \n         linear_regressor.predict(input_fn=prepare_full_input), \n         color='blue',\n         linewidth=3)\n\nWhy I think the model is bad? Here is the same data been given to the LinearRegression class from the scikit-learn:\nlr_updated = linear_model.LinearRegression()\nlr_updated.fit(weight_filtered_reshaped, height_filtered)\n\nAnd the visualization:\n\nIncreasing amount of steps has no effect. I would assume I'm using regressor from the TensorFlow in a wrong way.\niPython notebook with the code.\nEnv details\n\nA link to the pip package you installed:\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\n0.11.0rc0\n\nWhat other attempted solutions have you tried?\nThe issue was opened originally as a question on the stackoverflow.", "body": "Reproduce steps:\r\n\r\n[csv with data](http://%22https//vincentarelbundock.github.io/Rdatasets/csv/car/Davis.csv%22). Data includes weight and height values of some people. Overall learning process is very simple:\r\n\r\n```\r\nMAX_STEPS = 2000\r\n# ...\r\nfeatures = [tf.contrib.layers.real_valued_column(feature_name) for feature_name in FEATURES_COL]\r\n# ...\r\nlinear_regressor = tf.contrib.learn.LinearRegressor(feature_columns=features)\r\nlinear_regressor.fit(input_fn=prepare_input, max_steps=MAX_STEPS)\r\n```\r\n\r\nHowever, the model that is built by the regressor is, unexpectedly, bad. Result could be illustrated with the next picture: \r\n<img width=\"556\" alt=\"umbhj\" src=\"https://cloud.githubusercontent.com/assets/554101/20871476/1aaa1f42-ba4b-11e6-84cb-3bb5f3544f1a.png\">\r\nVisualization code(just in case):\r\n```\r\nplt.plot(height_and_weight_df_filtered[WEIGHT_COL], \r\n         linear_regressor.predict(input_fn=prepare_full_input), \r\n         color='blue',\r\n         linewidth=3)\r\n```\r\nWhy I think the model is bad? Here is the same data been given to the LinearRegression class from the scikit-learn:\r\n\r\n```\r\nlr_updated = linear_model.LinearRegression()\r\nlr_updated.fit(weight_filtered_reshaped, height_filtered)\r\n```\r\n\r\nAnd the visualization: \r\n\r\n<img width=\"548\" alt=\"gi1ui\" src=\"https://cloud.githubusercontent.com/assets/554101/20871501/5949a3e4-ba4b-11e6-970c-d5afaf002b85.png\">\r\n\r\nIncreasing amount of steps has no effect. I would assume I'm using regressor from the TensorFlow in a wrong way.\r\n\r\n[iPython notebook with the code.](https://storage.googleapis.com/stackoverflow-b0noi/Intro%2Bwith%2BTensorFlow.ipynb)\r\n\r\nEnv details\r\n\r\n1. A link to the pip package you installed:\r\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\r\n0.11.0rc0\r\n\r\n### What other attempted solutions have you tried?\r\n\r\nThe issue was opened originally as a question on the [stackoverflow](http://stackoverflow.com/questions/40734394/tf-contrib-learn-linearregressor-builds-unexpectedly-bad-model-for-a-data-with-o)."}