{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/274586644", "html_url": "https://github.com/tensorflow/tensorflow/issues/110#issuecomment-274586644", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/110", "id": 274586644, "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDU4NjY0NA==", "user": {"login": "rdipietro", "id": 5150559, "node_id": "MDQ6VXNlcjUxNTA1NTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/5150559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rdipietro", "html_url": "https://github.com/rdipietro", "followers_url": "https://api.github.com/users/rdipietro/followers", "following_url": "https://api.github.com/users/rdipietro/following{/other_user}", "gists_url": "https://api.github.com/users/rdipietro/gists{/gist_id}", "starred_url": "https://api.github.com/users/rdipietro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rdipietro/subscriptions", "organizations_url": "https://api.github.com/users/rdipietro/orgs", "repos_url": "https://api.github.com/users/rdipietro/repos", "events_url": "https://api.github.com/users/rdipietro/events{/privacy}", "received_events_url": "https://api.github.com/users/rdipietro/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-23T19:12:10Z", "updated_at": "2017-01-23T19:16:38Z", "author_association": "CONTRIBUTOR", "body_html": "<p>You're welcome <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=2210572\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/VittalP\">@VittalP</a> :)</p>\n<p>I have an updated set of notes that works as of 1.0.0 alpha:</p>\n<p>First of all Bazel finally just works. Can download the newest 0.4.x source code (dist zip version), run <code>./compile.sh</code>, then add the printed output path to <code>PATH</code>.</p>\n<p>TensorFlow unfortunately still doesn't just work. So (replacing my paths with yours):</p>\n<ol>\n<li>\n<p>In <code>configure</code>, replace <code>bazel clean --expunge</code> with <code>bazel clean --expunge_async</code></p>\n</li>\n<li>\n<p>In <code>third_party/gpus/crosstool/CROSSTOOL.tpl</code>, replace all occurrences of <code>/usr/bin/cpp</code> with <code>/cm/shared/apps/gcc/4.8.2/bin/cpp</code></p>\n</li>\n<li>\n<p>In <code>third_party/gpus/crosstool/CROSSTOOL.tpl</code>, after the line <code>-B/usr/bin/</code>, add the lines</p>\n</li>\n</ol>\n<p>linker_flag: \"-Wl,-R/cm/shared/apps/gcc/4.8.2/lib64\"<br>\ncxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include\"<br>\ncxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include-fixed\"<br>\ncxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/include/c++/4.8.2\"</p>\n<ol start=\"4\">\n<li>\n<p>In <code>third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl</code>, replace <code>NVCC_PATH = CURRENT_DIR + '/../../../cuda/bin/nvcc'</code> with <code>NVCC_PATH = ('/cm/shared/apps/cuda/7.5/bin/nvcc')</code></p>\n</li>\n<li>\n<p>In <code>third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl</code>, replace <code>LLVM_HOST_COMPILER_PATH = ('/usr/bin/gcc')</code> with <code>LLVM_HOST_COMPILER_PATH = ('/cm/shared/apps/gcc/4.8.2/bin/gcc')</code></p>\n</li>\n<li>\n<p>In <code>third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl</code>, comment out the line <code>cmd = 'PATH=' + PREFIX_DIR + ' ' + cmd</code></p>\n</li>\n</ol>\n<p>I configured with cuda 7.5, cudnn 5, compute compatibility 3.5 and built with <code>bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package</code></p>", "body_text": "You're welcome @VittalP :)\nI have an updated set of notes that works as of 1.0.0 alpha:\nFirst of all Bazel finally just works. Can download the newest 0.4.x source code (dist zip version), run ./compile.sh, then add the printed output path to PATH.\nTensorFlow unfortunately still doesn't just work. So (replacing my paths with yours):\n\n\nIn configure, replace bazel clean --expunge with bazel clean --expunge_async\n\n\nIn third_party/gpus/crosstool/CROSSTOOL.tpl, replace all occurrences of /usr/bin/cpp with /cm/shared/apps/gcc/4.8.2/bin/cpp\n\n\nIn third_party/gpus/crosstool/CROSSTOOL.tpl, after the line -B/usr/bin/, add the lines\n\n\nlinker_flag: \"-Wl,-R/cm/shared/apps/gcc/4.8.2/lib64\"\ncxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include\"\ncxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include-fixed\"\ncxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/include/c++/4.8.2\"\n\n\nIn third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl, replace NVCC_PATH = CURRENT_DIR + '/../../../cuda/bin/nvcc' with NVCC_PATH = ('/cm/shared/apps/cuda/7.5/bin/nvcc')\n\n\nIn third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl, replace LLVM_HOST_COMPILER_PATH = ('/usr/bin/gcc') with LLVM_HOST_COMPILER_PATH = ('/cm/shared/apps/gcc/4.8.2/bin/gcc')\n\n\nIn third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl, comment out the line cmd = 'PATH=' + PREFIX_DIR + ' ' + cmd\n\n\nI configured with cuda 7.5, cudnn 5, compute compatibility 3.5 and built with bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package", "body": "You're welcome @VittalP :)\r\n\r\nI have an updated set of notes that works as of 1.0.0 alpha:\r\n\r\nFirst of all Bazel finally just works. Can download the newest 0.4.x source code (dist zip version), run `./compile.sh`, then add the printed output path to `PATH`.\r\n\r\nTensorFlow unfortunately still doesn't just work. So (replacing my paths with yours):\r\n\r\n1) In `configure`, replace `bazel clean --expunge` with `bazel clean --expunge_async`\r\n\r\n2) In `third_party/gpus/crosstool/CROSSTOOL.tpl`, replace all occurrences of `/usr/bin/cpp` with `/cm/shared/apps/gcc/4.8.2/bin/cpp`\r\n\r\n3) In `third_party/gpus/crosstool/CROSSTOOL.tpl`, after the line `-B/usr/bin/`, add the lines\r\n\r\n  linker_flag: \"-Wl,-R/cm/shared/apps/gcc/4.8.2/lib64\"\r\n  cxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include\"\r\n  cxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include-fixed\"\r\n  cxx_builtin_include_directory: \"/cm/shared/apps/gcc/4.8.2/include/c++/4.8.2\"\r\n\r\n4) In `third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl`, replace `NVCC_PATH = CURRENT_DIR + '/../../../cuda/bin/nvcc'` with `NVCC_PATH = ('/cm/shared/apps/cuda/7.5/bin/nvcc')`\r\n\r\n5) In `third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl`, replace `LLVM_HOST_COMPILER_PATH = ('/usr/bin/gcc')` with `LLVM_HOST_COMPILER_PATH = ('/cm/shared/apps/gcc/4.8.2/bin/gcc')`\r\n\r\n6) In `third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc.tpl`, comment out the line `cmd = 'PATH=' + PREFIX_DIR + ' ' + cmd`\r\n\r\nI configured with cuda 7.5, cudnn 5, compute compatibility 3.5 and built with `bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package`"}