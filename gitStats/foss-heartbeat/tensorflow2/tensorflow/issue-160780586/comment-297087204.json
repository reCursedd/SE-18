{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/297087204", "html_url": "https://github.com/tensorflow/tensorflow/issues/2916#issuecomment-297087204", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2916", "id": 297087204, "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzA4NzIwNA==", "user": {"login": "shamoya", "id": 22274255, "node_id": "MDQ6VXNlcjIyMjc0MjU1", "avatar_url": "https://avatars2.githubusercontent.com/u/22274255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shamoya", "html_url": "https://github.com/shamoya", "followers_url": "https://api.github.com/users/shamoya/followers", "following_url": "https://api.github.com/users/shamoya/following{/other_user}", "gists_url": "https://api.github.com/users/shamoya/gists{/gist_id}", "starred_url": "https://api.github.com/users/shamoya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shamoya/subscriptions", "organizations_url": "https://api.github.com/users/shamoya/orgs", "repos_url": "https://api.github.com/users/shamoya/repos", "events_url": "https://api.github.com/users/shamoya/events{/privacy}", "received_events_url": "https://api.github.com/users/shamoya/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-25T16:30:01Z", "updated_at": "2017-04-25T16:30:01Z", "author_association": "CONTRIBUTOR", "body_html": "<p>We (<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=22419555\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/bkovalev\">@bkovalev</a> and me) did some testing on the new verbs code VS the default gRPC over TCP.<br>\nSome of the results in - <a href=\"https://docs.google.com/spreadsheets/d/1UIqmp5sKwPnxWpZkJ1rCcGrJz-Iqr4_1NZdZdRqJ7N8/pubhtml\" rel=\"nofollow\">https://docs.google.com/spreadsheets/d/1UIqmp5sKwPnxWpZkJ1rCcGrJz-Iqr4_1NZdZdRqJ7N8/pubhtml</a>.</p>\n<p>You can see there up to ~25% improvement with verbs in Inception-V3 (with only 14GPUs K40 in 7 nodes) and good results in VGG-16 case, where TCP can hardly get it running.<br>\nThe TCP issue is caused by a 100% CPU utilization on the workers cores sending the tensors (~5Gbit/s parameters/gradient vectors), we tried some optimizations (TCP tunings, IRQ affinity methods) but nothing helped to this moment (we are still working to tune performance in this case.</p>\n<p>We are working to extend the scale and optimize the verbs code even further.<br>\nThanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=12075848\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/junshi15\">@junshi15</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=2708344\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/anfeng\">@anfeng</a> for the excellent code contribution.</p>", "body_text": "We (@bkovalev and me) did some testing on the new verbs code VS the default gRPC over TCP.\nSome of the results in - https://docs.google.com/spreadsheets/d/1UIqmp5sKwPnxWpZkJ1rCcGrJz-Iqr4_1NZdZdRqJ7N8/pubhtml.\nYou can see there up to ~25% improvement with verbs in Inception-V3 (with only 14GPUs K40 in 7 nodes) and good results in VGG-16 case, where TCP can hardly get it running.\nThe TCP issue is caused by a 100% CPU utilization on the workers cores sending the tensors (~5Gbit/s parameters/gradient vectors), we tried some optimizations (TCP tunings, IRQ affinity methods) but nothing helped to this moment (we are still working to tune performance in this case.\nWe are working to extend the scale and optimize the verbs code even further.\nThanks @junshi15 @anfeng for the excellent code contribution.", "body": "We (@bkovalev and me) did some testing on the new verbs code VS the default gRPC over TCP.\r\nSome of the results in - https://docs.google.com/spreadsheets/d/1UIqmp5sKwPnxWpZkJ1rCcGrJz-Iqr4_1NZdZdRqJ7N8/pubhtml.\r\n\r\nYou can see there up to ~25% improvement with verbs in Inception-V3 (with only 14GPUs K40 in 7 nodes) and good results in VGG-16 case, where TCP can hardly get it running.\r\nThe TCP issue is caused by a 100% CPU utilization on the workers cores sending the tensors (~5Gbit/s parameters/gradient vectors), we tried some optimizations (TCP tunings, IRQ affinity methods) but nothing helped to this moment (we are still working to tune performance in this case.\r\n\r\nWe are working to extend the scale and optimize the verbs code even further.\r\nThanks @junshi15 @anfeng for the excellent code contribution."}