{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14777", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14777/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14777/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14777/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14777", "id": 275932335, "node_id": "MDU6SXNzdWUyNzU5MzIzMzU=", "number": 14777, "title": "After quantized ssd_mobilenet_v1_coco model, loaded error on Android ", "user": {"login": "offbye", "id": 836403, "node_id": "MDQ6VXNlcjgzNjQwMw==", "avatar_url": "https://avatars2.githubusercontent.com/u/836403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/offbye", "html_url": "https://github.com/offbye", "followers_url": "https://api.github.com/users/offbye/followers", "following_url": "https://api.github.com/users/offbye/following{/other_user}", "gists_url": "https://api.github.com/users/offbye/gists{/gist_id}", "starred_url": "https://api.github.com/users/offbye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/offbye/subscriptions", "organizations_url": "https://api.github.com/users/offbye/orgs", "repos_url": "https://api.github.com/users/offbye/repos", "events_url": "https://api.github.com/users/offbye/events{/privacy}", "received_events_url": "https://api.github.com/users/offbye/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-11-22T03:19:33Z", "updated_at": "2018-01-08T19:09:55Z", "closed_at": "2017-12-20T03:28:02Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>OS Platform and Distribution</strong> : Linux Ubuntu 14.04.5 LTS</li>\n<li><strong>TensorFlow installed from</strong> : binary</li>\n<li><strong>TensorFlow version</strong> : 1.2.1</li>\n<li><strong>Python version</strong>: 2.7</li>\n<li><strong>Bazel version</strong>: 0.70</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 4.8.4</li>\n<li><strong>CUDA/cuDNN version</strong>: 8.0</li>\n<li><strong>GPU model and memory</strong>: Tesla P100-PCIE</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Load a quantized ssd_mobilenet_v1 model on Android meet error<br>\nCaused by: java.io.IOException: Not a valid TensorFlow Graph serialization: NodeDef mentions attr 'T' not in Op&lt;name=Where; signature=input:bool -&gt; index:int64&gt;;</p>\n<p>I quantize the ssd_mobilenet_v1 model o ubuntu 14,  using the below command</p>\n<pre><code>bazel-bin/tensorflow/tools/graph_transforms/transform_graph \n--in_graph=/data5/zxt/coco_log/export/frozen_inference_graph.pb  \n--out_graph=/home/zxt/git/ssd_optimized.pb --inputs='image_tensor'\n --outputs='detection_boxes,detection_scores,num_detections,detection_classes' --transforms='\n  add_default_attributes\n  strip_unused_nodes(type=float, shape=\"-1,-1,-1,3\")\n  remove_nodes(op=Identity, op=CheckNumerics)\n  fold_batch_norms\n  fold_old_batch_norms\n  quantize_weights\n  strip_unused_nodes\n  sort_by_execution_order'\n</code></pre>\n<p>I also have tried some other parameters\uff0cbut all failed with same issue.<br>\nthe  frozen_inference_graph.pb   is ok on Android, but the quantized pb is can NOT load.<br>\nWhen run the quantized pb on android phone, met errors</p>\n<pre><code>      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:799)\n   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:689)\n    Caused by: java.io.IOException: Not a valid TensorFlow Graph serialization: NodeDef mentions attr 'T' not in Op&lt;name=Where; signature=input:bool -&gt; index:int64&gt;; \nNodeDef: Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/FilterGreaterThan/Where = Where[T=DT_BOOL](Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/FilterGreaterThan/Greater). \n(Check whether your GraphDef-interpreting binary is up to date with your GraphDef-generating binary.).\n           at org.tensorflow.contrib.android.TensorFlowInferenceInterface.loadGraph(TensorFlowInferenceInterface.java:535)\n \n</code></pre>", "body_text": "System information\n\nOS Platform and Distribution : Linux Ubuntu 14.04.5 LTS\nTensorFlow installed from : binary\nTensorFlow version : 1.2.1\nPython version: 2.7\nBazel version: 0.70\nGCC/Compiler version (if compiling from source): 4.8.4\nCUDA/cuDNN version: 8.0\nGPU model and memory: Tesla P100-PCIE\nExact command to reproduce:\n\nDescribe the problem\nLoad a quantized ssd_mobilenet_v1 model on Android meet error\nCaused by: java.io.IOException: Not a valid TensorFlow Graph serialization: NodeDef mentions attr 'T' not in Op<name=Where; signature=input:bool -> index:int64>;\nI quantize the ssd_mobilenet_v1 model o ubuntu 14,  using the below command\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \n--in_graph=/data5/zxt/coco_log/export/frozen_inference_graph.pb  \n--out_graph=/home/zxt/git/ssd_optimized.pb --inputs='image_tensor'\n --outputs='detection_boxes,detection_scores,num_detections,detection_classes' --transforms='\n  add_default_attributes\n  strip_unused_nodes(type=float, shape=\"-1,-1,-1,3\")\n  remove_nodes(op=Identity, op=CheckNumerics)\n  fold_batch_norms\n  fold_old_batch_norms\n  quantize_weights\n  strip_unused_nodes\n  sort_by_execution_order'\n\nI also have tried some other parameters\uff0cbut all failed with same issue.\nthe  frozen_inference_graph.pb   is ok on Android, but the quantized pb is can NOT load.\nWhen run the quantized pb on android phone, met errors\n      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:799)\n   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:689)\n    Caused by: java.io.IOException: Not a valid TensorFlow Graph serialization: NodeDef mentions attr 'T' not in Op<name=Where; signature=input:bool -> index:int64>; \nNodeDef: Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/FilterGreaterThan/Where = Where[T=DT_BOOL](Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/FilterGreaterThan/Greater). \n(Check whether your GraphDef-interpreting binary is up to date with your GraphDef-generating binary.).\n           at org.tensorflow.contrib.android.TensorFlowInferenceInterface.loadGraph(TensorFlowInferenceInterface.java:535)", "body": "### System information\r\n- **OS Platform and Distribution** : Linux Ubuntu 14.04.5 LTS\r\n- **TensorFlow installed from** : binary\r\n- **TensorFlow version** : 1.2.1\r\n- **Python version**: 2.7\r\n- **Bazel version**: 0.70\r\n- **GCC/Compiler version (if compiling from source)**: 4.8.4 \r\n- **CUDA/cuDNN version**: 8.0\r\n- **GPU model and memory**: Tesla P100-PCIE \r\n- **Exact command to reproduce**:\r\n\r\n\r\n### Describe the problem\r\nLoad a quantized ssd_mobilenet_v1 model on Android meet error\r\nCaused by: java.io.IOException: Not a valid TensorFlow Graph serialization: NodeDef mentions attr 'T' not in Op<name=Where; signature=input:bool -> index:int64>; \r\n\r\nI quantize the ssd_mobilenet_v1 model o ubuntu 14,  using the below command\r\n```\r\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \r\n--in_graph=/data5/zxt/coco_log/export/frozen_inference_graph.pb  \r\n--out_graph=/home/zxt/git/ssd_optimized.pb --inputs='image_tensor'\r\n --outputs='detection_boxes,detection_scores,num_detections,detection_classes' --transforms='\r\n  add_default_attributes\r\n  strip_unused_nodes(type=float, shape=\"-1,-1,-1,3\")\r\n  remove_nodes(op=Identity, op=CheckNumerics)\r\n  fold_batch_norms\r\n  fold_old_batch_norms\r\n  quantize_weights\r\n  strip_unused_nodes\r\n  sort_by_execution_order'\r\n```\r\nI also have tried some other parameters\uff0cbut all failed with same issue.\r\nthe  frozen_inference_graph.pb   is ok on Android, but the quantized pb is can NOT load.\r\nWhen run the quantized pb on android phone, met errors\r\n```\r\n      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:799)\r\n   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:689)\r\n    Caused by: java.io.IOException: Not a valid TensorFlow Graph serialization: NodeDef mentions attr 'T' not in Op<name=Where; signature=input:bool -> index:int64>; \r\nNodeDef: Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/FilterGreaterThan/Where = Where[T=DT_BOOL](Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/FilterGreaterThan/Greater). \r\n(Check whether your GraphDef-interpreting binary is up to date with your GraphDef-generating binary.).\r\n           at org.tensorflow.contrib.android.TensorFlowInferenceInterface.loadGraph(TensorFlowInferenceInterface.java:535)\r\n \r\n```"}