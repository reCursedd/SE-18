{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/272013504", "html_url": "https://github.com/tensorflow/tensorflow/issues/6763#issuecomment-272013504", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6763", "id": 272013504, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjAxMzUwNA==", "user": {"login": "oorlov", "id": 1262314, "node_id": "MDQ6VXNlcjEyNjIzMTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1262314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oorlov", "html_url": "https://github.com/oorlov", "followers_url": "https://api.github.com/users/oorlov/followers", "following_url": "https://api.github.com/users/oorlov/following{/other_user}", "gists_url": "https://api.github.com/users/oorlov/gists{/gist_id}", "starred_url": "https://api.github.com/users/oorlov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oorlov/subscriptions", "organizations_url": "https://api.github.com/users/oorlov/orgs", "repos_url": "https://api.github.com/users/oorlov/repos", "events_url": "https://api.github.com/users/oorlov/events{/privacy}", "received_events_url": "https://api.github.com/users/oorlov/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-11T22:17:49Z", "updated_at": "2017-01-11T22:22:56Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3376817\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrewharp\">@andrewharp</a> Checked Android build with Bazel, followed these instuctions:<br>\n<a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/android\">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/android</a><br>\nIncluding</p>\n<pre><code>bazel build -c opt tensorflow/core:android_tensorflow_lib \\\n --crosstool_top=//external:android/crosstool \\\n --cpu=armeabi-v7a \\\n --host_crosstool_top=@bazel_tools//tools/cpp:toolchain\n</code></pre>\n<p>Bazel build script for libtensorflow_inference.so generates different compilation error:</p>\n<pre><code>ERROR: /Users/alivecor/tensorflow-bazel/tensorflow/contrib/android/BUILD:71:1: Linking of rule '//tensorflow/contrib/android:libtensorflow_inference.so' failed: sandbox-exec failed: error executing command /usr/bin/sandbox-exec -f /private/var/tmp/_bazel_alivecor/b205624d5e3f9e00e1da3a96f45ffc17/bazel-sandbox/5d59ce41-1e8b-441a-8550-c21d6358aaa7-749/sandbox.sb ... (remaining 32 argument(s) skipped).\ntensorflow/core/ops/math_ops.cc:1822: error: undefined reference to 'ceil'\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/cmath:185: error: undefined reference to 'ceilf'\ntensorflow/core/ops/nn_ops.cc:64: error: undefined reference to 'floorf'\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/cmath:185: error: undefined reference to 'ceilf'\n</code></pre>\n<p>Log: <a href=\"https://github.com/tensorflow/tensorflow/files/700122/bazel-android-inference.txt\">bazel-android-inference.txt</a>, Verbose: <a href=\"https://github.com/tensorflow/tensorflow/files/700219/bazel-android-inference-verbose.txt\">bazel-android-inference-verbose.txt</a></p>\n<p>Now I'm confused. It happens on more than one machine, so I don't believe they share same misconfiguration problems.<br>\nWhat should be my next step? Should I stay on Makefile with neon and optimization switched off?Wouldn't it affect model execution? Or need to do extra steps for Bazel build?</p>\n<h3>Environment</h3>\n<p>Machine 1, (clean, OSX reinstalled):<br>\nOSX: 10.11.6<br>\nNDK: r12b<br>\nCUDA: not installed<br>\nBAZEL:<br>\nBuild label: 0.4.3-homebrew<br>\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar<br>\nBuild time: Thu Dec 22 15:20:22 2016 (1482420022)<br>\nBuild timestamp: 1482420022<br>\nBuild timestamp as int: 1482420022</p>\n<p>Machine 2:<br>\nOSX 10.12<br>\nNDK: r12b<br>\nCUDA: not installed<br>\nBAZEL:<br>\nBuild label: 0.4.1-homebrew<br>\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar<br>\nBuild time: Wed Nov 30 13:26:35 2016 (1480512395)<br>\nBuild timestamp: 1480512395<br>\nBuild timestamp as int: 1480512395</p>", "body_text": "@andrewharp Checked Android build with Bazel, followed these instuctions:\nhttps://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/android\nIncluding\nbazel build -c opt tensorflow/core:android_tensorflow_lib \\\n --crosstool_top=//external:android/crosstool \\\n --cpu=armeabi-v7a \\\n --host_crosstool_top=@bazel_tools//tools/cpp:toolchain\n\nBazel build script for libtensorflow_inference.so generates different compilation error:\nERROR: /Users/alivecor/tensorflow-bazel/tensorflow/contrib/android/BUILD:71:1: Linking of rule '//tensorflow/contrib/android:libtensorflow_inference.so' failed: sandbox-exec failed: error executing command /usr/bin/sandbox-exec -f /private/var/tmp/_bazel_alivecor/b205624d5e3f9e00e1da3a96f45ffc17/bazel-sandbox/5d59ce41-1e8b-441a-8550-c21d6358aaa7-749/sandbox.sb ... (remaining 32 argument(s) skipped).\ntensorflow/core/ops/math_ops.cc:1822: error: undefined reference to 'ceil'\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/cmath:185: error: undefined reference to 'ceilf'\ntensorflow/core/ops/nn_ops.cc:64: error: undefined reference to 'floorf'\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/cmath:185: error: undefined reference to 'ceilf'\n\nLog: bazel-android-inference.txt, Verbose: bazel-android-inference-verbose.txt\nNow I'm confused. It happens on more than one machine, so I don't believe they share same misconfiguration problems.\nWhat should be my next step? Should I stay on Makefile with neon and optimization switched off?Wouldn't it affect model execution? Or need to do extra steps for Bazel build?\nEnvironment\nMachine 1, (clean, OSX reinstalled):\nOSX: 10.11.6\nNDK: r12b\nCUDA: not installed\nBAZEL:\nBuild label: 0.4.3-homebrew\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Thu Dec 22 15:20:22 2016 (1482420022)\nBuild timestamp: 1482420022\nBuild timestamp as int: 1482420022\nMachine 2:\nOSX 10.12\nNDK: r12b\nCUDA: not installed\nBAZEL:\nBuild label: 0.4.1-homebrew\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Wed Nov 30 13:26:35 2016 (1480512395)\nBuild timestamp: 1480512395\nBuild timestamp as int: 1480512395", "body": "@andrewharp Checked Android build with Bazel, followed these instuctions:\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/android\r\nIncluding\r\n```\r\nbazel build -c opt tensorflow/core:android_tensorflow_lib \\\r\n --crosstool_top=//external:android/crosstool \\\r\n --cpu=armeabi-v7a \\\r\n --host_crosstool_top=@bazel_tools//tools/cpp:toolchain\r\n```\r\n\r\nBazel build script for libtensorflow_inference.so generates different compilation error:\r\n\r\n```\r\nERROR: /Users/alivecor/tensorflow-bazel/tensorflow/contrib/android/BUILD:71:1: Linking of rule '//tensorflow/contrib/android:libtensorflow_inference.so' failed: sandbox-exec failed: error executing command /usr/bin/sandbox-exec -f /private/var/tmp/_bazel_alivecor/b205624d5e3f9e00e1da3a96f45ffc17/bazel-sandbox/5d59ce41-1e8b-441a-8550-c21d6358aaa7-749/sandbox.sb ... (remaining 32 argument(s) skipped).\r\ntensorflow/core/ops/math_ops.cc:1822: error: undefined reference to 'ceil'\r\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/cmath:185: error: undefined reference to 'ceilf'\r\ntensorflow/core/ops/nn_ops.cc:64: error: undefined reference to 'floorf'\r\nexternal/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/include/cmath:185: error: undefined reference to 'ceilf'\r\n```\r\nLog: [bazel-android-inference.txt](https://github.com/tensorflow/tensorflow/files/700122/bazel-android-inference.txt), Verbose: [bazel-android-inference-verbose.txt](https://github.com/tensorflow/tensorflow/files/700219/bazel-android-inference-verbose.txt)\r\n\r\nNow I'm confused. It happens on more than one machine, so I don't believe they share same misconfiguration problems. \r\nWhat should be my next step? Should I stay on Makefile with neon and optimization switched off?Wouldn't it affect model execution? Or need to do extra steps for Bazel build?\r\n\r\n\r\n### Environment\r\nMachine 1, (clean, OSX reinstalled): \r\nOSX: 10.11.6\r\nNDK: r12b\r\nCUDA: not installed\r\nBAZEL:\r\nBuild label: 0.4.3-homebrew\r\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Thu Dec 22 15:20:22 2016 (1482420022)\r\nBuild timestamp: 1482420022\r\nBuild timestamp as int: 1482420022\r\n\r\nMachine 2:\r\nOSX 10.12\r\nNDK: r12b\r\nCUDA: not installed\r\nBAZEL:\r\nBuild label: 0.4.1-homebrew\r\nBuild target: bazel-out/local-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Wed Nov 30 13:26:35 2016 (1480512395)\r\nBuild timestamp: 1480512395\r\nBuild timestamp as int: 1480512395\r\n\r\n\r\n"}