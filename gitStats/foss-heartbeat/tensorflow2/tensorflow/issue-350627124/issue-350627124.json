{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21617", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21617/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21617/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21617/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21617", "id": 350627124, "node_id": "MDU6SXNzdWUzNTA2MjcxMjQ=", "number": 21617, "title": "Error trying to convert from saved model to tflite", "user": {"login": "jimenisimo", "id": 19747012, "node_id": "MDQ6VXNlcjE5NzQ3MDEy", "avatar_url": "https://avatars3.githubusercontent.com/u/19747012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimenisimo", "html_url": "https://github.com/jimenisimo", "followers_url": "https://api.github.com/users/jimenisimo/followers", "following_url": "https://api.github.com/users/jimenisimo/following{/other_user}", "gists_url": "https://api.github.com/users/jimenisimo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimenisimo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimenisimo/subscriptions", "organizations_url": "https://api.github.com/users/jimenisimo/orgs", "repos_url": "https://api.github.com/users/jimenisimo/repos", "events_url": "https://api.github.com/users/jimenisimo/events{/privacy}", "received_events_url": "https://api.github.com/users/jimenisimo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-08-14T23:01:26Z", "updated_at": "2018-08-23T18:17:08Z", "closed_at": "2018-08-23T18:17:08Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>OS Platform and Distribution: Linux Ubuntu 16.04</strong>:</li>\n<li><strong>TensorFlow installed from source</strong>:</li>\n<li><strong>TensorFlow version 1.10</strong>:</li>\n<li><strong>Python version 3.6</strong>:</li>\n<li><strong>Bazel version Build label: 0.16.0</strong>:</li>\n</ul>\n<p>While trying to convert a saved model to tflite file I get the following error:</p>\n<p>F tensorflow/contrib/lite/toco/tflite/export.cc:363] Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.contrib.lite.toco_convert(). Here is a list of operators for which you will need custom implementations: AsString, ParseExample.\\nAborted (core dumped)\\n' None</p>\n<p>I am using the DNN premade Estimator.</p>\n<pre><code>from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport numpy as np\nimport tensorflow as tf\nIRIS_TRAINING = \"iris_training.csv\"\nIRIS_TEST = \"iris_test.csv\"\nINPUT_TENSOR_NAME = 'inputs'\n\ndef main():\ntraining_set = tf.contrib.learn.datasets.base.load_csv_with_header(\n    filename=IRIS_TRAINING,\n    target_dtype=np.int,\n    features_dtype=np.float32)\n\nfeature_columns = [tf.feature_column.numeric_column(INPUT_TENSOR_NAME, shape=[4])]\n\n# Build 3 layer DNN with 10, 20, 10 units respectively.\nclassifier = tf.estimator.DNNClassifier(feature_columns=feature_columns,\n                           hidden_units=[10, 20, 10],\n                           n_classes=3,\n                           model_dir=\"/tmp/iris_model\")\n\n\n# Define the training inputs\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(\n    x={INPUT_TENSOR_NAME: np.array(training_set.data)},\n    y=np.array(training_set.target),\n    num_epochs=None,\n    shuffle=True)\n\n# Train model.\nclassifier.train(input_fn=train_input_fn, steps=2000)\n\ninputs = {'x': tf.placeholder(tf.float32, [4])}\ntf.estimator.export.ServingInputReceiver(inputs, inputs)\n\nsaved_model=classifier.export_savedmodel(export_dir_base=\"/tmp/iris_model\", serving_input_receiver_fn=serving_input_receiver_fn)\n\nconverter = tf.contrib.lite.TocoConverter.from_saved_model(saved_model)\ntflite_model = converter.convert()\n\ndef serving_input_receiver_fn():\n    feature_spec = {INPUT_TENSOR_NAME: tf.FixedLenFeature(dtype=tf.float32, shape=[4])}\n    return tf.estimator.export.build_parsing_serving_input_receiver_fn(feature_spec)()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>\n<p>Iris files can be downloaded form the following links:</p>\n<p>IRIS_TRAINING FILE: \"<a href=\"http://download.tensorflow.org/data/iris_training.csv\" rel=\"nofollow\">http://download.tensorflow.org/data/iris_training.csv</a>\"</p>\n<p>IRIS_TEST FILE: \"<a href=\"http://download.tensorflow.org/data/iris_test.csv\" rel=\"nofollow\">http://download.tensorflow.org/data/iris_test.csv</a>\"</p>", "body_text": "System information\n\nOS Platform and Distribution: Linux Ubuntu 16.04:\nTensorFlow installed from source:\nTensorFlow version 1.10:\nPython version 3.6:\nBazel version Build label: 0.16.0:\n\nWhile trying to convert a saved model to tflite file I get the following error:\nF tensorflow/contrib/lite/toco/tflite/export.cc:363] Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.contrib.lite.toco_convert(). Here is a list of operators for which you will need custom implementations: AsString, ParseExample.\\nAborted (core dumped)\\n' None\nI am using the DNN premade Estimator.\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport numpy as np\nimport tensorflow as tf\nIRIS_TRAINING = \"iris_training.csv\"\nIRIS_TEST = \"iris_test.csv\"\nINPUT_TENSOR_NAME = 'inputs'\n\ndef main():\ntraining_set = tf.contrib.learn.datasets.base.load_csv_with_header(\n    filename=IRIS_TRAINING,\n    target_dtype=np.int,\n    features_dtype=np.float32)\n\nfeature_columns = [tf.feature_column.numeric_column(INPUT_TENSOR_NAME, shape=[4])]\n\n# Build 3 layer DNN with 10, 20, 10 units respectively.\nclassifier = tf.estimator.DNNClassifier(feature_columns=feature_columns,\n                           hidden_units=[10, 20, 10],\n                           n_classes=3,\n                           model_dir=\"/tmp/iris_model\")\n\n\n# Define the training inputs\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(\n    x={INPUT_TENSOR_NAME: np.array(training_set.data)},\n    y=np.array(training_set.target),\n    num_epochs=None,\n    shuffle=True)\n\n# Train model.\nclassifier.train(input_fn=train_input_fn, steps=2000)\n\ninputs = {'x': tf.placeholder(tf.float32, [4])}\ntf.estimator.export.ServingInputReceiver(inputs, inputs)\n\nsaved_model=classifier.export_savedmodel(export_dir_base=\"/tmp/iris_model\", serving_input_receiver_fn=serving_input_receiver_fn)\n\nconverter = tf.contrib.lite.TocoConverter.from_saved_model(saved_model)\ntflite_model = converter.convert()\n\ndef serving_input_receiver_fn():\n    feature_spec = {INPUT_TENSOR_NAME: tf.FixedLenFeature(dtype=tf.float32, shape=[4])}\n    return tf.estimator.export.build_parsing_serving_input_receiver_fn(feature_spec)()\n\nif __name__ == \"__main__\":\n    main()\n\nIris files can be downloaded form the following links:\nIRIS_TRAINING FILE: \"http://download.tensorflow.org/data/iris_training.csv\"\nIRIS_TEST FILE: \"http://download.tensorflow.org/data/iris_test.csv\"", "body": "### System information\r\n- **OS Platform and Distribution: Linux Ubuntu 16.04**:\r\n- **TensorFlow installed from source**:\r\n- **TensorFlow version 1.10**:\r\n- **Python version 3.6**:\r\n- **Bazel version Build label: 0.16.0**:\r\n\r\nWhile trying to convert a saved model to tflite file I get the following error:\r\n\r\nF tensorflow/contrib/lite/toco/tflite/export.cc:363] Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.contrib.lite.toco_convert(). Here is a list of operators for which you will need custom implementations: AsString, ParseExample.\\nAborted (core dumped)\\n' None\r\n\r\nI am using the DNN premade Estimator.\r\n\r\n```\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\nIRIS_TRAINING = \"iris_training.csv\"\r\nIRIS_TEST = \"iris_test.csv\"\r\nINPUT_TENSOR_NAME = 'inputs'\r\n\r\ndef main():\r\ntraining_set = tf.contrib.learn.datasets.base.load_csv_with_header(\r\n    filename=IRIS_TRAINING,\r\n    target_dtype=np.int,\r\n    features_dtype=np.float32)\r\n\r\nfeature_columns = [tf.feature_column.numeric_column(INPUT_TENSOR_NAME, shape=[4])]\r\n\r\n# Build 3 layer DNN with 10, 20, 10 units respectively.\r\nclassifier = tf.estimator.DNNClassifier(feature_columns=feature_columns,\r\n                           hidden_units=[10, 20, 10],\r\n                           n_classes=3,\r\n                           model_dir=\"/tmp/iris_model\")\r\n\r\n\r\n# Define the training inputs\r\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(\r\n    x={INPUT_TENSOR_NAME: np.array(training_set.data)},\r\n    y=np.array(training_set.target),\r\n    num_epochs=None,\r\n    shuffle=True)\r\n\r\n# Train model.\r\nclassifier.train(input_fn=train_input_fn, steps=2000)\r\n\r\ninputs = {'x': tf.placeholder(tf.float32, [4])}\r\ntf.estimator.export.ServingInputReceiver(inputs, inputs)\r\n\r\nsaved_model=classifier.export_savedmodel(export_dir_base=\"/tmp/iris_model\", serving_input_receiver_fn=serving_input_receiver_fn)\r\n\r\nconverter = tf.contrib.lite.TocoConverter.from_saved_model(saved_model)\r\ntflite_model = converter.convert()\r\n\r\ndef serving_input_receiver_fn():\r\n    feature_spec = {INPUT_TENSOR_NAME: tf.FixedLenFeature(dtype=tf.float32, shape=[4])}\r\n    return tf.estimator.export.build_parsing_serving_input_receiver_fn(feature_spec)()\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n\r\nIris files can be downloaded form the following links:\r\n\r\nIRIS_TRAINING FILE: \"http://download.tensorflow.org/data/iris_training.csv\"\r\n\r\nIRIS_TEST FILE: \"http://download.tensorflow.org/data/iris_test.csv\""}