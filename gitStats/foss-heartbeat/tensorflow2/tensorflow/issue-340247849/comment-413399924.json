{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/413399924", "html_url": "https://github.com/tensorflow/tensorflow/issues/20698#issuecomment-413399924", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20698", "id": 413399924, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzM5OTkyNA==", "user": {"login": "keunwoochoi", "id": 16153797, "node_id": "MDQ6VXNlcjE2MTUzNzk3", "avatar_url": "https://avatars0.githubusercontent.com/u/16153797?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keunwoochoi", "html_url": "https://github.com/keunwoochoi", "followers_url": "https://api.github.com/users/keunwoochoi/followers", "following_url": "https://api.github.com/users/keunwoochoi/following{/other_user}", "gists_url": "https://api.github.com/users/keunwoochoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/keunwoochoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keunwoochoi/subscriptions", "organizations_url": "https://api.github.com/users/keunwoochoi/orgs", "repos_url": "https://api.github.com/users/keunwoochoi/repos", "events_url": "https://api.github.com/users/keunwoochoi/events{/privacy}", "received_events_url": "https://api.github.com/users/keunwoochoi/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T02:07:56Z", "updated_at": "2018-08-16T02:07:56Z", "author_association": "NONE", "body_html": "<p>My situation seems similar. The iterator of dataset fed to <code>model.fit</code> is made from <code>tf.data.Dataset.zip()</code></p>\n<div class=\"highlight highlight-source-python\"><pre>xy_ds <span class=\"pl-k\">=</span> (\n        tf.data.Dataset.zip((audio_ds, label_ds))\n            .batch(\n            <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span>batch_size,\n            <span class=\"pl-c\"><span class=\"pl-c\">#</span> drop_remainder=True if is_training else False</span>\n            )\n        .repeat(repeat)\n        .prefetch(tf.contrib.data.<span class=\"pl-c1\">AUTOTUNE</span>)\n    )</pre></div>\n<p>Both <code>audio_ds</code> (input) and <code>label_ds</code> (output) are instances of <code>tf.data.TextLineDataset</code>.</p>\n<div class=\"highlight highlight-source-python\"><pre>tf.data.TextLineDataset(id_path)\n            .map(load_audio, <span class=\"pl-v\">num_parallel_calls</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">N_READ_THREAD</span>)</pre></div>\n<p>Before fed to the model, its iterator is created.</p>\n<div class=\"highlight highlight-source-python\"><pre>tr_iterator <span class=\"pl-k\">=</span> tr_set.make_one_shot_iterator()\ntr_iterator.get_next()\n(<span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>IteratorGetNext:0<span class=\"pl-pds\">'</span></span> shape=<span class=\"pl-k\">&lt;</span>unknown<span class=\"pl-k\">&gt;</span> dtype=float32<span class=\"pl-k\">&gt;</span>, <span class=\"pl-k\">&lt;</span>tf.Tensor <span class=\"pl-s\"><span class=\"pl-pds\">'</span>IteratorGetNext:1<span class=\"pl-pds\">'</span></span> shape=<span class=\"pl-k\">&lt;</span>unknown<span class=\"pl-k\">&gt;</span> dtype=float32<span class=\"pl-k\">&gt;</span>)</pre></div>\n<p>And this is the error message when <code>model.fit()</code> is called.</p>\n<div class=\"highlight highlight-source-python\"><pre>  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>data_io.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">127</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n    model.fit(\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/keras/engine/training.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">950</span>, <span class=\"pl-k\">in</span> fit\n    <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span>batch_size)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/keras/engine/training.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">749</span>, <span class=\"pl-k\">in</span> _standardize_user_data\n    exception_prefix<span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>input<span class=\"pl-pds\">'</span></span>)\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">91</span>, <span class=\"pl-k\">in</span> standardize_input_data\n    data <span class=\"pl-k\">=</span> [standardize_single_array(x) <span class=\"pl-k\">for</span> x <span class=\"pl-k\">in</span> data]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">91</span>, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>listcomp<span class=\"pl-k\">&gt;</span>\n    data <span class=\"pl-k\">=</span> [standardize_single_array(x) <span class=\"pl-k\">for</span> x <span class=\"pl-k\">in</span> data]\n  File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py<span class=\"pl-pds\">\"</span></span>, line <span class=\"pl-c1\">26</span>, <span class=\"pl-k\">in</span> standardize_single_array\n    <span class=\"pl-k\">elif</span> x.ndim <span class=\"pl-k\">==</span> <span class=\"pl-c1\">1</span>:\n<span class=\"pl-c1\">AttributeError</span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>Iterator<span class=\"pl-pds\">'</span></span> <span class=\"pl-c1\">object</span> has no attribute <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ndim<span class=\"pl-pds\">'</span></span></pre></div>\n<p>tensorflow: 1.9.0, keras:2.2.2</p>", "body_text": "My situation seems similar. The iterator of dataset fed to model.fit is made from tf.data.Dataset.zip()\nxy_ds = (\n        tf.data.Dataset.zip((audio_ds, label_ds))\n            .batch(\n            batch_size=batch_size,\n            # drop_remainder=True if is_training else False\n            )\n        .repeat(repeat)\n        .prefetch(tf.contrib.data.AUTOTUNE)\n    )\nBoth audio_ds (input) and label_ds (output) are instances of tf.data.TextLineDataset.\ntf.data.TextLineDataset(id_path)\n            .map(load_audio, num_parallel_calls=N_READ_THREAD)\nBefore fed to the model, its iterator is created.\ntr_iterator = tr_set.make_one_shot_iterator()\ntr_iterator.get_next()\n(<tf.Tensor 'IteratorGetNext:0' shape=<unknown> dtype=float32>, <tf.Tensor 'IteratorGetNext:1' shape=<unknown> dtype=float32>)\nAnd this is the error message when model.fit() is called.\n  File \"data_io.py\", line 127, in <module>\n    model.fit(\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training.py\", line 950, in fit\n    batch_size=batch_size)\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training.py\", line 749, in _standardize_user_data\n    exception_prefix='input')\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py\", line 91, in standardize_input_data\n    data = [standardize_single_array(x) for x in data]\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py\", line 91, in <listcomp>\n    data = [standardize_single_array(x) for x in data]\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py\", line 26, in standardize_single_array\n    elif x.ndim == 1:\nAttributeError: 'Iterator' object has no attribute 'ndim'\ntensorflow: 1.9.0, keras:2.2.2", "body": "My situation seems similar. The iterator of dataset fed to `model.fit` is made from `tf.data.Dataset.zip()`\r\n```python\r\nxy_ds = (\r\n        tf.data.Dataset.zip((audio_ds, label_ds))\r\n            .batch(\r\n            batch_size=batch_size,\r\n            # drop_remainder=True if is_training else False\r\n            )\r\n        .repeat(repeat)\r\n        .prefetch(tf.contrib.data.AUTOTUNE)\r\n    )\r\n```\r\nBoth `audio_ds` (input) and `label_ds` (output) are instances of `tf.data.TextLineDataset`.\r\n```python\r\ntf.data.TextLineDataset(id_path)\r\n            .map(load_audio, num_parallel_calls=N_READ_THREAD)\r\n```\r\nBefore fed to the model, its iterator is created.\r\n```python\r\ntr_iterator = tr_set.make_one_shot_iterator()\r\ntr_iterator.get_next()\r\n(<tf.Tensor 'IteratorGetNext:0' shape=<unknown> dtype=float32>, <tf.Tensor 'IteratorGetNext:1' shape=<unknown> dtype=float32>)\r\n```\r\nAnd this is the error message when `model.fit()` is called.\r\n```python\r\n  File \"data_io.py\", line 127, in <module>\r\n    model.fit(\r\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training.py\", line 950, in fit\r\n    batch_size=batch_size)\r\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training.py\", line 749, in _standardize_user_data\r\n    exception_prefix='input')\r\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py\", line 91, in standardize_input_data\r\n    data = [standardize_single_array(x) for x in data]\r\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py\", line 91, in <listcomp>\r\n    data = [standardize_single_array(x) for x in data]\r\n  File \"/usr/local/lib/python3.5/dist-packages/keras/engine/training_utils.py\", line 26, in standardize_single_array\r\n    elif x.ndim == 1:\r\nAttributeError: 'Iterator' object has no attribute 'ndim'\r\n```\r\n\r\ntensorflow: 1.9.0, keras:2.2.2\r\n"}