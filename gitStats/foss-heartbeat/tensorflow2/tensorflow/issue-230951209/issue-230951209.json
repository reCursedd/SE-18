{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10153", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10153/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10153/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10153/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10153", "id": 230951209, "node_id": "MDU6SXNzdWUyMzA5NTEyMDk=", "number": 10153, "title": "Android: No OpKernel was registered to support Op 'ExtractImagePatches'", "user": {"login": "CHLLHC", "id": 12790956, "node_id": "MDQ6VXNlcjEyNzkwOTU2", "avatar_url": "https://avatars0.githubusercontent.com/u/12790956?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CHLLHC", "html_url": "https://github.com/CHLLHC", "followers_url": "https://api.github.com/users/CHLLHC/followers", "following_url": "https://api.github.com/users/CHLLHC/following{/other_user}", "gists_url": "https://api.github.com/users/CHLLHC/gists{/gist_id}", "starred_url": "https://api.github.com/users/CHLLHC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CHLLHC/subscriptions", "organizations_url": "https://api.github.com/users/CHLLHC/orgs", "repos_url": "https://api.github.com/users/CHLLHC/repos", "events_url": "https://api.github.com/users/CHLLHC/events{/privacy}", "received_events_url": "https://api.github.com/users/CHLLHC/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-05-24T07:55:08Z", "updated_at": "2018-01-28T22:11:55Z", "closed_at": "2017-05-26T04:53:31Z", "author_association": "NONE", "body_html": "<p>Hi, I have read (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"227107596\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9763\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9763/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9763\">#9763</a> =&gt;) <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"224674343\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9476\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9476/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9476\">#9476</a> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"190859299\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5764\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5764/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5764\">#5764</a> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"214899215\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8486\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8486/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/8486\">#8486</a> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"194882602\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/6260\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/6260/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/6260\">#6260</a> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"192173093\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5921\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5921/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5921\">#5921</a> (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"135957980\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1269\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1269/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1269\">#1269</a> This one is too old to be helpful).</p>\n<p>I was trying to use YOLOv2 on Android TensorFlow. I followed the exact same procedure stated in the README that successfully got the tiny-yolo-voc model running on my phones, the only different in the code is the filename. But I got the following error message and the app die.</p>\n<pre><code>FATAL EXCEPTION: inference\nProcess: org.tensorflow.demo, PID: 31154\njava.lang.IllegalArgumentException: No OpKernel was registered to support Op 'ExtractImagePatches' with these attrs.  Registered devices: [CPU], Registered kernels: &lt;no registered kernels&gt;\n                                                                     \n[[Node: ExtractImagePatches = ExtractImagePatches[T=DT_FLOAT, ksizes=[1, 2, 2, 1], padding=\"VALID\", rates=[1, 1, 1, 1], strides=[1, 2, 2, 1]](concat)]]\nat org.tensorflow.Session.run(Native Method)\nat org.tensorflow.Session.access$100(Session.java:48)\nat org.tensorflow.Session$Runner.runHelper(Session.java:295)\nat org.tensorflow.Session$Runner.run(Session.java:245)\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.run(TensorFlowInferenceInterface.java:142)\nat org.tensorflow.demo.TensorFlowYoloDetector.recognizeImage(TensorFlowYoloDetector.java:165)\nat org.tensorflow.demo.DetectorActivity$3.run(DetectorActivity.java:313)\nat android.os.Handler.handleCallback(Handler.java:755)\nat android.os.Handler.dispatchMessage(Handler.java:95)\nat android.os.Looper.loop(Looper.java:156)\nat android.os.HandlerThread.run(HandlerThread.java:61)\n</code></pre>\n<p>I also tried Yolo9000, it works (actually died because I didnot provide the matching label/name set, but it didnot yield the same error).</p>\n<ol>\n<li>I tried optimize_for_inference (<a href=\"https://petewarden.com/2016/09/27/tensorflow-for-mobile-poets/amp/\" rel=\"nofollow\">https://petewarden.com/2016/09/27/tensorflow-for-mobile-poets/amp/</a>), but the new pb file still have \"ExtractImagePatches\" op, so it didn't work for me.</li>\n</ol>\n<pre><code>$ grep \"ExtractImagePatches\" *\nBinary file graph-yolo-voc.pb matches\nBinary file opt.pb matches\n</code></pre>\n<ol start=\"2\">\n<li>I generated ops_to_register.h (shown below) and put it in tensorflow/tensorflow/core/framework dir (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"214899215\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8486\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8486/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/8486\">#8486</a>), and it didn't work for me.</li>\n</ol>\n<pre><code>#ifndef OPS_TO_REGISTER\n#define OPS_TO_REGISTER\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\n  return false\n     || (strcmp(op, \"BiasAdd\") == 0)\n     || (strcmp(op, \"ConcatV2\") == 0)\n     || (strcmp(op, \"Const\") == 0)\n     || (strcmp(op, \"Conv2D\") == 0)\n     || (strcmp(op, \"ExtractImagePatches\") == 0)\n     || (strcmp(op, \"Identity\") == 0)\n     || (strcmp(op, \"MaxPool\") == 0)\n     || (strcmp(op, \"Maximum\") == 0)\n     || (strcmp(op, \"Mul\") == 0)\n     || (strcmp(op, \"NoOp\") == 0)\n     || (strcmp(op, \"Pad\") == 0)\n     || (strcmp(op, \"Placeholder\") == 0)\n     || (strcmp(op, \"RealDiv\") == 0)\n     || (strcmp(op, \"Sub\") == 0)\n     || (strcmp(op, \"_Recv\") == 0)\n     || (strcmp(op, \"_Send\") == 0)\n  ;\n}\n#define SHOULD_REGISTER_OP(op) ShouldRegisterOp(op)\n\n\n    namespace {\n      constexpr const char* skip(const char* x) {\n        return (*x) ? (*x == ' ' ? skip(x + 1) : x) : x;\n      }\n\n      constexpr bool isequal(const char* x, const char* y) {\n        return (*skip(x) &amp;&amp; *skip(y))\n                   ? (*skip(x) == *skip(y) &amp;&amp; isequal(skip(x) + 1, skip(y) + 1))\n                   : (!*skip(x) &amp;&amp; !*skip(y));\n      }\n\n      template&lt;int N&gt;\n      struct find_in {\n        static constexpr bool f(const char* x, const char* const y[N]) {\n          return isequal(x, y[0]) || find_in&lt;N - 1&gt;::f(x, y + 1);\n        }\n      };\n\n      template&lt;&gt;\n      struct find_in&lt;0&gt; {\n        static constexpr bool f(const char* x, const char* const y[]) {\n          return false;\n        }\n      };\n    }  // end namespace\n    constexpr const char* kNecessaryOpKernelClasses[] = {\n\"BiasOp&lt;CPUDevice, float&gt;\",\n\"ConcatV2Op&lt;CPUDevice, float&gt;\",\n\"ConstantOp\",\n\"Conv2DOp&lt;CPUDevice, float&gt;\",\n\"ExtractImagePatchesOp&lt;CPUDevice, float&gt;\",\n\"IdentityOp\",\n\"MaxPoolingOp&lt;CPUDevice, float&gt;\",\n\"BinaryOp&lt;CPUDevice, functor::maximum&lt;float&gt;&gt;\",\n\"BinaryOp&lt;CPUDevice, functor::mul&lt;float&gt;&gt;\",\n\"NoOp\",\n\"PadOp&lt;CPUDevice, float&gt;\",\n\"PlaceholderOp\",\n\"BinaryOp&lt;CPUDevice, functor::div&lt;float&gt;&gt;\",\n\"BinaryOp&lt;CPUDevice, functor::sub&lt;float&gt;&gt;\",\n\"RecvOp\",\n\"SendOp\",\n};\n#define SHOULD_REGISTER_OP_KERNEL(clz) (find_in&lt;sizeof(kNecessaryOpKernelClasses) / sizeof(*kNecessaryOpKernelClasses)&gt;::f(clz, kNecessaryOpKernelClasses))\n\n#define SHOULD_REGISTER_OP_GRADIENT false\n#endif\n\n</code></pre>\n<ol start=\"3\">\n<li>I added <code>tensorflow/core/kernels/extract_image_patches_op.cc</code> to <code>tf_op_files.txt</code>(<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"190859299\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5764\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5764/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5764\">#5764</a>), and run bazel like this <code>$ bazel build -c opt //tensorflow/examples/android:tensorflow_demo --copt=\"-DSELECTIVE_REGISTRATION\" --define ANDROID_TYPES=__ANDROID_TYPES_FULL__</code> (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"224674343\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9476\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/9476/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/9476\">#9476</a>), still, didn't work for me.</li>\n</ol>\n<p>I am using ubuntu 16.04,<br>\nTensorFlow installed from (I think I did not install because I just <code>pip list</code> and tensorflow was not on that list. I just follow <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/android\">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/android</a> , and every thing works for tiny-yolo-voc),<br>\n[bazel release 0.4.5],<br>\nmy phone is running Android 7.0</p>\n<p>Thanks,<br>\nCHL</p>", "body_text": "Hi, I have read (#9763 =>) #9476 #5764 #8486 #6260 #5921 (#1269 This one is too old to be helpful).\nI was trying to use YOLOv2 on Android TensorFlow. I followed the exact same procedure stated in the README that successfully got the tiny-yolo-voc model running on my phones, the only different in the code is the filename. But I got the following error message and the app die.\nFATAL EXCEPTION: inference\nProcess: org.tensorflow.demo, PID: 31154\njava.lang.IllegalArgumentException: No OpKernel was registered to support Op 'ExtractImagePatches' with these attrs.  Registered devices: [CPU], Registered kernels: <no registered kernels>\n                                                                     \n[[Node: ExtractImagePatches = ExtractImagePatches[T=DT_FLOAT, ksizes=[1, 2, 2, 1], padding=\"VALID\", rates=[1, 1, 1, 1], strides=[1, 2, 2, 1]](concat)]]\nat org.tensorflow.Session.run(Native Method)\nat org.tensorflow.Session.access$100(Session.java:48)\nat org.tensorflow.Session$Runner.runHelper(Session.java:295)\nat org.tensorflow.Session$Runner.run(Session.java:245)\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.run(TensorFlowInferenceInterface.java:142)\nat org.tensorflow.demo.TensorFlowYoloDetector.recognizeImage(TensorFlowYoloDetector.java:165)\nat org.tensorflow.demo.DetectorActivity$3.run(DetectorActivity.java:313)\nat android.os.Handler.handleCallback(Handler.java:755)\nat android.os.Handler.dispatchMessage(Handler.java:95)\nat android.os.Looper.loop(Looper.java:156)\nat android.os.HandlerThread.run(HandlerThread.java:61)\n\nI also tried Yolo9000, it works (actually died because I didnot provide the matching label/name set, but it didnot yield the same error).\n\nI tried optimize_for_inference (https://petewarden.com/2016/09/27/tensorflow-for-mobile-poets/amp/), but the new pb file still have \"ExtractImagePatches\" op, so it didn't work for me.\n\n$ grep \"ExtractImagePatches\" *\nBinary file graph-yolo-voc.pb matches\nBinary file opt.pb matches\n\n\nI generated ops_to_register.h (shown below) and put it in tensorflow/tensorflow/core/framework dir (#8486), and it didn't work for me.\n\n#ifndef OPS_TO_REGISTER\n#define OPS_TO_REGISTER\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\n  return false\n     || (strcmp(op, \"BiasAdd\") == 0)\n     || (strcmp(op, \"ConcatV2\") == 0)\n     || (strcmp(op, \"Const\") == 0)\n     || (strcmp(op, \"Conv2D\") == 0)\n     || (strcmp(op, \"ExtractImagePatches\") == 0)\n     || (strcmp(op, \"Identity\") == 0)\n     || (strcmp(op, \"MaxPool\") == 0)\n     || (strcmp(op, \"Maximum\") == 0)\n     || (strcmp(op, \"Mul\") == 0)\n     || (strcmp(op, \"NoOp\") == 0)\n     || (strcmp(op, \"Pad\") == 0)\n     || (strcmp(op, \"Placeholder\") == 0)\n     || (strcmp(op, \"RealDiv\") == 0)\n     || (strcmp(op, \"Sub\") == 0)\n     || (strcmp(op, \"_Recv\") == 0)\n     || (strcmp(op, \"_Send\") == 0)\n  ;\n}\n#define SHOULD_REGISTER_OP(op) ShouldRegisterOp(op)\n\n\n    namespace {\n      constexpr const char* skip(const char* x) {\n        return (*x) ? (*x == ' ' ? skip(x + 1) : x) : x;\n      }\n\n      constexpr bool isequal(const char* x, const char* y) {\n        return (*skip(x) && *skip(y))\n                   ? (*skip(x) == *skip(y) && isequal(skip(x) + 1, skip(y) + 1))\n                   : (!*skip(x) && !*skip(y));\n      }\n\n      template<int N>\n      struct find_in {\n        static constexpr bool f(const char* x, const char* const y[N]) {\n          return isequal(x, y[0]) || find_in<N - 1>::f(x, y + 1);\n        }\n      };\n\n      template<>\n      struct find_in<0> {\n        static constexpr bool f(const char* x, const char* const y[]) {\n          return false;\n        }\n      };\n    }  // end namespace\n    constexpr const char* kNecessaryOpKernelClasses[] = {\n\"BiasOp<CPUDevice, float>\",\n\"ConcatV2Op<CPUDevice, float>\",\n\"ConstantOp\",\n\"Conv2DOp<CPUDevice, float>\",\n\"ExtractImagePatchesOp<CPUDevice, float>\",\n\"IdentityOp\",\n\"MaxPoolingOp<CPUDevice, float>\",\n\"BinaryOp<CPUDevice, functor::maximum<float>>\",\n\"BinaryOp<CPUDevice, functor::mul<float>>\",\n\"NoOp\",\n\"PadOp<CPUDevice, float>\",\n\"PlaceholderOp\",\n\"BinaryOp<CPUDevice, functor::div<float>>\",\n\"BinaryOp<CPUDevice, functor::sub<float>>\",\n\"RecvOp\",\n\"SendOp\",\n};\n#define SHOULD_REGISTER_OP_KERNEL(clz) (find_in<sizeof(kNecessaryOpKernelClasses) / sizeof(*kNecessaryOpKernelClasses)>::f(clz, kNecessaryOpKernelClasses))\n\n#define SHOULD_REGISTER_OP_GRADIENT false\n#endif\n\n\n\nI added tensorflow/core/kernels/extract_image_patches_op.cc to tf_op_files.txt(#5764), and run bazel like this $ bazel build -c opt //tensorflow/examples/android:tensorflow_demo --copt=\"-DSELECTIVE_REGISTRATION\" --define ANDROID_TYPES=__ANDROID_TYPES_FULL__ (#9476), still, didn't work for me.\n\nI am using ubuntu 16.04,\nTensorFlow installed from (I think I did not install because I just pip list and tensorflow was not on that list. I just follow https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/android , and every thing works for tiny-yolo-voc),\n[bazel release 0.4.5],\nmy phone is running Android 7.0\nThanks,\nCHL", "body": "Hi, I have read (#9763 =>) #9476 #5764 #8486 #6260 #5921 (#1269 This one is too old to be helpful).\r\n\r\nI was trying to use YOLOv2 on Android TensorFlow. I followed the exact same procedure stated in the README that successfully got the tiny-yolo-voc model running on my phones, the only different in the code is the filename. But I got the following error message and the app die.\r\n\r\n```\r\nFATAL EXCEPTION: inference\r\nProcess: org.tensorflow.demo, PID: 31154\r\njava.lang.IllegalArgumentException: No OpKernel was registered to support Op 'ExtractImagePatches' with these attrs.  Registered devices: [CPU], Registered kernels: <no registered kernels>\r\n                                                                     \r\n[[Node: ExtractImagePatches = ExtractImagePatches[T=DT_FLOAT, ksizes=[1, 2, 2, 1], padding=\"VALID\", rates=[1, 1, 1, 1], strides=[1, 2, 2, 1]](concat)]]\r\nat org.tensorflow.Session.run(Native Method)\r\nat org.tensorflow.Session.access$100(Session.java:48)\r\nat org.tensorflow.Session$Runner.runHelper(Session.java:295)\r\nat org.tensorflow.Session$Runner.run(Session.java:245)\r\nat org.tensorflow.contrib.android.TensorFlowInferenceInterface.run(TensorFlowInferenceInterface.java:142)\r\nat org.tensorflow.demo.TensorFlowYoloDetector.recognizeImage(TensorFlowYoloDetector.java:165)\r\nat org.tensorflow.demo.DetectorActivity$3.run(DetectorActivity.java:313)\r\nat android.os.Handler.handleCallback(Handler.java:755)\r\nat android.os.Handler.dispatchMessage(Handler.java:95)\r\nat android.os.Looper.loop(Looper.java:156)\r\nat android.os.HandlerThread.run(HandlerThread.java:61)\r\n```\r\n\r\nI also tried Yolo9000, it works (actually died because I didnot provide the matching label/name set, but it didnot yield the same error).\r\n\r\n1. I tried optimize_for_inference (https://petewarden.com/2016/09/27/tensorflow-for-mobile-poets/amp/), but the new pb file still have \"ExtractImagePatches\" op, so it didn't work for me.\r\n```\r\n$ grep \"ExtractImagePatches\" *\r\nBinary file graph-yolo-voc.pb matches\r\nBinary file opt.pb matches\r\n```\r\n\r\n2. I generated ops_to_register.h (shown below) and put it in tensorflow/tensorflow/core/framework dir (#8486), and it didn't work for me.\r\n```\r\n#ifndef OPS_TO_REGISTER\r\n#define OPS_TO_REGISTER\r\nconstexpr inline bool ShouldRegisterOp(const char op[]) {\r\n  return false\r\n     || (strcmp(op, \"BiasAdd\") == 0)\r\n     || (strcmp(op, \"ConcatV2\") == 0)\r\n     || (strcmp(op, \"Const\") == 0)\r\n     || (strcmp(op, \"Conv2D\") == 0)\r\n     || (strcmp(op, \"ExtractImagePatches\") == 0)\r\n     || (strcmp(op, \"Identity\") == 0)\r\n     || (strcmp(op, \"MaxPool\") == 0)\r\n     || (strcmp(op, \"Maximum\") == 0)\r\n     || (strcmp(op, \"Mul\") == 0)\r\n     || (strcmp(op, \"NoOp\") == 0)\r\n     || (strcmp(op, \"Pad\") == 0)\r\n     || (strcmp(op, \"Placeholder\") == 0)\r\n     || (strcmp(op, \"RealDiv\") == 0)\r\n     || (strcmp(op, \"Sub\") == 0)\r\n     || (strcmp(op, \"_Recv\") == 0)\r\n     || (strcmp(op, \"_Send\") == 0)\r\n  ;\r\n}\r\n#define SHOULD_REGISTER_OP(op) ShouldRegisterOp(op)\r\n\r\n\r\n    namespace {\r\n      constexpr const char* skip(const char* x) {\r\n        return (*x) ? (*x == ' ' ? skip(x + 1) : x) : x;\r\n      }\r\n\r\n      constexpr bool isequal(const char* x, const char* y) {\r\n        return (*skip(x) && *skip(y))\r\n                   ? (*skip(x) == *skip(y) && isequal(skip(x) + 1, skip(y) + 1))\r\n                   : (!*skip(x) && !*skip(y));\r\n      }\r\n\r\n      template<int N>\r\n      struct find_in {\r\n        static constexpr bool f(const char* x, const char* const y[N]) {\r\n          return isequal(x, y[0]) || find_in<N - 1>::f(x, y + 1);\r\n        }\r\n      };\r\n\r\n      template<>\r\n      struct find_in<0> {\r\n        static constexpr bool f(const char* x, const char* const y[]) {\r\n          return false;\r\n        }\r\n      };\r\n    }  // end namespace\r\n    constexpr const char* kNecessaryOpKernelClasses[] = {\r\n\"BiasOp<CPUDevice, float>\",\r\n\"ConcatV2Op<CPUDevice, float>\",\r\n\"ConstantOp\",\r\n\"Conv2DOp<CPUDevice, float>\",\r\n\"ExtractImagePatchesOp<CPUDevice, float>\",\r\n\"IdentityOp\",\r\n\"MaxPoolingOp<CPUDevice, float>\",\r\n\"BinaryOp<CPUDevice, functor::maximum<float>>\",\r\n\"BinaryOp<CPUDevice, functor::mul<float>>\",\r\n\"NoOp\",\r\n\"PadOp<CPUDevice, float>\",\r\n\"PlaceholderOp\",\r\n\"BinaryOp<CPUDevice, functor::div<float>>\",\r\n\"BinaryOp<CPUDevice, functor::sub<float>>\",\r\n\"RecvOp\",\r\n\"SendOp\",\r\n};\r\n#define SHOULD_REGISTER_OP_KERNEL(clz) (find_in<sizeof(kNecessaryOpKernelClasses) / sizeof(*kNecessaryOpKernelClasses)>::f(clz, kNecessaryOpKernelClasses))\r\n\r\n#define SHOULD_REGISTER_OP_GRADIENT false\r\n#endif\r\n\r\n```\r\n\r\n3. I added `tensorflow/core/kernels/extract_image_patches_op.cc` to `tf_op_files.txt`(#5764), and run bazel like this `$ bazel build -c opt //tensorflow/examples/android:tensorflow_demo --copt=\"-DSELECTIVE_REGISTRATION\" --define ANDROID_TYPES=__ANDROID_TYPES_FULL__` (#9476), still, didn't work for me.\r\n\r\nI am using ubuntu 16.04, \r\nTensorFlow installed from (I think I did not install because I just `pip list` and tensorflow was not on that list. I just follow https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/android , and every thing works for tiny-yolo-voc),\r\n[bazel release 0.4.5],\r\nmy phone is running Android 7.0\r\n\r\nThanks,\r\nCHL"}