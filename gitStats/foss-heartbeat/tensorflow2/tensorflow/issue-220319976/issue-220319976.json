{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9055", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9055/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9055/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9055/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9055", "id": 220319976, "node_id": "MDU6SXNzdWUyMjAzMTk5NzY=", "number": 9055, "title": "tf.matmul should be extended for rank 1 tensors", "user": {"login": "Utumno", "id": 1365079, "node_id": "MDQ6VXNlcjEzNjUwNzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/1365079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Utumno", "html_url": "https://github.com/Utumno", "followers_url": "https://api.github.com/users/Utumno/followers", "following_url": "https://api.github.com/users/Utumno/following{/other_user}", "gists_url": "https://api.github.com/users/Utumno/gists{/gist_id}", "starred_url": "https://api.github.com/users/Utumno/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Utumno/subscriptions", "organizations_url": "https://api.github.com/users/Utumno/orgs", "repos_url": "https://api.github.com/users/Utumno/repos", "events_url": "https://api.github.com/users/Utumno/events{/privacy}", "received_events_url": "https://api.github.com/users/Utumno/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2017-04-07T20:28:10Z", "updated_at": "2018-05-30T15:19:40Z", "closed_at": "2017-06-16T15:53:10Z", "author_association": "NONE", "body_html": "<p>This:</p>\n<pre><code>import numpy as np\na = np.array([1, 2, 1])\nw = np.array([[.5, .6], [.7, .8], [.7, .8]])\n\nprint(np.dot(a, w))\n# [ 2.6  3. ] # plain nice old matrix multiplication n x (n, m) -&gt; m\n\nimport tensorflow as tf\n\na = tf.constant(a, dtype=tf.float64)\nw = tf.constant(w)\n\nwith tf.Session() as sess:\n    print(tf.matmul(a, w).eval())\n</code></pre>\n<p>results in:</p>\n<pre><code>ValueError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\n</code></pre>\n<p>That's surprising and keeps tripping people up (see: <a href=\"http://stackoverflow.com/q/34908033/281545\" rel=\"nofollow\">http://stackoverflow.com/q/34908033/281545</a>,  <a href=\"http://stackoverflow.com/q/43284897/281545\" rel=\"nofollow\">http://stackoverflow.com/q/43284897/281545</a>, for instance), which is natural as matrix multiplication should not have any constraints apart from dimension alignment. Workarounds are verbose and complicated:</p>\n<pre><code>  print(tf.matmul(tf.expand_dims(a,0), w).eval())\n  print((tf.reduce_sum(tf.multiply(tf.expand_dims(a,-1), w), axis=0)).eval())\n  print((tf.reduce_sum(tf.multiply(a, tf.transpose(w)), axis=1)).eval())\n</code></pre>\n<h3>You must complete this information or else your issue will be closed</h3>\n<ul>\n<li><em>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)?</em>: yes</li>\n<li><em>TensorFlow installed from (source or binary)?</em>: pip</li>\n<li><em>TensorFlow version</em>: <code>tf.__version__</code> gives '1.0.1' - windows and python 3.5.2</li>\n<li><em>Bazel version (if compiling from source)</em>: -</li>\n<li><em>CUDA/cuDNN version</em>: -</li>\n<li><em>GPU Model and Memory</em>: -</li>\n<li><em>Exact command to reproduce</em>: see above</li>\n</ul>\n<h3>Source Code / Logs</h3>\n<p>Full traceback (why printing the same error twice ?)</p>\n<pre><code>C:\\_\\Python35\\python.exe C:/Users/MrD/.PyCharm2017.1/config/scratches/scratch_31.py\n[ 2.6  3. ]\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\nTraceback (most recent call last):\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 671, in _call_cpp_shape_fn_impl\n    input_tensors_as_shapes, status)\n  File \"C:\\_\\Python35\\lib\\contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:/Users/MrD/.PyCharm2017.1/config/scratches/scratch_31.py\", line 14, in &lt;module&gt;\n    print(tf.matmul(a, w).eval())\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1765, in matmul\n    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1454, in _mat_mul\n    transpose_b=transpose_b, name=name)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2329, in create_op\n    set_shapes_for_outputs(ret)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1717, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1667, in call_with_requiring\n    return call_cpp_shape_fn(op, require_shape_fn=True)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 610, in call_cpp_shape_fn\n    debug_python_shape_fn, require_shape_fn)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 676, in _call_cpp_shape_fn_impl\n    raise ValueError(err.message)\nValueError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\n\nProcess finished with exit code 1\n\n</code></pre>", "body_text": "This:\nimport numpy as np\na = np.array([1, 2, 1])\nw = np.array([[.5, .6], [.7, .8], [.7, .8]])\n\nprint(np.dot(a, w))\n# [ 2.6  3. ] # plain nice old matrix multiplication n x (n, m) -> m\n\nimport tensorflow as tf\n\na = tf.constant(a, dtype=tf.float64)\nw = tf.constant(w)\n\nwith tf.Session() as sess:\n    print(tf.matmul(a, w).eval())\n\nresults in:\nValueError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\n\nThat's surprising and keeps tripping people up (see: http://stackoverflow.com/q/34908033/281545,  http://stackoverflow.com/q/43284897/281545, for instance), which is natural as matrix multiplication should not have any constraints apart from dimension alignment. Workarounds are verbose and complicated:\n  print(tf.matmul(tf.expand_dims(a,0), w).eval())\n  print((tf.reduce_sum(tf.multiply(tf.expand_dims(a,-1), w), axis=0)).eval())\n  print((tf.reduce_sum(tf.multiply(a, tf.transpose(w)), axis=1)).eval())\n\nYou must complete this information or else your issue will be closed\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow)?: yes\nTensorFlow installed from (source or binary)?: pip\nTensorFlow version: tf.__version__ gives '1.0.1' - windows and python 3.5.2\nBazel version (if compiling from source): -\nCUDA/cuDNN version: -\nGPU Model and Memory: -\nExact command to reproduce: see above\n\nSource Code / Logs\nFull traceback (why printing the same error twice ?)\nC:\\_\\Python35\\python.exe C:/Users/MrD/.PyCharm2017.1/config/scratches/scratch_31.py\n[ 2.6  3. ]\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\nTraceback (most recent call last):\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 671, in _call_cpp_shape_fn_impl\n    input_tensors_as_shapes, status)\n  File \"C:\\_\\Python35\\lib\\contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:/Users/MrD/.PyCharm2017.1/config/scratches/scratch_31.py\", line 14, in <module>\n    print(tf.matmul(a, w).eval())\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1765, in matmul\n    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1454, in _mat_mul\n    transpose_b=transpose_b, name=name)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2329, in create_op\n    set_shapes_for_outputs(ret)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1717, in set_shapes_for_outputs\n    shapes = shape_func(op)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1667, in call_with_requiring\n    return call_cpp_shape_fn(op, require_shape_fn=True)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 610, in call_cpp_shape_fn\n    debug_python_shape_fn, require_shape_fn)\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 676, in _call_cpp_shape_fn_impl\n    raise ValueError(err.message)\nValueError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\n\nProcess finished with exit code 1", "body": "This:\r\n\r\n    import numpy as np\r\n    a = np.array([1, 2, 1])\r\n    w = np.array([[.5, .6], [.7, .8], [.7, .8]])\r\n    \r\n    print(np.dot(a, w))\r\n    # [ 2.6  3. ] # plain nice old matrix multiplication n x (n, m) -> m\r\n    \r\n    import tensorflow as tf\r\n    \r\n    a = tf.constant(a, dtype=tf.float64)\r\n    w = tf.constant(w)\r\n    \r\n    with tf.Session() as sess:\r\n        print(tf.matmul(a, w).eval())\r\n    \r\nresults in:\r\n\r\n    ValueError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\r\n\r\nThat's surprising and keeps tripping people up (see: http://stackoverflow.com/q/34908033/281545,  http://stackoverflow.com/q/43284897/281545, for instance), which is natural as matrix multiplication should not have any constraints apart from dimension alignment. Workarounds are verbose and complicated:\r\n\r\n```\r\n  print(tf.matmul(tf.expand_dims(a,0), w).eval())\r\n  print((tf.reduce_sum(tf.multiply(tf.expand_dims(a,-1), w), axis=0)).eval())\r\n  print((tf.reduce_sum(tf.multiply(a, tf.transpose(w)), axis=1)).eval())\r\n```\r\n\r\n### You must complete this information or else your issue will be closed\r\n- *Have I written custom code (as opposed to using a stock example script provided in TensorFlow)?*: yes\r\n- *TensorFlow installed from (source or binary)?*: pip\r\n- *TensorFlow version*: `tf.__version__` gives '1.0.1' - windows and python 3.5.2\r\n- *Bazel version (if compiling from source)*: -\r\n- *CUDA/cuDNN version*: -\r\n- *GPU Model and Memory*: -\r\n- *Exact command to reproduce*: see above\r\n\r\n### Source Code / Logs\r\n\r\nFull traceback (why printing the same error twice ?)\r\n\r\n```\r\nC:\\_\\Python35\\python.exe C:/Users/MrD/.PyCharm2017.1/config/scratches/scratch_31.py\r\n[ 2.6  3. ]\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"BestSplits\" device_type: \"CPU\"') for unknown op: BestSplits\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"CountExtremelyRandomStats\" device_type: \"CPU\"') for unknown op: CountExtremelyRandomStats\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"FinishedNodes\" device_type: \"CPU\"') for unknown op: FinishedNodes\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"GrowTree\" device_type: \"CPU\"') for unknown op: GrowTree\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ReinterpretStringToFloat\" device_type: \"CPU\"') for unknown op: ReinterpretStringToFloat\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"SampleInputs\" device_type: \"CPU\"') for unknown op: SampleInputs\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"ScatterAddNdim\" device_type: \"CPU\"') for unknown op: ScatterAddNdim\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNInsert\" device_type: \"CPU\"') for unknown op: TopNInsert\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TopNRemove\" device_type: \"CPU\"') for unknown op: TopNRemove\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"TreePredictions\" device_type: \"CPU\"') for unknown op: TreePredictions\r\nE c:\\tf_jenkins\\home\\workspace\\release-win\\device\\cpu\\os\\windows\\tensorflow\\core\\framework\\op_kernel.cc:943] OpKernel ('op: \"UpdateFertileSlots\" device_type: \"CPU\"') for unknown op: UpdateFertileSlots\r\nTraceback (most recent call last):\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 671, in _call_cpp_shape_fn_impl\r\n    input_tensors_as_shapes, status)\r\n  File \"C:\\_\\Python35\\lib\\contextlib.py\", line 66, in __exit__\r\n    next(self.gen)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py\", line 466, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:/Users/MrD/.PyCharm2017.1/config/scratches/scratch_31.py\", line 14, in <module>\r\n    print(tf.matmul(a, w).eval())\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 1765, in matmul\r\n    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 1454, in _mat_mul\r\n    transpose_b=transpose_b, name=name)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2329, in create_op\r\n    set_shapes_for_outputs(ret)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1717, in set_shapes_for_outputs\r\n    shapes = shape_func(op)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1667, in call_with_requiring\r\n    return call_cpp_shape_fn(op, require_shape_fn=True)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 610, in call_cpp_shape_fn\r\n    debug_python_shape_fn, require_shape_fn)\r\n  File \"C:\\_\\Python35\\lib\\site-packages\\tensorflow\\python\\framework\\common_shapes.py\", line 676, in _call_cpp_shape_fn_impl\r\n    raise ValueError(err.message)\r\nValueError: Shape must be rank 2 but is rank 1 for 'MatMul' (op: 'MatMul') with input shapes: [3], [3,2].\r\n\r\nProcess finished with exit code 1\r\n\r\n```"}