{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3349", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3349/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3349/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3349/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3349", "id": 165961937, "node_id": "MDU6SXNzdWUxNjU5NjE5Mzc=", "number": 3349, "title": "-mavx2 or -mavx prevents eigen from compiling", "user": {"login": "mccajm", "id": 3830784, "node_id": "MDQ6VXNlcjM4MzA3ODQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/3830784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mccajm", "html_url": "https://github.com/mccajm", "followers_url": "https://api.github.com/users/mccajm/followers", "following_url": "https://api.github.com/users/mccajm/following{/other_user}", "gists_url": "https://api.github.com/users/mccajm/gists{/gist_id}", "starred_url": "https://api.github.com/users/mccajm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mccajm/subscriptions", "organizations_url": "https://api.github.com/users/mccajm/orgs", "repos_url": "https://api.github.com/users/mccajm/repos", "events_url": "https://api.github.com/users/mccajm/events{/privacy}", "received_events_url": "https://api.github.com/users/mccajm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2016-07-17T05:39:11Z", "updated_at": "2016-09-04T12:01:57Z", "closed_at": "2016-08-16T15:52:00Z", "author_association": "NONE", "body_html": "<p>I'm compiling the master branch of TensorFlow as follows:</p>\n<blockquote>\n<p>bazel build -c opt --copt=-mavx2 --config=cuda //tensorflow/tools/pip_package:build_pip_package</p>\n</blockquote>\n<p>and receive the error:</p>\n<blockquote>\n<p>ERROR: /tmp/tensorflow/tensorflow/contrib/ffmpeg/BUILD:22:1: C++ compilation of rule '//tensorflow/contrib/ffmpeg:decode_audio_op_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object ... (remaining 57 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.<br>\nIn file included from ./third_party/eigen3/unsupported/Eigen/CXX11/FixedPoint:36:0,<br>\nfrom ./tensorflow/core/framework/types.h:27,<br>\nfrom ./tensorflow/core/framework/type_traits.h:22,<br>\nfrom ./tensorflow/core/framework/allocator.h:25,<br>\nfrom ./tensorflow/core/framework/op_kernel.h:22,<br>\nfrom tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:<br>\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:347:8: error: 'scalar_multiple2_op' is not a class template<br>\nstruct scalar_multiple2_op&lt;QInt32, double&gt; {<br>\n^<br>\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:347:44: error: explicit specialization of non-template 'Eigen::internal::scalar_multiple2_op'<br>\nstruct scalar_multiple2_op&lt;QInt32, double&gt; {<br>\n^<br>\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:369:23: error: 'Eigen::internal::scalar_multiple2_op' is not a template<br>\nstruct functor_traits&lt;scalar_multiple2_op&lt;QInt32, double&gt;&gt; {<br>\n^<br>\nIn file included from ./tensorflow/core/framework/op_kernel.h:22:0,<br>\nfrom tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:<br>\n./tensorflow/core/framework/allocator.h: In member function 'virtual std::size_t tensorflow::Allocator::RequestedSize(void_)':<br>\n./tensorflow/core/framework/allocator.h:155:3: warning: control reaches end of non-void function [-Wreturn-type]<br>\n}<br>\n^<br>\nIn file included from ./tensorflow/core/framework/op_kernel.h:25:0,<br>\nfrom tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:<br>\n./tensorflow/core/framework/device_base.h: In member function 'virtual tensorflow::Allocator_ tensorflow::DeviceBase::GetAllocator(tensorflow::AllocatorAttributes)':<br>\n./tensorflow/core/framework/device_base.h:151:3: warning: control reaches end of non-void function [-Wreturn-type]<br>\n}<br>\n^<br>\n./tensorflow/core/framework/device_base.h: In member function 'virtual const tensorflow::DeviceAttributes&amp; tensorflow::DeviceBase::attributes() const':<br>\n./tensorflow/core/framework/device_base.h:182:3: warning: control reaches end of non-void function [-Wreturn-type]<br>\n}<br>\n^</p>\n</blockquote>\n<p>/proc/cpuinfo shows my CPU has avx2 support:</p>\n<blockquote>\n<p>processor       : 31<br>\nmodel name      : Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz<br>\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm ida arat epb pln pts dtherm tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 <strong>avx2</strong> smep bmi2 erms invpcid cqm xsaveopt cqm_llc</p>\n</blockquote>", "body_text": "I'm compiling the master branch of TensorFlow as follows:\n\nbazel build -c opt --copt=-mavx2 --config=cuda //tensorflow/tools/pip_package:build_pip_package\n\nand receive the error:\n\nERROR: /tmp/tensorflow/tensorflow/contrib/ffmpeg/BUILD:22:1: C++ compilation of rule '//tensorflow/contrib/ffmpeg:decode_audio_op_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object ... (remaining 57 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nIn file included from ./third_party/eigen3/unsupported/Eigen/CXX11/FixedPoint:36:0,\nfrom ./tensorflow/core/framework/types.h:27,\nfrom ./tensorflow/core/framework/type_traits.h:22,\nfrom ./tensorflow/core/framework/allocator.h:25,\nfrom ./tensorflow/core/framework/op_kernel.h:22,\nfrom tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:347:8: error: 'scalar_multiple2_op' is not a class template\nstruct scalar_multiple2_op<QInt32, double> {\n^\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:347:44: error: explicit specialization of non-template 'Eigen::internal::scalar_multiple2_op'\nstruct scalar_multiple2_op<QInt32, double> {\n^\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:369:23: error: 'Eigen::internal::scalar_multiple2_op' is not a template\nstruct functor_traits<scalar_multiple2_op<QInt32, double>> {\n^\nIn file included from ./tensorflow/core/framework/op_kernel.h:22:0,\nfrom tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:\n./tensorflow/core/framework/allocator.h: In member function 'virtual std::size_t tensorflow::Allocator::RequestedSize(void_)':\n./tensorflow/core/framework/allocator.h:155:3: warning: control reaches end of non-void function [-Wreturn-type]\n}\n^\nIn file included from ./tensorflow/core/framework/op_kernel.h:25:0,\nfrom tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:\n./tensorflow/core/framework/device_base.h: In member function 'virtual tensorflow::Allocator_ tensorflow::DeviceBase::GetAllocator(tensorflow::AllocatorAttributes)':\n./tensorflow/core/framework/device_base.h:151:3: warning: control reaches end of non-void function [-Wreturn-type]\n}\n^\n./tensorflow/core/framework/device_base.h: In member function 'virtual const tensorflow::DeviceAttributes& tensorflow::DeviceBase::attributes() const':\n./tensorflow/core/framework/device_base.h:182:3: warning: control reaches end of non-void function [-Wreturn-type]\n}\n^\n\n/proc/cpuinfo shows my CPU has avx2 support:\n\nprocessor       : 31\nmodel name      : Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm ida arat epb pln pts dtherm tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm xsaveopt cqm_llc", "body": "I'm compiling the master branch of TensorFlow as follows:\n\n> bazel build -c opt --copt=-mavx2 --config=cuda //tensorflow/tools/pip_package:build_pip_package\n\nand receive the error:\n\n> ERROR: /tmp/tensorflow/tensorflow/contrib/ffmpeg/BUILD:22:1: C++ compilation of rule '//tensorflow/contrib/ffmpeg:decode_audio_op_cc' failed: crosstool_wrapper_driver_is_not_gcc failed: error executing command third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object ... (remaining 57 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\n> In file included from ./third_party/eigen3/unsupported/Eigen/CXX11/FixedPoint:36:0,\n>                  from ./tensorflow/core/framework/types.h:27,\n>                  from ./tensorflow/core/framework/type_traits.h:22,\n>                  from ./tensorflow/core/framework/allocator.h:25,\n>                  from ./tensorflow/core/framework/op_kernel.h:22,\n>                  from tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:\n> ./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:347:8: error: 'scalar_multiple2_op' is not a class template\n>  struct scalar_multiple2_op<QInt32, double> {\n>         ^\n> ./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:347:44: error: explicit specialization of non-template 'Eigen::internal::scalar_multiple2_op'\n>  struct scalar_multiple2_op<QInt32, double> {\n>                                             ^\n> ./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX2.h:369:23: error: 'Eigen::internal::scalar_multiple2_op' is not a template\n>  struct functor_traits<scalar_multiple2_op<QInt32, double>> {\n>                        ^\n> In file included from ./tensorflow/core/framework/op_kernel.h:22:0,\n>                  from tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:\n> ./tensorflow/core/framework/allocator.h: In member function 'virtual std::size_t tensorflow::Allocator::RequestedSize(void_)':\n> ./tensorflow/core/framework/allocator.h:155:3: warning: control reaches end of non-void function [-Wreturn-type]\n>    }\n>    ^\n> In file included from ./tensorflow/core/framework/op_kernel.h:25:0,\n>                  from tensorflow/contrib/ffmpeg/decode_audio_op.cc:23:\n> ./tensorflow/core/framework/device_base.h: In member function 'virtual tensorflow::Allocator_ tensorflow::DeviceBase::GetAllocator(tensorflow::AllocatorAttributes)':\n> ./tensorflow/core/framework/device_base.h:151:3: warning: control reaches end of non-void function [-Wreturn-type]\n>    }\n>    ^\n> ./tensorflow/core/framework/device_base.h: In member function 'virtual const tensorflow::DeviceAttributes& tensorflow::DeviceBase::attributes() const':\n> ./tensorflow/core/framework/device_base.h:182:3: warning: control reaches end of non-void function [-Wreturn-type]\n>    }\n>    ^\n\n/proc/cpuinfo shows my CPU has avx2 support:\n\n> processor       : 31\n> model name      : Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz\n> flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm ida arat epb pln pts dtherm tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 **avx2** smep bmi2 erms invpcid cqm xsaveopt cqm_llc \n"}