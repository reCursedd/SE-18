{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22306", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22306/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22306/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22306/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22306", "id": 360726354, "node_id": "MDU6SXNzdWUzNjA3MjYzNTQ=", "number": 22306, "title": "why options in session_config like intra_op_parallelism_threads/inter_op_parallelism_threads doesn't work in tensorflow estimator distribution mode\uff1f", "user": {"login": "guoguo11191", "id": 41990276, "node_id": "MDQ6VXNlcjQxOTkwMjc2", "avatar_url": "https://avatars3.githubusercontent.com/u/41990276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guoguo11191", "html_url": "https://github.com/guoguo11191", "followers_url": "https://api.github.com/users/guoguo11191/followers", "following_url": "https://api.github.com/users/guoguo11191/following{/other_user}", "gists_url": "https://api.github.com/users/guoguo11191/gists{/gist_id}", "starred_url": "https://api.github.com/users/guoguo11191/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guoguo11191/subscriptions", "organizations_url": "https://api.github.com/users/guoguo11191/orgs", "repos_url": "https://api.github.com/users/guoguo11191/repos", "events_url": "https://api.github.com/users/guoguo11191/events{/privacy}", "received_events_url": "https://api.github.com/users/guoguo11191/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "jart", "id": 49262, "node_id": "MDQ6VXNlcjQ5MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/49262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jart", "html_url": "https://github.com/jart", "followers_url": "https://api.github.com/users/jart/followers", "following_url": "https://api.github.com/users/jart/following{/other_user}", "gists_url": "https://api.github.com/users/jart/gists{/gist_id}", "starred_url": "https://api.github.com/users/jart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jart/subscriptions", "organizations_url": "https://api.github.com/users/jart/orgs", "repos_url": "https://api.github.com/users/jart/repos", "events_url": "https://api.github.com/users/jart/events{/privacy}", "received_events_url": "https://api.github.com/users/jart/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jart", "id": 49262, "node_id": "MDQ6VXNlcjQ5MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/49262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jart", "html_url": "https://github.com/jart", "followers_url": "https://api.github.com/users/jart/followers", "following_url": "https://api.github.com/users/jart/following{/other_user}", "gists_url": "https://api.github.com/users/jart/gists{/gist_id}", "starred_url": "https://api.github.com/users/jart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jart/subscriptions", "organizations_url": "https://api.github.com/users/jart/orgs", "repos_url": "https://api.github.com/users/jart/repos", "events_url": "https://api.github.com/users/jart/events{/privacy}", "received_events_url": "https://api.github.com/users/jart/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-17T05:25:31Z", "updated_at": "2018-11-20T07:56:23Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:just tried to import it.</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:CentOS Linux release 7.2</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>:</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:binary</li>\n<li><strong>TensorFlow version (use command below)</strong>:1.7 to 1.10</li>\n<li><strong>Python version</strong>:2.7</li>\n<li><strong>Bazel version (if compiling from source)</strong>:N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:N/A</li>\n<li><strong>CUDA/cuDNN version</strong>:N/A</li>\n<li><strong>CPU model and memory</strong>:Intel(R) Xeon(R) CPU E5-2670 v3 @ 2.30GHz,128G</li>\n<li><strong>Exact command to reproduce</strong>:N/A</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>when i set intra_op_parallelism_threads/inter_op_parallelism_threads for estimator dist mode like this:<br>\n<code>config = tf.ConfigProto() config.intra_op_parallelism_threads = 4 config.inter_op_parallelism_threads = 4 run_config = tf.estimator.RunConfig().replace(session_config=config) model = tf.estimator.DNNLinearCombinedClassifier( model_dir=model_dir, linear_feature_columns=wide_columns, dnn_feature_columns=deep_columns, dnn_hidden_units=hidden_units, config=run_config)</code><br>\nit doesn't work, i find the options isn't passed to kernals:</p>\n<p>tensorflow/python/estimator/training.py<br>\n<code>if config.session_config is None: session_config = config_pb2.ConfigProto(log_device_placement=False) else: session_config = config_pb2.ConfigProto( log_device_placement=False, gpu_options=config.session_config.gpu_options)</code><br>\nonly a few options are set, the code above indicate intra_op_parallelism_threads/inter_op_parallelism_threads have no effect\uff0cis a bug\uff1fwhy\uff1f</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):just tried to import it.\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):CentOS Linux release 7.2\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\nTensorFlow installed from (source or binary):binary\nTensorFlow version (use command below):1.7 to 1.10\nPython version:2.7\nBazel version (if compiling from source):N/A\nGCC/Compiler version (if compiling from source):N/A\nCUDA/cuDNN version:N/A\nCPU model and memory:Intel(R) Xeon(R) CPU E5-2670 v3 @ 2.30GHz,128G\nExact command to reproduce:N/A\n\nDescribe the problem\nwhen i set intra_op_parallelism_threads/inter_op_parallelism_threads for estimator dist mode like this:\nconfig = tf.ConfigProto() config.intra_op_parallelism_threads = 4 config.inter_op_parallelism_threads = 4 run_config = tf.estimator.RunConfig().replace(session_config=config) model = tf.estimator.DNNLinearCombinedClassifier( model_dir=model_dir, linear_feature_columns=wide_columns, dnn_feature_columns=deep_columns, dnn_hidden_units=hidden_units, config=run_config)\nit doesn't work, i find the options isn't passed to kernals:\ntensorflow/python/estimator/training.py\nif config.session_config is None: session_config = config_pb2.ConfigProto(log_device_placement=False) else: session_config = config_pb2.ConfigProto( log_device_placement=False, gpu_options=config.session_config.gpu_options)\nonly a few options are set, the code above indicate intra_op_parallelism_threads/inter_op_parallelism_threads have no effect\uff0cis a bug\uff1fwhy\uff1f", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:just tried to import it.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:CentOS Linux release 7.2\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:binary\r\n- **TensorFlow version (use command below)**:1.7 to 1.10\r\n- **Python version**:2.7\r\n- **Bazel version (if compiling from source)**:N/A\r\n- **GCC/Compiler version (if compiling from source)**:N/A\r\n- **CUDA/cuDNN version**:N/A\r\n- **CPU model and memory**:Intel(R) Xeon(R) CPU E5-2670 v3 @ 2.30GHz,128G\r\n- **Exact command to reproduce**:N/A\r\n\r\n### Describe the problem\r\nwhen i set intra_op_parallelism_threads/inter_op_parallelism_threads for estimator dist mode like this:\r\n`config = tf.ConfigProto()\r\nconfig.intra_op_parallelism_threads = 4\r\nconfig.inter_op_parallelism_threads = 4\r\nrun_config = tf.estimator.RunConfig().replace(session_config=config)\r\nmodel = tf.estimator.DNNLinearCombinedClassifier(\r\n            model_dir=model_dir,\r\n            linear_feature_columns=wide_columns,\r\n            dnn_feature_columns=deep_columns,\r\n            dnn_hidden_units=hidden_units,\r\n            config=run_config)`\r\nit doesn't work, i find the options isn't passed to kernals:\r\n\r\ntensorflow/python/estimator/training.py\r\n`if config.session_config is None:\r\n  session_config = config_pb2.ConfigProto(log_device_placement=False)\r\nelse:\r\n  session_config = config_pb2.ConfigProto(\r\n\t  log_device_placement=False,\r\n\t  gpu_options=config.session_config.gpu_options)`\r\nonly a few options are set, the code above indicate intra_op_parallelism_threads/inter_op_parallelism_threads have no effect\uff0cis a bug\uff1fwhy\uff1f\r\n"}