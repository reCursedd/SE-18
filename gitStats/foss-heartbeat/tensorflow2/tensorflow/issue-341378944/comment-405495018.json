{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/405495018", "html_url": "https://github.com/tensorflow/tensorflow/issues/20825#issuecomment-405495018", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20825", "id": 405495018, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTQ5NTAxOA==", "user": {"login": "longchr123", "id": 15262666, "node_id": "MDQ6VXNlcjE1MjYyNjY2", "avatar_url": "https://avatars0.githubusercontent.com/u/15262666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/longchr123", "html_url": "https://github.com/longchr123", "followers_url": "https://api.github.com/users/longchr123/followers", "following_url": "https://api.github.com/users/longchr123/following{/other_user}", "gists_url": "https://api.github.com/users/longchr123/gists{/gist_id}", "starred_url": "https://api.github.com/users/longchr123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/longchr123/subscriptions", "organizations_url": "https://api.github.com/users/longchr123/orgs", "repos_url": "https://api.github.com/users/longchr123/repos", "events_url": "https://api.github.com/users/longchr123/events{/privacy}", "received_events_url": "https://api.github.com/users/longchr123/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-17T08:00:01Z", "updated_at": "2018-07-17T08:00:15Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=667809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/karmel\">@karmel</a>  I should change mobilenet_v1_1.0_224_frozen.pb to mobilenet.pb  from</p>\n<pre><code>bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/path/to/mobilenet_v1_1.0_224_frozen.pb --input_checkpoint=/path/to/mobilenet_v1_1.0_224.ckpt --output_graph=/path/to/freezed_mobilenet.pb --output_node_names=MobilenetV1/Predictions/Reshape_1 --input_binary=true\n</code></pre>\n<p>like this:</p>\n<pre><code>bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/path/to/mobilenet.pb --input_checkpoint=/path/to/mobilenet_v1_1.0_224.ckpt --output_graph=/path/to/freezed_mobilenet.pb --output_node_names=MobilenetV1/Predictions/Reshape_1 --input_binary=true\n</code></pre>\n<p>Code to generate mobilenet.pb file:</p>\n<pre><code>def freeze_graph(ckpt_dir):\n    output_graph = os.path.join(MODEL_DIR, MODEL_NAME)\n    output_node_names = \"output\"\n    saver = tf.train.import_meta_graph(ckpt_dir + '.meta', clear_devices=True)\n\n    graph = tf.get_default_graph()\n    input_graph_def = graph.as_graph_def()\n\n    with tf.Session() as sess:\n        saver.restore(sess, ckpt_dir)\n\n        output_graph_def = graph_util.convert_variables_to_constants(\n            sess,\n            input_graph_def,\n            output_node_names.split(\",\")\n        )\n        with tf.gfile.GFile(output_graph, \"wb\") as f:\n            f.write(output_graph_def.SerializeToString())\n        print(\"%d ops in the final graph.\" % len(output_graph_def.node))\n\n        for op in graph.get_operations():\n            print(op.name, op.values())\n</code></pre>\n<p>Is the action of graph_util.convert_variables_to_constants and command(bazel...freeze_graph ) the same?</p>", "body_text": "@karmel  I should change mobilenet_v1_1.0_224_frozen.pb to mobilenet.pb  from\nbazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/path/to/mobilenet_v1_1.0_224_frozen.pb --input_checkpoint=/path/to/mobilenet_v1_1.0_224.ckpt --output_graph=/path/to/freezed_mobilenet.pb --output_node_names=MobilenetV1/Predictions/Reshape_1 --input_binary=true\n\nlike this:\nbazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/path/to/mobilenet.pb --input_checkpoint=/path/to/mobilenet_v1_1.0_224.ckpt --output_graph=/path/to/freezed_mobilenet.pb --output_node_names=MobilenetV1/Predictions/Reshape_1 --input_binary=true\n\nCode to generate mobilenet.pb file:\ndef freeze_graph(ckpt_dir):\n    output_graph = os.path.join(MODEL_DIR, MODEL_NAME)\n    output_node_names = \"output\"\n    saver = tf.train.import_meta_graph(ckpt_dir + '.meta', clear_devices=True)\n\n    graph = tf.get_default_graph()\n    input_graph_def = graph.as_graph_def()\n\n    with tf.Session() as sess:\n        saver.restore(sess, ckpt_dir)\n\n        output_graph_def = graph_util.convert_variables_to_constants(\n            sess,\n            input_graph_def,\n            output_node_names.split(\",\")\n        )\n        with tf.gfile.GFile(output_graph, \"wb\") as f:\n            f.write(output_graph_def.SerializeToString())\n        print(\"%d ops in the final graph.\" % len(output_graph_def.node))\n\n        for op in graph.get_operations():\n            print(op.name, op.values())\n\nIs the action of graph_util.convert_variables_to_constants and command(bazel...freeze_graph ) the same?", "body": "@karmel  I should change mobilenet_v1_1.0_224_frozen.pb to mobilenet.pb  from\r\n```\r\nbazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/path/to/mobilenet_v1_1.0_224_frozen.pb --input_checkpoint=/path/to/mobilenet_v1_1.0_224.ckpt --output_graph=/path/to/freezed_mobilenet.pb --output_node_names=MobilenetV1/Predictions/Reshape_1 --input_binary=true\r\n```\r\n\r\nlike this:\r\n```\r\nbazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/path/to/mobilenet.pb --input_checkpoint=/path/to/mobilenet_v1_1.0_224.ckpt --output_graph=/path/to/freezed_mobilenet.pb --output_node_names=MobilenetV1/Predictions/Reshape_1 --input_binary=true\r\n```\r\n\r\nCode to generate mobilenet.pb file:\r\n```\r\ndef freeze_graph(ckpt_dir):\r\n    output_graph = os.path.join(MODEL_DIR, MODEL_NAME)\r\n    output_node_names = \"output\"\r\n    saver = tf.train.import_meta_graph(ckpt_dir + '.meta', clear_devices=True)\r\n\r\n    graph = tf.get_default_graph()\r\n    input_graph_def = graph.as_graph_def()\r\n\r\n    with tf.Session() as sess:\r\n        saver.restore(sess, ckpt_dir)\r\n\r\n        output_graph_def = graph_util.convert_variables_to_constants(\r\n            sess,\r\n            input_graph_def,\r\n            output_node_names.split(\",\")\r\n        )\r\n        with tf.gfile.GFile(output_graph, \"wb\") as f:\r\n            f.write(output_graph_def.SerializeToString())\r\n        print(\"%d ops in the final graph.\" % len(output_graph_def.node))\r\n\r\n        for op in graph.get_operations():\r\n            print(op.name, op.values())\r\n```\r\n\r\nIs the action of graph_util.convert_variables_to_constants and command(bazel...freeze_graph ) the same?"}