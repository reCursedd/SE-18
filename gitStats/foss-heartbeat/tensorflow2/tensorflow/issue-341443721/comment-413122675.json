{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/413122675", "html_url": "https://github.com/tensorflow/tensorflow/issues/20833#issuecomment-413122675", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20833", "id": 413122675, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzEyMjY3NQ==", "user": {"login": "tobegit3hub", "id": 2715000, "node_id": "MDQ6VXNlcjI3MTUwMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/2715000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobegit3hub", "html_url": "https://github.com/tobegit3hub", "followers_url": "https://api.github.com/users/tobegit3hub/followers", "following_url": "https://api.github.com/users/tobegit3hub/following{/other_user}", "gists_url": "https://api.github.com/users/tobegit3hub/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobegit3hub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobegit3hub/subscriptions", "organizations_url": "https://api.github.com/users/tobegit3hub/orgs", "repos_url": "https://api.github.com/users/tobegit3hub/repos", "events_url": "https://api.github.com/users/tobegit3hub/events{/privacy}", "received_events_url": "https://api.github.com/users/tobegit3hub/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-15T07:56:13Z", "updated_at": "2018-08-15T07:56:13Z", "author_association": "CONTRIBUTOR", "body_html": "<p>We have the similar problem in <code>TensorFlow 1.8.0</code> when using <code>MonitoredSession </code> and  <code>SyncReplicasOptimizer</code> in distributed training. The parameter <code>ignore_live_threads</code> is in Coordinator and I'm not sure if we can set in <code>MonitoredSession</code>.</p>\n<p>Here is the error log of trying to close the session.</p>\n<pre><code>INFO:tensorflow:Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany\n2018-08-15 15:50:02 INFO     Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany\nException in thread QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany:\nTraceback (most recent call last):\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.py\", line 810, in __bootstrap_inner\n    self.run()\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.py\", line 763, in run\n    self.__target(*self.__args, **self.__kwargs)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 268, in _run\n    coord.request_stop(e)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/coordinator.py\", line 213, in request_stop\n    six.reraise(*sys.exc_info())\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 252, in _run\n    enqueue_callable()\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1244, in _single_operation_run\n    self._call_tf_sessionrun(None, {}, [], target_list, None)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\n    run_metadata)\nCancelledError: Step was cancelled by an explicit call to `Session::Close()`.\n</code></pre>", "body_text": "We have the similar problem in TensorFlow 1.8.0 when using MonitoredSession  and  SyncReplicasOptimizer in distributed training. The parameter ignore_live_threads is in Coordinator and I'm not sure if we can set in MonitoredSession.\nHere is the error log of trying to close the session.\nINFO:tensorflow:Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany\n2018-08-15 15:50:02 INFO     Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany\nException in thread QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany:\nTraceback (most recent call last):\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.py\", line 810, in __bootstrap_inner\n    self.run()\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.py\", line 763, in run\n    self.__target(*self.__args, **self.__kwargs)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 268, in _run\n    coord.request_stop(e)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/coordinator.py\", line 213, in request_stop\n    six.reraise(*sys.exc_info())\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 252, in _run\n    enqueue_callable()\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1244, in _single_operation_run\n    self._call_tf_sessionrun(None, {}, [], target_list, None)\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\n    run_metadata)\nCancelledError: Step was cancelled by an explicit call to `Session::Close()`.", "body": "We have the similar problem in `TensorFlow 1.8.0` when using `MonitoredSession ` and  `SyncReplicasOptimizer` in distributed training. The parameter `ignore_live_threads` is in Coordinator and I'm not sure if we can set in `MonitoredSession`.\r\n\r\nHere is the error log of trying to close the session.\r\n\r\n```\r\nINFO:tensorflow:Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany\r\n2018-08-15 15:50:02 INFO     Coordinator stopped with threads still running: QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany\r\nException in thread QueueRunnerThread-dummy_queue-sync_token_q_EnqueueMany:\r\nTraceback (most recent call last):\r\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.py\", line 810, in __bootstrap_inner\r\n    self.run()\r\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.py\", line 763, in run\r\n    self.__target(*self.__args, **self.__kwargs)\r\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 268, in _run\r\n    coord.request_stop(e)\r\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/coordinator.py\", line 213, in request_stop\r\n    six.reraise(*sys.exc_info())\r\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 252, in _run\r\n    enqueue_callable()\r\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1244, in _single_operation_run\r\n    self._call_tf_sessionrun(None, {}, [], target_list, None)\r\n  File \"/usr/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\r\n    run_metadata)\r\nCancelledError: Step was cancelled by an explicit call to `Session::Close()`.\r\n```"}