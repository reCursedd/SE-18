{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/289542279", "html_url": "https://github.com/tensorflow/tensorflow/issues/8702#issuecomment-289542279", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8702", "id": 289542279, "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTU0MjI3OQ==", "user": {"login": "liuyipei", "id": 4404828, "node_id": "MDQ6VXNlcjQ0MDQ4Mjg=", "avatar_url": "https://avatars0.githubusercontent.com/u/4404828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liuyipei", "html_url": "https://github.com/liuyipei", "followers_url": "https://api.github.com/users/liuyipei/followers", "following_url": "https://api.github.com/users/liuyipei/following{/other_user}", "gists_url": "https://api.github.com/users/liuyipei/gists{/gist_id}", "starred_url": "https://api.github.com/users/liuyipei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liuyipei/subscriptions", "organizations_url": "https://api.github.com/users/liuyipei/orgs", "repos_url": "https://api.github.com/users/liuyipei/repos", "events_url": "https://api.github.com/users/liuyipei/events{/privacy}", "received_events_url": "https://api.github.com/users/liuyipei/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-27T18:28:42Z", "updated_at": "2017-03-27T18:30:14Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7946809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gunan\">@gunan</a><br>\nApparently, the bzl file contents are being run on some super-restricted subset of python, with questionable behavior. It can't seem to import, and is missing functions like <code>ord</code> and <code>print</code>. <code>lstrip</code> also has strange behavior. The only way I can get anything to print to console was to use the <code>auto_configure_fail</code> function.</p>\n<p>I added these lines as a diagnostic, and the results are very strange. (the lines were inserted right before the location I mentioned above, as bazel is trying to parse cudnn.h to figure out the installed cudnn versions).<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/ede5ebe54f0689a53eeaf0fb1c9a25f136ab3a69/third_party/gpus/cuda_configure.bzl#L280\">tensorflow/third_party/gpus/cuda_configure.bzl</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 280\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/ede5ebe54f0689a53eeaf0fb1c9a25f136ab3a69\">ede5ebe</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L280\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"280\"></td>\n          <td id=\"LC280\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">return</span> lines[<span class=\"pl-c1\">0</span>].replace(define, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>).strip() </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<pre><code>space_padded = lines[0].replace(define, \"\")  \nmanual = ''.join([c for c in space_padded if c in \"0123456789\"])\nauto_configure_fail(manual + \"/\" + lines[0] + \"/\" + space_padded + \"/\" + space_padded.lstrip()  )\n</code></pre>\n<p>The output is</p>\n<pre><code>Auto-Configuration Error: 01315/#define CUDNN_MAJOR      5/      5/      5\n</code></pre>\n<p>It appears that basic character iteration and <code>lstrip</code> are both broken. <code>ord</code> is not available so I couldn't print out hex-values easily for the string characters.<br>\nI think there is something wrong with the python interpreter that is being used by bazel.</p>", "body_text": "@gunan\nApparently, the bzl file contents are being run on some super-restricted subset of python, with questionable behavior. It can't seem to import, and is missing functions like ord and print. lstrip also has strange behavior. The only way I can get anything to print to console was to use the auto_configure_fail function.\nI added these lines as a diagnostic, and the results are very strange. (the lines were inserted right before the location I mentioned above, as bazel is trying to parse cudnn.h to figure out the installed cudnn versions).\n\n  \n    \n      tensorflow/third_party/gpus/cuda_configure.bzl\n    \n    \n         Line 280\n      in\n      ede5ebe\n    \n    \n    \n    \n\n        \n          \n           return lines[0].replace(define, \"\").strip() \n        \n    \n  \n\n\nspace_padded = lines[0].replace(define, \"\")  \nmanual = ''.join([c for c in space_padded if c in \"0123456789\"])\nauto_configure_fail(manual + \"/\" + lines[0] + \"/\" + space_padded + \"/\" + space_padded.lstrip()  )\n\nThe output is\nAuto-Configuration Error: 01315/#define CUDNN_MAJOR      5/      5/      5\n\nIt appears that basic character iteration and lstrip are both broken. ord is not available so I couldn't print out hex-values easily for the string characters.\nI think there is something wrong with the python interpreter that is being used by bazel.", "body": "@gunan \r\nApparently, the bzl file contents are being run on some super-restricted subset of python, with questionable behavior. It can't seem to import, and is missing functions like `ord` and `print`. `lstrip` also has strange behavior. The only way I can get anything to print to console was to use the `auto_configure_fail` function.\r\n\r\nI added these lines as a diagnostic, and the results are very strange. (the lines were inserted right before the location I mentioned above, as bazel is trying to parse cudnn.h to figure out the installed cudnn versions).\r\nhttps://github.com/tensorflow/tensorflow/blob/ede5ebe54f0689a53eeaf0fb1c9a25f136ab3a69/third_party/gpus/cuda_configure.bzl#L280\r\n```\r\nspace_padded = lines[0].replace(define, \"\")  \r\nmanual = ''.join([c for c in space_padded if c in \"0123456789\"])\r\nauto_configure_fail(manual + \"/\" + lines[0] + \"/\" + space_padded + \"/\" + space_padded.lstrip()  )\r\n```\r\n\r\nThe output is \r\n```\r\nAuto-Configuration Error: 01315/#define CUDNN_MAJOR      5/      5/      5\r\n```\r\nIt appears that basic character iteration and `lstrip` are both broken. `ord` is not available so I couldn't print out hex-values easily for the string characters.\r\nI think there is something wrong with the python interpreter that is being used by bazel."}