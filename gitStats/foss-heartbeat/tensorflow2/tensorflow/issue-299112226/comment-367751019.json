{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/367751019", "html_url": "https://github.com/tensorflow/tensorflow/issues/17175#issuecomment-367751019", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17175", "id": 367751019, "node_id": "MDEyOklzc3VlQ29tbWVudDM2Nzc1MTAxOQ==", "user": {"login": "ipeirotis", "id": 152561, "node_id": "MDQ6VXNlcjE1MjU2MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/152561?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ipeirotis", "html_url": "https://github.com/ipeirotis", "followers_url": "https://api.github.com/users/ipeirotis/followers", "following_url": "https://api.github.com/users/ipeirotis/following{/other_user}", "gists_url": "https://api.github.com/users/ipeirotis/gists{/gist_id}", "starred_url": "https://api.github.com/users/ipeirotis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ipeirotis/subscriptions", "organizations_url": "https://api.github.com/users/ipeirotis/orgs", "repos_url": "https://api.github.com/users/ipeirotis/repos", "events_url": "https://api.github.com/users/ipeirotis/events{/privacy}", "received_events_url": "https://api.github.com/users/ipeirotis/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-22T17:09:40Z", "updated_at": "2018-02-22T17:19:31Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Here is an example:</p>\n<pre><code>K = 5\nd = np.zeros([K,K])\nfor s in range(K):\n    for q in range(K):\n        d[s,q] = q-s\nd = tf.constant(d)\nd\n</code></pre>\n<pre><code>&lt;tf.Tensor: id=179, shape=(5, 5), dtype=float64, numpy=\narray([[ 0.,  1.,  2.,  3.,  4.],\n       [-1.,  0.,  1.,  2.,  3.],\n       [-2., -1.,  0.,  1.,  2.],\n       [-3., -2., -1.,  0.,  1.],\n       [-4., -3., -2., -1.,  0.]])&gt;\n</code></pre>\n<hr>\n<p>Here is the correct output (the signature contains no spaces)</p>\n<pre><code>tf.einsum(\"xy,z-&gt;zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\n</code></pre>\n<p>results in:</p>\n<pre><code>&lt;tf.Tensor: id=136, shape=(3, 5, 5), dtype=float64, numpy=\narray([[[ 0.,  1.,  2.,  3.,  4.],\n        [-1.,  0.,  1.,  2.,  3.],\n        [-2., -1.,  0.,  1.,  2.],\n        [-3., -2., -1.,  0.,  1.],\n        [-4., -3., -2., -1.,  0.]],\n\n       [[ 0.,  1.,  2.,  3.,  4.],\n        [-1.,  0.,  1.,  2.,  3.],\n        [-2., -1.,  0.,  1.,  2.],\n        [-3., -2., -1.,  0.,  1.],\n        [-4., -3., -2., -1.,  0.]],\n\n       [[ 0.,  1.,  2.,  3.,  4.],\n        [-1.,  0.,  1.,  2.,  3.],\n        [-2., -1.,  0.,  1.,  2.],\n        [-3., -2., -1.,  0.,  1.],\n        [-4., -3., -2., -1.,  0.]]])&gt;\n</code></pre>\n<hr>\n<p>And here is a buggy version (with spaces in the signature)</p>\n<pre><code>tf.einsum(\"xy,z -&gt; zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\n</code></pre>\n<p>results in:</p>\n<pre><code>&lt;tf.Tensor: id=177, shape=(5, 5, 3), dtype=float64, numpy=\narray([[[ 0.,  0.,  0.],\n        [ 1.,  1.,  1.],\n        [ 2.,  2.,  2.],\n        [ 3.,  3.,  3.],\n        [ 4.,  4.,  4.]],\n\n       [[-1., -1., -1.],\n        [ 0.,  0.,  0.],\n        [ 1.,  1.,  1.],\n        [ 2.,  2.,  2.],\n        [ 3.,  3.,  3.]],\n\n       [[-2., -2., -2.],\n        [-1., -1., -1.],\n        [ 0.,  0.,  0.],\n        [ 1.,  1.,  1.],\n        [ 2.,  2.,  2.]],\n\n       [[-3., -3., -3.],\n        [-2., -2., -2.],\n        [-1., -1., -1.],\n        [ 0.,  0.,  0.],\n        [ 1.,  1.,  1.]],\n\n       [[-4., -4., -4.],\n        [-3., -3., -3.],\n        [-2., -2., -2.],\n        [-1., -1., -1.],\n        [ 0.,  0.,  0.]]])&gt;\n</code></pre>\n<hr>\n<p>And</p>\n<pre><code>tf.einsum(\"xy,z-&gt; zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\n</code></pre>\n<p>results in:</p>\n<pre><code>&lt;tf.Tensor: id=151, shape=(), dtype=float64, numpy=0.0&gt;\n</code></pre>", "body_text": "Here is an example:\nK = 5\nd = np.zeros([K,K])\nfor s in range(K):\n    for q in range(K):\n        d[s,q] = q-s\nd = tf.constant(d)\nd\n\n<tf.Tensor: id=179, shape=(5, 5), dtype=float64, numpy=\narray([[ 0.,  1.,  2.,  3.,  4.],\n       [-1.,  0.,  1.,  2.,  3.],\n       [-2., -1.,  0.,  1.,  2.],\n       [-3., -2., -1.,  0.,  1.],\n       [-4., -3., -2., -1.,  0.]])>\n\n\nHere is the correct output (the signature contains no spaces)\ntf.einsum(\"xy,z->zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\n\nresults in:\n<tf.Tensor: id=136, shape=(3, 5, 5), dtype=float64, numpy=\narray([[[ 0.,  1.,  2.,  3.,  4.],\n        [-1.,  0.,  1.,  2.,  3.],\n        [-2., -1.,  0.,  1.,  2.],\n        [-3., -2., -1.,  0.,  1.],\n        [-4., -3., -2., -1.,  0.]],\n\n       [[ 0.,  1.,  2.,  3.,  4.],\n        [-1.,  0.,  1.,  2.,  3.],\n        [-2., -1.,  0.,  1.,  2.],\n        [-3., -2., -1.,  0.,  1.],\n        [-4., -3., -2., -1.,  0.]],\n\n       [[ 0.,  1.,  2.,  3.,  4.],\n        [-1.,  0.,  1.,  2.,  3.],\n        [-2., -1.,  0.,  1.,  2.],\n        [-3., -2., -1.,  0.,  1.],\n        [-4., -3., -2., -1.,  0.]]])>\n\n\nAnd here is a buggy version (with spaces in the signature)\ntf.einsum(\"xy,z -> zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\n\nresults in:\n<tf.Tensor: id=177, shape=(5, 5, 3), dtype=float64, numpy=\narray([[[ 0.,  0.,  0.],\n        [ 1.,  1.,  1.],\n        [ 2.,  2.,  2.],\n        [ 3.,  3.,  3.],\n        [ 4.,  4.,  4.]],\n\n       [[-1., -1., -1.],\n        [ 0.,  0.,  0.],\n        [ 1.,  1.,  1.],\n        [ 2.,  2.,  2.],\n        [ 3.,  3.,  3.]],\n\n       [[-2., -2., -2.],\n        [-1., -1., -1.],\n        [ 0.,  0.,  0.],\n        [ 1.,  1.,  1.],\n        [ 2.,  2.,  2.]],\n\n       [[-3., -3., -3.],\n        [-2., -2., -2.],\n        [-1., -1., -1.],\n        [ 0.,  0.,  0.],\n        [ 1.,  1.,  1.]],\n\n       [[-4., -4., -4.],\n        [-3., -3., -3.],\n        [-2., -2., -2.],\n        [-1., -1., -1.],\n        [ 0.,  0.,  0.]]])>\n\n\nAnd\ntf.einsum(\"xy,z-> zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\n\nresults in:\n<tf.Tensor: id=151, shape=(), dtype=float64, numpy=0.0>", "body": "Here is an example:\r\n\r\n```\r\nK = 5\r\nd = np.zeros([K,K])\r\nfor s in range(K):\r\n    for q in range(K):\r\n        d[s,q] = q-s\r\nd = tf.constant(d)\r\nd\r\n```\r\n\r\n```\r\n<tf.Tensor: id=179, shape=(5, 5), dtype=float64, numpy=\r\narray([[ 0.,  1.,  2.,  3.,  4.],\r\n       [-1.,  0.,  1.,  2.,  3.],\r\n       [-2., -1.,  0.,  1.,  2.],\r\n       [-3., -2., -1.,  0.,  1.],\r\n       [-4., -3., -2., -1.,  0.]])>\r\n```\r\n----\r\nHere is the correct output (the signature contains no spaces)\r\n```\r\ntf.einsum(\"xy,z->zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\r\n```\r\nresults in:\r\n```\r\n<tf.Tensor: id=136, shape=(3, 5, 5), dtype=float64, numpy=\r\narray([[[ 0.,  1.,  2.,  3.,  4.],\r\n        [-1.,  0.,  1.,  2.,  3.],\r\n        [-2., -1.,  0.,  1.,  2.],\r\n        [-3., -2., -1.,  0.,  1.],\r\n        [-4., -3., -2., -1.,  0.]],\r\n\r\n       [[ 0.,  1.,  2.,  3.,  4.],\r\n        [-1.,  0.,  1.,  2.,  3.],\r\n        [-2., -1.,  0.,  1.,  2.],\r\n        [-3., -2., -1.,  0.,  1.],\r\n        [-4., -3., -2., -1.,  0.]],\r\n\r\n       [[ 0.,  1.,  2.,  3.,  4.],\r\n        [-1.,  0.,  1.,  2.,  3.],\r\n        [-2., -1.,  0.,  1.,  2.],\r\n        [-3., -2., -1.,  0.,  1.],\r\n        [-4., -3., -2., -1.,  0.]]])>\r\n```\r\n----\r\nAnd here is a buggy version (with spaces in the signature)\r\n\r\n```\r\ntf.einsum(\"xy,z -> zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\r\n```\r\nresults in:\r\n```\r\n<tf.Tensor: id=177, shape=(5, 5, 3), dtype=float64, numpy=\r\narray([[[ 0.,  0.,  0.],\r\n        [ 1.,  1.,  1.],\r\n        [ 2.,  2.,  2.],\r\n        [ 3.,  3.,  3.],\r\n        [ 4.,  4.,  4.]],\r\n\r\n       [[-1., -1., -1.],\r\n        [ 0.,  0.,  0.],\r\n        [ 1.,  1.,  1.],\r\n        [ 2.,  2.,  2.],\r\n        [ 3.,  3.,  3.]],\r\n\r\n       [[-2., -2., -2.],\r\n        [-1., -1., -1.],\r\n        [ 0.,  0.,  0.],\r\n        [ 1.,  1.,  1.],\r\n        [ 2.,  2.,  2.]],\r\n\r\n       [[-3., -3., -3.],\r\n        [-2., -2., -2.],\r\n        [-1., -1., -1.],\r\n        [ 0.,  0.,  0.],\r\n        [ 1.,  1.,  1.]],\r\n\r\n       [[-4., -4., -4.],\r\n        [-3., -3., -3.],\r\n        [-2., -2., -2.],\r\n        [-1., -1., -1.],\r\n        [ 0.,  0.,  0.]]])>\r\n```\r\n\r\n----\r\nAnd\r\n```\r\ntf.einsum(\"xy,z-> zxy\", xy, tf.ones(shape=[3], dtype=tf.float64) )\r\n```\r\nresults in:\r\n```\r\n<tf.Tensor: id=151, shape=(), dtype=float64, numpy=0.0>\r\n```"}