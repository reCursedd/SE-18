{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/356867539", "html_url": "https://github.com/tensorflow/tensorflow/issues/15985#issuecomment-356867539", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15985", "id": 356867539, "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njg2NzUzOQ==", "user": {"login": "selcouthlyBlue", "id": 13268675, "node_id": "MDQ6VXNlcjEzMjY4Njc1", "avatar_url": "https://avatars2.githubusercontent.com/u/13268675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/selcouthlyBlue", "html_url": "https://github.com/selcouthlyBlue", "followers_url": "https://api.github.com/users/selcouthlyBlue/followers", "following_url": "https://api.github.com/users/selcouthlyBlue/following{/other_user}", "gists_url": "https://api.github.com/users/selcouthlyBlue/gists{/gist_id}", "starred_url": "https://api.github.com/users/selcouthlyBlue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/selcouthlyBlue/subscriptions", "organizations_url": "https://api.github.com/users/selcouthlyBlue/orgs", "repos_url": "https://api.github.com/users/selcouthlyBlue/repos", "events_url": "https://api.github.com/users/selcouthlyBlue/events{/privacy}", "received_events_url": "https://api.github.com/users/selcouthlyBlue/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-11T08:54:22Z", "updated_at": "2018-01-11T09:01:00Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I'm not sure if this is how it's done but here's what I got so far: <a href=\"https://stackoverflow.com/questions/39838234/sparse-matrix-from-a-dense-one-tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/39838234/sparse-matrix-from-a-dense-one-tensorflow</a></p>\n<pre><code># labels is a dense tensor\nindices = tf.where(tf.not_equal(labels, 0))\nvalues = tf.gather_nd(labels, indices)\nshape = ???\nsparse_labels = tf.SparseTensor(indices, values, dense_shape=shape)\n</code></pre>\n<p>I've tried the following:</p>\n<ol>\n<li>If shape = labels.get_shape(), I get <code>ValueError: Cannot convert a partially known TensorShape to a Tensor: (?, 33)</code></li>\n<li>If shape = (1, 33) or tf.shape(labels, out_type=tf.int64), I get <code>ValueError: Shape must be rank 1 but is rank 0 for 'CTCLoss' (op: 'CTCLoss') with input shapes: [?,?,80], [?,2], [?], [].</code></li>\n</ol>", "body_text": "I'm not sure if this is how it's done but here's what I got so far: https://stackoverflow.com/questions/39838234/sparse-matrix-from-a-dense-one-tensorflow\n# labels is a dense tensor\nindices = tf.where(tf.not_equal(labels, 0))\nvalues = tf.gather_nd(labels, indices)\nshape = ???\nsparse_labels = tf.SparseTensor(indices, values, dense_shape=shape)\n\nI've tried the following:\n\nIf shape = labels.get_shape(), I get ValueError: Cannot convert a partially known TensorShape to a Tensor: (?, 33)\nIf shape = (1, 33) or tf.shape(labels, out_type=tf.int64), I get ValueError: Shape must be rank 1 but is rank 0 for 'CTCLoss' (op: 'CTCLoss') with input shapes: [?,?,80], [?,2], [?], [].", "body": "I'm not sure if this is how it's done but here's what I got so far: https://stackoverflow.com/questions/39838234/sparse-matrix-from-a-dense-one-tensorflow\r\n\r\n```\r\n# labels is a dense tensor\r\nindices = tf.where(tf.not_equal(labels, 0))\r\nvalues = tf.gather_nd(labels, indices)\r\nshape = ???\r\nsparse_labels = tf.SparseTensor(indices, values, dense_shape=shape)\r\n```\r\n\r\nI've tried the following:\r\n\r\n1. If shape = labels.get_shape(), I get `ValueError: Cannot convert a partially known TensorShape to a Tensor: (?, 33)`\r\n2. If shape = (1, 33) or tf.shape(labels, out_type=tf.int64), I get `ValueError: Shape must be rank 1 but is rank 0 for 'CTCLoss' (op: 'CTCLoss') with input shapes: [?,?,80], [?,2], [?], [].`"}