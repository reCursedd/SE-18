{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/366544970", "html_url": "https://github.com/tensorflow/tensorflow/issues/17067#issuecomment-366544970", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17067", "id": 366544970, "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjU0NDk3MA==", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-18T20:28:52Z", "updated_at": "2018-02-18T20:28:52Z", "author_association": "NONE", "body_html": "<p>The work around that I mentioned in a <a href=\"https://github.com/tensorflow/tensorflow/issues/17067#issuecomment-366496974\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/17067/hovercard\">previous comment</a> was half-baked. I have created a fork of protobuf containing all of the changes which appear to be necessary. To use this fork, I applied the following patch to <code>tensorflow/workspace.bzl</code>:</p>\n<div class=\"highlight highlight-source-diff\"><pre><span class=\"pl-md\">--- a/tensorflow/workspace.bzl</span>\n<span class=\"pl-mi1\">+++ b/tensorflow/workspace.bzl</span>\n<span class=\"pl-mdr\">@@ -353,11 +353,11 @@</span> def tf_workspace(path_prefix=\"\", tf_repo_name=\"\"):\n   tf_http_archive(\n       name = \"protobuf_archive\",\n       urls = [\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>          \"https://mirror.bazel.build/github.com/google/protobuf/archive/396336eb961b75f03b25824fe86cf6490fb75e3a.tar.gz\",</span>\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>          \"https://github.com/google/protobuf/archive/396336eb961b75f03b25824fe86cf6490fb75e3a.tar.gz\",</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>          \"https://mirror.bazel.build/github.com/dtrebbien/protobuf/archive/50f552646ba1de79e07562b41f3999fe036b4fd0.tar.gz\",</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>          \"https://github.com/dtrebbien/protobuf/archive/50f552646ba1de79e07562b41f3999fe036b4fd0.tar.gz\",</span>\n       ],\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>      sha256 = \"846d907acf472ae233ec0882ef3a2d24edbbe834b80c305e867ac65a1f2c59e3\",</span>\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>      strip_prefix = \"protobuf-396336eb961b75f03b25824fe86cf6490fb75e3a\",</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>      sha256 = \"eb16b33431b91fe8cee479575cee8de202f3626aaf00d9bf1783c6e62b4ffbc7\",</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>      strip_prefix = \"protobuf-50f552646ba1de79e07562b41f3999fe036b4fd0\",</span>\n   )\n \n   # We need to import the protobuf library under the names com_google_protobuf</pre></div>", "body_text": "The work around that I mentioned in a previous comment was half-baked. I have created a fork of protobuf containing all of the changes which appear to be necessary. To use this fork, I applied the following patch to tensorflow/workspace.bzl:\n--- a/tensorflow/workspace.bzl\n+++ b/tensorflow/workspace.bzl\n@@ -353,11 +353,11 @@ def tf_workspace(path_prefix=\"\", tf_repo_name=\"\"):\n   tf_http_archive(\n       name = \"protobuf_archive\",\n       urls = [\n-          \"https://mirror.bazel.build/github.com/google/protobuf/archive/396336eb961b75f03b25824fe86cf6490fb75e3a.tar.gz\",\n-          \"https://github.com/google/protobuf/archive/396336eb961b75f03b25824fe86cf6490fb75e3a.tar.gz\",\n+          \"https://mirror.bazel.build/github.com/dtrebbien/protobuf/archive/50f552646ba1de79e07562b41f3999fe036b4fd0.tar.gz\",\n+          \"https://github.com/dtrebbien/protobuf/archive/50f552646ba1de79e07562b41f3999fe036b4fd0.tar.gz\",\n       ],\n-      sha256 = \"846d907acf472ae233ec0882ef3a2d24edbbe834b80c305e867ac65a1f2c59e3\",\n-      strip_prefix = \"protobuf-396336eb961b75f03b25824fe86cf6490fb75e3a\",\n+      sha256 = \"eb16b33431b91fe8cee479575cee8de202f3626aaf00d9bf1783c6e62b4ffbc7\",\n+      strip_prefix = \"protobuf-50f552646ba1de79e07562b41f3999fe036b4fd0\",\n   )\n \n   # We need to import the protobuf library under the names com_google_protobuf", "body": "The work around that I mentioned in a [previous comment](https://github.com/tensorflow/tensorflow/issues/17067#issuecomment-366496974) was half-baked. I have created a fork of protobuf containing all of the changes which appear to be necessary. To use this fork, I applied the following patch to `tensorflow/workspace.bzl`:\r\n\r\n```patch\r\n--- a/tensorflow/workspace.bzl\r\n+++ b/tensorflow/workspace.bzl\r\n@@ -353,11 +353,11 @@ def tf_workspace(path_prefix=\"\", tf_repo_name=\"\"):\r\n   tf_http_archive(\r\n       name = \"protobuf_archive\",\r\n       urls = [\r\n-          \"https://mirror.bazel.build/github.com/google/protobuf/archive/396336eb961b75f03b25824fe86cf6490fb75e3a.tar.gz\",\r\n-          \"https://github.com/google/protobuf/archive/396336eb961b75f03b25824fe86cf6490fb75e3a.tar.gz\",\r\n+          \"https://mirror.bazel.build/github.com/dtrebbien/protobuf/archive/50f552646ba1de79e07562b41f3999fe036b4fd0.tar.gz\",\r\n+          \"https://github.com/dtrebbien/protobuf/archive/50f552646ba1de79e07562b41f3999fe036b4fd0.tar.gz\",\r\n       ],\r\n-      sha256 = \"846d907acf472ae233ec0882ef3a2d24edbbe834b80c305e867ac65a1f2c59e3\",\r\n-      strip_prefix = \"protobuf-396336eb961b75f03b25824fe86cf6490fb75e3a\",\r\n+      sha256 = \"eb16b33431b91fe8cee479575cee8de202f3626aaf00d9bf1783c6e62b4ffbc7\",\r\n+      strip_prefix = \"protobuf-50f552646ba1de79e07562b41f3999fe036b4fd0\",\r\n   )\r\n \r\n   # We need to import the protobuf library under the names com_google_protobuf\r\n```"}