{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13887", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13887/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13887/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13887/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13887", "id": 267403796, "node_id": "MDU6SXNzdWUyNjc0MDM3OTY=", "number": 13887, "title": "ValueError raised when using AdamOptimizer, but not for GradientDescentOptimizer", "user": {"login": "rohan-varma", "id": 8039770, "node_id": "MDQ6VXNlcjgwMzk3NzA=", "avatar_url": "https://avatars2.githubusercontent.com/u/8039770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan-varma", "html_url": "https://github.com/rohan-varma", "followers_url": "https://api.github.com/users/rohan-varma/followers", "following_url": "https://api.github.com/users/rohan-varma/following{/other_user}", "gists_url": "https://api.github.com/users/rohan-varma/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan-varma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan-varma/subscriptions", "organizations_url": "https://api.github.com/users/rohan-varma/orgs", "repos_url": "https://api.github.com/users/rohan-varma/repos", "events_url": "https://api.github.com/users/rohan-varma/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan-varma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2017-10-21T18:35:54Z", "updated_at": "2017-10-27T18:08:02Z", "closed_at": "2017-10-27T18:08:02Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: macOS Sierra 10.12.1</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary</li>\n<li><strong>TensorFlow version (use command below)</strong>: v1.2.0-rc2-21-g12f033d 1.2.0</li>\n<li><strong>Python version</strong>: 3.5.0</li>\n</ul>\n<h3>Source code / logs</h3>\n<p>Taken from this issue: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"194674080\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/6220\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/6220/hovercard?comment_id=314688444&amp;comment_type=issue_comment\" href=\"https://github.com/tensorflow/tensorflow/issues/6220#issuecomment-314688444\">#6220 (comment)</a>, the below code reproduces the error.</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\nclass SimpleModel:\n    def __init__(self):\n        self.loss = self.calc_loss()\n        self.train = self.train_model(self.loss)\n    def calc_loss(self):\n        W = tf.get_variable(\"w\", [1])\n        b = tf.Variable(tf.zeros([1]))\n        y = W * x_data + b\n        return tf.reduce_mean(tf.square(y - y_data))\n    def train_model(self, loss):\n        return tf.train.AdamOptimizer(0.5).minimize(loss)\n        #return tf.train.GradientDescentOptimizer(0.5)\nx_data = np.random.rand(100).astype(np.float32)\ny_data = x_data * 0.1 + 0.3\ns1 = SimpleModel()\ntf.get_variable_scope().reuse_variables()\ns2 = SimpleModel()\n</code></pre>\n<p>Running this gives the error <code>ValueError: Variable w/Adam_2/ does not exist, or was not created with tf.get_variable(). Did you mean to set reuse=None in VarScope?</code>, but when <code>train_model</code> is changed to return the <code>GradientDescentOptimizer</code>, the code compiles correctly.</p>\n<p>I've tried following all the advice in the issue that relates to this (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"194674080\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/6220\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/6220/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/6220\">#6220</a>), but haven't had any luck.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS Sierra 10.12.1\nTensorFlow installed from (source or binary): binary\nTensorFlow version (use command below): v1.2.0-rc2-21-g12f033d 1.2.0\nPython version: 3.5.0\n\nSource code / logs\nTaken from this issue: #6220 (comment), the below code reproduces the error.\nimport tensorflow as tf\nimport numpy as np\nclass SimpleModel:\n    def __init__(self):\n        self.loss = self.calc_loss()\n        self.train = self.train_model(self.loss)\n    def calc_loss(self):\n        W = tf.get_variable(\"w\", [1])\n        b = tf.Variable(tf.zeros([1]))\n        y = W * x_data + b\n        return tf.reduce_mean(tf.square(y - y_data))\n    def train_model(self, loss):\n        return tf.train.AdamOptimizer(0.5).minimize(loss)\n        #return tf.train.GradientDescentOptimizer(0.5)\nx_data = np.random.rand(100).astype(np.float32)\ny_data = x_data * 0.1 + 0.3\ns1 = SimpleModel()\ntf.get_variable_scope().reuse_variables()\ns2 = SimpleModel()\n\nRunning this gives the error ValueError: Variable w/Adam_2/ does not exist, or was not created with tf.get_variable(). Did you mean to set reuse=None in VarScope?, but when train_model is changed to return the GradientDescentOptimizer, the code compiles correctly.\nI've tried following all the advice in the issue that relates to this (#6220), but haven't had any luck.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: macOS Sierra 10.12.1\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: v1.2.0-rc2-21-g12f033d 1.2.0\r\n- **Python version**: 3.5.0\r\n\r\n### Source code / logs\r\n\r\nTaken from this issue: https://github.com/tensorflow/tensorflow/issues/6220#issuecomment-314688444, the below code reproduces the error.\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\nclass SimpleModel:\r\n    def __init__(self):\r\n        self.loss = self.calc_loss()\r\n        self.train = self.train_model(self.loss)\r\n    def calc_loss(self):\r\n        W = tf.get_variable(\"w\", [1])\r\n        b = tf.Variable(tf.zeros([1]))\r\n        y = W * x_data + b\r\n        return tf.reduce_mean(tf.square(y - y_data))\r\n    def train_model(self, loss):\r\n        return tf.train.AdamOptimizer(0.5).minimize(loss)\r\n        #return tf.train.GradientDescentOptimizer(0.5)\r\nx_data = np.random.rand(100).astype(np.float32)\r\ny_data = x_data * 0.1 + 0.3\r\ns1 = SimpleModel()\r\ntf.get_variable_scope().reuse_variables()\r\ns2 = SimpleModel()\r\n```\r\n\r\nRunning this gives the error `ValueError: Variable w/Adam_2/ does not exist, or was not created with tf.get_variable(). Did you mean to set reuse=None in VarScope?`, but when `train_model` is changed to return the `GradientDescentOptimizer`, the code compiles correctly.\r\n\r\nI've tried following all the advice in the issue that relates to this (https://github.com/tensorflow/tensorflow/issues/6220), but haven't had any luck. "}