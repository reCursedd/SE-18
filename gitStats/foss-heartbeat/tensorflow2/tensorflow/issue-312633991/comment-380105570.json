{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/380105570", "html_url": "https://github.com/tensorflow/tensorflow/issues/18352#issuecomment-380105570", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18352", "id": 380105570, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDEwNTU3MA==", "user": {"login": "matejaputic", "id": 2180391, "node_id": "MDQ6VXNlcjIxODAzOTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/2180391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matejaputic", "html_url": "https://github.com/matejaputic", "followers_url": "https://api.github.com/users/matejaputic/followers", "following_url": "https://api.github.com/users/matejaputic/following{/other_user}", "gists_url": "https://api.github.com/users/matejaputic/gists{/gist_id}", "starred_url": "https://api.github.com/users/matejaputic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matejaputic/subscriptions", "organizations_url": "https://api.github.com/users/matejaputic/orgs", "repos_url": "https://api.github.com/users/matejaputic/repos", "events_url": "https://api.github.com/users/matejaputic/events{/privacy}", "received_events_url": "https://api.github.com/users/matejaputic/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-10T13:51:21Z", "updated_at": "2018-04-10T13:51:21Z", "author_association": "NONE", "body_html": "<p>According to <a href=\"https://github.com/tensorflow/tensorflow/issues/7508#issuecomment-363964163\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/7508/hovercard\">this comment</a>, there is a way to map control inputs using the <code>c_api</code> module.</p>\n<p>I have tried:</p>\n<pre><code>scoped_options = c_api_util.ScopedTFImportGraphDefOptions()\noptions = scoped_options.options\n\ntf.import_graph_def(quantized_graph_def,\n    input_map={'batch': images},\n    name='')\nc_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images)\n</code></pre>\n<p>resulting in:</p>\n<pre><code>Traceback (most recent call last):\n  File \"vanilla_vgg.py\", line 419, in &lt;module&gt;\n    import_quantized_graph_with_imagenet()\n  File \"vanilla_vgg.py\", line 281, in import_quantized_graph_with_imagenet\n    c_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images)\nTypeError: in method 'TF_ImportGraphDefOptionsRemapControlDependency', argument 3 of type 'TF_Operation *'\n</code></pre>\n<p>Then I tried:</p>\n<pre><code>c_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images._as_tf_output().oper)\n</code></pre>\n<p>resulting in:</p>\n<pre><code>File \"/localtmp/mp3t/venv/doggett/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 556, in _as_tf_output\n  assert self.op._c_op\nAssertionError\n</code></pre>\n<p>How do I get a handle to a <code>c_op</code> from the input tensor <code>images</code>?</p>", "body_text": "According to this comment, there is a way to map control inputs using the c_api module.\nI have tried:\nscoped_options = c_api_util.ScopedTFImportGraphDefOptions()\noptions = scoped_options.options\n\ntf.import_graph_def(quantized_graph_def,\n    input_map={'batch': images},\n    name='')\nc_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images)\n\nresulting in:\nTraceback (most recent call last):\n  File \"vanilla_vgg.py\", line 419, in <module>\n    import_quantized_graph_with_imagenet()\n  File \"vanilla_vgg.py\", line 281, in import_quantized_graph_with_imagenet\n    c_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images)\nTypeError: in method 'TF_ImportGraphDefOptionsRemapControlDependency', argument 3 of type 'TF_Operation *'\n\nThen I tried:\nc_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images._as_tf_output().oper)\n\nresulting in:\nFile \"/localtmp/mp3t/venv/doggett/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 556, in _as_tf_output\n  assert self.op._c_op\nAssertionError\n\nHow do I get a handle to a c_op from the input tensor images?", "body": "According to [this comment](https://github.com/tensorflow/tensorflow/issues/7508#issuecomment-363964163), there is a way to map control inputs using the `c_api` module.\r\n\r\nI have tried: \r\n\r\n    scoped_options = c_api_util.ScopedTFImportGraphDefOptions()\r\n    options = scoped_options.options\r\n\r\n    tf.import_graph_def(quantized_graph_def,\r\n        input_map={'batch': images},\r\n        name='')\r\n    c_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images)\r\n\r\nresulting in:\r\n\r\n    Traceback (most recent call last):\r\n      File \"vanilla_vgg.py\", line 419, in <module>\r\n        import_quantized_graph_with_imagenet()\r\n      File \"vanilla_vgg.py\", line 281, in import_quantized_graph_with_imagenet\r\n        c_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images)\r\n    TypeError: in method 'TF_ImportGraphDefOptionsRemapControlDependency', argument 3 of type 'TF_Operation *'\r\n\r\nThen I tried:\r\n\r\n    c_api.TF_ImportGraphDefOptionsRemapControlDependency(options, 'batch', images._as_tf_output().oper)\r\n\r\nresulting in:\r\n\r\n    File \"/localtmp/mp3t/venv/doggett/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 556, in _as_tf_output\r\n      assert self.op._c_op\r\n    AssertionError\r\n\r\nHow do I get a handle to a `c_op` from the input tensor `images`?"}