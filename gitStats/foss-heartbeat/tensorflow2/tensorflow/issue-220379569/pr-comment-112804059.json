{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/112804059", "pull_request_review_id": 34151761, "id": 112804059, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMjgwNDA1OQ==", "diff_hunk": "@@ -2365,4 +2365,132 @@ output_max: the computed max output.\n \n )doc\");\n \n+// --------------------------------------------------------------------------\n+\n+namespace {\n+\n+Status ParticalReductionShapeFn(InferenceContext* c) {\n+  ShapeHandle handle;\n+  DimensionHandle dimhandle;\n+  // \"indices\" must have rank 2 and the number of columns must be 2\n+  TF_RETURN_IF_ERROR(c->WithRank(c->input(1), 2, &handle));\n+  TF_RETURN_IF_ERROR(c->Merge(c->Dim(c->input(1),1), c->MakeDim(2), &dimhandle));\n+  // \"data\" must have rank at least 1\n+  TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), 1, &handle));\n+  // shape of output tensor\n+  TF_RETURN_IF_ERROR(c->ReplaceDim(handle, 0, c->Dim(c->input(1),0), &handle));\n+  c->set_output(0, handle);\n+  return Status::OK();\n+}\n+\n+} // namespace\n+\n+REGISTER_OP(\"PartialSum\")\n+    .Input(\"data: T\")\n+    .Input(\"indices: Tindices\")\n+    .Output(\"output: T\")\n+    .Attr(\"T: numbertype\")\n+    .Attr(\"Tindices: {int32,int64}\")\n+    .SetShapeFn(ParticalReductionShapeFn)\n+    .Doc(R\"doc(\n+Dynamically sum over the first dimension of a tensor according to start and end\n+indices specified at \"index\". For example if input is\n+[[1,1,1],[10,10,10],[100,100,100],[1000,1000,1000]] and index is [[0,1],[1,1],[0,2]],\n+the the output will be [[1,1,1],[0,0,0],[11,11,11]]. The data must be at least rank\n+one. The indices must be of shape (?,2) where the first column is start indices and\n+the second column is end indices. The end index is not included in the sum, which\n+means, if you want to do a sum over 0,1,2, the you should have start index 0 and end\n+index 3. If end index is smaller than or equal to start, the result will be zero.\n+If end index is out of bounds, then the sum will automatically stop at the bound,\n+so feel free to put a large number as your end of your index if you want to sum until\n+the bound.\n+\n+data: The source of data where the computation will be taken from.\n+indices: start, end indices that controls which part to be included.\n+T: the type of data.\n+Tindices: the type of indices, must be int32 or int64.\n+output: the computed sum values.\n+)doc\");\n+\n+REGISTER_OP(\"PartialProd\")\n+    .Input(\"data: T\")\n+    .Input(\"indices: Tindices\")\n+    .Output(\"output: T\")\n+    .Attr(\"T: numbertype\")\n+    .Attr(\"Tindices: {int32,int64}\")\n+    .SetShapeFn(ParticalReductionShapeFn)\n+    .Doc(R\"doc(\n+Dynamically compute the product over the first dimension of a tensor according\n+to start and end indices specified at \"index\". For example if input is\n+[[1,2,3],[10,20,30],[100,200,300],[10,10,10]] and index is [[0,1],[1,1],[0,2]],\n+the the output will be [[1,2,3],[1,1,1],[10,40,90]]. The data must be at least rank\n+one. The indices must be of shape (?,2) where the first column is start indices and\n+the second column is end indices. The end index is not included in the product, which\n+means, if you want to do a product over 0,1,2, the you should have start index 0 and end\n+index 3. If end index is smaller than or equal to start, the result will be one.\n+If end index is out of bounds, then the sum will automatically stop at the bound,\n+so feel free to put a large number as your end of your index if you want to multiply until\n+the bound.\n+\n+data: The source of data where the computation will be taken from.\n+indices: start, end indices that controls which part to be included.\n+T: the type of data.\n+Tindices: the type of indices, must be int32 or int64.\n+output: the computed product values.\n+)doc\");\n+\n+REGISTER_OP(\"PartialMax\")\n+    .Input(\"data: T\")\n+    .Input(\"indices: Tindices\")\n+    .Output(\"output: T\")\n+    .Attr(\"T: numbertype\")\n+    .Attr(\"Tindices: {int32,int64}\")\n+    .SetShapeFn(ParticalReductionShapeFn)\n+    .Doc(R\"doc(\n+Dynamically compute the maximum over the first dimension of a tensor according\n+to start and end indices specified at \"index\". For example if input is\n+[[1,2,3],[10,20,30],[100,200,300],[10,10,10]] and index is [[0,1],[1,1],[0,2]],", "path": "tensorflow/core/ops/math_ops.cc", "position": null, "original_position": 88, "commit_id": "686d7fffa42ca0e78268fa2b94ca480da2f22368", "original_commit_id": "5e34a4fccdd28af7f89a2840b0a8731bfcd86787", "user": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "body": "It might be worth using pretty print to make the matrices multi line so they are more readable see array_ops.cc:884 \"MatrixBandPart\"\r\n", "created_at": "2017-04-22T06:37:37Z", "updated_at": "2017-08-10T00:09:10Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/9063#discussion_r112804059", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/9063", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/112804059"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/9063#discussion_r112804059"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/9063"}}, "body_html": "<p>It might be worth using pretty print to make the matrices multi line so they are more readable see array_ops.cc:884 \"MatrixBandPart\"</p>", "body_text": "It might be worth using pretty print to make the matrices multi line so they are more readable see array_ops.cc:884 \"MatrixBandPart\""}