{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/431666084", "html_url": "https://github.com/tensorflow/tensorflow/issues/23147#issuecomment-431666084", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23147", "id": 431666084, "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTY2NjA4NA==", "user": {"login": "hcl14", "id": 2828322, "node_id": "MDQ6VXNlcjI4MjgzMjI=", "avatar_url": "https://avatars3.githubusercontent.com/u/2828322?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hcl14", "html_url": "https://github.com/hcl14", "followers_url": "https://api.github.com/users/hcl14/followers", "following_url": "https://api.github.com/users/hcl14/following{/other_user}", "gists_url": "https://api.github.com/users/hcl14/gists{/gist_id}", "starred_url": "https://api.github.com/users/hcl14/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hcl14/subscriptions", "organizations_url": "https://api.github.com/users/hcl14/orgs", "repos_url": "https://api.github.com/users/hcl14/repos", "events_url": "https://api.github.com/users/hcl14/events{/privacy}", "received_events_url": "https://api.github.com/users/hcl14/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-21T12:49:45Z", "updated_at": "2018-10-21T13:02:59Z", "author_association": "NONE", "body_html": "<p>When I tried to call model from persistent process (i.e. not spawned dynamically for just one call, but created once on program start), I've got this error:</p>\n<p><code>Fetch argument &lt;tf.Operation 'init' type=NoOp&gt; cannot be interpreted as a Tensor. (Operation name: \"init\" op: \"NoOp\"  is not an element of this graph.)</code></p>\n<p>Following <a href=\"https://stackoverflow.com/questions/47918382/explicit-tensorflow-session-gives-fetch-error-in-tensorflow-nmt\" rel=\"nofollow\">stackoverflow post</a>, I changed in model inference:</p>\n<p><code>sess = tf.Session('grpc://'+tf_server_address, graph=graph)</code></p>\n<p>to</p>\n<p><code>sess = tf.InteractiveSession('grpc://'+tf_server_address, graph=graph)</code></p>\n<p>I've got persistent process working and dynamically created process hang.</p>\n<p>Hanging process issues warning:</p>\n<pre><code>Exception ignored in: &lt;generator object get_controller at 0x7f9b78ccba68&gt;\nTraceback (most recent call last):\n  File \"/mnt/clikque-backend/pysuggestion/py36_venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3815, in get_controller\n    if self.stack[-1] is not default:\nIndexError: list index out of range\n</code></pre>\n<p>When I use interactive session not only for evaluation, but for model loading as well</p>\n<pre><code>    graph = tf.get_default_graph()\n    \n    # interactive session installs itself as default\n    sess = tf.InteractiveSession(graph=graph)\n    \n    with sess.as_default():\n\n        NN1_MODEL = models.load_model(NN1_MODEL_FILE)\n</code></pre>\n<p>First run of dynamic process is Ok, but the second hangs with warnings</p>\n<pre><code>Exception ignored in: &lt;generator object get_controller at 0x7f8ad02ba338&gt;\nTraceback (most recent call last):\n  File \"/mnt/clikque-backend/pysuggestion/py36_venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3818, in get_controller\n    % type(default))\nAssertionError: Nesting violated for default stack of &lt;class 'tensorflow.python.client.session.InteractiveSession'&gt; objects\n</code></pre>", "body_text": "When I tried to call model from persistent process (i.e. not spawned dynamically for just one call, but created once on program start), I've got this error:\nFetch argument <tf.Operation 'init' type=NoOp> cannot be interpreted as a Tensor. (Operation name: \"init\" op: \"NoOp\"  is not an element of this graph.)\nFollowing stackoverflow post, I changed in model inference:\nsess = tf.Session('grpc://'+tf_server_address, graph=graph)\nto\nsess = tf.InteractiveSession('grpc://'+tf_server_address, graph=graph)\nI've got persistent process working and dynamically created process hang.\nHanging process issues warning:\nException ignored in: <generator object get_controller at 0x7f9b78ccba68>\nTraceback (most recent call last):\n  File \"/mnt/clikque-backend/pysuggestion/py36_venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3815, in get_controller\n    if self.stack[-1] is not default:\nIndexError: list index out of range\n\nWhen I use interactive session not only for evaluation, but for model loading as well\n    graph = tf.get_default_graph()\n    \n    # interactive session installs itself as default\n    sess = tf.InteractiveSession(graph=graph)\n    \n    with sess.as_default():\n\n        NN1_MODEL = models.load_model(NN1_MODEL_FILE)\n\nFirst run of dynamic process is Ok, but the second hangs with warnings\nException ignored in: <generator object get_controller at 0x7f8ad02ba338>\nTraceback (most recent call last):\n  File \"/mnt/clikque-backend/pysuggestion/py36_venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3818, in get_controller\n    % type(default))\nAssertionError: Nesting violated for default stack of <class 'tensorflow.python.client.session.InteractiveSession'> objects", "body": "When I tried to call model from persistent process (i.e. not spawned dynamically for just one call, but created once on program start), I've got this error:\r\n\r\n`Fetch argument <tf.Operation 'init' type=NoOp> cannot be interpreted as a Tensor. (Operation name: \"init\" op: \"NoOp\"  is not an element of this graph.)`\r\n\r\nFollowing [stackoverflow post](https://stackoverflow.com/questions/47918382/explicit-tensorflow-session-gives-fetch-error-in-tensorflow-nmt), I changed in model inference:\r\n\r\n`sess = tf.Session('grpc://'+tf_server_address, graph=graph)`\r\n\r\nto \r\n\r\n`sess = tf.InteractiveSession('grpc://'+tf_server_address, graph=graph)`\r\n\r\nI've got persistent process working and dynamically created process hang.\r\n\r\nHanging process issues warning:\r\n\r\n```\r\nException ignored in: <generator object get_controller at 0x7f9b78ccba68>\r\nTraceback (most recent call last):\r\n  File \"/mnt/clikque-backend/pysuggestion/py36_venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3815, in get_controller\r\n    if self.stack[-1] is not default:\r\nIndexError: list index out of range\r\n```\r\n\r\n\r\nWhen I use interactive session not only for evaluation, but for model loading as well\r\n```\r\n    graph = tf.get_default_graph()\r\n    \r\n    # interactive session installs itself as default\r\n    sess = tf.InteractiveSession(graph=graph)\r\n    \r\n    with sess.as_default():\r\n\r\n        NN1_MODEL = models.load_model(NN1_MODEL_FILE)\r\n```\r\n\r\n\r\nFirst run of dynamic process is Ok, but the second hangs with warnings\r\n```\r\nException ignored in: <generator object get_controller at 0x7f8ad02ba338>\r\nTraceback (most recent call last):\r\n  File \"/mnt/clikque-backend/pysuggestion/py36_venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3818, in get_controller\r\n    % type(default))\r\nAssertionError: Nesting violated for default stack of <class 'tensorflow.python.client.session.InteractiveSession'> objects\r\n```"}