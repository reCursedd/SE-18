{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4544", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4544/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4544/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4544/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4544", "id": 178782663, "node_id": "MDU6SXNzdWUxNzg3ODI2NjM=", "number": 4544, "title": "A problem when indexing tensor, I'm not sure if it is related to gather_nd issue", "user": {"login": "tuandnvn", "id": 4930699, "node_id": "MDQ6VXNlcjQ5MzA2OTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/4930699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tuandnvn", "html_url": "https://github.com/tuandnvn", "followers_url": "https://api.github.com/users/tuandnvn/followers", "following_url": "https://api.github.com/users/tuandnvn/following{/other_user}", "gists_url": "https://api.github.com/users/tuandnvn/gists{/gist_id}", "starred_url": "https://api.github.com/users/tuandnvn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tuandnvn/subscriptions", "organizations_url": "https://api.github.com/users/tuandnvn/orgs", "repos_url": "https://api.github.com/users/tuandnvn/repos", "events_url": "https://api.github.com/users/tuandnvn/events{/privacy}", "received_events_url": "https://api.github.com/users/tuandnvn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-09-23T04:33:42Z", "updated_at": "2016-10-23T05:45:13Z", "closed_at": "2016-10-23T05:45:13Z", "author_association": "NONE", "body_html": "<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>Might be related to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"116827263\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/206\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/206/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/206\">#206</a></p>\n<h3>Environment info</h3>\n<p>cuda-7.5<br>\ntensorflow 0.10.0rc0</p>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<pre><code># logit_t is tensor of shape (batch_size, number_of_label)\n# correct_t is targets, of size  (batch_size)\n\nlogit_corrects = []\n# I loop through batch_size because gather_nd doesn't support gradient\nfor i in xrange(batch_size):\n    logit_correct = tf.gather( logit_t[ i , : ], correct_t[ i ] ) \n    logit_corrects.append( logit_correct )\n\nlogit_corrects = tf.pack( logit_corrects )\nself._cost = cost = tf.reduce_mean( -logit_correct )\n</code></pre>\n<p>However, it complained that there is no supported kernel for GPU device.</p>\n<h3>What other attempted solutions have you tried?</h3>\n<h3>Logs or other output that would be helpful</h3>\n<pre><code>E tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'model/gradients/model/Squeeze_159_grad/Res\nhape/tensor': Could not satisfy explicit device specification '/device:GPU:3' because no supported kernel for GPU device\ns is available.\n         [[Node: model/gradients/model/Squeeze_159_grad/Reshape/tensor = UnsortedSegmentSum[T=DT_FLOAT, Tindices=DT_INT3\n2, _device=\"/device:GPU:3\"](model/gradients/model/Gather_39_grad/Reshape, model/gradients/model/Gather_39_grad/Reshape_1\n, model/gradients/model/Squeeze_159_grad/Reshape/Squeeze)]]\nTraceback (most recent call last):\n  File \"learning3.py\", line 976, in &lt;module&gt;\n    tf.initialize_all_variables().run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1553, in run\n    _run_using_default_session(self, feed_dict, self.graph, session)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3684, in _run_using_default_ses\nsion\n    session.run(operation, feed_dict)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'model/gradients/model/Squeeze_1\n59_grad/Reshape/tensor': Could not satisfy explicit device specification '/device:GPU:3' because no supported kernel for\n GPU devices is available.\n         [[Node: model/gradients/model/Squeeze_159_grad/Reshape/tensor = UnsortedSegmentSum[T=DT_FLOAT, Tindices=DT_INT3\n2, _device=\"/device:GPU:3\"](model/gradients/model/Gather_39_grad/Reshape, model/gradients/model/Gather_39_grad/Reshape_1\n, model/gradients/model/Squeeze_159_grad/Reshape/Squeeze)]]\nCaused by op u'model/gradients/model/Squeeze_159_grad/Reshape/tensor', defined at:\n  File \"learning3.py\", line 967, in &lt;module&gt;\n    m = Recognizer(is_training=True, config=config)\n  File \"learning3.py\", line 501, in __init__\n    grads, _ = tf.clip_by_global_norm(tf.gradients(cost, tvars),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 478, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 291, in _SqueezeGrad\n    return _ReshapeToInput(op, grad)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 281, in _ReshapeToInput\n    return array_ops.reshape(grad, array_ops.shape(op.inputs[0]))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 1750, in reshape\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 454, in apply_op\n    as_ref=input_arg.is_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 95, in _IndexedSlicesToTensor\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_math_ops.py\", line 2350, in unsorted_segment_su\nm\n    num_segments=num_segments, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n\n...which was originally created as op u'model/Squeeze_159', defined at:\n  File \"learning3.py\", line 967, in &lt;module&gt;\n    m = Recognizer(is_training=True, config=config)\n  File \"learning3.py\", line 480, in __init__\n    tf.gather(logit_t[i,:], correct_t[i])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 340, in _SliceHelper\n    return squeeze(sliced, squeeze_dims=squeeze_dims)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 2273, in squeeze\n    squeeze_dims=squeeze_dims, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n</code></pre>", "body_text": "What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nMight be related to #206\nEnvironment info\ncuda-7.5\ntensorflow 0.10.0rc0\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\n# logit_t is tensor of shape (batch_size, number_of_label)\n# correct_t is targets, of size  (batch_size)\n\nlogit_corrects = []\n# I loop through batch_size because gather_nd doesn't support gradient\nfor i in xrange(batch_size):\n    logit_correct = tf.gather( logit_t[ i , : ], correct_t[ i ] ) \n    logit_corrects.append( logit_correct )\n\nlogit_corrects = tf.pack( logit_corrects )\nself._cost = cost = tf.reduce_mean( -logit_correct )\n\nHowever, it complained that there is no supported kernel for GPU device.\nWhat other attempted solutions have you tried?\nLogs or other output that would be helpful\nE tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'model/gradients/model/Squeeze_159_grad/Res\nhape/tensor': Could not satisfy explicit device specification '/device:GPU:3' because no supported kernel for GPU device\ns is available.\n         [[Node: model/gradients/model/Squeeze_159_grad/Reshape/tensor = UnsortedSegmentSum[T=DT_FLOAT, Tindices=DT_INT3\n2, _device=\"/device:GPU:3\"](model/gradients/model/Gather_39_grad/Reshape, model/gradients/model/Gather_39_grad/Reshape_1\n, model/gradients/model/Squeeze_159_grad/Reshape/Squeeze)]]\nTraceback (most recent call last):\n  File \"learning3.py\", line 976, in <module>\n    tf.initialize_all_variables().run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1553, in run\n    _run_using_default_session(self, feed_dict, self.graph, session)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3684, in _run_using_default_ses\nsion\n    session.run(operation, feed_dict)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'model/gradients/model/Squeeze_1\n59_grad/Reshape/tensor': Could not satisfy explicit device specification '/device:GPU:3' because no supported kernel for\n GPU devices is available.\n         [[Node: model/gradients/model/Squeeze_159_grad/Reshape/tensor = UnsortedSegmentSum[T=DT_FLOAT, Tindices=DT_INT3\n2, _device=\"/device:GPU:3\"](model/gradients/model/Gather_39_grad/Reshape, model/gradients/model/Gather_39_grad/Reshape_1\n, model/gradients/model/Squeeze_159_grad/Reshape/Squeeze)]]\nCaused by op u'model/gradients/model/Squeeze_159_grad/Reshape/tensor', defined at:\n  File \"learning3.py\", line 967, in <module>\n    m = Recognizer(is_training=True, config=config)\n  File \"learning3.py\", line 501, in __init__\n    grads, _ = tf.clip_by_global_norm(tf.gradients(cost, tvars),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 478, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 291, in _SqueezeGrad\n    return _ReshapeToInput(op, grad)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 281, in _ReshapeToInput\n    return array_ops.reshape(grad, array_ops.shape(op.inputs[0]))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 1750, in reshape\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 454, in apply_op\n    as_ref=input_arg.is_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 95, in _IndexedSlicesToTensor\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_math_ops.py\", line 2350, in unsorted_segment_su\nm\n    num_segments=num_segments, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n\n...which was originally created as op u'model/Squeeze_159', defined at:\n  File \"learning3.py\", line 967, in <module>\n    m = Recognizer(is_training=True, config=config)\n  File \"learning3.py\", line 480, in __init__\n    tf.gather(logit_t[i,:], correct_t[i])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 340, in _SliceHelper\n    return squeeze(sliced, squeeze_dims=squeeze_dims)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 2273, in squeeze\n    squeeze_dims=squeeze_dims, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()", "body": "### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n\nMight be related to https://github.com/tensorflow/tensorflow/issues/206\n### Environment info\n\ncuda-7.5\ntensorflow 0.10.0rc0\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\n\n```\n# logit_t is tensor of shape (batch_size, number_of_label)\n# correct_t is targets, of size  (batch_size)\n\nlogit_corrects = []\n# I loop through batch_size because gather_nd doesn't support gradient\nfor i in xrange(batch_size):\n    logit_correct = tf.gather( logit_t[ i , : ], correct_t[ i ] ) \n    logit_corrects.append( logit_correct )\n\nlogit_corrects = tf.pack( logit_corrects )\nself._cost = cost = tf.reduce_mean( -logit_correct )\n```\n\nHowever, it complained that there is no supported kernel for GPU device. \n### What other attempted solutions have you tried?\n### Logs or other output that would be helpful\n\n```\nE tensorflow/core/client/tensor_c_api.cc:485] Cannot assign a device to node 'model/gradients/model/Squeeze_159_grad/Res\nhape/tensor': Could not satisfy explicit device specification '/device:GPU:3' because no supported kernel for GPU device\ns is available.\n         [[Node: model/gradients/model/Squeeze_159_grad/Reshape/tensor = UnsortedSegmentSum[T=DT_FLOAT, Tindices=DT_INT3\n2, _device=\"/device:GPU:3\"](model/gradients/model/Gather_39_grad/Reshape, model/gradients/model/Gather_39_grad/Reshape_1\n, model/gradients/model/Squeeze_159_grad/Reshape/Squeeze)]]\nTraceback (most recent call last):\n  File \"learning3.py\", line 976, in <module>\n    tf.initialize_all_variables().run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1553, in run\n    _run_using_default_session(self, feed_dict, self.graph, session)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3684, in _run_using_default_ses\nsion\n    session.run(operation, feed_dict)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors.InvalidArgumentError: Cannot assign a device to node 'model/gradients/model/Squeeze_1\n59_grad/Reshape/tensor': Could not satisfy explicit device specification '/device:GPU:3' because no supported kernel for\n GPU devices is available.\n         [[Node: model/gradients/model/Squeeze_159_grad/Reshape/tensor = UnsortedSegmentSum[T=DT_FLOAT, Tindices=DT_INT3\n2, _device=\"/device:GPU:3\"](model/gradients/model/Gather_39_grad/Reshape, model/gradients/model/Gather_39_grad/Reshape_1\n, model/gradients/model/Squeeze_159_grad/Reshape/Squeeze)]]\nCaused by op u'model/gradients/model/Squeeze_159_grad/Reshape/tensor', defined at:\n  File \"learning3.py\", line 967, in <module>\n    m = Recognizer(is_training=True, config=config)\n  File \"learning3.py\", line 501, in __init__\n    grads, _ = tf.clip_by_global_norm(tf.gradients(cost, tvars),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 478, in gradients\n    in_grads = _AsList(grad_fn(op, *out_grads))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 291, in _SqueezeGrad\n    return _ReshapeToInput(op, grad)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_grad.py\", line 281, in _ReshapeToInput\n    return array_ops.reshape(grad, array_ops.shape(op.inputs[0]))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 1750, in reshape\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 454, in apply_op\n    as_ref=input_arg.is_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 621, in convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 95, in _IndexedSlicesToTensor\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_math_ops.py\", line 2350, in unsorted_segment_su\nm\n    num_segments=num_segments, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n\n...which was originally created as op u'model/Squeeze_159', defined at:\n  File \"learning3.py\", line 967, in <module>\n    m = Recognizer(is_training=True, config=config)\n  File \"learning3.py\", line 480, in __init__\n    tf.gather(logit_t[i,:], correct_t[i])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 340, in _SliceHelper\n    return squeeze(sliced, squeeze_dims=squeeze_dims)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 2273, in squeeze\n    squeeze_dims=squeeze_dims, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py\", line 703, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 2310, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1232, in __init__\n    self._traceback = _extract_stack()\n```\n"}