{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1853", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1853/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1853/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1853/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1853", "id": 147501003, "node_id": "MDU6SXNzdWUxNDc1MDEwMDM=", "number": 1853, "title": "shuffle_batch gives ZeroDivisionError when computing capacity stat", "user": {"login": "yaroslavvb", "id": 23068, "node_id": "MDQ6VXNlcjIzMDY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaroslavvb", "html_url": "https://github.com/yaroslavvb", "followers_url": "https://api.github.com/users/yaroslavvb/followers", "following_url": "https://api.github.com/users/yaroslavvb/following{/other_user}", "gists_url": "https://api.github.com/users/yaroslavvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaroslavvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaroslavvb/subscriptions", "organizations_url": "https://api.github.com/users/yaroslavvb/orgs", "repos_url": "https://api.github.com/users/yaroslavvb/repos", "events_url": "https://api.github.com/users/yaroslavvb/events{/privacy}", "received_events_url": "https://api.github.com/users/yaroslavvb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-04-11T17:40:39Z", "updated_at": "2017-06-13T23:58:22Z", "closed_at": "2017-06-13T23:58:22Z", "author_association": "CONTRIBUTOR", "body_html": "<pre><code>import tensorflow as tf\nraw = tf.ones((2))\ntf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\n\n</code></pre>\n<p>this fails with</p>\n<pre><code>ZeroDivisionError                         Traceback (most recent call last)\n&lt;ipython-input-11-86e4af7ca1ee&gt; in &lt;module&gt;()\n      1 import tensorflow as tf\n      2 raw = tf.ones((2))\n----&gt; 3 tf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\n\n/Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\n   1220       allow_smaller_final_batch=allow_smaller_final_batch,\n   1221       shared_name=shared_name,\n-&gt; 1222       name=name)\n   1223 \n   1224 \n\n/Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in _shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, keep_input, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\n    779     full = (math_ops.cast(math_ops.maximum(0, queue.size() - min_after_dequeue),\n    780                           dtypes.float32) *\n--&gt; 781             (1. / (capacity - min_after_dequeue)))\n    782     # Note that name contains a '/' at the end so we intentionally do not place\n    783     # a '/' after %s below.\n\n</code></pre>\n<p>Unlike TF tensors, Python doesn't handle float division by zero. One solution is to wrap \"capacity\" and \"min_after_dequeue\" into TF tensors so that you get \"inf\" as a result instead of RuntimeError</p>", "body_text": "import tensorflow as tf\nraw = tf.ones((2))\ntf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\n\n\nthis fails with\nZeroDivisionError                         Traceback (most recent call last)\n<ipython-input-11-86e4af7ca1ee> in <module>()\n      1 import tensorflow as tf\n      2 raw = tf.ones((2))\n----> 3 tf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\n\n/Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\n   1220       allow_smaller_final_batch=allow_smaller_final_batch,\n   1221       shared_name=shared_name,\n-> 1222       name=name)\n   1223 \n   1224 \n\n/Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in _shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, keep_input, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\n    779     full = (math_ops.cast(math_ops.maximum(0, queue.size() - min_after_dequeue),\n    780                           dtypes.float32) *\n--> 781             (1. / (capacity - min_after_dequeue)))\n    782     # Note that name contains a '/' at the end so we intentionally do not place\n    783     # a '/' after %s below.\n\n\nUnlike TF tensors, Python doesn't handle float division by zero. One solution is to wrap \"capacity\" and \"min_after_dequeue\" into TF tensors so that you get \"inf\" as a result instead of RuntimeError", "body": "```\r\nimport tensorflow as tf\r\nraw = tf.ones((2))\r\ntf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\r\n\r\n```\r\n\r\nthis fails with\r\n\r\n```\r\nZeroDivisionError                         Traceback (most recent call last)\r\n<ipython-input-11-86e4af7ca1ee> in <module>()\r\n      1 import tensorflow as tf\r\n      2 raw = tf.ones((2))\r\n----> 3 tf.train.shuffle_batch([raw], batch_size=2, capacity=4, min_after_dequeue=4, seed=5)\r\n\r\n/Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\r\n   1220       allow_smaller_final_batch=allow_smaller_final_batch,\r\n   1221       shared_name=shared_name,\r\n-> 1222       name=name)\r\n   1223 \r\n   1224 \r\n\r\n/Users/yaroslav/anaconda/envs/tim-jan17/lib/python3.5/site-packages/tensorflow/python/training/input.py in _shuffle_batch(tensors, batch_size, capacity, min_after_dequeue, keep_input, num_threads, seed, enqueue_many, shapes, allow_smaller_final_batch, shared_name, name)\r\n    779     full = (math_ops.cast(math_ops.maximum(0, queue.size() - min_after_dequeue),\r\n    780                           dtypes.float32) *\r\n--> 781             (1. / (capacity - min_after_dequeue)))\r\n    782     # Note that name contains a '/' at the end so we intentionally do not place\r\n    783     # a '/' after %s below.\r\n\r\n```\r\n\r\nUnlike TF tensors, Python doesn't handle float division by zero. One solution is to wrap \"capacity\" and \"min_after_dequeue\" into TF tensors so that you get \"inf\" as a result instead of RuntimeError\r\n"}