{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16149", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16149/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16149/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16149/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16149", "id": 288821395, "node_id": "MDU6SXNzdWUyODg4MjEzOTU=", "number": 16149, "title": "Dataset from string generator raises Exception with python 2", "user": {"login": "shkarupa-alex", "id": 1289725, "node_id": "MDQ6VXNlcjEyODk3MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1289725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shkarupa-alex", "html_url": "https://github.com/shkarupa-alex", "followers_url": "https://api.github.com/users/shkarupa-alex/followers", "following_url": "https://api.github.com/users/shkarupa-alex/following{/other_user}", "gists_url": "https://api.github.com/users/shkarupa-alex/gists{/gist_id}", "starred_url": "https://api.github.com/users/shkarupa-alex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shkarupa-alex/subscriptions", "organizations_url": "https://api.github.com/users/shkarupa-alex/orgs", "repos_url": "https://api.github.com/users/shkarupa-alex/repos", "events_url": "https://api.github.com/users/shkarupa-alex/events{/privacy}", "received_events_url": "https://api.github.com/users/shkarupa-alex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-01-16T08:27:13Z", "updated_at": "2018-01-23T18:02:10Z", "closed_at": "2018-01-23T18:02:10Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: MacOS X 10.12.6</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary cpu version from pypi</li>\n<li><strong>TensorFlow version (use command below)</strong>: ('v1.5.0-rc0-9-gf9472619f6', '1.5.0-rc1')</li>\n<li><strong>Python version</strong>: 2.7.14</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I'm reading text data from file in generator. Encoding: UTF-8.<br>\nAfter some preprocessing i return it in generator manner.<br>\nNext, i'm trying to create Dataset from this generator.</p>\n<p>Code below produce exception in both Python 2&amp;3 for TensorFlow 1.4.<br>\nFor TF 1.5.rc1 &amp; Python 3 there is no errors.<br>\nFor TF 1.5.rc1 &amp; Python 2 error exist.</p>\n<h3>Source code / logs</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"><span class=\"pl-c\">#</span> -*- coding: utf-8 -*-</span>\n<span class=\"pl-k\">from</span> <span class=\"pl-c1\">__future__</span> <span class=\"pl-k\">import</span> absolute_import\n<span class=\"pl-k\">from</span> <span class=\"pl-c1\">__future__</span> <span class=\"pl-k\">import</span> division\n<span class=\"pl-k\">from</span> <span class=\"pl-c1\">__future__</span> <span class=\"pl-k\">import</span> print_function\n\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">generator</span>():\n    data <span class=\"pl-k\">=</span> [\n        [<span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u041f\u0440\u043e\u0441\u0442\u043e\u0439<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u0442\u0435\u0441\u0442<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u044e\u043d\u0438\u043a\u043e\u0434\u0430<span class=\"pl-pds\">'</span></span>],\n        [<span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u043d\u0438\u043a\u043e\u0433\u0434\u0430<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u043d\u0435<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u0431\u044b\u0432\u0430\u0435\u0442<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-k\">u</span><span class=\"pl-pds\">'</span>\u043f\u0440\u043e\u0441\u0442\u044b\u043c<span class=\"pl-pds\">'</span></span>]\n    ]\n\n    <span class=\"pl-k\">for</span> seq <span class=\"pl-k\">in</span> data:\n        <span class=\"pl-k\">yield</span> seq, [<span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">2</span>, <span class=\"pl-c1\">3</span>]\n\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">dataset</span>():\n    dataset <span class=\"pl-k\">=</span> tf.data.Dataset.from_generator(\n        generator,\n        (tf.string, tf.int32),\n        (tf.TensorShape([<span class=\"pl-c1\">None</span>]), tf.TensorShape([<span class=\"pl-c1\">None</span>]))\n    )\n    dataset <span class=\"pl-k\">=</span> dataset.padded_batch(<span class=\"pl-c1\">2</span>, <span class=\"pl-v\">padded_shapes</span><span class=\"pl-k\">=</span>([<span class=\"pl-c1\">None</span>], [<span class=\"pl-c1\">None</span>]), <span class=\"pl-v\">padding_values</span><span class=\"pl-k\">=</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span>, <span class=\"pl-c1\">0</span>))\n\n    <span class=\"pl-k\">return</span> dataset\n\n\niterator <span class=\"pl-k\">=</span> dataset().make_one_shot_iterator()\nnext_element <span class=\"pl-k\">=</span> iterator.get_next()\n\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess:\n    value <span class=\"pl-k\">=</span> sess.run(next_element)\n    <span class=\"pl-c1\">print</span>(value)</pre></div>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS X 10.12.6\nTensorFlow installed from (source or binary): binary cpu version from pypi\nTensorFlow version (use command below): ('v1.5.0-rc0-9-gf9472619f6', '1.5.0-rc1')\nPython version: 2.7.14\n\nDescribe the problem\nI'm reading text data from file in generator. Encoding: UTF-8.\nAfter some preprocessing i return it in generator manner.\nNext, i'm trying to create Dataset from this generator.\nCode below produce exception in both Python 2&3 for TensorFlow 1.4.\nFor TF 1.5.rc1 & Python 3 there is no errors.\nFor TF 1.5.rc1 & Python 2 error exist.\nSource code / logs\n# -*- coding: utf-8 -*-\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\n\n\ndef generator():\n    data = [\n        [u'\u041f\u0440\u043e\u0441\u0442\u043e\u0439', u'\u0442\u0435\u0441\u0442', u'\u044e\u043d\u0438\u043a\u043e\u0434\u0430'],\n        [u'\u043d\u0438\u043a\u043e\u0433\u0434\u0430', u'\u043d\u0435', u'\u0431\u044b\u0432\u0430\u0435\u0442', u'\u043f\u0440\u043e\u0441\u0442\u044b\u043c']\n    ]\n\n    for seq in data:\n        yield seq, [0, 1, 2, 3]\n\n\ndef dataset():\n    dataset = tf.data.Dataset.from_generator(\n        generator,\n        (tf.string, tf.int32),\n        (tf.TensorShape([None]), tf.TensorShape([None]))\n    )\n    dataset = dataset.padded_batch(2, padded_shapes=([None], [None]), padding_values=('', 0))\n\n    return dataset\n\n\niterator = dataset().make_one_shot_iterator()\nnext_element = iterator.get_next()\n\nwith tf.Session() as sess:\n    value = sess.run(next_element)\n    print(value)", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOS X 10.12.6\r\n- **TensorFlow installed from (source or binary)**: binary cpu version from pypi\r\n- **TensorFlow version (use command below)**: ('v1.5.0-rc0-9-gf9472619f6', '1.5.0-rc1')\r\n- **Python version**: 2.7.14\r\n\r\n### Describe the problem\r\nI'm reading text data from file in generator. Encoding: UTF-8.\r\nAfter some preprocessing i return it in generator manner.\r\nNext, i'm trying to create Dataset from this generator.\r\n\r\nCode below produce exception in both Python 2&3 for TensorFlow 1.4.\r\nFor TF 1.5.rc1 & Python 3 there is no errors.\r\nFor TF 1.5.rc1 & Python 2 error exist.\r\n\r\n### Source code / logs\r\n```python\r\n# -*- coding: utf-8 -*-\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n\r\nimport tensorflow as tf\r\n\r\n\r\ndef generator():\r\n    data = [\r\n        [u'\u041f\u0440\u043e\u0441\u0442\u043e\u0439', u'\u0442\u0435\u0441\u0442', u'\u044e\u043d\u0438\u043a\u043e\u0434\u0430'],\r\n        [u'\u043d\u0438\u043a\u043e\u0433\u0434\u0430', u'\u043d\u0435', u'\u0431\u044b\u0432\u0430\u0435\u0442', u'\u043f\u0440\u043e\u0441\u0442\u044b\u043c']\r\n    ]\r\n\r\n    for seq in data:\r\n        yield seq, [0, 1, 2, 3]\r\n\r\n\r\ndef dataset():\r\n    dataset = tf.data.Dataset.from_generator(\r\n        generator,\r\n        (tf.string, tf.int32),\r\n        (tf.TensorShape([None]), tf.TensorShape([None]))\r\n    )\r\n    dataset = dataset.padded_batch(2, padded_shapes=([None], [None]), padding_values=('', 0))\r\n\r\n    return dataset\r\n\r\n\r\niterator = dataset().make_one_shot_iterator()\r\nnext_element = iterator.get_next()\r\n\r\nwith tf.Session() as sess:\r\n    value = sess.run(next_element)\r\n    print(value)\r\n```"}