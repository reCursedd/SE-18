{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7545", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7545/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7545/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7545/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/7545", "id": 207975417, "node_id": "MDExOlB1bGxSZXF1ZXN0MTA2NDMxMjIy", "number": 7545, "title": "Added atrous_conv1d and 3d. Refactored 2d.", "user": {"login": "nmiculinic", "id": 3183610, "node_id": "MDQ6VXNlcjMxODM2MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/3183610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nmiculinic", "html_url": "https://github.com/nmiculinic", "followers_url": "https://api.github.com/users/nmiculinic/followers", "following_url": "https://api.github.com/users/nmiculinic/following{/other_user}", "gists_url": "https://api.github.com/users/nmiculinic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nmiculinic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nmiculinic/subscriptions", "organizations_url": "https://api.github.com/users/nmiculinic/orgs", "repos_url": "https://api.github.com/users/nmiculinic/repos", "events_url": "https://api.github.com/users/nmiculinic/events{/privacy}", "received_events_url": "https://api.github.com/users/nmiculinic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "gpapan", "id": 6232317, "node_id": "MDQ6VXNlcjYyMzIzMTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/6232317?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpapan", "html_url": "https://github.com/gpapan", "followers_url": "https://api.github.com/users/gpapan/followers", "following_url": "https://api.github.com/users/gpapan/following{/other_user}", "gists_url": "https://api.github.com/users/gpapan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpapan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpapan/subscriptions", "organizations_url": "https://api.github.com/users/gpapan/orgs", "repos_url": "https://api.github.com/users/gpapan/repos", "events_url": "https://api.github.com/users/gpapan/events{/privacy}", "received_events_url": "https://api.github.com/users/gpapan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpapan", "id": 6232317, "node_id": "MDQ6VXNlcjYyMzIzMTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/6232317?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpapan", "html_url": "https://github.com/gpapan", "followers_url": "https://api.github.com/users/gpapan/followers", "following_url": "https://api.github.com/users/gpapan/following{/other_user}", "gists_url": "https://api.github.com/users/gpapan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpapan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpapan/subscriptions", "organizations_url": "https://api.github.com/users/gpapan/orgs", "repos_url": "https://api.github.com/users/gpapan/repos", "events_url": "https://api.github.com/users/gpapan/events{/privacy}", "received_events_url": "https://api.github.com/users/gpapan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 18, "created_at": "2017-02-16T00:33:27Z", "updated_at": "2017-05-02T01:03:37Z", "closed_at": "2017-05-02T01:03:35Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/7545", "html_url": "https://github.com/tensorflow/tensorflow/pull/7545", "diff_url": "https://github.com/tensorflow/tensorflow/pull/7545.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/7545.patch"}, "body_html": "<p>This commit makes following changes:</p>\n<ul>\n<li>deleted most atrous_conv2d code to reuse existing tf.nn.convolution function</li>\n<li>added atrous_conv1d and atrous_conv3d with similar API as atrous_conv2d</li>\n<li>Added support for variable rate per dimension, e.g. for atrous_conv2d<br>\nrate=2, or rate=[2,1] does different things. Former is equal to<br>\nrate=[2,2]. rate_i determines dilation_rate in dimension i.</li>\n<li>added strides support with same API as in tf.nn.convolution function</li>\n</ul>\n<p>This commit makes more code deletions then additions. However<br>\ndocumentation per function makes it appear large.</p>\n<p>Test Plan:</p>\n<p>Some simple tests to verify I haven't screwed something up:</p>\n<pre><code>A = np.array([1, 2, 3, 4, 5, 6], dtype=np.float32).reshape(1, 6, 1)\nprint(A)\n\nkernel = np.array([100, 10, 1], dtype=np.float32).reshape(3, 1, 1)\n\nwith tf.Session() as sess:\n    print(sess.run(tf.nn.atrous_conv1d(A, kernel, padding='SAME', rate=[2])))\n</code></pre>\n<pre><code>B = np.arange(16, dtype=np.float32).reshape(1, 4, 4, 1)\nkernel = np.array([1000, 100, 10, 1.0], dtype=np.float32).reshape(2, 2, 1, 1)\n\nwith tf.Session() as sess:\n    a = sess.run(tf.nn.convolution(B, kernel, padding='SAME', dilation_rate=np.array([2, 2])))\n    b = sess.run(tf.nn.atrous_conv2d(B, kernel, rate=2, padding='SAME'))\n    print(np.allclose(a, b))\n    print(a)\n    print(b)\n</code></pre>\n<pre><code>C = np.arange(4**3, dtype=np.float32).reshape(1, 4, 4, 4, 1)\nkernel = (10**np.arange(8, 0, -1, dtype=np.float32)).reshape(2, 2, 2, 1, 1)\n\nwith tf.Session() as sess:\n    a = sess.run(tf.nn.conv3d(C, kernel, strides=[1, 1,1,1,1], padding='SAME'))\n    b = sess.run(tf.nn.atrous_conv3d(C, kernel, rate=1, padding='SAME'))\n    print(np.allclose(a, b))\n    print(a)\n    print(b)\n</code></pre>\n<p>Also running atrous_conv2d unit tests to verify backward compatibility.</p>", "body_text": "This commit makes following changes:\n\ndeleted most atrous_conv2d code to reuse existing tf.nn.convolution function\nadded atrous_conv1d and atrous_conv3d with similar API as atrous_conv2d\nAdded support for variable rate per dimension, e.g. for atrous_conv2d\nrate=2, or rate=[2,1] does different things. Former is equal to\nrate=[2,2]. rate_i determines dilation_rate in dimension i.\nadded strides support with same API as in tf.nn.convolution function\n\nThis commit makes more code deletions then additions. However\ndocumentation per function makes it appear large.\nTest Plan:\nSome simple tests to verify I haven't screwed something up:\nA = np.array([1, 2, 3, 4, 5, 6], dtype=np.float32).reshape(1, 6, 1)\nprint(A)\n\nkernel = np.array([100, 10, 1], dtype=np.float32).reshape(3, 1, 1)\n\nwith tf.Session() as sess:\n    print(sess.run(tf.nn.atrous_conv1d(A, kernel, padding='SAME', rate=[2])))\n\nB = np.arange(16, dtype=np.float32).reshape(1, 4, 4, 1)\nkernel = np.array([1000, 100, 10, 1.0], dtype=np.float32).reshape(2, 2, 1, 1)\n\nwith tf.Session() as sess:\n    a = sess.run(tf.nn.convolution(B, kernel, padding='SAME', dilation_rate=np.array([2, 2])))\n    b = sess.run(tf.nn.atrous_conv2d(B, kernel, rate=2, padding='SAME'))\n    print(np.allclose(a, b))\n    print(a)\n    print(b)\n\nC = np.arange(4**3, dtype=np.float32).reshape(1, 4, 4, 4, 1)\nkernel = (10**np.arange(8, 0, -1, dtype=np.float32)).reshape(2, 2, 2, 1, 1)\n\nwith tf.Session() as sess:\n    a = sess.run(tf.nn.conv3d(C, kernel, strides=[1, 1,1,1,1], padding='SAME'))\n    b = sess.run(tf.nn.atrous_conv3d(C, kernel, rate=1, padding='SAME'))\n    print(np.allclose(a, b))\n    print(a)\n    print(b)\n\nAlso running atrous_conv2d unit tests to verify backward compatibility.", "body": "This commit makes following changes:\r\n* deleted most atrous_conv2d code to reuse existing tf.nn.convolution function\r\n* added atrous_conv1d and atrous_conv3d with similar API as atrous_conv2d\r\n* Added support for variable rate per dimension, e.g. for atrous_conv2d\r\n  rate=2, or rate=[2,1] does different things. Former is equal to\r\n  rate=[2,2]. rate_i determines dilation_rate in dimension i.\r\n* added strides support with same API as in tf.nn.convolution function\r\n\r\nThis commit makes more code deletions then additions. However\r\ndocumentation per function makes it appear large.\r\n\r\nTest Plan:\r\n\r\nSome simple tests to verify I haven't screwed something up:\r\n\r\n```\r\nA = np.array([1, 2, 3, 4, 5, 6], dtype=np.float32).reshape(1, 6, 1)\r\nprint(A)\r\n\r\nkernel = np.array([100, 10, 1], dtype=np.float32).reshape(3, 1, 1)\r\n\r\nwith tf.Session() as sess:\r\n    print(sess.run(tf.nn.atrous_conv1d(A, kernel, padding='SAME', rate=[2])))\r\n```\r\n\r\n```\r\nB = np.arange(16, dtype=np.float32).reshape(1, 4, 4, 1)\r\nkernel = np.array([1000, 100, 10, 1.0], dtype=np.float32).reshape(2, 2, 1, 1)\r\n\r\nwith tf.Session() as sess:\r\n    a = sess.run(tf.nn.convolution(B, kernel, padding='SAME', dilation_rate=np.array([2, 2])))\r\n    b = sess.run(tf.nn.atrous_conv2d(B, kernel, rate=2, padding='SAME'))\r\n    print(np.allclose(a, b))\r\n    print(a)\r\n    print(b)\r\n```\r\n\r\n```\r\nC = np.arange(4**3, dtype=np.float32).reshape(1, 4, 4, 4, 1)\r\nkernel = (10**np.arange(8, 0, -1, dtype=np.float32)).reshape(2, 2, 2, 1, 1)\r\n\r\nwith tf.Session() as sess:\r\n    a = sess.run(tf.nn.conv3d(C, kernel, strides=[1, 1,1,1,1], padding='SAME'))\r\n    b = sess.run(tf.nn.atrous_conv3d(C, kernel, rate=1, padding='SAME'))\r\n    print(np.allclose(a, b))\r\n    print(a)\r\n    print(b)\r\n```\r\n\r\nAlso running atrous_conv2d unit tests to verify backward compatibility."}