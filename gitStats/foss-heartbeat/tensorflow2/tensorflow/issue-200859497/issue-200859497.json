{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6861", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6861/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6861/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6861/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6861", "id": 200859497, "node_id": "MDU6SXNzdWUyMDA4NTk0OTc=", "number": 6861, "title": "Strange bug with tf.nn.nce_loss", "user": {"login": "chiphuyen", "id": 11997567, "node_id": "MDQ6VXNlcjExOTk3NTY3", "avatar_url": "https://avatars1.githubusercontent.com/u/11997567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chiphuyen", "html_url": "https://github.com/chiphuyen", "followers_url": "https://api.github.com/users/chiphuyen/followers", "following_url": "https://api.github.com/users/chiphuyen/following{/other_user}", "gists_url": "https://api.github.com/users/chiphuyen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chiphuyen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chiphuyen/subscriptions", "organizations_url": "https://api.github.com/users/chiphuyen/orgs", "repos_url": "https://api.github.com/users/chiphuyen/repos", "events_url": "https://api.github.com/users/chiphuyen/events{/privacy}", "received_events_url": "https://api.github.com/users/chiphuyen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-01-15T09:56:22Z", "updated_at": "2017-07-10T09:03:26Z", "closed_at": "2017-01-15T22:55:40Z", "author_association": "NONE", "body_html": "<p>So for tf.nn.nce_loss for word2vec_basic, if I explicitly use keyword arguments, such as:<br>\ntf.nn.nce_loss(weights=nce_weights,<br>\nbiases=nce_biases,<br>\nlabels=train_labels,<br>\ninputs=embed,<br>\nnum_sampled=num_sampled,<br>\nnum_classes=vocabulary_size))</p>\n<p>everything is fine. But if I get rid of the keywords:<br>\ntf.nn.nce_loss(nce_weights, nce_biases, train_labels, embed, num_sampled, vocabulary_size))</p>\n<p>I run into the bug:<br>\n<code>  File \".../tensorflow/python/ops/nn.py\", line 1336, in nce_loss name=name) File \".../tensorflow/python/ops/nn.py\", line 1198, in _compute_sampled_logits array_ops.reshape(true_w, new_true_w_shape)) File \".../tensorflow/python/ops/gen_math_ops.py\", line 1613, in mul result = _op_def_lib.apply_op(\"Mul\", x=x, y=y, name=name) File \".../tensorflow/python/framework/op_def_library.py\", line 521, in apply_op inferred_from[input_arg.type_attr])) TypeError: Input 'y' of 'Mul' Op has type float32 that does not match type int32 of argument 'x'.</code></p>\n<p>I looked into the source code for nce_loss but couldn't seem to find the cause of this bug. Can anyone help me with this? Thanks a lot!</p>", "body_text": "So for tf.nn.nce_loss for word2vec_basic, if I explicitly use keyword arguments, such as:\ntf.nn.nce_loss(weights=nce_weights,\nbiases=nce_biases,\nlabels=train_labels,\ninputs=embed,\nnum_sampled=num_sampled,\nnum_classes=vocabulary_size))\neverything is fine. But if I get rid of the keywords:\ntf.nn.nce_loss(nce_weights, nce_biases, train_labels, embed, num_sampled, vocabulary_size))\nI run into the bug:\n  File \".../tensorflow/python/ops/nn.py\", line 1336, in nce_loss name=name) File \".../tensorflow/python/ops/nn.py\", line 1198, in _compute_sampled_logits array_ops.reshape(true_w, new_true_w_shape)) File \".../tensorflow/python/ops/gen_math_ops.py\", line 1613, in mul result = _op_def_lib.apply_op(\"Mul\", x=x, y=y, name=name) File \".../tensorflow/python/framework/op_def_library.py\", line 521, in apply_op inferred_from[input_arg.type_attr])) TypeError: Input 'y' of 'Mul' Op has type float32 that does not match type int32 of argument 'x'.\nI looked into the source code for nce_loss but couldn't seem to find the cause of this bug. Can anyone help me with this? Thanks a lot!", "body": "So for tf.nn.nce_loss for word2vec_basic, if I explicitly use keyword arguments, such as:\r\n      tf.nn.nce_loss(weights=nce_weights,\r\n                     biases=nce_biases,\r\n                     labels=train_labels,\r\n                     inputs=embed,\r\n                     num_sampled=num_sampled,\r\n                     num_classes=vocabulary_size))\r\n\r\neverything is fine. But if I get rid of the keywords:\r\n      tf.nn.nce_loss(nce_weights, nce_biases, train_labels, embed, num_sampled, vocabulary_size))\r\n\r\nI run into the bug: \r\n`  File \".../tensorflow/python/ops/nn.py\", line 1336, in nce_loss\r\n    name=name)\r\n  File \".../tensorflow/python/ops/nn.py\", line 1198, in _compute_sampled_logits\r\n    array_ops.reshape(true_w, new_true_w_shape))\r\n  File \".../tensorflow/python/ops/gen_math_ops.py\", line 1613, in mul\r\n    result = _op_def_lib.apply_op(\"Mul\", x=x, y=y, name=name)\r\n  File \".../tensorflow/python/framework/op_def_library.py\", line 521, in apply_op\r\n    inferred_from[input_arg.type_attr]))\r\nTypeError: Input 'y' of 'Mul' Op has type float32 that does not match type int32 of argument 'x'.`\r\n\r\nI looked into the source code for nce_loss but couldn't seem to find the cause of this bug. Can anyone help me with this? Thanks a lot!"}