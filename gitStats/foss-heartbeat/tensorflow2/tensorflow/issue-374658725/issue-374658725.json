{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23318", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23318/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23318/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23318/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23318", "id": 374658725, "node_id": "MDU6SXNzdWUzNzQ2NTg3MjU=", "number": 23318, "title": "tf.nn.conv2d_transpose with the same inputs produces different outputs on different calls on GPU", "user": {"login": "aiueogawa", "id": 30866185, "node_id": "MDQ6VXNlcjMwODY2MTg1", "avatar_url": "https://avatars0.githubusercontent.com/u/30866185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aiueogawa", "html_url": "https://github.com/aiueogawa", "followers_url": "https://api.github.com/users/aiueogawa/followers", "following_url": "https://api.github.com/users/aiueogawa/following{/other_user}", "gists_url": "https://api.github.com/users/aiueogawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/aiueogawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aiueogawa/subscriptions", "organizations_url": "https://api.github.com/users/aiueogawa/orgs", "repos_url": "https://api.github.com/users/aiueogawa/repos", "events_url": "https://api.github.com/users/aiueogawa/events{/privacy}", "received_events_url": "https://api.github.com/users/aiueogawa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": {"login": "ekelsen", "id": 2533174, "node_id": "MDQ6VXNlcjI1MzMxNzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2533174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekelsen", "html_url": "https://github.com/ekelsen", "followers_url": "https://api.github.com/users/ekelsen/followers", "following_url": "https://api.github.com/users/ekelsen/following{/other_user}", "gists_url": "https://api.github.com/users/ekelsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekelsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekelsen/subscriptions", "organizations_url": "https://api.github.com/users/ekelsen/orgs", "repos_url": "https://api.github.com/users/ekelsen/repos", "events_url": "https://api.github.com/users/ekelsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ekelsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ekelsen", "id": 2533174, "node_id": "MDQ6VXNlcjI1MzMxNzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2533174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekelsen", "html_url": "https://github.com/ekelsen", "followers_url": "https://api.github.com/users/ekelsen/followers", "following_url": "https://api.github.com/users/ekelsen/following{/other_user}", "gists_url": "https://api.github.com/users/ekelsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekelsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekelsen/subscriptions", "organizations_url": "https://api.github.com/users/ekelsen/orgs", "repos_url": "https://api.github.com/users/ekelsen/repos", "events_url": "https://api.github.com/users/ekelsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ekelsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-10-27T15:44:26Z", "updated_at": "2018-11-16T02:32:02Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><strong>System information</strong></p>\n<ul>\n<li>Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes</li>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04.5 LTS (Xenial Xerus)</li>\n<li>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: None</li>\n<li>TensorFlow installed from (source or binary): source</li>\n<li>TensorFlow version (use command below): v1.10.1-0-g4dcfddc</li>\n<li>Python version: Python 3.6.5</li>\n<li>Bazel version (if compiling from source): 0.16.1</li>\n<li>GCC/Compiler version (if compiling from source): 5.4.0-6ubuntu1~16.04.10</li>\n<li>CUDA/cuDNN version: V9.0.176/7.1.4.18</li>\n<li>GPU model and memory: GeForce GTX 1080 Ti with 12GB memory</li>\n</ul>\n<p><strong>Describe the current behavior</strong><br>\n<code>tf.nn.conv2d_transpose</code> with the same inputs produces different outputs on different calls on GPU.</p>\n<p><strong>Describe the expected behavior</strong><br>\n<code>tf.nn.conv2d_transpose</code> with the same inputs is expected to produce the same outputs on different calls on GPU.</p>\n<p><strong>Code to reproduce the issue</strong><br>\nThe code below</p>\n<pre><code>import tensorflow as tf\ntf.enable_eager_execution()\n\n\nx = tf.random_uniform([1, 1024, 32, 32])\nfilter = tf.random_uniform([4, 4, 96, 1024])\n\ny1 = tf.nn.conv2d_transpose(x, filter, [1, 96, 64, 64], strides=[1, 1, 2, 2], padding='SAME', data_format='NCHW')\ny2 = tf.nn.conv2d_transpose(x, filter, [1, 96, 64, 64], strides=[1, 1, 2, 2], padding='SAME', data_format='NCHW')\n\n# show difference between y1 and y2\nprint(tf.reduce_mean(tf.abs(y1 - y2)))\n</code></pre>\n<p>produces a non-zero result like</p>\n<pre><code>tf.Tensor(8.213489e-06, shape=(), dtype=float32)\n</code></pre>\n<p><strong>Other info / logs</strong><br>\n<code>tf.nn.conv2d_transpose</code> with the same inputs produces the same outputs on different calls on <strong>CPU</strong>.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04.5 LTS (Xenial Xerus)\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: None\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): v1.10.1-0-g4dcfddc\nPython version: Python 3.6.5\nBazel version (if compiling from source): 0.16.1\nGCC/Compiler version (if compiling from source): 5.4.0-6ubuntu1~16.04.10\nCUDA/cuDNN version: V9.0.176/7.1.4.18\nGPU model and memory: GeForce GTX 1080 Ti with 12GB memory\n\nDescribe the current behavior\ntf.nn.conv2d_transpose with the same inputs produces different outputs on different calls on GPU.\nDescribe the expected behavior\ntf.nn.conv2d_transpose with the same inputs is expected to produce the same outputs on different calls on GPU.\nCode to reproduce the issue\nThe code below\nimport tensorflow as tf\ntf.enable_eager_execution()\n\n\nx = tf.random_uniform([1, 1024, 32, 32])\nfilter = tf.random_uniform([4, 4, 96, 1024])\n\ny1 = tf.nn.conv2d_transpose(x, filter, [1, 96, 64, 64], strides=[1, 1, 2, 2], padding='SAME', data_format='NCHW')\ny2 = tf.nn.conv2d_transpose(x, filter, [1, 96, 64, 64], strides=[1, 1, 2, 2], padding='SAME', data_format='NCHW')\n\n# show difference between y1 and y2\nprint(tf.reduce_mean(tf.abs(y1 - y2)))\n\nproduces a non-zero result like\ntf.Tensor(8.213489e-06, shape=(), dtype=float32)\n\nOther info / logs\ntf.nn.conv2d_transpose with the same inputs produces the same outputs on different calls on CPU.", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04.5 LTS (Xenial Xerus)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: None\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): v1.10.1-0-g4dcfddc\r\n- Python version: Python 3.6.5\r\n- Bazel version (if compiling from source): 0.16.1\r\n- GCC/Compiler version (if compiling from source): 5.4.0-6ubuntu1~16.04.10\r\n- CUDA/cuDNN version: V9.0.176/7.1.4.18\r\n- GPU model and memory: GeForce GTX 1080 Ti with 12GB memory\r\n\r\n**Describe the current behavior**\r\n`tf.nn.conv2d_transpose` with the same inputs produces different outputs on different calls on GPU.\r\n\r\n**Describe the expected behavior**\r\n`tf.nn.conv2d_transpose` with the same inputs is expected to produce the same outputs on different calls on GPU.\r\n\r\n**Code to reproduce the issue**\r\nThe code below\r\n\r\n```\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\n\r\n\r\nx = tf.random_uniform([1, 1024, 32, 32])\r\nfilter = tf.random_uniform([4, 4, 96, 1024])\r\n\r\ny1 = tf.nn.conv2d_transpose(x, filter, [1, 96, 64, 64], strides=[1, 1, 2, 2], padding='SAME', data_format='NCHW')\r\ny2 = tf.nn.conv2d_transpose(x, filter, [1, 96, 64, 64], strides=[1, 1, 2, 2], padding='SAME', data_format='NCHW')\r\n\r\n# show difference between y1 and y2\r\nprint(tf.reduce_mean(tf.abs(y1 - y2)))\r\n```\r\n\r\nproduces a non-zero result like\r\n\r\n```\r\ntf.Tensor(8.213489e-06, shape=(), dtype=float32)\r\n```\r\n\r\n**Other info / logs**\r\n`tf.nn.conv2d_transpose` with the same inputs produces the same outputs on different calls on **CPU**."}