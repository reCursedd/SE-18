{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/277046074", "html_url": "https://github.com/tensorflow/tensorflow/issues/7172#issuecomment-277046074", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7172", "id": 277046074, "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzA0NjA3NA==", "user": {"login": "civilman628", "id": 8059551, "node_id": "MDQ6VXNlcjgwNTk1NTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/8059551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/civilman628", "html_url": "https://github.com/civilman628", "followers_url": "https://api.github.com/users/civilman628/followers", "following_url": "https://api.github.com/users/civilman628/following{/other_user}", "gists_url": "https://api.github.com/users/civilman628/gists{/gist_id}", "starred_url": "https://api.github.com/users/civilman628/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/civilman628/subscriptions", "organizations_url": "https://api.github.com/users/civilman628/orgs", "repos_url": "https://api.github.com/users/civilman628/repos", "events_url": "https://api.github.com/users/civilman628/events{/privacy}", "received_events_url": "https://api.github.com/users/civilman628/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-02T18:48:27Z", "updated_at": "2017-02-02T18:50:37Z", "author_association": "NONE", "body_html": "<p>i figure out how to use them. the code below is to export .pbtxt file for inception_resnet_v2.</p>\n<p>Use this .pbtxt and the published .ckpt to  freeze graph, if you want to get .pb file.</p>\n<p>if you want to load other models or get other .pbtxt files, just change the key word <strong>inception_resnet_v2</strong> to other model name, such as <strong>inception_v2</strong>, <strong>inception_v3</strong></p>\n<p>the first node of .pb file is <strong>Placeholder</strong>, which is the input 4D tensor of image, such as [1,299,299,3]</p>\n<p>you can use .ckpt for prediction as below. The endpoint is \"Prediction\", But I use .pb in general, which is smaller.</p>\n<pre><code>import tensorflow as tf\nimport tensorflow.contrib.slim as slim\nfrom nets.inception_resnet_v2 import inception_resnet_v2, inception_resnet_v2_arg_scope\nimport numpy as np\n\nheight = 299\nwidth = 299\nchannels = 3\n\n# Create graph\nX = tf.placeholder(tf.float32, shape=[None, height, width, channels])\nwith slim.arg_scope(inception_resnet_v2_arg_scope()):\n    logits, end_points = inception_resnet_v2(X, num_classes=1001,is_training=False)\npredictions = end_points[\"Predictions\"]\nsaver = tf.train.Saver()\n\nX_test = np.ones((1,299,299,3))  # a fake image, you can use your own image\n\n# Execute graph\nwith tf.Session() as sess:\n    saver.restore(sess, \"./inception_resnet_v2.ckpt\")\n    predictions_val = predictions.eval(feed_dict={X: X_test})\n    tf.train.write_graph(sess.graph_def, './', 'resnetv2.pbtxt')\n</code></pre>", "body_text": "i figure out how to use them. the code below is to export .pbtxt file for inception_resnet_v2.\nUse this .pbtxt and the published .ckpt to  freeze graph, if you want to get .pb file.\nif you want to load other models or get other .pbtxt files, just change the key word inception_resnet_v2 to other model name, such as inception_v2, inception_v3\nthe first node of .pb file is Placeholder, which is the input 4D tensor of image, such as [1,299,299,3]\nyou can use .ckpt for prediction as below. The endpoint is \"Prediction\", But I use .pb in general, which is smaller.\nimport tensorflow as tf\nimport tensorflow.contrib.slim as slim\nfrom nets.inception_resnet_v2 import inception_resnet_v2, inception_resnet_v2_arg_scope\nimport numpy as np\n\nheight = 299\nwidth = 299\nchannels = 3\n\n# Create graph\nX = tf.placeholder(tf.float32, shape=[None, height, width, channels])\nwith slim.arg_scope(inception_resnet_v2_arg_scope()):\n    logits, end_points = inception_resnet_v2(X, num_classes=1001,is_training=False)\npredictions = end_points[\"Predictions\"]\nsaver = tf.train.Saver()\n\nX_test = np.ones((1,299,299,3))  # a fake image, you can use your own image\n\n# Execute graph\nwith tf.Session() as sess:\n    saver.restore(sess, \"./inception_resnet_v2.ckpt\")\n    predictions_val = predictions.eval(feed_dict={X: X_test})\n    tf.train.write_graph(sess.graph_def, './', 'resnetv2.pbtxt')", "body": "i figure out how to use them. the code below is to export .pbtxt file for inception_resnet_v2.\r\n\r\nUse this .pbtxt and the published .ckpt to  freeze graph, if you want to get .pb file.\r\n\r\nif you want to load other models or get other .pbtxt files, just change the key word **inception_resnet_v2** to other model name, such as **inception_v2**, **inception_v3**\r\n\r\nthe first node of .pb file is **Placeholder**, which is the input 4D tensor of image, such as [1,299,299,3]\r\n\r\nyou can use .ckpt for prediction as below. The endpoint is \"Prediction\", But I use .pb in general, which is smaller.\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.slim as slim\r\nfrom nets.inception_resnet_v2 import inception_resnet_v2, inception_resnet_v2_arg_scope\r\nimport numpy as np\r\n\r\nheight = 299\r\nwidth = 299\r\nchannels = 3\r\n\r\n# Create graph\r\nX = tf.placeholder(tf.float32, shape=[None, height, width, channels])\r\nwith slim.arg_scope(inception_resnet_v2_arg_scope()):\r\n    logits, end_points = inception_resnet_v2(X, num_classes=1001,is_training=False)\r\npredictions = end_points[\"Predictions\"]\r\nsaver = tf.train.Saver()\r\n\r\nX_test = np.ones((1,299,299,3))  # a fake image, you can use your own image\r\n\r\n# Execute graph\r\nwith tf.Session() as sess:\r\n    saver.restore(sess, \"./inception_resnet_v2.ckpt\")\r\n    predictions_val = predictions.eval(feed_dict={X: X_test})\r\n    tf.train.write_graph(sess.graph_def, './', 'resnetv2.pbtxt')\r\n```"}