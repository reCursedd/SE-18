{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7172", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7172/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7172/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7172/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7172", "id": 204464520, "node_id": "MDU6SXNzdWUyMDQ0NjQ1MjA=", "number": 7172, "title": "freeze graph fail by using the published checkpoint file: Attempting to use uninitialized value", "user": {"login": "civilman628", "id": 8059551, "node_id": "MDQ6VXNlcjgwNTk1NTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/8059551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/civilman628", "html_url": "https://github.com/civilman628", "followers_url": "https://api.github.com/users/civilman628/followers", "following_url": "https://api.github.com/users/civilman628/following{/other_user}", "gists_url": "https://api.github.com/users/civilman628/gists{/gist_id}", "starred_url": "https://api.github.com/users/civilman628/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/civilman628/subscriptions", "organizations_url": "https://api.github.com/users/civilman628/orgs", "repos_url": "https://api.github.com/users/civilman628/repos", "events_url": "https://api.github.com/users/civilman628/events{/privacy}", "received_events_url": "https://api.github.com/users/civilman628/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 21, "created_at": "2017-02-01T00:26:26Z", "updated_at": "2018-06-04T09:49:48Z", "closed_at": "2017-02-10T22:48:05Z", "author_association": "NONE", "body_html": "<p>I am using the latest Tensorflow code on Ubuntu 16.04</p>\n<ol>\n<li>\n<p>I download <strong>Inception-ResNet-v2</strong> model from the link <a href=\"https://github.com/tensorflow/models/tree/master/slim\">https://github.com/tensorflow/models/tree/master/slim</a><br>\nthe check point file is:<br>\n<a href=\"http://download.tensorflow.org/models/inception_resnet_v2_2016_08_30.tar.gz\" rel=\"nofollow\">http://download.tensorflow.org/models/inception_resnet_v2_2016_08_30.tar.gz</a></p>\n</li>\n<li>\n<p>use the code below to get graph define, which output is <strong>graph.pbtxt</strong></p>\n</li>\n</ol>\n<pre><code>import tensorflow as tf\nfrom nets import inception_resnet_v2\nimport numpy as np\n\nx = tf.placeholder(shape=[1,299,299,3], dtype=tf.float32)\ninception_resnet_v2 = inception_resnet_v2.inception_resnet_v2(x)\n\nsess = tf.Session()\ntf.train.write_graph(sess.graph_def, './', 'graph.pbtxt')\n</code></pre>\n<p>3, use the freeze graph tool to get <strong>.pb</strong> file.</p>\n<p><code>bazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/home/scopeserver/RaidDisk/DeepLearning/mwang/Model_backup2/slim/graph.pbtxt --input_checkpoint=/home/scopeserver/RaidDisk/DeepLearning/mwang/Model_backup2/slim/inception_resnet_v2_2016_08_30.ckpt   --output_graph=/tmp/frozen_graph.pb --output_node_names=InceptionResnetV2/Logits/Predictions</code></p>\n<p>i get the error:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 218, in &lt;module&gt;\n    app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 44, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 150, in main\n    FLAGS.variable_names_blacklist)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 138, in freeze_graph\n    variable_names_blacklist=variable_names_blacklist)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/graph_util_impl.py\", line 218, in convert_variables_to_constants\n    returned_variables = sess.run(variable_names)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.FailedPreconditionError: **Attempting to use uninitialized value InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases**\n\t [[Node: _send_InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases_0 = _Send[T=DT_FLOAT, client_terminated=true, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=4447330825950993621, tensor_name=\"InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases:0\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases)]]\n\n\n</code></pre>", "body_text": "I am using the latest Tensorflow code on Ubuntu 16.04\n\n\nI download Inception-ResNet-v2 model from the link https://github.com/tensorflow/models/tree/master/slim\nthe check point file is:\nhttp://download.tensorflow.org/models/inception_resnet_v2_2016_08_30.tar.gz\n\n\nuse the code below to get graph define, which output is graph.pbtxt\n\n\nimport tensorflow as tf\nfrom nets import inception_resnet_v2\nimport numpy as np\n\nx = tf.placeholder(shape=[1,299,299,3], dtype=tf.float32)\ninception_resnet_v2 = inception_resnet_v2.inception_resnet_v2(x)\n\nsess = tf.Session()\ntf.train.write_graph(sess.graph_def, './', 'graph.pbtxt')\n\n3, use the freeze graph tool to get .pb file.\nbazel-bin/tensorflow/python/tools/freeze_graph --input_graph=/home/scopeserver/RaidDisk/DeepLearning/mwang/Model_backup2/slim/graph.pbtxt --input_checkpoint=/home/scopeserver/RaidDisk/DeepLearning/mwang/Model_backup2/slim/inception_resnet_v2_2016_08_30.ckpt   --output_graph=/tmp/frozen_graph.pb --output_node_names=InceptionResnetV2/Logits/Predictions\ni get the error:\nTraceback (most recent call last):\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 218, in <module>\n    app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 44, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 150, in main\n    FLAGS.variable_names_blacklist)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 138, in freeze_graph\n    variable_names_blacklist=variable_names_blacklist)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/graph_util_impl.py\", line 218, in convert_variables_to_constants\n    returned_variables = sess.run(variable_names)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.FailedPreconditionError: **Attempting to use uninitialized value InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases**\n\t [[Node: _send_InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases_0 = _Send[T=DT_FLOAT, client_terminated=true, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=4447330825950993621, tensor_name=\"InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases:0\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases)]]", "body": "I am using the latest Tensorflow code on Ubuntu 16.04\r\n\r\n1. I download **Inception-ResNet-v2** model from the link https://github.com/tensorflow/models/tree/master/slim    \r\nthe check point file is:\r\nhttp://download.tensorflow.org/models/inception_resnet_v2_2016_08_30.tar.gz\r\n\r\n2. use the code below to get graph define, which output is **graph.pbtxt**\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom nets import inception_resnet_v2\r\nimport numpy as np\r\n\r\nx = tf.placeholder(shape=[1,299,299,3], dtype=tf.float32)\r\ninception_resnet_v2 = inception_resnet_v2.inception_resnet_v2(x)\r\n\r\nsess = tf.Session()\r\ntf.train.write_graph(sess.graph_def, './', 'graph.pbtxt')\r\n```\r\n3, use the freeze graph tool to get **.pb** file. \r\n\r\n`bazel-bin/tensorflow/python/tools/freeze_graph\r\n --input_graph=/home/scopeserver/RaidDisk/DeepLearning/mwang/Model_backup2/slim/graph.pbtxt --input_checkpoint=/home/scopeserver/RaidDisk/DeepLearning/mwang/Model_backup2/slim/inception_resnet_v2_2016_08_30.ckpt  \r\n--output_graph=/tmp/frozen_graph.pb --output_node_names=InceptionResnetV2/Logits/Predictions`\r\n\r\ni get the error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 218, in <module>\r\n    app.run(main=main, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 44, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 150, in main\r\n    FLAGS.variable_names_blacklist)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 138, in freeze_graph\r\n    variable_names_blacklist=variable_names_blacklist)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/graph_util_impl.py\", line 218, in convert_variables_to_constants\r\n    returned_variables = sess.run(variable_names)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/home/scopeserver/RaidDisk/DeepLearning/mwang/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.FailedPreconditionError: **Attempting to use uninitialized value InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases**\r\n\t [[Node: _send_InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases_0 = _Send[T=DT_FLOAT, client_terminated=true, recv_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device=\"/job:localhost/replica:0/task:0/cpu:0\", send_device_incarnation=4447330825950993621, tensor_name=\"InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases:0\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](InceptionResnetV2/Repeat_1/block17_16/Branch_1/Conv2d_0c_7x1/biases)]]\r\n\r\n\r\n```"}