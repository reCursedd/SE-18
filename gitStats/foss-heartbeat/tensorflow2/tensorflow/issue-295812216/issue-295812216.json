{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16887", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16887/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16887/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16887/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16887", "id": 295812216, "node_id": "MDU6SXNzdWUyOTU4MTIyMTY=", "number": 16887, "title": "A problem about gcc 5.5.0. It does not compile TensorFlow.", "user": {"login": "daisylab", "id": 31073109, "node_id": "MDQ6VXNlcjMxMDczMTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/31073109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daisylab", "html_url": "https://github.com/daisylab", "followers_url": "https://api.github.com/users/daisylab/followers", "following_url": "https://api.github.com/users/daisylab/following{/other_user}", "gists_url": "https://api.github.com/users/daisylab/gists{/gist_id}", "starred_url": "https://api.github.com/users/daisylab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daisylab/subscriptions", "organizations_url": "https://api.github.com/users/daisylab/orgs", "repos_url": "https://api.github.com/users/daisylab/repos", "events_url": "https://api.github.com/users/daisylab/events{/privacy}", "received_events_url": "https://api.github.com/users/daisylab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-02-09T09:52:07Z", "updated_at": "2018-02-23T01:44:52Z", "closed_at": "2018-02-23T00:27:37Z", "author_association": "NONE", "body_html": "<p>Please go to Stack Overflow for help and support:</p>\n<p><a href=\"https://stackoverflow.com/questions/tagged/tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/tagged/tensorflow</a></p>\n<p>If you open a GitHub issue, here is our policy:</p>\n<ol>\n<li>It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).</li>\n<li>The form below must be filled out.</li>\n<li>It shouldn't be a TensorBoard issue. Those go <a href=\"https://github.com/tensorflow/tensorboard/issues\">here</a>.</li>\n</ol>\n<p><strong>Here's why we have that policy</strong>: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.</p>\n<hr>\n<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nNO.</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nSlackware Linux 14.2 64 bit</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>:<br>\nsource</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>:<br>\n1.5.0</p>\n</li>\n<li>\n<p><strong>Python version</strong>:<br>\n3.6.4</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>:<br>\n0.5.4</p>\n</li>\n<li>\n<p><strong>GCC/Compiler version (if compiling from source)</strong>:<br>\n5.5.0</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:<br>\n9.0/7</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\n1050Ti / 4Gb</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:<br>\nbazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package</p>\n</li>\n</ul>\n<p>You can collect some of this information using our environment capture script:</p>\n<p><a href=\"https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\">https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh</a></p>\n<p>You can obtain the TensorFlow version with</p>\n<p>python -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"</p>\n<h3>Describe the problem</h3>\n<p>Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.</p>\n<h4>gcc 5.5.0 does not compile TF source code.</h4>\n<p>First of all, sorry for that I'm NOT using Ubuntu Linux for TF. I know that Ubuntu Linux is the only supported Linux system for TF. Instead, I use an ancient distribution, i.e., Slackware Linux. Recently, I got a security update for Spectre. As a side-effect, I also got an updated gcc (5.3.0 -&gt; 5.5.0).</p>\n<p>I usually compile the TensorFlow source code for optimization. However, it can not be compiled with updated gcc (5.5.0), like this;</p>\n<pre><code>INFO: From Compiling tensorflow/contrib/resampler/kernels/resampler_ops_gpu.cu.cc:\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9220): error: argument of type \"const void *\" is incompatible with parameter of type \"const float *\"\n\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9231): error: argument of type \"const void *\" is incompatible with parameter of type \"const float *\"\n\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9244): error: argument of type \"const void *\" is incompatible with parameter of type \"const double *\"\n\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9255): error: argument of type \"const void *\" is incompatible with parameter of type \"const double *\"\n</code></pre>\n<p>So I googled a little bit, and found the following issue:</p>\n<p><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"231642042\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10220\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/10220/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/10220\">#10220</a></p>\n<p>in the middle of the thread, I saw</p>\n<blockquote>\n<p>I think the problem here is that gcc-5.5 shipped with avx512<em>intrin.h headers that switched to using void</em> and const void* (<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731\" rel=\"nofollow\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731</a>) but without switching the builtins to do the same. This is why 5.4 works but 5.5 breaks.</p>\n</blockquote>\n<p>so I tracked down the matter that I could see</p>\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731\" rel=\"nofollow\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731</a></p>\n<blockquote>\n<p>All of the scatter/gather intrinsics in avx512intrin.h use int/float/double pointers, which is incorrect.</p>\n</blockquote>\n<p>So, at first, I thought this problem is about gcc, but someone suggested that it's maybe related to CUDA.</p>\n<blockquote>\n<p>it's the GPU/CUDA code that doesn't support the new compiler so, if you want to build that, your only option is downgrade the compiler, until Nvidia releases a new CUDA sdk.</p>\n</blockquote>\n<p>from <a href=\"https://www.linuxquestions.org/questions/showthread.php?p=5817669#post5817669\" rel=\"nofollow\">https://www.linuxquestions.org/questions/showthread.php?p=5817669#post5817669</a></p>\n<p>To wrap up, I was able to compile TF successfully with gcc 5.3.0. With gcc 5.5.0, I get error messages here and there, and yet I do not know what makes this errors. I suspect the combination of gcc and CUDA (and also TensorFlow) does not work well, but I still can not figure out which of them makes this fault.</p>\n<p>Thank you for your help.</p>\n<p>Best regards,<br>\nsungjin.</p>\n<h3>Source code / logs</h3>\n<p>Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.</p>", "body_text": "Please go to Stack Overflow for help and support:\nhttps://stackoverflow.com/questions/tagged/tensorflow\nIf you open a GitHub issue, here is our policy:\n\nIt must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\nThe form below must be filled out.\nIt shouldn't be a TensorBoard issue. Those go here.\n\nHere's why we have that policy: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\n\nSystem information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNO.\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nSlackware Linux 14.2 64 bit\n\n\nTensorFlow installed from (source or binary):\nsource\n\n\nTensorFlow version (use command below):\n1.5.0\n\n\nPython version:\n3.6.4\n\n\nBazel version (if compiling from source):\n0.5.4\n\n\nGCC/Compiler version (if compiling from source):\n5.5.0\n\n\nCUDA/cuDNN version:\n9.0/7\n\n\nGPU model and memory:\n1050Ti / 4Gb\n\n\nExact command to reproduce:\nbazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\n\n\nYou can collect some of this information using our environment capture script:\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\nYou can obtain the TensorFlow version with\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\nDescribe the problem\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\ngcc 5.5.0 does not compile TF source code.\nFirst of all, sorry for that I'm NOT using Ubuntu Linux for TF. I know that Ubuntu Linux is the only supported Linux system for TF. Instead, I use an ancient distribution, i.e., Slackware Linux. Recently, I got a security update for Spectre. As a side-effect, I also got an updated gcc (5.3.0 -> 5.5.0).\nI usually compile the TensorFlow source code for optimization. However, it can not be compiled with updated gcc (5.5.0), like this;\nINFO: From Compiling tensorflow/contrib/resampler/kernels/resampler_ops_gpu.cu.cc:\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9220): error: argument of type \"const void *\" is incompatible with parameter of type \"const float *\"\n\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9231): error: argument of type \"const void *\" is incompatible with parameter of type \"const float *\"\n\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9244): error: argument of type \"const void *\" is incompatible with parameter of type \"const double *\"\n\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9255): error: argument of type \"const void *\" is incompatible with parameter of type \"const double *\"\n\nSo I googled a little bit, and found the following issue:\n#10220\nin the middle of the thread, I saw\n\nI think the problem here is that gcc-5.5 shipped with avx512intrin.h headers that switched to using void and const void* (https://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731) but without switching the builtins to do the same. This is why 5.4 works but 5.5 breaks.\n\nso I tracked down the matter that I could see\nhttps://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731\n\nAll of the scatter/gather intrinsics in avx512intrin.h use int/float/double pointers, which is incorrect.\n\nSo, at first, I thought this problem is about gcc, but someone suggested that it's maybe related to CUDA.\n\nit's the GPU/CUDA code that doesn't support the new compiler so, if you want to build that, your only option is downgrade the compiler, until Nvidia releases a new CUDA sdk.\n\nfrom https://www.linuxquestions.org/questions/showthread.php?p=5817669#post5817669\nTo wrap up, I was able to compile TF successfully with gcc 5.3.0. With gcc 5.5.0, I get error messages here and there, and yet I do not know what makes this errors. I suspect the combination of gcc and CUDA (and also TensorFlow) does not work well, but I still can not figure out which of them makes this fault.\nThank you for your help.\nBest regards,\nsungjin.\nSource code / logs\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNO.\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nSlackware Linux 14.2 64 bit\r\n\r\n- **TensorFlow installed from (source or binary)**:\r\nsource\r\n\r\n- **TensorFlow version (use command below)**:\r\n1.5.0\r\n\r\n- **Python version**: \r\n3.6.4\r\n\r\n- **Bazel version (if compiling from source)**:\r\n0.5.4\r\n\r\n- **GCC/Compiler version (if compiling from source)**:\r\n5.5.0\r\n\r\n- **CUDA/cuDNN version**:\r\n9.0/7\r\n\r\n- **GPU model and memory**:\r\n1050Ti / 4Gb\r\n\r\n- **Exact command to reproduce**:\r\nbazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\n\r\n#### gcc 5.5.0 does not compile TF source code.\r\n\r\nFirst of all, sorry for that I'm NOT using Ubuntu Linux for TF. I know that Ubuntu Linux is the only supported Linux system for TF. Instead, I use an ancient distribution, i.e., Slackware Linux. Recently, I got a security update for Spectre. As a side-effect, I also got an updated gcc (5.3.0 -> 5.5.0).\r\n\r\nI usually compile the TensorFlow source code for optimization. However, it can not be compiled with updated gcc (5.5.0), like this;\r\n\r\n\r\n```\r\nINFO: From Compiling tensorflow/contrib/resampler/kernels/resampler_ops_gpu.cu.cc:\r\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9220): error: argument of type \"const void *\" is incompatible with parameter of type \"const float *\"\r\n\r\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9231): error: argument of type \"const void *\" is incompatible with parameter of type \"const float *\"\r\n\r\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9244): error: argument of type \"const void *\" is incompatible with parameter of type \"const double *\"\r\n\r\n/usr/lib64/gcc/x86_64-slackware-linux/5.5.0/include/avx512fintrin.h(9255): error: argument of type \"const void *\" is incompatible with parameter of type \"const double *\"\r\n```\r\n\r\n\r\nSo I googled a little bit, and found the following issue:\r\n\r\n#10220 \r\n\r\nin the middle of the thread, I saw\r\n\r\n> I think the problem here is that gcc-5.5 shipped with avx512*intrin.h headers that switched to using void* and const void* (https://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731) but without switching the builtins to do the same. This is why 5.4 works but 5.5 breaks. \r\n\r\n\r\nso I tracked down the matter that I could see \r\n\r\nhttps://gcc.gnu.org/bugzilla/show_bug.cgi?id=76731\r\n\r\n> All of the scatter/gather intrinsics in avx512intrin.h use int/float/double pointers, which is incorrect. \r\n\r\nSo, at first, I thought this problem is about gcc, but someone suggested that it's maybe related to CUDA.\r\n\r\n> it's the GPU/CUDA code that doesn't support the new compiler so, if you want to build that, your only option is downgrade the compiler, until Nvidia releases a new CUDA sdk.\r\n\r\nfrom https://www.linuxquestions.org/questions/showthread.php?p=5817669#post5817669\r\n\r\nTo wrap up, I was able to compile TF successfully with gcc 5.3.0. With gcc 5.5.0, I get error messages here and there, and yet I do not know what makes this errors. I suspect the combination of gcc and CUDA (and also TensorFlow) does not work well, but I still can not figure out which of them makes this fault.\r\n\r\nThank you for your help.\r\n\r\n\r\nBest regards,\r\nsungjin.\r\n\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}