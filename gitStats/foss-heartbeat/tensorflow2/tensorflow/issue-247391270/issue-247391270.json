{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11967", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11967/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11967/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11967/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11967", "id": 247391270, "node_id": "MDU6SXNzdWUyNDczOTEyNzA=", "number": 11967, "title": "Training_ops_test assertion failures on Ubuntu 16.04", "user": {"login": "namrata-ibm", "id": 21953668, "node_id": "MDQ6VXNlcjIxOTUzNjY4", "avatar_url": "https://avatars3.githubusercontent.com/u/21953668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/namrata-ibm", "html_url": "https://github.com/namrata-ibm", "followers_url": "https://api.github.com/users/namrata-ibm/followers", "following_url": "https://api.github.com/users/namrata-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/namrata-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/namrata-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/namrata-ibm/subscriptions", "organizations_url": "https://api.github.com/users/namrata-ibm/orgs", "repos_url": "https://api.github.com/users/namrata-ibm/repos", "events_url": "https://api.github.com/users/namrata-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/namrata-ibm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "poxvoculi", "id": 15676913, "node_id": "MDQ6VXNlcjE1Njc2OTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15676913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poxvoculi", "html_url": "https://github.com/poxvoculi", "followers_url": "https://api.github.com/users/poxvoculi/followers", "following_url": "https://api.github.com/users/poxvoculi/following{/other_user}", "gists_url": "https://api.github.com/users/poxvoculi/gists{/gist_id}", "starred_url": "https://api.github.com/users/poxvoculi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poxvoculi/subscriptions", "organizations_url": "https://api.github.com/users/poxvoculi/orgs", "repos_url": "https://api.github.com/users/poxvoculi/repos", "events_url": "https://api.github.com/users/poxvoculi/events{/privacy}", "received_events_url": "https://api.github.com/users/poxvoculi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "poxvoculi", "id": 15676913, "node_id": "MDQ6VXNlcjE1Njc2OTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15676913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poxvoculi", "html_url": "https://github.com/poxvoculi", "followers_url": "https://api.github.com/users/poxvoculi/followers", "following_url": "https://api.github.com/users/poxvoculi/following{/other_user}", "gists_url": "https://api.github.com/users/poxvoculi/gists{/gist_id}", "starred_url": "https://api.github.com/users/poxvoculi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poxvoculi/subscriptions", "organizations_url": "https://api.github.com/users/poxvoculi/orgs", "repos_url": "https://api.github.com/users/poxvoculi/repos", "events_url": "https://api.github.com/users/poxvoculi/events{/privacy}", "received_events_url": "https://api.github.com/users/poxvoculi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2017-08-02T13:36:00Z", "updated_at": "2017-08-10T18:33:44Z", "closed_at": "2017-08-10T18:33:44Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>:  'v1.2.1-0-gb4957ff', '1.2.1'</li>\n<li><strong>Python version</strong>:  2.7.12</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.4.5</li>\n<li><strong>CUDA/cuDNN version</strong>: No GPU</li>\n<li><strong>GPU model and memory</strong>: No GPU</li>\n<li><strong>Exact command to reproduce</strong>: bazel test -c opt //tensorflow/python:training_ops_test</li>\n</ul>\n<h3>The problem</h3>\n<p>The <code>//tensorflow/python:training_ops_test</code> is failing on s390x with AssertionError in <code>_testTypesForFtrl</code> method. I have added test log below.</p>\n<p>A single value differs as below in the result:</p>\n<pre><code>lhs =  [-2.9473114]\nrhs =  [-2.94730377]\n</code></pre>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7946809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gunan\">@gunan</a>, I saw your suggestion in <a href=\"https://github.com/tensorflow/tensorflow/issues/8945#issuecomment-291763267\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8945/hovercard\">issue</a>, that the test tolerance bounds are too tight.</p>\n<p>So I tried increasing tolerance to <code>4e-06 </code> as below and test passes.</p>\n<pre><code>- self.assertAllClose(linear_update, linear.eval())\n+ self.assertAllClose(linear_update, linear.eval(), rtol=4e-06, atol=4e-06)\n</code></pre>\n<p>Is this tolerance level acceptable?</p>\n<h3>Source code / logs</h3>\n<pre><code>AssertionError:\nNot equal to tolerance rtol=1e-06, atol=1e-06\nNone\n(mismatch 1.0%)\n x: array([  1.020000e+02,   1.038411e+02,   1.050863e+02,   1.055917e+02,\n         1.053070e+02,   1.042043e+02,   1.022649e+02,   9.947507e+01,\n         9.582399e+01,   9.130299e+01,   8.590485e+01,   7.962347e+01,...\n y: array([  1.020000e+02,   1.038411e+02,   1.050863e+02,   1.055917e+02,\n         1.053070e+02,   1.042043e+02,   1.022649e+02,   9.947507e+01,\n         9.582399e+01,   9.130299e+01,   8.590485e+01,   7.962347e+01,...\n\n----------------------------------------------------------------------\n\nRan 9 tests in 4.704s\n\nFAILED (failures=1)\nnot close where =  (array([19]),)\nnot close lhs =  [-2.9473114]\nnot close rhs =  [-2.94730377]\nnot close dif =  [  7.62939453e-06]\nnot close tol =  [  3.94730387e-06]\ndtype = float32, shape = (100,)\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below):  'v1.2.1-0-gb4957ff', '1.2.1'\nPython version:  2.7.12\nBazel version (if compiling from source): 0.4.5\nCUDA/cuDNN version: No GPU\nGPU model and memory: No GPU\nExact command to reproduce: bazel test -c opt //tensorflow/python:training_ops_test\n\nThe problem\nThe //tensorflow/python:training_ops_test is failing on s390x with AssertionError in _testTypesForFtrl method. I have added test log below.\nA single value differs as below in the result:\nlhs =  [-2.9473114]\nrhs =  [-2.94730377]\n\n@gunan, I saw your suggestion in issue, that the test tolerance bounds are too tight.\nSo I tried increasing tolerance to 4e-06  as below and test passes.\n- self.assertAllClose(linear_update, linear.eval())\n+ self.assertAllClose(linear_update, linear.eval(), rtol=4e-06, atol=4e-06)\n\nIs this tolerance level acceptable?\nSource code / logs\nAssertionError:\nNot equal to tolerance rtol=1e-06, atol=1e-06\nNone\n(mismatch 1.0%)\n x: array([  1.020000e+02,   1.038411e+02,   1.050863e+02,   1.055917e+02,\n         1.053070e+02,   1.042043e+02,   1.022649e+02,   9.947507e+01,\n         9.582399e+01,   9.130299e+01,   8.590485e+01,   7.962347e+01,...\n y: array([  1.020000e+02,   1.038411e+02,   1.050863e+02,   1.055917e+02,\n         1.053070e+02,   1.042043e+02,   1.022649e+02,   9.947507e+01,\n         9.582399e+01,   9.130299e+01,   8.590485e+01,   7.962347e+01,...\n\n----------------------------------------------------------------------\n\nRan 9 tests in 4.704s\n\nFAILED (failures=1)\nnot close where =  (array([19]),)\nnot close lhs =  [-2.9473114]\nnot close rhs =  [-2.94730377]\nnot close dif =  [  7.62939453e-06]\nnot close tol =  [  3.94730387e-06]\ndtype = float32, shape = (100,)", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**:  'v1.2.1-0-gb4957ff', '1.2.1'\r\n- **Python version**:  2.7.12\r\n- **Bazel version (if compiling from source)**: 0.4.5\r\n- **CUDA/cuDNN version**: No GPU\r\n- **GPU model and memory**: No GPU\r\n- **Exact command to reproduce**: bazel test -c opt //tensorflow/python:training_ops_test\r\n\r\n### The problem\r\nThe `//tensorflow/python:training_ops_test` is failing on s390x with AssertionError in `_testTypesForFtrl` method. I have added test log below.\r\n\r\nA single value differs as below in the result:\r\n```\r\nlhs =  [-2.9473114]\r\nrhs =  [-2.94730377]\r\n```\r\n\r\n@gunan, I saw your suggestion in [issue](https://github.com/tensorflow/tensorflow/issues/8945#issuecomment-291763267), that the test tolerance bounds are too tight.\r\n\r\nSo I tried increasing tolerance to `4e-06 ` as below and test passes.\r\n\r\n```\r\n- self.assertAllClose(linear_update, linear.eval())\r\n+ self.assertAllClose(linear_update, linear.eval(), rtol=4e-06, atol=4e-06)\r\n```  \r\nIs this tolerance level acceptable?    \r\n\r\n   \r\n    \r\n    \r\n\r\n### Source code / logs   \r\n```\r\nAssertionError:\r\nNot equal to tolerance rtol=1e-06, atol=1e-06\r\nNone\r\n(mismatch 1.0%)\r\n x: array([  1.020000e+02,   1.038411e+02,   1.050863e+02,   1.055917e+02,\r\n         1.053070e+02,   1.042043e+02,   1.022649e+02,   9.947507e+01,\r\n         9.582399e+01,   9.130299e+01,   8.590485e+01,   7.962347e+01,...\r\n y: array([  1.020000e+02,   1.038411e+02,   1.050863e+02,   1.055917e+02,\r\n         1.053070e+02,   1.042043e+02,   1.022649e+02,   9.947507e+01,\r\n         9.582399e+01,   9.130299e+01,   8.590485e+01,   7.962347e+01,...\r\n\r\n----------------------------------------------------------------------\r\n\r\nRan 9 tests in 4.704s\r\n\r\nFAILED (failures=1)\r\nnot close where =  (array([19]),)\r\nnot close lhs =  [-2.9473114]\r\nnot close rhs =  [-2.94730377]\r\nnot close dif =  [  7.62939453e-06]\r\nnot close tol =  [  3.94730387e-06]\r\ndtype = float32, shape = (100,)\r\n```"}