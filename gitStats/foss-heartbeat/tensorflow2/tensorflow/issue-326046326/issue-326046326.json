{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19526", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19526/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19526/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19526/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19526", "id": 326046326, "node_id": "MDU6SXNzdWUzMjYwNDYzMjY=", "number": 19526, "title": "Node 'output/softmax' does not exist in model 'file:///android_asset/OptimizedGraph.pb'", "user": {"login": "bibhu107", "id": 23478853, "node_id": "MDQ6VXNlcjIzNDc4ODUz", "avatar_url": "https://avatars0.githubusercontent.com/u/23478853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bibhu107", "html_url": "https://github.com/bibhu107", "followers_url": "https://api.github.com/users/bibhu107/followers", "following_url": "https://api.github.com/users/bibhu107/following{/other_user}", "gists_url": "https://api.github.com/users/bibhu107/gists{/gist_id}", "starred_url": "https://api.github.com/users/bibhu107/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bibhu107/subscriptions", "organizations_url": "https://api.github.com/users/bibhu107/orgs", "repos_url": "https://api.github.com/users/bibhu107/repos", "events_url": "https://api.github.com/users/bibhu107/events{/privacy}", "received_events_url": "https://api.github.com/users/bibhu107/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-05-24T09:51:45Z", "updated_at": "2018-06-14T04:50:37Z", "closed_at": "2018-06-11T05:19:51Z", "author_association": "NONE", "body_html": "<p>I trained my model then frozen the graph using the .ckpt file and .pbtxt file<br>\n<strong>Code to freeze:</strong></p>\n<pre><code>freeze_graph.freeze_graph('./tensorflowModel.pbtxt', \"\",False,'./tfmodel.ckpt', \"output/predictions\", \"save/restore_all\",  \"save/Const:0\",'frozen.pb', True,\"\")\n</code></pre>\n<p>Then to <strong>optimize for inference</strong> followed the  below code:</p>\n<pre><code>inputGraph = tf.GraphDef()\nwith tf.gfile.Open(\"frozen.pb\", \"rb\") as f:\n    data2read = f.read()\n    inputGraph.ParseFromString(data2read)\n\noutputGraph = optimize_for_inference_lib.optimize_for_inference(\n                inputGraph,\n                [\"inputTensor\"], # an array of the input node(s)\n                [\"output/predictions\"], # an array of output nodes\n                tf.int32.as_datatype_enum)\n\n        # Save the optimized graph\n\nf = tf.gfile.FastGFile(\"OptimizedGraph.pb\", \"w\")\nf.write(outputGraph.SerializeToString())  \n</code></pre>\n<p>The output file <strong>\"OptimizedGraph.pb\",</strong> When I try to use it in the android studio it produces the error:</p>\n<pre><code> Node 'output/softmax' does not exist in model 'file:///android_asset/OptimizedGraph.pb'\n</code></pre>\n<p>I checked my .pbtxt file which I used to freeze my graph and there was no node <strong>output/softmax</strong>!</p>\n<p>What should I do?</p>", "body_text": "I trained my model then frozen the graph using the .ckpt file and .pbtxt file\nCode to freeze:\nfreeze_graph.freeze_graph('./tensorflowModel.pbtxt', \"\",False,'./tfmodel.ckpt', \"output/predictions\", \"save/restore_all\",  \"save/Const:0\",'frozen.pb', True,\"\")\n\nThen to optimize for inference followed the  below code:\ninputGraph = tf.GraphDef()\nwith tf.gfile.Open(\"frozen.pb\", \"rb\") as f:\n    data2read = f.read()\n    inputGraph.ParseFromString(data2read)\n\noutputGraph = optimize_for_inference_lib.optimize_for_inference(\n                inputGraph,\n                [\"inputTensor\"], # an array of the input node(s)\n                [\"output/predictions\"], # an array of output nodes\n                tf.int32.as_datatype_enum)\n\n        # Save the optimized graph\n\nf = tf.gfile.FastGFile(\"OptimizedGraph.pb\", \"w\")\nf.write(outputGraph.SerializeToString())  \n\nThe output file \"OptimizedGraph.pb\", When I try to use it in the android studio it produces the error:\n Node 'output/softmax' does not exist in model 'file:///android_asset/OptimizedGraph.pb'\n\nI checked my .pbtxt file which I used to freeze my graph and there was no node output/softmax!\nWhat should I do?", "body": "I trained my model then frozen the graph using the .ckpt file and .pbtxt file  \r\n**Code to freeze:**\r\n \r\n\r\n    freeze_graph.freeze_graph('./tensorflowModel.pbtxt', \"\",False,'./tfmodel.ckpt', \"output/predictions\", \"save/restore_all\",  \"save/Const:0\",'frozen.pb', True,\"\")\r\n\r\nThen to **optimize for inference** followed the  below code:\r\n\r\n    inputGraph = tf.GraphDef()\r\n    with tf.gfile.Open(\"frozen.pb\", \"rb\") as f:\r\n        data2read = f.read()\r\n        inputGraph.ParseFromString(data2read)\r\n    \r\n    outputGraph = optimize_for_inference_lib.optimize_for_inference(\r\n                    inputGraph,\r\n                    [\"inputTensor\"], # an array of the input node(s)\r\n                    [\"output/predictions\"], # an array of output nodes\r\n                    tf.int32.as_datatype_enum)\r\n    \r\n            # Save the optimized graph\r\n    \r\n    f = tf.gfile.FastGFile(\"OptimizedGraph.pb\", \"w\")\r\n    f.write(outputGraph.SerializeToString())  \r\n\r\n \r\n\r\nThe output file **\"OptimizedGraph.pb\",** When I try to use it in the android studio it produces the error:\r\n\r\n     Node 'output/softmax' does not exist in model 'file:///android_asset/OptimizedGraph.pb'\r\n\r\n\r\nI checked my .pbtxt file which I used to freeze my graph and there was no node **output/softmax**!\r\n\r\nWhat should I do?\r\n"}