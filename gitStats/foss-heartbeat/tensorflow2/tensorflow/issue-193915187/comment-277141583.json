{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/277141583", "html_url": "https://github.com/tensorflow/tensorflow/issues/6132#issuecomment-277141583", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6132", "id": 277141583, "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzE0MTU4Mw==", "user": {"login": "vvpreetham", "id": 16869974, "node_id": "MDQ6VXNlcjE2ODY5OTc0", "avatar_url": "https://avatars2.githubusercontent.com/u/16869974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vvpreetham", "html_url": "https://github.com/vvpreetham", "followers_url": "https://api.github.com/users/vvpreetham/followers", "following_url": "https://api.github.com/users/vvpreetham/following{/other_user}", "gists_url": "https://api.github.com/users/vvpreetham/gists{/gist_id}", "starred_url": "https://api.github.com/users/vvpreetham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vvpreetham/subscriptions", "organizations_url": "https://api.github.com/users/vvpreetham/orgs", "repos_url": "https://api.github.com/users/vvpreetham/repos", "events_url": "https://api.github.com/users/vvpreetham/events{/privacy}", "received_events_url": "https://api.github.com/users/vvpreetham/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-03T01:42:43Z", "updated_at": "2017-02-03T01:43:36Z", "author_association": "NONE", "body_html": "<p>I am still getting the error. I am super certain that soft placement is enabled as I have dry run the code with log.info and also breakpoints. I also add the gpu_fraction and soft placement directly in the session (The GPU memory fraction works, and soft placement works as I have stated for constants). My modified code for session is as follows:</p>\n<pre><code>def get_session(gpu_fraction=DEFAULT_GPU_FRACTION):\n    num_threads = os.environ.get('OMP_NUM_THREADS')\n    gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=gpu_fraction)\n    if num_threads:\n        return tf.Session(config=tf.ConfigProto(\n                    allow_soft_placement=True,\n                    log_device_placement=True,\n                    gpu_options=gpu_options, \n                    intra_op_parallelism_threads=num_threads))\n    else:\n        return tf.Session(config=tf.ConfigProto(allow_soft_placement=True,\n                                                log_device_placement=True,\n                                                gpu_options=gpu_options))\n</code></pre>\n<p>I setup the session as follows:</p>\n<pre><code>def main(_):\n    with get_session() as sess:\n        m, df_test = wide_batch_train()\n</code></pre>\n<p>The problem seems to be the tf.SparseTensor</p>", "body_text": "I am still getting the error. I am super certain that soft placement is enabled as I have dry run the code with log.info and also breakpoints. I also add the gpu_fraction and soft placement directly in the session (The GPU memory fraction works, and soft placement works as I have stated for constants). My modified code for session is as follows:\ndef get_session(gpu_fraction=DEFAULT_GPU_FRACTION):\n    num_threads = os.environ.get('OMP_NUM_THREADS')\n    gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=gpu_fraction)\n    if num_threads:\n        return tf.Session(config=tf.ConfigProto(\n                    allow_soft_placement=True,\n                    log_device_placement=True,\n                    gpu_options=gpu_options, \n                    intra_op_parallelism_threads=num_threads))\n    else:\n        return tf.Session(config=tf.ConfigProto(allow_soft_placement=True,\n                                                log_device_placement=True,\n                                                gpu_options=gpu_options))\n\nI setup the session as follows:\ndef main(_):\n    with get_session() as sess:\n        m, df_test = wide_batch_train()\n\nThe problem seems to be the tf.SparseTensor", "body": "I am still getting the error. I am super certain that soft placement is enabled as I have dry run the code with log.info and also breakpoints. I also add the gpu_fraction and soft placement directly in the session (The GPU memory fraction works, and soft placement works as I have stated for constants). My modified code for session is as follows:\r\n\r\n```\r\ndef get_session(gpu_fraction=DEFAULT_GPU_FRACTION):\r\n    num_threads = os.environ.get('OMP_NUM_THREADS')\r\n    gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=gpu_fraction)\r\n    if num_threads:\r\n        return tf.Session(config=tf.ConfigProto(\r\n                    allow_soft_placement=True,\r\n                    log_device_placement=True,\r\n                    gpu_options=gpu_options, \r\n                    intra_op_parallelism_threads=num_threads))\r\n    else:\r\n        return tf.Session(config=tf.ConfigProto(allow_soft_placement=True,\r\n                                                log_device_placement=True,\r\n                                                gpu_options=gpu_options))\r\n```\r\n\r\nI setup the session as follows:\r\n\r\n```\r\ndef main(_):\r\n    with get_session() as sess:\r\n        m, df_test = wide_batch_train()\r\n```\r\n\r\nThe problem seems to be the tf.SparseTensor"}