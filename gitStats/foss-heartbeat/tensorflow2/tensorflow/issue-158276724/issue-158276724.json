{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2629", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2629/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2629/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2629/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2629", "id": 158276724, "node_id": "MDU6SXNzdWUxNTgyNzY3MjQ=", "number": 2629, "title": "Tensorflow distributed master worker saves unexpected: not raise exception and return the store checkpoint filepath,but check point file is not exist", "user": {"login": "u4lr451", "id": 18026245, "node_id": "MDQ6VXNlcjE4MDI2MjQ1", "avatar_url": "https://avatars0.githubusercontent.com/u/18026245?v=4", "gravatar_id": "", "url": "https://api.github.com/users/u4lr451", "html_url": "https://github.com/u4lr451", "followers_url": "https://api.github.com/users/u4lr451/followers", "following_url": "https://api.github.com/users/u4lr451/following{/other_user}", "gists_url": "https://api.github.com/users/u4lr451/gists{/gist_id}", "starred_url": "https://api.github.com/users/u4lr451/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/u4lr451/subscriptions", "organizations_url": "https://api.github.com/users/u4lr451/orgs", "repos_url": "https://api.github.com/users/u4lr451/repos", "events_url": "https://api.github.com/users/u4lr451/events{/privacy}", "received_events_url": "https://api.github.com/users/u4lr451/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-06-03T02:02:34Z", "updated_at": "2016-06-03T15:51:30Z", "closed_at": "2016-06-03T15:51:30Z", "author_association": "NONE", "body_html": "<p>**In distribution tensorflow  environment. the master worker saves checkpoint  fail.<br></p>\n<h2>saver.save  has return ok_<strong>(not raise exception and return the expected checkpoint file path) *_<em>but, the return checkpoint file is not exist</em></strong>.<br></h2>\n<p>this is different from the description of the tensorflow api<br></p>\n<p>=============<br><br>\n<strong>the related code is below:</strong></p>\n<pre><code> def def_ps(self):\n    self.saver = tf.train.Saver(max_to_keep=100,keep_checkpoint_every_n_hours=3)\n\ndef save(self,idx):    \n    ret = self.saver.save(self.sess,self.save_model_path,global_step=None,write_meta_graph=False)\n    if not os.path.exists(ret):\n        msg = \"save model for %u path %s not exists.\"%(idx,ret)\n        lg.error(msg)\n        raise Exception(msg);\n</code></pre>\n<p>=============<br><br>\n<strong>the log is below</strong>:</p>\n<p>2016-06-02 21:33:52,323 root         ERROR    save model for 2 path model_path/rl_model_2 not exists.<br>\n2016-06-02 21:33:52,323 root         ERROR    has error:save model for 2 path model_path/rl_model_2 not exists.<br>\nTraceback (most recent call last):<br>\nFile \"d_rl_main_model_dist_0.py\", line 755, in run_worker<br>\nmodel_a.save(next_model_idx)<br>\nFile \"d_rl_main_model_dist_0.py\", line 360, in save<br>\nTrainer.save(self,save_idx)<br>\nFile \"d_rl_main_model_dist_0.py\", line 289, in save<br>\nraise Exception(msg);<br>\nException: save model for 2 path model_path/rl_model_2 not exists.</p>\n<p>===========<br><br>\n<strong>not meets the tensorflow api which define Saver.save as below:</strong></p>\n<p><a href=\"https://www.tensorflow.org/versions/master/api_docs/python/state_ops.html#Saver\" rel=\"nofollow\">https://www.tensorflow.org/versions/master/api_docs/python/state_ops.html#Saver</a></p>\n<p>tf.train.Saver.save(sess, save_path, global_step=None, latest_filename=None, meta_graph_suffix='meta', write_meta_graph=True)</p>\n<p>Returns:</p>\n<p>A string: path at which the variables were saved. If the saver is sharded, this string ends with: '-?????-of-nnnnn' where 'nnnnn' is the number of shards created.</p>\n<p>Raises:</p>\n<p>TypeError: If sess is not a Session.<br>\nValueError: If latest_filename contains path components.</p>", "body_text": "**In distribution tensorflow  environment. the master worker saves checkpoint  fail.\nsaver.save  has return ok_(not raise exception and return the expected checkpoint file path) *_but, the return checkpoint file is not exist.\nthis is different from the description of the tensorflow api\n=============\nthe related code is below:\n def def_ps(self):\n    self.saver = tf.train.Saver(max_to_keep=100,keep_checkpoint_every_n_hours=3)\n\ndef save(self,idx):    \n    ret = self.saver.save(self.sess,self.save_model_path,global_step=None,write_meta_graph=False)\n    if not os.path.exists(ret):\n        msg = \"save model for %u path %s not exists.\"%(idx,ret)\n        lg.error(msg)\n        raise Exception(msg);\n\n=============\nthe log is below:\n2016-06-02 21:33:52,323 root         ERROR    save model for 2 path model_path/rl_model_2 not exists.\n2016-06-02 21:33:52,323 root         ERROR    has error:save model for 2 path model_path/rl_model_2 not exists.\nTraceback (most recent call last):\nFile \"d_rl_main_model_dist_0.py\", line 755, in run_worker\nmodel_a.save(next_model_idx)\nFile \"d_rl_main_model_dist_0.py\", line 360, in save\nTrainer.save(self,save_idx)\nFile \"d_rl_main_model_dist_0.py\", line 289, in save\nraise Exception(msg);\nException: save model for 2 path model_path/rl_model_2 not exists.\n===========\nnot meets the tensorflow api which define Saver.save as below:\nhttps://www.tensorflow.org/versions/master/api_docs/python/state_ops.html#Saver\ntf.train.Saver.save(sess, save_path, global_step=None, latest_filename=None, meta_graph_suffix='meta', write_meta_graph=True)\nReturns:\nA string: path at which the variables were saved. If the saver is sharded, this string ends with: '-?????-of-nnnnn' where 'nnnnn' is the number of shards created.\nRaises:\nTypeError: If sess is not a Session.\nValueError: If latest_filename contains path components.", "body": "**In distribution tensorflow  environment. the master worker saves checkpoint  fail.<br>\n## saver.save  has return ok_**(not raise exception and return the expected checkpoint file path) *__but, the return checkpoint file is not exist_**.<br>\n\nthis is different from the description of the tensorflow api<br>\n\n=============<br>\n**the related code is below:**\n\n```\n def def_ps(self):\n    self.saver = tf.train.Saver(max_to_keep=100,keep_checkpoint_every_n_hours=3)\n\ndef save(self,idx):    \n    ret = self.saver.save(self.sess,self.save_model_path,global_step=None,write_meta_graph=False)\n    if not os.path.exists(ret):\n        msg = \"save model for %u path %s not exists.\"%(idx,ret)\n        lg.error(msg)\n        raise Exception(msg);\n```\n\n=============<br>\n**the log is below**:\n\n 2016-06-02 21:33:52,323 root         ERROR    save model for 2 path model_path/rl_model_2 not exists.\n2016-06-02 21:33:52,323 root         ERROR    has error:save model for 2 path model_path/rl_model_2 not exists.\nTraceback (most recent call last):\n  File \"d_rl_main_model_dist_0.py\", line 755, in run_worker\n    model_a.save(next_model_idx)\n  File \"d_rl_main_model_dist_0.py\", line 360, in save\n    Trainer.save(self,save_idx)\n  File \"d_rl_main_model_dist_0.py\", line 289, in save\n    raise Exception(msg);\nException: save model for 2 path model_path/rl_model_2 not exists.\n\n===========<br>\n**not meets the tensorflow api which define Saver.save as below:**\n\nhttps://www.tensorflow.org/versions/master/api_docs/python/state_ops.html#Saver\n\ntf.train.Saver.save(sess, save_path, global_step=None, latest_filename=None, meta_graph_suffix='meta', write_meta_graph=True)\n\nReturns:\n\nA string: path at which the variables were saved. If the saver is sharded, this string ends with: '-?????-of-nnnnn' where 'nnnnn' is the number of shards created.\n\nRaises:\n\nTypeError: If sess is not a Session.\nValueError: If latest_filename contains path components.\n"}