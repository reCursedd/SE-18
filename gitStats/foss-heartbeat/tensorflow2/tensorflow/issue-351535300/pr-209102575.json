{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21677", "id": 209102575, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA5MTAyNTc1", "html_url": "https://github.com/tensorflow/tensorflow/pull/21677", "diff_url": "https://github.com/tensorflow/tensorflow/pull/21677.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/21677.patch", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21677", "number": 21677, "state": "open", "locked": false, "title": "Fix embedding_ops_test on AVX512 builds", "user": {"login": "markdryan", "id": 984073, "node_id": "MDQ6VXNlcjk4NDA3Mw==", "avatar_url": "https://avatars3.githubusercontent.com/u/984073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markdryan", "html_url": "https://github.com/markdryan", "followers_url": "https://api.github.com/users/markdryan/followers", "following_url": "https://api.github.com/users/markdryan/following{/other_user}", "gists_url": "https://api.github.com/users/markdryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/markdryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markdryan/subscriptions", "organizations_url": "https://api.github.com/users/markdryan/orgs", "repos_url": "https://api.github.com/users/markdryan/repos", "events_url": "https://api.github.com/users/markdryan/events{/privacy}", "received_events_url": "https://api.github.com/users/markdryan/received_events", "type": "User", "site_admin": false}, "body": "This commit modifies the embedding_ops_test unit test so that it\r\npasses on AVX512 builds.  The test compares the result of an embedding\r\noperation to a precomputed expected result, both of which are computed\r\nusing square roots.  The test appears to fail on AVX512 builds as the\r\nembedding operation makes use of Eigen's fast vectorized square root\r\nalgorithm for doubles, which can return slightly different results to\r\nthose computed using numpy.  As the test expects both results to be\r\nidentical it fails on AVX512 builds, even though the difference\r\nbetween the results is insignificant.  This commit fixes the issue by\r\nmodifying the equality tests to use assertAllClose instead of\r\nassertAllEqual.  Note that the test passes in its current form on AVX2\r\nbuilds as Eigen does not yet implement an AVX2 version of the fast\r\nsquare root algorithm for doubles.\r\n\r\nFixes: https://github.com/tensorflow/tensorflow/issues/21676\r\n\r\nSigned-off-by: Mark Ryan <mark.d.ryan@intel.com>", "created_at": "2018-08-17T10:06:43Z", "updated_at": "2018-11-22T06:42:29Z", "closed_at": null, "merged_at": null, "merge_commit_sha": "a46cb5bb563eeb83294be27fe12b5fb7c7565cfe", "assignee": {"login": "protoget", "id": 5117188, "node_id": "MDQ6VXNlcjUxMTcxODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5117188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/protoget", "html_url": "https://github.com/protoget", "followers_url": "https://api.github.com/users/protoget/followers", "following_url": "https://api.github.com/users/protoget/following{/other_user}", "gists_url": "https://api.github.com/users/protoget/gists{/gist_id}", "starred_url": "https://api.github.com/users/protoget/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/protoget/subscriptions", "organizations_url": "https://api.github.com/users/protoget/orgs", "repos_url": "https://api.github.com/users/protoget/repos", "events_url": "https://api.github.com/users/protoget/events{/privacy}", "received_events_url": "https://api.github.com/users/protoget/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "protoget", "id": 5117188, "node_id": "MDQ6VXNlcjUxMTcxODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5117188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/protoget", "html_url": "https://github.com/protoget", "followers_url": "https://api.github.com/users/protoget/followers", "following_url": "https://api.github.com/users/protoget/following{/other_user}", "gists_url": "https://api.github.com/users/protoget/gists{/gist_id}", "starred_url": "https://api.github.com/users/protoget/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/protoget/subscriptions", "organizations_url": "https://api.github.com/users/protoget/orgs", "repos_url": "https://api.github.com/users/protoget/repos", "events_url": "https://api.github.com/users/protoget/events{/privacy}", "received_events_url": "https://api.github.com/users/protoget/received_events", "type": "User", "site_admin": false}], "requested_reviewers": [], "requested_teams": [], "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "milestone": null, "commits_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21677/commits", "review_comments_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21677/comments", "review_comment_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21677/comments", "statuses_url": "https://api.github.com/repos/tensorflow/tensorflow/statuses/cb73f96401b9f63742e041f6cdc65bda667a7daf", "head": {"label": "markdryan:markdryan-avx512-fix-embedding_ops_test", "ref": "markdryan-avx512-fix-embedding_ops_test", "sha": "cb73f96401b9f63742e041f6cdc65bda667a7daf", "user": {"login": "markdryan", "id": 984073, "node_id": "MDQ6VXNlcjk4NDA3Mw==", "avatar_url": "https://avatars3.githubusercontent.com/u/984073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markdryan", "html_url": "https://github.com/markdryan", "followers_url": "https://api.github.com/users/markdryan/followers", "following_url": "https://api.github.com/users/markdryan/following{/other_user}", "gists_url": "https://api.github.com/users/markdryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/markdryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markdryan/subscriptions", "organizations_url": "https://api.github.com/users/markdryan/orgs", "repos_url": "https://api.github.com/users/markdryan/repos", "events_url": "https://api.github.com/users/markdryan/events{/privacy}", "received_events_url": "https://api.github.com/users/markdryan/received_events", "type": "User", "site_admin": false}, "repo": {"id": 132156653, "node_id": "MDEwOlJlcG9zaXRvcnkxMzIxNTY2NTM=", "name": "tensorflow", "full_name": "markdryan/tensorflow", "private": false, "owner": {"login": "markdryan", "id": 984073, "node_id": "MDQ6VXNlcjk4NDA3Mw==", "avatar_url": "https://avatars3.githubusercontent.com/u/984073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markdryan", "html_url": "https://github.com/markdryan", "followers_url": "https://api.github.com/users/markdryan/followers", "following_url": "https://api.github.com/users/markdryan/following{/other_user}", "gists_url": "https://api.github.com/users/markdryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/markdryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markdryan/subscriptions", "organizations_url": "https://api.github.com/users/markdryan/orgs", "repos_url": "https://api.github.com/users/markdryan/repos", "events_url": "https://api.github.com/users/markdryan/events{/privacy}", "received_events_url": "https://api.github.com/users/markdryan/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/markdryan/tensorflow", "description": "Computation using data flow graphs for scalable machine learning", "fork": true, "url": "https://api.github.com/repos/markdryan/tensorflow", "forks_url": "https://api.github.com/repos/markdryan/tensorflow/forks", "keys_url": "https://api.github.com/repos/markdryan/tensorflow/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/markdryan/tensorflow/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/markdryan/tensorflow/teams", "hooks_url": "https://api.github.com/repos/markdryan/tensorflow/hooks", "issue_events_url": "https://api.github.com/repos/markdryan/tensorflow/issues/events{/number}", "events_url": "https://api.github.com/repos/markdryan/tensorflow/events", "assignees_url": "https://api.github.com/repos/markdryan/tensorflow/assignees{/user}", "branches_url": "https://api.github.com/repos/markdryan/tensorflow/branches{/branch}", "tags_url": "https://api.github.com/repos/markdryan/tensorflow/tags", "blobs_url": "https://api.github.com/repos/markdryan/tensorflow/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/markdryan/tensorflow/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/markdryan/tensorflow/git/refs{/sha}", "trees_url": "https://api.github.com/repos/markdryan/tensorflow/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/markdryan/tensorflow/statuses/{sha}", "languages_url": "https://api.github.com/repos/markdryan/tensorflow/languages", "stargazers_url": "https://api.github.com/repos/markdryan/tensorflow/stargazers", "contributors_url": "https://api.github.com/repos/markdryan/tensorflow/contributors", "subscribers_url": "https://api.github.com/repos/markdryan/tensorflow/subscribers", "subscription_url": "https://api.github.com/repos/markdryan/tensorflow/subscription", "commits_url": "https://api.github.com/repos/markdryan/tensorflow/commits{/sha}", "git_commits_url": "https://api.github.com/repos/markdryan/tensorflow/git/commits{/sha}", "comments_url": "https://api.github.com/repos/markdryan/tensorflow/comments{/number}", "issue_comment_url": "https://api.github.com/repos/markdryan/tensorflow/issues/comments{/number}", "contents_url": "https://api.github.com/repos/markdryan/tensorflow/contents/{+path}", "compare_url": "https://api.github.com/repos/markdryan/tensorflow/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/markdryan/tensorflow/merges", "archive_url": "https://api.github.com/repos/markdryan/tensorflow/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/markdryan/tensorflow/downloads", "issues_url": "https://api.github.com/repos/markdryan/tensorflow/issues{/number}", "pulls_url": "https://api.github.com/repos/markdryan/tensorflow/pulls{/number}", "milestones_url": "https://api.github.com/repos/markdryan/tensorflow/milestones{/number}", "notifications_url": "https://api.github.com/repos/markdryan/tensorflow/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/markdryan/tensorflow/labels{/name}", "releases_url": "https://api.github.com/repos/markdryan/tensorflow/releases{/id}", "deployments_url": "https://api.github.com/repos/markdryan/tensorflow/deployments", "created_at": "2018-05-04T15:19:25Z", "updated_at": "2018-06-27T12:13:27Z", "pushed_at": "2018-10-30T09:34:55Z", "git_url": "git://github.com/markdryan/tensorflow.git", "ssh_url": "git@github.com:markdryan/tensorflow.git", "clone_url": "https://github.com/markdryan/tensorflow.git", "svn_url": "https://github.com/markdryan/tensorflow", "homepage": "https://tensorflow.org", "size": 271540, "stargazers_count": 0, "watchers_count": 0, "language": "C++", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "forks_count": 0, "mirror_url": null, "archived": false, "open_issues_count": 0, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "tensorflow:master", "ref": "master", "sha": "0340ef97561b035155741cedc5c5aa8c3debc42a", "user": {"login": "tensorflow", "id": 15658638, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE1NjU4NjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15658638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tensorflow", "html_url": "https://github.com/tensorflow", "followers_url": "https://api.github.com/users/tensorflow/followers", "following_url": "https://api.github.com/users/tensorflow/following{/other_user}", "gists_url": "https://api.github.com/users/tensorflow/gists{/gist_id}", "starred_url": "https://api.github.com/users/tensorflow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tensorflow/subscriptions", "organizations_url": "https://api.github.com/users/tensorflow/orgs", "repos_url": "https://api.github.com/users/tensorflow/repos", "events_url": "https://api.github.com/users/tensorflow/events{/privacy}", "received_events_url": "https://api.github.com/users/tensorflow/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 45717250, "node_id": "MDEwOlJlcG9zaXRvcnk0NTcxNzI1MA==", "name": "tensorflow", "full_name": "tensorflow/tensorflow", "private": false, "owner": {"login": "tensorflow", "id": 15658638, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE1NjU4NjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15658638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tensorflow", "html_url": "https://github.com/tensorflow", "followers_url": "https://api.github.com/users/tensorflow/followers", "following_url": "https://api.github.com/users/tensorflow/following{/other_user}", "gists_url": "https://api.github.com/users/tensorflow/gists{/gist_id}", "starred_url": "https://api.github.com/users/tensorflow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tensorflow/subscriptions", "organizations_url": "https://api.github.com/users/tensorflow/orgs", "repos_url": "https://api.github.com/users/tensorflow/repos", "events_url": "https://api.github.com/users/tensorflow/events{/privacy}", "received_events_url": "https://api.github.com/users/tensorflow/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/tensorflow/tensorflow", "description": "An Open Source Machine Learning Framework for Everyone", "fork": false, "url": "https://api.github.com/repos/tensorflow/tensorflow", "forks_url": "https://api.github.com/repos/tensorflow/tensorflow/forks", "keys_url": "https://api.github.com/repos/tensorflow/tensorflow/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/tensorflow/tensorflow/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/tensorflow/tensorflow/teams", "hooks_url": "https://api.github.com/repos/tensorflow/tensorflow/hooks", "issue_events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/events{/number}", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/events", "assignees_url": "https://api.github.com/repos/tensorflow/tensorflow/assignees{/user}", "branches_url": "https://api.github.com/repos/tensorflow/tensorflow/branches{/branch}", "tags_url": "https://api.github.com/repos/tensorflow/tensorflow/tags", "blobs_url": "https://api.github.com/repos/tensorflow/tensorflow/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/tensorflow/tensorflow/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/tensorflow/tensorflow/git/refs{/sha}", "trees_url": "https://api.github.com/repos/tensorflow/tensorflow/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/tensorflow/tensorflow/statuses/{sha}", "languages_url": "https://api.github.com/repos/tensorflow/tensorflow/languages", "stargazers_url": "https://api.github.com/repos/tensorflow/tensorflow/stargazers", "contributors_url": "https://api.github.com/repos/tensorflow/tensorflow/contributors", "subscribers_url": "https://api.github.com/repos/tensorflow/tensorflow/subscribers", "subscription_url": "https://api.github.com/repos/tensorflow/tensorflow/subscription", "commits_url": "https://api.github.com/repos/tensorflow/tensorflow/commits{/sha}", "git_commits_url": "https://api.github.com/repos/tensorflow/tensorflow/git/commits{/sha}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/comments{/number}", "issue_comment_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments{/number}", "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/{+path}", "compare_url": "https://api.github.com/repos/tensorflow/tensorflow/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/tensorflow/tensorflow/merges", "archive_url": "https://api.github.com/repos/tensorflow/tensorflow/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/tensorflow/tensorflow/downloads", "issues_url": "https://api.github.com/repos/tensorflow/tensorflow/issues{/number}", "pulls_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls{/number}", "milestones_url": "https://api.github.com/repos/tensorflow/tensorflow/milestones{/number}", "notifications_url": "https://api.github.com/repos/tensorflow/tensorflow/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/labels{/name}", "releases_url": "https://api.github.com/repos/tensorflow/tensorflow/releases{/id}", "deployments_url": "https://api.github.com/repos/tensorflow/tensorflow/deployments", "created_at": "2015-11-07T01:19:20Z", "updated_at": "2018-11-24T19:13:45Z", "pushed_at": "2018-11-24T18:40:19Z", "git_url": "git://github.com/tensorflow/tensorflow.git", "ssh_url": "git@github.com:tensorflow/tensorflow.git", "clone_url": "https://github.com/tensorflow/tensorflow.git", "svn_url": "https://github.com/tensorflow/tensorflow", "homepage": "https://tensorflow.org", "size": 284546, "stargazers_count": 115174, "watchers_count": 115174, "language": "C++", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "forks_count": 69944, "mirror_url": null, "archived": false, "open_issues_count": 1759, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "forks": 69944, "open_issues": 1759, "watchers": 115174, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21677"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/21677"}, "issue": {"href": "https://api.github.com/repos/tensorflow/tensorflow/issues/21677"}, "comments": {"href": "https://api.github.com/repos/tensorflow/tensorflow/issues/21677/comments"}, "review_comments": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21677/comments"}, "review_comment": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21677/commits"}, "statuses": {"href": "https://api.github.com/repos/tensorflow/tensorflow/statuses/cb73f96401b9f63742e041f6cdc65bda667a7daf"}}, "author_association": "CONTRIBUTOR", "body_html": "<p>This commit modifies the embedding_ops_test unit test so that it<br>\npasses on AVX512 builds.  The test compares the result of an embedding<br>\noperation to a precomputed expected result, both of which are computed<br>\nusing square roots.  The test appears to fail on AVX512 builds as the<br>\nembedding operation makes use of Eigen's fast vectorized square root<br>\nalgorithm for doubles, which can return slightly different results to<br>\nthose computed using numpy.  As the test expects both results to be<br>\nidentical it fails on AVX512 builds, even though the difference<br>\nbetween the results is insignificant.  This commit fixes the issue by<br>\nmodifying the equality tests to use assertAllClose instead of<br>\nassertAllEqual.  Note that the test passes in its current form on AVX2<br>\nbuilds as Eigen does not yet implement an AVX2 version of the fast<br>\nsquare root algorithm for doubles.</p>\n<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #21676.\">Fixes</span>: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"351532696\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/21676\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/21676/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/21676\">#21676</a></p>\n<p>Signed-off-by: Mark Ryan <a href=\"mailto:mark.d.ryan@intel.com\">mark.d.ryan@intel.com</a></p>", "body_text": "This commit modifies the embedding_ops_test unit test so that it\npasses on AVX512 builds.  The test compares the result of an embedding\noperation to a precomputed expected result, both of which are computed\nusing square roots.  The test appears to fail on AVX512 builds as the\nembedding operation makes use of Eigen's fast vectorized square root\nalgorithm for doubles, which can return slightly different results to\nthose computed using numpy.  As the test expects both results to be\nidentical it fails on AVX512 builds, even though the difference\nbetween the results is insignificant.  This commit fixes the issue by\nmodifying the equality tests to use assertAllClose instead of\nassertAllEqual.  Note that the test passes in its current form on AVX2\nbuilds as Eigen does not yet implement an AVX2 version of the fast\nsquare root algorithm for doubles.\nFixes: #21676\nSigned-off-by: Mark Ryan mark.d.ryan@intel.com", "merged": false, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": null, "comments": 4, "review_comments": 5, "maintainer_can_modify": true, "commits": 1, "additions": 14, "deletions": 2, "changed_files": 1}