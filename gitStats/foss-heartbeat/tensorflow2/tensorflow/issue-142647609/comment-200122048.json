{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/200122048", "html_url": "https://github.com/tensorflow/tensorflow/issues/1578#issuecomment-200122048", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1578", "id": 200122048, "node_id": "MDEyOklzc3VlQ29tbWVudDIwMDEyMjA0OA==", "user": {"login": "shawnLeeZX", "id": 2428233, "node_id": "MDQ6VXNlcjI0MjgyMzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2428233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shawnLeeZX", "html_url": "https://github.com/shawnLeeZX", "followers_url": "https://api.github.com/users/shawnLeeZX/followers", "following_url": "https://api.github.com/users/shawnLeeZX/following{/other_user}", "gists_url": "https://api.github.com/users/shawnLeeZX/gists{/gist_id}", "starred_url": "https://api.github.com/users/shawnLeeZX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shawnLeeZX/subscriptions", "organizations_url": "https://api.github.com/users/shawnLeeZX/orgs", "repos_url": "https://api.github.com/users/shawnLeeZX/repos", "events_url": "https://api.github.com/users/shawnLeeZX/events{/privacy}", "received_events_url": "https://api.github.com/users/shawnLeeZX/received_events", "type": "User", "site_admin": false}, "created_at": "2016-03-23T01:51:12Z", "updated_at": "2016-03-23T01:51:12Z", "author_association": "NONE", "body_html": "<p>How could I delete a session object in python?</p>\n<p>I tried</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> time\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n<span class=\"pl-k\">for</span> i <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">0</span>,<span class=\"pl-c1\">10000000</span>):\n  t0 <span class=\"pl-k\">=</span> time.clock()\n\n  <span class=\"pl-k\">with</span> tf.Graph().as_default():\n    sess <span class=\"pl-k\">=</span> tf.Session()\n\n    a <span class=\"pl-k\">=</span> tf.placeholder(tf.int16, <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>a<span class=\"pl-pds\">'</span></span>)\n    y <span class=\"pl-k\">=</span> tf.identity(a, <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>y<span class=\"pl-pds\">'</span></span>)\n\n    sess.run(y, <span class=\"pl-v\">feed_dict</span><span class=\"pl-k\">=</span>{a: <span class=\"pl-c1\">3</span>})\n    sess.close()\n\n  <span class=\"pl-k\">del</span> sess\n\n  time.sleep(<span class=\"pl-c1\">20</span>)\n\n<span class=\"pl-c1\">print</span> time.clock() <span class=\"pl-k\">-</span> t0</pre></div>\n<p>But when the program is sleeping, it still occupies memory.</p>\n<p>Also, could you provide the line that configure session to use <code>allow_growth</code>?</p>\n<p>I tried</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> time\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n<span class=\"pl-k\">for</span> i <span class=\"pl-k\">in</span> <span class=\"pl-c1\">range</span>(<span class=\"pl-c1\">0</span>,<span class=\"pl-c1\">10000000</span>):\n  t0 <span class=\"pl-k\">=</span> time.clock()\n\n  <span class=\"pl-k\">with</span> tf.Graph().as_default():\n    sess <span class=\"pl-k\">=</span> tf.Session(<span class=\"pl-v\">config</span><span class=\"pl-k\">=</span>tf.GPUOptions(<span class=\"pl-v\">allow_growth</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>))\n\n    a <span class=\"pl-k\">=</span> tf.placeholder(tf.int16, <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>a<span class=\"pl-pds\">'</span></span>)\n    y <span class=\"pl-k\">=</span> tf.identity(a, <span class=\"pl-v\">name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>y<span class=\"pl-pds\">'</span></span>)\n\n    sess.run(y, <span class=\"pl-v\">feed_dict</span><span class=\"pl-k\">=</span>{a: <span class=\"pl-c1\">3</span>})\n    sess.close()\n\n  <span class=\"pl-k\">del</span> sess\n\n  time.sleep(<span class=\"pl-c1\">20</span>)\n\n<span class=\"pl-c1\">print</span> time.clock() <span class=\"pl-k\">-</span> t0</pre></div>\n<p>and got this error report</p>\n<div class=\"highlight highlight-source-shell\"><pre>TypeError: Expected config_pb2.ConfigProto, but got <span class=\"pl-k\">&lt;</span>class <span class=\"pl-s\"><span class=\"pl-pds\">'</span>tensorflow.core.protobuf.config_pb2.GPUOptions<span class=\"pl-pds\">'</span></span><span class=\"pl-k\">&gt;</span></pre></div>\n<p>Note that this time I used a tensorflow compiled from source, since the 0.7.1 release does not have <code>allow_growth</code> option yet.</p>", "body_text": "How could I delete a session object in python?\nI tried\nimport time\nimport tensorflow as tf\n\nfor i in range(0,10000000):\n  t0 = time.clock()\n\n  with tf.Graph().as_default():\n    sess = tf.Session()\n\n    a = tf.placeholder(tf.int16, name='a')\n    y = tf.identity(a, name='y')\n\n    sess.run(y, feed_dict={a: 3})\n    sess.close()\n\n  del sess\n\n  time.sleep(20)\n\nprint time.clock() - t0\nBut when the program is sleeping, it still occupies memory.\nAlso, could you provide the line that configure session to use allow_growth?\nI tried\nimport time\nimport tensorflow as tf\n\nfor i in range(0,10000000):\n  t0 = time.clock()\n\n  with tf.Graph().as_default():\n    sess = tf.Session(config=tf.GPUOptions(allow_growth=True))\n\n    a = tf.placeholder(tf.int16, name='a')\n    y = tf.identity(a, name='y')\n\n    sess.run(y, feed_dict={a: 3})\n    sess.close()\n\n  del sess\n\n  time.sleep(20)\n\nprint time.clock() - t0\nand got this error report\nTypeError: Expected config_pb2.ConfigProto, but got <class 'tensorflow.core.protobuf.config_pb2.GPUOptions'>\nNote that this time I used a tensorflow compiled from source, since the 0.7.1 release does not have allow_growth option yet.", "body": "How could I delete a session object in python?\n\nI tried\n\n``` python\nimport time\nimport tensorflow as tf\n\nfor i in range(0,10000000):\n  t0 = time.clock()\n\n  with tf.Graph().as_default():\n    sess = tf.Session()\n\n    a = tf.placeholder(tf.int16, name='a')\n    y = tf.identity(a, name='y')\n\n    sess.run(y, feed_dict={a: 3})\n    sess.close()\n\n  del sess\n\n  time.sleep(20)\n\nprint time.clock() - t0\n```\n\nBut when the program is sleeping, it still occupies memory.\n\nAlso, could you provide the line that configure session to use `allow_growth`?\n\nI tried\n\n``` python\nimport time\nimport tensorflow as tf\n\nfor i in range(0,10000000):\n  t0 = time.clock()\n\n  with tf.Graph().as_default():\n    sess = tf.Session(config=tf.GPUOptions(allow_growth=True))\n\n    a = tf.placeholder(tf.int16, name='a')\n    y = tf.identity(a, name='y')\n\n    sess.run(y, feed_dict={a: 3})\n    sess.close()\n\n  del sess\n\n  time.sleep(20)\n\nprint time.clock() - t0\n```\n\nand got this error report\n\n``` bash\nTypeError: Expected config_pb2.ConfigProto, but got <class 'tensorflow.core.protobuf.config_pb2.GPUOptions'>\n```\n\nNote that this time I used a tensorflow compiled from source, since the 0.7.1 release does not have `allow_growth` option yet.\n"}