{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7394", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7394/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7394/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7394/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7394", "id": 206583742, "node_id": "MDU6SXNzdWUyMDY1ODM3NDI=", "number": 7394, "title": "Segfault when calling TF_OperationGetAttrTensor on malformed tensor", "user": {"login": "malmaud", "id": 987837, "node_id": "MDQ6VXNlcjk4NzgzNw==", "avatar_url": "https://avatars1.githubusercontent.com/u/987837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malmaud", "html_url": "https://github.com/malmaud", "followers_url": "https://api.github.com/users/malmaud/followers", "following_url": "https://api.github.com/users/malmaud/following{/other_user}", "gists_url": "https://api.github.com/users/malmaud/gists{/gist_id}", "starred_url": "https://api.github.com/users/malmaud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malmaud/subscriptions", "organizations_url": "https://api.github.com/users/malmaud/orgs", "repos_url": "https://api.github.com/users/malmaud/repos", "events_url": "https://api.github.com/users/malmaud/events{/privacy}", "received_events_url": "https://api.github.com/users/malmaud/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2017-02-09T18:04:40Z", "updated_at": "2018-02-12T20:28:58Z", "closed_at": "2018-02-12T20:28:58Z", "author_association": "CONTRIBUTOR", "body_html": "<p>On 1.0.0-rc1 (and earlier versions), this segfaults:</p>\n<div class=\"highlight highlight-source-c\"><pre><span class=\"pl-k\">void</span> <span class=\"pl-en\">dealloc</span>(<span class=\"pl-k\">void</span>* data, <span class=\"pl-c1\">size_t</span> len, <span class=\"pl-k\">void</span>* arg) {\n}\n\n<span class=\"pl-k\">int</span> <span class=\"pl-en\">main</span>() {\n  TF_Tensor* empty = <span class=\"pl-c1\">TF_NewTensor</span>(TF_FLOAT, <span class=\"pl-c1\">NULL</span>, <span class=\"pl-c1\">0</span>, <span class=\"pl-c1\">NULL</span>, <span class=\"pl-c1\">0</span>, dealloc, <span class=\"pl-c1\">NULL</span>);\n  TF_Graph* graph = <span class=\"pl-c1\">TF_NewGraph</span>();\n  TF_OperationDescription* desc = <span class=\"pl-c1\">TF_NewOperation</span>(graph, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Const<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>empty<span class=\"pl-pds\">\"</span></span>);\n  TF_Status* status = <span class=\"pl-c1\">TF_NewStatus</span>();\n  <span class=\"pl-c1\">TF_SetAttrTensor</span>(desc, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>value<span class=\"pl-pds\">\"</span></span>, empty, status);\n  <span class=\"pl-c1\">TF_SetAttrType</span>(desc, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>dtype<span class=\"pl-pds\">\"</span></span>, TF_FLOAT);\n  TF_Operation* op = <span class=\"pl-c1\">TF_FinishOperation</span>(desc, status);\n  TF_Tensor* value;\n  <span class=\"pl-c1\">TF_OperationGetAttrTensor</span>(op, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>value<span class=\"pl-pds\">\"</span></span>, &amp;value, status); <span class=\"pl-c\"><span class=\"pl-c\">//</span>Segfaults</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-c1\">0</span>;\n}</pre></div>\n<p>Note that <code>TF_Message(status)</code> is <code>TF_OK</code> after the calls to <code>TF_SetAttrTensor</code> and <code>TF_FinishOperation</code>.</p>", "body_text": "On 1.0.0-rc1 (and earlier versions), this segfaults:\nvoid dealloc(void* data, size_t len, void* arg) {\n}\n\nint main() {\n  TF_Tensor* empty = TF_NewTensor(TF_FLOAT, NULL, 0, NULL, 0, dealloc, NULL);\n  TF_Graph* graph = TF_NewGraph();\n  TF_OperationDescription* desc = TF_NewOperation(graph, \"Const\", \"empty\");\n  TF_Status* status = TF_NewStatus();\n  TF_SetAttrTensor(desc, \"value\", empty, status);\n  TF_SetAttrType(desc, \"dtype\", TF_FLOAT);\n  TF_Operation* op = TF_FinishOperation(desc, status);\n  TF_Tensor* value;\n  TF_OperationGetAttrTensor(op, \"value\", &value, status); //Segfaults\n  return 0;\n}\nNote that TF_Message(status) is TF_OK after the calls to TF_SetAttrTensor and TF_FinishOperation.", "body": "On 1.0.0-rc1 (and earlier versions), this segfaults:\r\n\r\n```c\r\nvoid dealloc(void* data, size_t len, void* arg) {\r\n}\r\n\r\nint main() {\r\n  TF_Tensor* empty = TF_NewTensor(TF_FLOAT, NULL, 0, NULL, 0, dealloc, NULL);\r\n  TF_Graph* graph = TF_NewGraph();\r\n  TF_OperationDescription* desc = TF_NewOperation(graph, \"Const\", \"empty\");\r\n  TF_Status* status = TF_NewStatus();\r\n  TF_SetAttrTensor(desc, \"value\", empty, status);\r\n  TF_SetAttrType(desc, \"dtype\", TF_FLOAT);\r\n  TF_Operation* op = TF_FinishOperation(desc, status);\r\n  TF_Tensor* value;\r\n  TF_OperationGetAttrTensor(op, \"value\", &value, status); //Segfaults\r\n  return 0;\r\n}\r\n```\r\n\r\nNote that `TF_Message(status)` is `TF_OK` after the calls to `TF_SetAttrTensor` and `TF_FinishOperation`. "}