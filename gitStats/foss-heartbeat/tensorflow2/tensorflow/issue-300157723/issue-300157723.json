{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17269", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17269/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17269/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17269/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/17269", "id": 300157723, "node_id": "MDU6SXNzdWUzMDAxNTc3MjM=", "number": 17269, "title": "Can't load model file", "user": {"login": "frkhit", "id": 15940906, "node_id": "MDQ6VXNlcjE1OTQwOTA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15940906?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frkhit", "html_url": "https://github.com/frkhit", "followers_url": "https://api.github.com/users/frkhit/followers", "following_url": "https://api.github.com/users/frkhit/following{/other_user}", "gists_url": "https://api.github.com/users/frkhit/gists{/gist_id}", "starred_url": "https://api.github.com/users/frkhit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frkhit/subscriptions", "organizations_url": "https://api.github.com/users/frkhit/orgs", "repos_url": "https://api.github.com/users/frkhit/repos", "events_url": "https://api.github.com/users/frkhit/events{/privacy}", "received_events_url": "https://api.github.com/users/frkhit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "poxvoculi", "id": 15676913, "node_id": "MDQ6VXNlcjE1Njc2OTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15676913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poxvoculi", "html_url": "https://github.com/poxvoculi", "followers_url": "https://api.github.com/users/poxvoculi/followers", "following_url": "https://api.github.com/users/poxvoculi/following{/other_user}", "gists_url": "https://api.github.com/users/poxvoculi/gists{/gist_id}", "starred_url": "https://api.github.com/users/poxvoculi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poxvoculi/subscriptions", "organizations_url": "https://api.github.com/users/poxvoculi/orgs", "repos_url": "https://api.github.com/users/poxvoculi/repos", "events_url": "https://api.github.com/users/poxvoculi/events{/privacy}", "received_events_url": "https://api.github.com/users/poxvoculi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "poxvoculi", "id": 15676913, "node_id": "MDQ6VXNlcjE1Njc2OTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15676913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poxvoculi", "html_url": "https://github.com/poxvoculi", "followers_url": "https://api.github.com/users/poxvoculi/followers", "following_url": "https://api.github.com/users/poxvoculi/following{/other_user}", "gists_url": "https://api.github.com/users/poxvoculi/gists{/gist_id}", "starred_url": "https://api.github.com/users/poxvoculi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poxvoculi/subscriptions", "organizations_url": "https://api.github.com/users/poxvoculi/orgs", "repos_url": "https://api.github.com/users/poxvoculi/repos", "events_url": "https://api.github.com/users/poxvoculi/events{/privacy}", "received_events_url": "https://api.github.com/users/poxvoculi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-02-26T09:10:28Z", "updated_at": "2018-04-06T16:26:08Z", "closed_at": "2018-04-06T16:26:08Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nYes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nenv from <a href=\"https://colab.research.google.com/\" rel=\"nofollow\">google colab</a></li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nenv from <a href=\"https://colab.research.google.com/\" rel=\"nofollow\">google colab</a></li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\n<code>1.6.0-rc1 </code></li>\n<li><strong>Python version</strong>:<br>\n<code>python 3.6</code></li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I have code like this:</p>\n<pre><code>slim.assign_from_checkpoint_fn(\n        pretrained_model_file,\n        variables_to_restore,\n        ignore_missing_vars=True)\n</code></pre>\n<p>when  <code>pretrained_model_file = \"vgg_19.ckpt\"</code>, where vgg_19.ckpt is a checkpoint file from pre-trained model, it raise Exception:</p>\n<pre><code>---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n&lt;ipython-input-29-b803c1b9c409&gt; in &lt;module&gt;()\n     10 \n     11 \n---&gt; 12 demo()\n\n&lt;ipython-input-29-b803c1b9c409&gt; in demo()\n      7             \"1000\", \"--network\", \"/content/vgg_19.ckpt\",\n      8             \"--checkpoint-iterations\", \"10\", \"--checkpoint-output\", \"/content/tmp-tv-%s.jpg\"]\n----&gt; 9     neural_style_main(args)\n     10 \n     11 \n\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/neural_style.py in main(args)\n    178         pooling=options.pooling,\n    179         print_iterations=options.print_iterations,\n--&gt; 180         checkpoint_iterations=options.checkpoint_iterations\n    181     ):\n    182         output_file = None\n\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/stylize.py in stylize(network, initial, initial_noiseblend, content, styles, preserve_colors, iterations, content_weight, content_weight_blend, style_weight, style_layer_weight_exp, style_blend_weights, tv_weight, learning_rate, beta1, beta2, epsilon, pooling, print_iterations, checkpoint_iterations)\n     77                                                     naming=\"style-{}\".format(i),\n     78                                                     pretrained_model_file=pretrained_model_file,\n---&gt; 79                                                     checkpoint_exclude_scopes=checkpoint_exclude_scopes)\n     80 \n     81         for index, layer in enumerate(STYLE_LAYERS):\n\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/losses.py in get_style_features(model_name, style_image, image_size, style_layers, naming, pretrained_model_file, checkpoint_exclude_scopes)\n     97                 break\n     98         if not excluded:\n---&gt; 99             variables_to_restore.append(var)\n    100 \n    101     return assign_from_checkpoint_fn(\n\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/framework/python/ops/variables.py in callback(session)\n    688     saver = tf_saver.Saver(var_list, reshape=reshape_variables)\n    689     def callback(session):\n--&gt; 690       saver.restore(session, model_path)\n    691     return callback\n    692   else:\n\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\n   1754       raise ValueError(\"The specified path: %s is a file.\"\n   1755                        \" Please specify only the path prefix\"\n-&gt; 1756                        \" to the checkpoint files.\" % save_path)\n   1757     logging.info(\"Restoring parameters from %s\", save_path)\n   1758     if context.in_graph_mode():\n\nValueError: The specified path: /content/vgg_19.ckpt is a file. Please specify only the path prefix to the checkpoint files.\n</code></pre>\n<p>If I change pretained_model_file to the folder contains checkpoint file, it raise <code>Exception: No checkpoint found...</code>.</p>\n<p>If I force to change tensorflow from 1.6 to 1.4, and  <code>pretrained_model_file = \"vgg_19.ckpt\"</code>, this code can work!</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nenv from google colab\nTensorFlow installed from (source or binary):\nenv from google colab\nTensorFlow version (use command below):\n1.6.0-rc1 \nPython version:\npython 3.6\n\nDescribe the problem\nI have code like this:\nslim.assign_from_checkpoint_fn(\n        pretrained_model_file,\n        variables_to_restore,\n        ignore_missing_vars=True)\n\nwhen  pretrained_model_file = \"vgg_19.ckpt\", where vgg_19.ckpt is a checkpoint file from pre-trained model, it raise Exception:\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-29-b803c1b9c409> in <module>()\n     10 \n     11 \n---> 12 demo()\n\n<ipython-input-29-b803c1b9c409> in demo()\n      7             \"1000\", \"--network\", \"/content/vgg_19.ckpt\",\n      8             \"--checkpoint-iterations\", \"10\", \"--checkpoint-output\", \"/content/tmp-tv-%s.jpg\"]\n----> 9     neural_style_main(args)\n     10 \n     11 \n\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/neural_style.py in main(args)\n    178         pooling=options.pooling,\n    179         print_iterations=options.print_iterations,\n--> 180         checkpoint_iterations=options.checkpoint_iterations\n    181     ):\n    182         output_file = None\n\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/stylize.py in stylize(network, initial, initial_noiseblend, content, styles, preserve_colors, iterations, content_weight, content_weight_blend, style_weight, style_layer_weight_exp, style_blend_weights, tv_weight, learning_rate, beta1, beta2, epsilon, pooling, print_iterations, checkpoint_iterations)\n     77                                                     naming=\"style-{}\".format(i),\n     78                                                     pretrained_model_file=pretrained_model_file,\n---> 79                                                     checkpoint_exclude_scopes=checkpoint_exclude_scopes)\n     80 \n     81         for index, layer in enumerate(STYLE_LAYERS):\n\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/losses.py in get_style_features(model_name, style_image, image_size, style_layers, naming, pretrained_model_file, checkpoint_exclude_scopes)\n     97                 break\n     98         if not excluded:\n---> 99             variables_to_restore.append(var)\n    100 \n    101     return assign_from_checkpoint_fn(\n\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/framework/python/ops/variables.py in callback(session)\n    688     saver = tf_saver.Saver(var_list, reshape=reshape_variables)\n    689     def callback(session):\n--> 690       saver.restore(session, model_path)\n    691     return callback\n    692   else:\n\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\n   1754       raise ValueError(\"The specified path: %s is a file.\"\n   1755                        \" Please specify only the path prefix\"\n-> 1756                        \" to the checkpoint files.\" % save_path)\n   1757     logging.info(\"Restoring parameters from %s\", save_path)\n   1758     if context.in_graph_mode():\n\nValueError: The specified path: /content/vgg_19.ckpt is a file. Please specify only the path prefix to the checkpoint files.\n\nIf I change pretained_model_file to the folder contains checkpoint file, it raise Exception: No checkpoint found....\nIf I force to change tensorflow from 1.6 to 1.4, and  pretrained_model_file = \"vgg_19.ckpt\", this code can work!", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n   env from [google colab](https://colab.research.google.com/)\r\n- **TensorFlow installed from (source or binary)**:\r\n  env from [google colab](https://colab.research.google.com/)\r\n- **TensorFlow version (use command below)**:\r\n``` 1.6.0-rc1  ```\r\n- **Python version**: \r\n```python 3.6```\r\n\r\n### Describe the problem\r\nI have code like this:\r\n\r\n```\r\nslim.assign_from_checkpoint_fn(\r\n        pretrained_model_file,\r\n        variables_to_restore,\r\n        ignore_missing_vars=True)\r\n```\r\n\r\nwhen  `pretrained_model_file = \"vgg_19.ckpt\"`, where vgg_19.ckpt is a checkpoint file from pre-trained model, it raise Exception:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-29-b803c1b9c409> in <module>()\r\n     10 \r\n     11 \r\n---> 12 demo()\r\n\r\n<ipython-input-29-b803c1b9c409> in demo()\r\n      7             \"1000\", \"--network\", \"/content/vgg_19.ckpt\",\r\n      8             \"--checkpoint-iterations\", \"10\", \"--checkpoint-output\", \"/content/tmp-tv-%s.jpg\"]\r\n----> 9     neural_style_main(args)\r\n     10 \r\n     11 \r\n\r\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/neural_style.py in main(args)\r\n    178         pooling=options.pooling,\r\n    179         print_iterations=options.print_iterations,\r\n--> 180         checkpoint_iterations=options.checkpoint_iterations\r\n    181     ):\r\n    182         output_file = None\r\n\r\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/stylize.py in stylize(network, initial, initial_noiseblend, content, styles, preserve_colors, iterations, content_weight, content_weight_blend, style_weight, style_layer_weight_exp, style_blend_weights, tv_weight, learning_rate, beta1, beta2, epsilon, pooling, print_iterations, checkpoint_iterations)\r\n     77                                                     naming=\"style-{}\".format(i),\r\n     78                                                     pretrained_model_file=pretrained_model_file,\r\n---> 79                                                     checkpoint_exclude_scopes=checkpoint_exclude_scopes)\r\n     80 \r\n     81         for index, layer in enumerate(STYLE_LAYERS):\r\n\r\n/usr/local/lib/python3.6/dist-packages/neural_style_demo/losses.py in get_style_features(model_name, style_image, image_size, style_layers, naming, pretrained_model_file, checkpoint_exclude_scopes)\r\n     97                 break\r\n     98         if not excluded:\r\n---> 99             variables_to_restore.append(var)\r\n    100 \r\n    101     return assign_from_checkpoint_fn(\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/framework/python/ops/variables.py in callback(session)\r\n    688     saver = tf_saver.Saver(var_list, reshape=reshape_variables)\r\n    689     def callback(session):\r\n--> 690       saver.restore(session, model_path)\r\n    691     return callback\r\n    692   else:\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\r\n   1754       raise ValueError(\"The specified path: %s is a file.\"\r\n   1755                        \" Please specify only the path prefix\"\r\n-> 1756                        \" to the checkpoint files.\" % save_path)\r\n   1757     logging.info(\"Restoring parameters from %s\", save_path)\r\n   1758     if context.in_graph_mode():\r\n\r\nValueError: The specified path: /content/vgg_19.ckpt is a file. Please specify only the path prefix to the checkpoint files.\r\n```\r\n\r\nIf I change pretained_model_file to the folder contains checkpoint file, it raise ` Exception: No checkpoint found... `.\r\n\r\nIf I force to change tensorflow from 1.6 to 1.4, and  `pretrained_model_file = \"vgg_19.ckpt\"`, this code can work!\r\n\r\n\r\n"}