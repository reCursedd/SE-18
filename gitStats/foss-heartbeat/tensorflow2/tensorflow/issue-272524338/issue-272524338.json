{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14405", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14405/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14405/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14405/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14405", "id": 272524338, "node_id": "MDU6SXNzdWUyNzI1MjQzMzg=", "number": 14405, "title": "`keras` model with `tf.keras.layers.Conv2D` layers compiled with `tf.losses.softmax_cross_entropy` loss does not converge", "user": {"login": "tranhungnghiep", "id": 4527536, "node_id": "MDQ6VXNlcjQ1Mjc1MzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4527536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tranhungnghiep", "html_url": "https://github.com/tranhungnghiep", "followers_url": "https://api.github.com/users/tranhungnghiep/followers", "following_url": "https://api.github.com/users/tranhungnghiep/following{/other_user}", "gists_url": "https://api.github.com/users/tranhungnghiep/gists{/gist_id}", "starred_url": "https://api.github.com/users/tranhungnghiep/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tranhungnghiep/subscriptions", "organizations_url": "https://api.github.com/users/tranhungnghiep/orgs", "repos_url": "https://api.github.com/users/tranhungnghiep/repos", "events_url": "https://api.github.com/users/tranhungnghiep/events{/privacy}", "received_events_url": "https://api.github.com/users/tranhungnghiep/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-11-09T11:05:43Z", "updated_at": "2017-11-11T12:40:17Z", "closed_at": "2017-11-10T21:38:46Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: simple MNIST model in keras</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Debian GNU/Linux 8</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: binary from pip</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.4</li>\n<li><strong>Python version</strong>: 3.5.3</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When using <code>tf.losses.softmax_cross_entropy</code> in a <code>tf.keras</code> model with <code>tf.keras.layers.Conv2D</code> layer, <code>model.fit()</code> does not converge, although no exception raised loss does not change.<br>\nWhen change loss function to <code>tf.keras.losses.categorical_crossentropy</code>, or layer to <code>tf.layers.Conv2D</code>, it converges quickly.</p>\n<h3>Source code / logs</h3>\n<p><code>model.fit()</code> log:<br>\nTrain on 50000 samples, validate on 10000 samples<br>\nEpoch 1/5<br>\n50000/50000 [==============================] - 84s - loss: 2.3622 - acc: 0.0986 - val_loss: 2.3662 - val_acc: 0.0950<br>\nEpoch 2/5<br>\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950<br>\nEpoch 3/5<br>\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950<br>\nEpoch 4/5<br>\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950<br>\nEpoch 5/5<br>\n50000/50000 [==============================] - 84s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950<br>\n9984/10000 [============================&gt;.] - ETA: 0s<br>\nTest loss: 2.362950. Test accuracy: 0.098200</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): simple MNIST model in keras\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Debian GNU/Linux 8\nTensorFlow installed from (source or binary): binary from pip\nTensorFlow version (use command below): 1.4\nPython version: 3.5.3\n\nDescribe the problem\nWhen using tf.losses.softmax_cross_entropy in a tf.keras model with tf.keras.layers.Conv2D layer, model.fit() does not converge, although no exception raised loss does not change.\nWhen change loss function to tf.keras.losses.categorical_crossentropy, or layer to tf.layers.Conv2D, it converges quickly.\nSource code / logs\nmodel.fit() log:\nTrain on 50000 samples, validate on 10000 samples\nEpoch 1/5\n50000/50000 [==============================] - 84s - loss: 2.3622 - acc: 0.0986 - val_loss: 2.3662 - val_acc: 0.0950\nEpoch 2/5\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\nEpoch 3/5\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\nEpoch 4/5\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\nEpoch 5/5\n50000/50000 [==============================] - 84s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\n9984/10000 [============================>.] - ETA: 0s\nTest loss: 2.362950. Test accuracy: 0.098200", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: simple MNIST model in keras\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Debian GNU/Linux 8\r\n- **TensorFlow installed from (source or binary)**: binary from pip\r\n- **TensorFlow version (use command below)**: 1.4\r\n- **Python version**: 3.5.3\r\n\r\n### Describe the problem\r\nWhen using `tf.losses.softmax_cross_entropy` in a `tf.keras` model with `tf.keras.layers.Conv2D` layer, `model.fit()` does not converge, although no exception raised loss does not change.\r\nWhen change loss function to `tf.keras.losses.categorical_crossentropy`, or layer to `tf.layers.Conv2D`, it converges quickly.\r\n\r\n### Source code / logs\r\n`model.fit()` log:\r\nTrain on 50000 samples, validate on 10000 samples\r\nEpoch 1/5\r\n50000/50000 [==============================] - 84s - loss: 2.3622 - acc: 0.0986 - val_loss: 2.3662 - val_acc: 0.0950\r\nEpoch 2/5\r\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\r\nEpoch 3/5\r\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\r\nEpoch 4/5\r\n50000/50000 [==============================] - 83s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\r\nEpoch 5/5\r\n50000/50000 [==============================] - 84s - loss: 2.3633 - acc: 0.0978 - val_loss: 2.3662 - val_acc: 0.0950\r\n9984/10000 [============================>.] - ETA: 0s \r\nTest loss: 2.362950. Test accuracy: 0.098200"}