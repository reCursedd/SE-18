{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/123114482", "pull_request_review_id": 45287495, "id": 123114482, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMzExNDQ4Mg==", "diff_hunk": "@@ -166,7 +170,15 @@ Status AutoParallel::Initialize(const GrapplerItem& item) {\n   std::set<string> dont_replicate_nodes;\n   for (const auto& variable : item.MainVariables()) {\n     dont_replicate_nodes.insert(variable->name());\n+    VariableDef var = variables_[strings::StrCat(variable->name(), \":0\")];\n+    if (!var.initializer_name().empty()) {\n+      dont_replicate_nodes.insert(NodeName(var.initializer_name()));\n+    }\n+    if (!var.snapshot_name().empty()) {\n+      dont_replicate_nodes.insert(NodeName(var.initializer_name()));", "path": "tensorflow/core/grappler/optimizers/auto_parallel.cc", "position": null, "original_position": 20, "commit_id": "eaf6894f9194a25f7ba7931e93ea76a79ca7e2b6", "original_commit_id": "7760db6dd7b2c1f8057397a8b5d5f7f293beb71c", "user": {"login": "benoitsteiner", "id": 6969686, "node_id": "MDQ6VXNlcjY5Njk2ODY=", "avatar_url": "https://avatars0.githubusercontent.com/u/6969686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benoitsteiner", "html_url": "https://github.com/benoitsteiner", "followers_url": "https://api.github.com/users/benoitsteiner/followers", "following_url": "https://api.github.com/users/benoitsteiner/following{/other_user}", "gists_url": "https://api.github.com/users/benoitsteiner/gists{/gist_id}", "starred_url": "https://api.github.com/users/benoitsteiner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benoitsteiner/subscriptions", "organizations_url": "https://api.github.com/users/benoitsteiner/orgs", "repos_url": "https://api.github.com/users/benoitsteiner/repos", "events_url": "https://api.github.com/users/benoitsteiner/events{/privacy}", "received_events_url": "https://api.github.com/users/benoitsteiner/received_events", "type": "User", "site_admin": false}, "body": "You probably meant to at the snapshot_name to the list of nodes to avoid replicating here.\r\n\r\nSnapshots are used as a way to prefetch the content of a variable onto a device. If you start creating multiple replicas, you probably want to prefetch the variables onto the devices where each replica is going to be executed. So you probably should replicate the variable snapshots.", "created_at": "2017-06-20T22:38:17Z", "updated_at": "2017-06-21T13:24:17Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/10368#discussion_r123114482", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/10368", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/123114482"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/10368#discussion_r123114482"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/10368"}}, "body_html": "<p>You probably meant to at the snapshot_name to the list of nodes to avoid replicating here.</p>\n<p>Snapshots are used as a way to prefetch the content of a variable onto a device. If you start creating multiple replicas, you probably want to prefetch the variables onto the devices where each replica is going to be executed. So you probably should replicate the variable snapshots.</p>", "body_text": "You probably meant to at the snapshot_name to the list of nodes to avoid replicating here.\nSnapshots are used as a way to prefetch the content of a variable onto a device. If you start creating multiple replicas, you probably want to prefetch the variables onto the devices where each replica is going to be executed. So you probably should replicate the variable snapshots."}