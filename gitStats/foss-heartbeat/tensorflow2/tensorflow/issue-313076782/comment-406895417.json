{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/406895417", "html_url": "https://github.com/tensorflow/tensorflow/issues/18394#issuecomment-406895417", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18394", "id": 406895417, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjg5NTQxNw==", "user": {"login": "ankitvgupta", "id": 5473865, "node_id": "MDQ6VXNlcjU0NzM4NjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/5473865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ankitvgupta", "html_url": "https://github.com/ankitvgupta", "followers_url": "https://api.github.com/users/ankitvgupta/followers", "following_url": "https://api.github.com/users/ankitvgupta/following{/other_user}", "gists_url": "https://api.github.com/users/ankitvgupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/ankitvgupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ankitvgupta/subscriptions", "organizations_url": "https://api.github.com/users/ankitvgupta/orgs", "repos_url": "https://api.github.com/users/ankitvgupta/repos", "events_url": "https://api.github.com/users/ankitvgupta/events{/privacy}", "received_events_url": "https://api.github.com/users/ankitvgupta/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-22T20:45:15Z", "updated_at": "2018-07-22T20:45:43Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=245990\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/goutham\">@goutham</a>, I tried this out on tf-nightly-gpu, and ran into one small bug.</p>\n<p>I used <code>tf.estimator.train_and_evaluate</code>, and added the new early stopping hook as one of the train hooks. It looks like it checks for early stopping right after the first checkpoint (step 0), and as a result finds that there is no eval directory made yet since the first eval hasn't happened yet. Specifically, I get this error message (replacing MY_MODEL_DIR with the actual directory)</p>\n<p><code>tensorflow.python.framework.errors_impl.NotFoundError: $MY_MODEL_DIR/eval; No such file or directory</code></p>\n<p>In the new version of <code>run_local</code>, it looks like evaluation occurs <a href=\"https://github.com/tensorflow/tensorflow/blob/3edb609926f2521c726737fc1efeae1572dc6581/tensorflow/python/estimator/training.py#L685\">via a CheckpointSaverListener</a>, so eval should occur right after the checkpoint is saved. However, it looks like the early stopping hook is running before that happens.</p>\n<p>I believe there is a min_steps parameter, but it appears to be checking for eval stats even if I set that to be high.</p>", "body_text": "Hi @goutham, I tried this out on tf-nightly-gpu, and ran into one small bug.\nI used tf.estimator.train_and_evaluate, and added the new early stopping hook as one of the train hooks. It looks like it checks for early stopping right after the first checkpoint (step 0), and as a result finds that there is no eval directory made yet since the first eval hasn't happened yet. Specifically, I get this error message (replacing MY_MODEL_DIR with the actual directory)\ntensorflow.python.framework.errors_impl.NotFoundError: $MY_MODEL_DIR/eval; No such file or directory\nIn the new version of run_local, it looks like evaluation occurs via a CheckpointSaverListener, so eval should occur right after the checkpoint is saved. However, it looks like the early stopping hook is running before that happens.\nI believe there is a min_steps parameter, but it appears to be checking for eval stats even if I set that to be high.", "body": "Hi @goutham, I tried this out on tf-nightly-gpu, and ran into one small bug. \r\n\r\nI used `tf.estimator.train_and_evaluate`, and added the new early stopping hook as one of the train hooks. It looks like it checks for early stopping right after the first checkpoint (step 0), and as a result finds that there is no eval directory made yet since the first eval hasn't happened yet. Specifically, I get this error message (replacing MY_MODEL_DIR with the actual directory)\r\n\r\n```tensorflow.python.framework.errors_impl.NotFoundError: $MY_MODEL_DIR/eval; No such file or directory```\r\n\r\nIn the new version of `run_local`, it looks like evaluation occurs [via a CheckpointSaverListener](https://github.com/tensorflow/tensorflow/blob/3edb609926f2521c726737fc1efeae1572dc6581/tensorflow/python/estimator/training.py#L685), so eval should occur right after the checkpoint is saved. However, it looks like the early stopping hook is running before that happens. \r\n\r\nI believe there is a min_steps parameter, but it appears to be checking for eval stats even if I set that to be high. "}