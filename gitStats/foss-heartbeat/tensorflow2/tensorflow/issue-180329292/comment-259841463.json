{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/259841463", "html_url": "https://github.com/tensorflow/tensorflow/pull/4686#issuecomment-259841463", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4686", "id": 259841463, "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTg0MTQ2Mw==", "user": {"login": "lmthang", "id": 396613, "node_id": "MDQ6VXNlcjM5NjYxMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/396613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lmthang", "html_url": "https://github.com/lmthang", "followers_url": "https://api.github.com/users/lmthang/followers", "following_url": "https://api.github.com/users/lmthang/following{/other_user}", "gists_url": "https://api.github.com/users/lmthang/gists{/gist_id}", "starred_url": "https://api.github.com/users/lmthang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lmthang/subscriptions", "organizations_url": "https://api.github.com/users/lmthang/orgs", "repos_url": "https://api.github.com/users/lmthang/repos", "events_url": "https://api.github.com/users/lmthang/events{/privacy}", "received_events_url": "https://api.github.com/users/lmthang/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-10T23:44:27Z", "updated_at": "2016-11-10T23:48:35Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=12167999\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/alrojo\">@alrojo</a>,</p>\n<p>Continuing from my earlier code, one more thing you should add to make the <code>simple_decoder_fn_inference</code> correct:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">if</span> cell_output <span class=\"pl-k\">==</span> <span class=\"pl-c1\">None</span>:\n  <span class=\"pl-c1\">...</span>\n  cell_output <span class=\"pl-k\">=</span> array_ops.zeros(num_decoder_symbols, <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>dtypes.float32)\n<span class=\"pl-k\">else</span>:\n  <span class=\"pl-c1\">...</span>\n  cell_output <span class=\"pl-k\">=</span> logits</pre></div>\n<p>This part <code>array_ops.zeros(num_decoder_symbols, dtype=dtypes.float32)</code> is a temporary hack so that <code>raw_rnn</code> can get the right output size. Also, we ideally want to return the word indices (beside the logits), but this is slightly tricky to do as we need to update <code>raw_rnn</code>. We (=TF team) will address these issues later once this PR is approved.</p>\n<p>-Thang</p>", "body_text": "Hi @alrojo,\nContinuing from my earlier code, one more thing you should add to make the simple_decoder_fn_inference correct:\nif cell_output == None:\n  ...\n  cell_output = array_ops.zeros(num_decoder_symbols, dtype=dtypes.float32)\nelse:\n  ...\n  cell_output = logits\nThis part array_ops.zeros(num_decoder_symbols, dtype=dtypes.float32) is a temporary hack so that raw_rnn can get the right output size. Also, we ideally want to return the word indices (beside the logits), but this is slightly tricky to do as we need to update raw_rnn. We (=TF team) will address these issues later once this PR is approved.\n-Thang", "body": "Hi @alrojo,\n\nContinuing from my earlier code, one more thing you should add to make the `simple_decoder_fn_inference` correct:\n\n``` python\nif cell_output == None:\n  ...\n  cell_output = array_ops.zeros(num_decoder_symbols, dtype=dtypes.float32)\nelse:\n  ...\n  cell_output = logits\n```\n\nThis part `array_ops.zeros(num_decoder_symbols, dtype=dtypes.float32)` is a temporary hack so that `raw_rnn` can get the right output size. Also, we ideally want to return the word indices (beside the logits), but this is slightly tricky to do as we need to update `raw_rnn`. We (=TF team) will address these issues later once this PR is approved.\n\n-Thang\n"}