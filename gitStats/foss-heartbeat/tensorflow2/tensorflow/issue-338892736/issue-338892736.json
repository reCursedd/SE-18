{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20588", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20588/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20588/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20588/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20588", "id": 338892736, "node_id": "MDU6SXNzdWUzMzg4OTI3MzY=", "number": 20588, "title": "simple_estimator_example.py does not working", "user": {"login": "Bocharick", "id": 6680697, "node_id": "MDQ6VXNlcjY2ODA2OTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/6680697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bocharick", "html_url": "https://github.com/Bocharick", "followers_url": "https://api.github.com/users/Bocharick/followers", "following_url": "https://api.github.com/users/Bocharick/following{/other_user}", "gists_url": "https://api.github.com/users/Bocharick/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bocharick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bocharick/subscriptions", "organizations_url": "https://api.github.com/users/Bocharick/orgs", "repos_url": "https://api.github.com/users/Bocharick/repos", "events_url": "https://api.github.com/users/Bocharick/events{/privacy}", "received_events_url": "https://api.github.com/users/Bocharick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-07-06T10:43:45Z", "updated_at": "2018-08-31T18:15:27Z", "closed_at": "2018-08-31T18:15:27Z", "author_association": "NONE", "body_html": "<p>Hello.<br>\nTried to figure out with your<br>\nand try <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/distribute/python/examples/simple_estimator_example.py\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/distribute/python/examples/simple_estimator_example.py</a><br>\nbut it doesn't working with that errors:</p>\n<p>/usr/bin/python3.5 /<em><strong>SOME_PATH</strong></em>_/simple_estimator_example.py<br>\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmp0qhilmok<br>\n2018-07-06 17:41:20.153970: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>\n2018-07-06 17:41:20.269549: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-07-06 17:41:20.269961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties:<br>\nname: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.683<br>\npciBusID: 0000:01:00.0<br>\ntotalMemory: 7.92GiB freeMemory: 7.83GiB<br>\n2018-07-06 17:41:20.269973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0<br>\n2018-07-06 17:41:20.475627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-07-06 17:41:20.475650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0<br>\n2018-07-06 17:41:20.475655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N<br>\n2018-07-06 17:41:20.475841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/device:GPU:0 with 7559 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)<br>\n2018-07-06 17:41:20.564665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0<br>\n2018-07-06 17:41:20.564699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-07-06 17:41:20.564705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0<br>\n2018-07-06 17:41:20.564709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N<br>\n2018-07-06 17:41:20.564810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7559 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)<br>\nTraceback (most recent call last):<br>\nFile \"/home/bocharick/HDD/UbuntuFiles/PycharmProjects/LanguageDetector/bin/estimator_tst.py\", line 89, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 125, in run<br>\n_sys.exit(main(argv))<br>\nFile \"/home/bocharick/HDD/UbuntuFiles/PycharmProjects/LanguageDetector/bin/estimator_tst.py\", line 73, in main<br>\nestimator.train(input_fn=input_fn, steps=10)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 366, in train<br>\nloss = self._train_model(input_fn, hooks, saving_listeners)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1117, in _train_model<br>\nreturn self._train_model_distributed(input_fn, hooks, saving_listeners)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1160, in _train_model_distributed<br>\nself.config)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/distribute.py\", line 794, in call_for_each_tower<br>\nreturn self._call_for_each_tower(fn, *args, **kwargs)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 269, in _call_for_each_tower<br>\ncoord.join(threads)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 389, in join<br>\nsix.reraise(*self._exc_info_to_raise)<br>\nFile \"/usr/lib/python3/dist-packages/six.py\", line 686, in reraise<br>\nraise value<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 297, in stop_on_exception<br>\nyield<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 263, in _call_for_each_tower<br>\nself, *merge_args, **merge_kwargs)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/optimizer.py\", line 652, in _distributed_apply<br>\nreduced_grads = distribution.batch_reduce(\"sum\", grads_and_vars)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/distribute.py\", line 840, in batch_reduce<br>\nreturn self._batch_reduce(method_string, value_destination_pairs)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 310, in _batch_reduce<br>\nvalue_destination_pairs)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/cross_tower_ops.py\", line 171, in batch_reduce<br>\nraise ValueError(\"<code>value_destination_pairs</code> must be a list or a tuple of \"<br>\nValueError: <code>value_destination_pairs</code> must be a list or a tuple of tuples of PerDevice objects and destinations</p>\n<p>Process finished with exit code 1</p>\n<p>I tried two versions of tensorflow:</p>\n<ol>\n<li>1.10.nigthly</li>\n<li>1.9.rc2<br>\nPython 3.5</li>\n</ol>\n<p>Same problems both TF versions.<br>\nThank you. Help me, plz</p>", "body_text": "Hello.\nTried to figure out with your\nand try https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/distribute/python/examples/simple_estimator_example.py\nbut it doesn't working with that errors:\n/usr/bin/python3.5 /SOME_PATH_/simple_estimator_example.py\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmp0qhilmok\n2018-07-06 17:41:20.153970: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-07-06 17:41:20.269549: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-07-06 17:41:20.269961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties:\nname: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.683\npciBusID: 0000:01:00.0\ntotalMemory: 7.92GiB freeMemory: 7.83GiB\n2018-07-06 17:41:20.269973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0\n2018-07-06 17:41:20.475627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-07-06 17:41:20.475650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0\n2018-07-06 17:41:20.475655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N\n2018-07-06 17:41:20.475841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/device:GPU:0 with 7559 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-07-06 17:41:20.564665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0\n2018-07-06 17:41:20.564699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-07-06 17:41:20.564705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0\n2018-07-06 17:41:20.564709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N\n2018-07-06 17:41:20.564810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7559 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)\nTraceback (most recent call last):\nFile \"/home/bocharick/HDD/UbuntuFiles/PycharmProjects/LanguageDetector/bin/estimator_tst.py\", line 89, in \ntf.app.run()\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 125, in run\n_sys.exit(main(argv))\nFile \"/home/bocharick/HDD/UbuntuFiles/PycharmProjects/LanguageDetector/bin/estimator_tst.py\", line 73, in main\nestimator.train(input_fn=input_fn, steps=10)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\nloss = self._train_model(input_fn, hooks, saving_listeners)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1117, in _train_model\nreturn self._train_model_distributed(input_fn, hooks, saving_listeners)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1160, in _train_model_distributed\nself.config)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/distribute.py\", line 794, in call_for_each_tower\nreturn self._call_for_each_tower(fn, *args, **kwargs)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 269, in _call_for_each_tower\ncoord.join(threads)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 389, in join\nsix.reraise(*self._exc_info_to_raise)\nFile \"/usr/lib/python3/dist-packages/six.py\", line 686, in reraise\nraise value\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 297, in stop_on_exception\nyield\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 263, in _call_for_each_tower\nself, *merge_args, **merge_kwargs)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/optimizer.py\", line 652, in _distributed_apply\nreduced_grads = distribution.batch_reduce(\"sum\", grads_and_vars)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/distribute.py\", line 840, in batch_reduce\nreturn self._batch_reduce(method_string, value_destination_pairs)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 310, in _batch_reduce\nvalue_destination_pairs)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/cross_tower_ops.py\", line 171, in batch_reduce\nraise ValueError(\"value_destination_pairs must be a list or a tuple of \"\nValueError: value_destination_pairs must be a list or a tuple of tuples of PerDevice objects and destinations\nProcess finished with exit code 1\nI tried two versions of tensorflow:\n\n1.10.nigthly\n1.9.rc2\nPython 3.5\n\nSame problems both TF versions.\nThank you. Help me, plz", "body": "Hello. \r\nTried to figure out with your\r\nand try https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/distribute/python/examples/simple_estimator_example.py\r\nbut it doesn't working with that errors:\r\n\r\n/usr/bin/python3.5 /___SOME_PATH____/simple_estimator_example.py\r\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmp0qhilmok\r\n2018-07-06 17:41:20.153970: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-07-06 17:41:20.269549: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-07-06 17:41:20.269961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1392] Found device 0 with properties: \r\nname: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.683\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 7.92GiB freeMemory: 7.83GiB\r\n2018-07-06 17:41:20.269973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0\r\n2018-07-06 17:41:20.475627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-07-06 17:41:20.475650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0 \r\n2018-07-06 17:41:20.475655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N \r\n2018-07-06 17:41:20.475841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/device:GPU:0 with 7559 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-07-06 17:41:20.564665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1471] Adding visible gpu devices: 0\r\n2018-07-06 17:41:20.564699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:952] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-07-06 17:41:20.564705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:958]      0 \r\n2018-07-06 17:41:20.564709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   N \r\n2018-07-06 17:41:20.564810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1084] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7559 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\nTraceback (most recent call last):\r\n  File \"/home/bocharick/HDD/UbuntuFiles/PycharmProjects/LanguageDetector/bin/estimator_tst.py\", line 89, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"/home/bocharick/HDD/UbuntuFiles/PycharmProjects/LanguageDetector/bin/estimator_tst.py\", line 73, in main\r\n    estimator.train(input_fn=input_fn, steps=10)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 366, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1117, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/estimator/estimator.py\", line 1160, in _train_model_distributed\r\n    self.config)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/distribute.py\", line 794, in call_for_each_tower\r\n    return self._call_for_each_tower(fn, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 269, in _call_for_each_tower\r\n    coord.join(threads)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 389, in join\r\n    six.reraise(*self._exc_info_to_raise)\r\n  File \"/usr/lib/python3/dist-packages/six.py\", line 686, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 297, in stop_on_exception\r\n    yield\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 263, in _call_for_each_tower\r\n    self, *merge_args, **merge_kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/optimizer.py\", line 652, in _distributed_apply\r\n    reduced_grads = distribution.batch_reduce(\"sum\", grads_and_vars)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/distribute.py\", line 840, in batch_reduce\r\n    return self._batch_reduce(method_string, value_destination_pairs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/mirrored_strategy.py\", line 310, in _batch_reduce\r\n    value_destination_pairs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/distribute/python/cross_tower_ops.py\", line 171, in batch_reduce\r\n    raise ValueError(\"`value_destination_pairs` must be a list or a tuple of \"\r\nValueError: `value_destination_pairs` must be a list or a tuple of tuples of PerDevice objects and destinations\r\n\r\nProcess finished with exit code 1\r\n\r\nI tried two versions of tensorflow:\r\n1) 1.10.nigthly\r\n2) 1.9.rc2\r\nPython 3.5\r\n\r\nSame problems both TF versions.\r\nThank you. Help me, plz"}