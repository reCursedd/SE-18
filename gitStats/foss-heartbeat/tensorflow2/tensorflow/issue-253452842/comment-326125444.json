{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/326125444", "html_url": "https://github.com/tensorflow/tensorflow/issues/12659#issuecomment-326125444", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12659", "id": 326125444, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjEyNTQ0NA==", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-30T21:32:52Z", "updated_at": "2017-08-30T21:32:52Z", "author_association": "CONTRIBUTOR", "body_html": "<p>When I run <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=22214696\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/meijun\">@meijun</a>'s code on my CPU-only workstation, I get the expected result (<code>nan</code>). Also, I think <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=49262\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jart\">@jart</a>'s version (which passes <code>np.nan</code> as a constant) will end up running on the CPU as part of a constant folding pass.</p>\n<p>I suspect the problem might be in the GPU implementation of <code>tf.maximum()</code>. This looks like code that hasn't changed for a long time, and is basically a call into Eigen. Perhaps <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6969686\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/benoitsteiner\">@benoitsteiner</a> knows a potential cause for the discrepancy?</p>", "body_text": "When I run @meijun's code on my CPU-only workstation, I get the expected result (nan). Also, I think @jart's version (which passes np.nan as a constant) will end up running on the CPU as part of a constant folding pass.\nI suspect the problem might be in the GPU implementation of tf.maximum(). This looks like code that hasn't changed for a long time, and is basically a call into Eigen. Perhaps @benoitsteiner knows a potential cause for the discrepancy?", "body": "When I run @meijun's code on my CPU-only workstation, I get the expected result (`nan`). Also, I think @jart's version (which passes `np.nan` as a constant) will end up running on the CPU as part of a constant folding pass.\r\n\r\nI suspect the problem might be in the GPU implementation of `tf.maximum()`. This looks like code that hasn't changed for a long time, and is basically a call into Eigen. Perhaps @benoitsteiner knows a potential cause for the discrepancy?"}