{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/439088092", "html_url": "https://github.com/tensorflow/tensorflow/issues/23471#issuecomment-439088092", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23471", "id": 439088092, "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTA4ODA5Mg==", "user": {"login": "inscite", "id": 20734988, "node_id": "MDQ6VXNlcjIwNzM0OTg4", "avatar_url": "https://avatars2.githubusercontent.com/u/20734988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inscite", "html_url": "https://github.com/inscite", "followers_url": "https://api.github.com/users/inscite/followers", "following_url": "https://api.github.com/users/inscite/following{/other_user}", "gists_url": "https://api.github.com/users/inscite/gists{/gist_id}", "starred_url": "https://api.github.com/users/inscite/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inscite/subscriptions", "organizations_url": "https://api.github.com/users/inscite/orgs", "repos_url": "https://api.github.com/users/inscite/repos", "events_url": "https://api.github.com/users/inscite/events{/privacy}", "received_events_url": "https://api.github.com/users/inscite/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-15T15:51:14Z", "updated_at": "2018-11-15T15:51:14Z", "author_association": "NONE", "body_html": "<p>Greetings!</p>\n<p>Here's some progress about tensorflow source build.<br>\nI'll update extra progress for multiple releases.</p>\n<p><strong>[Common DevEnv]</strong><br>\nCPU: Intel(R) Xeon(R) Gold 6126 (skylake)<br>\nOS: CentOS 7.3.1611<br>\nGCC: 8.2.0<br>\nOpenMPI: Mellanox HPC-X MPI (v3.0.1a1)<br>\nPYENV: Anaconda Virtualenv w/ python 3.6.5<br>\nJDK: 11.0.1</p>\n<p><strong>[Bootstrapping]</strong><br>\nBefore every bazel build, I did..</p>\n<pre><code>$ bazel clean --expunge --async\n$ bazel shutdown\n$ rm -rf &lt;bazel cache&gt;\n</code></pre>\n<p><strong>[r1.12.0]</strong></p>\n<ul>\n<li>XLA | MPI | MKL optz:</li>\n</ul>\n<pre><code>$ bazel build --config=opt --config=mkl //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<ul>\n<li>NOXLA | MPI | nGraph optz:</li>\n</ul>\n<pre><code>$ bazel build --config=opt --config=ngraph //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<ul>\n<li>bazel 0.15.0 | XLA | MPI | MKL optz: Success</li>\n<li>bazel 0.18.0 | XLA | MPI | MKL optz: Success (bazel version may not an issue)</li>\n<li>bazel 0.18.0 | NOXLA | MPI | nGraph optz: Success (graph compiler may not an issue)</li>\n</ul>\n<p><strong>[r1.11.0]</strong></p>\n<ul>\n<li>XLA | MPI | MKL optz:</li>\n</ul>\n<pre><code>$ bazel build --config=opt --config=mkl //tensorflow/tools/pip_package:build_pip_package\n# after I met build error,\n$ git clone https://github.com/tensorflow/tensorflow.git\n$ git checkout 89979f42e827d9eb5c349259a5aa2ec32d38c86a\n</code></pre>\n<ul>\n<li>NOXLA | MPI | nGraph optz:</li>\n</ul>\n<pre><code>$ bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<ul>\n<li>bazel 0.18.0 | XLA | MPI | MKL optz | no patch <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/89979f42e827d9eb5c349259a5aa2ec32d38c86a/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/89979f42e827d9eb5c349259a5aa2ec32d38c86a\"><tt>89979f4</tt></a>: Fail</li>\n<li>bazel 0.18.0 | XLA | MPI | MKL optz | patch <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/89979f42e827d9eb5c349259a5aa2ec32d38c86a/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/89979f42e827d9eb5c349259a5aa2ec32d38c86a\"><tt>89979f4</tt></a>: Success</li>\n<li>bazel 0.18.0 | NOXLA | MPI | nGraph optz: Fail (however the error is related to nGraph, not a MPI)</li>\n</ul>\n<p>One suspicious log I found is related to bazel warning:</p>\n<pre><code>WARNING: Output base '/home/xo/.cache/bazel/_bazel_xo/385bf1ed0f5ed6366bd1e06f79b126ed' is on NFS. This may lead to surprising failures and undetermined behavior.\n</code></pre>\n<p>Actually, I moved 'base source build partition' from NFS to Lustre (there are no local storage) since I experienced multiple errors while building several applications with gcc.<br>\nDoes it cause any errors while building tensorflow? I still have no idea.</p>\n<p><strong>[Conclusion]</strong><br>\nI also succeed to build TF r1.11.0/1.12.0 with minimal revision.<br>\nSince there are a couple of new stable releases, I'll only stick with r1.11.0, r1.12.0.<br>\nStill, for backup usage, I'll test for MPI support.<br>\nThank you for your support: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=28744304\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jthestness\">@jthestness</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=42781361\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/harshini-gadige\">@harshini-gadige</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=2613663\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byronyi\">@byronyi</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6932348\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yongtang\">@yongtang</a></p>\n<p>May I close the issue?</p>", "body_text": "Greetings!\nHere's some progress about tensorflow source build.\nI'll update extra progress for multiple releases.\n[Common DevEnv]\nCPU: Intel(R) Xeon(R) Gold 6126 (skylake)\nOS: CentOS 7.3.1611\nGCC: 8.2.0\nOpenMPI: Mellanox HPC-X MPI (v3.0.1a1)\nPYENV: Anaconda Virtualenv w/ python 3.6.5\nJDK: 11.0.1\n[Bootstrapping]\nBefore every bazel build, I did..\n$ bazel clean --expunge --async\n$ bazel shutdown\n$ rm -rf <bazel cache>\n\n[r1.12.0]\n\nXLA | MPI | MKL optz:\n\n$ bazel build --config=opt --config=mkl //tensorflow/tools/pip_package:build_pip_package\n\n\nNOXLA | MPI | nGraph optz:\n\n$ bazel build --config=opt --config=ngraph //tensorflow/tools/pip_package:build_pip_package\n\n\nbazel 0.15.0 | XLA | MPI | MKL optz: Success\nbazel 0.18.0 | XLA | MPI | MKL optz: Success (bazel version may not an issue)\nbazel 0.18.0 | NOXLA | MPI | nGraph optz: Success (graph compiler may not an issue)\n\n[r1.11.0]\n\nXLA | MPI | MKL optz:\n\n$ bazel build --config=opt --config=mkl //tensorflow/tools/pip_package:build_pip_package\n# after I met build error,\n$ git clone https://github.com/tensorflow/tensorflow.git\n$ git checkout 89979f42e827d9eb5c349259a5aa2ec32d38c86a\n\n\nNOXLA | MPI | nGraph optz:\n\n$ bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\n\n\nbazel 0.18.0 | XLA | MPI | MKL optz | no patch 89979f4: Fail\nbazel 0.18.0 | XLA | MPI | MKL optz | patch 89979f4: Success\nbazel 0.18.0 | NOXLA | MPI | nGraph optz: Fail (however the error is related to nGraph, not a MPI)\n\nOne suspicious log I found is related to bazel warning:\nWARNING: Output base '/home/xo/.cache/bazel/_bazel_xo/385bf1ed0f5ed6366bd1e06f79b126ed' is on NFS. This may lead to surprising failures and undetermined behavior.\n\nActually, I moved 'base source build partition' from NFS to Lustre (there are no local storage) since I experienced multiple errors while building several applications with gcc.\nDoes it cause any errors while building tensorflow? I still have no idea.\n[Conclusion]\nI also succeed to build TF r1.11.0/1.12.0 with minimal revision.\nSince there are a couple of new stable releases, I'll only stick with r1.11.0, r1.12.0.\nStill, for backup usage, I'll test for MPI support.\nThank you for your support: @jthestness @harshini-gadige @byronyi @yongtang\nMay I close the issue?", "body": "Greetings!\r\n\r\nHere's some progress about tensorflow source build.\r\nI'll update extra progress for multiple releases.\r\n\r\n**[Common DevEnv]**\r\nCPU: Intel(R) Xeon(R) Gold 6126 (skylake)\r\nOS: CentOS 7.3.1611\r\nGCC: 8.2.0\r\nOpenMPI: Mellanox HPC-X MPI (v3.0.1a1)\r\nPYENV: Anaconda Virtualenv w/ python 3.6.5\r\nJDK: 11.0.1\r\n\r\n**[Bootstrapping]**\r\nBefore every bazel build, I did..\r\n```\r\n$ bazel clean --expunge --async\r\n$ bazel shutdown\r\n$ rm -rf <bazel cache>\r\n```\r\n\r\n**[r1.12.0]**\r\n* XLA | MPI | MKL optz:\r\n```\r\n$ bazel build --config=opt --config=mkl //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n* NOXLA | MPI | nGraph optz:\r\n```\r\n$ bazel build --config=opt --config=ngraph //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n- bazel 0.15.0 | XLA | MPI | MKL optz: Success\r\n- bazel 0.18.0 | XLA | MPI | MKL optz: Success (bazel version may not an issue)\r\n- bazel 0.18.0 | NOXLA | MPI | nGraph optz: Success (graph compiler may not an issue)\r\n\r\n**[r1.11.0]**\r\n* XLA | MPI | MKL optz:\r\n```\r\n$ bazel build --config=opt --config=mkl //tensorflow/tools/pip_package:build_pip_package\r\n# after I met build error,\r\n$ git clone https://github.com/tensorflow/tensorflow.git\r\n$ git checkout 89979f42e827d9eb5c349259a5aa2ec32d38c86a\r\n```\r\n* NOXLA | MPI | nGraph optz:\r\n```\r\n$ bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n- bazel 0.18.0 | XLA | MPI | MKL optz | no patch 89979f42e827d9eb5c349259a5aa2ec32d38c86a: Fail\r\n- bazel 0.18.0 | XLA | MPI | MKL optz | patch 89979f42e827d9eb5c349259a5aa2ec32d38c86a: Success\r\n- bazel 0.18.0 | NOXLA | MPI | nGraph optz: Fail (however the error is related to nGraph, not a MPI)\r\n\r\nOne suspicious log I found is related to bazel warning:\r\n```\r\nWARNING: Output base '/home/xo/.cache/bazel/_bazel_xo/385bf1ed0f5ed6366bd1e06f79b126ed' is on NFS. This may lead to surprising failures and undetermined behavior.\r\n```\r\nActually, I moved 'base source build partition' from NFS to Lustre (there are no local storage) since I experienced multiple errors while building several applications with gcc.\r\nDoes it cause any errors while building tensorflow? I still have no idea.\r\n\r\n**[Conclusion]**\r\nI also succeed to build TF r1.11.0/1.12.0 with minimal revision.\r\nSince there are a couple of new stable releases, I'll only stick with r1.11.0, r1.12.0.\r\nStill, for backup usage, I'll test for MPI support.\r\nThank you for your support: @jthestness @harshini-gadige @byronyi @yongtang \r\n\r\nMay I close the issue?"}