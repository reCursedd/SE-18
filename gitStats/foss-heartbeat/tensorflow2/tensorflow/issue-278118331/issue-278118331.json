{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15002", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15002/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15002/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15002/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15002", "id": 278118331, "node_id": "MDU6SXNzdWUyNzgxMTgzMzE=", "number": 15002, "title": "fatal error: cuda/include/cuda.h: No such file or directory", "user": {"login": "PatWie", "id": 6756603, "node_id": "MDQ6VXNlcjY3NTY2MDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/6756603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PatWie", "html_url": "https://github.com/PatWie", "followers_url": "https://api.github.com/users/PatWie/followers", "following_url": "https://api.github.com/users/PatWie/following{/other_user}", "gists_url": "https://api.github.com/users/PatWie/gists{/gist_id}", "starred_url": "https://api.github.com/users/PatWie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PatWie/subscriptions", "organizations_url": "https://api.github.com/users/PatWie/orgs", "repos_url": "https://api.github.com/users/PatWie/repos", "events_url": "https://api.github.com/users/PatWie/events{/privacy}", "received_events_url": "https://api.github.com/users/PatWie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "av8ramit", "id": 5588272, "node_id": "MDQ6VXNlcjU1ODgyNzI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5588272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/av8ramit", "html_url": "https://github.com/av8ramit", "followers_url": "https://api.github.com/users/av8ramit/followers", "following_url": "https://api.github.com/users/av8ramit/following{/other_user}", "gists_url": "https://api.github.com/users/av8ramit/gists{/gist_id}", "starred_url": "https://api.github.com/users/av8ramit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/av8ramit/subscriptions", "organizations_url": "https://api.github.com/users/av8ramit/orgs", "repos_url": "https://api.github.com/users/av8ramit/repos", "events_url": "https://api.github.com/users/av8ramit/events{/privacy}", "received_events_url": "https://api.github.com/users/av8ramit/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "av8ramit", "id": 5588272, "node_id": "MDQ6VXNlcjU1ODgyNzI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5588272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/av8ramit", "html_url": "https://github.com/av8ramit", "followers_url": "https://api.github.com/users/av8ramit/followers", "following_url": "https://api.github.com/users/av8ramit/following{/other_user}", "gists_url": "https://api.github.com/users/av8ramit/gists{/gist_id}", "starred_url": "https://api.github.com/users/av8ramit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/av8ramit/subscriptions", "organizations_url": "https://api.github.com/users/av8ramit/orgs", "repos_url": "https://api.github.com/users/av8ramit/repos", "events_url": "https://api.github.com/users/av8ramit/events{/privacy}", "received_events_url": "https://api.github.com/users/av8ramit/received_events", "type": "User", "site_admin": false}, {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 29, "created_at": "2017-11-30T13:23:35Z", "updated_at": "2018-09-25T21:38:58Z", "closed_at": "2018-02-19T08:36:19Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nYes, I followed the official documentation for custom operations.</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:</li>\n</ul>\n<pre><code>Linux pc 4.4.0-81-generic #104-Ubuntu SMP Wed Jun 14 08:17:06 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n<ul>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\ntried both</li>\n<li><strong>TensorFlow version (use command below)</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>version</th>\n<th>status</th>\n<th>comment</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>('v1.2.0-rc1-7529-g8a4d849', '1.4.0')</td>\n<td>not working</td>\n<td>from pip or from source</td>\n</tr>\n<tr>\n<td>('v1.2.0-rc2-21-g12f033d', '1.2.0')</td>\n<td>working</td>\n<td>from <a href=\"https://pypi.python.org/packages/4b/d3/d4fe94f4f370fbb3790444b8f0a007298a795c447e195d88a066de04930d/tensorflow-1.2.0-cp27-cp27mu-manylinux1_x86_64.whl#md5=7e1640384dfd705e17b2f668c1b0427b\" rel=\"nofollow\">pypip</a></td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong>Python version</strong>: 2.7 (<em>irrelevant</em>)</li>\n<li><strong>Bazel version (if compiling from source)</strong>:</li>\n</ul>\n<pre><code>Build label: 0.6.1\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Thu Oct 5 21:54:59 2017 (1507240499)\nBuild timestamp: 1507240499\nBuild timestamp as int: 1507240499\n</code></pre>\n<ul>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: <em>irrelevant</em><br>\ntried both\n<ul>\n<li>g++4.8</li>\n<li>g++5.0</li>\n</ul>\n</li>\n<li><strong>CUDA/cuDNN version</strong>: <em>irrelevant</em></li>\n</ul>\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2016 NVIDIA Corporation\nBuilt on Sun_Sep__4_22:14:01_CDT_2016\nCuda compilation tools, release 8.0, V8.0.44\n</code></pre>\n<ul>\n<li><strong>GPU model and memory</strong>: irrelevant</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<div class=\"highlight highlight-source-shell\"><pre><span class=\"pl-c1\">cd</span> /tmp\nmkdir tf_issue\n<span class=\"pl-c1\">cd</span> tf_issue\nvirtualenv <span class=\"pl-c1\">test</span>\n<span class=\"pl-c1\">source</span> test/bin/activate\npip install tensorflow <span class=\"pl-c\"><span class=\"pl-c\">#</span> in some way: either tensorflow-gpu or from wheel package created by bazel</span>\ngit clone https://github.com/cgtuebingen/tf_custom_op\n<span class=\"pl-c1\">cd</span> tf_custom_op\ncmake <span class=\"pl-c1\">.</span>\nmake</pre></div>\n<h3>Describe the problem</h3>\n<p>Compiling custom ops with</p>\n<div class=\"highlight highlight-source-c++\"><pre>#<span class=\"pl-k\">include</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>tensorflow/core/util/cuda_kernel_helper.h<span class=\"pl-pds\">\"</span></span></pre></div>\n<p>fails due to missing files</p>\n<pre><code>/code/lib/python2.7/site-packages/tensorflow/include/tensorflow/core/util/cuda_kernel_helper.h:24:31: fatal error: cuda/include/cuda.h: No such file or directory\n</code></pre>\n<p>This file <code>cuda/include/cuda.h</code> does not exists! Neither in the pip package nor in the git repository.<br>\nRemoving <code>#include \"tensorflow/core/util/cuda_kernel_helper.h\"</code></p>\n<p>gives plenty of other issues</p>\n<pre><code>/code/kernels/matrix_add_kernel.cu(13): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\n/code/kernels/matrix_add_kernel.cu(59): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\n/code/kernels/matrix_add_kernel.cu(59): error: expected a \";\"\n/code/kernels/matrix_add_kernel.cu(63): error: identifier \"cfg\" is undefined\n/code/kernels/matrix_add_kernel.cu(88): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\n/code/kernels/matrix_add_kernel.cu(88): error: expected a \";\"\n/code/kernels/matrix_add_kernel.cu(92): error: identifier \"cfg\" is undefined\n</code></pre>\n<p>As I already wrote in a related issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"255777816\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12860\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12860/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12860\">#12860</a>, the commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/2c598e874e6a7b6b3185846ce9bac97a7d5d0169/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/2c598e874e6a7b6b3185846ce9bac97a7d5d0169\"><tt>2c598e8</tt></a> is causing this issue by changing</p>\n<div class=\"highlight highlight-source-diff\"><pre><span class=\"pl-md\"><span class=\"pl-md\">-</span>#include \"third_party/gpus/cuda/include/cuda.h\"</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>#include \"cuda/include/cuda.h\"</span></pre></div>\n<p>Copying the old <code>cuda.h</code> gives</p>\n<pre><code>[...]/local/lib/python2.7/site-packages/tensorflow/include/tensorflow/core/platform/default/mutex.h:25:22: fatal error: nsync_cv.h: No such file or directory\n</code></pre>\n<p>which does not exist, too.</p>\n<p>This problem is not related to custom code, it is related to ignore/omitting files in commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/2c598e874e6a7b6b3185846ce9bac97a7d5d0169/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/2c598e874e6a7b6b3185846ce9bac97a7d5d0169\"><tt>2c598e8</tt></a></p>\n<p>As mention in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"255777816\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12860\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12860/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12860\">#12860</a>, this affects many people. In fact, the entire way of writing customs ops with CUDA seems to be broken. Copying own source-code to the TensorFlow-repo was not necessary until TF1.3. Interestingly, even recent NIPS paper implementations state in their readme, they only support TFv1.2. I don't think the proposed workaround of downgrading to TFv1.2 should be the way to go.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes, I followed the official documentation for custom operations.\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\n\nLinux pc 4.4.0-81-generic #104-Ubuntu SMP Wed Jun 14 08:17:06 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n\nTensorFlow installed from (source or binary):\ntried both\nTensorFlow version (use command below):\n\n\n\n\nversion\nstatus\ncomment\n\n\n\n\n('v1.2.0-rc1-7529-g8a4d849', '1.4.0')\nnot working\nfrom pip or from source\n\n\n('v1.2.0-rc2-21-g12f033d', '1.2.0')\nworking\nfrom pypip\n\n\n\n\nPython version: 2.7 (irrelevant)\nBazel version (if compiling from source):\n\nBuild label: 0.6.1\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Thu Oct 5 21:54:59 2017 (1507240499)\nBuild timestamp: 1507240499\nBuild timestamp as int: 1507240499\n\n\nGCC/Compiler version (if compiling from source): irrelevant\ntried both\n\ng++4.8\ng++5.0\n\n\nCUDA/cuDNN version: irrelevant\n\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2016 NVIDIA Corporation\nBuilt on Sun_Sep__4_22:14:01_CDT_2016\nCuda compilation tools, release 8.0, V8.0.44\n\n\nGPU model and memory: irrelevant\nExact command to reproduce:\n\ncd /tmp\nmkdir tf_issue\ncd tf_issue\nvirtualenv test\nsource test/bin/activate\npip install tensorflow # in some way: either tensorflow-gpu or from wheel package created by bazel\ngit clone https://github.com/cgtuebingen/tf_custom_op\ncd tf_custom_op\ncmake .\nmake\nDescribe the problem\nCompiling custom ops with\n#include \"tensorflow/core/util/cuda_kernel_helper.h\"\nfails due to missing files\n/code/lib/python2.7/site-packages/tensorflow/include/tensorflow/core/util/cuda_kernel_helper.h:24:31: fatal error: cuda/include/cuda.h: No such file or directory\n\nThis file cuda/include/cuda.h does not exists! Neither in the pip package nor in the git repository.\nRemoving #include \"tensorflow/core/util/cuda_kernel_helper.h\"\ngives plenty of other issues\n/code/kernels/matrix_add_kernel.cu(13): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\n/code/kernels/matrix_add_kernel.cu(59): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\n/code/kernels/matrix_add_kernel.cu(59): error: expected a \";\"\n/code/kernels/matrix_add_kernel.cu(63): error: identifier \"cfg\" is undefined\n/code/kernels/matrix_add_kernel.cu(88): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\n/code/kernels/matrix_add_kernel.cu(88): error: expected a \";\"\n/code/kernels/matrix_add_kernel.cu(92): error: identifier \"cfg\" is undefined\n\nAs I already wrote in a related issue #12860, the commit 2c598e8 is causing this issue by changing\n-#include \"third_party/gpus/cuda/include/cuda.h\"\n+#include \"cuda/include/cuda.h\"\nCopying the old cuda.h gives\n[...]/local/lib/python2.7/site-packages/tensorflow/include/tensorflow/core/platform/default/mutex.h:25:22: fatal error: nsync_cv.h: No such file or directory\n\nwhich does not exist, too.\nThis problem is not related to custom code, it is related to ignore/omitting files in commit 2c598e8\nAs mention in #12860, this affects many people. In fact, the entire way of writing customs ops with CUDA seems to be broken. Copying own source-code to the TensorFlow-repo was not necessary until TF1.3. Interestingly, even recent NIPS paper implementations state in their readme, they only support TFv1.2. I don't think the proposed workaround of downgrading to TFv1.2 should be the way to go.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes, I followed the official documentation for custom operations.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n\r\n```\r\nLinux pc 4.4.0-81-generic #104-Ubuntu SMP Wed Jun 14 08:17:06 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n- **TensorFlow installed from (source or binary)**:\r\n  tried both\r\n- **TensorFlow version (use command below)**:\r\n\r\n| version                               | status        | comment |\r\n| -------------                         | ------------- | -----|\r\n| ('v1.2.0-rc1-7529-g8a4d849', '1.4.0') | not working   | from pip or from source |\r\n| ('v1.2.0-rc2-21-g12f033d', '1.2.0')   | working       | from [pypip](https://pypi.python.org/packages/4b/d3/d4fe94f4f370fbb3790444b8f0a007298a795c447e195d88a066de04930d/tensorflow-1.2.0-cp27-cp27mu-manylinux1_x86_64.whl#md5=7e1640384dfd705e17b2f668c1b0427b) |\r\n\r\n- **Python version**: 2.7 (*irrelevant*)\r\n- **Bazel version (if compiling from source)**:\r\n\r\n```\r\nBuild label: 0.6.1\r\nBuild target: bazel-out/local-fastbuild/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Thu Oct 5 21:54:59 2017 (1507240499)\r\nBuild timestamp: 1507240499\r\nBuild timestamp as int: 1507240499\r\n```\r\n\r\n- **GCC/Compiler version (if compiling from source)**: *irrelevant*\r\n  tried both\r\n  - g++4.8\r\n  - g++5.0\r\n- **CUDA/cuDNN version**: *irrelevant*\r\n\r\n```\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2016 NVIDIA Corporation\r\nBuilt on Sun_Sep__4_22:14:01_CDT_2016\r\nCuda compilation tools, release 8.0, V8.0.44\r\n```\r\n\r\n- **GPU model and memory**: irrelevant\r\n- **Exact command to reproduce**:\r\n\r\n```bash\r\ncd /tmp\r\nmkdir tf_issue\r\ncd tf_issue\r\nvirtualenv test\r\nsource test/bin/activate\r\npip install tensorflow # in some way: either tensorflow-gpu or from wheel package created by bazel\r\ngit clone https://github.com/cgtuebingen/tf_custom_op\r\ncd tf_custom_op\r\ncmake .\r\nmake\r\n```\r\n\r\n### Describe the problem\r\nCompiling custom ops with\r\n\r\n```cpp\r\n#include \"tensorflow/core/util/cuda_kernel_helper.h\"\r\n```\r\n\r\nfails due to missing files\r\n\r\n\r\n```\r\n/code/lib/python2.7/site-packages/tensorflow/include/tensorflow/core/util/cuda_kernel_helper.h:24:31: fatal error: cuda/include/cuda.h: No such file or directory\r\n```\r\n\r\nThis file `cuda/include/cuda.h` does not exists! Neither in the pip package nor in the git repository.\r\nRemoving `#include \"tensorflow/core/util/cuda_kernel_helper.h\"` \r\n\r\ngives plenty of other issues\r\n\r\n```\r\n/code/kernels/matrix_add_kernel.cu(13): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\r\n/code/kernels/matrix_add_kernel.cu(59): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\r\n/code/kernels/matrix_add_kernel.cu(59): error: expected a \";\"\r\n/code/kernels/matrix_add_kernel.cu(63): error: identifier \"cfg\" is undefined\r\n/code/kernels/matrix_add_kernel.cu(88): error: namespace \"tensorflow\" has no member \"CudaLaunchConfig\"\r\n/code/kernels/matrix_add_kernel.cu(88): error: expected a \";\"\r\n/code/kernels/matrix_add_kernel.cu(92): error: identifier \"cfg\" is undefined\r\n```\r\n\r\nAs I already wrote in a related issue #12860, the commit 2c598e874e6a7b6b3185846ce9bac97a7d5d0169 is causing this issue by changing\r\n\r\n```diff\r\n-#include \"third_party/gpus/cuda/include/cuda.h\"\r\n+#include \"cuda/include/cuda.h\"\r\n```\r\n\r\nCopying the old `cuda.h` gives\r\n\r\n```\r\n[...]/local/lib/python2.7/site-packages/tensorflow/include/tensorflow/core/platform/default/mutex.h:25:22: fatal error: nsync_cv.h: No such file or directory\r\n```\r\n\r\nwhich does not exist, too.\r\n\r\nThis problem is not related to custom code, it is related to ignore/omitting files in commit 2c598e874e6a7b6b3185846ce9bac97a7d5d0169\r\n\r\nAs mention in #12860, this affects many people. In fact, the entire way of writing customs ops with CUDA seems to be broken. Copying own source-code to the TensorFlow-repo was not necessary until TF1.3. Interestingly, even recent NIPS paper implementations state in their readme, they only support TFv1.2. I don't think the proposed workaround of downgrading to TFv1.2 should be the way to go."}