{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19119", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19119/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19119/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19119/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19119", "id": 320640648, "node_id": "MDU6SXNzdWUzMjA2NDA2NDg=", "number": 19119, "title": "Cannot build tensorflow on Windows 10 CUDA", "user": {"login": "Duskfall", "id": 2528125, "node_id": "MDQ6VXNlcjI1MjgxMjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2528125?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Duskfall", "html_url": "https://github.com/Duskfall", "followers_url": "https://api.github.com/users/Duskfall/followers", "following_url": "https://api.github.com/users/Duskfall/following{/other_user}", "gists_url": "https://api.github.com/users/Duskfall/gists{/gist_id}", "starred_url": "https://api.github.com/users/Duskfall/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Duskfall/subscriptions", "organizations_url": "https://api.github.com/users/Duskfall/orgs", "repos_url": "https://api.github.com/users/Duskfall/repos", "events_url": "https://api.github.com/users/Duskfall/events{/privacy}", "received_events_url": "https://api.github.com/users/Duskfall/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-05-06T23:58:16Z", "updated_at": "2018-10-31T16:16:55Z", "closed_at": "2018-10-31T16:16:55Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Windows 10</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.8 or master ( tried both)</li>\n<li><strong>Python version</strong>: 3.6.4</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.13.0</li>\n<li><strong>Cmake version (if compiling from source)</strong>: 3.10.1</li>\n<li><strong>CUDA/cuDNN version</strong>: 9.1/7.1</li>\n<li><strong>GPU model and memory</strong>: GTX 1080 Ti</li>\n<li><strong>Exact command to reproduce</strong>:<br>\ncmake -T host=x64 -DCMAKE_BUILD_TYPE=Release -DSWIG_EXECUTABLE=c:/swigwin-3.0.12/swig.exe -Dtensorflow_ENABLE_GPU=ON -Dtensorflow_CUDA_VERSION=9.1 -Dtensorflow_CUDNN_VERSION=7.1 -DCUDNN_HOME=\"C:\\cudnn-9.1-windows10-x64-v7.1\\cuda\" ..</li>\n</ul>\n<p>Notes: -DCUDNN_HOME line could be skipped since it is already installed inside cuda 9.1 folder but tried different ones too</p>\n<p>MSBuild /p:Configuration=Release /verbosity:detailed tf_python_build_pip_package.vcxproj</p>\n<p>Build fails, I suppose warnings are fine, but what am I missing?<br>\nI need to build tensorflow because my CPU doesn't use AVX instructions (Intel Xeon 5670) and since I want to use GPU for this I only want to focus on CUDA build.</p>\n<p>I have also tried with bazel:</p>\n<pre><code>$ ./configure\nYou have bazel 0.13.0 installed.\nPlease specify the location of python. [Default is D:\\Miniconda3\\python.exe]:\n\n\nFound possible Python library paths:\n  D:\\Miniconda3\\lib\\site-packages\nPlease input the desired Python library path to use.  Default is [D:\\Miniconda3\\                               lib\\site-packages]\n\nDo you wish to build TensorFlow with XLA JIT support? [y/N]:\nNo XLA JIT support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with GDR support? [y/N]:\nNo GDR support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with VERBS support? [y/N]:\nNo VERBS support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\nCUDA support will be enabled for TensorFlow.\n\nPlease specify the CUDA SDK version you want to use, e.g. 7.0. [Leave empty to d                               efault to CUDA 9.0]: 9.1\n\n\nPlease specify the location where CUDA 9.1 toolkit is installed. Refer to README                               .md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/                               CUDA/v9.1]:\n\n\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuD                               NN 7.0]: 7.1\n\n\nPlease specify the location where cuDNN 7 library is installed. Refer to README.                               md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/C                               UDA/v9.1]:\n\n\nPlease specify a list of comma-separated Cuda compute capabilities you want to b                               uild with.\nYou can find the compute capability of your device at: https://developer.nvidia.                               com/cuda-gpus.\nPlease note that each additional compute capability significantly increases your                                build time and binary size. [Default is: 3.5,5.2]6.1\n\n\nDo you wish to build TensorFlow with MPI support? [y/N]:\nNo MPI support will be enabled for TensorFlow.\n\nPlease specify optimization flags to use during compilation when bazel option \"-                               -config=opt\" is specified [Default is /arch:AVX]:\n\n\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]:                               \nNot configuring the WORKSPACE for Android builds.\n\nPreconfigured Bazel build configs. You can use any of the below by adding \"--con                               fig=&lt;&gt;\" to your build command. See tools/bazel.rc for more details.\n        --config=mkl            # Build with MKL support.\n        --config=monolithic     # Config for mostly static monolithic build.\nConfiguration finished\n\natro@atro-PC MINGW64 /c/tensorflow (master)\n$\n\natro@atro-PC MINGW64 /c/tensorflow (master)\n$ bazel build --config=opt --config=win-cuda //tensorflow/tools/pip_package:buil                               d_pip_package\nStarting local Bazel server and connecting to it...\n.................\nWARNING: The following configs were expanded more than once: [win-cuda]. For rep                               eatable flags, repeats are counted twice and may lead to unexpected behavior.\nLoading:\nLoading: 0 packages loaded\nLoading: 0 packages loaded\n    currently loading: tensorflow/tools/pip_package\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (1 packages l                               oaded)\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/protobuf_archive/WORKSPACE:                               1: Workspace name in C:/users/atro/_bazel_atro/x1e5egqw/external/protobuf_archiv                               e/WORKSPACE (@com_google_protobuf) does not match the name given in the reposito                               ry's definition (@protobuf_archive); this will cause a build error in future ver                               sions\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/WORKSPACE:1: Workspace                                name in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/WORKSPACE (@com_github                               _grpc_grpc) does not match the name given in the repository's definition (@grpc)                               ; this will cause a build error in future versions\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/absl_py/WORKSPACE:1: Worksp                               ace name in C:/users/atro/_bazel_atro/x1e5egqw/external/absl_py/WORKSPACE (@io_a                               bseil_py) does not match the name given in the repository's definition (@absl_py                               ); this will cause a build error in future versions\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (76 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (124 packages                                loaded)\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_common.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_decode.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_encode.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (134 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (145 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (160 packages                                loaded)\nWARNING: C:/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule /                               /tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depen                               ds on deprecated target '//tensorflow/contrib/session_bundle:exporter': No longe                               r supported. Switch to SavedModel immediately.\nWARNING: C:/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule /                               /tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depen                               ds on deprecated target '//tensorflow/contrib/session_bundle:gc': No longer supp                               orted. Switch to SavedModel immediately.\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (256 packages                                loaded)\nINFO: Analysed target //tensorflow/tools/pip_package:build_pip_package (257 pack                               ages loaded).\nINFO: Found 1 target...\nBuilding: no action\n[2 / 19] [-----] BazelWorkspaceStatusAction stable-status.txt\nERROR: C:/tensorflow/tensorflow/core/BUILD:1800:1: C++ compilation of rule '//tensorflow/core:lib_hash_crc32c_accelerate_internal' failed (Exit 2): cl.exe failed: error executing command\n  cd C:/users/atro/_bazel_atro/x1e5egqw/execroot/org_tensorflow\n  SET INCLUDE=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\ucrt;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\include\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\shared;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\winrt;\n    SET LIB=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\LIB\\amd64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\LIB\\amd64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\ucrt\\x64;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\lib\\um\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\um\\x64;\n    SET PATH=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\amd64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\VCPackages;C:\\WINDOWS\\Microsoft.NET\\Framework64\\v4.0.30319;C:\\WINDOWS\\Microsoft.NET\\Framework64\\;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x86;C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.6.1 Tools\\x64\\;;C:\\WINDOWS\\system32\n    SET PWD=/proc/self/cwd\n    SET TEMP=C:\\Users\\atro\\AppData\\Local\\Temp\n    SET TMP=C:\\Users\\atro\\AppData\\Local\\Temp\n  C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/amd64/cl.exe /c tensorflow/core/lib/hash/crc32c_accelerate.cc /Fobazel-out/host/bin/tensorflow/core/_objs/lib_hash_crc32c_accelerate_internal/tensorflow/core/lib/hash/crc32c_accelerate.o /nologo /DCOMPILER_MSVC /DNOMINMAX /D_WIN32_WINNT=0x0600 /D_CRT_SECURE_NO_DEPRECATE /D_CRT_SECURE_NO_WARNINGS /D_SILENCE_STDEXT_HASH_DEPRECATION_WARNINGS /bigobj /Zm500 /J /Gy /GF /EHsc /wd4351 /wd4291 /wd4250 /wd4996 /I. /Ibazel-out/host/genfiles /Iexternal/bazel_tools /Ibazel-out/host/genfiles/external/bazel_tools /showIncludes /MD /O2 /DNDEBUG -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK -w -DGOOGLE_CUDA=1 -DTENSORFLOW_MONOLITHIC_BUILD /DPLATFORM_WINDOWS /DEIGEN_HAS_C99_MATH /DTENSORFLOW_USE_EIGEN_THREADPOOL /DEIGEN_AVOID_STL_ARRAY /Iexternal/gemmlowp /wd4018 /U_HAS_EXCEPTIONS /D_HAS_EXCEPTIONS=1 /EHsc /DNOGDI /DTF_COMPILE_LIBRARY\ntensorflow/core/lib/hash/crc32c_accelerate.cc(16): fatal error C1083: Cannot open include file: 'stddef.h': No such file or directory\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 20.360s, Critical Path: 0.32s\nINFO: 0 processes.\nFAILED: Build did NOT complete successfully\n</code></pre>\n<h3>Source code / logs</h3>\n<p>Attached is the complete msbuild log.<br>\n<a href=\"https://github.com/tensorflow/tensorflow/files/1978158/msbuild.zip\">msbuild.zip</a></p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.8 or master ( tried both)\nPython version: 3.6.4\nBazel version (if compiling from source): 0.13.0\nCmake version (if compiling from source): 3.10.1\nCUDA/cuDNN version: 9.1/7.1\nGPU model and memory: GTX 1080 Ti\nExact command to reproduce:\ncmake -T host=x64 -DCMAKE_BUILD_TYPE=Release -DSWIG_EXECUTABLE=c:/swigwin-3.0.12/swig.exe -Dtensorflow_ENABLE_GPU=ON -Dtensorflow_CUDA_VERSION=9.1 -Dtensorflow_CUDNN_VERSION=7.1 -DCUDNN_HOME=\"C:\\cudnn-9.1-windows10-x64-v7.1\\cuda\" ..\n\nNotes: -DCUDNN_HOME line could be skipped since it is already installed inside cuda 9.1 folder but tried different ones too\nMSBuild /p:Configuration=Release /verbosity:detailed tf_python_build_pip_package.vcxproj\nBuild fails, I suppose warnings are fine, but what am I missing?\nI need to build tensorflow because my CPU doesn't use AVX instructions (Intel Xeon 5670) and since I want to use GPU for this I only want to focus on CUDA build.\nI have also tried with bazel:\n$ ./configure\nYou have bazel 0.13.0 installed.\nPlease specify the location of python. [Default is D:\\Miniconda3\\python.exe]:\n\n\nFound possible Python library paths:\n  D:\\Miniconda3\\lib\\site-packages\nPlease input the desired Python library path to use.  Default is [D:\\Miniconda3\\                               lib\\site-packages]\n\nDo you wish to build TensorFlow with XLA JIT support? [y/N]:\nNo XLA JIT support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with GDR support? [y/N]:\nNo GDR support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with VERBS support? [y/N]:\nNo VERBS support will be enabled for TensorFlow.\n\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\nCUDA support will be enabled for TensorFlow.\n\nPlease specify the CUDA SDK version you want to use, e.g. 7.0. [Leave empty to d                               efault to CUDA 9.0]: 9.1\n\n\nPlease specify the location where CUDA 9.1 toolkit is installed. Refer to README                               .md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/                               CUDA/v9.1]:\n\n\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuD                               NN 7.0]: 7.1\n\n\nPlease specify the location where cuDNN 7 library is installed. Refer to README.                               md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/C                               UDA/v9.1]:\n\n\nPlease specify a list of comma-separated Cuda compute capabilities you want to b                               uild with.\nYou can find the compute capability of your device at: https://developer.nvidia.                               com/cuda-gpus.\nPlease note that each additional compute capability significantly increases your                                build time and binary size. [Default is: 3.5,5.2]6.1\n\n\nDo you wish to build TensorFlow with MPI support? [y/N]:\nNo MPI support will be enabled for TensorFlow.\n\nPlease specify optimization flags to use during compilation when bazel option \"-                               -config=opt\" is specified [Default is /arch:AVX]:\n\n\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]:                               \nNot configuring the WORKSPACE for Android builds.\n\nPreconfigured Bazel build configs. You can use any of the below by adding \"--con                               fig=<>\" to your build command. See tools/bazel.rc for more details.\n        --config=mkl            # Build with MKL support.\n        --config=monolithic     # Config for mostly static monolithic build.\nConfiguration finished\n\natro@atro-PC MINGW64 /c/tensorflow (master)\n$\n\natro@atro-PC MINGW64 /c/tensorflow (master)\n$ bazel build --config=opt --config=win-cuda //tensorflow/tools/pip_package:buil                               d_pip_package\nStarting local Bazel server and connecting to it...\n.................\nWARNING: The following configs were expanded more than once: [win-cuda]. For rep                               eatable flags, repeats are counted twice and may lead to unexpected behavior.\nLoading:\nLoading: 0 packages loaded\nLoading: 0 packages loaded\n    currently loading: tensorflow/tools/pip_package\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (1 packages l                               oaded)\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/protobuf_archive/WORKSPACE:                               1: Workspace name in C:/users/atro/_bazel_atro/x1e5egqw/external/protobuf_archiv                               e/WORKSPACE (@com_google_protobuf) does not match the name given in the reposito                               ry's definition (@protobuf_archive); this will cause a build error in future ver                               sions\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/WORKSPACE:1: Workspace                                name in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/WORKSPACE (@com_github                               _grpc_grpc) does not match the name given in the repository's definition (@grpc)                               ; this will cause a build error in future versions\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/absl_py/WORKSPACE:1: Worksp                               ace name in C:/users/atro/_bazel_atro/x1e5egqw/external/absl_py/WORKSPACE (@io_a                               bseil_py) does not match the name given in the repository's definition (@absl_py                               ); this will cause a build error in future versions\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (76 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (124 packages                                loaded)\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_common.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_decode.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_encode.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (134 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (145 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages                                loaded)\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (160 packages                                loaded)\nWARNING: C:/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule /                               /tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depen                               ds on deprecated target '//tensorflow/contrib/session_bundle:exporter': No longe                               r supported. Switch to SavedModel immediately.\nWARNING: C:/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule /                               /tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depen                               ds on deprecated target '//tensorflow/contrib/session_bundle:gc': No longer supp                               orted. Switch to SavedModel immediately.\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (256 packages                                loaded)\nINFO: Analysed target //tensorflow/tools/pip_package:build_pip_package (257 pack                               ages loaded).\nINFO: Found 1 target...\nBuilding: no action\n[2 / 19] [-----] BazelWorkspaceStatusAction stable-status.txt\nERROR: C:/tensorflow/tensorflow/core/BUILD:1800:1: C++ compilation of rule '//tensorflow/core:lib_hash_crc32c_accelerate_internal' failed (Exit 2): cl.exe failed: error executing command\n  cd C:/users/atro/_bazel_atro/x1e5egqw/execroot/org_tensorflow\n  SET INCLUDE=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\ucrt;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\include\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\shared;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\winrt;\n    SET LIB=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\LIB\\amd64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\LIB\\amd64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\ucrt\\x64;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\lib\\um\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\um\\x64;\n    SET PATH=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\amd64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\VCPackages;C:\\WINDOWS\\Microsoft.NET\\Framework64\\v4.0.30319;C:\\WINDOWS\\Microsoft.NET\\Framework64\\;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x86;C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.6.1 Tools\\x64\\;;C:\\WINDOWS\\system32\n    SET PWD=/proc/self/cwd\n    SET TEMP=C:\\Users\\atro\\AppData\\Local\\Temp\n    SET TMP=C:\\Users\\atro\\AppData\\Local\\Temp\n  C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/amd64/cl.exe /c tensorflow/core/lib/hash/crc32c_accelerate.cc /Fobazel-out/host/bin/tensorflow/core/_objs/lib_hash_crc32c_accelerate_internal/tensorflow/core/lib/hash/crc32c_accelerate.o /nologo /DCOMPILER_MSVC /DNOMINMAX /D_WIN32_WINNT=0x0600 /D_CRT_SECURE_NO_DEPRECATE /D_CRT_SECURE_NO_WARNINGS /D_SILENCE_STDEXT_HASH_DEPRECATION_WARNINGS /bigobj /Zm500 /J /Gy /GF /EHsc /wd4351 /wd4291 /wd4250 /wd4996 /I. /Ibazel-out/host/genfiles /Iexternal/bazel_tools /Ibazel-out/host/genfiles/external/bazel_tools /showIncludes /MD /O2 /DNDEBUG -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK -w -DGOOGLE_CUDA=1 -DTENSORFLOW_MONOLITHIC_BUILD /DPLATFORM_WINDOWS /DEIGEN_HAS_C99_MATH /DTENSORFLOW_USE_EIGEN_THREADPOOL /DEIGEN_AVOID_STL_ARRAY /Iexternal/gemmlowp /wd4018 /U_HAS_EXCEPTIONS /D_HAS_EXCEPTIONS=1 /EHsc /DNOGDI /DTF_COMPILE_LIBRARY\ntensorflow/core/lib/hash/crc32c_accelerate.cc(16): fatal error C1083: Cannot open include file: 'stddef.h': No such file or directory\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 20.360s, Critical Path: 0.32s\nINFO: 0 processes.\nFAILED: Build did NOT complete successfully\n\nSource code / logs\nAttached is the complete msbuild log.\nmsbuild.zip", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.8 or master ( tried both)\r\n- **Python version**: 3.6.4\r\n- **Bazel version (if compiling from source)**: 0.13.0\r\n- **Cmake version (if compiling from source)**: 3.10.1\r\n- **CUDA/cuDNN version**: 9.1/7.1\r\n- **GPU model and memory**: GTX 1080 Ti\r\n- **Exact command to reproduce**: \r\ncmake -T host=x64 -DCMAKE_BUILD_TYPE=Release -DSWIG_EXECUTABLE=c:/swigwin-3.0.12/swig.exe -Dtensorflow_ENABLE_GPU=ON -Dtensorflow_CUDA_VERSION=9.1 -Dtensorflow_CUDNN_VERSION=7.1 -DCUDNN_HOME=\"C:\\cudnn-9.1-windows10-x64-v7.1\\cuda\" ..\r\n\r\nNotes: -DCUDNN_HOME line could be skipped since it is already installed inside cuda 9.1 folder but tried different ones too\r\n\r\nMSBuild /p:Configuration=Release /verbosity:detailed tf_python_build_pip_package.vcxproj\r\n\r\nBuild fails, I suppose warnings are fine, but what am I missing?\r\nI need to build tensorflow because my CPU doesn't use AVX instructions (Intel Xeon 5670) and since I want to use GPU for this I only want to focus on CUDA build.\r\n\r\nI have also tried with bazel:\r\n````\r\n$ ./configure\r\nYou have bazel 0.13.0 installed.\r\nPlease specify the location of python. [Default is D:\\Miniconda3\\python.exe]:\r\n\r\n\r\nFound possible Python library paths:\r\n  D:\\Miniconda3\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [D:\\Miniconda3\\                               lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]:\r\nNo XLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with GDR support? [y/N]:\r\nNo GDR support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with VERBS support? [y/N]:\r\nNo VERBS support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify the CUDA SDK version you want to use, e.g. 7.0. [Leave empty to d                               efault to CUDA 9.0]: 9.1\r\n\r\n\r\nPlease specify the location where CUDA 9.1 toolkit is installed. Refer to README                               .md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/                               CUDA/v9.1]:\r\n\r\n\r\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuD                               NN 7.0]: 7.1\r\n\r\n\r\nPlease specify the location where cuDNN 7 library is installed. Refer to README.                               md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/C                               UDA/v9.1]:\r\n\r\n\r\nPlease specify a list of comma-separated Cuda compute capabilities you want to b                               uild with.\r\nYou can find the compute capability of your device at: https://developer.nvidia.                               com/cuda-gpus.\r\nPlease note that each additional compute capability significantly increases your                                build time and binary size. [Default is: 3.5,5.2]6.1\r\n\r\n\r\nDo you wish to build TensorFlow with MPI support? [y/N]:\r\nNo MPI support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"-                               -config=opt\" is specified [Default is /arch:AVX]:\r\n\r\n\r\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]:                               \r\nNot configuring the WORKSPACE for Android builds.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--con                               fig=<>\" to your build command. See tools/bazel.rc for more details.\r\n        --config=mkl            # Build with MKL support.\r\n        --config=monolithic     # Config for mostly static monolithic build.\r\nConfiguration finished\r\n\r\natro@atro-PC MINGW64 /c/tensorflow (master)\r\n$\r\n\r\natro@atro-PC MINGW64 /c/tensorflow (master)\r\n$ bazel build --config=opt --config=win-cuda //tensorflow/tools/pip_package:buil                               d_pip_package\r\nStarting local Bazel server and connecting to it...\r\n.................\r\nWARNING: The following configs were expanded more than once: [win-cuda]. For rep                               eatable flags, repeats are counted twice and may lead to unexpected behavior.\r\nLoading:\r\nLoading: 0 packages loaded\r\nLoading: 0 packages loaded\r\n    currently loading: tensorflow/tools/pip_package\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (1 packages l                               oaded)\r\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/protobuf_archive/WORKSPACE:                               1: Workspace name in C:/users/atro/_bazel_atro/x1e5egqw/external/protobuf_archiv                               e/WORKSPACE (@com_google_protobuf) does not match the name given in the reposito                               ry's definition (@protobuf_archive); this will cause a build error in future ver                               sions\r\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/WORKSPACE:1: Workspace                                name in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/WORKSPACE (@com_github                               _grpc_grpc) does not match the name given in the repository's definition (@grpc)                               ; this will cause a build error in future versions\r\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/absl_py/WORKSPACE:1: Worksp                               ace name in C:/users/atro/_bazel_atro/x1e5egqw/external/absl_py/WORKSPACE (@io_a                               bseil_py) does not match the name given in the repository's definition (@absl_py                               ); this will cause a build error in future versions\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (76 packages                                loaded)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (124 packages                                loaded)\r\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_common.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\r\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_decode.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\r\nWARNING: C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/BUILD:1960:1: in srcs                                attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//t                               hird_party/nanopb:pb_encode.c' directly. You should either move the file to this                                package or depend on an appropriate rule there. Since this rule was created by                                the macro 'grpc_generate_one_off_targets', the error might have been caused by t                               he macro implementation in C:/users/atro/_bazel_atro/x1e5egqw/external/grpc/baze                               l/grpc_build_system.bzl:172:12\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (134 packages                                loaded)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (145 packages                                loaded)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (149 packages                                loaded)\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (160 packages                                loaded)\r\nWARNING: C:/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule /                               /tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depen                               ds on deprecated target '//tensorflow/contrib/session_bundle:exporter': No longe                               r supported. Switch to SavedModel immediately.\r\nWARNING: C:/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule /                               /tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depen                               ds on deprecated target '//tensorflow/contrib/session_bundle:gc': No longer supp                               orted. Switch to SavedModel immediately.\r\nAnalyzing: target //tensorflow/tools/pip_package:build_pip_package (256 packages                                loaded)\r\nINFO: Analysed target //tensorflow/tools/pip_package:build_pip_package (257 pack                               ages loaded).\r\nINFO: Found 1 target...\r\nBuilding: no action\r\n[2 / 19] [-----] BazelWorkspaceStatusAction stable-status.txt\r\nERROR: C:/tensorflow/tensorflow/core/BUILD:1800:1: C++ compilation of rule '//tensorflow/core:lib_hash_crc32c_accelerate_internal' failed (Exit 2): cl.exe failed: error executing command\r\n  cd C:/users/atro/_bazel_atro/x1e5egqw/execroot/org_tensorflow\r\n  SET INCLUDE=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\ucrt;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\include\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\shared;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.15063.0\\winrt;\r\n    SET LIB=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\LIB\\amd64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\LIB\\amd64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\ucrt\\x64;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\lib\\um\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\um\\x64;\r\n    SET PATH=C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\amd64;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\VCPackages;C:\\WINDOWS\\Microsoft.NET\\Framework64\\v4.0.30319;C:\\WINDOWS\\Microsoft.NET\\Framework64\\;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x86;C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.6.1 Tools\\x64\\;;C:\\WINDOWS\\system32\r\n    SET PWD=/proc/self/cwd\r\n    SET TEMP=C:\\Users\\atro\\AppData\\Local\\Temp\r\n    SET TMP=C:\\Users\\atro\\AppData\\Local\\Temp\r\n  C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/amd64/cl.exe /c tensorflow/core/lib/hash/crc32c_accelerate.cc /Fobazel-out/host/bin/tensorflow/core/_objs/lib_hash_crc32c_accelerate_internal/tensorflow/core/lib/hash/crc32c_accelerate.o /nologo /DCOMPILER_MSVC /DNOMINMAX /D_WIN32_WINNT=0x0600 /D_CRT_SECURE_NO_DEPRECATE /D_CRT_SECURE_NO_WARNINGS /D_SILENCE_STDEXT_HASH_DEPRECATION_WARNINGS /bigobj /Zm500 /J /Gy /GF /EHsc /wd4351 /wd4291 /wd4250 /wd4996 /I. /Ibazel-out/host/genfiles /Iexternal/bazel_tools /Ibazel-out/host/genfiles/external/bazel_tools /showIncludes /MD /O2 /DNDEBUG -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK -w -DGOOGLE_CUDA=1 -DTENSORFLOW_MONOLITHIC_BUILD /DPLATFORM_WINDOWS /DEIGEN_HAS_C99_MATH /DTENSORFLOW_USE_EIGEN_THREADPOOL /DEIGEN_AVOID_STL_ARRAY /Iexternal/gemmlowp /wd4018 /U_HAS_EXCEPTIONS /D_HAS_EXCEPTIONS=1 /EHsc /DNOGDI /DTF_COMPILE_LIBRARY\r\ntensorflow/core/lib/hash/crc32c_accelerate.cc(16): fatal error C1083: Cannot open include file: 'stddef.h': No such file or directory\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 20.360s, Critical Path: 0.32s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully\r\n````\r\n\r\n### Source code / logs\r\nAttached is the complete msbuild log. \r\n[msbuild.zip](https://github.com/tensorflow/tensorflow/files/1978158/msbuild.zip)\r\n"}