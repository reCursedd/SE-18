{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21759", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21759/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21759/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21759/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21759", "id": 352499082, "node_id": "MDU6SXNzdWUzNTI0OTkwODI=", "number": 21759, "title": "tf.placeholder changes random number sequence generated by a seed", "user": {"login": "pratham16", "id": 4096433, "node_id": "MDQ6VXNlcjQwOTY0MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/4096433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pratham16", "html_url": "https://github.com/pratham16", "followers_url": "https://api.github.com/users/pratham16/followers", "following_url": "https://api.github.com/users/pratham16/following{/other_user}", "gists_url": "https://api.github.com/users/pratham16/gists{/gist_id}", "starred_url": "https://api.github.com/users/pratham16/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pratham16/subscriptions", "organizations_url": "https://api.github.com/users/pratham16/orgs", "repos_url": "https://api.github.com/users/pratham16/repos", "events_url": "https://api.github.com/users/pratham16/events{/privacy}", "received_events_url": "https://api.github.com/users/pratham16/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rohan100jain", "id": 144114, "node_id": "MDQ6VXNlcjE0NDExNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/144114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan100jain", "html_url": "https://github.com/rohan100jain", "followers_url": "https://api.github.com/users/rohan100jain/followers", "following_url": "https://api.github.com/users/rohan100jain/following{/other_user}", "gists_url": "https://api.github.com/users/rohan100jain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan100jain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan100jain/subscriptions", "organizations_url": "https://api.github.com/users/rohan100jain/orgs", "repos_url": "https://api.github.com/users/rohan100jain/repos", "events_url": "https://api.github.com/users/rohan100jain/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan100jain/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-08-21T11:33:35Z", "updated_at": "2018-08-22T20:08:16Z", "closed_at": "2018-08-22T20:08:16Z", "author_association": "NONE", "body_html": "<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow):</strong><br>\nYes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04):</strong><br>\nDebian Buster (Debian 10)</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:</strong><br>\nN/A</li>\n<li><strong>TensorFlow installed from (source or binary):</strong><br>\nN/A</li>\n<li><strong>TensorFlow version (use command below):</strong><br>\n1.8.0</li>\n<li><strong>Python version:</strong><br>\n2.7.14</li>\n<li><strong>Bazel version (if compiling from source):</strong><br>\nN/A</li>\n<li><strong>GCC/Compiler version (if compiling from source):</strong><br>\n7.3.0</li>\n<li><strong>CUDA/cuDNN version:</strong><br>\nN/A</li>\n<li><strong>GPU model and memory:</strong><br>\nN/A</li>\n<li><strong>Exact command to reproduce:</strong><br>\nN/A</li>\n</ul>\n<p>Here's the code to test. Inserting a placeholder changes the sequence of <code>a</code> and <code>b</code>.</p>\n<div class=\"highlight highlight-source-python\"><pre>tf.set_random_seed(<span class=\"pl-c1\">1234</span>)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>c = tf.placeholder(dtype=tf.float32, shape=[10,10])</span>\na <span class=\"pl-k\">=</span> tf.random_uniform([<span class=\"pl-c1\">1</span>])\nb <span class=\"pl-k\">=</span> tf.random_normal([<span class=\"pl-c1\">1</span>])\n\n<span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Session 1<span class=\"pl-pds\">\"</span></span>)\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess1:\n  <span class=\"pl-c1\">print</span>(sess1.run(a))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'A1'</span>\n  <span class=\"pl-c1\">print</span>(sess1.run(a))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'A2'</span>\n  <span class=\"pl-c1\">print</span>(sess1.run(b))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'B1'</span>\n  <span class=\"pl-c1\">print</span>(sess1.run(b))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'B2'</span>\n\n<span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Session 2<span class=\"pl-pds\">\"</span></span>)\n<span class=\"pl-k\">with</span> tf.Session() <span class=\"pl-k\">as</span> sess2:\n  <span class=\"pl-c1\">print</span>(sess2.run(a))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'A1'</span>\n  <span class=\"pl-c1\">print</span>(sess2.run(a))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'A2'</span>\n  <span class=\"pl-c1\">print</span>(sess2.run(b))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'B1'</span>\n  <span class=\"pl-c1\">print</span>(sess2.run(b))  <span class=\"pl-c\"><span class=\"pl-c\">#</span> generates 'B2'</span></pre></div>\n<p>Few Observations -</p>\n<ol>\n<li>I tried adding the line <code>c = tf.placeholder(dtype=tf.float32, shape=[10,10])</code> before and after <code>tf.set_random_seed(1234)</code>. The issue persists.</li>\n<li>Insertion of placeholder does not affect the outcome when op level seed is set.</li>\n</ol>\n<p>Does the placeholder affect the sequence in which random numbers are generated by graph level seed?</p>", "body_text": "Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nDebian Buster (Debian 10)\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\nN/A\nTensorFlow installed from (source or binary):\nN/A\nTensorFlow version (use command below):\n1.8.0\nPython version:\n2.7.14\nBazel version (if compiling from source):\nN/A\nGCC/Compiler version (if compiling from source):\n7.3.0\nCUDA/cuDNN version:\nN/A\nGPU model and memory:\nN/A\nExact command to reproduce:\nN/A\n\nHere's the code to test. Inserting a placeholder changes the sequence of a and b.\ntf.set_random_seed(1234)\n#c = tf.placeholder(dtype=tf.float32, shape=[10,10])\na = tf.random_uniform([1])\nb = tf.random_normal([1])\n\nprint(\"Session 1\")\nwith tf.Session() as sess1:\n  print(sess1.run(a))  # generates 'A1'\n  print(sess1.run(a))  # generates 'A2'\n  print(sess1.run(b))  # generates 'B1'\n  print(sess1.run(b))  # generates 'B2'\n\nprint(\"Session 2\")\nwith tf.Session() as sess2:\n  print(sess2.run(a))  # generates 'A1'\n  print(sess2.run(a))  # generates 'A2'\n  print(sess2.run(b))  # generates 'B1'\n  print(sess2.run(b))  # generates 'B2'\nFew Observations -\n\nI tried adding the line c = tf.placeholder(dtype=tf.float32, shape=[10,10]) before and after tf.set_random_seed(1234). The issue persists.\nInsertion of placeholder does not affect the outcome when op level seed is set.\n\nDoes the placeholder affect the sequence in which random numbers are generated by graph level seed?", "body": "- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow):**\r\nYes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04):**\r\nDebian Buster (Debian 10)\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:**\r\nN/A\r\n- **TensorFlow installed from (source or binary):**\r\nN/A\r\n- **TensorFlow version (use command below):**\r\n1.8.0\r\n- **Python version:**\r\n2.7.14\r\n- **Bazel version (if compiling from source):**\r\nN/A\r\n- **GCC/Compiler version (if compiling from source):**\r\n7.3.0\r\n- **CUDA/cuDNN version:**\r\nN/A\r\n- **GPU model and memory:**\r\nN/A\r\n- **Exact command to reproduce:**\r\nN/A\r\n\r\nHere's the code to test. Inserting a placeholder changes the sequence of `a` and `b`.\r\n``` python\r\ntf.set_random_seed(1234)\r\n#c = tf.placeholder(dtype=tf.float32, shape=[10,10])\r\na = tf.random_uniform([1])\r\nb = tf.random_normal([1])\r\n\r\nprint(\"Session 1\")\r\nwith tf.Session() as sess1:\r\n  print(sess1.run(a))  # generates 'A1'\r\n  print(sess1.run(a))  # generates 'A2'\r\n  print(sess1.run(b))  # generates 'B1'\r\n  print(sess1.run(b))  # generates 'B2'\r\n\r\nprint(\"Session 2\")\r\nwith tf.Session() as sess2:\r\n  print(sess2.run(a))  # generates 'A1'\r\n  print(sess2.run(a))  # generates 'A2'\r\n  print(sess2.run(b))  # generates 'B1'\r\n  print(sess2.run(b))  # generates 'B2'\r\n```\r\nFew Observations - \r\n1. I tried adding the line `c = tf.placeholder(dtype=tf.float32, shape=[10,10])` before and after `tf.set_random_seed(1234)`. The issue persists.\r\n2. Insertion of placeholder does not affect the outcome when op level seed is set.\r\n\r\nDoes the placeholder affect the sequence in which random numbers are generated by graph level seed?"}