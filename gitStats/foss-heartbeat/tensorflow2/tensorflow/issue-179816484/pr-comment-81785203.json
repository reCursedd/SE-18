{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/81785203", "pull_request_review_id": 2739427, "id": 81785203, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDgxNzg1MjAz", "diff_hunk": "@@ -24,169 +24,209 @@\n \n class GridRNNCellTest(tf.test.TestCase):\n \n+  def _assertTupleOfTensorShapes(self, tp, expected_size):\n+\n+    def get_shape(element):\n+      return element.shape if isinstance(element, np.ndarray) \\\n+        else element.get_shape()\n+\n+    self.assertEqual(len(tp), len(expected_size))\n+    for tp_real, tp_expected in zip(tp, expected_size):\n+      if isinstance(tp_real, tuple):\n+        self.assertEqual(len(tp_real), len(tp_expected))\n+        for el_real, el_expected in zip(tp_real, tp_expected):\n+          self.assertEqual(get_shape(el_real), el_expected)\n+      else:\n+        self.assertEqual(get_shape(tp_real), tp_expected)\n+\n+\n+\n   def testGrid2BasicLSTMCell(self):\n-    with self.test_session() as sess:\n+    with self.test_session(use_gpu=False) as sess:\n       with tf.variable_scope(\n           'root', initializer=tf.constant_initializer(0.2)) as root_scope:\n         x = tf.zeros([1, 3])\n-        m = tf.zeros([1, 8])\n+        m = ((tf.zeros([1, 2]), tf.zeros([1, 2])),\n+             (tf.zeros([1, 2]), tf.zeros([1, 2])))\n         cell = tf.contrib.grid_rnn.Grid2BasicLSTMCell(2)\n-        self.assertEqual(cell.state_size, 8)\n+        self.assertEqual(cell.state_size, ((2, 2), (2, 2)))\n \n         g, s = cell(x, m)\n-        self.assertEqual(g.get_shape(), (1, 2))\n-        self.assertEqual(s.get_shape(), (1, 8))\n+        self._assertTupleOfTensorShapes(g, ((1, 2),))", "path": "tensorflow/contrib/grid_rnn/python/kernel_tests/grid_rnn_test.py", "position": null, "original_position": 37, "commit_id": "94528e6a688598a74f538926ab68f1efce321352", "original_commit_id": "bcd4be237d637ab2db4564fe72c98625350ca1ac", "user": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "body": "you'll be able to use assertEqual after the change suggested above\n", "created_at": "2016-10-04T15:34:19Z", "updated_at": "2016-11-07T09:53:53Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/4631#discussion_r81785203", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/4631", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/81785203"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/4631#discussion_r81785203"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/4631"}}, "body_html": "<p>you'll be able to use assertEqual after the change suggested above</p>", "body_text": "you'll be able to use assertEqual after the change suggested above"}