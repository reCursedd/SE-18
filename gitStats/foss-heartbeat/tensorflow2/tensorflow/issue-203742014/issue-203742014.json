{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7116", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7116/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7116/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7116/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7116", "id": 203742014, "node_id": "MDU6SXNzdWUyMDM3NDIwMTQ=", "number": 7116, "title": "Packet16q16i does not name a type", "user": {"login": "jiazhentim", "id": 1425881, "node_id": "MDQ6VXNlcjE0MjU4ODE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1425881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiazhentim", "html_url": "https://github.com/jiazhentim", "followers_url": "https://api.github.com/users/jiazhentim/followers", "following_url": "https://api.github.com/users/jiazhentim/following{/other_user}", "gists_url": "https://api.github.com/users/jiazhentim/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiazhentim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiazhentim/subscriptions", "organizations_url": "https://api.github.com/users/jiazhentim/orgs", "repos_url": "https://api.github.com/users/jiazhentim/repos", "events_url": "https://api.github.com/users/jiazhentim/events{/privacy}", "received_events_url": "https://api.github.com/users/jiazhentim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 29, "created_at": "2017-01-27T21:15:26Z", "updated_at": "2018-03-20T18:50:47Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>When I compile from source using the flag of AVX512 on Xeon Phi with gcc, I come across a problem as below:<br>\nERROR: tensorflow/tensorflow/core/kernels/BUILD:895:1: C++ compilation of rule '//tensorflow/core/kernels:gather_functor' failed: gcc failed: error executing command /opt/rh/devtoolset-4/root/usr/bin/gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wl,-z,-relro,-z,now -B/opt/rh/devtoolset-4/root/usr/bin -B/usr/bin -Wunused-but-set-parameter ... (remaining 56 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.<br>\nIn file included from ./third_party/eigen3/unsupported/Eigen/CXX11/FixedPoint:35:0,<br>\nfrom ./tensorflow/core/framework/numeric_types.h:25,<br>\nfrom ./tensorflow/core/framework/type_traits.h:22,<br>\nfrom ./tensorflow/core/kernels/gather_functor.h:22,<br>\nfrom tensorflow/core/kernels/gather_functor.cc:50:<br>\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX512.h:84:11: error: 'Packet16q16i' does not name a type<br>\ntypedef Packet16q16i half;<br>\n^<br>\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX512.h:135:11: error: 'Packet16q16i' does not name a type<br>\ntypedef Packet16q16i half;</p>\n<p>Is it caused by some code missing? I add some code in the file PacketMathAVX512.h:<br>\ntypedef struct Packet16q16i {<br>\n__m512i val;<br>\noperator __m512i() const { return val; }<br>\nPacket16q16i();<br>\nPacket16q16i(__m512i val) : val(val) {}<br>\n} Packet16q16i;</p>\n<p>However, it is still failed with the following issue:</p>\n<p>ERROR: tensorflow/tensorflow/core/kernels/BUILD:346:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed: gcc failed: error executing command</p>\n<p>external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/GenericPacketMath.h:478:16: error: 'alignment' is not a member of 'Eigen::internal::unpacket_traitsEigen::internal::Packet64q8u'<br>\nif(Alignment &gt;= unpacket_traits::alignment)<br>\n^<br>\nI am not sure if I did something wrong. Can someone help?</p>\n<p>I use the command provided in <a href=\"url\">https://github.com/tensorflow/tensorflow/issues/4775</a><br>\nbazel build --ignore_unsupported_sandboxing -c opt //tensorflow/tools/pip_package:build_pip_package  --copt \"-mavx512f\" --copt \"-mavx512cd\" --copt \"-mavx512er\" --copt \"-mavx512pf\" --copt \"-mavx2\" --copt \"-fopt-info-vec-all\" --copt \"-DEIGEN_ENABLE_AVX512\" --copt \"-DEIGEN_ENABLE_AVX2\"  --verbose_failures   -j 64</p>\n<p>The gcc version is 5.3.</p>\n<p>BTW, I also tried to use Intel compiler to compile the code, but failed. I saw two issues are discussed, but it seems that there is no solution.</p>", "body_text": "When I compile from source using the flag of AVX512 on Xeon Phi with gcc, I come across a problem as below:\nERROR: tensorflow/tensorflow/core/kernels/BUILD:895:1: C++ compilation of rule '//tensorflow/core/kernels:gather_functor' failed: gcc failed: error executing command /opt/rh/devtoolset-4/root/usr/bin/gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wl,-z,-relro,-z,now -B/opt/rh/devtoolset-4/root/usr/bin -B/usr/bin -Wunused-but-set-parameter ... (remaining 56 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nIn file included from ./third_party/eigen3/unsupported/Eigen/CXX11/FixedPoint:35:0,\nfrom ./tensorflow/core/framework/numeric_types.h:25,\nfrom ./tensorflow/core/framework/type_traits.h:22,\nfrom ./tensorflow/core/kernels/gather_functor.h:22,\nfrom tensorflow/core/kernels/gather_functor.cc:50:\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX512.h:84:11: error: 'Packet16q16i' does not name a type\ntypedef Packet16q16i half;\n^\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX512.h:135:11: error: 'Packet16q16i' does not name a type\ntypedef Packet16q16i half;\nIs it caused by some code missing? I add some code in the file PacketMathAVX512.h:\ntypedef struct Packet16q16i {\n__m512i val;\noperator __m512i() const { return val; }\nPacket16q16i();\nPacket16q16i(__m512i val) : val(val) {}\n} Packet16q16i;\nHowever, it is still failed with the following issue:\nERROR: tensorflow/tensorflow/core/kernels/BUILD:346:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed: gcc failed: error executing command\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/GenericPacketMath.h:478:16: error: 'alignment' is not a member of 'Eigen::internal::unpacket_traitsEigen::internal::Packet64q8u'\nif(Alignment >= unpacket_traits::alignment)\n^\nI am not sure if I did something wrong. Can someone help?\nI use the command provided in https://github.com/tensorflow/tensorflow/issues/4775\nbazel build --ignore_unsupported_sandboxing -c opt //tensorflow/tools/pip_package:build_pip_package  --copt \"-mavx512f\" --copt \"-mavx512cd\" --copt \"-mavx512er\" --copt \"-mavx512pf\" --copt \"-mavx2\" --copt \"-fopt-info-vec-all\" --copt \"-DEIGEN_ENABLE_AVX512\" --copt \"-DEIGEN_ENABLE_AVX2\"  --verbose_failures   -j 64\nThe gcc version is 5.3.\nBTW, I also tried to use Intel compiler to compile the code, but failed. I saw two issues are discussed, but it seems that there is no solution.", "body": "When I compile from source using the flag of AVX512 on Xeon Phi with gcc, I come across a problem as below:\r\nERROR: tensorflow/tensorflow/core/kernels/BUILD:895:1: C++ compilation of rule '//tensorflow/core/kernels:gather_functor' failed: gcc failed: error executing command /opt/rh/devtoolset-4/root/usr/bin/gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wl,-z,-relro,-z,now -B/opt/rh/devtoolset-4/root/usr/bin -B/usr/bin -Wunused-but-set-parameter ... (remaining 56 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\r\nIn file included from ./third_party/eigen3/unsupported/Eigen/CXX11/FixedPoint:35:0,\r\n                 from ./tensorflow/core/framework/numeric_types.h:25,\r\n                 from ./tensorflow/core/framework/type_traits.h:22,\r\n                 from ./tensorflow/core/kernels/gather_functor.h:22,\r\n                 from tensorflow/core/kernels/gather_functor.cc:50:\r\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX512.h:84:11: error: 'Packet16q16i' does not name a type\r\n   typedef Packet16q16i half;\r\n           ^\r\n./third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/PacketMathAVX512.h:135:11: error: 'Packet16q16i' does not name a type\r\n   typedef Packet16q16i half;\r\n\r\nIs it caused by some code missing? I add some code in the file PacketMathAVX512.h:\r\ntypedef struct Packet16q16i {\r\n  __m512i val;\r\n  operator __m512i() const { return val; }\r\n  Packet16q16i();\r\n  Packet16q16i(__m512i val) : val(val) {}\r\n} Packet16q16i;\r\n\r\nHowever, it is still failed with the following issue:\r\n\r\nERROR: tensorflow/tensorflow/core/kernels/BUILD:346:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed: gcc failed: error executing command \r\n\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/GenericPacketMath.h:478:16: error: 'alignment' is not a member of 'Eigen::internal::unpacket_traits<Eigen::internal::Packet64q8u>'\r\n   if(Alignment >= unpacket_traits<Packet>::alignment)\r\n                ^\r\nI am not sure if I did something wrong. Can someone help?\r\n\r\nI use the command provided in [https://github.com/tensorflow/tensorflow/issues/4775](url)\r\nbazel build --ignore_unsupported_sandboxing -c opt //tensorflow/tools/pip_package:build_pip_package  --copt \"-mavx512f\" --copt \"-mavx512cd\" --copt \"-mavx512er\" --copt \"-mavx512pf\" --copt \"-mavx2\" --copt \"-fopt-info-vec-all\" --copt \"-DEIGEN_ENABLE_AVX512\" --copt \"-DEIGEN_ENABLE_AVX2\"  --verbose_failures   -j 64\r\n\r\nThe gcc version is 5.3.\r\n\r\nBTW, I also tried to use Intel compiler to compile the code, but failed. I saw two issues are discussed, but it seems that there is no solution. "}