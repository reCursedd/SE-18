{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6039", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6039/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6039/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6039/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6039", "id": 193071786, "node_id": "MDU6SXNzdWUxOTMwNzE3ODY=", "number": 6039, "title": "Precision of reduce_sum operation", "user": {"login": "flash1293", "id": 1508364, "node_id": "MDQ6VXNlcjE1MDgzNjQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/1508364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flash1293", "html_url": "https://github.com/flash1293", "followers_url": "https://api.github.com/users/flash1293/followers", "following_url": "https://api.github.com/users/flash1293/following{/other_user}", "gists_url": "https://api.github.com/users/flash1293/gists{/gist_id}", "starred_url": "https://api.github.com/users/flash1293/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flash1293/subscriptions", "organizations_url": "https://api.github.com/users/flash1293/orgs", "repos_url": "https://api.github.com/users/flash1293/repos", "events_url": "https://api.github.com/users/flash1293/events{/privacy}", "received_events_url": "https://api.github.com/users/flash1293/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "benoitsteiner", "id": 6969686, "node_id": "MDQ6VXNlcjY5Njk2ODY=", "avatar_url": "https://avatars0.githubusercontent.com/u/6969686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benoitsteiner", "html_url": "https://github.com/benoitsteiner", "followers_url": "https://api.github.com/users/benoitsteiner/followers", "following_url": "https://api.github.com/users/benoitsteiner/following{/other_user}", "gists_url": "https://api.github.com/users/benoitsteiner/gists{/gist_id}", "starred_url": "https://api.github.com/users/benoitsteiner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benoitsteiner/subscriptions", "organizations_url": "https://api.github.com/users/benoitsteiner/orgs", "repos_url": "https://api.github.com/users/benoitsteiner/repos", "events_url": "https://api.github.com/users/benoitsteiner/events{/privacy}", "received_events_url": "https://api.github.com/users/benoitsteiner/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "benoitsteiner", "id": 6969686, "node_id": "MDQ6VXNlcjY5Njk2ODY=", "avatar_url": "https://avatars0.githubusercontent.com/u/6969686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benoitsteiner", "html_url": "https://github.com/benoitsteiner", "followers_url": "https://api.github.com/users/benoitsteiner/followers", "following_url": "https://api.github.com/users/benoitsteiner/following{/other_user}", "gists_url": "https://api.github.com/users/benoitsteiner/gists{/gist_id}", "starred_url": "https://api.github.com/users/benoitsteiner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benoitsteiner/subscriptions", "organizations_url": "https://api.github.com/users/benoitsteiner/orgs", "repos_url": "https://api.github.com/users/benoitsteiner/repos", "events_url": "https://api.github.com/users/benoitsteiner/events{/privacy}", "received_events_url": "https://api.github.com/users/benoitsteiner/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-12-02T09:35:24Z", "updated_at": "2017-02-13T17:58:23Z", "closed_at": "2017-02-13T17:58:23Z", "author_association": "NONE", "body_html": "<p>There seems to be a numerical precision problem with the reduce_sum operation, see the example provided below. Even though everything is set to float32 as datatype tensorflow produces a much more imprecise result than numpy (whose result is numerically exact).</p>\n<p>Is this intended? It seems strange that tensorflow makes such serious numerical errors. Am I doing something wrong?</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>nothing there to my knowledge</p>\n<h3>Environment info</h3>\n<p>Operating System: Mac OSX 10.12.1<br>\nTensorflow 0.11.0 CPU<br>\n<a href=\"https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.11.0-py2-none-any.whl\" rel=\"nofollow\">https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.11.0-py2-none-any.whl</a></p>\n<p>could be reproduced in docker-container <code>tensorflow/tensorflow:0.12.0-rc0</code> in a virtualbox linux vm</p>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n<span class=\"pl-k\">import</span> numpy <span class=\"pl-k\">as</span> np\n\ndata <span class=\"pl-k\">=</span> tf.constant(<span class=\"pl-c1\">1.23456</span>, <span class=\"pl-v\">shape</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">250</span>,<span class=\"pl-c1\">250</span>], <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32)\n<span class=\"pl-c1\">sum</span> <span class=\"pl-k\">=</span> tf.reduce_sum(data)\nsess <span class=\"pl-k\">=</span> tf.Session()\nsess.run(<span class=\"pl-c1\">sum</span>) <span class=\"pl-c\"><span class=\"pl-c\">#</span>77151.477</span>\n\ndata2 <span class=\"pl-k\">=</span> np.full([<span class=\"pl-c1\">250</span>, <span class=\"pl-c1\">250</span>], np.float32(<span class=\"pl-c1\">1.23456</span>), <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>np.float32)\nnp.sum(data2) <span class=\"pl-c\"><span class=\"pl-c\">#</span>77160</span></pre></div>\n<p><a href=\"https://gist.github.com/flash1293/84c2719dd646c0314ec0f4ea05df117a\">https://gist.github.com/flash1293/84c2719dd646c0314ec0f4ea05df117a</a></p>\n<h3>What other attempted solutions have you tried?</h3>\n<ul>\n<li></li>\n</ul>\n<h3>Logs or other output that would be helpful</h3>\n<ul>\n<li></li>\n</ul>", "body_text": "There seems to be a numerical precision problem with the reduce_sum operation, see the example provided below. Even though everything is set to float32 as datatype tensorflow produces a much more imprecise result than numpy (whose result is numerically exact).\nIs this intended? It seems strange that tensorflow makes such serious numerical errors. Am I doing something wrong?\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nnothing there to my knowledge\nEnvironment info\nOperating System: Mac OSX 10.12.1\nTensorflow 0.11.0 CPU\nhttps://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.11.0-py2-none-any.whl\ncould be reproduced in docker-container tensorflow/tensorflow:0.12.0-rc0 in a virtualbox linux vm\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nimport tensorflow as tf\nimport numpy as np\n\ndata = tf.constant(1.23456, shape=[250,250], dtype=tf.float32)\nsum = tf.reduce_sum(data)\nsess = tf.Session()\nsess.run(sum) #77151.477\n\ndata2 = np.full([250, 250], np.float32(1.23456), dtype=np.float32)\nnp.sum(data2) #77160\nhttps://gist.github.com/flash1293/84c2719dd646c0314ec0f4ea05df117a\nWhat other attempted solutions have you tried?\n\n\n\nLogs or other output that would be helpful", "body": "There seems to be a numerical precision problem with the reduce_sum operation, see the example provided below. Even though everything is set to float32 as datatype tensorflow produces a much more imprecise result than numpy (whose result is numerically exact).\r\n\r\nIs this intended? It seems strange that tensorflow makes such serious numerical errors. Am I doing something wrong?\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\n\r\nnothing there to my knowledge\r\n\r\n### Environment info\r\nOperating System: Mac OSX 10.12.1\r\nTensorflow 0.11.0 CPU\r\nhttps://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.11.0-py2-none-any.whl\r\n\r\ncould be reproduced in docker-container `tensorflow/tensorflow:0.12.0-rc0` in a virtualbox linux vm\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\ndata = tf.constant(1.23456, shape=[250,250], dtype=tf.float32)\r\nsum = tf.reduce_sum(data)\r\nsess = tf.Session()\r\nsess.run(sum) #77151.477\r\n\r\ndata2 = np.full([250, 250], np.float32(1.23456), dtype=np.float32)\r\nnp.sum(data2) #77160\r\n```\r\nhttps://gist.github.com/flash1293/84c2719dd646c0314ec0f4ea05df117a\r\n\r\n### What other attempted solutions have you tried?\r\n\r\n-\r\n\r\n### Logs or other output that would be helpful\r\n\r\n-\r\n"}