{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/411317055", "html_url": "https://github.com/tensorflow/tensorflow/issues/21328#issuecomment-411317055", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21328", "id": 411317055, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTMxNzA1NQ==", "user": {"login": "haifenghan", "id": 4157827, "node_id": "MDQ6VXNlcjQxNTc4Mjc=", "avatar_url": "https://avatars1.githubusercontent.com/u/4157827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haifenghan", "html_url": "https://github.com/haifenghan", "followers_url": "https://api.github.com/users/haifenghan/followers", "following_url": "https://api.github.com/users/haifenghan/following{/other_user}", "gists_url": "https://api.github.com/users/haifenghan/gists{/gist_id}", "starred_url": "https://api.github.com/users/haifenghan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haifenghan/subscriptions", "organizations_url": "https://api.github.com/users/haifenghan/orgs", "repos_url": "https://api.github.com/users/haifenghan/repos", "events_url": "https://api.github.com/users/haifenghan/events{/privacy}", "received_events_url": "https://api.github.com/users/haifenghan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-08T07:43:03Z", "updated_at": "2018-08-08T07:51:35Z", "author_association": "NONE", "body_html": "<p>When running the following example code, I get error message which doesn't exist in TF 1.8.</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\n\nsess = tf.Session()\nsess.as_default()\n\nwith tf.gfile.FastGFile('mobilenet_v2_1.0_224_frozen.pb', 'rb') as f:\n    sess.graph.as_default()\n    graph_def = tf.GraphDef()\n    graph_def.ParseFromString(f.read())\n\ninput_data = np.random.randn(1,224,224,3)\n\ninput_data = tf.convert_to_tensor(input_data, dtype=tf.float32)\ntf.import_graph_def(graph_def, name=\"\", input_map={'input:0':input_data})\nbatch_norm = tf.get_default_graph().get_operation_by_name('MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm')\nout = sess.run(batch_norm.outputs[1])\nprint out\n\n</code></pre>\n<p>The error is as follows:</p>\n<pre><code>Optimizing fused batch norm node name: \"MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm\"                                            \nop: \"FusedBatchNorm\"                                                                                                                             \ninput: \"MobilenetV2/expanded_conv/depthwise/depthwise\"\ninput: \"Const_198\"                                                                                                                               \ninput: \"Const_37\"\ninput: \"Const_138\"                                                                                                                               \ninput: \"Const_120\"\ndevice: \"/job:localhost/replica:0/task:0/device:CPU:0\"                                                                                           \nattr {\n  key: \"T\"                                                                                                                                       \n  value {\n    type: DT_FLOAT                                                                                                                               \n  }\n}\nattr {\n  key: \"data_format\"\n  value {\n    s: \"NHWC\"\n  }\n}\nattr {\n  key: \"epsilon\"\n  value {\n    f: 0.001\n  }\n}\nattr {\n  key: \"is_training\"                                                                                                                             \n  value {\n    b: false\n  }                                     \nTraceback (most recent call last):\n  File \"test.py\", line 17, in &lt;module&gt;\n    out = sess.run(batch_norm.outputs[1])\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 900, in run\n    run_metadata_ptr)\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1135, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\n    run_metadata)\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: FetchOutputs MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm:1: output\nindex too large, must be &lt; 1\n\n</code></pre>", "body_text": "When running the following example code, I get error message which doesn't exist in TF 1.8.\nimport tensorflow as tf\nimport numpy as np\n\nsess = tf.Session()\nsess.as_default()\n\nwith tf.gfile.FastGFile('mobilenet_v2_1.0_224_frozen.pb', 'rb') as f:\n    sess.graph.as_default()\n    graph_def = tf.GraphDef()\n    graph_def.ParseFromString(f.read())\n\ninput_data = np.random.randn(1,224,224,3)\n\ninput_data = tf.convert_to_tensor(input_data, dtype=tf.float32)\ntf.import_graph_def(graph_def, name=\"\", input_map={'input:0':input_data})\nbatch_norm = tf.get_default_graph().get_operation_by_name('MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm')\nout = sess.run(batch_norm.outputs[1])\nprint out\n\n\nThe error is as follows:\nOptimizing fused batch norm node name: \"MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm\"                                            \nop: \"FusedBatchNorm\"                                                                                                                             \ninput: \"MobilenetV2/expanded_conv/depthwise/depthwise\"\ninput: \"Const_198\"                                                                                                                               \ninput: \"Const_37\"\ninput: \"Const_138\"                                                                                                                               \ninput: \"Const_120\"\ndevice: \"/job:localhost/replica:0/task:0/device:CPU:0\"                                                                                           \nattr {\n  key: \"T\"                                                                                                                                       \n  value {\n    type: DT_FLOAT                                                                                                                               \n  }\n}\nattr {\n  key: \"data_format\"\n  value {\n    s: \"NHWC\"\n  }\n}\nattr {\n  key: \"epsilon\"\n  value {\n    f: 0.001\n  }\n}\nattr {\n  key: \"is_training\"                                                                                                                             \n  value {\n    b: false\n  }                                     \nTraceback (most recent call last):\n  File \"test.py\", line 17, in <module>\n    out = sess.run(batch_norm.outputs[1])\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 900, in run\n    run_metadata_ptr)\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1135, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\n    run_metadata)\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: FetchOutputs MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm:1: output\nindex too large, must be < 1", "body": "When running the following example code, I get error message which doesn't exist in TF 1.8.\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nsess = tf.Session()\r\nsess.as_default()\r\n\r\nwith tf.gfile.FastGFile('mobilenet_v2_1.0_224_frozen.pb', 'rb') as f:\r\n    sess.graph.as_default()\r\n    graph_def = tf.GraphDef()\r\n    graph_def.ParseFromString(f.read())\r\n\r\ninput_data = np.random.randn(1,224,224,3)\r\n\r\ninput_data = tf.convert_to_tensor(input_data, dtype=tf.float32)\r\ntf.import_graph_def(graph_def, name=\"\", input_map={'input:0':input_data})\r\nbatch_norm = tf.get_default_graph().get_operation_by_name('MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm')\r\nout = sess.run(batch_norm.outputs[1])\r\nprint out\r\n\r\n```\r\n\r\nThe error is as follows:\r\n```\r\nOptimizing fused batch norm node name: \"MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm\"                                            \r\nop: \"FusedBatchNorm\"                                                                                                                             \r\ninput: \"MobilenetV2/expanded_conv/depthwise/depthwise\"\r\ninput: \"Const_198\"                                                                                                                               \r\ninput: \"Const_37\"\r\ninput: \"Const_138\"                                                                                                                               \r\ninput: \"Const_120\"\r\ndevice: \"/job:localhost/replica:0/task:0/device:CPU:0\"                                                                                           \r\nattr {\r\n  key: \"T\"                                                                                                                                       \r\n  value {\r\n    type: DT_FLOAT                                                                                                                               \r\n  }\r\n}\r\nattr {\r\n  key: \"data_format\"\r\n  value {\r\n    s: \"NHWC\"\r\n  }\r\n}\r\nattr {\r\n  key: \"epsilon\"\r\n  value {\r\n    f: 0.001\r\n  }\r\n}\r\nattr {\r\n  key: \"is_training\"                                                                                                                             \r\n  value {\r\n    b: false\r\n  }                                     \r\nTraceback (most recent call last):\r\n  File \"test.py\", line 17, in <module>\r\n    out = sess.run(batch_norm.outputs[1])\r\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 900, in run\r\n    run_metadata_ptr)\r\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1135, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\r\n    run_metadata)\r\n  File \"/home/haifeng/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: FetchOutputs MobilenetV2/expanded_conv/depthwise/BatchNorm/FusedBatchNorm:1: output\r\nindex too large, must be < 1\r\n\r\n```"}