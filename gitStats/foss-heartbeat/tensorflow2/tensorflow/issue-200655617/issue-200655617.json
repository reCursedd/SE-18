{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6831", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6831/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6831/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6831/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6831", "id": 200655617, "node_id": "MDU6SXNzdWUyMDA2NTU2MTc=", "number": 6831, "title": "running session multiple times with tf.random returns different values for conv2d", "user": {"login": "joonggonyim", "id": 25104542, "node_id": "MDQ6VXNlcjI1MTA0NTQy", "avatar_url": "https://avatars0.githubusercontent.com/u/25104542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joonggonyim", "html_url": "https://github.com/joonggonyim", "followers_url": "https://api.github.com/users/joonggonyim/followers", "following_url": "https://api.github.com/users/joonggonyim/following{/other_user}", "gists_url": "https://api.github.com/users/joonggonyim/gists{/gist_id}", "starred_url": "https://api.github.com/users/joonggonyim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joonggonyim/subscriptions", "organizations_url": "https://api.github.com/users/joonggonyim/orgs", "repos_url": "https://api.github.com/users/joonggonyim/repos", "events_url": "https://api.github.com/users/joonggonyim/events{/privacy}", "received_events_url": "https://api.github.com/users/joonggonyim/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-13T15:21:57Z", "updated_at": "2017-01-13T16:06:42Z", "closed_at": "2017-01-13T16:04:41Z", "author_association": "NONE", "body_html": "<pre><code>import tensorflow as tf \nimport numpy as np \n\nx_tf = tf.placeholder('float',[None, 2, 5, 1])\nx_np = np.random.noraml(0,1,[1,2,5,1])\n\n# ======== filter option1 and option2 ===========\nf_np = np.random.normal(0,1,[1,3,1,1])\nf_tf = tf.constant(f_np,'float') # option 1\nf_tf = tf.random_normal([1,3,1,1]) # option 2\n# ===============================================\n\nx_conv = tf.nn.conv2d(x_tf,f_tf,[1,1,1,1],'SAME')\n\nwith tf.Session() as sess:\n     tf.gloval_variables_initializer().run()\n     x_conv_np  = sess.run(x_conv, feed_dict={x_tf, x_np})\n     x_conv_np2 = sess.run(x_conv, feed_dict={x_tf, x_np})\n</code></pre>\n<p>If I run the code above with option1, I get the same values for <code>x_conv_np</code> and <code>x_conv_np2</code><br>\nHowever, when I run the above with option2, I get different values for <code>x_conv_np</code> and <code>x_conv_np2</code>.</p>\n<p>I am guessing the <code>tf.random_normal</code> gets initialized every time the session is ran.<br>\nIs this meant to happen or is it a bug?<br>\nI found this out while I was trying to debug my code, and it took me a while to figure out the issue.</p>\n<p>Doesn't this mean that when option2 is chosen, the result of the convolution changes for each loop that iterates over mini batches?</p>", "body_text": "import tensorflow as tf \nimport numpy as np \n\nx_tf = tf.placeholder('float',[None, 2, 5, 1])\nx_np = np.random.noraml(0,1,[1,2,5,1])\n\n# ======== filter option1 and option2 ===========\nf_np = np.random.normal(0,1,[1,3,1,1])\nf_tf = tf.constant(f_np,'float') # option 1\nf_tf = tf.random_normal([1,3,1,1]) # option 2\n# ===============================================\n\nx_conv = tf.nn.conv2d(x_tf,f_tf,[1,1,1,1],'SAME')\n\nwith tf.Session() as sess:\n     tf.gloval_variables_initializer().run()\n     x_conv_np  = sess.run(x_conv, feed_dict={x_tf, x_np})\n     x_conv_np2 = sess.run(x_conv, feed_dict={x_tf, x_np})\n\nIf I run the code above with option1, I get the same values for x_conv_np and x_conv_np2\nHowever, when I run the above with option2, I get different values for x_conv_np and x_conv_np2.\nI am guessing the tf.random_normal gets initialized every time the session is ran.\nIs this meant to happen or is it a bug?\nI found this out while I was trying to debug my code, and it took me a while to figure out the issue.\nDoesn't this mean that when option2 is chosen, the result of the convolution changes for each loop that iterates over mini batches?", "body": "```\r\nimport tensorflow as tf \r\nimport numpy as np \r\n\r\nx_tf = tf.placeholder('float',[None, 2, 5, 1])\r\nx_np = np.random.noraml(0,1,[1,2,5,1])\r\n\r\n# ======== filter option1 and option2 ===========\r\nf_np = np.random.normal(0,1,[1,3,1,1])\r\nf_tf = tf.constant(f_np,'float') # option 1\r\nf_tf = tf.random_normal([1,3,1,1]) # option 2\r\n# ===============================================\r\n\r\nx_conv = tf.nn.conv2d(x_tf,f_tf,[1,1,1,1],'SAME')\r\n\r\nwith tf.Session() as sess:\r\n     tf.gloval_variables_initializer().run()\r\n     x_conv_np  = sess.run(x_conv, feed_dict={x_tf, x_np})\r\n     x_conv_np2 = sess.run(x_conv, feed_dict={x_tf, x_np})\r\n```\r\nIf I run the code above with option1, I get the same values for `x_conv_np` and `x_conv_np2`\r\nHowever, when I run the above with option2, I get different values for `x_conv_np` and `x_conv_np2`.\r\n\r\nI am guessing the `tf.random_normal` gets initialized every time the session is ran.\r\nIs this meant to happen or is it a bug?\r\nI found this out while I was trying to debug my code, and it took me a while to figure out the issue. \r\n\r\nDoesn't this mean that when option2 is chosen, the result of the convolution changes for each loop that iterates over mini batches?\r\n"}