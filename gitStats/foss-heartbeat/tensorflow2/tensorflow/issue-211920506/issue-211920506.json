{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8090", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8090/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8090/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8090/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8090", "id": 211920506, "node_id": "MDU6SXNzdWUyMTE5MjA1MDY=", "number": 8090, "title": "fused_batch_norm doesn't work with epsilon < 1e-5", "user": {"login": "adityaramesh", "id": 1999682, "node_id": "MDQ6VXNlcjE5OTk2ODI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1999682?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adityaramesh", "html_url": "https://github.com/adityaramesh", "followers_url": "https://api.github.com/users/adityaramesh/followers", "following_url": "https://api.github.com/users/adityaramesh/following{/other_user}", "gists_url": "https://api.github.com/users/adityaramesh/gists{/gist_id}", "starred_url": "https://api.github.com/users/adityaramesh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adityaramesh/subscriptions", "organizations_url": "https://api.github.com/users/adityaramesh/orgs", "repos_url": "https://api.github.com/users/adityaramesh/repos", "events_url": "https://api.github.com/users/adityaramesh/events{/privacy}", "received_events_url": "https://api.github.com/users/adityaramesh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-03-05T01:00:30Z", "updated_at": "2017-09-19T02:55:09Z", "closed_at": "2017-09-19T02:55:09Z", "author_association": "NONE", "body_html": "<p><a href=\"https://github.com/tensorflow/tensorflow/blob/067cba5e4b873829f6cdfa61256079d2cfc45d02/tensorflow/python/ops/nn_impl.py#L806\">This line in nn_impl.py</a> has the following comment: \"Add 1e-12 to epsilon when epsilon &lt;= 1e-5 to prevent CUDNN exception.\" However, I still get the cuDNN exception when using values of epsilon less than 1e-5.</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>Nothing related.</p>\n<h3>Environment info</h3>\n<ul>\n<li>Operating System: CentOS release 6.3 (Final)</li>\n<li>Installed version of CUDA: 8.0.44</li>\n<li>Installed version of cuDNN: 8.0v5.1</li>\n<li>Installed <code>tensorflow-gpu</code> from pip-3.5</li>\n</ul>\n<pre><code>$ python3.5 -c \"import tensorflow; print(tensorflow.__version__)\"\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\n1.0.0\n</code></pre>\n<h3>If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)</h3>\n<pre><code>import tensorflow as tf\nfrom itertools import chain\n\nwith tf.device('/gpu:0'):\n        x = tf.zeros([4, 4, 4, 4])\n        scale, offset = tf.ones(4), tf.zeros(4)\n\n        y, _, _ = tf.nn.fused_batch_norm(x, scale, offset, mean=None, variance=None, epsilon=1e-8,\n                data_format='NCHW', is_training=True)\n\n        init_op = tf.group(*(v.initializer for v in chain(tf.global_variables(),\n                tf.local_variables())))\n\n        sess = tf.Session()\n        sess.run(init_op)\n        sess.run(y)\n</code></pre>\n<h3>Logs or other output that would be helpful</h3>\n<pre><code>$ python3.5 tests/fused_batch_norm_crash.py\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:84:00.0\nTotal memory: 7.92GiB\nFree memory: 7.81GiB\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX 1080, pci bus id: 0000:84:00.0)\nE tensorflow/stream_executor/cuda/cuda_dnn.cc:2177] failed to enqueue forward batch normalization on stream: CUDNN_STATUS_BAD_PARAM\nTraceback (most recent call last):\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1022, in _do_call\n    return fn(*args)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1004, in _run_fn\n    status, run_metadata)\n  File \"/share/apps/python3/3.5.3/intel/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([4,4,4,4])\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"tests/fused_batch_norm_crash.py\", line 16, in &lt;module&gt;\n    sess.run(y)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([4,4,4,4])\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\n\nCaused by op 'FusedBatchNorm', defined at:\n  File \"tests/fused_batch_norm_crash.py\", line 9, in &lt;module&gt;\n    data_format='NCHW', is_training=True)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/ops/nn_impl.py\", line 818, in fused_batch_norm\n    name=name)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1257, in _fused_batch_norm\n    is_training=is_training, name=name)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1264, in __init__\n    self._traceback = _extract_stack()\n\nInternalError (see above for traceback): cuDNN launch failure : input shape ([4,4,4,4])\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\n</code></pre>", "body_text": "This line in nn_impl.py has the following comment: \"Add 1e-12 to epsilon when epsilon <= 1e-5 to prevent CUDNN exception.\" However, I still get the cuDNN exception when using values of epsilon less than 1e-5.\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nNothing related.\nEnvironment info\n\nOperating System: CentOS release 6.3 (Final)\nInstalled version of CUDA: 8.0.44\nInstalled version of cuDNN: 8.0v5.1\nInstalled tensorflow-gpu from pip-3.5\n\n$ python3.5 -c \"import tensorflow; print(tensorflow.__version__)\"\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\n1.0.0\n\nIf possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\nimport tensorflow as tf\nfrom itertools import chain\n\nwith tf.device('/gpu:0'):\n        x = tf.zeros([4, 4, 4, 4])\n        scale, offset = tf.ones(4), tf.zeros(4)\n\n        y, _, _ = tf.nn.fused_batch_norm(x, scale, offset, mean=None, variance=None, epsilon=1e-8,\n                data_format='NCHW', is_training=True)\n\n        init_op = tf.group(*(v.initializer for v in chain(tf.global_variables(),\n                tf.local_variables())))\n\n        sess = tf.Session()\n        sess.run(init_op)\n        sess.run(y)\n\nLogs or other output that would be helpful\n$ python3.5 tests/fused_batch_norm_crash.py\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\nname: GeForce GTX 1080\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\npciBusID 0000:84:00.0\nTotal memory: 7.92GiB\nFree memory: 7.81GiB\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:84:00.0)\nE tensorflow/stream_executor/cuda/cuda_dnn.cc:2177] failed to enqueue forward batch normalization on stream: CUDNN_STATUS_BAD_PARAM\nTraceback (most recent call last):\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1022, in _do_call\n    return fn(*args)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1004, in _run_fn\n    status, run_metadata)\n  File \"/share/apps/python3/3.5.3/intel/lib/python3.5/contextlib.py\", line 66, in __exit__\n    next(self.gen)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\n    pywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([4,4,4,4])\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"tests/fused_batch_norm_crash.py\", line 16, in <module>\n    sess.run(y)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 767, in run\n    run_metadata_ptr)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 965, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\n    target_list, options, run_metadata)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([4,4,4,4])\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\n\nCaused by op 'FusedBatchNorm', defined at:\n  File \"tests/fused_batch_norm_crash.py\", line 9, in <module>\n    data_format='NCHW', is_training=True)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/ops/nn_impl.py\", line 818, in fused_batch_norm\n    name=name)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1257, in _fused_batch_norm\n    is_training=is_training, name=name)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\n    op_def=op_def)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1264, in __init__\n    self._traceback = _extract_stack()\n\nInternalError (see above for traceback): cuDNN launch failure : input shape ([4,4,4,4])\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]", "body": "[This line in nn_impl.py](https://github.com/tensorflow/tensorflow/blob/067cba5e4b873829f6cdfa61256079d2cfc45d02/tensorflow/python/ops/nn_impl.py#L806) has the following comment: \"Add 1e-12 to epsilon when epsilon <= 1e-5 to prevent CUDNN exception.\" However, I still get the cuDNN exception when using values of epsilon less than 1e-5.\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\n\r\nNothing related.\r\n\r\n### Environment info\r\n\r\n- Operating System: CentOS release 6.3 (Final)\r\n- Installed version of CUDA: 8.0.44\r\n- Installed version of cuDNN: 8.0v5.1\r\n- Installed `tensorflow-gpu` from pip-3.5\r\n\r\n```\r\n$ python3.5 -c \"import tensorflow; print(tensorflow.__version__)\"\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\r\n1.0.0\r\n```\r\n\r\n### If possible, provide a minimal reproducible example (We usually don't have time to read hundreds of lines of your code)\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom itertools import chain\r\n\r\nwith tf.device('/gpu:0'):\r\n        x = tf.zeros([4, 4, 4, 4])\r\n        scale, offset = tf.ones(4), tf.zeros(4)\r\n\r\n        y, _, _ = tf.nn.fused_batch_norm(x, scale, offset, mean=None, variance=None, epsilon=1e-8,\r\n                data_format='NCHW', is_training=True)\r\n\r\n        init_op = tf.group(*(v.initializer for v in chain(tf.global_variables(),\r\n                tf.local_variables())))\r\n\r\n        sess = tf.Session()\r\n        sess.run(init_op)\r\n        sess.run(y)\r\n```\r\n\r\n### Logs or other output that would be helpful\r\n\r\n```\r\n$ python3.5 tests/fused_batch_norm_crash.py\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally\r\nI tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\r\nW tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:\r\nname: GeForce GTX 1080\r\nmajor: 6 minor: 1 memoryClockRate (GHz) 1.7335\r\npciBusID 0000:84:00.0\r\nTotal memory: 7.92GiB\r\nFree memory: 7.81GiB\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y\r\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:84:00.0)\r\nE tensorflow/stream_executor/cuda/cuda_dnn.cc:2177] failed to enqueue forward batch normalization on stream: CUDNN_STATUS_BAD_PARAM\r\nTraceback (most recent call last):\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1022, in _do_call\r\n    return fn(*args)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1004, in _run_fn\r\n    status, run_metadata)\r\n  File \"/share/apps/python3/3.5.3/intel/lib/python3.5/contextlib.py\", line 66, in __exit__\r\n    next(self.gen)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([4,4,4,4])\r\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"tests/fused_batch_norm_crash.py\", line 16, in <module>\r\n    sess.run(y)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([4,4,4,4])\r\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\r\n\r\nCaused by op 'FusedBatchNorm', defined at:\r\n  File \"tests/fused_batch_norm_crash.py\", line 9, in <module>\r\n    data_format='NCHW', is_training=True)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/ops/nn_impl.py\", line 818, in fused_batch_norm\r\n    name=name)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1257, in _fused_batch_norm\r\n    is_training=is_training, name=name)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/home/ar2922/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1264, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInternalError (see above for traceback): cuDNN launch failure : input shape ([4,4,4,4])\r\n\t [[Node: FusedBatchNorm = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.0001e-08, is_training=true, _device=\"/job:localhost/replica:0/task:0/gpu:0\"](random_normal, ones, zeros, Const, Const_1)]]\r\n```\r\n"}