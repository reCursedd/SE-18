{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13986", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13986/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13986/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13986/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13986", "id": 268595205, "node_id": "MDU6SXNzdWUyNjg1OTUyMDU=", "number": 13986, "title": "tensorflow building graph very slow \u2014 for more than two hours when looping", "user": {"login": "jacobisdsa", "id": 33107559, "node_id": "MDQ6VXNlcjMzMTA3NTU5", "avatar_url": "https://avatars3.githubusercontent.com/u/33107559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacobisdsa", "html_url": "https://github.com/jacobisdsa", "followers_url": "https://api.github.com/users/jacobisdsa/followers", "following_url": "https://api.github.com/users/jacobisdsa/following{/other_user}", "gists_url": "https://api.github.com/users/jacobisdsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacobisdsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacobisdsa/subscriptions", "organizations_url": "https://api.github.com/users/jacobisdsa/orgs", "repos_url": "https://api.github.com/users/jacobisdsa/repos", "events_url": "https://api.github.com/users/jacobisdsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jacobisdsa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-10-26T00:49:16Z", "updated_at": "2018-04-22T04:51:52Z", "closed_at": "2017-10-27T17:17:08Z", "author_association": "NONE", "body_html": "<h3>Describe the problem</h3>\n<p>Tensorflow is really slow when using loops. A very simple code can even last for hours and this is strange.<br>\nCan anyone help me with issue?</p>\n<h3>Source code / logs</h3>\n<pre><code>import numpy as np\nimport tensorflow as tf\nimport time\n\n# define a guassian function so that it picks a value of 1 when the required value is met and otherwise a small neglegible value\ndef gaussian(x_box, x_tensor):\n    x_box=tf.convert_to_tensor(x_box,dtype=tf.float32)\n    return tf.exp(tf.divide(tf.square(x_box-x_tensor),-0.02))\n\na=time.time()\n# the input tensor with shape=[1,1000]\nlength = 1000\ninput_= tf.placeholder(dtype= tf.float32, shape= [1, length])\n\n\n# the box length is 100\nbox=np.zeros(100, dtype='O')\n#zero_tensor=tf.convert_to_tensor(0,dtype=tf.float32)\n#box[:]=zero_tensor\n\n\n# in order to put the element in the correct box, I use a gaussian function, so that when the element\n# in input_ is  near the box , it contributes a large number\nfor i in range(length):\n    for j in range(len(box)):\n        box[j] += gaussian(j, input_[0][i])\nb=time.time()\nprint(b-a)\n\n##########\n# really slow when length=1000 and box len 100, but if I set length =10 and box len also 10\n# it get the correct ansewr and faster as expected\n# for example\ninput_value = [[0,0,0,0,0,1,1,1,1,1]]\nwith tf.Session() as sess:\n    for i in range(len(box)):\n        box[i] = int(sess.run(box[i], {input_: input_value}))\nprint(box)\n\n</code></pre>", "body_text": "Describe the problem\nTensorflow is really slow when using loops. A very simple code can even last for hours and this is strange.\nCan anyone help me with issue?\nSource code / logs\nimport numpy as np\nimport tensorflow as tf\nimport time\n\n# define a guassian function so that it picks a value of 1 when the required value is met and otherwise a small neglegible value\ndef gaussian(x_box, x_tensor):\n    x_box=tf.convert_to_tensor(x_box,dtype=tf.float32)\n    return tf.exp(tf.divide(tf.square(x_box-x_tensor),-0.02))\n\na=time.time()\n# the input tensor with shape=[1,1000]\nlength = 1000\ninput_= tf.placeholder(dtype= tf.float32, shape= [1, length])\n\n\n# the box length is 100\nbox=np.zeros(100, dtype='O')\n#zero_tensor=tf.convert_to_tensor(0,dtype=tf.float32)\n#box[:]=zero_tensor\n\n\n# in order to put the element in the correct box, I use a gaussian function, so that when the element\n# in input_ is  near the box , it contributes a large number\nfor i in range(length):\n    for j in range(len(box)):\n        box[j] += gaussian(j, input_[0][i])\nb=time.time()\nprint(b-a)\n\n##########\n# really slow when length=1000 and box len 100, but if I set length =10 and box len also 10\n# it get the correct ansewr and faster as expected\n# for example\ninput_value = [[0,0,0,0,0,1,1,1,1,1]]\nwith tf.Session() as sess:\n    for i in range(len(box)):\n        box[i] = int(sess.run(box[i], {input_: input_value}))\nprint(box)", "body": "### Describe the problem\r\nTensorflow is really slow when using loops. A very simple code can even last for hours and this is strange.\r\nCan anyone help me with issue?\r\n### Source code / logs\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport time\r\n\r\n# define a guassian function so that it picks a value of 1 when the required value is met and otherwise a small neglegible value\r\ndef gaussian(x_box, x_tensor):\r\n    x_box=tf.convert_to_tensor(x_box,dtype=tf.float32)\r\n    return tf.exp(tf.divide(tf.square(x_box-x_tensor),-0.02))\r\n\r\na=time.time()\r\n# the input tensor with shape=[1,1000]\r\nlength = 1000\r\ninput_= tf.placeholder(dtype= tf.float32, shape= [1, length])\r\n\r\n\r\n# the box length is 100\r\nbox=np.zeros(100, dtype='O')\r\n#zero_tensor=tf.convert_to_tensor(0,dtype=tf.float32)\r\n#box[:]=zero_tensor\r\n\r\n\r\n# in order to put the element in the correct box, I use a gaussian function, so that when the element\r\n# in input_ is  near the box , it contributes a large number\r\nfor i in range(length):\r\n    for j in range(len(box)):\r\n        box[j] += gaussian(j, input_[0][i])\r\nb=time.time()\r\nprint(b-a)\r\n\r\n##########\r\n# really slow when length=1000 and box len 100, but if I set length =10 and box len also 10\r\n# it get the correct ansewr and faster as expected\r\n# for example\r\ninput_value = [[0,0,0,0,0,1,1,1,1,1]]\r\nwith tf.Session() as sess:\r\n    for i in range(len(box)):\r\n        box[i] = int(sess.run(box[i], {input_: input_value}))\r\nprint(box)\r\n\r\n```"}