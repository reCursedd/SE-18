{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/367932467", "html_url": "https://github.com/tensorflow/tensorflow/issues/17149#issuecomment-367932467", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17149", "id": 367932467, "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzkzMjQ2Nw==", "user": {"login": "dieka13", "id": 6777265, "node_id": "MDQ6VXNlcjY3NzcyNjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/6777265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dieka13", "html_url": "https://github.com/dieka13", "followers_url": "https://api.github.com/users/dieka13/followers", "following_url": "https://api.github.com/users/dieka13/following{/other_user}", "gists_url": "https://api.github.com/users/dieka13/gists{/gist_id}", "starred_url": "https://api.github.com/users/dieka13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dieka13/subscriptions", "organizations_url": "https://api.github.com/users/dieka13/orgs", "repos_url": "https://api.github.com/users/dieka13/repos", "events_url": "https://api.github.com/users/dieka13/events{/privacy}", "received_events_url": "https://api.github.com/users/dieka13/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-23T07:33:24Z", "updated_at": "2018-02-23T08:39:11Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3474655\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/bignamehyp\">@bignamehyp</a>:<br>\nI'm not calling tf.tensordot explicitly in my code<br>\nmaybe because of this?</p>\n<div class=\"highlight highlight-source-python\"><pre>    <span class=\"pl-k\">with</span> tf.variable_scope(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>dense_0<span class=\"pl-pds\">'</span></span>, <span class=\"pl-v\">reuse</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>):\n        flatten_layer <span class=\"pl-k\">=</span> tf.reshape(prev_layer, tf.stack([tf.shape(prev_layer)[<span class=\"pl-c1\">0</span>], tf.shape(prev_layer)[<span class=\"pl-c1\">1</span>], <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>]))\n        flatten_layer.set_shape([<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">None</span>, kernel_sizes[<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>] <span class=\"pl-k\">*</span> <span class=\"pl-c1\">64</span>])\n        logits <span class=\"pl-k\">=</span> tf.layers.dense(flatten_layer, n_class, <span class=\"pl-v\">activation</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>)</pre></div>\n<p>i want to flatten last CNN layer so i can put it into Dense</p>\n<p>also it's still weird, because it's running in training but error when loaded from saved model.</p>", "body_text": "@bignamehyp:\nI'm not calling tf.tensordot explicitly in my code\nmaybe because of this?\n    with tf.variable_scope('dense_0', reuse=None):\n        flatten_layer = tf.reshape(prev_layer, tf.stack([tf.shape(prev_layer)[0], tf.shape(prev_layer)[1], -1]))\n        flatten_layer.set_shape([None, None, kernel_sizes[-1] * 64])\n        logits = tf.layers.dense(flatten_layer, n_class, activation=None)\ni want to flatten last CNN layer so i can put it into Dense\nalso it's still weird, because it's running in training but error when loaded from saved model.", "body": "@bignamehyp: \r\nI'm not calling tf.tensordot explicitly in my code\r\nmaybe because of this?\r\n```python\r\n    with tf.variable_scope('dense_0', reuse=None):\r\n        flatten_layer = tf.reshape(prev_layer, tf.stack([tf.shape(prev_layer)[0], tf.shape(prev_layer)[1], -1]))\r\n        flatten_layer.set_shape([None, None, kernel_sizes[-1] * 64])\r\n        logits = tf.layers.dense(flatten_layer, n_class, activation=None)\r\n```\r\ni want to flatten last CNN layer so i can put it into Dense\r\n\r\nalso it's still weird, because it's running in training but error when loaded from saved model."}