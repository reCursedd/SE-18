{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/323", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/323/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/323/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/323/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/323", "id": 118251717, "node_id": "MDU6SXNzdWUxMTgyNTE3MTc=", "number": 323, "title": "Tensorflow crashed when using AdamOptimizer", "user": {"login": "chuanwen", "id": 2024931, "node_id": "MDQ6VXNlcjIwMjQ5MzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/2024931?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chuanwen", "html_url": "https://github.com/chuanwen", "followers_url": "https://api.github.com/users/chuanwen/followers", "following_url": "https://api.github.com/users/chuanwen/following{/other_user}", "gists_url": "https://api.github.com/users/chuanwen/gists{/gist_id}", "starred_url": "https://api.github.com/users/chuanwen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chuanwen/subscriptions", "organizations_url": "https://api.github.com/users/chuanwen/orgs", "repos_url": "https://api.github.com/users/chuanwen/repos", "events_url": "https://api.github.com/users/chuanwen/events{/privacy}", "received_events_url": "https://api.github.com/users/chuanwen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 27, "created_at": "2015-11-22T08:56:05Z", "updated_at": "2017-10-18T09:03:19Z", "closed_at": "2015-12-03T03:47:13Z", "author_association": "NONE", "body_html": "<p>I tried the cnn in the tutorial for MNIST data, but initialize the parameters with stddev=1 (instead of stddev=0.1).</p>\n<p>Error message:<br>\nI tensorflow/core/common_runtime/local_device.cc:25] Local device intra op parallelism threads: 4<br>\nI tensorflow/core/common_runtime/local_session.cc:45] Local session inter op parallelism threads: 4<br>\n0 0.098<br>\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values<br>\n[[Node: gradients/Relu_grad/Relu/CheckNumerics = CheckNumerics<a href=\"add\">T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]<br>\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values<br>\n[[Node: gradients/Relu_1_grad/Relu_1/CheckNumerics = CheckNumerics<a href=\"add_1\">T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]<br>\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values<br>\n[[Node: gradients/Relu_2_grad/Relu_2/CheckNumerics = CheckNumerics<a href=\"add_2\">T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]<br>\nTraceback (most recent call last):<br>\nFile \"2_cnn.py\", line 67, in <br>\nsession.run(train_step, feed_dict={X: x, Y: y, keep_prob: 0.5})<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 345, in run<br>\nresults = self._do_run(target_list, unique_fetch_targets, feed_dict_string)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 419, in _do_run<br>\ne.code)<br>\ntensorflow.python.framework.errors.InvalidArgumentError: ReluGrad input is not finite. : Tensor had NaN values<br>\n[[Node: gradients/Relu_grad/Relu/CheckNumerics = CheckNumerics<a href=\"add\">T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"</a>]]<br>\nCaused by op u'gradients/Relu_grad/Relu/CheckNumerics', defined at:<br>\nFile \"2_cnn.py\", line 55, in <br>\ntrain_step = tf.train.AdamOptimizer().minimize(loss)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 165, in minimize<br>\ngate_gradients=gate_gradients)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 205, in compute_gradients<br>\nloss, var_list, gate_gradients=(gate_gradients == Optimizer.GATE_OP))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 414, in gradients<br>\nin_grads = _AsList(grad_fn(op_wrapper, *out_grads))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 107, in _ReluGrad<br>\nt = _VerifyTensor(op.inputs[0], op.name, \"ReluGrad input is not finite.\")<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 100, in _VerifyTensor<br>\nverify_input = array_ops.check_numerics(t, message=msg)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 48, in check_numerics<br>\nname=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 633, in apply_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1710, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 988, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>...which was originally created as op u'Relu', defined at:<br>\nFile \"2_cnn.py\", line 32, in <br>\nh_conv1 = tf.nn.relu(conv2d(X1, w_conv1) + b_conv1)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 506, in relu<br>\nreturn _op_def_lib.apply_op(\"Relu\", features=features, name=name)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 633, in apply_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1710, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 988, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>", "body_text": "I tried the cnn in the tutorial for MNIST data, but initialize the parameters with stddev=1 (instead of stddev=0.1).\nError message:\nI tensorflow/core/common_runtime/local_device.cc:25] Local device intra op parallelism threads: 4\nI tensorflow/core/common_runtime/local_session.cc:45] Local session inter op parallelism threads: 4\n0 0.098\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values\n[[Node: gradients/Relu_grad/Relu/CheckNumerics = CheckNumericsT=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values\n[[Node: gradients/Relu_1_grad/Relu_1/CheckNumerics = CheckNumericsT=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values\n[[Node: gradients/Relu_2_grad/Relu_2/CheckNumerics = CheckNumericsT=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nTraceback (most recent call last):\nFile \"2_cnn.py\", line 67, in \nsession.run(train_step, feed_dict={X: x, Y: y, keep_prob: 0.5})\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 345, in run\nresults = self._do_run(target_list, unique_fetch_targets, feed_dict_string)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 419, in _do_run\ne.code)\ntensorflow.python.framework.errors.InvalidArgumentError: ReluGrad input is not finite. : Tensor had NaN values\n[[Node: gradients/Relu_grad/Relu/CheckNumerics = CheckNumericsT=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"]]\nCaused by op u'gradients/Relu_grad/Relu/CheckNumerics', defined at:\nFile \"2_cnn.py\", line 55, in \ntrain_step = tf.train.AdamOptimizer().minimize(loss)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 165, in minimize\ngate_gradients=gate_gradients)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 205, in compute_gradients\nloss, var_list, gate_gradients=(gate_gradients == Optimizer.GATE_OP))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 414, in gradients\nin_grads = _AsList(grad_fn(op_wrapper, *out_grads))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 107, in _ReluGrad\nt = _VerifyTensor(op.inputs[0], op.name, \"ReluGrad input is not finite.\")\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 100, in _VerifyTensor\nverify_input = array_ops.check_numerics(t, message=msg)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 48, in check_numerics\nname=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 633, in apply_op\nop_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1710, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 988, in init\nself._traceback = _extract_stack()\n...which was originally created as op u'Relu', defined at:\nFile \"2_cnn.py\", line 32, in \nh_conv1 = tf.nn.relu(conv2d(X1, w_conv1) + b_conv1)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 506, in relu\nreturn _op_def_lib.apply_op(\"Relu\", features=features, name=name)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 633, in apply_op\nop_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1710, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 988, in init\nself._traceback = _extract_stack()", "body": "I tried the cnn in the tutorial for MNIST data, but initialize the parameters with stddev=1 (instead of stddev=0.1).\n\nError message:\nI tensorflow/core/common_runtime/local_device.cc:25] Local device intra op parallelism threads: 4\nI tensorflow/core/common_runtime/local_session.cc:45] Local session inter op parallelism threads: 4\n0 0.098\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values\n     [[Node: gradients/Relu_grad/Relu/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add)]]\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values\n     [[Node: gradients/Relu_1_grad/Relu_1/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add_1)]]\nW tensorflow/core/common_runtime/executor.cc:1027] 0x4472710 Compute status: Invalid argument: ReluGrad input is not finite. : Tensor had NaN values\n     [[Node: gradients/Relu_2_grad/Relu_2/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add_2)]]\nTraceback (most recent call last):\n  File \"2_cnn.py\", line 67, in <module>\n    session.run(train_step, feed_dict={X: x, Y: y, keep_prob: 0.5})\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 345, in run\n    results = self._do_run(target_list, unique_fetch_targets, feed_dict_string)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 419, in _do_run\n    e.code)\ntensorflow.python.framework.errors.InvalidArgumentError: ReluGrad input is not finite. : Tensor had NaN values\n     [[Node: gradients/Relu_grad/Relu/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"ReluGrad input is not finite.\", _device=\"/job:localhost/replica:0/task:0/cpu:0\"](add)]]\nCaused by op u'gradients/Relu_grad/Relu/CheckNumerics', defined at:\n  File \"2_cnn.py\", line 55, in <module>\n    train_step = tf.train.AdamOptimizer().minimize(loss)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 165, in minimize\n    gate_gradients=gate_gradients)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 205, in compute_gradients\n    loss, var_list, gate_gradients=(gate_gradients == Optimizer.GATE_OP))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients.py\", line 414, in gradients\n    in_grads = _AsList(grad_fn(op_wrapper, *out_grads))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 107, in _ReluGrad\n    t = _VerifyTensor(op.inputs[0], op.name, \"ReluGrad input is not finite.\")\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.py\", line 100, in _VerifyTensor\n    verify_input = array_ops.check_numerics(t, message=msg)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 48, in check_numerics\n    name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 633, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1710, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 988, in __init__\n    self._traceback = _extract_stack()\n\n...which was originally created as op u'Relu', defined at:\n  File \"2_cnn.py\", line 32, in <module>\n    h_conv1 = tf.nn.relu(conv2d(X1, w_conv1) + b_conv1)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 506, in relu\n    return _op_def_lib.apply_op(\"Relu\", features=features, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/op_def_library.py\", line 633, in apply_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1710, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 988, in __init__\n    self._traceback = _extract_stack()\n"}