{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2097", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2097/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2097/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2097/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2097", "id": 150907853, "node_id": "MDU6SXNzdWUxNTA5MDc4NTM=", "number": 2097, "title": "Undefined symbol in GPU user op", "user": {"login": "c0g", "id": 1376357, "node_id": "MDQ6VXNlcjEzNzYzNTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1376357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c0g", "html_url": "https://github.com/c0g", "followers_url": "https://api.github.com/users/c0g/followers", "following_url": "https://api.github.com/users/c0g/following{/other_user}", "gists_url": "https://api.github.com/users/c0g/gists{/gist_id}", "starred_url": "https://api.github.com/users/c0g/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c0g/subscriptions", "organizations_url": "https://api.github.com/users/c0g/orgs", "repos_url": "https://api.github.com/users/c0g/repos", "events_url": "https://api.github.com/users/c0g/events{/privacy}", "received_events_url": "https://api.github.com/users/c0g/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-04-25T15:53:01Z", "updated_at": "2016-08-13T04:52:22Z", "closed_at": "2016-04-25T16:41:51Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>Environment info</h3>\n<p>Operating System: Ubuntu 14.04</p>\n<p>Installed version of CUDA and cuDNN: 7.5, 5 (see bottom for ls output)<br>\nIf installed from sources, provide the commit hash: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/55068f32c87c73c8de7a417d8be735306e5307a1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/55068f32c87c73c8de7a417d8be735306e5307a1\"><tt>55068f3</tt></a></p>\n<h3>Steps to reproduce</h3>\n<ol>\n<li>Get BUILD, get_diag.cc, get_diag.cu.cc from <a href=\"https://github.com/c0g/tensorflow/tree/master/tensorflow/core/user_ops\">my fork</a></li>\n<li>Build the get_diag op with <code>bazel build -c opt --config cuda //tensorflow/core/user_ops:get_diag.so</code></li>\n<li>Try to run it on the GPU.</li>\n</ol>\n<p>Error messages is:<br>\n<code>tensorflow.python.framework.errors.NotFoundError: /home/tron/Source/tensorflow/bazel-bin/tensorflow/core/user_ops/get_diag.so: undefined symbol: _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_</code></p>\n<p>however, running <code>nm -an get_diag.so | grep _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_</code> shows <code>U _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_</code> , so it appears the symbol is present.</p>\n<p>This works fine with the CPU version of the op - is there something I'm missing to make Bazel link things properly?</p>\n<h3>Logs or other output that would be helpful</h3>\n<p>-rw-r--r-- 1 root root   322936 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudadevrt.a<br>\nlrwxrwxrwx 1 root root       16 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so -&gt; libcudart.so.7.5<br>\nlrwxrwxrwx 1 root root       19 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5 -&gt; libcudart.so.7.5.18<br>\n-rwxr-xr-x 1 root root   383336 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18<br>\n-rw-r--r-- 1 root root   720192 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart_static.a<br>\nlrwxrwxrwx 1 tron tron       13 Mar 22 07:44 /usr/local/cuda-7.5/lib64/libcudnn.so -&gt; libcudnn.so.5<br>\nlrwxrwxrwx 1 tron tron       17 Mar 22 07:44 /usr/local/cuda-7.5/lib64/libcudnn.so.5 -&gt; libcudnn.so.5.0.4<br>\n-rwxrwxr-x 1 tron tron 59823168 Mar 22 01:37 /usr/local/cuda-7.5/lib64/libcudnn.so.5.0.4<br>\n-rw-rw-r-- 1 tron tron 58734618 Mar 22 01:37 /usr/local/cuda-7.5/lib64/libcudnn_static.a</p>", "body_text": "Environment info\nOperating System: Ubuntu 14.04\nInstalled version of CUDA and cuDNN: 7.5, 5 (see bottom for ls output)\nIf installed from sources, provide the commit hash: 55068f3\nSteps to reproduce\n\nGet BUILD, get_diag.cc, get_diag.cu.cc from my fork\nBuild the get_diag op with bazel build -c opt --config cuda //tensorflow/core/user_ops:get_diag.so\nTry to run it on the GPU.\n\nError messages is:\ntensorflow.python.framework.errors.NotFoundError: /home/tron/Source/tensorflow/bazel-bin/tensorflow/core/user_ops/get_diag.so: undefined symbol: _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_\nhowever, running nm -an get_diag.so | grep _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_ shows U _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_ , so it appears the symbol is present.\nThis works fine with the CPU version of the op - is there something I'm missing to make Bazel link things properly?\nLogs or other output that would be helpful\n-rw-r--r-- 1 root root   322936 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudadevrt.a\nlrwxrwxrwx 1 root root       16 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so -> libcudart.so.7.5\nlrwxrwxrwx 1 root root       19 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5 -> libcudart.so.7.5.18\n-rwxr-xr-x 1 root root   383336 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18\n-rw-r--r-- 1 root root   720192 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart_static.a\nlrwxrwxrwx 1 tron tron       13 Mar 22 07:44 /usr/local/cuda-7.5/lib64/libcudnn.so -> libcudnn.so.5\nlrwxrwxrwx 1 tron tron       17 Mar 22 07:44 /usr/local/cuda-7.5/lib64/libcudnn.so.5 -> libcudnn.so.5.0.4\n-rwxrwxr-x 1 tron tron 59823168 Mar 22 01:37 /usr/local/cuda-7.5/lib64/libcudnn.so.5.0.4\n-rw-rw-r-- 1 tron tron 58734618 Mar 22 01:37 /usr/local/cuda-7.5/lib64/libcudnn_static.a", "body": "### Environment info\n\nOperating System: Ubuntu 14.04\n\nInstalled version of CUDA and cuDNN: 7.5, 5 (see bottom for ls output)\nIf installed from sources, provide the commit hash: 55068f32c87c73c8de7a417d8be735306e5307a1\n### Steps to reproduce\n1. Get BUILD, get_diag.cc, get_diag.cu.cc from [my fork](https://github.com/c0g/tensorflow/tree/master/tensorflow/core/user_ops)\n2. Build the get_diag op with `bazel build -c opt --config cuda //tensorflow/core/user_ops:get_diag.so`\n3. Try to run it on the GPU.\n\nError messages is: \n`\ntensorflow.python.framework.errors.NotFoundError: /home/tron/Source/tensorflow/bazel-bin/tensorflow/core/user_ops/get_diag.so: undefined symbol: _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_\n`\n\nhowever, running `nm -an get_diag.so | grep _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_` shows `U _Z21GetDiagKernelLauncherIdEvPKT_iiPS0_` , so it appears the symbol is present.\n\nThis works fine with the CPU version of the op - is there something I'm missing to make Bazel link things properly?\n### Logs or other output that would be helpful\n\n-rw-r--r-- 1 root root   322936 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudadevrt.a\nlrwxrwxrwx 1 root root       16 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so -> libcudart.so.7.5\nlrwxrwxrwx 1 root root       19 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5 -> libcudart.so.7.5.18\n-rwxr-xr-x 1 root root   383336 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart.so.7.5.18\n-rw-r--r-- 1 root root   720192 Aug 15  2015 /usr/local/cuda-7.5/lib64/libcudart_static.a\nlrwxrwxrwx 1 tron tron       13 Mar 22 07:44 /usr/local/cuda-7.5/lib64/libcudnn.so -> libcudnn.so.5\nlrwxrwxrwx 1 tron tron       17 Mar 22 07:44 /usr/local/cuda-7.5/lib64/libcudnn.so.5 -> libcudnn.so.5.0.4\n-rwxrwxr-x 1 tron tron 59823168 Mar 22 01:37 /usr/local/cuda-7.5/lib64/libcudnn.so.5.0.4\n-rw-rw-r-- 1 tron tron 58734618 Mar 22 01:37 /usr/local/cuda-7.5/lib64/libcudnn_static.a\n"}