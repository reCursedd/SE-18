{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16934", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16934/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16934/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16934/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16934", "id": 296189855, "node_id": "MDU6SXNzdWUyOTYxODk4NTU=", "number": 16934, "title": "Can not create confusion_matrix", "user": {"login": "lachaka", "id": 14894633, "node_id": "MDQ6VXNlcjE0ODk0NjMz", "avatar_url": "https://avatars0.githubusercontent.com/u/14894633?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lachaka", "html_url": "https://github.com/lachaka", "followers_url": "https://api.github.com/users/lachaka/followers", "following_url": "https://api.github.com/users/lachaka/following{/other_user}", "gists_url": "https://api.github.com/users/lachaka/gists{/gist_id}", "starred_url": "https://api.github.com/users/lachaka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lachaka/subscriptions", "organizations_url": "https://api.github.com/users/lachaka/orgs", "repos_url": "https://api.github.com/users/lachaka/repos", "events_url": "https://api.github.com/users/lachaka/events{/privacy}", "received_events_url": "https://api.github.com/users/lachaka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-02-11T13:26:19Z", "updated_at": "2018-02-20T16:58:52Z", "closed_at": "2018-02-20T12:29:17Z", "author_association": "NONE", "body_html": "<p>This is my code for the network. I am using tensorflow 1.4 and I am using my nvidia for training. The code is working. I want to create a confusion matrix and I do it like this</p>\n<pre><code>with tf.device('/device:GPU:0'):    \n    images = tf.placeholder(tf.float32, [None, IMAGE_WIDTH, IMAGE_LENGTH, 3])\n    labels = tf.placeholder(tf.int64, [None])\n\n    flat = tf.layers.flatten(labels)\n    logits = tf.layers.dense(flat, len(set(train_labels_arr)), tf.nn.relu)\n\n    predicted_labels = tf.argmax(tf.nn.softmax(logits), 1)\n\n    cross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(logits = logits,\n                                                               labels = labels)\n    loss = tf.reduce_mean(cross_entropy)\n\n    optimizer = tf.train.AdamOptimizer(learning_rate=0.001).minimize(loss)\n    correct_prediction = tf.equal(predicted_labels, labels)\n    accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))\n\n    init = tf.global_variables_initializer()\n</code></pre>\n<p>I want to create a confusion matrix and I do it like this:</p>\n<pre><code> confusion_matrix = tf.confusion_matrix(labels=labels, predictions=predicted_labels,\n                                      num_classes=len(set(train_labels_arr)),dtype=tf.int64)\n</code></pre>\n<p>When I call:</p>\n<pre><code>session = tf.Session()\nsession.run(init) \n</code></pre>\n<p>I got very weird error, but if remove the line with the confusion_matrix everything is ok: InvalidArgumentError: Cannot assign a device for operation 'confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.<br>\n[[Node: confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_STRING, DT_INT64], summarize=3, _device=\"/device:GPU:0\"](confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/Switch, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_0, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_1, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_2, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/Switch_1)]]</p>\n<p>Caused by op u'confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert', defined at:<br>\nFile \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main<br>\n\"<strong>main</strong>\", fname, loader, pkg_name)<br>\nFile \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code<br>\nexec code in run_globals<br>\nFile \"/home/lachaka/tensorflow/lib/python2.7/site-packages/ipykernel_launcher.py\", line 16, in <br>\napp.launch_new_instance()<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance<br>\napp.start()<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 478, in start<br>\nself.io_loop.start()<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 177, in start<br>\nsuper(ZMQIOLoop, self).start()<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/ioloop.py\", line 888, in start<br>\nhandler_func(fd_obj, events)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 277, in null_wrapper<br>\nreturn fn(*args, **kwargs)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events<br>\nself._handle_recv()<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv<br>\nself._run_callback(callback, msg)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback<br>\ncallback(*args, **kwargs)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 277, in null_wrapper<br>\nreturn fn(*args, **kwargs)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher<br>\nreturn self.dispatch_shell(stream, msg)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell<br>\nhandler(stream, idents, msg)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request<br>\nuser_expressions, allow_stdin)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute<br>\nres = shell.run_cell(code, store_history=store_history, silent=silent)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell<br>\nreturn super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2718, in run_cell<br>\ninteractivity=interactivity, compiler=compiler, result=result)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2822, in run_ast_nodes<br>\nif self.run_code(code, result):<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2882, in run_code<br>\nexec(code_obj, self.user_global_ns, self.user_ns)<br>\nFile \"\", line 41, in <br>\nnum_classes=len(set(train_labels_arr)),dtype=tf.int64)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/confusion_matrix.py\", line 162, in confusion_matrix<br>\nlabels, message='<code>labels</code> contains negative values')],<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/check_ops.py\", line 237, in assert_non_negative<br>\nreturn assert_less_equal(zero, x, data=data, summarize=summarize)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/check_ops.py\", line 443, in assert_less_equal<br>\nreturn control_flow_ops.Assert(condition, data, summarize=summarize)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped<br>\nreturn _add_should_use_warning(fn(*args, **kwargs))<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 134, in Assert<br>\ncondition, no_op, true_assert, name=\"AssertGuard\")<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 316, in new_func<br>\nreturn func(*args, **kwargs)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1864, in cond<br>\norig_res_f, res_f = context_f.BuildCondBranch(false_fn)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1725, in BuildCondBranch<br>\noriginal_result = fn()<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 132, in true_assert<br>\ncondition, data, summarize, name=\"Assert\")<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 47, in _assert<br>\nname=name)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper<br>\nop_def=op_def)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op<br>\nop_def=op_def)<br>\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1470, in <strong>init</strong><br>\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access</p>", "body_text": "This is my code for the network. I am using tensorflow 1.4 and I am using my nvidia for training. The code is working. I want to create a confusion matrix and I do it like this\nwith tf.device('/device:GPU:0'):    \n    images = tf.placeholder(tf.float32, [None, IMAGE_WIDTH, IMAGE_LENGTH, 3])\n    labels = tf.placeholder(tf.int64, [None])\n\n    flat = tf.layers.flatten(labels)\n    logits = tf.layers.dense(flat, len(set(train_labels_arr)), tf.nn.relu)\n\n    predicted_labels = tf.argmax(tf.nn.softmax(logits), 1)\n\n    cross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(logits = logits,\n                                                               labels = labels)\n    loss = tf.reduce_mean(cross_entropy)\n\n    optimizer = tf.train.AdamOptimizer(learning_rate=0.001).minimize(loss)\n    correct_prediction = tf.equal(predicted_labels, labels)\n    accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))\n\n    init = tf.global_variables_initializer()\n\nI want to create a confusion matrix and I do it like this:\n confusion_matrix = tf.confusion_matrix(labels=labels, predictions=predicted_labels,\n                                      num_classes=len(set(train_labels_arr)),dtype=tf.int64)\n\nWhen I call:\nsession = tf.Session()\nsession.run(init) \n\nI got very weird error, but if remove the line with the confusion_matrix everything is ok: InvalidArgumentError: Cannot assign a device for operation 'confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\n[[Node: confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_STRING, DT_INT64], summarize=3, _device=\"/device:GPU:0\"](confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/Switch, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_0, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_1, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_2, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/Switch_1)]]\nCaused by op u'confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert', defined at:\nFile \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n\"main\", fname, loader, pkg_name)\nFile \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\nexec code in run_globals\nFile \"/home/lachaka/tensorflow/lib/python2.7/site-packages/ipykernel_launcher.py\", line 16, in \napp.launch_new_instance()\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\napp.start()\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 478, in start\nself.io_loop.start()\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 177, in start\nsuper(ZMQIOLoop, self).start()\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/ioloop.py\", line 888, in start\nhandler_func(fd_obj, events)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 277, in null_wrapper\nreturn fn(*args, **kwargs)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\nself._handle_recv()\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\nself._run_callback(callback, msg)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\ncallback(*args, **kwargs)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 277, in null_wrapper\nreturn fn(*args, **kwargs)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\nreturn self.dispatch_shell(stream, msg)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\nhandler(stream, idents, msg)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\nuser_expressions, allow_stdin)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\nres = shell.run_cell(code, store_history=store_history, silent=silent)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\nreturn super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2718, in run_cell\ninteractivity=interactivity, compiler=compiler, result=result)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2822, in run_ast_nodes\nif self.run_code(code, result):\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\nexec(code_obj, self.user_global_ns, self.user_ns)\nFile \"\", line 41, in \nnum_classes=len(set(train_labels_arr)),dtype=tf.int64)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/confusion_matrix.py\", line 162, in confusion_matrix\nlabels, message='labels contains negative values')],\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/check_ops.py\", line 237, in assert_non_negative\nreturn assert_less_equal(zero, x, data=data, summarize=summarize)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/check_ops.py\", line 443, in assert_less_equal\nreturn control_flow_ops.Assert(condition, data, summarize=summarize)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\nreturn _add_should_use_warning(fn(*args, **kwargs))\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 134, in Assert\ncondition, no_op, true_assert, name=\"AssertGuard\")\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 316, in new_func\nreturn func(*args, **kwargs)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1864, in cond\norig_res_f, res_f = context_f.BuildCondBranch(false_fn)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1725, in BuildCondBranch\noriginal_result = fn()\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 132, in true_assert\ncondition, data, summarize, name=\"Assert\")\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 47, in _assert\nname=name)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\nop_def=op_def)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\nop_def=op_def)\nFile \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1470, in init\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access", "body": "This is my code for the network. I am using tensorflow 1.4 and I am using my nvidia for training. The code is working. I want to create a confusion matrix and I do it like this \r\n\r\n\r\n\r\n    with tf.device('/device:GPU:0'):    \r\n        images = tf.placeholder(tf.float32, [None, IMAGE_WIDTH, IMAGE_LENGTH, 3])\r\n        labels = tf.placeholder(tf.int64, [None])\r\n\r\n        flat = tf.layers.flatten(labels)\r\n        logits = tf.layers.dense(flat, len(set(train_labels_arr)), tf.nn.relu)\r\n\r\n        predicted_labels = tf.argmax(tf.nn.softmax(logits), 1)\r\n\r\n        cross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(logits = logits,\r\n                                                                   labels = labels)\r\n        loss = tf.reduce_mean(cross_entropy)\r\n\r\n        optimizer = tf.train.AdamOptimizer(learning_rate=0.001).minimize(loss)\r\n        correct_prediction = tf.equal(predicted_labels, labels)\r\n        accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))\r\n\r\n        init = tf.global_variables_initializer()\r\n\r\nI want to create a confusion matrix and I do it like this:\r\n\r\n     confusion_matrix = tf.confusion_matrix(labels=labels, predictions=predicted_labels,\r\n                                          num_classes=len(set(train_labels_arr)),dtype=tf.int64)\r\nWhen I call: \r\n\r\n    session = tf.Session()\r\n    session.run(init) \r\n\r\nI got very weird error, but if remove the line with the confusion_matrix everything is ok: InvalidArgumentError: Cannot assign a device for operation 'confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert': Could not satisfy explicit device specification '/device:GPU:0' because no supported kernel for GPU devices is available.\r\n\t [[Node: confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_STRING, DT_INT64], summarize=3, _device=\"/device:GPU:0\"](confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/Switch, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_0, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_1, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/data_2, confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert/Switch_1)]]\r\n\r\nCaused by op u'confusion_matrix_4/assert_non_negative/assert_less_equal/Assert/AssertGuard/Assert', defined at:\r\n  File \"/usr/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\r\n    \"__main__\", fname, loader, pkg_name)\r\n  File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\r\n    exec code in run_globals\r\n  File \"/home/lachaka/tensorflow/lib/python2.7/site-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 478, in start\r\n    self.io_loop.start()\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 177, in start\r\n    super(ZMQIOLoop, self).start()\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/ioloop.py\", line 888, in start\r\n    handler_func(fd_obj, events)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\r\n    self._handle_recv()\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 233, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 208, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 537, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2718, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2822, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-27-64238c75dfbf>\", line 41, in <module>\r\n    num_classes=len(set(train_labels_arr)),dtype=tf.int64)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/confusion_matrix.py\", line 162, in confusion_matrix\r\n    labels, message='`labels` contains negative values')],\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/check_ops.py\", line 237, in assert_non_negative\r\n    return assert_less_equal(zero, x, data=data, summarize=summarize)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/check_ops.py\", line 443, in assert_less_equal\r\n    return control_flow_ops.Assert(condition, data, summarize=summarize)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/util/tf_should_use.py\", line 107, in wrapped\r\n    return _add_should_use_warning(fn(*args, **kwargs))\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 134, in Assert\r\n    condition, no_op, true_assert, name=\"AssertGuard\")\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 316, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1864, in cond\r\n    orig_res_f, res_f = context_f.BuildCondBranch(false_fn)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 1725, in BuildCondBranch\r\n    original_result = fn()\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 132, in true_assert\r\n    condition, data, summarize, name=\"Assert\")\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 47, in _assert\r\n    name=name)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2956, in create_op\r\n    op_def=op_def)\r\n  File \"/home/lachaka/tensorflow/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1470, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access"}