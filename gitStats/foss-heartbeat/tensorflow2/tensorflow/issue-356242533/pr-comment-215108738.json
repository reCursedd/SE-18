{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/215108738", "pull_request_review_id": 152302989, "id": 215108738, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNTEwODczOA==", "diff_hunk": "@@ -778,6 +778,8 @@ def shard(self, num_shards, index):\n \n     - Be sure to shard before you use any randomizing operator (such as\n       shuffle).\n+    - Invoking repeat before shuffle may blur epoch boundaries. Consider", "path": "tensorflow/python/data/ops/dataset_ops.py", "position": 4, "original_position": 4, "commit_id": "2e3da0c0fd7b7883621821f75f66ace4f27edb84", "original_commit_id": "2e3da0c0fd7b7883621821f75f66ace4f27edb84", "user": {"login": "ntenenz", "id": 8411908, "node_id": "MDQ6VXNlcjg0MTE5MDg=", "avatar_url": "https://avatars3.githubusercontent.com/u/8411908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ntenenz", "html_url": "https://github.com/ntenenz", "followers_url": "https://api.github.com/users/ntenenz/followers", "following_url": "https://api.github.com/users/ntenenz/following{/other_user}", "gists_url": "https://api.github.com/users/ntenenz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ntenenz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ntenenz/subscriptions", "organizations_url": "https://api.github.com/users/ntenenz/orgs", "repos_url": "https://api.github.com/users/ntenenz/repos", "events_url": "https://api.github.com/users/ntenenz/events{/privacy}", "received_events_url": "https://api.github.com/users/ntenenz/received_events", "type": "User", "site_admin": false}, "body": "Technically, both are true.\r\n* `repeat` before `shard` can bring into the current epoch elements from the next epoch.\r\n* `repeat` before `shuffle` can move elements in and out of the current epoch.\r\n\r\nThe intention was to call out the latter (hence the suggestion of `shuffle_and_repeat`). While not necessarily relevant to `shard` itself and thus perhaps it should be omitted for brevity, the sample code may result in certain undesirable effects that the end user should be aware of. While this is explicitly addressed in the Performance Guide, I'm not sure if I've seen it anywhere else (e.g., documentation for `repeat` or `shuffle`).\r\n\r\nRegarding the former point, it is implicitly addressed by the bullet below but I can call it out directly to make it clear if desired.\r\n\r\n_TL;DR_: It's a minor documentation update trying to point users in the right direction, so feel free to close if you feel it's unnecessary (it very well may be) or suggest a change that might be more helpful.", "created_at": "2018-09-05T00:52:50Z", "updated_at": "2018-09-05T00:52:51Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/22010#discussion_r215108738", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22010", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/215108738"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/22010#discussion_r215108738"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22010"}}, "body_html": "<p>Technically, both are true.</p>\n<ul>\n<li><code>repeat</code> before <code>shard</code> can bring into the current epoch elements from the next epoch.</li>\n<li><code>repeat</code> before <code>shuffle</code> can move elements in and out of the current epoch.</li>\n</ul>\n<p>The intention was to call out the latter (hence the suggestion of <code>shuffle_and_repeat</code>). While not necessarily relevant to <code>shard</code> itself and thus perhaps it should be omitted for brevity, the sample code may result in certain undesirable effects that the end user should be aware of. While this is explicitly addressed in the Performance Guide, I'm not sure if I've seen it anywhere else (e.g., documentation for <code>repeat</code> or <code>shuffle</code>).</p>\n<p>Regarding the former point, it is implicitly addressed by the bullet below but I can call it out directly to make it clear if desired.</p>\n<p><em>TL;DR</em>: It's a minor documentation update trying to point users in the right direction, so feel free to close if you feel it's unnecessary (it very well may be) or suggest a change that might be more helpful.</p>", "body_text": "Technically, both are true.\n\nrepeat before shard can bring into the current epoch elements from the next epoch.\nrepeat before shuffle can move elements in and out of the current epoch.\n\nThe intention was to call out the latter (hence the suggestion of shuffle_and_repeat). While not necessarily relevant to shard itself and thus perhaps it should be omitted for brevity, the sample code may result in certain undesirable effects that the end user should be aware of. While this is explicitly addressed in the Performance Guide, I'm not sure if I've seen it anywhere else (e.g., documentation for repeat or shuffle).\nRegarding the former point, it is implicitly addressed by the bullet below but I can call it out directly to make it clear if desired.\nTL;DR: It's a minor documentation update trying to point users in the right direction, so feel free to close if you feel it's unnecessary (it very well may be) or suggest a change that might be more helpful.", "in_reply_to_id": 215017540}