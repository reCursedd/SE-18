{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22226", "id": 359342694, "node_id": "MDU6SXNzdWUzNTkzNDI2OTQ=", "number": 22226, "title": "Orthogonal initialization gives inaccurate result when running on GPU", "user": {"login": "dargilboa", "id": 16104218, "node_id": "MDQ6VXNlcjE2MTA0MjE4", "avatar_url": "https://avatars1.githubusercontent.com/u/16104218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dargilboa", "html_url": "https://github.com/dargilboa", "followers_url": "https://api.github.com/users/dargilboa/followers", "following_url": "https://api.github.com/users/dargilboa/following{/other_user}", "gists_url": "https://api.github.com/users/dargilboa/gists{/gist_id}", "starred_url": "https://api.github.com/users/dargilboa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dargilboa/subscriptions", "organizations_url": "https://api.github.com/users/dargilboa/orgs", "repos_url": "https://api.github.com/users/dargilboa/repos", "events_url": "https://api.github.com/users/dargilboa/events{/privacy}", "received_events_url": "https://api.github.com/users/dargilboa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-09-12T07:06:10Z", "updated_at": "2018-11-23T18:39:42Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code</strong>: see example below</li>\n<li><strong>OS Platform and Distribution</strong>:Google Colabratory (also in compiled code on Linux)</li>\n<li><strong>Mobile device</strong>: N/A</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Google Colabratory</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.10.1</li>\n<li><strong>Python version</strong>: 2.7.14</li>\n<li><strong>Bazel version (if compiling from source)</strong>:  N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:  N/A</li>\n<li><strong>CUDA/cuDNN version</strong>:  N/A</li>\n<li><strong>GPU model and memory</strong>: Issue occurred both on Telsa V100 and Tesla K80 with at least 11GB of available memory (but not when using CPU runtime)</li>\n<li><strong>Exact command to reproduce</strong>: see example below</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>When generating an orthogonal matrix and running on a GPU, if the matrix is 1000x1000 or larger the resulting matrix is not orthogonal. The deviations are several orders of magnitude larger than expected from finite precision errors.<br>\nThe issue doesn't occur for smaller n (say 100) or when running on a CPU.</p>\n<p>In the example below, the final result has entry-wise deviations from the identity matrix of order 1e-2.</p>\n<h3>Source code / logs</h3>\n<pre><code>import tensorflow as tf\ntf.enable_eager_execution()\ntf.set_random_seed(0)\ninit = tf.orthogonal_initializer(1,seed=0)\na = init([1000,1000])\ntf.matmul(a,tf.transpose(a))\n</code></pre>", "body_text": "System information\n\nHave I written custom code: see example below\nOS Platform and Distribution:Google Colabratory (also in compiled code on Linux)\nMobile device: N/A\nTensorFlow installed from (source or binary): Google Colabratory\nTensorFlow version (use command below): 1.10.1\nPython version: 2.7.14\nBazel version (if compiling from source):  N/A\nGCC/Compiler version (if compiling from source):  N/A\nCUDA/cuDNN version:  N/A\nGPU model and memory: Issue occurred both on Telsa V100 and Tesla K80 with at least 11GB of available memory (but not when using CPU runtime)\nExact command to reproduce: see example below\n\nDescribe the problem\nWhen generating an orthogonal matrix and running on a GPU, if the matrix is 1000x1000 or larger the resulting matrix is not orthogonal. The deviations are several orders of magnitude larger than expected from finite precision errors.\nThe issue doesn't occur for smaller n (say 100) or when running on a CPU.\nIn the example below, the final result has entry-wise deviations from the identity matrix of order 1e-2.\nSource code / logs\nimport tensorflow as tf\ntf.enable_eager_execution()\ntf.set_random_seed(0)\ninit = tf.orthogonal_initializer(1,seed=0)\na = init([1000,1000])\ntf.matmul(a,tf.transpose(a))", "body": "### System information\r\n- **Have I written custom code**: see example below\r\n- **OS Platform and Distribution**:Google Colabratory (also in compiled code on Linux)\r\n- **Mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: Google Colabratory\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 2.7.14 \r\n- **Bazel version (if compiling from source)**:  N/A\r\n- **GCC/Compiler version (if compiling from source)**:  N/A\r\n- **CUDA/cuDNN version**:  N/A\r\n- **GPU model and memory**: Issue occurred both on Telsa V100 and Tesla K80 with at least 11GB of available memory (but not when using CPU runtime)\r\n- **Exact command to reproduce**: see example below\r\n\r\n### Describe the problem\r\nWhen generating an orthogonal matrix and running on a GPU, if the matrix is 1000x1000 or larger the resulting matrix is not orthogonal. The deviations are several orders of magnitude larger than expected from finite precision errors.\r\nThe issue doesn't occur for smaller n (say 100) or when running on a CPU.\r\n\r\nIn the example below, the final result has entry-wise deviations from the identity matrix of order 1e-2.\r\n\r\n### Source code / logs\r\n \r\n\r\n```\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\ntf.set_random_seed(0)\r\ninit = tf.orthogonal_initializer(1,seed=0)\r\na = init([1000,1000])\r\ntf.matmul(a,tf.transpose(a))\r\n```\r\n"}