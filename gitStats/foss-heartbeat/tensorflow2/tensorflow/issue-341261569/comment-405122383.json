{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/405122383", "html_url": "https://github.com/tensorflow/tensorflow/issues/20805#issuecomment-405122383", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20805", "id": 405122383, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTEyMjM4Mw==", "user": {"login": "nairouz", "id": 10966954, "node_id": "MDQ6VXNlcjEwOTY2OTU0", "avatar_url": "https://avatars0.githubusercontent.com/u/10966954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nairouz", "html_url": "https://github.com/nairouz", "followers_url": "https://api.github.com/users/nairouz/followers", "following_url": "https://api.github.com/users/nairouz/following{/other_user}", "gists_url": "https://api.github.com/users/nairouz/gists{/gist_id}", "starred_url": "https://api.github.com/users/nairouz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nairouz/subscriptions", "organizations_url": "https://api.github.com/users/nairouz/orgs", "repos_url": "https://api.github.com/users/nairouz/repos", "events_url": "https://api.github.com/users/nairouz/events{/privacy}", "received_events_url": "https://api.github.com/users/nairouz/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-15T22:11:41Z", "updated_at": "2018-07-15T23:31:09Z", "author_association": "NONE", "body_html": "<p>Even the simplistic custom layer from the Keras documentation  produces the same error:</p>\n<p><a href=\"url\">https://keras.io/layers/writing-your-own-keras-layers/</a></p>\n<pre><code>class MyLayer(Layer):\n\n    def __init__(self, output_dim, **kwargs):\n        self.output_dim = output_dim\n        super(MyLayer, self).__init__(**kwargs)\n\n    def build(self, input_shape):\n        # Create a trainable weight variable for this layer.\n        self.kernel = self.add_weight(name='kernel', \n                                  shape=(input_shape[1].value, self.output_dim),\n                                  initializer='uniform',\n                                  trainable=True)\n        super(MyLayer, self).build(input_shape)  # Be sure to call this at the end\n\n    def call(self, x):\n        return K.dot(x, self.kernel)\n\n    def compute_output_shape(self, input_shape):\n        return (input_shape[0], self.output_dim)`\n</code></pre>\n<p>I  also made sure to verify that it has nothing to do with my custom loss function by trying the vanilla mean_square_error, but still the same error. I have asked the same question on Stackoverflow and I didn't receive any response till now:<br>\n<a href=\"url\">https://stackoverflow.com/questions/51342304/keras-custom-layer-and-eager-execution</a><br>\nI think it is more like a bug.</p>", "body_text": "Even the simplistic custom layer from the Keras documentation  produces the same error:\nhttps://keras.io/layers/writing-your-own-keras-layers/\nclass MyLayer(Layer):\n\n    def __init__(self, output_dim, **kwargs):\n        self.output_dim = output_dim\n        super(MyLayer, self).__init__(**kwargs)\n\n    def build(self, input_shape):\n        # Create a trainable weight variable for this layer.\n        self.kernel = self.add_weight(name='kernel', \n                                  shape=(input_shape[1].value, self.output_dim),\n                                  initializer='uniform',\n                                  trainable=True)\n        super(MyLayer, self).build(input_shape)  # Be sure to call this at the end\n\n    def call(self, x):\n        return K.dot(x, self.kernel)\n\n    def compute_output_shape(self, input_shape):\n        return (input_shape[0], self.output_dim)`\n\nI  also made sure to verify that it has nothing to do with my custom loss function by trying the vanilla mean_square_error, but still the same error. I have asked the same question on Stackoverflow and I didn't receive any response till now:\nhttps://stackoverflow.com/questions/51342304/keras-custom-layer-and-eager-execution\nI think it is more like a bug.", "body": "Even the simplistic custom layer from the Keras documentation  produces the same error:\r\n\r\n[https://keras.io/layers/writing-your-own-keras-layers/](url)\r\n\r\n    class MyLayer(Layer):\r\n\r\n        def __init__(self, output_dim, **kwargs):\r\n            self.output_dim = output_dim\r\n            super(MyLayer, self).__init__(**kwargs)\r\n\r\n        def build(self, input_shape):\r\n            # Create a trainable weight variable for this layer.\r\n            self.kernel = self.add_weight(name='kernel', \r\n                                      shape=(input_shape[1].value, self.output_dim),\r\n                                      initializer='uniform',\r\n                                      trainable=True)\r\n            super(MyLayer, self).build(input_shape)  # Be sure to call this at the end\r\n\r\n        def call(self, x):\r\n            return K.dot(x, self.kernel)\r\n\r\n        def compute_output_shape(self, input_shape):\r\n            return (input_shape[0], self.output_dim)`\r\n\r\nI  also made sure to verify that it has nothing to do with my custom loss function by trying the vanilla mean_square_error, but still the same error. I have asked the same question on Stackoverflow and I didn't receive any response till now:\r\n[https://stackoverflow.com/questions/51342304/keras-custom-layer-and-eager-execution](url)\r\nI think it is more like a bug."}