{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10464", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10464/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10464/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10464/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10464", "id": 233928225, "node_id": "MDU6SXNzdWUyMzM5MjgyMjU=", "number": 10464, "title": "Expected dimension in the range [-1, 1), but got 1", "user": {"login": "jeremygoetz", "id": 19783847, "node_id": "MDQ6VXNlcjE5NzgzODQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/19783847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeremygoetz", "html_url": "https://github.com/jeremygoetz", "followers_url": "https://api.github.com/users/jeremygoetz/followers", "following_url": "https://api.github.com/users/jeremygoetz/following{/other_user}", "gists_url": "https://api.github.com/users/jeremygoetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeremygoetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeremygoetz/subscriptions", "organizations_url": "https://api.github.com/users/jeremygoetz/orgs", "repos_url": "https://api.github.com/users/jeremygoetz/repos", "events_url": "https://api.github.com/users/jeremygoetz/events{/privacy}", "received_events_url": "https://api.github.com/users/jeremygoetz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-06-06T15:19:25Z", "updated_at": "2017-06-07T22:52:47Z", "closed_at": "2017-06-07T22:52:47Z", "author_association": "NONE", "body_html": "<p>the error</p>\n<p>InvalidArgumentError                      Traceback (most recent call last)<br>\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)<br>\n1021     try:<br>\n-&gt; 1022       return fn(*args)<br>\n1023     except errors.OpError as e:</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(session, feed_dict, fetch_list, target_list, options, run_metadata)<br>\n1003                                  feed_dict, fetch_list, target_list,<br>\n-&gt; 1004                                  status, run_metadata)<br>\n1005</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\contextlib.py in <strong>exit</strong>(self, type, value, traceback)<br>\n65             try:<br>\n---&gt; 66                 next(self.gen)<br>\n67             except StopIteration:</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()<br>\n465           compat.as_text(pywrap_tensorflow.TF_Message(status)),<br>\n--&gt; 466           pywrap_tensorflow.TF_GetCode(status))<br>\n467   finally:</p>\n<p>InvalidArgumentError: Expected dimension in the range [-1, 1), but got 1<br>\n[[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>InvalidArgumentError                      Traceback (most recent call last)<br>\n in ()<br>\n1 batch_xs, batch_ys = dm.loadbatch(151,\"data/NoneNematic/validate/NoneNematic\",0)<br>\n----&gt; 2 print(sess.run(accuracy, feed_dict={x: batch_xs, z_: batch_ys}))</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)<br>\n765     try:<br>\n766       result = self._run(None, fetches, feed_dict, options_ptr,<br>\n--&gt; 767                          run_metadata_ptr)<br>\n768       if run_metadata:<br>\n769         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)<br>\n963     if final_fetches or final_targets:<br>\n964       results = self._do_run(handle, final_targets, final_fetches,<br>\n--&gt; 965                              feed_dict_string, options, run_metadata)<br>\n966     else:<br>\n967       results = []</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)<br>\n1013     if handle is None:<br>\n1014       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,<br>\n-&gt; 1015                            target_list, options, run_metadata)<br>\n1016     else:<br>\n1017       return self._do_call(_prun_fn, self._session, handle, feed_dict,</p>\n<p>C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)<br>\n1033         except KeyError:<br>\n1034           pass<br>\n-&gt; 1035       raise type(e)(node_def, op, message)<br>\n1036<br>\n1037   def _extend_graph(self):</p>\n<p>InvalidArgumentError: Expected dimension in the range [-1, 1), but got 1<br>\n[[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]</p>\n<p>Caused by op 'ArgMax_1', defined at:<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\runpy.py\", line 193, in _run_module_as_main<br>\n\"<strong>main</strong>\", mod_spec)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\runpy.py\", line 85, in _run_code<br>\nexec(code, run_globals)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel_launcher.py\", line 16, in <br>\napp.launch_new_instance()<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance<br>\napp.start()<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 477, in start<br>\nioloop.IOLoop.instance().start()<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\ioloop.py\", line 177, in start<br>\nsuper(ZMQIOLoop, self).start()<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\ioloop.py\", line 887, in start<br>\nhandler_func(fd_obj, events)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\stack_context.py\", line 275, in null_wrapper<br>\nreturn fn(*args, **kwargs)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 440, in _handle_events<br>\nself._handle_recv()<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 472, in _handle_recv<br>\nself._run_callback(callback, msg)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 414, in <em>run_callback<br>\ncallback(*args, **kwargs)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\stack_context.py\", line 275, in null_wrapper<br>\nreturn fn(*args, **kwargs)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 283, in dispatcher<br>\nreturn self.dispatch_shell(stream, msg)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 235, in dispatch_shell<br>\nhandler(stream, idents, msg)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 399, in execute_request<br>\nuser_expressions, allow_stdin)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 196, in do_execute<br>\nres = shell.run_cell(code, store_history=store_history, silent=silent)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 533, in run_cell<br>\nreturn super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2717, in run_cell<br>\ninteractivity=interactivity, compiler=compiler, result=result)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2821, in run_ast_nodes<br>\nif self.run_code(code, result):<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2881, in run_code<br>\nexec(code_obj, self.user_global_ns, self.user_ns)<br>\nFile \"\", line 1, in <br>\ncorrect_prediction = tf.equal(tf.argmax(z,1), tf.argmax(z</em>,1))<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 173, in argmax<br>\nreturn gen_math_ops.arg_max(input, axis, name)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 168, in arg_max<br>\nname=name)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op<br>\nop_def=op_def)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): Expected dimension in the range [-1, 1), but got 1<br>\n[[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]</p>\n<p>the code<br>\nSTM Data intermediate brain<br>\nImport dataset and tensorflow<br>\nIn [ ]:</p>\n<p>import tensorflow as tf<br>\nimport math<br>\nIn [ ]:</p>\n<p>import datamaker as dm<br>\nimport matplotlib.pyplot as plt<br>\nimport numpy as np<br>\nDefine the Model<br>\nIn [ ]:</p>\n<p>Nhidden=1024<br>\nIMAGE_SIZE = 30<br>\nIMAGE_PIXELS = IMAGE_SIZE * IMAGE_SIZE<br>\nNUM_CLASSES = 2<br>\nIn [ ]:</p>\n<p>x = tf.placeholder(tf.float32, [None, IMAGE_PIXELS])<br>\nIn [ ]:</p>\n<p>W = tf.Variable(tf.zeros([IMAGE_PIXELS, Nhidden]))<br>\nb = tf.Variable(tf.zeros([Nhidden]))<br>\nIn [ ]:</p>\n<p>y = tf.nn.relu(tf.matmul(x, W) + b)<br>\nIn [ ]:</p>\n<p>V = tf.Variable(tf.zeros([Nhidden,NUM_CLASSES]))<br>\na = tf.Variable(tf.zeros([NUM_CLASSES]))<br>\nIn [ ]:</p>\n<p>z = tf.nn.softmax(tf.matmul(y,V)+a)<br>\nIn [ ]:</p>\n<p>y_ = tf.placeholder(tf.float32, [None, Nhidden])<br>\nIn [ ]:</p>\n<p>z_ = tf.placeholder(tf.int32, [100])<br>\nDefine the cost/loss function and training algorithm<br>\nIn [ ]:</p>\n<p>#cross_entropy1 = tf.nn.softmax_cross_entropy_with_logits(labels=y_,logits=tf.matmul(x, W) + b)<br>\nIn [ ]:</p>\n<p>#train_step1 = tf.train.GradientDescentOptimizer(0.5).minimize(cross_entropy1)<br>\nIn [ ]:</p>\n<p>cross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(labels=z_,logits=tf.matmul(y,V)+a)<br>\nIn [ ]:</p>\n<p>loss = tf.reduce_mean(cross_entropy)<br>\nIn [ ]:</p>\n<p>train_step = tf.train.GradientDescentOptimizer(0.5).minimize(loss)<br>\nTrain the model<br>\nIn [ ]:</p>\n<p>sess = tf.InteractiveSession()<br>\nIn [ ]:</p>\n<p>tf.global_variables_initializer().run()<br>\nIn [ ]:</p>\n<p>for b in range(94):<br>\nbatch_xs, batch_ys = dm.loadbatch(b,\"data/NoneNematic/train/NoneNematic\",0)<br>\nsess.run(train_step, feed_dict={x: batch_xs, z_: batch_ys})<br>\nIn [ ]:</p>\n<p>for b in range(100):<br>\nbatch_xs, batch_ys = dm.loadbatch(b,\"data/Nematic/train/Nematic\",1)<br>\nsess.run(train_step, feed_dict={x: batch_xs, z_: batch_ys})<br>\nEvaluate the model<br>\nIn [ ]:</p>\n<p>correct_prediction = tf.equal(tf.argmax(z,1), tf.argmax(z_,1))<br>\nIn [ ]:</p>\n<p>t<br>\naccuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.int32))<br>\nIn [ ]:</p>\n<p>batch_xs, batch_ys = dm.loadbatch(151,\"data/NoneNematic/validate/NoneNematic\",0)<br>\nprint(sess.run(accuracy, feed_dict={x: batch_xs, z_: batch_ys}))<br>\nIn [ ]:</p>\n<p>accuracy.eval({x: batch_xs, z_: batch_ys})<br>\nprint(\"Accuracy:\", accuracy.eval({x: batch_xs, z_: batch_ys}))<br>\nIn [ ]:</p>\n<p>print(sess.run(z, feed_dict={x:batch_xs}))<br>\nprint(sess.run(z, feed_dict={x:batch_xs}))</p>", "body_text": "the error\nInvalidArgumentError                      Traceback (most recent call last)\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\n1021     try:\n-> 1022       return fn(*args)\n1023     except errors.OpError as e:\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(session, feed_dict, fetch_list, target_list, options, run_metadata)\n1003                                  feed_dict, fetch_list, target_list,\n-> 1004                                  status, run_metadata)\n1005\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\contextlib.py in exit(self, type, value, traceback)\n65             try:\n---> 66                 next(self.gen)\n67             except StopIteration:\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\n465           compat.as_text(pywrap_tensorflow.TF_Message(status)),\n--> 466           pywrap_tensorflow.TF_GetCode(status))\n467   finally:\nInvalidArgumentError: Expected dimension in the range [-1, 1), but got 1\n[[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]\nDuring handling of the above exception, another exception occurred:\nInvalidArgumentError                      Traceback (most recent call last)\n in ()\n1 batch_xs, batch_ys = dm.loadbatch(151,\"data/NoneNematic/validate/NoneNematic\",0)\n----> 2 print(sess.run(accuracy, feed_dict={x: batch_xs, z_: batch_ys}))\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\n765     try:\n766       result = self._run(None, fetches, feed_dict, options_ptr,\n--> 767                          run_metadata_ptr)\n768       if run_metadata:\n769         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\n963     if final_fetches or final_targets:\n964       results = self._do_run(handle, final_targets, final_fetches,\n--> 965                              feed_dict_string, options, run_metadata)\n966     else:\n967       results = []\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n1013     if handle is None:\n1014       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n-> 1015                            target_list, options, run_metadata)\n1016     else:\n1017       return self._do_call(_prun_fn, self._session, handle, feed_dict,\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\n1033         except KeyError:\n1034           pass\n-> 1035       raise type(e)(node_def, op, message)\n1036\n1037   def _extend_graph(self):\nInvalidArgumentError: Expected dimension in the range [-1, 1), but got 1\n[[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]\nCaused by op 'ArgMax_1', defined at:\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\runpy.py\", line 193, in _run_module_as_main\n\"main\", mod_spec)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\runpy.py\", line 85, in _run_code\nexec(code, run_globals)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel_launcher.py\", line 16, in \napp.launch_new_instance()\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance\napp.start()\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 477, in start\nioloop.IOLoop.instance().start()\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\ioloop.py\", line 177, in start\nsuper(ZMQIOLoop, self).start()\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\ioloop.py\", line 887, in start\nhandler_func(fd_obj, events)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\stack_context.py\", line 275, in null_wrapper\nreturn fn(*args, **kwargs)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 440, in _handle_events\nself._handle_recv()\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 472, in _handle_recv\nself._run_callback(callback, msg)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 414, in run_callback\ncallback(*args, **kwargs)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\stack_context.py\", line 275, in null_wrapper\nreturn fn(*args, **kwargs)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 283, in dispatcher\nreturn self.dispatch_shell(stream, msg)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 235, in dispatch_shell\nhandler(stream, idents, msg)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 399, in execute_request\nuser_expressions, allow_stdin)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 196, in do_execute\nres = shell.run_cell(code, store_history=store_history, silent=silent)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 533, in run_cell\nreturn super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2717, in run_cell\ninteractivity=interactivity, compiler=compiler, result=result)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2821, in run_ast_nodes\nif self.run_code(code, result):\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2881, in run_code\nexec(code_obj, self.user_global_ns, self.user_ns)\nFile \"\", line 1, in \ncorrect_prediction = tf.equal(tf.argmax(z,1), tf.argmax(z,1))\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 173, in argmax\nreturn gen_math_ops.arg_max(input, axis, name)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 168, in arg_max\nname=name)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\nop_def=op_def)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): Expected dimension in the range [-1, 1), but got 1\n[[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]\nthe code\nSTM Data intermediate brain\nImport dataset and tensorflow\nIn [ ]:\nimport tensorflow as tf\nimport math\nIn [ ]:\nimport datamaker as dm\nimport matplotlib.pyplot as plt\nimport numpy as np\nDefine the Model\nIn [ ]:\nNhidden=1024\nIMAGE_SIZE = 30\nIMAGE_PIXELS = IMAGE_SIZE * IMAGE_SIZE\nNUM_CLASSES = 2\nIn [ ]:\nx = tf.placeholder(tf.float32, [None, IMAGE_PIXELS])\nIn [ ]:\nW = tf.Variable(tf.zeros([IMAGE_PIXELS, Nhidden]))\nb = tf.Variable(tf.zeros([Nhidden]))\nIn [ ]:\ny = tf.nn.relu(tf.matmul(x, W) + b)\nIn [ ]:\nV = tf.Variable(tf.zeros([Nhidden,NUM_CLASSES]))\na = tf.Variable(tf.zeros([NUM_CLASSES]))\nIn [ ]:\nz = tf.nn.softmax(tf.matmul(y,V)+a)\nIn [ ]:\ny_ = tf.placeholder(tf.float32, [None, Nhidden])\nIn [ ]:\nz_ = tf.placeholder(tf.int32, [100])\nDefine the cost/loss function and training algorithm\nIn [ ]:\n#cross_entropy1 = tf.nn.softmax_cross_entropy_with_logits(labels=y_,logits=tf.matmul(x, W) + b)\nIn [ ]:\n#train_step1 = tf.train.GradientDescentOptimizer(0.5).minimize(cross_entropy1)\nIn [ ]:\ncross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(labels=z_,logits=tf.matmul(y,V)+a)\nIn [ ]:\nloss = tf.reduce_mean(cross_entropy)\nIn [ ]:\ntrain_step = tf.train.GradientDescentOptimizer(0.5).minimize(loss)\nTrain the model\nIn [ ]:\nsess = tf.InteractiveSession()\nIn [ ]:\ntf.global_variables_initializer().run()\nIn [ ]:\nfor b in range(94):\nbatch_xs, batch_ys = dm.loadbatch(b,\"data/NoneNematic/train/NoneNematic\",0)\nsess.run(train_step, feed_dict={x: batch_xs, z_: batch_ys})\nIn [ ]:\nfor b in range(100):\nbatch_xs, batch_ys = dm.loadbatch(b,\"data/Nematic/train/Nematic\",1)\nsess.run(train_step, feed_dict={x: batch_xs, z_: batch_ys})\nEvaluate the model\nIn [ ]:\ncorrect_prediction = tf.equal(tf.argmax(z,1), tf.argmax(z_,1))\nIn [ ]:\nt\naccuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.int32))\nIn [ ]:\nbatch_xs, batch_ys = dm.loadbatch(151,\"data/NoneNematic/validate/NoneNematic\",0)\nprint(sess.run(accuracy, feed_dict={x: batch_xs, z_: batch_ys}))\nIn [ ]:\naccuracy.eval({x: batch_xs, z_: batch_ys})\nprint(\"Accuracy:\", accuracy.eval({x: batch_xs, z_: batch_ys}))\nIn [ ]:\nprint(sess.run(z, feed_dict={x:batch_xs}))\nprint(sess.run(z, feed_dict={x:batch_xs}))", "body": "the error\r\n\r\nInvalidArgumentError                      Traceback (most recent call last)\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1021     try:\r\n-> 1022       return fn(*args)\r\n   1023     except errors.OpError as e:\r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(session, feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1003                                  feed_dict, fetch_list, target_list,\r\n-> 1004                                  status, run_metadata)\r\n   1005 \r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\contextlib.py in __exit__(self, type, value, traceback)\r\n     65             try:\r\n---> 66                 next(self.gen)\r\n     67             except StopIteration:\r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\errors_impl.py in raise_exception_on_not_ok_status()\r\n    465           compat.as_text(pywrap_tensorflow.TF_Message(status)),\r\n--> 466           pywrap_tensorflow.TF_GetCode(status))\r\n    467   finally:\r\n\r\nInvalidArgumentError: Expected dimension in the range [-1, 1), but got 1\r\n\t [[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n<ipython-input-22-5a0d43c01cd7> in <module>()\r\n      1 batch_xs, batch_ys = dm.loadbatch(151,\"data/NoneNematic/validate/NoneNematic\",0)\r\n----> 2 print(sess.run(accuracy, feed_dict={x: batch_xs, z_: batch_ys}))\r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    765     try:\r\n    766       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 767                          run_metadata_ptr)\r\n    768       if run_metadata:\r\n    769         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n    963     if final_fetches or final_targets:\r\n    964       results = self._do_run(handle, final_targets, final_fetches,\r\n--> 965                              feed_dict_string, options, run_metadata)\r\n    966     else:\r\n    967       results = []\r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1013     if handle is None:\r\n   1014       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\r\n-> 1015                            target_list, options, run_metadata)\r\n   1016     else:\r\n   1017       return self._do_call(_prun_fn, self._session, handle, feed_dict,\r\n\r\nC:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1033         except KeyError:\r\n   1034           pass\r\n-> 1035       raise type(e)(node_def, op, message)\r\n   1036 \r\n   1037   def _extend_graph(self):\r\n\r\nInvalidArgumentError: Expected dimension in the range [-1, 1), but got 1\r\n\t [[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]\r\n\r\nCaused by op 'ArgMax_1', defined at:\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 477, in start\r\n    ioloop.IOLoop.instance().start()\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\ioloop.py\", line 177, in start\r\n    super(ZMQIOLoop, self).start()\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\ioloop.py\", line 887, in start\r\n    handler_func(fd_obj, events)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\stack_context.py\", line 275, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 440, in _handle_events\r\n    self._handle_recv()\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 472, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\zmq\\eventloop\\zmqstream.py\", line 414, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tornado\\stack_context.py\", line 275, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 235, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 196, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 533, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2717, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2821, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2881, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-20-1310bf690995>\", line 1, in <module>\r\n    correct_prediction = tf.equal(tf.argmax(z,1), tf.argmax(z_,1))\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py\", line 173, in argmax\r\n    return gen_math_ops.arg_max(input, axis, name)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py\", line 168, in arg_max\r\n    name=name)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2327, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"C:\\Users\\Owner\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1226, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Expected dimension in the range [-1, 1), but got 1\r\n\t [[Node: ArgMax_1 = ArgMax[T=DT_INT32, Tidx=DT_INT32, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](_recv_Placeholder_2_0, ArgMax_1/dimension)]]\r\n\r\n\r\nthe code\r\nSTM Data intermediate brain\r\nImport dataset and tensorflow\r\nIn [ ]:\r\n\r\nimport tensorflow as tf\r\nimport math\r\nIn [ ]:\r\n\r\nimport datamaker as dm\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nDefine the Model\r\nIn [ ]:\r\n\r\nNhidden=1024\r\nIMAGE_SIZE = 30\r\nIMAGE_PIXELS = IMAGE_SIZE * IMAGE_SIZE\r\nNUM_CLASSES = 2\r\nIn [ ]:\r\n\r\nx = tf.placeholder(tf.float32, [None, IMAGE_PIXELS])\r\nIn [ ]:\r\n\r\nW = tf.Variable(tf.zeros([IMAGE_PIXELS, Nhidden]))\r\nb = tf.Variable(tf.zeros([Nhidden]))\r\nIn [ ]:\r\n\r\ny = tf.nn.relu(tf.matmul(x, W) + b)\r\nIn [ ]:\r\n\r\nV = tf.Variable(tf.zeros([Nhidden,NUM_CLASSES]))\r\na = tf.Variable(tf.zeros([NUM_CLASSES]))\r\nIn [ ]:\r\n\r\nz = tf.nn.softmax(tf.matmul(y,V)+a)\r\nIn [ ]:\r\n\r\ny_ = tf.placeholder(tf.float32, [None, Nhidden])\r\nIn [ ]:\r\n\r\nz_ = tf.placeholder(tf.int32, [100])\r\nDefine the cost/loss function and training algorithm\r\nIn [ ]:\r\n\r\n#cross_entropy1 = tf.nn.softmax_cross_entropy_with_logits(labels=y_,logits=tf.matmul(x, W) + b)\r\nIn [ ]:\r\n\r\n#train_step1 = tf.train.GradientDescentOptimizer(0.5).minimize(cross_entropy1)\r\nIn [ ]:\r\n\r\ncross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(labels=z_,logits=tf.matmul(y,V)+a)\r\nIn [ ]:\r\n\r\nloss = tf.reduce_mean(cross_entropy)\r\nIn [ ]:\r\n\r\ntrain_step = tf.train.GradientDescentOptimizer(0.5).minimize(loss)\r\nTrain the model\r\nIn [ ]:\r\n\r\nsess = tf.InteractiveSession()\r\nIn [ ]:\r\n\r\ntf.global_variables_initializer().run()\r\nIn [ ]:\r\n\r\nfor b in range(94):\r\n  batch_xs, batch_ys = dm.loadbatch(b,\"data/NoneNematic/train/NoneNematic\",0)\r\n  sess.run(train_step, feed_dict={x: batch_xs, z_: batch_ys})\r\nIn [ ]:\r\n\r\nfor b in range(100):\r\n  batch_xs, batch_ys = dm.loadbatch(b,\"data/Nematic/train/Nematic\",1)\r\n  sess.run(train_step, feed_dict={x: batch_xs, z_: batch_ys})\r\nEvaluate the model\r\nIn [ ]:\r\n\r\ncorrect_prediction = tf.equal(tf.argmax(z,1), tf.argmax(z_,1))\r\nIn [ ]:\r\n\r\nt\r\naccuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.int32))\r\nIn [ ]:\r\n\r\nbatch_xs, batch_ys = dm.loadbatch(151,\"data/NoneNematic/validate/NoneNematic\",0)\r\nprint(sess.run(accuracy, feed_dict={x: batch_xs, z_: batch_ys}))\r\nIn [ ]:\r\n\r\naccuracy.eval({x: batch_xs, z_: batch_ys})\r\n print(\"Accuracy:\", accuracy.eval({x: batch_xs, z_: batch_ys}))\r\nIn [ ]:\r\n\r\nprint(sess.run(z, feed_dict={x:batch_xs}))\r\nprint(sess.run(z, feed_dict={x:batch_xs}))"}