{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22424", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22424/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22424/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22424/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22424", "id": 362342118, "node_id": "MDU6SXNzdWUzNjIzNDIxMTg=", "number": 22424, "title": "Native compilation of Tensorflow on ARMv8 platforms fail", "user": {"login": "xiaomin05", "id": 31901820, "node_id": "MDQ6VXNlcjMxOTAxODIw", "avatar_url": "https://avatars0.githubusercontent.com/u/31901820?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiaomin05", "html_url": "https://github.com/xiaomin05", "followers_url": "https://api.github.com/users/xiaomin05/followers", "following_url": "https://api.github.com/users/xiaomin05/following{/other_user}", "gists_url": "https://api.github.com/users/xiaomin05/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiaomin05/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiaomin05/subscriptions", "organizations_url": "https://api.github.com/users/xiaomin05/orgs", "repos_url": "https://api.github.com/users/xiaomin05/repos", "events_url": "https://api.github.com/users/xiaomin05/events{/privacy}", "received_events_url": "https://api.github.com/users/xiaomin05/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-09-20T19:56:32Z", "updated_at": "2018-09-29T03:36:29Z", "closed_at": "2018-09-29T03:36:29Z", "author_association": "NONE", "body_html": "<hr>\n<h3>System information</h3>\n<p>== cat /etc/issue ===============================================<br>\nLinux ad96b38fdef35570b0c421cb8b68608f.lsdk.generic.ls1046ardb.nxp 4.14.47 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP PREEMPT Sat Jun 23 08:17:00 CST 2018 aarch64 aarch64 aarch64 GNU/Linux<br>\nVERSION=\"18.04 LTS (Bionic Beaver)\"<br>\nVERSION_ID=\"18.04\"<br>\nVERSION_CODENAME=bionic<br>\n== are we in docker =============================================<br>\nNo</p>\n<p>== compiler =====================================================<br>\nc++ (Ubuntu/Linaro 7.3.0-16ubuntu3) 7.3.0<br>\nCopyright (C) 2017 Free Software Foundation, Inc.<br>\nThis is free software; see the source for copying conditions.  There is NO<br>\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n<p>== uname -a =====================================================<br>\nLinux ad96b38fdef35570b0c421cb8b68608f.lsdk.generic.ls1046ardb.nxp 4.14.47 <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115886302\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1\">#1</a> SMP PREEMPT Sat Jun 23 08:17:00 CST 2018 aarch64 aarch64 aarch64 GNU/Linux</p>\n<p>== check pips ===================================================<br>\nnumpy (1.13.3)<br>\nprotobuf (3.6.0)<br>\ntensorflow (1.10.0)</p>\n<p>== check for virtualenv =========================================<br>\nFalse</p>\n<p>== tensorflow import ============================================<br>\ntf.VERSION = 1.10.0<br>\ntf.GIT_VERSION = v1.10.0-0-g656e7a2b34<br>\ntf.COMPILER_VERSION = v1.10.0-0-g656e7a2b34<br>\nSanity check: array([1], dtype=int32)<br>\nTraceback (most recent call last):<br>\nFile \"\", line 1, in <br>\nFile \"tensorflow/<strong>init</strong>.py\", line 24, in <br>\nfrom tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import<br>\nFile \"tensorflow/python/<strong>init</strong>.py\", line 49, in <br>\nfrom tensorflow.python import pywrap_tensorflow<br>\nFile \"tensorflow/python/pywrap_tensorflow.py\", line 25, in <br>\nfrom tensorflow.python.platform import self_check<br>\nImportError: No module named platform</p>\n<p>== env ==========================================================<br>\nLD_LIBRARY_PATH is unset<br>\nDYLD_LIBRARY_PATH is unset</p>\n<p>== nvidia-smi ===================================================<br>\n./tools/tf_env_collect.sh: line 105: nvidia-smi: command not found</p>\n<p>== cuda libs  ===================================================</p>\n<h3>Describe the problem</h3>\n<p>Native compilation on ARMv8 platform fails, due to tensorflow-lite<br>\nPatch is copied below. Please incorporate them in the next release. thanks.<br>\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p>\n<ul>\n<li>Patch file is copied below<br>\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br>\ndiff --git a/tensorflow/contrib/lite/build_def.bzl b/tensorflow/contrib/lite/build_def.bzl<br>\nindex b735d08b4b..4f333f079d 100644<br>\n--- a/tensorflow/contrib/lite/build_def.bzl<br>\n+++ b/tensorflow/contrib/lite/build_def.bzl<br>\n@@ -14,8 +14,8 @@ def tflite_copts():<br>\n\"-O3\",<br>\n],<br>\nstr(Label(\"//tensorflow:android_arm\")): [</li>\n</ul>\n<ul>\n<li>\n<pre><code>         \"-mfpu=neon\",\n</code></pre>\n</li>\n<li>\n<pre><code>         \"-mfloat-abi=softfp\",\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>         #\"-mfpu=neon\",\n</code></pre>\n</li>\n<li>\n<pre><code>         #\"-mfloat-abi=softfp\",\n         \"-std=c++11\",\n         \"-O3\",\n     ],\n</code></pre>\n</li>\n</ul>\n<p>diff --git a/tensorflow/contrib/lite/kernels/internal/BUILD b/tensorflow/contrib/lite/kernels/internal/BUILD<br>\nindex 3a855fe3dd..c013313512 100644<br>\n--- a/tensorflow/contrib/lite/kernels/internal/BUILD<br>\n+++ b/tensorflow/contrib/lite/kernels/internal/BUILD<br>\n@@ -21,7 +21,7 @@ HARD_FP_FLAGS_IF_APPLICABLE = select({<br>\nNEON_FLAGS_IF_APPLICABLE = select({<br>\n\":arm\": [<br>\n\"-O3\",</p>\n<ul>\n<li>\n<pre><code>   \"-mfpu=neon\",\n</code></pre>\n</li>\n</ul>\n<ul>\n<li>\n<pre><code>   #\"-mfpu=neon\",\n</code></pre>\n],<br>\n\":armeabi-v7a\": [<br>\n\"-O3\",<br>\ndiff --git a/third_party/png.BUILD b/third_party/png.BUILD<br>\nindex 17c5449cc0..7b095cbc36 100644<br>\n--- a/third_party/png.BUILD<br>\n+++ b/third_party/png.BUILD<br>\n@@ -42,6 +42,7 @@ cc_library(<br>\n],<br>\nincludes = [\".\"],<br>\nlinkopts = [\"-lm\"],</li>\n<li>copts = [\"-DPNG_ARM_NEON_OPT=0\"],<br>\nvisibility = [\"//visibility:public\"],<br>\ndeps = [\"@zlib_archive//:zlib\"],<br>\n)</li>\n</ul>", "body_text": "System information\n== cat /etc/issue ===============================================\nLinux ad96b38fdef35570b0c421cb8b68608f.lsdk.generic.ls1046ardb.nxp 4.14.47 #1 SMP PREEMPT Sat Jun 23 08:17:00 CST 2018 aarch64 aarch64 aarch64 GNU/Linux\nVERSION=\"18.04 LTS (Bionic Beaver)\"\nVERSION_ID=\"18.04\"\nVERSION_CODENAME=bionic\n== are we in docker =============================================\nNo\n== compiler =====================================================\nc++ (Ubuntu/Linaro 7.3.0-16ubuntu3) 7.3.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n== uname -a =====================================================\nLinux ad96b38fdef35570b0c421cb8b68608f.lsdk.generic.ls1046ardb.nxp 4.14.47 #1 SMP PREEMPT Sat Jun 23 08:17:00 CST 2018 aarch64 aarch64 aarch64 GNU/Linux\n== check pips ===================================================\nnumpy (1.13.3)\nprotobuf (3.6.0)\ntensorflow (1.10.0)\n== check for virtualenv =========================================\nFalse\n== tensorflow import ============================================\ntf.VERSION = 1.10.0\ntf.GIT_VERSION = v1.10.0-0-g656e7a2b34\ntf.COMPILER_VERSION = v1.10.0-0-g656e7a2b34\nSanity check: array([1], dtype=int32)\nTraceback (most recent call last):\nFile \"\", line 1, in \nFile \"tensorflow/init.py\", line 24, in \nfrom tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\nFile \"tensorflow/python/init.py\", line 49, in \nfrom tensorflow.python import pywrap_tensorflow\nFile \"tensorflow/python/pywrap_tensorflow.py\", line 25, in \nfrom tensorflow.python.platform import self_check\nImportError: No module named platform\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n== nvidia-smi ===================================================\n./tools/tf_env_collect.sh: line 105: nvidia-smi: command not found\n== cuda libs  ===================================================\nDescribe the problem\nNative compilation on ARMv8 platform fails, due to tensorflow-lite\nPatch is copied below. Please incorporate them in the next release. thanks.\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n\nPatch file is copied below\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++\ndiff --git a/tensorflow/contrib/lite/build_def.bzl b/tensorflow/contrib/lite/build_def.bzl\nindex b735d08b4b..4f333f079d 100644\n--- a/tensorflow/contrib/lite/build_def.bzl\n+++ b/tensorflow/contrib/lite/build_def.bzl\n@@ -14,8 +14,8 @@ def tflite_copts():\n\"-O3\",\n],\nstr(Label(\"//tensorflow:android_arm\")): [\n\n\n\n         \"-mfpu=neon\",\n\n\n\n         \"-mfloat-abi=softfp\",\n\n\n\n\n\n         #\"-mfpu=neon\",\n\n\n\n         #\"-mfloat-abi=softfp\",\n         \"-std=c++11\",\n         \"-O3\",\n     ],\n\n\n\ndiff --git a/tensorflow/contrib/lite/kernels/internal/BUILD b/tensorflow/contrib/lite/kernels/internal/BUILD\nindex 3a855fe3dd..c013313512 100644\n--- a/tensorflow/contrib/lite/kernels/internal/BUILD\n+++ b/tensorflow/contrib/lite/kernels/internal/BUILD\n@@ -21,7 +21,7 @@ HARD_FP_FLAGS_IF_APPLICABLE = select({\nNEON_FLAGS_IF_APPLICABLE = select({\n\":arm\": [\n\"-O3\",\n\n\n   \"-mfpu=neon\",\n\n\n\n\n\n   #\"-mfpu=neon\",\n\n],\n\":armeabi-v7a\": [\n\"-O3\",\ndiff --git a/third_party/png.BUILD b/third_party/png.BUILD\nindex 17c5449cc0..7b095cbc36 100644\n--- a/third_party/png.BUILD\n+++ b/third_party/png.BUILD\n@@ -42,6 +42,7 @@ cc_library(\n],\nincludes = [\".\"],\nlinkopts = [\"-lm\"],\ncopts = [\"-DPNG_ARM_NEON_OPT=0\"],\nvisibility = [\"//visibility:public\"],\ndeps = [\"@zlib_archive//:zlib\"],\n)", "body": "------------------------\r\n\r\n### System information\r\n== cat /etc/issue ===============================================\r\nLinux ad96b38fdef35570b0c421cb8b68608f.lsdk.generic.ls1046ardb.nxp 4.14.47 #1 SMP PREEMPT Sat Jun 23 08:17:00 CST 2018 aarch64 aarch64 aarch64 GNU/Linux\r\nVERSION=\"18.04 LTS (Bionic Beaver)\"                                                                                                                     \r\nVERSION_ID=\"18.04\"                                                                                                                                      \r\nVERSION_CODENAME=bionic                                                                                                                                 \r\n== are we in docker =============================================\r\nNo                                                               \r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu/Linaro 7.3.0-16ubuntu3) 7.3.0                        \r\nCopyright (C) 2017 Free Software Foundation, Inc.                \r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux ad96b38fdef35570b0c421cb8b68608f.lsdk.generic.ls1046ardb.nxp 4.14.47 #1 SMP PREEMPT Sat Jun 23 08:17:00 CST 2018 aarch64 aarch64 aarch64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.13.3)\r\nprotobuf (3.6.0)\r\ntensorflow (1.10.0)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.10.0\r\ntf.GIT_VERSION = v1.10.0-0-g656e7a2b34\r\ntf.COMPILER_VERSION = v1.10.0-0-g656e7a2b34\r\nSanity check: array([1], dtype=int32)\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"tensorflow/__init__.py\", line 24, in <module>\r\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\r\n  File \"tensorflow/python/__init__.py\", line 49, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"tensorflow/python/pywrap_tensorflow.py\", line 25, in <module>\r\n    from tensorflow.python.platform import self_check\r\nImportError: No module named platform\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n./tools/tf_env_collect.sh: line 105: nvidia-smi: command not found\r\n\r\n== cuda libs  ===================================================\r\n\r\n### Describe the problem\r\nNative compilation on ARMv8 platform fails, due to tensorflow-lite \r\nPatch is copied below. Please incorporate them in the next release. thanks.\r\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\n+ Patch file is copied below\r\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\ndiff --git a/tensorflow/contrib/lite/build_def.bzl b/tensorflow/contrib/lite/build_def.bzl\r\nindex b735d08b4b..4f333f079d 100644                                                       \r\n--- a/tensorflow/contrib/lite/build_def.bzl                                               \r\n+++ b/tensorflow/contrib/lite/build_def.bzl                                               \r\n@@ -14,8 +14,8 @@ def tflite_copts():                                                     \r\n               \"-O3\",                                                                     \r\n           ],                                                                             \r\n           str(Label(\"//tensorflow:android_arm\")): [\r\n-              \"-mfpu=neon\",\r\n-              \"-mfloat-abi=softfp\",\r\n+              #\"-mfpu=neon\",\r\n+              #\"-mfloat-abi=softfp\",\r\n               \"-std=c++11\",\r\n               \"-O3\",\r\n           ],\r\ndiff --git a/tensorflow/contrib/lite/kernels/internal/BUILD b/tensorflow/contrib/lite/kernels/internal/BUILD\r\nindex 3a855fe3dd..c013313512 100644\r\n--- a/tensorflow/contrib/lite/kernels/internal/BUILD\r\n+++ b/tensorflow/contrib/lite/kernels/internal/BUILD\r\n@@ -21,7 +21,7 @@ HARD_FP_FLAGS_IF_APPLICABLE = select({\r\n NEON_FLAGS_IF_APPLICABLE = select({\r\n     \":arm\": [\r\n         \"-O3\",\r\n-        \"-mfpu=neon\",\r\n+        #\"-mfpu=neon\",\r\n     ],\r\n     \":armeabi-v7a\": [\r\n         \"-O3\",\r\ndiff --git a/third_party/png.BUILD b/third_party/png.BUILD\r\nindex 17c5449cc0..7b095cbc36 100644\r\n--- a/third_party/png.BUILD\r\n+++ b/third_party/png.BUILD\r\n@@ -42,6 +42,7 @@ cc_library(\r\n     ],\r\n     includes = [\".\"],\r\n     linkopts = [\"-lm\"],\r\n+    copts = [\"-DPNG_ARM_NEON_OPT=0\"],\r\n     visibility = [\"//visibility:public\"],\r\n     deps = [\"@zlib_archive//:zlib\"],\r\n )\r\n\r\n\r\n"}