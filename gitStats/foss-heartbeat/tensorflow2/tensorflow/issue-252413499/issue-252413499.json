{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12539", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12539/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12539/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12539/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12539", "id": 252413499, "node_id": "MDU6SXNzdWUyNTI0MTM0OTk=", "number": 12539, "title": "libtensorflow_cc.so linker issues with r 1.3 on Mac OS X Undefined symbols for architecture", "user": {"login": "vade", "id": 65011, "node_id": "MDQ6VXNlcjY1MDEx", "avatar_url": "https://avatars1.githubusercontent.com/u/65011?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vade", "html_url": "https://github.com/vade", "followers_url": "https://api.github.com/users/vade/followers", "following_url": "https://api.github.com/users/vade/following{/other_user}", "gists_url": "https://api.github.com/users/vade/gists{/gist_id}", "starred_url": "https://api.github.com/users/vade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vade/subscriptions", "organizations_url": "https://api.github.com/users/vade/orgs", "repos_url": "https://api.github.com/users/vade/repos", "events_url": "https://api.github.com/users/vade/events{/privacy}", "received_events_url": "https://api.github.com/users/vade/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 23, "created_at": "2017-08-23T20:55:30Z", "updated_at": "2017-12-11T21:47:52Z", "closed_at": "2017-12-11T21:47:52Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nYes, but this appears to be a linker issue.</p>\n</li>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nMac OS X 10.12.6</p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>:<br>\nSource</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>:<br>\nGit tagged at 1.3 and master at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/593dc8e5d65f4db93e8f5fced772abb3531a9752/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/593dc8e5d65f4db93e8f5fced772abb3531a9752\"><tt>593dc8e</tt></a></p>\n</li>\n<li>\n<p><strong>Python version</strong>:<br>\n2.7 (OS Default).</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>:<br>\n0.5.3-homebrew</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:<br>\nN/A</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\nN/A</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:<br>\nbazel clean<br>\n./configure stating N to every option for CPU only build.<br>\nbazel build //tensorflow:libtensorflow_cc.so with no optimizations  (testing deployment)</p>\n</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>The above commands builds a libtensorflow_cc.so from for TF 1.3</p>\n<p>Linking my built libtensorflow_cc.so to a C++ / Obj-C App which has successfully linked against a TF 1.2 build of libtensorflow_cc.so, results in the following linker errors in the log section of this bug report.</p>\n<p>No code changes were made on my end between a working 1.2 libtensorflow_cc.so and a new 1.3 libtensorflow_cc.so - Just replacing the binary so file, building clean and re-compiling.</p>\n<p>Thank you.</p>\n<h3>Source code / logs</h3>\n<pre lang=\"Ld\" data-meta=\"/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release/Synopsis.framework/Versions/A/Synopsis normal x86_64\"><code>    cd /Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis\n    export MACOSX_DEPLOYMENT_TARGET=10.11\n    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang++ -arch x86_64 -dynamiclib -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk -L/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release -L/Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/Tensorflow/lib -F/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release -F/Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/OpenCV -filelist /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis.LinkFileList -install_name @rpath/Synopsis.framework/Versions/A/Synopsis -Xlinker -rpath -Xlinker @executable_path/../Frameworks -Xlinker -rpath -Xlinker @loader_path/Frameworks -mmacosx-version-min=10.11 -Xlinker -object_path_lto -Xlinker /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis_lto.o -fobjc-arc -fobjc-link-runtime -stdlib=libc++ -lblas -framework Accelerate -lz -framework Cocoa -framework CoreMedia -framework CoreMediaIO -framework CoreVideo -framework OpenCL -framework opencv2 /Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/Tensorflow/lib/libtensorflow_cc.so -single_module -compatibility_version 1 -current_version 1 -Xlinker -dependency_info -Xlinker /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis_dependency_info.dat -o /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release/Synopsis.framework/Versions/A/Synopsis\n\nUndefined symbols for architecture x86_64:\n  \"tensorflow::TensorShape::SlowCopyFrom(tensorflow::TensorShape const&amp;)\", referenced from:\n      tensorflow::Tensor::Tensor(tensorflow::Tensor const&amp;) in TensorflowFeatureModule.o\n  \"tensorflow::TensorShape::DestructorOutOfLine()\", referenced from:\n      -[TensorflowFeatureModule initWithQualityHint:] in TensorflowFeatureModule.o\n      tensorflow::Tensor::Tensor(tensorflow::Tensor const&amp;) in TensorflowFeatureModule.o\n  \"tensorflow::TensorShape::TensorShape(tensorflow::gtl::ArraySlice&lt;long long&gt;)\", referenced from:\n      -[TensorflowFeatureModule initWithQualityHint:] in TensorflowFeatureModule.o\n  \"tensorflow::TensorShape::dim_size(int) const\", referenced from:\n      Eigen::DSizes&lt;long, 4&gt; tensorflow::TensorShape::AsEigenDSizesWithPadding&lt;4&gt;() const in TensorflowFeatureModule.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>", "body_text": "System information\n\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes, but this appears to be a linker issue.\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nMac OS X 10.12.6\n\n\nTensorFlow installed from (source or binary):\nSource\n\n\nTensorFlow version (use command below):\nGit tagged at 1.3 and master at 593dc8e\n\n\nPython version:\n2.7 (OS Default).\n\n\nBazel version (if compiling from source):\n0.5.3-homebrew\n\n\nCUDA/cuDNN version:\nN/A\n\n\nGPU model and memory:\nN/A\n\n\nExact command to reproduce:\nbazel clean\n./configure stating N to every option for CPU only build.\nbazel build //tensorflow:libtensorflow_cc.so with no optimizations  (testing deployment)\n\n\nDescribe the problem\nThe above commands builds a libtensorflow_cc.so from for TF 1.3\nLinking my built libtensorflow_cc.so to a C++ / Obj-C App which has successfully linked against a TF 1.2 build of libtensorflow_cc.so, results in the following linker errors in the log section of this bug report.\nNo code changes were made on my end between a working 1.2 libtensorflow_cc.so and a new 1.3 libtensorflow_cc.so - Just replacing the binary so file, building clean and re-compiling.\nThank you.\nSource code / logs\n    cd /Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis\n    export MACOSX_DEPLOYMENT_TARGET=10.11\n    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang++ -arch x86_64 -dynamiclib -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk -L/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release -L/Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/Tensorflow/lib -F/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release -F/Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/OpenCV -filelist /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis.LinkFileList -install_name @rpath/Synopsis.framework/Versions/A/Synopsis -Xlinker -rpath -Xlinker @executable_path/../Frameworks -Xlinker -rpath -Xlinker @loader_path/Frameworks -mmacosx-version-min=10.11 -Xlinker -object_path_lto -Xlinker /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis_lto.o -fobjc-arc -fobjc-link-runtime -stdlib=libc++ -lblas -framework Accelerate -lz -framework Cocoa -framework CoreMedia -framework CoreMediaIO -framework CoreVideo -framework OpenCL -framework opencv2 /Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/Tensorflow/lib/libtensorflow_cc.so -single_module -compatibility_version 1 -current_version 1 -Xlinker -dependency_info -Xlinker /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis_dependency_info.dat -o /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release/Synopsis.framework/Versions/A/Synopsis\n\nUndefined symbols for architecture x86_64:\n  \"tensorflow::TensorShape::SlowCopyFrom(tensorflow::TensorShape const&)\", referenced from:\n      tensorflow::Tensor::Tensor(tensorflow::Tensor const&) in TensorflowFeatureModule.o\n  \"tensorflow::TensorShape::DestructorOutOfLine()\", referenced from:\n      -[TensorflowFeatureModule initWithQualityHint:] in TensorflowFeatureModule.o\n      tensorflow::Tensor::Tensor(tensorflow::Tensor const&) in TensorflowFeatureModule.o\n  \"tensorflow::TensorShape::TensorShape(tensorflow::gtl::ArraySlice<long long>)\", referenced from:\n      -[TensorflowFeatureModule initWithQualityHint:] in TensorflowFeatureModule.o\n  \"tensorflow::TensorShape::dim_size(int) const\", referenced from:\n      Eigen::DSizes<long, 4> tensorflow::TensorShape::AsEigenDSizesWithPadding<4>() const in TensorflowFeatureModule.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)", "body": "\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes, but this appears to be a linker issue.\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nMac OS X 10.12.6\r\n\r\n- **TensorFlow installed from (source or binary)**:\r\nSource\r\n- **TensorFlow version (use command below)**:\r\nGit tagged at 1.3 and master at 593dc8e5d65f4db93e8f5fced772abb3531a9752 \r\n- **Python version**: \r\n2.7 (OS Default).\r\n- **Bazel version (if compiling from source)**:\r\n 0.5.3-homebrew\r\n- **CUDA/cuDNN version**:\r\nN/A\r\n- **GPU model and memory**:\r\nN/A\r\n\r\n- **Exact command to reproduce**:\r\nbazel clean\r\n./configure stating N to every option for CPU only build.\r\nbazel build //tensorflow:libtensorflow_cc.so with no optimizations  (testing deployment)\r\n\r\n### Describe the problem\r\n\r\nThe above commands builds a libtensorflow_cc.so from for TF 1.3\r\n\r\nLinking my built libtensorflow_cc.so to a C++ / Obj-C App which has successfully linked against a TF 1.2 build of libtensorflow_cc.so, results in the following linker errors in the log section of this bug report.\r\n\r\nNo code changes were made on my end between a working 1.2 libtensorflow_cc.so and a new 1.3 libtensorflow_cc.so - Just replacing the binary so file, building clean and re-compiling.\r\n\r\nThank you.\r\n\r\n### Source code / logs\r\n```Ld /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release/Synopsis.framework/Versions/A/Synopsis normal x86_64\r\n    cd /Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis\r\n    export MACOSX_DEPLOYMENT_TARGET=10.11\r\n    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang++ -arch x86_64 -dynamiclib -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk -L/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release -L/Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/Tensorflow/lib -F/Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release -F/Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/OpenCV -filelist /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis.LinkFileList -install_name @rpath/Synopsis.framework/Versions/A/Synopsis -Xlinker -rpath -Xlinker @executable_path/../Frameworks -Xlinker -rpath -Xlinker @loader_path/Frameworks -mmacosx-version-min=10.11 -Xlinker -object_path_lto -Xlinker /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis_lto.o -fobjc-arc -fobjc-link-runtime -stdlib=libc++ -lblas -framework Accelerate -lz -framework Cocoa -framework CoreMedia -framework CoreMediaIO -framework CoreVideo -framework OpenCL -framework opencv2 /Users/vade/Documents/Repositories/Synopsis/Synopsis/Synopsis/Synopsis-Framework/Synopsis/Synopsis/Tensorflow/lib/libtensorflow_cc.so -single_module -compatibility_version 1 -current_version 1 -Xlinker -dependency_info -Xlinker /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Intermediates/Synopsis-Framework.build/Release/Synopsis-macOS.build/Objects-normal/x86_64/Synopsis_dependency_info.dat -o /Users/vade/Library/Developer/Xcode/DerivedData/Synopsis-cdbnfomidhkpiodcmhdwciqcvshg/Build/Products/Release/Synopsis.framework/Versions/A/Synopsis\r\n\r\nUndefined symbols for architecture x86_64:\r\n  \"tensorflow::TensorShape::SlowCopyFrom(tensorflow::TensorShape const&)\", referenced from:\r\n      tensorflow::Tensor::Tensor(tensorflow::Tensor const&) in TensorflowFeatureModule.o\r\n  \"tensorflow::TensorShape::DestructorOutOfLine()\", referenced from:\r\n      -[TensorflowFeatureModule initWithQualityHint:] in TensorflowFeatureModule.o\r\n      tensorflow::Tensor::Tensor(tensorflow::Tensor const&) in TensorflowFeatureModule.o\r\n  \"tensorflow::TensorShape::TensorShape(tensorflow::gtl::ArraySlice<long long>)\", referenced from:\r\n      -[TensorflowFeatureModule initWithQualityHint:] in TensorflowFeatureModule.o\r\n  \"tensorflow::TensorShape::dim_size(int) const\", referenced from:\r\n      Eigen::DSizes<long, 4> tensorflow::TensorShape::AsEigenDSizesWithPadding<4>() const in TensorflowFeatureModule.o\r\nld: symbol(s) not found for architecture x86_64\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n```"}