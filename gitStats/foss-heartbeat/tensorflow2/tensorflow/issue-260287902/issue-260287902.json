{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13292", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13292/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13292/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13292/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13292", "id": 260287902, "node_id": "MDU6SXNzdWUyNjAyODc5MDI=", "number": 13292, "title": "cudnn PoolBackward launch failed when using tf.nn.max_pool on Tensorflow GPU (Windows 10)", "user": {"login": "rktamplayo", "id": 16053571, "node_id": "MDQ6VXNlcjE2MDUzNTcx", "avatar_url": "https://avatars3.githubusercontent.com/u/16053571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rktamplayo", "html_url": "https://github.com/rktamplayo", "followers_url": "https://api.github.com/users/rktamplayo/followers", "following_url": "https://api.github.com/users/rktamplayo/following{/other_user}", "gists_url": "https://api.github.com/users/rktamplayo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rktamplayo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rktamplayo/subscriptions", "organizations_url": "https://api.github.com/users/rktamplayo/orgs", "repos_url": "https://api.github.com/users/rktamplayo/repos", "events_url": "https://api.github.com/users/rktamplayo/events{/privacy}", "received_events_url": "https://api.github.com/users/rktamplayo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-09-25T14:01:49Z", "updated_at": "2018-07-27T03:28:58Z", "closed_at": "2017-12-05T17:22:36Z", "author_association": "NONE", "body_html": "<p>When using max_pool, the error below shows and stops the code. I used the code available here: <a href=\"https://github.com/charlesashby/CharLSTM\">https://github.com/charlesashby/CharLSTM</a>. Specifically, I used the <code>lib_model/bidirectional_lstm.py</code> and the error occurs at the <code>tdnn</code> function when <code>tf.nn.max_pool</code> is ran.</p>\n<p>What does this error mean? Thanks!</p>\n<pre><code>Caused by op 'gradients/TDNN/MaxPool_grad/MaxPoolGrad', defined at:\n  File \"main.py\", line 33, in &lt;module&gt;\n    network.train()\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 165, in train\n    optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 315, in minimize\n    grad_loss=grad_loss)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 386, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 542, in gradients\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 348, in _MaybeCompile\n    return grad_fn()  # Exit early\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 542, in &lt;lambda&gt;\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\nn_grad.py\", line 526, in _MaxPoolGrad\n    data_format=op.get_attr(\"data_format\"))\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1752, in _max_pool_grad\n    data_format=data_format, name=name)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\n    op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\n...which was originally created as op 'TDNN/MaxPool', defined at:\n  File \"main.py\", line 31, in &lt;module&gt;\n    network.build()\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 103, in build\n    cnn = tdnn(self.X, kernels, kernel_features)\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 92, in tdnn\n    pool = tf.nn.max_pool(tf.nn.tanh(conv), [1, 1, reduced_length, 1], [1, 1, 1, 1], 'VALID')\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 1772, in max_pool\n    name=name)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1605, in _max_pool\n    data_format=data_format, name=name)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\n    op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInternalError (see above for traceback): cudnn PoolBackward launch failed\n         [[Node: gradients/TDNN/MaxPool_grad/MaxPoolGrad = MaxPoolGrad[T=DT_FLOAT, data_format=\"NHWC\", ksize=[1, 1, 16, 1], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TDNN/Tanh, TDNN/MaxPool, gradients/TDNN/Squeeze_grad/Reshape)]]\n</code></pre>\n<p><strong>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</strong></p>\n<p>I have searched through all websites including GitHub and StackOverflow, and it seems like this error has not been reported anywhere else.</p>\n<p><strong>Environment info</strong></p>\n<ul>\n<li>Tensorflow 1.3.0</li>\n<li>Python 3.5.3</li>\n<li>CUDA 8.0</li>\n<li>cuDNN 6.0</li>\n<li>OS: Windows 10</li>\n<li>GPU: GeForce GTX 1080ti</li>\n</ul>", "body_text": "When using max_pool, the error below shows and stops the code. I used the code available here: https://github.com/charlesashby/CharLSTM. Specifically, I used the lib_model/bidirectional_lstm.py and the error occurs at the tdnn function when tf.nn.max_pool is ran.\nWhat does this error mean? Thanks!\nCaused by op 'gradients/TDNN/MaxPool_grad/MaxPoolGrad', defined at:\n  File \"main.py\", line 33, in <module>\n    network.train()\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 165, in train\n    optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 315, in minimize\n    grad_loss=grad_loss)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 386, in compute_gradients\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 542, in gradients\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 348, in _MaybeCompile\n    return grad_fn()  # Exit early\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 542, in <lambda>\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\nn_grad.py\", line 526, in _MaxPoolGrad\n    data_format=op.get_attr(\"data_format\"))\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1752, in _max_pool_grad\n    data_format=data_format, name=name)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\n    op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\n...which was originally created as op 'TDNN/MaxPool', defined at:\n  File \"main.py\", line 31, in <module>\n    network.build()\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 103, in build\n    cnn = tdnn(self.X, kernels, kernel_features)\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 92, in tdnn\n    pool = tf.nn.max_pool(tf.nn.tanh(conv), [1, 1, reduced_length, 1], [1, 1, 1, 1], 'VALID')\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 1772, in max_pool\n    name=name)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1605, in _max_pool\n    data_format=data_format, name=name)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\n    op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInternalError (see above for traceback): cudnn PoolBackward launch failed\n         [[Node: gradients/TDNN/MaxPool_grad/MaxPoolGrad = MaxPoolGrad[T=DT_FLOAT, data_format=\"NHWC\", ksize=[1, 1, 16, 1], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TDNN/Tanh, TDNN/MaxPool, gradients/TDNN/Squeeze_grad/Reshape)]]\n\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nI have searched through all websites including GitHub and StackOverflow, and it seems like this error has not been reported anywhere else.\nEnvironment info\n\nTensorflow 1.3.0\nPython 3.5.3\nCUDA 8.0\ncuDNN 6.0\nOS: Windows 10\nGPU: GeForce GTX 1080ti", "body": "When using max_pool, the error below shows and stops the code. I used the code available here: [https://github.com/charlesashby/CharLSTM](https://github.com/charlesashby/CharLSTM). Specifically, I used the `lib_model/bidirectional_lstm.py` and the error occurs at the `tdnn` function when `tf.nn.max_pool` is ran.\r\n\r\nWhat does this error mean? Thanks!\r\n\r\n```\r\nCaused by op 'gradients/TDNN/MaxPool_grad/MaxPoolGrad', defined at:\r\n  File \"main.py\", line 33, in <module>\r\n    network.train()\r\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 165, in train\r\n    optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 315, in minimize\r\n    grad_loss=grad_loss)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\training\\optimizer.py\", line 386, in compute_gradients\r\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 542, in gradients\r\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 348, in _MaybeCompile\r\n    return grad_fn()  # Exit early\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gradients_impl.py\", line 542, in <lambda>\r\n    grad_scope, op, func_call, lambda: grad_fn(op, *out_grads))\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\nn_grad.py\", line 526, in _MaxPoolGrad\r\n    data_format=op.get_attr(\"data_format\"))\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1752, in _max_pool_grad\r\n    data_format=data_format, name=name)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\r\n    op_def=op_def)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\n...which was originally created as op 'TDNN/MaxPool', defined at:\r\n  File \"main.py\", line 31, in <module>\r\n    network.build()\r\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 103, in build\r\n    cnn = tdnn(self.X, kernels, kernel_features)\r\n  File \"E:\\rktamplayo\\Personalized\\CharLSTM\\lib_model\\bidirectional_lstm.py\", line 92, in tdnn\r\n    pool = tf.nn.max_pool(tf.nn.tanh(conv), [1, 1, reduced_length, 1], [1, 1, 1, 1], 'VALID')\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 1772, in max_pool\r\n    name=name)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1605, in _max_pool\r\n    data_format=data_format, name=name)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 767, in apply_op\r\n    op_def=op_def)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2630, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"C:\\Users\\seung-won\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1204, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInternalError (see above for traceback): cudnn PoolBackward launch failed\r\n         [[Node: gradients/TDNN/MaxPool_grad/MaxPoolGrad = MaxPoolGrad[T=DT_FLOAT, data_format=\"NHWC\", ksize=[1, 1, 16, 1], padding=\"VALID\", strides=[1, 1, 1, 1], _device=\"/job:localhost/replica:0/task:0/gpu:0\"](TDNN/Tanh, TDNN/MaxPool, gradients/TDNN/Squeeze_grad/Reshape)]]\r\n```\r\n\r\n**What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?**\r\n\r\nI have searched through all websites including GitHub and StackOverflow, and it seems like this error has not been reported anywhere else.\r\n\r\n**Environment info**\r\n\r\n- Tensorflow 1.3.0\r\n- Python 3.5.3\r\n- CUDA 8.0\r\n- cuDNN 6.0\r\n- OS: Windows 10\r\n- GPU: GeForce GTX 1080ti"}