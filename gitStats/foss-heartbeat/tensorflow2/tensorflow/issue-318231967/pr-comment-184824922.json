{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/184824922", "pull_request_review_id": 116042558, "id": 184824922, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDgyNDkyMg==", "diff_hunk": "@@ -236,9 +362,22 @@ tensorflow::Status SegmentGraph(\n   // Collect the segments/subgraphs. Each subgraph is represented by a\n   // set of the names of the nodes in that subgraph.\n   std::unordered_map<string, std::set<string>> sg_map;\n+  std::unordered_map<string, std::set<string>> device_maps;\n   for (auto& u : node_segments) {\n     if ((u.Value() != nullptr) && (u.ParentValue() != nullptr)) {\n       sg_map[u.ParentValue()->name()].insert(u.Value()->name());\n+      auto tf_node = u.Value()->tf_node();\n+      if (tf_node->has_assigned_device_name()) {", "path": "tensorflow/contrib/tensorrt/segment/segment.cc", "position": null, "original_position": 340, "commit_id": "bf70368d36df3ee9a16f5285940d73fb54d911c0", "original_commit_id": "8838e2a84f98bd210147dc1a79e1037f2545dff9", "user": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "body": "I realized that we need to accommodate the existing python graph conversion api, in that case please see my comment below, by running the original segmentation algorithm multiple times, one for each subgraph with different device assignment, we don't need the logic here and it can minimize the change to segment.h/cc.", "created_at": "2018-04-27T23:03:28Z", "updated_at": "2018-05-02T21:46:24Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/18909#discussion_r184824922", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/18909", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/184824922"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/18909#discussion_r184824922"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/18909"}}, "body_html": "<p>I realized that we need to accommodate the existing python graph conversion api, in that case please see my comment below, by running the original segmentation algorithm multiple times, one for each subgraph with different device assignment, we don't need the logic here and it can minimize the change to segment.h/cc.</p>", "body_text": "I realized that we need to accommodate the existing python graph conversion api, in that case please see my comment below, by running the original segmentation algorithm multiple times, one for each subgraph with different device assignment, we don't need the logic here and it can minimize the change to segment.h/cc.", "in_reply_to_id": 184800905}