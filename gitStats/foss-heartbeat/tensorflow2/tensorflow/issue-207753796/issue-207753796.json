{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7521", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7521/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7521/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7521/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7521", "id": 207753796, "node_id": "MDU6SXNzdWUyMDc3NTM3OTY=", "number": 7521, "title": "Tensorflow takes all my CPUs", "user": {"login": "fabienbaradel", "id": 11565723, "node_id": "MDQ6VXNlcjExNTY1NzIz", "avatar_url": "https://avatars0.githubusercontent.com/u/11565723?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fabienbaradel", "html_url": "https://github.com/fabienbaradel", "followers_url": "https://api.github.com/users/fabienbaradel/followers", "following_url": "https://api.github.com/users/fabienbaradel/following{/other_user}", "gists_url": "https://api.github.com/users/fabienbaradel/gists{/gist_id}", "starred_url": "https://api.github.com/users/fabienbaradel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fabienbaradel/subscriptions", "organizations_url": "https://api.github.com/users/fabienbaradel/orgs", "repos_url": "https://api.github.com/users/fabienbaradel/repos", "events_url": "https://api.github.com/users/fabienbaradel/events{/privacy}", "received_events_url": "https://api.github.com/users/fabienbaradel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2017-02-15T09:47:10Z", "updated_at": "2018-09-26T08:35:01Z", "closed_at": "2017-02-20T08:48:11Z", "author_association": "NONE", "body_html": "<p>I am having issue with CPU usage. I am running my code on a node with 4 GPUs and 12 CPUs.<br>\nI am using TFRecords for reading my data and it works well. However when I run my model Tensorflow uses all the CPUs available on my node (<em>even when I specify that I want to use only one thread</em>):<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/11565723/22968352/5b682558-f36a-11e6-9bef-97b1e8e4caff.png\"><img width=\"587\" alt=\"capture d ecran 2017-02-15 a 10 26 58\" src=\"https://cloud.githubusercontent.com/assets/11565723/22968352/5b682558-f36a-11e6-9bef-97b1e8e4caff.png\" style=\"max-width:100%;\"></a></p>\n<p>I wanted to check what are the devices founded by Tensorflow by running this:<br>\n<strong>from tensorflow.python.client import device_lib<br>\nprint(device_lib.list_local_devices())</strong></p>\n<p>Log:<br>\n[name: \"/cpu:0\"<br>\ndevice_type: \"CPU\"<br>\nmemory_limit: 268435456<br>\nlocality {<br>\n}<br>\nincarnation: 5188106746934734819<br>\n, name: \"/gpu:0\"<br>\ndevice_type: \"GPU\"<br>\nmemory_limit: 12051264308<br>\nlocality {<br>\nbus_id: 1<br>\n}<br>\nincarnation: 5913495995344792631<br>\nphysical_device_desc: \"device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:01:00.0\"<br>\n]</p>\n<p>Given the output it seems Tensorflow finds and uses only one CPU. But maybe this CPU founded is a kind of \"concatenation\" of the 12 CPUs available on my node..</p>\n<p><strong>How to specify Tensorflow to use only one CPU?<br>\nHow to make Tensorflow understand that I have several CPUs on my node? ( I can't find an config option or something else in the tf.Session()</strong></p>\n<p>Thanks for your help.</p>\n<p>I installed Tensorflow using \"pip install tensorflow\" and below is the output of python -c \"import tensorflow; print(tensorflow.<strong>version</strong>)\":<br>\n<strong>0.12.0-rc1</strong></p>\n<p>An when I run this, it tells me that I have my 12 cores:<br>\nimport multiprocessing<br>\nmultiprocessing.cpu_count()<br>\n<strong>12</strong></p>", "body_text": "I am having issue with CPU usage. I am running my code on a node with 4 GPUs and 12 CPUs.\nI am using TFRecords for reading my data and it works well. However when I run my model Tensorflow uses all the CPUs available on my node (even when I specify that I want to use only one thread):\n\nI wanted to check what are the devices founded by Tensorflow by running this:\nfrom tensorflow.python.client import device_lib\nprint(device_lib.list_local_devices())\nLog:\n[name: \"/cpu:0\"\ndevice_type: \"CPU\"\nmemory_limit: 268435456\nlocality {\n}\nincarnation: 5188106746934734819\n, name: \"/gpu:0\"\ndevice_type: \"GPU\"\nmemory_limit: 12051264308\nlocality {\nbus_id: 1\n}\nincarnation: 5913495995344792631\nphysical_device_desc: \"device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:01:00.0\"\n]\nGiven the output it seems Tensorflow finds and uses only one CPU. But maybe this CPU founded is a kind of \"concatenation\" of the 12 CPUs available on my node..\nHow to specify Tensorflow to use only one CPU?\nHow to make Tensorflow understand that I have several CPUs on my node? ( I can't find an config option or something else in the tf.Session()\nThanks for your help.\nI installed Tensorflow using \"pip install tensorflow\" and below is the output of python -c \"import tensorflow; print(tensorflow.version)\":\n0.12.0-rc1\nAn when I run this, it tells me that I have my 12 cores:\nimport multiprocessing\nmultiprocessing.cpu_count()\n12", "body": "I am having issue with CPU usage. I am running my code on a node with 4 GPUs and 12 CPUs.\r\nI am using TFRecords for reading my data and it works well. However when I run my model Tensorflow uses all the CPUs available on my node (_even when I specify that I want to use only one thread_):\r\n<img width=\"587\" alt=\"capture d ecran 2017-02-15 a 10 26 58\" src=\"https://cloud.githubusercontent.com/assets/11565723/22968352/5b682558-f36a-11e6-9bef-97b1e8e4caff.png\">\r\n\r\nI wanted to check what are the devices founded by Tensorflow by running this:\r\n    **from tensorflow.python.client import device_lib\r\n    print(device_lib.list_local_devices())**\r\n\r\nLog:\r\n[name: \"/cpu:0\"\r\ndevice_type: \"CPU\"\r\nmemory_limit: 268435456\r\nlocality {\r\n}\r\nincarnation: 5188106746934734819\r\n, name: \"/gpu:0\"\r\ndevice_type: \"GPU\"\r\nmemory_limit: 12051264308\r\nlocality {\r\n  bus_id: 1\r\n}\r\nincarnation: 5913495995344792631\r\nphysical_device_desc: \"device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:01:00.0\"\r\n]\r\n\r\nGiven the output it seems Tensorflow finds and uses only one CPU. But maybe this CPU founded is a kind of \"concatenation\" of the 12 CPUs available on my node..\r\n\r\n**How to specify Tensorflow to use only one CPU?\r\nHow to make Tensorflow understand that I have several CPUs on my node? ( I can't find an config option or something else in the tf.Session()**\r\n\r\nThanks for your help.\r\n\r\nI installed Tensorflow using \"pip install tensorflow\" and below is the output of python -c \"import tensorflow; print(tensorflow.__version__)\":\r\n**0.12.0-rc1**\r\n\r\nAn when I run this, it tells me that I have my 12 cores:\r\nimport multiprocessing\r\nmultiprocessing.cpu_count()\r\n**12**\r\n"}