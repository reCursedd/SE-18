{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/333296582", "html_url": "https://github.com/tensorflow/tensorflow/issues/13342#issuecomment-333296582", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13342", "id": 333296582, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzI5NjU4Mg==", "user": {"login": "gauss-clb", "id": 11674304, "node_id": "MDQ6VXNlcjExNjc0MzA0", "avatar_url": "https://avatars2.githubusercontent.com/u/11674304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gauss-clb", "html_url": "https://github.com/gauss-clb", "followers_url": "https://api.github.com/users/gauss-clb/followers", "following_url": "https://api.github.com/users/gauss-clb/following{/other_user}", "gists_url": "https://api.github.com/users/gauss-clb/gists{/gist_id}", "starred_url": "https://api.github.com/users/gauss-clb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gauss-clb/subscriptions", "organizations_url": "https://api.github.com/users/gauss-clb/orgs", "repos_url": "https://api.github.com/users/gauss-clb/repos", "events_url": "https://api.github.com/users/gauss-clb/events{/privacy}", "received_events_url": "https://api.github.com/users/gauss-clb/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-30T09:28:57Z", "updated_at": "2017-09-30T09:32:43Z", "author_association": "NONE", "body_html": "<p>After I view the source, I find there maybe  faulty design. <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/slim/python/slim/learning.py#L717\">slim.learning.train</a> use <code>Supervisor</code>, and the <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L200\">construct function</a> of <code>Supervisor</code> use <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L438\">_init_saver</a> to initialize <code>saver</code>, which means if global_variables() is not NULL, <code>saver</code> will be <code>tf.train.saver()</code>.<br>\nAnd then it will create <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L342\">SessionManager</a> and invoke <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L889\">managed_session</a> and <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L704\">prepare_or_wait_for_session</a>,<br>\nbut if the <code>saver</code> is not NULL, the <code>SessionManager</code> <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/session_manager.py#L274\">won't run <code>init_op</code> and <code>init_fn</code></a>, that's why it raise an error.</p>\n<p>It means the <code>saver</code> is always not NULL, and <code>init_op</code> and <code>init_fn</code> will be never run.</p>\n<p>Can anyone give me response and how to fix it, I just want to restore some variables from checkpoint file and the other variables should invoke init_op to initialize.</p>", "body_text": "After I view the source, I find there maybe  faulty design. slim.learning.train use Supervisor, and the construct function of Supervisor use _init_saver to initialize saver, which means if global_variables() is not NULL, saver will be tf.train.saver().\nAnd then it will create SessionManager and invoke managed_session and prepare_or_wait_for_session,\nbut if the saver is not NULL, the SessionManager won't run init_op and init_fn, that's why it raise an error.\nIt means the saver is always not NULL, and init_op and init_fn will be never run.\nCan anyone give me response and how to fix it, I just want to restore some variables from checkpoint file and the other variables should invoke init_op to initialize.", "body": "After I view the source, I find there maybe  faulty design. [slim.learning.train](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/slim/python/slim/learning.py#L717) use `Supervisor`, and the [construct function](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L200) of `Supervisor` use [_init_saver](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L438) to initialize `saver`, which means if global_variables() is not NULL, `saver` will be `tf.train.saver()`.\r\nAnd then it will create [SessionManager](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L342) and invoke [managed_session](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L889) and [prepare_or_wait_for_session](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/supervisor.py#L704),\r\nbut if the `saver` is not NULL, the `SessionManager` [won't run `init_op` and `init_fn`](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/session_manager.py#L274), that's why it raise an error.\r\n\r\nIt means the `saver` is always not NULL, and `init_op` and `init_fn` will be never run.\r\n\r\nCan anyone give me response and how to fix it, I just want to restore some variables from checkpoint file and the other variables should invoke init_op to initialize."}