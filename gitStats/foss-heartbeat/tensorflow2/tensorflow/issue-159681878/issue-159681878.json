{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2787", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2787/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2787/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2787/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2787", "id": 159681878, "node_id": "MDU6SXNzdWUxNTk2ODE4Nzg=", "number": 2787, "title": "0.9rc0 regression when using scan over axes with shape None", "user": {"login": "jlowin", "id": 153965, "node_id": "MDQ6VXNlcjE1Mzk2NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/153965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlowin", "html_url": "https://github.com/jlowin", "followers_url": "https://api.github.com/users/jlowin/followers", "following_url": "https://api.github.com/users/jlowin/following{/other_user}", "gists_url": "https://api.github.com/users/jlowin/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlowin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlowin/subscriptions", "organizations_url": "https://api.github.com/users/jlowin/orgs", "repos_url": "https://api.github.com/users/jlowin/repos", "events_url": "https://api.github.com/users/jlowin/events{/privacy}", "received_events_url": "https://api.github.com/users/jlowin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2016-06-10T17:19:01Z", "updated_at": "2017-07-08T08:20:30Z", "closed_at": "2016-08-08T17:54:42Z", "author_association": "NONE", "body_html": "<p>A simple cumulative sum with scan that worked in TF 0.8 fails in 0.9rc0 with an inconsistent shape error. I have attached code to illustrate the error below. Basically, a scan over the 0th axis fails when a different axis has None shape. This occurs, for example, when computing a cumulative sum over an arbitrary axis of a minibatched variable (after first transposing that axis to be in the 0th position).</p>\n<h3>Environment info</h3>\n<p>Operating System: Mac OSX 10.11.5</p>\n<p>Installed version of CUDA and cuDNN:<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>): N/A</p>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>\n<p>Which pip package you installed:</p>\n<p><code>https://storage.googleapis.com/tensorflow/mac/tensorflow-0.9.0rc0-py3-none-any.whl</code></p>\n</li>\n<li>\n<p>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.</p>\n<p><code>0.9.0rc0</code></p>\n</li>\n</ol>\n<p>If installed from sources, provide the commit hash:</p>\n<h3>Steps to reproduce</h3>\n<p>Run the following code:</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\nx <span class=\"pl-k\">=</span> tf.placeholder(<span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32, <span class=\"pl-v\">shape</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">2</span>])\nxT <span class=\"pl-k\">=</span> tf.transpose(x)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> scan over dimension 0 (with shape None)</span>\nresult <span class=\"pl-k\">=</span> tf.scan(<span class=\"pl-k\">lambda</span> <span class=\"pl-smi\">a</span>, <span class=\"pl-smi\">x</span>: a <span class=\"pl-k\">+</span> x, x)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> scanned over transposed dimension 0 (with shape 2)</span>\nresultT <span class=\"pl-k\">=</span> tf.scan(<span class=\"pl-k\">lambda</span> <span class=\"pl-smi\">a</span>, <span class=\"pl-smi\">x</span>: a <span class=\"pl-k\">+</span> x, xT)</pre></div>\n<p>To see the following error:<br>\n<code>ValueError: Inconsistent shapes: saw (?,) but expected (?,) (and infer_shape=True)</code></p>", "body_text": "A simple cumulative sum with scan that worked in TF 0.8 fails in 0.9rc0 with an inconsistent shape error. I have attached code to illustrate the error below. Basically, a scan over the 0th axis fails when a different axis has None shape. This occurs, for example, when computing a cumulative sum over an arbitrary axis of a minibatched variable (after first transposing that axis to be in the 0th position).\nEnvironment info\nOperating System: Mac OSX 10.11.5\nInstalled version of CUDA and cuDNN:\n(please attach the output of ls -l /path/to/cuda/lib/libcud*): N/A\nIf installed from binary pip package, provide:\n\n\nWhich pip package you installed:\nhttps://storage.googleapis.com/tensorflow/mac/tensorflow-0.9.0rc0-py3-none-any.whl\n\n\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\n0.9.0rc0\n\n\nIf installed from sources, provide the commit hash:\nSteps to reproduce\nRun the following code:\nimport tensorflow as tf\nx = tf.placeholder(dtype=tf.float32, shape=[None, 2])\nxT = tf.transpose(x)\n# scan over dimension 0 (with shape None)\nresult = tf.scan(lambda a, x: a + x, x)\n# scanned over transposed dimension 0 (with shape 2)\nresultT = tf.scan(lambda a, x: a + x, xT)\nTo see the following error:\nValueError: Inconsistent shapes: saw (?,) but expected (?,) (and infer_shape=True)", "body": "A simple cumulative sum with scan that worked in TF 0.8 fails in 0.9rc0 with an inconsistent shape error. I have attached code to illustrate the error below. Basically, a scan over the 0th axis fails when a different axis has None shape. This occurs, for example, when computing a cumulative sum over an arbitrary axis of a minibatched variable (after first transposing that axis to be in the 0th position).\n### Environment info\n\nOperating System: Mac OSX 10.11.5\n\nInstalled version of CUDA and cuDNN: \n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`): N/A\n\nIf installed from binary pip package, provide:\n1. Which pip package you installed: \n   \n   `https://storage.googleapis.com/tensorflow/mac/tensorflow-0.9.0rc0-py3-none-any.whl`\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\n   \n   `0.9.0rc0`\n\nIf installed from sources, provide the commit hash:\n### Steps to reproduce\n\nRun the following code:\n\n``` python\nimport tensorflow as tf\nx = tf.placeholder(dtype=tf.float32, shape=[None, 2])\nxT = tf.transpose(x)\n# scan over dimension 0 (with shape None)\nresult = tf.scan(lambda a, x: a + x, x)\n# scanned over transposed dimension 0 (with shape 2)\nresultT = tf.scan(lambda a, x: a + x, xT)\n```\n\nTo see the following error:\n`ValueError: Inconsistent shapes: saw (?,) but expected (?,) (and infer_shape=True)`\n"}