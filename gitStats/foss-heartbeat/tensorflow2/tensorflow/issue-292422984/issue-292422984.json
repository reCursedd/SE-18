{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16542", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16542/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16542/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16542/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16542", "id": 292422984, "node_id": "MDU6SXNzdWUyOTI0MjI5ODQ=", "number": 16542, "title": "Cannot merge devices with incompatible jobs", "user": {"login": "wangshuaizs", "id": 21264093, "node_id": "MDQ6VXNlcjIxMjY0MDkz", "avatar_url": "https://avatars2.githubusercontent.com/u/21264093?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangshuaizs", "html_url": "https://github.com/wangshuaizs", "followers_url": "https://api.github.com/users/wangshuaizs/followers", "following_url": "https://api.github.com/users/wangshuaizs/following{/other_user}", "gists_url": "https://api.github.com/users/wangshuaizs/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangshuaizs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangshuaizs/subscriptions", "organizations_url": "https://api.github.com/users/wangshuaizs/orgs", "repos_url": "https://api.github.com/users/wangshuaizs/repos", "events_url": "https://api.github.com/users/wangshuaizs/events{/privacy}", "received_events_url": "https://api.github.com/users/wangshuaizs/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2018-01-29T14:18:45Z", "updated_at": "2018-05-29T16:18:17Z", "closed_at": "2018-05-29T16:18:17Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 16.04(kernel 4.10)</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source code</li>\n<li><strong>TensorFlow version (use command below)</strong>: r1.4.0</li>\n<li><strong>Python version</strong>: 2.7</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.5.4</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 5.4.0</li>\n<li><strong>CUDA/cuDNN version</strong>: No CUDA</li>\n<li><strong>GPU model and memory</strong>: No GPU</li>\n<li><strong>Exact command to reproduce</strong>: var_rep = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I am running distributed tensorflow with 2 parameter servers and 2 workers. I created some partioned variables by using \"tf.create_partitioned_variables()\". So the different parts of a variable will be placed on different ps. Then I want to concatenate them by using \"tf.concat()\" and assign the result of tf.concat() to a untrainable variable which lies in worker. But the error occurs as follows:</p>\n<pre><code>Traceback (most recent call last):\n  File \"distributed_vgg19.py\", line 230, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"distributed_vgg19.py\", line 188, in main\n    sess = sv.prepare_or_wait_for_session(server.target, config=sess_config)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 726, in prepare_or_wait_for_session\n    max_wait_secs=max_wait_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 400, in wait_for_session\n    sess)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 483, in _try_run_local_init_op\n    sess.run(self._local_init_op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 889, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1120, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\n    options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot colocate nodes 'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0' and 'fc8/fc8_biases/part_1: Cannot merge devices with incompatible jobs: '/job:ps/task:0' and '/job:worker/task:1'\n         [[Node: fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0 = Identity[T=DT_FLOAT, _class=[\"loc:@fc8/fc8_biases/part_1\"], _device=\"/job:worker/task:1\"](fc8/fc8_biases_1/cond_1/Merge)]]\n\nCaused by op u'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0', defined at:\n  File \"distributed_vgg19.py\", line 230, in &lt;module&gt;\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"distributed_vgg19.py\", line 136, in main\n    vgg.build(x, train_mode)\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 96, in build\n    self.fc8 = self.fc_layer(self.relu7, 4096, 1000, \"fc8\")\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 120, in fc_layer\n    weights, biases = self.get_fc_var(in_size, out_size, name)\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 143, in get_fc_var\n    biases = self.get_var(initial_value, name, 1, name + \"_biases\")\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 171, in get_var\n    var_rep = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 229, in __init__\n    constraint=constraint)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 378, in _init_from_args\n    self._build_initializer_expr(self._initial_value),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 811, in _build_initializer_expr\n    new_op = self._build_initializer_expr(initial_value.op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 830, in _build_initializer_expr\n    new_tensor = self._build_initializer_expr(tensor)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 811, in _build_initializer_expr\n    new_op = self._build_initializer_expr(initial_value.op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 847, in _build_initializer_expr\n    attrs=initial_value.node_def.attr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3042, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1521, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): Cannot colocate nodes 'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0' and 'fc8/fc8_biases/part_1: Cannot merge devices with incompatible jobs: '/job:ps/task:0' and '/job:worker/task:1'\n         [[Node: fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0 = Identity[T=DT_FLOAT, _class=[\"loc:@fc8/fc8_biases/part_1\"], _device=\"/job:worker/task:1\"](fc8/fc8_biases_1/cond_1/Merge)]]\n</code></pre>\n<p>there are some relevant code:</p>\n<pre><code>            slice_list = []\n            for dim_index in range(value.get_shape().ndims):\n                if dim_index == 0:\n                    slice_list.append(self.num_of_ps)\n                else:\n                    slice_list.append(1)\n            var_list = tf.create_partitioned_variables(shape=value.get_shape(), \n                                                       slicing=slice_list, \n                                                       initializer=value,\n                                                       name=var_name)\n            var_concat = var_list[0]\n            for ps_index in range(self.num_of_ps - 1):\n                var_concat = tf.concat([var_concat, var_list[ps_index + 1]], 0)\n            with tf.device('/job:worker/task:%d' % self.task_index):\n                var = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\n</code></pre>\n<p>Anybody knows why this error happened? Is it caused by an bug? If not, what i can do to assign the value of a variable lying in ps to another variable lying in worker?<br>\nThanks a lot!</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04(kernel 4.10)\nTensorFlow installed from (source or binary): source code\nTensorFlow version (use command below): r1.4.0\nPython version: 2.7\nBazel version (if compiling from source): 0.5.4\nGCC/Compiler version (if compiling from source): 5.4.0\nCUDA/cuDNN version: No CUDA\nGPU model and memory: No GPU\nExact command to reproduce: var_rep = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\n\nDescribe the problem\nI am running distributed tensorflow with 2 parameter servers and 2 workers. I created some partioned variables by using \"tf.create_partitioned_variables()\". So the different parts of a variable will be placed on different ps. Then I want to concatenate them by using \"tf.concat()\" and assign the result of tf.concat() to a untrainable variable which lies in worker. But the error occurs as follows:\nTraceback (most recent call last):\n  File \"distributed_vgg19.py\", line 230, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"distributed_vgg19.py\", line 188, in main\n    sess = sv.prepare_or_wait_for_session(server.target, config=sess_config)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 726, in prepare_or_wait_for_session\n    max_wait_secs=max_wait_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 400, in wait_for_session\n    sess)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 483, in _try_run_local_init_op\n    sess.run(self._local_init_op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 889, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1120, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\n    options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot colocate nodes 'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0' and 'fc8/fc8_biases/part_1: Cannot merge devices with incompatible jobs: '/job:ps/task:0' and '/job:worker/task:1'\n         [[Node: fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0 = Identity[T=DT_FLOAT, _class=[\"loc:@fc8/fc8_biases/part_1\"], _device=\"/job:worker/task:1\"](fc8/fc8_biases_1/cond_1/Merge)]]\n\nCaused by op u'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0', defined at:\n  File \"distributed_vgg19.py\", line 230, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"distributed_vgg19.py\", line 136, in main\n    vgg.build(x, train_mode)\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 96, in build\n    self.fc8 = self.fc_layer(self.relu7, 4096, 1000, \"fc8\")\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 120, in fc_layer\n    weights, biases = self.get_fc_var(in_size, out_size, name)\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 143, in get_fc_var\n    biases = self.get_var(initial_value, name, 1, name + \"_biases\")\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 171, in get_var\n    var_rep = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 229, in __init__\n    constraint=constraint)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 378, in _init_from_args\n    self._build_initializer_expr(self._initial_value),\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 811, in _build_initializer_expr\n    new_op = self._build_initializer_expr(initial_value.op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 830, in _build_initializer_expr\n    new_tensor = self._build_initializer_expr(tensor)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 811, in _build_initializer_expr\n    new_op = self._build_initializer_expr(initial_value.op)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 847, in _build_initializer_expr\n    attrs=initial_value.node_def.attr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3042, in create_op\n    op_def=op_def)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1521, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nInvalidArgumentError (see above for traceback): Cannot colocate nodes 'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0' and 'fc8/fc8_biases/part_1: Cannot merge devices with incompatible jobs: '/job:ps/task:0' and '/job:worker/task:1'\n         [[Node: fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0 = Identity[T=DT_FLOAT, _class=[\"loc:@fc8/fc8_biases/part_1\"], _device=\"/job:worker/task:1\"](fc8/fc8_biases_1/cond_1/Merge)]]\n\nthere are some relevant code:\n            slice_list = []\n            for dim_index in range(value.get_shape().ndims):\n                if dim_index == 0:\n                    slice_list.append(self.num_of_ps)\n                else:\n                    slice_list.append(1)\n            var_list = tf.create_partitioned_variables(shape=value.get_shape(), \n                                                       slicing=slice_list, \n                                                       initializer=value,\n                                                       name=var_name)\n            var_concat = var_list[0]\n            for ps_index in range(self.num_of_ps - 1):\n                var_concat = tf.concat([var_concat, var_list[ps_index + 1]], 0)\n            with tf.device('/job:worker/task:%d' % self.task_index):\n                var = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\n\nAnybody knows why this error happened? Is it caused by an bug? If not, what i can do to assign the value of a variable lying in ps to another variable lying in worker?\nThanks a lot!", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04(kernel 4.10)\r\n- **TensorFlow installed from (source or binary)**: source code\r\n- **TensorFlow version (use command below)**: r1.4.0\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: 0.5.4\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0\r\n- **CUDA/cuDNN version**: No CUDA\r\n- **GPU model and memory**: No GPU\r\n- **Exact command to reproduce**: var_rep = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\r\n\r\n### Describe the problem\r\nI am running distributed tensorflow with 2 parameter servers and 2 workers. I created some partioned variables by using \"tf.create_partitioned_variables()\". So the different parts of a variable will be placed on different ps. Then I want to concatenate them by using \"tf.concat()\" and assign the result of tf.concat() to a untrainable variable which lies in worker. But the error occurs as follows:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"distributed_vgg19.py\", line 230, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"distributed_vgg19.py\", line 188, in main\r\n    sess = sv.prepare_or_wait_for_session(server.target, config=sess_config)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 726, in prepare_or_wait_for_session\r\n    max_wait_secs=max_wait_secs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 400, in wait_for_session\r\n    sess)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/session_manager.py\", line 483, in _try_run_local_init_op\r\n    sess.run(self._local_init_op)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 889, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1120, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1317, in _do_run\r\n    options, run_metadata)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1336, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot colocate nodes 'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0' and 'fc8/fc8_biases/part_1: Cannot merge devices with incompatible jobs: '/job:ps/task:0' and '/job:worker/task:1'\r\n         [[Node: fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0 = Identity[T=DT_FLOAT, _class=[\"loc:@fc8/fc8_biases/part_1\"], _device=\"/job:worker/task:1\"](fc8/fc8_biases_1/cond_1/Merge)]]\r\n\r\nCaused by op u'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0', defined at:\r\n  File \"distributed_vgg19.py\", line 230, in <module>\r\n    tf.app.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"distributed_vgg19.py\", line 136, in main\r\n    vgg.build(x, train_mode)\r\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 96, in build\r\n    self.fc8 = self.fc_layer(self.relu7, 4096, 1000, \"fc8\")\r\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 120, in fc_layer\r\n    weights, biases = self.get_fc_var(in_size, out_size, name)\r\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 143, in get_fc_var\r\n    biases = self.get_var(initial_value, name, 1, name + \"_biases\")\r\n  File \"/home/shuai/distributed_vgg19_part/vgg19.py\", line 171, in get_var\r\n    var_rep = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 229, in __init__\r\n    constraint=constraint)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 378, in _init_from_args\r\n    self._build_initializer_expr(self._initial_value),\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 811, in _build_initializer_expr\r\n    new_op = self._build_initializer_expr(initial_value.op)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 830, in _build_initializer_expr\r\n    new_tensor = self._build_initializer_expr(tensor)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 811, in _build_initializer_expr\r\n    new_op = self._build_initializer_expr(initial_value.op)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/variables.py\", line 847, in _build_initializer_expr\r\n    attrs=initial_value.node_def.attr)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 3042, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 1521, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): Cannot colocate nodes 'fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0' and 'fc8/fc8_biases/part_1: Cannot merge devices with incompatible jobs: '/job:ps/task:0' and '/job:worker/task:1'\r\n         [[Node: fc8/fc8_biases_1/fc8/fc8_biases/part_1/read_fc8/fc8_biases_1_0 = Identity[T=DT_FLOAT, _class=[\"loc:@fc8/fc8_biases/part_1\"], _device=\"/job:worker/task:1\"](fc8/fc8_biases_1/cond_1/Merge)]]\r\n```\r\n\r\nthere are some relevant code:\r\n```\r\n            slice_list = []\r\n            for dim_index in range(value.get_shape().ndims):\r\n                if dim_index == 0:\r\n                    slice_list.append(self.num_of_ps)\r\n                else:\r\n                    slice_list.append(1)\r\n            var_list = tf.create_partitioned_variables(shape=value.get_shape(), \r\n                                                       slicing=slice_list, \r\n                                                       initializer=value,\r\n                                                       name=var_name)\r\n            var_concat = var_list[0]\r\n            for ps_index in range(self.num_of_ps - 1):\r\n                var_concat = tf.concat([var_concat, var_list[ps_index + 1]], 0)\r\n            with tf.device('/job:worker/task:%d' % self.task_index):\r\n                var = tf.Variable(var_concat, name=var_name, collections=[tf.GraphKeys.LOCAL_VARIABLES], trainable=False)\r\n```\r\n\r\nAnybody knows why this error happened? Is it caused by an bug? If not, what i can do to assign the value of a variable lying in ps to another variable lying in worker?\r\nThanks a lot!"}