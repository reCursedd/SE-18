{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15339", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15339/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15339/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15339/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15339", "id": 281745695, "node_id": "MDU6SXNzdWUyODE3NDU2OTU=", "number": 15339, "title": "opencv cannot read frame from video with tensorflow", "user": {"login": "kxhit", "id": 16812362, "node_id": "MDQ6VXNlcjE2ODEyMzYy", "avatar_url": "https://avatars2.githubusercontent.com/u/16812362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kxhit", "html_url": "https://github.com/kxhit", "followers_url": "https://api.github.com/users/kxhit/followers", "following_url": "https://api.github.com/users/kxhit/following{/other_user}", "gists_url": "https://api.github.com/users/kxhit/gists{/gist_id}", "starred_url": "https://api.github.com/users/kxhit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kxhit/subscriptions", "organizations_url": "https://api.github.com/users/kxhit/orgs", "repos_url": "https://api.github.com/users/kxhit/repos", "events_url": "https://api.github.com/users/kxhit/events{/privacy}", "received_events_url": "https://api.github.com/users/kxhit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-12-13T13:15:26Z", "updated_at": "2017-12-21T22:35:46Z", "closed_at": "2017-12-13T19:18:09Z", "author_association": "NONE", "body_html": "<p>I am using tensorflow r1.4 and opencv3.1 in ubuntu14.04.<br>\nWhen I include #include &lt;tensorflow/core/public/session.h&gt; or<br>\n#include \"tensorflow/cc/ops/standard_ops.h\" I cannot read images from cv::VideoCapture adn I got empty mat. When I didn't include these tensorflow headers, I can read frame successfully. Anyone could help me? Thanks a lot!!!<br>\nI noticed other issues like <a href=\"https://github.com/tensorflow/tensorflow/issues/1924?from=singlemessage\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1924/hovercard\">#1924</a> <a href=\"https://github.com/tensorflow/tensorflow/issues/6496\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/6496/hovercard\">#6496</a> but got no idea.</p>\n<p>Here is my cpp file:<br>\n#include &lt;tensorflow/core/platform/env.h&gt;<br>\n#include &lt;tensorflow/core/public/session.h&gt;<br>\n#include \"tensorflow/cc/ops/standard_ops.h\"<br>\n#include &lt;opencv2/opencv.hpp&gt;<br>\n#include <br>\nusing namespace std;<br>\nusing namespace tensorflow;</p>\n<p>int main()<br>\n{<br>\ncv::VideoCapture cap;<br>\nif(!cap.open(\"/home/kx/project/RM-dataset/01.avi\")){<br>\nstd::cout&lt;&lt;\"cannot open video \"&lt;&lt;std::endl;<br>\n}<br>\ncv::Mat frame;<br>\nwhile(1){<br>\ncap&gt;&gt;frame;<br>\nif(frame.empty()){<br>\nstd::cout&lt;&lt;\"no frame\"&lt;&lt;std::endl;<br>\ncontinue;<br>\n}<br>\ncv::imshow(\"frame\",frame);<br>\ncv::waitKey(0);<br>\n}<br>\nreturn 0;<br>\n}</p>\n<p>my cmake file:</p>\n<p>cmake_minimum_required (VERSION 2.8)<br>\nproject (tf_example)</p>\n<p>set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -g -std=c++11 -W\")<br>\nfind_package(OpenCV 3.1.0 REQUIRED)<br>\ninclude_directories(<br>\n/home/kx/something/tensorflow-r1.4<br>\n/home/kx/something/tensorflow-r1.4/tensorflow/bazel-genfiles<br>\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/protobuf/include<br>\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/host_obj<br>\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/proto<br>\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/downloads/nsync/public<br>\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/downloads/eigen<br>\n/home/kx/something/tensorflow-r1.4/bazel-out/local-py3-opt/genfiles<br>\n${OPENCV_INCLUDE_DIRS}<br>\n)</p>\n<p>add_executable(tf_test tf_test.cpp)<br>\ntarget_link_libraries(tf_test<br>\n/home/kx/something/tensorflow-r1.4/bazel-bin/tensorflow/libtensorflow_cc.so<br>\n/home/kx/something/tensorflow-r1.4/bazel-bin/tensorflow/libtensorflow_framework.so<br>\n${OpenCV_LIBS}<br>\n)</p>\n<p>The results:<br>\nno frame</p>", "body_text": "I am using tensorflow r1.4 and opencv3.1 in ubuntu14.04.\nWhen I include #include <tensorflow/core/public/session.h> or\n#include \"tensorflow/cc/ops/standard_ops.h\" I cannot read images from cv::VideoCapture adn I got empty mat. When I didn't include these tensorflow headers, I can read frame successfully. Anyone could help me? Thanks a lot!!!\nI noticed other issues like #1924 #6496 but got no idea.\nHere is my cpp file:\n#include <tensorflow/core/platform/env.h>\n#include <tensorflow/core/public/session.h>\n#include \"tensorflow/cc/ops/standard_ops.h\"\n#include <opencv2/opencv.hpp>\n#include \nusing namespace std;\nusing namespace tensorflow;\nint main()\n{\ncv::VideoCapture cap;\nif(!cap.open(\"/home/kx/project/RM-dataset/01.avi\")){\nstd::cout<<\"cannot open video \"<<std::endl;\n}\ncv::Mat frame;\nwhile(1){\ncap>>frame;\nif(frame.empty()){\nstd::cout<<\"no frame\"<<std::endl;\ncontinue;\n}\ncv::imshow(\"frame\",frame);\ncv::waitKey(0);\n}\nreturn 0;\n}\nmy cmake file:\ncmake_minimum_required (VERSION 2.8)\nproject (tf_example)\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -g -std=c++11 -W\")\nfind_package(OpenCV 3.1.0 REQUIRED)\ninclude_directories(\n/home/kx/something/tensorflow-r1.4\n/home/kx/something/tensorflow-r1.4/tensorflow/bazel-genfiles\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/protobuf/include\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/host_obj\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/proto\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/downloads/nsync/public\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/downloads/eigen\n/home/kx/something/tensorflow-r1.4/bazel-out/local-py3-opt/genfiles\n${OPENCV_INCLUDE_DIRS}\n)\nadd_executable(tf_test tf_test.cpp)\ntarget_link_libraries(tf_test\n/home/kx/something/tensorflow-r1.4/bazel-bin/tensorflow/libtensorflow_cc.so\n/home/kx/something/tensorflow-r1.4/bazel-bin/tensorflow/libtensorflow_framework.so\n${OpenCV_LIBS}\n)\nThe results:\nno frame", "body": "I am using tensorflow r1.4 and opencv3.1 in ubuntu14.04.\r\nWhen I include #include <tensorflow/core/public/session.h> or \r\n#include \"tensorflow/cc/ops/standard_ops.h\" I cannot read images from cv::VideoCapture adn I got empty mat. When I didn't include these tensorflow headers, I can read frame successfully. Anyone could help me? Thanks a lot!!!\r\nI noticed other issues like [#1924](https://github.com/tensorflow/tensorflow/issues/1924?from=singlemessage) [#6496](https://github.com/tensorflow/tensorflow/issues/6496) but got no idea.\r\n\r\nHere is my cpp file:\r\n#include <tensorflow/core/platform/env.h>\r\n#include <tensorflow/core/public/session.h>\r\n#include \"tensorflow/cc/ops/standard_ops.h\"\r\n#include <opencv2/opencv.hpp>\r\n#include <iostream>\r\nusing namespace std;\r\nusing namespace tensorflow;\r\n\r\nint main()\r\n{\r\ncv::VideoCapture cap;\r\nif(!cap.open(\"/home/kx/project/RM-dataset/01.avi\")){\r\nstd::cout<<\"cannot open video \"<<std::endl;\r\n}\r\ncv::Mat frame;\r\nwhile(1){\r\ncap>>frame;\r\nif(frame.empty()){\r\nstd::cout<<\"no frame\"<<std::endl;\r\ncontinue;\r\n}\r\ncv::imshow(\"frame\",frame);\r\ncv::waitKey(0);\r\n}\r\nreturn 0;\r\n}\r\n\r\nmy cmake file:\r\n\r\ncmake_minimum_required (VERSION 2.8)\r\nproject (tf_example)\r\n\r\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -g -std=c++11 -W\")\r\nfind_package(OpenCV 3.1.0 REQUIRED)\r\ninclude_directories(\r\n/home/kx/something/tensorflow-r1.4\r\n/home/kx/something/tensorflow-r1.4/tensorflow/bazel-genfiles\r\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/protobuf/include\r\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/host_obj\r\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/gen/proto\r\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/downloads/nsync/public\r\n/home/kx/something/tensorflow-r1.4/tensorflow/contrib/makefile/downloads/eigen\r\n/home/kx/something/tensorflow-r1.4/bazel-out/local-py3-opt/genfiles\r\n${OPENCV_INCLUDE_DIRS}\r\n)\r\n\r\nadd_executable(tf_test tf_test.cpp)\r\ntarget_link_libraries(tf_test\r\n/home/kx/something/tensorflow-r1.4/bazel-bin/tensorflow/libtensorflow_cc.so\r\n/home/kx/something/tensorflow-r1.4/bazel-bin/tensorflow/libtensorflow_framework.so\r\n${OpenCV_LIBS}\r\n)\r\n\r\nThe results:\r\nno frame\r\n\r\n"}