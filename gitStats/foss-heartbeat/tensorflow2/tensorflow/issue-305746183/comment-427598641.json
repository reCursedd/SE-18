{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/427598641", "html_url": "https://github.com/tensorflow/tensorflow/issues/17747#issuecomment-427598641", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17747", "id": 427598641, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzU5ODY0MQ==", "user": {"login": "gogobd", "id": 728976, "node_id": "MDQ6VXNlcjcyODk3Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/728976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gogobd", "html_url": "https://github.com/gogobd", "followers_url": "https://api.github.com/users/gogobd/followers", "following_url": "https://api.github.com/users/gogobd/following{/other_user}", "gists_url": "https://api.github.com/users/gogobd/gists{/gist_id}", "starred_url": "https://api.github.com/users/gogobd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gogobd/subscriptions", "organizations_url": "https://api.github.com/users/gogobd/orgs", "repos_url": "https://api.github.com/users/gogobd/repos", "events_url": "https://api.github.com/users/gogobd/events{/privacy}", "received_events_url": "https://api.github.com/users/gogobd/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-06T19:04:54Z", "updated_at": "2018-10-13T09:11:36Z", "author_association": "NONE", "body_html": "<p>I've got the same issue running the code above with Windows 10, tensorflow 1.8.0, cudatoolkit 9.0 (anaconda), cudnn 7.1.4 (anaconda) on a GTX 970 (msi), any help would be very appreciated...</p>\n<pre><code>&gt;python test_tf_CUDA_ERROR_ILLEGAL_INSTRUCTION.py\n2018-10-06 21:06:28.880502: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1356] Found device 0 with properties:\nname: GeForce GTX 970 major: 5 minor: 2 memoryClockRate(GHz): 1.253\npciBusID: 0000:02:00.0\ntotalMemory: 4.00GiB freeMemory: 3.30GiB\n2018-10-06 21:06:28.892851: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1435] Adding visible gpu devices: 0\n2018-10-06 21:06:29.561979: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-10-06 21:06:29.567773: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:929]      0\n2018-10-06 21:06:29.574945: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:942] 0:   N\n2018-10-06 21:06:29.579561: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2048 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 970, pci bus id: 0000:02:00.0, compute capability: 5.2)\n2018-10-06 21:06:29.887384: E C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_driver.cc:1110] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_INSTRUCTION ::\n2018-10-06 21:06:29.887400: E C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_event.cc:49] Error polling for event status: failed to query event: CUDA_ERROR_ILLEGAL_INSTRUCTION\n2018-10-06 21:06:29.898608: F C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_event_mgr.cc:208] Unexpected Event status: 1\n</code></pre>\n<p>The code to reproduce this is:</p>\n<pre><code>import tensorflow as tf\n\nbatch_size = 64\nimages = tf.random_normal(shape=[batch_size, 32, 32, 3], dtype=tf.float32)\nangles = tf.random_uniform([batch_size], -0.5, 0.5)\nimages = tf.contrib.image.rotate(images, angles)\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.5)\n\nwith tf.Session(config=tf.ConfigProto(gpu_options=gpu_options)) as sess:\n    _ = sess.run(images)\n</code></pre>", "body_text": "I've got the same issue running the code above with Windows 10, tensorflow 1.8.0, cudatoolkit 9.0 (anaconda), cudnn 7.1.4 (anaconda) on a GTX 970 (msi), any help would be very appreciated...\n>python test_tf_CUDA_ERROR_ILLEGAL_INSTRUCTION.py\n2018-10-06 21:06:28.880502: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1356] Found device 0 with properties:\nname: GeForce GTX 970 major: 5 minor: 2 memoryClockRate(GHz): 1.253\npciBusID: 0000:02:00.0\ntotalMemory: 4.00GiB freeMemory: 3.30GiB\n2018-10-06 21:06:28.892851: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1435] Adding visible gpu devices: 0\n2018-10-06 21:06:29.561979: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-10-06 21:06:29.567773: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:929]      0\n2018-10-06 21:06:29.574945: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:942] 0:   N\n2018-10-06 21:06:29.579561: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2048 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970, pci bus id: 0000:02:00.0, compute capability: 5.2)\n2018-10-06 21:06:29.887384: E C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_driver.cc:1110] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_INSTRUCTION ::\n2018-10-06 21:06:29.887400: E C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_event.cc:49] Error polling for event status: failed to query event: CUDA_ERROR_ILLEGAL_INSTRUCTION\n2018-10-06 21:06:29.898608: F C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_event_mgr.cc:208] Unexpected Event status: 1\n\nThe code to reproduce this is:\nimport tensorflow as tf\n\nbatch_size = 64\nimages = tf.random_normal(shape=[batch_size, 32, 32, 3], dtype=tf.float32)\nangles = tf.random_uniform([batch_size], -0.5, 0.5)\nimages = tf.contrib.image.rotate(images, angles)\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.5)\n\nwith tf.Session(config=tf.ConfigProto(gpu_options=gpu_options)) as sess:\n    _ = sess.run(images)", "body": "I've got the same issue running the code above with Windows 10, tensorflow 1.8.0, cudatoolkit 9.0 (anaconda), cudnn 7.1.4 (anaconda) on a GTX 970 (msi), any help would be very appreciated...\r\n\r\n```\r\n>python test_tf_CUDA_ERROR_ILLEGAL_INSTRUCTION.py\r\n2018-10-06 21:06:28.880502: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1356] Found device 0 with properties:\r\nname: GeForce GTX 970 major: 5 minor: 2 memoryClockRate(GHz): 1.253\r\npciBusID: 0000:02:00.0\r\ntotalMemory: 4.00GiB freeMemory: 3.30GiB\r\n2018-10-06 21:06:28.892851: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1435] Adding visible gpu devices: 0\r\n2018-10-06 21:06:29.561979: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-10-06 21:06:29.567773: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:929]      0\r\n2018-10-06 21:06:29.574945: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:942] 0:   N\r\n2018-10-06 21:06:29.579561: I C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2048 MB memory) -> physical GPU (device: 0, name: GeForce GTX 970, pci bus id: 0000:02:00.0, compute capability: 5.2)\r\n2018-10-06 21:06:29.887384: E C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_driver.cc:1110] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_INSTRUCTION ::\r\n2018-10-06 21:06:29.887400: E C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\stream_executor\\cuda\\cuda_event.cc:49] Error polling for event status: failed to query event: CUDA_ERROR_ILLEGAL_INSTRUCTION\r\n2018-10-06 21:06:29.898608: F C:\\users\\nwani\\_bazel_nwani\\mmtm6wb6\\execroot\\org_tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_event_mgr.cc:208] Unexpected Event status: 1\r\n```\r\n\r\nThe code to reproduce this is:\r\n```\r\nimport tensorflow as tf\r\n\r\nbatch_size = 64\r\nimages = tf.random_normal(shape=[batch_size, 32, 32, 3], dtype=tf.float32)\r\nangles = tf.random_uniform([batch_size], -0.5, 0.5)\r\nimages = tf.contrib.image.rotate(images, angles)\r\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.5)\r\n\r\nwith tf.Session(config=tf.ConfigProto(gpu_options=gpu_options)) as sess:\r\n    _ = sess.run(images)\r\n```"}