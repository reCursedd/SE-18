{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/330249213", "html_url": "https://github.com/tensorflow/tensorflow/issues/13090#issuecomment-330249213", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13090", "id": 330249213, "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDI0OTIxMw==", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-18T14:54:21Z", "updated_at": "2017-09-18T14:54:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I think the problem is that you're trying to load a file in the <code>SavedModel</code> format into a <code>GraphDef</code> protobuf message, and this is silently failing. While a <code>SavedModel</code> may contain one or more <code>GraphDef</code> messages, they are not equivalent.</p>\n<hr>\n<p>Based on a quick look at the <a href=\"https://github.com/tensorflow/tensorflow/blob/6e7539b8bc7ea1c921ab1865d202e543b80ef539/tensorflow/core/common_runtime/direct_session.cc#L368\"><code>DirectSession::Create()</code></a> code, the behavior you're seeing could be explained if <code>model_graph</code> were <strong>empty</strong> after this line:</p>\n<div class=\"highlight highlight-source-objc\"><pre><span class=\"pl-en\">PortableReadFileToProto</span>([model_path <span class=\"pl-c1\">UTF8String</span>], &amp;model_graph);</pre></div>\n<p>Can you try the following two things?</p>\n<ol>\n<li>Can you check whether or not <code>model_graph</code> contains any nodes after you read the file? Printing <code>model_graph.node_size()</code> and checking whether it is greater than 0 should suffice.</li>\n<li>From the code it looks like <a href=\"https://github.com/tensorflow/tensorflow/blob/6e7539b8bc7ea1c921ab1865d202e543b80ef539/tensorflow/examples/ios/camera/tensorflow_utils.mm#L86\"><code>PortableReadFileToProto()</code></a> returns a <code>bool</code> to indicate success or failure. Can you check its value?</li>\n</ol>", "body_text": "I think the problem is that you're trying to load a file in the SavedModel format into a GraphDef protobuf message, and this is silently failing. While a SavedModel may contain one or more GraphDef messages, they are not equivalent.\n\nBased on a quick look at the DirectSession::Create() code, the behavior you're seeing could be explained if model_graph were empty after this line:\nPortableReadFileToProto([model_path UTF8String], &model_graph);\nCan you try the following two things?\n\nCan you check whether or not model_graph contains any nodes after you read the file? Printing model_graph.node_size() and checking whether it is greater than 0 should suffice.\nFrom the code it looks like PortableReadFileToProto() returns a bool to indicate success or failure. Can you check its value?", "body": "I think the problem is that you're trying to load a file in the `SavedModel` format into a `GraphDef` protobuf message, and this is silently failing. While a `SavedModel` may contain one or more `GraphDef` messages, they are not equivalent.\r\n\r\n---\r\n\r\nBased on a quick look at the [`DirectSession::Create()`](https://github.com/tensorflow/tensorflow/blob/6e7539b8bc7ea1c921ab1865d202e543b80ef539/tensorflow/core/common_runtime/direct_session.cc#L368) code, the behavior you're seeing could be explained if `model_graph` were **empty** after this line:\r\n\r\n```objc\r\nPortableReadFileToProto([model_path UTF8String], &model_graph);\r\n```\r\n\r\nCan you try the following two things?\r\n\r\n1. Can you check whether or not `model_graph` contains any nodes after you read the file? Printing `model_graph.node_size()` and checking whether it is greater than 0 should suffice.\r\n2. From the code it looks like [`PortableReadFileToProto()`](https://github.com/tensorflow/tensorflow/blob/6e7539b8bc7ea1c921ab1865d202e543b80ef539/tensorflow/examples/ios/camera/tensorflow_utils.mm#L86) returns a `bool` to indicate success or failure. Can you check its value?"}