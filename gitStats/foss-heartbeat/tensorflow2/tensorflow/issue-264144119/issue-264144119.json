{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13603", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13603/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13603/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13603/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13603", "id": 264144119, "node_id": "MDU6SXNzdWUyNjQxNDQxMTk=", "number": 13603, "title": "SVD on GPU is slower than SVD on CPU", "user": {"login": "hzhangxyz", "id": 11623447, "node_id": "MDQ6VXNlcjExNjIzNDQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/11623447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hzhangxyz", "html_url": "https://github.com/hzhangxyz", "followers_url": "https://api.github.com/users/hzhangxyz/followers", "following_url": "https://api.github.com/users/hzhangxyz/following{/other_user}", "gists_url": "https://api.github.com/users/hzhangxyz/gists{/gist_id}", "starred_url": "https://api.github.com/users/hzhangxyz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hzhangxyz/subscriptions", "organizations_url": "https://api.github.com/users/hzhangxyz/orgs", "repos_url": "https://api.github.com/users/hzhangxyz/repos", "events_url": "https://api.github.com/users/hzhangxyz/events{/privacy}", "received_events_url": "https://api.github.com/users/hzhangxyz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2017-10-10T08:42:13Z", "updated_at": "2018-11-20T07:51:48Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>OS:</p>\n<ul>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: CentOS release 7.4.1708</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: From source</li>\n<li><strong>Python version</strong>: 2.7.13</li>\n<li><strong>Bazel version</strong>: 0.6.1</li>\n<li><strong>CUDA/cuDNN version</strong>: CUDA 8.0/cuDNN 6.0.21</li>\n<li><strong>GPU model and memory</strong>: GeForce GTX 950M, memory 4GB</li>\n</ul>\n<p>output of <code>tf_env_collect.sh</code></p>\n<pre><code>\n== cat /etc/issue ===============================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"7 (Core)\"\nVERSION_ID=\"7\"\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\n\n== are we in docker =============================================\nNo\n\n== compiler =====================================================\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\nCopyright \u00a9 2015 Free Software Foundation, Inc.\n\u672c\u7a0b\u5e8f\u662f\u81ea\u7531\u8f6f\u4ef6\uff1b\u8bf7\u53c2\u770b\u6e90\u4ee3\u7801\u7684\u7248\u6743\u58f0\u660e\u3002\u672c\u8f6f\u4ef6\u6ca1\u6709\u4efb\u4f55\u62c5\u4fdd\uff1b\n\u5305\u62ec\u6ca1\u6709\u9002\u9500\u6027\u548c\u67d0\u4e00\u4e13\u7528\u76ee\u7684\u4e0b\u7684\u9002\u7528\u6027\u62c5\u4fdd\u3002\n\n== uname -a =====================================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\nImportError: No module named tensorflow\n\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nTue Oct 10 16:36:08 2017       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\n| N/A   45C    P0    N/A /  N/A |      0MiB /  4044MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n\n== cat /etc/issue ===============================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"7 (Core)\"\nVERSION_ID=\"7\"\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\n\n== are we in docker =============================================\nNo\n\n== compiler =====================================================\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\nCopyright \u00a9 2015 Free Software Foundation, Inc.\n\u672c\u7a0b\u5e8f\u662f\u81ea\u7531\u8f6f\u4ef6\uff1b\u8bf7\u53c2\u770b\u6e90\u4ee3\u7801\u7684\u7248\u6743\u58f0\u660e\u3002\u672c\u8f6f\u4ef6\u6ca1\u6709\u4efb\u4f55\u62c5\u4fdd\uff1b\n\u5305\u62ec\u6ca1\u6709\u9002\u9500\u6027\u548c\u67d0\u4e00\u4e13\u7528\u76ee\u7684\u4e0b\u7684\u9002\u7528\u6027\u62c5\u4fdd\u3002\n\n== uname -a =====================================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.12.1)\nprotobuf (3.4.0)\ntensorflow (1.4.0rc0)\ntensorflow-tensorboard (0.4.0rc1)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.4.0-rc0\ntf.GIT_VERSION = v1.3.0-rc1-3111-g4196d6d\ntf.COMPILER_VERSION = v1.3.0-rc1-3111-g4196d6d\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH /usr/local/cuda/lib64/:/usr/local/cuda/lib64/stubs/:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/nvvm/lib64/:/usr/lib64/nvidia/:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/mic/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/tbb/lib/intel64/gcc4.7:/opt/intel/debugger_2017/iga/lib:/opt/intel/debugger_2017/libipt/intel64/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/daal/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/daal/../tbb/lib/intel64_lin/gcc4.4\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nTue Oct 10 16:36:37 2017       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\n| N/A   45C    P0    N/A /  N/A |      0MiB /  4044MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\n</code></pre>\n<p>output of <code>python -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"</code></p>\n<pre><code>('v1.3.0-rc1-3111-g4196d6d', '1.4.0-rc0')\n</code></pre>\n<h3>Describe the problem</h3>\n<p>SVD on GPU is slower than SVD on CPU</p>\n<h3>Source code / logs</h3>\n<p>file main.py</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\nimport sys\n\nD = 1024\ndA = np.random.normal(size=(D,D))\n\ndev = \"/gpu:0\" if len(sys.argv)==1 else \"/cpu:0\"\n\nwith tf.device(dev):\n    A = tf.placeholder(shape=(D,D),dtype=tf.float32)\n    S, U, V = tf.svd(A)\n\nconfig = tf.ConfigProto()\nconfig.log_device_placement = True\nconfig.graph_options.optimizer_options.global_jit_level=tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\n\nfor _ in xrange(10):\n    dS, dU, dV = sess.run((S, U, V), feed_dict={A:dA})\n</code></pre>\n<h2>run on GPU</h2>\n<p><code>time python main.py</code></p>\n<pre><code>2017-10-10 16:28:49.047703: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:28:49.048176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:28:49.048205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:28:49.064960: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067234: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:GPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067302: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.074053: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x488e860\npython main.py  27.50s user 2.30s system 100% cpu 29.658 total\n</code></pre>\n<h2>run on CPU</h2>\n<p><code>time python main.py -</code></p>\n<pre><code>2017-10-10 16:29:53.252138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:29:53.252572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:29:53.252600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:29:53.269242: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -&gt; device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -&gt; device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -&gt; device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271505: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:CPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271544: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:CPU:0\npython main.py -  34.33s user 10.68s system 621% cpu 7.241 total\n</code></pre>", "body_text": "OS:\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS release 7.4.1708\nTensorFlow installed from (source or binary): From source\nPython version: 2.7.13\nBazel version: 0.6.1\nCUDA/cuDNN version: CUDA 8.0/cuDNN 6.0.21\nGPU model and memory: GeForce GTX 950M, memory 4GB\n\noutput of tf_env_collect.sh\n\n== cat /etc/issue ===============================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"7 (Core)\"\nVERSION_ID=\"7\"\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\n\n== are we in docker =============================================\nNo\n\n== compiler =====================================================\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\nCopyright \u00a9 2015 Free Software Foundation, Inc.\n\u672c\u7a0b\u5e8f\u662f\u81ea\u7531\u8f6f\u4ef6\uff1b\u8bf7\u53c2\u770b\u6e90\u4ee3\u7801\u7684\u7248\u6743\u58f0\u660e\u3002\u672c\u8f6f\u4ef6\u6ca1\u6709\u4efb\u4f55\u62c5\u4fdd\uff1b\n\u5305\u62ec\u6ca1\u6709\u9002\u9500\u6027\u548c\u67d0\u4e00\u4e13\u7528\u76ee\u7684\u4e0b\u7684\u9002\u7528\u6027\u62c5\u4fdd\u3002\n\n== uname -a =====================================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nImportError: No module named tensorflow\n\n== env ==========================================================\nLD_LIBRARY_PATH is unset\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nTue Oct 10 16:36:08 2017       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\n| N/A   45C    P0    N/A /  N/A |      0MiB /  4044MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n\n== cat /etc/issue ===============================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nVERSION=\"7 (Core)\"\nVERSION_ID=\"7\"\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\n\n== are we in docker =============================================\nNo\n\n== compiler =====================================================\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\nCopyright \u00a9 2015 Free Software Foundation, Inc.\n\u672c\u7a0b\u5e8f\u662f\u81ea\u7531\u8f6f\u4ef6\uff1b\u8bf7\u53c2\u770b\u6e90\u4ee3\u7801\u7684\u7248\u6743\u58f0\u660e\u3002\u672c\u8f6f\u4ef6\u6ca1\u6709\u4efb\u4f55\u62c5\u4fdd\uff1b\n\u5305\u62ec\u6ca1\u6709\u9002\u9500\u6027\u548c\u67d0\u4e00\u4e13\u7528\u76ee\u7684\u4e0b\u7684\u9002\u7528\u6027\u62c5\u4fdd\u3002\n\n== uname -a =====================================================\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.12.1)\nprotobuf (3.4.0)\ntensorflow (1.4.0rc0)\ntensorflow-tensorboard (0.4.0rc1)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.4.0-rc0\ntf.GIT_VERSION = v1.3.0-rc1-3111-g4196d6d\ntf.COMPILER_VERSION = v1.3.0-rc1-3111-g4196d6d\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH /usr/local/cuda/lib64/:/usr/local/cuda/lib64/stubs/:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/nvvm/lib64/:/usr/lib64/nvidia/:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/mic/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/tbb/lib/intel64/gcc4.7:/opt/intel/debugger_2017/iga/lib:/opt/intel/debugger_2017/libipt/intel64/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/daal/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/daal/../tbb/lib/intel64_lin/gcc4.4\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nTue Oct 10 16:36:37 2017       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\n| N/A   45C    P0    N/A /  N/A |      0MiB /  4044MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\n\noutput of python -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\n('v1.3.0-rc1-3111-g4196d6d', '1.4.0-rc0')\n\nDescribe the problem\nSVD on GPU is slower than SVD on CPU\nSource code / logs\nfile main.py\nimport tensorflow as tf\nimport numpy as np\nimport sys\n\nD = 1024\ndA = np.random.normal(size=(D,D))\n\ndev = \"/gpu:0\" if len(sys.argv)==1 else \"/cpu:0\"\n\nwith tf.device(dev):\n    A = tf.placeholder(shape=(D,D),dtype=tf.float32)\n    S, U, V = tf.svd(A)\n\nconfig = tf.ConfigProto()\nconfig.log_device_placement = True\nconfig.graph_options.optimizer_options.global_jit_level=tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\n\nfor _ in xrange(10):\n    dS, dU, dV = sess.run((S, U, V), feed_dict={A:dA})\n\nrun on GPU\ntime python main.py\n2017-10-10 16:28:49.047703: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:28:49.048176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:28:49.048205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:28:49.064960: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067234: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:GPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.067302: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:GPU:0\n2017-10-10 16:28:49.074053: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x488e860\npython main.py  27.50s user 2.30s system 100% cpu 29.658 total\n\nrun on CPU\ntime python main.py -\n2017-10-10 16:29:53.252138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2017-10-10 16:29:53.252572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2017-10-10 16:29:53.252600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\nDevice mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n2017-10-10 16:29:53.269242: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\n\nSvd: (Svd): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271505: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:CPU:0\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:CPU:0\n2017-10-10 16:29:53.271544: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:CPU:0\npython main.py -  34.33s user 10.68s system 621% cpu 7.241 total", "body": "OS:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: CentOS release 7.4.1708\r\n- **TensorFlow installed from (source or binary)**: From source\r\n- **Python version**: 2.7.13\r\n- **Bazel version**: 0.6.1\r\n- **CUDA/cuDNN version**: CUDA 8.0/cuDNN 6.0.21\r\n- **GPU model and memory**: GeForce GTX 950M, memory 4GB\r\n\r\noutput of `tf_env_collect.sh`\r\n```\r\n\r\n== cat /etc/issue ===============================================\r\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"7 (Core)\"\r\nVERSION_ID=\"7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\r\nCopyright \u00a9 2015 Free Software Foundation, Inc.\r\n\u672c\u7a0b\u5e8f\u662f\u81ea\u7531\u8f6f\u4ef6\uff1b\u8bf7\u53c2\u770b\u6e90\u4ee3\u7801\u7684\u7248\u6743\u58f0\u660e\u3002\u672c\u8f6f\u4ef6\u6ca1\u6709\u4efb\u4f55\u62c5\u4fdd\uff1b\r\n\u5305\u62ec\u6ca1\u6709\u9002\u9500\u6027\u548c\u67d0\u4e00\u4e13\u7528\u76ee\u7684\u4e0b\u7684\u9002\u7528\u6027\u62c5\u4fdd\u3002\r\n\r\n== uname -a =====================================================\r\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\nImportError: No module named tensorflow\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nTue Oct 10 16:36:08 2017       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\r\n| N/A   45C    P0    N/A /  N/A |      0MiB /  4044MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n\r\n== cat /etc/issue ===============================================\r\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"7 (Core)\"\r\nVERSION_ID=\"7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\r\nCopyright \u00a9 2015 Free Software Foundation, Inc.\r\n\u672c\u7a0b\u5e8f\u662f\u81ea\u7531\u8f6f\u4ef6\uff1b\u8bf7\u53c2\u770b\u6e90\u4ee3\u7801\u7684\u7248\u6743\u58f0\u660e\u3002\u672c\u8f6f\u4ef6\u6ca1\u6709\u4efb\u4f55\u62c5\u4fdd\uff1b\r\n\u5305\u62ec\u6ca1\u6709\u9002\u9500\u6027\u548c\u67d0\u4e00\u4e13\u7528\u76ee\u7684\u4e0b\u7684\u9002\u7528\u6027\u62c5\u4fdd\u3002\r\n\r\n== uname -a =====================================================\r\nLinux zhanghao 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.12.1)\r\nprotobuf (3.4.0)\r\ntensorflow (1.4.0rc0)\r\ntensorflow-tensorboard (0.4.0rc1)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.4.0-rc0\r\ntf.GIT_VERSION = v1.3.0-rc1-3111-g4196d6d\r\ntf.COMPILER_VERSION = v1.3.0-rc1-3111-g4196d6d\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /usr/local/cuda/lib64/:/usr/local/cuda/lib64/stubs/:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/nvvm/lib64/:/usr/lib64/nvidia/:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/mic/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries_2017.4.196/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/tbb/lib/intel64/gcc4.7:/opt/intel/debugger_2017/iga/lib:/opt/intel/debugger_2017/libipt/intel64/lib:/opt/intel/compilers_and_libraries_2017.4.196/linux/daal/lib/intel64_lin:/opt/intel/compilers_and_libraries_2017.4.196/linux/daal/../tbb/lib/intel64_lin/gcc4.4\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nTue Oct 10 16:36:37 2017       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\r\n| N/A   45C    P0    N/A /  N/A |      0MiB /  4044MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\r\n```\r\n\r\noutput of `python -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"`\r\n```\r\n('v1.3.0-rc1-3111-g4196d6d', '1.4.0-rc0')\r\n```\r\n\r\n### Describe the problem\r\n\r\nSVD on GPU is slower than SVD on CPU\r\n\r\n### Source code / logs\r\n\r\nfile main.py\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\nimport sys\r\n\r\nD = 1024\r\ndA = np.random.normal(size=(D,D))\r\n\r\ndev = \"/gpu:0\" if len(sys.argv)==1 else \"/cpu:0\"\r\n\r\nwith tf.device(dev):\r\n    A = tf.placeholder(shape=(D,D),dtype=tf.float32)\r\n    S, U, V = tf.svd(A)\r\n\r\nconfig = tf.ConfigProto()\r\nconfig.log_device_placement = True\r\nconfig.graph_options.optimizer_options.global_jit_level=tf.OptimizerOptions.ON_1\r\nsess = tf.Session(config=config)\r\n\r\nfor _ in xrange(10):\r\n    dS, dU, dV = sess.run((S, U, V), feed_dict={A:dA})\r\n```\r\n\r\n## run on GPU\r\n`time python main.py`\r\n```\r\n2017-10-10 16:28:49.047703: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2017-10-10 16:28:49.048176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2017-10-10 16:28:49.048205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n2017-10-10 16:28:49.064960: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n\r\nSvd: (Svd): /job:localhost/replica:0/task:0/device:GPU:0\r\n2017-10-10 16:28:49.067234: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:GPU:0\r\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:GPU:0\r\n2017-10-10 16:28:49.067302: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:GPU:0\r\n2017-10-10 16:28:49.074053: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x488e860\r\npython main.py  27.50s user 2.30s system 100% cpu 29.658 total\r\n```\r\n\r\n## run on CPU\r\n`time python main.py -`\r\n```\r\n2017-10-10 16:29:53.252138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2017-10-10 16:29:53.252572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2017-10-10 16:29:53.252600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n2017-10-10 16:29:53.269242: I tensorflow/core/common_runtime/direct_session.cc:299] Device mapping:\r\n/job:localhost/replica:0/task:0/device:XLA_GPU:0 -> device: XLA_GPU device\r\n/job:localhost/replica:0/task:0/device:XLA_CPU:0 -> device: XLA_CPU device\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0\r\n\r\nSvd: (Svd): /job:localhost/replica:0/task:0/device:CPU:0\r\n2017-10-10 16:29:53.271505: I tensorflow/core/common_runtime/placer.cc:874] Svd: (Svd)/job:localhost/replica:0/task:0/device:CPU:0\r\nPlaceholder: (Placeholder): /job:localhost/replica:0/task:0/device:CPU:0\r\n2017-10-10 16:29:53.271544: I tensorflow/core/common_runtime/placer.cc:874] Placeholder: (Placeholder)/job:localhost/replica:0/task:0/device:CPU:0\r\npython main.py -  34.33s user 10.68s system 621% cpu 7.241 total\r\n```"}