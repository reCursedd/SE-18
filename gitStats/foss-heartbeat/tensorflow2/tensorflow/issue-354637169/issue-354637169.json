{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21919", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21919/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21919/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21919/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21919", "id": 354637169, "node_id": "MDU6SXNzdWUzNTQ2MzcxNjk=", "number": 21919, "title": "Error: Can not allocate memory for the given inputs: external/tensorflow/tensorflow/contrib/lite/kernels/sub.cc:48 NumDimensions(input1) != NumDimensions(input2) (4 != 0)", "user": {"login": "seayqrain", "id": 22736331, "node_id": "MDQ6VXNlcjIyNzM2MzMx", "avatar_url": "https://avatars2.githubusercontent.com/u/22736331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seayqrain", "html_url": "https://github.com/seayqrain", "followers_url": "https://api.github.com/users/seayqrain/followers", "following_url": "https://api.github.com/users/seayqrain/following{/other_user}", "gists_url": "https://api.github.com/users/seayqrain/gists{/gist_id}", "starred_url": "https://api.github.com/users/seayqrain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seayqrain/subscriptions", "organizations_url": "https://api.github.com/users/seayqrain/orgs", "repos_url": "https://api.github.com/users/seayqrain/repos", "events_url": "https://api.github.com/users/seayqrain/events{/privacy}", "received_events_url": "https://api.github.com/users/seayqrain/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-28T09:05:25Z", "updated_at": "2018-08-31T02:16:24Z", "closed_at": "2018-08-31T02:16:24Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>**Have I written custom code (as opposed to using a stock example script provided in TensorFlow):<br>\nI only replace the model we retained refer to tensorflow-for-poets.</li>\n<li>**OS Platform and Distribution (e.g., Linux Ubuntu 16.04):<br>\nUbuntu 14.04.3 LTS</li>\n<li>**Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:<br>\nLG G4</li>\n<li>**TensorFlow installed from (source or binary):binary</li>\n<li>**TensorFlow version (use command below):1.7.1</li>\n<li>**Python version:2.7.6</li>\n<li>**Bazel version (if compiling from source): NA</li>\n<li>**GCC/Compiler version (if compiling from source): NA</li>\n<li>**CUDA/cuDNN version: NA</li>\n<li>**GPU model and memory: NA</li>\n<li>**Exact command to reproduce:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Hi,<br>\nI retrained a model refer to tensorflow-for-poets, the retrain command is:</p>\n<blockquote>\n<p>python -m scripts.retrain <br>\n  --bottleneck_dir=tf_files/bottlenecks <br>\n  --model_dir=tf_files/models/ <br>\n  --summaries_dir=tf_files/training_summaries/mobilenet_v2_140_224 <br>\n  --output_graph=tf_files/retrained_graph.pb <br>\n  --output_labels=tf_files/retrained_labels.txt <br>\n  --tfhub_module=<a href=\"https://tfhub.dev/google/imagenet/mobilenet_v2_140_224/feature_vector/2\" rel=\"nofollow\">https://tfhub.dev/google/imagenet/mobilenet_v2_140_224/feature_vector/2</a> <br>\n  --how_many_training_steps=8000 <br>\n  --learning_rate=0.005 <br>\n  --flip_left_right True <br>\n  --random_crop=10 <br>\n  --random_scale=10 <br>\n  --random_brightness=10 <br>\n  --image_dir=tf_files/tf_Images</p>\n</blockquote>\n<p>retrained_graph.pb works fine in our Android APP.<br>\nThen I converted \".pb\" to \".lite\" with this command:</p>\n<blockquote>\n<p>toco <br>\n  --input_file=tf_files/retrained_graph.pb <br>\n  --output_file=tf_files/retrained_graph.lite <br>\n  --input_format=TENSORFLOW_GRAPHDEF <br>\n  --output_format=TFLITE <br>\n  --input_shape=1,224,224,3 <br>\n  --input_array=Placeholder <br>\n  --output_array=final_result <br>\n  --inference_type=FLOAT <br>\n  --input_data_type=FLOAT</p>\n</blockquote>\n<p>But retrained_graph.lite <strong>can not</strong> work in our Android APP(refer to tensorflow-for-poets-2\\android\\tflite), the error is:</p>\n<blockquote>\n<p>08-23 18:15:33.202  2457  2475 E AndroidRuntime: java.lang.NullPointerException: Can not allocate memory for the given inputs: external/tensorflow/tensorflow/contrib/lite/kernels/sub.cc:48 NumDimensions(input1) != NumDimensions(input2) (4 != 0)<br>\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.NativeInterpreterWrapper.run(Native Method)<br>\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.NativeInterpreterWrapper.run(NativeInterpreterWrapper.java:95)<br>\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs(Interpreter.java:113)<br>\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.Interpreter.run(Interpreter.java:94)</p>\n</blockquote>\n<p><strong>Please help to analyze that why this error occurs? Thanks!</strong></p>", "body_text": "System information\n\n**Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\nI only replace the model we retained refer to tensorflow-for-poets.\n**OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nUbuntu 14.04.3 LTS\n**Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\nLG G4\n**TensorFlow installed from (source or binary):binary\n**TensorFlow version (use command below):1.7.1\n**Python version:2.7.6\n**Bazel version (if compiling from source): NA\n**GCC/Compiler version (if compiling from source): NA\n**CUDA/cuDNN version: NA\n**GPU model and memory: NA\n**Exact command to reproduce:\n\nDescribe the problem\nHi,\nI retrained a model refer to tensorflow-for-poets, the retrain command is:\n\npython -m scripts.retrain \n  --bottleneck_dir=tf_files/bottlenecks \n  --model_dir=tf_files/models/ \n  --summaries_dir=tf_files/training_summaries/mobilenet_v2_140_224 \n  --output_graph=tf_files/retrained_graph.pb \n  --output_labels=tf_files/retrained_labels.txt \n  --tfhub_module=https://tfhub.dev/google/imagenet/mobilenet_v2_140_224/feature_vector/2 \n  --how_many_training_steps=8000 \n  --learning_rate=0.005 \n  --flip_left_right True \n  --random_crop=10 \n  --random_scale=10 \n  --random_brightness=10 \n  --image_dir=tf_files/tf_Images\n\nretrained_graph.pb works fine in our Android APP.\nThen I converted \".pb\" to \".lite\" with this command:\n\ntoco \n  --input_file=tf_files/retrained_graph.pb \n  --output_file=tf_files/retrained_graph.lite \n  --input_format=TENSORFLOW_GRAPHDEF \n  --output_format=TFLITE \n  --input_shape=1,224,224,3 \n  --input_array=Placeholder \n  --output_array=final_result \n  --inference_type=FLOAT \n  --input_data_type=FLOAT\n\nBut retrained_graph.lite can not work in our Android APP(refer to tensorflow-for-poets-2\\android\\tflite), the error is:\n\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: java.lang.NullPointerException: Can not allocate memory for the given inputs: external/tensorflow/tensorflow/contrib/lite/kernels/sub.cc:48 NumDimensions(input1) != NumDimensions(input2) (4 != 0)\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.NativeInterpreterWrapper.run(Native Method)\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.NativeInterpreterWrapper.run(NativeInterpreterWrapper.java:95)\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs(Interpreter.java:113)\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.Interpreter.run(Interpreter.java:94)\n\nPlease help to analyze that why this error occurs? Thanks!", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nI only replace the model we retained refer to tensorflow-for-poets.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nUbuntu 14.04.3 LTS\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nLG G4\r\n- **TensorFlow installed from (source or binary):binary\r\n- **TensorFlow version (use command below):1.7.1\r\n- **Python version:2.7.6\r\n- **Bazel version (if compiling from source): NA\r\n- **GCC/Compiler version (if compiling from source): NA\r\n- **CUDA/cuDNN version: NA\r\n- **GPU model and memory: NA\r\n- **Exact command to reproduce:\r\n\r\n\r\n### Describe the problem\r\nHi,\r\nI retrained a model refer to tensorflow-for-poets, the retrain command is:\r\n\r\n> python -m scripts.retrain \\\r\n  --bottleneck_dir=tf_files/bottlenecks \\\r\n  --model_dir=tf_files/models/ \\\r\n  --summaries_dir=tf_files/training_summaries/mobilenet_v2_140_224 \\\r\n  --output_graph=tf_files/retrained_graph.pb \\\r\n  --output_labels=tf_files/retrained_labels.txt \\\r\n  --tfhub_module=https://tfhub.dev/google/imagenet/mobilenet_v2_140_224/feature_vector/2 \\\r\n  --how_many_training_steps=8000 \\\r\n  --learning_rate=0.005 \\\r\n  --flip_left_right True \\\r\n  --random_crop=10 \\\r\n  --random_scale=10 \\\r\n  --random_brightness=10 \\\r\n  --image_dir=tf_files/tf_Images\r\n\r\nretrained_graph.pb works fine in our Android APP.\r\nThen I converted \".pb\" to \".lite\" with this command:\r\n\r\n> toco \\\r\n  --input_file=tf_files/retrained_graph.pb \\\r\n  --output_file=tf_files/retrained_graph.lite \\\r\n  --input_format=TENSORFLOW_GRAPHDEF \\\r\n  --output_format=TFLITE \\\r\n  --input_shape=1,224,224,3 \\\r\n  --input_array=Placeholder \\\r\n  --output_array=final_result \\\r\n  --inference_type=FLOAT \\\r\n  --input_data_type=FLOAT\r\n\r\nBut retrained_graph.lite **can not** work in our Android APP(refer to tensorflow-for-poets-2\\android\\tflite), the error is:\r\n\r\n> 08-23 18:15:33.202  2457  2475 E AndroidRuntime: java.lang.NullPointerException: Can not allocate memory for the given inputs: external/tensorflow/tensorflow/contrib/lite/kernels/sub.cc:48 NumDimensions(input1) != NumDimensions(input2) (4 != 0)\r\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.NativeInterpreterWrapper.run(Native Method)\r\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.NativeInterpreterWrapper.run(NativeInterpreterWrapper.java:95)\r\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs(Interpreter.java:113)\r\n08-23 18:15:33.202  2457  2475 E AndroidRuntime: \tat org.tensorflow.lite.Interpreter.run(Interpreter.java:94)\r\n\r\n**Please help to analyze that why this error occurs? Thanks!**"}