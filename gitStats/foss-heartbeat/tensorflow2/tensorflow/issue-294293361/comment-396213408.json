{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/396213408", "html_url": "https://github.com/tensorflow/tensorflow/issues/16768#issuecomment-396213408", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16768", "id": 396213408, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjIxMzQwOA==", "user": {"login": "laraibzubair18", "id": 25176675, "node_id": "MDQ6VXNlcjI1MTc2Njc1", "avatar_url": "https://avatars3.githubusercontent.com/u/25176675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/laraibzubair18", "html_url": "https://github.com/laraibzubair18", "followers_url": "https://api.github.com/users/laraibzubair18/followers", "following_url": "https://api.github.com/users/laraibzubair18/following{/other_user}", "gists_url": "https://api.github.com/users/laraibzubair18/gists{/gist_id}", "starred_url": "https://api.github.com/users/laraibzubair18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/laraibzubair18/subscriptions", "organizations_url": "https://api.github.com/users/laraibzubair18/orgs", "repos_url": "https://api.github.com/users/laraibzubair18/repos", "events_url": "https://api.github.com/users/laraibzubair18/events{/privacy}", "received_events_url": "https://api.github.com/users/laraibzubair18/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-11T11:37:09Z", "updated_at": "2018-06-11T11:37:09Z", "author_association": "NONE", "body_html": "<div class=\"email-fragment\">Kute harramte dele</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On 11 Jun 2018 16:35, \"daoud\" ***@***.***&gt; wrote:\n I am doing performance testing inception model flask api with gunicorn\n (creating multiple process) Error: OOM when allocating tensor with\n shape[800,1280,3] and type float on /job:localhost/replica:0/task:0/device:GPU:0\n by allocator GPU_0_bfc [[Node: Cast = CastDstT=DT_FLOAT, SrcT=DT_UINT8,\n _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]] Hint: If you\n want to see a list of allocated tensors when OOM happens, add\n report_tensor_allocations_upon_oom to RunOptions for current allocation\n info.\n\n Caused by op 'Cast', defined at: File \"/usr/local/bin/gunicorn\", line 11,\n in sys.exit(run()) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/app/wsgiapp.py\", line 61, in run\n WSGIApplication(\"%(prog)s [OPTIONS] [APP_MODULE]\").run() File\n \"/usr/local/lib/python3.5/dist-packages/gunicorn/app/base.py\", line 223,\n in run super(Application, self).run() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/app/base.py\", line 72, in run Arbiter(self).run()\n File \"/usr/local/lib/python3.5/dist-packages/gunicorn/arbiter.py\", line\n 212, in run self.manage_workers() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/arbiter.py\", line 545, in manage_workers\n self.spawn_workers() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/arbiter.py\", line 616, in spawn_workers\n self.spawn_worker() File \"/usr/local/lib/python3.5/dist-packages/gunicorn/arbiter.py\",\n line 583, in spawn_worker worker.init_process() File\n \"/usr/local/lib/python3.5/dist-packages/gunicorn/workers/base.py\", line\n 134, in init_process self.run() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 124, in run\n self.run_for_one(timeout) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 68, in run_for_one\n self.accept(listener) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 30, in accept\n self.handle(listener, client, addr) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 135, in handle\n self.handle_request(listener, req, client, addr) File\n \"/usr/local/lib/python3.5/dist-packages/gunicorn/workers/sync.py\", line\n 176, in handle_request respiter = self.wsgi(environ, resp.start_response)\n File \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1997, in\n call return self.wsgi_app(environ, start_response) File\n \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1982, in\n wsgi_app response = self.full_dispatch_request() File\n \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1612, in\n full_dispatch_request rv = self.dispatch_request() File\n \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1598, in\n dispatch_request return self.view_functionsrule.endpoint File\n \"/home/ubuntu/cv_workspace/computer_vision_services.py\", line 1480, in\n classify_bulk input_operation, output_operation, tf_session=sess) File\n \"/home/ubuntu/cv_workspace/src/apis/ImgClassification.py\", line 228, in\n classifyImageInSess t = read_tensor_from_image_file(file_name) File\n \"/home/ubuntu/cv_workspace/src/apis/ImgClassification.py\", line 51, in\n read_tensor_from_image_file float_caster = tf.cast(image_reader,\n tf.float32) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/math_ops.py\",\n line 758, in cast return gen_math_ops.cast(x, base_type, name=name) File\n \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_math_ops.py\",\n line 919, in cast \"Cast\", x=x, DstT=DstT, name=name) File\n \"/usr/local/lib/python3.5/dist-packages/tensorflow/\n python/framework/op_def_library.py\", line 787, in _apply_op_helper\n op_def=op_def) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\",\n line 3160, in create_op op_def=op_def) File \"/usr/local/lib/python3.5/\n dist-packages/tensorflow/python/framework/ops.py\", line 1625, in init\n self._traceback = self._graph._extract_stack() # pylint:\n disable=protected-access\n\n ################ GPU\n [image: image]\n &lt;<a href=\"https://user-images.githubusercontent.com/2271152/41229156-a212955c-6d98-11e8-8a7e-8d41001f3036.png\">https://user-images.githubusercontent.com/2271152/41229156-a212955c-6d98-11e8-8a7e-8d41001f3036.png</a>&gt;\n\n \u2014\n You are receiving this because you are subscribed to this thread.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"294293361\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/16768\" href=\"https://github.com/tensorflow/tensorflow/issues/16768#issuecomment-396211455\">#16768 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AYAqY45nRfM6H-3eb984gBdCr9zs0SbQks5t7lXtgaJpZM4R5AQq\">https://github.com/notifications/unsubscribe-auth/AYAqY45nRfM6H-3eb984gBdCr9zs0SbQks5t7lXtgaJpZM4R5AQq</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Kute harramte dele\n\u2026\nOn 11 Jun 2018 16:35, \"daoud\" ***@***.***> wrote:\n I am doing performance testing inception model flask api with gunicorn\n (creating multiple process) Error: OOM when allocating tensor with\n shape[800,1280,3] and type float on /job:localhost/replica:0/task:0/device:GPU:0\n by allocator GPU_0_bfc [[Node: Cast = CastDstT=DT_FLOAT, SrcT=DT_UINT8,\n _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]] Hint: If you\n want to see a list of allocated tensors when OOM happens, add\n report_tensor_allocations_upon_oom to RunOptions for current allocation\n info.\n\n Caused by op 'Cast', defined at: File \"/usr/local/bin/gunicorn\", line 11,\n in sys.exit(run()) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/app/wsgiapp.py\", line 61, in run\n WSGIApplication(\"%(prog)s [OPTIONS] [APP_MODULE]\").run() File\n \"/usr/local/lib/python3.5/dist-packages/gunicorn/app/base.py\", line 223,\n in run super(Application, self).run() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/app/base.py\", line 72, in run Arbiter(self).run()\n File \"/usr/local/lib/python3.5/dist-packages/gunicorn/arbiter.py\", line\n 212, in run self.manage_workers() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/arbiter.py\", line 545, in manage_workers\n self.spawn_workers() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/arbiter.py\", line 616, in spawn_workers\n self.spawn_worker() File \"/usr/local/lib/python3.5/dist-packages/gunicorn/arbiter.py\",\n line 583, in spawn_worker worker.init_process() File\n \"/usr/local/lib/python3.5/dist-packages/gunicorn/workers/base.py\", line\n 134, in init_process self.run() File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 124, in run\n self.run_for_one(timeout) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 68, in run_for_one\n self.accept(listener) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 30, in accept\n self.handle(listener, client, addr) File \"/usr/local/lib/python3.5/\n dist-packages/gunicorn/workers/sync.py\", line 135, in handle\n self.handle_request(listener, req, client, addr) File\n \"/usr/local/lib/python3.5/dist-packages/gunicorn/workers/sync.py\", line\n 176, in handle_request respiter = self.wsgi(environ, resp.start_response)\n File \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1997, in\n call return self.wsgi_app(environ, start_response) File\n \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1982, in\n wsgi_app response = self.full_dispatch_request() File\n \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1612, in\n full_dispatch_request rv = self.dispatch_request() File\n \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1598, in\n dispatch_request return self.view_functionsrule.endpoint File\n \"/home/ubuntu/cv_workspace/computer_vision_services.py\", line 1480, in\n classify_bulk input_operation, output_operation, tf_session=sess) File\n \"/home/ubuntu/cv_workspace/src/apis/ImgClassification.py\", line 228, in\n classifyImageInSess t = read_tensor_from_image_file(file_name) File\n \"/home/ubuntu/cv_workspace/src/apis/ImgClassification.py\", line 51, in\n read_tensor_from_image_file float_caster = tf.cast(image_reader,\n tf.float32) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/math_ops.py\",\n line 758, in cast return gen_math_ops.cast(x, base_type, name=name) File\n \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_math_ops.py\",\n line 919, in cast \"Cast\", x=x, DstT=DstT, name=name) File\n \"/usr/local/lib/python3.5/dist-packages/tensorflow/\n python/framework/op_def_library.py\", line 787, in _apply_op_helper\n op_def=op_def) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\",\n line 3160, in create_op op_def=op_def) File \"/usr/local/lib/python3.5/\n dist-packages/tensorflow/python/framework/ops.py\", line 1625, in init\n self._traceback = self._graph._extract_stack() # pylint:\n disable=protected-access\n\n ################ GPU\n [image: image]\n <https://user-images.githubusercontent.com/2271152/41229156-a212955c-6d98-11e8-8a7e-8d41001f3036.png>\n\n \u2014\n You are receiving this because you are subscribed to this thread.\n Reply to this email directly, view it on GitHub\n <#16768 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AYAqY45nRfM6H-3eb984gBdCr9zs0SbQks5t7lXtgaJpZM4R5AQq>\n .", "body": "Kute harramte dele\nOn 11 Jun 2018 16:35, \"daoud\" <notifications@github.com> wrote:\n\n> I am doing performance testing inception model flask api with gunicorn\n> (creating multiple process) Error: OOM when allocating tensor with\n> shape[800,1280,3] and type float on /job:localhost/replica:0/task:0/device:GPU:0\n> by allocator GPU_0_bfc [[Node: Cast = CastDstT=DT_FLOAT, SrcT=DT_UINT8,\n> _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]] Hint: If you\n> want to see a list of allocated tensors when OOM happens, add\n> report_tensor_allocations_upon_oom to RunOptions for current allocation\n> info.\n>\n> Caused by op 'Cast', defined at: File \"/usr/local/bin/gunicorn\", line 11,\n> in sys.exit(run()) File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/app/wsgiapp.py\", line 61, in run\n> WSGIApplication(\"%(prog)s [OPTIONS] [APP_MODULE]\").run() File\n> \"/usr/local/lib/python3.5/dist-packages/gunicorn/app/base.py\", line 223,\n> in run super(Application, self).run() File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/app/base.py\", line 72, in run Arbiter(self).run()\n> File \"/usr/local/lib/python3.5/dist-packages/gunicorn/arbiter.py\", line\n> 212, in run self.manage_workers() File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/arbiter.py\", line 545, in manage_workers\n> self.spawn_workers() File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/arbiter.py\", line 616, in spawn_workers\n> self.spawn_worker() File \"/usr/local/lib/python3.5/dist-packages/gunicorn/arbiter.py\",\n> line 583, in spawn_worker worker.init_process() File\n> \"/usr/local/lib/python3.5/dist-packages/gunicorn/workers/base.py\", line\n> 134, in init_process self.run() File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/workers/sync.py\", line 124, in run\n> self.run_for_one(timeout) File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/workers/sync.py\", line 68, in run_for_one\n> self.accept(listener) File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/workers/sync.py\", line 30, in accept\n> self.handle(listener, client, addr) File \"/usr/local/lib/python3.5/\n> dist-packages/gunicorn/workers/sync.py\", line 135, in handle\n> self.handle_request(listener, req, client, addr) File\n> \"/usr/local/lib/python3.5/dist-packages/gunicorn/workers/sync.py\", line\n> 176, in handle_request respiter = self.wsgi(environ, resp.start_response)\n> File \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1997, in\n> call return self.wsgi_app(environ, start_response) File\n> \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1982, in\n> wsgi_app response = self.full_dispatch_request() File\n> \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1612, in\n> full_dispatch_request rv = self.dispatch_request() File\n> \"/usr/local/lib/python3.5/dist-packages/flask/app.py\", line 1598, in\n> dispatch_request return self.view_functionsrule.endpoint File\n> \"/home/ubuntu/cv_workspace/computer_vision_services.py\", line 1480, in\n> classify_bulk input_operation, output_operation, tf_session=sess) File\n> \"/home/ubuntu/cv_workspace/src/apis/ImgClassification.py\", line 228, in\n> classifyImageInSess t = read_tensor_from_image_file(file_name) File\n> \"/home/ubuntu/cv_workspace/src/apis/ImgClassification.py\", line 51, in\n> read_tensor_from_image_file float_caster = tf.cast(image_reader,\n> tf.float32) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/math_ops.py\",\n> line 758, in cast return gen_math_ops.cast(x, base_type, name=name) File\n> \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_math_ops.py\",\n> line 919, in cast \"Cast\", x=x, DstT=DstT, name=name) File\n> \"/usr/local/lib/python3.5/dist-packages/tensorflow/\n> python/framework/op_def_library.py\", line 787, in _apply_op_helper\n> op_def=op_def) File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\",\n> line 3160, in create_op op_def=op_def) File \"/usr/local/lib/python3.5/\n> dist-packages/tensorflow/python/framework/ops.py\", line 1625, in init\n> self._traceback = self._graph._extract_stack() # pylint:\n> disable=protected-access\n>\n> ################ GPU\n> [image: image]\n> <https://user-images.githubusercontent.com/2271152/41229156-a212955c-6d98-11e8-8a7e-8d41001f3036.png>\n>\n> \u2014\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/16768#issuecomment-396211455>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AYAqY45nRfM6H-3eb984gBdCr9zs0SbQks5t7lXtgaJpZM4R5AQq>\n> .\n>\n"}