{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22124", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22124/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22124/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22124/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22124", "id": 357863573, "node_id": "MDU6SXNzdWUzNTc4NjM1NzM=", "number": 22124, "title": "python -c \"import tensorflow as tf\" fails when run in Dockerfile, works when inside container.", "user": {"login": "huawei-tomas", "id": 42659125, "node_id": "MDQ6VXNlcjQyNjU5MTI1", "avatar_url": "https://avatars2.githubusercontent.com/u/42659125?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huawei-tomas", "html_url": "https://github.com/huawei-tomas", "followers_url": "https://api.github.com/users/huawei-tomas/followers", "following_url": "https://api.github.com/users/huawei-tomas/following{/other_user}", "gists_url": "https://api.github.com/users/huawei-tomas/gists{/gist_id}", "starred_url": "https://api.github.com/users/huawei-tomas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huawei-tomas/subscriptions", "organizations_url": "https://api.github.com/users/huawei-tomas/orgs", "repos_url": "https://api.github.com/users/huawei-tomas/repos", "events_url": "https://api.github.com/users/huawei-tomas/events{/privacy}", "received_events_url": "https://api.github.com/users/huawei-tomas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-06T23:19:46Z", "updated_at": "2018-09-21T23:20:57Z", "closed_at": "2018-09-21T23:20:57Z", "author_association": "NONE", "body_html": "<p>So I can import tensorflow inside the docker container that I've pulled from DockerHub, but not in the Dockerfile.</p>\n<pre><code>thomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker build .\nSending build context to Docker daemon  2.048kB\nStep 1/2 : FROM tensorflow/tensorflow:latest-devel-gpu\n ---&gt; f73df9e66ebb\nStep 2/2 : RUN python -c \"import tensorflow as tf\"\n ---&gt; Running in 18e621bcd3b1\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/__init__.py\", line 22, in &lt;module&gt;\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/__init__.py\", line 49, in &lt;module&gt;\n    from tensorflow.python import pywrap_tensorflow\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow.py\", line 74, in &lt;module&gt;\n    raise ImportError(msg)\nImportError: Traceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow.py\", line 58, in &lt;module&gt;\n    from tensorflow.python.pywrap_tensorflow_internal import *\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 28, in &lt;module&gt;\n    _pywrap_tensorflow_internal = swig_import_helper()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\nImportError: libcuda.so.1: cannot open shared object file: No such file or directory\n\n\nFailed to load the native TensorFlow runtime.\n\nSee https://www.tensorflow.org/install/install_sources#common_installation_problems\n\nfor some common reasons and solutions.  Include the entire stack trace\nabove this error message when asking for help.\nThe command '/bin/sh -c python -c \"import tensorflow as tf\"' returned a non-zero code: 1\nthomas@fw0013591:~/code/tf_docker_bug$ nano Dockerfile\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker build .\nSending build context to Docker daemon  2.048kB\nStep 1/1 : FROM tensorflow/tensorflow:latest-devel-gpu\n ---&gt; f73df9e66ebb\nSuccessfully built f73df9e66ebb\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker run -it f73df9e66ebb /bin/bash\nroot@68ed17426105:~# python -c \"import tensorflow as tf\"\nroot@68ed17426105:~# \n</code></pre>\n<p>The dockerfile is incredibly simple. Looks like this:</p>\n<pre><code>FROM tensorflow/tensorflow:latest-devel-gpu\nRUN python -c \"import tensorflow as tf\"\n</code></pre>\n<p>Is this behavior to be expected?</p>", "body_text": "So I can import tensorflow inside the docker container that I've pulled from DockerHub, but not in the Dockerfile.\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker build .\nSending build context to Docker daemon  2.048kB\nStep 1/2 : FROM tensorflow/tensorflow:latest-devel-gpu\n ---> f73df9e66ebb\nStep 2/2 : RUN python -c \"import tensorflow as tf\"\n ---> Running in 18e621bcd3b1\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/__init__.py\", line 22, in <module>\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/__init__.py\", line 49, in <module>\n    from tensorflow.python import pywrap_tensorflow\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow.py\", line 74, in <module>\n    raise ImportError(msg)\nImportError: Traceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow.py\", line 58, in <module>\n    from tensorflow.python.pywrap_tensorflow_internal import *\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 28, in <module>\n    _pywrap_tensorflow_internal = swig_import_helper()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\nImportError: libcuda.so.1: cannot open shared object file: No such file or directory\n\n\nFailed to load the native TensorFlow runtime.\n\nSee https://www.tensorflow.org/install/install_sources#common_installation_problems\n\nfor some common reasons and solutions.  Include the entire stack trace\nabove this error message when asking for help.\nThe command '/bin/sh -c python -c \"import tensorflow as tf\"' returned a non-zero code: 1\nthomas@fw0013591:~/code/tf_docker_bug$ nano Dockerfile\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker build .\nSending build context to Docker daemon  2.048kB\nStep 1/1 : FROM tensorflow/tensorflow:latest-devel-gpu\n ---> f73df9e66ebb\nSuccessfully built f73df9e66ebb\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker run -it f73df9e66ebb /bin/bash\nroot@68ed17426105:~# python -c \"import tensorflow as tf\"\nroot@68ed17426105:~# \n\nThe dockerfile is incredibly simple. Looks like this:\nFROM tensorflow/tensorflow:latest-devel-gpu\nRUN python -c \"import tensorflow as tf\"\n\nIs this behavior to be expected?", "body": "\r\n\r\nSo I can import tensorflow inside the docker container that I've pulled from DockerHub, but not in the Dockerfile.\r\n```\r\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker build .\r\nSending build context to Docker daemon  2.048kB\r\nStep 1/2 : FROM tensorflow/tensorflow:latest-devel-gpu\r\n ---> f73df9e66ebb\r\nStep 2/2 : RUN python -c \"import tensorflow as tf\"\r\n ---> Running in 18e621bcd3b1\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/__init__.py\", line 22, in <module>\r\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/__init__.py\", line 49, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow.py\", line 74, in <module>\r\n    raise ImportError(msg)\r\nImportError: Traceback (most recent call last):\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow.py\", line 58, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\nImportError: libcuda.so.1: cannot open shared object file: No such file or directory\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n\r\nSee https://www.tensorflow.org/install/install_sources#common_installation_problems\r\n\r\nfor some common reasons and solutions.  Include the entire stack trace\r\nabove this error message when asking for help.\r\nThe command '/bin/sh -c python -c \"import tensorflow as tf\"' returned a non-zero code: 1\r\nthomas@fw0013591:~/code/tf_docker_bug$ nano Dockerfile\r\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker build .\r\nSending build context to Docker daemon  2.048kB\r\nStep 1/1 : FROM tensorflow/tensorflow:latest-devel-gpu\r\n ---> f73df9e66ebb\r\nSuccessfully built f73df9e66ebb\r\nthomas@fw0013591:~/code/tf_docker_bug$ nvidia-docker run -it f73df9e66ebb /bin/bash\r\nroot@68ed17426105:~# python -c \"import tensorflow as tf\"\r\nroot@68ed17426105:~# \r\n```\r\n\r\nThe dockerfile is incredibly simple. Looks like this:\r\n```\r\nFROM tensorflow/tensorflow:latest-devel-gpu\r\nRUN python -c \"import tensorflow as tf\"\r\n```\r\n\r\nIs this behavior to be expected?"}