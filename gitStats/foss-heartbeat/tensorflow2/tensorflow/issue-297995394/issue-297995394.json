{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17090", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17090/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17090/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17090/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/17090", "id": 297995394, "node_id": "MDU6SXNzdWUyOTc5OTUzOTQ=", "number": 17090, "title": "XLA CHECK-fails when using tf.random_normal op", "user": {"login": "hzhangxyz", "id": 11623447, "node_id": "MDQ6VXNlcjExNjIzNDQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/11623447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hzhangxyz", "html_url": "https://github.com/hzhangxyz", "followers_url": "https://api.github.com/users/hzhangxyz/followers", "following_url": "https://api.github.com/users/hzhangxyz/following{/other_user}", "gists_url": "https://api.github.com/users/hzhangxyz/gists{/gist_id}", "starred_url": "https://api.github.com/users/hzhangxyz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hzhangxyz/subscriptions", "organizations_url": "https://api.github.com/users/hzhangxyz/orgs", "repos_url": "https://api.github.com/users/hzhangxyz/repos", "events_url": "https://api.github.com/users/hzhangxyz/events{/privacy}", "received_events_url": "https://api.github.com/users/hzhangxyz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-02-17T10:36:23Z", "updated_at": "2018-02-27T22:34:42Z", "closed_at": "2018-02-27T22:34:42Z", "author_association": "NONE", "body_html": "<p>this issue is about XLA core dump similar to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"253648874\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12683\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12683/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12683\">#12683</a></p>\n<h3>code</h3>\n<pre><code>import tensorflow as tf\nimport sys\nD = 2\nA = tf.random_normal(shape=[D, D, 2], dtype=tf.float32,name=\"A\")\nB = tf.random_normal(shape=[D, D, 2], dtype=tf.float32, name=\"B\")\nif len(sys.argv)%2:\n    fun = tf.random_normal\nelse:\n    fun = tf.ones\nE = fun(shape=[D], dtype=tf.float32, name=\"EBA\")\nH = tf.reshape(tf.constant([[0.25,0,0,0],[0,-0.25,0.5,0],[0,0.5,-0.25,0],[0,0,0,0.25]],\n                           dtype=tf.float32),[2,2,2,2],name=\"Hamiltonian\")\nEA = tf.multiply(A,tf.reshape(E,[D,1,1]))\nAB = tf.tensordot(EA,B,[[1],[0]],name=\"AB\")\nS, U, V = tf.svd(tf.reshape(AB,[2*D,2*D]))\nUU = tf.transpose(tf.multiply(tf.reshape(U[:,:D],[D,2,D]),tf.reshape(E,[D,1,1])),[0,2,1],name=\"nA\")\ndata = UU / tf.reduce_max(UU)\nconfig = tf.ConfigProto()\nif len(sys.argv)&gt;2:\n    config.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\nsess.run(tf.global_variables_initializer())\nprint(sess.run(data))\n</code></pre>\n<h3>output</h3>\n<pre><code> \u2718 hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py\n2018-02-17 17:13:19.904413: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:19.904879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:19.904896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:20.109302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:20.109333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:20.109342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:20.109495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:20.292794: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55eaa51abab0\n[[[-0.3788082  -0.63152224]\n  [ 0.69478613 -0.15805985]]\n\n [[-0.12801631 -1.0104226 ]\n  [ 1.         -0.25424612]]]\n hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py -\n2018-02-17 17:13:26.235761: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:26.236224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:26.236250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:26.438962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:26.439018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:26.439028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:26.439205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:26.629210: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x564cf97d4cf0\n[[[-0.95954746 -0.42915264]\n  [-0.46691963 -0.69855815]]\n\n [[-0.7818373   0.17119625]\n  [ 1.          0.19870493]]]\n hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - -\n2018-02-17 17:13:30.150087: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:30.150570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:30.150595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:30.354220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:30.354264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:30.354271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:30.354448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:30.413176: I tensorflow/compiler/xla/service/service.cc:158] XLA service 0x7f05400021d0 executing computations on platform CUDA. Devices:\n2018-02-17 17:13:30.413215: I tensorflow/compiler/xla/service/service.cc:166]   StreamExecutor device (0): GeForce GTX 950M, Compute Capability 5.0\n2018-02-17 17:13:30.555655: W tensorflow/compiler/xla/service/gpu/gpu_compiler.cc:351] *** WARNING *** You are using ptxas 9.0.176, which is in range [9.0.0, 9.0.276) + [9.1.0, 9.1.121). These versions are known to miscompile XLA code, leading to incorrect results or invalid-address errors.\n2018-02-17 17:13:30.945780: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55a05a6aa980\n2018-02-17 17:13:31.100741: F tensorflow/compiler/xla/util.cc:187] Check failed: p1.size() == p2.size() (3 vs. 0)\n[1]    17796 abort (core dumped)  LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - -\n \u2718 hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - - -\n2018-02-17 17:13:36.566031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:36.566533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:36.566560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:36.780285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:36.780327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:36.780334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:36.780575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:36.838113: I tensorflow/compiler/xla/service/service.cc:158] XLA service 0x7f4490001fd0 executing computations on platform CUDA. Devices:\n2018-02-17 17:13:36.838151: I tensorflow/compiler/xla/service/service.cc:166]   StreamExecutor device (0): GeForce GTX 950M, Compute Capability 5.0\n2018-02-17 17:13:36.856927: W tensorflow/compiler/xla/service/gpu/gpu_compiler.cc:351] *** WARNING *** You are using ptxas 9.0.176, which is in range [9.0.0, 9.0.276) + [9.1.0, 9.1.121). These versions are known to miscompile XLA code, leading to incorrect results or invalid-address errors.\n2018-02-17 17:13:37.011879: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x557af19c7660\n[[[-4.4751650e-01 -2.8206566e-01]\n  [ 8.2662034e-01 -5.5483520e-01]]\n\n [[ 1.0000000e+00 -8.6649950e-04]\n  [ 2.1385331e-01  4.9290603e-01]]]\n</code></pre>\n<h1>system info</h1>\n<h3>output of tf_env_collect.sh</h3>\n<pre><code>\n== cat /etc/issue ===============================================\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\nLSB_VERSION=1.4\n\n== are we in docker =============================================\nNo\n\n== compiler =====================================================\nc++ (GCC) 7.3.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\n== uname -a =====================================================\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.14.0)\nprotobuf (3.5.1)\ntensorflow (1.5.0)\ntensorflow-tensorboard (1.5.0)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.6.0-rc0\ntf.GIT_VERSION = v1.6.0-rc1-167-g56422034fe\ntf.COMPILER_VERSION = v1.6.0-rc1-167-g56422034fe\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH /opt/cuda-9.0/lib64\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nSat Feb 17 18:25:00 2018       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 390.25                 Driver Version: 390.25                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\n| N/A   50C    P0    N/A /  N/A |      0MiB /  4046MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n</code></pre>\n<p>tf is compiled from source (<a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/56422034fe039d7e8a57392957ed0c8b4b4efe56/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/56422034fe039d7e8a57392957ed0c8b4b4efe56\"><tt>5642203</tt></a>)<br>\nwith cuda, with xla, with opt, with mkl, without anything else</p>\n<h3>OS is archlinux:</h3>\n<pre><code>Linux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\n</code></pre>\n<h3>python</h3>\n<pre><code>Python 2.7.14 (default, Jan  5 2018, 10:41:29)\n[GCC 7.2.1 20171224] on linux2\n</code></pre>\n<h3>bazel</h3>\n<pre><code>..............................................................\nBuild label: 0.10.0- (@non-git)\nBuild target: bazel-out/k8-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Wed Jun 18 09:24:24 +50064 (1517714702664)\nBuild timestamp: 1517714702664\nBuild timestamp as int: 1517714702664\n</code></pre>\n<h3>GPU</h3>\n<p>cuda 9.0, cudnn 7.0.5<br>\nGPU: GeForce GTX 950M</p>\n<h3>Describe the problem</h3>\n<p>core dump when use xla with gpu</p>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=150663\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jlebar\">@jlebar</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=35820639\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/bixia1\">@bixia1</a></p>", "body_text": "this issue is about XLA core dump similar to #12683\ncode\nimport tensorflow as tf\nimport sys\nD = 2\nA = tf.random_normal(shape=[D, D, 2], dtype=tf.float32,name=\"A\")\nB = tf.random_normal(shape=[D, D, 2], dtype=tf.float32, name=\"B\")\nif len(sys.argv)%2:\n    fun = tf.random_normal\nelse:\n    fun = tf.ones\nE = fun(shape=[D], dtype=tf.float32, name=\"EBA\")\nH = tf.reshape(tf.constant([[0.25,0,0,0],[0,-0.25,0.5,0],[0,0.5,-0.25,0],[0,0,0,0.25]],\n                           dtype=tf.float32),[2,2,2,2],name=\"Hamiltonian\")\nEA = tf.multiply(A,tf.reshape(E,[D,1,1]))\nAB = tf.tensordot(EA,B,[[1],[0]],name=\"AB\")\nS, U, V = tf.svd(tf.reshape(AB,[2*D,2*D]))\nUU = tf.transpose(tf.multiply(tf.reshape(U[:,:D],[D,2,D]),tf.reshape(E,[D,1,1])),[0,2,1],name=\"nA\")\ndata = UU / tf.reduce_max(UU)\nconfig = tf.ConfigProto()\nif len(sys.argv)>2:\n    config.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\nsess = tf.Session(config=config)\nsess.run(tf.global_variables_initializer())\nprint(sess.run(data))\n\noutput\n \u2718 hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py\n2018-02-17 17:13:19.904413: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:19.904879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:19.904896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:20.109302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:20.109333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:20.109342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:20.109495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:20.292794: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55eaa51abab0\n[[[-0.3788082  -0.63152224]\n  [ 0.69478613 -0.15805985]]\n\n [[-0.12801631 -1.0104226 ]\n  [ 1.         -0.25424612]]]\n hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py -\n2018-02-17 17:13:26.235761: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:26.236224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:26.236250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:26.438962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:26.439018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:26.439028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:26.439205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:26.629210: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x564cf97d4cf0\n[[[-0.95954746 -0.42915264]\n  [-0.46691963 -0.69855815]]\n\n [[-0.7818373   0.17119625]\n  [ 1.          0.19870493]]]\n hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - -\n2018-02-17 17:13:30.150087: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:30.150570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:30.150595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:30.354220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:30.354264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:30.354271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:30.354448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:30.413176: I tensorflow/compiler/xla/service/service.cc:158] XLA service 0x7f05400021d0 executing computations on platform CUDA. Devices:\n2018-02-17 17:13:30.413215: I tensorflow/compiler/xla/service/service.cc:166]   StreamExecutor device (0): GeForce GTX 950M, Compute Capability 5.0\n2018-02-17 17:13:30.555655: W tensorflow/compiler/xla/service/gpu/gpu_compiler.cc:351] *** WARNING *** You are using ptxas 9.0.176, which is in range [9.0.0, 9.0.276) + [9.1.0, 9.1.121). These versions are known to miscompile XLA code, leading to incorrect results or invalid-address errors.\n2018-02-17 17:13:30.945780: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55a05a6aa980\n2018-02-17 17:13:31.100741: F tensorflow/compiler/xla/util.cc:187] Check failed: p1.size() == p2.size() (3 vs. 0)\n[1]    17796 abort (core dumped)  LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - -\n \u2718 hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - - -\n2018-02-17 17:13:36.566031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-02-17 17:13:36.566533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\npciBusID: 0000:0a:00.0\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\n2018-02-17 17:13:36.566560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\n2018-02-17 17:13:36.780285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-02-17 17:13:36.780327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\n2018-02-17 17:13:36.780334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\n2018-02-17 17:13:36.780575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\n2018-02-17 17:13:36.838113: I tensorflow/compiler/xla/service/service.cc:158] XLA service 0x7f4490001fd0 executing computations on platform CUDA. Devices:\n2018-02-17 17:13:36.838151: I tensorflow/compiler/xla/service/service.cc:166]   StreamExecutor device (0): GeForce GTX 950M, Compute Capability 5.0\n2018-02-17 17:13:36.856927: W tensorflow/compiler/xla/service/gpu/gpu_compiler.cc:351] *** WARNING *** You are using ptxas 9.0.176, which is in range [9.0.0, 9.0.276) + [9.1.0, 9.1.121). These versions are known to miscompile XLA code, leading to incorrect results or invalid-address errors.\n2018-02-17 17:13:37.011879: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x557af19c7660\n[[[-4.4751650e-01 -2.8206566e-01]\n  [ 8.2662034e-01 -5.5483520e-01]]\n\n [[ 1.0000000e+00 -8.6649950e-04]\n  [ 2.1385331e-01  4.9290603e-01]]]\n\nsystem info\noutput of tf_env_collect.sh\n\n== cat /etc/issue ===============================================\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\nLSB_VERSION=1.4\n\n== are we in docker =============================================\nNo\n\n== compiler =====================================================\nc++ (GCC) 7.3.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\n== uname -a =====================================================\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\n\n== check pips ===================================================\nnumpy (1.14.0)\nprotobuf (3.5.1)\ntensorflow (1.5.0)\ntensorflow-tensorboard (1.5.0)\n\n== check for virtualenv =========================================\nFalse\n\n== tensorflow import ============================================\ntf.VERSION = 1.6.0-rc0\ntf.GIT_VERSION = v1.6.0-rc1-167-g56422034fe\ntf.COMPILER_VERSION = v1.6.0-rc1-167-g56422034fe\nSanity check: array([1], dtype=int32)\n\n== env ==========================================================\nLD_LIBRARY_PATH /opt/cuda-9.0/lib64\nDYLD_LIBRARY_PATH is unset\n\n== nvidia-smi ===================================================\nSat Feb 17 18:25:00 2018       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 390.25                 Driver Version: 390.25                    |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\n| N/A   50C    P0    N/A /  N/A |      0MiB /  4046MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n\n== cuda libs  ===================================================\n\ntf is compiled from source (5642203)\nwith cuda, with xla, with opt, with mkl, without anything else\nOS is archlinux:\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\n\npython\nPython 2.7.14 (default, Jan  5 2018, 10:41:29)\n[GCC 7.2.1 20171224] on linux2\n\nbazel\n..............................................................\nBuild label: 0.10.0- (@non-git)\nBuild target: bazel-out/k8-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\nBuild time: Wed Jun 18 09:24:24 +50064 (1517714702664)\nBuild timestamp: 1517714702664\nBuild timestamp as int: 1517714702664\n\nGPU\ncuda 9.0, cudnn 7.0.5\nGPU: GeForce GTX 950M\nDescribe the problem\ncore dump when use xla with gpu\n@jlebar @bixia1", "body": "this issue is about XLA core dump similar to #12683\r\n\r\n### code\r\n```\r\nimport tensorflow as tf\r\nimport sys\r\nD = 2\r\nA = tf.random_normal(shape=[D, D, 2], dtype=tf.float32,name=\"A\")\r\nB = tf.random_normal(shape=[D, D, 2], dtype=tf.float32, name=\"B\")\r\nif len(sys.argv)%2:\r\n    fun = tf.random_normal\r\nelse:\r\n    fun = tf.ones\r\nE = fun(shape=[D], dtype=tf.float32, name=\"EBA\")\r\nH = tf.reshape(tf.constant([[0.25,0,0,0],[0,-0.25,0.5,0],[0,0.5,-0.25,0],[0,0,0,0.25]],\r\n                           dtype=tf.float32),[2,2,2,2],name=\"Hamiltonian\")\r\nEA = tf.multiply(A,tf.reshape(E,[D,1,1]))\r\nAB = tf.tensordot(EA,B,[[1],[0]],name=\"AB\")\r\nS, U, V = tf.svd(tf.reshape(AB,[2*D,2*D]))\r\nUU = tf.transpose(tf.multiply(tf.reshape(U[:,:D],[D,2,D]),tf.reshape(E,[D,1,1])),[0,2,1],name=\"nA\")\r\ndata = UU / tf.reduce_max(UU)\r\nconfig = tf.ConfigProto()\r\nif len(sys.argv)>2:\r\n    config.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\r\nsess = tf.Session(config=config)\r\nsess.run(tf.global_variables_initializer())\r\nprint(sess.run(data))\r\n```\r\n\r\n### output\r\n```\r\n \u2718 hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py\r\n2018-02-17 17:13:19.904413: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-02-17 17:13:19.904879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2018-02-17 17:13:19.904896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\r\n2018-02-17 17:13:20.109302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-02-17 17:13:20.109333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\r\n2018-02-17 17:13:20.109342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\r\n2018-02-17 17:13:20.109495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\n2018-02-17 17:13:20.292794: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55eaa51abab0\r\n[[[-0.3788082  -0.63152224]\r\n  [ 0.69478613 -0.15805985]]\r\n\r\n [[-0.12801631 -1.0104226 ]\r\n  [ 1.         -0.25424612]]]\r\n hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py -\r\n2018-02-17 17:13:26.235761: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-02-17 17:13:26.236224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2018-02-17 17:13:26.236250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\r\n2018-02-17 17:13:26.438962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-02-17 17:13:26.439018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\r\n2018-02-17 17:13:26.439028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\r\n2018-02-17 17:13:26.439205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\n2018-02-17 17:13:26.629210: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x564cf97d4cf0\r\n[[[-0.95954746 -0.42915264]\r\n  [-0.46691963 -0.69855815]]\r\n\r\n [[-0.7818373   0.17119625]\r\n  [ 1.          0.19870493]]]\r\n hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - -\r\n2018-02-17 17:13:30.150087: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-02-17 17:13:30.150570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2018-02-17 17:13:30.150595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\r\n2018-02-17 17:13:30.354220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-02-17 17:13:30.354264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\r\n2018-02-17 17:13:30.354271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\r\n2018-02-17 17:13:30.354448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\n2018-02-17 17:13:30.413176: I tensorflow/compiler/xla/service/service.cc:158] XLA service 0x7f05400021d0 executing computations on platform CUDA. Devices:\r\n2018-02-17 17:13:30.413215: I tensorflow/compiler/xla/service/service.cc:166]   StreamExecutor device (0): GeForce GTX 950M, Compute Capability 5.0\r\n2018-02-17 17:13:30.555655: W tensorflow/compiler/xla/service/gpu/gpu_compiler.cc:351] *** WARNING *** You are using ptxas 9.0.176, which is in range [9.0.0, 9.0.276) + [9.1.0, 9.1.121). These versions are known to miscompile XLA code, leading to incorrect results or invalid-address errors.\r\n2018-02-17 17:13:30.945780: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55a05a6aa980\r\n2018-02-17 17:13:31.100741: F tensorflow/compiler/xla/util.cc:187] Check failed: p1.size() == p2.size() (3 vs. 0)\r\n[1]    17796 abort (core dumped)  LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - -\r\n \u2718 hzhangxyz@zhanghao \ue0b0 ~/Documents/test \ue0b0 LD_LIBRARY_PATH=/opt/cuda-9.0/lib64 python2 main.py - - -\r\n2018-02-17 17:13:36.566031: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-02-17 17:13:36.566533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1331] Found device 0 with properties:\r\nname: GeForce GTX 950M major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:0a:00.0\r\ntotalMemory: 3.95GiB freeMemory: 3.91GiB\r\n2018-02-17 17:13:36.566560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1410] Adding visible gpu devices: 0\r\n2018-02-17 17:13:36.780285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-02-17 17:13:36.780327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0\r\n2018-02-17 17:13:36.780334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N\r\n2018-02-17 17:13:36.780575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1021] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3654 MB memory) -> physical GPU (device: 0, name: GeForce GTX 950M, pci bus id: 0000:0a:00.0, compute capability: 5.0)\r\n2018-02-17 17:13:36.838113: I tensorflow/compiler/xla/service/service.cc:158] XLA service 0x7f4490001fd0 executing computations on platform CUDA. Devices:\r\n2018-02-17 17:13:36.838151: I tensorflow/compiler/xla/service/service.cc:166]   StreamExecutor device (0): GeForce GTX 950M, Compute Capability 5.0\r\n2018-02-17 17:13:36.856927: W tensorflow/compiler/xla/service/gpu/gpu_compiler.cc:351] *** WARNING *** You are using ptxas 9.0.176, which is in range [9.0.0, 9.0.276) + [9.1.0, 9.1.121). These versions are known to miscompile XLA code, leading to incorrect results or invalid-address errors.\r\n2018-02-17 17:13:37.011879: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x557af19c7660\r\n[[[-4.4751650e-01 -2.8206566e-01]\r\n  [ 8.2662034e-01 -5.5483520e-01]]\r\n\r\n [[ 1.0000000e+00 -8.6649950e-04]\r\n  [ 2.1385331e-01  4.9290603e-01]]]\r\n```\r\n\r\n# system info\r\n\r\n### output of tf_env_collect.sh\r\n```\r\n\r\n== cat /etc/issue ===============================================\r\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\r\nLSB_VERSION=1.4\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 7.3.0\r\nCopyright (C) 2017 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.14.0)\r\nprotobuf (3.5.1)\r\ntensorflow (1.5.0)\r\ntensorflow-tensorboard (1.5.0)\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.6.0-rc0\r\ntf.GIT_VERSION = v1.6.0-rc1-167-g56422034fe\r\ntf.COMPILER_VERSION = v1.6.0-rc1-167-g56422034fe\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /opt/cuda-9.0/lib64\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nSat Feb 17 18:25:00 2018       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 390.25                 Driver Version: 390.25                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 950M    Off  | 00000000:0A:00.0 Off |                  N/A |\r\n| N/A   50C    P0    N/A /  N/A |      0MiB /  4046MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n```\r\n\r\ntf is compiled from source (56422034fe)\r\nwith cuda, with xla, with opt, with mkl, without anything else\r\n\r\n### OS is archlinux: \r\n```\r\nLinux zhanghao 4.15.3-2-ARCH #1 SMP PREEMPT Thu Feb 15 00:13:49 UTC 2018 x86_64 GNU/Linux\r\n```\r\n\r\n### python\r\n```\r\nPython 2.7.14 (default, Jan  5 2018, 10:41:29)\r\n[GCC 7.2.1 20171224] on linux2\r\n```\r\n\r\n### bazel\r\n```\r\n..............................................................\r\nBuild label: 0.10.0- (@non-git)\r\nBuild target: bazel-out/k8-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Wed Jun 18 09:24:24 +50064 (1517714702664)\r\nBuild timestamp: 1517714702664\r\nBuild timestamp as int: 1517714702664\r\n```\r\n\r\n### GPU\r\ncuda 9.0, cudnn 7.0.5\r\nGPU: GeForce GTX 950M\r\n\r\n### Describe the problem\r\ncore dump when use xla with gpu\r\n\r\n@jlebar @bixia1 "}