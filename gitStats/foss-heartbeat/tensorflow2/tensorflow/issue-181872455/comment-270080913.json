{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/270080913", "html_url": "https://github.com/tensorflow/tensorflow/issues/4848#issuecomment-270080913", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4848", "id": 270080913, "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDA4MDkxMw==", "user": {"login": "davidzchen", "id": 5283042, "node_id": "MDQ6VXNlcjUyODMwNDI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5283042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidzchen", "html_url": "https://github.com/davidzchen", "followers_url": "https://api.github.com/users/davidzchen/followers", "following_url": "https://api.github.com/users/davidzchen/following{/other_user}", "gists_url": "https://api.github.com/users/davidzchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidzchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidzchen/subscriptions", "organizations_url": "https://api.github.com/users/davidzchen/orgs", "repos_url": "https://api.github.com/users/davidzchen/repos", "events_url": "https://api.github.com/users/davidzchen/events{/privacy}", "received_events_url": "https://api.github.com/users/davidzchen/received_events", "type": "User", "site_admin": false}, "created_at": "2017-01-03T09:57:35Z", "updated_at": "2017-01-03T09:57:35Z", "author_association": "MEMBER", "body_html": "<p>The reason why this is happening is that it looks like <code>bazel clean</code> is, as Damien described, invalidating the repository created by <code>cuda_configure</code>, and because the environment variables used by <code>cuda_configure</code> are no longer set (since they were only set in the subshell when <code>./configure</code> ran), we end up re-fetching with all default values and thus configuring the repository to not build with GPU.</p>\n<p>Seems this behavior we are observing where running <code>bazel clean</code> without <code>--expunge</code> invalidates the repository might be a bug.</p>", "body_text": "The reason why this is happening is that it looks like bazel clean is, as Damien described, invalidating the repository created by cuda_configure, and because the environment variables used by cuda_configure are no longer set (since they were only set in the subshell when ./configure ran), we end up re-fetching with all default values and thus configuring the repository to not build with GPU.\nSeems this behavior we are observing where running bazel clean without --expunge invalidates the repository might be a bug.", "body": "The reason why this is happening is that it looks like `bazel clean` is, as Damien described, invalidating the repository created by `cuda_configure`, and because the environment variables used by `cuda_configure` are no longer set (since they were only set in the subshell when `./configure` ran), we end up re-fetching with all default values and thus configuring the repository to not build with GPU.\r\n\r\nSeems this behavior we are observing where running `bazel clean` without `--expunge` invalidates the repository might be a bug."}