{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11017", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11017/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11017/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11017/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11017", "id": 238203839, "node_id": "MDU6SXNzdWUyMzgyMDM4Mzk=", "number": 11017, "title": "Tfdbg does not work with Coordinator/QueueRunners", "user": {"login": "rubenvereecken", "id": 5216553, "node_id": "MDQ6VXNlcjUyMTY1NTM=", "avatar_url": "https://avatars0.githubusercontent.com/u/5216553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rubenvereecken", "html_url": "https://github.com/rubenvereecken", "followers_url": "https://api.github.com/users/rubenvereecken/followers", "following_url": "https://api.github.com/users/rubenvereecken/following{/other_user}", "gists_url": "https://api.github.com/users/rubenvereecken/gists{/gist_id}", "starred_url": "https://api.github.com/users/rubenvereecken/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rubenvereecken/subscriptions", "organizations_url": "https://api.github.com/users/rubenvereecken/orgs", "repos_url": "https://api.github.com/users/rubenvereecken/repos", "events_url": "https://api.github.com/users/rubenvereecken/events{/privacy}", "received_events_url": "https://api.github.com/users/rubenvereecken/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2017-06-23T17:18:55Z", "updated_at": "2018-01-26T01:25:24Z", "closed_at": "2017-07-07T01:10:24Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Mint 18</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Binary (pip)</li>\n<li><strong>TensorFlow version (use command below)</strong>: v1.2.0-rc2-21-g12f033d 1.2.0</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A</li>\n<li><strong>GPU model and memory</strong>: N/A</li>\n<li><strong>Exact command to reproduce</strong>: N/A</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>The Tensorflow debugger does not seem to be working with Queues; data never seems to be fetched by the QueueRunner threads, be it from a file (using <code>tf.TFRecordReader</code> and <code>tf.parse_single_example</code>) or preloaded (using <code>tf.train.slice_input_producer</code>). Instead, the <code>coordinator.should_stop()</code> is True right away. This is only the case after wrapping the session in a <code>tf.python.debug.LocalCLIDebugWrapperSession</code>. The example should make things clearer.</p>\n<p>Moreover, another error occurs at <code>coordinator.join(threads)</code>.</p>\n<p>I am aware of the <a href=\"https://www.tensorflow.org/programmers_guide/debugger\" rel=\"nofollow\">FAQ entry on Threads</a>, but that does not explain why the data fetching threads would not be working.</p>\n<h3>Source code / logs</h3>\n<p>To make it easiest to replicate, I simply took the <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/how_tos/reading_data/fully_connected_preloaded.py\">example on working with preloaded data</a>, and wrapped the session in there with the debugger. I uploaded the gist with two lines added to <a href=\"https://gist.github.com/rubenvereecken/079cdf1abc76866714ff6f752167481d#file-fully_connected_preloaded_debug-py-L92\">https://gist.github.com/rubenvereecken/079cdf1abc76866714ff6f752167481d#file-fully_connected_preloaded_debug-py-L92</a>.</p>\n<p>To reproduce, run the file. Once you drop in the debugger, run once. It then exits. The full output is below:</p>\n<pre><code>Extracting /tmp/data/train-images-idx3-ubyte.gz\nExtracting /tmp/data/train-labels-idx1-ubyte.gz\nExtracting /tmp/data/t10k-images-idx3-ubyte.gz\nExtracting /tmp/data/t10k-labels-idx1-ubyte.gz\nTraceback (most recent call last):\n  File \"ex.py\", line 191, in &lt;module&gt;\n    tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"ex.py\", line 143, in main\n    run_training()\n  File \"ex.py\", line 138, in run_training\n    coord.join(threads)\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\n    six.reraise(*self._exc_info_to_raise)\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/six.py\", line 686, in reraise\n    raise value\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 233, in _run\n    enqueue_callable = sess.make_callable(enqueue_op)\nAttributeError: 'LocalCLIDebugWrapperSession' object has no attribute 'make_callable'\n</code></pre>\n<p>The stacktrace is about <code>coord.join(threads)</code>, but this is only possible because <code>coord.should_stop()</code> never seems to be <code>False</code>, which would indicate there is data to load. Without the added debugger lines, the example simply works.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Mint 18\nTensorFlow installed from (source or binary): Binary (pip)\nTensorFlow version (use command below): v1.2.0-rc2-21-g12f033d 1.2.0\nBazel version (if compiling from source): N/A\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce: N/A\n\nDescribe the problem\nThe Tensorflow debugger does not seem to be working with Queues; data never seems to be fetched by the QueueRunner threads, be it from a file (using tf.TFRecordReader and tf.parse_single_example) or preloaded (using tf.train.slice_input_producer). Instead, the coordinator.should_stop() is True right away. This is only the case after wrapping the session in a tf.python.debug.LocalCLIDebugWrapperSession. The example should make things clearer.\nMoreover, another error occurs at coordinator.join(threads).\nI am aware of the FAQ entry on Threads, but that does not explain why the data fetching threads would not be working.\nSource code / logs\nTo make it easiest to replicate, I simply took the example on working with preloaded data, and wrapped the session in there with the debugger. I uploaded the gist with two lines added to https://gist.github.com/rubenvereecken/079cdf1abc76866714ff6f752167481d#file-fully_connected_preloaded_debug-py-L92.\nTo reproduce, run the file. Once you drop in the debugger, run once. It then exits. The full output is below:\nExtracting /tmp/data/train-images-idx3-ubyte.gz\nExtracting /tmp/data/train-labels-idx1-ubyte.gz\nExtracting /tmp/data/t10k-images-idx3-ubyte.gz\nExtracting /tmp/data/t10k-labels-idx1-ubyte.gz\nTraceback (most recent call last):\n  File \"ex.py\", line 191, in <module>\n    tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 48, in run\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\n  File \"ex.py\", line 143, in main\n    run_training()\n  File \"ex.py\", line 138, in run_training\n    coord.join(threads)\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\n    six.reraise(*self._exc_info_to_raise)\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/six.py\", line 686, in reraise\n    raise value\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 233, in _run\n    enqueue_callable = sess.make_callable(enqueue_op)\nAttributeError: 'LocalCLIDebugWrapperSession' object has no attribute 'make_callable'\n\nThe stacktrace is about coord.join(threads), but this is only possible because coord.should_stop() never seems to be False, which would indicate there is data to load. Without the added debugger lines, the example simply works.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Mint 18\r\n- **TensorFlow installed from (source or binary)**: Binary (pip)\r\n- **TensorFlow version (use command below)**: v1.2.0-rc2-21-g12f033d 1.2.0\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\nThe Tensorflow debugger does not seem to be working with Queues; data never seems to be fetched by the QueueRunner threads, be it from a file (using `tf.TFRecordReader` and `tf.parse_single_example`) or preloaded (using `tf.train.slice_input_producer`). Instead, the `coordinator.should_stop()` is True right away. This is only the case after wrapping the session in a `tf.python.debug.LocalCLIDebugWrapperSession`. The example should make things clearer.\r\n\r\nMoreover, another error occurs at `coordinator.join(threads)`.\r\n\r\nI am aware of the [FAQ entry on Threads](https://www.tensorflow.org/programmers_guide/debugger), but that does not explain why the data fetching threads would not be working.\r\n\r\n### Source code / logs\r\nTo make it easiest to replicate, I simply took the [example on working with preloaded data](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/how_tos/reading_data/fully_connected_preloaded.py), and wrapped the session in there with the debugger. I uploaded the gist with two lines added to https://gist.github.com/rubenvereecken/079cdf1abc76866714ff6f752167481d#file-fully_connected_preloaded_debug-py-L92.\r\n\r\nTo reproduce, run the file. Once you drop in the debugger, run once. It then exits. The full output is below:\r\n\r\n```\r\nExtracting /tmp/data/train-images-idx3-ubyte.gz\r\nExtracting /tmp/data/train-labels-idx1-ubyte.gz\r\nExtracting /tmp/data/t10k-images-idx3-ubyte.gz\r\nExtracting /tmp/data/t10k-labels-idx1-ubyte.gz\r\nTraceback (most recent call last):\r\n  File \"ex.py\", line 191, in <module>\r\n    tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"ex.py\", line 143, in main\r\n    run_training()\r\n  File \"ex.py\", line 138, in run_training\r\n    coord.join(threads)\r\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\r\n    six.reraise(*self._exc_info_to_raise)\r\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/six.py\", line 686, in reraise\r\n    raise value\r\n  File \"/home/ruben/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/queue_runner_impl.py\", line 233, in _run\r\n    enqueue_callable = sess.make_callable(enqueue_op)\r\nAttributeError: 'LocalCLIDebugWrapperSession' object has no attribute 'make_callable'\r\n```\r\n\r\nThe stacktrace is about `coord.join(threads)`, but this is only possible because `coord.should_stop()` never seems to be `False`, which would indicate there is data to load. Without the added debugger lines, the example simply works."}