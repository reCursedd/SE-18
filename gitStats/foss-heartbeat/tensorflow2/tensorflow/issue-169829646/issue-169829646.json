{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3692", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3692/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3692/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3692/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3692", "id": 169829646, "node_id": "MDU6SXNzdWUxNjk4Mjk2NDY=", "number": 3692, "title": "tf.tile() doesn't propagate shapes when `multiples` argument depends on a placeholder", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-08-08T01:52:40Z", "updated_at": "2017-10-19T23:13:55Z", "closed_at": "2016-08-10T18:33:17Z", "author_association": "CONTRIBUTOR", "body_html": "<p>From <a href=\"http://stackoverflow.com/q/38806136/3574081\" rel=\"nofollow\">this Stack Overflow question</a>:</p>\n<blockquote>\n<p>I have a variable a of dimension (1, 5) which I want to 'tile' as many times as the size of my mini-batch. For example, if the mini-batch size is 32 then I want to construct a tensor <code>c</code> of dimension (32, 5) where each row has values the same as the original (1, 5) variable <code>a</code>.</p>\n<p>But I only know the mini-batch size at run time: it's the size of dimension 0 of a placeholder <code>b</code>: <code>tf.shape(b)[0]</code></p>\n<p>Here's my code to construct c:</p>\n<div class=\"highlight highlight-source-python\"><pre>a  <span class=\"pl-k\">=</span> tf.Variable(np.random.uniform(<span class=\"pl-v\">size</span><span class=\"pl-k\">=</span>(<span class=\"pl-c1\">1</span>,<span class=\"pl-c1\">5</span>)))\nb <span class=\"pl-k\">=</span> tf.placeholder(<span class=\"pl-v\">shape</span><span class=\"pl-k\">=</span>[<span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">12</span>], <span class=\"pl-v\">dtype</span><span class=\"pl-k\">=</span>tf.float32)\nbatch_size <span class=\"pl-k\">=</span> tf.shape(b)[<span class=\"pl-c1\">0</span>]\nc <span class=\"pl-k\">=</span> tf.tile(a, tf.pack([batch_size, <span class=\"pl-c1\">1</span>]))</pre></div>\n<p>This runs fine. However <code>c.get_shape()</code> returns <code>(?, ?)</code>. I don't understand why this doesn't return <code>(?, 5)</code> instead.</p>\n<p>This is causing an issue later in my code when I construct a matrix variable <code>W</code> with number of columns <code>c.get_shape()[1]</code> which I expect to return 5 rather than ?.</p>\n<p>Any help would be appreciated. Thanks.</p>\n</blockquote>\n<p>The solution is to use <code>tensor_util.constant_value_as_shape()</code> in the shape function for <code>tf.tile()</code>. I have a fix pending.</p>", "body_text": "From this Stack Overflow question:\n\nI have a variable a of dimension (1, 5) which I want to 'tile' as many times as the size of my mini-batch. For example, if the mini-batch size is 32 then I want to construct a tensor c of dimension (32, 5) where each row has values the same as the original (1, 5) variable a.\nBut I only know the mini-batch size at run time: it's the size of dimension 0 of a placeholder b: tf.shape(b)[0]\nHere's my code to construct c:\na  = tf.Variable(np.random.uniform(size=(1,5)))\nb = tf.placeholder(shape=[None, 12], dtype=tf.float32)\nbatch_size = tf.shape(b)[0]\nc = tf.tile(a, tf.pack([batch_size, 1]))\nThis runs fine. However c.get_shape() returns (?, ?). I don't understand why this doesn't return (?, 5) instead.\nThis is causing an issue later in my code when I construct a matrix variable W with number of columns c.get_shape()[1] which I expect to return 5 rather than ?.\nAny help would be appreciated. Thanks.\n\nThe solution is to use tensor_util.constant_value_as_shape() in the shape function for tf.tile(). I have a fix pending.", "body": "From [this Stack Overflow question](http://stackoverflow.com/q/38806136/3574081):\n\n> I have a variable a of dimension (1, 5) which I want to 'tile' as many times as the size of my mini-batch. For example, if the mini-batch size is 32 then I want to construct a tensor `c` of dimension (32, 5) where each row has values the same as the original (1, 5) variable `a`.\n> \n> But I only know the mini-batch size at run time: it's the size of dimension 0 of a placeholder `b`: `tf.shape(b)[0]`\n> \n> Here's my code to construct c:\n> \n> ``` python\n> a  = tf.Variable(np.random.uniform(size=(1,5)))\n> b = tf.placeholder(shape=[None, 12], dtype=tf.float32)\n> batch_size = tf.shape(b)[0]\n> c = tf.tile(a, tf.pack([batch_size, 1]))\n> ```\n> \n> This runs fine. However `c.get_shape()` returns `(?, ?)`. I don't understand why this doesn't return `(?, 5)` instead.\n> \n> This is causing an issue later in my code when I construct a matrix variable `W` with number of columns `c.get_shape()[1]` which I expect to return 5 rather than ?.\n> \n> Any help would be appreciated. Thanks.\n\nThe solution is to use `tensor_util.constant_value_as_shape()` in the shape function for `tf.tile()`. I have a fix pending.\n"}