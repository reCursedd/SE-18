{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/355028088", "html_url": "https://github.com/tensorflow/tensorflow/issues/15266#issuecomment-355028088", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15266", "id": 355028088, "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTAyODA4OA==", "user": {"login": "sandipmgiri", "id": 16284232, "node_id": "MDQ6VXNlcjE2Mjg0MjMy", "avatar_url": "https://avatars0.githubusercontent.com/u/16284232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandipmgiri", "html_url": "https://github.com/sandipmgiri", "followers_url": "https://api.github.com/users/sandipmgiri/followers", "following_url": "https://api.github.com/users/sandipmgiri/following{/other_user}", "gists_url": "https://api.github.com/users/sandipmgiri/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandipmgiri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandipmgiri/subscriptions", "organizations_url": "https://api.github.com/users/sandipmgiri/orgs", "repos_url": "https://api.github.com/users/sandipmgiri/repos", "events_url": "https://api.github.com/users/sandipmgiri/events{/privacy}", "received_events_url": "https://api.github.com/users/sandipmgiri/received_events", "type": "User", "site_admin": false}, "created_at": "2018-01-03T14:42:21Z", "updated_at": "2018-01-03T14:42:21Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Investigated further on this and found the reason , see below details :</p>\n<p>While running the test using : <code>./bazel-out/local-opt/bin/tensorflow/compiler/xla/tests/array_elementwise_ops_test_cpu_parallel</code> , no <code>--xla_backend_extra_options</code> is being set.  Thats why the test is passing.</p>\n<p>However, while running the test using \"<code>bazel test</code>\" command , the <code>'--xla_backend_extra_options=xla_cpu_parallel'</code> option is being set automatically, and test is failing.</p>\n<p>Which is found in file <a href=\"https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120\">https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120</a><br>\n<code>this_backend_args += [\"--xla_backend_extra_options=\\\"xla_cpu_parallel\\\"\"]</code></p>\n<p>I tried removing this line , and test passes with \"<code>bazel test</code>\" as well (as no <code>--xla_backend_extra_options</code> is being set).</p>\n<p>Now here, as per my opinion below two options to fix this test :</p>\n<ol>\n<li>Add <code>ppc64le</code> specific condition in file <a href=\"https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120\">https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120</a>, something like this :</li>\n</ol>\n<pre><code>if !(ppc64le):\n   this_backend_args += [\"--xla_backend_extra_options=\\\"xla_cpu_parallel\\\"\"]     \n endif\n</code></pre>\n<ol start=\"2\">\n<li>While running the test using \"<code>bazel test</code>\" command, disable <code>'--xla_backend_extra_options=xla_cpu_parallel'</code> option.</li>\n</ol>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7946809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gunan\">@gunan</a> and <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=20959853\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/drpngx\">@drpngx</a> - Which one according to you is the better option? Also please provide if you have any other suggestions/comments.Thanks!</p>", "body_text": "Investigated further on this and found the reason , see below details :\nWhile running the test using : ./bazel-out/local-opt/bin/tensorflow/compiler/xla/tests/array_elementwise_ops_test_cpu_parallel , no --xla_backend_extra_options is being set.  Thats why the test is passing.\nHowever, while running the test using \"bazel test\" command , the '--xla_backend_extra_options=xla_cpu_parallel' option is being set automatically, and test is failing.\nWhich is found in file https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120\nthis_backend_args += [\"--xla_backend_extra_options=\\\"xla_cpu_parallel\\\"\"]\nI tried removing this line , and test passes with \"bazel test\" as well (as no --xla_backend_extra_options is being set).\nNow here, as per my opinion below two options to fix this test :\n\nAdd ppc64le specific condition in file https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120, something like this :\n\nif !(ppc64le):\n   this_backend_args += [\"--xla_backend_extra_options=\\\"xla_cpu_parallel\\\"\"]     \n endif\n\n\nWhile running the test using \"bazel test\" command, disable '--xla_backend_extra_options=xla_cpu_parallel' option.\n\n@gunan and @drpngx - Which one according to you is the better option? Also please provide if you have any other suggestions/comments.Thanks!", "body": "Investigated further on this and found the reason , see below details :\r\n\r\nWhile running the test using : `./bazel-out/local-opt/bin/tensorflow/compiler/xla/tests/array_elementwise_ops_test_cpu_parallel` , no `--xla_backend_extra_options` is being set.  Thats why the test is passing.\r\n\r\nHowever, while running the test using \"`bazel test`\" command , the `'--xla_backend_extra_options=xla_cpu_parallel'` option is being set automatically, and test is failing.\r\n\r\nWhich is found in file https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120\r\n `this_backend_args += [\"--xla_backend_extra_options=\\\"xla_cpu_parallel\\\"\"]`\r\n\r\nI tried removing this line , and test passes with \"`bazel test`\" as well (as no `--xla_backend_extra_options` is being set).\r\n\r\n\r\nNow here, as per my opinion below two options to fix this test :\r\n\r\n1) Add `ppc64le` specific condition in file https://github.com/tensorflow/tensorflow/blob/v1.3.1/tensorflow/compiler/xla/tests/build_defs.bzl#L120, something like this :\r\n\r\n  ```\r\n if !(ppc64le):\r\n     this_backend_args += [\"--xla_backend_extra_options=\\\"xla_cpu_parallel\\\"\"]     \r\n   endif\r\n```\r\n\r\n\r\n\r\n2) While running the test using \"`bazel test`\" command, disable `'--xla_backend_extra_options=xla_cpu_parallel'` option.\r\n\r\n\r\n@gunan and @drpngx - Which one according to you is the better option? Also please provide if you have any other suggestions/comments.Thanks!\r\n"}