{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/260587859", "html_url": "https://github.com/tensorflow/tensorflow/issues/5515#issuecomment-260587859", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5515", "id": 260587859, "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDU4Nzg1OQ==", "user": {"login": "hholst80", "id": 6200749, "node_id": "MDQ6VXNlcjYyMDA3NDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/6200749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hholst80", "html_url": "https://github.com/hholst80", "followers_url": "https://api.github.com/users/hholst80/followers", "following_url": "https://api.github.com/users/hholst80/following{/other_user}", "gists_url": "https://api.github.com/users/hholst80/gists{/gist_id}", "starred_url": "https://api.github.com/users/hholst80/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hholst80/subscriptions", "organizations_url": "https://api.github.com/users/hholst80/orgs", "repos_url": "https://api.github.com/users/hholst80/repos", "events_url": "https://api.github.com/users/hholst80/events{/privacy}", "received_events_url": "https://api.github.com/users/hholst80/received_events", "type": "User", "site_admin": false}, "created_at": "2016-11-15T09:15:54Z", "updated_at": "2016-11-15T09:15:54Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I updated the trainer.py and start script to make it more clear what is <em>not</em> happening. As we see task 1 never gets a <code>sv.should_stop()</code> signal as I would expect.</p>\n<pre><code>(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat worker0.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; localhost:3000, 1 -&gt; localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:3000\nI tensorflow/core/distributed_runtime/master_session.cc:928] Start master session c878251f6d23eadc with config: \n\ntask 0 should_stop = True\ntask 0 calling sv.stop()\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n</code></pre>\n<pre><code>(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat worker1.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; localhost:3000, 1 -&gt; localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:3001\nI tensorflow/core/distributed_runtime/master_session.cc:928] Start master session 1b67ef1b14af632b with config: \n\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n</code></pre>\n<pre><code>(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat ps0.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -&gt; {0 -&gt; localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -&gt; {0 -&gt; localhost:3000, 1 -&gt; localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:2000\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n</code></pre>", "body_text": "I updated the trainer.py and start script to make it more clear what is not happening. As we see task 1 never gets a sv.should_stop() signal as I would expect.\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat worker0.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3000, 1 -> localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:3000\nI tensorflow/core/distributed_runtime/master_session.cc:928] Start master session c878251f6d23eadc with config: \n\ntask 0 should_stop = True\ntask 0 calling sv.stop()\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat worker1.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3000, 1 -> localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:3001\nI tensorflow/core/distributed_runtime/master_session.cc:928] Start master session 1b67ef1b14af632b with config: \n\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat ps0.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3000, 1 -> localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:2000\n(tensorflow) hholst@fb-hholst3:/tmp/bug$", "body": "I updated the trainer.py and start script to make it more clear what is _not_ happening. As we see task 1 never gets a `sv.should_stop()` signal as I would expect.\n\n```\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat worker0.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3000, 1 -> localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:3000\nI tensorflow/core/distributed_runtime/master_session.cc:928] Start master session c878251f6d23eadc with config: \n\ntask 0 should_stop = True\ntask 0 calling sv.stop()\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n```\n\n```\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat worker1.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3000, 1 -> localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:3001\nI tensorflow/core/distributed_runtime/master_session.cc:928] Start master session 1b67ef1b14af632b with config: \n\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n```\n\n```\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ cat ps0.log \nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2000}\nI tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:197] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3000, 1 -> localhost:3001}\nI tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:206] Started server with target: grpc://localhost:2000\n(tensorflow) hholst@fb-hholst3:/tmp/bug$ \n```\n"}