{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7889", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7889/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7889/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7889/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7889", "id": 210278110, "node_id": "MDU6SXNzdWUyMTAyNzgxMTA=", "number": 7889, "title": "Bug in code for new TF Layer tutorial \"A Guide to TF Layers: Building a Convolutional Neural Network\"", "user": {"login": "jtopor", "id": 15280147, "node_id": "MDQ6VXNlcjE1MjgwMTQ3", "avatar_url": "https://avatars2.githubusercontent.com/u/15280147?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jtopor", "html_url": "https://github.com/jtopor", "followers_url": "https://api.github.com/users/jtopor/followers", "following_url": "https://api.github.com/users/jtopor/following{/other_user}", "gists_url": "https://api.github.com/users/jtopor/gists{/gist_id}", "starred_url": "https://api.github.com/users/jtopor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jtopor/subscriptions", "organizations_url": "https://api.github.com/users/jtopor/orgs", "repos_url": "https://api.github.com/users/jtopor/repos", "events_url": "https://api.github.com/users/jtopor/events{/privacy}", "received_events_url": "https://api.github.com/users/jtopor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-02-26T02:18:05Z", "updated_at": "2017-07-21T21:00:34Z", "closed_at": "2017-03-09T18:31:18Z", "author_association": "NONE", "body_html": "<p>The code provided for the new TF Layer API tutorial (see <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/layers/cnn_mnist.py\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/layers/cnn_mnist.py</a>) does not work if any filter size other than 5x5 is specified, or if color images are used. No matter what other filter size is specified, an error is generated indicating a shape mismatch between the specified filter (3x3 in the error message shown below) and another seemingly hard-coded 5x5 filter buried somewhere in the estimator. The tensor referred to below as \"rhs\" ALWAYS reports as [5,5,1,32] no matter what the actual filter size is set to within the python code OR if a color/3 channel image is used (e.g., lhs reports as 5x5x3x32 while rhs is 5x5x1x32).</p>\n<p>Here's a sample code snippet wherein the filter size is set to 3x3 instead of 5x5 for the first convolution layer:</p>\n<p>conv1 = tf.layers.conv2d(<br>\ninputs=input_layer,<br>\nfilters=32,<br>\nkernel_size=[3, 3],<br>\npadding=\"same\",<br>\nactivation=tf.nn.relu)</p>\n<p>and here's the error message:</p>\n<p>InvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [3,3,1,32] rhs shape= [5,5,1,32]<br>\n[[Node: save/Assign_2 = Assign[T=DT_FLOAT, _class=[\"loc:@conv2d/kernel\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](conv2d/kernel, save/RestoreV2_2)]]</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<p>None found - this seems to be a new problem related to the new TF Layer API</p>\n<h3>Environment info</h3>\n<p>Operating System: Windows 10, Anaconda3, Python 3.5.2, TensorFlow 1.0</p>", "body_text": "The code provided for the new TF Layer API tutorial (see https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/layers/cnn_mnist.py) does not work if any filter size other than 5x5 is specified, or if color images are used. No matter what other filter size is specified, an error is generated indicating a shape mismatch between the specified filter (3x3 in the error message shown below) and another seemingly hard-coded 5x5 filter buried somewhere in the estimator. The tensor referred to below as \"rhs\" ALWAYS reports as [5,5,1,32] no matter what the actual filter size is set to within the python code OR if a color/3 channel image is used (e.g., lhs reports as 5x5x3x32 while rhs is 5x5x1x32).\nHere's a sample code snippet wherein the filter size is set to 3x3 instead of 5x5 for the first convolution layer:\nconv1 = tf.layers.conv2d(\ninputs=input_layer,\nfilters=32,\nkernel_size=[3, 3],\npadding=\"same\",\nactivation=tf.nn.relu)\nand here's the error message:\nInvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [3,3,1,32] rhs shape= [5,5,1,32]\n[[Node: save/Assign_2 = Assign[T=DT_FLOAT, _class=[\"loc:@conv2d/kernel\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](conv2d/kernel, save/RestoreV2_2)]]\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nNone found - this seems to be a new problem related to the new TF Layer API\nEnvironment info\nOperating System: Windows 10, Anaconda3, Python 3.5.2, TensorFlow 1.0", "body": "The code provided for the new TF Layer API tutorial (see https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/layers/cnn_mnist.py) does not work if any filter size other than 5x5 is specified, or if color images are used. No matter what other filter size is specified, an error is generated indicating a shape mismatch between the specified filter (3x3 in the error message shown below) and another seemingly hard-coded 5x5 filter buried somewhere in the estimator. The tensor referred to below as \"rhs\" ALWAYS reports as [5,5,1,32] no matter what the actual filter size is set to within the python code OR if a color/3 channel image is used (e.g., lhs reports as 5x5x3x32 while rhs is 5x5x1x32).\r\n\r\nHere's a sample code snippet wherein the filter size is set to 3x3 instead of 5x5 for the first convolution layer:\r\n\r\n conv1 = tf.layers.conv2d(\r\n      inputs=input_layer,\r\n      filters=32,\r\n      kernel_size=[3, 3],\r\n      padding=\"same\",\r\n      activation=tf.nn.relu)\r\n\r\n\r\nand here's the error message:\r\n\r\nInvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [3,3,1,32] rhs shape= [5,5,1,32]\r\n\t [[Node: save/Assign_2 = Assign[T=DT_FLOAT, _class=[\"loc:@conv2d/kernel\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](conv2d/kernel, save/RestoreV2_2)]]\r\n\r\n\r\n\r\n\r\n\r\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\r\n\r\nNone found - this seems to be a new problem related to the new TF Layer API\r\n\r\n### Environment info\r\nOperating System: Windows 10, Anaconda3, Python 3.5.2, TensorFlow 1.0\r\n\r\n"}