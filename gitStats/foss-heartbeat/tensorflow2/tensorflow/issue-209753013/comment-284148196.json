{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/284148196", "html_url": "https://github.com/tensorflow/tensorflow/issues/7817#issuecomment-284148196", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7817", "id": 284148196, "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDE0ODE5Ng==", "user": {"login": "akaitsuki-ii", "id": 8386553, "node_id": "MDQ6VXNlcjgzODY1NTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/8386553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akaitsuki-ii", "html_url": "https://github.com/akaitsuki-ii", "followers_url": "https://api.github.com/users/akaitsuki-ii/followers", "following_url": "https://api.github.com/users/akaitsuki-ii/following{/other_user}", "gists_url": "https://api.github.com/users/akaitsuki-ii/gists{/gist_id}", "starred_url": "https://api.github.com/users/akaitsuki-ii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akaitsuki-ii/subscriptions", "organizations_url": "https://api.github.com/users/akaitsuki-ii/orgs", "repos_url": "https://api.github.com/users/akaitsuki-ii/repos", "events_url": "https://api.github.com/users/akaitsuki-ii/events{/privacy}", "received_events_url": "https://api.github.com/users/akaitsuki-ii/received_events", "type": "User", "site_admin": false}, "created_at": "2017-03-04T12:22:09Z", "updated_at": "2017-03-04T12:22:09Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a> Sorry for check it so late.<br>\nI did preload the queue full enough (using single thread <code>sess.run(enqueue_ops)</code>) this time before start running my model and consume the queue, there is no more enqueue operation after dequeue is start.<br>\nBut it seems to be very slow for dequeue in this situation.</p>\n<p>The following is the graph and node metadata showed in TensorBoard. You can see that compute time of dequeue operation is 24.2ms, which is much longer than that of my model, 1.36ms.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/8386553/23578611/322056d4-0116-11e7-9f48-621e7b6a55d0.png\"><img src=\"https://cloud.githubusercontent.com/assets/8386553/23578611/322056d4-0116-11e7-9f48-621e7b6a55d0.png\" alt=\"graph\" style=\"max-width:100%;\"></a><br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/8386553/23578630/a4d7c284-0116-11e7-81f4-7d4aec8b49cd.png\"><img src=\"https://cloud.githubusercontent.com/assets/8386553/23578630/a4d7c284-0116-11e7-81f4-7d4aec8b49cd.png\" alt=\"dequeue-status\" style=\"max-width:100%;\"></a><br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/8386553/23578632/aecdc41e-0116-11e7-8047-501c6e3dd442.png\"><img src=\"https://cloud.githubusercontent.com/assets/8386553/23578632/aecdc41e-0116-11e7-8047-501c6e3dd442.png\" alt=\"model-status\" style=\"max-width:100%;\"></a></p>\n<p>However, if I replace my model with much light operation like <code>tf.square</code>, dequeue will be much faster with same tensors output.<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/8386553/23578663/45ab84e8-0117-11e7-9d6f-7c6316857d2f.png\"><img src=\"https://cloud.githubusercontent.com/assets/8386553/23578663/45ab84e8-0117-11e7-9d6f-7c6316857d2f.png\" alt=\"graph-light\" style=\"max-width:100%;\"></a><br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/8386553/23578664/494bfe02-0117-11e7-94e0-a43dccceb613.png\"><img src=\"https://cloud.githubusercontent.com/assets/8386553/23578664/494bfe02-0117-11e7-94e0-a43dccceb613.png\" alt=\"dequeue-status-light\" style=\"max-width:100%;\"></a></p>\n<p>I can not figure out what the problem is...?</p>", "body_text": "@yaroslavvb Sorry for check it so late.\nI did preload the queue full enough (using single thread sess.run(enqueue_ops)) this time before start running my model and consume the queue, there is no more enqueue operation after dequeue is start.\nBut it seems to be very slow for dequeue in this situation.\nThe following is the graph and node metadata showed in TensorBoard. You can see that compute time of dequeue operation is 24.2ms, which is much longer than that of my model, 1.36ms.\n\n\n\nHowever, if I replace my model with much light operation like tf.square, dequeue will be much faster with same tensors output.\n\n\nI can not figure out what the problem is...?", "body": "@yaroslavvb Sorry for check it so late.\r\nI did preload the queue full enough (using single thread `sess.run(enqueue_ops)`) this time before start running my model and consume the queue, there is no more enqueue operation after dequeue is start.\r\nBut it seems to be very slow for dequeue in this situation.\r\n\r\nThe following is the graph and node metadata showed in TensorBoard. You can see that compute time of dequeue operation is 24.2ms, which is much longer than that of my model, 1.36ms.\r\n![graph](https://cloud.githubusercontent.com/assets/8386553/23578611/322056d4-0116-11e7-9f48-621e7b6a55d0.png)\r\n![dequeue-status](https://cloud.githubusercontent.com/assets/8386553/23578630/a4d7c284-0116-11e7-81f4-7d4aec8b49cd.png)\r\n![model-status](https://cloud.githubusercontent.com/assets/8386553/23578632/aecdc41e-0116-11e7-8047-501c6e3dd442.png)\r\n\r\nHowever, if I replace my model with much light operation like `tf.square`, dequeue will be much faster with same tensors output.\r\n![graph-light](https://cloud.githubusercontent.com/assets/8386553/23578663/45ab84e8-0117-11e7-9d6f-7c6316857d2f.png)\r\n![dequeue-status-light](https://cloud.githubusercontent.com/assets/8386553/23578664/494bfe02-0117-11e7-94e0-a43dccceb613.png)\r\n\r\nI can not figure out what the problem is...?"}