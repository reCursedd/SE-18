{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/306222523", "html_url": "https://github.com/tensorflow/tensorflow/issues/10408#issuecomment-306222523", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10408", "id": 306222523, "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjIyMjUyMw==", "user": {"login": "Dref360", "id": 8976546, "node_id": "MDQ6VXNlcjg5NzY1NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/8976546?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dref360", "html_url": "https://github.com/Dref360", "followers_url": "https://api.github.com/users/Dref360/followers", "following_url": "https://api.github.com/users/Dref360/following{/other_user}", "gists_url": "https://api.github.com/users/Dref360/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dref360/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dref360/subscriptions", "organizations_url": "https://api.github.com/users/Dref360/orgs", "repos_url": "https://api.github.com/users/Dref360/repos", "events_url": "https://api.github.com/users/Dref360/events{/privacy}", "received_events_url": "https://api.github.com/users/Dref360/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-05T15:43:08Z", "updated_at": "2017-06-05T15:43:43Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Early tests seems to show that<br>\n_GRAPH_LEARNING_PHASES is not cleared so there is tons of tensors that get kept.</p>\n<p>Changing to <code>def reset_uids(): global _GRAPH_UID_DICTS global _GRAPH_LEARNING_PHASES _GRAPH_UID_DICTS = {} _GRAPH_LEARNING_PHASES = {}</code></p>\n<p>Seems to resolve the problem.</p>\n<blockquote>\n<p>memory use: 0.13166046142578125<br>\nmemory use: 0.13190841674804688<br>\nmemory use: 0.13220977783203125<br>\nmemory use: 0.13220977783203125<br>\nmemory use: 0.13220977783203125<br>\nmemory use: 0.13220977783203125<br>\nmemory use: 0.13220977783203125<br>\nmemory use: 0.13220977783203125</p>\n</blockquote>\n<p>Will do a PR on keras, it will then get merged into TF I guess?</p>", "body_text": "Early tests seems to show that\n_GRAPH_LEARNING_PHASES is not cleared so there is tons of tensors that get kept.\nChanging to def reset_uids(): global _GRAPH_UID_DICTS global _GRAPH_LEARNING_PHASES _GRAPH_UID_DICTS = {} _GRAPH_LEARNING_PHASES = {}\nSeems to resolve the problem.\n\nmemory use: 0.13166046142578125\nmemory use: 0.13190841674804688\nmemory use: 0.13220977783203125\nmemory use: 0.13220977783203125\nmemory use: 0.13220977783203125\nmemory use: 0.13220977783203125\nmemory use: 0.13220977783203125\nmemory use: 0.13220977783203125\n\nWill do a PR on keras, it will then get merged into TF I guess?", "body": "Early tests seems to show that \r\n_GRAPH_LEARNING_PHASES is not cleared so there is tons of tensors that get kept.\r\n\r\nChanging to ```def reset_uids():\r\n  global _GRAPH_UID_DICTS\r\n  global _GRAPH_LEARNING_PHASES\r\n  _GRAPH_UID_DICTS = {}\r\n  _GRAPH_LEARNING_PHASES = {}```\r\n\r\nSeems to resolve the problem. \r\n\r\n> memory use: 0.13166046142578125\r\nmemory use: 0.13190841674804688\r\nmemory use: 0.13220977783203125\r\nmemory use: 0.13220977783203125\r\nmemory use: 0.13220977783203125\r\nmemory use: 0.13220977783203125\r\nmemory use: 0.13220977783203125\r\nmemory use: 0.13220977783203125\r\n\r\nWill do a PR on keras, it will then get merged into TF I guess?\r\n"}