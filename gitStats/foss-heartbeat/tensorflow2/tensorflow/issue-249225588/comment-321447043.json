{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/321447043", "html_url": "https://github.com/tensorflow/tensorflow/issues/12163#issuecomment-321447043", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12163", "id": 321447043, "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTQ0NzA0Mw==", "user": {"login": "yaroslavvb", "id": 23068, "node_id": "MDQ6VXNlcjIzMDY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaroslavvb", "html_url": "https://github.com/yaroslavvb", "followers_url": "https://api.github.com/users/yaroslavvb/followers", "following_url": "https://api.github.com/users/yaroslavvb/following{/other_user}", "gists_url": "https://api.github.com/users/yaroslavvb/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaroslavvb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaroslavvb/subscriptions", "organizations_url": "https://api.github.com/users/yaroslavvb/orgs", "repos_url": "https://api.github.com/users/yaroslavvb/repos", "events_url": "https://api.github.com/users/yaroslavvb/events{/privacy}", "received_events_url": "https://api.github.com/users/yaroslavvb/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-10T04:23:23Z", "updated_at": "2017-08-10T04:23:23Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hm, I have access to almost identical CPU (only the microcode is a bit older) and can't reproduce this. Also, your example is strange -- in your code TF runtime is never utilized, only Python wrapper functions are called. This means the illegal instruction would be caused by the Python interpreter, or numpy's <code>asarray</code> function rather than TensorFlow. Could it be that your version of numpy is built for wrong architecture?</p>\n<pre><code>&gt;&gt;&gt; a = [0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1]\n&gt;&gt;&gt; \n&gt;&gt;&gt; tf.cast(a, tf.int32)\n&lt;tf.Tensor 'Cast/x:0' shape=(32,) dtype=int32&gt;\n&gt;&gt;&gt; sess=tf.Session()\n2017-08-09 21:17:09.678711: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678746: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678764: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678779: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678793: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\n&gt;&gt;&gt; sess.run(tf.cast(a, tf.int32))\narray([0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0,\n       1, 1, 0, 0, 1, 1, 1, 0, 1], dtype=int32)\n&gt;&gt;&gt; \n&gt;&gt;&gt; tf.__version__\n'1.2.1'\n\n</code></pre>\n<pre><code>processor\t: 31\nvendor_id\t: GenuineIntel\ncpu family\t: 6\nmodel\t\t: 63\nmodel name\t: Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz\nstepping\t: 2\nmicrocode\t: 0x36\ncpu MHz\t\t: 1290.750\ncache size\t: 20480 KB\nphysical id\t: 1\nsiblings\t: 16\ncore id\t\t: 7\ncpu cores\t: 8\napicid\t\t: 31\ninitial apicid\t: 31\nfpu\t\t: yes\nfpu_exception\t: yes\ncpuid level\t: 15\nwp\t\t: yes\n\n</code></pre>", "body_text": "Hm, I have access to almost identical CPU (only the microcode is a bit older) and can't reproduce this. Also, your example is strange -- in your code TF runtime is never utilized, only Python wrapper functions are called. This means the illegal instruction would be caused by the Python interpreter, or numpy's asarray function rather than TensorFlow. Could it be that your version of numpy is built for wrong architecture?\n>>> a = [0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1]\n>>> \n>>> tf.cast(a, tf.int32)\n<tf.Tensor 'Cast/x:0' shape=(32,) dtype=int32>\n>>> sess=tf.Session()\n2017-08-09 21:17:09.678711: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678746: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678764: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678779: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\n2017-08-09 21:17:09.678793: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\n>>> sess.run(tf.cast(a, tf.int32))\narray([0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0,\n       1, 1, 0, 0, 1, 1, 1, 0, 1], dtype=int32)\n>>> \n>>> tf.__version__\n'1.2.1'\n\n\nprocessor\t: 31\nvendor_id\t: GenuineIntel\ncpu family\t: 6\nmodel\t\t: 63\nmodel name\t: Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz\nstepping\t: 2\nmicrocode\t: 0x36\ncpu MHz\t\t: 1290.750\ncache size\t: 20480 KB\nphysical id\t: 1\nsiblings\t: 16\ncore id\t\t: 7\ncpu cores\t: 8\napicid\t\t: 31\ninitial apicid\t: 31\nfpu\t\t: yes\nfpu_exception\t: yes\ncpuid level\t: 15\nwp\t\t: yes", "body": "Hm, I have access to almost identical CPU (only the microcode is a bit older) and can't reproduce this. Also, your example is strange -- in your code TF runtime is never utilized, only Python wrapper functions are called. This means the illegal instruction would be caused by the Python interpreter, or numpy's `asarray` function rather than TensorFlow. Could it be that your version of numpy is built for wrong architecture?\r\n\r\n```\r\n>>> a = [0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1]\r\n>>> \r\n>>> tf.cast(a, tf.int32)\r\n<tf.Tensor 'Cast/x:0' shape=(32,) dtype=int32>\r\n>>> sess=tf.Session()\r\n2017-08-09 21:17:09.678711: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-08-09 21:17:09.678746: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-08-09 21:17:09.678764: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-08-09 21:17:09.678779: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.\r\n2017-08-09 21:17:09.678793: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.\r\n>>> sess.run(tf.cast(a, tf.int32))\r\narray([0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0,\r\n       1, 1, 0, 0, 1, 1, 1, 0, 1], dtype=int32)\r\n>>> \r\n>>> tf.__version__\r\n'1.2.1'\r\n\r\n```\r\n\r\n```\r\nprocessor\t: 31\r\nvendor_id\t: GenuineIntel\r\ncpu family\t: 6\r\nmodel\t\t: 63\r\nmodel name\t: Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz\r\nstepping\t: 2\r\nmicrocode\t: 0x36\r\ncpu MHz\t\t: 1290.750\r\ncache size\t: 20480 KB\r\nphysical id\t: 1\r\nsiblings\t: 16\r\ncore id\t\t: 7\r\ncpu cores\t: 8\r\napicid\t\t: 31\r\ninitial apicid\t: 31\r\nfpu\t\t: yes\r\nfpu_exception\t: yes\r\ncpuid level\t: 15\r\nwp\t\t: yes\r\n\r\n```"}