{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/294925454", "html_url": "https://github.com/tensorflow/tensorflow/issues/9230#issuecomment-294925454", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9230", "id": 294925454, "node_id": "MDEyOklzc3VlQ29tbWVudDI5NDkyNTQ1NA==", "user": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-18T17:46:47Z", "updated_at": "2017-04-18T17:46:47Z", "author_association": "CONTRIBUTOR", "body_html": "<div class=\"email-fragment\">Indeed, the random hue layer would have to allow stateless seeds;\n\nthe map_fn could then be changed to:\n\ndef sampler(img, seed):\n  this_seed = tf.stack((global_seed, seed))\n  return ...sample...(img, ..., seed=this_seed)\n\nsampled_images = map_fn(sampler, images, 5000 + tf.range(0,\nshape(images)[0]))</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Tue, Apr 18, 2017 at 8:53 AM, Geoffrey Irving ***@***.***&gt; wrote:\n Unfortunately the stateful seeding behavior is buried pretty deep in the\n random ops. Making map_fn work in parallel while treating that behavior\n correctly would require some significant redesigns.\n\n Conceivably one could use the new stateless random ops here (<a href=\"https://github.com/tensorflow/tensorflow/commit/cc45456e4ad0eff16127d1727d0cf48afb71ca0e\" class=\"commit-link\"><tt>cc45456</tt></a>\n &lt;<a href=\"https://github.com/tensorflow/tensorflow/commit/cc45456e4ad0eff16127d1727d0cf48afb71ca0e\" class=\"commit-link\"><tt>cc45456</tt></a>&gt;),\n but that would still require higher level layers to track the seeds in a\n reasonable way.\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"221914823\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/9230\" href=\"https://github.com/tensorflow/tensorflow/issues/9230#issuecomment-294889184\">#9230 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/ABtim6ZIn1CjXaATUjNF0bb353Gl4um2ks5rxNxngaJpZM4M-Mpw\">https://github.com/notifications/unsubscribe-auth/ABtim6ZIn1CjXaATUjNF0bb353Gl4um2ks5rxNxngaJpZM4M-Mpw</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Indeed, the random hue layer would have to allow stateless seeds;\n\nthe map_fn could then be changed to:\n\ndef sampler(img, seed):\n  this_seed = tf.stack((global_seed, seed))\n  return ...sample...(img, ..., seed=this_seed)\n\nsampled_images = map_fn(sampler, images, 5000 + tf.range(0,\nshape(images)[0]))\n\u2026\nOn Tue, Apr 18, 2017 at 8:53 AM, Geoffrey Irving ***@***.***> wrote:\n Unfortunately the stateful seeding behavior is buried pretty deep in the\n random ops. Making map_fn work in parallel while treating that behavior\n correctly would require some significant redesigns.\n\n Conceivably one could use the new stateless random ops here (cc45456\n <cc45456>),\n but that would still require higher level layers to track the seeds in a\n reasonable way.\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#9230 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/ABtim6ZIn1CjXaATUjNF0bb353Gl4um2ks5rxNxngaJpZM4M-Mpw>\n .", "body": "Indeed, the random hue layer would have to allow stateless seeds;\n\nthe map_fn could then be changed to:\n\ndef sampler(img, seed):\n  this_seed = tf.stack((global_seed, seed))\n  return ...sample...(img, ..., seed=this_seed)\n\nsampled_images = map_fn(sampler, images, 5000 + tf.range(0,\nshape(images)[0]))\n\n\nOn Tue, Apr 18, 2017 at 8:53 AM, Geoffrey Irving <notifications@github.com>\nwrote:\n\n> Unfortunately the stateful seeding behavior is buried pretty deep in the\n> random ops. Making map_fn work in parallel while treating that behavior\n> correctly would require some significant redesigns.\n>\n> Conceivably one could use the new stateless random ops here (cc45456\n> <https://github.com/tensorflow/tensorflow/commit/cc45456e4ad0eff16127d1727d0cf48afb71ca0e>),\n> but that would still require higher level layers to track the seeds in a\n> reasonable way.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/9230#issuecomment-294889184>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtim6ZIn1CjXaATUjNF0bb353Gl4um2ks5rxNxngaJpZM4M-Mpw>\n> .\n>\n"}