{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/441068771", "html_url": "https://github.com/tensorflow/tensorflow/issues/9545#issuecomment-441068771", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9545", "id": 441068771, "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MTA2ODc3MQ==", "user": {"login": "gsujansai", "id": 27744000, "node_id": "MDQ6VXNlcjI3NzQ0MDAw", "avatar_url": "https://avatars3.githubusercontent.com/u/27744000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gsujansai", "html_url": "https://github.com/gsujansai", "followers_url": "https://api.github.com/users/gsujansai/followers", "following_url": "https://api.github.com/users/gsujansai/following{/other_user}", "gists_url": "https://api.github.com/users/gsujansai/gists{/gist_id}", "starred_url": "https://api.github.com/users/gsujansai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gsujansai/subscriptions", "organizations_url": "https://api.github.com/users/gsujansai/orgs", "repos_url": "https://api.github.com/users/gsujansai/repos", "events_url": "https://api.github.com/users/gsujansai/events{/privacy}", "received_events_url": "https://api.github.com/users/gsujansai/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-22T15:49:42Z", "updated_at": "2018-11-22T15:50:25Z", "author_association": "NONE", "body_html": "<p>I am facing the same issue. Its a problem with tensor-board creating extra instances of shared layers.</p>\n<pre><code>def inference():\n    with tf.variable_scope(\"inner\", reuse=tf.AUTO_REUSE):\n        x = tf.placeholder(dtype = tf.float32, shape=(None, 30,30,3))\n        h = tf.layers.conv2d(x, 5, [3, 3], [1, 1], padding='SAME')\n        print(tf.get_default_graph().get_name_scope()) \n        return h\n\nwith tf.variable_scope(\"outer\"):\n    x = inference() _# will print outer/inner_\n    x2 = inference() _# will print outer/inner_1_\n</code></pre>\n<p>But output of the model summary shows that the variables are being shared.</p>\n<pre><code>outer/inner/conv2d/kernel:0 (float32_ref 3x3x3x5) [135, bytes: 540]\nouter/inner/conv2d/bias:0 (float32_ref 5) [5, bytes: 20]\nTotal size of variables: 140\nTotal bytes of variables: 560\n</code></pre>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9438971\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/sleighsoft\">@sleighsoft</a>'s PR is still in review. Is there any suggested workaround?</p>", "body_text": "I am facing the same issue. Its a problem with tensor-board creating extra instances of shared layers.\ndef inference():\n    with tf.variable_scope(\"inner\", reuse=tf.AUTO_REUSE):\n        x = tf.placeholder(dtype = tf.float32, shape=(None, 30,30,3))\n        h = tf.layers.conv2d(x, 5, [3, 3], [1, 1], padding='SAME')\n        print(tf.get_default_graph().get_name_scope()) \n        return h\n\nwith tf.variable_scope(\"outer\"):\n    x = inference() _# will print outer/inner_\n    x2 = inference() _# will print outer/inner_1_\n\nBut output of the model summary shows that the variables are being shared.\nouter/inner/conv2d/kernel:0 (float32_ref 3x3x3x5) [135, bytes: 540]\nouter/inner/conv2d/bias:0 (float32_ref 5) [5, bytes: 20]\nTotal size of variables: 140\nTotal bytes of variables: 560\n\n@sleighsoft's PR is still in review. Is there any suggested workaround?", "body": "I am facing the same issue. Its a problem with tensor-board creating extra instances of shared layers.\r\n\r\n```\r\ndef inference():\r\n    with tf.variable_scope(\"inner\", reuse=tf.AUTO_REUSE):\r\n        x = tf.placeholder(dtype = tf.float32, shape=(None, 30,30,3))\r\n        h = tf.layers.conv2d(x, 5, [3, 3], [1, 1], padding='SAME')\r\n        print(tf.get_default_graph().get_name_scope()) \r\n        return h\r\n\r\nwith tf.variable_scope(\"outer\"):\r\n    x = inference() _# will print outer/inner_\r\n    x2 = inference() _# will print outer/inner_1_\r\n```\r\n\r\n\r\nBut output of the model summary shows that the variables are being shared.\r\n\r\n```\r\nouter/inner/conv2d/kernel:0 (float32_ref 3x3x3x5) [135, bytes: 540]\r\nouter/inner/conv2d/bias:0 (float32_ref 5) [5, bytes: 20]\r\nTotal size of variables: 140\r\nTotal bytes of variables: 560\r\n```\r\n\r\n@sleighsoft's PR is still in review. Is there any suggested workaround?"}