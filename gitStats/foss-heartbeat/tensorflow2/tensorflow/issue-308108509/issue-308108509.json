{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17956", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17956/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17956/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17956/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/17956", "id": 308108509, "node_id": "MDU6SXNzdWUzMDgxMDg1MDk=", "number": 17956, "title": "Operation missing on iOS despite being added to tf_op_files.txt and ops_to_register.h", "user": {"login": "naktinis", "id": 657600, "node_id": "MDQ6VXNlcjY1NzYwMA==", "avatar_url": "https://avatars0.githubusercontent.com/u/657600?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naktinis", "html_url": "https://github.com/naktinis", "followers_url": "https://api.github.com/users/naktinis/followers", "following_url": "https://api.github.com/users/naktinis/following{/other_user}", "gists_url": "https://api.github.com/users/naktinis/gists{/gist_id}", "starred_url": "https://api.github.com/users/naktinis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naktinis/subscriptions", "organizations_url": "https://api.github.com/users/naktinis/orgs", "repos_url": "https://api.github.com/users/naktinis/repos", "events_url": "https://api.github.com/users/naktinis/events{/privacy}", "received_events_url": "https://api.github.com/users/naktinis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-03-23T17:00:28Z", "updated_at": "2018-11-20T13:26:47Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Mac OS X 10.13.3</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Source</li>\n<li><strong>TensorFlow version (use command below)</strong>: v1.7.0-rc1</li>\n<li><strong>Python version</strong>: 2.7.10</li>\n<li><strong>Bazel version (if compiling from source)</strong>: bazel release 0.11.1-homebrew</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: Apple LLVM version 9.0.0 (clang-900.0.39.2)</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A</li>\n<li><strong>GPU model and memory</strong>: N/A</li>\n<li><strong>Exact command to reproduce</strong>: N/A</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I believe it's a bug. We're trying to run a TensorFlow model on an iOS app by performing the steps described in the <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/makefile#optimization\">official</a> <a href=\"https://www.tensorflow.org/mobile/prepare_models\" rel=\"nofollow\">docs</a>. I've previously successfully built and ran this graph and its related libraries on Android.</p>\n<p>We build the libraries like this:</p>\n<pre><code>tensorflow/contrib/makefile/build_all_ios.sh -a arm64 -g our_inference_graph.pb\n</code></pre>\n<p>We make sure the operations in question (<code>fft_ops.cc</code>) are built:</p>\n<ol>\n<li>\n<p><code>tensorflow/core/framework/ops_to_register.h</code> contains <code>|| isequal(op, \"RFFT\")</code></p>\n</li>\n<li>\n<p><code>android_extended_ops_group1</code> in <code>tensorflow/core/kernels/BUILD</code> contains <code>fft_ops.cc</code></p>\n</li>\n<li>\n<p><code>tensorflow/contrib/makefile/tf_op_files.txt</code> contains <code>tensorflow/core/kernels/fft_ops.cc</code></p>\n</li>\n<li>\n<p>The fft object file is built as <code>tensorflow/contrib/makefile/gen/obj/fft_ops.o</code></p>\n</li>\n</ol>\n<p>However, we get the following error when loading the graph:</p>\n<pre><code>2018-03-23 13:04:06.618259: E tensorflow/core/framework/op_kernel.cc:1197] OpKernel ('op: \"RFFT\" device_type: \"CPU\"') for unknown op: RFFT\n2018-03-23 13:04:06.618616: E &lt;App path&gt;/TensorFlow/Adapter/TensorFlowUtils.mm:152] Could not create TensorFlow Graph: Not found: Op type not registered 'RFFT' in binary running on Foolish. Make sure the Op and Kernel are registered in the binary running in this process.\n2018-03-23 13:04:06.618827: F &lt;App path&gt;/TensorFlow/Adapter/TensorFlowProcessor.mm:73] Couldn't load model: Not found: Op type not registered 'RFFT' in binary running on Foolish. Make sure the Op and Kernel are registered in the binary running in this process.\n</code></pre>\n<p>Here's my question on SO (no repsonse): <a href=\"https://stackoverflow.com/questions/49452489/opkernel-op-rfft-device-type-cpu-for-unknown-op-rfft\" rel=\"nofollow\">https://stackoverflow.com/questions/49452489/opkernel-op-rfft-device-type-cpu-for-unknown-op-rfft</a></p>\n<p>Related issues: issues <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"286538124\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/15921\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/15921/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/15921\">#15921</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"188513832\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/5518\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/5518/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/5518\">#5518</a> suggest adding the operation to <code>tf_op_files.txt</code>, which we've done (see above).</p>\n<h3>Source code / logs</h3>\n<p>Here's how we load the graph: <a href=\"https://gist.github.com/nerthase/22f54c040a195f87b7a9b241536be2a1\">https://gist.github.com/nerthase/22f54c040a195f87b7a9b241536be2a1</a></p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac OS X 10.13.3\nTensorFlow installed from (source or binary): Source\nTensorFlow version (use command below): v1.7.0-rc1\nPython version: 2.7.10\nBazel version (if compiling from source): bazel release 0.11.1-homebrew\nGCC/Compiler version (if compiling from source): Apple LLVM version 9.0.0 (clang-900.0.39.2)\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce: N/A\n\nDescribe the problem\nI believe it's a bug. We're trying to run a TensorFlow model on an iOS app by performing the steps described in the official docs. I've previously successfully built and ran this graph and its related libraries on Android.\nWe build the libraries like this:\ntensorflow/contrib/makefile/build_all_ios.sh -a arm64 -g our_inference_graph.pb\n\nWe make sure the operations in question (fft_ops.cc) are built:\n\n\ntensorflow/core/framework/ops_to_register.h contains || isequal(op, \"RFFT\")\n\n\nandroid_extended_ops_group1 in tensorflow/core/kernels/BUILD contains fft_ops.cc\n\n\ntensorflow/contrib/makefile/tf_op_files.txt contains tensorflow/core/kernels/fft_ops.cc\n\n\nThe fft object file is built as tensorflow/contrib/makefile/gen/obj/fft_ops.o\n\n\nHowever, we get the following error when loading the graph:\n2018-03-23 13:04:06.618259: E tensorflow/core/framework/op_kernel.cc:1197] OpKernel ('op: \"RFFT\" device_type: \"CPU\"') for unknown op: RFFT\n2018-03-23 13:04:06.618616: E <App path>/TensorFlow/Adapter/TensorFlowUtils.mm:152] Could not create TensorFlow Graph: Not found: Op type not registered 'RFFT' in binary running on Foolish. Make sure the Op and Kernel are registered in the binary running in this process.\n2018-03-23 13:04:06.618827: F <App path>/TensorFlow/Adapter/TensorFlowProcessor.mm:73] Couldn't load model: Not found: Op type not registered 'RFFT' in binary running on Foolish. Make sure the Op and Kernel are registered in the binary running in this process.\n\nHere's my question on SO (no repsonse): https://stackoverflow.com/questions/49452489/opkernel-op-rfft-device-type-cpu-for-unknown-op-rfft\nRelated issues: issues #15921 and #5518 suggest adding the operation to tf_op_files.txt, which we've done (see above).\nSource code / logs\nHere's how we load the graph: https://gist.github.com/nerthase/22f54c040a195f87b7a9b241536be2a1", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Mac OS X 10.13.3\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: v1.7.0-rc1\r\n- **Python version**: 2.7.10\r\n- **Bazel version (if compiling from source)**: bazel release 0.11.1-homebrew\r\n- **GCC/Compiler version (if compiling from source)**: Apple LLVM version 9.0.0 (clang-900.0.39.2)\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\nI believe it's a bug. We're trying to run a TensorFlow model on an iOS app by performing the steps described in the [official](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/makefile#optimization) [docs](https://www.tensorflow.org/mobile/prepare_models). I've previously successfully built and ran this graph and its related libraries on Android.\r\n\r\nWe build the libraries like this:\r\n\r\n    tensorflow/contrib/makefile/build_all_ios.sh -a arm64 -g our_inference_graph.pb\r\n\r\nWe make sure the operations in question (`fft_ops.cc`) are built:\r\n\r\n1. `tensorflow/core/framework/ops_to_register.h` contains `|| isequal(op, \"RFFT\")`\r\n\r\n1. `android_extended_ops_group1` in `tensorflow/core/kernels/BUILD` contains `fft_ops.cc`\r\n\r\n1. `tensorflow/contrib/makefile/tf_op_files.txt` contains `tensorflow/core/kernels/fft_ops.cc`\r\n\r\n1. The fft object file is built as `tensorflow/contrib/makefile/gen/obj/fft_ops.o`\r\n\r\nHowever, we get the following error when loading the graph:\r\n\r\n    2018-03-23 13:04:06.618259: E tensorflow/core/framework/op_kernel.cc:1197] OpKernel ('op: \"RFFT\" device_type: \"CPU\"') for unknown op: RFFT\r\n    2018-03-23 13:04:06.618616: E <App path>/TensorFlow/Adapter/TensorFlowUtils.mm:152] Could not create TensorFlow Graph: Not found: Op type not registered 'RFFT' in binary running on Foolish. Make sure the Op and Kernel are registered in the binary running in this process.\r\n    2018-03-23 13:04:06.618827: F <App path>/TensorFlow/Adapter/TensorFlowProcessor.mm:73] Couldn't load model: Not found: Op type not registered 'RFFT' in binary running on Foolish. Make sure the Op and Kernel are registered in the binary running in this process.\r\n\r\nHere's my question on SO (no repsonse): https://stackoverflow.com/questions/49452489/opkernel-op-rfft-device-type-cpu-for-unknown-op-rfft\r\n\r\nRelated issues: issues #15921 and #5518 suggest adding the operation to `tf_op_files.txt`, which we've done (see above).\r\n\r\n### Source code / logs\r\nHere's how we load the graph: https://gist.github.com/nerthase/22f54c040a195f87b7a9b241536be2a1\r\n"}