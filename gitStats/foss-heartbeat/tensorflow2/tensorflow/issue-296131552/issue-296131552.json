{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16919", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16919/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16919/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16919/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16919", "id": 296131552, "node_id": "MDU6SXNzdWUyOTYxMzE1NTI=", "number": 16919, "title": "libhdfs3 instead of libhdfs", "user": {"login": "superbobry", "id": 185856, "node_id": "MDQ6VXNlcjE4NTg1Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/185856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/superbobry", "html_url": "https://github.com/superbobry", "followers_url": "https://api.github.com/users/superbobry/followers", "following_url": "https://api.github.com/users/superbobry/following{/other_user}", "gists_url": "https://api.github.com/users/superbobry/gists{/gist_id}", "starred_url": "https://api.github.com/users/superbobry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/superbobry/subscriptions", "organizations_url": "https://api.github.com/users/superbobry/orgs", "repos_url": "https://api.github.com/users/superbobry/repos", "events_url": "https://api.github.com/users/superbobry/events{/privacy}", "received_events_url": "https://api.github.com/users/superbobry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2018-02-10T20:33:22Z", "updated_at": "2018-07-25T19:19:48Z", "closed_at": null, "author_association": "MEMBER", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes, see diff below.</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: N/A</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: N/A</li>\n<li><strong>TensorFlow version (use command below)</strong>: N/A</li>\n<li><strong>Python version</strong>: N/A</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: N/A</li>\n<li><strong>GPU model and memory</strong>: N/A</li>\n<li><strong>Exact command to reproduce</strong>: N/A</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>Current HDFS support in TensorFlow is based on <a href=\"https://wiki.apache.org/hadoop/LibHDFS\" rel=\"nofollow\"><code>libhdfs</code></a>, a JNI wrapper for the HDFS client implemented in Java. Due to this design choice, users of <code>libhdfs</code> (and transitively TensorFlow)</p>\n<ul>\n<li>need to keep in mind an implicit dependency on the JVM runtime,</li>\n<li>have to do quite a bit of <a href=\"https://www.tensorflow.org/deploy/hadoop\" rel=\"nofollow\">trickery</a> to setup the environment expected by <code>libhdfs</code>.</li>\n</ul>\n<p><a href=\"http://pivotal-data-attic.github.io/attic-c-hdfs-client\" rel=\"nofollow\"><code>libhdfs3</code></a> is a native implementation of an HDFS client, which could potentially free the users from the two issues mentioned above. The documentation of <code>libhdfs3</code> claims that its C API is \"almost the same\" as that of <code>libhdfs</code>. I've verified this on the <code>master</code> version of TensorFlow and the diff is indeed negligible:</p>\n<div class=\"highlight highlight-source-diff\"><pre>index 5f2b222622..0f168fe0dd 100644\n<span class=\"pl-md\">--- a/tensorflow/core/platform/hadoop/hadoop_file_system.h</span>\n<span class=\"pl-mi1\">+++ b/tensorflow/core/platform/hadoop/hadoop_file_system.h</span>\n<span class=\"pl-mdr\">@@ -19,8 +19,8 @@</span> limitations under the License.\n #include \"tensorflow/core/platform/env.h\"\n\n extern \"C\" {\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>struct hdfs_internal;</span>\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>typedef hdfs_internal* hdfsFS;</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>struct HdfsFileSystemInternalWrapper;</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>typedef HdfsFileSystemInternalWrapper* hdfsFS;</span>\n }</pre></div>\n<p>What do you think?</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes, see diff below.\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): N/A\nTensorFlow installed from (source or binary): N/A\nTensorFlow version (use command below): N/A\nPython version: N/A\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version: N/A\nGPU model and memory: N/A\nExact command to reproduce: N/A\n\nDescribe the problem\nCurrent HDFS support in TensorFlow is based on libhdfs, a JNI wrapper for the HDFS client implemented in Java. Due to this design choice, users of libhdfs (and transitively TensorFlow)\n\nneed to keep in mind an implicit dependency on the JVM runtime,\nhave to do quite a bit of trickery to setup the environment expected by libhdfs.\n\nlibhdfs3 is a native implementation of an HDFS client, which could potentially free the users from the two issues mentioned above. The documentation of libhdfs3 claims that its C API is \"almost the same\" as that of libhdfs. I've verified this on the master version of TensorFlow and the diff is indeed negligible:\nindex 5f2b222622..0f168fe0dd 100644\n--- a/tensorflow/core/platform/hadoop/hadoop_file_system.h\n+++ b/tensorflow/core/platform/hadoop/hadoop_file_system.h\n@@ -19,8 +19,8 @@ limitations under the License.\n #include \"tensorflow/core/platform/env.h\"\n\n extern \"C\" {\n-struct hdfs_internal;\n-typedef hdfs_internal* hdfsFS;\n+struct HdfsFileSystemInternalWrapper;\n+typedef HdfsFileSystemInternalWrapper* hdfsFS;\n }\nWhat do you think?", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes, see diff below.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: N/A\r\n- **TensorFlow installed from (source or binary)**: N/A\r\n- **TensorFlow version (use command below)**: N/A\r\n- **Python version**: N/A\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\n\r\nCurrent HDFS support in TensorFlow is based on [`libhdfs`](https://wiki.apache.org/hadoop/LibHDFS), a JNI wrapper for the HDFS client implemented in Java. Due to this design choice, users of `libhdfs` (and transitively TensorFlow) \r\n\r\n* need to keep in mind an implicit dependency on the JVM runtime,\r\n* have to do quite a bit of [trickery](https://www.tensorflow.org/deploy/hadoop) to setup the environment expected by `libhdfs`.\r\n\r\n[`libhdfs3`](http://pivotal-data-attic.github.io/attic-c-hdfs-client) is a native implementation of an HDFS client, which could potentially free the users from the two issues mentioned above. The documentation of `libhdfs3` claims that its C API is \"almost the same\" as that of `libhdfs`. I've verified this on the `master` version of TensorFlow and the diff is indeed negligible:\r\n\r\n```diff\r\nindex 5f2b222622..0f168fe0dd 100644\r\n--- a/tensorflow/core/platform/hadoop/hadoop_file_system.h\r\n+++ b/tensorflow/core/platform/hadoop/hadoop_file_system.h\r\n@@ -19,8 +19,8 @@ limitations under the License.\r\n #include \"tensorflow/core/platform/env.h\"\r\n\r\n extern \"C\" {\r\n-struct hdfs_internal;\r\n-typedef hdfs_internal* hdfsFS;\r\n+struct HdfsFileSystemInternalWrapper;\r\n+typedef HdfsFileSystemInternalWrapper* hdfsFS;\r\n }\r\n```\r\n\r\nWhat do you think?"}