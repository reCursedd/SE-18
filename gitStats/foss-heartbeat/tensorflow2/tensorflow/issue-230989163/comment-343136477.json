{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/343136477", "html_url": "https://github.com/tensorflow/tensorflow/issues/10155#issuecomment-343136477", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10155", "id": 343136477, "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzEzNjQ3Nw==", "user": {"login": "GPhilo", "id": 4441724, "node_id": "MDQ6VXNlcjQ0NDE3MjQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/4441724?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GPhilo", "html_url": "https://github.com/GPhilo", "followers_url": "https://api.github.com/users/GPhilo/followers", "following_url": "https://api.github.com/users/GPhilo/following{/other_user}", "gists_url": "https://api.github.com/users/GPhilo/gists{/gist_id}", "starred_url": "https://api.github.com/users/GPhilo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GPhilo/subscriptions", "organizations_url": "https://api.github.com/users/GPhilo/orgs", "repos_url": "https://api.github.com/users/GPhilo/repos", "events_url": "https://api.github.com/users/GPhilo/events{/privacy}", "received_events_url": "https://api.github.com/users/GPhilo/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-09T12:11:37Z", "updated_at": "2017-11-09T12:11:37Z", "author_association": "NONE", "body_html": "<p>Hello,<br>\ncould you clarify how <code>init_from_checkpoint</code>'s <code>assignment_map</code> should be defined?</p>\n<p>I'm trying to restore weights from an InceptionResnet_v2 checkpoint, but I want to exclude the <code>InceptionResnetV2/Logits</code> and <code>InceptionResnetV2/AuxLogits</code> scopes.<br>\nI get the variables to restore via <code>tf.contrib.slim.get_variables_to_restore(exclude=['InceptionResnetV2/Logits', 'InceptionResnetV2/AuxLogits'])</code> and extract the scopes from the resulting list via <code>scopes = { os.path.dirname(v.name) for v in variables_to_restore }</code>. If I build the assignment_map as <code>{s+'/':s+'/' for s in scopes}</code>, the model init fails trying to restore <code>InceptionResnetV2/Logits/Logits/biases</code>. In <code>scopes</code> there is no <code>*/Logits/*</code>, so why is <code>init_from_checkpoint</code> loading those as well from the checkpoint?</p>", "body_text": "Hello,\ncould you clarify how init_from_checkpoint's assignment_map should be defined?\nI'm trying to restore weights from an InceptionResnet_v2 checkpoint, but I want to exclude the InceptionResnetV2/Logits and InceptionResnetV2/AuxLogits scopes.\nI get the variables to restore via tf.contrib.slim.get_variables_to_restore(exclude=['InceptionResnetV2/Logits', 'InceptionResnetV2/AuxLogits']) and extract the scopes from the resulting list via scopes = { os.path.dirname(v.name) for v in variables_to_restore }. If I build the assignment_map as {s+'/':s+'/' for s in scopes}, the model init fails trying to restore InceptionResnetV2/Logits/Logits/biases. In scopes there is no */Logits/*, so why is init_from_checkpoint loading those as well from the checkpoint?", "body": "Hello,\r\ncould you clarify how `init_from_checkpoint`'s `assignment_map` should be defined?\r\n\r\nI'm trying to restore weights from an InceptionResnet_v2 checkpoint, but I want to exclude the `InceptionResnetV2/Logits` and `InceptionResnetV2/AuxLogits` scopes.\r\nI get the variables to restore via `tf.contrib.slim.get_variables_to_restore(exclude=['InceptionResnetV2/Logits', 'InceptionResnetV2/AuxLogits'])` and extract the scopes from the resulting list via `scopes = { os.path.dirname(v.name) for v in variables_to_restore }`. If I build the assignment_map as `{s+'/':s+'/' for s in scopes}`, the model init fails trying to restore `InceptionResnetV2/Logits/Logits/biases`. In `scopes` there is no `*/Logits/*`, so why is `init_from_checkpoint` loading those as well from the checkpoint?"}