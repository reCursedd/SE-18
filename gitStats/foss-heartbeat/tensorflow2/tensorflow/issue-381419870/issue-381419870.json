{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23785", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23785/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23785/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23785/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23785", "id": 381419870, "node_id": "MDU6SXNzdWUzODE0MTk4NzA=", "number": 23785, "title": "Infinite loop when printing CSV data in eager execution mode ", "user": {"login": "magnusart", "id": 58892, "node_id": "MDQ6VXNlcjU4ODky", "avatar_url": "https://avatars3.githubusercontent.com/u/58892?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magnusart", "html_url": "https://github.com/magnusart", "followers_url": "https://api.github.com/users/magnusart/followers", "following_url": "https://api.github.com/users/magnusart/following{/other_user}", "gists_url": "https://api.github.com/users/magnusart/gists{/gist_id}", "starred_url": "https://api.github.com/users/magnusart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magnusart/subscriptions", "organizations_url": "https://api.github.com/users/magnusart/orgs", "repos_url": "https://api.github.com/users/magnusart/repos", "events_url": "https://api.github.com/users/magnusart/events{/privacy}", "received_events_url": "https://api.github.com/users/magnusart/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "open", "locked": false, "assignee": {"login": "yongtang", "id": 6932348, "node_id": "MDQ6VXNlcjY5MzIzNDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6932348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongtang", "html_url": "https://github.com/yongtang", "followers_url": "https://api.github.com/users/yongtang/followers", "following_url": "https://api.github.com/users/yongtang/following{/other_user}", "gists_url": "https://api.github.com/users/yongtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongtang/subscriptions", "organizations_url": "https://api.github.com/users/yongtang/orgs", "repos_url": "https://api.github.com/users/yongtang/repos", "events_url": "https://api.github.com/users/yongtang/events{/privacy}", "received_events_url": "https://api.github.com/users/yongtang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yongtang", "id": 6932348, "node_id": "MDQ6VXNlcjY5MzIzNDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6932348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongtang", "html_url": "https://github.com/yongtang", "followers_url": "https://api.github.com/users/yongtang/followers", "following_url": "https://api.github.com/users/yongtang/following{/other_user}", "gists_url": "https://api.github.com/users/yongtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongtang/subscriptions", "organizations_url": "https://api.github.com/users/yongtang/orgs", "repos_url": "https://api.github.com/users/yongtang/repos", "events_url": "https://api.github.com/users/yongtang/events{/privacy}", "received_events_url": "https://api.github.com/users/yongtang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-11-16T02:26:13Z", "updated_at": "2018-11-20T18:14:04Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><em>Please make sure that this is a bug. As per our <a href=\"https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md\">GitHub Policy</a>, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em></p>\n<p><strong>System information</strong></p>\n<ul>\n<li>Have I written custom code (as opposed to using a stock example script provided in TensorFlow):<br>\nNo</li>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04):<br>\nMac OS X Mojave</li>\n<li>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:<br>\nNo</li>\n<li>TensorFlow installed from (source or binary):<br>\nbinary via pip (1.12.0)</li>\n<li>TensorFlow version (use command below):<br>\nv1.12.0-rc2-3-ga6d8ffae09 1.12.0</li>\n<li>Python version:<br>\nPython 3.6.5</li>\n<li>Bazel version (if compiling from source):<br>\nN/A</li>\n<li>GCC/Compiler version (if compiling from source):<br>\nN/A</li>\n<li>CUDA/cuDNN version:<br>\nN/A</li>\n<li>GPU model and memory:<br>\nN/A</li>\n</ul>\n<p>You can collect some of this information using our environment capture <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\">script</a><br>\nYou can also obtain the TensorFlow version with<br>\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"</p>\n<p><strong>Describe the current behavior</strong><br>\nFollowing the docs at: <a href=\"https://www.tensorflow.org/tutorials/eager/eager_basics\" rel=\"nofollow\">https://www.tensorflow.org/tutorials/eager/eager_basics</a><br>\nWhen using <code>ds_file = tf.data.TextLineDataset(filename)</code> the docs works as expected, but when using <code>tf.data.experimental.make_csv_dataset</code> function then then the first statement in the print loop is repeated infinitely.</p>\n<p>Example output</p>\n<pre><code>1.12.0\n\nElements in ds_file:\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\n... etc\n</code></pre>\n<p><strong>Describe the expected behavior</strong><br>\nI expect the data API to allow me exploring data in eager execution mode even if I use the CsvDataset class. I can't use <code>TextLineDataset</code> as my CSV file contain multi line values in quotation marks.</p>\n<p><strong>Code to reproduce the issue</strong><br>\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tempfile\n<span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\n\n<span class=\"pl-c1\">print</span>(tf.<span class=\"pl-c1\">__version__</span>)\ntf.enable_eager_execution()\n_, filename <span class=\"pl-k\">=</span> tempfile.mkstemp()\n\n<span class=\"pl-k\">with</span> <span class=\"pl-c1\">open</span>(filename, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>w<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">as</span> f:\n  f.write(<span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"</span>\"Line 1\",1</span>\n<span class=\"pl-s\">\"Line 2\",2</span>\n<span class=\"pl-s\">\"Line 3\",3<span class=\"pl-pds\">\"\"\"</span></span>)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span>ds_file = tf.data.TextLineDataset(filename)</span>\nds_file <span class=\"pl-k\">=</span> tf.data.experimental.make_csv_dataset(filename, <span class=\"pl-c1\">1</span>)\n\n<span class=\"pl-c1\">print</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-cce\">\\n</span>Elements in ds_file:<span class=\"pl-pds\">'</span></span>)\n<span class=\"pl-k\">for</span> x <span class=\"pl-k\">in</span> ds_file:\n  <span class=\"pl-c1\">print</span>(x)</pre></div>\n<p><strong>Other info / logs</strong><br>\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.<br>\nSee above.</p>", "body_text": "Please make sure that this is a bug. As per our GitHub Policy, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nNo\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nMac OS X Mojave\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\nNo\nTensorFlow installed from (source or binary):\nbinary via pip (1.12.0)\nTensorFlow version (use command below):\nv1.12.0-rc2-3-ga6d8ffae09 1.12.0\nPython version:\nPython 3.6.5\nBazel version (if compiling from source):\nN/A\nGCC/Compiler version (if compiling from source):\nN/A\nCUDA/cuDNN version:\nN/A\nGPU model and memory:\nN/A\n\nYou can collect some of this information using our environment capture script\nYou can also obtain the TensorFlow version with\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\nDescribe the current behavior\nFollowing the docs at: https://www.tensorflow.org/tutorials/eager/eager_basics\nWhen using ds_file = tf.data.TextLineDataset(filename) the docs works as expected, but when using tf.data.experimental.make_csv_dataset function then then the first statement in the print loop is repeated infinitely.\nExample output\n1.12.0\n\nElements in ds_file:\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\nOrderedDict([('Line 1', ), ('1', )])\n... etc\n\nDescribe the expected behavior\nI expect the data API to allow me exploring data in eager execution mode even if I use the CsvDataset class. I can't use TextLineDataset as my CSV file contain multi line values in quotation marks.\nCode to reproduce the issue\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\nimport tempfile\nimport tensorflow as tf\n\nprint(tf.__version__)\ntf.enable_eager_execution()\n_, filename = tempfile.mkstemp()\n\nwith open(filename, 'w') as f:\n  f.write(\"\"\"\"Line 1\",1\n\"Line 2\",2\n\"Line 3\",3\"\"\")\n#ds_file = tf.data.TextLineDataset(filename)\nds_file = tf.data.experimental.make_csv_dataset(filename, 1)\n\nprint('\\nElements in ds_file:')\nfor x in ds_file:\n  print(x)\nOther info / logs\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\nSee above.", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nNo\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nMac OS X Mojave\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nNo\r\n- TensorFlow installed from (source or binary):\r\nbinary via pip (1.12.0)\r\n- TensorFlow version (use command below):\r\nv1.12.0-rc2-3-ga6d8ffae09 1.12.0\r\n- Python version:\r\nPython 3.6.5\r\n- Bazel version (if compiling from source):\r\nN/A\r\n- GCC/Compiler version (if compiling from source):\r\nN/A\r\n- CUDA/cuDNN version:\r\nN/A\r\n- GPU model and memory:\r\nN/A\r\n\r\nYou can collect some of this information using our environment capture [script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n**Describe the current behavior**\r\nFollowing the docs at: https://www.tensorflow.org/tutorials/eager/eager_basics\r\nWhen using `ds_file = tf.data.TextLineDataset(filename)` the docs works as expected, but when using `tf.data.experimental.make_csv_dataset` function then then the first statement in the print loop is repeated infinitely.\r\n\r\nExample output\r\n```\r\n1.12.0\r\n\r\nElements in ds_file:\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\nOrderedDict([('Line 1', ), ('1', )])\r\n... etc\r\n```\r\n\r\n**Describe the expected behavior**\r\nI expect the data API to allow me exploring data in eager execution mode even if I use the CsvDataset class. I can't use `TextLineDataset` as my CSV file contain multi line values in quotation marks. \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```python\r\nimport tempfile\r\nimport tensorflow as tf\r\n\r\nprint(tf.__version__)\r\ntf.enable_eager_execution()\r\n_, filename = tempfile.mkstemp()\r\n\r\nwith open(filename, 'w') as f:\r\n  f.write(\"\"\"\"Line 1\",1\r\n\"Line 2\",2\r\n\"Line 3\",3\"\"\")\r\n#ds_file = tf.data.TextLineDataset(filename)\r\nds_file = tf.data.experimental.make_csv_dataset(filename, 1)\r\n\r\nprint('\\nElements in ds_file:')\r\nfor x in ds_file:\r\n  print(x)\r\n```\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nSee above."}