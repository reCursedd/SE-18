{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/392640171", "html_url": "https://github.com/tensorflow/tensorflow/issues/5379#issuecomment-392640171", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5379", "id": 392640171, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjY0MDE3MQ==", "user": {"login": "kalluwa", "id": 9412335, "node_id": "MDQ6VXNlcjk0MTIzMzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/9412335?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kalluwa", "html_url": "https://github.com/kalluwa", "followers_url": "https://api.github.com/users/kalluwa/followers", "following_url": "https://api.github.com/users/kalluwa/following{/other_user}", "gists_url": "https://api.github.com/users/kalluwa/gists{/gist_id}", "starred_url": "https://api.github.com/users/kalluwa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kalluwa/subscriptions", "organizations_url": "https://api.github.com/users/kalluwa/orgs", "repos_url": "https://api.github.com/users/kalluwa/repos", "events_url": "https://api.github.com/users/kalluwa/events{/privacy}", "received_events_url": "https://api.github.com/users/kalluwa/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-29T03:05:06Z", "updated_at": "2018-05-29T03:05:06Z", "author_association": "NONE", "body_html": "<p>[ <strong>Windows 10 x64</strong> ] I have found a solution for using \"setDefaultDevice\" with no exception:</p>\n<p>edit <strong>tensorflow/tf_version_script.lds</strong> to:</p>\n<blockquote>\n<p>this code is from another issue, but i cannot find it out now</p>\n</blockquote>\n<pre><code>tensorflow {\n  global:\n    *tensorflow*;\n    *perftools*gputools*;\n    *TF_*;\n    *TFE_*;\n    *nsync_*;\n    *protobuf*;\n  local:\n    *;\n};\n</code></pre>\n<p>then compile the source( r1.2 is tested ok)<br>\nyou will get tensorflow.dll and lib, but if use these two file in your project you will encounter the exception.<br>\nplease use *<strong>.obj</strong> file instead of <del>tensorflow.dll/lib</del><br>\nEdit your <strong>vcxproj</strong> file (add a lot of Object Entries) just like:</p>\n<pre><code>&lt;ItemGroup&gt;\n        &lt;Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\arena.obj\" /&gt;\n    &lt;Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\bitmap.obj\" /&gt;\n    &lt;Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\coding.obj\" /&gt;\n    &lt;Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\status.obj\" /&gt;\n    &lt;Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\stringpiece.obj\" /&gt;\n    &lt;Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\threadpool.obj\" /&gt;\n...\n</code></pre>\n<p>more details see <a href=\"https://pan.baidu.com/s/12OLFuQ4htdLbNQ-z57408g\" rel=\"nofollow\">this link</a></p>\n<hr>\n<p>and the exception is gone.<br>\nbut :<br>\nexe file is larger  (10MB - &gt; 150MB)<br>\nno tensorflow.dll depends</p>", "body_text": "[ Windows 10 x64 ] I have found a solution for using \"setDefaultDevice\" with no exception:\nedit tensorflow/tf_version_script.lds to:\n\nthis code is from another issue, but i cannot find it out now\n\ntensorflow {\n  global:\n    *tensorflow*;\n    *perftools*gputools*;\n    *TF_*;\n    *TFE_*;\n    *nsync_*;\n    *protobuf*;\n  local:\n    *;\n};\n\nthen compile the source( r1.2 is tested ok)\nyou will get tensorflow.dll and lib, but if use these two file in your project you will encounter the exception.\nplease use *.obj file instead of tensorflow.dll/lib\nEdit your vcxproj file (add a lot of Object Entries) just like:\n<ItemGroup>\n        <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\arena.obj\" />\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\bitmap.obj\" />\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\coding.obj\" />\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\status.obj\" />\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\stringpiece.obj\" />\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\threadpool.obj\" />\n...\n\nmore details see this link\n\nand the exception is gone.\nbut :\nexe file is larger  (10MB - > 150MB)\nno tensorflow.dll depends", "body": "[ **Windows 10 x64** ] I have found a solution for using \"setDefaultDevice\" with no exception:\r\n\r\nedit **tensorflow/tf_version_script.lds** to:\r\n\r\n> this code is from another issue, but i cannot find it out now\r\n\r\n```\r\ntensorflow {\r\n  global:\r\n    *tensorflow*;\r\n    *perftools*gputools*;\r\n    *TF_*;\r\n    *TFE_*;\r\n    *nsync_*;\r\n    *protobuf*;\r\n  local:\r\n    *;\r\n};\r\n```\r\nthen compile the source( r1.2 is tested ok)\r\nyou will get tensorflow.dll and lib, but if use these two file in your project you will encounter the exception.\r\n please use ***.obj** file instead of ~~tensorflow.dll/lib~~\r\nEdit your **vcxproj** file (add a lot of Object Entries) just like:\r\n```\r\n<ItemGroup>\r\n        <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\arena.obj\" />\r\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\bitmap.obj\" />\r\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\coding.obj\" />\r\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\status.obj\" />\r\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\stringpiece.obj\" />\r\n    <Object Include=\"E:\\twd\\build_from_source\\buildgpu12_setdevice\\tf_core_lib.dir\\$(Configuration)\\threadpool.obj\" />\r\n...\r\n```\r\nmore details see [this link](https://pan.baidu.com/s/12OLFuQ4htdLbNQ-z57408g)\r\n\r\n---\r\nand the exception is gone.\r\nbut :\r\nexe file is larger  (10MB - > 150MB)\r\nno tensorflow.dll depends\r\n"}