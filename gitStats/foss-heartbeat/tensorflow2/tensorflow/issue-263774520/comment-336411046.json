{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/336411046", "html_url": "https://github.com/tensorflow/tensorflow/issues/13575#issuecomment-336411046", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13575", "id": 336411046, "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQxMTA0Ng==", "user": {"login": "bodokaiser", "id": 1780466, "node_id": "MDQ6VXNlcjE3ODA0NjY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1780466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bodokaiser", "html_url": "https://github.com/bodokaiser", "followers_url": "https://api.github.com/users/bodokaiser/followers", "following_url": "https://api.github.com/users/bodokaiser/following{/other_user}", "gists_url": "https://api.github.com/users/bodokaiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/bodokaiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bodokaiser/subscriptions", "organizations_url": "https://api.github.com/users/bodokaiser/orgs", "repos_url": "https://api.github.com/users/bodokaiser/repos", "events_url": "https://api.github.com/users/bodokaiser/events{/privacy}", "received_events_url": "https://api.github.com/users/bodokaiser/received_events", "type": "User", "site_admin": false}, "created_at": "2017-10-13T10:11:01Z", "updated_at": "2017-10-13T11:06:02Z", "author_association": "NONE", "body_html": "<p>Okay this is really weird.</p>\n<p>If I replace <code>tf.parse_single_example</code> with <code>tf.parse_single_sequence_example</code> and reference to the resulting features with <code>features[0]['encoded']</code> instead of <code>features['encoded']</code> I do not get an error but the decoded bytes are just about 1/5 of the size it should be. On macOS it works as expected.</p>\n<p><strong>Update:</strong></p>\n<p><del>Using <code>tf.parse_example</code> also gives the same error on windows. Can it be that there is some allocation limit going on on windows?</del></p>\n<p>There are just two possibilities (<a href=\"https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L307\">1</a>, <a href=\"https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L310\">2</a>) where <code>ParseExample</code> returns <code>false</code>. The first one ends at <a href=\"https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L229\"><code>SkipExtraenousTag</code></a> calling <a href=\"https://github.com/google/protobuf/blob/fa5a69e73b0dd667ff15062adbc170310d440ee9/src/google/protobuf/io/coded_stream.cc#L401\"><code>CodedInputStream::ReadVarint32</code></a>. The second one ends at <a href=\"https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L281\"><code>ParseFeatures</code></a> where there are multiple possible points of failure. As this code is coupled very tight with the protobuf library it may make sense to write a protobuf only test case.</p>", "body_text": "Okay this is really weird.\nIf I replace tf.parse_single_example with tf.parse_single_sequence_example and reference to the resulting features with features[0]['encoded'] instead of features['encoded'] I do not get an error but the decoded bytes are just about 1/5 of the size it should be. On macOS it works as expected.\nUpdate:\nUsing tf.parse_example also gives the same error on windows. Can it be that there is some allocation limit going on on windows?\nThere are just two possibilities (1, 2) where ParseExample returns false. The first one ends at SkipExtraenousTag calling CodedInputStream::ReadVarint32. The second one ends at ParseFeatures where there are multiple possible points of failure. As this code is coupled very tight with the protobuf library it may make sense to write a protobuf only test case.", "body": "Okay this is really weird.\r\n\r\nIf I replace `tf.parse_single_example` with `tf.parse_single_sequence_example` and reference to the resulting features with `features[0]['encoded']` instead of `features['encoded']` I do not get an error but the decoded bytes are just about 1/5 of the size it should be. On macOS it works as expected.\r\n\r\n**Update:**\r\n\r\n~~Using `tf.parse_example` also gives the same error on windows. Can it be that there is some allocation limit going on on windows?~~\r\n\r\nThere are just two possibilities ([1][1], [2][2]) where `ParseExample` returns `false`. The first one ends at [`SkipExtraenousTag`][3] calling [`CodedInputStream::ReadVarint32`][4]. The second one ends at [`ParseFeatures`][5] where there are multiple possible points of failure. As this code is coupled very tight with the protobuf library it may make sense to write a protobuf only test case.\r\n\r\n[1]: https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L307\r\n\r\n[2]: https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L310\r\n\r\n[3]: https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L229\r\n\r\n[4]: https://github.com/google/protobuf/blob/fa5a69e73b0dd667ff15062adbc170310d440ee9/src/google/protobuf/io/coded_stream.cc#L401\r\n\r\n[5]: https://github.com/tensorflow/tensorflow/blob/e062447136faa0a3513e3b0690598fee5c16a5db/tensorflow/core/util/example_proto_fast_parsing.cc#L281"}