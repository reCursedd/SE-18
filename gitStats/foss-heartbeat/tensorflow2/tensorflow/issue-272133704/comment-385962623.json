{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/385962623", "html_url": "https://github.com/tensorflow/tensorflow/issues/14356#issuecomment-385962623", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14356", "id": 385962623, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTk2MjYyMw==", "user": {"login": "anujgupta82", "id": 11848354, "node_id": "MDQ6VXNlcjExODQ4MzU0", "avatar_url": "https://avatars0.githubusercontent.com/u/11848354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anujgupta82", "html_url": "https://github.com/anujgupta82", "followers_url": "https://api.github.com/users/anujgupta82/followers", "following_url": "https://api.github.com/users/anujgupta82/following{/other_user}", "gists_url": "https://api.github.com/users/anujgupta82/gists{/gist_id}", "starred_url": "https://api.github.com/users/anujgupta82/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anujgupta82/subscriptions", "organizations_url": "https://api.github.com/users/anujgupta82/orgs", "repos_url": "https://api.github.com/users/anujgupta82/repos", "events_url": "https://api.github.com/users/anujgupta82/events{/privacy}", "received_events_url": "https://api.github.com/users/anujgupta82/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-02T12:35:28Z", "updated_at": "2018-06-01T13:34:27Z", "author_association": "NONE", "body_html": "<p>K.clear_session() did not work for me</p>\n<p>however, what worked was :</p>\n<pre><code>def load_model():\n\tglobal model\n\tmodel = ResNet50(weights=\"imagenet\")\n            # this is key : save the graph after loading the model\n\tglobal graph\n\tgraph = tf.get_default_graph()\n</code></pre>\n<p>While predicting, use the same graph</p>\n<pre><code>    with graph.as_default():\n\tpreds = model.predict(image)\n\t#... etc\n</code></pre>", "body_text": "K.clear_session() did not work for me\nhowever, what worked was :\ndef load_model():\n\tglobal model\n\tmodel = ResNet50(weights=\"imagenet\")\n            # this is key : save the graph after loading the model\n\tglobal graph\n\tgraph = tf.get_default_graph()\n\nWhile predicting, use the same graph\n    with graph.as_default():\n\tpreds = model.predict(image)\n\t#... etc", "body": "K.clear_session() did not work for me\r\n\r\nhowever, what worked was : \r\n\r\n\r\n\tdef load_model():\r\n\t\tglobal model\r\n\t\tmodel = ResNet50(weights=\"imagenet\")\r\n                # this is key : save the graph after loading the model\r\n\t\tglobal graph\r\n\t\tgraph = tf.get_default_graph()\r\n\r\nWhile predicting, use the same graph\r\n\r\n        with graph.as_default():\r\n\t\tpreds = model.predict(image)\r\n\t\t#... etc\r\n\r\n"}