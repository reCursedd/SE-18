{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17106", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17106/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17106/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17106/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/17106", "id": 298074386, "node_id": "MDU6SXNzdWUyOTgwNzQzODY=", "number": 17106, "title": "Bug: tf.dynamic_partition appears to produce bad outputs on GPU (0s appended) (TF 1.5/1.6)", "user": {"login": "ankitvgupta", "id": 5473865, "node_id": "MDQ6VXNlcjU0NzM4NjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/5473865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ankitvgupta", "html_url": "https://github.com/ankitvgupta", "followers_url": "https://api.github.com/users/ankitvgupta/followers", "following_url": "https://api.github.com/users/ankitvgupta/following{/other_user}", "gists_url": "https://api.github.com/users/ankitvgupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/ankitvgupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ankitvgupta/subscriptions", "organizations_url": "https://api.github.com/users/ankitvgupta/orgs", "repos_url": "https://api.github.com/users/ankitvgupta/repos", "events_url": "https://api.github.com/users/ankitvgupta/events{/privacy}", "received_events_url": "https://api.github.com/users/ankitvgupta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ekelsen", "id": 2533174, "node_id": "MDQ6VXNlcjI1MzMxNzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2533174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekelsen", "html_url": "https://github.com/ekelsen", "followers_url": "https://api.github.com/users/ekelsen/followers", "following_url": "https://api.github.com/users/ekelsen/following{/other_user}", "gists_url": "https://api.github.com/users/ekelsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekelsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekelsen/subscriptions", "organizations_url": "https://api.github.com/users/ekelsen/orgs", "repos_url": "https://api.github.com/users/ekelsen/repos", "events_url": "https://api.github.com/users/ekelsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ekelsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ekelsen", "id": 2533174, "node_id": "MDQ6VXNlcjI1MzMxNzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2533174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekelsen", "html_url": "https://github.com/ekelsen", "followers_url": "https://api.github.com/users/ekelsen/followers", "following_url": "https://api.github.com/users/ekelsen/following{/other_user}", "gists_url": "https://api.github.com/users/ekelsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekelsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekelsen/subscriptions", "organizations_url": "https://api.github.com/users/ekelsen/orgs", "repos_url": "https://api.github.com/users/ekelsen/repos", "events_url": "https://api.github.com/users/ekelsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ekelsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-02-18T10:26:50Z", "updated_at": "2018-03-26T18:37:45Z", "closed_at": "2018-03-26T18:37:45Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: Yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Linux Ubuntu 16</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Pip installed 1.5 and 1.6rc0</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.5 and 1.6rc0</li>\n<li><strong>Python version</strong>: 3.6</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>: 9</li>\n<li><strong>GPU model and memory</strong>: nvidia k80</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<pre><code>import tensorflow as tf\nimport numpy as np\nx  = tf.constant(np.random.randn(3072))\ninds = [0]*189 + [1]*184 + [2]*184 + [3]*191 + [4]*192 + [5]*195 + [6]*195 + [7]*195 + [8]*188 + [9]*195 + [10]*188 + [11]*202 + [12]*194 + [13]*194 + [14]*194 + [15]*192\nassert(len(inds) == 3072)\npartitioned = tf.dynamic_partition(x, inds, 16)\nsess = tf.InteractiveSession()\nres = sess.run(partitioned)\nprint(res[-1].shape) # This should be (192,) but is (198,)\n</code></pre>\n<h3>Describe the problem</h3>\n<p>There appears to be a bug with tf.dynamic_partition. When I run the above commands, I see that there are some extra 0s appended to the final partitioned value, and its shape is incorrect - I'm not sure why.</p>\n<p>I checked that this problem does not appear to occur with Tensorflow 1.4, but does occur with Tensorflow 1.5/1.6rc0 on their GPU versions. It does NOT appear to have any issue in the CPU version of Tensorflow 1.5/1.6rc0. I was able to reproduce the error on two separate computers with GPUs.</p>\n<p>This <em>might</em> be related to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"295611516\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/16872\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/16872/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/16872\">#16872</a>.</p>\n<h3>Source code / logs</h3>\n<p>Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16\nTensorFlow installed from (source or binary): Pip installed 1.5 and 1.6rc0\nTensorFlow version (use command below): 1.5 and 1.6rc0\nPython version: 3.6\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version: 9\nGPU model and memory: nvidia k80\nExact command to reproduce:\n\nimport tensorflow as tf\nimport numpy as np\nx  = tf.constant(np.random.randn(3072))\ninds = [0]*189 + [1]*184 + [2]*184 + [3]*191 + [4]*192 + [5]*195 + [6]*195 + [7]*195 + [8]*188 + [9]*195 + [10]*188 + [11]*202 + [12]*194 + [13]*194 + [14]*194 + [15]*192\nassert(len(inds) == 3072)\npartitioned = tf.dynamic_partition(x, inds, 16)\nsess = tf.InteractiveSession()\nres = sess.run(partitioned)\nprint(res[-1].shape) # This should be (192,) but is (198,)\n\nDescribe the problem\nThere appears to be a bug with tf.dynamic_partition. When I run the above commands, I see that there are some extra 0s appended to the final partitioned value, and its shape is incorrect - I'm not sure why.\nI checked that this problem does not appear to occur with Tensorflow 1.4, but does occur with Tensorflow 1.5/1.6rc0 on their GPU versions. It does NOT appear to have any issue in the CPU version of Tensorflow 1.5/1.6rc0. I was able to reproduce the error on two separate computers with GPUs.\nThis might be related to #16872.\nSource code / logs\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16\r\n- **TensorFlow installed from (source or binary)**: Pip installed 1.5 and 1.6rc0\r\n- **TensorFlow version (use command below)**: 1.5 and 1.6rc0\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: 9\r\n- **GPU model and memory**: nvidia k80\r\n- **Exact command to reproduce**: \r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\nx  = tf.constant(np.random.randn(3072))\r\ninds = [0]*189 + [1]*184 + [2]*184 + [3]*191 + [4]*192 + [5]*195 + [6]*195 + [7]*195 + [8]*188 + [9]*195 + [10]*188 + [11]*202 + [12]*194 + [13]*194 + [14]*194 + [15]*192\r\nassert(len(inds) == 3072)\r\npartitioned = tf.dynamic_partition(x, inds, 16)\r\nsess = tf.InteractiveSession()\r\nres = sess.run(partitioned)\r\nprint(res[-1].shape) # This should be (192,) but is (198,)\r\n```\r\n\r\n### Describe the problem\r\n\r\nThere appears to be a bug with tf.dynamic_partition. When I run the above commands, I see that there are some extra 0s appended to the final partitioned value, and its shape is incorrect - I'm not sure why. \r\n\r\nI checked that this problem does not appear to occur with Tensorflow 1.4, but does occur with Tensorflow 1.5/1.6rc0 on their GPU versions. It does NOT appear to have any issue in the CPU version of Tensorflow 1.5/1.6rc0. I was able to reproduce the error on two separate computers with GPUs.\r\n\r\nThis _might_ be related to https://github.com/tensorflow/tensorflow/issues/16872.\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}