{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2653", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2653/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2653/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2653/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/2653", "id": 158504321, "node_id": "MDU6SXNzdWUxNTg1MDQzMjE=", "number": 2653, "title": "CUDA_VISIBLE_DEVICES not working?", "user": {"login": "fancyerii", "id": 5372812, "node_id": "MDQ6VXNlcjUzNzI4MTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/5372812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fancyerii", "html_url": "https://github.com/fancyerii", "followers_url": "https://api.github.com/users/fancyerii/followers", "following_url": "https://api.github.com/users/fancyerii/following{/other_user}", "gists_url": "https://api.github.com/users/fancyerii/gists{/gist_id}", "starred_url": "https://api.github.com/users/fancyerii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fancyerii/subscriptions", "organizations_url": "https://api.github.com/users/fancyerii/orgs", "repos_url": "https://api.github.com/users/fancyerii/repos", "events_url": "https://api.github.com/users/fancyerii/events{/privacy}", "received_events_url": "https://api.github.com/users/fancyerii/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-06-04T13:14:47Z", "updated_at": "2016-12-16T09:15:36Z", "closed_at": "2016-06-06T03:28:56Z", "author_association": "NONE", "body_html": "<p>gpu0 is used by other guys, So I want to use another gpu to run cifar10_train(cifar10_multi_gpu_train).<br>\nBut it seems that tensorflow still try to use gpu0 even I specify CUDA_VISIBLE_DEVICES=2</p>\n<p>$ CUDA_VISIBLE_DEVICES=2 python ~/tensorflow2/lib/python2.7/site-packages/tensorflow/models/image/cifar10/cifar10_train.py --data_dir ~/cifar10_data --train_dir ~/cifar10_train_gpu<br>\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally<br>\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally<br>\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally<br>\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so.1 locally<br>\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally<br>\nFilling queue with 20000 CIFAR images before starting to train. This will take a few minutes.<br>\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties:<br>\nname: GeForce GTX TITAN X<br>\nmajor: 5 minor: 2 memoryClockRate (GHz) 1.076<br>\npciBusID 0000:08:00.0<br>\nTotal memory: 12.00GiB<br>\nFree memory: 11.87GiB<br>\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0<br>\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y<br>\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:755] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:08:00.0)<br>\nF tensorflow/stream_executor/cuda/cuda_dnn.cc:427] could not set cudnn filter descriptor: CUDNN_STATUS_BAD_PARAM<br>\nAborted (core dumped)</p>\n<p>$ nvidia-smi<br>\n|===============================+======================+======================|<br>\n|   0  GeForce GTX TIT...  Off  | 0000:04:00.0     Off |                  N/A |<br>\n| 32%   70C    P2   100W / 250W |  10135MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   1  GeForce GTX TIT...  Off  | 0000:05:00.0     Off |                  N/A |<br>\n| 22%   41C    P0    73W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   2  GeForce GTX TIT...  Off  | 0000:08:00.0     Off |                  N/A |<br>\n| 22%   41C    P0    67W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   3  GeForce GTX TIT...  Off  | 0000:09:00.0     Off |                  N/A |<br>\n| 22%   42C    P0    74W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   4  GeForce GTX TIT...  Off  | 0000:84:00.0     Off |                  N/A |<br>\n| 22%   39C    P0    75W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   5  GeForce GTX TIT...  Off  | 0000:85:00.0     Off |                  N/A |<br>\n| 22%   39C    P0    69W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   6  GeForce GTX TIT...  Off  | 0000:88:00.0     Off |                  N/A |<br>\n| 22%   38C    P0    74W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+<br>\n|   7  GeForce GTX TIT...  Off  | 0000:89:00.0     Off |                  N/A |<br>\n| 22%   38C    P0    69W / 250W |     23MiB / 12287MiB |      0%   E. Process |<br>\n+-------------------------------+----------------------+----------------------+</p>\n<p>+-----------------------------------------------------------------------------+<br>\n| Processes:                                                       GPU Memory |<br>\n|  GPU       PID  Type  Process name                               Usage      |<br>\n|=============================================================================|<br>\n|    0      7266    C   /some/app       10111MiB</p>", "body_text": "gpu0 is used by other guys, So I want to use another gpu to run cifar10_train(cifar10_multi_gpu_train).\nBut it seems that tensorflow still try to use gpu0 even I specify CUDA_VISIBLE_DEVICES=2\n$ CUDA_VISIBLE_DEVICES=2 python ~/tensorflow2/lib/python2.7/site-packages/tensorflow/models/image/cifar10/cifar10_train.py --data_dir ~/cifar10_data --train_dir ~/cifar10_train_gpu\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally\nFilling queue with 20000 CIFAR images before starting to train. This will take a few minutes.\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties:\nname: GeForce GTX TITAN X\nmajor: 5 minor: 2 memoryClockRate (GHz) 1.076\npciBusID 0000:08:00.0\nTotal memory: 12.00GiB\nFree memory: 11.87GiB\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y\nI tensorflow/core/common_runtime/gpu/gpu_device.cc:755] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:08:00.0)\nF tensorflow/stream_executor/cuda/cuda_dnn.cc:427] could not set cudnn filter descriptor: CUDNN_STATUS_BAD_PARAM\nAborted (core dumped)\n$ nvidia-smi\n|===============================+======================+======================|\n|   0  GeForce GTX TIT...  Off  | 0000:04:00.0     Off |                  N/A |\n| 32%   70C    P2   100W / 250W |  10135MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX TIT...  Off  | 0000:05:00.0     Off |                  N/A |\n| 22%   41C    P0    73W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX TIT...  Off  | 0000:08:00.0     Off |                  N/A |\n| 22%   41C    P0    67W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX TIT...  Off  | 0000:09:00.0     Off |                  N/A |\n| 22%   42C    P0    74W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   4  GeForce GTX TIT...  Off  | 0000:84:00.0     Off |                  N/A |\n| 22%   39C    P0    75W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   5  GeForce GTX TIT...  Off  | 0000:85:00.0     Off |                  N/A |\n| 22%   39C    P0    69W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   6  GeForce GTX TIT...  Off  | 0000:88:00.0     Off |                  N/A |\n| 22%   38C    P0    74W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   7  GeForce GTX TIT...  Off  | 0000:89:00.0     Off |                  N/A |\n| 22%   38C    P0    69W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n|=============================================================================|\n|    0      7266    C   /some/app       10111MiB", "body": "gpu0 is used by other guys, So I want to use another gpu to run cifar10_train(cifar10_multi_gpu_train).\nBut it seems that tensorflow still try to use gpu0 even I specify CUDA_VISIBLE_DEVICES=2\n\n$ CUDA_VISIBLE_DEVICES=2 python ~/tensorflow2/lib/python2.7/site-packages/tensorflow/models/image/cifar10/cifar10_train.py --data_dir ~/cifar10_data --train_dir ~/cifar10_train_gpu\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally\nFilling queue with 20000 CIFAR images before starting to train. This will take a few minutes.\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: \nname: GeForce GTX TITAN X\nmajor: 5 minor: 2 memoryClockRate (GHz) 1.076\npciBusID 0000:08:00.0\nTotal memory: 12.00GiB\nFree memory: 11.87GiB\nI tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 \nI tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y \nI tensorflow/core/common_runtime/gpu/gpu_device.cc:755] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:08:00.0)\nF tensorflow/stream_executor/cuda/cuda_dnn.cc:427] could not set cudnn filter descriptor: CUDNN_STATUS_BAD_PARAM\nAborted (core dumped)\n\n$ nvidia-smi\n|===============================+======================+======================|\n|   0  GeForce GTX TIT...  Off  | 0000:04:00.0     Off |                  N/A |\n| 32%   70C    P2   100W / 250W |  10135MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   1  GeForce GTX TIT...  Off  | 0000:05:00.0     Off |                  N/A |\n| 22%   41C    P0    73W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   2  GeForce GTX TIT...  Off  | 0000:08:00.0     Off |                  N/A |\n| 22%   41C    P0    67W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   3  GeForce GTX TIT...  Off  | 0000:09:00.0     Off |                  N/A |\n| 22%   42C    P0    74W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   4  GeForce GTX TIT...  Off  | 0000:84:00.0     Off |                  N/A |\n| 22%   39C    P0    75W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   5  GeForce GTX TIT...  Off  | 0000:85:00.0     Off |                  N/A |\n| 22%   39C    P0    69W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   6  GeForce GTX TIT...  Off  | 0000:88:00.0     Off |                  N/A |\n| 22%   38C    P0    74W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n|   7  GeForce GTX TIT...  Off  | 0000:89:00.0     Off |                  N/A |\n| 22%   38C    P0    69W / 250W |     23MiB / 12287MiB |      0%   E. Process |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID  Type  Process name                               Usage      |\n|=============================================================================|\n|    0      7266    C   /some/app       10111MiB \n"}