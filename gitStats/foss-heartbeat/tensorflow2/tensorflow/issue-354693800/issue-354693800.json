{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21920", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21920/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21920/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21920/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21920", "id": 354693800, "node_id": "MDU6SXNzdWUzNTQ2OTM4MDA=", "number": 21920, "title": "BeamSearchDecoder bug\uff1f", "user": {"login": "weiwancheng", "id": 13504420, "node_id": "MDQ6VXNlcjEzNTA0NDIw", "avatar_url": "https://avatars0.githubusercontent.com/u/13504420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weiwancheng", "html_url": "https://github.com/weiwancheng", "followers_url": "https://api.github.com/users/weiwancheng/followers", "following_url": "https://api.github.com/users/weiwancheng/following{/other_user}", "gists_url": "https://api.github.com/users/weiwancheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/weiwancheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weiwancheng/subscriptions", "organizations_url": "https://api.github.com/users/weiwancheng/orgs", "repos_url": "https://api.github.com/users/weiwancheng/repos", "events_url": "https://api.github.com/users/weiwancheng/events{/privacy}", "received_events_url": "https://api.github.com/users/weiwancheng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2018-08-28T11:46:07Z", "updated_at": "2018-11-11T13:30:40Z", "closed_at": "2018-10-25T15:35:49Z", "author_association": "NONE", "body_html": "<p>it seems that the beam search not end with 'eos' symbol. So, there are same sentences generated by beam search. who can slove this problem?<br>\ncode:<br>\n<code>                    inference_decoder = BeamSearchDecoder( cell=self.decoder_cell, embedding=embed_and_input_proj, start_tokens=start_tokens, end_token=end_token, initial_state=self.decoder_initial_state, beam_width=self.beam_width, output_layer=self.decoder_output_projection, )</code></p>\n<p>beam_size=5,result:<br>\nsentence1\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u5c0f\u66e6\u4e5f\u662f\u5341\u5206\u62b1\u6b49\u7684 eos unk unk unk unk unk<br>\nsentence2\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos  eos  eos eos eos eos eos eos eos eos eos<br>\nsentence3\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos eos eos eos eos eos eos eos eos eos unk<br>\nsentence4\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos eos eos eos eos eos eos unk unk unk unk<br>\nsentence5\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos unk unk unk unk unk unk unk unk unk unk</p>\n<p>above. sentence2,sentence3,sentence4,sentence5 is alike.</p>", "body_text": "it seems that the beam search not end with 'eos' symbol. So, there are same sentences generated by beam search. who can slove this problem?\ncode:\n                    inference_decoder = BeamSearchDecoder( cell=self.decoder_cell, embedding=embed_and_input_proj, start_tokens=start_tokens, end_token=end_token, initial_state=self.decoder_initial_state, beam_width=self.beam_width, output_layer=self.decoder_output_projection, )\nbeam_size=5,result:\nsentence1\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u5c0f\u66e6\u4e5f\u662f\u5341\u5206\u62b1\u6b49\u7684 eos unk unk unk unk unk\nsentence2\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos  eos  eos eos eos eos eos eos eos eos eos\nsentence3\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos eos eos eos eos eos eos eos eos eos unk\nsentence4\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos eos eos eos eos eos eos unk unk unk unk\nsentence5\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos unk unk unk unk unk unk unk unk unk unk\nabove. sentence2,sentence3,sentence4,sentence5 is alike.", "body": "it seems that the beam search not end with 'eos' symbol. So, there are same sentences generated by beam search. who can slove this problem?\r\ncode:\r\n`                    inference_decoder = BeamSearchDecoder(\r\n                        cell=self.decoder_cell,\r\n                        embedding=embed_and_input_proj,\r\n                        start_tokens=start_tokens,\r\n                        end_token=end_token,\r\n                        initial_state=self.decoder_initial_state,\r\n                        beam_width=self.beam_width,\r\n                        output_layer=self.decoder_output_projection,\r\n                    )`\r\n\r\nbeam_size=5,result:\r\nsentence1\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u5c0f\u66e6\u4e5f\u662f\u5341\u5206\u62b1\u6b49\u7684 eos unk unk unk unk unk\r\nsentence2\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos  eos  eos eos eos eos eos eos eos eos eos \r\nsentence3\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos eos eos eos eos eos eos eos eos eos unk\r\nsentence4\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos eos eos eos eos eos eos unk unk unk unk \r\nsentence5\uff1a \u7ed9\u60a8\u5e26\u6765\u4e0d\u597d\u7684\u4f53\u9a8c\u4e86\uff0c\u975e\u5e38\u62b1\u6b49 eos unk unk unk unk unk unk unk unk unk unk\r\n\r\nabove. sentence2,sentence3,sentence4,sentence5 is alike.\r\n"}