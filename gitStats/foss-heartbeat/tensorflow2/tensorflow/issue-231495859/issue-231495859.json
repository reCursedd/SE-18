{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10204", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10204/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10204/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10204/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10204", "id": 231495859, "node_id": "MDU6SXNzdWUyMzE0OTU4NTk=", "number": 10204, "title": "tf.summary.text fails keeping summaries", "user": {"login": "j-min", "id": 18069263, "node_id": "MDQ6VXNlcjE4MDY5MjYz", "avatar_url": "https://avatars3.githubusercontent.com/u/18069263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/j-min", "html_url": "https://github.com/j-min", "followers_url": "https://api.github.com/users/j-min/followers", "following_url": "https://api.github.com/users/j-min/following{/other_user}", "gists_url": "https://api.github.com/users/j-min/gists{/gist_id}", "starred_url": "https://api.github.com/users/j-min/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/j-min/subscriptions", "organizations_url": "https://api.github.com/users/j-min/orgs", "repos_url": "https://api.github.com/users/j-min/repos", "events_url": "https://api.github.com/users/j-min/events{/privacy}", "received_events_url": "https://api.github.com/users/j-min/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-05-26T00:33:10Z", "updated_at": "2017-06-16T20:45:07Z", "closed_at": "2017-06-16T20:44:58Z", "author_association": "NONE", "body_html": "<p>I got following issues when I use <code>tf.summary.text</code> and view the summaries on tensorboard.</p>\n<ul>\n<li>It shows me text summaries in random order.</li>\n<li>It randomly removes existing summaries and show me only a few (Is there a configuration for maximum number of summaries to keep?)</li>\n<li>I can usually see only around 5 summaries on tensorboard even if I added summaries 100+ times.</li>\n<li>Other summaries work properly when I use summaries like below.</li>\n</ul>\n<pre><code>summary_op = tf.summary.merge(summaries) # Other scalar, distribution, histogram summaries\nvalid_summary_op = tf.summary.merge([valid_sentence_summary]) # text summary with tf.summary.text\n</code></pre>\n<p>I can reproduce this problem in two different environments.</p>\n<ol>\n<li>Ubuntu 14.04 / CUDA 8.0 / Cudnn 5.1 / TF 1.1.0rc2 / Bazel 0.4.5 / GPU TITAN X Pascal (use 0 gpus~4gpus)</li>\n<li>Mac OSx Sierra / TF 1.1.0rc2 / Bazel 0.4.5 / No GPU</li>\n</ol>\n<p>Below is sample code to reproduce this issue.</p>\n<pre><code>import tensorflow as tf\n\ntext_list = ['this is the first text', 'this is 2nd text', 'this is random text']\nid2sent = {id:sent for id, sent in enumerate(text_list)}\nsent2id = {sent:id for id, sent in id2sent.items()}\n\ntf.reset_default_graph()    \n\nouter_string = tf.convert_to_tensor('This is string outside inner scope.')\nouter_summary = tf.summary.text('outside_summary', outer_string)\n\nwith tf.name_scope('validation_sentences') as scope:\n    id_list = tf.placeholder(tf.int32, shape=[3], name='sent_ids')\n\n    valid_placeholder = tf.placeholder(tf.string, name='valid_summaries')\n\n    inner_summary = tf.summary.text('sent_summary', valid_placeholder)\n    summaries = [outer_summary, inner_summary]\n    summary_op = tf.summary.merge(summaries)\n        \nsess = tf.Session()\nsummary_writer = tf.summary.FileWriter(logdir='./text_summary', graph=sess.graph)\n\nfor step in range(10):\n\n    predicted_sents_ids = sess.run(\n        id_list,\n        feed_dict={\n            id_list: [0, 1, 2]\n        })\n\n    # list of string\n    predicted_sents = [id2sent[id] for id in predicted_sents_ids]\n\n    valid_summary = sess.run(summary_op, feed_dict={\n        valid_placeholder: predicted_sents\n    })\n\n    summary_writer.add_summary(valid_summary, global_step=step)\n    # summary_writer.flush()\n# summary_writer.flush()\n# flush() didn't help..\n</code></pre>\n<p>And below is the result on tensorboard.</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://cloud.githubusercontent.com/assets/18069263/26475951/2030a548-41f6-11e7-8898-ca7ac12aa137.png\"><img src=\"https://cloud.githubusercontent.com/assets/18069263/26475951/2030a548-41f6-11e7-8898-ca7ac12aa137.png\" alt=\"image\" style=\"max-width:100%;\"></a></p>", "body_text": "I got following issues when I use tf.summary.text and view the summaries on tensorboard.\n\nIt shows me text summaries in random order.\nIt randomly removes existing summaries and show me only a few (Is there a configuration for maximum number of summaries to keep?)\nI can usually see only around 5 summaries on tensorboard even if I added summaries 100+ times.\nOther summaries work properly when I use summaries like below.\n\nsummary_op = tf.summary.merge(summaries) # Other scalar, distribution, histogram summaries\nvalid_summary_op = tf.summary.merge([valid_sentence_summary]) # text summary with tf.summary.text\n\nI can reproduce this problem in two different environments.\n\nUbuntu 14.04 / CUDA 8.0 / Cudnn 5.1 / TF 1.1.0rc2 / Bazel 0.4.5 / GPU TITAN X Pascal (use 0 gpus~4gpus)\nMac OSx Sierra / TF 1.1.0rc2 / Bazel 0.4.5 / No GPU\n\nBelow is sample code to reproduce this issue.\nimport tensorflow as tf\n\ntext_list = ['this is the first text', 'this is 2nd text', 'this is random text']\nid2sent = {id:sent for id, sent in enumerate(text_list)}\nsent2id = {sent:id for id, sent in id2sent.items()}\n\ntf.reset_default_graph()    \n\nouter_string = tf.convert_to_tensor('This is string outside inner scope.')\nouter_summary = tf.summary.text('outside_summary', outer_string)\n\nwith tf.name_scope('validation_sentences') as scope:\n    id_list = tf.placeholder(tf.int32, shape=[3], name='sent_ids')\n\n    valid_placeholder = tf.placeholder(tf.string, name='valid_summaries')\n\n    inner_summary = tf.summary.text('sent_summary', valid_placeholder)\n    summaries = [outer_summary, inner_summary]\n    summary_op = tf.summary.merge(summaries)\n        \nsess = tf.Session()\nsummary_writer = tf.summary.FileWriter(logdir='./text_summary', graph=sess.graph)\n\nfor step in range(10):\n\n    predicted_sents_ids = sess.run(\n        id_list,\n        feed_dict={\n            id_list: [0, 1, 2]\n        })\n\n    # list of string\n    predicted_sents = [id2sent[id] for id in predicted_sents_ids]\n\n    valid_summary = sess.run(summary_op, feed_dict={\n        valid_placeholder: predicted_sents\n    })\n\n    summary_writer.add_summary(valid_summary, global_step=step)\n    # summary_writer.flush()\n# summary_writer.flush()\n# flush() didn't help..\n\nAnd below is the result on tensorboard.", "body": "I got following issues when I use `tf.summary.text` and view the summaries on tensorboard.\r\n\r\n- It shows me text summaries in random order.\r\n- It randomly removes existing summaries and show me only a few (Is there a configuration for maximum number of summaries to keep?)\r\n- I can usually see only around 5 summaries on tensorboard even if I added summaries 100+ times.\r\n- Other summaries work properly when I use summaries like below.\r\n```\r\nsummary_op = tf.summary.merge(summaries) # Other scalar, distribution, histogram summaries\r\nvalid_summary_op = tf.summary.merge([valid_sentence_summary]) # text summary with tf.summary.text\r\n```\r\n\r\n\r\nI can reproduce this problem in two different environments.\r\n\r\n1. Ubuntu 14.04 / CUDA 8.0 / Cudnn 5.1 / TF 1.1.0rc2 / Bazel 0.4.5 / GPU TITAN X Pascal (use 0 gpus~4gpus)\r\n2. Mac OSx Sierra / TF 1.1.0rc2 / Bazel 0.4.5 / No GPU\r\n\r\nBelow is sample code to reproduce this issue.\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\ntext_list = ['this is the first text', 'this is 2nd text', 'this is random text']\r\nid2sent = {id:sent for id, sent in enumerate(text_list)}\r\nsent2id = {sent:id for id, sent in id2sent.items()}\r\n\r\ntf.reset_default_graph()    \r\n\r\nouter_string = tf.convert_to_tensor('This is string outside inner scope.')\r\nouter_summary = tf.summary.text('outside_summary', outer_string)\r\n\r\nwith tf.name_scope('validation_sentences') as scope:\r\n    id_list = tf.placeholder(tf.int32, shape=[3], name='sent_ids')\r\n\r\n    valid_placeholder = tf.placeholder(tf.string, name='valid_summaries')\r\n\r\n    inner_summary = tf.summary.text('sent_summary', valid_placeholder)\r\n    summaries = [outer_summary, inner_summary]\r\n    summary_op = tf.summary.merge(summaries)\r\n        \r\nsess = tf.Session()\r\nsummary_writer = tf.summary.FileWriter(logdir='./text_summary', graph=sess.graph)\r\n\r\nfor step in range(10):\r\n\r\n    predicted_sents_ids = sess.run(\r\n        id_list,\r\n        feed_dict={\r\n            id_list: [0, 1, 2]\r\n        })\r\n\r\n    # list of string\r\n    predicted_sents = [id2sent[id] for id in predicted_sents_ids]\r\n\r\n    valid_summary = sess.run(summary_op, feed_dict={\r\n        valid_placeholder: predicted_sents\r\n    })\r\n\r\n    summary_writer.add_summary(valid_summary, global_step=step)\r\n    # summary_writer.flush()\r\n# summary_writer.flush()\r\n# flush() didn't help..\r\n```\r\n\r\nAnd below is the result on tensorboard.\r\n\r\n![image](https://cloud.githubusercontent.com/assets/18069263/26475951/2030a548-41f6-11e7-8898-ca7ac12aa137.png)\r\n"}