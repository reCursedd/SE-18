{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/230248043", "pull_request_review_id": 170941844, "id": 230248043, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDI0ODA0Mw==", "diff_hunk": "@@ -126,6 +126,7 @@ py_library(\n     }) + select({\n         \"//tensorflow:with_ignite_support\": [\n             \"//tensorflow/contrib/ignite\",\n+            \"//tensorflow/contrib/igfs\",", "path": "tensorflow/contrib/BUILD", "position": null, "original_position": 4, "commit_id": "24579bc55c379ea1d43b3d3b9d319038aa12f091", "original_commit_id": "273abe3bd46ce505b610b0bcf88d9c6afc472fce", "user": {"login": "mrry", "id": 192142, "node_id": "MDQ6VXNlcjE5MjE0Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/192142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrry", "html_url": "https://github.com/mrry", "followers_url": "https://api.github.com/users/mrry/followers", "following_url": "https://api.github.com/users/mrry/following{/other_user}", "gists_url": "https://api.github.com/users/mrry/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrry/subscriptions", "organizations_url": "https://api.github.com/users/mrry/orgs", "repos_url": "https://api.github.com/users/mrry/repos", "events_url": "https://api.github.com/users/mrry/events{/privacy}", "received_events_url": "https://api.github.com/users/mrry/received_events", "type": "User", "site_admin": false}, "body": "No, I don't agree. The two modules are coupled by dependencies from this new code to the `tensorflow/contrib/ignite` module. The `tf.contrib.igfs` module doesn't export any public symbols, so users won't interact with it directly... and (if built) it will be loaded if they like it or not.\r\n\r\nPerhaps most importantly, the shared object rules in the `BUILD` file mean that the code in `\"//tensorflow/contrib/ignite:ignite_client\"` will be present in both `tensorflow/contrib/igfs/_igfs_ops.so` and `tensorflow/contrib/ignite/_dataset_ops.so`, which can lead to a One Definition Rule violation and undefined behavior.\r\n\r\nSo, for all those reasons, life would be much easier if the code were combined in one module, with a single shared object!", "created_at": "2018-11-02T01:22:16Z", "updated_at": "2018-11-07T11:35:25Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/22194#discussion_r230248043", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22194", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/230248043"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/22194#discussion_r230248043"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/22194"}}, "body_html": "<p>No, I don't agree. The two modules are coupled by dependencies from this new code to the <code>tensorflow/contrib/ignite</code> module. The <code>tf.contrib.igfs</code> module doesn't export any public symbols, so users won't interact with it directly... and (if built) it will be loaded if they like it or not.</p>\n<p>Perhaps most importantly, the shared object rules in the <code>BUILD</code> file mean that the code in <code>\"//tensorflow/contrib/ignite:ignite_client\"</code> will be present in both <code>tensorflow/contrib/igfs/_igfs_ops.so</code> and <code>tensorflow/contrib/ignite/_dataset_ops.so</code>, which can lead to a One Definition Rule violation and undefined behavior.</p>\n<p>So, for all those reasons, life would be much easier if the code were combined in one module, with a single shared object!</p>", "body_text": "No, I don't agree. The two modules are coupled by dependencies from this new code to the tensorflow/contrib/ignite module. The tf.contrib.igfs module doesn't export any public symbols, so users won't interact with it directly... and (if built) it will be loaded if they like it or not.\nPerhaps most importantly, the shared object rules in the BUILD file mean that the code in \"//tensorflow/contrib/ignite:ignite_client\" will be present in both tensorflow/contrib/igfs/_igfs_ops.so and tensorflow/contrib/ignite/_dataset_ops.so, which can lead to a One Definition Rule violation and undefined behavior.\nSo, for all those reasons, life would be much easier if the code were combined in one module, with a single shared object!", "in_reply_to_id": 224857474}