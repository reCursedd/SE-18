{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18875", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18875/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18875/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18875/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18875", "id": 317785171, "node_id": "MDU6SXNzdWUzMTc3ODUxNzE=", "number": 18875, "title": "1.7.0 fails to compile on aarch64 with TensorRT support", "user": {"login": "thomasyoung", "id": 583132, "node_id": "MDQ6VXNlcjU4MzEzMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/583132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomasyoung", "html_url": "https://github.com/thomasyoung", "followers_url": "https://api.github.com/users/thomasyoung/followers", "following_url": "https://api.github.com/users/thomasyoung/following{/other_user}", "gists_url": "https://api.github.com/users/thomasyoung/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomasyoung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomasyoung/subscriptions", "organizations_url": "https://api.github.com/users/thomasyoung/orgs", "repos_url": "https://api.github.com/users/thomasyoung/repos", "events_url": "https://api.github.com/users/thomasyoung/events{/privacy}", "received_events_url": "https://api.github.com/users/thomasyoung/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-25T20:38:53Z", "updated_at": "2018-06-06T06:45:33Z", "closed_at": "2018-04-25T22:51:11Z", "author_association": "NONE", "body_html": "<p>JetsonTX2 with JetPack 3.2 which has Cuda9, Cudnn7 and TensorRT 3.0. Here is the content in .tf_configure.bazelrc file:</p>\n<pre><code>build --action_env PYTHON_BIN_PATH=\"/usr/bin/python\"\nbuild --action_env PYTHON_LIB_PATH=\"/usr/local/lib/python2.7/dist-packages\"\nbuild --force_python=py2\nbuild --host_force_python=py2\nbuild --python_path=\"/usr/bin/python\"\nbuild --define with_jemalloc=true\nbuild --define with_gcp_support=true\nbuild --define with_hdfs_support=true\nbuild --define with_s3_support=true\nbuild:kafka --define with_kafka_support=true\nbuild:xla --define with_xla_support=true\nbuild:gdr --define with_gdr_support=true\nbuild:verbs --define with_verbs_support=true\nbuild --action_env TF_NEED_OPENCL_SYCL=\"0\"\nbuild --action_env TF_NEED_CUDA=\"1\"\nbuild --action_env CUDA_TOOLKIT_PATH=\"/usr/local/cuda\"\nbuild --action_env TF_CUDA_VERSION=\"9.0\"\nbuild --action_env CUDNN_INSTALL_PATH=\"/usr/lib/aarch64-linux-gnu\"\nbuild --action_env TF_CUDNN_VERSION=\"7\"\nbuild --action_env TENSORRT_INSTALL_PATH=\"/usr/lib/aarch64-linux-gnu\"\nbuild --action_env TF_TENSORRT_VERSION=\"4.0.4\"\nbuild --action_env TF_CUDA_COMPUTE_CAPABILITIES=\"3.5,5.2\"\nbuild --action_env LD_LIBRARY_PATH=\"/usr/local/cuda-9.0/lib64:\"\nbuild --action_env TF_CUDA_CLANG=\"0\"\nbuild --action_env GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\nbuild --config=cuda\ntest --config=cuda\nbuild --define grpc_no_ares=true\nbuild:opt --copt=-march=native\nbuild:opt --host_copt=-march=native\nbuild:opt --define with_default_optimizations=true\nbuild --copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK\nbuild --host_copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK\n</code></pre>\n<p>When building pip package:</p>\n<pre><code>.........................\nERROR: Skipping 'tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'build_defs.bzl': no such package '@local_config_tensorrt//': Traceback (most recent call last):\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 167\n\t\t_trt_lib_version(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 77, in _trt_lib_version\n\t\t_find_trt_header_dir(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in _find_trt_header_dir\n\t\tstr(repository_ctx.path((\"%s/../incl...)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in str\n\t\trepository_ctx.path((\"%s/../include\" % trt_install_path)).realpath\n/usr/lib/include (No such file or directory)\nWARNING: Target pattern parsing failed.\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'build_defs.bzl': no such package '@local_config_tensorrt//': Traceback (most recent call last):\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 167\n\t\t_trt_lib_version(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 77, in _trt_lib_version\n\t\t_find_trt_header_dir(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in _find_trt_header_dir\n\t\tstr(repository_ctx.path((\"%s/../incl...)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in str\n\t\trepository_ctx.path((\"%s/../include\" % trt_install_path)).realpath\n/usr/lib/include (No such file or directory)\n</code></pre>\n<p>Without TensorRT support it compiles well.</p>", "body_text": "JetsonTX2 with JetPack 3.2 which has Cuda9, Cudnn7 and TensorRT 3.0. Here is the content in .tf_configure.bazelrc file:\nbuild --action_env PYTHON_BIN_PATH=\"/usr/bin/python\"\nbuild --action_env PYTHON_LIB_PATH=\"/usr/local/lib/python2.7/dist-packages\"\nbuild --force_python=py2\nbuild --host_force_python=py2\nbuild --python_path=\"/usr/bin/python\"\nbuild --define with_jemalloc=true\nbuild --define with_gcp_support=true\nbuild --define with_hdfs_support=true\nbuild --define with_s3_support=true\nbuild:kafka --define with_kafka_support=true\nbuild:xla --define with_xla_support=true\nbuild:gdr --define with_gdr_support=true\nbuild:verbs --define with_verbs_support=true\nbuild --action_env TF_NEED_OPENCL_SYCL=\"0\"\nbuild --action_env TF_NEED_CUDA=\"1\"\nbuild --action_env CUDA_TOOLKIT_PATH=\"/usr/local/cuda\"\nbuild --action_env TF_CUDA_VERSION=\"9.0\"\nbuild --action_env CUDNN_INSTALL_PATH=\"/usr/lib/aarch64-linux-gnu\"\nbuild --action_env TF_CUDNN_VERSION=\"7\"\nbuild --action_env TENSORRT_INSTALL_PATH=\"/usr/lib/aarch64-linux-gnu\"\nbuild --action_env TF_TENSORRT_VERSION=\"4.0.4\"\nbuild --action_env TF_CUDA_COMPUTE_CAPABILITIES=\"3.5,5.2\"\nbuild --action_env LD_LIBRARY_PATH=\"/usr/local/cuda-9.0/lib64:\"\nbuild --action_env TF_CUDA_CLANG=\"0\"\nbuild --action_env GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\nbuild --config=cuda\ntest --config=cuda\nbuild --define grpc_no_ares=true\nbuild:opt --copt=-march=native\nbuild:opt --host_copt=-march=native\nbuild:opt --define with_default_optimizations=true\nbuild --copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK\nbuild --host_copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK\n\nWhen building pip package:\n.........................\nERROR: Skipping 'tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'build_defs.bzl': no such package '@local_config_tensorrt//': Traceback (most recent call last):\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 167\n\t\t_trt_lib_version(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 77, in _trt_lib_version\n\t\t_find_trt_header_dir(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in _find_trt_header_dir\n\t\tstr(repository_ctx.path((\"%s/../incl...)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in str\n\t\trepository_ctx.path((\"%s/../include\" % trt_install_path)).realpath\n/usr/lib/include (No such file or directory)\nWARNING: Target pattern parsing failed.\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'build_defs.bzl': no such package '@local_config_tensorrt//': Traceback (most recent call last):\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 167\n\t\t_trt_lib_version(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 77, in _trt_lib_version\n\t\t_find_trt_header_dir(repository_ctx, trt_install_path)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in _find_trt_header_dir\n\t\tstr(repository_ctx.path((\"%s/../incl...)\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in str\n\t\trepository_ctx.path((\"%s/../include\" % trt_install_path)).realpath\n/usr/lib/include (No such file or directory)\n\nWithout TensorRT support it compiles well.", "body": "JetsonTX2 with JetPack 3.2 which has Cuda9, Cudnn7 and TensorRT 3.0. Here is the content in .tf_configure.bazelrc file:\r\n```\r\nbuild --action_env PYTHON_BIN_PATH=\"/usr/bin/python\"\r\nbuild --action_env PYTHON_LIB_PATH=\"/usr/local/lib/python2.7/dist-packages\"\r\nbuild --force_python=py2\r\nbuild --host_force_python=py2\r\nbuild --python_path=\"/usr/bin/python\"\r\nbuild --define with_jemalloc=true\r\nbuild --define with_gcp_support=true\r\nbuild --define with_hdfs_support=true\r\nbuild --define with_s3_support=true\r\nbuild:kafka --define with_kafka_support=true\r\nbuild:xla --define with_xla_support=true\r\nbuild:gdr --define with_gdr_support=true\r\nbuild:verbs --define with_verbs_support=true\r\nbuild --action_env TF_NEED_OPENCL_SYCL=\"0\"\r\nbuild --action_env TF_NEED_CUDA=\"1\"\r\nbuild --action_env CUDA_TOOLKIT_PATH=\"/usr/local/cuda\"\r\nbuild --action_env TF_CUDA_VERSION=\"9.0\"\r\nbuild --action_env CUDNN_INSTALL_PATH=\"/usr/lib/aarch64-linux-gnu\"\r\nbuild --action_env TF_CUDNN_VERSION=\"7\"\r\nbuild --action_env TENSORRT_INSTALL_PATH=\"/usr/lib/aarch64-linux-gnu\"\r\nbuild --action_env TF_TENSORRT_VERSION=\"4.0.4\"\r\nbuild --action_env TF_CUDA_COMPUTE_CAPABILITIES=\"3.5,5.2\"\r\nbuild --action_env LD_LIBRARY_PATH=\"/usr/local/cuda-9.0/lib64:\"\r\nbuild --action_env TF_CUDA_CLANG=\"0\"\r\nbuild --action_env GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\r\nbuild --config=cuda\r\ntest --config=cuda\r\nbuild --define grpc_no_ares=true\r\nbuild:opt --copt=-march=native\r\nbuild:opt --host_copt=-march=native\r\nbuild:opt --define with_default_optimizations=true\r\nbuild --copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK\r\nbuild --host_copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK\r\n```\r\nWhen building pip package:\r\n```\r\n.........................\r\nERROR: Skipping 'tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'build_defs.bzl': no such package '@local_config_tensorrt//': Traceback (most recent call last):\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 167\r\n\t\t_trt_lib_version(repository_ctx, trt_install_path)\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 77, in _trt_lib_version\r\n\t\t_find_trt_header_dir(repository_ctx, trt_install_path)\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in _find_trt_header_dir\r\n\t\tstr(repository_ctx.path((\"%s/../incl...)\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in str\r\n\t\trepository_ctx.path((\"%s/../include\" % trt_install_path)).realpath\r\n/usr/lib/include (No such file or directory)\r\nWARNING: Target pattern parsing failed.\r\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'build_defs.bzl': no such package '@local_config_tensorrt//': Traceback (most recent call last):\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 167\r\n\t\t_trt_lib_version(repository_ctx, trt_install_path)\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 77, in _trt_lib_version\r\n\t\t_find_trt_header_dir(repository_ctx, trt_install_path)\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in _find_trt_header_dir\r\n\t\tstr(repository_ctx.path((\"%s/../incl...)\r\n\tFile \"/home/nvidia/sourcecode/tensorflow/third_party/tensorrt/tensorrt_configure.bzl\", line 60, in str\r\n\t\trepository_ctx.path((\"%s/../include\" % trt_install_path)).realpath\r\n/usr/lib/include (No such file or directory)\r\n```\r\nWithout TensorRT support it compiles well.\r\n"}