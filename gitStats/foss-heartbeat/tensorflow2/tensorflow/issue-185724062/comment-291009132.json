{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/291009132", "html_url": "https://github.com/tensorflow/tensorflow/issues/5243#issuecomment-291009132", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5243", "id": 291009132, "node_id": "MDEyOklzc3VlQ29tbWVudDI5MTAwOTEzMg==", "user": {"login": "vashat", "id": 1157672, "node_id": "MDQ6VXNlcjExNTc2NzI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1157672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vashat", "html_url": "https://github.com/vashat", "followers_url": "https://api.github.com/users/vashat/followers", "following_url": "https://api.github.com/users/vashat/following{/other_user}", "gists_url": "https://api.github.com/users/vashat/gists{/gist_id}", "starred_url": "https://api.github.com/users/vashat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vashat/subscriptions", "organizations_url": "https://api.github.com/users/vashat/orgs", "repos_url": "https://api.github.com/users/vashat/repos", "events_url": "https://api.github.com/users/vashat/events{/privacy}", "received_events_url": "https://api.github.com/users/vashat/received_events", "type": "User", "site_admin": false}, "created_at": "2017-04-02T19:32:17Z", "updated_at": "2017-04-02T19:32:17Z", "author_association": "NONE", "body_html": "<p>I'm having the same issue trying to do the same thing. Here's my full stack backtrace of the error:</p>\n<p>`Traceback (most recent call last):<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1022, in _do_call<br>\nreturn fn(*args)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1004, in _run_fn<br>\nstatus, run_metadata)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 66, in <strong>exit</strong><br>\nnext(self.gen)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status<br>\npywrap_tensorflow.TF_GetCode(status))<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]<br>\n[[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"test.py\", line 51, in <br>\nevaluate_images(images)<br>\nFile \"test.py\", line 17, in evaluate_images<br>\nload_trained_model(logit)<br>\nFile \"test.py\", line 26, in load_trained_model<br>\nsaver.restore(sess, ckpt.model_checkpoint_path)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1439, in restore<br>\n{self.saver_def.filename_tensor_name: save_path})<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 767, in run<br>\nrun_metadata_ptr)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 965, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]<br>\n[[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]</p>\n<p>Caused by op 'save/Assign_5', defined at:<br>\nFile \"test.py\", line 51, in <br>\nevaluate_images(images)<br>\nFile \"test.py\", line 17, in evaluate_images<br>\nload_trained_model(logit)<br>\nFile \"test.py\", line 25, in load_trained_model<br>\nsaver = tf.train.Saver()<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1051, in <strong>init</strong><br>\nself.build()<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1081, in build<br>\nrestore_sequentially=self._restore_sequentially)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 675, in build<br>\nrestore_sequentially, reshape)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 414, in _AddRestoreOps<br>\nassign_ops.append(saveable.restore(tensors, shapes))<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 155, in restore<br>\nself.op.get_shape().is_fully_defined())<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/ops/gen_state_ops.py\", line 47, in assign<br>\nuse_locking=use_locking, name=name)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op<br>\nop_def=op_def)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op<br>\noriginal_op=self._default_original_op, op_def=op_def)<br>\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1264, in <strong>init</strong><br>\nself._traceback = _extract_stack()</p>\n<p>InvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]<br>\n[[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]<br>\n`</p>", "body_text": "I'm having the same issue trying to do the same thing. Here's my full stack backtrace of the error:\n`Traceback (most recent call last):\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1022, in _do_call\nreturn fn(*args)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1004, in _run_fn\nstatus, run_metadata)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 66, in exit\nnext(self.gen)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\npywrap_tensorflow.TF_GetCode(status))\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]\n[[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"test.py\", line 51, in \nevaluate_images(images)\nFile \"test.py\", line 17, in evaluate_images\nload_trained_model(logit)\nFile \"test.py\", line 26, in load_trained_model\nsaver.restore(sess, ckpt.model_checkpoint_path)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1439, in restore\n{self.saver_def.filename_tensor_name: save_path})\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 767, in run\nrun_metadata_ptr)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 965, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\ntarget_list, options, run_metadata)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]\n[[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]\nCaused by op 'save/Assign_5', defined at:\nFile \"test.py\", line 51, in \nevaluate_images(images)\nFile \"test.py\", line 17, in evaluate_images\nload_trained_model(logit)\nFile \"test.py\", line 25, in load_trained_model\nsaver = tf.train.Saver()\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1051, in init\nself.build()\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1081, in build\nrestore_sequentially=self._restore_sequentially)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 675, in build\nrestore_sequentially, reshape)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 414, in _AddRestoreOps\nassign_ops.append(saveable.restore(tensors, shapes))\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 155, in restore\nself.op.get_shape().is_fully_defined())\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/ops/gen_state_ops.py\", line 47, in assign\nuse_locking=use_locking, name=name)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\nop_def=op_def)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\noriginal_op=self._default_original_op, op_def=op_def)\nFile \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1264, in init\nself._traceback = _extract_stack()\nInvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]\n[[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]\n`", "body": "I'm having the same issue trying to do the same thing. Here's my full stack backtrace of the error:\r\n\r\n`Traceback (most recent call last):\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1022, in _do_call\r\n    return fn(*args)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1004, in _run_fn\r\n    status, run_metadata)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py\", line 66, in __exit__\r\n    next(self.gen)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py\", line 469, in raise_exception_on_not_ok_status\r\n    pywrap_tensorflow.TF_GetCode(status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]\r\n\t [[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 51, in <module>\r\n    evaluate_images(images)\r\n  File \"test.py\", line 17, in evaluate_images\r\n    load_trained_model(logit)\r\n  File \"test.py\", line 26, in load_trained_model\r\n    saver.restore(sess, ckpt.model_checkpoint_path)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1439, in restore\r\n    {self.saver_def.filename_tensor_name: save_path})\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 767, in run\r\n    run_metadata_ptr)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 965, in _run\r\n    feed_dict_string, options, run_metadata)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1015, in _do_run\r\n    target_list, options, run_metadata)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1035, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]\r\n\t [[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]\r\n\r\nCaused by op 'save/Assign_5', defined at:\r\n  File \"test.py\", line 51, in <module>\r\n    evaluate_images(images)\r\n  File \"test.py\", line 17, in evaluate_images\r\n    load_trained_model(logit)\r\n  File \"test.py\", line 25, in load_trained_model\r\n    saver = tf.train.Saver()\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1051, in __init__\r\n    self.build()\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1081, in build\r\n    restore_sequentially=self._restore_sequentially)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 675, in build\r\n    restore_sequentially, reshape)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 414, in _AddRestoreOps\r\n    assign_ops.append(saveable.restore(tensors, shapes))\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 155, in restore\r\n    self.op.get_shape().is_fully_defined())\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/ops/gen_state_ops.py\", line 47, in assign\r\n    use_locking=use_locking, name=name)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 763, in apply_op\r\n    op_def=op_def)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 2395, in create_op\r\n    original_op=self._default_original_op, op_def=op_def)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1264, in __init__\r\n    self._traceback = _extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [18,384] rhs shape= [2304,384]\r\n\t [[Node: save/Assign_5 = Assign[T=DT_FLOAT, _class=[\"loc:@local3/weights\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](local3/weights, save/RestoreV2_5)]]\r\n`"}