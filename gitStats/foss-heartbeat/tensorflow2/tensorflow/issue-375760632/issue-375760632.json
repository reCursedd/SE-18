{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23391", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23391/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23391/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23391/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23391", "id": 375760632, "node_id": "MDU6SXNzdWUzNzU3NjA2MzI=", "number": 23391, "title": "Is the tensorflow framework wrong?", "user": {"login": "zhouhao-learning", "id": 24581773, "node_id": "MDQ6VXNlcjI0NTgxNzcz", "avatar_url": "https://avatars1.githubusercontent.com/u/24581773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhouhao-learning", "html_url": "https://github.com/zhouhao-learning", "followers_url": "https://api.github.com/users/zhouhao-learning/followers", "following_url": "https://api.github.com/users/zhouhao-learning/following{/other_user}", "gists_url": "https://api.github.com/users/zhouhao-learning/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhouhao-learning/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhouhao-learning/subscriptions", "organizations_url": "https://api.github.com/users/zhouhao-learning/orgs", "repos_url": "https://api.github.com/users/zhouhao-learning/repos", "events_url": "https://api.github.com/users/zhouhao-learning/events{/privacy}", "received_events_url": "https://api.github.com/users/zhouhao-learning/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "harshini-gadige", "id": 42781361, "node_id": "MDQ6VXNlcjQyNzgxMzYx", "avatar_url": "https://avatars1.githubusercontent.com/u/42781361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshini-gadige", "html_url": "https://github.com/harshini-gadige", "followers_url": "https://api.github.com/users/harshini-gadige/followers", "following_url": "https://api.github.com/users/harshini-gadige/following{/other_user}", "gists_url": "https://api.github.com/users/harshini-gadige/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshini-gadige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshini-gadige/subscriptions", "organizations_url": "https://api.github.com/users/harshini-gadige/orgs", "repos_url": "https://api.github.com/users/harshini-gadige/repos", "events_url": "https://api.github.com/users/harshini-gadige/events{/privacy}", "received_events_url": "https://api.github.com/users/harshini-gadige/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "harshini-gadige", "id": 42781361, "node_id": "MDQ6VXNlcjQyNzgxMzYx", "avatar_url": "https://avatars1.githubusercontent.com/u/42781361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshini-gadige", "html_url": "https://github.com/harshini-gadige", "followers_url": "https://api.github.com/users/harshini-gadige/followers", "following_url": "https://api.github.com/users/harshini-gadige/following{/other_user}", "gists_url": "https://api.github.com/users/harshini-gadige/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshini-gadige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshini-gadige/subscriptions", "organizations_url": "https://api.github.com/users/harshini-gadige/orgs", "repos_url": "https://api.github.com/users/harshini-gadige/repos", "events_url": "https://api.github.com/users/harshini-gadige/events{/privacy}", "received_events_url": "https://api.github.com/users/harshini-gadige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-10-31T01:28:14Z", "updated_at": "2018-11-13T21:39:15Z", "closed_at": "2018-11-13T21:39:15Z", "author_association": "NONE", "body_html": "<p>When I use the tensorflow framework to train my model through the CPU, I get an tensorflow unexpected error.Error is as follows:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1361, in _do_call\n    return fn(*args)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1340, in _run_fn\n    target_list, status, run_metadata)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/worker/bin/run.py\", line 375, in task_main\n    await module_run(api) if iscoroutinefunction(module_run) else module_run(api)\n  File \"/worker/package/smiles_package_DAG_qlaVw/train_model/__init__.py\", line 135, in run\n    callbacks=[processcallback])\n  File \"/worker/package/smiles_package_DAG_qlaVw/DAG_tensorgraph.py\", line 91, in fit_generator\n    fetched_values = self.session.run(fetches, feed_dict=train_generator)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 905, in run\n    run_metadata_ptr)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1137, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1355, in _do_run\n    options, run_metadata)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1374, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\n\nCaused by op 'DAGLayer_4/Relu', defined at:\n  File \"main.py\", line 32, in &lt;module&gt;\n    main()\n  File \"main.py\", line 28, in main\n    router.task_run()\n  File \"/worker/bin/router.py\", line 129, in task_run\n    p.start()\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 105, in start\n    self._popen = self._Popen(self)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/context.py\", line 223, in _Popen\n    return _default_context.get_context().Process._Popen(process_obj)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/context.py\", line 277, in _Popen\n    return Popen(process_obj)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/popen_fork.py\", line 26, in __init__\n    self._launch(process_obj)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/popen_fork.py\", line 80, in _launch\n    code = process_obj._bootstrap()\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\n    self.run()\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 93, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/worker/bin/router.py\", line 111, in run_worker\n    run([worker])\n  File \"/atlas/home/test/.local/lib/python3.6/site-packages/autobahn/asyncio/component.py\", line 373, in run\n    loop.run_forever()\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/base_events.py\", line 421, in run_forever\n    self._run_once()\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/base_events.py\", line 1431, in _run_once\n    handle._run()\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/events.py\", line 145, in _run\n    self._callback(*self._args)\n  File \"/worker/bin/router.py\", line 38, in onJoin\n    api = await task_main(task_id)\n  File \"/worker/bin/run.py\", line 375, in task_main\n    await module_run(api) if iscoroutinefunction(module_run) else module_run(api)\n  File \"/worker/package/smiles_package_DAG_qlaVw/train_model/__init__.py\", line 115, in run\n    model = DAG_fit.load_from_dir(model_dir)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 818, in load_from_dir\n    tensorgraph.restore()\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 785, in restore\n    self.build()\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 476, in build\n    layer.create_tensor(training=self._training_placeholder)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/graph_layers.py\", line 686, in create_tensor\n    batch_outputs = self.DAGgraph_step(batch_inputs, self.W_list, self.b_list)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/graph_layers.py\", line 705, in DAGgraph_step\n    outputs = self.activation(outputs)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/activations.py\", line 96, in relu\n    return model_ops.relu(x, alpha=alpha, max_value=max_value)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/model_ops.py\", line 516, in relu\n    x = tf.nn.relu(x)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 4331, in relu\n    \"Relu\", features=features, name=name)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3271, in create_op\n    op_def=op_def)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1650, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nAbortedError (see above for traceback): Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\n</code></pre>\n<p>I managed to train this model on my GPU by running a model built by tensorflow, but I got this unexpected error when I used CPU training.</p>\n<p>Why can't I train on the CPU? My version of tensorflow is 1.6, please give me some guidance, thank you!</p>", "body_text": "When I use the tensorflow framework to train my model through the CPU, I get an tensorflow unexpected error.Error is as follows:\nTraceback (most recent call last):\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1361, in _do_call\n    return fn(*args)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1340, in _run_fn\n    target_list, status, run_metadata)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/worker/bin/run.py\", line 375, in task_main\n    await module_run(api) if iscoroutinefunction(module_run) else module_run(api)\n  File \"/worker/package/smiles_package_DAG_qlaVw/train_model/__init__.py\", line 135, in run\n    callbacks=[processcallback])\n  File \"/worker/package/smiles_package_DAG_qlaVw/DAG_tensorgraph.py\", line 91, in fit_generator\n    fetched_values = self.session.run(fetches, feed_dict=train_generator)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 905, in run\n    run_metadata_ptr)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1137, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1355, in _do_run\n    options, run_metadata)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1374, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\n\nCaused by op 'DAGLayer_4/Relu', defined at:\n  File \"main.py\", line 32, in <module>\n    main()\n  File \"main.py\", line 28, in main\n    router.task_run()\n  File \"/worker/bin/router.py\", line 129, in task_run\n    p.start()\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 105, in start\n    self._popen = self._Popen(self)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/context.py\", line 223, in _Popen\n    return _default_context.get_context().Process._Popen(process_obj)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/context.py\", line 277, in _Popen\n    return Popen(process_obj)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/popen_fork.py\", line 26, in __init__\n    self._launch(process_obj)\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/popen_fork.py\", line 80, in _launch\n    code = process_obj._bootstrap()\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\n    self.run()\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 93, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/worker/bin/router.py\", line 111, in run_worker\n    run([worker])\n  File \"/atlas/home/test/.local/lib/python3.6/site-packages/autobahn/asyncio/component.py\", line 373, in run\n    loop.run_forever()\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/base_events.py\", line 421, in run_forever\n    self._run_once()\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/base_events.py\", line 1431, in _run_once\n    handle._run()\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/events.py\", line 145, in _run\n    self._callback(*self._args)\n  File \"/worker/bin/router.py\", line 38, in onJoin\n    api = await task_main(task_id)\n  File \"/worker/bin/run.py\", line 375, in task_main\n    await module_run(api) if iscoroutinefunction(module_run) else module_run(api)\n  File \"/worker/package/smiles_package_DAG_qlaVw/train_model/__init__.py\", line 115, in run\n    model = DAG_fit.load_from_dir(model_dir)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 818, in load_from_dir\n    tensorgraph.restore()\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 785, in restore\n    self.build()\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 476, in build\n    layer.create_tensor(training=self._training_placeholder)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/graph_layers.py\", line 686, in create_tensor\n    batch_outputs = self.DAGgraph_step(batch_inputs, self.W_list, self.b_list)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/graph_layers.py\", line 705, in DAGgraph_step\n    outputs = self.activation(outputs)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/activations.py\", line 96, in relu\n    return model_ops.relu(x, alpha=alpha, max_value=max_value)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/model_ops.py\", line 516, in relu\n    x = tf.nn.relu(x)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 4331, in relu\n    \"Relu\", features=features, name=name)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3271, in create_op\n    op_def=op_def)\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1650, in __init__\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\n\nAbortedError (see above for traceback): Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\n\nI managed to train this model on my GPU by running a model built by tensorflow, but I got this unexpected error when I used CPU training.\nWhy can't I train on the CPU? My version of tensorflow is 1.6, please give me some guidance, thank you!", "body": "When I use the tensorflow framework to train my model through the CPU, I get an tensorflow unexpected error.Error is as follows:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1361, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1340, in _run_fn\r\n    target_list, status, run_metadata)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\r\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/worker/bin/run.py\", line 375, in task_main\r\n    await module_run(api) if iscoroutinefunction(module_run) else module_run(api)\r\n  File \"/worker/package/smiles_package_DAG_qlaVw/train_model/__init__.py\", line 135, in run\r\n    callbacks=[processcallback])\r\n  File \"/worker/package/smiles_package_DAG_qlaVw/DAG_tensorgraph.py\", line 91, in fit_generator\r\n    fetched_values = self.session.run(fetches, feed_dict=train_generator)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 905, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1137, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1355, in _do_run\r\n    options, run_metadata)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1374, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\r\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\r\n\r\nCaused by op 'DAGLayer_4/Relu', defined at:\r\n  File \"main.py\", line 32, in <module>\r\n    main()\r\n  File \"main.py\", line 28, in main\r\n    router.task_run()\r\n  File \"/worker/bin/router.py\", line 129, in task_run\r\n    p.start()\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 105, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/context.py\", line 223, in _Popen\r\n    return _default_context.get_context().Process._Popen(process_obj)\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/context.py\", line 277, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/popen_fork.py\", line 26, in __init__\r\n    self._launch(process_obj)\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/popen_fork.py\", line 80, in _launch\r\n    code = process_obj._bootstrap()\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"/usr/local/anaconda3/lib/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/worker/bin/router.py\", line 111, in run_worker\r\n    run([worker])\r\n  File \"/atlas/home/test/.local/lib/python3.6/site-packages/autobahn/asyncio/component.py\", line 373, in run\r\n    loop.run_forever()\r\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/base_events.py\", line 421, in run_forever\r\n    self._run_once()\r\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/base_events.py\", line 1431, in _run_once\r\n    handle._run()\r\n  File \"/usr/local/anaconda3/lib/python3.6/asyncio/events.py\", line 145, in _run\r\n    self._callback(*self._args)\r\n  File \"/worker/bin/router.py\", line 38, in onJoin\r\n    api = await task_main(task_id)\r\n  File \"/worker/bin/run.py\", line 375, in task_main\r\n    await module_run(api) if iscoroutinefunction(module_run) else module_run(api)\r\n  File \"/worker/package/smiles_package_DAG_qlaVw/train_model/__init__.py\", line 115, in run\r\n    model = DAG_fit.load_from_dir(model_dir)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 818, in load_from_dir\r\n    tensorgraph.restore()\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 785, in restore\r\n    self.build()\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/tensor_graph.py\", line 476, in build\r\n    layer.create_tensor(training=self._training_placeholder)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/graph_layers.py\", line 686, in create_tensor\r\n    batch_outputs = self.DAGgraph_step(batch_inputs, self.W_list, self.b_list)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/graph_layers.py\", line 705, in DAGgraph_step\r\n    outputs = self.activation(outputs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/activations.py\", line 96, in relu\r\n    return model_ops.relu(x, alpha=alpha, max_value=max_value)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/deepchem/models/tensorgraph/model_ops.py\", line 516, in relu\r\n    x = tf.nn.relu(x)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 4331, in relu\r\n    \"Relu\", features=features, name=name)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3271, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1650, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nAbortedError (see above for traceback): Operation received an exception:Status: 5, message: could not create a eltwise forward primitive descriptor, in file tensorflow/core/kernels/mkl_relu_op.cc:457\r\n\t [[Node: DAGLayer_4/Relu = _MklRelu[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](DAGLayer_4/xw_plus_b, DMT/_8)]]\r\n```\r\n\r\nI managed to train this model on my GPU by running a model built by tensorflow, but I got this unexpected error when I used CPU training.\r\n\r\nWhy can't I train on the CPU? My version of tensorflow is 1.6, please give me some guidance, thank you!"}