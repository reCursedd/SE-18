{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3586", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3586/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3586/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3586/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3586", "id": 168466295, "node_id": "MDU6SXNzdWUxNjg0NjYyOTU=", "number": 3586, "title": "Bug involving tf.train.Saver and num_epochs parameter in tf.train.string_input_producer", "user": {"login": "siddMahen", "id": 823940, "node_id": "MDQ6VXNlcjgyMzk0MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/823940?v=4", "gravatar_id": "", "url": "https://api.github.com/users/siddMahen", "html_url": "https://github.com/siddMahen", "followers_url": "https://api.github.com/users/siddMahen/followers", "following_url": "https://api.github.com/users/siddMahen/following{/other_user}", "gists_url": "https://api.github.com/users/siddMahen/gists{/gist_id}", "starred_url": "https://api.github.com/users/siddMahen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/siddMahen/subscriptions", "organizations_url": "https://api.github.com/users/siddMahen/orgs", "repos_url": "https://api.github.com/users/siddMahen/repos", "events_url": "https://api.github.com/users/siddMahen/events{/privacy}", "received_events_url": "https://api.github.com/users/siddMahen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ilblackdragon", "id": 175486, "node_id": "MDQ6VXNlcjE3NTQ4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/175486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilblackdragon", "html_url": "https://github.com/ilblackdragon", "followers_url": "https://api.github.com/users/ilblackdragon/followers", "following_url": "https://api.github.com/users/ilblackdragon/following{/other_user}", "gists_url": "https://api.github.com/users/ilblackdragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilblackdragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilblackdragon/subscriptions", "organizations_url": "https://api.github.com/users/ilblackdragon/orgs", "repos_url": "https://api.github.com/users/ilblackdragon/repos", "events_url": "https://api.github.com/users/ilblackdragon/events{/privacy}", "received_events_url": "https://api.github.com/users/ilblackdragon/received_events", "type": "User", "site_admin": false}, {"login": "touts", "id": 15698149, "node_id": "MDQ6VXNlcjE1Njk4MTQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/15698149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/touts", "html_url": "https://github.com/touts", "followers_url": "https://api.github.com/users/touts/followers", "following_url": "https://api.github.com/users/touts/following{/other_user}", "gists_url": "https://api.github.com/users/touts/gists{/gist_id}", "starred_url": "https://api.github.com/users/touts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/touts/subscriptions", "organizations_url": "https://api.github.com/users/touts/orgs", "repos_url": "https://api.github.com/users/touts/repos", "events_url": "https://api.github.com/users/touts/events{/privacy}", "received_events_url": "https://api.github.com/users/touts/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-07-30T12:58:11Z", "updated_at": "2016-10-13T17:30:32Z", "closed_at": "2016-10-13T17:30:32Z", "author_association": "NONE", "body_html": "<p>I've run into a strange problem involving both <code>tf.train.Saver</code> and an input pipeline based on <code>tf.train.string_input_producer()</code>. It seems as though the <code>num_epochs</code> parameter to <code>tf.train.string_input_producer()</code> stops working as intended after loading a saved model.</p>\n<p>I'm currently using v0.8 but I suspect this is still an issue on v0.9 and above.</p>\n<h3>Environment info</h3>\n<p>Operating System: Mac OSX (10.11.6)<br>\nTensorflow version: 0.8<br>\npip version: 8.1.1</p>\n<h3>Steps to reproduce</h3>\n<p>1 - Create a new directory and add to it the files from the following gist: <a href=\"https://gist.github.com/6d730e1b3d331c4be34c9a57b0a39ccf\">https://gist.github.com/6d730e1b3d331c4be34c9a57b0a39ccf</a> . The <code>1.txt</code> and <code>2.txt</code> files simulate training data. The <code>training.py</code> file implements a simple input pipeline, taking in text files, and printing them line by line. Notice that the <code>num_epochs</code> parameter on line 28 is set to 1.</p>\n<p>2 - Run <code>$ python training.py test 1.txt</code>. The output should resemble the following:</p>\n<pre><code>The multiplying villanies of nature\nDo swarm upon him--from the western isles\nAnd fortune, on his damned quarrel smiling,\nShow'd like a rebel's whore: but all's too weak:\nFor brave Macbeth--well he deserves that name--\nModel saved to ./model-test-0\nAs two spent swimmers, that do cling together\nDisdaining fortune, with his brandish'd steel,\nAnd fix'd his head upon our battlements.\nLike valour's minion carved out his passage\nWhich smoked with bloody execution,\nModel saved to ./model-test-1\nTill he unseam'd him from the nave to the chaps,\nAnd choke their art. The merciless Macdonwald--\nOf kerns and gallowglasses is supplied;\nWorthy to be a rebel, for to that\nDoubtful it stood;\nModel saved to ./model-test-2\nDone training!\nModel saved to ./model-test-3\n</code></pre>\n<p>3 - Run <code>$ python training.py test 2.txt</code>. The output should be:</p>\n<pre><code>Done training!\nModel saved to ./model-test-3\n</code></pre>\n<p>4 - Now, change the <code>num_epochs</code> parameter on line 28 from 1 to 2, and run <code>$ python training.py test 2.txt</code> again. In this case, we have something that resembles:</p>\n<pre><code>Letting 'I dare not' wait upon 'I would,'\nAs thou art in desire? Wouldst thou have that\nSuch I account thy love. Art thou afeard\nWhich thou esteem'st the ornament of life,\nAnd wakes it now, to look so green and pale\nModel saved to ./model-test-3\nAnd live a coward in thine own esteem,\nAt what it did so freely? From this time\nLike the poor cat i' the adage?\nWherein you dress'd yourself? hath it slept since?\nTo be the same in thine own act and valour\nModel saved to ./model-test-4\nDone training!\nModel saved to ./model-test-5\n</code></pre>\n<p>5 - To cleanup, run <code>$ rm checkpoint model-test-*</code>.</p>\n<p>There are two problems: First, the model does not continue to \"train\" in step 3. Second, when the <code>num_epochs</code> parameter is modified and it does continue to train, it doesn't reproduce the input twice, as it should (step 4).</p>\n<p>Playing around with this, I notice that the initial value of <code>num_epochs</code> works as expected, e.g. if at step 1, <code>num_epochs</code> is set to 3, three copies of the input file will be produced. Further, step 4 yields similar results when the new value for <code>num_epochs</code> is larger than the previous value.</p>", "body_text": "I've run into a strange problem involving both tf.train.Saver and an input pipeline based on tf.train.string_input_producer(). It seems as though the num_epochs parameter to tf.train.string_input_producer() stops working as intended after loading a saved model.\nI'm currently using v0.8 but I suspect this is still an issue on v0.9 and above.\nEnvironment info\nOperating System: Mac OSX (10.11.6)\nTensorflow version: 0.8\npip version: 8.1.1\nSteps to reproduce\n1 - Create a new directory and add to it the files from the following gist: https://gist.github.com/6d730e1b3d331c4be34c9a57b0a39ccf . The 1.txt and 2.txt files simulate training data. The training.py file implements a simple input pipeline, taking in text files, and printing them line by line. Notice that the num_epochs parameter on line 28 is set to 1.\n2 - Run $ python training.py test 1.txt. The output should resemble the following:\nThe multiplying villanies of nature\nDo swarm upon him--from the western isles\nAnd fortune, on his damned quarrel smiling,\nShow'd like a rebel's whore: but all's too weak:\nFor brave Macbeth--well he deserves that name--\nModel saved to ./model-test-0\nAs two spent swimmers, that do cling together\nDisdaining fortune, with his brandish'd steel,\nAnd fix'd his head upon our battlements.\nLike valour's minion carved out his passage\nWhich smoked with bloody execution,\nModel saved to ./model-test-1\nTill he unseam'd him from the nave to the chaps,\nAnd choke their art. The merciless Macdonwald--\nOf kerns and gallowglasses is supplied;\nWorthy to be a rebel, for to that\nDoubtful it stood;\nModel saved to ./model-test-2\nDone training!\nModel saved to ./model-test-3\n\n3 - Run $ python training.py test 2.txt. The output should be:\nDone training!\nModel saved to ./model-test-3\n\n4 - Now, change the num_epochs parameter on line 28 from 1 to 2, and run $ python training.py test 2.txt again. In this case, we have something that resembles:\nLetting 'I dare not' wait upon 'I would,'\nAs thou art in desire? Wouldst thou have that\nSuch I account thy love. Art thou afeard\nWhich thou esteem'st the ornament of life,\nAnd wakes it now, to look so green and pale\nModel saved to ./model-test-3\nAnd live a coward in thine own esteem,\nAt what it did so freely? From this time\nLike the poor cat i' the adage?\nWherein you dress'd yourself? hath it slept since?\nTo be the same in thine own act and valour\nModel saved to ./model-test-4\nDone training!\nModel saved to ./model-test-5\n\n5 - To cleanup, run $ rm checkpoint model-test-*.\nThere are two problems: First, the model does not continue to \"train\" in step 3. Second, when the num_epochs parameter is modified and it does continue to train, it doesn't reproduce the input twice, as it should (step 4).\nPlaying around with this, I notice that the initial value of num_epochs works as expected, e.g. if at step 1, num_epochs is set to 3, three copies of the input file will be produced. Further, step 4 yields similar results when the new value for num_epochs is larger than the previous value.", "body": "I've run into a strange problem involving both `tf.train.Saver` and an input pipeline based on `tf.train.string_input_producer()`. It seems as though the `num_epochs` parameter to `tf.train.string_input_producer()` stops working as intended after loading a saved model.\n\nI'm currently using v0.8 but I suspect this is still an issue on v0.9 and above.\n### Environment info\n\nOperating System: Mac OSX (10.11.6)\nTensorflow version: 0.8\npip version: 8.1.1\n### Steps to reproduce\n\n1 - Create a new directory and add to it the files from the following gist: https://gist.github.com/6d730e1b3d331c4be34c9a57b0a39ccf . The `1.txt` and `2.txt` files simulate training data. The `training.py` file implements a simple input pipeline, taking in text files, and printing them line by line. Notice that the `num_epochs` parameter on line 28 is set to 1.\n\n2 - Run `$ python training.py test 1.txt`. The output should resemble the following: \n\n```\nThe multiplying villanies of nature\nDo swarm upon him--from the western isles\nAnd fortune, on his damned quarrel smiling,\nShow'd like a rebel's whore: but all's too weak:\nFor brave Macbeth--well he deserves that name--\nModel saved to ./model-test-0\nAs two spent swimmers, that do cling together\nDisdaining fortune, with his brandish'd steel,\nAnd fix'd his head upon our battlements.\nLike valour's minion carved out his passage\nWhich smoked with bloody execution,\nModel saved to ./model-test-1\nTill he unseam'd him from the nave to the chaps,\nAnd choke their art. The merciless Macdonwald--\nOf kerns and gallowglasses is supplied;\nWorthy to be a rebel, for to that\nDoubtful it stood;\nModel saved to ./model-test-2\nDone training!\nModel saved to ./model-test-3\n```\n\n3 - Run `$ python training.py test 2.txt`. The output should be:\n\n```\nDone training!\nModel saved to ./model-test-3\n```\n\n4 - Now, change the `num_epochs` parameter on line 28 from 1 to 2, and run `$ python training.py test 2.txt` again. In this case, we have something that resembles:\n\n```\nLetting 'I dare not' wait upon 'I would,'\nAs thou art in desire? Wouldst thou have that\nSuch I account thy love. Art thou afeard\nWhich thou esteem'st the ornament of life,\nAnd wakes it now, to look so green and pale\nModel saved to ./model-test-3\nAnd live a coward in thine own esteem,\nAt what it did so freely? From this time\nLike the poor cat i' the adage?\nWherein you dress'd yourself? hath it slept since?\nTo be the same in thine own act and valour\nModel saved to ./model-test-4\nDone training!\nModel saved to ./model-test-5\n```\n\n5 - To cleanup, run `$ rm checkpoint model-test-*`.\n\nThere are two problems: First, the model does not continue to \"train\" in step 3. Second, when the `num_epochs` parameter is modified and it does continue to train, it doesn't reproduce the input twice, as it should (step 4).\n\nPlaying around with this, I notice that the initial value of `num_epochs` works as expected, e.g. if at step 1, `num_epochs` is set to 3, three copies of the input file will be produced. Further, step 4 yields similar results when the new value for `num_epochs` is larger than the previous value.\n"}