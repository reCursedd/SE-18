{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/346278849", "html_url": "https://github.com/tensorflow/tensorflow/issues/14535#issuecomment-346278849", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14535", "id": 346278849, "node_id": "MDEyOklzc3VlQ29tbWVudDM0NjI3ODg0OQ==", "user": {"login": "phongnhhn92", "id": 11288381, "node_id": "MDQ6VXNlcjExMjg4Mzgx", "avatar_url": "https://avatars3.githubusercontent.com/u/11288381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phongnhhn92", "html_url": "https://github.com/phongnhhn92", "followers_url": "https://api.github.com/users/phongnhhn92/followers", "following_url": "https://api.github.com/users/phongnhhn92/following{/other_user}", "gists_url": "https://api.github.com/users/phongnhhn92/gists{/gist_id}", "starred_url": "https://api.github.com/users/phongnhhn92/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phongnhhn92/subscriptions", "organizations_url": "https://api.github.com/users/phongnhhn92/orgs", "repos_url": "https://api.github.com/users/phongnhhn92/repos", "events_url": "https://api.github.com/users/phongnhhn92/events{/privacy}", "received_events_url": "https://api.github.com/users/phongnhhn92/received_events", "type": "User", "site_admin": false}, "created_at": "2017-11-22T08:32:48Z", "updated_at": "2017-11-22T08:32:48Z", "author_association": "NONE", "body_html": "<p>Also I would like to update what I have done so far.<br>\nWith my trained model, using the following command I can have the same results on both PC and android version.<br>\n<code>bazel-bin/tensorflow/tools/graph_transforms/transform_graph \\ --in_graph=frozen_inference_graph.pb \\ --out_graph=optimized_SSD_graph.pb \\ --inputs='image_tensor' \\ --outputs='num_detections,detection_boxes,detection_scores,detection_classes' \\ --transforms='   sort_by_execution_order fold_batch_norms fold_old_batch_norms strip_unused_nodes round_weights(num_steps=256)'</code><br>\nHowever if I add 'quantize_weights' graph transformation then I almost can not detect anything (zero bounding box detected)<br>\n<code>bazel-bin/tensorflow/tools/graph_transforms/transform_graph \\ --in_graph=frozen_inference_graph.pb \\ --out_graph=optimized_SSD_graph.pb \\ --inputs='image_tensor' \\ --outputs='num_detections,detection_boxes,detection_scores,detection_classes' \\ --transforms='   sort_by_execution_order fold_batch_norms fold_old_batch_norms strip_unused_nodes round_weights(num_steps=256) quantize_weights'</code></p>", "body_text": "Also I would like to update what I have done so far.\nWith my trained model, using the following command I can have the same results on both PC and android version.\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\ --in_graph=frozen_inference_graph.pb \\ --out_graph=optimized_SSD_graph.pb \\ --inputs='image_tensor' \\ --outputs='num_detections,detection_boxes,detection_scores,detection_classes' \\ --transforms='   sort_by_execution_order fold_batch_norms fold_old_batch_norms strip_unused_nodes round_weights(num_steps=256)'\nHowever if I add 'quantize_weights' graph transformation then I almost can not detect anything (zero bounding box detected)\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\ --in_graph=frozen_inference_graph.pb \\ --out_graph=optimized_SSD_graph.pb \\ --inputs='image_tensor' \\ --outputs='num_detections,detection_boxes,detection_scores,detection_classes' \\ --transforms='   sort_by_execution_order fold_batch_norms fold_old_batch_norms strip_unused_nodes round_weights(num_steps=256) quantize_weights'", "body": "Also I would like to update what I have done so far.\r\nWith my trained model, using the following command I can have the same results on both PC and android version.\r\n`\r\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\\r\n--in_graph=frozen_inference_graph.pb \\\r\n--out_graph=optimized_SSD_graph.pb \\\r\n--inputs='image_tensor' \\\r\n--outputs='num_detections,detection_boxes,detection_scores,detection_classes' \\\r\n--transforms='  \r\n  sort_by_execution_order\r\n  fold_batch_norms\r\n  fold_old_batch_norms\r\n  strip_unused_nodes\r\n  round_weights(num_steps=256)'\r\n`\r\nHowever if I add 'quantize_weights' graph transformation then I almost can not detect anything (zero bounding box detected)\r\n`\r\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\\r\n--in_graph=frozen_inference_graph.pb \\\r\n--out_graph=optimized_SSD_graph.pb \\\r\n--inputs='image_tensor' \\\r\n--outputs='num_detections,detection_boxes,detection_scores,detection_classes' \\\r\n--transforms='  \r\n  sort_by_execution_order\r\n  fold_batch_norms\r\n  fold_old_batch_norms\r\n  strip_unused_nodes\r\n  round_weights(num_steps=256)\r\n  quantize_weights'\r\n`\r\n"}