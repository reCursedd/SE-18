{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23145", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23145/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23145/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23145/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23145", "id": 372291096, "node_id": "MDU6SXNzdWUzNzIyOTEwOTY=", "number": 23145, "title": "Could not initialize a memory descriptor when using softmax layer", "user": {"login": "kawaiiQ", "id": 10705175, "node_id": "MDQ6VXNlcjEwNzA1MTc1", "avatar_url": "https://avatars2.githubusercontent.com/u/10705175?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kawaiiQ", "html_url": "https://github.com/kawaiiQ", "followers_url": "https://api.github.com/users/kawaiiQ/followers", "following_url": "https://api.github.com/users/kawaiiQ/following{/other_user}", "gists_url": "https://api.github.com/users/kawaiiQ/gists{/gist_id}", "starred_url": "https://api.github.com/users/kawaiiQ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kawaiiQ/subscriptions", "organizations_url": "https://api.github.com/users/kawaiiQ/orgs", "repos_url": "https://api.github.com/users/kawaiiQ/repos", "events_url": "https://api.github.com/users/kawaiiQ/events{/privacy}", "received_events_url": "https://api.github.com/users/kawaiiQ/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1104829434, "node_id": "MDU6TGFiZWwxMTA0ODI5NDM0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:mkl", "name": "comp:mkl", "color": "0052cc", "default": false}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false}, {"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-10-21T08:22:20Z", "updated_at": "2018-11-22T23:36:54Z", "closed_at": null, "author_association": "NONE", "body_html": "<p>I have both CPU and GPU version installed by Miniconda, each with a unique environment. While GPU version works fine, the CPU version seems to throw an error when I try to add a softmax layer after a convolution layer.</p>\n<p><strong>System information</strong></p>\n<ul>\n<li>Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes</li>\n<li>OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Manjaro 4.14.74</li>\n<li>TensorFlow installed from (source or binary): binary from Miniconda</li>\n<li>TensorFlow version (use command below): 1.11.0</li>\n<li>Python version: Python 3.6.6 :: Anaconda, Inc.</li>\n<li>CUDA/cuDNN version: CPU version, no CUDA/cuDNN</li>\n<li>Bazel version: N/A</li>\n<li>GPU model and memory: N/A</li>\n<li>Mobile device: N/A</li>\n<li>Exact command to reproduce: python code.py</li>\n</ul>\n<p><strong>Describe the current behavior</strong></p>\n<p>Run the test code, the program throws AbortedError, info is:</p>\n<pre><code>AbortedError (see above for traceback): Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n\t [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n</code></pre>\n<p><strong>Describe the expected behavior</strong></p>\n<p>The program should finish with no error.</p>\n<p><strong>Code to reproduce the issue</strong></p>\n<pre><code>import tensorflow as tf\nimport numpy as np\n\nsess = tf.Session()\ninputs = tf.placeholder(dtype=tf.float32, shape=(1, 300, 300, 3))\nnet = tf.layers.Conv2D(filters=2, kernel_size=3)(inputs)\nnet = tf.nn.softmax(net, axis=-1)\nsess.run(tf.global_variables_initializer())\nsess.run(net, feed_dict={inputs: np.zeros(shape=(1, 300, 300, 3), dtype=np.float32)})\n</code></pre>\n<p><strong>Other info / logs</strong></p>\n<ul>\n<li>\n<p>I set up the environment by <code>conda create -n xxx pip python=3 tensorflow</code></p>\n</li>\n<li>\n<p>Traceback is:</p>\n</li>\n</ul>\n<pre><code>Traceback (most recent call last):\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1292, in _do_call\n    return fn(*args)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1277, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1367, in _call_tf_sessionrun\n    run_metadata)\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"test.py\", line 10, in &lt;module&gt;\n    sess.run(net, feed_dict={inputs: np.zeros(shape=(1, 300, 300, 3), dtype=np.float32)})\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 887, in run\n    run_metadata_ptr)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\n    run_metadata)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n\nCaused by op 'Softmax', defined at:\n  File \"test.py\", line 7, in &lt;module&gt;\n    net = tf.nn.softmax(net, axis=-1)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 1746, in softmax\n    return _softmax(logits, gen_nn_ops.softmax, axis, name)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 1685, in _softmax\n    return compute_op(logits, name=name)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 7138, in softmax\n    \"Softmax\", logits=logits, name=name)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3272, in create_op\n    op_def=op_def)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1768, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nAbortedError (see above for traceback): Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n</code></pre>\n<ul>\n<li>\n<p>GPU version works fine.</p>\n</li>\n<li>\n<p>If i set axis to 0, 1 or 2, the program finishes with no error, but with it set to  -1 or 3, the error occurs.</p>\n</li>\n<li>\n<p>If the softmax layer is added after a dense layer, it also works fine.</p>\n</li>\n<li>\n<p>I've also tested on another server with CentOS 7 and a Quadro P2000, the problem still occurs. (GPU version works fine while CPU version not)</p>\n</li>\n<li>\n<p>This code still not work:</p>\n</li>\n</ul>\n<pre><code>net = tf.layers.Conv2D(filters=2, kernel_size=3, activation=tf.nn.softmax)(inputs)\n</code></pre>", "body_text": "I have both CPU and GPU version installed by Miniconda, each with a unique environment. While GPU version works fine, the CPU version seems to throw an error when I try to add a softmax layer after a convolution layer.\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Manjaro 4.14.74\nTensorFlow installed from (source or binary): binary from Miniconda\nTensorFlow version (use command below): 1.11.0\nPython version: Python 3.6.6 :: Anaconda, Inc.\nCUDA/cuDNN version: CPU version, no CUDA/cuDNN\nBazel version: N/A\nGPU model and memory: N/A\nMobile device: N/A\nExact command to reproduce: python code.py\n\nDescribe the current behavior\nRun the test code, the program throws AbortedError, info is:\nAbortedError (see above for traceback): Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n\t [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n\nDescribe the expected behavior\nThe program should finish with no error.\nCode to reproduce the issue\nimport tensorflow as tf\nimport numpy as np\n\nsess = tf.Session()\ninputs = tf.placeholder(dtype=tf.float32, shape=(1, 300, 300, 3))\nnet = tf.layers.Conv2D(filters=2, kernel_size=3)(inputs)\nnet = tf.nn.softmax(net, axis=-1)\nsess.run(tf.global_variables_initializer())\nsess.run(net, feed_dict={inputs: np.zeros(shape=(1, 300, 300, 3), dtype=np.float32)})\n\nOther info / logs\n\n\nI set up the environment by conda create -n xxx pip python=3 tensorflow\n\n\nTraceback is:\n\n\nTraceback (most recent call last):\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1292, in _do_call\n    return fn(*args)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1277, in _run_fn\n    options, feed_dict, fetch_list, target_list, run_metadata)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1367, in _call_tf_sessionrun\n    run_metadata)\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"test.py\", line 10, in <module>\n    sess.run(net, feed_dict={inputs: np.zeros(shape=(1, 300, 300, 3), dtype=np.float32)})\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 887, in run\n    run_metadata_ptr)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\n    feed_dict_tensor, options, run_metadata)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\n    run_metadata)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\n    raise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n\nCaused by op 'Softmax', defined at:\n  File \"test.py\", line 7, in <module>\n    net = tf.nn.softmax(net, axis=-1)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 1746, in softmax\n    return _softmax(logits, gen_nn_ops.softmax, axis, name)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 1685, in _softmax\n    return compute_op(logits, name=name)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 7138, in softmax\n    \"Softmax\", logits=logits, name=name)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\n    op_def=op_def)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\n    return func(*args, **kwargs)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3272, in create_op\n    op_def=op_def)\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1768, in __init__\n    self._traceback = tf_stack.extract_stack()\n\nAbortedError (see above for traceback): Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\n\n\n\nGPU version works fine.\n\n\nIf i set axis to 0, 1 or 2, the program finishes with no error, but with it set to  -1 or 3, the error occurs.\n\n\nIf the softmax layer is added after a dense layer, it also works fine.\n\n\nI've also tested on another server with CentOS 7 and a Quadro P2000, the problem still occurs. (GPU version works fine while CPU version not)\n\n\nThis code still not work:\n\n\nnet = tf.layers.Conv2D(filters=2, kernel_size=3, activation=tf.nn.softmax)(inputs)", "body": "I have both CPU and GPU version installed by Miniconda, each with a unique environment. While GPU version works fine, the CPU version seems to throw an error when I try to add a softmax layer after a convolution layer.\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Manjaro 4.14.74\r\n- TensorFlow installed from (source or binary): binary from Miniconda\r\n- TensorFlow version (use command below): 1.11.0\r\n- Python version: Python 3.6.6 :: Anaconda, Inc.\r\n- CUDA/cuDNN version: CPU version, no CUDA/cuDNN\r\n- Bazel version: N/A\r\n- GPU model and memory: N/A\r\n- Mobile device: N/A\r\n- Exact command to reproduce: python code.py\r\n\r\n**Describe the current behavior**\r\n\r\nRun the test code, the program throws AbortedError, info is:\r\n\r\n```\r\nAbortedError (see above for traceback): Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\r\n\t [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nThe program should finish with no error.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nsess = tf.Session()\r\ninputs = tf.placeholder(dtype=tf.float32, shape=(1, 300, 300, 3))\r\nnet = tf.layers.Conv2D(filters=2, kernel_size=3)(inputs)\r\nnet = tf.nn.softmax(net, axis=-1)\r\nsess.run(tf.global_variables_initializer())\r\nsess.run(net, feed_dict={inputs: np.zeros(shape=(1, 300, 300, 3), dtype=np.float32)})\r\n```\r\n\r\n**Other info / logs**\r\n\r\n* I set up the environment by ```conda create -n xxx pip python=3 tensorflow```\r\n\r\n* Traceback is:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1292, in _do_call\r\n    return fn(*args)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1277, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1367, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\r\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 10, in <module>\r\n    sess.run(net, feed_dict={inputs: np.zeros(shape=(1, 300, 300, 3), dtype=np.float32)})\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 887, in run\r\n    run_metadata_ptr)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1110, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1286, in _do_run\r\n    run_metadata)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1308, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.AbortedError: Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\r\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\r\n\r\nCaused by op 'Softmax', defined at:\r\n  File \"test.py\", line 7, in <module>\r\n    net = tf.nn.softmax(net, axis=-1)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 1746, in softmax\r\n    return _softmax(logits, gen_nn_ops.softmax, axis, name)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 1685, in _softmax\r\n    return compute_op(logits, name=name)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 7138, in softmax\r\n    \"Softmax\", logits=logits, name=name)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3272, in create_op\r\n    op_def=op_def)\r\n  File \"/home/kwy/.conda/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1768, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nAbortedError (see above for traceback): Operation received an exception:Status: 3, message: could not initialize a memory descriptor, in file tensorflow/core/kernels/mkl_softmax_op.cc:163\r\n         [[{{node Softmax}} = _MklSoftmax[T=DT_FLOAT, _kernel=\"MklOp\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](conv2d/BiasAdd, conv2d/BiasAdd:2)]]\r\n```\r\n\r\n* GPU version works fine.\r\n\r\n* If i set axis to 0, 1 or 2, the program finishes with no error, but with it set to  -1 or 3, the error occurs.\r\n\r\n* If the softmax layer is added after a dense layer, it also works fine.\r\n\r\n* I've also tested on another server with CentOS 7 and a Quadro P2000, the problem still occurs. (GPU version works fine while CPU version not)\r\n\r\n* This code still not work:\r\n```\r\nnet = tf.layers.Conv2D(filters=2, kernel_size=3, activation=tf.nn.softmax)(inputs)\r\n```"}