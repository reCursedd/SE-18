{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/437112590", "html_url": "https://github.com/tensorflow/tensorflow/issues/19021#issuecomment-437112590", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19021", "id": 437112590, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzExMjU5MA==", "user": {"login": "gbildson", "id": 1090775, "node_id": "MDQ6VXNlcjEwOTA3NzU=", "avatar_url": "https://avatars2.githubusercontent.com/u/1090775?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbildson", "html_url": "https://github.com/gbildson", "followers_url": "https://api.github.com/users/gbildson/followers", "following_url": "https://api.github.com/users/gbildson/following{/other_user}", "gists_url": "https://api.github.com/users/gbildson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbildson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbildson/subscriptions", "organizations_url": "https://api.github.com/users/gbildson/orgs", "repos_url": "https://api.github.com/users/gbildson/repos", "events_url": "https://api.github.com/users/gbildson/events{/privacy}", "received_events_url": "https://api.github.com/users/gbildson/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-08T18:48:32Z", "updated_at": "2018-11-08T18:51:09Z", "author_association": "NONE", "body_html": "<p>Let me try that more cleanly ...<br>\nI went into the tf.moments source and changed it to use supported methods:</p>\n<pre><code>   diff = math_ops.subtract(y, array_ops.stop_gradient(mean))\n    variance = math_ops.reduce_mean(\n        #math_ops.squared_difference(y, array_ops.stop_gradient(mean)),\n        math_ops.multiply(diff,diff),\n        axes,\n        keepdims=True,\n        name=\"variance\")\n</code></pre>\n<p>and in recent tflite versions, pow is supported so this works in instance normalization:<br>\n<code>           normalized = (inputs - mu) / (sigma_sq + EPSILON) ** .5</code></p>", "body_text": "Let me try that more cleanly ...\nI went into the tf.moments source and changed it to use supported methods:\n   diff = math_ops.subtract(y, array_ops.stop_gradient(mean))\n    variance = math_ops.reduce_mean(\n        #math_ops.squared_difference(y, array_ops.stop_gradient(mean)),\n        math_ops.multiply(diff,diff),\n        axes,\n        keepdims=True,\n        name=\"variance\")\n\nand in recent tflite versions, pow is supported so this works in instance normalization:\n           normalized = (inputs - mu) / (sigma_sq + EPSILON) ** .5", "body": "Let me try that more cleanly ...\r\nI went into the tf.moments source and changed it to use supported methods:\r\n~~~~\r\n   diff = math_ops.subtract(y, array_ops.stop_gradient(mean))\r\n    variance = math_ops.reduce_mean(\r\n        #math_ops.squared_difference(y, array_ops.stop_gradient(mean)),\r\n        math_ops.multiply(diff,diff),\r\n        axes,\r\n        keepdims=True,\r\n        name=\"variance\")\r\n~~~~\r\n\r\nand in recent tflite versions, pow is supported so this works in instance normalization:\r\n`            normalized = (inputs - mu) / (sigma_sq + EPSILON) ** .5\r\n`"}