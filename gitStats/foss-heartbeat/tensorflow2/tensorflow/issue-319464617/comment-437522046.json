{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/437522046", "html_url": "https://github.com/tensorflow/tensorflow/issues/19021#issuecomment-437522046", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19021", "id": 437522046, "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzUyMjA0Ng==", "user": {"login": "vholod", "id": 32450207, "node_id": "MDQ6VXNlcjMyNDUwMjA3", "avatar_url": "https://avatars1.githubusercontent.com/u/32450207?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vholod", "html_url": "https://github.com/vholod", "followers_url": "https://api.github.com/users/vholod/followers", "following_url": "https://api.github.com/users/vholod/following{/other_user}", "gists_url": "https://api.github.com/users/vholod/gists{/gist_id}", "starred_url": "https://api.github.com/users/vholod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vholod/subscriptions", "organizations_url": "https://api.github.com/users/vholod/orgs", "repos_url": "https://api.github.com/users/vholod/repos", "events_url": "https://api.github.com/users/vholod/events{/privacy}", "received_events_url": "https://api.github.com/users/vholod/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-09T22:59:51Z", "updated_at": "2018-11-09T22:59:51Z", "author_association": "NONE", "body_html": "<p>Thanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1090775\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gbildson\">@gbildson</a> ,<br>\nI can try to benchmark the model with those changes, and I will try to update. My last solution did use a lot of memory to perform Square operations:</p>\n<pre><code>2018-10-24 15:35:10.255607: I tensorflow/core/util/stat_summarizer.cc:85] ============================== Summary by node type ==============================\n2018-10-24 15:35:10.255611: I tensorflow/core/util/stat_summarizer.cc:85]                    [Node type]          [count]         [avg ms]         [avg %]          [cdf %]       [mem KB]      [times called]\n2018-10-24 15:35:10.255616: I tensorflow/core/util/stat_summarizer.cc:85]                         Conv2D               14         5227.149         76.688%          76.688%     1152921.625            14\n2018-10-24 15:35:10.255620: I tensorflow/core/util/stat_summarizer.cc:85]            Conv2DBackpropInput                2          614.725          9.019%          85.707%     1293926.375             2\n2018-10-24 15:35:10.255625: I tensorflow/core/util/stat_summarizer.cc:85]                           Mean               64          283.185          4.155%          89.861%       7431.704             64\n2018-10-24 15:35:10.255629: I tensorflow/core/util/stat_summarizer.cc:85]                            Mul               33          150.679          2.211%          92.072%          0.000             33\n2018-10-24 15:35:10.255633: I tensorflow/core/util/stat_summarizer.cc:85]                            Add               32          142.681          2.093%          94.165%          0.000             32\n2018-10-24 15:35:10.255642: I tensorflow/core/util/stat_summarizer.cc:85]                            Sub               16          133.475          1.958%          96.123%          0.000             16\n2018-10-24 15:35:10.255649: I tensorflow/core/util/stat_summarizer.cc:85]                         Square               16          126.811          1.860%          97.984%     1551052.750            16\n2018-10-24 15:35:10.255657: I tensorflow/core/util/stat_summarizer.cc:85]                           Relu               10           82.338          1.208%          99.192%          0.000             10\n2018-10-24 15:35:10.255664: I tensorflow/core/util/stat_summarizer.cc:85]                           AddN                5           52.525          0.771%          99.962%          0.000              5\n2018-10-24 15:35:10.255675: I tensorflow/core/util/stat_summarizer.cc:85]                        Sigmoid                1            2.446          0.036%          99.998%          0.000              1\n2018-10-24 15:35:10.255682: I tensorflow/core/util/stat_summarizer.cc:85]                          Const               54            0.069          0.001%          99.999%          0.000             54\n2018-10-24 15:35:10.255690: I tensorflow/core/util/stat_summarizer.cc:85]                          Rsqrt               16            0.043          0.001%         100.000%          0.000             16\n2018-10-24 15:35:10.255697: I tensorflow/core/util/stat_summarizer.cc:85]                        _Retval                1            0.005          0.000%         100.000%          0.000              1\n2018-10-24 15:35:10.255705: I tensorflow/core/util/stat_summarizer.cc:85]                           NoOp                1            0.004          0.000%         100.000%          0.000              1\n2018-10-24 15:35:10.255714: I tensorflow/core/util/stat_summarizer.cc:85]                           _Arg                1            0.001          0.000%         100.000%          0.000              1\n</code></pre>", "body_text": "Thanks @gbildson ,\nI can try to benchmark the model with those changes, and I will try to update. My last solution did use a lot of memory to perform Square operations:\n2018-10-24 15:35:10.255607: I tensorflow/core/util/stat_summarizer.cc:85] ============================== Summary by node type ==============================\n2018-10-24 15:35:10.255611: I tensorflow/core/util/stat_summarizer.cc:85]                    [Node type]          [count]         [avg ms]         [avg %]          [cdf %]       [mem KB]      [times called]\n2018-10-24 15:35:10.255616: I tensorflow/core/util/stat_summarizer.cc:85]                         Conv2D               14         5227.149         76.688%          76.688%     1152921.625            14\n2018-10-24 15:35:10.255620: I tensorflow/core/util/stat_summarizer.cc:85]            Conv2DBackpropInput                2          614.725          9.019%          85.707%     1293926.375             2\n2018-10-24 15:35:10.255625: I tensorflow/core/util/stat_summarizer.cc:85]                           Mean               64          283.185          4.155%          89.861%       7431.704             64\n2018-10-24 15:35:10.255629: I tensorflow/core/util/stat_summarizer.cc:85]                            Mul               33          150.679          2.211%          92.072%          0.000             33\n2018-10-24 15:35:10.255633: I tensorflow/core/util/stat_summarizer.cc:85]                            Add               32          142.681          2.093%          94.165%          0.000             32\n2018-10-24 15:35:10.255642: I tensorflow/core/util/stat_summarizer.cc:85]                            Sub               16          133.475          1.958%          96.123%          0.000             16\n2018-10-24 15:35:10.255649: I tensorflow/core/util/stat_summarizer.cc:85]                         Square               16          126.811          1.860%          97.984%     1551052.750            16\n2018-10-24 15:35:10.255657: I tensorflow/core/util/stat_summarizer.cc:85]                           Relu               10           82.338          1.208%          99.192%          0.000             10\n2018-10-24 15:35:10.255664: I tensorflow/core/util/stat_summarizer.cc:85]                           AddN                5           52.525          0.771%          99.962%          0.000              5\n2018-10-24 15:35:10.255675: I tensorflow/core/util/stat_summarizer.cc:85]                        Sigmoid                1            2.446          0.036%          99.998%          0.000              1\n2018-10-24 15:35:10.255682: I tensorflow/core/util/stat_summarizer.cc:85]                          Const               54            0.069          0.001%          99.999%          0.000             54\n2018-10-24 15:35:10.255690: I tensorflow/core/util/stat_summarizer.cc:85]                          Rsqrt               16            0.043          0.001%         100.000%          0.000             16\n2018-10-24 15:35:10.255697: I tensorflow/core/util/stat_summarizer.cc:85]                        _Retval                1            0.005          0.000%         100.000%          0.000              1\n2018-10-24 15:35:10.255705: I tensorflow/core/util/stat_summarizer.cc:85]                           NoOp                1            0.004          0.000%         100.000%          0.000              1\n2018-10-24 15:35:10.255714: I tensorflow/core/util/stat_summarizer.cc:85]                           _Arg                1            0.001          0.000%         100.000%          0.000              1", "body": "Thanks @gbildson ,\r\nI can try to benchmark the model with those changes, and I will try to update. My last solution did use a lot of memory to perform Square operations:\r\n\r\n```\r\n2018-10-24 15:35:10.255607: I tensorflow/core/util/stat_summarizer.cc:85] ============================== Summary by node type ==============================\r\n2018-10-24 15:35:10.255611: I tensorflow/core/util/stat_summarizer.cc:85]                    [Node type]          [count]         [avg ms]         [avg %]          [cdf %]       [mem KB]      [times called]\r\n2018-10-24 15:35:10.255616: I tensorflow/core/util/stat_summarizer.cc:85]                         Conv2D               14         5227.149         76.688%          76.688%     1152921.625            14\r\n2018-10-24 15:35:10.255620: I tensorflow/core/util/stat_summarizer.cc:85]            Conv2DBackpropInput                2          614.725          9.019%          85.707%     1293926.375             2\r\n2018-10-24 15:35:10.255625: I tensorflow/core/util/stat_summarizer.cc:85]                           Mean               64          283.185          4.155%          89.861%       7431.704             64\r\n2018-10-24 15:35:10.255629: I tensorflow/core/util/stat_summarizer.cc:85]                            Mul               33          150.679          2.211%          92.072%          0.000             33\r\n2018-10-24 15:35:10.255633: I tensorflow/core/util/stat_summarizer.cc:85]                            Add               32          142.681          2.093%          94.165%          0.000             32\r\n2018-10-24 15:35:10.255642: I tensorflow/core/util/stat_summarizer.cc:85]                            Sub               16          133.475          1.958%          96.123%          0.000             16\r\n2018-10-24 15:35:10.255649: I tensorflow/core/util/stat_summarizer.cc:85]                         Square               16          126.811          1.860%          97.984%     1551052.750            16\r\n2018-10-24 15:35:10.255657: I tensorflow/core/util/stat_summarizer.cc:85]                           Relu               10           82.338          1.208%          99.192%          0.000             10\r\n2018-10-24 15:35:10.255664: I tensorflow/core/util/stat_summarizer.cc:85]                           AddN                5           52.525          0.771%          99.962%          0.000              5\r\n2018-10-24 15:35:10.255675: I tensorflow/core/util/stat_summarizer.cc:85]                        Sigmoid                1            2.446          0.036%          99.998%          0.000              1\r\n2018-10-24 15:35:10.255682: I tensorflow/core/util/stat_summarizer.cc:85]                          Const               54            0.069          0.001%          99.999%          0.000             54\r\n2018-10-24 15:35:10.255690: I tensorflow/core/util/stat_summarizer.cc:85]                          Rsqrt               16            0.043          0.001%         100.000%          0.000             16\r\n2018-10-24 15:35:10.255697: I tensorflow/core/util/stat_summarizer.cc:85]                        _Retval                1            0.005          0.000%         100.000%          0.000              1\r\n2018-10-24 15:35:10.255705: I tensorflow/core/util/stat_summarizer.cc:85]                           NoOp                1            0.004          0.000%         100.000%          0.000              1\r\n2018-10-24 15:35:10.255714: I tensorflow/core/util/stat_summarizer.cc:85]                           _Arg                1            0.001          0.000%         100.000%          0.000              1\r\n```\r\n"}