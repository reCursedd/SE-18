{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4419", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4419/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4419/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4419/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4419", "id": 177514444, "node_id": "MDU6SXNzdWUxNzc1MTQ0NDQ=", "number": 4419, "title": "tf.get_variable without an explicit initializer fails for integer types", "user": {"login": "ethereon", "id": 337985, "node_id": "MDQ6VXNlcjMzNzk4NQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/337985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ethereon", "html_url": "https://github.com/ethereon", "followers_url": "https://api.github.com/users/ethereon/followers", "following_url": "https://api.github.com/users/ethereon/following{/other_user}", "gists_url": "https://api.github.com/users/ethereon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ethereon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ethereon/subscriptions", "organizations_url": "https://api.github.com/users/ethereon/orgs", "repos_url": "https://api.github.com/users/ethereon/repos", "events_url": "https://api.github.com/users/ethereon/events{/privacy}", "received_events_url": "https://api.github.com/users/ethereon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "lukaszkaiser", "id": 684901, "node_id": "MDQ6VXNlcjY4NDkwMQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/684901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukaszkaiser", "html_url": "https://github.com/lukaszkaiser", "followers_url": "https://api.github.com/users/lukaszkaiser/followers", "following_url": "https://api.github.com/users/lukaszkaiser/following{/other_user}", "gists_url": "https://api.github.com/users/lukaszkaiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukaszkaiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukaszkaiser/subscriptions", "organizations_url": "https://api.github.com/users/lukaszkaiser/orgs", "repos_url": "https://api.github.com/users/lukaszkaiser/repos", "events_url": "https://api.github.com/users/lukaszkaiser/events{/privacy}", "received_events_url": "https://api.github.com/users/lukaszkaiser/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lukaszkaiser", "id": 684901, "node_id": "MDQ6VXNlcjY4NDkwMQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/684901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukaszkaiser", "html_url": "https://github.com/lukaszkaiser", "followers_url": "https://api.github.com/users/lukaszkaiser/followers", "following_url": "https://api.github.com/users/lukaszkaiser/following{/other_user}", "gists_url": "https://api.github.com/users/lukaszkaiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukaszkaiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukaszkaiser/subscriptions", "organizations_url": "https://api.github.com/users/lukaszkaiser/orgs", "repos_url": "https://api.github.com/users/lukaszkaiser/repos", "events_url": "https://api.github.com/users/lukaszkaiser/events{/privacy}", "received_events_url": "https://api.github.com/users/lukaszkaiser/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-09-16T20:33:04Z", "updated_at": "2017-06-16T22:05:08Z", "closed_at": "2017-06-16T22:05:08Z", "author_association": "NONE", "body_html": "<p>The following fails (shape and name are arbitrary):</p>\n<pre><code>tf.get_variable(name='foo', shape=(42,), dtype=tf.int32)\n</code></pre>\n<p>Exception: <code>TypeError: Expected int32, got -1.7320508075688772 of type 'float' instead.</code></p>\n<p>In contrast, using <code>tf.float32</code> works just fine.</p>\n<p>The problem appears to be <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/variable_scope.py#L658\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/variable_scope.py#L658</a></p>\n<p>If an initializer is not provided (and a default one is not set), a uniform unit scaling init is used (notice that <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/init_ops.py#L275\"><code>sqrt(3)==1.7320...</code></a>), which of course conflicts with the requested integer type.</p>\n<p>While this can be mitigated by doing something like:</p>\n<pre><code>tf.get_variable(name='foo', dtype=tf.int32, initializer=tf.zeros_initializer(shape=(42,), dtype=tf.int32))\n</code></pre>\n<p>it feels like a smarter default behavior based on the variable type is warranted (or at least a less cryptic error).</p>\n<p>Tested on the current master.</p>", "body_text": "The following fails (shape and name are arbitrary):\ntf.get_variable(name='foo', shape=(42,), dtype=tf.int32)\n\nException: TypeError: Expected int32, got -1.7320508075688772 of type 'float' instead.\nIn contrast, using tf.float32 works just fine.\nThe problem appears to be https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/variable_scope.py#L658\nIf an initializer is not provided (and a default one is not set), a uniform unit scaling init is used (notice that sqrt(3)==1.7320...), which of course conflicts with the requested integer type.\nWhile this can be mitigated by doing something like:\ntf.get_variable(name='foo', dtype=tf.int32, initializer=tf.zeros_initializer(shape=(42,), dtype=tf.int32))\n\nit feels like a smarter default behavior based on the variable type is warranted (or at least a less cryptic error).\nTested on the current master.", "body": "The following fails (shape and name are arbitrary):\n\n```\ntf.get_variable(name='foo', shape=(42,), dtype=tf.int32)\n```\n\nException: `TypeError: Expected int32, got -1.7320508075688772 of type 'float' instead.`\n\nIn contrast, using `tf.float32` works just fine.\n\nThe problem appears to be https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/variable_scope.py#L658\n\nIf an initializer is not provided (and a default one is not set), a uniform unit scaling init is used (notice that [`sqrt(3)==1.7320...`](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/init_ops.py#L275)), which of course conflicts with the requested integer type.\n\nWhile this can be mitigated by doing something like:\n\n```\ntf.get_variable(name='foo', dtype=tf.int32, initializer=tf.zeros_initializer(shape=(42,), dtype=tf.int32))\n```\n\nit feels like a smarter default behavior based on the variable type is warranted (or at least a less cryptic error).\n\nTested on the current master.\n"}