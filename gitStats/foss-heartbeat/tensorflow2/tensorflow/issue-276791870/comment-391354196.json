{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/391354196", "html_url": "https://github.com/tensorflow/tensorflow/issues/14884#issuecomment-391354196", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14884", "id": 391354196, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTM1NDE5Ng==", "user": {"login": "peci1", "id": 182533, "node_id": "MDQ6VXNlcjE4MjUzMw==", "avatar_url": "https://avatars1.githubusercontent.com/u/182533?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peci1", "html_url": "https://github.com/peci1", "followers_url": "https://api.github.com/users/peci1/followers", "following_url": "https://api.github.com/users/peci1/following{/other_user}", "gists_url": "https://api.github.com/users/peci1/gists{/gist_id}", "starred_url": "https://api.github.com/users/peci1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peci1/subscriptions", "organizations_url": "https://api.github.com/users/peci1/orgs", "repos_url": "https://api.github.com/users/peci1/repos", "events_url": "https://api.github.com/users/peci1/events{/privacy}", "received_events_url": "https://api.github.com/users/peci1/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-23T13:51:15Z", "updated_at": "2018-05-23T13:51:15Z", "author_association": "NONE", "body_html": "<p>For anyone who'd like to take models from newer TF and transform them into models compatible with TF 1.3, here's my piece of code:</p>\n<pre><code>def fix_graph_def(graph_def):\n        # fix nodes\n        for node in graph_def.node:\n            if node.op == 'RefSwitch':\n                node.op = 'Switch'\n                for index in range(len(node.input)):\n                    if 'moving_' in node.input[index]:\n                        node.input[index] = node.input[index] + '/read'\n            elif node.op == 'AssignSub':\n                node.op = 'Sub'\n                if 'use_locking' in node.attr:\n                    del node.attr['use_locking']\n            if \"dilations\" in node.attr:\n                del node.attr[\"dilations\"]\n            if \"index_type\" in node.attr:\n                del node.attr[\"index_type\"]\n</code></pre>\n<p>It's probably not a complete list of all new attributes that have to be deleted, but in a few iterations you can make it strip everything you need.</p>", "body_text": "For anyone who'd like to take models from newer TF and transform them into models compatible with TF 1.3, here's my piece of code:\ndef fix_graph_def(graph_def):\n        # fix nodes\n        for node in graph_def.node:\n            if node.op == 'RefSwitch':\n                node.op = 'Switch'\n                for index in range(len(node.input)):\n                    if 'moving_' in node.input[index]:\n                        node.input[index] = node.input[index] + '/read'\n            elif node.op == 'AssignSub':\n                node.op = 'Sub'\n                if 'use_locking' in node.attr:\n                    del node.attr['use_locking']\n            if \"dilations\" in node.attr:\n                del node.attr[\"dilations\"]\n            if \"index_type\" in node.attr:\n                del node.attr[\"index_type\"]\n\nIt's probably not a complete list of all new attributes that have to be deleted, but in a few iterations you can make it strip everything you need.", "body": "For anyone who'd like to take models from newer TF and transform them into models compatible with TF 1.3, here's my piece of code:\r\n\r\n```\r\ndef fix_graph_def(graph_def):\r\n        # fix nodes\r\n        for node in graph_def.node:\r\n            if node.op == 'RefSwitch':\r\n                node.op = 'Switch'\r\n                for index in range(len(node.input)):\r\n                    if 'moving_' in node.input[index]:\r\n                        node.input[index] = node.input[index] + '/read'\r\n            elif node.op == 'AssignSub':\r\n                node.op = 'Sub'\r\n                if 'use_locking' in node.attr:\r\n                    del node.attr['use_locking']\r\n            if \"dilations\" in node.attr:\r\n                del node.attr[\"dilations\"]\r\n            if \"index_type\" in node.attr:\r\n                del node.attr[\"index_type\"]\r\n```\r\n\r\nIt's probably not a complete list of all new attributes that have to be deleted, but in a few iterations you can make it strip everything you need."}