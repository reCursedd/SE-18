{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21850", "id": 353722955, "node_id": "MDU6SXNzdWUzNTM3MjI5NTU=", "number": 21850, "title": "Error while using create_inference_graph - Can't find a device placement for the op!", "user": {"login": "srihari-humbarwadi", "id": 24864163, "node_id": "MDQ6VXNlcjI0ODY0MTYz", "avatar_url": "https://avatars0.githubusercontent.com/u/24864163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srihari-humbarwadi", "html_url": "https://github.com/srihari-humbarwadi", "followers_url": "https://api.github.com/users/srihari-humbarwadi/followers", "following_url": "https://api.github.com/users/srihari-humbarwadi/following{/other_user}", "gists_url": "https://api.github.com/users/srihari-humbarwadi/gists{/gist_id}", "starred_url": "https://api.github.com/users/srihari-humbarwadi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srihari-humbarwadi/subscriptions", "organizations_url": "https://api.github.com/users/srihari-humbarwadi/orgs", "repos_url": "https://api.github.com/users/srihari-humbarwadi/repos", "events_url": "https://api.github.com/users/srihari-humbarwadi/events{/privacy}", "received_events_url": "https://api.github.com/users/srihari-humbarwadi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-08-24T10:06:15Z", "updated_at": "2018-11-15T08:08:06Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 16.04</li>\n<li><strong>Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>: No</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.10</li>\n<li><strong>Python version</strong>: 3.5</li>\n<li><strong>Bazel version (if compiling from source)</strong>:  0.16.1</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:  5.4.0</li>\n<li><strong>CUDA/cuDNN version</strong>: 9.0/7.0.5</li>\n<li><strong>GPU model and memory</strong>: 4 x GTX 1080Ti 394.44 11GB VRAM each</li>\n<li><strong>TensorRT version</strong>:3.0.4</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>error while running trt.create_inference_graph on a frozen graph pb</p>\n<h3>Source code</h3>\n<pre><code>import os\nimport tensorflow as tf\nimport tensorflow.contrib.tensorrt as trt\nfrom tensorflow.python.framework import graph_io\n\n_input = 'input_1'\n_output = 'output_node0'\noutputs = [_output]\n\n\ndef get_frozen_graph():\n  with tf.gfile.FastGFile('model.h5.pb', \"rb\") as f:\n    graph_def = tf.GraphDef()\n    graph_def.ParseFromString(f.read())\n  return graph_def\n\n\nfrozen_graph_def = get_frozen_graph()\ntrt_graph_def = trt.create_inference_graph(frozen_graph_def, \n\t\t\t\t\toutputs,\n\t\t\t\t\tmax_batch_size=256, \n\t\t\t\t\tmax_workspace_size_bytes=1 &lt;&lt; 30, \n\t\t\t\t\tprecision_mode='FP16')\ntf.reset_default_graph()\ng = tf.Graph()\nwith tf.Session(graph=g) as sess:\n\twith g.as_default():\n\t\ttf.import_graph_def(\n  \t\tgraph_def=trt_graph_def,\n  \t\tname='')\n\tgraph_io.write_graph(g, '.', 'trt_frozen.pb', as_text=False)\n</code></pre>\n<h3>logs</h3>\n<p>2018-08-24 15:34:59.873109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-08-24 15:34:59.964048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-08-24 15:35:00.046908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-08-24 15:35:00.149867: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-08-24 15:35:00.150535: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count &gt;= 8): 4<br>\n2018-08-24 15:35:00.150615: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session<br>\n2018-08-24 15:35:00.151247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582<br>\npciBusID: 0000:01:00.0<br>\ntotalMemory: 10.91GiB freeMemory: 10.38GiB<br>\n2018-08-24 15:35:00.151374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582<br>\npciBusID: 0000:02:00.0<br>\ntotalMemory: 10.92GiB freeMemory: 10.76GiB<br>\n2018-08-24 15:35:00.151494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582<br>\npciBusID: 0000:03:00.0<br>\ntotalMemory: 10.92GiB freeMemory: 10.76GiB<br>\n2018-08-24 15:35:00.151608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582<br>\npciBusID: 0000:05:00.0<br>\ntotalMemory: 10.92GiB freeMemory: 10.76GiB<br>\n2018-08-24 15:35:00.156119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3<br>\n2018-08-24 15:35:01.123215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-08-24 15:35:01.123254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3<br>\n2018-08-24 15:35:01.123259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y<br>\n2018-08-24 15:35:01.123263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y<br>\n2018-08-24 15:35:01.123266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y<br>\n2018-08-24 15:35:01.123269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N<br>\n2018-08-24 15:35:01.123691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:01.202813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -&gt; physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:01.286295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -&gt; physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:01.369518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -&gt; physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:01.827178: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-08-24 15:35:01.827279: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!<br>\n2018-08-24 15:35:01.901005: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.<br>\n2018-08-24 15:35:02.432465: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2<br>\n2018-08-24 15:35:02.433733: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2<br>\n2018-08-24 15:35:02.434291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...<br>\n2018-08-24 15:35:02.751864: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-08-24 15:35:02.751964: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!<br>\n2018-08-24 15:35:02.856268: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.<br>\n2018-08-24 15:35:02.904384: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2<br>\n2018-08-24 15:35:02.905595: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2<br>\n2018-08-24 15:35:02.906038: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...<br>\n2018-08-24 15:35:03.064587: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must <em>NOT</em> be called on function objects.<br>\n2018-08-24 15:35:03.127441: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must <em>NOT</em> be called on function objects.<br>\n2018-08-24 15:35:03.160255: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: tf_graph<br>\n2018-08-24 15:35:03.160298: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1098 nodes (-606), 1155 edges (-606), time = 96.013ms.<br>\n2018-08-24 15:35:03.160304: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Graph size after: 1161 nodes (63), 1157 edges (2), time = 32.452ms.<br>\n2018-08-24 15:35:03.160322: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1161 nodes (0), 1157 edges (0), time = 808.131ms.<br>\n2018-08-24 15:35:03.160329: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1100 nodes (-61), 1157 edges (0), time = 80.726ms.<br>\n2018-08-24 15:35:03.160332: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1100 nodes (0), 1157 edges (0), time = 390.558ms.<br>\n2018-08-24 15:35:03.160335: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: my_trt_op_0_native_segment<br>\n2018-08-24 15:35:03.160349: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 65.266ms.<br>\n2018-08-24 15:35:03.160434: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Invalid argument: The graph is already optimized by layout optimizer.<br>\n2018-08-24 15:35:03.160438: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.5ms.<br>\n2018-08-24 15:35:03.160455: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 53.271ms.<br>\n2018-08-24 15:35:03.160458: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.467ms.<br>\n2018-08-24 15:35:03.336425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3<br>\n2018-08-24 15:35:03.336534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-08-24 15:35:03.336542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3<br>\n2018-08-24 15:35:03.336545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y<br>\n2018-08-24 15:35:03.336548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y<br>\n2018-08-24 15:35:03.336551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y<br>\n2018-08-24 15:35:03.336553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N<br>\n2018-08-24 15:35:03.336822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:03.336960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -&gt; physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:03.337073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -&gt; physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)<br>\n2018-08-24 15:35:03.337142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -&gt; physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.10\nPython version: 3.5\nBazel version (if compiling from source):  0.16.1\nGCC/Compiler version (if compiling from source):  5.4.0\nCUDA/cuDNN version: 9.0/7.0.5\nGPU model and memory: 4 x GTX 1080Ti 394.44 11GB VRAM each\nTensorRT version:3.0.4\n\nDescribe the problem\nerror while running trt.create_inference_graph on a frozen graph pb\nSource code\nimport os\nimport tensorflow as tf\nimport tensorflow.contrib.tensorrt as trt\nfrom tensorflow.python.framework import graph_io\n\n_input = 'input_1'\n_output = 'output_node0'\noutputs = [_output]\n\n\ndef get_frozen_graph():\n  with tf.gfile.FastGFile('model.h5.pb', \"rb\") as f:\n    graph_def = tf.GraphDef()\n    graph_def.ParseFromString(f.read())\n  return graph_def\n\n\nfrozen_graph_def = get_frozen_graph()\ntrt_graph_def = trt.create_inference_graph(frozen_graph_def, \n\t\t\t\t\toutputs,\n\t\t\t\t\tmax_batch_size=256, \n\t\t\t\t\tmax_workspace_size_bytes=1 << 30, \n\t\t\t\t\tprecision_mode='FP16')\ntf.reset_default_graph()\ng = tf.Graph()\nwith tf.Session(graph=g) as sess:\n\twith g.as_default():\n\t\ttf.import_graph_def(\n  \t\tgraph_def=trt_graph_def,\n  \t\tname='')\n\tgraph_io.write_graph(g, '.', 'trt_frozen.pb', as_text=False)\n\nlogs\n2018-08-24 15:34:59.873109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-08-24 15:34:59.964048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-08-24 15:35:00.046908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-08-24 15:35:00.149867: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-08-24 15:35:00.150535: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count >= 8): 4\n2018-08-24 15:35:00.150615: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session\n2018-08-24 15:35:00.151247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:01:00.0\ntotalMemory: 10.91GiB freeMemory: 10.38GiB\n2018-08-24 15:35:00.151374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:02:00.0\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\n2018-08-24 15:35:00.151494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:03:00.0\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\n2018-08-24 15:35:00.151608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:05:00.0\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\n2018-08-24 15:35:00.156119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-24 15:35:01.123215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-24 15:35:01.123254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3\n2018-08-24 15:35:01.123259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y\n2018-08-24 15:35:01.123263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y\n2018-08-24 15:35:01.123266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y\n2018-08-24 15:35:01.123269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N\n2018-08-24 15:35:01.123691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-08-24 15:35:01.202813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)\n2018-08-24 15:35:01.286295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)\n2018-08-24 15:35:01.369518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)\n2018-08-24 15:35:01.827178: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment @scope '', converted to graph\n2018-08-24 15:35:01.827279: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!\n2018-08-24 15:35:01.901005: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.\n2018-08-24 15:35:02.432465: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\n2018-08-24 15:35:02.433733: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\n2018-08-24 15:35:02.434291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...\n2018-08-24 15:35:02.751864: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment @scope '', converted to graph\n2018-08-24 15:35:02.751964: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!\n2018-08-24 15:35:02.856268: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.\n2018-08-24 15:35:02.904384: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\n2018-08-24 15:35:02.905595: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\n2018-08-24 15:35:02.906038: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...\n2018-08-24 15:35:03.064587: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must NOT be called on function objects.\n2018-08-24 15:35:03.127441: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must NOT be called on function objects.\n2018-08-24 15:35:03.160255: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: tf_graph\n2018-08-24 15:35:03.160298: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1098 nodes (-606), 1155 edges (-606), time = 96.013ms.\n2018-08-24 15:35:03.160304: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Graph size after: 1161 nodes (63), 1157 edges (2), time = 32.452ms.\n2018-08-24 15:35:03.160322: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1161 nodes (0), 1157 edges (0), time = 808.131ms.\n2018-08-24 15:35:03.160329: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1100 nodes (-61), 1157 edges (0), time = 80.726ms.\n2018-08-24 15:35:03.160332: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1100 nodes (0), 1157 edges (0), time = 390.558ms.\n2018-08-24 15:35:03.160335: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: my_trt_op_0_native_segment\n2018-08-24 15:35:03.160349: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 65.266ms.\n2018-08-24 15:35:03.160434: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Invalid argument: The graph is already optimized by layout optimizer.\n2018-08-24 15:35:03.160438: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.5ms.\n2018-08-24 15:35:03.160455: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 53.271ms.\n2018-08-24 15:35:03.160458: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.467ms.\n2018-08-24 15:35:03.336425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\n2018-08-24 15:35:03.336534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-08-24 15:35:03.336542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3\n2018-08-24 15:35:03.336545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y\n2018-08-24 15:35:03.336548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y\n2018-08-24 15:35:03.336551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y\n2018-08-24 15:35:03.336553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N\n2018-08-24 15:35:03.336822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-08-24 15:35:03.336960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)\n2018-08-24 15:35:03.337073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)\n2018-08-24 15:35:03.337142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**:  0.16.1\r\n- **GCC/Compiler version (if compiling from source)**:  5.4.0\r\n- **CUDA/cuDNN version**: 9.0/7.0.5\r\n- **GPU model and memory**: 4 x GTX 1080Ti 394.44 11GB VRAM each\r\n- **TensorRT version**:3.0.4\r\n\r\n### Describe the problem\r\nerror while running trt.create_inference_graph on a frozen graph pb\r\n\r\n### Source code\r\n```\r\nimport os\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.tensorrt as trt\r\nfrom tensorflow.python.framework import graph_io\r\n\r\n_input = 'input_1'\r\n_output = 'output_node0'\r\noutputs = [_output]\r\n\r\n\r\ndef get_frozen_graph():\r\n  with tf.gfile.FastGFile('model.h5.pb', \"rb\") as f:\r\n    graph_def = tf.GraphDef()\r\n    graph_def.ParseFromString(f.read())\r\n  return graph_def\r\n\r\n\r\nfrozen_graph_def = get_frozen_graph()\r\ntrt_graph_def = trt.create_inference_graph(frozen_graph_def, \r\n\t\t\t\t\toutputs,\r\n\t\t\t\t\tmax_batch_size=256, \r\n\t\t\t\t\tmax_workspace_size_bytes=1 << 30, \r\n\t\t\t\t\tprecision_mode='FP16')\r\ntf.reset_default_graph()\r\ng = tf.Graph()\r\nwith tf.Session(graph=g) as sess:\r\n\twith g.as_default():\r\n\t\ttf.import_graph_def(\r\n  \t\tgraph_def=trt_graph_def,\r\n  \t\tname='')\r\n\tgraph_io.write_graph(g, '.', 'trt_frozen.pb', as_text=False)\r\n```\r\n### logs\r\n2018-08-24 15:34:59.873109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:34:59.964048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:35:00.046908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:35:00.149867: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:35:00.150535: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count >= 8): 4\r\n2018-08-24 15:35:00.150615: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session\r\n2018-08-24 15:35:00.151247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 10.91GiB freeMemory: 10.38GiB\r\n2018-08-24 15:35:00.151374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:02:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\r\n2018-08-24 15:35:00.151494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:03:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\r\n2018-08-24 15:35:00.151608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:05:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\r\n2018-08-24 15:35:00.156119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-24 15:35:01.123215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-24 15:35:01.123254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-24 15:35:01.123259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-24 15:35:01.123263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-24 15:35:01.123266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-24 15:35:01.123269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-24 15:35:01.123691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.202813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.286295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.369518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.827178: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment @scope '', converted to graph\r\n2018-08-24 15:35:01.827279: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!\r\n2018-08-24 15:35:01.901005: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.\r\n2018-08-24 15:35:02.432465: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.433733: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.434291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...\r\n2018-08-24 15:35:02.751864: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment @scope '', converted to graph\r\n2018-08-24 15:35:02.751964: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!\r\n2018-08-24 15:35:02.856268: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.\r\n2018-08-24 15:35:02.904384: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.905595: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.906038: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...\r\n2018-08-24 15:35:03.064587: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must *NOT* be called on function objects.\r\n2018-08-24 15:35:03.127441: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must *NOT* be called on function objects.\r\n2018-08-24 15:35:03.160255: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: tf_graph\r\n2018-08-24 15:35:03.160298: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1098 nodes (-606), 1155 edges (-606), time = 96.013ms.\r\n2018-08-24 15:35:03.160304: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Graph size after: 1161 nodes (63), 1157 edges (2), time = 32.452ms.\r\n2018-08-24 15:35:03.160322: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1161 nodes (0), 1157 edges (0), time = 808.131ms.\r\n2018-08-24 15:35:03.160329: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1100 nodes (-61), 1157 edges (0), time = 80.726ms.\r\n2018-08-24 15:35:03.160332: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1100 nodes (0), 1157 edges (0), time = 390.558ms.\r\n2018-08-24 15:35:03.160335: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: my_trt_op_0_native_segment\r\n2018-08-24 15:35:03.160349: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 65.266ms.\r\n2018-08-24 15:35:03.160434: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Invalid argument: The graph is already optimized by layout optimizer.\r\n2018-08-24 15:35:03.160438: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.5ms.\r\n2018-08-24 15:35:03.160455: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 53.271ms.\r\n2018-08-24 15:35:03.160458: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.467ms.\r\n2018-08-24 15:35:03.336425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-24 15:35:03.336534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-24 15:35:03.336542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-24 15:35:03.336545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-24 15:35:03.336548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-24 15:35:03.336551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-24 15:35:03.336553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-24 15:35:03.336822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:03.336960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:03.337073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:03.337142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)"}