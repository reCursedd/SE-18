{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/385931653", "html_url": "https://github.com/tensorflow/tensorflow/issues/18994#issuecomment-385931653", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18994", "id": 385931653, "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTkzMTY1Mw==", "user": {"login": "oscarriddle", "id": 13745902, "node_id": "MDQ6VXNlcjEzNzQ1OTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/13745902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oscarriddle", "html_url": "https://github.com/oscarriddle", "followers_url": "https://api.github.com/users/oscarriddle/followers", "following_url": "https://api.github.com/users/oscarriddle/following{/other_user}", "gists_url": "https://api.github.com/users/oscarriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/oscarriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oscarriddle/subscriptions", "organizations_url": "https://api.github.com/users/oscarriddle/orgs", "repos_url": "https://api.github.com/users/oscarriddle/repos", "events_url": "https://api.github.com/users/oscarriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/oscarriddle/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-02T10:19:43Z", "updated_at": "2018-05-02T10:19:43Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=10539540\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/samikama\">@samikama</a> ,</p>\n<p>Thanks for your reply. I will try your advice soon.<br>\nToday I tried another way of doing this, that I loaded a frozen model, then TRT optimized it, then exported it as a saved_model.<br>\nBut when I tried to restore this saved_model, an ERROR popped up, that seems the node 'TRTEngineOp' is not recognized:</p>\n<pre><code>Traceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 2, in &lt;module&gt;\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/saved_model/loader_impl.py\", line 219, in load\n    saver = tf_saver.import_meta_graph(meta_graph_def_to_load, **saver_kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1927, in import_meta_graph\n    **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/meta_graph.py\", line 741, in import_scoped_meta_graph\n    producer_op_list=producer_op_list)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 432, in new_func\n    return func(*args, **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 457, in import_graph_def\n    _RemoveDefaultAttrs(op_dict, producer_op_list, graph_def)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 227, in _RemoveDefaultAttrs\n    op_def = op_dict[node.op]\nKeyError: u'TRTEngineOp'\n&gt;&gt;&gt; tf.__version__\n'1.7.0'\n\n</code></pre>\n<p>I traced the source code, the 'TRTEngineOp' seems a subclass of the OpKernel, so I'm a little confused why it can't be restored in a standard way. Could you share some comment on this?</p>\n<p>Thanks,</p>", "body_text": "Hi @samikama ,\nThanks for your reply. I will try your advice soon.\nToday I tried another way of doing this, that I loaded a frozen model, then TRT optimized it, then exported it as a saved_model.\nBut when I tried to restore this saved_model, an ERROR popped up, that seems the node 'TRTEngineOp' is not recognized:\nTraceback (most recent call last):\n  File \"<stdin>\", line 2, in <module>\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/saved_model/loader_impl.py\", line 219, in load\n    saver = tf_saver.import_meta_graph(meta_graph_def_to_load, **saver_kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1927, in import_meta_graph\n    **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/meta_graph.py\", line 741, in import_scoped_meta_graph\n    producer_op_list=producer_op_list)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 432, in new_func\n    return func(*args, **kwargs)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 457, in import_graph_def\n    _RemoveDefaultAttrs(op_dict, producer_op_list, graph_def)\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 227, in _RemoveDefaultAttrs\n    op_def = op_dict[node.op]\nKeyError: u'TRTEngineOp'\n>>> tf.__version__\n'1.7.0'\n\n\nI traced the source code, the 'TRTEngineOp' seems a subclass of the OpKernel, so I'm a little confused why it can't be restored in a standard way. Could you share some comment on this?\nThanks,", "body": "Hi @samikama ,\r\n\r\nThanks for your reply. I will try your advice soon.\r\nToday I tried another way of doing this, that I loaded a frozen model, then TRT optimized it, then exported it as a saved_model.\r\nBut when I tried to restore this saved_model, an ERROR popped up, that seems the node 'TRTEngineOp' is not recognized:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 2, in <module>\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/saved_model/loader_impl.py\", line 219, in load\r\n    saver = tf_saver.import_meta_graph(meta_graph_def_to_load, **saver_kwargs)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1927, in import_meta_graph\r\n    **kwargs)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/meta_graph.py\", line 741, in import_scoped_meta_graph\r\n    producer_op_list=producer_op_list)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 432, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 457, in import_graph_def\r\n    _RemoveDefaultAttrs(op_dict, producer_op_list, graph_def)\r\n  File \"/home/web_server/dlpy72/dlpy/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 227, in _RemoveDefaultAttrs\r\n    op_def = op_dict[node.op]\r\nKeyError: u'TRTEngineOp'\r\n>>> tf.__version__\r\n'1.7.0'\r\n\r\n```\r\nI traced the source code, the 'TRTEngineOp' seems a subclass of the OpKernel, so I'm a little confused why it can't be restored in a standard way. Could you share some comment on this? \r\n\r\nThanks,"}