{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9394", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9394/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9394/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9394/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9394", "id": 223649825, "node_id": "MDU6SXNzdWUyMjM2NDk4MjU=", "number": 9394, "title": "Max_pool with dynamic ksize", "user": {"login": "filipealeixo", "id": 12476396, "node_id": "MDQ6VXNlcjEyNDc2Mzk2", "avatar_url": "https://avatars3.githubusercontent.com/u/12476396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/filipealeixo", "html_url": "https://github.com/filipealeixo", "followers_url": "https://api.github.com/users/filipealeixo/followers", "following_url": "https://api.github.com/users/filipealeixo/following{/other_user}", "gists_url": "https://api.github.com/users/filipealeixo/gists{/gist_id}", "starred_url": "https://api.github.com/users/filipealeixo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/filipealeixo/subscriptions", "organizations_url": "https://api.github.com/users/filipealeixo/orgs", "repos_url": "https://api.github.com/users/filipealeixo/repos", "events_url": "https://api.github.com/users/filipealeixo/events{/privacy}", "received_events_url": "https://api.github.com/users/filipealeixo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-04-23T17:10:27Z", "updated_at": "2017-04-24T17:06:41Z", "closed_at": "2017-04-24T17:06:41Z", "author_association": "NONE", "body_html": "<p>I have the following code for a convolutional layer. This layer is part a larger computational graph.</p>\n<pre><code># Define the shape of the filter\nfilter_shape = [1,\n                config.char_filter_size,\n                config.dim_char,\n                config.dim_char]\n\n# Define the convolutional layer weights and biases\nW_conv = tf.Variable(tf.truncated_normal(filter_shape, stddev=0.1),\n                     name=\"W_conv\")\nb_conv = tf.Variable(tf.constant(0.1, shape=[config.dim_char]),\n                     name=\"b_conv\")\n# Do 2d convolution\nconv = tf.nn.conv2d(char_embeddings,\n                    W_conv,\n                    strides=[1, 1, 1, 1],\n                    padding=\"VALID\",\n                    name=\"conv\")\n# Apply nonlinearity\n# h_conv has the same shape as conv\nh_conv = tf.nn.relu(tf.nn.bias_add(conv, b_conv),\n                    name=\"conv_relu\")\n# Maxpooling h_conv over dim 2 (char dim)\n\n# ERROR HERE\nconv_pooled = tf.nn.max_pool(h_conv,\n                             ksize=[1, 1, tf.shape(h_conv)[-2], 1],\n                             strides=[1, 1, 1, 1],\n                             padding='VALID',\n                             name=\"conv_max_pool\")\n</code></pre>\n<p>When trying to run, I get the error:</p>\n<blockquote>\n<p>TypeError: Expected int for argument 'ksize' not tf.Tensor shape=() dtype=int32.</p>\n</blockquote>\n<p>is tf.nn.max_pool unable to handle dynamic ksize?</p>", "body_text": "I have the following code for a convolutional layer. This layer is part a larger computational graph.\n# Define the shape of the filter\nfilter_shape = [1,\n                config.char_filter_size,\n                config.dim_char,\n                config.dim_char]\n\n# Define the convolutional layer weights and biases\nW_conv = tf.Variable(tf.truncated_normal(filter_shape, stddev=0.1),\n                     name=\"W_conv\")\nb_conv = tf.Variable(tf.constant(0.1, shape=[config.dim_char]),\n                     name=\"b_conv\")\n# Do 2d convolution\nconv = tf.nn.conv2d(char_embeddings,\n                    W_conv,\n                    strides=[1, 1, 1, 1],\n                    padding=\"VALID\",\n                    name=\"conv\")\n# Apply nonlinearity\n# h_conv has the same shape as conv\nh_conv = tf.nn.relu(tf.nn.bias_add(conv, b_conv),\n                    name=\"conv_relu\")\n# Maxpooling h_conv over dim 2 (char dim)\n\n# ERROR HERE\nconv_pooled = tf.nn.max_pool(h_conv,\n                             ksize=[1, 1, tf.shape(h_conv)[-2], 1],\n                             strides=[1, 1, 1, 1],\n                             padding='VALID',\n                             name=\"conv_max_pool\")\n\nWhen trying to run, I get the error:\n\nTypeError: Expected int for argument 'ksize' not tf.Tensor shape=() dtype=int32.\n\nis tf.nn.max_pool unable to handle dynamic ksize?", "body": "I have the following code for a convolutional layer. This layer is part a larger computational graph.\r\n\r\n```\r\n# Define the shape of the filter\r\nfilter_shape = [1,\r\n                config.char_filter_size,\r\n                config.dim_char,\r\n                config.dim_char]\r\n\r\n# Define the convolutional layer weights and biases\r\nW_conv = tf.Variable(tf.truncated_normal(filter_shape, stddev=0.1),\r\n                     name=\"W_conv\")\r\nb_conv = tf.Variable(tf.constant(0.1, shape=[config.dim_char]),\r\n                     name=\"b_conv\")\r\n# Do 2d convolution\r\nconv = tf.nn.conv2d(char_embeddings,\r\n                    W_conv,\r\n                    strides=[1, 1, 1, 1],\r\n                    padding=\"VALID\",\r\n                    name=\"conv\")\r\n# Apply nonlinearity\r\n# h_conv has the same shape as conv\r\nh_conv = tf.nn.relu(tf.nn.bias_add(conv, b_conv),\r\n                    name=\"conv_relu\")\r\n# Maxpooling h_conv over dim 2 (char dim)\r\n\r\n# ERROR HERE\r\nconv_pooled = tf.nn.max_pool(h_conv,\r\n                             ksize=[1, 1, tf.shape(h_conv)[-2], 1],\r\n                             strides=[1, 1, 1, 1],\r\n                             padding='VALID',\r\n                             name=\"conv_max_pool\")\r\n```\r\n\r\nWhen trying to run, I get the error:\r\n\r\n> TypeError: Expected int for argument 'ksize' not tf.Tensor shape=() dtype=int32.\r\n\r\nis tf.nn.max_pool unable to handle dynamic ksize?"}