{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21116", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21116/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21116/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21116/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21116", "id": 344292220, "node_id": "MDU6SXNzdWUzNDQyOTIyMjA=", "number": 21116, "title": "tensorflow lite only one output", "user": {"login": "iChiaGuo", "id": 13581022, "node_id": "MDQ6VXNlcjEzNTgxMDIy", "avatar_url": "https://avatars3.githubusercontent.com/u/13581022?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iChiaGuo", "html_url": "https://github.com/iChiaGuo", "followers_url": "https://api.github.com/users/iChiaGuo/followers", "following_url": "https://api.github.com/users/iChiaGuo/following{/other_user}", "gists_url": "https://api.github.com/users/iChiaGuo/gists{/gist_id}", "starred_url": "https://api.github.com/users/iChiaGuo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iChiaGuo/subscriptions", "organizations_url": "https://api.github.com/users/iChiaGuo/orgs", "repos_url": "https://api.github.com/users/iChiaGuo/repos", "events_url": "https://api.github.com/users/iChiaGuo/events{/privacy}", "received_events_url": "https://api.github.com/users/iChiaGuo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-07-25T04:54:38Z", "updated_at": "2018-07-26T08:59:26Z", "closed_at": "2018-07-26T08:59:26Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:yes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:Linux Ubuntu 16.04</li>\n<li><strong>Mobile device (e.g iphone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device</strong>:iphone 6s</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:no</li>\n<li><strong>TensorFlow version (use command below)</strong>:1.9</li>\n<li><strong>Python version</strong>:3.5</li>\n<li><strong>Bazel version (if compiling from source)</strong>:0.12</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:</li>\n<li><strong>CUDA/cuDNN version</strong>:</li>\n<li><strong>GPU model and memory</strong>:</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I use my model in tensorflowlite ,it have two outputs,but in my iphone6s only get one output!</p>\n<p>(py35) ljg@ljg-linux:~/facenet/src/align/pb$ /home/ljg/tensorflow/bazel-bin/tensorflow/tools/graph_transforms/summarize_graph --in_graph=Pnet.pb<br>\nFound 1 possible inputs: (name=pnet/input, type=float(1), shape=[?,?,?,3])<br>\nNo variables spotted.<br>\nFound 2 possible outputs: (name=pnet/conv4-1/BiasAdd, op=BiasAdd) (name=pnet/conv4-2/BiasAdd, op=BiasAdd)<br>\nFound 6632 (6.63k) const parameters, 0 (0) variable parameters, and 0 control_edges<br>\nOp types used: 13 Const, 13 Identity, 6 Neg, 6 Relu, 5 BiasAdd, 5 Conv2D, 3 Add, 3 Mul, 1 MaxPool, 1 Placeholder<br>\nTo use with tensorflow/tools/benchmark:benchmark_model try these arguments:<br>\nbazel run tensorflow/tools/benchmark:benchmark_model -- --graph=Pnet.pb --show_flops --input_layer=pnet/input --input_layer_type=float --input_layer_shape=-1,-1,-1,3 --output_layer=pnet/conv4-1/BiasAdd,pnet/conv4-2/BiasAdd</p>\n<p>/home/ljg/tensorflow-1.9.0/bazel-bin/tensorflow/contrib/lite/toco/toco --input_file=Pnet.pb --input_format=TENSORFLOW_GRAPHDEF  --output_format=TFLITE --output_file=Pnet.tflite  --inference_type=FLOAT --inference_input_type=FLOAT --input_shape=1,12,12,3 --input_array=pnet/input --output_array=pnet/conv4-1/BiasAdd pnet/conv4-2/BiasAdd</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/13581022/43180218-6e6282b0-9009-11e8-8bd4-f1d6046ba7e5.png\"><img src=\"https://user-images.githubusercontent.com/13581022/43180218-6e6282b0-9009-11e8-8bd4-f1d6046ba7e5.png\" alt=\"problem\" style=\"max-width:100%;\"></a></p>\n<h3>Source code / logs</h3>\n<pre><code>`class PNet(Network):\n    def setup(self):\n         (self.feed('data') \n         .conv(3, 3, 10, 1, 1, padding='VALID', relu=False, name='conv1')\n         .prelu(name='PReLU1')\n         .max_pool(2, 2, 2, 2, name='pool1')\n         .conv(3, 3, 16, 1, 1, padding='VALID', relu=False, name='conv2')\n         .prelu(name='PReLU2')\n         .conv(3, 3, 32, 1, 1, padding='VALID', relu=False, name='conv3')\n         .prelu(name='PReLU3')\n         .conv(1, 1, 2, 1, 1, relu=False, name='conv4-1'))\n         .softmax(3,name='prob1'))\n\n         (self.feed('PReLU3') \n         .conv(1, 1, 4, 1, 1, relu=False, name='conv4-2'))\n    `   \n  `model_path='./'\n  export_dir='./pb/'\n  g1 = tf.Graph()\n  sess1 = tf.Session(graph=g1)\n  with sess1.as_default(): \n      with g1.as_default():\n          with tf.variable_scope('pnet'):\n              data = tf.placeholder(tf.float32, (None,None,None,3), 'input')\n              pnet = PNet({'data':data})\n             pnet.load(os.path.join(model_path, 'det1.npy'), sess1)\n        \nfrozen_graphdef = tf.graph_util.convert_variables_to_constants(\n      sess1, sess1.graph_def, ['pnet/conv4-2/BiasAdd', 'pnet/conv4-1/BiasAdd'])\ntf.train.write_graph(frozen_graphdef,export_dir, 'Pnet.pb', as_text=False)  \nprint ('finis')\n</code></pre>\n<p>`</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):yes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\nMobile device (e.g iphone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:iphone 6s\nTensorFlow installed from (source or binary):no\nTensorFlow version (use command below):1.9\nPython version:3.5\nBazel version (if compiling from source):0.12\nGCC/Compiler version (if compiling from source):\nCUDA/cuDNN version:\nGPU model and memory:\nExact command to reproduce:\n\nDescribe the problem\nI use my model in tensorflowlite ,it have two outputs,but in my iphone6s only get one output!\n(py35) ljg@ljg-linux:~/facenet/src/align/pb$ /home/ljg/tensorflow/bazel-bin/tensorflow/tools/graph_transforms/summarize_graph --in_graph=Pnet.pb\nFound 1 possible inputs: (name=pnet/input, type=float(1), shape=[?,?,?,3])\nNo variables spotted.\nFound 2 possible outputs: (name=pnet/conv4-1/BiasAdd, op=BiasAdd) (name=pnet/conv4-2/BiasAdd, op=BiasAdd)\nFound 6632 (6.63k) const parameters, 0 (0) variable parameters, and 0 control_edges\nOp types used: 13 Const, 13 Identity, 6 Neg, 6 Relu, 5 BiasAdd, 5 Conv2D, 3 Add, 3 Mul, 1 MaxPool, 1 Placeholder\nTo use with tensorflow/tools/benchmark:benchmark_model try these arguments:\nbazel run tensorflow/tools/benchmark:benchmark_model -- --graph=Pnet.pb --show_flops --input_layer=pnet/input --input_layer_type=float --input_layer_shape=-1,-1,-1,3 --output_layer=pnet/conv4-1/BiasAdd,pnet/conv4-2/BiasAdd\n/home/ljg/tensorflow-1.9.0/bazel-bin/tensorflow/contrib/lite/toco/toco --input_file=Pnet.pb --input_format=TENSORFLOW_GRAPHDEF  --output_format=TFLITE --output_file=Pnet.tflite  --inference_type=FLOAT --inference_input_type=FLOAT --input_shape=1,12,12,3 --input_array=pnet/input --output_array=pnet/conv4-1/BiasAdd pnet/conv4-2/BiasAdd\n\nSource code / logs\n`class PNet(Network):\n    def setup(self):\n         (self.feed('data') \n         .conv(3, 3, 10, 1, 1, padding='VALID', relu=False, name='conv1')\n         .prelu(name='PReLU1')\n         .max_pool(2, 2, 2, 2, name='pool1')\n         .conv(3, 3, 16, 1, 1, padding='VALID', relu=False, name='conv2')\n         .prelu(name='PReLU2')\n         .conv(3, 3, 32, 1, 1, padding='VALID', relu=False, name='conv3')\n         .prelu(name='PReLU3')\n         .conv(1, 1, 2, 1, 1, relu=False, name='conv4-1'))\n         .softmax(3,name='prob1'))\n\n         (self.feed('PReLU3') \n         .conv(1, 1, 4, 1, 1, relu=False, name='conv4-2'))\n    `   \n  `model_path='./'\n  export_dir='./pb/'\n  g1 = tf.Graph()\n  sess1 = tf.Session(graph=g1)\n  with sess1.as_default(): \n      with g1.as_default():\n          with tf.variable_scope('pnet'):\n              data = tf.placeholder(tf.float32, (None,None,None,3), 'input')\n              pnet = PNet({'data':data})\n             pnet.load(os.path.join(model_path, 'det1.npy'), sess1)\n        \nfrozen_graphdef = tf.graph_util.convert_variables_to_constants(\n      sess1, sess1.graph_def, ['pnet/conv4-2/BiasAdd', 'pnet/conv4-1/BiasAdd'])\ntf.train.write_graph(frozen_graphdef,export_dir, 'Pnet.pb', as_text=False)  \nprint ('finis')\n\n`", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:Linux Ubuntu 16.04\r\n- **Mobile device (e.g iphone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:iphone 6s\r\n- **TensorFlow installed from (source or binary)**:no\r\n- **TensorFlow version (use command below)**:1.9\r\n- **Python version**:3.5\r\n- **Bazel version (if compiling from source)**:0.12\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nI use my model in tensorflowlite ,it have two outputs,but in my iphone6s only get one output!\r\n\r\n(py35) ljg@ljg-linux:~/facenet/src/align/pb$ /home/ljg/tensorflow/bazel-bin/tensorflow/tools/graph_transforms/summarize_graph --in_graph=Pnet.pb\r\nFound 1 possible inputs: (name=pnet/input, type=float(1), shape=[?,?,?,3]) \r\nNo variables spotted.\r\nFound 2 possible outputs: (name=pnet/conv4-1/BiasAdd, op=BiasAdd) (name=pnet/conv4-2/BiasAdd, op=BiasAdd) \r\nFound 6632 (6.63k) const parameters, 0 (0) variable parameters, and 0 control_edges\r\nOp types used: 13 Const, 13 Identity, 6 Neg, 6 Relu, 5 BiasAdd, 5 Conv2D, 3 Add, 3 Mul, 1 MaxPool, 1 Placeholder\r\nTo use with tensorflow/tools/benchmark:benchmark_model try these arguments:\r\nbazel run tensorflow/tools/benchmark:benchmark_model -- --graph=Pnet.pb --show_flops --input_layer=pnet/input --input_layer_type=float --input_layer_shape=-1,-1,-1,3 --output_layer=pnet/conv4-1/BiasAdd,pnet/conv4-2/BiasAdd\r\n\r\n/home/ljg/tensorflow-1.9.0/bazel-bin/tensorflow/contrib/lite/toco/toco --input_file=Pnet.pb --input_format=TENSORFLOW_GRAPHDEF  --output_format=TFLITE --output_file=Pnet.tflite  --inference_type=FLOAT --inference_input_type=FLOAT --input_shape=1,12,12,3 --input_array=pnet/input --output_array=pnet/conv4-1/BiasAdd pnet/conv4-2/BiasAdd\r\n\r\n![problem](https://user-images.githubusercontent.com/13581022/43180218-6e6282b0-9009-11e8-8bd4-f1d6046ba7e5.png)\r\n\r\n### Source code / logs\r\n    `class PNet(Network):\r\n        def setup(self):\r\n             (self.feed('data') \r\n             .conv(3, 3, 10, 1, 1, padding='VALID', relu=False, name='conv1')\r\n             .prelu(name='PReLU1')\r\n             .max_pool(2, 2, 2, 2, name='pool1')\r\n             .conv(3, 3, 16, 1, 1, padding='VALID', relu=False, name='conv2')\r\n             .prelu(name='PReLU2')\r\n             .conv(3, 3, 32, 1, 1, padding='VALID', relu=False, name='conv3')\r\n             .prelu(name='PReLU3')\r\n             .conv(1, 1, 2, 1, 1, relu=False, name='conv4-1'))\r\n             .softmax(3,name='prob1'))\r\n\r\n             (self.feed('PReLU3') \r\n             .conv(1, 1, 4, 1, 1, relu=False, name='conv4-2'))\r\n        `   \r\n      `model_path='./'\r\n      export_dir='./pb/'\r\n      g1 = tf.Graph()\r\n      sess1 = tf.Session(graph=g1)\r\n      with sess1.as_default(): \r\n          with g1.as_default():\r\n              with tf.variable_scope('pnet'):\r\n                  data = tf.placeholder(tf.float32, (None,None,None,3), 'input')\r\n                  pnet = PNet({'data':data})\r\n                 pnet.load(os.path.join(model_path, 'det1.npy'), sess1)\r\n            \r\n    frozen_graphdef = tf.graph_util.convert_variables_to_constants(\r\n          sess1, sess1.graph_def, ['pnet/conv4-2/BiasAdd', 'pnet/conv4-1/BiasAdd'])\r\n    tf.train.write_graph(frozen_graphdef,export_dir, 'Pnet.pb', as_text=False)  \r\n    print ('finis')\r\n`     \r\n\r\n"}