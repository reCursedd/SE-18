{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/409498725", "html_url": "https://github.com/tensorflow/tensorflow/pull/20003#issuecomment-409498725", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20003", "id": 409498725, "node_id": "MDEyOklzc3VlQ29tbWVudDQwOTQ5ODcyNQ==", "user": {"login": "perfinion", "id": 363227, "node_id": "MDQ6VXNlcjM2MzIyNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/363227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/perfinion", "html_url": "https://github.com/perfinion", "followers_url": "https://api.github.com/users/perfinion/followers", "following_url": "https://api.github.com/users/perfinion/following{/other_user}", "gists_url": "https://api.github.com/users/perfinion/gists{/gist_id}", "starred_url": "https://api.github.com/users/perfinion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/perfinion/subscriptions", "organizations_url": "https://api.github.com/users/perfinion/orgs", "repos_url": "https://api.github.com/users/perfinion/repos", "events_url": "https://api.github.com/users/perfinion/events{/privacy}", "received_events_url": "https://api.github.com/users/perfinion/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-01T08:42:16Z", "updated_at": "2018-08-01T08:42:16Z", "author_association": "MEMBER", "body_html": "<p>Thanks for this! I originally did the --strip=always fix for an older version but didnt get around to adding a configure flag for it.</p>\n<p>Isn't it cleaner to put the check inside set_build_strip_flag()?<br>\nalso the fix commits should be squashed down i think.</p>\n<p>something like:</p>\n<pre><code>diff --git a/configure.py b/configure.py\nindex f97bf8a668..884e50d741 100644\n--- a/configure.py\n+++ b/configure.py\n@@ -1399,7 +1399,8 @@ def set_grpc_build_flags():\n \n \n def set_build_strip_flag():\n-  write_to_bazelrc('build --strip=always')\n+  if environ_cp.get(\"BAZEL_STRIP\") != \"0\":\n+    write_to_bazelrc('build --strip=always')\n \n \n def set_windows_build_flags(environ_cp):\n</code></pre>", "body_text": "Thanks for this! I originally did the --strip=always fix for an older version but didnt get around to adding a configure flag for it.\nIsn't it cleaner to put the check inside set_build_strip_flag()?\nalso the fix commits should be squashed down i think.\nsomething like:\ndiff --git a/configure.py b/configure.py\nindex f97bf8a668..884e50d741 100644\n--- a/configure.py\n+++ b/configure.py\n@@ -1399,7 +1399,8 @@ def set_grpc_build_flags():\n \n \n def set_build_strip_flag():\n-  write_to_bazelrc('build --strip=always')\n+  if environ_cp.get(\"BAZEL_STRIP\") != \"0\":\n+    write_to_bazelrc('build --strip=always')\n \n \n def set_windows_build_flags(environ_cp):", "body": "Thanks for this! I originally did the --strip=always fix for an older version but didnt get around to adding a configure flag for it.\r\n\r\nIsn't it cleaner to put the check inside set_build_strip_flag()?\r\nalso the fix commits should be squashed down i think.\r\n\r\nsomething like:\r\n```\r\ndiff --git a/configure.py b/configure.py\r\nindex f97bf8a668..884e50d741 100644\r\n--- a/configure.py\r\n+++ b/configure.py\r\n@@ -1399,7 +1399,8 @@ def set_grpc_build_flags():\r\n \r\n \r\n def set_build_strip_flag():\r\n-  write_to_bazelrc('build --strip=always')\r\n+  if environ_cp.get(\"BAZEL_STRIP\") != \"0\":\r\n+    write_to_bazelrc('build --strip=always')\r\n \r\n \r\n def set_windows_build_flags(environ_cp):\r\n```"}