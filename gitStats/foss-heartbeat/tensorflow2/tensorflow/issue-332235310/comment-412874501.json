{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/412874501", "html_url": "https://github.com/tensorflow/tensorflow/pull/20003#issuecomment-412874501", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20003", "id": 412874501, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMjg3NDUwMQ==", "user": {"login": "perfinion", "id": 363227, "node_id": "MDQ6VXNlcjM2MzIyNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/363227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/perfinion", "html_url": "https://github.com/perfinion", "followers_url": "https://api.github.com/users/perfinion/followers", "following_url": "https://api.github.com/users/perfinion/following{/other_user}", "gists_url": "https://api.github.com/users/perfinion/gists{/gist_id}", "starred_url": "https://api.github.com/users/perfinion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/perfinion/subscriptions", "organizations_url": "https://api.github.com/users/perfinion/orgs", "repos_url": "https://api.github.com/users/perfinion/repos", "events_url": "https://api.github.com/users/perfinion/events{/privacy}", "received_events_url": "https://api.github.com/users/perfinion/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-14T13:38:05Z", "updated_at": "2018-08-14T13:38:05Z", "author_association": "MEMBER", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=577277\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/martinwicke\">@martinwicke</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=10539540\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/samikama\">@samikama</a><br>\nThey correspond to nothing in .bazelrc, --strip=never, and --strip=always</p>\n<pre><code>$ ls -l /tmp/dst-*strip/*.whl\n-rw-r--r--. 1 jason users 50544207 Aug 14 20:51 /tmp/dst-neverstrip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\n-rw-r--r--. 1 jason users 50544200 Aug 14 20:45 /tmp/dst-nostrip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\n-rw-r--r--. 1 jason users 50544200 Aug 14 20:48 /tmp/dst-strip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\n</code></pre>\n<p>Interestingly, I went back and looked at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/1039ff9ee8c8c7ed09f9bb106131a50285866dd4/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/1039ff9ee8c8c7ed09f9bb106131a50285866dd4\"><tt>1039ff9</tt></a> which was the commit where I removed the <code>-s</code> flags. Those were only ever on libtensorflow{,_cc}.so. Not on libtensorflow_framework.so. The wheels only contain the _framework.so. The .so and _cc.so are not distributed on PyPI so shouldn't actually have made a difference anyway.</p>\n<p>The <em>really</em> heavy handed way to strip is <code>--linkopt=-Wl,--strip-all</code>, but even that one only saves ~3.8MB on the entire wheel so also isn't worth the downsides.</p>", "body_text": "@martinwicke @samikama\nThey correspond to nothing in .bazelrc, --strip=never, and --strip=always\n$ ls -l /tmp/dst-*strip/*.whl\n-rw-r--r--. 1 jason users 50544207 Aug 14 20:51 /tmp/dst-neverstrip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\n-rw-r--r--. 1 jason users 50544200 Aug 14 20:45 /tmp/dst-nostrip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\n-rw-r--r--. 1 jason users 50544200 Aug 14 20:48 /tmp/dst-strip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\n\nInterestingly, I went back and looked at 1039ff9 which was the commit where I removed the -s flags. Those were only ever on libtensorflow{,_cc}.so. Not on libtensorflow_framework.so. The wheels only contain the _framework.so. The .so and _cc.so are not distributed on PyPI so shouldn't actually have made a difference anyway.\nThe really heavy handed way to strip is --linkopt=-Wl,--strip-all, but even that one only saves ~3.8MB on the entire wheel so also isn't worth the downsides.", "body": "@martinwicke @samikama \r\nThey correspond to nothing in .bazelrc, --strip=never, and --strip=always\r\n```\r\n$ ls -l /tmp/dst-*strip/*.whl\r\n-rw-r--r--. 1 jason users 50544207 Aug 14 20:51 /tmp/dst-neverstrip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\r\n-rw-r--r--. 1 jason users 50544200 Aug 14 20:45 /tmp/dst-nostrip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\r\n-rw-r--r--. 1 jason users 50544200 Aug 14 20:48 /tmp/dst-strip/tensorflow-1.10.0-cp36-cp36m-linux_x86_64.whl\r\n```\r\nInterestingly, I went back and looked at 1039ff9ee8c8c7ed09f9bb106131a50285866dd4 which was the commit where I removed the `-s` flags. Those were only ever on libtensorflow{,_cc}.so. Not on libtensorflow_framework.so. The wheels only contain the _framework.so. The .so and _cc.so are not distributed on PyPI so shouldn't actually have made a difference anyway.\r\n\r\nThe *really* heavy handed way to strip is `--linkopt=-Wl,--strip-all`, but even that one only saves ~3.8MB on the entire wheel so also isn't worth the downsides. "}