{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/408402317", "html_url": "https://github.com/tensorflow/tensorflow/issues/20334#issuecomment-408402317", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20334", "id": 408402317, "node_id": "MDEyOklzc3VlQ29tbWVudDQwODQwMjMxNw==", "user": {"login": "2649", "id": 17809849, "node_id": "MDQ6VXNlcjE3ODA5ODQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/17809849?v=4", "gravatar_id": "", "url": "https://api.github.com/users/2649", "html_url": "https://github.com/2649", "followers_url": "https://api.github.com/users/2649/followers", "following_url": "https://api.github.com/users/2649/following{/other_user}", "gists_url": "https://api.github.com/users/2649/gists{/gist_id}", "starred_url": "https://api.github.com/users/2649/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/2649/subscriptions", "organizations_url": "https://api.github.com/users/2649/orgs", "repos_url": "https://api.github.com/users/2649/repos", "events_url": "https://api.github.com/users/2649/events{/privacy}", "received_events_url": "https://api.github.com/users/2649/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-27T12:17:30Z", "updated_at": "2018-07-27T12:56:21Z", "author_association": "NONE", "body_html": "<p>I have the same error. My message looks liek this:</p>\n<p><code>ValueError: Incompatible shapes between op input and calculated input gradient.  Forward operation: decoder/conv3d_transpose/conv3d_transpose.  Input index: 2. Original input shape: (30, 149, 149, 1, 8).  Calculated input gradient shape: (30, 298, 298, 1, 8)</code>.</p>\n<p>It seems that the calculated shape of the gradient does not match with the output shape that one has to give the function conv_transpose. In my case the error only occurs in my code with a stride &gt; 1 and a deconv -&gt; conv  -&gt; deconv -&gt; conv ... architecture for the decoder (For an AE). Iam not sure if this is a bug or If I did something wrong. But since I have a symmetric AE it could be a bug.</p>\n<p><strong>EDIT</strong></p>\n<p>After further investigation it looks like a bug:<br>\nI perform a 2d convolution with stride = 2 and padding =\"SAME\" and tf reduces the size from 298 to 149. I checked my connections in tensorboard and did nothing wrong. This is the output of the specific node:</p>\n<pre><code>\n`decoder/conv_same_3/Conv2D\nOperation: Conv2D\nAttributes (6)\nT {\"type\":\"DT_FLOAT\"}\ndata_format {\"s\":\"NHWC\"}\ndilations {\"list\":{\"i\":[1,1,1,1]}}\npadding {\"s\":\"SAME\"}\nstrides {\"list\":{\"i\":[1,2,2,1]}}\nuse_cudnn_on_gpu {\"b\":true}\nInputs (2) decoder/conv2d_transpose_3/Relu 30\u00d7298\u00d7298\u00d78\n    default_variable_decoder/conv2d_transpose_3_w/read 2\u00d72\u00d78\u00d78 \nOutputs (1) decoder/conv_same_3/BiasAdd 30\u00d7149\u00d7149\u00d78\n</code></pre>\n<p>`</p>", "body_text": "I have the same error. My message looks liek this:\nValueError: Incompatible shapes between op input and calculated input gradient.  Forward operation: decoder/conv3d_transpose/conv3d_transpose.  Input index: 2. Original input shape: (30, 149, 149, 1, 8).  Calculated input gradient shape: (30, 298, 298, 1, 8).\nIt seems that the calculated shape of the gradient does not match with the output shape that one has to give the function conv_transpose. In my case the error only occurs in my code with a stride > 1 and a deconv -> conv  -> deconv -> conv ... architecture for the decoder (For an AE). Iam not sure if this is a bug or If I did something wrong. But since I have a symmetric AE it could be a bug.\nEDIT\nAfter further investigation it looks like a bug:\nI perform a 2d convolution with stride = 2 and padding =\"SAME\" and tf reduces the size from 298 to 149. I checked my connections in tensorboard and did nothing wrong. This is the output of the specific node:\n\n`decoder/conv_same_3/Conv2D\nOperation: Conv2D\nAttributes (6)\nT {\"type\":\"DT_FLOAT\"}\ndata_format {\"s\":\"NHWC\"}\ndilations {\"list\":{\"i\":[1,1,1,1]}}\npadding {\"s\":\"SAME\"}\nstrides {\"list\":{\"i\":[1,2,2,1]}}\nuse_cudnn_on_gpu {\"b\":true}\nInputs (2) decoder/conv2d_transpose_3/Relu 30\u00d7298\u00d7298\u00d78\n    default_variable_decoder/conv2d_transpose_3_w/read 2\u00d72\u00d78\u00d78 \nOutputs (1) decoder/conv_same_3/BiasAdd 30\u00d7149\u00d7149\u00d78\n\n`", "body": "I have the same error. My message looks liek this:\r\n\r\n `ValueError: Incompatible shapes between op input and calculated input gradient.  Forward operation: decoder/conv3d_transpose/conv3d_transpose.  Input index: 2. Original input shape: (30, 149, 149, 1, 8).  Calculated input gradient shape: (30, 298, 298, 1, 8)`.\r\n\r\n It seems that the calculated shape of the gradient does not match with the output shape that one has to give the function conv_transpose. In my case the error only occurs in my code with a stride > 1 and a deconv -> conv  -> deconv -> conv ... architecture for the decoder (For an AE). Iam not sure if this is a bug or If I did something wrong. But since I have a symmetric AE it could be a bug.\r\n\r\n**EDIT**\r\n\r\nAfter further investigation it looks like a bug: \r\nI perform a 2d convolution with stride = 2 and padding =\"SAME\" and tf reduces the size from 298 to 149. I checked my connections in tensorboard and did nothing wrong. This is the output of the specific node:\r\n```\r\n\r\n`decoder/conv_same_3/Conv2D\r\nOperation: Conv2D\r\nAttributes (6)\r\nT {\"type\":\"DT_FLOAT\"}\r\ndata_format {\"s\":\"NHWC\"}\r\ndilations {\"list\":{\"i\":[1,1,1,1]}}\r\npadding {\"s\":\"SAME\"}\r\nstrides {\"list\":{\"i\":[1,2,2,1]}}\r\nuse_cudnn_on_gpu {\"b\":true}\r\nInputs (2) decoder/conv2d_transpose_3/Relu 30\u00d7298\u00d7298\u00d78\r\n    default_variable_decoder/conv2d_transpose_3_w/read 2\u00d72\u00d78\u00d78 \r\nOutputs (1) decoder/conv_same_3/BiasAdd 30\u00d7149\u00d7149\u00d78\r\n```\r\n`"}