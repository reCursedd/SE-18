{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17232", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17232/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17232/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17232/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/17232", "id": 299881128, "node_id": "MDU6SXNzdWUyOTk4ODExMjg=", "number": 17232, "title": "Cmake build doesn't work on ubuntu 16.04", "user": {"login": "achalshah20", "id": 9772589, "node_id": "MDQ6VXNlcjk3NzI1ODk=", "avatar_url": "https://avatars0.githubusercontent.com/u/9772589?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achalshah20", "html_url": "https://github.com/achalshah20", "followers_url": "https://api.github.com/users/achalshah20/followers", "following_url": "https://api.github.com/users/achalshah20/following{/other_user}", "gists_url": "https://api.github.com/users/achalshah20/gists{/gist_id}", "starred_url": "https://api.github.com/users/achalshah20/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achalshah20/subscriptions", "organizations_url": "https://api.github.com/users/achalshah20/orgs", "repos_url": "https://api.github.com/users/achalshah20/repos", "events_url": "https://api.github.com/users/achalshah20/events{/privacy}", "received_events_url": "https://api.github.com/users/achalshah20/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2018-02-23T23:21:33Z", "updated_at": "2018-04-26T20:47:52Z", "closed_at": "2018-04-26T20:47:52Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Source</li>\n<li><strong>TensorFlow version (use command below)</strong>: Latest from master branch</li>\n<li><strong>Python version</strong>: 2.7</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 5.4</li>\n<li><strong>CUDA/cuDNN version</strong>: Cuda 9.1, cuDNN 7.0.5</li>\n<li><strong>GPU model and memory</strong>: GeForce GTX TITAN X, 12288 MB</li>\n<li><strong>Exact command to reproduce</strong>:<br>\ngit clone <a href=\"https://github.com/tensorflow/tensorflow\">https://github.com/tensorflow/tensorflow</a><br>\ncd tensorflow/tensorflow/contrib/cmake/<br>\nmkdir build &amp;&amp; cd build<br>\nccmake .. [correct cuda version and add nccl library, idk why that was mandatory though.]<br>\nmake -j</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I am trying to compile tensorflow with cmake on ubuntu 16.04. Some issues I have faced till now:</p>\n<p><strong>1. cuda/extras/CUPTI/include/cupti.h no found (In cupti_wrapper.h)</strong><br>\nTemp fix: I saw \"cuda/extras/CUPTI/include\" is already included in the cmake. So, changed \"cuda/extras/CUPTI/include/cupti.h\" =&gt; \"cupti.h\" and it works.</p>\n<p><strong>2. src/nccl.h not found (In nccl_manager.h and nccl_ops.cc)</strong><br>\nTemp fix: nccl v2 doesnt have src folder but nccl.h can be found in /usr/include/. So, changed<br>\n\"src/nccl.h\" =&gt; nccl.h and it works</p>\n<p><strong>3. GRPC is not linked to libpywrap_tensorflow_internal.so (Not fixed yet)</strong><br>\n<code>[100%] Running SWIG to generate Python wrappers [100%] Building CXX object CMakeFiles/pywrap_tensorflow_internal.dir/pywrap_tensorflow_internal.cc.o [100%] Linking CXX shared library libpywrap_tensorflow_internal.so grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function </code>on_txt_done_cb(void*, int, int, unsigned char*, int)':<br>\ngrpc_ares_wrapper.cc:(.text+0x256): undefined reference to <code>ares_parse_txt_reply_ext' grpc_ares_wrapper.cc:(.text+0x267): undefined reference to </code>ares_strerror'<br>\ngrpc_ares_wrapper.cc:(.text+0x363): undefined reference to <code>ares_free_data' grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function </code>on_srv_query_done_cb(void*, int, int, unsigned char*, int)':<br>\ngrpc_ares_wrapper.cc:(.text+0x65a): undefined reference to <code>ares_parse_srv_reply' grpc_ares_wrapper.cc:(.text+0x677): undefined reference to </code>ares_free_data'<br>\ngrpc_ares_wrapper.cc:(.text+0x683): undefined reference to <code>ares_strerror' grpc_ares_wrapper.cc:(.text+0x7cf): undefined reference to </code>ares_gethostbyname'<br>\ngrpc_ares_wrapper.cc:(.text+0x830): undefined reference to <code>ares_gethostbyname' grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function </code>on_hostbyname_done_cb(void*, int, int, hostent*)':<br>\ngrpc_ares_wrapper.cc:(.text+0x964): undefined reference to <code>ares_strerror' grpc_ares_wrapper.cc:(.text+0xb7d): undefined reference to </code>ares_inet_ntop'<br>\ngrpc_ares_wrapper.cc:(.text+0xc62): undefined reference to <code>ares_inet_ntop' grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function </code>grpc_dns_lookup_ares_impl(char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**)':<br>\n`<br>\n<strong>4. Can't fix with GRPC OFF in ccmake (Not fixed yet)</strong></p>\n<p>There are so many issues in CMake and I am not able to build directly on ubuntu 16.04. Can someone look into this? Thanks!</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\nTensorFlow installed from (source or binary): Source\nTensorFlow version (use command below): Latest from master branch\nPython version: 2.7\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): 5.4\nCUDA/cuDNN version: Cuda 9.1, cuDNN 7.0.5\nGPU model and memory: GeForce GTX TITAN X, 12288 MB\nExact command to reproduce:\ngit clone https://github.com/tensorflow/tensorflow\ncd tensorflow/tensorflow/contrib/cmake/\nmkdir build && cd build\nccmake .. [correct cuda version and add nccl library, idk why that was mandatory though.]\nmake -j\n\nDescribe the problem\nI am trying to compile tensorflow with cmake on ubuntu 16.04. Some issues I have faced till now:\n1. cuda/extras/CUPTI/include/cupti.h no found (In cupti_wrapper.h)\nTemp fix: I saw \"cuda/extras/CUPTI/include\" is already included in the cmake. So, changed \"cuda/extras/CUPTI/include/cupti.h\" => \"cupti.h\" and it works.\n2. src/nccl.h not found (In nccl_manager.h and nccl_ops.cc)\nTemp fix: nccl v2 doesnt have src folder but nccl.h can be found in /usr/include/. So, changed\n\"src/nccl.h\" => nccl.h and it works\n3. GRPC is not linked to libpywrap_tensorflow_internal.so (Not fixed yet)\n[100%] Running SWIG to generate Python wrappers [100%] Building CXX object CMakeFiles/pywrap_tensorflow_internal.dir/pywrap_tensorflow_internal.cc.o [100%] Linking CXX shared library libpywrap_tensorflow_internal.so grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function on_txt_done_cb(void*, int, int, unsigned char*, int)':\ngrpc_ares_wrapper.cc:(.text+0x256): undefined reference to ares_parse_txt_reply_ext' grpc_ares_wrapper.cc:(.text+0x267): undefined reference to ares_strerror'\ngrpc_ares_wrapper.cc:(.text+0x363): undefined reference to ares_free_data' grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function on_srv_query_done_cb(void*, int, int, unsigned char*, int)':\ngrpc_ares_wrapper.cc:(.text+0x65a): undefined reference to ares_parse_srv_reply' grpc_ares_wrapper.cc:(.text+0x677): undefined reference to ares_free_data'\ngrpc_ares_wrapper.cc:(.text+0x683): undefined reference to ares_strerror' grpc_ares_wrapper.cc:(.text+0x7cf): undefined reference to ares_gethostbyname'\ngrpc_ares_wrapper.cc:(.text+0x830): undefined reference to ares_gethostbyname' grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function on_hostbyname_done_cb(void*, int, int, hostent*)':\ngrpc_ares_wrapper.cc:(.text+0x964): undefined reference to ares_strerror' grpc_ares_wrapper.cc:(.text+0xb7d): undefined reference to ares_inet_ntop'\ngrpc_ares_wrapper.cc:(.text+0xc62): undefined reference to ares_inet_ntop' grpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function grpc_dns_lookup_ares_impl(char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**)':\n`\n4. Can't fix with GRPC OFF in ccmake (Not fixed yet)\nThere are so many issues in CMake and I am not able to build directly on ubuntu 16.04. Can someone look into this? Thanks!", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: Latest from master branch\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: 5.4\r\n- **CUDA/cuDNN version**: Cuda 9.1, cuDNN 7.0.5\r\n- **GPU model and memory**: GeForce GTX TITAN X, 12288 MB\r\n- **Exact command to reproduce**:\r\ngit clone https://github.com/tensorflow/tensorflow\r\ncd tensorflow/tensorflow/contrib/cmake/\r\nmkdir build && cd build \r\nccmake .. [correct cuda version and add nccl library, idk why that was mandatory though.]\r\nmake -j\r\n\r\n\r\n### Describe the problem\r\nI am trying to compile tensorflow with cmake on ubuntu 16.04. Some issues I have faced till now:\r\n\r\n**1. cuda/extras/CUPTI/include/cupti.h no found (In cupti_wrapper.h)**\r\nTemp fix: I saw \"cuda/extras/CUPTI/include\" is already included in the cmake. So, changed \"cuda/extras/CUPTI/include/cupti.h\" => \"cupti.h\" and it works.\r\n\r\n**2. src/nccl.h not found (In nccl_manager.h and nccl_ops.cc)**\r\nTemp fix: nccl v2 doesnt have src folder but nccl.h can be found in /usr/include/. So, changed\r\n\"src/nccl.h\" => nccl.h and it works\r\n\r\n**3. GRPC is not linked to libpywrap_tensorflow_internal.so (Not fixed yet)**\r\n`[100%] Running SWIG to generate Python wrappers\r\n[100%] Building CXX object CMakeFiles/pywrap_tensorflow_internal.dir/pywrap_tensorflow_internal.cc.o\r\n[100%] Linking CXX shared library libpywrap_tensorflow_internal.so\r\ngrpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function `on_txt_done_cb(void*, int, int, unsigned char*, int)':\r\ngrpc_ares_wrapper.cc:(.text+0x256): undefined reference to `ares_parse_txt_reply_ext'\r\ngrpc_ares_wrapper.cc:(.text+0x267): undefined reference to `ares_strerror'\r\ngrpc_ares_wrapper.cc:(.text+0x363): undefined reference to `ares_free_data'\r\ngrpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function `on_srv_query_done_cb(void*, int, int, unsigned char*, int)':\r\ngrpc_ares_wrapper.cc:(.text+0x65a): undefined reference to `ares_parse_srv_reply'\r\ngrpc_ares_wrapper.cc:(.text+0x677): undefined reference to `ares_free_data'\r\ngrpc_ares_wrapper.cc:(.text+0x683): undefined reference to `ares_strerror'\r\ngrpc_ares_wrapper.cc:(.text+0x7cf): undefined reference to `ares_gethostbyname'\r\ngrpc_ares_wrapper.cc:(.text+0x830): undefined reference to `ares_gethostbyname'\r\ngrpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function `on_hostbyname_done_cb(void*, int, int, hostent*)':\r\ngrpc_ares_wrapper.cc:(.text+0x964): undefined reference to `ares_strerror'\r\ngrpc_ares_wrapper.cc:(.text+0xb7d): undefined reference to `ares_inet_ntop'\r\ngrpc_ares_wrapper.cc:(.text+0xc62): undefined reference to `ares_inet_ntop'\r\ngrpc/src/grpc/libgrpc_unsecure.a(grpc_ares_wrapper.cc.o): In function `grpc_dns_lookup_ares_impl(char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**)':\r\n`\r\n**4. Can't fix with GRPC OFF in ccmake (Not fixed yet)**\r\n\r\nThere are so many issues in CMake and I am not able to build directly on ubuntu 16.04. Can someone look into this? Thanks!"}