{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/380277565", "html_url": "https://github.com/tensorflow/tensorflow/issues/10749#issuecomment-380277565", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10749", "id": 380277565, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDI3NzU2NQ==", "user": {"login": "rryan", "id": 26527, "node_id": "MDQ6VXNlcjI2NTI3", "avatar_url": "https://avatars3.githubusercontent.com/u/26527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rryan", "html_url": "https://github.com/rryan", "followers_url": "https://api.github.com/users/rryan/followers", "following_url": "https://api.github.com/users/rryan/following{/other_user}", "gists_url": "https://api.github.com/users/rryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rryan/subscriptions", "organizations_url": "https://api.github.com/users/rryan/orgs", "repos_url": "https://api.github.com/users/rryan/repos", "events_url": "https://api.github.com/users/rryan/events{/privacy}", "received_events_url": "https://api.github.com/users/rryan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-10T23:19:33Z", "updated_at": "2018-04-10T23:19:33Z", "author_association": "MEMBER", "body_html": "<p>Different results make sense, since the computation is being run by different hardware implementations of IEEE-754. Also, the implementation of reductions across CPU and GPU can be quite different. I've heard that Eigen on CPU can produce non-deterministic results when computing e.g. reductions using a thread pool.</p>\n<p>One way to eliminate Eigen CPU non-determinism as a factor in testing is to set <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/protobuf/config.proto#L273\">intra_op_parallelism_threads</a> to 1 in your ConfigProto.</p>\n<p>Differences can also arise from software bugs though, so please do file issues, ideally with reproducible test cases, for places where you think the difference might be a bug.</p>", "body_text": "Different results make sense, since the computation is being run by different hardware implementations of IEEE-754. Also, the implementation of reductions across CPU and GPU can be quite different. I've heard that Eigen on CPU can produce non-deterministic results when computing e.g. reductions using a thread pool.\nOne way to eliminate Eigen CPU non-determinism as a factor in testing is to set intra_op_parallelism_threads to 1 in your ConfigProto.\nDifferences can also arise from software bugs though, so please do file issues, ideally with reproducible test cases, for places where you think the difference might be a bug.", "body": "Different results make sense, since the computation is being run by different hardware implementations of IEEE-754. Also, the implementation of reductions across CPU and GPU can be quite different. I've heard that Eigen on CPU can produce non-deterministic results when computing e.g. reductions using a thread pool. \r\n\r\nOne way to eliminate Eigen CPU non-determinism as a factor in testing is to set [intra_op_parallelism_threads](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/protobuf/config.proto#L273) to 1 in your ConfigProto.\r\n\r\nDifferences can also arise from software bugs though, so please do file issues, ideally with reproducible test cases, for places where you think the difference might be a bug."}