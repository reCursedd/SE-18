{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19081", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19081/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19081/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19081/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19081", "id": 320206792, "node_id": "MDU6SXNzdWUzMjAyMDY3OTI=", "number": 19081, "title": "tensorflow/python/ops/init_ops.py line 466 - initialization scaling incorrect?", "user": {"login": "Bhumbra", "id": 2971392, "node_id": "MDQ6VXNlcjI5NzEzOTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/2971392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bhumbra", "html_url": "https://github.com/Bhumbra", "followers_url": "https://api.github.com/users/Bhumbra/followers", "following_url": "https://api.github.com/users/Bhumbra/following{/other_user}", "gists_url": "https://api.github.com/users/Bhumbra/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bhumbra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bhumbra/subscriptions", "organizations_url": "https://api.github.com/users/Bhumbra/orgs", "repos_url": "https://api.github.com/users/Bhumbra/repos", "events_url": "https://api.github.com/users/Bhumbra/events{/privacy}", "received_events_url": "https://api.github.com/users/Bhumbra/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-05-04T09:24:24Z", "updated_at": "2018-06-04T20:24:36Z", "closed_at": "2018-06-04T20:24:36Z", "author_association": "NONE", "body_html": "<h3>System information : NOT APPLICABLE</h3>\n<p>Have I written custom code: No and N/A<br>\nOS Platform and Distribution: GNU/Linux Gentoo and N/A<br>\nTensorFlow installed from: <a href=\"https://www.tensorflow.org/install/install_sources\" rel=\"nofollow\">https://www.tensorflow.org/install/install_sources</a><br>\nTensorFlow version:  1.6.0 but relevant to stable version on GitHub<br>\nBazel version: 0.11.1 and N/A<br>\nCUDA/cuDNN version: 9.1/7.1 and N/A<br>\nGPU model and memory: Titan XP x2 - 12GB x2 and N/A<br>\nExact command to reproduce: N/A</p>\n<h3>Source code / logs:</h3>\n<p>tensorflow/python/ops/init_ops.py - lines 465-469:</p>\n<pre><code>    if self.distribution == \"normal\":\n      stddev = math.sqrt(scale)\n      return random_ops.truncated_normal(\n          shape, 0.0, stddev, dtype, seed=self.seed)\n</code></pre>\n<h3>Describe the problem:</h3>\n<p>According to He et al (2015) [http://arxiv.org/abs/1502.0185] (Eq. 10) the correct scaling for the standard deviation for kernel initialization is sqrt(2/n). However line 466 of tensorflow/python/ops/init_ops.py reads:</p>\n<p><code>stddev = math.sqrt(scale)</code></p>\n<p>where the default <code>scale</code> is 1/n (n depending on fan mode), corresponding to sqrt(1/n) rather than sqrt(2/n) - therefore giving half the correct scaling.</p>\n<p>Also - since a truncated (-2SD to +2SD) normal distribution is used rather than a full distribution, shouldn't the scale be multiplied by 1.137? Perhaps the simplest fix is therefore:</p>\n<p><code>stddev = math.sqrt(2.274*scale)</code></p>", "body_text": "System information : NOT APPLICABLE\nHave I written custom code: No and N/A\nOS Platform and Distribution: GNU/Linux Gentoo and N/A\nTensorFlow installed from: https://www.tensorflow.org/install/install_sources\nTensorFlow version:  1.6.0 but relevant to stable version on GitHub\nBazel version: 0.11.1 and N/A\nCUDA/cuDNN version: 9.1/7.1 and N/A\nGPU model and memory: Titan XP x2 - 12GB x2 and N/A\nExact command to reproduce: N/A\nSource code / logs:\ntensorflow/python/ops/init_ops.py - lines 465-469:\n    if self.distribution == \"normal\":\n      stddev = math.sqrt(scale)\n      return random_ops.truncated_normal(\n          shape, 0.0, stddev, dtype, seed=self.seed)\n\nDescribe the problem:\nAccording to He et al (2015) [http://arxiv.org/abs/1502.0185] (Eq. 10) the correct scaling for the standard deviation for kernel initialization is sqrt(2/n). However line 466 of tensorflow/python/ops/init_ops.py reads:\nstddev = math.sqrt(scale)\nwhere the default scale is 1/n (n depending on fan mode), corresponding to sqrt(1/n) rather than sqrt(2/n) - therefore giving half the correct scaling.\nAlso - since a truncated (-2SD to +2SD) normal distribution is used rather than a full distribution, shouldn't the scale be multiplied by 1.137? Perhaps the simplest fix is therefore:\nstddev = math.sqrt(2.274*scale)", "body": "### System information : NOT APPLICABLE\r\nHave I written custom code: No and N/A\r\nOS Platform and Distribution: GNU/Linux Gentoo and N/A\r\nTensorFlow installed from: https://www.tensorflow.org/install/install_sources\r\nTensorFlow version:  1.6.0 but relevant to stable version on GitHub\r\nBazel version: 0.11.1 and N/A\r\nCUDA/cuDNN version: 9.1/7.1 and N/A\r\nGPU model and memory: Titan XP x2 - 12GB x2 and N/A\r\nExact command to reproduce: N/A\r\n### Source code / logs:\r\ntensorflow/python/ops/init_ops.py - lines 465-469:\r\n```\r\n    if self.distribution == \"normal\":\r\n      stddev = math.sqrt(scale)\r\n      return random_ops.truncated_normal(\r\n          shape, 0.0, stddev, dtype, seed=self.seed)\r\n```\r\n### Describe the problem:\r\nAccording to He et al (2015) [http://arxiv.org/abs/1502.0185] (Eq. 10) the correct scaling for the standard deviation for kernel initialization is sqrt(2/n). However line 466 of tensorflow/python/ops/init_ops.py reads:\r\n\r\n`stddev = math.sqrt(scale)`\r\n\r\nwhere the default `scale` is 1/n (n depending on fan mode), corresponding to sqrt(1/n) rather than sqrt(2/n) - therefore giving half the correct scaling.\r\n\r\nAlso - since a truncated (-2SD to +2SD) normal distribution is used rather than a full distribution, shouldn't the scale be multiplied by 1.137? Perhaps the simplest fix is therefore:\r\n\r\n`stddev = math.sqrt(2.274*scale)`\r\n "}