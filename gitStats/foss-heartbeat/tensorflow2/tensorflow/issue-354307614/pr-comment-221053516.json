{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/221053516", "pull_request_review_id": 159610580, "id": 221053516, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTA1MzUxNg==", "diff_hunk": "@@ -147,6 +147,66 @@ func (g *Graph) Operations() []Operation {\n \treturn ops\n }\n \n+// AddGradientsWithPrefix adds operations to compute the partial derivatives of sum of `y`s w.r.t `x`s,\n+// i.e., d(y_1 + y_2 + ...)/dx_1, d(y_1 + y_2 + ...)/dx_2...\n+// This methods allows to caller to pass a custom name prefix to the operations\n+// added to a graph to compute the gradients.\n+func (g *Graph) AddGradients(prefix string, y []Output, x []Output, dx []Output) ([]Output, error) {\n+\tvar (\n+\t\tcprefix = C.CString(prefix)\n+\n+\t\tcy  = make([]C.TF_Output, len(y))\n+\t\tcx  = make([]C.TF_Output, len(x))\n+\t\tcdx = make([]C.TF_Output, len(dx))\n+\t\tcdy = make([]C.TF_Output, len(x))\n+\n+\t\tpcy  *C.TF_Output\n+\t\tpcx  *C.TF_Output\n+\t\tpcdx *C.TF_Output\n+\t\tpcdy *C.TF_Output\n+\n+\t\tstatus = newStatus()\n+\t)\n+\n+\tif len(y) > 0 {\n+\t\tpcy = &cy[0]\n+\t\tfor i, o := range y {\n+\t\t\tcy[i] = o.c()\n+\t\t}\n+\t}\n+\tif len(x) > 0 {\n+\t\tpcx = &cx[0]\n+\t\tfor i, o := range x {\n+\t\t\tcx[i] = o.c()\n+\t\t}\n+\t\tpcdy = &cdy[0]\n+\t}\n+\tif len(dx) > 0 {\n+\t\tpcdx = &cdx[0]\n+\t\tfor i, o := range dx {\n+\t\t\tcdx[i] = o.c()\n+\t\t}\n+\t}\n+\n+\t// If prefix is \"\", the C.TF_AddGradientsWithPrefix need cprefix to be nil but not \"\"", "path": "tensorflow/go/graph.go", "position": 46, "original_position": 45, "commit_id": "a911ecf5a94e037554f677670762b0122c062b41", "original_commit_id": "e40c032d62075621053262758c065f9bfb9faed9", "user": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "body": "How about:\r\n\r\n```go\r\nif len(prefix) == 0 {\r\n  cprefix = nil\r\n}\r\nC.TF_AddGradientsWithPrefix(...)\r\n```\r\n\r\ninstead of repeating the larger call and all its arguments?", "created_at": "2018-09-27T19:44:58Z", "updated_at": "2018-11-21T06:08:04Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/21895#discussion_r221053516", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21895", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/221053516"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/21895#discussion_r221053516"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/21895"}}, "body_html": "<p>How about:</p>\n<div class=\"highlight highlight-source-go\"><pre><span class=\"pl-k\">if</span> <span class=\"pl-c1\">len</span>(prefix) == <span class=\"pl-c1\">0</span> {\n  cprefix = <span class=\"pl-c1\">nil</span>\n}\nC.<span class=\"pl-c1\">TF_AddGradientsWithPrefix</span>(...)</pre></div>\n<p>instead of repeating the larger call and all its arguments?</p>", "body_text": "How about:\nif len(prefix) == 0 {\n  cprefix = nil\n}\nC.TF_AddGradientsWithPrefix(...)\ninstead of repeating the larger call and all its arguments?"}