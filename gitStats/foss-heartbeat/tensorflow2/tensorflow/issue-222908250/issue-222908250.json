{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9319", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9319/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9319/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9319/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/9319", "id": 222908250, "node_id": "MDU6SXNzdWUyMjI5MDgyNTA=", "number": 9319, "title": "[feature] Mobile Integration with NNPACK", "user": {"login": "cancan101", "id": 51059, "node_id": "MDQ6VXNlcjUxMDU5", "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cancan101", "html_url": "https://github.com/cancan101", "followers_url": "https://api.github.com/users/cancan101/followers", "following_url": "https://api.github.com/users/cancan101/following{/other_user}", "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}", "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions", "organizations_url": "https://api.github.com/users/cancan101/orgs", "repos_url": "https://api.github.com/users/cancan101/repos", "events_url": "https://api.github.com/users/cancan101/events{/privacy}", "received_events_url": "https://api.github.com/users/cancan101/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2017-04-20T00:09:19Z", "updated_at": "2018-07-28T19:53:19Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<p>Caffe2 use can use <a href=\"https://github.com/Maratyszcza/NNPACK\">NNPACK</a> for <a href=\"http://caffe2.ai/docs/mobile-integration.html#null__performance-considerations\" rel=\"nofollow\">which it says</a>:</p>\n<blockquote>\n<p>NNPACK, which specifically optimizes convolutions on ARM</p>\n</blockquote>\n<blockquote>\n<p>Currently Caffe2 is optimized for ARM CPUs with NEON (basically any ARM CPU since 2012). Perhaps surprisingly, ARM CPUs outperform the on-board GPUs (our NNPACK ARM CPU implementation outperforms Apple\u2019s MPSCNNConvolution for all devices except the iPhone 7).</p>\n</blockquote>\n<blockquote>\n<p>For a convolutional implementation, it is recommended to use NNPACK since that\u2019s substantially faster (~2x-3x) than the standard im2col/sgemm implementation used in most frameworks.</p>\n</blockquote>\n<p>The readme for NNPACK lists Tensorflow as a framework that could potentially use it, though <a href=\"https://github.com/Maratyszcza/NNPACK/issues/1\" data-hovercard-type=\"issue\" data-hovercard-url=\"/Maratyszcza/NNPACK/issues/1/hovercard\">that has not yet happened</a>.</p>\n<p>I believe that TF also avoids using the im2col/sgemm approach on mobile and instead uses the Eigen TensorConvolution. It would be good to benchmark these two options against each other and see if TF performance can be improved by using the <code>NNPACK</code> conv instead of the eigen conv. There is an open ticket to do this benchmarking: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"179708902\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/Maratyszcza/NNPACK/issues/30\" data-hovercard-type=\"issue\" data-hovercard-url=\"/Maratyszcza/NNPACK/issues/30/hovercard\" href=\"https://github.com/Maratyszcza/NNPACK/issues/30\">Maratyszcza/NNPACK#30</a>.</p>\n<p>As a feature I suggest offering an <code>NNPACK</code> backed kernel to allow comparing vs Eigen.</p>", "body_text": "Caffe2 use can use NNPACK for which it says:\n\nNNPACK, which specifically optimizes convolutions on ARM\n\n\nCurrently Caffe2 is optimized for ARM CPUs with NEON (basically any ARM CPU since 2012). Perhaps surprisingly, ARM CPUs outperform the on-board GPUs (our NNPACK ARM CPU implementation outperforms Apple\u2019s MPSCNNConvolution for all devices except the iPhone 7).\n\n\nFor a convolutional implementation, it is recommended to use NNPACK since that\u2019s substantially faster (~2x-3x) than the standard im2col/sgemm implementation used in most frameworks.\n\nThe readme for NNPACK lists Tensorflow as a framework that could potentially use it, though that has not yet happened.\nI believe that TF also avoids using the im2col/sgemm approach on mobile and instead uses the Eigen TensorConvolution. It would be good to benchmark these two options against each other and see if TF performance can be improved by using the NNPACK conv instead of the eigen conv. There is an open ticket to do this benchmarking: Maratyszcza/NNPACK#30.\nAs a feature I suggest offering an NNPACK backed kernel to allow comparing vs Eigen.", "body": "Caffe2 use can use [NNPACK](https://github.com/Maratyszcza/NNPACK) for [which it says](http://caffe2.ai/docs/mobile-integration.html#null__performance-considerations):\r\n>NNPACK, which specifically optimizes convolutions on ARM\r\n\r\n>Currently Caffe2 is optimized for ARM CPUs with NEON (basically any ARM CPU since 2012). Perhaps surprisingly, ARM CPUs outperform the on-board GPUs (our NNPACK ARM CPU implementation outperforms Apple\u2019s MPSCNNConvolution for all devices except the iPhone 7). \r\n\r\n>For a convolutional implementation, it is recommended to use NNPACK since that\u2019s substantially faster (~2x-3x) than the standard im2col/sgemm implementation used in most frameworks. \r\n\r\nThe readme for NNPACK lists Tensorflow as a framework that could potentially use it, though [that has not yet happened](https://github.com/Maratyszcza/NNPACK/issues/1).\r\n\r\nI believe that TF also avoids using the im2col/sgemm approach on mobile and instead uses the Eigen TensorConvolution. It would be good to benchmark these two options against each other and see if TF performance can be improved by using the `NNPACK` conv instead of the eigen conv. There is an open ticket to do this benchmarking: https://github.com/Maratyszcza/NNPACK/issues/30.\r\n\r\nAs a feature I suggest offering an `NNPACK` backed kernel to allow comparing vs Eigen."}