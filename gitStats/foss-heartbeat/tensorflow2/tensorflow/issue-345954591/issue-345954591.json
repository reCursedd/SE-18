{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21254", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21254/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21254/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21254/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21254", "id": 345954591, "node_id": "MDU6SXNzdWUzNDU5NTQ1OTE=", "number": 21254, "title": "InvalidArgumentError: assertion failed: [predictions must be in [0, 1]] [Condition x >= y did not hold element-wise:x (linear/head/predictions/logistic:0) = ]", "user": {"login": "opokualbert", "id": 6060244, "node_id": "MDQ6VXNlcjYwNjAyNDQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6060244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/opokualbert", "html_url": "https://github.com/opokualbert", "followers_url": "https://api.github.com/users/opokualbert/followers", "following_url": "https://api.github.com/users/opokualbert/following{/other_user}", "gists_url": "https://api.github.com/users/opokualbert/gists{/gist_id}", "starred_url": "https://api.github.com/users/opokualbert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/opokualbert/subscriptions", "organizations_url": "https://api.github.com/users/opokualbert/orgs", "repos_url": "https://api.github.com/users/opokualbert/repos", "events_url": "https://api.github.com/users/opokualbert/events{/privacy}", "received_events_url": "https://api.github.com/users/opokualbert/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-07-30T22:07:35Z", "updated_at": "2018-07-31T15:19:11Z", "closed_at": "2018-07-31T15:19:11Z", "author_association": "NONE", "body_html": "<h3>Describe the problem</h3>\n<p>I am using TF 1.9. My model trains successfully but when I try to evaluate I get the error below. I was even thinking my create_test_input_fn() could be the problem so I tried to evaluate on the training data set but I got the same error.</p>\n<h3>Source code / logs</h3>\n<p>def create_train_input_fn():<br>\nreturn tf.estimator.inputs.pandas_input_fn(<br>\nx=X_train.drop('indiv_key',axis=1),<br>\ny=y_train,<br>\nbatch_size=32,<br>\nnum_epochs=None, # Repeat forever<br>\nshuffle=True)</p>\n<p>def create_test_input_fn():<br>\nreturn tf.estimator.inputs.pandas_input_fn(<br>\nx=X_test.drop('indiv_key',axis=1),<br>\ny=y_test,<br>\nnum_epochs=1, # Just one epoch<br>\nshuffle=False) # Don't shuffle so we can compare to census_test_labels later</p>\n<p>outdir = 'graphs/linear'<br>\nshutil.rmtree(outdir, ignore_errors = True) # start fresh each time<br>\nmyopt = tf.train.AdamOptimizer(1e-4)</p>\n<p>train_input_fn = create_train_input_fn()<br>\nestimator = tf.estimator.LinearClassifier(feature_columns ,<br>\noptimizer=myopt,<br>\nmodel_dir=outdir,<br>\nn_classes=2)<br>\nestimator.train(train_input_fn, steps=5000)</p>\n<p>test_input_fn = create_test_input_fn()<br>\nestimator.evaluate(test_input_fn)</p>\n<h1>=============<br>\nERROR</h1>\n<p>InvalidArgumentError: assertion failed: [predictions must be in [0, 1]] [Condition x &gt;= y did not hold element-wise:x (linear/head/predictions/logistic:0) = ] [[0.0246640872][0.0240472779][0.0353220813]...] [y (linear/metrics/auc_precision_recall/Cast/x:0) = ] [0]<br>\n[[Node: linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_FLOAT, DT_STRING, DT_FLOAT], summarize=3, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/Switch, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/data_0, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/data_1, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/Switch_1, linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/data_3, linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/Switch_2)]]</p>\n<p>During handling of the above exception, another exception occurred:</p>", "body_text": "Describe the problem\nI am using TF 1.9. My model trains successfully but when I try to evaluate I get the error below. I was even thinking my create_test_input_fn() could be the problem so I tried to evaluate on the training data set but I got the same error.\nSource code / logs\ndef create_train_input_fn():\nreturn tf.estimator.inputs.pandas_input_fn(\nx=X_train.drop('indiv_key',axis=1),\ny=y_train,\nbatch_size=32,\nnum_epochs=None, # Repeat forever\nshuffle=True)\ndef create_test_input_fn():\nreturn tf.estimator.inputs.pandas_input_fn(\nx=X_test.drop('indiv_key',axis=1),\ny=y_test,\nnum_epochs=1, # Just one epoch\nshuffle=False) # Don't shuffle so we can compare to census_test_labels later\noutdir = 'graphs/linear'\nshutil.rmtree(outdir, ignore_errors = True) # start fresh each time\nmyopt = tf.train.AdamOptimizer(1e-4)\ntrain_input_fn = create_train_input_fn()\nestimator = tf.estimator.LinearClassifier(feature_columns ,\noptimizer=myopt,\nmodel_dir=outdir,\nn_classes=2)\nestimator.train(train_input_fn, steps=5000)\ntest_input_fn = create_test_input_fn()\nestimator.evaluate(test_input_fn)\n=============\nERROR\nInvalidArgumentError: assertion failed: [predictions must be in [0, 1]] [Condition x >= y did not hold element-wise:x (linear/head/predictions/logistic:0) = ] [[0.0246640872][0.0240472779][0.0353220813]...] [y (linear/metrics/auc_precision_recall/Cast/x:0) = ] [0]\n[[Node: linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_FLOAT, DT_STRING, DT_FLOAT], summarize=3, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/Switch, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/data_0, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/data_1, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/Switch_1, linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/data_3, linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/Switch_2)]]\nDuring handling of the above exception, another exception occurred:", "body": "### Describe the problem\r\nI am using TF 1.9. My model trains successfully but when I try to evaluate I get the error below. I was even thinking my create_test_input_fn() could be the problem so I tried to evaluate on the training data set but I got the same error.\r\n\r\n### Source code / logs\r\n\r\ndef create_train_input_fn(): \r\n    return tf.estimator.inputs.pandas_input_fn(\r\n        x=X_train.drop('indiv_key',axis=1),\r\n        y=y_train, \r\n        batch_size=32,\r\n        num_epochs=None, # Repeat forever\r\n        shuffle=True)\r\n\r\ndef create_test_input_fn():\r\n    return tf.estimator.inputs.pandas_input_fn(\r\n        x=X_test.drop('indiv_key',axis=1),\r\n        y=y_test, \r\n        num_epochs=1, # Just one epoch\r\n        shuffle=False) # Don't shuffle so we can compare to census_test_labels later\r\n\r\n\r\noutdir = 'graphs/linear'\r\nshutil.rmtree(outdir, ignore_errors = True) # start fresh each time\r\nmyopt = tf.train.AdamOptimizer(1e-4)\r\n\r\ntrain_input_fn = create_train_input_fn()\r\nestimator = tf.estimator.LinearClassifier(feature_columns ,\r\n            optimizer=myopt, \r\n            model_dir=outdir, \r\n            n_classes=2)\r\nestimator.train(train_input_fn, steps=5000)\r\n\r\n\r\ntest_input_fn = create_test_input_fn()\r\nestimator.evaluate(test_input_fn)\r\n\r\n=============\r\nERROR\r\n=============\r\nInvalidArgumentError: assertion failed: [predictions must be in [0, 1]] [Condition x >= y did not hold element-wise:x (linear/head/predictions/logistic:0) = ] [[0.0246640872][0.0240472779][0.0353220813]...] [y (linear/metrics/auc_precision_recall/Cast/x:0) = ] [0]\r\n\t [[Node: linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_FLOAT, DT_STRING, DT_FLOAT], summarize=3, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/Switch, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/data_0, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/data_1, linear/metrics/auc/assert_greater_equal/Assert/AssertGuard/Assert/Switch_1, linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/data_3, linear/metrics/auc_precision_recall/assert_greater_equal/Assert/AssertGuard/Assert/Switch_2)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n"}