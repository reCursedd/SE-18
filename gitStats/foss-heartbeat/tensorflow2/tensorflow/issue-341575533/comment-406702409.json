{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/406702409", "html_url": "https://github.com/tensorflow/tensorflow/issues/20843#issuecomment-406702409", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20843", "id": 406702409, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjcwMjQwOQ==", "user": {"login": "drasmuss", "id": 1952220, "node_id": "MDQ6VXNlcjE5NTIyMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1952220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drasmuss", "html_url": "https://github.com/drasmuss", "followers_url": "https://api.github.com/users/drasmuss/followers", "following_url": "https://api.github.com/users/drasmuss/following{/other_user}", "gists_url": "https://api.github.com/users/drasmuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/drasmuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drasmuss/subscriptions", "organizations_url": "https://api.github.com/users/drasmuss/orgs", "repos_url": "https://api.github.com/users/drasmuss/repos", "events_url": "https://api.github.com/users/drasmuss/events{/privacy}", "received_events_url": "https://api.github.com/users/drasmuss/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-20T19:20:48Z", "updated_at": "2018-07-20T20:50:51Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I did a git bisect to figure out where the slowdowns occurred, and found 3 commits that contributed to the decreased performance:</p>\n<p><a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/2c105ace934edce193669b55b13b64283caa24d7/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/2c105ace934edce193669b55b13b64283caa24d7\"><tt>2c105ac</tt></a></p>\n<p>Runs the graph optimizer pass twice (up from previous value of once), so makes sense that this would take longer.  Can be disabled via <code>config.graph_options.rewrite_options.meta_optimizer_iterations=RewriterConfig.ONE</code>.</p>\n<p><a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/7e5d24de55572741f10ee7e17247ca195eaadfae/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/7e5d24de55572741f10ee7e17247ca195eaadfae\"><tt>7e5d24d</tt></a></p>\n<p>Turns on three new graph optimization steps: dead branch elimination, shape optimization, and remapping.  Shape optimization and remapping can be disabled via <code>config.graph_options.rewrite_options.shape_optimization/remapping=RewriterConfig.OFF</code>, but I don't think there is any way to selectively disable dead branch elimination (other than turning off all loop optimizations).</p>\n<p><a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/2273b62a769aa477f8d2ef02ca7dee253b8ea7b0/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/2273b62a769aa477f8d2ef02ca7dee253b8ea7b0\"><tt>2273b62</tt></a></p>\n<p>This adds some new logic to the <code>SymbolicShapeRefiner</code>, which is what is slowing things down I'm guessing.  I don't think there is any way to disable this.</p>\n<p>Note: all three commits are by <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=6969686\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/benoitsteiner\">@benoitsteiner</a>, so he may be able to provide more detail.</p>", "body_text": "I did a git bisect to figure out where the slowdowns occurred, and found 3 commits that contributed to the decreased performance:\n2c105ac\nRuns the graph optimizer pass twice (up from previous value of once), so makes sense that this would take longer.  Can be disabled via config.graph_options.rewrite_options.meta_optimizer_iterations=RewriterConfig.ONE.\n7e5d24d\nTurns on three new graph optimization steps: dead branch elimination, shape optimization, and remapping.  Shape optimization and remapping can be disabled via config.graph_options.rewrite_options.shape_optimization/remapping=RewriterConfig.OFF, but I don't think there is any way to selectively disable dead branch elimination (other than turning off all loop optimizations).\n2273b62\nThis adds some new logic to the SymbolicShapeRefiner, which is what is slowing things down I'm guessing.  I don't think there is any way to disable this.\nNote: all three commits are by @benoitsteiner, so he may be able to provide more detail.", "body": "I did a git bisect to figure out where the slowdowns occurred, and found 3 commits that contributed to the decreased performance:\r\n\r\nhttps://github.com/tensorflow/tensorflow/commit/2c105ace934edce193669b55b13b64283caa24d7\r\n\r\nRuns the graph optimizer pass twice (up from previous value of once), so makes sense that this would take longer.  Can be disabled via `config.graph_options.rewrite_options.meta_optimizer_iterations=RewriterConfig.ONE`.\r\n\r\nhttps://github.com/tensorflow/tensorflow/commit/7e5d24de55572741f10ee7e17247ca195eaadfae\r\n\r\nTurns on three new graph optimization steps: dead branch elimination, shape optimization, and remapping.  Shape optimization and remapping can be disabled via `config.graph_options.rewrite_options.shape_optimization/remapping=RewriterConfig.OFF`, but I don't think there is any way to selectively disable dead branch elimination (other than turning off all loop optimizations).\r\n\r\nhttps://github.com/tensorflow/tensorflow/commit/2273b62a769aa477f8d2ef02ca7dee253b8ea7b0\r\n\r\nThis adds some new logic to the `SymbolicShapeRefiner`, which is what is slowing things down I'm guessing.  I don't think there is any way to disable this.\r\n\r\nNote: all three commits are by @benoitsteiner, so he may be able to provide more detail.\r\n"}