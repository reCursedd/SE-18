{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4797", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4797/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4797/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4797/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4797", "id": 181375659, "node_id": "MDU6SXNzdWUxODEzNzU2NTk=", "number": 4797, "title": "Error following the wide and deep tutorial ", "user": {"login": "mahdeto", "id": 875353, "node_id": "MDQ6VXNlcjg3NTM1Mw==", "avatar_url": "https://avatars0.githubusercontent.com/u/875353?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mahdeto", "html_url": "https://github.com/mahdeto", "followers_url": "https://api.github.com/users/mahdeto/followers", "following_url": "https://api.github.com/users/mahdeto/following{/other_user}", "gists_url": "https://api.github.com/users/mahdeto/gists{/gist_id}", "starred_url": "https://api.github.com/users/mahdeto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mahdeto/subscriptions", "organizations_url": "https://api.github.com/users/mahdeto/orgs", "repos_url": "https://api.github.com/users/mahdeto/repos", "events_url": "https://api.github.com/users/mahdeto/events{/privacy}", "received_events_url": "https://api.github.com/users/mahdeto/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-10-06T10:15:16Z", "updated_at": "2018-08-02T02:28:36Z", "closed_at": "2016-10-06T23:39:00Z", "author_association": "NONE", "body_html": "<p>I've been trying to follow through the wide and deep tutorial on a different data set and I am getting the below error.</p>\n<p>I am using this version of tensorflow: tensorflow-0.11.0rc0-cp27-none-linux_x86_64.whl<br>\non python: Python 2.7.5</p>\n<p>All my fields are strings (features and labels)</p>\n<p>I am adding the relevant code snippets</p>\n<pre><code>f1Col = tf.contrib.layers.sparse_column_with_keys(\"f1\", keys = [\"l1\", \"l2\", \"l3\"])\n..\n..\nI've defined all columns similar to this one (no hash bucket ones)\n..\n..\n\n</code></pre>\n<pre><code>wide_columns = [\n  tf.contrib.layers.crossed_column(columns = [f1Col, f2Col, f3Col] , hash_bucket_size = 1e7),\n  ...\n  defined all crossed columns like the above one with smaller hash buckets for ones with less features\n  ...\n]\n</code></pre>\n<pre><code>deep_columns = [\n    tf.contrib.layers.embedding_column(f1Col, dimension=8),\n    ...\n   defined all my features here as embedding columns exactly as the one above\n   ....\n]\n</code></pre>\n<p>tried this with both settings for enable_centered_bias the error changes a bit but is still the same</p>\n<pre><code>import tempfile\nmodel_dir = tempfile.mkdtemp()\nm = tf.contrib.learn.DNNLinearCombinedClassifier(\n    model_dir=model_dir,\n    linear_feature_columns=wide_columns,\n    dnn_feature_columns=deep_columns,\n    dnn_hidden_units=[1000, 500, 250], enable_centered_bias = False)\n</code></pre>\n<pre><code>def input_fn(df):\n  categorical_cols = {k: tf.SparseTensor(\n      indices=[[i, 0] for i in range(df[k].size)],\n      values=df[k].values,\n      shape=[df[k].size, 1])\n                      for k in my_features_col_list}\n  label = tf.constant(df['my_label_col'].values)\n  return categorical_cols, label\n\ndef train_input_fn():\n  return input_fn(features)\n\ndef eval_input_fn():\n  return input_fn(features)\n</code></pre>\n<p>then when I try to fit like this:<br>\n<code>m.fit(input_fn=train_input_fn, steps=200)</code></p>\n<p>I get the following error. I am not sure if I hit a bug or did something wrong. I am getting some warnings in the earlier code about combiner function defaults changing</p>\n<p>Then again when executing the fit I get the 2 warnings and then the error below them:</p>\n<pre><code>WARNING:tensorflow:Given features: {'f1': &lt;tensorflow.python.framework.ops.SparseTensor object at 0xc5bf690&gt;, ... required signatures: {'f1': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), ...\n\nWARNING:tensorflow:Given targets: Tensor(\"Const:0\", shape=(2019,), dtype=string), required signatures: TensorSignature(dtype=tf.string, shape=TensorShape([Dimension(2019)]), is_sparse=False).\n\n</code></pre>\n<pre><code>---------------------------------------------------------------------------\nUnimplementedError                        Traceback (most recent call last)\n&lt;ipython-input-29-8f5351c1fdf8&gt; in &lt;module&gt;()\n----&gt; 1 m.fit(input_fn=train_input_fn, steps=200)\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.pyc in fit(self, x, y, input_fn, steps, batch_size, monitors, max_steps)\n    331                              steps=steps,\n    332                              monitors=monitors,\n--&gt; 333                              max_steps=max_steps)\n    334     logging.info('Loss for final step: %s.', loss)\n    335     return self\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.pyc in _train_model(self, input_fn, steps, feed_fn, init_op, init_feed_fn, init_fn, device_fn, monitors, log_every_steps, fail_on_nan_loss, max_steps)\n    706           fail_on_nan_loss=fail_on_nan_loss,\n    707           hooks=hooks,\n--&gt; 708           max_steps=max_steps)\n    709 \n    710   def _extract_metric_update_ops(self, eval_dict):\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.pyc in _monitored_train(graph, output_dir, train_op, loss_op, global_step_tensor, init_op, init_feed_dict, init_fn, log_every_steps, supervisor_is_chief, supervisor_master, supervisor_save_model_secs, keep_checkpoint_max, supervisor_save_summaries_steps, feed_fn, steps, fail_on_nan_loss, hooks, max_steps)\n    283       while not super_sess.should_stop():\n    284         _, loss = super_sess.run([train_op, loss_op], feed_fn() if feed_fn else\n--&gt; 285                                  None)\n    286       return loss\n    287 \n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    366                           feed_dict=feed_dict,\n    367                           options=options,\n--&gt; 368                           run_metadata=run_metadata)\n    369 \n    370   def should_stop(self):\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    519                               feed_dict=feed_dict,\n    520                               options=options,\n--&gt; 521                               run_metadata=run_metadata)\n    522       except errors.AbortedError:\n    523         self.close()\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, *args, **kwargs)\n    486 \n    487   def run(self, *args, **kwargs):\n--&gt; 488     return self._sess.run(*args, **kwargs)\n    489 \n    490 \n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    617                                   feed_dict=feed_dict,\n    618                                   options=options,\n--&gt; 619                                   run_metadata=run_metadata)\n    620 \n    621     for hook in self._hooks:\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, *args, **kwargs)\n    486 \n    487   def run(self, *args, **kwargs):\n--&gt; 488     return self._sess.run(*args, **kwargs)\n    489 \n    490 \n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    715     try:\n    716       result = self._run(None, fetches, feed_dict, options_ptr,\n--&gt; 717                          run_metadata_ptr)\n    718       if run_metadata:\n    719         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict, options, run_metadata)\n    913     if final_fetches or final_targets:\n    914       results = self._do_run(handle, final_targets, final_fetches,\n--&gt; 915                              feed_dict_string, options, run_metadata)\n    916     else:\n    917       results = []\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n    963     if handle is None:\n    964       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n--&gt; 965                            target_list, options, run_metadata)\n    966     else:\n    967       return self._do_call(_prun_fn, self._session, handle, feed_dict,\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\n    983         except KeyError:\n    984           pass\n--&gt; 985       raise type(e)(node_def, op, message)\n    986 \n    987   def _extend_graph(self):\n\nUnimplementedError: Cast string to float is not supported\n     [[Node: ToFloat = Cast[DstT=DT_FLOAT, SrcT=DT_STRING, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](ExpandDims)]]\n\nCaused by op u'ToFloat', defined at:\n  File \"/usr/lib64/python2.7/runpy.py\", line 162, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib64/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/usr/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in &lt;module&gt;\n    app.launch_new_instance()\n  File \"/usr/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\n    app.start()\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 474, in start\n    ioloop.IOLoop.instance().start()\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 162, in start\n    super(ZMQIOLoop, self).start()\n  File \"/usr/lib/python2.7/site-packages/tornado/ioloop.py\", line 887, in start\n    handler_func(fd_obj, events)\n  File \"/usr/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\n    self._handle_recv()\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\n    callback(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 276, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 228, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 390, in execute_request\n    user_expressions, allow_stdin)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 196, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 501, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2717, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2827, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"&lt;ipython-input-29-8f5351c1fdf8&gt;\", line 1, in &lt;module&gt;\n    m.fit(input_fn=train_input_fn, steps=200)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 333, in fit\n    max_steps=max_steps)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 662, in _train_model\n    train_op, loss_op = self._get_train_ops(features, targets)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 195, in _get_train_ops\n    features)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 206, in training_loss\n    loss_unweighted = self._loss_fn(logits, target)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 389, in _log_loss_with_two_classes\n    math_ops.to_float(target))\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py\", line 661, in to_float\n    return cast(x, dtypes.float32, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py\", line 616, in cast\n    return gen_math_ops.cast(x, base_type, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.py\", line 419, in cast\n    result = _op_def_lib.apply_op(\"Cast\", x=x, DstT=DstT, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\n    op_def=op_def)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1298, in __init__\n    self._traceback = _extract_stack()\n\nUnimplementedError (see above for traceback): Cast string to float is not supported\n     [[Node: ToFloat = Cast[DstT=DT_FLOAT, SrcT=DT_STRING, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](ExpandDims)]]\n</code></pre>", "body_text": "I've been trying to follow through the wide and deep tutorial on a different data set and I am getting the below error.\nI am using this version of tensorflow: tensorflow-0.11.0rc0-cp27-none-linux_x86_64.whl\non python: Python 2.7.5\nAll my fields are strings (features and labels)\nI am adding the relevant code snippets\nf1Col = tf.contrib.layers.sparse_column_with_keys(\"f1\", keys = [\"l1\", \"l2\", \"l3\"])\n..\n..\nI've defined all columns similar to this one (no hash bucket ones)\n..\n..\n\n\nwide_columns = [\n  tf.contrib.layers.crossed_column(columns = [f1Col, f2Col, f3Col] , hash_bucket_size = 1e7),\n  ...\n  defined all crossed columns like the above one with smaller hash buckets for ones with less features\n  ...\n]\n\ndeep_columns = [\n    tf.contrib.layers.embedding_column(f1Col, dimension=8),\n    ...\n   defined all my features here as embedding columns exactly as the one above\n   ....\n]\n\ntried this with both settings for enable_centered_bias the error changes a bit but is still the same\nimport tempfile\nmodel_dir = tempfile.mkdtemp()\nm = tf.contrib.learn.DNNLinearCombinedClassifier(\n    model_dir=model_dir,\n    linear_feature_columns=wide_columns,\n    dnn_feature_columns=deep_columns,\n    dnn_hidden_units=[1000, 500, 250], enable_centered_bias = False)\n\ndef input_fn(df):\n  categorical_cols = {k: tf.SparseTensor(\n      indices=[[i, 0] for i in range(df[k].size)],\n      values=df[k].values,\n      shape=[df[k].size, 1])\n                      for k in my_features_col_list}\n  label = tf.constant(df['my_label_col'].values)\n  return categorical_cols, label\n\ndef train_input_fn():\n  return input_fn(features)\n\ndef eval_input_fn():\n  return input_fn(features)\n\nthen when I try to fit like this:\nm.fit(input_fn=train_input_fn, steps=200)\nI get the following error. I am not sure if I hit a bug or did something wrong. I am getting some warnings in the earlier code about combiner function defaults changing\nThen again when executing the fit I get the 2 warnings and then the error below them:\nWARNING:tensorflow:Given features: {'f1': <tensorflow.python.framework.ops.SparseTensor object at 0xc5bf690>, ... required signatures: {'f1': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), ...\n\nWARNING:tensorflow:Given targets: Tensor(\"Const:0\", shape=(2019,), dtype=string), required signatures: TensorSignature(dtype=tf.string, shape=TensorShape([Dimension(2019)]), is_sparse=False).\n\n\n---------------------------------------------------------------------------\nUnimplementedError                        Traceback (most recent call last)\n<ipython-input-29-8f5351c1fdf8> in <module>()\n----> 1 m.fit(input_fn=train_input_fn, steps=200)\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.pyc in fit(self, x, y, input_fn, steps, batch_size, monitors, max_steps)\n    331                              steps=steps,\n    332                              monitors=monitors,\n--> 333                              max_steps=max_steps)\n    334     logging.info('Loss for final step: %s.', loss)\n    335     return self\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.pyc in _train_model(self, input_fn, steps, feed_fn, init_op, init_feed_fn, init_fn, device_fn, monitors, log_every_steps, fail_on_nan_loss, max_steps)\n    706           fail_on_nan_loss=fail_on_nan_loss,\n    707           hooks=hooks,\n--> 708           max_steps=max_steps)\n    709 \n    710   def _extract_metric_update_ops(self, eval_dict):\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.pyc in _monitored_train(graph, output_dir, train_op, loss_op, global_step_tensor, init_op, init_feed_dict, init_fn, log_every_steps, supervisor_is_chief, supervisor_master, supervisor_save_model_secs, keep_checkpoint_max, supervisor_save_summaries_steps, feed_fn, steps, fail_on_nan_loss, hooks, max_steps)\n    283       while not super_sess.should_stop():\n    284         _, loss = super_sess.run([train_op, loss_op], feed_fn() if feed_fn else\n--> 285                                  None)\n    286       return loss\n    287 \n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    366                           feed_dict=feed_dict,\n    367                           options=options,\n--> 368                           run_metadata=run_metadata)\n    369 \n    370   def should_stop(self):\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    519                               feed_dict=feed_dict,\n    520                               options=options,\n--> 521                               run_metadata=run_metadata)\n    522       except errors.AbortedError:\n    523         self.close()\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, *args, **kwargs)\n    486 \n    487   def run(self, *args, **kwargs):\n--> 488     return self._sess.run(*args, **kwargs)\n    489 \n    490 \n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    617                                   feed_dict=feed_dict,\n    618                                   options=options,\n--> 619                                   run_metadata=run_metadata)\n    620 \n    621     for hook in self._hooks:\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, *args, **kwargs)\n    486 \n    487   def run(self, *args, **kwargs):\n--> 488     return self._sess.run(*args, **kwargs)\n    489 \n    490 \n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    715     try:\n    716       result = self._run(None, fetches, feed_dict, options_ptr,\n--> 717                          run_metadata_ptr)\n    718       if run_metadata:\n    719         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict, options, run_metadata)\n    913     if final_fetches or final_targets:\n    914       results = self._do_run(handle, final_targets, final_fetches,\n--> 915                              feed_dict_string, options, run_metadata)\n    916     else:\n    917       results = []\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n    963     if handle is None:\n    964       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n--> 965                            target_list, options, run_metadata)\n    966     else:\n    967       return self._do_call(_prun_fn, self._session, handle, feed_dict,\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\n    983         except KeyError:\n    984           pass\n--> 985       raise type(e)(node_def, op, message)\n    986 \n    987   def _extend_graph(self):\n\nUnimplementedError: Cast string to float is not supported\n     [[Node: ToFloat = Cast[DstT=DT_FLOAT, SrcT=DT_STRING, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](ExpandDims)]]\n\nCaused by op u'ToFloat', defined at:\n  File \"/usr/lib64/python2.7/runpy.py\", line 162, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib64/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/usr/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in <module>\n    app.launch_new_instance()\n  File \"/usr/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\n    app.start()\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 474, in start\n    ioloop.IOLoop.instance().start()\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 162, in start\n    super(ZMQIOLoop, self).start()\n  File \"/usr/lib/python2.7/site-packages/tornado/ioloop.py\", line 887, in start\n    handler_func(fd_obj, events)\n  File \"/usr/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\n    self._handle_recv()\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\n    callback(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 276, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 228, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 390, in execute_request\n    user_expressions, allow_stdin)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 196, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 501, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2717, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2827, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-29-8f5351c1fdf8>\", line 1, in <module>\n    m.fit(input_fn=train_input_fn, steps=200)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 333, in fit\n    max_steps=max_steps)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 662, in _train_model\n    train_op, loss_op = self._get_train_ops(features, targets)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 195, in _get_train_ops\n    features)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 206, in training_loss\n    loss_unweighted = self._loss_fn(logits, target)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 389, in _log_loss_with_two_classes\n    math_ops.to_float(target))\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py\", line 661, in to_float\n    return cast(x, dtypes.float32, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py\", line 616, in cast\n    return gen_math_ops.cast(x, base_type, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.py\", line 419, in cast\n    result = _op_def_lib.apply_op(\"Cast\", x=x, DstT=DstT, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\n    op_def=op_def)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1298, in __init__\n    self._traceback = _extract_stack()\n\nUnimplementedError (see above for traceback): Cast string to float is not supported\n     [[Node: ToFloat = Cast[DstT=DT_FLOAT, SrcT=DT_STRING, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](ExpandDims)]]", "body": "I've been trying to follow through the wide and deep tutorial on a different data set and I am getting the below error.\n\nI am using this version of tensorflow: tensorflow-0.11.0rc0-cp27-none-linux_x86_64.whl\non python: Python 2.7.5\n\nAll my fields are strings (features and labels)\n\nI am adding the relevant code snippets\n\n```\nf1Col = tf.contrib.layers.sparse_column_with_keys(\"f1\", keys = [\"l1\", \"l2\", \"l3\"])\n..\n..\nI've defined all columns similar to this one (no hash bucket ones)\n..\n..\n\n```\n\n```\nwide_columns = [\n  tf.contrib.layers.crossed_column(columns = [f1Col, f2Col, f3Col] , hash_bucket_size = 1e7),\n  ...\n  defined all crossed columns like the above one with smaller hash buckets for ones with less features\n  ...\n]\n```\n\n```\ndeep_columns = [\n    tf.contrib.layers.embedding_column(f1Col, dimension=8),\n    ...\n   defined all my features here as embedding columns exactly as the one above\n   ....\n]\n```\n\ntried this with both settings for enable_centered_bias the error changes a bit but is still the same\n\n```\nimport tempfile\nmodel_dir = tempfile.mkdtemp()\nm = tf.contrib.learn.DNNLinearCombinedClassifier(\n    model_dir=model_dir,\n    linear_feature_columns=wide_columns,\n    dnn_feature_columns=deep_columns,\n    dnn_hidden_units=[1000, 500, 250], enable_centered_bias = False)\n```\n\n```\ndef input_fn(df):\n  categorical_cols = {k: tf.SparseTensor(\n      indices=[[i, 0] for i in range(df[k].size)],\n      values=df[k].values,\n      shape=[df[k].size, 1])\n                      for k in my_features_col_list}\n  label = tf.constant(df['my_label_col'].values)\n  return categorical_cols, label\n\ndef train_input_fn():\n  return input_fn(features)\n\ndef eval_input_fn():\n  return input_fn(features)\n```\n\nthen when I try to fit like this:\n`m.fit(input_fn=train_input_fn, steps=200)`\n\nI get the following error. I am not sure if I hit a bug or did something wrong. I am getting some warnings in the earlier code about combiner function defaults changing\n\nThen again when executing the fit I get the 2 warnings and then the error below them:\n\n```\nWARNING:tensorflow:Given features: {'f1': <tensorflow.python.framework.ops.SparseTensor object at 0xc5bf690>, ... required signatures: {'f1': TensorSignature(dtype=tf.string, shape=None, is_sparse=True), ...\n\nWARNING:tensorflow:Given targets: Tensor(\"Const:0\", shape=(2019,), dtype=string), required signatures: TensorSignature(dtype=tf.string, shape=TensorShape([Dimension(2019)]), is_sparse=False).\n\n```\n\n```\n---------------------------------------------------------------------------\nUnimplementedError                        Traceback (most recent call last)\n<ipython-input-29-8f5351c1fdf8> in <module>()\n----> 1 m.fit(input_fn=train_input_fn, steps=200)\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.pyc in fit(self, x, y, input_fn, steps, batch_size, monitors, max_steps)\n    331                              steps=steps,\n    332                              monitors=monitors,\n--> 333                              max_steps=max_steps)\n    334     logging.info('Loss for final step: %s.', loss)\n    335     return self\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.pyc in _train_model(self, input_fn, steps, feed_fn, init_op, init_feed_fn, init_fn, device_fn, monitors, log_every_steps, fail_on_nan_loss, max_steps)\n    706           fail_on_nan_loss=fail_on_nan_loss,\n    707           hooks=hooks,\n--> 708           max_steps=max_steps)\n    709 \n    710   def _extract_metric_update_ops(self, eval_dict):\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/graph_actions.pyc in _monitored_train(graph, output_dir, train_op, loss_op, global_step_tensor, init_op, init_feed_dict, init_fn, log_every_steps, supervisor_is_chief, supervisor_master, supervisor_save_model_secs, keep_checkpoint_max, supervisor_save_summaries_steps, feed_fn, steps, fail_on_nan_loss, hooks, max_steps)\n    283       while not super_sess.should_stop():\n    284         _, loss = super_sess.run([train_op, loss_op], feed_fn() if feed_fn else\n--> 285                                  None)\n    286       return loss\n    287 \n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    366                           feed_dict=feed_dict,\n    367                           options=options,\n--> 368                           run_metadata=run_metadata)\n    369 \n    370   def should_stop(self):\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    519                               feed_dict=feed_dict,\n    520                               options=options,\n--> 521                               run_metadata=run_metadata)\n    522       except errors.AbortedError:\n    523         self.close()\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, *args, **kwargs)\n    486 \n    487   def run(self, *args, **kwargs):\n--> 488     return self._sess.run(*args, **kwargs)\n    489 \n    490 \n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    617                                   feed_dict=feed_dict,\n    618                                   options=options,\n--> 619                                   run_metadata=run_metadata)\n    620 \n    621     for hook in self._hooks:\n\n/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/monitored_session.pyc in run(self, *args, **kwargs)\n    486 \n    487   def run(self, *args, **kwargs):\n--> 488     return self._sess.run(*args, **kwargs)\n    489 \n    490 \n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in run(self, fetches, feed_dict, options, run_metadata)\n    715     try:\n    716       result = self._run(None, fetches, feed_dict, options_ptr,\n--> 717                          run_metadata_ptr)\n    718       if run_metadata:\n    719         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _run(self, handle, fetches, feed_dict, options, run_metadata)\n    913     if final_fetches or final_targets:\n    914       results = self._do_run(handle, final_targets, final_fetches,\n--> 915                              feed_dict_string, options, run_metadata)\n    916     else:\n    917       results = []\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\n    963     if handle is None:\n    964       return self._do_call(_run_fn, self._session, feed_dict, fetch_list,\n--> 965                            target_list, options, run_metadata)\n    966     else:\n    967       return self._do_call(_prun_fn, self._session, handle, feed_dict,\n\n/usr/lib/python2.7/site-packages/tensorflow/python/client/session.pyc in _do_call(self, fn, *args)\n    983         except KeyError:\n    984           pass\n--> 985       raise type(e)(node_def, op, message)\n    986 \n    987   def _extend_graph(self):\n\nUnimplementedError: Cast string to float is not supported\n     [[Node: ToFloat = Cast[DstT=DT_FLOAT, SrcT=DT_STRING, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](ExpandDims)]]\n\nCaused by op u'ToFloat', defined at:\n  File \"/usr/lib64/python2.7/runpy.py\", line 162, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib64/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/usr/lib/python2.7/site-packages/ipykernel/__main__.py\", line 3, in <module>\n    app.launch_new_instance()\n  File \"/usr/lib/python2.7/site-packages/traitlets/config/application.py\", line 658, in launch_instance\n    app.start()\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelapp.py\", line 474, in start\n    ioloop.IOLoop.instance().start()\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/ioloop.py\", line 162, in start\n    super(ZMQIOLoop, self).start()\n  File \"/usr/lib/python2.7/site-packages/tornado/ioloop.py\", line 887, in start\n    handler_func(fd_obj, events)\n  File \"/usr/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 440, in _handle_events\n    self._handle_recv()\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 472, in _handle_recv\n    self._run_callback(callback, msg)\n  File \"/usr/lib/python2.7/site-packages/zmq/eventloop/zmqstream.py\", line 414, in _run_callback\n    callback(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/tornado/stack_context.py\", line 275, in null_wrapper\n    return fn(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 276, in dispatcher\n    return self.dispatch_shell(stream, msg)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 228, in dispatch_shell\n    handler(stream, idents, msg)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/kernelbase.py\", line 390, in execute_request\n    user_expressions, allow_stdin)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/ipkernel.py\", line 196, in do_execute\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\n  File \"/usr/lib/python2.7/site-packages/ipykernel/zmqshell.py\", line 501, in run_cell\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2717, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2827, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/usr/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-29-8f5351c1fdf8>\", line 1, in <module>\n    m.fit(input_fn=train_input_fn, steps=200)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 333, in fit\n    max_steps=max_steps)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py\", line 662, in _train_model\n    train_op, loss_op = self._get_train_ops(features, targets)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/dnn_linear_combined.py\", line 195, in _get_train_ops\n    features)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 206, in training_loss\n    loss_unweighted = self._loss_fn(logits, target)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/contrib/layers/python/layers/target_column.py\", line 389, in _log_loss_with_two_classes\n    math_ops.to_float(target))\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py\", line 661, in to_float\n    return cast(x, dtypes.float32, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py\", line 616, in cast\n    return gen_math_ops.cast(x, base_type, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.py\", line 419, in cast\n    result = _op_def_lib.apply_op(\"Cast\", x=x, DstT=DstT, name=name)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 749, in apply_op\n    op_def=op_def)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2380, in create_op\n    original_op=self._default_original_op, op_def=op_def)\n  File \"/usr/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1298, in __init__\n    self._traceback = _extract_stack()\n\nUnimplementedError (see above for traceback): Cast string to float is not supported\n     [[Node: ToFloat = Cast[DstT=DT_FLOAT, SrcT=DT_STRING, _device=\"/job:localhost/replica:0/task:0/cpu:0\"](ExpandDims)]]\n```\n"}