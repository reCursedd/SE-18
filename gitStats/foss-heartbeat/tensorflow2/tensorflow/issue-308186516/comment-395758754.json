{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/395758754", "html_url": "https://github.com/tensorflow/tensorflow/issues/17965#issuecomment-395758754", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17965", "id": 395758754, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NTc1ODc1NA==", "user": {"login": "t94126", "id": 10750919, "node_id": "MDQ6VXNlcjEwNzUwOTE5", "avatar_url": "https://avatars2.githubusercontent.com/u/10750919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/t94126", "html_url": "https://github.com/t94126", "followers_url": "https://api.github.com/users/t94126/followers", "following_url": "https://api.github.com/users/t94126/following{/other_user}", "gists_url": "https://api.github.com/users/t94126/gists{/gist_id}", "starred_url": "https://api.github.com/users/t94126/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/t94126/subscriptions", "organizations_url": "https://api.github.com/users/t94126/orgs", "repos_url": "https://api.github.com/users/t94126/repos", "events_url": "https://api.github.com/users/t94126/events{/privacy}", "received_events_url": "https://api.github.com/users/t94126/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-08T13:21:19Z", "updated_at": "2018-06-08T13:21:19Z", "author_association": "NONE", "body_html": "<p>Hi, <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=9123400\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/iganichev\">@iganichev</a> I think I know the correct solution. (credit to my friends.)<br>\nYou should move the .stack inside the body:</p>\n<pre><code>import tensorflow as tf\n\ndef body(v):\n    m = tf.constant([v,v])\n    ta = tf.TensorArray(dtype=tf.float32, size=3, dynamic_size=False)\n    t = ta.write(0, m)\n    return t.stack()\n\ncond = tf.constant(False)\nt = tf.cond(cond, true_fn=lambda: body(2.0), false_fn=lambda: body(3.0))\nwith tf.Session() as ss:\n    print(ss.run(t))\n</code></pre>\n<p>Unfortunately, I cannot explain why. I will try to to do that and post later. I think I need check the doc of tf.cond<br>\nIf anyone know how to explain, please also tell me. Thx!</p>", "body_text": "Hi, @iganichev I think I know the correct solution. (credit to my friends.)\nYou should move the .stack inside the body:\nimport tensorflow as tf\n\ndef body(v):\n    m = tf.constant([v,v])\n    ta = tf.TensorArray(dtype=tf.float32, size=3, dynamic_size=False)\n    t = ta.write(0, m)\n    return t.stack()\n\ncond = tf.constant(False)\nt = tf.cond(cond, true_fn=lambda: body(2.0), false_fn=lambda: body(3.0))\nwith tf.Session() as ss:\n    print(ss.run(t))\n\nUnfortunately, I cannot explain why. I will try to to do that and post later. I think I need check the doc of tf.cond\nIf anyone know how to explain, please also tell me. Thx!", "body": "Hi, @iganichev I think I know the correct solution. (credit to my friends.)\r\nYou should move the .stack inside the body:\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\ndef body(v):\r\n    m = tf.constant([v,v])\r\n    ta = tf.TensorArray(dtype=tf.float32, size=3, dynamic_size=False)\r\n    t = ta.write(0, m)\r\n    return t.stack()\r\n\r\ncond = tf.constant(False)\r\nt = tf.cond(cond, true_fn=lambda: body(2.0), false_fn=lambda: body(3.0))\r\nwith tf.Session() as ss:\r\n    print(ss.run(t))\r\n```\r\nUnfortunately, I cannot explain why. I will try to to do that and post later. I think I need check the doc of tf.cond\r\nIf anyone know how to explain, please also tell me. Thx!"}