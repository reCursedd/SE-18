{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18731", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18731/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18731/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18731/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18731", "id": 316229028, "node_id": "MDU6SXNzdWUzMTYyMjkwMjg=", "number": 18731, "title": "TfLite toco: fail kTensorflowMerge", "user": {"login": "Kayoku", "id": 14290069, "node_id": "MDQ6VXNlcjE0MjkwMDY5", "avatar_url": "https://avatars3.githubusercontent.com/u/14290069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kayoku", "html_url": "https://github.com/Kayoku", "followers_url": "https://api.github.com/users/Kayoku/followers", "following_url": "https://api.github.com/users/Kayoku/following{/other_user}", "gists_url": "https://api.github.com/users/Kayoku/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kayoku/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kayoku/subscriptions", "organizations_url": "https://api.github.com/users/Kayoku/orgs", "repos_url": "https://api.github.com/users/Kayoku/repos", "events_url": "https://api.github.com/users/Kayoku/events{/privacy}", "received_events_url": "https://api.github.com/users/Kayoku/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 23, "created_at": "2018-04-20T11:20:56Z", "updated_at": "2018-09-14T18:16:54Z", "closed_at": "2018-09-13T20:16:24Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nYes</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nLinux Ubuntu 18.04 Beta</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nSource</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\nMaster</li>\n<li><strong>Python version</strong>:<br>\n3.6</li>\n<li><strong>Bazel version (if compiling from source)</strong>:<br>\n0.10.0</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>:<br>\ngcc 4.8.5</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\n9.1 / 7.0.5</li>\n<li><strong>GPU model and memory</strong>:<br>\nGTX 1070 Ti 6go &amp; 16Go RAM</li>\n<li><strong>Exact command to reproduce</strong>:<br>\nbazel-bin/tensorflow/contrib/lite/toco/toco<br>\n--input_file=frozen_graph.pb<br>\n--input_format=TENSORFLOW_GRAPHDEF<br>\n--output_format=TFLITE<br>\n--output_file=/tmp/test.tflite<br>\n--inference_input_type=FLOAT<br>\n--input_arrays=input_image<br>\n--output_arrays=output_corner,output_mask<br>\n--input_shapes=1,512,512,3</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I'm working on a FCN. I want to export my frozen graph to TfLite graph but it's not working. I'm wondering why, but I guess it's just due to the lack of maturity of TfLite (and probably some operator compatibility). In my case, it's about the operator \"Merge\". Someone can explain me if there is a way/trick to make it work ?</p>\n<h3>Source code / logs</h3>\n<pre><code>2018-04-20 12:57:33.287154: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1268] Converting unsupported operation: LogicalOr\n2018-04-20 12:57:33.302765: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 518 operators, 965 arrays (0 quantized)\n2018-04-20 12:57:33.312501: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After Removing unused ops pass 1: 477 operators, 902 arrays (0 quantized)\n2018-04-20 12:57:33.325133: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 477 operators, 902 arrays (0 quantized)\n2018-04-20 12:57:33.325335: F tensorflow/contrib/lite/toco/graph_transformations/resolve_tensorflow_switch.cc:95] Check failed: other_op-&gt;type == OperatorType::kTensorFlowMerge \nAborted (core dumped)\n</code></pre>\n<p>I also make a summarize_graph for you, maybe it help</p>\n<pre><code>Found 1 possible inputs: (name=input_image, type=int32(3), shape=[1,?,?,3]) \nNo variables spotted.\nFound 2 possible outputs: (name=output_corner, op=Tile) (name=output_mask, op=Tile) \nFound 1471309 (1.47M) const parameters, 0 (0) variable parameters, and 51 control_edges\nOp types used: 239 Const, 168 Switch, 36 FusedBatchNorm, 27 Add, 22 Identity, 21 Merge, 18 Conv2D, 15 Relu, 13 StridedSlice, 12 Shape, 7 Mul, 6 Cast, 5 MaxPool, 5 Pack, 5 RealDiv, 3 Slice, 3 Conv2DBackpropInput, 2 Tile, 2 Reshape, 2 RandomUniform, 2 PlaceholderWithDefault, 2 Greater, 2 Floor, 2 ConcatV2, 1 Placeholder, 1 Maximum, 1 LogicalOr, 1 ResizeBilinear, 1 Sigmoid, 1 Softmax, 1 Squeeze, 1 ExpandDims, 1 Sub, 1 ArgMax\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nYes\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nLinux Ubuntu 18.04 Beta\nTensorFlow installed from (source or binary):\nSource\nTensorFlow version (use command below):\nMaster\nPython version:\n3.6\nBazel version (if compiling from source):\n0.10.0\nGCC/Compiler version (if compiling from source):\ngcc 4.8.5\nCUDA/cuDNN version:\n9.1 / 7.0.5\nGPU model and memory:\nGTX 1070 Ti 6go & 16Go RAM\nExact command to reproduce:\nbazel-bin/tensorflow/contrib/lite/toco/toco\n--input_file=frozen_graph.pb\n--input_format=TENSORFLOW_GRAPHDEF\n--output_format=TFLITE\n--output_file=/tmp/test.tflite\n--inference_input_type=FLOAT\n--input_arrays=input_image\n--output_arrays=output_corner,output_mask\n--input_shapes=1,512,512,3\n\nDescribe the problem\nI'm working on a FCN. I want to export my frozen graph to TfLite graph but it's not working. I'm wondering why, but I guess it's just due to the lack of maturity of TfLite (and probably some operator compatibility). In my case, it's about the operator \"Merge\". Someone can explain me if there is a way/trick to make it work ?\nSource code / logs\n2018-04-20 12:57:33.287154: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1268] Converting unsupported operation: LogicalOr\n2018-04-20 12:57:33.302765: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 518 operators, 965 arrays (0 quantized)\n2018-04-20 12:57:33.312501: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After Removing unused ops pass 1: 477 operators, 902 arrays (0 quantized)\n2018-04-20 12:57:33.325133: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 477 operators, 902 arrays (0 quantized)\n2018-04-20 12:57:33.325335: F tensorflow/contrib/lite/toco/graph_transformations/resolve_tensorflow_switch.cc:95] Check failed: other_op->type == OperatorType::kTensorFlowMerge \nAborted (core dumped)\n\nI also make a summarize_graph for you, maybe it help\nFound 1 possible inputs: (name=input_image, type=int32(3), shape=[1,?,?,3]) \nNo variables spotted.\nFound 2 possible outputs: (name=output_corner, op=Tile) (name=output_mask, op=Tile) \nFound 1471309 (1.47M) const parameters, 0 (0) variable parameters, and 51 control_edges\nOp types used: 239 Const, 168 Switch, 36 FusedBatchNorm, 27 Add, 22 Identity, 21 Merge, 18 Conv2D, 15 Relu, 13 StridedSlice, 12 Shape, 7 Mul, 6 Cast, 5 MaxPool, 5 Pack, 5 RealDiv, 3 Slice, 3 Conv2DBackpropInput, 2 Tile, 2 Reshape, 2 RandomUniform, 2 PlaceholderWithDefault, 2 Greater, 2 Floor, 2 ConcatV2, 1 Placeholder, 1 Maximum, 1 LogicalOr, 1 ResizeBilinear, 1 Sigmoid, 1 Softmax, 1 Squeeze, 1 ExpandDims, 1 Sub, 1 ArgMax", "body": "### System information\r\n\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nLinux Ubuntu 18.04 Beta\r\n- **TensorFlow installed from (source or binary)**:\r\nSource\r\n- **TensorFlow version (use command below)**:\r\nMaster\r\n- **Python version**: \r\n3.6\r\n- **Bazel version (if compiling from source)**:\r\n0.10.0\r\n- **GCC/Compiler version (if compiling from source)**:\r\ngcc 4.8.5\r\n- **CUDA/cuDNN version**:\r\n9.1 / 7.0.5\r\n- **GPU model and memory**:\r\nGTX 1070 Ti 6go & 16Go RAM\r\n- **Exact command to reproduce**:\r\nbazel-bin/tensorflow/contrib/lite/toco/toco \r\n--input_file=frozen_graph.pb \r\n--input_format=TENSORFLOW_GRAPHDEF \r\n--output_format=TFLITE \r\n--output_file=/tmp/test.tflite \r\n--inference_input_type=FLOAT\r\n--input_arrays=input_image\r\n--output_arrays=output_corner,output_mask\r\n--input_shapes=1,512,512,3\r\n\r\n### Describe the problem\r\n\r\nI'm working on a FCN. I want to export my frozen graph to TfLite graph but it's not working. I'm wondering why, but I guess it's just due to the lack of maturity of TfLite (and probably some operator compatibility). In my case, it's about the operator \"Merge\". Someone can explain me if there is a way/trick to make it work ?\r\n\r\n### Source code / logs\r\n\r\n```\r\n2018-04-20 12:57:33.287154: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1268] Converting unsupported operation: LogicalOr\r\n2018-04-20 12:57:33.302765: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 518 operators, 965 arrays (0 quantized)\r\n2018-04-20 12:57:33.312501: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After Removing unused ops pass 1: 477 operators, 902 arrays (0 quantized)\r\n2018-04-20 12:57:33.325133: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 477 operators, 902 arrays (0 quantized)\r\n2018-04-20 12:57:33.325335: F tensorflow/contrib/lite/toco/graph_transformations/resolve_tensorflow_switch.cc:95] Check failed: other_op->type == OperatorType::kTensorFlowMerge \r\nAborted (core dumped)\r\n```\r\n\r\nI also make a summarize_graph for you, maybe it help\r\n\r\n```\r\nFound 1 possible inputs: (name=input_image, type=int32(3), shape=[1,?,?,3]) \r\nNo variables spotted.\r\nFound 2 possible outputs: (name=output_corner, op=Tile) (name=output_mask, op=Tile) \r\nFound 1471309 (1.47M) const parameters, 0 (0) variable parameters, and 51 control_edges\r\nOp types used: 239 Const, 168 Switch, 36 FusedBatchNorm, 27 Add, 22 Identity, 21 Merge, 18 Conv2D, 15 Relu, 13 StridedSlice, 12 Shape, 7 Mul, 6 Cast, 5 MaxPool, 5 Pack, 5 RealDiv, 3 Slice, 3 Conv2DBackpropInput, 2 Tile, 2 Reshape, 2 RandomUniform, 2 PlaceholderWithDefault, 2 Greater, 2 Floor, 2 ConcatV2, 1 Placeholder, 1 Maximum, 1 LogicalOr, 1 ResizeBilinear, 1 Sigmoid, 1 Softmax, 1 Squeeze, 1 ExpandDims, 1 Sub, 1 ArgMax\r\n```"}