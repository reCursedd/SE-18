{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/352652280", "html_url": "https://github.com/tensorflow/tensorflow/issues/15445#issuecomment-352652280", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15445", "id": 352652280, "node_id": "MDEyOklzc3VlQ29tbWVudDM1MjY1MjI4MA==", "user": {"login": "vinceyuan", "id": 1109524, "node_id": "MDQ6VXNlcjExMDk1MjQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/1109524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vinceyuan", "html_url": "https://github.com/vinceyuan", "followers_url": "https://api.github.com/users/vinceyuan/followers", "following_url": "https://api.github.com/users/vinceyuan/following{/other_user}", "gists_url": "https://api.github.com/users/vinceyuan/gists{/gist_id}", "starred_url": "https://api.github.com/users/vinceyuan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vinceyuan/subscriptions", "organizations_url": "https://api.github.com/users/vinceyuan/orgs", "repos_url": "https://api.github.com/users/vinceyuan/repos", "events_url": "https://api.github.com/users/vinceyuan/events{/privacy}", "received_events_url": "https://api.github.com/users/vinceyuan/received_events", "type": "User", "site_admin": false}, "created_at": "2017-12-19T06:29:48Z", "updated_at": "2017-12-19T06:29:48Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=16397721\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jakajacky\">@jakajacky</a> I also tried the old version of bazel which is used to build the official tensorflow releases. Same errors.</p>\n<p><strong>Good news! I accidentally built TensorFlow Lite successfully on macOS Sierra.</strong> Since I could not build the TensorFlow Lite converter, I wanted to convert TensorFlow model to CoreML. Then I installed <a href=\"https://apple.github.io/coremltools/\" rel=\"nofollow\">coremltools</a>. Because you mentioned you could not build <code>bazel build //tensorflow/contrib/lite/toco:toco</code> and I had the same problem, I tried to build it again. It worked! Probably it is because it installs <code>protobuf</code> and the older version of <code>six</code>.</p>\n<pre><code>$ sudo pip install -U coremltools\nPassword:\nThe directory '/Users/XXX/Library/Caches/pip/http' or its parent directory is not owned by the current user and the cache has been disabled. Please check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\nThe directory '/Users/XXX/Library/Caches/pip' or its parent directory is not owned by the current user and caching wheels has been disabled. check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\nCollecting coremltools\n  Downloading coremltools-0.7-cp27-none-macosx_10_12_intel.whl (3.7MB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3.7MB 198kB/s \nCollecting protobuf&gt;=3.1.0 (from coremltools)\n  Downloading protobuf-3.5.0.post1-py2.py3-none-any.whl (389kB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 389kB 1.6MB/s \nCollecting six==1.10.0 (from coremltools)\n  Downloading six-1.10.0-py2.py3-none-any.whl\nRequirement already up-to-date: numpy&gt;=1.6.2 in /anaconda/envs/mypython2/lib/python2.7/site-packages (from coremltools)\nRequirement already up-to-date: setuptools in /anaconda/envs/mypython2/lib/python2.7/site-packages (from protobuf&gt;=3.1.0-&gt;coremltools)\nInstalling collected packages: six, protobuf, coremltools\n  Found existing installation: six 1.11.0\n    Uninstalling six-1.11.0:\n      Successfully uninstalled six-1.11.0\nSuccessfully installed coremltools-0.7 protobuf-3.5.0.post1 six-1.10.0\n</code></pre>\n<pre><code>$ bazel build tensorflow/contrib/lite/toco:toco\nINFO: Analysed target //tensorflow/contrib/lite/toco:toco (5 packages loaded).\nINFO: Found 1 target...\nINFO: From ProtoCompile tensorflow/contrib/lite/toco/toco_flags.pb.cc:\nbazel-out/darwin-opt/genfiles/external/protobuf_archive/src: warning: directory does not exist.\nbazel-out/darwin-opt/genfiles/external/protobuf_archive/src: warning: directory does not exist.\n...\nTarget //tensorflow/contrib/lite/toco:toco up-to-date:\n  bazel-bin/tensorflow/contrib/lite/toco/toco\nINFO: Elapsed time: 312.332s, Critical Path: 35.52s\nINFO: Build completed successfully, 748 total actions\n</code></pre>\n<pre><code>$ bazel build tensorflow/python/tools:freeze_graph\nINFO: Analysed target //tensorflow/python/tools:freeze_graph (1 packages loaded).\nINFO: Found 1 target...\nINFO: From Linking tensorflow/core/liblib_internal_impl.a [for host]:\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib: file: bazel-out/host/bin/tensorflow/core/liblib_internal_impl.a(android_armv7a_cpu_utils_helper.o) has no symbols\nINFO: From Compiling tensorflow/core/framework/op_kernel.cc [for host]:\ntensorflow/core/framework/op_kernel.cc:962:8: warning: unused function 'FindKernelRegistration' [-Wunused-function]\nStatus FindKernelRegistration(const DeviceType&amp; device_type, const Node&amp; node,\n       ^\n1 warning generated.\nINFO: From Compiling tensorflow/core/common_runtime/executor.cc [for host]:\ntensorflow/core/common_runtime/executor.cc:1945:19: warning: calling function 'ActivateNodes' requires holding mutex 'output_frame-&gt;mu' exclusively [-Wthread-safety-precise]\n    output_frame-&gt;ActivateNodes(item, is_dead, output_iter, outputs, ready);\n...\nTarget //tensorflow/python/tools:freeze_graph up-to-date:\n  bazel-bin/tensorflow/python/tools/freeze_graph\nINFO: Elapsed time: 6941.332s, Critical Path: 104.91s\nINFO: Build completed successfully, 3787 total actions\n</code></pre>\n<pre><code>$ bazel build -c opt --cxxopt='--std=c++11' //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo\nINFO: Analysed target //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo (3 packages loaded).\nINFO: Found 1 target...\nTarget //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo up-to-date:\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo_deploy.jar\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo_unsigned.apk\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo.apk\nINFO: Elapsed time: 63.940s, Critical Path: 26.61s\nINFO: Build completed successfully, 211 total actions\n</code></pre>", "body_text": "@jakajacky I also tried the old version of bazel which is used to build the official tensorflow releases. Same errors.\nGood news! I accidentally built TensorFlow Lite successfully on macOS Sierra. Since I could not build the TensorFlow Lite converter, I wanted to convert TensorFlow model to CoreML. Then I installed coremltools. Because you mentioned you could not build bazel build //tensorflow/contrib/lite/toco:toco and I had the same problem, I tried to build it again. It worked! Probably it is because it installs protobuf and the older version of six.\n$ sudo pip install -U coremltools\nPassword:\nThe directory '/Users/XXX/Library/Caches/pip/http' or its parent directory is not owned by the current user and the cache has been disabled. Please check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\nThe directory '/Users/XXX/Library/Caches/pip' or its parent directory is not owned by the current user and caching wheels has been disabled. check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\nCollecting coremltools\n  Downloading coremltools-0.7-cp27-none-macosx_10_12_intel.whl (3.7MB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3.7MB 198kB/s \nCollecting protobuf>=3.1.0 (from coremltools)\n  Downloading protobuf-3.5.0.post1-py2.py3-none-any.whl (389kB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 389kB 1.6MB/s \nCollecting six==1.10.0 (from coremltools)\n  Downloading six-1.10.0-py2.py3-none-any.whl\nRequirement already up-to-date: numpy>=1.6.2 in /anaconda/envs/mypython2/lib/python2.7/site-packages (from coremltools)\nRequirement already up-to-date: setuptools in /anaconda/envs/mypython2/lib/python2.7/site-packages (from protobuf>=3.1.0->coremltools)\nInstalling collected packages: six, protobuf, coremltools\n  Found existing installation: six 1.11.0\n    Uninstalling six-1.11.0:\n      Successfully uninstalled six-1.11.0\nSuccessfully installed coremltools-0.7 protobuf-3.5.0.post1 six-1.10.0\n\n$ bazel build tensorflow/contrib/lite/toco:toco\nINFO: Analysed target //tensorflow/contrib/lite/toco:toco (5 packages loaded).\nINFO: Found 1 target...\nINFO: From ProtoCompile tensorflow/contrib/lite/toco/toco_flags.pb.cc:\nbazel-out/darwin-opt/genfiles/external/protobuf_archive/src: warning: directory does not exist.\nbazel-out/darwin-opt/genfiles/external/protobuf_archive/src: warning: directory does not exist.\n...\nTarget //tensorflow/contrib/lite/toco:toco up-to-date:\n  bazel-bin/tensorflow/contrib/lite/toco/toco\nINFO: Elapsed time: 312.332s, Critical Path: 35.52s\nINFO: Build completed successfully, 748 total actions\n\n$ bazel build tensorflow/python/tools:freeze_graph\nINFO: Analysed target //tensorflow/python/tools:freeze_graph (1 packages loaded).\nINFO: Found 1 target...\nINFO: From Linking tensorflow/core/liblib_internal_impl.a [for host]:\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib: file: bazel-out/host/bin/tensorflow/core/liblib_internal_impl.a(android_armv7a_cpu_utils_helper.o) has no symbols\nINFO: From Compiling tensorflow/core/framework/op_kernel.cc [for host]:\ntensorflow/core/framework/op_kernel.cc:962:8: warning: unused function 'FindKernelRegistration' [-Wunused-function]\nStatus FindKernelRegistration(const DeviceType& device_type, const Node& node,\n       ^\n1 warning generated.\nINFO: From Compiling tensorflow/core/common_runtime/executor.cc [for host]:\ntensorflow/core/common_runtime/executor.cc:1945:19: warning: calling function 'ActivateNodes' requires holding mutex 'output_frame->mu' exclusively [-Wthread-safety-precise]\n    output_frame->ActivateNodes(item, is_dead, output_iter, outputs, ready);\n...\nTarget //tensorflow/python/tools:freeze_graph up-to-date:\n  bazel-bin/tensorflow/python/tools/freeze_graph\nINFO: Elapsed time: 6941.332s, Critical Path: 104.91s\nINFO: Build completed successfully, 3787 total actions\n\n$ bazel build -c opt --cxxopt='--std=c++11' //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo\nINFO: Analysed target //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo (3 packages loaded).\nINFO: Found 1 target...\nTarget //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo up-to-date:\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo_deploy.jar\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo_unsigned.apk\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo.apk\nINFO: Elapsed time: 63.940s, Critical Path: 26.61s\nINFO: Build completed successfully, 211 total actions", "body": "@jakajacky I also tried the old version of bazel which is used to build the official tensorflow releases. Same errors.\r\n\r\n**Good news! I accidentally built TensorFlow Lite successfully on macOS Sierra.** Since I could not build the TensorFlow Lite converter, I wanted to convert TensorFlow model to CoreML. Then I installed [coremltools](https://apple.github.io/coremltools/). Because you mentioned you could not build `bazel build //tensorflow/contrib/lite/toco:toco` and I had the same problem, I tried to build it again. It worked! Probably it is because it installs `protobuf` and the older version of `six`.\r\n\r\n```\r\n$ sudo pip install -U coremltools\r\nPassword:\r\nThe directory '/Users/XXX/Library/Caches/pip/http' or its parent directory is not owned by the current user and the cache has been disabled. Please check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\r\nThe directory '/Users/XXX/Library/Caches/pip' or its parent directory is not owned by the current user and caching wheels has been disabled. check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\r\nCollecting coremltools\r\n  Downloading coremltools-0.7-cp27-none-macosx_10_12_intel.whl (3.7MB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3.7MB 198kB/s \r\nCollecting protobuf>=3.1.0 (from coremltools)\r\n  Downloading protobuf-3.5.0.post1-py2.py3-none-any.whl (389kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 389kB 1.6MB/s \r\nCollecting six==1.10.0 (from coremltools)\r\n  Downloading six-1.10.0-py2.py3-none-any.whl\r\nRequirement already up-to-date: numpy>=1.6.2 in /anaconda/envs/mypython2/lib/python2.7/site-packages (from coremltools)\r\nRequirement already up-to-date: setuptools in /anaconda/envs/mypython2/lib/python2.7/site-packages (from protobuf>=3.1.0->coremltools)\r\nInstalling collected packages: six, protobuf, coremltools\r\n  Found existing installation: six 1.11.0\r\n    Uninstalling six-1.11.0:\r\n      Successfully uninstalled six-1.11.0\r\nSuccessfully installed coremltools-0.7 protobuf-3.5.0.post1 six-1.10.0\r\n```\r\n\r\n```\r\n$ bazel build tensorflow/contrib/lite/toco:toco\r\nINFO: Analysed target //tensorflow/contrib/lite/toco:toco (5 packages loaded).\r\nINFO: Found 1 target...\r\nINFO: From ProtoCompile tensorflow/contrib/lite/toco/toco_flags.pb.cc:\r\nbazel-out/darwin-opt/genfiles/external/protobuf_archive/src: warning: directory does not exist.\r\nbazel-out/darwin-opt/genfiles/external/protobuf_archive/src: warning: directory does not exist.\r\n...\r\nTarget //tensorflow/contrib/lite/toco:toco up-to-date:\r\n  bazel-bin/tensorflow/contrib/lite/toco/toco\r\nINFO: Elapsed time: 312.332s, Critical Path: 35.52s\r\nINFO: Build completed successfully, 748 total actions\r\n```\r\n\r\n```\r\n$ bazel build tensorflow/python/tools:freeze_graph\r\nINFO: Analysed target //tensorflow/python/tools:freeze_graph (1 packages loaded).\r\nINFO: Found 1 target...\r\nINFO: From Linking tensorflow/core/liblib_internal_impl.a [for host]:\r\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib: file: bazel-out/host/bin/tensorflow/core/liblib_internal_impl.a(android_armv7a_cpu_utils_helper.o) has no symbols\r\nINFO: From Compiling tensorflow/core/framework/op_kernel.cc [for host]:\r\ntensorflow/core/framework/op_kernel.cc:962:8: warning: unused function 'FindKernelRegistration' [-Wunused-function]\r\nStatus FindKernelRegistration(const DeviceType& device_type, const Node& node,\r\n       ^\r\n1 warning generated.\r\nINFO: From Compiling tensorflow/core/common_runtime/executor.cc [for host]:\r\ntensorflow/core/common_runtime/executor.cc:1945:19: warning: calling function 'ActivateNodes' requires holding mutex 'output_frame->mu' exclusively [-Wthread-safety-precise]\r\n    output_frame->ActivateNodes(item, is_dead, output_iter, outputs, ready);\r\n...\r\nTarget //tensorflow/python/tools:freeze_graph up-to-date:\r\n  bazel-bin/tensorflow/python/tools/freeze_graph\r\nINFO: Elapsed time: 6941.332s, Critical Path: 104.91s\r\nINFO: Build completed successfully, 3787 total actions\r\n```\r\n\r\n```\r\n$ bazel build -c opt --cxxopt='--std=c++11' //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo\r\nINFO: Analysed target //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo (3 packages loaded).\r\nINFO: Found 1 target...\r\nTarget //tensorflow/contrib/lite/java/demo/app/src/main:TfLiteCameraDemo up-to-date:\r\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo_deploy.jar\r\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo_unsigned.apk\r\n  bazel-bin/tensorflow/contrib/lite/java/demo/app/src/main/TfLiteCameraDemo.apk\r\nINFO: Elapsed time: 63.940s, Critical Path: 26.61s\r\nINFO: Build completed successfully, 211 total actions\r\n```"}