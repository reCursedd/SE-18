{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20397", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20397/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20397/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20397/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/20397", "id": 336848165, "node_id": "MDU6SXNzdWUzMzY4NDgxNjU=", "number": 20397, "title": "tf.image.decode_png bug", "user": {"login": "whyguu", "id": 26961073, "node_id": "MDQ6VXNlcjI2OTYxMDcz", "avatar_url": "https://avatars2.githubusercontent.com/u/26961073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whyguu", "html_url": "https://github.com/whyguu", "followers_url": "https://api.github.com/users/whyguu/followers", "following_url": "https://api.github.com/users/whyguu/following{/other_user}", "gists_url": "https://api.github.com/users/whyguu/gists{/gist_id}", "starred_url": "https://api.github.com/users/whyguu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whyguu/subscriptions", "organizations_url": "https://api.github.com/users/whyguu/orgs", "repos_url": "https://api.github.com/users/whyguu/repos", "events_url": "https://api.github.com/users/whyguu/events{/privacy}", "received_events_url": "https://api.github.com/users/whyguu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-06-29T03:12:04Z", "updated_at": "2018-07-12T18:02:39Z", "closed_at": "2018-07-12T18:02:38Z", "author_association": "NONE", "body_html": "<p>Please go to Stack Overflow for help and support:</p>\n<p><a href=\"https://stackoverflow.com/questions/tagged/tensorflow\" rel=\"nofollow\">https://stackoverflow.com/questions/tagged/tensorflow</a></p>\n<p>If you open a GitHub issue, here is our policy:</p>\n<ol>\n<li>It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).</li>\n<li>The form below must be filled out.</li>\n<li>It shouldn't be a TensorBoard issue. Those go <a href=\"https://github.com/tensorflow/tensorboard/issues\">here</a>.</li>\n</ol>\n<p><strong>Here's why we have that policy</strong>: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.</p>\n<hr>\n<h3>System information</h3>\n<ul>\n<li>official docker image , Linux Ubuntu 16.04</li>\n<li>tf1.8.0  v1.8.0-0-g93bc2e2072 1.8.0</li>\n<li>python3.5.2</li>\n<li>Cuda compilation tools, release 9.0, V9.0.176</li>\n<li>GPU:1080Ti</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>tf.image.decode_png can not decode a gray png which has size 60064</p>\n<h3>Source code / logs</h3>\n<p>pp = 'SRAD2018_TRAIN_004/RAD_296582494212544/RAD_296582494212544_004.png'<br>\nim = io.imread(pp)<br>\nprint('haha:  ',  im.shape)<br>\ncontent = tf.read_file(pp)<br>\nimg = tf.image.decode_png(content, channels=1)<br>\nwith tf.Session() as sess:<br>\nig = sess.run(img)<br>\nprint(ig.shape)<br>\npicture can be downloaded here <a href=\"https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.451d5147iiIyoD&amp;raceId=231662\" rel=\"nofollow\">https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.451d5147iiIyoD&amp;raceId=231662</a><br>\nit is a competition hosted by aliyun,  the competition name is \"IEEE ICDM 2018 \u5168\u7403\u6c14\u8c61AI\u6311\u6218\u8d5b\"</p>\n<p>picture name is 'SRAD2018_TRAIN_004/RAD_296582494212544/RAD_296582494212544_004.png'</p>\n<p>I met this problem several times. maybe there are several pictures can repeat this bug. i just give an example above. at everytime the bug occurs with image having size 65564.</p>\n<p>only images having size 65504 can not be decoded, and skimage.io can read the picture correctly.</p>\n<h3>Logs</h3>\n<p>haha:  (501, 501)<br>\n2018-06-29 02:57:24.012213: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>\n2018-06-29 02:57:24.128019: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-06-29 02:57:24.128635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645<br>\npciBusID: 0000:01:00.0<br>\ntotalMemory: 10.91GiB freeMemory: 222.81MiB<br>\n2018-06-29 02:57:24.328695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-06-29 02:57:24.329699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645<br>\npciBusID: 0000:04:00.0<br>\ntotalMemory: 10.91GiB freeMemory: 9.93GiB<br>\n2018-06-29 02:57:24.527217: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero<br>\n2018-06-29 02:57:24.528368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645<br>\npciBusID: 0000:06:00.0<br>\ntotalMemory: 10.91GiB freeMemory: 10.74GiB<br>\n2018-06-29 02:57:24.539737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2<br>\n2018-06-29 02:57:25.708418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-06-29 02:57:25.708454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2<br>\n2018-06-29 02:57:25.708465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y<br>\n2018-06-29 02:57:25.708475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y<br>\n2018-06-29 02:57:25.708486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N<br>\n2018-06-29 02:57:25.709161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 166 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)<br>\n2018-06-29 02:57:25.710945: E tensorflow/stream_executor/cuda/cuda_driver.cc:936] failed to allocate 166.81M (174915584 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY<br>\n2018-06-29 02:57:25.715583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 9604 MB memory) -&gt; physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)<br>\n2018-06-29 02:57:25.827449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10397 MB memory) -&gt; physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:06:00.0, compute capability: 6.1)<br>\nTraceback (most recent call last):<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1322, in _do_call<br>\nreturn fn(*args)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1307, in _run_fn<br>\noptions, feed_dict, fetch_list, target_list, run_metadata)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun<br>\nrun_metadata)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid PNG data, size 65564<br>\n[[Node: DecodePng = DecodePng<a href=\"ReadFile\">channels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"model.py\", line 452, in <br>\nig = sess.run(img)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 900, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run<br>\nrun_metadata)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid PNG data, size 65564<br>\n[[Node: DecodePng = DecodePng<a href=\"ReadFile\">channels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n<p>Caused by op 'DecodePng', defined at:<br>\nFile \"model.py\", line 450, in <br>\nimg = tf.image.decode_png(content, channels=1)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_image_ops.py\", line 1062, in decode_png<br>\nname=name)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op<br>\nop_def=op_def)<br>\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 1718, in <strong>init</strong><br>\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access</p>\n<p>InvalidArgumentError (see above for traceback): Invalid PNG data, size 65564<br>\n[[Node: DecodePng = DecodePng<a href=\"ReadFile\">channels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>", "body_text": "Please go to Stack Overflow for help and support:\nhttps://stackoverflow.com/questions/tagged/tensorflow\nIf you open a GitHub issue, here is our policy:\n\nIt must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\nThe form below must be filled out.\nIt shouldn't be a TensorBoard issue. Those go here.\n\nHere's why we have that policy: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\n\nSystem information\n\nofficial docker image , Linux Ubuntu 16.04\ntf1.8.0  v1.8.0-0-g93bc2e2072 1.8.0\npython3.5.2\nCuda compilation tools, release 9.0, V9.0.176\nGPU:1080Ti\n\nDescribe the problem\ntf.image.decode_png can not decode a gray png which has size 60064\nSource code / logs\npp = 'SRAD2018_TRAIN_004/RAD_296582494212544/RAD_296582494212544_004.png'\nim = io.imread(pp)\nprint('haha:  ',  im.shape)\ncontent = tf.read_file(pp)\nimg = tf.image.decode_png(content, channels=1)\nwith tf.Session() as sess:\nig = sess.run(img)\nprint(ig.shape)\npicture can be downloaded here https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.451d5147iiIyoD&raceId=231662\nit is a competition hosted by aliyun,  the competition name is \"IEEE ICDM 2018 \u5168\u7403\u6c14\u8c61AI\u6311\u6218\u8d5b\"\npicture name is 'SRAD2018_TRAIN_004/RAD_296582494212544/RAD_296582494212544_004.png'\nI met this problem several times. maybe there are several pictures can repeat this bug. i just give an example above. at everytime the bug occurs with image having size 65564.\nonly images having size 65504 can not be decoded, and skimage.io can read the picture correctly.\nLogs\nhaha:  (501, 501)\n2018-06-29 02:57:24.012213: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-06-29 02:57:24.128019: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-06-29 02:57:24.128635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645\npciBusID: 0000:01:00.0\ntotalMemory: 10.91GiB freeMemory: 222.81MiB\n2018-06-29 02:57:24.328695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-06-29 02:57:24.329699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645\npciBusID: 0000:04:00.0\ntotalMemory: 10.91GiB freeMemory: 9.93GiB\n2018-06-29 02:57:24.527217: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2018-06-29 02:57:24.528368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645\npciBusID: 0000:06:00.0\ntotalMemory: 10.91GiB freeMemory: 10.74GiB\n2018-06-29 02:57:24.539737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2\n2018-06-29 02:57:25.708418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-06-29 02:57:25.708454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2\n2018-06-29 02:57:25.708465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y\n2018-06-29 02:57:25.708475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y\n2018-06-29 02:57:25.708486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N\n2018-06-29 02:57:25.709161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 166 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-06-29 02:57:25.710945: E tensorflow/stream_executor/cuda/cuda_driver.cc:936] failed to allocate 166.81M (174915584 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY\n2018-06-29 02:57:25.715583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 9604 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)\n2018-06-29 02:57:25.827449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10397 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:06:00.0, compute capability: 6.1)\nTraceback (most recent call last):\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1322, in _do_call\nreturn fn(*args)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1307, in _run_fn\noptions, feed_dict, fetch_list, target_list, run_metadata)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\nrun_metadata)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid PNG data, size 65564\n[[Node: DecodePng = DecodePngchannels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"model.py\", line 452, in \nig = sess.run(img)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 900, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\nrun_metadata)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid PNG data, size 65564\n[[Node: DecodePng = DecodePngchannels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\nCaused by op 'DecodePng', defined at:\nFile \"model.py\", line 450, in \nimg = tf.image.decode_png(content, channels=1)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_image_ops.py\", line 1062, in decode_png\nname=name)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\nop_def=op_def)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op\nop_def=op_def)\nFile \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 1718, in init\nself._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\nInvalidArgumentError (see above for traceback): Invalid PNG data, size 65564\n[[Node: DecodePng = DecodePngchannels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- official docker image , Linux Ubuntu 16.04\r\n- tf1.8.0  v1.8.0-0-g93bc2e2072 1.8.0\r\n- python3.5.2\r\n- Cuda compilation tools, release 9.0, V9.0.176\r\n- GPU:1080Ti \r\n\r\n### Describe the problem\r\ntf.image.decode_png can not decode a gray png which has size 60064\r\n\r\n### Source code / logs\r\npp = 'SRAD2018_TRAIN_004/RAD_296582494212544/RAD_296582494212544_004.png'\r\nim = io.imread(pp)\r\nprint('haha:  ',  im.shape)\r\ncontent = tf.read_file(pp)\r\nimg = tf.image.decode_png(content, channels=1)\r\nwith tf.Session() as sess:\r\n     ig = sess.run(img)\r\n     print(ig.shape)\r\npicture can be downloaded here https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.451d5147iiIyoD&raceId=231662\r\nit is a competition hosted by aliyun,  the competition name is \"IEEE ICDM 2018 \u5168\u7403\u6c14\u8c61AI\u6311\u6218\u8d5b\"\r\n\r\npicture name is 'SRAD2018_TRAIN_004/RAD_296582494212544/RAD_296582494212544_004.png'\r\n\r\nI met this problem several times. maybe there are several pictures can repeat this bug. i just give an example above. at everytime the bug occurs with image having size 65564.\r\n\r\nonly images having size 65504 can not be decoded, and skimage.io can read the picture correctly.\r\n### Logs\r\nhaha:  (501, 501)\r\n2018-06-29 02:57:24.012213: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-06-29 02:57:24.128019: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-06-29 02:57:24.128635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 10.91GiB freeMemory: 222.81MiB\r\n2018-06-29 02:57:24.328695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-06-29 02:57:24.329699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645\r\npciBusID: 0000:04:00.0\r\ntotalMemory: 10.91GiB freeMemory: 9.93GiB\r\n2018-06-29 02:57:24.527217: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-06-29 02:57:24.528368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645\r\npciBusID: 0000:06:00.0\r\ntotalMemory: 10.91GiB freeMemory: 10.74GiB\r\n2018-06-29 02:57:24.539737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2\r\n2018-06-29 02:57:25.708418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-06-29 02:57:25.708454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 \r\n2018-06-29 02:57:25.708465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y \r\n2018-06-29 02:57:25.708475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y \r\n2018-06-29 02:57:25.708486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N \r\n2018-06-29 02:57:25.709161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 166 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-06-29 02:57:25.710945: E tensorflow/stream_executor/cuda/cuda_driver.cc:936] failed to allocate 166.81M (174915584 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY\r\n2018-06-29 02:57:25.715583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 9604 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)\r\n2018-06-29 02:57:25.827449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10397 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:06:00.0, compute capability: 6.1)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1322, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1307, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1409, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid PNG data, size 65564\r\n\t [[Node: DecodePng = DecodePng[channels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](ReadFile)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"model.py\", line 452, in <module>\r\n    ig = sess.run(img)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 900, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1135, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\r\n    run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid PNG data, size 65564\r\n\t [[Node: DecodePng = DecodePng[channels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](ReadFile)]]\r\n\r\nCaused by op 'DecodePng', defined at:\r\n  File \"model.py\", line 450, in <module>\r\n    img = tf.image.decode_png(content, channels=1)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_image_ops.py\", line 1062, in decode_png\r\n    name=name)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 3392, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 1718, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): Invalid PNG data, size 65564\r\n\t [[Node: DecodePng = DecodePng[channels=1, dtype=DT_UINT8, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](ReadFile)]]\r\n\r\n"}