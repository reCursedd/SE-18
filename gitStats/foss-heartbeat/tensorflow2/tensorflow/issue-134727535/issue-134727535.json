{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1181", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1181/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1181/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1181/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1181", "id": 134727535, "node_id": "MDU6SXNzdWUxMzQ3Mjc1MzU=", "number": 1181, "title": "tensorflow.gfile.Open() error with MNIST example in python 3.4", "user": {"login": "hemanthdv", "id": 8747166, "node_id": "MDQ6VXNlcjg3NDcxNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/8747166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hemanthdv", "html_url": "https://github.com/hemanthdv", "followers_url": "https://api.github.com/users/hemanthdv/followers", "following_url": "https://api.github.com/users/hemanthdv/following{/other_user}", "gists_url": "https://api.github.com/users/hemanthdv/gists{/gist_id}", "starred_url": "https://api.github.com/users/hemanthdv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hemanthdv/subscriptions", "organizations_url": "https://api.github.com/users/hemanthdv/orgs", "repos_url": "https://api.github.com/users/hemanthdv/repos", "events_url": "https://api.github.com/users/hemanthdv/events{/privacy}", "received_events_url": "https://api.github.com/users/hemanthdv/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-02-18T23:19:45Z", "updated_at": "2016-02-22T16:36:50Z", "closed_at": "2016-02-18T23:23:27Z", "author_association": "NONE", "body_html": "<p>The <code>tf.gfile.Open(filename)</code> function throws an error when a bytestream is read. The issue arises in tensorflow/examples/tutorials/mnist using python 3.4</p>\n<h3>Environment info</h3>\n<p>Operating System:<br>\nUbuntu LTS 14.04 64bit</p>\n<ol>\n<li>pip package installed:<br>\n<code>sudo pip3 install --upgrade https://storage.googleapis.com/tensorflow/linux/gpu/tensorflow-0.7.0-cp34-none-linux_x86_64.whl</code></li>\n<li>The output from python -c \"import tensorflow; print(tensorflow.<strong>version</strong>)\".<br>\n<code>python3 -c \"import tensorflow; print(tensorflow.__version__)\" I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally 0.7.0 </code>\n<h3>Steps to reproduce</h3>\nRun the mnist example in tensorflow with python3<br>\n<code>from tensorflow.examples.tutorials.mnist import input_data mnist = input_data.read_data_sets(\"MNIST_data/\", one_hot=True)</code></li>\n</ol>\n<h3>Steps to overcome</h3>\n<p>Got rid of the tf.gfile.Open function call. Replaced the line:<br>\n<code>with tf.gfile.Open(filename) as f, gzip.GzipFile(fileobj=f) as bytestream:</code><br>\nwith<br>\n<code>with gzip.GzipFile(filename=filename) as bytestream:</code></p>\n<h3>Logs</h3>\n<p><code>Extracting MNIST_data/train-labels-idx1-ubyte.gz</code><br>\n<code>Successfully downloaded train-images-idx3-ubyte.gz 9912422 bytes.</code><br>\n<code>Extracting MNIST_data/train-images-idx3-ubyte.gz</code><br>\n<code>Traceback (most recent call last):</code><br>\n<code>File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;</code><br>\n<code>File \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 202, in read_data_sets</code><br>\n<code>train_images = extract_images(local_file)</code><br>\n<code>File \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 58, in extract_images</code><br>\n<code>magic = _read32(bytestream)</code><br>\n<code>File \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 51, in _read32</code><br>\n<code>return numpy.frombuffer(bytestream.read(4), dtype=dt)[0]</code><br>\n<code>File \"/usr/lib/python3.4/gzip.py\", line 365, in read</code><br>\n<code>if not self._read(readsize):</code><br>\n<code>File \"/usr/lib/python3.4/gzip.py\", line 433, in _read</code><br>\n<code>if not self._read_gzip_header():</code><br>\n<code>File \"/usr/lib/python3.4/gzip.py\", line 292, in _read_gzip_header</code><br>\n<code>magic = self.fileobj.read(2)</code><br>\n<code>File \"/usr/lib/python3.4/gzip.py\", line 90, in read</code><br>\n<code>self.file.read(size-self._length+read)</code><br>\n<code>File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/platform/default/_gfile.py\", line 45, in sync</code><br>\n<code>return fn(self, *args, **kwargs)</code><br>\n<code>File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/platform/default/_gfile.py\", line 199, in read</code><br>\n<code>return self._fp.read(n)</code><br>\n<code>File \"/usr/lib/python3.4/codecs.py\", line 319, in decode</code><br>\n<code>(result, consumed) = self._buffer_decode(data, self.errors, final)</code><br>\n<code>UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte</code></p>", "body_text": "The tf.gfile.Open(filename) function throws an error when a bytestream is read. The issue arises in tensorflow/examples/tutorials/mnist using python 3.4\nEnvironment info\nOperating System:\nUbuntu LTS 14.04 64bit\n\npip package installed:\nsudo pip3 install --upgrade https://storage.googleapis.com/tensorflow/linux/gpu/tensorflow-0.7.0-cp34-none-linux_x86_64.whl\nThe output from python -c \"import tensorflow; print(tensorflow.version)\".\npython3 -c \"import tensorflow; print(tensorflow.__version__)\" I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so locally I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally 0.7.0 \nSteps to reproduce\nRun the mnist example in tensorflow with python3\nfrom tensorflow.examples.tutorials.mnist import input_data mnist = input_data.read_data_sets(\"MNIST_data/\", one_hot=True)\n\nSteps to overcome\nGot rid of the tf.gfile.Open function call. Replaced the line:\nwith tf.gfile.Open(filename) as f, gzip.GzipFile(fileobj=f) as bytestream:\nwith\nwith gzip.GzipFile(filename=filename) as bytestream:\nLogs\nExtracting MNIST_data/train-labels-idx1-ubyte.gz\nSuccessfully downloaded train-images-idx3-ubyte.gz 9912422 bytes.\nExtracting MNIST_data/train-images-idx3-ubyte.gz\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nFile \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 202, in read_data_sets\ntrain_images = extract_images(local_file)\nFile \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 58, in extract_images\nmagic = _read32(bytestream)\nFile \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 51, in _read32\nreturn numpy.frombuffer(bytestream.read(4), dtype=dt)[0]\nFile \"/usr/lib/python3.4/gzip.py\", line 365, in read\nif not self._read(readsize):\nFile \"/usr/lib/python3.4/gzip.py\", line 433, in _read\nif not self._read_gzip_header():\nFile \"/usr/lib/python3.4/gzip.py\", line 292, in _read_gzip_header\nmagic = self.fileobj.read(2)\nFile \"/usr/lib/python3.4/gzip.py\", line 90, in read\nself.file.read(size-self._length+read)\nFile \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/platform/default/_gfile.py\", line 45, in sync\nreturn fn(self, *args, **kwargs)\nFile \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/platform/default/_gfile.py\", line 199, in read\nreturn self._fp.read(n)\nFile \"/usr/lib/python3.4/codecs.py\", line 319, in decode\n(result, consumed) = self._buffer_decode(data, self.errors, final)\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte", "body": "The `tf.gfile.Open(filename)` function throws an error when a bytestream is read. The issue arises in tensorflow/examples/tutorials/mnist using python 3.4\n### Environment info\n\nOperating System:\nUbuntu LTS 14.04 64bit\n1. pip package installed: \n   `sudo pip3 install --upgrade https://storage.googleapis.com/tensorflow/linux/gpu/tensorflow-0.7.0-cp34-none-linux_x86_64.whl`\n2. The output from python -c \"import tensorflow; print(tensorflow.**version**)\". \n   `python3 -c \"import tensorflow; print(tensorflow.__version__)\"\n   I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally\n   I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally\n   I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally\n   I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so locally\n   I tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally\n   0.7.0\n   `\n   ### Steps to reproduce\n   Run the mnist example in tensorflow with python3\n   `from tensorflow.examples.tutorials.mnist import input_data\n   mnist = input_data.read_data_sets(\"MNIST_data/\", one_hot=True)`\n### Steps to overcome\n\nGot rid of the tf.gfile.Open function call. Replaced the line:\n`with tf.gfile.Open(filename) as f, gzip.GzipFile(fileobj=f) as bytestream:`\nwith\n`with gzip.GzipFile(filename=filename) as bytestream:`\n### Logs\n\n`Extracting MNIST_data/train-labels-idx1-ubyte.gz`\n`Successfully downloaded train-images-idx3-ubyte.gz 9912422 bytes.`\n`Extracting MNIST_data/train-images-idx3-ubyte.gz`\n`Traceback (most recent call last):`\n`File \"<stdin>\", line 1, in <module>`\n`File \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 202, in read_data_sets`\n`train_images = extract_images(local_file)`\n`File \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 58, in extract_images`\n`magic = _read32(bytestream)`\n`File \"/usr/local/lib/python3.4/dist-packages/tensorflow/examples/tutorials/mnist/input_data.py\", line 51, in _read32`\n`return numpy.frombuffer(bytestream.read(4), dtype=dt)[0]`\n`File \"/usr/lib/python3.4/gzip.py\", line 365, in read`\n`if not self._read(readsize):`\n`File \"/usr/lib/python3.4/gzip.py\", line 433, in _read`\n`if not self._read_gzip_header():`\n`File \"/usr/lib/python3.4/gzip.py\", line 292, in _read_gzip_header`\n`magic = self.fileobj.read(2)`\n`File \"/usr/lib/python3.4/gzip.py\", line 90, in read`\n`self.file.read(size-self._length+read)`\n`File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/platform/default/_gfile.py\", line 45, in sync`\n`return fn(self, *args, **kwargs)`\n`File \"/usr/local/lib/python3.4/dist-packages/tensorflow/python/platform/default/_gfile.py\", line 199, in read`\n`return self._fp.read(n)`\n`File \"/usr/lib/python3.4/codecs.py\", line 319, in decode`\n`(result, consumed) = self._buffer_decode(data, self.errors, final)`\n`UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte`\n"}