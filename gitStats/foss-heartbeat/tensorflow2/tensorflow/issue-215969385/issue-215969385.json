{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8617", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8617/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8617/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8617/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/8617", "id": 215969385, "node_id": "MDU6SXNzdWUyMTU5NjkzODU=", "number": 8617, "title": "Error when using lookup table from tf.contrib.keras", "user": {"login": "ophiry", "id": 5228696, "node_id": "MDQ6VXNlcjUyMjg2OTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5228696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ophiry", "html_url": "https://github.com/ophiry", "followers_url": "https://api.github.com/users/ophiry/followers", "following_url": "https://api.github.com/users/ophiry/following{/other_user}", "gists_url": "https://api.github.com/users/ophiry/gists{/gist_id}", "starred_url": "https://api.github.com/users/ophiry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ophiry/subscriptions", "organizations_url": "https://api.github.com/users/ophiry/orgs", "repos_url": "https://api.github.com/users/ophiry/repos", "events_url": "https://api.github.com/users/ophiry/events{/privacy}", "received_events_url": "https://api.github.com/users/ophiry/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-03-22T06:51:25Z", "updated_at": "2017-07-15T21:55:55Z", "closed_at": "2017-03-23T15:43:19Z", "author_association": "NONE", "body_html": "<p>I'm trying to build a simple model that includes string input and lookup in a lookup table, and embedding.</p>\n<p>I get an error that appears to caused by using non keras layers in a keras model</p>\n<p>the code:</p>\n<pre><code>import tensorflow.contrib.keras as keras\nimport tensorflow\n\ninput_layer = keras.layers.Input(shape=(1,), name='input', dtype='string')\nlut = tensorflow.contrib.lookup.HashTable(tensorflow.contrib.lookup.KeyValueTensorInitializer(['a', 'b', 'c'], [1, 2, 3]), default_value=-1)\nlut_layer = lut.lookup(input_layer)\nembed = keras.layers.Embedding(input_dim=10, output_dim=5)(lut_layer)\n\nmodel = keras.models.Model(inputs=[input_layer], outputs=[embed])\n\n\n</code></pre>\n<p>the error:</p>\n<pre><code>Traceback (most recent call last):\n  File \"/Users/ophir/dev/ophir/tf_keras_2.py\", line 10, in &lt;module&gt;\n    model = keras.models.Model(inputs=[input_layer], outputs=[embed])\n  File \"/Users/ophir/anaconda3/envs/tf_master/lib/python3.6/site-packages/tensorflow/contrib/keras/python/keras/engine/topology.py\", line 1640, in __init__\n    build_map_of_graph(x, seen_nodes, depth=0)\n  File \"/Users/ophir/anaconda3/envs/tf_master/lib/python3.6/site-packages/tensorflow/contrib/keras/python/keras/engine/topology.py\", line 1631, in build_map_of_graph\n    next_node = layer.inbound_nodes[node_index]\nAttributeError: 'NoneType' object has no attribute 'inbound_nodes'\n\nProcess finished with exit code 1\n</code></pre>\n<p>using tensorflow on macos, built from source revision: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/88998663605ca3b728d6eec298717c8a8558639f/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/88998663605ca3b728d6eec298717c8a8558639f\"><tt>8899866</tt></a></p>", "body_text": "I'm trying to build a simple model that includes string input and lookup in a lookup table, and embedding.\nI get an error that appears to caused by using non keras layers in a keras model\nthe code:\nimport tensorflow.contrib.keras as keras\nimport tensorflow\n\ninput_layer = keras.layers.Input(shape=(1,), name='input', dtype='string')\nlut = tensorflow.contrib.lookup.HashTable(tensorflow.contrib.lookup.KeyValueTensorInitializer(['a', 'b', 'c'], [1, 2, 3]), default_value=-1)\nlut_layer = lut.lookup(input_layer)\nembed = keras.layers.Embedding(input_dim=10, output_dim=5)(lut_layer)\n\nmodel = keras.models.Model(inputs=[input_layer], outputs=[embed])\n\n\n\nthe error:\nTraceback (most recent call last):\n  File \"/Users/ophir/dev/ophir/tf_keras_2.py\", line 10, in <module>\n    model = keras.models.Model(inputs=[input_layer], outputs=[embed])\n  File \"/Users/ophir/anaconda3/envs/tf_master/lib/python3.6/site-packages/tensorflow/contrib/keras/python/keras/engine/topology.py\", line 1640, in __init__\n    build_map_of_graph(x, seen_nodes, depth=0)\n  File \"/Users/ophir/anaconda3/envs/tf_master/lib/python3.6/site-packages/tensorflow/contrib/keras/python/keras/engine/topology.py\", line 1631, in build_map_of_graph\n    next_node = layer.inbound_nodes[node_index]\nAttributeError: 'NoneType' object has no attribute 'inbound_nodes'\n\nProcess finished with exit code 1\n\nusing tensorflow on macos, built from source revision: 8899866", "body": "I'm trying to build a simple model that includes string input and lookup in a lookup table, and embedding.\r\n\r\nI get an error that appears to caused by using non keras layers in a keras model\r\n\r\nthe code:\r\n```\r\nimport tensorflow.contrib.keras as keras\r\nimport tensorflow\r\n\r\ninput_layer = keras.layers.Input(shape=(1,), name='input', dtype='string')\r\nlut = tensorflow.contrib.lookup.HashTable(tensorflow.contrib.lookup.KeyValueTensorInitializer(['a', 'b', 'c'], [1, 2, 3]), default_value=-1)\r\nlut_layer = lut.lookup(input_layer)\r\nembed = keras.layers.Embedding(input_dim=10, output_dim=5)(lut_layer)\r\n\r\nmodel = keras.models.Model(inputs=[input_layer], outputs=[embed])\r\n\r\n\r\n```\r\nthe error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/ophir/dev/ophir/tf_keras_2.py\", line 10, in <module>\r\n    model = keras.models.Model(inputs=[input_layer], outputs=[embed])\r\n  File \"/Users/ophir/anaconda3/envs/tf_master/lib/python3.6/site-packages/tensorflow/contrib/keras/python/keras/engine/topology.py\", line 1640, in __init__\r\n    build_map_of_graph(x, seen_nodes, depth=0)\r\n  File \"/Users/ophir/anaconda3/envs/tf_master/lib/python3.6/site-packages/tensorflow/contrib/keras/python/keras/engine/topology.py\", line 1631, in build_map_of_graph\r\n    next_node = layer.inbound_nodes[node_index]\r\nAttributeError: 'NoneType' object has no attribute 'inbound_nodes'\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nusing tensorflow on macos, built from source revision: 88998663605ca3b728d6eec298717c8a8558639f"}