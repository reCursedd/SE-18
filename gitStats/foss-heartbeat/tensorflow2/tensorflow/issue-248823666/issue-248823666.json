{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12117", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12117/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12117/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12117/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/12117", "id": 248823666, "node_id": "MDU6SXNzdWUyNDg4MjM2NjY=", "number": 12117, "title": "Bazel Windows Build: '//tensorflow/tools/proto_text:gen_proto_text_functions' failed to link", "user": {"login": "meteorcloudy", "id": 4171702, "node_id": "MDQ6VXNlcjQxNzE3MDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/4171702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meteorcloudy", "html_url": "https://github.com/meteorcloudy", "followers_url": "https://api.github.com/users/meteorcloudy/followers", "following_url": "https://api.github.com/users/meteorcloudy/following{/other_user}", "gists_url": "https://api.github.com/users/meteorcloudy/gists{/gist_id}", "starred_url": "https://api.github.com/users/meteorcloudy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meteorcloudy/subscriptions", "organizations_url": "https://api.github.com/users/meteorcloudy/orgs", "repos_url": "https://api.github.com/users/meteorcloudy/repos", "events_url": "https://api.github.com/users/meteorcloudy/events{/privacy}", "received_events_url": "https://api.github.com/users/meteorcloudy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-08-08T19:39:25Z", "updated_at": "2017-08-10T15:35:23Z", "closed_at": "2017-08-10T15:35:23Z", "author_association": "MEMBER", "body_html": "<p>This was first caught by Bazel CI: <a href=\"http://ci.bazel.io/blue/organizations/jenkins/TensorFlow/detail/TensorFlow/1030/pipeline\" rel=\"nofollow\">http://ci.bazel.io/blue/organizations/jenkins/TensorFlow/detail/TensorFlow/1030/pipeline</a><br>\nReported at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"248799285\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/bazelbuild/bazel/issues/3524\" data-hovercard-type=\"issue\" data-hovercard-url=\"/bazelbuild/bazel/issues/3524/hovercard\" href=\"https://github.com/bazelbuild/bazel/issues/3524\">bazelbuild/bazel#3524</a></p>\n<pre><code>  C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/amd64/link.exe /nologo /OUT:bazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe /MACHINE:X64 /SUBSYSTEM:CONSOLE @bazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe-2.params /DEFAULTLIB:libcmt.lib.\nliblib_proto_parsing.a(logging.o) : error LNK2019: unresolved external symbol \"public: unsigned __int64 __cdecl tensorflow::StringPiece::Hasher::operator()(class tensorflow::StringPiece)const \" (??RHasher@StringPiece@tensorflow@@QEBA_KV12@@Z) referenced in function \"protected: struct std::pair&lt;class std::_List_iterator&lt;class std::_List_val&lt;struct std::_List_simple_types&lt;struct std::pair&lt;class tensorflow::StringPiece const ,int&gt; &gt; &gt; &gt;,bool&gt; __cdecl std::_Hash&lt;class std::_Umap_traits&lt;class tensorflow::StringPiece,int,class std::_Uhash_compare&lt;class tensorflow::StringPiece,struct tensorflow::StringPiece::Hasher,struct std::equal_to&lt;class tensorflow::StringPiece&gt; &gt;,class std::allocator&lt;struct std::pair&lt;class tensorflow::StringPiece const ,int&gt; &gt;,0&gt; &gt;::_Insert&lt;struct std::pair&lt;class tensorflow::StringPiece const ,int&gt; &amp;,class std::_List_unchecked_iterator&lt;class std::_List_val&lt;struct std::_List_simple_types&lt;struct std::pair&lt;class tensorflow::StringPiece const ,int&gt; &gt; &gt; &gt; &gt;(struct std::pair&lt;class tensorflow::StringPiece const ,int&gt; &amp;,class std::_List_unchecked_iterator&lt;class std::_List_val&lt;struct std::_List_simple_types&lt;struct std::pair&lt;class tensorflow::StringPiece const ,int&gt; &gt; &gt; &gt;)\" (??$_Insert@AEAU?$pair@$$CBVStringPiece@tensorflow@@H@std@@V?$_List_unchecked_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@2@@?$_Hash@V?$_Umap_traits@VStringPiece@tensorflow@@HV?$_Uhash_compare@VStringPiece@tensorflow@@UHasher@12@U?$equal_to@VStringPiece@tensorflow@@@std@@@std@@V?$allocator@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@4@$0A@@std@@@std@@IEAA?AU?$pair@V?$_List_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@std@@_N@1@AEAU?$pair@$$CBVStringPiece@tensorflow@@H@1@V?$_List_unchecked_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@1@@Z)\nbazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe : fatal error LNK1120: 1 unresolved externals\nTarget //tensorflow/tools/proto_text:gen_proto_text_functions failed to build\n</code></pre>\n<p>Culprit is found by bisecting: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/072b0c9/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/072b0c9\"><tt>072b0c9</tt></a>.<br>\nThe unresolved symbol <code>tensorflow::StringPiece::Hasher::operator()</code> is implemented in <code>stringpiece.cc</code>. This change should have introduced a dependency on stringpieces.cc from logging.cc.</p>\n<p>However, <code>//tensorflow/tools/proto_text:gen_proto_text_functions</code> doesn't contain <code>stringpiece.cc</code></p>\n<pre><code>$ bazel query 'somepath(//tensorflow/tools/proto_text:gen_proto_text_functions, tensorflow/core/lib/core/stringpiece.h)'\n//tensorflow/tools/proto_text:gen_proto_text_functions\n//tensorflow/core:lib_proto_parsing\n//tensorflow/core:lib/core/stringpiece.h\n\n$ bazel query 'somepath(//tensorflow/tools/proto_text:gen_proto_text_functions, tensorflow/core/lib/core/stringpiece.cc)'\nINFO: Empty results\n</code></pre>\n<p>The strange thing is this didn't break the Linux build, one possible explanation is that there is an implementation of stringpiece.cc in protobuf, which is a dependency of <code>//tensorflow/tools/proto_text:gen_proto_text_functions</code></p>\n<pre><code>$ bazel query 'deps(//tensorflow/tools/proto_text:gen_proto_text_functions)' | grep stringpiece.cc\n@protobuf_archive//:src/google/protobuf/stubs/stringpiece.cc\n</code></pre>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7657273\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/learyg\">@learyg</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7946809\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gunan\">@gunan</a></p>", "body_text": "This was first caught by Bazel CI: http://ci.bazel.io/blue/organizations/jenkins/TensorFlow/detail/TensorFlow/1030/pipeline\nReported at bazelbuild/bazel#3524\n  C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/amd64/link.exe /nologo /OUT:bazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe /MACHINE:X64 /SUBSYSTEM:CONSOLE @bazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe-2.params /DEFAULTLIB:libcmt.lib.\nliblib_proto_parsing.a(logging.o) : error LNK2019: unresolved external symbol \"public: unsigned __int64 __cdecl tensorflow::StringPiece::Hasher::operator()(class tensorflow::StringPiece)const \" (??RHasher@StringPiece@tensorflow@@QEBA_KV12@@Z) referenced in function \"protected: struct std::pair<class std::_List_iterator<class std::_List_val<struct std::_List_simple_types<struct std::pair<class tensorflow::StringPiece const ,int> > > >,bool> __cdecl std::_Hash<class std::_Umap_traits<class tensorflow::StringPiece,int,class std::_Uhash_compare<class tensorflow::StringPiece,struct tensorflow::StringPiece::Hasher,struct std::equal_to<class tensorflow::StringPiece> >,class std::allocator<struct std::pair<class tensorflow::StringPiece const ,int> >,0> >::_Insert<struct std::pair<class tensorflow::StringPiece const ,int> &,class std::_List_unchecked_iterator<class std::_List_val<struct std::_List_simple_types<struct std::pair<class tensorflow::StringPiece const ,int> > > > >(struct std::pair<class tensorflow::StringPiece const ,int> &,class std::_List_unchecked_iterator<class std::_List_val<struct std::_List_simple_types<struct std::pair<class tensorflow::StringPiece const ,int> > > >)\" (??$_Insert@AEAU?$pair@$$CBVStringPiece@tensorflow@@H@std@@V?$_List_unchecked_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@2@@?$_Hash@V?$_Umap_traits@VStringPiece@tensorflow@@HV?$_Uhash_compare@VStringPiece@tensorflow@@UHasher@12@U?$equal_to@VStringPiece@tensorflow@@@std@@@std@@V?$allocator@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@4@$0A@@std@@@std@@IEAA?AU?$pair@V?$_List_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@std@@_N@1@AEAU?$pair@$$CBVStringPiece@tensorflow@@H@1@V?$_List_unchecked_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@1@@Z)\nbazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe : fatal error LNK1120: 1 unresolved externals\nTarget //tensorflow/tools/proto_text:gen_proto_text_functions failed to build\n\nCulprit is found by bisecting: 072b0c9.\nThe unresolved symbol tensorflow::StringPiece::Hasher::operator() is implemented in stringpiece.cc. This change should have introduced a dependency on stringpieces.cc from logging.cc.\nHowever, //tensorflow/tools/proto_text:gen_proto_text_functions doesn't contain stringpiece.cc\n$ bazel query 'somepath(//tensorflow/tools/proto_text:gen_proto_text_functions, tensorflow/core/lib/core/stringpiece.h)'\n//tensorflow/tools/proto_text:gen_proto_text_functions\n//tensorflow/core:lib_proto_parsing\n//tensorflow/core:lib/core/stringpiece.h\n\n$ bazel query 'somepath(//tensorflow/tools/proto_text:gen_proto_text_functions, tensorflow/core/lib/core/stringpiece.cc)'\nINFO: Empty results\n\nThe strange thing is this didn't break the Linux build, one possible explanation is that there is an implementation of stringpiece.cc in protobuf, which is a dependency of //tensorflow/tools/proto_text:gen_proto_text_functions\n$ bazel query 'deps(//tensorflow/tools/proto_text:gen_proto_text_functions)' | grep stringpiece.cc\n@protobuf_archive//:src/google/protobuf/stubs/stringpiece.cc\n\n@learyg @gunan", "body": "This was first caught by Bazel CI: http://ci.bazel.io/blue/organizations/jenkins/TensorFlow/detail/TensorFlow/1030/pipeline\r\nReported at https://github.com/bazelbuild/bazel/issues/3524\r\n```\r\n  C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/bin/amd64/link.exe /nologo /OUT:bazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe /MACHINE:X64 /SUBSYSTEM:CONSOLE @bazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe-2.params /DEFAULTLIB:libcmt.lib.\r\nliblib_proto_parsing.a(logging.o) : error LNK2019: unresolved external symbol \"public: unsigned __int64 __cdecl tensorflow::StringPiece::Hasher::operator()(class tensorflow::StringPiece)const \" (??RHasher@StringPiece@tensorflow@@QEBA_KV12@@Z) referenced in function \"protected: struct std::pair<class std::_List_iterator<class std::_List_val<struct std::_List_simple_types<struct std::pair<class tensorflow::StringPiece const ,int> > > >,bool> __cdecl std::_Hash<class std::_Umap_traits<class tensorflow::StringPiece,int,class std::_Uhash_compare<class tensorflow::StringPiece,struct tensorflow::StringPiece::Hasher,struct std::equal_to<class tensorflow::StringPiece> >,class std::allocator<struct std::pair<class tensorflow::StringPiece const ,int> >,0> >::_Insert<struct std::pair<class tensorflow::StringPiece const ,int> &,class std::_List_unchecked_iterator<class std::_List_val<struct std::_List_simple_types<struct std::pair<class tensorflow::StringPiece const ,int> > > > >(struct std::pair<class tensorflow::StringPiece const ,int> &,class std::_List_unchecked_iterator<class std::_List_val<struct std::_List_simple_types<struct std::pair<class tensorflow::StringPiece const ,int> > > >)\" (??$_Insert@AEAU?$pair@$$CBVStringPiece@tensorflow@@H@std@@V?$_List_unchecked_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@2@@?$_Hash@V?$_Umap_traits@VStringPiece@tensorflow@@HV?$_Uhash_compare@VStringPiece@tensorflow@@UHasher@12@U?$equal_to@VStringPiece@tensorflow@@@std@@@std@@V?$allocator@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@4@$0A@@std@@@std@@IEAA?AU?$pair@V?$_List_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@std@@_N@1@AEAU?$pair@$$CBVStringPiece@tensorflow@@H@1@V?$_List_unchecked_iterator@V?$_List_val@U?$_List_simple_types@U?$pair@$$CBVStringPiece@tensorflow@@H@std@@@std@@@std@@@1@@Z)\r\nbazel-out/msvc_x64-py3-opt/bin/tensorflow/tools/proto_text/gen_proto_text_functions.exe : fatal error LNK1120: 1 unresolved externals\r\nTarget //tensorflow/tools/proto_text:gen_proto_text_functions failed to build\r\n```\r\n\r\nCulprit is found by bisecting: tensorflow/tensorflow@072b0c9.\r\nThe unresolved symbol `tensorflow::StringPiece::Hasher::operator()` is implemented in `stringpiece.cc`. This change should have introduced a dependency on stringpieces.cc from logging.cc.\r\n\r\nHowever, `//tensorflow/tools/proto_text:gen_proto_text_functions` doesn't contain `stringpiece.cc`\r\n```\r\n$ bazel query 'somepath(//tensorflow/tools/proto_text:gen_proto_text_functions, tensorflow/core/lib/core/stringpiece.h)'\r\n//tensorflow/tools/proto_text:gen_proto_text_functions\r\n//tensorflow/core:lib_proto_parsing\r\n//tensorflow/core:lib/core/stringpiece.h\r\n\r\n$ bazel query 'somepath(//tensorflow/tools/proto_text:gen_proto_text_functions, tensorflow/core/lib/core/stringpiece.cc)'\r\nINFO: Empty results\r\n```\r\n\r\nThe strange thing is this didn't break the Linux build, one possible explanation is that there is an implementation of stringpiece.cc in protobuf, which is a dependency of `//tensorflow/tools/proto_text:gen_proto_text_functions`\r\n```\r\n$ bazel query 'deps(//tensorflow/tools/proto_text:gen_proto_text_functions)' | grep stringpiece.cc\r\n@protobuf_archive//:src/google/protobuf/stubs/stringpiece.cc\r\n```\r\n@learyg @gunan \r\n\r\n"}