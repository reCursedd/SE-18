{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23427", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23427/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23427/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23427/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23427", "id": 376362545, "node_id": "MDU6SXNzdWUzNzYzNjI1NDU=", "number": 23427, "title": "Build failing with ` ERROR: Config value cuda is not defined in any .rc file`", "user": {"login": "AgrawalAmey", "id": 15227113, "node_id": "MDQ6VXNlcjE1MjI3MTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15227113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AgrawalAmey", "html_url": "https://github.com/AgrawalAmey", "followers_url": "https://api.github.com/users/AgrawalAmey/followers", "following_url": "https://api.github.com/users/AgrawalAmey/following{/other_user}", "gists_url": "https://api.github.com/users/AgrawalAmey/gists{/gist_id}", "starred_url": "https://api.github.com/users/AgrawalAmey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AgrawalAmey/subscriptions", "organizations_url": "https://api.github.com/users/AgrawalAmey/orgs", "repos_url": "https://api.github.com/users/AgrawalAmey/repos", "events_url": "https://api.github.com/users/AgrawalAmey/events{/privacy}", "received_events_url": "https://api.github.com/users/AgrawalAmey/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-01T11:55:49Z", "updated_at": "2018-11-01T14:47:31Z", "closed_at": "2018-11-01T14:47:31Z", "author_association": "NONE", "body_html": "<p>I build TF on a biweekly basis, the last successful build was done 3 days ago (29th Oct), but the build job is failing today, while there has been no changes in the installation script.</p>\n<p>The build happens on an amazon linux machine with cuda 9.0 and cudnn 7.3, using the following command,</p>\n<pre><code>bazel build --config=opt --config=mk1 --config=cuda --copt=-mavx --copt=-msse4.2 --copt=-msse4.1 //tensorflow/tools/pip_package:build_pip_package\n</code></pre>\n<p>Some of the ralevent flags are set as follows,</p>\n<pre><code>export TF_NEED_CUDA=1\nexport TF_CUDA_VERSION=\"$(nvcc --version | sed -n 's/^.*release \\(.*\\),.*/\\1/p')\"\n    export TF_CUDNN_VERSION=\"$(sed -n 's/^#define CUDNN_MAJOR\\s*\\(.*\\).*/\\1/p' $CUDNN_INSTALL_PATH/include/cudnn.h)\"\n</code></pre>\n<p>The job failes with the following error message,</p>\n<pre><code>+ bazel build --config=opt --config=cuda --copt=-mavx --copt=-msse4.2 --copt=-msse4.1 //tensorflow/tools/pip_package:build_pip_package\nWARNING: The following rc files are no longer being read, please transfer their contents or import their path into one of the standard rc files:\n/home/ec2-user/workspace/build-dl-package/src/deep-learning/tensorflow/tensorflow/tools/bazel.rc\nExtracting Bazel installation...\nStarting local Bazel server and connecting to it...\nINFO: Options provided by the client:\n  Inherited 'common' options: --isatty=0 --terminal_columns=80\nINFO: Reading rc options for 'build' from /home/ec2-user/workspace/build-dl-package/src/deep-learning/tensorflow/tensorflow/.tf_configure.bazelrc:\n  'build' options: --action_env PYTHON_BIN_PATH=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu//bin/python --action_env PYTHON_LIB_PATH=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu/lib/python2.7/site-packages --python_path=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu//bin/python --define with_jemalloc=true --define with_hdfs_support=true --define with_aws_support=true --define with_kafka_support=true --action_env TF_NEED_OPENCL_SYCL=0 --action_env TF_NEED_CUDA=1 --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda --action_env TF_CUDA_VERSION=9.0 --action_env CUDNN_INSTALL_PATH=/usr/local/cuda-9.0 --action_env TF_CUDNN_VERSION=7 --action_env NCCL_INSTALL_PATH=/usr/local/nccl --action_env TF_NCCL_VERSION=2 --action_env TF_CUDA_COMPUTE_CAPABILITIES=3.0,3.5,5.2 --action_env LD_LIBRARY_PATH=/usr/java/jdk1.7.0_67/jre/lib/amd64/server:/usr/java/jdk1.7.0_67/jre/lib/amd64:/usr/java/jdk1.7.0_67/jre/../lib/amd64:/usr/lib/hadoop2.6/lib/native/:/usr/local/cuda-8.0/lib64:/usr/java/jdk1.8.0_121//jre/lib/amd64/server:/usr/lib/torch/install/lib:/usr/local/mpi/lib: --action_env TF_CUDA_CLANG=0 --action_env GCC_HOST_COMPILER_PATH=/usr/bin/gcc --config=cuda --define with_mpi_support=true --define grpc_no_ares=true\nERROR: Config value cuda is not defined in any .rc file\n</code></pre>\n<p>The build is run against <code>r1.11</code> along with commit <code>89979f42e827d9eb5c349259a5aa2ec32d38c86a</code> cherry-picked.</p>\n<p>Should I change something?<br>\nThank you.</p>", "body_text": "I build TF on a biweekly basis, the last successful build was done 3 days ago (29th Oct), but the build job is failing today, while there has been no changes in the installation script.\nThe build happens on an amazon linux machine with cuda 9.0 and cudnn 7.3, using the following command,\nbazel build --config=opt --config=mk1 --config=cuda --copt=-mavx --copt=-msse4.2 --copt=-msse4.1 //tensorflow/tools/pip_package:build_pip_package\n\nSome of the ralevent flags are set as follows,\nexport TF_NEED_CUDA=1\nexport TF_CUDA_VERSION=\"$(nvcc --version | sed -n 's/^.*release \\(.*\\),.*/\\1/p')\"\n    export TF_CUDNN_VERSION=\"$(sed -n 's/^#define CUDNN_MAJOR\\s*\\(.*\\).*/\\1/p' $CUDNN_INSTALL_PATH/include/cudnn.h)\"\n\nThe job failes with the following error message,\n+ bazel build --config=opt --config=cuda --copt=-mavx --copt=-msse4.2 --copt=-msse4.1 //tensorflow/tools/pip_package:build_pip_package\nWARNING: The following rc files are no longer being read, please transfer their contents or import their path into one of the standard rc files:\n/home/ec2-user/workspace/build-dl-package/src/deep-learning/tensorflow/tensorflow/tools/bazel.rc\nExtracting Bazel installation...\nStarting local Bazel server and connecting to it...\nINFO: Options provided by the client:\n  Inherited 'common' options: --isatty=0 --terminal_columns=80\nINFO: Reading rc options for 'build' from /home/ec2-user/workspace/build-dl-package/src/deep-learning/tensorflow/tensorflow/.tf_configure.bazelrc:\n  'build' options: --action_env PYTHON_BIN_PATH=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu//bin/python --action_env PYTHON_LIB_PATH=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu/lib/python2.7/site-packages --python_path=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu//bin/python --define with_jemalloc=true --define with_hdfs_support=true --define with_aws_support=true --define with_kafka_support=true --action_env TF_NEED_OPENCL_SYCL=0 --action_env TF_NEED_CUDA=1 --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda --action_env TF_CUDA_VERSION=9.0 --action_env CUDNN_INSTALL_PATH=/usr/local/cuda-9.0 --action_env TF_CUDNN_VERSION=7 --action_env NCCL_INSTALL_PATH=/usr/local/nccl --action_env TF_NCCL_VERSION=2 --action_env TF_CUDA_COMPUTE_CAPABILITIES=3.0,3.5,5.2 --action_env LD_LIBRARY_PATH=/usr/java/jdk1.7.0_67/jre/lib/amd64/server:/usr/java/jdk1.7.0_67/jre/lib/amd64:/usr/java/jdk1.7.0_67/jre/../lib/amd64:/usr/lib/hadoop2.6/lib/native/:/usr/local/cuda-8.0/lib64:/usr/java/jdk1.8.0_121//jre/lib/amd64/server:/usr/lib/torch/install/lib:/usr/local/mpi/lib: --action_env TF_CUDA_CLANG=0 --action_env GCC_HOST_COMPILER_PATH=/usr/bin/gcc --config=cuda --define with_mpi_support=true --define grpc_no_ares=true\nERROR: Config value cuda is not defined in any .rc file\n\nThe build is run against r1.11 along with commit 89979f42e827d9eb5c349259a5aa2ec32d38c86a cherry-picked.\nShould I change something?\nThank you.", "body": "I build TF on a biweekly basis, the last successful build was done 3 days ago (29th Oct), but the build job is failing today, while there has been no changes in the installation script.\r\n\r\nThe build happens on an amazon linux machine with cuda 9.0 and cudnn 7.3, using the following command, \r\n\r\n```\r\nbazel build --config=opt --config=mk1 --config=cuda --copt=-mavx --copt=-msse4.2 --copt=-msse4.1 //tensorflow/tools/pip_package:build_pip_package\r\n```\r\nSome of the ralevent flags are set as follows,\r\n```\r\nexport TF_NEED_CUDA=1\r\nexport TF_CUDA_VERSION=\"$(nvcc --version | sed -n 's/^.*release \\(.*\\),.*/\\1/p')\"\r\n    export TF_CUDNN_VERSION=\"$(sed -n 's/^#define CUDNN_MAJOR\\s*\\(.*\\).*/\\1/p' $CUDNN_INSTALL_PATH/include/cudnn.h)\"\r\n```\r\nThe job failes with the following error message,\r\n```\r\n+ bazel build --config=opt --config=cuda --copt=-mavx --copt=-msse4.2 --copt=-msse4.1 //tensorflow/tools/pip_package:build_pip_package\r\nWARNING: The following rc files are no longer being read, please transfer their contents or import their path into one of the standard rc files:\r\n/home/ec2-user/workspace/build-dl-package/src/deep-learning/tensorflow/tensorflow/tools/bazel.rc\r\nExtracting Bazel installation...\r\nStarting local Bazel server and connecting to it...\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=0 --terminal_columns=80\r\nINFO: Reading rc options for 'build' from /home/ec2-user/workspace/build-dl-package/src/deep-learning/tensorflow/tensorflow/.tf_configure.bazelrc:\r\n  'build' options: --action_env PYTHON_BIN_PATH=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu//bin/python --action_env PYTHON_LIB_PATH=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu/lib/python2.7/site-packages --python_path=/usr/lib/a-4.2.9-py-2.7.13-dl-gpu//bin/python --define with_jemalloc=true --define with_hdfs_support=true --define with_aws_support=true --define with_kafka_support=true --action_env TF_NEED_OPENCL_SYCL=0 --action_env TF_NEED_CUDA=1 --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda --action_env TF_CUDA_VERSION=9.0 --action_env CUDNN_INSTALL_PATH=/usr/local/cuda-9.0 --action_env TF_CUDNN_VERSION=7 --action_env NCCL_INSTALL_PATH=/usr/local/nccl --action_env TF_NCCL_VERSION=2 --action_env TF_CUDA_COMPUTE_CAPABILITIES=3.0,3.5,5.2 --action_env LD_LIBRARY_PATH=/usr/java/jdk1.7.0_67/jre/lib/amd64/server:/usr/java/jdk1.7.0_67/jre/lib/amd64:/usr/java/jdk1.7.0_67/jre/../lib/amd64:/usr/lib/hadoop2.6/lib/native/:/usr/local/cuda-8.0/lib64:/usr/java/jdk1.8.0_121//jre/lib/amd64/server:/usr/lib/torch/install/lib:/usr/local/mpi/lib: --action_env TF_CUDA_CLANG=0 --action_env GCC_HOST_COMPILER_PATH=/usr/bin/gcc --config=cuda --define with_mpi_support=true --define grpc_no_ares=true\r\nERROR: Config value cuda is not defined in any .rc file\r\n````\r\nThe build is run against `r1.11` along with commit `89979f42e827d9eb5c349259a5aa2ec32d38c86a` cherry-picked.\r\n\r\nShould I change something?\r\nThank you."}