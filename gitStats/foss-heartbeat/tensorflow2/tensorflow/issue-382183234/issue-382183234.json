{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23852", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23852/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23852/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23852/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23852", "id": 382183234, "node_id": "MDU6SXNzdWUzODIxODMyMzQ=", "number": 23852, "title": "reduce_max returns wrong shape", "user": {"login": "comeonfox", "id": 1546064, "node_id": "MDQ6VXNlcjE1NDYwNjQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1546064?v=4", "gravatar_id": "", "url": "https://api.github.com/users/comeonfox", "html_url": "https://github.com/comeonfox", "followers_url": "https://api.github.com/users/comeonfox/followers", "following_url": "https://api.github.com/users/comeonfox/following{/other_user}", "gists_url": "https://api.github.com/users/comeonfox/gists{/gist_id}", "starred_url": "https://api.github.com/users/comeonfox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/comeonfox/subscriptions", "organizations_url": "https://api.github.com/users/comeonfox/orgs", "repos_url": "https://api.github.com/users/comeonfox/repos", "events_url": "https://api.github.com/users/comeonfox/events{/privacy}", "received_events_url": "https://api.github.com/users/comeonfox/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-11-19T12:00:17Z", "updated_at": "2018-11-19T12:00:17Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><strong>Problem</strong><br>\n<strong>tf.reduce_max returns tensor with wrong shape</strong></p>\n<pre><code>...\nleft_expr = tf.reduce_sum(left_encs, axis=1)\nleft_expr = tf.Print(left_expr,  [tf.shape(left_encs), tf.shape(left_expr)], message=\"Shapes Are: \")\n...\n</code></pre>\n<p>and the output is:</p>\n<pre><code>Shapes Are: [46 21 512][1 512]\n</code></pre>\n<p>the tensor <code>left_encs</code> is the output of transformer encoder, the meaning of the shape is [batch_size, sequence_length, hidden_dim]</p>\n<p>I have tried to construct a random tensor with same shape as <code>left_encs</code> and the call <code>tf.reduce_sum(left_encs, axis=1)</code> and the output is as expected <code>[46, 512]</code>.</p>\n<p>but I cannot get it right from the real code.</p>\n<p>is there any operation should I do before calling <code>tf.reduce_sum</code>?</p>\n<p><strong>System information</strong></p>\n<ul>\n<li>TensorFlow installed from: Anaconda</li>\n<li>TensorFlow version: v1.11</li>\n<li>Python version: 3.6</li>\n<li>CUDA/cuDNN version: v9.0</li>\n<li>GPU model and memory: Tesla K40</li>\n</ul>", "body_text": "Problem\ntf.reduce_max returns tensor with wrong shape\n...\nleft_expr = tf.reduce_sum(left_encs, axis=1)\nleft_expr = tf.Print(left_expr,  [tf.shape(left_encs), tf.shape(left_expr)], message=\"Shapes Are: \")\n...\n\nand the output is:\nShapes Are: [46 21 512][1 512]\n\nthe tensor left_encs is the output of transformer encoder, the meaning of the shape is [batch_size, sequence_length, hidden_dim]\nI have tried to construct a random tensor with same shape as left_encs and the call tf.reduce_sum(left_encs, axis=1) and the output is as expected [46, 512].\nbut I cannot get it right from the real code.\nis there any operation should I do before calling tf.reduce_sum?\nSystem information\n\nTensorFlow installed from: Anaconda\nTensorFlow version: v1.11\nPython version: 3.6\nCUDA/cuDNN version: v9.0\nGPU model and memory: Tesla K40", "body": "**Problem**\r\n**tf.reduce_max returns tensor with wrong shape**\r\n\r\n    ...\r\n    left_expr = tf.reduce_sum(left_encs, axis=1)\r\n    left_expr = tf.Print(left_expr,  [tf.shape(left_encs), tf.shape(left_expr)], message=\"Shapes Are: \")\r\n    ...\r\n\r\nand the output is:\r\n\r\n    Shapes Are: [46 21 512][1 512]\r\n\r\nthe tensor `left_encs` is the output of transformer encoder, the meaning of the shape is [batch_size, sequence_length, hidden_dim]\r\n\r\nI have tried to construct a random tensor with same shape as `left_encs` and the call `tf.reduce_sum(left_encs, axis=1)` and the output is as expected `[46, 512]`.\r\n\r\nbut I cannot get it right from the real code.\r\n\r\nis there any operation should I do before calling `tf.reduce_sum`?\r\n\r\n**System information**\r\n- TensorFlow installed from: Anaconda\r\n- TensorFlow version: v1.11\r\n- Python version: 3.6\r\n- CUDA/cuDNN version: v9.0\r\n- GPU model and memory: Tesla K40\r\n\r\n"}