{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/145562331", "pull_request_review_id": 70381011, "id": 145562331, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0NTU2MjMzMQ==", "diff_hunk": "@@ -79,23 +80,43 @@ RUN git clone https://github.com/tensorflow/tensorflow.git && \\\n     git checkout ${TF_BRANCH}\n WORKDIR /tensorflow\n \n-# Configure the build for our CUDA configuration.\n-ENV CI_BUILD_PYTHON python\n-ENV LD_LIBRARY_PATH /usr/local/cuda/extras/CUPTI/lib64:$LD_LIBRARY_PATH\n-ENV TF_NEED_CUDA 1\n-ENV TF_CUDA_COMPUTE_CAPABILITIES 3.0,3.5,5.2,6.0,6.1\n-ENV TF_CUDA_VERSION 9.0\n-ENV TF_CUDNN_VERSION 7\n-RUN ./configure\n-\n-RUN LD_LIBRARY_PATH=/usr/local/cuda/lib64/stubs:${LD_LIBRARY_PATH} \\\n-    bazel build -c opt --config=cuda --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" \\\n-        --jobs=${TF_AVAILABLE_CPUS} \\\n-        tensorflow/tools/pip_package:build_pip_package && \\\n-    mkdir -p /pip_pkg && \\\n+# Tell TensorFlow how to configure the build, in detail.\n+ENV CI_BUILD_PYTHON=python \\\n+    LD_LIBRARY_PATH=/usr/local/cuda/extras/CUPTI/lib64:${LD_LIBRARY_PATH} \\\n+    CUDNN_INSTALL_PATH=/usr/lib/x86_64-linux-gnu \\\n+    PYTHON_BIN_PATH=/usr/bin/python \\\n+    PYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \\\n+    TF_NEED_CUDA=1 \\\n+    TF_CUDA_VERSION=9.0 \\\n+    TF_CUDA_COMPUTE_CAPABILITIES=3.0,3.5,5.2,6.0,6.1,7.0 \\\n+    TF_CUDNN_VERSION=7 \\\n+    TF_NEED_JEMALLOC=1 \\\n+    TF_NEED_GCP=0 \\\n+    TF_NEED_HDFS=0 \\\n+    TF_ENABLE_XLA=1 \\\n+    TF_NEED_GDR=0 \\\n+    TF_NEED_VERBS=0 \\\n+    TF_NEED_OPENCL=0 \\\n+    TF_NEED_S3=0 \\\n+    TF_CUDA_CLANG=0 \\\n+    TF_NEED_MPI=0\n+\n+# Configure, Build and Install TensorFlow.\n+RUN ln -s /usr/local/cuda/lib64/stubs/libcuda.so /usr/local/cuda/lib64/stubs/libcuda.so.1 && \\", "path": "tensorflow/tools/docker/Dockerfile.devel-gpu-cuda9-cudnn7", "position": null, "original_position": 57, "commit_id": "aee0663e87c7121b7e447a30f8b9ca83f79f15f2", "original_commit_id": "2db15724069d9b484c07bad2fe4a678a28988836", "user": {"login": "chi-hung", "id": 14253807, "node_id": "MDQ6VXNlcjE0MjUzODA3", "avatar_url": "https://avatars3.githubusercontent.com/u/14253807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chi-hung", "html_url": "https://github.com/chi-hung", "followers_url": "https://api.github.com/users/chi-hung/followers", "following_url": "https://api.github.com/users/chi-hung/following{/other_user}", "gists_url": "https://api.github.com/users/chi-hung/gists{/gist_id}", "starred_url": "https://api.github.com/users/chi-hung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chi-hung/subscriptions", "organizations_url": "https://api.github.com/users/chi-hung/orgs", "repos_url": "https://api.github.com/users/chi-hung/repos", "events_url": "https://api.github.com/users/chi-hung/events{/privacy}", "received_events_url": "https://api.github.com/users/chi-hung/received_events", "type": "User", "site_admin": false}, "body": "I am not sure where the ```libcuda.so.1``` link is, as you can see:\r\n```\r\nchweng@honghuTX:/dev/shm/tmp$ nvidia-docker build -t 'test' .\r\nSending build context to Docker daemon  221.4MB\r\nStep 1/3 : FROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\r\n ---> 86c4dcdd14b5\r\nStep 2/3 : RUN ls -hl  /usr/local/cuda/lib64/stubs/libcuda*\r\n ---> Running in 7234e9e1d37b\r\n-rw-r--r-- 1 root root 42K Sep  2 10:39 /usr/local/cuda/lib64/stubs/libcuda.so\r\n ---> ba363cc03ba6\r\nRemoving intermediate container 7234e9e1d37b\r\nStep 3/3 : RUN ls -hl  /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/libcuda*\r\n ---> Running in 9d99b95ea77b\r\n-rw-r--r-- 1 root root 42K Sep  2 10:39 /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/libcuda.so\r\n ---> e073112d01a3\r\nRemoving intermediate container 9d99b95ea77b\r\nSuccessfully built e073112d01a3\r\nSuccessfully tagged test:latest\r\n```\r\nThat is to say, you can find ```libcuda.so``` in  ```/usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/``` or ```/usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/```, but I don't know where to look for the ```libcuda.so.1``` link.", "created_at": "2017-10-18T22:41:50Z", "updated_at": "2017-10-19T15:19:26Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/13811#discussion_r145562331", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13811", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/145562331"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/13811#discussion_r145562331"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/13811"}}, "body_html": "<p>I am not sure where the <code>libcuda.so.1</code> link is, as you can see:</p>\n<pre><code>chweng@honghuTX:/dev/shm/tmp$ nvidia-docker build -t 'test' .\nSending build context to Docker daemon  221.4MB\nStep 1/3 : FROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\n ---&gt; 86c4dcdd14b5\nStep 2/3 : RUN ls -hl  /usr/local/cuda/lib64/stubs/libcuda*\n ---&gt; Running in 7234e9e1d37b\n-rw-r--r-- 1 root root 42K Sep  2 10:39 /usr/local/cuda/lib64/stubs/libcuda.so\n ---&gt; ba363cc03ba6\nRemoving intermediate container 7234e9e1d37b\nStep 3/3 : RUN ls -hl  /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/libcuda*\n ---&gt; Running in 9d99b95ea77b\n-rw-r--r-- 1 root root 42K Sep  2 10:39 /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/libcuda.so\n ---&gt; e073112d01a3\nRemoving intermediate container 9d99b95ea77b\nSuccessfully built e073112d01a3\nSuccessfully tagged test:latest\n</code></pre>\n<p>That is to say, you can find <code>libcuda.so</code> in  <code>/usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/</code> or <code>/usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/</code>, but I don't know where to look for the <code>libcuda.so.1</code> link.</p>", "body_text": "I am not sure where the libcuda.so.1 link is, as you can see:\nchweng@honghuTX:/dev/shm/tmp$ nvidia-docker build -t 'test' .\nSending build context to Docker daemon  221.4MB\nStep 1/3 : FROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\n ---> 86c4dcdd14b5\nStep 2/3 : RUN ls -hl  /usr/local/cuda/lib64/stubs/libcuda*\n ---> Running in 7234e9e1d37b\n-rw-r--r-- 1 root root 42K Sep  2 10:39 /usr/local/cuda/lib64/stubs/libcuda.so\n ---> ba363cc03ba6\nRemoving intermediate container 7234e9e1d37b\nStep 3/3 : RUN ls -hl  /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/libcuda*\n ---> Running in 9d99b95ea77b\n-rw-r--r-- 1 root root 42K Sep  2 10:39 /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/libcuda.so\n ---> e073112d01a3\nRemoving intermediate container 9d99b95ea77b\nSuccessfully built e073112d01a3\nSuccessfully tagged test:latest\n\nThat is to say, you can find libcuda.so in  /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/ or /usr/local/cuda-9.0/targets/x86_64-linux/lib/stubs/, but I don't know where to look for the libcuda.so.1 link.", "in_reply_to_id": 145529156}