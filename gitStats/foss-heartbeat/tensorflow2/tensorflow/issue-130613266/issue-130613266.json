{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/961", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/961/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/961/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/961/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/961", "id": 130613266, "node_id": "MDU6SXNzdWUxMzA2MTMyNjY=", "number": 961, "title": "Failed to build pip package for Python 3: `PyString_FromStringAndSize` not declared", "user": {"login": "gaohuazuo", "id": 10446514, "node_id": "MDQ6VXNlcjEwNDQ2NTE0", "avatar_url": "https://avatars0.githubusercontent.com/u/10446514?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gaohuazuo", "html_url": "https://github.com/gaohuazuo", "followers_url": "https://api.github.com/users/gaohuazuo/followers", "following_url": "https://api.github.com/users/gaohuazuo/following{/other_user}", "gists_url": "https://api.github.com/users/gaohuazuo/gists{/gist_id}", "starred_url": "https://api.github.com/users/gaohuazuo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gaohuazuo/subscriptions", "organizations_url": "https://api.github.com/users/gaohuazuo/orgs", "repos_url": "https://api.github.com/users/gaohuazuo/repos", "events_url": "https://api.github.com/users/gaohuazuo/events{/privacy}", "received_events_url": "https://api.github.com/users/gaohuazuo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-02-02T08:39:42Z", "updated_at": "2016-02-02T16:54:59Z", "closed_at": "2016-02-02T16:54:59Z", "author_association": "CONTRIBUTOR", "body_html": "<p>I was building pip package for Python 3.5. bazel reported an error during</p>\n<pre><code>bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package --verbose_failures\n</code></pre>\n<p>The failing command was:</p>\n<pre><code>cd /home/z/.cache/bazel/_bazel_z/4c5a3f7b23103a2fe3f8cd834eaf9376/tensorflow &amp;&amp; \\\nexec env - \\\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games \\\nthird_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc \\\n(lots of flags here)\n-c bazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc \\\n-o bazel-out/local_linux-py3-opt/bin/tensorflow/python/_objs/_pywrap_tensorflow.so/tensorflow/python/pywrap_tensorflow.pic.o\n</code></pre>\n<p>The error was:</p>\n<pre><code>bazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc: In function 'PyObject* _wrap_TF_PRunSetup(PyObject*, PyObject*)':\nbazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc:4974:66: error: 'PyString_FromStringAndSize' was not declared in this scope\n       resultobj = PyString_FromStringAndSize(*arg6, strlen(*arg6));\n                                                                  ^\n</code></pre>\n<p>It seemed to be a Python 2/3 compatibility issue, since <code>PyString_FromStringAndSize</code> is no longer provided by Python 3 headers.</p>\n<p><code>pywrap_tensorflow.cc</code> reads like:</p>\n<pre><code>  resultobj = SWIG_Py_Void();\n  {\n    if (!arg5-&gt;ok()) {\n      RaiseStatusNotOK(*arg5, SWIGTYPE_p_tensorflow__Status);\n      SWIG_fail;\n    } else {\n      resultobj = PyString_FromStringAndSize(*arg6, strlen(*arg6));\n      delete *arg6;\n    }\n  }\n  return resultobj;\n</code></pre>\n<p>I'm not sure whether it was caused by tensorflow or my configuration, but I did find some suspicious code in <code>tensorflow/python/client/tf_session.i</code>, that closely resembles the problematic code:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/97f585d506cccc57dc98f234f4d5fcd824dd3c03/tensorflow/python/client/tf_session.i#L211\">tensorflow/tensorflow/python/client/tf_session.i</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 211\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/97f585d506cccc57dc98f234f4d5fcd824dd3c03\">97f585d</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L211\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"211\"></td>\n          <td id=\"LC211\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> $result = PyString_FromStringAndSize(*$2, strlen(*$2)); </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>", "body_text": "I was building pip package for Python 3.5. bazel reported an error during\nbazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package --verbose_failures\n\nThe failing command was:\ncd /home/z/.cache/bazel/_bazel_z/4c5a3f7b23103a2fe3f8cd834eaf9376/tensorflow && \\\nexec env - \\\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games \\\nthird_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc \\\n(lots of flags here)\n-c bazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc \\\n-o bazel-out/local_linux-py3-opt/bin/tensorflow/python/_objs/_pywrap_tensorflow.so/tensorflow/python/pywrap_tensorflow.pic.o\n\nThe error was:\nbazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc: In function 'PyObject* _wrap_TF_PRunSetup(PyObject*, PyObject*)':\nbazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc:4974:66: error: 'PyString_FromStringAndSize' was not declared in this scope\n       resultobj = PyString_FromStringAndSize(*arg6, strlen(*arg6));\n                                                                  ^\n\nIt seemed to be a Python 2/3 compatibility issue, since PyString_FromStringAndSize is no longer provided by Python 3 headers.\npywrap_tensorflow.cc reads like:\n  resultobj = SWIG_Py_Void();\n  {\n    if (!arg5->ok()) {\n      RaiseStatusNotOK(*arg5, SWIGTYPE_p_tensorflow__Status);\n      SWIG_fail;\n    } else {\n      resultobj = PyString_FromStringAndSize(*arg6, strlen(*arg6));\n      delete *arg6;\n    }\n  }\n  return resultobj;\n\nI'm not sure whether it was caused by tensorflow or my configuration, but I did find some suspicious code in tensorflow/python/client/tf_session.i, that closely resembles the problematic code:\n\n  \n    \n      tensorflow/tensorflow/python/client/tf_session.i\n    \n    \n         Line 211\n      in\n      97f585d\n    \n    \n    \n    \n\n        \n          \n           $result = PyString_FromStringAndSize(*$2, strlen(*$2));", "body": "I was building pip package for Python 3.5. bazel reported an error during \n\n```\nbazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package --verbose_failures\n```\n\nThe failing command was:\n\n```\ncd /home/z/.cache/bazel/_bazel_z/4c5a3f7b23103a2fe3f8cd834eaf9376/tensorflow && \\\nexec env - \\\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games \\\nthird_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc \\\n(lots of flags here)\n-c bazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc \\\n-o bazel-out/local_linux-py3-opt/bin/tensorflow/python/_objs/_pywrap_tensorflow.so/tensorflow/python/pywrap_tensorflow.pic.o\n```\n\nThe error was:\n\n```\nbazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc: In function 'PyObject* _wrap_TF_PRunSetup(PyObject*, PyObject*)':\nbazel-out/local_linux-py3-opt/bin/tensorflow/python/pywrap_tensorflow.cc:4974:66: error: 'PyString_FromStringAndSize' was not declared in this scope\n       resultobj = PyString_FromStringAndSize(*arg6, strlen(*arg6));\n                                                                  ^\n```\n\nIt seemed to be a Python 2/3 compatibility issue, since `PyString_FromStringAndSize` is no longer provided by Python 3 headers.\n\n`pywrap_tensorflow.cc` reads like:\n\n```\n  resultobj = SWIG_Py_Void();\n  {\n    if (!arg5->ok()) {\n      RaiseStatusNotOK(*arg5, SWIGTYPE_p_tensorflow__Status);\n      SWIG_fail;\n    } else {\n      resultobj = PyString_FromStringAndSize(*arg6, strlen(*arg6));\n      delete *arg6;\n    }\n  }\n  return resultobj;\n```\n\nI'm not sure whether it was caused by tensorflow or my configuration, but I did find some suspicious code in `tensorflow/python/client/tf_session.i`, that closely resembles the problematic code:\nhttps://github.com/tensorflow/tensorflow/blob/97f585d506cccc57dc98f234f4d5fcd824dd3c03/tensorflow/python/client/tf_session.i#L211\n"}