{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/397903035", "html_url": "https://github.com/tensorflow/tensorflow/issues/4588#issuecomment-397903035", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4588", "id": 397903035, "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzkwMzAzNQ==", "user": {"login": "ikrambennasrbennasr", "id": 36957166, "node_id": "MDQ6VXNlcjM2OTU3MTY2", "avatar_url": "https://avatars2.githubusercontent.com/u/36957166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ikrambennasrbennasr", "html_url": "https://github.com/ikrambennasrbennasr", "followers_url": "https://api.github.com/users/ikrambennasrbennasr/followers", "following_url": "https://api.github.com/users/ikrambennasrbennasr/following{/other_user}", "gists_url": "https://api.github.com/users/ikrambennasrbennasr/gists{/gist_id}", "starred_url": "https://api.github.com/users/ikrambennasrbennasr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ikrambennasrbennasr/subscriptions", "organizations_url": "https://api.github.com/users/ikrambennasrbennasr/orgs", "repos_url": "https://api.github.com/users/ikrambennasrbennasr/repos", "events_url": "https://api.github.com/users/ikrambennasrbennasr/events{/privacy}", "received_events_url": "https://api.github.com/users/ikrambennasrbennasr/received_events", "type": "User", "site_admin": false}, "created_at": "2018-06-17T20:07:50Z", "updated_at": "2018-06-17T20:08:12Z", "author_association": "NONE", "body_html": "<p>hello, please i run this code :</p>\n<p>from sparkdl import DeepImagePredictor<br>\nimage_df = ImageSchema.readImages(\"flower_photos/sample/\")</p>\n<p>predictor = DeepImagePredictor(inputCol=\"image\", outputCol=\"predicted_labels\", modelName=\"InceptionV3\", decodePredictions=True, topK=10)<br>\npredictions_df = predictor.transform(image_df)</p>\n<p>and i get this error :</p>\n<hr>\n<p>ValueError                                Traceback (most recent call last)<br>\n in ()<br>\n4<br>\n5 predictor = DeepImagePredictor(inputCol=\"image\", outputCol=\"predicted_labels\", modelName=\"InceptionV3\", decodePredictions=True, topK=10)<br>\n----&gt; 6 predictions_df = predictor.transform(image_df)</p>\n<p>~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)<br>\n171                 return self.copy(params)._transform(dataset)<br>\n172             else:<br>\n--&gt; 173                 return self._transform(dataset)<br>\n174         else:<br>\n175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/named_image.py in _transform(self, dataset)<br>\n94             modelName=self.getModelName(),<br>\n95             featurize=False)<br>\n---&gt; 96         transformed = transformer.transform(dataset)<br>\n97         if self.getOrDefault(self.decodePredictions):<br>\n98             return self._decodeOutputAsPredictions(transformed)</p>\n<p>~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)<br>\n171                 return self.copy(params)._transform(dataset)<br>\n172             else:<br>\n--&gt; 173                 return self._transform(dataset)<br>\n174         else:<br>\n175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/named_image.py in _transform(self, dataset)<br>\n327             outputMode=modelGraphSpec[\"outputMode\"])<br>\n328         resizeUdf = createResizeImageUDF(modelGraphSpec[\"inputTensorSize\"])<br>\n--&gt; 329         result = tfTransformer.transform(dataset.withColumn(resizedCol, resizeUdf(inputCol)))<br>\n330         return result.drop(resizedCol)<br>\n331</p>\n<p>~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)<br>\n171                 return self.copy(params)._transform(dataset)<br>\n172             else:<br>\n--&gt; 173                 return self._transform(dataset)<br>\n174         else:<br>\n175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/tf_image.py in _transform(self, dataset)<br>\n145                                  \"width\": \"__sdl_image_width\",<br>\n146                                  \"num_channels\": \"__sdl_image_nchannels\",<br>\n--&gt; 147                                  \"image_buffer\": \"__sdl_image_data\"})<br>\n148                 .drop(\"__sdl_image_height\", \"__sdl_image_width\", \"__sdl_image_nchannels\",<br>\n149                       \"__sdl_image_data\")</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in map_rows(fetches, dframe, feed_dict, initial_variables)<br>\n262     if isinstance(dframe, pd.DataFrame):<br>\n263         return _map_pd(fetches, dframe, feed_dict, block=False, trim=None, initial_variables=initial_variables)<br>\n--&gt; 264     return _map(fetches, dframe, feed_dict, block=False, trim=None, initial_variables=initial_variables)<br>\n265<br>\n266 def map_blocks(fetches, dframe, feed_dict=None, trim=False, initial_variables=_initial_variables_default):</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _map(fetches, dframe, feed_dict, block, trim, initial_variables)<br>\n150         builder = _java_api().map_rows(dframe._jdf)<br>\n151     _add_graph(graph, builder)<br>\n--&gt; 152     ph_names = _add_shapes(graph, builder, fetches)<br>\n153     _add_inputs(builder, feed_dict, ph_names)<br>\n154     jdf = builder.buildDF()</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _add_shapes(graph, builder, fetches)<br>\n83             t = graph.get_tensor_by_name(op_name + \":0\")<br>\n84             ph_names.append(t.name)<br>\n---&gt; 85             ph_shapes.append(_get_shape(t))<br>\n86     logger.info(\"fetches: %s %s\", str(names), str(shapes))<br>\n87     logger.info(\"inputs: %s %s\", str(ph_names), str(ph_shapes))</p>\n<p>/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _get_shape(node)<br>\n36<br>\n37 def _get_shape(node):<br>\n---&gt; 38     l = node.get_shape().as_list()<br>\n39     return [-1 if x is None else x for x in l]<br>\n40</p>\n<p>~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py in as_list(self)<br>\n898     \"\"\"<br>\n899     if self._dims is None:<br>\n--&gt; 900       raise ValueError(\"as_list() is not defined on an unknown TensorShape.\")<br>\n901     return [dim.value for dim in self._dims]<br>\n902</p>\n<p>ValueError: as_list() is not defined on an unknown TensorShape.</p>\n<p>Any help please ! Thanks</p>", "body_text": "hello, please i run this code :\nfrom sparkdl import DeepImagePredictor\nimage_df = ImageSchema.readImages(\"flower_photos/sample/\")\npredictor = DeepImagePredictor(inputCol=\"image\", outputCol=\"predicted_labels\", modelName=\"InceptionV3\", decodePredictions=True, topK=10)\npredictions_df = predictor.transform(image_df)\nand i get this error :\n\nValueError                                Traceback (most recent call last)\n in ()\n4\n5 predictor = DeepImagePredictor(inputCol=\"image\", outputCol=\"predicted_labels\", modelName=\"InceptionV3\", decodePredictions=True, topK=10)\n----> 6 predictions_df = predictor.transform(image_df)\n~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)\n171                 return self.copy(params)._transform(dataset)\n172             else:\n--> 173                 return self._transform(dataset)\n174         else:\n175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/named_image.py in _transform(self, dataset)\n94             modelName=self.getModelName(),\n95             featurize=False)\n---> 96         transformed = transformer.transform(dataset)\n97         if self.getOrDefault(self.decodePredictions):\n98             return self._decodeOutputAsPredictions(transformed)\n~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)\n171                 return self.copy(params)._transform(dataset)\n172             else:\n--> 173                 return self._transform(dataset)\n174         else:\n175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/named_image.py in _transform(self, dataset)\n327             outputMode=modelGraphSpec[\"outputMode\"])\n328         resizeUdf = createResizeImageUDF(modelGraphSpec[\"inputTensorSize\"])\n--> 329         result = tfTransformer.transform(dataset.withColumn(resizedCol, resizeUdf(inputCol)))\n330         return result.drop(resizedCol)\n331\n~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)\n171                 return self.copy(params)._transform(dataset)\n172             else:\n--> 173                 return self._transform(dataset)\n174         else:\n175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/tf_image.py in _transform(self, dataset)\n145                                  \"width\": \"__sdl_image_width\",\n146                                  \"num_channels\": \"__sdl_image_nchannels\",\n--> 147                                  \"image_buffer\": \"__sdl_image_data\"})\n148                 .drop(\"__sdl_image_height\", \"__sdl_image_width\", \"__sdl_image_nchannels\",\n149                       \"__sdl_image_data\")\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in map_rows(fetches, dframe, feed_dict, initial_variables)\n262     if isinstance(dframe, pd.DataFrame):\n263         return _map_pd(fetches, dframe, feed_dict, block=False, trim=None, initial_variables=initial_variables)\n--> 264     return _map(fetches, dframe, feed_dict, block=False, trim=None, initial_variables=initial_variables)\n265\n266 def map_blocks(fetches, dframe, feed_dict=None, trim=False, initial_variables=_initial_variables_default):\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _map(fetches, dframe, feed_dict, block, trim, initial_variables)\n150         builder = _java_api().map_rows(dframe._jdf)\n151     _add_graph(graph, builder)\n--> 152     ph_names = _add_shapes(graph, builder, fetches)\n153     _add_inputs(builder, feed_dict, ph_names)\n154     jdf = builder.buildDF()\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _add_shapes(graph, builder, fetches)\n83             t = graph.get_tensor_by_name(op_name + \":0\")\n84             ph_names.append(t.name)\n---> 85             ph_shapes.append(_get_shape(t))\n86     logger.info(\"fetches: %s %s\", str(names), str(shapes))\n87     logger.info(\"inputs: %s %s\", str(ph_names), str(ph_shapes))\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _get_shape(node)\n36\n37 def _get_shape(node):\n---> 38     l = node.get_shape().as_list()\n39     return [-1 if x is None else x for x in l]\n40\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py in as_list(self)\n898     \"\"\"\n899     if self._dims is None:\n--> 900       raise ValueError(\"as_list() is not defined on an unknown TensorShape.\")\n901     return [dim.value for dim in self._dims]\n902\nValueError: as_list() is not defined on an unknown TensorShape.\nAny help please ! Thanks", "body": "hello, please i run this code : \r\n\r\nfrom sparkdl import DeepImagePredictor\r\nimage_df = ImageSchema.readImages(\"flower_photos/sample/\")\r\n\r\npredictor = DeepImagePredictor(inputCol=\"image\", outputCol=\"predicted_labels\", modelName=\"InceptionV3\", decodePredictions=True, topK=10)\r\npredictions_df = predictor.transform(image_df)\r\n\r\n\r\nand i get this error : \r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-10-d7bde844670d> in <module>()\r\n      4 \r\n      5 predictor = DeepImagePredictor(inputCol=\"image\", outputCol=\"predicted_labels\", modelName=\"InceptionV3\", decodePredictions=True, topK=10)\r\n----> 6 predictions_df = predictor.transform(image_df)\r\n\r\n~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)\r\n    171                 return self.copy(params)._transform(dataset)\r\n    172             else:\r\n--> 173                 return self._transform(dataset)\r\n    174         else:\r\n    175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/named_image.py in _transform(self, dataset)\r\n     94             modelName=self.getModelName(),\r\n     95             featurize=False)\r\n---> 96         transformed = transformer.transform(dataset)\r\n     97         if self.getOrDefault(self.decodePredictions):\r\n     98             return self._decodeOutputAsPredictions(transformed)\r\n\r\n~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)\r\n    171                 return self.copy(params)._transform(dataset)\r\n    172             else:\r\n--> 173                 return self._transform(dataset)\r\n    174         else:\r\n    175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/named_image.py in _transform(self, dataset)\r\n    327             outputMode=modelGraphSpec[\"outputMode\"])\r\n    328         resizeUdf = createResizeImageUDF(modelGraphSpec[\"inputTensorSize\"])\r\n--> 329         result = tfTransformer.transform(dataset.withColumn(resizedCol, resizeUdf(inputCol)))\r\n    330         return result.drop(resizedCol)\r\n    331 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/pyspark/ml/base.py in transform(self, dataset, params)\r\n    171                 return self.copy(params)._transform(dataset)\r\n    172             else:\r\n--> 173                 return self._transform(dataset)\r\n    174         else:\r\n    175             raise ValueError(\"Params must be a param map but got %s.\" % type(params))\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_spark-deep-learning-1.0.0-spark2.3-s_2.11.jar/sparkdl/transformers/tf_image.py in _transform(self, dataset)\r\n    145                                  \"width\": \"__sdl_image_width\",\r\n    146                                  \"num_channels\": \"__sdl_image_nchannels\",\r\n--> 147                                  \"image_buffer\": \"__sdl_image_data\"})\r\n    148                 .drop(\"__sdl_image_height\", \"__sdl_image_width\", \"__sdl_image_nchannels\",\r\n    149                       \"__sdl_image_data\")\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in map_rows(fetches, dframe, feed_dict, initial_variables)\r\n    262     if isinstance(dframe, pd.DataFrame):\r\n    263         return _map_pd(fetches, dframe, feed_dict, block=False, trim=None, initial_variables=initial_variables)\r\n--> 264     return _map(fetches, dframe, feed_dict, block=False, trim=None, initial_variables=initial_variables)\r\n    265 \r\n    266 def map_blocks(fetches, dframe, feed_dict=None, trim=False, initial_variables=_initial_variables_default):\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _map(fetches, dframe, feed_dict, block, trim, initial_variables)\r\n    150         builder = _java_api().map_rows(dframe._jdf)\r\n    151     _add_graph(graph, builder)\r\n--> 152     ph_names = _add_shapes(graph, builder, fetches)\r\n    153     _add_inputs(builder, feed_dict, ph_names)\r\n    154     jdf = builder.buildDF()\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _add_shapes(graph, builder, fetches)\r\n     83             t = graph.get_tensor_by_name(op_name + \":0\")\r\n     84             ph_names.append(t.name)\r\n---> 85             ph_shapes.append(_get_shape(t))\r\n     86     logger.info(\"fetches: %s %s\", str(names), str(shapes))\r\n     87     logger.info(\"inputs: %s %s\", str(ph_names), str(ph_shapes))\r\n\r\n/tmp/spark-ad4dff5c-2eda-49cc-b5a8-b81ede3fac4b/userFiles-d4fb97fa-84ed-4aaf-8036-d6d38363201e/databricks_tensorframes-0.3.0-s_2.11.jar/tensorframes/core.py in _get_shape(node)\r\n     36 \r\n     37 def _get_shape(node):\r\n---> 38     l = node.get_shape().as_list()\r\n     39     return [-1 if x is None else x for x in l]\r\n     40 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py in as_list(self)\r\n    898     \"\"\"\r\n    899     if self._dims is None:\r\n--> 900       raise ValueError(\"as_list() is not defined on an unknown TensorShape.\")\r\n    901     return [dim.value for dim in self._dims]\r\n    902 \r\n\r\nValueError: as_list() is not defined on an unknown TensorShape.\r\n\r\n\r\nAny help please ! Thanks "}