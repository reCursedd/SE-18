{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/375511245", "html_url": "https://github.com/tensorflow/tensorflow/issues/17852#issuecomment-375511245", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17852", "id": 375511245, "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTUxMTI0NQ==", "user": {"login": "simpeng", "id": 3860113, "node_id": "MDQ6VXNlcjM4NjAxMTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/3860113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simpeng", "html_url": "https://github.com/simpeng", "followers_url": "https://api.github.com/users/simpeng/followers", "following_url": "https://api.github.com/users/simpeng/following{/other_user}", "gists_url": "https://api.github.com/users/simpeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/simpeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simpeng/subscriptions", "organizations_url": "https://api.github.com/users/simpeng/orgs", "repos_url": "https://api.github.com/users/simpeng/repos", "events_url": "https://api.github.com/users/simpeng/events{/privacy}", "received_events_url": "https://api.github.com/users/simpeng/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-23T01:35:28Z", "updated_at": "2018-03-23T01:36:31Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=577277\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/martinwicke\">@martinwicke</a> , yes it's repeatable, I did twice ( one on my local machine for debugging, the other one is on another build machine).</p>\n<p>My testing case is:</p>\n<ul>\n<li>Start the PS job first, normally it keep waiting for response from worker, util worker get started.</li>\n</ul>\n<blockquote>\n<p>2018-03-20 05:49:50.430531: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:worker/replica:0/task:0</p>\n</blockquote>\n<ul>\n<li>With 1.6, it will try to \"connect to the channel\" and retry few times, then throw exception:</li>\n</ul>\n<blockquote>\n<p>{\"created\":\"@1521525453.308215652\",\"description\":\"Failed to connect to remote host: OS Error\",\"errno\":111,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_client_posix.cc\",\"file_line\":198,\"os_error\":\"Connection refused\",\"syscall\":\"connect\",\"target_address\":\"ipv4:10.0.1.4:14417\"}<br>\nI0320 05:57:33.308375658 3806 subchannel.cc:484] Retry in 999 milliseconds<br>\nI0320 05:57:34.307172752 3796 subchannel.cc:437] Failed to connect to channel, retrying<br>\n2018-03-20 05:57:34.308793: E tensorflow/core/distributed_runtime/master.cc:269] Master init: Unavailable: OS Error<br>\nTraceback (most recent call last):<br>\nFile \"mnist_replica.py\", line 304, in<br>\nmain(args)<br>\nFile \"mnist_replica.py\", line 102, in main<br>\nsess.run(queue.dequeue())<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 905, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1137, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1355, in _do_run<br>\noptions, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1374, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.UnavailableError: OS Error</p>\n</blockquote>\n<p>The change I reverted is the <a href=\"https://github.com/tensorflow/tensorflow/commit/cb498995bf3499d3dd4a6edad407590af12ac3bd\">gRPC commit</a>.</p>", "body_text": "@martinwicke , yes it's repeatable, I did twice ( one on my local machine for debugging, the other one is on another build machine).\nMy testing case is:\n\nStart the PS job first, normally it keep waiting for response from worker, util worker get started.\n\n\n2018-03-20 05:49:50.430531: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:worker/replica:0/task:0\n\n\nWith 1.6, it will try to \"connect to the channel\" and retry few times, then throw exception:\n\n\n{\"created\":\"@1521525453.308215652\",\"description\":\"Failed to connect to remote host: OS Error\",\"errno\":111,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_client_posix.cc\",\"file_line\":198,\"os_error\":\"Connection refused\",\"syscall\":\"connect\",\"target_address\":\"ipv4:10.0.1.4:14417\"}\nI0320 05:57:33.308375658 3806 subchannel.cc:484] Retry in 999 milliseconds\nI0320 05:57:34.307172752 3796 subchannel.cc:437] Failed to connect to channel, retrying\n2018-03-20 05:57:34.308793: E tensorflow/core/distributed_runtime/master.cc:269] Master init: Unavailable: OS Error\nTraceback (most recent call last):\nFile \"mnist_replica.py\", line 304, in\nmain(args)\nFile \"mnist_replica.py\", line 102, in main\nsess.run(queue.dequeue())\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 905, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1137, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1355, in _do_run\noptions, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1374, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnavailableError: OS Error\n\nThe change I reverted is the gRPC commit.", "body": "@martinwicke , yes it's repeatable, I did twice ( one on my local machine for debugging, the other one is on another build machine). \r\n\r\nMy testing case is: \r\n\r\n- Start the PS job first, normally it keep waiting for response from worker, util worker get started. \r\n\r\n> 2018-03-20 05:49:50.430531: I tensorflow/core/distributed_runtime/master.cc:221] CreateSession still waiting for response from worker: /job:worker/replica:0/task:0\r\n\r\n- With 1.6, it will try to \"connect to the channel\" and retry few times, then throw exception:\r\n\r\n> {\"created\":\"@1521525453.308215652\",\"description\":\"Failed to connect to remote host: OS Error\",\"errno\":111,\"file\":\"external/grpc/src/core/lib/iomgr/tcp_client_posix.cc\",\"file_line\":198,\"os_error\":\"Connection refused\",\"syscall\":\"connect\",\"target_address\":\"ipv4:10.0.1.4:14417\"}\r\nI0320 05:57:33.308375658 3806 subchannel.cc:484] Retry in 999 milliseconds\r\nI0320 05:57:34.307172752 3796 subchannel.cc:437] Failed to connect to channel, retrying\r\n2018-03-20 05:57:34.308793: E tensorflow/core/distributed_runtime/master.cc:269] Master init: Unavailable: OS Error\r\nTraceback (most recent call last):\r\nFile \"mnist_replica.py\", line 304, in \r\nmain(args)\r\nFile \"mnist_replica.py\", line 102, in main\r\nsess.run(queue.dequeue())\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 905, in run\r\nrun_metadata_ptr)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1137, in _run\r\nfeed_dict_tensor, options, run_metadata)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1355, in _do_run\r\noptions, run_metadata)\r\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 1374, in _do_call\r\nraise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnavailableError: OS Error\r\n\r\nThe change I reverted is the [gRPC commit](https://github.com/tensorflow/tensorflow/commit/cb498995bf3499d3dd4a6edad407590af12ac3bd).\r\n"}