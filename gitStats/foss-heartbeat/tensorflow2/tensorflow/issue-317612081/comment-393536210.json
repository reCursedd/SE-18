{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/393536210", "html_url": "https://github.com/tensorflow/tensorflow/issues/18861#issuecomment-393536210", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18861", "id": 393536210, "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzUzNjIxMA==", "user": {"login": "nikkymen", "id": 6241610, "node_id": "MDQ6VXNlcjYyNDE2MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6241610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikkymen", "html_url": "https://github.com/nikkymen", "followers_url": "https://api.github.com/users/nikkymen/followers", "following_url": "https://api.github.com/users/nikkymen/following{/other_user}", "gists_url": "https://api.github.com/users/nikkymen/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikkymen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikkymen/subscriptions", "organizations_url": "https://api.github.com/users/nikkymen/orgs", "repos_url": "https://api.github.com/users/nikkymen/repos", "events_url": "https://api.github.com/users/nikkymen/events{/privacy}", "received_events_url": "https://api.github.com/users/nikkymen/received_events", "type": "User", "site_admin": false}, "created_at": "2018-05-31T13:49:33Z", "updated_at": "2018-06-01T12:57:46Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=3300016\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/kerolos\">@kerolos</a></p>\n<p>In c++ this can be done with graph modification before creation the session, something like this:</p>\n<pre><code>tensorflow::Session * load_graph(const std::string &amp;path, const std::string &amp;device = std::string())\n{\n    tensorflow::GraphDef graph_def;\n    tensorflow::ReadBinaryProto(tensorflow::Env::Default(), path, &amp;graph_def);\n\n    if(!device.empty())\n    {\n        for(int i = 0; i &lt; graph_def.node_size(); ++i)\n        {\n            graph_def.mutable_node(i)-&gt;set_device(device);\n        }\n    }\n\n    tensorflow::Session *session;\n    tensorflow::NewSession(tensorflow::SessionOptions(), &amp;session);\n    session-&gt;Create(graph_def);\n    return session;\n}\n\n...\n\ntensorflow::Session *session_gpu_0 = load_graph(graph_file_path, \"/gpu:0\");\ntensorflow::Session *session_gpu_1 = load_graph(graph_file_path, \"/gpu:1\");\n\n</code></pre>", "body_text": "@kerolos\nIn c++ this can be done with graph modification before creation the session, something like this:\ntensorflow::Session * load_graph(const std::string &path, const std::string &device = std::string())\n{\n    tensorflow::GraphDef graph_def;\n    tensorflow::ReadBinaryProto(tensorflow::Env::Default(), path, &graph_def);\n\n    if(!device.empty())\n    {\n        for(int i = 0; i < graph_def.node_size(); ++i)\n        {\n            graph_def.mutable_node(i)->set_device(device);\n        }\n    }\n\n    tensorflow::Session *session;\n    tensorflow::NewSession(tensorflow::SessionOptions(), &session);\n    session->Create(graph_def);\n    return session;\n}\n\n...\n\ntensorflow::Session *session_gpu_0 = load_graph(graph_file_path, \"/gpu:0\");\ntensorflow::Session *session_gpu_1 = load_graph(graph_file_path, \"/gpu:1\");", "body": "@kerolos \r\n\r\nIn c++ this can be done with graph modification before creation the session, something like this:\r\n\r\n```\r\ntensorflow::Session * load_graph(const std::string &path, const std::string &device = std::string())\r\n{\r\n    tensorflow::GraphDef graph_def;\r\n    tensorflow::ReadBinaryProto(tensorflow::Env::Default(), path, &graph_def);\r\n\r\n    if(!device.empty())\r\n    {\r\n        for(int i = 0; i < graph_def.node_size(); ++i)\r\n        {\r\n            graph_def.mutable_node(i)->set_device(device);\r\n        }\r\n    }\r\n\r\n    tensorflow::Session *session;\r\n    tensorflow::NewSession(tensorflow::SessionOptions(), &session);\r\n    session->Create(graph_def);\r\n    return session;\r\n}\r\n\r\n...\r\n\r\ntensorflow::Session *session_gpu_0 = load_graph(graph_file_path, \"/gpu:0\");\r\ntensorflow::Session *session_gpu_1 = load_graph(graph_file_path, \"/gpu:1\");\r\n\r\n```\r\n\r\n"}