{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6790", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6790/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6790/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6790/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/6790", "id": 200112026, "node_id": "MDU6SXNzdWUyMDAxMTIwMjY=", "number": 6790, "title": "Only Master worker do predict when using estimator.Estimator.predict", "user": {"login": "buptjz", "id": 3990778, "node_id": "MDQ6VXNlcjM5OTA3Nzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3990778?v=4", "gravatar_id": "", "url": "https://api.github.com/users/buptjz", "html_url": "https://github.com/buptjz", "followers_url": "https://api.github.com/users/buptjz/followers", "following_url": "https://api.github.com/users/buptjz/following{/other_user}", "gists_url": "https://api.github.com/users/buptjz/gists{/gist_id}", "starred_url": "https://api.github.com/users/buptjz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/buptjz/subscriptions", "organizations_url": "https://api.github.com/users/buptjz/orgs", "repos_url": "https://api.github.com/users/buptjz/repos", "events_url": "https://api.github.com/users/buptjz/events{/privacy}", "received_events_url": "https://api.github.com/users/buptjz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-01-11T14:46:21Z", "updated_at": "2017-03-09T18:26:36Z", "closed_at": "2017-03-09T18:26:36Z", "author_association": "NONE", "body_html": "<p>I run distributed training via a estimator.Estimator.The model is save at hdfs with multiple files.<br>\nWhen I use this model to predict, only the master worker do prediction while other workers do nothing,<br>\njust stop at the beginning of the for loop.</p>\n<p>classifier = tf.contrib.learn.estimator.Estimator(<br>\nmodel_fn=l2m_model_fn,<br>\nparams=model_params,<br>\nconfig=run_config,<br>\nmodel_dir=FLAGS.ckp_dir<br>\n)</p>\n<p>predictions = classifier.predict(<br>\ninput_fn=lambda: l2m_input_fn2(args),<br>\nas_iterable=True<br>\n)</p>\n<p>for i, p in enumerate(predictions):<br>\n#do sth with p</p>", "body_text": "I run distributed training via a estimator.Estimator.The model is save at hdfs with multiple files.\nWhen I use this model to predict, only the master worker do prediction while other workers do nothing,\njust stop at the beginning of the for loop.\nclassifier = tf.contrib.learn.estimator.Estimator(\nmodel_fn=l2m_model_fn,\nparams=model_params,\nconfig=run_config,\nmodel_dir=FLAGS.ckp_dir\n)\npredictions = classifier.predict(\ninput_fn=lambda: l2m_input_fn2(args),\nas_iterable=True\n)\nfor i, p in enumerate(predictions):\n#do sth with p", "body": "I run distributed training via a estimator.Estimator.The model is save at hdfs with multiple files.\r\nWhen I use this model to predict, only the master worker do prediction while other workers do nothing,\r\njust stop at the beginning of the for loop.\r\n\r\nclassifier = tf.contrib.learn.estimator.Estimator(\r\n        model_fn=l2m_model_fn,\r\n        params=model_params,\r\n        config=run_config,\r\n        model_dir=FLAGS.ckp_dir\r\n    )\r\n\r\npredictions = classifier.predict(\r\n        input_fn=lambda: l2m_input_fn2(args),\r\n        as_iterable=True\r\n)\r\n\r\nfor i, p in enumerate(predictions):\r\n        #do sth with p"}