{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/324476775", "html_url": "https://github.com/tensorflow/tensorflow/issues/12536#issuecomment-324476775", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/12536", "id": 324476775, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNDQ3Njc3NQ==", "user": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-23T22:08:47Z", "updated_at": "2017-08-23T22:08:47Z", "author_association": "MEMBER", "body_html": "<div class=\"email-fragment\">Actually this is where the error is raised:\n<a href=\"https://github.com/tensorflow/tensorflow/blob/593dc8e5d65f4db93e8f5fced772abb3531a9752/tensorflow/core/util/strided_slice_op.cc#L257\">https://github.com/tensorflow/tensorflow/blob/593dc8e5d65f4db93e8f5fced772abb3531a9752/tensorflow/core/util/strided_slice_op.cc#L257</a>\n\nSince I assume you're setting the strides correctly (they must be non-zero)\nI think we're looking at memory being freed before tensorflow gets to it.\n\nOn Wed, Aug 23, 2017 at 3:06 PM, Alexandre Passos &lt;apassos@google.com&gt;\nwrote:</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\"> What this looks like to me from the non-determinism is that JNI is freeing\n the tensor while tensorflow still has a reference to it.\n\n Maybe try making a copy of the memory before creating a tensor and see if\n it goes away?\n\n Oddly I can't find where in the code this error is coming from. Can you\n edit the line 1192 in op_kernel.cc and make it crash the program and\n produce a stack trace, in case my suggestion above doesn't work?\n\n On Wed, Aug 23, 2017 at 2:42 PM, Anthony Platanios &lt;\n ***@***.***&gt; wrote:\n\n&gt; I see. You're actually right. I guess I'm only trying to reproduce a\n&gt; problem I'm getting when setting this up through my JNI bindings. The error\n&gt; I get (and which is not deterministic) is:\n&gt;\n&gt; W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument:\n&gt; strides[0] must be non-zero\n&gt;\n&gt; And the actual values I'm passing to the op are exactly the same as in\n&gt; the above example. Do you have any idea as to why this might be happening?\n&gt; Thanks! :)\n&gt;\n&gt; \u2014\n&gt; You are receiving this because you were mentioned.\n&gt; Reply to this email directly, view it on GitHub\n&gt; &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"252397873\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12536\" href=\"https://github.com/tensorflow/tensorflow/issues/12536#issuecomment-324470106\">#12536 (comment)</a>&gt;,\n&gt; or mute the thread\n&gt; &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AAATxRlIF80A_btxawrJB0HeYafHejcfks5sbJy4gaJpZM4PAgVi\">https://github.com/notifications/unsubscribe-auth/AAATxRlIF80A_btxawrJB0HeYafHejcfks5sbJy4gaJpZM4PAgVi</a>&gt;\n&gt; .\n&gt;\n\n\n\n --\n  - Alex\n</div>\n<div class=\"email-fragment\"></div>\n<div class=\"email-signature-reply\">-- \n - Alex</div>\n</div>", "body_text": "Actually this is where the error is raised:\nhttps://github.com/tensorflow/tensorflow/blob/593dc8e5d65f4db93e8f5fced772abb3531a9752/tensorflow/core/util/strided_slice_op.cc#L257\n\nSince I assume you're setting the strides correctly (they must be non-zero)\nI think we're looking at memory being freed before tensorflow gets to it.\n\nOn Wed, Aug 23, 2017 at 3:06 PM, Alexandre Passos <apassos@google.com>\nwrote:\n\u2026\n What this looks like to me from the non-determinism is that JNI is freeing\n the tensor while tensorflow still has a reference to it.\n\n Maybe try making a copy of the memory before creating a tensor and see if\n it goes away?\n\n Oddly I can't find where in the code this error is coming from. Can you\n edit the line 1192 in op_kernel.cc and make it crash the program and\n produce a stack trace, in case my suggestion above doesn't work?\n\n On Wed, Aug 23, 2017 at 2:42 PM, Anthony Platanios <\n ***@***.***> wrote:\n\n> I see. You're actually right. I guess I'm only trying to reproduce a\n> problem I'm getting when setting this up through my JNI bindings. The error\n> I get (and which is not deterministic) is:\n>\n> W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument:\n> strides[0] must be non-zero\n>\n> And the actual values I'm passing to the op are exactly the same as in\n> the above example. Do you have any idea as to why this might be happening?\n> Thanks! :)\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <#12536 (comment)>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AAATxRlIF80A_btxawrJB0HeYafHejcfks5sbJy4gaJpZM4PAgVi>\n> .\n>\n\n\n\n --\n  - Alex\n\n\n-- \n - Alex", "body": "Actually this is where the error is raised:\nhttps://github.com/tensorflow/tensorflow/blob/593dc8e5d65f4db93e8f5fced772abb3531a9752/tensorflow/core/util/strided_slice_op.cc#L257\n\nSince I assume you're setting the strides correctly (they must be non-zero)\nI think we're looking at memory being freed before tensorflow gets to it.\n\nOn Wed, Aug 23, 2017 at 3:06 PM, Alexandre Passos <apassos@google.com>\nwrote:\n\n> What this looks like to me from the non-determinism is that JNI is freeing\n> the tensor while tensorflow still has a reference to it.\n>\n> Maybe try making a copy of the memory before creating a tensor and see if\n> it goes away?\n>\n> Oddly I can't find where in the code this error is coming from. Can you\n> edit the line 1192 in op_kernel.cc and make it crash the program and\n> produce a stack trace, in case my suggestion above doesn't work?\n>\n> On Wed, Aug 23, 2017 at 2:42 PM, Anthony Platanios <\n> notifications@github.com> wrote:\n>\n>> I see. You're actually right. I guess I'm only trying to reproduce a\n>> problem I'm getting when setting this up through my JNI bindings. The error\n>> I get (and which is not deterministic) is:\n>>\n>> W tensorflow/core/framework/op_kernel.cc:1192] Invalid argument:\n>> strides[0] must be non-zero\n>>\n>> And the actual values I'm passing to the op are exactly the same as in\n>> the above example. Do you have any idea as to why this might be happening?\n>> Thanks! :)\n>>\n>> \u2014\n>> You are receiving this because you were mentioned.\n>> Reply to this email directly, view it on GitHub\n>> <https://github.com/tensorflow/tensorflow/issues/12536#issuecomment-324470106>,\n>> or mute the thread\n>> <https://github.com/notifications/unsubscribe-auth/AAATxRlIF80A_btxawrJB0HeYafHejcfks5sbJy4gaJpZM4PAgVi>\n>> .\n>>\n>\n>\n>\n> --\n>  - Alex\n>\n\n\n\n-- \n - Alex\n"}