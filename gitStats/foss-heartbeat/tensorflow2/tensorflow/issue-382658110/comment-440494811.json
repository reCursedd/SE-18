{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/440494811", "html_url": "https://github.com/tensorflow/tensorflow/issues/23881#issuecomment-440494811", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23881", "id": 440494811, "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDQ5NDgxMQ==", "user": {"login": "banbsyip", "id": 18277076, "node_id": "MDQ6VXNlcjE4Mjc3MDc2", "avatar_url": "https://avatars3.githubusercontent.com/u/18277076?v=4", "gravatar_id": "", "url": "https://api.github.com/users/banbsyip", "html_url": "https://github.com/banbsyip", "followers_url": "https://api.github.com/users/banbsyip/followers", "following_url": "https://api.github.com/users/banbsyip/following{/other_user}", "gists_url": "https://api.github.com/users/banbsyip/gists{/gist_id}", "starred_url": "https://api.github.com/users/banbsyip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/banbsyip/subscriptions", "organizations_url": "https://api.github.com/users/banbsyip/orgs", "repos_url": "https://api.github.com/users/banbsyip/repos", "events_url": "https://api.github.com/users/banbsyip/events{/privacy}", "received_events_url": "https://api.github.com/users/banbsyip/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-21T01:31:05Z", "updated_at": "2018-11-21T01:31:05Z", "author_association": "NONE", "body_html": "<blockquote>\n<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=18277076\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/banbsyip\">@banbsyip</a> We encourage users to stay with the two latest versions of TF. Please use tensorflow 1.11 or 1.12. This issue would not occur with these versions.</p>\n</blockquote>\n<p>i run a project with pycharm, it could work,then i uninstall the tensorflow1.8 and installed TensorFlow1.12, the same wrong came again,but i could run the project with pycharm yesterday night. this morning i run the project but failed, it shows taht  \"Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\" the detail as fllow:</p>\n<p>Using TensorFlow backend.<br>\n2018-11-21 09:16:41.195484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0<br>\n2018-11-21 09:16:41.195534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-11-21 09:16:41.195539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0<br>\n2018-11-21 09:16:41.195543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N<br>\n2018-11-21 09:16:41.195656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3638 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)<br>\n2018-11-21 09:16:52.238761: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR<br>\n2018-11-21 09:16:52.241850: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR<br>\nTraceback (most recent call last):<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call<br>\nreturn fn(*args)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn<br>\noptions, feed_dict, fetch_list, target_list, run_metadata)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun<br>\nrun_metadata)<br>\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.<br>\n[[{{node conv1_1/Conv2D}} = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]<br>\n[[{{node rois/Reshape/_97}} = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/demo.py\", line 21, in <br>\nresult, image_framed = ocr.model(image)<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ocr.py\", line 83, in model<br>\ntext_recs, img_framed, img = text_detect(img)<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 90, in text_detect<br>\nscores, boxes, img, scale = ctpn(img)<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 52, in ctpn<br>\nscores, boxes = test_ctpn(sess, net, img)<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/fast_rcnn/test.py\", line 51, in test_ctpn<br>\nrois = sess.run([net.get_output('rois')[0]],feed_dict=feed_dict)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 929, in run<br>\nrun_metadata_ptr)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1152, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run<br>\nrun_metadata)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.<br>\n[[node conv1_1/Conv2D (defined at /home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py:167)  = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]<br>\n[[{{node rois/Reshape/_97}} = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>\n<p>Caused by op 'conv1_1/Conv2D', defined at:<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/demo.py\", line 3, in <br>\nimport ocr<br>\nFile \"\", line 969, in _find_and_load<br>\nFile \"\", line 958, in _find_and_load_unlocked<br>\nFile \"\", line 673, in _load_unlocked<br>\nFile \"\", line 665, in exec_module<br>\nFile \"\", line 222, in _call_with_frames_removed<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ocr.py\", line 10, in <br>\nfrom ctpn.text_detect import text_detect<br>\nFile \"\", line 969, in _find_and_load<br>\nFile \"\", line 958, in _find_and_load_unlocked<br>\nFile \"\", line 673, in _load_unlocked<br>\nFile \"\", line 665, in exec_module<br>\nFile \"\", line 222, in _call_with_frames_removed<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 45, in <br>\nsess, net = load_tf_model()<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 30, in load_tf_model<br>\nnet = get_network(\"VGGnet_test\")<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/factory.py\", line 8, in get_network<br>\nreturn VGGnet_test()<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/VGGnet_test.py\", line 14, in <strong>init</strong><br>\nself.setup()<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/VGGnet_test.py\", line 21, in setup<br>\n.conv(3, 3, 64, 1, 1, name='conv1_1')<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 23, in layer_decorated<br>\nlayer_output = op(self, layer_input, *args, **kwargs)<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 176, in conv<br>\nconv = convolve(input, kernel)<br>\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 167, in <br>\nconvolve = lambda i, k: tf.nn.conv2d(i, k, [1, s_h, s_w, 1], padding=padding)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 957, in conv2d<br>\ndata_format=data_format, dilations=dilations, name=name)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper<br>\nop_def=op_def)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func<br>\nreturn func(*args, **kwargs)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op<br>\nop_def=op_def)<br>\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1770, in <strong>init</strong><br>\nself._traceback = tf_stack.extract_stack()</p>\n<p>UnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.<br>\n[[node conv1_1/Conv2D (defined at /home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py:167)  = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]<br>\n[[{{node rois/Reshape/_97}} = _Recv<a href=\"\">client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"</a>]]</p>", "body_text": "@banbsyip We encourage users to stay with the two latest versions of TF. Please use tensorflow 1.11 or 1.12. This issue would not occur with these versions.\n\ni run a project with pycharm, it could work,then i uninstall the tensorflow1.8 and installed TensorFlow1.12, the same wrong came again,but i could run the project with pycharm yesterday night. this morning i run the project but failed, it shows taht  \"Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\" the detail as fllow:\nUsing TensorFlow backend.\n2018-11-21 09:16:41.195484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0\n2018-11-21 09:16:41.195534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-11-21 09:16:41.195539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0\n2018-11-21 09:16:41.195543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N\n2018-11-21 09:16:41.195656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3638 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\n2018-11-21 09:16:52.238761: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\n2018-11-21 09:16:52.241850: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\nTraceback (most recent call last):\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\nreturn fn(*args)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\noptions, feed_dict, fetch_list, target_list, run_metadata)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\nrun_metadata)\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\n[[{{node conv1_1/Conv2D}} = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]\n[[{{node rois/Reshape/_97}} = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/demo.py\", line 21, in \nresult, image_framed = ocr.model(image)\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ocr.py\", line 83, in model\ntext_recs, img_framed, img = text_detect(img)\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 90, in text_detect\nscores, boxes, img, scale = ctpn(img)\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 52, in ctpn\nscores, boxes = test_ctpn(sess, net, img)\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/fast_rcnn/test.py\", line 51, in test_ctpn\nrois = sess.run([net.get_output('rois')[0]],feed_dict=feed_dict)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 929, in run\nrun_metadata_ptr)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\nrun_metadata)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\n[[node conv1_1/Conv2D (defined at /home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py:167)  = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]\n[[{{node rois/Reshape/_97}} = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]\nCaused by op 'conv1_1/Conv2D', defined at:\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/demo.py\", line 3, in \nimport ocr\nFile \"\", line 969, in _find_and_load\nFile \"\", line 958, in _find_and_load_unlocked\nFile \"\", line 673, in _load_unlocked\nFile \"\", line 665, in exec_module\nFile \"\", line 222, in _call_with_frames_removed\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ocr.py\", line 10, in \nfrom ctpn.text_detect import text_detect\nFile \"\", line 969, in _find_and_load\nFile \"\", line 958, in _find_and_load_unlocked\nFile \"\", line 673, in _load_unlocked\nFile \"\", line 665, in exec_module\nFile \"\", line 222, in _call_with_frames_removed\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 45, in \nsess, net = load_tf_model()\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 30, in load_tf_model\nnet = get_network(\"VGGnet_test\")\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/factory.py\", line 8, in get_network\nreturn VGGnet_test()\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/VGGnet_test.py\", line 14, in init\nself.setup()\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/VGGnet_test.py\", line 21, in setup\n.conv(3, 3, 64, 1, 1, name='conv1_1')\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 23, in layer_decorated\nlayer_output = op(self, layer_input, *args, **kwargs)\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 176, in conv\nconv = convolve(input, kernel)\nFile \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 167, in \nconvolve = lambda i, k: tf.nn.conv2d(i, k, [1, s_h, s_w, 1], padding=padding)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 957, in conv2d\ndata_format=data_format, dilations=dilations, name=name)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\nop_def=op_def)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\nreturn func(*args, **kwargs)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\nop_def=op_def)\nFile \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1770, in init\nself._traceback = tf_stack.extract_stack()\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\n[[node conv1_1/Conv2D (defined at /home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py:167)  = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]\n[[{{node rois/Reshape/_97}} = _Recvclient_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]]", "body": "> @banbsyip We encourage users to stay with the two latest versions of TF. Please use tensorflow 1.11 or 1.12. This issue would not occur with these versions.\r\n\r\ni run a project with pycharm, it could work,then i uninstall the tensorflow1.8 and installed TensorFlow1.12, the same wrong came again,but i could run the project with pycharm yesterday night. this morning i run the project but failed, it shows taht  \"Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\" the detail as fllow:\r\n\r\n\r\nUsing TensorFlow backend.\r\n2018-11-21 09:16:41.195484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0\r\n2018-11-21 09:16:41.195534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-11-21 09:16:41.195539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 \r\n2018-11-21 09:16:41.195543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N \r\n2018-11-21 09:16:41.195656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3638 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-11-21 09:16:52.238761: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2018-11-21 09:16:52.241850: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\nTraceback (most recent call last):\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n     [[{{node conv1_1/Conv2D}} = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]\r\n     [[{{node rois/Reshape/_97}} = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/demo.py\", line 21, in <module>\r\n    result, image_framed = ocr.model(image)\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ocr.py\", line 83, in model\r\n    text_recs, img_framed, img = text_detect(img)\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 90, in text_detect\r\n    scores, boxes, img, scale = ctpn(img)\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 52, in ctpn\r\n    scores, boxes = test_ctpn(sess, net, img)\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/fast_rcnn/test.py\", line 51, in test_ctpn\r\n    rois = sess.run([net.get_output('rois')[0]],feed_dict=feed_dict)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n     [[node conv1_1/Conv2D (defined at /home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py:167)  = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]\r\n     [[{{node rois/Reshape/_97}} = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nCaused by op 'conv1_1/Conv2D', defined at:\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/demo.py\", line 3, in <module>\r\n    import ocr\r\n  File \"<frozen importlib._bootstrap>\", line 969, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 958, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 673, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 665, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 222, in _call_with_frames_removed\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ocr.py\", line 10, in <module>\r\n    from ctpn.text_detect import text_detect\r\n  File \"<frozen importlib._bootstrap>\", line 969, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 958, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 673, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 665, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 222, in _call_with_frames_removed\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 45, in <module>\r\n    sess, net = load_tf_model()\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/text_detect.py\", line 30, in load_tf_model\r\n    net = get_network(\"VGGnet_test\")\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/factory.py\", line 8, in get_network\r\n    return VGGnet_test()\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/VGGnet_test.py\", line 14, in __init__\r\n    self.setup()\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/VGGnet_test.py\", line 21, in setup\r\n    .conv(3, 3, 64, 1, 1, name='conv1_1')\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 23, in layer_decorated\r\n    layer_output = op(self, layer_input, *args, **kwargs)\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 176, in conv\r\n    conv = convolve(input, kernel)\r\n  File \"/home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py\", line 167, in <lambda>\r\n    convolve = lambda i, k: tf.nn.conv2d(i, k, [1, s_h, s_w, 1], padding=padding)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 957, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/home/cq/anaconda3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n     [[node conv1_1/Conv2D (defined at /home/cq/\u684c\u9762/chinese_ocr-master/ctpn/lib/networks/network.py:167)  = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](conv1_1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1_1/weights/read)]]\r\n     [[{{node rois/Reshape/_97}} = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_587_rois/Reshape\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n"}