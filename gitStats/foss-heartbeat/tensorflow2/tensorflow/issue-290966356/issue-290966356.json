{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16333", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16333/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16333/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16333/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/16333", "id": 290966356, "node_id": "MDU6SXNzdWUyOTA5NjYzNTY=", "number": 16333, "title": "Computing gradients of loop variables return None", "user": {"login": "mholzel", "id": 7227349, "node_id": "MDQ6VXNlcjcyMjczNDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/7227349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mholzel", "html_url": "https://github.com/mholzel", "followers_url": "https://api.github.com/users/mholzel/followers", "following_url": "https://api.github.com/users/mholzel/following{/other_user}", "gists_url": "https://api.github.com/users/mholzel/gists{/gist_id}", "starred_url": "https://api.github.com/users/mholzel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mholzel/subscriptions", "organizations_url": "https://api.github.com/users/mholzel/orgs", "repos_url": "https://api.github.com/users/mholzel/repos", "events_url": "https://api.github.com/users/mholzel/events{/privacy}", "received_events_url": "https://api.github.com/users/mholzel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-01-23T19:36:43Z", "updated_at": "2018-11-22T18:53:47Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li>Windows 10 x64</li>\n<li>Installed from binary</li>\n<li>TensorFlow 1.3.0</li>\n<li>Python 3.6.3</li>\n<li>CuDNN 6.4.6, CUDA 8.0</li>\n<li>NVIDIA GeForce 940M</li>\n</ul>\n<h3>Bug Description</h3>\n<p>Issue <a href=\"https://github.com/tensorflow/tensorflow/issues/15403\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/15403/hovercard\">15403</a> was closed since it was labelled as \"not a bug or feature request\". I believe it is indeed a bug.</p>\n<p>The fundamental problem is that gradients do not seem to be working inside of <code>tf.while_loop</code>s. Here is a demonstration of code run inside and outside of a while loop. The code outside of the loop produces a result, whereas the gradient inside of the loop returns None:</p>\n<pre><code>import tensorflow as tf\n\ni = tf.constant(0)\nx = tf.constant(3.0)\nprint(\"External gradient:\", tf.gradients(x, x)[0])     # Prints Tensor(\"gradients/Fill:0\", shape=(), dtype=float32)\n\ndef loop_body(i, x, y):\n    print(\"internal gradient:\", tf.gradients(x, y)[0]) # Prints None\n    return i + 1, x, y\n\ntf.while_loop( lambda i,x,y: tf.less(i, 5), loop_body, [i, x, x]);\n</code></pre>", "body_text": "System information\n\nWindows 10 x64\nInstalled from binary\nTensorFlow 1.3.0\nPython 3.6.3\nCuDNN 6.4.6, CUDA 8.0\nNVIDIA GeForce 940M\n\nBug Description\nIssue 15403 was closed since it was labelled as \"not a bug or feature request\". I believe it is indeed a bug.\nThe fundamental problem is that gradients do not seem to be working inside of tf.while_loops. Here is a demonstration of code run inside and outside of a while loop. The code outside of the loop produces a result, whereas the gradient inside of the loop returns None:\nimport tensorflow as tf\n\ni = tf.constant(0)\nx = tf.constant(3.0)\nprint(\"External gradient:\", tf.gradients(x, x)[0])     # Prints Tensor(\"gradients/Fill:0\", shape=(), dtype=float32)\n\ndef loop_body(i, x, y):\n    print(\"internal gradient:\", tf.gradients(x, y)[0]) # Prints None\n    return i + 1, x, y\n\ntf.while_loop( lambda i,x,y: tf.less(i, 5), loop_body, [i, x, x]);", "body": "### System information\r\n- Windows 10 x64\r\n- Installed from binary\r\n- TensorFlow 1.3.0\r\n- Python 3.6.3\r\n- CuDNN 6.4.6, CUDA 8.0\r\n- NVIDIA GeForce 940M\r\n\r\n### Bug Description\r\n\r\nIssue [15403](https://github.com/tensorflow/tensorflow/issues/15403) was closed since it was labelled as \"not a bug or feature request\". I believe it is indeed a bug. \r\n\r\nThe fundamental problem is that gradients do not seem to be working inside of `tf.while_loop`s. Here is a demonstration of code run inside and outside of a while loop. The code outside of the loop produces a result, whereas the gradient inside of the loop returns None: \r\n```\r\nimport tensorflow as tf\r\n\r\ni = tf.constant(0)\r\nx = tf.constant(3.0)\r\nprint(\"External gradient:\", tf.gradients(x, x)[0])     # Prints Tensor(\"gradients/Fill:0\", shape=(), dtype=float32)\r\n\r\ndef loop_body(i, x, y):\r\n    print(\"internal gradient:\", tf.gradients(x, y)[0]) # Prints None\r\n    return i + 1, x, y\r\n\r\ntf.while_loop( lambda i,x,y: tf.less(i, 5), loop_body, [i, x, x]);\r\n```"}