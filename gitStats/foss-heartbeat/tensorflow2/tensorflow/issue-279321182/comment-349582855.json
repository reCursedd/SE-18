{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/349582855", "html_url": "https://github.com/tensorflow/tensorflow/issues/15122#issuecomment-349582855", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15122", "id": 349582855, "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTU4Mjg1NQ==", "user": {"login": "imxboards", "id": 11689850, "node_id": "MDQ6VXNlcjExNjg5ODUw", "avatar_url": "https://avatars3.githubusercontent.com/u/11689850?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imxboards", "html_url": "https://github.com/imxboards", "followers_url": "https://api.github.com/users/imxboards/followers", "following_url": "https://api.github.com/users/imxboards/following{/other_user}", "gists_url": "https://api.github.com/users/imxboards/gists{/gist_id}", "starred_url": "https://api.github.com/users/imxboards/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imxboards/subscriptions", "organizations_url": "https://api.github.com/users/imxboards/orgs", "repos_url": "https://api.github.com/users/imxboards/repos", "events_url": "https://api.github.com/users/imxboards/events{/privacy}", "received_events_url": "https://api.github.com/users/imxboards/received_events", "type": "User", "site_admin": false}, "created_at": "2017-12-06T09:27:21Z", "updated_at": "2017-12-06T09:27:21Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=25754898\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrehentz\">@andrehentz</a> tks for you help!<br>\nI try below:<br>\npython tensorflow/examples/image_retraining/retrain.py <br>\n--image_dir /home/ubuntu/vegetables_photos/ <br>\n--output_graph /home/ubuntu/vegetables_out/vegetables.pb <br>\n--output_label /home/ubuntu/vegetables_out/labels.txt <br>\n--how_many_training_steps=60 <br>\n--architecture mobilenet_1.0_224</p>\n<p>bazel-bin/tensorflow/contrib/lite/toco/toco <br>\n--input_format=TENSORFLOW_GRAPHDEF <br>\n--input_file=/home/ubuntu/vegetables_out/vegetables.pb <br>\n--output_format=TFLITE <br>\n--output_file=/home/ubuntu/vegetables_out/mobilenet_quant_v1_224.tflite <br>\n--inference_type=FLOAT <br>\n--inference_input_type=FLOAT <br>\n--input_arrays=input <br>\n--output_arrays=final_result <br>\n--input_shapes=1,224,224,3<br>\nandroid I put the mobilenet_quant_v1_224.tflite into the TfLiteCameraDemo.apk assert dir,android run TfLiteCameraDemo.apk, but the apk throws error:<br>\nCaused by: java.lang.IllegalArgumentException: Failed to get input dimensions. 0-th input should have 602112 bytes, but found 150528 bytes.</p>\n<p>however I find then TfLiteCameraDemo.apk need quant mode,so I try below:<br>\npython tensorflow/examples/image_retraining/retrain.py <br>\n--image_dir /home/ubuntu/vegetables_photos/ <br>\n--output_graph /home/ubuntu/vegetables_out/vegetables.pb <br>\n--output_label /home/ubuntu/vegetables_out/labels.txt <br>\n--how_many_training_steps=60 <br>\n--architecture mobilenet_1.0_224_quantized</p>\n<p>bazel-bin/tensorflow/contrib/lite/toco/toco <br>\n--input_format=TENSORFLOW_GRAPHDEF <br>\n--input_file=/home/ubuntu/vegetables_out/vegetables.pb <br>\n--output_format=TFLITE <br>\n--output_file=/home/ubuntu/vegetables_out/mobilenet_quant_v1_224.tflite <br>\n--input_shapes=1,224,224,3 <br>\n--inference_type=QUANTIZED_UINT8 <br>\n--input_arrays=Placeholder <br>\n--output_arrays=final_result <br>\n--mean_values=128 <br>\n--std_values=127<br>\nthen I got the error:<br>\n017-12-06 09:21:10.165673: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub<br>\n2017-12-06 09:21:10.165698: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignAdd<br>\n2017-12-06 09:21:10.165729: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: Pow<br>\n2017-12-06 09:21:10.165757: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub<br>\n2017-12-06 09:21:10.165801: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub<br>\n2017-12-06 09:21:10.165823: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignAdd<br>\n2017-12-06 09:21:10.165853: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: Pow<br>\n2017-12-06 09:21:10.165890: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub<br>\n2017-12-06 09:21:10.219204: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 1433 operators, 2236 arrays (0 quantized)<br>\n2017-12-06 09:21:10.623803: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 401 operators, 962 arrays (1 quantized)<br>\n2017-12-06 09:21:10.630679: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 94 operators, 184 arrays (1 quantized)<br>\n2017-12-06 09:21:10.631553: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 94 operators, 184 arrays (1 quantized)<br>\n2017-12-06 09:21:10.632222: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 94 operators, 184 arrays (1 quantized)<br>\n2017-12-06 09:21:10.632392: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After pre-quantization graph transformations pass 1: 66 operators, 156 arrays (1 quantized)<br>\n2017-12-06 09:21:10.632699: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before quantization graph transformations: 66 operators, 156 arrays (1 quantized)<br>\n2017-12-06 09:21:10.671081: F tensorflow/contrib/lite/toco/graph_transformations/quantize.cc:354] Unimplemented: this graph contains an operator of type (Unsupported TensorFlow op: Pow) for which the quantized form is not yet implemented. Sorry, and patches welcome (that's a relatively fun patch to write, mostly providing the actual quantized arithmetic code for this op).<br>\nAborted (core dumped)</p>\n<p>My question is :<br>\nHow I can retrain model which like mobilenet_quant_v1_224.tflite in the TfLiteCameraDemo.apk<br>\npls help!</p>", "body_text": "@andrehentz tks for you help!\nI try below:\npython tensorflow/examples/image_retraining/retrain.py \n--image_dir /home/ubuntu/vegetables_photos/ \n--output_graph /home/ubuntu/vegetables_out/vegetables.pb \n--output_label /home/ubuntu/vegetables_out/labels.txt \n--how_many_training_steps=60 \n--architecture mobilenet_1.0_224\nbazel-bin/tensorflow/contrib/lite/toco/toco \n--input_format=TENSORFLOW_GRAPHDEF \n--input_file=/home/ubuntu/vegetables_out/vegetables.pb \n--output_format=TFLITE \n--output_file=/home/ubuntu/vegetables_out/mobilenet_quant_v1_224.tflite \n--inference_type=FLOAT \n--inference_input_type=FLOAT \n--input_arrays=input \n--output_arrays=final_result \n--input_shapes=1,224,224,3\nandroid I put the mobilenet_quant_v1_224.tflite into the TfLiteCameraDemo.apk assert dir,android run TfLiteCameraDemo.apk, but the apk throws error:\nCaused by: java.lang.IllegalArgumentException: Failed to get input dimensions. 0-th input should have 602112 bytes, but found 150528 bytes.\nhowever I find then TfLiteCameraDemo.apk need quant mode,so I try below:\npython tensorflow/examples/image_retraining/retrain.py \n--image_dir /home/ubuntu/vegetables_photos/ \n--output_graph /home/ubuntu/vegetables_out/vegetables.pb \n--output_label /home/ubuntu/vegetables_out/labels.txt \n--how_many_training_steps=60 \n--architecture mobilenet_1.0_224_quantized\nbazel-bin/tensorflow/contrib/lite/toco/toco \n--input_format=TENSORFLOW_GRAPHDEF \n--input_file=/home/ubuntu/vegetables_out/vegetables.pb \n--output_format=TFLITE \n--output_file=/home/ubuntu/vegetables_out/mobilenet_quant_v1_224.tflite \n--input_shapes=1,224,224,3 \n--inference_type=QUANTIZED_UINT8 \n--input_arrays=Placeholder \n--output_arrays=final_result \n--mean_values=128 \n--std_values=127\nthen I got the error:\n017-12-06 09:21:10.165673: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\n2017-12-06 09:21:10.165698: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignAdd\n2017-12-06 09:21:10.165729: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: Pow\n2017-12-06 09:21:10.165757: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\n2017-12-06 09:21:10.165801: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\n2017-12-06 09:21:10.165823: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignAdd\n2017-12-06 09:21:10.165853: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: Pow\n2017-12-06 09:21:10.165890: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\n2017-12-06 09:21:10.219204: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 1433 operators, 2236 arrays (0 quantized)\n2017-12-06 09:21:10.623803: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 401 operators, 962 arrays (1 quantized)\n2017-12-06 09:21:10.630679: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 94 operators, 184 arrays (1 quantized)\n2017-12-06 09:21:10.631553: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 94 operators, 184 arrays (1 quantized)\n2017-12-06 09:21:10.632222: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 94 operators, 184 arrays (1 quantized)\n2017-12-06 09:21:10.632392: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After pre-quantization graph transformations pass 1: 66 operators, 156 arrays (1 quantized)\n2017-12-06 09:21:10.632699: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before quantization graph transformations: 66 operators, 156 arrays (1 quantized)\n2017-12-06 09:21:10.671081: F tensorflow/contrib/lite/toco/graph_transformations/quantize.cc:354] Unimplemented: this graph contains an operator of type (Unsupported TensorFlow op: Pow) for which the quantized form is not yet implemented. Sorry, and patches welcome (that's a relatively fun patch to write, mostly providing the actual quantized arithmetic code for this op).\nAborted (core dumped)\nMy question is :\nHow I can retrain model which like mobilenet_quant_v1_224.tflite in the TfLiteCameraDemo.apk\npls help!", "body": "@andrehentz tks for you help!\r\nI try below:\r\npython tensorflow/examples/image_retraining/retrain.py \\\r\n    --image_dir /home/ubuntu/vegetables_photos/ \\\r\n    --output_graph /home/ubuntu/vegetables_out/vegetables.pb \\\r\n    --output_label /home/ubuntu/vegetables_out/labels.txt \\\r\n    --how_many_training_steps=60 \\\r\n    --architecture mobilenet_1.0_224\r\n\r\nbazel-bin/tensorflow/contrib/lite/toco/toco \\\r\n  --input_format=TENSORFLOW_GRAPHDEF \\\r\n  --input_file=/home/ubuntu/vegetables_out/vegetables.pb \\\r\n  --output_format=TFLITE \\\r\n  --output_file=/home/ubuntu/vegetables_out/mobilenet_quant_v1_224.tflite \\\r\n  --inference_type=FLOAT \\\r\n  --inference_input_type=FLOAT \\\r\n  --input_arrays=input \\\r\n  --output_arrays=final_result \\\r\n  --input_shapes=1,224,224,3\r\nandroid I put the mobilenet_quant_v1_224.tflite into the TfLiteCameraDemo.apk assert dir,android run TfLiteCameraDemo.apk, but the apk throws error:\r\nCaused by: java.lang.IllegalArgumentException: Failed to get input dimensions. 0-th input should have 602112 bytes, but found 150528 bytes.\r\n\r\n\r\n\r\nhowever I find then TfLiteCameraDemo.apk need quant mode,so I try below:\r\npython tensorflow/examples/image_retraining/retrain.py \\\r\n    --image_dir /home/ubuntu/vegetables_photos/ \\\r\n    --output_graph /home/ubuntu/vegetables_out/vegetables.pb \\\r\n    --output_label /home/ubuntu/vegetables_out/labels.txt \\\r\n    --how_many_training_steps=60 \\\r\n    --architecture mobilenet_1.0_224_quantized\r\n\r\nbazel-bin/tensorflow/contrib/lite/toco/toco \\\r\n  --input_format=TENSORFLOW_GRAPHDEF \\\r\n  --input_file=/home/ubuntu/vegetables_out/vegetables.pb \\\r\n  --output_format=TFLITE \\\r\n  --output_file=/home/ubuntu/vegetables_out/mobilenet_quant_v1_224.tflite \\\r\n  --input_shapes=1,224,224,3 \\\r\n  --inference_type=QUANTIZED_UINT8 \\\r\n  --input_arrays=Placeholder \\\r\n  --output_arrays=final_result \\\r\n  --mean_values=128 \\\r\n  --std_values=127\r\nthen I got the error:\r\n017-12-06 09:21:10.165673: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\r\n2017-12-06 09:21:10.165698: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignAdd\r\n2017-12-06 09:21:10.165729: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: Pow\r\n2017-12-06 09:21:10.165757: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\r\n2017-12-06 09:21:10.165801: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\r\n2017-12-06 09:21:10.165823: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignAdd\r\n2017-12-06 09:21:10.165853: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: Pow\r\n2017-12-06 09:21:10.165890: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1046] Converting unsupported operation: AssignSub\r\n2017-12-06 09:21:10.219204: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 1433 operators, 2236 arrays (0 quantized)\r\n2017-12-06 09:21:10.623803: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 401 operators, 962 arrays (1 quantized)\r\n2017-12-06 09:21:10.630679: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 94 operators, 184 arrays (1 quantized)\r\n2017-12-06 09:21:10.631553: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 94 operators, 184 arrays (1 quantized)\r\n2017-12-06 09:21:10.632222: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 94 operators, 184 arrays (1 quantized)\r\n2017-12-06 09:21:10.632392: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After pre-quantization graph transformations pass 1: 66 operators, 156 arrays (1 quantized)\r\n2017-12-06 09:21:10.632699: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before quantization graph transformations: 66 operators, 156 arrays (1 quantized)\r\n2017-12-06 09:21:10.671081: F tensorflow/contrib/lite/toco/graph_transformations/quantize.cc:354] Unimplemented: this graph contains an operator of type (Unsupported TensorFlow op: Pow) for which the quantized form is not yet implemented. Sorry, and patches welcome (that's a relatively fun patch to write, mostly providing the actual quantized arithmetic code for this op).\r\nAborted (core dumped)\r\n\r\nMy question is : \r\n How I can retrain model which like mobilenet_quant_v1_224.tflite in the TfLiteCameraDemo.apk\r\npls help! \r\n\r\n"}