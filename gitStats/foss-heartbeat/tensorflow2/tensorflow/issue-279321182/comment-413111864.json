{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/413111864", "html_url": "https://github.com/tensorflow/tensorflow/issues/15122#issuecomment-413111864", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15122", "id": 413111864, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzExMTg2NA==", "user": {"login": "gaojingwen945", "id": 9261703, "node_id": "MDQ6VXNlcjkyNjE3MDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/9261703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gaojingwen945", "html_url": "https://github.com/gaojingwen945", "followers_url": "https://api.github.com/users/gaojingwen945/followers", "following_url": "https://api.github.com/users/gaojingwen945/following{/other_user}", "gists_url": "https://api.github.com/users/gaojingwen945/gists{/gist_id}", "starred_url": "https://api.github.com/users/gaojingwen945/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gaojingwen945/subscriptions", "organizations_url": "https://api.github.com/users/gaojingwen945/orgs", "repos_url": "https://api.github.com/users/gaojingwen945/repos", "events_url": "https://api.github.com/users/gaojingwen945/events{/privacy}", "received_events_url": "https://api.github.com/users/gaojingwen945/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-15T07:00:53Z", "updated_at": "2018-08-15T07:01:36Z", "author_association": "NONE", "body_html": "<p>Update:<br>\nAnd, I retrained the mobilenet_1.0_224 model, the un-quantized version, and using toco to convert it to a QUANTIZED_UINT8 tflite file, it works, and the .tflite file is much smaller in size, which is 4.3M.<br>\nThe command I use is as follows:</p>\n<p><code>IMAGE_SIZE=224</code><br>\n<code>OUTPUT_NODE_NAME='final_result'</code><br>\n<code>INPUT_TYPE=\"QUANTIZED_UINT8\"</code><br>\n<code>INPUT_FILE=\"retrained_graph.pb\"</code><br>\n<code>toco \\ --graph_def_file=$output_dir/$INPUT_FILE \\ --output_file=$output_dir/optimized_graph.lite \\ --input_format=TENSORFLOW_GRAPHDEF \\ --output_format=TFLITE \\ --inference_type=$INPUT_TYPE \\ --inference_input_type=$INPUT_TYPE \\ --input_array=input \\ --input_shape=1,\"${IMAGE_SIZE}\",\"${IMAGE_SIZE}\",3 \\ --output_array=$OUTPUT_NODE_NAME \\ --mean_value=128 \\ --std_dev_values=128 \\ --default_ranges_min=0 \\ --default_ranges_max=6 \\ --logtostderr '--v=2'</code></p>", "body_text": "Update:\nAnd, I retrained the mobilenet_1.0_224 model, the un-quantized version, and using toco to convert it to a QUANTIZED_UINT8 tflite file, it works, and the .tflite file is much smaller in size, which is 4.3M.\nThe command I use is as follows:\nIMAGE_SIZE=224\nOUTPUT_NODE_NAME='final_result'\nINPUT_TYPE=\"QUANTIZED_UINT8\"\nINPUT_FILE=\"retrained_graph.pb\"\ntoco \\ --graph_def_file=$output_dir/$INPUT_FILE \\ --output_file=$output_dir/optimized_graph.lite \\ --input_format=TENSORFLOW_GRAPHDEF \\ --output_format=TFLITE \\ --inference_type=$INPUT_TYPE \\ --inference_input_type=$INPUT_TYPE \\ --input_array=input \\ --input_shape=1,\"${IMAGE_SIZE}\",\"${IMAGE_SIZE}\",3 \\ --output_array=$OUTPUT_NODE_NAME \\ --mean_value=128 \\ --std_dev_values=128 \\ --default_ranges_min=0 \\ --default_ranges_max=6 \\ --logtostderr '--v=2'", "body": "Update: \r\nAnd, I retrained the mobilenet_1.0_224 model, the un-quantized version, and using toco to convert it to a QUANTIZED_UINT8 tflite file, it works, and the .tflite file is much smaller in size, which is 4.3M.\r\nThe command I use is as follows:\r\n\r\n`IMAGE_SIZE=224`\r\n`OUTPUT_NODE_NAME='final_result'`\r\n`INPUT_TYPE=\"QUANTIZED_UINT8\"`\r\n`INPUT_FILE=\"retrained_graph.pb\"`\r\n`toco \\\r\n  --graph_def_file=$output_dir/$INPUT_FILE \\\r\n  --output_file=$output_dir/optimized_graph.lite \\\r\n  --input_format=TENSORFLOW_GRAPHDEF \\\r\n  --output_format=TFLITE \\\r\n  --inference_type=$INPUT_TYPE \\\r\n  --inference_input_type=$INPUT_TYPE \\\r\n  --input_array=input \\\r\n  --input_shape=1,\"${IMAGE_SIZE}\",\"${IMAGE_SIZE}\",3 \\\r\n  --output_array=$OUTPUT_NODE_NAME \\\r\n  --mean_value=128 \\\r\n  --std_dev_values=128 \\\r\n  --default_ranges_min=0 \\\r\n  --default_ranges_max=6 \\\r\n  --logtostderr '--v=2'`"}