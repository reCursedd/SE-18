{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/364940011", "html_url": "https://github.com/tensorflow/tensorflow/issues/15122#issuecomment-364940011", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15122", "id": 364940011, "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDk0MDAxMQ==", "user": {"login": "igsoft", "id": 11719351, "node_id": "MDQ6VXNlcjExNzE5MzUx", "avatar_url": "https://avatars0.githubusercontent.com/u/11719351?v=4", "gravatar_id": "", "url": "https://api.github.com/users/igsoft", "html_url": "https://github.com/igsoft", "followers_url": "https://api.github.com/users/igsoft/followers", "following_url": "https://api.github.com/users/igsoft/following{/other_user}", "gists_url": "https://api.github.com/users/igsoft/gists{/gist_id}", "starred_url": "https://api.github.com/users/igsoft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/igsoft/subscriptions", "organizations_url": "https://api.github.com/users/igsoft/orgs", "repos_url": "https://api.github.com/users/igsoft/repos", "events_url": "https://api.github.com/users/igsoft/events{/privacy}", "received_events_url": "https://api.github.com/users/igsoft/received_events", "type": "User", "site_admin": false}, "created_at": "2018-02-12T14:34:18Z", "updated_at": "2018-02-12T14:35:35Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=25754898\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrehentz\">@andrehentz</a> I'm trying to use your method but I'm not able to create the quantized.tflite. I'm using a docker with tf1.5 and in your second step with toco I received:<br>\n<code>toco --input_file=tf_files/retrained_graph.pb --input_format=TENSORFLOW_GRAPHDEF --output_format=TFLITE --output_file=tf_files/model.tflite --inference_type=QUANTIZED_UINT8 --input_array=Placeholder --output_array=final_result --input_shape=1,224,224,3 --mean_value=128 --std_value=128</code><br>\n/usr/local/lib/python2.7/dist-packages/h5py/<strong>init</strong>.py:36: FutureWarning: Conversion of the second argument of issubdtype from <code>float</code> to <code>np.floating</code> is deprecated. In future, it will be treated as <code>np.float64 == np.dtype(float).type</code>.<br>\nfrom ._conv import register_converters as _register_converters<br>\n2018-02-12 14:30:20.126646: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.126818: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.127122: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.127511: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.127633: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.128115: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.128356: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.128786: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.129454: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.129759: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize<br>\n2018-02-12 14:30:20.132161: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 145 operators, 239 arrays (0 quantized)<br>\n2018-02-12 14:30:20.134624: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 62 operators, 152 arrays (0 quantized)<br>\n2018-02-12 14:30:20.136101: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 62 operators, 153 arrays (0 quantized)<br>\n2018-02-12 14:30:20.137529: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 61 operators, 151 arrays (0 quantized)<br>\n2018-02-12 14:30:20.138834: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 61 operators, 151 arrays (0 quantized)<br>\n2018-02-12 14:30:20.139734: F tensorflow/contrib/lite/toco/tooling_util.cc:1204] Array input, which is an input to the Conv operator producing the output array MobilenetV1/MobilenetV1/Conv2d_0/Relu6, is lacking min/max data, which is necessary for quantization. Either target a non-quantized output format, or change the input graph to contain min/max information, or pass --default_ranges_min= and --default_ranges_max= if you do not care about the accuracy of results.<br>\nAborted</p>\n<p>Am I doing something wrong?</p>", "body_text": "@andrehentz I'm trying to use your method but I'm not able to create the quantized.tflite. I'm using a docker with tf1.5 and in your second step with toco I received:\ntoco --input_file=tf_files/retrained_graph.pb --input_format=TENSORFLOW_GRAPHDEF --output_format=TFLITE --output_file=tf_files/model.tflite --inference_type=QUANTIZED_UINT8 --input_array=Placeholder --output_array=final_result --input_shape=1,224,224,3 --mean_value=128 --std_value=128\n/usr/local/lib/python2.7/dist-packages/h5py/init.py:36: FutureWarning: Conversion of the second argument of issubdtype from float to np.floating is deprecated. In future, it will be treated as np.float64 == np.dtype(float).type.\nfrom ._conv import register_converters as _register_converters\n2018-02-12 14:30:20.126646: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.126818: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.127122: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.127511: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.127633: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.128115: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.128356: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.128786: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.129454: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.129759: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\n2018-02-12 14:30:20.132161: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 145 operators, 239 arrays (0 quantized)\n2018-02-12 14:30:20.134624: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 62 operators, 152 arrays (0 quantized)\n2018-02-12 14:30:20.136101: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 62 operators, 153 arrays (0 quantized)\n2018-02-12 14:30:20.137529: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 61 operators, 151 arrays (0 quantized)\n2018-02-12 14:30:20.138834: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 61 operators, 151 arrays (0 quantized)\n2018-02-12 14:30:20.139734: F tensorflow/contrib/lite/toco/tooling_util.cc:1204] Array input, which is an input to the Conv operator producing the output array MobilenetV1/MobilenetV1/Conv2d_0/Relu6, is lacking min/max data, which is necessary for quantization. Either target a non-quantized output format, or change the input graph to contain min/max information, or pass --default_ranges_min= and --default_ranges_max= if you do not care about the accuracy of results.\nAborted\nAm I doing something wrong?", "body": "@andrehentz I'm trying to use your method but I'm not able to create the quantized.tflite. I'm using a docker with tf1.5 and in your second step with toco I received:\r\n`toco --input_file=tf_files/retrained_graph.pb --input_format=TENSORFLOW_GRAPHDEF --output_format=TFLITE --output_file=tf_files/model.tflite --inference_type=QUANTIZED_UINT8 --input_array=Placeholder --output_array=final_result --input_shape=1,224,224,3 --mean_value=128 --std_value=128`\r\n/usr/local/lib/python2.7/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\n2018-02-12 14:30:20.126646: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.126818: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.127122: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.127511: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.127633: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.128115: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.128356: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.128786: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.129454: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.129759: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1057] Converting unsupported operation: Dequantize\r\n2018-02-12 14:30:20.132161: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 145 operators, 239 arrays (0 quantized)\r\n2018-02-12 14:30:20.134624: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 62 operators, 152 arrays (0 quantized)\r\n2018-02-12 14:30:20.136101: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 62 operators, 153 arrays (0 quantized)\r\n2018-02-12 14:30:20.137529: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 61 operators, 151 arrays (0 quantized)\r\n2018-02-12 14:30:20.138834: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 61 operators, 151 arrays (0 quantized)\r\n2018-02-12 14:30:20.139734: F tensorflow/contrib/lite/toco/tooling_util.cc:1204] Array input, which is an input to the Conv operator producing the output array MobilenetV1/MobilenetV1/Conv2d_0/Relu6, is lacking min/max data, which is necessary for quantization. Either target a non-quantized output format, or change the input graph to contain min/max information, or pass --default_ranges_min= and --default_ranges_max= if you do not care about the accuracy of results.\r\nAborted \r\n\r\nAm I doing something wrong?"}