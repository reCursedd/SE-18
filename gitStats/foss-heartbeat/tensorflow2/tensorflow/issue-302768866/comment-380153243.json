{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/380153243", "html_url": "https://github.com/tensorflow/tensorflow/issues/17487#issuecomment-380153243", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17487", "id": 380153243, "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDE1MzI0Mw==", "user": {"login": "ispirmustafa", "id": 19293677, "node_id": "MDQ6VXNlcjE5MjkzNjc3", "avatar_url": "https://avatars1.githubusercontent.com/u/19293677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ispirmustafa", "html_url": "https://github.com/ispirmustafa", "followers_url": "https://api.github.com/users/ispirmustafa/followers", "following_url": "https://api.github.com/users/ispirmustafa/following{/other_user}", "gists_url": "https://api.github.com/users/ispirmustafa/gists{/gist_id}", "starred_url": "https://api.github.com/users/ispirmustafa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ispirmustafa/subscriptions", "organizations_url": "https://api.github.com/users/ispirmustafa/orgs", "repos_url": "https://api.github.com/users/ispirmustafa/repos", "events_url": "https://api.github.com/users/ispirmustafa/events{/privacy}", "received_events_url": "https://api.github.com/users/ispirmustafa/received_events", "type": "User", "site_admin": false}, "created_at": "2018-04-10T15:56:36Z", "updated_at": "2018-04-10T15:56:36Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=19590686\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/sami93\">@sami93</a><br>\nI've checked your code again. You can fix this problem by using regular tensor instead of sparse tensor. categorical column should work with that. So you will replace following line:</p>\n<pre><code>categorical_cols = {k: tf.SparseTensor(\n    indices=[[i, 0] for i in range(data_set[k].size)], values=data_set[k].values, dense_shape=[data_set[k].size, 1])\nfor k in FEATURES_CAT}\n</code></pre>\n<p>with following:</p>\n<pre><code>categorical_cols = {k: tf.constant(data_set[k].values) for k in FEATURES_CAT}\n</code></pre>\n<p>Having said that I recommend using <code>pandas_input_fn</code>.<br>\nClosing this now. Please re-open it if it doesn't work.</p>", "body_text": "Hi @sami93\nI've checked your code again. You can fix this problem by using regular tensor instead of sparse tensor. categorical column should work with that. So you will replace following line:\ncategorical_cols = {k: tf.SparseTensor(\n    indices=[[i, 0] for i in range(data_set[k].size)], values=data_set[k].values, dense_shape=[data_set[k].size, 1])\nfor k in FEATURES_CAT}\n\nwith following:\ncategorical_cols = {k: tf.constant(data_set[k].values) for k in FEATURES_CAT}\n\nHaving said that I recommend using pandas_input_fn.\nClosing this now. Please re-open it if it doesn't work.", "body": "Hi @sami93 \r\nI've checked your code again. You can fix this problem by using regular tensor instead of sparse tensor. categorical column should work with that. So you will replace following line:\r\n\r\n```\r\ncategorical_cols = {k: tf.SparseTensor(\r\n    indices=[[i, 0] for i in range(data_set[k].size)], values=data_set[k].values, dense_shape=[data_set[k].size, 1])\r\nfor k in FEATURES_CAT}\r\n```\r\nwith following:\r\n```\r\ncategorical_cols = {k: tf.constant(data_set[k].values) for k in FEATURES_CAT}\r\n```\r\nHaving said that I recommend using `pandas_input_fn`.\r\nClosing this now. Please re-open it if it doesn't work.\r\n"}