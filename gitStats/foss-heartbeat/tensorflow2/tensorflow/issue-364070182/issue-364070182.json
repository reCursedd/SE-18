{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22540", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22540/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22540/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22540/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22540", "id": 364070182, "node_id": "MDU6SXNzdWUzNjQwNzAxODI=", "number": 22540, "title": "conflicting shape of tflite conv2d weight tensor shape vs conv2d documentation", "user": {"login": "jnorwood", "id": 1499591, "node_id": "MDQ6VXNlcjE0OTk1OTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1499591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jnorwood", "html_url": "https://github.com/jnorwood", "followers_url": "https://api.github.com/users/jnorwood/followers", "following_url": "https://api.github.com/users/jnorwood/following{/other_user}", "gists_url": "https://api.github.com/users/jnorwood/gists{/gist_id}", "starred_url": "https://api.github.com/users/jnorwood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jnorwood/subscriptions", "organizations_url": "https://api.github.com/users/jnorwood/orgs", "repos_url": "https://api.github.com/users/jnorwood/repos", "events_url": "https://api.github.com/users/jnorwood/events{/privacy}", "received_events_url": "https://api.github.com/users/jnorwood/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-26T14:49:04Z", "updated_at": "2018-09-27T15:42:58Z", "closed_at": "2018-09-27T15:42:58Z", "author_association": "NONE", "body_html": "<p><a href=\"https://www.tensorflow.org/api_docs/python/tf/nn/conv2d\" rel=\"nofollow\">https://www.tensorflow.org/api_docs/python/tf/nn/conv2d</a><br>\nshows that conv2d expects kernel tensor of shape [filter_height, filter_width, in_channels, out_channels]<br>\nThe mobilenet_v1_1.0_224/mobilenet_v1_1.0_224.tflite from the following link contains shape for the first conv2d of [32,3,3,3]<br>\nwhile the mobilenet_v1_1.0_224/mobilenet_v1_1.0_223_frozen.pb has conv2d tensor shape of [3,3,3,32]<br>\n<a href=\"https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.md\">https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.md</a></p>\n<p>So, since these are conflicting shapes, both going into the first conv2d, then one of them does not match the documentation kernel tensor shape.  It appears to me the .pb file matches the documentation, since HWCN is 3,3,3,32 for the first conv2d</p>\n<p>Is the .tflite format going to persist the weight tensors in a different shape than in the .pb?   If so, I don't see that documented.</p>\n<p>You can see this by downloading the netron viewer from<br>\n<a href=\"https://github.com/lutzroeder/netron\">https://github.com/lutzroeder/netron</a><br>\nand clicking on the weight tab in the first conv2d, and look at the shape in the weights node properties.<br>\nI'm using tensorflow 1.10 on ubuntu 18.04, and using netron viewer 2.1.8</p>", "body_text": "https://www.tensorflow.org/api_docs/python/tf/nn/conv2d\nshows that conv2d expects kernel tensor of shape [filter_height, filter_width, in_channels, out_channels]\nThe mobilenet_v1_1.0_224/mobilenet_v1_1.0_224.tflite from the following link contains shape for the first conv2d of [32,3,3,3]\nwhile the mobilenet_v1_1.0_224/mobilenet_v1_1.0_223_frozen.pb has conv2d tensor shape of [3,3,3,32]\nhttps://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.md\nSo, since these are conflicting shapes, both going into the first conv2d, then one of them does not match the documentation kernel tensor shape.  It appears to me the .pb file matches the documentation, since HWCN is 3,3,3,32 for the first conv2d\nIs the .tflite format going to persist the weight tensors in a different shape than in the .pb?   If so, I don't see that documented.\nYou can see this by downloading the netron viewer from\nhttps://github.com/lutzroeder/netron\nand clicking on the weight tab in the first conv2d, and look at the shape in the weights node properties.\nI'm using tensorflow 1.10 on ubuntu 18.04, and using netron viewer 2.1.8", "body": " https://www.tensorflow.org/api_docs/python/tf/nn/conv2d\r\nshows that conv2d expects kernel tensor of shape [filter_height, filter_width, in_channels, out_channels]\r\nThe mobilenet_v1_1.0_224/mobilenet_v1_1.0_224.tflite from the following link contains shape for the first conv2d of [32,3,3,3]\r\nwhile the mobilenet_v1_1.0_224/mobilenet_v1_1.0_223_frozen.pb has conv2d tensor shape of [3,3,3,32]\r\nhttps://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.md\r\n\r\nSo, since these are conflicting shapes, both going into the first conv2d, then one of them does not match the documentation kernel tensor shape.  It appears to me the .pb file matches the documentation, since HWCN is 3,3,3,32 for the first conv2d\r\n\r\nIs the .tflite format going to persist the weight tensors in a different shape than in the .pb?   If so, I don't see that documented.\r\n\r\nYou can see this by downloading the netron viewer from \r\nhttps://github.com/lutzroeder/netron\r\nand clicking on the weight tab in the first conv2d, and look at the shape in the weights node properties.\r\nI'm using tensorflow 1.10 on ubuntu 18.04, and using netron viewer 2.1.8  \r\n\r\n\r\n"}