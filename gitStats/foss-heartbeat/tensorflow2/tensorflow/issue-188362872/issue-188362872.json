{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5504", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5504/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5504/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/5504/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/5504", "id": 188362872, "node_id": "MDU6SXNzdWUxODgzNjI4NzI=", "number": 5504, "title": "Android arm64-v8a (armv8) native libs build error", "user": {"login": "kevinmost", "id": 3058312, "node_id": "MDQ6VXNlcjMwNTgzMTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/3058312?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevinmost", "html_url": "https://github.com/kevinmost", "followers_url": "https://api.github.com/users/kevinmost/followers", "following_url": "https://api.github.com/users/kevinmost/following{/other_user}", "gists_url": "https://api.github.com/users/kevinmost/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevinmost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevinmost/subscriptions", "organizations_url": "https://api.github.com/users/kevinmost/orgs", "repos_url": "https://api.github.com/users/kevinmost/repos", "events_url": "https://api.github.com/users/kevinmost/events{/privacy}", "received_events_url": "https://api.github.com/users/kevinmost/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2016-11-09T21:57:19Z", "updated_at": "2017-01-24T20:00:46Z", "closed_at": "2017-01-24T20:00:32Z", "author_association": "NONE", "body_html": "<p>Hello,</p>\n<p>I am encountering an error trying to build Tensorflow for arm64-v8a. <em>All other architectures build successfully</em>.</p>\n<p>Operating system: OS X 10.11<br>\nTensorflow repo commit: v0.11.0rc2 (tagged release)</p>\n<p>From the Tensorflow repository root directory, I run:</p>\n<pre><code>bazel build -c opt //tensorflow/examples/android:tensorflow_native_libs \\\n--crosstool_top=//external:android/crosstool \\\n--host_crosstool_top=@bazel_tools//tools/cpp:toolchain \\\n--verbose_failures \\\n--cpu=arm64-v8a\n</code></pre>\n<p>The error emitted is:</p>\n<pre lang=\"ERROR:\" data-meta=\"/Users/kevin/work/mobile-sdk/android/sdk/tensorflow/tensorflow/examples/android/BUILD:14:1: Linking of rule '//tensorflow/examples/android:libtensorflow_demo.so' failed: aarch64-linux-android-gcc failed: error executing command\"><code>  (cd /private/var/tmp/_bazel_kevin/47b9700ecb360f2f1d6606e4f92873e1/execroot/tensorflow &amp;&amp; \\\n  exec env - \\\n  external/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/aarch64-linux-android-gcc -shared -o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/libtensorflow_demo.so -Wl,-whole-archive bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/imageutils_jni.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/rgb2yuv.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/yuv2rgb.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/contrib/android/libandroid_tensorflow_inference_jni.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/kernels/libandroid_tensorflow_kernels.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib_lite.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libprotos_all_cc.a bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf.a bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf_lite.a -Wl,-no-whole-archive external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/arm64-v8a/libgnustl_static.a external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/arm64-v8a/libsupc++.a -landroid -ljnigraphics -llog -lm -z defs -s '-Wl,--icf=all' -Wl,--version-script tensorflow/contrib/android/jni/version_script.lds -lz -static-libgcc -no-canonical-prefixes '--sysroot=external/androidndk/ndk/platforms/android-21/arch-arm64'): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nexternal/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9.x/../../../../aarch64-linux-android/bin/ld: unrecognized option '--icf=all'\nexternal/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9.x/../../../../aarch64-linux-android/bin/ld: use the --help option for usage information\n</code></pre>\n<p>As stated, I have built several other architectures successfully with this method (changing the <code>cpu</code> flag to <code>armeabi-v7a</code>, <code>x86</code>, <code>x86_64</code> all build successfully).</p>\n<p>Thanks for any help! Let me know if I can provide any more info.</p>", "body_text": "Hello,\nI am encountering an error trying to build Tensorflow for arm64-v8a. All other architectures build successfully.\nOperating system: OS X 10.11\nTensorflow repo commit: v0.11.0rc2 (tagged release)\nFrom the Tensorflow repository root directory, I run:\nbazel build -c opt //tensorflow/examples/android:tensorflow_native_libs \\\n--crosstool_top=//external:android/crosstool \\\n--host_crosstool_top=@bazel_tools//tools/cpp:toolchain \\\n--verbose_failures \\\n--cpu=arm64-v8a\n\nThe error emitted is:\n  (cd /private/var/tmp/_bazel_kevin/47b9700ecb360f2f1d6606e4f92873e1/execroot/tensorflow && \\\n  exec env - \\\n  external/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/aarch64-linux-android-gcc -shared -o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/libtensorflow_demo.so -Wl,-whole-archive bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/imageutils_jni.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/rgb2yuv.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/yuv2rgb.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/contrib/android/libandroid_tensorflow_inference_jni.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/kernels/libandroid_tensorflow_kernels.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib_lite.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libprotos_all_cc.a bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf.a bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf_lite.a -Wl,-no-whole-archive external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/arm64-v8a/libgnustl_static.a external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/arm64-v8a/libsupc++.a -landroid -ljnigraphics -llog -lm -z defs -s '-Wl,--icf=all' -Wl,--version-script tensorflow/contrib/android/jni/version_script.lds -lz -static-libgcc -no-canonical-prefixes '--sysroot=external/androidndk/ndk/platforms/android-21/arch-arm64'): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\nexternal/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9.x/../../../../aarch64-linux-android/bin/ld: unrecognized option '--icf=all'\nexternal/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9.x/../../../../aarch64-linux-android/bin/ld: use the --help option for usage information\n\nAs stated, I have built several other architectures successfully with this method (changing the cpu flag to armeabi-v7a, x86, x86_64 all build successfully).\nThanks for any help! Let me know if I can provide any more info.", "body": "Hello,\r\n\r\nI am encountering an error trying to build Tensorflow for arm64-v8a. *All other architectures build successfully*.\r\n\r\nOperating system: OS X 10.11\r\nTensorflow repo commit: v0.11.0rc2 (tagged release)\r\n\r\nFrom the Tensorflow repository root directory, I run:\r\n\r\n```\r\nbazel build -c opt //tensorflow/examples/android:tensorflow_native_libs \\\r\n--crosstool_top=//external:android/crosstool \\\r\n--host_crosstool_top=@bazel_tools//tools/cpp:toolchain \\\r\n--verbose_failures \\\r\n--cpu=arm64-v8a\r\n```\r\n\r\nThe error emitted is:\r\n\r\n```ERROR: /Users/kevin/work/mobile-sdk/android/sdk/tensorflow/tensorflow/examples/android/BUILD:14:1: Linking of rule '//tensorflow/examples/android:libtensorflow_demo.so' failed: aarch64-linux-android-gcc failed: error executing command\r\n  (cd /private/var/tmp/_bazel_kevin/47b9700ecb360f2f1d6606e4f92873e1/execroot/tensorflow && \\\r\n  exec env - \\\r\n  external/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/aarch64-linux-android-gcc -shared -o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/libtensorflow_demo.so -Wl,-whole-archive bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/imageutils_jni.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/rgb2yuv.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/examples/android/_objs/libtensorflow_demo.so/tensorflow/examples/android/jni/yuv2rgb.o bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/contrib/android/libandroid_tensorflow_inference_jni.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/kernels/libandroid_tensorflow_kernels.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libandroid_tensorflow_lib_lite.lo bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/tensorflow/core/libprotos_all_cc.a bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf.a bazel-out/aarch64-linux-android-4.9-gnu-libstdcpp-opt/bin/external/protobuf/libprotobuf_lite.a -Wl,-no-whole-archive external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/arm64-v8a/libgnustl_static.a external/androidndk/ndk/sources/cxx-stl/gnu-libstdc++/4.9/libs/arm64-v8a/libsupc++.a -landroid -ljnigraphics -llog -lm -z defs -s '-Wl,--icf=all' -Wl,--version-script tensorflow/contrib/android/jni/version_script.lds -lz -static-libgcc -no-canonical-prefixes '--sysroot=external/androidndk/ndk/platforms/android-21/arch-arm64'): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\r\nexternal/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9.x/../../../../aarch64-linux-android/bin/ld: unrecognized option '--icf=all'\r\nexternal/androidndk/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9.x/../../../../aarch64-linux-android/bin/ld: use the --help option for usage information\r\n```\r\n\r\nAs stated, I have built several other architectures successfully with this method (changing the `cpu` flag to `armeabi-v7a`, `x86`, `x86_64` all build successfully).\r\n\r\nThanks for any help! Let me know if I can provide any more info."}