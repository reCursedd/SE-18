{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13861", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13861/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13861/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13861/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13861", "id": 267263340, "node_id": "MDU6SXNzdWUyNjcyNjMzNDA=", "number": 13861, "title": "Channel number of convolution output is unspecified when atrous rate > 1 ", "user": {"login": "vs-zhehangd", "id": 29877977, "node_id": "MDQ6VXNlcjI5ODc3OTc3", "avatar_url": "https://avatars1.githubusercontent.com/u/29877977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vs-zhehangd", "html_url": "https://github.com/vs-zhehangd", "followers_url": "https://api.github.com/users/vs-zhehangd/followers", "following_url": "https://api.github.com/users/vs-zhehangd/following{/other_user}", "gists_url": "https://api.github.com/users/vs-zhehangd/gists{/gist_id}", "starred_url": "https://api.github.com/users/vs-zhehangd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vs-zhehangd/subscriptions", "organizations_url": "https://api.github.com/users/vs-zhehangd/orgs", "repos_url": "https://api.github.com/users/vs-zhehangd/repos", "events_url": "https://api.github.com/users/vs-zhehangd/events{/privacy}", "received_events_url": "https://api.github.com/users/vs-zhehangd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-10-20T18:25:39Z", "updated_at": "2017-12-27T03:35:25Z", "closed_at": "2017-12-27T03:35:25Z", "author_association": "NONE", "body_html": "<p>Python 2.7<br>\nTensorflow v1.2.0-rc2-21-g12f033d and v1.3.0-rc1-2361-gd1286ab</p>\n<p>Easily reproduced by the following code:</p>\n<div class=\"highlight highlight-source-python\"><pre>x <span class=\"pl-k\">=</span> tf.placeholder(tf.float32, [<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">None</span>])\nw <span class=\"pl-k\">=</span> tf.zeros([<span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">3</span>, <span class=\"pl-c1\">10</span>, <span class=\"pl-c1\">20</span>])\ny <span class=\"pl-k\">=</span> tf.nn.convolution(x, w, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>VALID<span class=\"pl-pds\">'</span></span>, [<span class=\"pl-c1\">1</span>]<span class=\"pl-k\">*</span><span class=\"pl-c1\">2</span>, [<span class=\"pl-c1\">2</span>]<span class=\"pl-k\">*</span><span class=\"pl-c1\">2</span>, <span class=\"pl-v\">data_format</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">'</span>NCHW<span class=\"pl-pds\">'</span></span>)\n<span class=\"pl-c1\">print</span>(y)</pre></div>\n<p>The input has known channel number but unknown width and height, in NCHW format. The convolution has rate &gt;= 2. The channel number of the output <code>y</code> is obviously known, <code>(1, 20, None, None)</code> in this example, depending on the shape of <code>w</code>. However the execution result gives</p>\n<pre><code>Tensor(\"convolution/BatchToSpaceND:0\", shape=(1, ?, ?, ?), dtype=float32)\n</code></pre>\n<p>I believe this is related to the reshaping operation in the atrous convolution. The issue happens only when the spatial shape is unknown and with NCHW format. Not sure if this happens to the latest version.</p>", "body_text": "Python 2.7\nTensorflow v1.2.0-rc2-21-g12f033d and v1.3.0-rc1-2361-gd1286ab\nEasily reproduced by the following code:\nx = tf.placeholder(tf.float32, [1, 10, None, None])\nw = tf.zeros([3, 3, 10, 20])\ny = tf.nn.convolution(x, w, 'VALID', [1]*2, [2]*2, data_format='NCHW')\nprint(y)\nThe input has known channel number but unknown width and height, in NCHW format. The convolution has rate >= 2. The channel number of the output y is obviously known, (1, 20, None, None) in this example, depending on the shape of w. However the execution result gives\nTensor(\"convolution/BatchToSpaceND:0\", shape=(1, ?, ?, ?), dtype=float32)\n\nI believe this is related to the reshaping operation in the atrous convolution. The issue happens only when the spatial shape is unknown and with NCHW format. Not sure if this happens to the latest version.", "body": "Python 2.7\r\nTensorflow v1.2.0-rc2-21-g12f033d and v1.3.0-rc1-2361-gd1286ab\r\n\r\n\r\nEasily reproduced by the following code:\r\n``` Python\r\nx = tf.placeholder(tf.float32, [1, 10, None, None])\r\nw = tf.zeros([3, 3, 10, 20])\r\ny = tf.nn.convolution(x, w, 'VALID', [1]*2, [2]*2, data_format='NCHW')\r\nprint(y)\r\n```\r\nThe input has known channel number but unknown width and height, in NCHW format. The convolution has rate >= 2. The channel number of the output `y` is obviously known, `(1, 20, None, None)` in this example, depending on the shape of `w`. However the execution result gives \r\n```\r\nTensor(\"convolution/BatchToSpaceND:0\", shape=(1, ?, ?, ?), dtype=float32)\r\n```\r\nI believe this is related to the reshaping operation in the atrous convolution. The issue happens only when the spatial shape is unknown and with NCHW format. Not sure if this happens to the latest version.\r\n\r\n"}