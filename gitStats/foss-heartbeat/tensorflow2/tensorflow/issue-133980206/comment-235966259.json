{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/235966259", "html_url": "https://github.com/tensorflow/tensorflow/issues/1122#issuecomment-235966259", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1122", "id": 235966259, "node_id": "MDEyOklzc3VlQ29tbWVudDIzNTk2NjI1OQ==", "user": {"login": "papadopav", "id": 20671213, "node_id": "MDQ6VXNlcjIwNjcxMjEz", "avatar_url": "https://avatars3.githubusercontent.com/u/20671213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/papadopav", "html_url": "https://github.com/papadopav", "followers_url": "https://api.github.com/users/papadopav/followers", "following_url": "https://api.github.com/users/papadopav/following{/other_user}", "gists_url": "https://api.github.com/users/papadopav/gists{/gist_id}", "starred_url": "https://api.github.com/users/papadopav/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/papadopav/subscriptions", "organizations_url": "https://api.github.com/users/papadopav/orgs", "repos_url": "https://api.github.com/users/papadopav/repos", "events_url": "https://api.github.com/users/papadopav/events{/privacy}", "received_events_url": "https://api.github.com/users/papadopav/received_events", "type": "User", "site_admin": false}, "created_at": "2016-07-28T17:30:25Z", "updated_at": "2016-07-28T18:10:06Z", "author_association": "NONE", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=1855278\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/brando90\">@brando90</a><br>\nThe relevant part of the code is here <a href=\"https://github.com/tensorflow/tensorflow/blob/98d63de3bb2bab7c9a81f83c8ca864741399300c/tensorflow/contrib/layers/python/layers/layers.py#L227-L256\">L227-256</a>.</p>\n<p>As you will notice is there is a <code>with ops.control_dependencies</code> statement that forces the updates. I believe that for the code to be used \"right out of the box\" the default should be None.</p>\n<p>As for my comment above <a href=\"https://github.com/tensorflow/tensorflow/issues/1122#issuecomment-235433645\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1122/hovercard\">1122</a>, I figured out that   tf.get_variable_scope().reuse_variables() takes care of the issue, so  in the training phase the argument reuse of batch_norm should be None. It has to do with the statement variable_op_scope (read its documentation in tensorflow)</p>", "body_text": "@brando90\nThe relevant part of the code is here L227-256.\nAs you will notice is there is a with ops.control_dependencies statement that forces the updates. I believe that for the code to be used \"right out of the box\" the default should be None.\nAs for my comment above 1122, I figured out that   tf.get_variable_scope().reuse_variables() takes care of the issue, so  in the training phase the argument reuse of batch_norm should be None. It has to do with the statement variable_op_scope (read its documentation in tensorflow)", "body": "@brando90 \nThe relevant part of the code is here [L227-256](https://github.com/tensorflow/tensorflow/blob/98d63de3bb2bab7c9a81f83c8ca864741399300c/tensorflow/contrib/layers/python/layers/layers.py#L227-L256).\n\nAs you will notice is there is a `with ops.control_dependencies` statement that forces the updates. I believe that for the code to be used \"right out of the box\" the default should be None. \n\nAs for my comment above [1122](https://github.com/tensorflow/tensorflow/issues/1122#issuecomment-235433645), I figured out that   tf.get_variable_scope().reuse_variables() takes care of the issue, so  in the training phase the argument reuse of batch_norm should be None. It has to do with the statement variable_op_scope (read its documentation in tensorflow) \n"}