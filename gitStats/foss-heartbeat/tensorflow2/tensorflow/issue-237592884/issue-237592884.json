{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10958", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10958/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10958/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10958/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10958", "id": 237592884, "node_id": "MDU6SXNzdWUyMzc1OTI4ODQ=", "number": 10958, "title": "tf.summary.FileWriter doesn't support unicode paths.", "user": {"login": "lockywolf", "id": 2077025, "node_id": "MDQ6VXNlcjIwNzcwMjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/2077025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lockywolf", "html_url": "https://github.com/lockywolf", "followers_url": "https://api.github.com/users/lockywolf/followers", "following_url": "https://api.github.com/users/lockywolf/following{/other_user}", "gists_url": "https://api.github.com/users/lockywolf/gists{/gist_id}", "starred_url": "https://api.github.com/users/lockywolf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lockywolf/subscriptions", "organizations_url": "https://api.github.com/users/lockywolf/orgs", "repos_url": "https://api.github.com/users/lockywolf/repos", "events_url": "https://api.github.com/users/lockywolf/events{/privacy}", "received_events_url": "https://api.github.com/users/lockywolf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-06-21T16:26:51Z", "updated_at": "2018-02-09T00:17:36Z", "closed_at": "2018-02-09T00:17:35Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:</li>\n</ul>\n<p>Yes. In fact, I use code from Denny Britz's CNN tutorial:<br>\n<a href=\"https://github.com/dennybritz/cnn-text-classification-tf\">https://github.com/dennybritz/cnn-text-classification-tf</a></p>\n<p>Line 116, (<a href=\"https://github.com/dennybritz/cnn-text-classification-tf/blob/master/train.py\">https://github.com/dennybritz/cnn-text-classification-tf/blob/master/train.py</a>)</p>\n<ul>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:</li>\n</ul>\n<p>Windows 10, x86_64, locale: Russian</p>\n<ul>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>:<br>\nbinary, pip install tensorflow</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>:<br>\nb'unknown' 1.2.0</p>\n</li>\n<li>\n<p><strong>Bazel version (if compiling from source)</strong>:<br>\nn/a</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:<br>\n8.0, 5.1</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\nnvidia 970</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:</p>\n</li>\n</ul>\n<pre><code>out_dir = os.path.abspath(os.path.join(os.path.curdir, \"runs\", timestamp))\ntrain_summary_dir = os.path.join(out_dir, \"summaries\", \"train\")\ntrain_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph, flush_secs=5)\n</code></pre>\n<h3>Describe the problem</h3>\n<p>The running directory is:</p>\n<p><code>C:\\Users\\Locky\\Google \u0414\u0438\u0441\u043a\\MachineLearning\\wildml-cnn-nlp\\cnn-text-classification-tf </code><br>\nBut FileWriter writes summaries to</p>\n<p><code>C:\\Users\\Locky\\Google \u0420\u201d\u0420\u0451\u0421\u0403\u0420\u0454\\MachineLearning\\wildml-cnn-nlp\\cnn-text-classification-tf </code><br>\n\"\u0420\u201d\u0420\u0451\u0421\u0403\u0420\u0454\" doesn't make sense in Russian, and perhaps, comes from:</p>\n<pre><code>File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\summary\\writer\\event_file_writer.py\", line 70, in __init__\n    compat.as_bytes(os.path.join(self._logdir, \"events\")))\n\n</code></pre>\n<p>I suspect that 'as_bytes' corrupts the string with Russian characters. Therefore, I think, this behaviour is a bug.</p>\n<h3>Source code / logs</h3>\n<pre><code>```\n# Output directory for models and summaries\n    timestamp = str(int(time.time()))\n    out_dir = os.path.abspath(os.path.join(os.path.curdir, \"runs\", timestamp))\n    print(\"Writing to {}\\n\".format(out_dir))\n   \n    # Summaries for loss and accuracy\n    loss_summary = tf.summary.scalar(\"loss\", cnn.loss)\n    acc_summary = tf.summary.scalar(\"accuracy\", cnn.accuracy)\n\n    # Train Summaries\n    train_summary_op = tf.summary.merge([loss_summary, acc_summary, grad_summaries_merged])\n    train_summary_dir = os.path.join(out_dir, \"summaries\", \"train\")\n    train_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph, flush_secs=5)\n\n    # Dev summaries\n    dev_summary_op = tf.summary.merge([loss_summary, acc_summary])\n    dev_summary_dir = os.path.join(out_dir, \"summaries\", \"dev\")\n    dev_summary_writer = tf.summary.FileWriter(dev_summary_dir, sess.graph)\n</code></pre>\n<pre><code></code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\n\nYes. In fact, I use code from Denny Britz's CNN tutorial:\nhttps://github.com/dennybritz/cnn-text-classification-tf\nLine 116, (https://github.com/dennybritz/cnn-text-classification-tf/blob/master/train.py)\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\n\nWindows 10, x86_64, locale: Russian\n\n\nTensorFlow installed from (source or binary):\nbinary, pip install tensorflow\n\n\nTensorFlow version (use command below):\nb'unknown' 1.2.0\n\n\nBazel version (if compiling from source):\nn/a\n\n\nCUDA/cuDNN version:\n8.0, 5.1\n\n\nGPU model and memory:\nnvidia 970\n\n\nExact command to reproduce:\n\n\nout_dir = os.path.abspath(os.path.join(os.path.curdir, \"runs\", timestamp))\ntrain_summary_dir = os.path.join(out_dir, \"summaries\", \"train\")\ntrain_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph, flush_secs=5)\n\nDescribe the problem\nThe running directory is:\nC:\\Users\\Locky\\Google \u0414\u0438\u0441\u043a\\MachineLearning\\wildml-cnn-nlp\\cnn-text-classification-tf \nBut FileWriter writes summaries to\nC:\\Users\\Locky\\Google \u0420\u201d\u0420\u0451\u0421\u0403\u0420\u0454\\MachineLearning\\wildml-cnn-nlp\\cnn-text-classification-tf \n\"\u0420\u201d\u0420\u0451\u0421\u0403\u0420\u0454\" doesn't make sense in Russian, and perhaps, comes from:\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\summary\\writer\\event_file_writer.py\", line 70, in __init__\n    compat.as_bytes(os.path.join(self._logdir, \"events\")))\n\n\nI suspect that 'as_bytes' corrupts the string with Russian characters. Therefore, I think, this behaviour is a bug.\nSource code / logs\n```\n# Output directory for models and summaries\n    timestamp = str(int(time.time()))\n    out_dir = os.path.abspath(os.path.join(os.path.curdir, \"runs\", timestamp))\n    print(\"Writing to {}\\n\".format(out_dir))\n   \n    # Summaries for loss and accuracy\n    loss_summary = tf.summary.scalar(\"loss\", cnn.loss)\n    acc_summary = tf.summary.scalar(\"accuracy\", cnn.accuracy)\n\n    # Train Summaries\n    train_summary_op = tf.summary.merge([loss_summary, acc_summary, grad_summaries_merged])\n    train_summary_dir = os.path.join(out_dir, \"summaries\", \"train\")\n    train_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph, flush_secs=5)\n\n    # Dev summaries\n    dev_summary_op = tf.summary.merge([loss_summary, acc_summary])\n    dev_summary_dir = os.path.join(out_dir, \"summaries\", \"dev\")\n    dev_summary_writer = tf.summary.FileWriter(dev_summary_dir, sess.graph)", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n\r\nYes. In fact, I use code from Denny Britz's CNN tutorial: \r\nhttps://github.com/dennybritz/cnn-text-classification-tf\r\n\r\nLine 116, (https://github.com/dennybritz/cnn-text-classification-tf/blob/master/train.py)\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n\r\nWindows 10, x86_64, locale: Russian\r\n\r\n- **TensorFlow installed from (source or binary)**:\r\nbinary, pip install tensorflow\r\n- **TensorFlow version (use command below)**:\r\nb'unknown' 1.2.0\r\n\r\n- **Bazel version (if compiling from source)**:\r\nn/a\r\n- **CUDA/cuDNN version**:\r\n8.0, 5.1\r\n- **GPU model and memory**:\r\nnvidia 970\r\n- **Exact command to reproduce**:\r\n```\r\nout_dir = os.path.abspath(os.path.join(os.path.curdir, \"runs\", timestamp))\r\ntrain_summary_dir = os.path.join(out_dir, \"summaries\", \"train\")\r\ntrain_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph, flush_secs=5)\r\n```\r\n\r\n### Describe the problem\r\nThe running directory is: \r\n\r\n`C:\\Users\\Locky\\Google \u0414\u0438\u0441\u043a\\MachineLearning\\wildml-cnn-nlp\\cnn-text-classification-tf\r\n`\r\nBut FileWriter writes summaries to \r\n\r\n`C:\\Users\\Locky\\Google \u0420\u201d\u0420\u0451\u0421\u0403\u0420\u0454\\MachineLearning\\wildml-cnn-nlp\\cnn-text-classification-tf\r\n`\r\n\"\u0420\u201d\u0420\u0451\u0421\u0403\u0420\u0454\" doesn't make sense in Russian, and perhaps, comes from:\r\n\r\n```\r\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\summary\\writer\\event_file_writer.py\", line 70, in __init__\r\n    compat.as_bytes(os.path.join(self._logdir, \"events\")))\r\n\r\n```\r\nI suspect that 'as_bytes' corrupts the string with Russian characters. Therefore, I think, this behaviour is a bug.\r\n\r\n### Source code / logs\r\n\r\n    ```\r\n    # Output directory for models and summaries\r\n        timestamp = str(int(time.time()))\r\n        out_dir = os.path.abspath(os.path.join(os.path.curdir, \"runs\", timestamp))\r\n        print(\"Writing to {}\\n\".format(out_dir))\r\n       \r\n        # Summaries for loss and accuracy\r\n        loss_summary = tf.summary.scalar(\"loss\", cnn.loss)\r\n        acc_summary = tf.summary.scalar(\"accuracy\", cnn.accuracy)\r\n\r\n        # Train Summaries\r\n        train_summary_op = tf.summary.merge([loss_summary, acc_summary, grad_summaries_merged])\r\n        train_summary_dir = os.path.join(out_dir, \"summaries\", \"train\")\r\n        train_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph, flush_secs=5)\r\n\r\n        # Dev summaries\r\n        dev_summary_op = tf.summary.merge([loss_summary, acc_summary])\r\n        dev_summary_dir = os.path.join(out_dir, \"summaries\", \"dev\")\r\n        dev_summary_writer = tf.summary.FileWriter(dev_summary_dir, sess.graph)\r\n\r\n```"}