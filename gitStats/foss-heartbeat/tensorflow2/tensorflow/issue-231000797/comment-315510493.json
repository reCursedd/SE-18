{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/315510493", "html_url": "https://github.com/tensorflow/tensorflow/issues/10157#issuecomment-315510493", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10157", "id": 315510493, "node_id": "MDEyOklzc3VlQ29tbWVudDMxNTUxMDQ5Mw==", "user": {"login": "drormeir", "id": 25232145, "node_id": "MDQ6VXNlcjI1MjMyMTQ1", "avatar_url": "https://avatars2.githubusercontent.com/u/25232145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drormeir", "html_url": "https://github.com/drormeir", "followers_url": "https://api.github.com/users/drormeir/followers", "following_url": "https://api.github.com/users/drormeir/following{/other_user}", "gists_url": "https://api.github.com/users/drormeir/gists{/gist_id}", "starred_url": "https://api.github.com/users/drormeir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drormeir/subscriptions", "organizations_url": "https://api.github.com/users/drormeir/orgs", "repos_url": "https://api.github.com/users/drormeir/repos", "events_url": "https://api.github.com/users/drormeir/events{/privacy}", "received_events_url": "https://api.github.com/users/drormeir/received_events", "type": "User", "site_admin": false}, "created_at": "2017-07-15T05:10:21Z", "updated_at": "2017-07-15T05:10:21Z", "author_association": "NONE", "body_html": "<div class=\"email-fragment\">Thank you!</div>\n<span class=\"email-hidden-toggle\"><a href=\"#\">\u2026</a></span><div class=\"email-hidden-reply\">\n<div class=\"email-quoted-reply\">On Jul 14, 2017 23:57, \"Lukasz Janyst\" ***@***.***&gt; wrote:\n It is not a bug in TensorFlow; it's a problem with Eigen.\n\n When used in the MKL mode, Eigen's code defines BlasIndex to be whatever\n MKL_INT is:\n\n typedef MKL_INT BlasIndex;\n\n It is utterly confusing because the definition of MKL_INT varies\n depending on the size of indices you want to use in your program. However,\n instead of using the MKL's BLAS interface, which takes the size of MKL_INT\n into account, Eigen defines its own interface (\n <a href=\"https://bitbucket.org/eigen/eigen/src/e7027de735d6450c8ede3ce2f65166\">https://bitbucket.org/eigen/eigen/src/e7027de735d6450c8ede3ce2f65166</a>\n 714c6aef50/Eigen/src/misc/blas.h?at=default&amp;fileviewer=file-view-default)\n using only 32-bit long ints. This is the reason for the compilation errors\n you see.\n\n <a class=\"user-mention\" href=\"https://github.com/gogo40\">@gogo40</a> &lt;<a href=\"https://github.com/gogo40\">https://github.com/gogo40</a>&gt; Your patch is unnecessary if you use\n short indices (-DMKL_LP64) and makes a significant chunk of the Eigen's\n unit tests fail if you use long indices (-DMKL_ILP64\n -DEIGEN_BLAS_INDEX=int). This is because the implementation of BLAS in\n libmkl_intel_ilp64.so expects 64-bit long indices.\n\n <a class=\"user-mention\" href=\"https://github.com/drormeir\">@drormeir</a> &lt;<a href=\"https://github.com/drormeir\">https://github.com/drormeir</a>&gt; if you use -DMKL_LP64 instead of\n -DMKL_ILP64, TensorFlow will compile fine. I would not expect to see\n performance improvements though.\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n &lt;<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"231000797\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/10157\" href=\"https://github.com/tensorflow/tensorflow/issues/10157#issuecomment-315465528\">#10157 (comment)</a>&gt;,\n or mute the thread\n &lt;<a href=\"https://github.com/notifications/unsubscribe-auth/AYEDEa7uYfjj9T7CCpmXYlBFZat8h3jiks5sN9Y3gaJpZM4Nk8LC\">https://github.com/notifications/unsubscribe-auth/AYEDEa7uYfjj9T7CCpmXYlBFZat8h3jiks5sN9Y3gaJpZM4Nk8LC</a>&gt;\n .\n</div>\n<div class=\"email-fragment\"></div>\n</div>", "body_text": "Thank you!\n\u2026\nOn Jul 14, 2017 23:57, \"Lukasz Janyst\" ***@***.***> wrote:\n It is not a bug in TensorFlow; it's a problem with Eigen.\n\n When used in the MKL mode, Eigen's code defines BlasIndex to be whatever\n MKL_INT is:\n\n typedef MKL_INT BlasIndex;\n\n It is utterly confusing because the definition of MKL_INT varies\n depending on the size of indices you want to use in your program. However,\n instead of using the MKL's BLAS interface, which takes the size of MKL_INT\n into account, Eigen defines its own interface (\n https://bitbucket.org/eigen/eigen/src/e7027de735d6450c8ede3ce2f65166\n 714c6aef50/Eigen/src/misc/blas.h?at=default&fileviewer=file-view-default)\n using only 32-bit long ints. This is the reason for the compilation errors\n you see.\n\n @gogo40 <https://github.com/gogo40> Your patch is unnecessary if you use\n short indices (-DMKL_LP64) and makes a significant chunk of the Eigen's\n unit tests fail if you use long indices (-DMKL_ILP64\n -DEIGEN_BLAS_INDEX=int). This is because the implementation of BLAS in\n libmkl_intel_ilp64.so expects 64-bit long indices.\n\n @drormeir <https://github.com/drormeir> if you use -DMKL_LP64 instead of\n -DMKL_ILP64, TensorFlow will compile fine. I would not expect to see\n performance improvements though.\n\n \u2014\n You are receiving this because you were mentioned.\n Reply to this email directly, view it on GitHub\n <#10157 (comment)>,\n or mute the thread\n <https://github.com/notifications/unsubscribe-auth/AYEDEa7uYfjj9T7CCpmXYlBFZat8h3jiks5sN9Y3gaJpZM4Nk8LC>\n .", "body": "Thank you!\n\nOn Jul 14, 2017 23:57, \"Lukasz Janyst\" <notifications@github.com> wrote:\n\n> It is not a bug in TensorFlow; it's a problem with Eigen.\n>\n> When used in the MKL mode, Eigen's code defines BlasIndex to be whatever\n> MKL_INT is:\n>\n> typedef MKL_INT BlasIndex;\n>\n> It is utterly confusing because the definition of MKL_INT varies\n> depending on the size of indices you want to use in your program. However,\n> instead of using the MKL's BLAS interface, which takes the size of MKL_INT\n> into account, Eigen defines its own interface (\n> https://bitbucket.org/eigen/eigen/src/e7027de735d6450c8ede3ce2f65166\n> 714c6aef50/Eigen/src/misc/blas.h?at=default&fileviewer=file-view-default)\n> using only 32-bit long ints. This is the reason for the compilation errors\n> you see.\n>\n> @gogo40 <https://github.com/gogo40> Your patch is unnecessary if you use\n> short indices (-DMKL_LP64) and makes a significant chunk of the Eigen's\n> unit tests fail if you use long indices (-DMKL_ILP64\n> -DEIGEN_BLAS_INDEX=int). This is because the implementation of BLAS in\n> libmkl_intel_ilp64.so expects 64-bit long indices.\n>\n> @drormeir <https://github.com/drormeir> if you use -DMKL_LP64 instead of\n> -DMKL_ILP64, TensorFlow will compile fine. I would not expect to see\n> performance improvements though.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/tensorflow/tensorflow/issues/10157#issuecomment-315465528>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AYEDEa7uYfjj9T7CCpmXYlBFZat8h3jiks5sN9Y3gaJpZM4Nk8LC>\n> .\n>\n"}