{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3937", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3937/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3937/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3937/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3937", "id": 172261006, "node_id": "MDU6SXNzdWUxNzIyNjEwMDY=", "number": 3937, "title": "tf.add_check_numerics_ops() causes numeric errors for gradients of tf.pow", "user": {"login": "thjashin", "id": 5267554, "node_id": "MDQ6VXNlcjUyNjc1NTQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/5267554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thjashin", "html_url": "https://github.com/thjashin", "followers_url": "https://api.github.com/users/thjashin/followers", "following_url": "https://api.github.com/users/thjashin/following{/other_user}", "gists_url": "https://api.github.com/users/thjashin/gists{/gist_id}", "starred_url": "https://api.github.com/users/thjashin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thjashin/subscriptions", "organizations_url": "https://api.github.com/users/thjashin/orgs", "repos_url": "https://api.github.com/users/thjashin/repos", "events_url": "https://api.github.com/users/thjashin/events{/privacy}", "received_events_url": "https://api.github.com/users/thjashin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-08-20T08:35:08Z", "updated_at": "2018-06-30T08:45:09Z", "closed_at": "2016-08-22T21:27:46Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>Environment info</h3>\n<p>Operating System: Ubuntu 16.04</p>\n<p>Installed version of CUDA and cuDNN: None<br>\n(please attach the output of <code>ls -l /path/to/cuda/lib/libcud*</code>):</p>\n<p>If installed from binary pip package, provide:</p>\n<ol>\n<li>Which pip package you installed.<br>\n<a href=\"https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0rc0-cp27-none-linux_x86_64.whl\" rel=\"nofollow\"><code>https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0rc0-cp27-none-linux_x86_64.whl</code></a></li>\n<li>The output from <code>python -c \"import tensorflow; print(tensorflow.__version__)\"</code>.<br>\n<code>0.10.0rc0</code></li>\n</ol>\n<h3>Steps to reproduce</h3>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">import</span> tensorflow <span class=\"pl-k\">as</span> tf\nx <span class=\"pl-k\">=</span> tf.Variable(<span class=\"pl-c1\">0</span>.)\nx_grad <span class=\"pl-k\">=</span> tf.gradients(x<span class=\"pl-k\">**</span><span class=\"pl-c1\">2</span>, x)\ninit <span class=\"pl-k\">=</span> tf.initialize_all_variables()\ncheck_op <span class=\"pl-k\">=</span> tf.add_check_numerics_ops()\nsess <span class=\"pl-k\">=</span> tf.InteractiveSession()\nsess.run(init)\nsess.run(x_grad <span class=\"pl-k\">+</span> [check_op])\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> =&gt; InvalidArgumentError: gradients/pow_grad/Log:0 : Tensor had Inf values</span>\nsess.run(x_grad)\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> =&gt; [0.0]</span></pre></div>\n<p>My guess is that the check_op forces the two factors in <code>grad(x**2) = (e**(2log x)) * (1./x)</code> to separately evaluate. Then 1./x causes an <code>Inf</code>.</p>", "body_text": "Environment info\nOperating System: Ubuntu 16.04\nInstalled version of CUDA and cuDNN: None\n(please attach the output of ls -l /path/to/cuda/lib/libcud*):\nIf installed from binary pip package, provide:\n\nWhich pip package you installed.\nhttps://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0rc0-cp27-none-linux_x86_64.whl\nThe output from python -c \"import tensorflow; print(tensorflow.__version__)\".\n0.10.0rc0\n\nSteps to reproduce\nimport tensorflow as tf\nx = tf.Variable(0.)\nx_grad = tf.gradients(x**2, x)\ninit = tf.initialize_all_variables()\ncheck_op = tf.add_check_numerics_ops()\nsess = tf.InteractiveSession()\nsess.run(init)\nsess.run(x_grad + [check_op])\n# => InvalidArgumentError: gradients/pow_grad/Log:0 : Tensor had Inf values\nsess.run(x_grad)\n# => [0.0]\nMy guess is that the check_op forces the two factors in grad(x**2) = (e**(2log x)) * (1./x) to separately evaluate. Then 1./x causes an Inf.", "body": "### Environment info\n\nOperating System: Ubuntu 16.04\n\nInstalled version of CUDA and cuDNN: None\n(please attach the output of `ls -l /path/to/cuda/lib/libcud*`):\n\nIf installed from binary pip package, provide:\n1. Which pip package you installed.\n   [`https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0rc0-cp27-none-linux_x86_64.whl`](https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.10.0rc0-cp27-none-linux_x86_64.whl)\n2. The output from `python -c \"import tensorflow; print(tensorflow.__version__)\"`.\n   `0.10.0rc0`\n### Steps to reproduce\n\n``` python\nimport tensorflow as tf\nx = tf.Variable(0.)\nx_grad = tf.gradients(x**2, x)\ninit = tf.initialize_all_variables()\ncheck_op = tf.add_check_numerics_ops()\nsess = tf.InteractiveSession()\nsess.run(init)\nsess.run(x_grad + [check_op])\n# => InvalidArgumentError: gradients/pow_grad/Log:0 : Tensor had Inf values\nsess.run(x_grad)\n# => [0.0]\n```\n\nMy guess is that the check_op forces the two factors in `grad(x**2) = (e**(2log x)) * (1./x)` to separately evaluate. Then 1./x causes an `Inf`.\n"}