{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18523", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18523/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18523/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/18523/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/18523", "id": 314358287, "node_id": "MDU6SXNzdWUzMTQzNTgyODc=", "number": 18523, "title": "Unable to freeze graph for LinearClassifier", "user": {"login": "dkhmelenko", "id": 4306809, "node_id": "MDQ6VXNlcjQzMDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4306809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkhmelenko", "html_url": "https://github.com/dkhmelenko", "followers_url": "https://api.github.com/users/dkhmelenko/followers", "following_url": "https://api.github.com/users/dkhmelenko/following{/other_user}", "gists_url": "https://api.github.com/users/dkhmelenko/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkhmelenko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkhmelenko/subscriptions", "organizations_url": "https://api.github.com/users/dkhmelenko/orgs", "repos_url": "https://api.github.com/users/dkhmelenko/repos", "events_url": "https://api.github.com/users/dkhmelenko/events{/privacy}", "received_events_url": "https://api.github.com/users/dkhmelenko/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 24, "created_at": "2018-04-14T20:11:39Z", "updated_at": "2018-09-04T22:25:47Z", "closed_at": "2018-07-30T21:28:34Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Windows 10</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Anaconda</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.4.0</li>\n<li><strong>Python version</strong>: 3.5.4</li>\n<li><strong>Bazel version (if compiling from source)</strong>: N/A</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: N/A</li>\n<li><strong>CUDA/cuDNN version</strong>:  N/A</li>\n<li><strong>GPU model and memory</strong>:  N/A</li>\n<li><strong>Exact command to reproduce</strong>: freeze_graph for LinearClassifier model</li>\n</ul>\n<p>I'm trying to freeze my model using the source <a href=\"https://www.tensorflow.org/mobile/prepare_models\" rel=\"nofollow\">https://www.tensorflow.org/mobile/prepare_models</a>. So I could use it in Android app (using Tensorflow Mobile).<br>\nI have a model created with <code>LinearClassifier</code>. Below is the example of creating it:</p>\n<div class=\"highlight highlight-source-python\"><pre>gender <span class=\"pl-k\">=</span> tf.feature_column.categorical_column_with_vocabulary_list(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>gender<span class=\"pl-pds\">\"</span></span>, [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>m<span class=\"pl-pds\">\"</span></span>])\ngoal <span class=\"pl-k\">=</span> tf.feature_column.categorical_column_with_vocabulary_list(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>goal<span class=\"pl-pds\">\"</span></span>, [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>fit<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>lose<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>muscle<span class=\"pl-pds\">\"</span></span>])\nlevel <span class=\"pl-k\">=</span> tf.feature_column.categorical_column_with_vocabulary_list(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>level<span class=\"pl-pds\">\"</span></span>, [<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>begin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>middle<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>advance<span class=\"pl-pds\">\"</span></span>])\nfeature_columns <span class=\"pl-k\">=</span> [gender,goal,level]\n\ninput_fn <span class=\"pl-k\">=</span> tf.estimator.inputs.pandas_input_fn(<span class=\"pl-v\">x</span><span class=\"pl-k\">=</span>x_train, <span class=\"pl-v\">y</span><span class=\"pl-k\">=</span>y_train, <span class=\"pl-v\">batch_size</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">100</span>, <span class=\"pl-v\">num_epochs</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">None</span>, <span class=\"pl-v\">shuffle</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">True</span>)\nmodel <span class=\"pl-k\">=</span> tf.estimator.LinearClassifier(<span class=\"pl-v\">feature_columns</span><span class=\"pl-k\">=</span>feature_columns, <span class=\"pl-v\">n_classes</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">18</span>, <span class=\"pl-v\">model_dir</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>export<span class=\"pl-pds\">\"</span></span>)\n\nmodel.train(<span class=\"pl-v\">input_fn</span><span class=\"pl-k\">=</span>input_fn, <span class=\"pl-v\">steps</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">100</span>)</pre></div>\n<p>The model is successfully created and saved. It works correctly when it's evaluated.<br>\nHowever, I'm getting the following error, when I try to freeze the graph:</p>\n<pre><code>TypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor(\"linear/linear_model/bias_weights:0\", shape=(18,), dtype=float32)\n</code></pre>\n<p>I looked on <a href=\"https://stackoverflow.com/search?q=names_to_saveables+must+be+a+dict+\" rel=\"nofollow\">StackOverflow</a> and seems this issue happens to many people and there is no answer to that.</p>\n<p>I would appreciate any help, because many people are having similar issue.</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\nTensorFlow installed from (source or binary): Anaconda\nTensorFlow version (use command below): 1.4.0\nPython version: 3.5.4\nBazel version (if compiling from source): N/A\nGCC/Compiler version (if compiling from source): N/A\nCUDA/cuDNN version:  N/A\nGPU model and memory:  N/A\nExact command to reproduce: freeze_graph for LinearClassifier model\n\nI'm trying to freeze my model using the source https://www.tensorflow.org/mobile/prepare_models. So I could use it in Android app (using Tensorflow Mobile).\nI have a model created with LinearClassifier. Below is the example of creating it:\ngender = tf.feature_column.categorical_column_with_vocabulary_list(\"gender\", [\"f\", \"m\"])\ngoal = tf.feature_column.categorical_column_with_vocabulary_list(\"goal\", [\"fit\", \"lose\", \"muscle\"])\nlevel = tf.feature_column.categorical_column_with_vocabulary_list(\"level\", [\"begin\", \"middle\", \"advance\"])\nfeature_columns = [gender,goal,level]\n\ninput_fn = tf.estimator.inputs.pandas_input_fn(x=x_train, y=y_train, batch_size=100, num_epochs=None, shuffle=True)\nmodel = tf.estimator.LinearClassifier(feature_columns=feature_columns, n_classes=18, model_dir=\"export\")\n\nmodel.train(input_fn=input_fn, steps=100)\nThe model is successfully created and saved. It works correctly when it's evaluated.\nHowever, I'm getting the following error, when I try to freeze the graph:\nTypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor(\"linear/linear_model/bias_weights:0\", shape=(18,), dtype=float32)\n\nI looked on StackOverflow and seems this issue happens to many people and there is no answer to that.\nI would appreciate any help, because many people are having similar issue.", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10\r\n- **TensorFlow installed from (source or binary)**: Anaconda\r\n- **TensorFlow version (use command below)**: 1.4.0\r\n- **Python version**: 3.5.4\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**:  N/A\r\n- **GPU model and memory**:  N/A\r\n- **Exact command to reproduce**: freeze_graph for LinearClassifier model\r\n\r\nI'm trying to freeze my model using the source https://www.tensorflow.org/mobile/prepare_models. So I could use it in Android app (using Tensorflow Mobile).\r\nI have a model created with `LinearClassifier`. Below is the example of creating it:\r\n\r\n```python\r\ngender = tf.feature_column.categorical_column_with_vocabulary_list(\"gender\", [\"f\", \"m\"])\r\ngoal = tf.feature_column.categorical_column_with_vocabulary_list(\"goal\", [\"fit\", \"lose\", \"muscle\"])\r\nlevel = tf.feature_column.categorical_column_with_vocabulary_list(\"level\", [\"begin\", \"middle\", \"advance\"])\r\nfeature_columns = [gender,goal,level]\r\n\r\ninput_fn = tf.estimator.inputs.pandas_input_fn(x=x_train, y=y_train, batch_size=100, num_epochs=None, shuffle=True)\r\nmodel = tf.estimator.LinearClassifier(feature_columns=feature_columns, n_classes=18, model_dir=\"export\")\r\n\r\nmodel.train(input_fn=input_fn, steps=100)\r\n```\r\nThe model is successfully created and saved. It works correctly when it's evaluated.\r\nHowever, I'm getting the following error, when I try to freeze the graph:\r\n```\r\nTypeError: names_to_saveables must be a dict mapping string names to Tensors/Variables. Not a variable: Tensor(\"linear/linear_model/bias_weights:0\", shape=(18,), dtype=float32)\r\n```\r\n\r\nI looked on [StackOverflow](https://stackoverflow.com/search?q=names_to_saveables+must+be+a+dict+) and seems this issue happens to many people and there is no answer to that.\r\n\r\nI would appreciate any help, because many people are having similar issue."}