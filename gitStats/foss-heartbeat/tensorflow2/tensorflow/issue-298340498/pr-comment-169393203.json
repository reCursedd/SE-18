{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/169393203", "pull_request_review_id": 97912829, "id": 169393203, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2OTM5MzIwMw==", "diff_hunk": "@@ -71,12 +73,32 @@ def __init__(self,\n     self.input_statistics_generator = input_statistics_generator\n     self._name = name\n \n-  def _train_ops(self, features):\n-    \"\"\"Add training ops to the graph.\"\"\"\n-    with variable_scope.variable_scope(\"model\"):\n+  @property\n+  def name(self):\n+    return self._name\n+\n+  # TODO(terrytangyuan): consolidate `model_outputs` and `_Head.LossSpec`\n+  # once `_Head.create_loss` becomes extendable\n+  def create_loss(self, features, mode, logits=None, labels=None):\n+    \"\"\"See `_Head`.\"\"\"\n+    with variable_scope.variable_scope(\n+        \"model\", reuse=variable_scope.AUTO_REUSE):", "path": "tensorflow/contrib/timeseries/python/timeseries/head.py", "position": null, "original_position": 32, "commit_id": "422dcdacc46d3319baf0c87b25b47da0550a78b1", "original_commit_id": "7193af53a38017df9b617be60c4f44414b73bcb4", "user": {"login": "terrytangyuan", "id": 4269898, "node_id": "MDQ6VXNlcjQyNjk4OTg=", "avatar_url": "https://avatars3.githubusercontent.com/u/4269898?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terrytangyuan", "html_url": "https://github.com/terrytangyuan", "followers_url": "https://api.github.com/users/terrytangyuan/followers", "following_url": "https://api.github.com/users/terrytangyuan/following{/other_user}", "gists_url": "https://api.github.com/users/terrytangyuan/gists{/gist_id}", "starred_url": "https://api.github.com/users/terrytangyuan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terrytangyuan/subscriptions", "organizations_url": "https://api.github.com/users/terrytangyuan/orgs", "repos_url": "https://api.github.com/users/terrytangyuan/repos", "events_url": "https://api.github.com/users/terrytangyuan/events{/privacy}", "received_events_url": "https://api.github.com/users/terrytangyuan/received_events", "type": "User", "site_admin": false}, "body": "I think so but please help double check - if I remove it, I will get:\r\n```\r\nValueError: Variable model/state_update_step/exogenous_noise_increasing_mean/fully_connected/weights already exists, disallowed. Did you mean to set reuse=True or reuse=tf.AUTO_REUSE in VarScope\r\n```\r\nThis is because we calculated predictions using the same variable scope before we calculate the loss:\r\n```\r\nwith variable_scope.variable_scope(\"model\"):\r\n      prediction_outputs = self.model.predict(features=features)\r\n```\r\nNote that originally we had `reuse=True`. ", "created_at": "2018-02-20T17:16:39Z", "updated_at": "2018-02-20T18:47:01Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/17134#discussion_r169393203", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17134", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/169393203"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/17134#discussion_r169393203"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17134"}}, "body_html": "<p>I think so but please help double check - if I remove it, I will get:</p>\n<pre><code>ValueError: Variable model/state_update_step/exogenous_noise_increasing_mean/fully_connected/weights already exists, disallowed. Did you mean to set reuse=True or reuse=tf.AUTO_REUSE in VarScope\n</code></pre>\n<p>This is because we calculated predictions using the same variable scope before we calculate the loss:</p>\n<pre><code>with variable_scope.variable_scope(\"model\"):\n      prediction_outputs = self.model.predict(features=features)\n</code></pre>\n<p>Note that originally we had <code>reuse=True</code>.</p>", "body_text": "I think so but please help double check - if I remove it, I will get:\nValueError: Variable model/state_update_step/exogenous_noise_increasing_mean/fully_connected/weights already exists, disallowed. Did you mean to set reuse=True or reuse=tf.AUTO_REUSE in VarScope\n\nThis is because we calculated predictions using the same variable scope before we calculate the loss:\nwith variable_scope.variable_scope(\"model\"):\n      prediction_outputs = self.model.predict(features=features)\n\nNote that originally we had reuse=True.", "in_reply_to_id": 169388505}