{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4147", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4147/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4147/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4147/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4147", "id": 174470174, "node_id": "MDU6SXNzdWUxNzQ0NzAxNzQ=", "number": 4147, "title": "`math_grad._ProdGrad` fails to handle cases where reduction_indices is scalar", "user": {"login": "gaohuazuo", "id": 10446514, "node_id": "MDQ6VXNlcjEwNDQ2NTE0", "avatar_url": "https://avatars0.githubusercontent.com/u/10446514?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gaohuazuo", "html_url": "https://github.com/gaohuazuo", "followers_url": "https://api.github.com/users/gaohuazuo/followers", "following_url": "https://api.github.com/users/gaohuazuo/following{/other_user}", "gists_url": "https://api.github.com/users/gaohuazuo/gists{/gist_id}", "starred_url": "https://api.github.com/users/gaohuazuo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gaohuazuo/subscriptions", "organizations_url": "https://api.github.com/users/gaohuazuo/orgs", "repos_url": "https://api.github.com/users/gaohuazuo/repos", "events_url": "https://api.github.com/users/gaohuazuo/events{/privacy}", "received_events_url": "https://api.github.com/users/gaohuazuo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-09-01T08:53:57Z", "updated_at": "2016-09-01T15:47:44Z", "closed_at": "2016-09-01T15:47:44Z", "author_association": "CONTRIBUTOR", "body_html": "<pre><code>x = tf.zeros([10])\ntf.gradients(tf.reduce_prod(x, 0), [x])\n</code></pre>\n<p>Gives</p>\n<pre><code>more traceback\n\n/home/***/.local/lib/python2.7/site-packages/tensorflow/python/ops/math_grad.pyc in _ProdGrad(op, grad)\n    128   reduced = math_ops.cast(op.inputs[1], dtypes.int32)\n    129   idx = math_ops.range(0, array_ops.rank(op.inputs[0]))\n--&gt; 130   other, _ = array_ops.listdiff(idx, reduced)\n    131   perm = array_ops.concat(0, [reduced, other])\n    132   reduced_num = math_ops.reduce_prod(array_ops.gather(input_shape, reduced))\n\nmore traceback\n</code></pre>\n<p>In line 128, <code>op.inputs[1]</code> could be a scalar, which will cause a shape mismatch when passed to <code>array_ops.listdiff</code> in line 130.</p>\n<p>TF version: master branch a week ago</p>", "body_text": "x = tf.zeros([10])\ntf.gradients(tf.reduce_prod(x, 0), [x])\n\nGives\nmore traceback\n\n/home/***/.local/lib/python2.7/site-packages/tensorflow/python/ops/math_grad.pyc in _ProdGrad(op, grad)\n    128   reduced = math_ops.cast(op.inputs[1], dtypes.int32)\n    129   idx = math_ops.range(0, array_ops.rank(op.inputs[0]))\n--> 130   other, _ = array_ops.listdiff(idx, reduced)\n    131   perm = array_ops.concat(0, [reduced, other])\n    132   reduced_num = math_ops.reduce_prod(array_ops.gather(input_shape, reduced))\n\nmore traceback\n\nIn line 128, op.inputs[1] could be a scalar, which will cause a shape mismatch when passed to array_ops.listdiff in line 130.\nTF version: master branch a week ago", "body": "```\nx = tf.zeros([10])\ntf.gradients(tf.reduce_prod(x, 0), [x])\n```\n\nGives\n\n```\nmore traceback\n\n/home/***/.local/lib/python2.7/site-packages/tensorflow/python/ops/math_grad.pyc in _ProdGrad(op, grad)\n    128   reduced = math_ops.cast(op.inputs[1], dtypes.int32)\n    129   idx = math_ops.range(0, array_ops.rank(op.inputs[0]))\n--> 130   other, _ = array_ops.listdiff(idx, reduced)\n    131   perm = array_ops.concat(0, [reduced, other])\n    132   reduced_num = math_ops.reduce_prod(array_ops.gather(input_shape, reduced))\n\nmore traceback\n```\n\nIn line 128, `op.inputs[1]` could be a scalar, which will cause a shape mismatch when passed to `array_ops.listdiff` in line 130.\n\nTF version: master branch a week ago\n"}