{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/372552174", "html_url": "https://github.com/tensorflow/tensorflow/issues/17437#issuecomment-372552174", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17437", "id": 372552174, "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjU1MjE3NA==", "user": {"login": "wei-v-wang", "id": 22306846, "node_id": "MDQ6VXNlcjIyMzA2ODQ2", "avatar_url": "https://avatars3.githubusercontent.com/u/22306846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wei-v-wang", "html_url": "https://github.com/wei-v-wang", "followers_url": "https://api.github.com/users/wei-v-wang/followers", "following_url": "https://api.github.com/users/wei-v-wang/following{/other_user}", "gists_url": "https://api.github.com/users/wei-v-wang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wei-v-wang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wei-v-wang/subscriptions", "organizations_url": "https://api.github.com/users/wei-v-wang/orgs", "repos_url": "https://api.github.com/users/wei-v-wang/repos", "events_url": "https://api.github.com/users/wei-v-wang/events{/privacy}", "received_events_url": "https://api.github.com/users/wei-v-wang/received_events", "type": "User", "site_admin": false}, "created_at": "2018-03-13T05:33:36Z", "updated_at": "2018-03-13T05:34:48Z", "author_association": "NONE", "body_html": "<p>Can you please try the patch below?</p>\n<p>--- a/tensorflow/contrib/mpi_collectives/BUILD<br>\n+++ b/tensorflow/contrib/mpi_collectives/BUILD<br>\n@@ -53,6 +53,7 @@ tf_custom_op_library(<br>\n\":mpi_defines\",<br>\n\":mpi_message_proto_cc\",<br>\n\"//third_party/mpi\",<br>\n(+)        \"//tensorflow/stream_executor\",<br>\n],<br>\n)</p>\n<p>diff --git a/tensorflow/tensorflow.bzl b/tensorflow/tensorflow.bzl<br>\nindex 23d11c88ed..12512ae6df 100644<br>\n--- a/tensorflow/tensorflow.bzl<br>\n+++ b/tensorflow/tensorflow.bzl<br>\n@@ -1247,7 +1247,7 @@ def tf_custom_op_library(name, srcs=[], gpu_srcs=[], deps=[], linkopts=[]):<br>\ndeps=deps + if_cuda(cuda_deps),<br>\ndisallowed_deps=[<br>\nclean_dep(\"//tensorflow/core:framework\"),<br>\n(-)          clean_dep(\"//tensorflow/core:lib\")<br>\n(+)#          clean_dep(\"//tensorflow/core:lib\")<br>\n])<br>\ntf_cc_shared_object(<br>\nname=name,</p>\n<p>Credit goes to <a href=\"https://github.com/aburden5\">https://github.com/aburden5</a> in the comments of a similar issue: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"215627553\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/baidu-research/tensorflow-allreduce/issues/5\" data-hovercard-type=\"issue\" data-hovercard-url=\"/baidu-research/tensorflow-allreduce/issues/5/hovercard\" href=\"https://github.com/baidu-research/tensorflow-allreduce/issues/5\">baidu-research/tensorflow-allreduce#5</a></p>", "body_text": "Can you please try the patch below?\n--- a/tensorflow/contrib/mpi_collectives/BUILD\n+++ b/tensorflow/contrib/mpi_collectives/BUILD\n@@ -53,6 +53,7 @@ tf_custom_op_library(\n\":mpi_defines\",\n\":mpi_message_proto_cc\",\n\"//third_party/mpi\",\n(+)        \"//tensorflow/stream_executor\",\n],\n)\ndiff --git a/tensorflow/tensorflow.bzl b/tensorflow/tensorflow.bzl\nindex 23d11c88ed..12512ae6df 100644\n--- a/tensorflow/tensorflow.bzl\n+++ b/tensorflow/tensorflow.bzl\n@@ -1247,7 +1247,7 @@ def tf_custom_op_library(name, srcs=[], gpu_srcs=[], deps=[], linkopts=[]):\ndeps=deps + if_cuda(cuda_deps),\ndisallowed_deps=[\nclean_dep(\"//tensorflow/core:framework\"),\n(-)          clean_dep(\"//tensorflow/core:lib\")\n(+)#          clean_dep(\"//tensorflow/core:lib\")\n])\ntf_cc_shared_object(\nname=name,\nCredit goes to https://github.com/aburden5 in the comments of a similar issue: baidu-research/tensorflow-allreduce#5", "body": "Can you please try the patch below?\r\n\r\n--- a/tensorflow/contrib/mpi_collectives/BUILD\r\n+++ b/tensorflow/contrib/mpi_collectives/BUILD\r\n@@ -53,6 +53,7 @@ tf_custom_op_library(\r\n         \":mpi_defines\",\r\n         \":mpi_message_proto_cc\",\r\n         \"//third_party/mpi\",\r\n(+)        \"//tensorflow/stream_executor\",\r\n     ],\r\n )\r\n \r\ndiff --git a/tensorflow/tensorflow.bzl b/tensorflow/tensorflow.bzl\r\nindex 23d11c88ed..12512ae6df 100644\r\n--- a/tensorflow/tensorflow.bzl\r\n+++ b/tensorflow/tensorflow.bzl\r\n@@ -1247,7 +1247,7 @@ def tf_custom_op_library(name, srcs=[], gpu_srcs=[], deps=[], linkopts=[]):\r\n       deps=deps + if_cuda(cuda_deps),\r\n       disallowed_deps=[\r\n           clean_dep(\"//tensorflow/core:framework\"),\r\n(-)          clean_dep(\"//tensorflow/core:lib\")\r\n(+)#          clean_dep(\"//tensorflow/core:lib\")\r\n       ])\r\n   tf_cc_shared_object(\r\n       name=name,\r\n\r\n\r\nCredit goes to https://github.com/aburden5 in the comments of a similar issue: https://github.com/baidu-research/tensorflow-allreduce/issues/5 \r\n"}