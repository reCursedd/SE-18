{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14108", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14108/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14108/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14108/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14108", "id": 269752364, "node_id": "MDU6SXNzdWUyNjk3NTIzNjQ=", "number": 14108, "title": "Custom OP Reader AttributeError: 'module' object has no attribute 'read'", "user": {"login": "dnel38", "id": 32913846, "node_id": "MDQ6VXNlcjMyOTEzODQ2", "avatar_url": "https://avatars2.githubusercontent.com/u/32913846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dnel38", "html_url": "https://github.com/dnel38", "followers_url": "https://api.github.com/users/dnel38/followers", "following_url": "https://api.github.com/users/dnel38/following{/other_user}", "gists_url": "https://api.github.com/users/dnel38/gists{/gist_id}", "starred_url": "https://api.github.com/users/dnel38/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dnel38/subscriptions", "organizations_url": "https://api.github.com/users/dnel38/orgs", "repos_url": "https://api.github.com/users/dnel38/repos", "events_url": "https://api.github.com/users/dnel38/events{/privacy}", "received_events_url": "https://api.github.com/users/dnel38/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-10-30T21:00:02Z", "updated_at": "2017-10-31T05:01:08Z", "closed_at": "2017-10-31T05:01:08Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>:<br>\nCustom Code</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nLinux Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>:<br>\nSource</li>\n<li><strong>TensorFlow version (use command below)</strong>:<br>\n1.4.0</li>\n<li><strong>Python version</strong>:<br>\n2.7</li>\n<li><strong>Bazel version (if compiling from source)</strong>:<br>\n0.6.1</li>\n<li><strong>CUDA/cuDNN version</strong>:<br>\nLaptop CPU</li>\n<li><strong>GPU model and memory</strong>:<br>\nLaptop CPU</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<pre><code>import tensorflow as tf\nfilename_queue = tf.train.string_input_producer([\"test.csv\"])\nreader = tf.load_op_library('./tensorflow/bazel-bin/tensorflow/core/user_ops/redis_reader.so')\nkey, value = reader.read(filename_queue) \n</code></pre>\n<h3>Describe the problem</h3>\n<p>For my custom op reader, I am getting <code>AttributeError: 'module' object has no attribute 'read'</code>. This is most puzzling to me because I thought the python wrapper would inherit <code>read</code> from <code>/tensorflow/python/ops/io_ops.py</code>. Furthermore, <code>gen_user_ops.py</code> in my bazel-genfiles doesn't seem to have code that reflects my custom op reader. Is it suppose to show in that file?</p>\n<h3>Source code / logs</h3>\n<p>Here I have registed the OP:</p>\n<pre><code>REGISTER_OP(\"RedisReader\")\n    .Output(\"reader_handle: resource\")                            \n    .Attr(\"container: string = ''\")                               \n    .Attr(\"shared_name: string = ''\")                             \n    .SetIsStateful()                                              \n    .SetShapeFn(TwoElementOutput)\n    .Doc(R\"doc(Description Goes Here)doc\");\n</code></pre>\n<p>Here is my kernel and kernel registration:</p>\n<pre><code>class RedisReaderOp : public ReaderOpKernel {\n    public:\n        explicit RedisReaderOp(OpKernelConstruction* context) : ReaderOpKernel(context) {\n            \n            Env* env = context-&gt;env();\n\n            SetReaderFactory([this, env]() {\n                return new RedisReader(name(), env);\n            });\n        }\n};\n\nREGISTER_KERNEL_BUILDER(Name(\"RedisReader\").Device(DEVICE_CPU), RedisReaderOp);\n</code></pre>\n<p>And here is my python wrapper located in <code>user_ops.py</code>:</p>\n<pre><code>from tensorflow.python.ops import gen_user_ops as _gen_user_ops\n\n# go/tf-wildcard-import\nfrom tensorflow.python.ops.gen_user_ops import *  # pylint: disable=wildcard-import\n\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.ops import common_shapes\nfrom tensorflow.python.ops import io_ops\n\nclass RedisReader(io_ops.ReaderBase) :\n\n\tdef __init__(self, name=None):\n        \trr = _gen_user_ops.redis_reader(name=name)\n        \tsuper(RedisReader, self).__init__(rr)\t\n\nops.NotDifferentiable(\"RedisReader\")\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\nCustom Code\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nLinux Ubuntu 16.04\nTensorFlow installed from (source or binary):\nSource\nTensorFlow version (use command below):\n1.4.0\nPython version:\n2.7\nBazel version (if compiling from source):\n0.6.1\nCUDA/cuDNN version:\nLaptop CPU\nGPU model and memory:\nLaptop CPU\nExact command to reproduce:\n\nimport tensorflow as tf\nfilename_queue = tf.train.string_input_producer([\"test.csv\"])\nreader = tf.load_op_library('./tensorflow/bazel-bin/tensorflow/core/user_ops/redis_reader.so')\nkey, value = reader.read(filename_queue) \n\nDescribe the problem\nFor my custom op reader, I am getting AttributeError: 'module' object has no attribute 'read'. This is most puzzling to me because I thought the python wrapper would inherit read from /tensorflow/python/ops/io_ops.py. Furthermore, gen_user_ops.py in my bazel-genfiles doesn't seem to have code that reflects my custom op reader. Is it suppose to show in that file?\nSource code / logs\nHere I have registed the OP:\nREGISTER_OP(\"RedisReader\")\n    .Output(\"reader_handle: resource\")                            \n    .Attr(\"container: string = ''\")                               \n    .Attr(\"shared_name: string = ''\")                             \n    .SetIsStateful()                                              \n    .SetShapeFn(TwoElementOutput)\n    .Doc(R\"doc(Description Goes Here)doc\");\n\nHere is my kernel and kernel registration:\nclass RedisReaderOp : public ReaderOpKernel {\n    public:\n        explicit RedisReaderOp(OpKernelConstruction* context) : ReaderOpKernel(context) {\n            \n            Env* env = context->env();\n\n            SetReaderFactory([this, env]() {\n                return new RedisReader(name(), env);\n            });\n        }\n};\n\nREGISTER_KERNEL_BUILDER(Name(\"RedisReader\").Device(DEVICE_CPU), RedisReaderOp);\n\nAnd here is my python wrapper located in user_ops.py:\nfrom tensorflow.python.ops import gen_user_ops as _gen_user_ops\n\n# go/tf-wildcard-import\nfrom tensorflow.python.ops.gen_user_ops import *  # pylint: disable=wildcard-import\n\nfrom tensorflow.python.framework import ops\nfrom tensorflow.python.ops import common_shapes\nfrom tensorflow.python.ops import io_ops\n\nclass RedisReader(io_ops.ReaderBase) :\n\n\tdef __init__(self, name=None):\n        \trr = _gen_user_ops.redis_reader(name=name)\n        \tsuper(RedisReader, self).__init__(rr)\t\n\nops.NotDifferentiable(\"RedisReader\")", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nCustom Code\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nLinux Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**:\r\nSource\r\n- **TensorFlow version (use command below)**:\r\n1.4.0\r\n- **Python version**: \r\n2.7\r\n- **Bazel version (if compiling from source)**:\r\n0.6.1\r\n- **CUDA/cuDNN version**:\r\nLaptop CPU\r\n- **GPU model and memory**:\r\nLaptop CPU\r\n- **Exact command to reproduce**:\r\n```\r\nimport tensorflow as tf\r\nfilename_queue = tf.train.string_input_producer([\"test.csv\"])\r\nreader = tf.load_op_library('./tensorflow/bazel-bin/tensorflow/core/user_ops/redis_reader.so')\r\nkey, value = reader.read(filename_queue) \r\n```\r\n\r\n### Describe the problem\r\nFor my custom op reader, I am getting `AttributeError: 'module' object has no attribute 'read'`. This is most puzzling to me because I thought the python wrapper would inherit `read` from `/tensorflow/python/ops/io_ops.py`. Furthermore, `gen_user_ops.py` in my bazel-genfiles doesn't seem to have code that reflects my custom op reader. Is it suppose to show in that file? \r\n\r\n### Source code / logs\r\nHere I have registed the OP:\r\n\r\n```\r\nREGISTER_OP(\"RedisReader\")\r\n    .Output(\"reader_handle: resource\")                            \r\n    .Attr(\"container: string = ''\")                               \r\n    .Attr(\"shared_name: string = ''\")                             \r\n    .SetIsStateful()                                              \r\n    .SetShapeFn(TwoElementOutput)\r\n    .Doc(R\"doc(Description Goes Here)doc\");\r\n```\r\n\r\nHere is my kernel and kernel registration:\r\n\r\n```\r\nclass RedisReaderOp : public ReaderOpKernel {\r\n    public:\r\n        explicit RedisReaderOp(OpKernelConstruction* context) : ReaderOpKernel(context) {\r\n            \r\n            Env* env = context->env();\r\n\r\n            SetReaderFactory([this, env]() {\r\n                return new RedisReader(name(), env);\r\n            });\r\n        }\r\n};\r\n\r\nREGISTER_KERNEL_BUILDER(Name(\"RedisReader\").Device(DEVICE_CPU), RedisReaderOp);\r\n```\r\n\r\nAnd here is my python wrapper located in `user_ops.py`:\r\n\r\n```\r\nfrom tensorflow.python.ops import gen_user_ops as _gen_user_ops\r\n\r\n# go/tf-wildcard-import\r\nfrom tensorflow.python.ops.gen_user_ops import *  # pylint: disable=wildcard-import\r\n\r\nfrom tensorflow.python.framework import ops\r\nfrom tensorflow.python.ops import common_shapes\r\nfrom tensorflow.python.ops import io_ops\r\n\r\nclass RedisReader(io_ops.ReaderBase) :\r\n\r\n\tdef __init__(self, name=None):\r\n        \trr = _gen_user_ops.redis_reader(name=name)\r\n        \tsuper(RedisReader, self).__init__(rr)\t\r\n\r\nops.NotDifferentiable(\"RedisReader\")\r\n```"}