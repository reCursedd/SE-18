{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/200734691", "html_url": "https://github.com/tensorflow/tensorflow/issues/1029#issuecomment-200734691", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1029", "id": 200734691, "node_id": "MDEyOklzc3VlQ29tbWVudDIwMDczNDY5MQ==", "user": {"login": "fayeshine", "id": 11470826, "node_id": "MDQ6VXNlcjExNDcwODI2", "avatar_url": "https://avatars0.githubusercontent.com/u/11470826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fayeshine", "html_url": "https://github.com/fayeshine", "followers_url": "https://api.github.com/users/fayeshine/followers", "following_url": "https://api.github.com/users/fayeshine/following{/other_user}", "gists_url": "https://api.github.com/users/fayeshine/gists{/gist_id}", "starred_url": "https://api.github.com/users/fayeshine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fayeshine/subscriptions", "organizations_url": "https://api.github.com/users/fayeshine/orgs", "repos_url": "https://api.github.com/users/fayeshine/repos", "events_url": "https://api.github.com/users/fayeshine/events{/privacy}", "received_events_url": "https://api.github.com/users/fayeshine/received_events", "type": "User", "site_admin": false}, "created_at": "2016-03-24T08:37:39Z", "updated_at": "2016-03-25T00:23:05Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=70511\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/girving\">@girving</a> I tried to use tf.placeholder with no shape, however I still cannot reproduce this bug.</p>\n<pre><code>from tensorflow.examples.tutorials.mnist import input_data\nmnist = input_data.read_data_sets('MNIST_data', one_hot=True)\nimport tensorflow as tf\nsess = tf.InteractiveSession()\nimport matplotlib.pyplot as plt\narr = mnist.train.images[:10].reshape([10,28,28,1])\nplt.imshow(arr[5,:,:,0])\n\n#images = tf.convert_to_tensor(arr, name='images')\nimages = tf.placeholder(tf.float32, shape=[None,None,None,None])\n\n#%%\ndef _compute_longer_edge(height, width, new_shorter_edge):\n    return tf.cast(width*new_shorter_edge/height, tf.int32)\n\nshape = tf.shape(images)\nheight = shape[1]\nwidth = shape[2]\nnew_shorter_edge = tf.constant(400, dtype=tf.int32)\n\nheight_smaller_than_width = tf.less_equal(height, width)\nnew_height_and_width = tf.cond(\n    height_smaller_than_width,\n    lambda: (new_shorter_edge, _compute_longer_edge(height, width, new_shorter_edge)),\n    lambda: (_compute_longer_edge(width, height, new_shorter_edge), new_shorter_edge)\n)\n\nimages_ = tf.image.resize_images(images, new_height_and_width[0], new_height_and_width[1])\n#image = tf.image.resize_bilinear(images, tf.pack(new_height_and_width))\nimages_ = tf.Print(images_, [tf.shape(images_), height, width, new_height_and_width[0], new_height_and_width[1]])\n\nres = tf.random_crop(images_, [10,224,224,1]).eval(feed_dict={images: arr})\nplt.imshow(res[5,:,:,0])\n#%%\n\narr2 = mnist.train.images[10:20].reshape([10,56,14,1])\nres2 = tf.random_crop(images_, [10,224,224,1]).eval(feed_dict={images: arr2})\nplt.imshow(res2[5,:,:,0])\n</code></pre>", "body_text": "@girving I tried to use tf.placeholder with no shape, however I still cannot reproduce this bug.\nfrom tensorflow.examples.tutorials.mnist import input_data\nmnist = input_data.read_data_sets('MNIST_data', one_hot=True)\nimport tensorflow as tf\nsess = tf.InteractiveSession()\nimport matplotlib.pyplot as plt\narr = mnist.train.images[:10].reshape([10,28,28,1])\nplt.imshow(arr[5,:,:,0])\n\n#images = tf.convert_to_tensor(arr, name='images')\nimages = tf.placeholder(tf.float32, shape=[None,None,None,None])\n\n#%%\ndef _compute_longer_edge(height, width, new_shorter_edge):\n    return tf.cast(width*new_shorter_edge/height, tf.int32)\n\nshape = tf.shape(images)\nheight = shape[1]\nwidth = shape[2]\nnew_shorter_edge = tf.constant(400, dtype=tf.int32)\n\nheight_smaller_than_width = tf.less_equal(height, width)\nnew_height_and_width = tf.cond(\n    height_smaller_than_width,\n    lambda: (new_shorter_edge, _compute_longer_edge(height, width, new_shorter_edge)),\n    lambda: (_compute_longer_edge(width, height, new_shorter_edge), new_shorter_edge)\n)\n\nimages_ = tf.image.resize_images(images, new_height_and_width[0], new_height_and_width[1])\n#image = tf.image.resize_bilinear(images, tf.pack(new_height_and_width))\nimages_ = tf.Print(images_, [tf.shape(images_), height, width, new_height_and_width[0], new_height_and_width[1]])\n\nres = tf.random_crop(images_, [10,224,224,1]).eval(feed_dict={images: arr})\nplt.imshow(res[5,:,:,0])\n#%%\n\narr2 = mnist.train.images[10:20].reshape([10,56,14,1])\nres2 = tf.random_crop(images_, [10,224,224,1]).eval(feed_dict={images: arr2})\nplt.imshow(res2[5,:,:,0])", "body": "@girving I tried to use tf.placeholder with no shape, however I still cannot reproduce this bug.\n\n```\nfrom tensorflow.examples.tutorials.mnist import input_data\nmnist = input_data.read_data_sets('MNIST_data', one_hot=True)\nimport tensorflow as tf\nsess = tf.InteractiveSession()\nimport matplotlib.pyplot as plt\narr = mnist.train.images[:10].reshape([10,28,28,1])\nplt.imshow(arr[5,:,:,0])\n\n#images = tf.convert_to_tensor(arr, name='images')\nimages = tf.placeholder(tf.float32, shape=[None,None,None,None])\n\n#%%\ndef _compute_longer_edge(height, width, new_shorter_edge):\n    return tf.cast(width*new_shorter_edge/height, tf.int32)\n\nshape = tf.shape(images)\nheight = shape[1]\nwidth = shape[2]\nnew_shorter_edge = tf.constant(400, dtype=tf.int32)\n\nheight_smaller_than_width = tf.less_equal(height, width)\nnew_height_and_width = tf.cond(\n    height_smaller_than_width,\n    lambda: (new_shorter_edge, _compute_longer_edge(height, width, new_shorter_edge)),\n    lambda: (_compute_longer_edge(width, height, new_shorter_edge), new_shorter_edge)\n)\n\nimages_ = tf.image.resize_images(images, new_height_and_width[0], new_height_and_width[1])\n#image = tf.image.resize_bilinear(images, tf.pack(new_height_and_width))\nimages_ = tf.Print(images_, [tf.shape(images_), height, width, new_height_and_width[0], new_height_and_width[1]])\n\nres = tf.random_crop(images_, [10,224,224,1]).eval(feed_dict={images: arr})\nplt.imshow(res[5,:,:,0])\n#%%\n\narr2 = mnist.train.images[10:20].reshape([10,56,14,1])\nres2 = tf.random_crop(images_, [10,224,224,1]).eval(feed_dict={images: arr2})\nplt.imshow(res2[5,:,:,0])\n```\n"}