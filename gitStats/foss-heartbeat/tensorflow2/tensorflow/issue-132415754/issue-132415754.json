{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1029", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1029/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1029/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1029/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1029", "id": 132415754, "node_id": "MDU6SXNzdWUxMzI0MTU3NTQ=", "number": 1029, "title": "tf.image.resize_images() expects statically known rank", "user": {"login": "mackcmillion", "id": 6370271, "node_id": "MDQ6VXNlcjYzNzAyNzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6370271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mackcmillion", "html_url": "https://github.com/mackcmillion", "followers_url": "https://api.github.com/users/mackcmillion/followers", "following_url": "https://api.github.com/users/mackcmillion/following{/other_user}", "gists_url": "https://api.github.com/users/mackcmillion/gists{/gist_id}", "starred_url": "https://api.github.com/users/mackcmillion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mackcmillion/subscriptions", "organizations_url": "https://api.github.com/users/mackcmillion/orgs", "repos_url": "https://api.github.com/users/mackcmillion/repos", "events_url": "https://api.github.com/users/mackcmillion/events{/privacy}", "received_events_url": "https://api.github.com/users/mackcmillion/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 24, "created_at": "2016-02-09T13:12:08Z", "updated_at": "2018-04-14T04:16:19Z", "closed_at": "2017-06-16T17:40:22Z", "author_association": "NONE", "body_html": "<p>It looks like the op <code>tf.image.resize_images()</code> has no effect on the image shape when the parameters <code>new_height</code> and <code>new_width</code> are dynamically computed (this is possible since the fix of issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"131664218\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/1001\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/1001/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/1001\">#1001</a>).</p>\n<p>For example, this piece of code</p>\n<pre><code>shape = tf.shape(image)\nheight = shape[0]\nwidth = shape[1]\nnew_shorter_edge = tf.constant(400, dtype=tf.int32)\n\nheight_smaller_than_width = tf.less_equal(height, width)\nnew_height_and_width = tf.cond(\n    height_smaller_than_width,\n    lambda: (new_shorter_edge, _compute_longer_edge(height, width, new_shorter_edge)),\n    lambda: (_compute_longer_edge(width, height, new_shorter_edge), new_shorter_edge)\n)\n\nimage = tf.image.resize_images(image, new_height_and_width[0], new_height_and_width[1])\nimage = tf.Print(image, [tf.shape(image), height, width, new_height_and_width[0], new_height_and_width[1]])\nreturn tf.image.random_crop(image, [224, 224])\n</code></pre>\n<p>throws the following exception:</p>\n<pre><code>I tensorflow/core/kernels/logging_ops.cc:79] [122 160 3][122][160][400][524]\nW tensorflow/core/common_runtime/executor.cc:1096] 0x7f9c08008490 Compute status: Failed precondition: width must be &gt;= target_width: width = 160, target_width = 224\n</code></pre>\n<p>So as you can see in the first line of the printout, the shape of the image is not affected by <code>tf.image.resize_images</code>. Is this a bug or am I doing something wrong?</p>\n<hr>\n<p>I also made up a workaround for this:</p>\n<pre><code>image = tf.expand_dims(image, 0)\nimage = tf.image.resize_bilinear(image, tf.pack(new_height_and_width))\nimage = tf.squeeze(image, [0])\nimage = tf.Print(image, [tf.shape(image), height, width, new_height_and_width[0], new_height_and_width[1]])\nreturn tf.image.random_crop(image, [224, 224])\n</code></pre>\n<p>for example prints</p>\n<pre><code>I tensorflow/core/kernels/logging_ops.cc:79] [400 711 3][281][500][400][711]\n</code></pre>", "body_text": "It looks like the op tf.image.resize_images() has no effect on the image shape when the parameters new_height and new_width are dynamically computed (this is possible since the fix of issue #1001).\nFor example, this piece of code\nshape = tf.shape(image)\nheight = shape[0]\nwidth = shape[1]\nnew_shorter_edge = tf.constant(400, dtype=tf.int32)\n\nheight_smaller_than_width = tf.less_equal(height, width)\nnew_height_and_width = tf.cond(\n    height_smaller_than_width,\n    lambda: (new_shorter_edge, _compute_longer_edge(height, width, new_shorter_edge)),\n    lambda: (_compute_longer_edge(width, height, new_shorter_edge), new_shorter_edge)\n)\n\nimage = tf.image.resize_images(image, new_height_and_width[0], new_height_and_width[1])\nimage = tf.Print(image, [tf.shape(image), height, width, new_height_and_width[0], new_height_and_width[1]])\nreturn tf.image.random_crop(image, [224, 224])\n\nthrows the following exception:\nI tensorflow/core/kernels/logging_ops.cc:79] [122 160 3][122][160][400][524]\nW tensorflow/core/common_runtime/executor.cc:1096] 0x7f9c08008490 Compute status: Failed precondition: width must be >= target_width: width = 160, target_width = 224\n\nSo as you can see in the first line of the printout, the shape of the image is not affected by tf.image.resize_images. Is this a bug or am I doing something wrong?\n\nI also made up a workaround for this:\nimage = tf.expand_dims(image, 0)\nimage = tf.image.resize_bilinear(image, tf.pack(new_height_and_width))\nimage = tf.squeeze(image, [0])\nimage = tf.Print(image, [tf.shape(image), height, width, new_height_and_width[0], new_height_and_width[1]])\nreturn tf.image.random_crop(image, [224, 224])\n\nfor example prints\nI tensorflow/core/kernels/logging_ops.cc:79] [400 711 3][281][500][400][711]", "body": "It looks like the op `tf.image.resize_images()` has no effect on the image shape when the parameters `new_height` and `new_width` are dynamically computed (this is possible since the fix of issue #1001).\n\nFor example, this piece of code\n\n```\nshape = tf.shape(image)\nheight = shape[0]\nwidth = shape[1]\nnew_shorter_edge = tf.constant(400, dtype=tf.int32)\n\nheight_smaller_than_width = tf.less_equal(height, width)\nnew_height_and_width = tf.cond(\n    height_smaller_than_width,\n    lambda: (new_shorter_edge, _compute_longer_edge(height, width, new_shorter_edge)),\n    lambda: (_compute_longer_edge(width, height, new_shorter_edge), new_shorter_edge)\n)\n\nimage = tf.image.resize_images(image, new_height_and_width[0], new_height_and_width[1])\nimage = tf.Print(image, [tf.shape(image), height, width, new_height_and_width[0], new_height_and_width[1]])\nreturn tf.image.random_crop(image, [224, 224])\n```\n\nthrows the following exception:\n\n```\nI tensorflow/core/kernels/logging_ops.cc:79] [122 160 3][122][160][400][524]\nW tensorflow/core/common_runtime/executor.cc:1096] 0x7f9c08008490 Compute status: Failed precondition: width must be >= target_width: width = 160, target_width = 224\n```\n\nSo as you can see in the first line of the printout, the shape of the image is not affected by `tf.image.resize_images`. Is this a bug or am I doing something wrong?\n\n---\n\nI also made up a workaround for this:\n\n```\nimage = tf.expand_dims(image, 0)\nimage = tf.image.resize_bilinear(image, tf.pack(new_height_and_width))\nimage = tf.squeeze(image, [0])\nimage = tf.Print(image, [tf.shape(image), height, width, new_height_and_width[0], new_height_and_width[1]])\nreturn tf.image.random_crop(image, [224, 224])\n```\n\nfor example prints\n\n```\nI tensorflow/core/kernels/logging_ops.cc:79] [400 711 3][281][500][400][711]\n```\n"}