{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13875", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13875/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13875/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/13875/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/13875", "id": 267338326, "node_id": "MDU6SXNzdWUyNjczMzgzMjY=", "number": 13875, "title": "Missing MPI collectives op symbols in TF build", "user": {"login": "jthestness", "id": 28744304, "node_id": "MDQ6VXNlcjI4NzQ0MzA0", "avatar_url": "https://avatars0.githubusercontent.com/u/28744304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jthestness", "html_url": "https://github.com/jthestness", "followers_url": "https://api.github.com/users/jthestness/followers", "following_url": "https://api.github.com/users/jthestness/following{/other_user}", "gists_url": "https://api.github.com/users/jthestness/gists{/gist_id}", "starred_url": "https://api.github.com/users/jthestness/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jthestness/subscriptions", "organizations_url": "https://api.github.com/users/jthestness/orgs", "repos_url": "https://api.github.com/users/jthestness/repos", "events_url": "https://api.github.com/users/jthestness/events{/privacy}", "received_events_url": "https://api.github.com/users/jthestness/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2017-10-21T00:53:02Z", "updated_at": "2018-01-03T18:10:28Z", "closed_at": "2018-01-03T18:10:28Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Running into a build issue when trying to use MPI collectives. We are able to build a recent version of TF using NVIDIA's changes for CUDA 9/cuDNN 7. However, it appears that the build strips the MPI collectives library ops:</p>\n<pre><code>% python -c 'import tensorflow.contrib.mpi_collectives as mpi'\nTraceback (most recent call last):\n File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/__init__.py\", line 126, in &lt;module&gt;\n   from tensorflow.contrib.mpi_collectives.mpi_ops import size\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py\", line 59, in &lt;module&gt;\n   'MPIAllreduce'])\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py\", line 51, in _load_library\n   (expected_op, name))\nNameError: Could not find operator MPISize in dynamic library mpi_collectives.so\n</code></pre>\n<p>It seems like the issue might be caused by commit <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/5c7f9e316d8c7735308a217310350d416d7498cc/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/5c7f9e316d8c7735308a217310350d416d7498cc\"><tt>5c7f9e3</tt></a>, which changes linking behavior, but we're unable to bisect due to commit order dependencies.</p>\n<p>Anyone have an idea how to fix the issue? We're willing to update the MPI collectives code and submit a PR fix.</p>\n<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: We've applied NVIDIA's CUDA 9/cuDNN 7 patches for mixed-precision per this page: <a href=\"http://docs.nvidia.com/deeplearning/sdk/mixed-precision-training/index.html#training_tensorflow\" rel=\"nofollow\">http://docs.nvidia.com/deeplearning/sdk/mixed-precision-training/index.html#training_tensorflow</a></li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: 14.04</li>\n<li><strong>TensorFlow version (use command below)</strong>: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/ea94bbe9fa9f9b3d01fb057c02ef7873d76bf09c/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/ea94bbe9fa9f9b3d01fb057c02ef7873d76bf09c\"><tt>ea94bbe</tt></a></li>\n<li><strong>Python version</strong>: 3.6</li>\n<li><strong>Bazel version</strong>: 0.5.4</li>\n<li><strong>CUDA/cuDNN version</strong>: CUDA 9.0.103_rc/cuDNN 7.0-rc</li>\n<li><strong>Exact command to reproduce</strong>: <code>python -c 'import tensorflow.contrib.mpi_collectives as mpi'</code></li>\n</ul>", "body_text": "Running into a build issue when trying to use MPI collectives. We are able to build a recent version of TF using NVIDIA's changes for CUDA 9/cuDNN 7. However, it appears that the build strips the MPI collectives library ops:\n% python -c 'import tensorflow.contrib.mpi_collectives as mpi'\nTraceback (most recent call last):\n File \"<string>\", line 1, in <module>\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/__init__.py\", line 126, in <module>\n   from tensorflow.contrib.mpi_collectives.mpi_ops import size\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py\", line 59, in <module>\n   'MPIAllreduce'])\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py\", line 51, in _load_library\n   (expected_op, name))\nNameError: Could not find operator MPISize in dynamic library mpi_collectives.so\n\nIt seems like the issue might be caused by commit 5c7f9e3, which changes linking behavior, but we're unable to bisect due to commit order dependencies.\nAnyone have an idea how to fix the issue? We're willing to update the MPI collectives code and submit a PR fix.\nSystem information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): We've applied NVIDIA's CUDA 9/cuDNN 7 patches for mixed-precision per this page: http://docs.nvidia.com/deeplearning/sdk/mixed-precision-training/index.html#training_tensorflow\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): 14.04\nTensorFlow version (use command below): ea94bbe\nPython version: 3.6\nBazel version: 0.5.4\nCUDA/cuDNN version: CUDA 9.0.103_rc/cuDNN 7.0-rc\nExact command to reproduce: python -c 'import tensorflow.contrib.mpi_collectives as mpi'", "body": "Running into a build issue when trying to use MPI collectives. We are able to build a recent version of TF using NVIDIA's changes for CUDA 9/cuDNN 7. However, it appears that the build strips the MPI collectives library ops:\r\n\r\n```\r\n% python -c 'import tensorflow.contrib.mpi_collectives as mpi'\r\nTraceback (most recent call last):\r\n File \"<string>\", line 1, in <module>\r\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/__init__.py\", line 126, in <module>\r\n   from tensorflow.contrib.mpi_collectives.mpi_ops import size\r\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py\", line 59, in <module>\r\n   'MPIAllreduce'])\r\n File \"/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py\", line 51, in _load_library\r\n   (expected_op, name))\r\nNameError: Could not find operator MPISize in dynamic library mpi_collectives.so\r\n```\r\n\r\nIt seems like the issue might be caused by commit 5c7f9e3, which changes linking behavior, but we're unable to bisect due to commit order dependencies.\r\n\r\n\r\nAnyone have an idea how to fix the issue? We're willing to update the MPI collectives code and submit a PR fix.\r\n\r\n\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: We've applied NVIDIA's CUDA 9/cuDNN 7 patches for mixed-precision per this page: http://docs.nvidia.com/deeplearning/sdk/mixed-precision-training/index.html#training_tensorflow\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: 14.04\r\n- **TensorFlow version (use command below)**: ea94bbe9fa9f9b3d01fb057c02ef7873d76bf09c\r\n- **Python version**: 3.6\r\n- **Bazel version**: 0.5.4\r\n- **CUDA/cuDNN version**: CUDA 9.0.103_rc/cuDNN 7.0-rc\r\n- **Exact command to reproduce**: `python -c 'import tensorflow.contrib.mpi_collectives as mpi'`\r\n\r\n\r\n\r\n\r\n"}