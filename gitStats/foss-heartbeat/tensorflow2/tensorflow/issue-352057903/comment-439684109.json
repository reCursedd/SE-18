{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/439684109", "html_url": "https://github.com/tensorflow/tensorflow/issues/21729#issuecomment-439684109", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21729", "id": 439684109, "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTY4NDEwOQ==", "user": {"login": "hsm207", "id": 2398765, "node_id": "MDQ6VXNlcjIzOTg3NjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2398765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hsm207", "html_url": "https://github.com/hsm207", "followers_url": "https://api.github.com/users/hsm207/followers", "following_url": "https://api.github.com/users/hsm207/following{/other_user}", "gists_url": "https://api.github.com/users/hsm207/gists{/gist_id}", "starred_url": "https://api.github.com/users/hsm207/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hsm207/subscriptions", "organizations_url": "https://api.github.com/users/hsm207/orgs", "repos_url": "https://api.github.com/users/hsm207/repos", "events_url": "https://api.github.com/users/hsm207/events{/privacy}", "received_events_url": "https://api.github.com/users/hsm207/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-18T11:01:22Z", "updated_at": "2018-11-18T11:01:22Z", "author_association": "CONTRIBUTOR", "body_html": "<p>It also does not work when the input is a dictionary:</p>\n<pre><code>import tensorflow as tf\nfrom collections import ChainMap\n\ntf.enable_eager_execution()\n\n\nclass MyModel(tf.keras.Model):\n    def __init__(self):\n        super(MyModel, self).__init__()\n        self.dense1 = tf.keras.layers.Dense(2, activation='relu')\n        self.dense2 = tf.keras.layers.Dense(2, activation='relu')\n        self.dense3 = tf.keras.layers.Dense(1)\n\n    def call(self, inputs, training=None, mask=None):\n        x1 = inputs['x1']\n        x2 = inputs['x2']\n\n        x1 = self.dense1(x1)\n        x2 = self.dense2(x2)\n\n        y = self.dense3(x1 + x2)\n\n        return y\n\n\nmodel = MyModel()\n\nx1 = tf.random.normal((10, 1), 0, 1)\nx2 = tf.random.normal((10, 1), 1, 2)\ny = x1 + 2 * x2\n\nds = tf.data.Dataset.zip((tf.data.Dataset.from_tensor_slices({'x1': x1}),\n                          tf.data.Dataset.from_tensor_slices({'x2': x2}))) \\\n    .map(lambda *dicts: dict(ChainMap(*dicts)))\n\ny = tf.data.Dataset.from_tensor_slices(y)\n\nds = tf.data.Dataset.zip((ds, y)) \\\n    .batch(5) \\\n    .repeat()\n\nmodel.compile(tf.train.AdamOptimizer(), 'mean_squared_error', metrics =['mae'])\nmodel.fit(ds, epochs=1, steps_per_epoch=10, validation_data=ds)\n</code></pre>\n<p>It gives the following error:</p>\n<pre><code>Traceback (most recent call last):\n  File \"&lt;input&gt;\", line 1, in &lt;module&gt;\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/engine/training.py\", line 1614, in fit\n    validation_steps=validation_steps)\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/engine/training_eager.py\", line 681, in fit_loop\n    verbose=verbose)\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/callbacks.py\", line 144, in configure_callbacks\n    val_data = val_inputs + val_targets\nTypeError: unsupported operand type(s) for +: 'dict' and 'list'\n</code></pre>", "body_text": "It also does not work when the input is a dictionary:\nimport tensorflow as tf\nfrom collections import ChainMap\n\ntf.enable_eager_execution()\n\n\nclass MyModel(tf.keras.Model):\n    def __init__(self):\n        super(MyModel, self).__init__()\n        self.dense1 = tf.keras.layers.Dense(2, activation='relu')\n        self.dense2 = tf.keras.layers.Dense(2, activation='relu')\n        self.dense3 = tf.keras.layers.Dense(1)\n\n    def call(self, inputs, training=None, mask=None):\n        x1 = inputs['x1']\n        x2 = inputs['x2']\n\n        x1 = self.dense1(x1)\n        x2 = self.dense2(x2)\n\n        y = self.dense3(x1 + x2)\n\n        return y\n\n\nmodel = MyModel()\n\nx1 = tf.random.normal((10, 1), 0, 1)\nx2 = tf.random.normal((10, 1), 1, 2)\ny = x1 + 2 * x2\n\nds = tf.data.Dataset.zip((tf.data.Dataset.from_tensor_slices({'x1': x1}),\n                          tf.data.Dataset.from_tensor_slices({'x2': x2}))) \\\n    .map(lambda *dicts: dict(ChainMap(*dicts)))\n\ny = tf.data.Dataset.from_tensor_slices(y)\n\nds = tf.data.Dataset.zip((ds, y)) \\\n    .batch(5) \\\n    .repeat()\n\nmodel.compile(tf.train.AdamOptimizer(), 'mean_squared_error', metrics =['mae'])\nmodel.fit(ds, epochs=1, steps_per_epoch=10, validation_data=ds)\n\nIt gives the following error:\nTraceback (most recent call last):\n  File \"<input>\", line 1, in <module>\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/engine/training.py\", line 1614, in fit\n    validation_steps=validation_steps)\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/engine/training_eager.py\", line 681, in fit_loop\n    verbose=verbose)\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/callbacks.py\", line 144, in configure_callbacks\n    val_data = val_inputs + val_targets\nTypeError: unsupported operand type(s) for +: 'dict' and 'list'", "body": "It also does not work when the input is a dictionary:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom collections import ChainMap\r\n\r\ntf.enable_eager_execution()\r\n\r\n\r\nclass MyModel(tf.keras.Model):\r\n    def __init__(self):\r\n        super(MyModel, self).__init__()\r\n        self.dense1 = tf.keras.layers.Dense(2, activation='relu')\r\n        self.dense2 = tf.keras.layers.Dense(2, activation='relu')\r\n        self.dense3 = tf.keras.layers.Dense(1)\r\n\r\n    def call(self, inputs, training=None, mask=None):\r\n        x1 = inputs['x1']\r\n        x2 = inputs['x2']\r\n\r\n        x1 = self.dense1(x1)\r\n        x2 = self.dense2(x2)\r\n\r\n        y = self.dense3(x1 + x2)\r\n\r\n        return y\r\n\r\n\r\nmodel = MyModel()\r\n\r\nx1 = tf.random.normal((10, 1), 0, 1)\r\nx2 = tf.random.normal((10, 1), 1, 2)\r\ny = x1 + 2 * x2\r\n\r\nds = tf.data.Dataset.zip((tf.data.Dataset.from_tensor_slices({'x1': x1}),\r\n                          tf.data.Dataset.from_tensor_slices({'x2': x2}))) \\\r\n    .map(lambda *dicts: dict(ChainMap(*dicts)))\r\n\r\ny = tf.data.Dataset.from_tensor_slices(y)\r\n\r\nds = tf.data.Dataset.zip((ds, y)) \\\r\n    .batch(5) \\\r\n    .repeat()\r\n\r\nmodel.compile(tf.train.AdamOptimizer(), 'mean_squared_error', metrics =['mae'])\r\nmodel.fit(ds, epochs=1, steps_per_epoch=10, validation_data=ds)\r\n```\r\nIt gives the following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/engine/training.py\", line 1614, in fit\r\n    validation_steps=validation_steps)\r\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/engine/training_eager.py\", line 681, in fit_loop\r\n    verbose=verbose)\r\n  File \"/Users/user/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/keras/callbacks.py\", line 144, in configure_callbacks\r\n    val_data = val_inputs + val_targets\r\nTypeError: unsupported operand type(s) for +: 'dict' and 'list'\r\n```\r\n"}