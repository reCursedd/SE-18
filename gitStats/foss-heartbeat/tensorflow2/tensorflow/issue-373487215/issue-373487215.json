{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23212", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23212/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23212/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23212/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/23212", "id": 373487215, "node_id": "MDU6SXNzdWUzNzM0ODcyMTU=", "number": 23212, "title": "Ambiguity with tf.nn.embedding_lookup_sparse", "user": {"login": "brochier", "id": 20535690, "node_id": "MDQ6VXNlcjIwNTM1Njkw", "avatar_url": "https://avatars0.githubusercontent.com/u/20535690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brochier", "html_url": "https://github.com/brochier", "followers_url": "https://api.github.com/users/brochier/followers", "following_url": "https://api.github.com/users/brochier/following{/other_user}", "gists_url": "https://api.github.com/users/brochier/gists{/gist_id}", "starred_url": "https://api.github.com/users/brochier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brochier/subscriptions", "organizations_url": "https://api.github.com/users/brochier/orgs", "repos_url": "https://api.github.com/users/brochier/repos", "events_url": "https://api.github.com/users/brochier/events{/privacy}", "received_events_url": "https://api.github.com/users/brochier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, {"login": "harshini-gadige", "id": 42781361, "node_id": "MDQ6VXNlcjQyNzgxMzYx", "avatar_url": "https://avatars1.githubusercontent.com/u/42781361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshini-gadige", "html_url": "https://github.com/harshini-gadige", "followers_url": "https://api.github.com/users/harshini-gadige/followers", "following_url": "https://api.github.com/users/harshini-gadige/following{/other_user}", "gists_url": "https://api.github.com/users/harshini-gadige/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshini-gadige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshini-gadige/subscriptions", "organizations_url": "https://api.github.com/users/harshini-gadige/orgs", "repos_url": "https://api.github.com/users/harshini-gadige/repos", "events_url": "https://api.github.com/users/harshini-gadige/events{/privacy}", "received_events_url": "https://api.github.com/users/harshini-gadige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-10-24T13:37:12Z", "updated_at": "2018-11-19T23:24:14Z", "closed_at": null, "author_association": "NONE", "body_html": "<p><em>Please make sure that this is a feature request. As per our <a href=\"https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md\">GitHub Policy</a>, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em></p>\n<p><strong>System information</strong></p>\n<ul>\n<li>TensorFlow 1.9.0</li>\n<li>Python 3.6.6</li>\n<li>Are you willing to contribute it (Yes/No): Yes</li>\n</ul>\n<p><strong>Describe the feature and the current behavior/state.</strong><br>\nThe tf.nn.embedding_lookup_sparse need two tf.SparseTensor (sp_ids and sp_weights) but I can't figure out why. Specifically, it seems to me that the columns of the indices of sp_ids and sp_weights are useless (see the example in the doc). This could be changed to use only one SparseTensor with:</p>\n<ul>\n<li>rows of indices pointing to the index of the element of the batch.</li>\n<li>columns of indices pointing to the index of the target element of the embedding (params).</li>\n<li>values corresponding to the weights.</li>\n</ul>\n<p>Small example of two operations doing the same things:<br>\ntf.sparse_tensor_dense_matmul(sparse_tensor, embeddings)<br>\ntf.nn.embedding_lookup_sparse(embeddings, sparse_ids, sparse_weights, \"sum\")<br>\nHere sparse_ids and sparse_weights have the same indices, the values of sparse_ids are the columns of indices of sparse_tensor and the values of weights are the values of  sparse_tensor. The three sparse tensors share the same rows of indices.</p>\n<p>ps: It might not work in higher dimensional embedding lookups, I just wanted to point out the fact that embedding_lookup and embedding_lookup_sparse, despite their close names, have actually a very different usability.</p>\n<p><strong>Will this change the current api? How?</strong><br>\nI can't really say.  tf.nn.embedding_lookup_sparse(params, sp_ids, sp_weights...) could become tf.nn.embedding_lookup_sparse(params, sparse_ids...) to be more consistent with tf.nn.embedding_lookup.</p>\n<p><strong>Who will benefit with this feature?</strong><br>\nI don't really know.</p>\n<p><strong>Any Other info.</strong></p>\n<p>Have I written custom code: no<br>\nOS Platform and Distribution: linux, but not relevant<br>\nTensorFlow installed from: pip<br>\nTensorFlow version: 1.9.0<br>\nBazel version: ?<br>\nCUDA/cuDNN version: no CUDA<br>\nGPU model and memory: no GPU<br>\nExact command to reproduce: See above<br>\nMobile device: not relevant</p>", "body_text": "Please make sure that this is a feature request. As per our GitHub Policy, we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template\nSystem information\n\nTensorFlow 1.9.0\nPython 3.6.6\nAre you willing to contribute it (Yes/No): Yes\n\nDescribe the feature and the current behavior/state.\nThe tf.nn.embedding_lookup_sparse need two tf.SparseTensor (sp_ids and sp_weights) but I can't figure out why. Specifically, it seems to me that the columns of the indices of sp_ids and sp_weights are useless (see the example in the doc). This could be changed to use only one SparseTensor with:\n\nrows of indices pointing to the index of the element of the batch.\ncolumns of indices pointing to the index of the target element of the embedding (params).\nvalues corresponding to the weights.\n\nSmall example of two operations doing the same things:\ntf.sparse_tensor_dense_matmul(sparse_tensor, embeddings)\ntf.nn.embedding_lookup_sparse(embeddings, sparse_ids, sparse_weights, \"sum\")\nHere sparse_ids and sparse_weights have the same indices, the values of sparse_ids are the columns of indices of sparse_tensor and the values of weights are the values of  sparse_tensor. The three sparse tensors share the same rows of indices.\nps: It might not work in higher dimensional embedding lookups, I just wanted to point out the fact that embedding_lookup and embedding_lookup_sparse, despite their close names, have actually a very different usability.\nWill this change the current api? How?\nI can't really say.  tf.nn.embedding_lookup_sparse(params, sp_ids, sp_weights...) could become tf.nn.embedding_lookup_sparse(params, sparse_ids...) to be more consistent with tf.nn.embedding_lookup.\nWho will benefit with this feature?\nI don't really know.\nAny Other info.\nHave I written custom code: no\nOS Platform and Distribution: linux, but not relevant\nTensorFlow installed from: pip\nTensorFlow version: 1.9.0\nBazel version: ?\nCUDA/cuDNN version: no CUDA\nGPU model and memory: no GPU\nExact command to reproduce: See above\nMobile device: not relevant", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow 1.9.0\r\n- Python 3.6.6\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nThe tf.nn.embedding_lookup_sparse need two tf.SparseTensor (sp_ids and sp_weights) but I can't figure out why. Specifically, it seems to me that the columns of the indices of sp_ids and sp_weights are useless (see the example in the doc). This could be changed to use only one SparseTensor with:\r\n- rows of indices pointing to the index of the element of the batch.\r\n- columns of indices pointing to the index of the target element of the embedding (params).\r\n- values corresponding to the weights. \r\n\r\nSmall example of two operations doing the same things:\r\ntf.sparse_tensor_dense_matmul(sparse_tensor, embeddings)\r\ntf.nn.embedding_lookup_sparse(embeddings, sparse_ids, sparse_weights, \"sum\")\r\nHere sparse_ids and sparse_weights have the same indices, the values of sparse_ids are the columns of indices of sparse_tensor and the values of weights are the values of  sparse_tensor. The three sparse tensors share the same rows of indices. \r\n\r\nps: It might not work in higher dimensional embedding lookups, I just wanted to point out the fact that embedding_lookup and embedding_lookup_sparse, despite their close names, have actually a very different usability. \r\n\r\n\r\n**Will this change the current api? How?**\r\nI can't really say.  tf.nn.embedding_lookup_sparse(params, sp_ids, sp_weights...) could become tf.nn.embedding_lookup_sparse(params, sparse_ids...) to be more consistent with tf.nn.embedding_lookup.\r\n\r\n\r\n**Who will benefit with this feature?**\r\nI don't really know. \r\n\r\n\r\n**Any Other info.**\r\n\r\nHave I written custom code: no\r\nOS Platform and Distribution: linux, but not relevant\r\nTensorFlow installed from: pip\r\nTensorFlow version: 1.9.0\r\nBazel version: ?\r\nCUDA/cuDNN version: no CUDA\r\nGPU model and memory: no GPU\r\nExact command to reproduce: See above\r\nMobile device: not relevant\r\n"}