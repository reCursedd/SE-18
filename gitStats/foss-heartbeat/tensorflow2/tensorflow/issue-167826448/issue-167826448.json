{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3526", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3526/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3526/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3526/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3526", "id": 167826448, "node_id": "MDU6SXNzdWUxNjc4MjY0NDg=", "number": 3526, "title": "Build fails on Ubuntu 16.04 LTS, CUDA Toolkit 8.0, cuDNN 5.0.5, and Bazel 0.3.0-jdk7", "user": {"login": "adam-erickson", "id": 5751456, "node_id": "MDQ6VXNlcjU3NTE0NTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5751456?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adam-erickson", "html_url": "https://github.com/adam-erickson", "followers_url": "https://api.github.com/users/adam-erickson/followers", "following_url": "https://api.github.com/users/adam-erickson/following{/other_user}", "gists_url": "https://api.github.com/users/adam-erickson/gists{/gist_id}", "starred_url": "https://api.github.com/users/adam-erickson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adam-erickson/subscriptions", "organizations_url": "https://api.github.com/users/adam-erickson/orgs", "repos_url": "https://api.github.com/users/adam-erickson/repos", "events_url": "https://api.github.com/users/adam-erickson/events{/privacy}", "received_events_url": "https://api.github.com/users/adam-erickson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-07-27T10:55:16Z", "updated_at": "2016-07-28T15:22:40Z", "closed_at": "2016-07-28T15:22:40Z", "author_association": "NONE", "body_html": "<p>Hi Everyone,</p>\n<p>I've downgraded my gcc to 5.3.0 by building from source in order to install CUDA Toolkit 8.0 with cuDNN 5.0.5. I also installed OpenCL freeglut3 and mesa libraries via apt-get. I then built Bazel from source using the installer script. Next, I installed the TensorFlow and Google Cloud Platform Python dependencies. I then cloned the tensorflow GitHub repository and modified the CROSSTOOL file variable cxx_builtin_include_directory to include the gcc location for 5.3.0. I then ran ./configure with default settings and tried to build with Bazel, but it always fails with an error like this, which appears to be a gcc issue:</p>\n<p>WARNING: /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/protobuf/WORKSPACE:1: Workspace name in /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/protobuf/WORKSPACE (@<strong>main</strong>) does not match the name given in the repository's definition (<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=30293029\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/protobuf\">@protobuf</a>); this will cause a build error in future versions.</p>\n<p>ERROR: /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/zlib_archive/BUILD:7:1: undeclared inclusion(s) in rule '@zlib_archive//:zlib'</p>\n<p>This rule is missing dependency declarations for the following files included by 'external/zlib_archive/zlib-1.2.8/inftrees.c':<br>\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include-fixed/limits.h'<br>\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include-fixed/syslimits.h'<br>\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include/stddef.h'<br>\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include/stdarg.h'.<br>\nTarget //tensorflow/cc:tutorials_example_trainer failed to build</p>\n<p>If I change the gcc version to 4.8 (installed via apt-get) in ./configure and revert CROSSTOOL I get many warnings:<br>\nINFO: ... warning: variable 'parsed_colon' set but not used</p>\n<p>This warning is followed by an error:<br>\nERROR: /opt/tensorflow/tensorflow/core/kernels/BUILD:1527:1: undeclared inclusion(s) in rule '//tensorflow/core/kernels:depth_space_ops_gpu':<br>\nthis rule is missing dependency declarations for the following files included by 'tensorflow/core/kernels/spacetodepth_op_gpu.cu.cc':<br>\n'/usr/local/cuda-8.0/include/cuda_runtime.h'<br>\n'/usr/local/cuda-8.0/include/host_config.h'<br>\n'/usr/local/cuda-8.0/include/builtin_types.h'<br>\n'/usr/local/cuda-8.0/include/device_types.h'<br>\n'/usr/local/cuda-8.0/include/host_defines.h'<br>\n'/usr/local/cuda-8.0/include/driver_types.h'<br>\n...</p>\n<p>This time, it appears to be an issue with CUDA Toolkit 8.0. Everything seems to work flawlessly up until building tensorflow from source.</p>\n<p>Thanks,</p>\n<p>Adam</p>", "body_text": "Hi Everyone,\nI've downgraded my gcc to 5.3.0 by building from source in order to install CUDA Toolkit 8.0 with cuDNN 5.0.5. I also installed OpenCL freeglut3 and mesa libraries via apt-get. I then built Bazel from source using the installer script. Next, I installed the TensorFlow and Google Cloud Platform Python dependencies. I then cloned the tensorflow GitHub repository and modified the CROSSTOOL file variable cxx_builtin_include_directory to include the gcc location for 5.3.0. I then ran ./configure with default settings and tried to build with Bazel, but it always fails with an error like this, which appears to be a gcc issue:\nWARNING: /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/protobuf/WORKSPACE:1: Workspace name in /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/protobuf/WORKSPACE (@main) does not match the name given in the repository's definition (@protobuf); this will cause a build error in future versions.\nERROR: /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/zlib_archive/BUILD:7:1: undeclared inclusion(s) in rule '@zlib_archive//:zlib'\nThis rule is missing dependency declarations for the following files included by 'external/zlib_archive/zlib-1.2.8/inftrees.c':\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include-fixed/limits.h'\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include-fixed/syslimits.h'\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include/stddef.h'\n'/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include/stdarg.h'.\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\nIf I change the gcc version to 4.8 (installed via apt-get) in ./configure and revert CROSSTOOL I get many warnings:\nINFO: ... warning: variable 'parsed_colon' set but not used\nThis warning is followed by an error:\nERROR: /opt/tensorflow/tensorflow/core/kernels/BUILD:1527:1: undeclared inclusion(s) in rule '//tensorflow/core/kernels:depth_space_ops_gpu':\nthis rule is missing dependency declarations for the following files included by 'tensorflow/core/kernels/spacetodepth_op_gpu.cu.cc':\n'/usr/local/cuda-8.0/include/cuda_runtime.h'\n'/usr/local/cuda-8.0/include/host_config.h'\n'/usr/local/cuda-8.0/include/builtin_types.h'\n'/usr/local/cuda-8.0/include/device_types.h'\n'/usr/local/cuda-8.0/include/host_defines.h'\n'/usr/local/cuda-8.0/include/driver_types.h'\n...\nThis time, it appears to be an issue with CUDA Toolkit 8.0. Everything seems to work flawlessly up until building tensorflow from source.\nThanks,\nAdam", "body": "Hi Everyone,\n\nI've downgraded my gcc to 5.3.0 by building from source in order to install CUDA Toolkit 8.0 with cuDNN 5.0.5. I also installed OpenCL freeglut3 and mesa libraries via apt-get. I then built Bazel from source using the installer script. Next, I installed the TensorFlow and Google Cloud Platform Python dependencies. I then cloned the tensorflow GitHub repository and modified the CROSSTOOL file variable cxx_builtin_include_directory to include the gcc location for 5.3.0. I then ran ./configure with default settings and tried to build with Bazel, but it always fails with an error like this, which appears to be a gcc issue:\n\nWARNING: /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/protobuf/WORKSPACE:1: Workspace name in /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/protobuf/WORKSPACE (@__main__) does not match the name given in the repository's definition (@protobuf); this will cause a build error in future versions.\n\nERROR: /root/.cache/bazel/_bazel_root/fbc06f9baef46cade6e35d9e4137e37c/external/zlib_archive/BUILD:7:1: undeclared inclusion(s) in rule '@zlib_archive//:zlib'\n\nThis rule is missing dependency declarations for the following files included by 'external/zlib_archive/zlib-1.2.8/inftrees.c':\n  '/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include-fixed/limits.h'\n  '/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include-fixed/syslimits.h'\n  '/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include/stddef.h'\n  '/usr/local/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include/stdarg.h'.\nTarget //tensorflow/cc:tutorials_example_trainer failed to build\n\nIf I change the gcc version to 4.8 (installed via apt-get) in ./configure and revert CROSSTOOL I get many warnings:\n  INFO: ... warning: variable 'parsed_colon' set but not used\n\nThis warning is followed by an error:\nERROR: /opt/tensorflow/tensorflow/core/kernels/BUILD:1527:1: undeclared inclusion(s) in rule '//tensorflow/core/kernels:depth_space_ops_gpu':\nthis rule is missing dependency declarations for the following files included by 'tensorflow/core/kernels/spacetodepth_op_gpu.cu.cc':\n  '/usr/local/cuda-8.0/include/cuda_runtime.h'\n  '/usr/local/cuda-8.0/include/host_config.h'\n  '/usr/local/cuda-8.0/include/builtin_types.h'\n  '/usr/local/cuda-8.0/include/device_types.h'\n  '/usr/local/cuda-8.0/include/host_defines.h'\n  '/usr/local/cuda-8.0/include/driver_types.h'\n  ...\n\nThis time, it appears to be an issue with CUDA Toolkit 8.0. Everything seems to work flawlessly up until building tensorflow from source.\n\nThanks,\n\nAdam\n"}