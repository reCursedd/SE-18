{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/420360032", "html_url": "https://github.com/tensorflow/tensorflow/pull/19845#issuecomment-420360032", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19845", "id": 420360032, "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDM2MDAzMg==", "user": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-11T17:45:49Z", "updated_at": "2018-09-11T17:45:49Z", "author_association": "MEMBER", "body_html": "<p>One high-level question is how this relates to Grappler's memory optimizer. There is a swapping heuristic which is on by default: <div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom bg-gray-light\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/tensorflow/tensorflow/blob/36568a821a13379b79d74586ff20bdd3e0da102b/tensorflow/core/grappler/optimizers/memory_optimizer.cc#L1109\">tensorflow/tensorflow/core/grappler/optimizers/memory_optimizer.cc</a>\n    </p>\n    <p class=\"mb-0 text-gray-light\">\n         Line 1109\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/tensorflow/tensorflow/commit/36568a821a13379b79d74586ff20bdd3e0da102b\">36568a8</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L1109\" class=\"blob-num border-0 px-3 py-0 bg-white js-line-number\" data-line-number=\"1109\"></td>\n          <td id=\"LC1109\" class=\"blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line\"> <span class=\"pl-k\">bool</span> <span class=\"pl-en\">SwappingPass</span>(RewriterConfig::MemOptType optimization_level, </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p>In general we've been leaning toward optimizing things by default when possible rather than providing opt-in utilities. Is there something here we could merge into Grappler to reach more people without requiring them to configure it? (But if there are optimizations too experimental/aggressive to turn on by default, adding an option to RewriterConfig is possible.)</p>\n<p>Having rewrites in Python is also going to limit their impact significantly. Grappler gets run in quite a few places, for example when defining graph functions while executing eagerly.</p>\n<p>The second issue is that contrib is going away, and we're trying to reduce rather than increase the number of contrib projects. <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=577277\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/martinwicke\">@martinwicke</a> would have a bit more context on this, but I think the short summary is that we'd prefer things that can't/won't be merged into core to live in their own repos. But if these rewrites could be contributed to Grappler, maybe the documentation/examples could live with Grappler too (rather than in a contrib/ directory)?</p>", "body_text": "One high-level question is how this relates to Grappler's memory optimizer. There is a swapping heuristic which is on by default: \n  \n    \n      tensorflow/tensorflow/core/grappler/optimizers/memory_optimizer.cc\n    \n    \n         Line 1109\n      in\n      36568a8\n    \n    \n    \n    \n\n        \n          \n           bool SwappingPass(RewriterConfig::MemOptType optimization_level, \n        \n    \n  \n\n\nIn general we've been leaning toward optimizing things by default when possible rather than providing opt-in utilities. Is there something here we could merge into Grappler to reach more people without requiring them to configure it? (But if there are optimizations too experimental/aggressive to turn on by default, adding an option to RewriterConfig is possible.)\nHaving rewrites in Python is also going to limit their impact significantly. Grappler gets run in quite a few places, for example when defining graph functions while executing eagerly.\nThe second issue is that contrib is going away, and we're trying to reduce rather than increase the number of contrib projects. @martinwicke would have a bit more context on this, but I think the short summary is that we'd prefer things that can't/won't be merged into core to live in their own repos. But if these rewrites could be contributed to Grappler, maybe the documentation/examples could live with Grappler too (rather than in a contrib/ directory)?", "body": "One high-level question is how this relates to Grappler's memory optimizer. There is a swapping heuristic which is on by default: https://github.com/tensorflow/tensorflow/blob/36568a821a13379b79d74586ff20bdd3e0da102b/tensorflow/core/grappler/optimizers/memory_optimizer.cc#L1109\r\n\r\nIn general we've been leaning toward optimizing things by default when possible rather than providing opt-in utilities. Is there something here we could merge into Grappler to reach more people without requiring them to configure it? (But if there are optimizations too experimental/aggressive to turn on by default, adding an option to RewriterConfig is possible.)\r\n\r\nHaving rewrites in Python is also going to limit their impact significantly. Grappler gets run in quite a few places, for example when defining graph functions while executing eagerly.\r\n\r\nThe second issue is that contrib is going away, and we're trying to reduce rather than increase the number of contrib projects. @martinwicke would have a bit more context on this, but I think the short summary is that we'd prefer things that can't/won't be merged into core to live in their own repos. But if these rewrites could be contributed to Grappler, maybe the documentation/examples could live with Grappler too (rather than in a contrib/ directory)?"}