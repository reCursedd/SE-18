{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17438", "id": 172860068, "node_id": "MDExOlB1bGxSZXF1ZXN0MTcyODYwMDY4", "html_url": "https://github.com/tensorflow/tensorflow/pull/17438", "diff_url": "https://github.com/tensorflow/tensorflow/pull/17438.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/17438.patch", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17438", "number": 17438, "state": "closed", "locked": false, "title": "Add optimizers with decoupled weight decay.", "user": {"login": "PhilJd", "id": 16101605, "node_id": "MDQ6VXNlcjE2MTAxNjA1", "avatar_url": "https://avatars2.githubusercontent.com/u/16101605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilJd", "html_url": "https://github.com/PhilJd", "followers_url": "https://api.github.com/users/PhilJd/followers", "following_url": "https://api.github.com/users/PhilJd/following{/other_user}", "gists_url": "https://api.github.com/users/PhilJd/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilJd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilJd/subscriptions", "organizations_url": "https://api.github.com/users/PhilJd/orgs", "repos_url": "https://api.github.com/users/PhilJd/repos", "events_url": "https://api.github.com/users/PhilJd/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilJd/received_events", "type": "User", "site_admin": false}, "body": "This pull request implements decoupled weight decay as described in 'Fixing Weight Decay Regularization' by  Loshchilov & Hutter [https://arxiv.org/abs/1711.05101](https://arxiv.org/abs/1711.05101).\r\n\r\nThis paper shows that for adaptive gradient algorithms, the implemented method regularizes variables with large gradients more than L2 regularization would and that this  yields better training loss and generalization error.\r\n\r\nFor SGD variants, this simplifies hyperparameter search since it decouples the settings of weight decay and learning rate, which is nicely visualized in Fig. 2 in the paper: \r\n![adamw](https://user-images.githubusercontent.com/16101605/36976180-f2fcbf92-207c-11e8-879e-4677381d892d.png)\r\n\r\nThis implementation explicitly adds the optimizers described in the paper (`AdamW` and `MomentumW`) to tf.contrib.opt and provides a factory function `extend_with_decoupled_weight_decay` that can be used to create a new optimizer class with decoupled weight decay.\r\n\r\nCloses #15237.", "created_at": "2018-03-05T12:59:02Z", "updated_at": "2018-07-20T07:04:56Z", "closed_at": "2018-06-13T18:48:21Z", "merged_at": "2018-06-13T18:48:21Z", "merge_commit_sha": "feb9a3ede5b14d5c5a27255eeccfb9cafb778c28", "assignee": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}], "requested_reviewers": [], "requested_teams": [], "labels": [{"id": 419840263, "node_id": "MDU6TGFiZWw0MTk4NDAyNjM=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20testing%20(then%20merge)", "name": "awaiting testing (then merge)", "color": "c2e0c6", "default": false}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "milestone": null, "commits_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17438/commits", "review_comments_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17438/comments", "review_comment_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/17438/comments", "statuses_url": "https://api.github.com/repos/tensorflow/tensorflow/statuses/20b120c10c76e53873208fecaba4b7fc5263be6e", "head": {"label": "PhilJd:phil/weight_decay_optimizer", "ref": "phil/weight_decay_optimizer", "sha": "20b120c10c76e53873208fecaba4b7fc5263be6e", "user": {"login": "PhilJd", "id": 16101605, "node_id": "MDQ6VXNlcjE2MTAxNjA1", "avatar_url": "https://avatars2.githubusercontent.com/u/16101605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilJd", "html_url": "https://github.com/PhilJd", "followers_url": "https://api.github.com/users/PhilJd/followers", "following_url": "https://api.github.com/users/PhilJd/following{/other_user}", "gists_url": "https://api.github.com/users/PhilJd/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilJd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilJd/subscriptions", "organizations_url": "https://api.github.com/users/PhilJd/orgs", "repos_url": "https://api.github.com/users/PhilJd/repos", "events_url": "https://api.github.com/users/PhilJd/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilJd/received_events", "type": "User", "site_admin": false}, "repo": {"id": 81326787, "node_id": "MDEwOlJlcG9zaXRvcnk4MTMyNjc4Nw==", "name": "tensorflow", "full_name": "PhilJd/tensorflow", "private": false, "owner": {"login": "PhilJd", "id": 16101605, "node_id": "MDQ6VXNlcjE2MTAxNjA1", "avatar_url": "https://avatars2.githubusercontent.com/u/16101605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilJd", "html_url": "https://github.com/PhilJd", "followers_url": "https://api.github.com/users/PhilJd/followers", "following_url": "https://api.github.com/users/PhilJd/following{/other_user}", "gists_url": "https://api.github.com/users/PhilJd/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilJd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilJd/subscriptions", "organizations_url": "https://api.github.com/users/PhilJd/orgs", "repos_url": "https://api.github.com/users/PhilJd/repos", "events_url": "https://api.github.com/users/PhilJd/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilJd/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/PhilJd/tensorflow", "description": "Development fork.", "fork": true, "url": "https://api.github.com/repos/PhilJd/tensorflow", "forks_url": "https://api.github.com/repos/PhilJd/tensorflow/forks", "keys_url": "https://api.github.com/repos/PhilJd/tensorflow/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/PhilJd/tensorflow/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/PhilJd/tensorflow/teams", "hooks_url": "https://api.github.com/repos/PhilJd/tensorflow/hooks", "issue_events_url": "https://api.github.com/repos/PhilJd/tensorflow/issues/events{/number}", "events_url": "https://api.github.com/repos/PhilJd/tensorflow/events", "assignees_url": "https://api.github.com/repos/PhilJd/tensorflow/assignees{/user}", "branches_url": "https://api.github.com/repos/PhilJd/tensorflow/branches{/branch}", "tags_url": "https://api.github.com/repos/PhilJd/tensorflow/tags", "blobs_url": "https://api.github.com/repos/PhilJd/tensorflow/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/PhilJd/tensorflow/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/PhilJd/tensorflow/git/refs{/sha}", "trees_url": "https://api.github.com/repos/PhilJd/tensorflow/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/PhilJd/tensorflow/statuses/{sha}", "languages_url": "https://api.github.com/repos/PhilJd/tensorflow/languages", "stargazers_url": "https://api.github.com/repos/PhilJd/tensorflow/stargazers", "contributors_url": "https://api.github.com/repos/PhilJd/tensorflow/contributors", "subscribers_url": "https://api.github.com/repos/PhilJd/tensorflow/subscribers", "subscription_url": "https://api.github.com/repos/PhilJd/tensorflow/subscription", "commits_url": "https://api.github.com/repos/PhilJd/tensorflow/commits{/sha}", "git_commits_url": "https://api.github.com/repos/PhilJd/tensorflow/git/commits{/sha}", "comments_url": "https://api.github.com/repos/PhilJd/tensorflow/comments{/number}", "issue_comment_url": "https://api.github.com/repos/PhilJd/tensorflow/issues/comments{/number}", "contents_url": "https://api.github.com/repos/PhilJd/tensorflow/contents/{+path}", "compare_url": "https://api.github.com/repos/PhilJd/tensorflow/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/PhilJd/tensorflow/merges", "archive_url": "https://api.github.com/repos/PhilJd/tensorflow/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/PhilJd/tensorflow/downloads", "issues_url": "https://api.github.com/repos/PhilJd/tensorflow/issues{/number}", "pulls_url": "https://api.github.com/repos/PhilJd/tensorflow/pulls{/number}", "milestones_url": "https://api.github.com/repos/PhilJd/tensorflow/milestones{/number}", "notifications_url": "https://api.github.com/repos/PhilJd/tensorflow/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/PhilJd/tensorflow/labels{/name}", "releases_url": "https://api.github.com/repos/PhilJd/tensorflow/releases{/id}", "deployments_url": "https://api.github.com/repos/PhilJd/tensorflow/deployments", "created_at": "2017-02-08T12:16:24Z", "updated_at": "2018-09-12T07:40:59Z", "pushed_at": "2018-09-12T07:39:52Z", "git_url": "git://github.com/PhilJd/tensorflow.git", "ssh_url": "git@github.com:PhilJd/tensorflow.git", "clone_url": "https://github.com/PhilJd/tensorflow.git", "svn_url": "https://github.com/PhilJd/tensorflow", "homepage": "http://tensorflow.org", "size": 254319, "stargazers_count": 0, "watchers_count": 0, "language": "C++", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "forks_count": 0, "mirror_url": null, "archived": false, "open_issues_count": 0, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "tensorflow:master", "ref": "master", "sha": "5fa7b03a255d3c0d05aa48e7604a94185ef6b9e2", "user": {"login": "tensorflow", "id": 15658638, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE1NjU4NjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15658638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tensorflow", "html_url": "https://github.com/tensorflow", "followers_url": "https://api.github.com/users/tensorflow/followers", "following_url": "https://api.github.com/users/tensorflow/following{/other_user}", "gists_url": "https://api.github.com/users/tensorflow/gists{/gist_id}", "starred_url": "https://api.github.com/users/tensorflow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tensorflow/subscriptions", "organizations_url": "https://api.github.com/users/tensorflow/orgs", "repos_url": "https://api.github.com/users/tensorflow/repos", "events_url": "https://api.github.com/users/tensorflow/events{/privacy}", "received_events_url": "https://api.github.com/users/tensorflow/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 45717250, "node_id": "MDEwOlJlcG9zaXRvcnk0NTcxNzI1MA==", "name": "tensorflow", "full_name": "tensorflow/tensorflow", "private": false, "owner": {"login": "tensorflow", "id": 15658638, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE1NjU4NjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15658638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tensorflow", "html_url": "https://github.com/tensorflow", "followers_url": "https://api.github.com/users/tensorflow/followers", "following_url": "https://api.github.com/users/tensorflow/following{/other_user}", "gists_url": "https://api.github.com/users/tensorflow/gists{/gist_id}", "starred_url": "https://api.github.com/users/tensorflow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tensorflow/subscriptions", "organizations_url": "https://api.github.com/users/tensorflow/orgs", "repos_url": "https://api.github.com/users/tensorflow/repos", "events_url": "https://api.github.com/users/tensorflow/events{/privacy}", "received_events_url": "https://api.github.com/users/tensorflow/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/tensorflow/tensorflow", "description": "An Open Source Machine Learning Framework for Everyone", "fork": false, "url": "https://api.github.com/repos/tensorflow/tensorflow", "forks_url": "https://api.github.com/repos/tensorflow/tensorflow/forks", "keys_url": "https://api.github.com/repos/tensorflow/tensorflow/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/tensorflow/tensorflow/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/tensorflow/tensorflow/teams", "hooks_url": "https://api.github.com/repos/tensorflow/tensorflow/hooks", "issue_events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/events{/number}", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/events", "assignees_url": "https://api.github.com/repos/tensorflow/tensorflow/assignees{/user}", "branches_url": "https://api.github.com/repos/tensorflow/tensorflow/branches{/branch}", "tags_url": "https://api.github.com/repos/tensorflow/tensorflow/tags", "blobs_url": "https://api.github.com/repos/tensorflow/tensorflow/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/tensorflow/tensorflow/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/tensorflow/tensorflow/git/refs{/sha}", "trees_url": "https://api.github.com/repos/tensorflow/tensorflow/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/tensorflow/tensorflow/statuses/{sha}", "languages_url": "https://api.github.com/repos/tensorflow/tensorflow/languages", "stargazers_url": "https://api.github.com/repos/tensorflow/tensorflow/stargazers", "contributors_url": "https://api.github.com/repos/tensorflow/tensorflow/contributors", "subscribers_url": "https://api.github.com/repos/tensorflow/tensorflow/subscribers", "subscription_url": "https://api.github.com/repos/tensorflow/tensorflow/subscription", "commits_url": "https://api.github.com/repos/tensorflow/tensorflow/commits{/sha}", "git_commits_url": "https://api.github.com/repos/tensorflow/tensorflow/git/commits{/sha}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/comments{/number}", "issue_comment_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments{/number}", "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/{+path}", "compare_url": "https://api.github.com/repos/tensorflow/tensorflow/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/tensorflow/tensorflow/merges", "archive_url": "https://api.github.com/repos/tensorflow/tensorflow/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/tensorflow/tensorflow/downloads", "issues_url": "https://api.github.com/repos/tensorflow/tensorflow/issues{/number}", "pulls_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls{/number}", "milestones_url": "https://api.github.com/repos/tensorflow/tensorflow/milestones{/number}", "notifications_url": "https://api.github.com/repos/tensorflow/tensorflow/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/labels{/name}", "releases_url": "https://api.github.com/repos/tensorflow/tensorflow/releases{/id}", "deployments_url": "https://api.github.com/repos/tensorflow/tensorflow/deployments", "created_at": "2015-11-07T01:19:20Z", "updated_at": "2018-11-24T20:25:08Z", "pushed_at": "2018-11-24T18:40:19Z", "git_url": "git://github.com/tensorflow/tensorflow.git", "ssh_url": "git@github.com:tensorflow/tensorflow.git", "clone_url": "https://github.com/tensorflow/tensorflow.git", "svn_url": "https://github.com/tensorflow/tensorflow", "homepage": "https://tensorflow.org", "size": 284546, "stargazers_count": 115177, "watchers_count": 115177, "language": "C++", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "forks_count": 69947, "mirror_url": null, "archived": false, "open_issues_count": 1759, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "forks": 69947, "open_issues": 1759, "watchers": 115177, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17438"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/17438"}, "issue": {"href": "https://api.github.com/repos/tensorflow/tensorflow/issues/17438"}, "comments": {"href": "https://api.github.com/repos/tensorflow/tensorflow/issues/17438/comments"}, "review_comments": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17438/comments"}, "review_comment": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17438/commits"}, "statuses": {"href": "https://api.github.com/repos/tensorflow/tensorflow/statuses/20b120c10c76e53873208fecaba4b7fc5263be6e"}}, "author_association": "CONTRIBUTOR", "body_html": "<p>This pull request implements decoupled weight decay as described in 'Fixing Weight Decay Regularization' by  Loshchilov &amp; Hutter <a href=\"https://arxiv.org/abs/1711.05101\" rel=\"nofollow\">https://arxiv.org/abs/1711.05101</a>.</p>\n<p>This paper shows that for adaptive gradient algorithms, the implemented method regularizes variables with large gradients more than L2 regularization would and that this  yields better training loss and generalization error.</p>\n<p>For SGD variants, this simplifies hyperparameter search since it decouples the settings of weight decay and learning rate, which is nicely visualized in Fig. 2 in the paper:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/16101605/36976180-f2fcbf92-207c-11e8-879e-4677381d892d.png\"><img src=\"https://user-images.githubusercontent.com/16101605/36976180-f2fcbf92-207c-11e8-879e-4677381d892d.png\" alt=\"adamw\" style=\"max-width:100%;\"></a></p>\n<p>This implementation explicitly adds the optimizers described in the paper (<code>AdamW</code> and <code>MomentumW</code>) to tf.contrib.opt and provides a factory function <code>extend_with_decoupled_weight_decay</code> that can be used to create a new optimizer class with decoupled weight decay.</p>\n<p><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #15237.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"280728601\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/15237\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/15237/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/15237\">#15237</a>.</p>", "body_text": "This pull request implements decoupled weight decay as described in 'Fixing Weight Decay Regularization' by  Loshchilov & Hutter https://arxiv.org/abs/1711.05101.\nThis paper shows that for adaptive gradient algorithms, the implemented method regularizes variables with large gradients more than L2 regularization would and that this  yields better training loss and generalization error.\nFor SGD variants, this simplifies hyperparameter search since it decouples the settings of weight decay and learning rate, which is nicely visualized in Fig. 2 in the paper:\n\nThis implementation explicitly adds the optimizers described in the paper (AdamW and MomentumW) to tf.contrib.opt and provides a factory function extend_with_decoupled_weight_decay that can be used to create a new optimizer class with decoupled weight decay.\nCloses #15237.", "merged": true, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "comments": 22, "review_comments": 3, "maintainer_can_modify": false, "commits": 4, "additions": 541, "deletions": 0, "changed_files": 4}