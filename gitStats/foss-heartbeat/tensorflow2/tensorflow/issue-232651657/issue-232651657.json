{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10350", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10350/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10350/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/10350/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/10350", "id": 232651657, "node_id": "MDU6SXNzdWUyMzI2NTE2NTc=", "number": 10350, "title": "Build Android demo, ambiguous python reference", "user": {"login": "osdamv", "id": 4120796, "node_id": "MDQ6VXNlcjQxMjA3OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4120796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/osdamv", "html_url": "https://github.com/osdamv", "followers_url": "https://api.github.com/users/osdamv/followers", "following_url": "https://api.github.com/users/osdamv/following{/other_user}", "gists_url": "https://api.github.com/users/osdamv/gists{/gist_id}", "starred_url": "https://api.github.com/users/osdamv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/osdamv/subscriptions", "organizations_url": "https://api.github.com/users/osdamv/orgs", "repos_url": "https://api.github.com/users/osdamv/repos", "events_url": "https://api.github.com/users/osdamv/events{/privacy}", "received_events_url": "https://api.github.com/users/osdamv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug/performance", "name": "type:bug/performance", "color": "159b2e", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-05-31T18:17:46Z", "updated_at": "2018-01-24T13:09:05Z", "closed_at": "2017-06-01T01:38:54Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi, while I was building the android demo with the command <code>bazel build -c opt //tensorflow/examples/android:tensorflow_demo --verbose_failures</code>,  it throw the error:</p>\n<pre><code>ERROR: /home/damian/ai/tensorflow/tensorflow/examples/android/BUILD:63:1: Extracting Java resources from deploy jar for split Java resource apk failed: resource_extractor failed: error executing command \n  (cd /home/damian/.cache/bazel/_bazel_damian/80fc8f2224411108cd5fffb32690db73/execroot/tensorflow &amp;&amp; \\\n  exec env - \\\n  bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor bazel-out/local-opt/bin/tensorflow/examples/android/tensorflow_demo_deploy.jar bazel-out/local-opt/bin/tensorflow/examples/android/_dx/tensorflow_demo/extracted_tensorflow_demo_deploy.jar): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\n  File \"/home/damian/.cache/bazel/_bazel_damian/80fc8f2224411108cd5fffb32690db73/execroot/tensorflow/bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor.runfiles/org_tensorflow/../bazel_tools/tools/android/resource_extractor.py\", line 98\n    print USAGE\n              ^\nSyntaxError: Missing parentheses in call to print\n\n</code></pre>\n<p>I debuged the error and the cause is in the file <code>bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor</code> around the line 35:</p>\n<pre><code>PYTHON_BINARY = 'python'\nif IsWindows() and not PYTHON_BINARY.endswith('.exe'):\n  PYTHON_BINARY = PYTHON_BINARY + '.exe'\n\n# Find a file in a given search path.\ndef SearchPath(name):\n  search_path = os.getenv('PATH', os.defpath).split(os.pathsep)\n  for directory in search_path:\n    if directory == '': continue\n    path = os.path.join(directory, name)\n    if os.path.isfile(path) and os.access(path, os.X_OK):\n      return path\n  return None\n\ndef IsRunningFromZip():\n  return False\n\n# Find the real Python binary if it's not a normal absolute path\ndef FindPythonBinary():\n  if PYTHON_BINARY.startswith('//'):\n    # Case 1: Path is a label. Not supported yet.\n    raise AssertionError(\n      'Bazel does not support execution of Python interpreters via labels yet')\n  elif PYTHON_BINARY.startswith('/'):\n    # Case 2: Absolute path.\n    return PYTHON_BINARY\n  elif '/' in PYTHON_BINARY:\n    # Case 3: Path is relative to current working directory.\n    return os.path.join(os.getcwd(), PYTHON_BINARY)\n  else:\n    # Case 4: Path has to be looked up in the search path.\n    return SearchPath(PYTHON_BINARY)\n\n</code></pre>\n<p>the script  need and assumes the default /usr/bin/python is linked to python 2.x wich in my case is not,<br>\nMy current work around is a simple <code>ln -sf /usr/bin/python2 /usr/bin/python</code>.</p>\n<p>I would like to patch but I dont have idea where is the file <code>bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor</code> because is an autogen script, I tried look for it in the bazel repo but I can't find it</p>", "body_text": "Hi, while I was building the android demo with the command bazel build -c opt //tensorflow/examples/android:tensorflow_demo --verbose_failures,  it throw the error:\nERROR: /home/damian/ai/tensorflow/tensorflow/examples/android/BUILD:63:1: Extracting Java resources from deploy jar for split Java resource apk failed: resource_extractor failed: error executing command \n  (cd /home/damian/.cache/bazel/_bazel_damian/80fc8f2224411108cd5fffb32690db73/execroot/tensorflow && \\\n  exec env - \\\n  bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor bazel-out/local-opt/bin/tensorflow/examples/android/tensorflow_demo_deploy.jar bazel-out/local-opt/bin/tensorflow/examples/android/_dx/tensorflow_demo/extracted_tensorflow_demo_deploy.jar): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\n  File \"/home/damian/.cache/bazel/_bazel_damian/80fc8f2224411108cd5fffb32690db73/execroot/tensorflow/bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor.runfiles/org_tensorflow/../bazel_tools/tools/android/resource_extractor.py\", line 98\n    print USAGE\n              ^\nSyntaxError: Missing parentheses in call to print\n\n\nI debuged the error and the cause is in the file bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor around the line 35:\nPYTHON_BINARY = 'python'\nif IsWindows() and not PYTHON_BINARY.endswith('.exe'):\n  PYTHON_BINARY = PYTHON_BINARY + '.exe'\n\n# Find a file in a given search path.\ndef SearchPath(name):\n  search_path = os.getenv('PATH', os.defpath).split(os.pathsep)\n  for directory in search_path:\n    if directory == '': continue\n    path = os.path.join(directory, name)\n    if os.path.isfile(path) and os.access(path, os.X_OK):\n      return path\n  return None\n\ndef IsRunningFromZip():\n  return False\n\n# Find the real Python binary if it's not a normal absolute path\ndef FindPythonBinary():\n  if PYTHON_BINARY.startswith('//'):\n    # Case 1: Path is a label. Not supported yet.\n    raise AssertionError(\n      'Bazel does not support execution of Python interpreters via labels yet')\n  elif PYTHON_BINARY.startswith('/'):\n    # Case 2: Absolute path.\n    return PYTHON_BINARY\n  elif '/' in PYTHON_BINARY:\n    # Case 3: Path is relative to current working directory.\n    return os.path.join(os.getcwd(), PYTHON_BINARY)\n  else:\n    # Case 4: Path has to be looked up in the search path.\n    return SearchPath(PYTHON_BINARY)\n\n\nthe script  need and assumes the default /usr/bin/python is linked to python 2.x wich in my case is not,\nMy current work around is a simple ln -sf /usr/bin/python2 /usr/bin/python.\nI would like to patch but I dont have idea where is the file bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor because is an autogen script, I tried look for it in the bazel repo but I can't find it", "body": "Hi, while I was building the android demo with the command `bazel build -c opt //tensorflow/examples/android:tensorflow_demo --verbose_failures`,  it throw the error: \r\n\r\n```\r\nERROR: /home/damian/ai/tensorflow/tensorflow/examples/android/BUILD:63:1: Extracting Java resources from deploy jar for split Java resource apk failed: resource_extractor failed: error executing command \r\n  (cd /home/damian/.cache/bazel/_bazel_damian/80fc8f2224411108cd5fffb32690db73/execroot/tensorflow && \\\r\n  exec env - \\\r\n  bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor bazel-out/local-opt/bin/tensorflow/examples/android/tensorflow_demo_deploy.jar bazel-out/local-opt/bin/tensorflow/examples/android/_dx/tensorflow_demo/extracted_tensorflow_demo_deploy.jar): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\r\n  File \"/home/damian/.cache/bazel/_bazel_damian/80fc8f2224411108cd5fffb32690db73/execroot/tensorflow/bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor.runfiles/org_tensorflow/../bazel_tools/tools/android/resource_extractor.py\", line 98\r\n    print USAGE\r\n              ^\r\nSyntaxError: Missing parentheses in call to print\r\n\r\n```\r\n\r\nI debuged the error and the cause is in the file `bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor` around the line 35:  \r\n\r\n```\r\nPYTHON_BINARY = 'python'\r\nif IsWindows() and not PYTHON_BINARY.endswith('.exe'):\r\n  PYTHON_BINARY = PYTHON_BINARY + '.exe'\r\n\r\n# Find a file in a given search path.\r\ndef SearchPath(name):\r\n  search_path = os.getenv('PATH', os.defpath).split(os.pathsep)\r\n  for directory in search_path:\r\n    if directory == '': continue\r\n    path = os.path.join(directory, name)\r\n    if os.path.isfile(path) and os.access(path, os.X_OK):\r\n      return path\r\n  return None\r\n\r\ndef IsRunningFromZip():\r\n  return False\r\n\r\n# Find the real Python binary if it's not a normal absolute path\r\ndef FindPythonBinary():\r\n  if PYTHON_BINARY.startswith('//'):\r\n    # Case 1: Path is a label. Not supported yet.\r\n    raise AssertionError(\r\n      'Bazel does not support execution of Python interpreters via labels yet')\r\n  elif PYTHON_BINARY.startswith('/'):\r\n    # Case 2: Absolute path.\r\n    return PYTHON_BINARY\r\n  elif '/' in PYTHON_BINARY:\r\n    # Case 3: Path is relative to current working directory.\r\n    return os.path.join(os.getcwd(), PYTHON_BINARY)\r\n  else:\r\n    # Case 4: Path has to be looked up in the search path.\r\n    return SearchPath(PYTHON_BINARY)\r\n\r\n```\r\n\r\nthe script  need and assumes the default /usr/bin/python is linked to python 2.x wich in my case is not,\r\nMy current work around is a simple `ln -sf /usr/bin/python2 /usr/bin/python`.\r\n\r\nI would like to patch but I dont have idea where is the file `bazel-out/host/bin/external/bazel_tools/tools/android/resource_extractor` because is an autogen script, I tried look for it in the bazel repo but I can't find it "}