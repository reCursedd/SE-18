{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/405154274", "html_url": "https://github.com/tensorflow/tensorflow/issues/20677#issuecomment-405154274", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/20677", "id": 405154274, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTE1NDI3NA==", "user": {"login": "zjfheart", "id": 10344081, "node_id": "MDQ6VXNlcjEwMzQ0MDgx", "avatar_url": "https://avatars3.githubusercontent.com/u/10344081?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zjfheart", "html_url": "https://github.com/zjfheart", "followers_url": "https://api.github.com/users/zjfheart/followers", "following_url": "https://api.github.com/users/zjfheart/following{/other_user}", "gists_url": "https://api.github.com/users/zjfheart/gists{/gist_id}", "starred_url": "https://api.github.com/users/zjfheart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zjfheart/subscriptions", "organizations_url": "https://api.github.com/users/zjfheart/orgs", "repos_url": "https://api.github.com/users/zjfheart/repos", "events_url": "https://api.github.com/users/zjfheart/events{/privacy}", "received_events_url": "https://api.github.com/users/zjfheart/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T05:51:17Z", "updated_at": "2018-07-16T05:52:11Z", "author_association": "NONE", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=22967383\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/wdirons\">@wdirons</a><br>\nThanks for response.</p>\n<p>I cherry-picked the fix by:</p>\n<pre><code>git clone https://github.com/tensorflow/tensorflow\ncd tensorflow\ngit remote add wdirons https://github.com/wdirons/tensorflow\ngit fetch wdirons\ngit cherry-pick --no-commit 8a5c6c4c305905a206065b0f5fa9a86c03876428\n</code></pre>\n<p>(without \"--no-commit\", there will be \"cherry-pick error: Your local changes would be overwritten by cherry-pick.\" )</p>\n<p>Then I bazel build it, but still get C++ compilation errors.</p>\n<p>[root@Jingfeng_redhat tensorflow]# bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package<br>\nERROR: /root/.cache/bazel/<em>bazel_root/efb88f6336d9c4a18216fb94287b8d97/external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/BUILD:30:1: C++ compilation of rule '@com_github_googlecloudplatform_google_cloud_cpp//google/cloud/bigtable:bigtable_client' failed (Exit 1)<br>\nIn file included from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/row_reader.h:22:0,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/table.h:25,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.h:19,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.cc:15:<br>\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h: In member function 'const google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:bigtable::v0::Row&amp;&amp; google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:bigtable::v0::internal::RowReaderIterator::operator*() const &amp;&amp;':<br>\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:57:44: error: ambiguous overload for 'operator*' (operand type is 'std::remove_reference&lt;const google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:v0::internal::optionalgoogle:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:bigtable::v0::Row&amp;&gt;::type {aka const google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:v0::internal::optionalgoogle:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:bigtable::v0::Row}')<br>\nRow const&amp;&amp; operator*() const&amp;&amp; { return *std::move(row</em>); }<br>\n^<br>\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:57:44: note: candidates are:<br>\nIn file included from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:19:0,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/row_reader.h:22,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/table.h:25,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.h:19,<br>\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.cc:15:<br>\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/internal/optional.h:121:22: note: constexpr const T&amp; google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:v0::internal::optional::operator*() const &amp; [with T = google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:bigtable::v0::Row]<br>\nconstexpr T const&amp; operator*() const&amp; {<br>\n^<br>\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/internal/optional.h:126:23: note: constexpr const T&amp;&amp; google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:v0::internal::optional::operator*() const &amp;&amp; [with T = google:<g-emoji class=\"g-emoji\" alias=\"cloud\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/2601.png\">\u2601\ufe0f</g-emoji>:bigtable::v0::Row]<br>\nconstexpr T const&amp;&amp; operator*() const&amp;&amp; {<br>\n^<br>\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build<br>\nUse --verbose_failures to see the command lines of failed build steps.<br>\nINFO: Elapsed time: 103.567s, Critical Path: 73.97s<br>\nFAILED: Build did NOT complete successfully</p>", "body_text": "Hi @wdirons\nThanks for response.\nI cherry-picked the fix by:\ngit clone https://github.com/tensorflow/tensorflow\ncd tensorflow\ngit remote add wdirons https://github.com/wdirons/tensorflow\ngit fetch wdirons\ngit cherry-pick --no-commit 8a5c6c4c305905a206065b0f5fa9a86c03876428\n\n(without \"--no-commit\", there will be \"cherry-pick error: Your local changes would be overwritten by cherry-pick.\" )\nThen I bazel build it, but still get C++ compilation errors.\n[root@Jingfeng_redhat tensorflow]# bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\nERROR: /root/.cache/bazel/bazel_root/efb88f6336d9c4a18216fb94287b8d97/external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/BUILD:30:1: C++ compilation of rule '@com_github_googlecloudplatform_google_cloud_cpp//google/cloud/bigtable:bigtable_client' failed (Exit 1)\nIn file included from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/row_reader.h:22:0,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/table.h:25,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.h:19,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.cc:15:\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h: In member function 'const google:\u2601\ufe0f:bigtable::v0::Row&& google:\u2601\ufe0f:bigtable::v0::internal::RowReaderIterator::operator*() const &&':\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:57:44: error: ambiguous overload for 'operator*' (operand type is 'std::remove_reference<const google:\u2601\ufe0f:v0::internal::optionalgoogle:\u2601\ufe0f:bigtable::v0::Row&>::type {aka const google:\u2601\ufe0f:v0::internal::optionalgoogle:\u2601\ufe0f:bigtable::v0::Row}')\nRow const&& operator*() const&& { return *std::move(row); }\n^\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:57:44: note: candidates are:\nIn file included from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:19:0,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/row_reader.h:22,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/table.h:25,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.h:19,\nfrom external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.cc:15:\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/internal/optional.h:121:22: note: constexpr const T& google:\u2601\ufe0f:v0::internal::optional::operator*() const & [with T = google:\u2601\ufe0f:bigtable::v0::Row]\nconstexpr T const& operator*() const& {\n^\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/internal/optional.h:126:23: note: constexpr const T&& google:\u2601\ufe0f:v0::internal::optional::operator*() const && [with T = google:\u2601\ufe0f:bigtable::v0::Row]\nconstexpr T const&& operator*() const&& {\n^\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 103.567s, Critical Path: 73.97s\nFAILED: Build did NOT complete successfully", "body": "Hi @wdirons \r\nThanks for response. \r\n\r\nI cherry-picked the fix by: \r\n```\r\ngit clone https://github.com/tensorflow/tensorflow\r\ncd tensorflow\r\ngit remote add wdirons https://github.com/wdirons/tensorflow\r\ngit fetch wdirons\r\ngit cherry-pick --no-commit 8a5c6c4c305905a206065b0f5fa9a86c03876428\r\n```\r\n(without \"--no-commit\", there will be \"cherry-pick error: Your local changes would be overwritten by cherry-pick.\" ) \r\n\r\nThen I bazel build it, but still get C++ compilation errors.\r\n \r\n[root@Jingfeng_redhat tensorflow]# bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\r\nERROR: /root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/BUILD:30:1: C++ compilation of rule '@com_github_googlecloudplatform_google_cloud_cpp//google/cloud/bigtable:bigtable_client' failed (Exit 1)\r\nIn file included from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/row_reader.h:22:0,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/table.h:25,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.h:19,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.cc:15:\r\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h: In member function 'const google::cloud::bigtable::v0::Row&& google::cloud::bigtable::v0::internal::RowReaderIterator::operator*() const &&':\r\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:57:44: error: ambiguous overload for 'operator*' (operand type is 'std::remove_reference<const google::cloud::v0::internal::optional<google::cloud::bigtable::v0::Row>&>::type {aka const google::cloud::v0::internal::optional<google::cloud::bigtable::v0::Row>}')\r\n   Row const&& operator*() const&& { return *std::move(row_); }\r\n                                            ^\r\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:57:44: note: candidates are:\r\nIn file included from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/rowreaderiterator.h:19:0,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/row_reader.h:22,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/internal/table.h:25,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.h:19,\r\n                 from external/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/bigtable/table.cc:15:\r\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/internal/optional.h:121:22: note: constexpr const T& google::cloud::v0::internal::optional<T>::operator*() const & [with T = google::cloud::bigtable::v0::Row]\r\n   constexpr T const& operator*() const& {\r\n                      ^\r\nexternal/com_github_googlecloudplatform_google_cloud_cpp/google/cloud/internal/optional.h:126:23: note: constexpr const T&& google::cloud::v0::internal::optional<T>::operator*() const && [with T = google::cloud::bigtable::v0::Row]\r\n   constexpr T const&& operator*() const&& {\r\n                       ^\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 103.567s, Critical Path: 73.97s\r\nFAILED: Build did NOT complete successfully\r\n "}