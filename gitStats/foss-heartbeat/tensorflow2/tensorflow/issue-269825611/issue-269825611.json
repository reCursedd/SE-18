{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14117", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14117/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14117/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/14117/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/14117", "id": 269825611, "node_id": "MDU6SXNzdWUyNjk4MjU2MTE=", "number": 14117, "title": "Error in CMake generated build script", "user": {"login": "cloudhan", "id": 1279292, "node_id": "MDQ6VXNlcjEyNzkyOTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1279292?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloudhan", "html_url": "https://github.com/cloudhan", "followers_url": "https://api.github.com/users/cloudhan/followers", "following_url": "https://api.github.com/users/cloudhan/following{/other_user}", "gists_url": "https://api.github.com/users/cloudhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloudhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloudhan/subscriptions", "organizations_url": "https://api.github.com/users/cloudhan/orgs", "repos_url": "https://api.github.com/users/cloudhan/repos", "events_url": "https://api.github.com/users/cloudhan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloudhan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-10-31T03:49:01Z", "updated_at": "2018-04-05T14:47:01Z", "closed_at": null, "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Windows 10 1709</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: source</li>\n<li><strong>TensorFlow version (use command below)</strong>: 1.4.0-rc1</li>\n<li><strong>Python version</strong>: 3.5</li>\n<li><strong>Bazel version (if compiling from source)</strong>: - (I use cmake)</li>\n<li><strong>CUDA/cuDNN version</strong>: 9.0/7</li>\n<li><strong>GPU model and memory</strong>: Notebook 1070 8G</li>\n<li><strong>Exact command to reproduce</strong>:<br>\nUse cmake to generate build script for <code>Visual Studio 2017 Win64</code><br>\n<code>CMAKE_C_COMPILER</code>, <code>CMAKE_CXX_COMPILER</code> and <code>CUDA_HOST_COMPILER</code> should be set manually, otherwise, it will failed the compilation phase calling to NVCC</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>This problem happens when building with Visual Studio 2017.4 + CUDA 9.0 + cuDNN 7 + CMake + GPU build.</p>\n<p>Sorry for lack of information. I build it yesterday (and failed) and it take so long the compile through and I didn't keep the log. This problem is LINK ERRORs. What I can identify is they are in the generated build script. The problems happens exactly  in</p>\n<pre><code>_beam_search_ops.vcxproj\n_gru_ops.vcxproj\n_lstm_ops.vcxproj\n_nearest_neighbor_ops.vcxproj\n</code></pre>\n<p>e.g. in  <code>_beam_search_ops.vcxproj</code> around line 103</p>\n<pre><code>    &lt;Link&gt;\n      &lt;AdditionalDependencies&gt;\\pywrap_tensorflow_internal.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cudart_static.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cuda.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cublas.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cublas_device.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cufft.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\curand.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\extras\\CUPTI\\libx64\\cupti.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cusolver.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cudnn.lib;kernel32.lib;user32.lib;gdi32.lib;winspool.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;comdlg32.lib;advapi32.lib&lt;/AdditionalDependencies&gt;\n      &lt;AdditionalLibraryDirectories&gt;%(AdditionalLibraryDirectories)&lt;/AdditionalLibraryDirectories&gt;\n      &lt;AdditionalOptions&gt;%(AdditionalOptions) /machine:x64 /ignore:4049 /ignore:4197 /ignore:4217 /ignore:4221&lt;/AdditionalOptions&gt;\n      &lt;GenerateDebugInformation&gt;false&lt;/GenerateDebugInformation&gt;\n      &lt;IgnoreSpecificDefaultLibraries&gt;%(IgnoreSpecificDefaultLibraries)&lt;/IgnoreSpecificDefaultLibraries&gt;\n      &lt;ImportLibrary&gt;D:/workspaces/tensorflow/tensorflow/contrib/cmake/build/Release/_beam_search_ops.lib&lt;/ImportLibrary&gt;\n      &lt;ProgramDataBaseFile&gt;D:/workspaces/tensorflow/tensorflow/contrib/cmake/build/Release/_beam_search_ops.pdb&lt;/ProgramDataBaseFile&gt;\n      &lt;SubSystem&gt;Console&lt;/SubSystem&gt;\n    &lt;/Link&gt;\n</code></pre>\n<p>You can see a <code>\\pywrap_tensorflow_internal.lib</code> in <code>&lt;AdditionalDependencies&gt;</code> cause the LINK ERROR, since the linker can't find file <code>pywrap_tensorflow_internal.lib</code>.</p>\n<p>The prefix <strong>backslash</strong> seems to be the cause. I suspect it should be some <code>${BLAH_env_VARIBALE}pywrap_tensorflow_internal.lib</code> and this <code>${BLAH_env_VARIBALE}</code> happens to be empty string and results to a <code>\\pywrap_tensorflow_internal.lib</code>.</p>\n<p>All four <code>.vcxproj</code> files comes from function call <code>AddUserOps</code> in <code>tf_python.cmake</code> , where the <code>AddUserOps</code> is defined in <code>tf_cc_ops.cmake</code> file. Due to my poor eye sight, I can't decide where is the problem from here...</p>\n<p>Notice, I CAN see the file <code>pywrap_tensorflow_internal.lib</code> in some directory so it should be problem related with the path .</p>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 1709\nTensorFlow installed from (source or binary): source\nTensorFlow version (use command below): 1.4.0-rc1\nPython version: 3.5\nBazel version (if compiling from source): - (I use cmake)\nCUDA/cuDNN version: 9.0/7\nGPU model and memory: Notebook 1070 8G\nExact command to reproduce:\nUse cmake to generate build script for Visual Studio 2017 Win64\nCMAKE_C_COMPILER, CMAKE_CXX_COMPILER and CUDA_HOST_COMPILER should be set manually, otherwise, it will failed the compilation phase calling to NVCC\n\nDescribe the problem\nThis problem happens when building with Visual Studio 2017.4 + CUDA 9.0 + cuDNN 7 + CMake + GPU build.\nSorry for lack of information. I build it yesterday (and failed) and it take so long the compile through and I didn't keep the log. This problem is LINK ERRORs. What I can identify is they are in the generated build script. The problems happens exactly  in\n_beam_search_ops.vcxproj\n_gru_ops.vcxproj\n_lstm_ops.vcxproj\n_nearest_neighbor_ops.vcxproj\n\ne.g. in  _beam_search_ops.vcxproj around line 103\n    <Link>\n      <AdditionalDependencies>\\pywrap_tensorflow_internal.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cudart_static.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cuda.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cublas.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cublas_device.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cufft.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\curand.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\extras\\CUPTI\\libx64\\cupti.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cusolver.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cudnn.lib;kernel32.lib;user32.lib;gdi32.lib;winspool.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;comdlg32.lib;advapi32.lib</AdditionalDependencies>\n      <AdditionalLibraryDirectories>%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>\n      <AdditionalOptions>%(AdditionalOptions) /machine:x64 /ignore:4049 /ignore:4197 /ignore:4217 /ignore:4221</AdditionalOptions>\n      <GenerateDebugInformation>false</GenerateDebugInformation>\n      <IgnoreSpecificDefaultLibraries>%(IgnoreSpecificDefaultLibraries)</IgnoreSpecificDefaultLibraries>\n      <ImportLibrary>D:/workspaces/tensorflow/tensorflow/contrib/cmake/build/Release/_beam_search_ops.lib</ImportLibrary>\n      <ProgramDataBaseFile>D:/workspaces/tensorflow/tensorflow/contrib/cmake/build/Release/_beam_search_ops.pdb</ProgramDataBaseFile>\n      <SubSystem>Console</SubSystem>\n    </Link>\n\nYou can see a \\pywrap_tensorflow_internal.lib in <AdditionalDependencies> cause the LINK ERROR, since the linker can't find file pywrap_tensorflow_internal.lib.\nThe prefix backslash seems to be the cause. I suspect it should be some ${BLAH_env_VARIBALE}pywrap_tensorflow_internal.lib and this ${BLAH_env_VARIBALE} happens to be empty string and results to a \\pywrap_tensorflow_internal.lib.\nAll four .vcxproj files comes from function call AddUserOps in tf_python.cmake , where the AddUserOps is defined in tf_cc_ops.cmake file. Due to my poor eye sight, I can't decide where is the problem from here...\nNotice, I CAN see the file pywrap_tensorflow_internal.lib in some directory so it should be problem related with the path .", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10 1709\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.4.0-rc1\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**: - (I use cmake)\r\n- **CUDA/cuDNN version**: 9.0/7\r\n- **GPU model and memory**: Notebook 1070 8G\r\n- **Exact command to reproduce**: \r\nUse cmake to generate build script for `Visual Studio 2017 Win64`\r\n`CMAKE_C_COMPILER`, `CMAKE_CXX_COMPILER` and `CUDA_HOST_COMPILER` should be set manually, otherwise, it will failed the compilation phase calling to NVCC\r\n\r\n\r\n### Describe the problem\r\nThis problem happens when building with Visual Studio 2017.4 + CUDA 9.0 + cuDNN 7 + CMake + GPU build.\r\n\r\nSorry for lack of information. I build it yesterday (and failed) and it take so long the compile through and I didn't keep the log. This problem is LINK ERRORs. What I can identify is they are in the generated build script. The problems happens exactly  in\r\n```\r\n_beam_search_ops.vcxproj\r\n_gru_ops.vcxproj\r\n_lstm_ops.vcxproj\r\n_nearest_neighbor_ops.vcxproj\r\n```\r\ne.g. in  `_beam_search_ops.vcxproj` around line 103\r\n```\r\n    <Link>\r\n      <AdditionalDependencies>\\pywrap_tensorflow_internal.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cudart_static.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cuda.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cublas.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cublas_device.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cufft.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\curand.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\extras\\CUPTI\\libx64\\cupti.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cusolver.lib;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.0\\lib\\x64\\cudnn.lib;kernel32.lib;user32.lib;gdi32.lib;winspool.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;comdlg32.lib;advapi32.lib</AdditionalDependencies>\r\n      <AdditionalLibraryDirectories>%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>\r\n      <AdditionalOptions>%(AdditionalOptions) /machine:x64 /ignore:4049 /ignore:4197 /ignore:4217 /ignore:4221</AdditionalOptions>\r\n      <GenerateDebugInformation>false</GenerateDebugInformation>\r\n      <IgnoreSpecificDefaultLibraries>%(IgnoreSpecificDefaultLibraries)</IgnoreSpecificDefaultLibraries>\r\n      <ImportLibrary>D:/workspaces/tensorflow/tensorflow/contrib/cmake/build/Release/_beam_search_ops.lib</ImportLibrary>\r\n      <ProgramDataBaseFile>D:/workspaces/tensorflow/tensorflow/contrib/cmake/build/Release/_beam_search_ops.pdb</ProgramDataBaseFile>\r\n      <SubSystem>Console</SubSystem>\r\n    </Link>\r\n```\r\n\r\nYou can see a `\\pywrap_tensorflow_internal.lib` in `<AdditionalDependencies>` cause the LINK ERROR, since the linker can't find file `pywrap_tensorflow_internal.lib`.\r\n\r\nThe prefix **backslash** seems to be the cause. I suspect it should be some `${BLAH_env_VARIBALE}pywrap_tensorflow_internal.lib` and this `${BLAH_env_VARIBALE}` happens to be empty string and results to a `\\pywrap_tensorflow_internal.lib`.\r\n\r\nAll four `.vcxproj` files comes from function call `AddUserOps` in `tf_python.cmake` , where the `AddUserOps` is defined in `tf_cc_ops.cmake` file. Due to my poor eye sight, I can't decide where is the problem from here...\r\n\r\nNotice, I CAN see the file `pywrap_tensorflow_internal.lib` in some directory so it should be problem related with the path ."}