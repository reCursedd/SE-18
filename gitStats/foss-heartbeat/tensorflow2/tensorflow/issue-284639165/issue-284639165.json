{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15650", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15650/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15650/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/15650/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/15650", "id": 284639165, "node_id": "MDU6SXNzdWUyODQ2MzkxNjU=", "number": 15650, "title": "Unable to compile tensorflow r1.4 from source with cuda 8.0 and cudnn 7 and after downgrading bazel?", "user": {"login": "kwotsin", "id": 11178344, "node_id": "MDQ6VXNlcjExMTc4MzQ0", "avatar_url": "https://avatars2.githubusercontent.com/u/11178344?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kwotsin", "html_url": "https://github.com/kwotsin", "followers_url": "https://api.github.com/users/kwotsin/followers", "following_url": "https://api.github.com/users/kwotsin/following{/other_user}", "gists_url": "https://api.github.com/users/kwotsin/gists{/gist_id}", "starred_url": "https://api.github.com/users/kwotsin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kwotsin/subscriptions", "organizations_url": "https://api.github.com/users/kwotsin/orgs", "repos_url": "https://api.github.com/users/kwotsin/repos", "events_url": "https://api.github.com/users/kwotsin/events{/privacy}", "received_events_url": "https://api.github.com/users/kwotsin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-12-27T03:02:31Z", "updated_at": "2018-01-05T13:50:41Z", "closed_at": "2018-01-05T13:50:41Z", "author_association": "CONTRIBUTOR", "body_html": "<h3>System information</h3>\n<ul>\n<li><strong>Have I written custom code (as opposed to using a stock example script provided in TensorFlow)</strong>: No</li>\n<li><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>: Ubuntu 16.04</li>\n<li><strong>TensorFlow installed from (source or binary)</strong>: Source</li>\n<li><strong>TensorFlow version (use command below)</strong>: r1.4</li>\n<li><strong>Python version</strong>:  2.7.12</li>\n<li><strong>Bazel version (if compiling from source)</strong>: 0.8.1</li>\n<li><strong>GCC/Compiler version (if compiling from source)</strong>: 5.4.0</li>\n<li><strong>CUDA/cuDNN version</strong>: 8.0/7.0.4</li>\n<li><strong>GPU model and memory</strong>: 1080 Ti</li>\n<li><strong>Exact command to reproduce</strong>:<br>\n<code>bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package --verbose_failures --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" --action_env=\"LD_LIBRARY_PATH=${LD_LIBRARY_PATH}\"</code></li>\n</ul>\n<h3>Describe the problem</h3>\n<p>I'm trying to compile TF r1.4 from source but didn't manage to get this working although I tried several fixes:</p>\n<ol>\n<li>\n<p>Downgrading bazel from 0.9.0 to 0.8.1 based on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"283346623\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/15492\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/15492/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/15492\">#15492</a></p>\n</li>\n<li>\n<p><code>sudo sh -c \"echo '/usr/local/cuda-8.0/lib64' &gt;&gt; /etc/ld.so.conf.d/nvidia.conf\"</code>  and <code>sudo ldconfig</code> based on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"262655193\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/13481\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/13481/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/13481\">#13481</a></p>\n</li>\n<li>\n<p>adding the <code>action_env</code> argument based on <a href=\"https://stackoverflow.com/questions/47080760/tensorflow-fails-to-compile/47295278#47295278\" rel=\"nofollow\">https://stackoverflow.com/questions/47080760/tensorflow-fails-to-compile/47295278#47295278</a></p>\n</li>\n</ol>\n<p>Note: When installing cudnn, I used both the runtime library and the tar file which i extracted and placed it in the /usr/local/cuda library respective folders.</p>\n<h3>Source code / logs</h3>\n<pre><code>ERROR: /home/kwotsin/tensorflow/tensorflow/core/BUILD:2131:1: C++ compilation of rule '//tensorflow/core:gpu_runtime_impl' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \n  (cd /home/kwotsin/.cache/bazel/_bazel_kwotsin/041f6cc3555a2d9f6211c6d126ede477/execroot/org_tensorflow &amp;&amp; \\\n  exec env - \\\n    LD_LIBRARY_PATH=/usr/local/cuda/lib64 \\\n    PATH=/usr/local/cuda/bin:/home/kwotsin/bin:/home/kwotsin/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \\\n    PWD=/proc/self/cwd \\\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections -g0 '-std=c++11' -g0 -MD -MF bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.d '-frandom-seed=bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DSNAPPY -iquote . -iquote bazel-out/host/genfiles -iquote external/bazel_tools -iquote bazel-out/host/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/host/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/host/genfiles/external/local_config_sycl -iquote external/nsync -iquote bazel-out/host/genfiles/external/nsync -iquote external/gif_archive -iquote bazel-out/host/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/host/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/host/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/host/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/host/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/host/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/host/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/host/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/host/genfiles/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/host/genfiles/external/local_config_cuda -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/host/genfiles/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/host/genfiles/external/nsync/public -isystem external/gif_archive/lib -isystem bazel-out/host/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/host/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/host/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/host/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/host/genfiles/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/host/genfiles/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/host/genfiles/external/local_config_cuda/cuda/cuda/include -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' -msse3 -pthread '-DGOOGLE_CUDA=1' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fno-canonical-system-headers -c tensorflow/core/common_runtime/gpu/gpu_device.cc -o bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.o)\nIn file included from ./tensorflow/stream_executor/stream_executor.h:35:0,\n                 from ./tensorflow/core/platform/stream_executor.h:38,\n                 from ./tensorflow/core/common_runtime/gpu/gpu_event_mgr.h:28,\n                 from ./tensorflow/core/common_runtime/gpu/gpu_device.h:30,\n                 from tensorflow/core/common_runtime/gpu/gpu_device.cc:22:\n./tensorflow/stream_executor/stream_executor_pimpl.h:87:63: internal compiler error: Segmentation fault\n   PlatformKind platform_kind() const { return platform_kind_; }\n                                                               ^\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee &lt;file:///usr/share/doc/gcc-5/README.Bugs&gt; for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 145.189s, Critical Path: 22.73s\nFAILED: Build did NOT complete successfully\n\n</code></pre>\n<p>Thank you.</p>\n<p>====</p>\n<p>Further updates:</p>\n<ol>\n<li>\n<p>I tried switching to the more updated 7.0.5 CuDNN (although some mentioned in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"248135560\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/12052\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/12052/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/12052\">#12052</a> that their build worked with 7.0.4. I'm now using CUDA 9.0 + CuDNN 7.05 for CUDA 9.0, and with bazel 0.8.1. The build unfortunately still doesn't work.</p>\n</li>\n<li>\n<p>CUDA 8.0 + CuDNN 6.0.21 also doesn't work, with the similar reasons as such:</p>\n</li>\n</ol>\n<pre><code>C++ compilation of rule '//tensorflow/core/kernels:sparse_conditional_accumulator_op' failed (Exit 1)\nIn file included from tensorflow/core/kernels/sparse_conditional_accumulator_op.cc:19:0:\n./tensorflow/core/kernels/sparse_conditional_accumulator.h: In destructor 'tensorflow::SparseConditionalAccumulator&lt;Device, T&gt;::~SparseConditionalAccumulator() [with Device = Eigen::ThreadPoolDevice; T = float]':\n./tensorflow/core/kernels/sparse_conditional_accumulator.h:68:3: internal compiler error: Segmentation fault\n   };\n   ^\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee &lt;file:///usr/share/doc/gcc-5/README.Bugs&gt; for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 505.239s, Critical Path: 114.19s\nFAILED: Build did NOT complete successfully\n\n</code></pre>\n<pre><code>ERROR: /home/kwotsin/tensorflow/tensorflow/core/kernels/BUILD:2554:1: C++ compilation of rule '//tensorflow/core/kernels:cwise_op' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \n  (cd /home/kwotsin/.cache/bazel/_bazel_kwotsin/041f6cc3555a2d9f6211c6d126ede477/execroot/org_tensorflow &amp;&amp; \\\n  exec env - \\\n    CUDA_TOOLKIT_PATH=/usr/local/cuda \\\n    CUDNN_INSTALL_PATH=/usr/local/cuda-9.0 \\\n    GCC_HOST_COMPILER_PATH=/usr/bin/gcc \\\n    PWD=/proc/self/cwd \\\n    PYTHON_BIN_PATH=/usr/bin/python \\\n    PYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \\\n    TF_CUDA_CLANG=0 \\\n    TF_CUDA_COMPUTE_CAPABILITIES=6.1 \\\n    TF_CUDA_VERSION=9.0 \\\n    TF_CUDNN_VERSION=7.0.5 \\\n    TF_NEED_CUDA=1 \\\n    TF_NEED_OPENCL=0 \\\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections '-march=native' '-std=c++11' '-march=native' '-D_GLIBCXX_USE_CXX11_ABI=0' -MD -MF bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DSNAPPY -iquote . -iquote bazel-out/k8-opt/genfiles -iquote external/nsync -iquote bazel-out/k8-opt/genfiles/external/nsync -iquote external/bazel_tools -iquote bazel-out/k8-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/k8-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/k8-opt/genfiles/external/local_config_sycl -iquote external/gif_archive -iquote bazel-out/k8-opt/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/k8-opt/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/k8-opt/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/k8-opt/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/k8-opt/genfiles/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/k8-opt/genfiles/external/local_config_cuda -isystem external/nsync/public -isystem bazel-out/k8-opt/genfiles/external/nsync/public -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/k8-opt/genfiles/external/eigen_archive -isystem external/gif_archive/lib -isystem bazel-out/k8-opt/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/k8-opt/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/k8-opt/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/k8-opt/genfiles/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda/cuda/include -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' -msse3 -pthread '-DGOOGLE_CUDA=1' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fno-canonical-system-headers -c tensorflow/core/kernels/cwise_op_floor_div.cc -o bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.o)\nIn file included from tensorflow/core/kernels/cwise_op_floor_div.cc:16:0:\n./tensorflow/core/kernels/cwise_ops_common.h: In instantiation of 'void tensorflow::functor::BinaryFunctor&lt;Eigen::ThreadPoolDevice, Functor, NDIMS, false&gt;::BCast(const CPUDevice&amp;, typename tensorflow::TTypes&lt;typename Functor::out_type, NDIMS&gt;::Tensor, typename tensorflow::TTypes&lt;typename Functor::in_type, NDIMS&gt;::ConstTensor, Eigen::array&lt;long int, NDIMS&gt;, typename tensorflow::TTypes&lt;typename Functor::in_type, NDIMS&gt;::ConstTensor, Eigen::array&lt;long int, NDIMS&gt;, bool*) [with Functor = tensorflow::functor::floor_div_real&lt;double&gt;; int NDIMS = 4; tensorflow::functor::CPUDevice = Eigen::ThreadPoolDevice; typename tensorflow::TTypes&lt;typename Functor::out_type, NDIMS&gt;::Tensor = Eigen::TensorMap&lt;Eigen::Tensor&lt;double, 4, 1, long int&gt;, 16, Eigen::MakePointer&gt;; typename tensorflow::TTypes&lt;typename Functor::in_type, NDIMS&gt;::ConstTensor = Eigen::TensorMap&lt;Eigen::Tensor&lt;const double, 4, 1, long int&gt;, 16, Eigen::MakePointer&gt;]':\n./tensorflow/core/kernels/cwise_ops_common.h:136:7:   required from 'void tensorflow::BinaryOp&lt;Device, Functor&gt;::Compute(tensorflow::OpKernelContext*) [with Device = Eigen::ThreadPoolDevice; Functor = tensorflow::functor::floor_div_real&lt;double&gt;]'\ntensorflow/core/kernels/cwise_op_floor_div.cc:53:1:   required from here\n./tensorflow/core/kernels/cwise_ops_common.h:417:3: internal compiler error: Segmentation fault\n   }\n   ^\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee &lt;file:///usr/share/doc/gcc-5/README.Bugs&gt; for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 430.853s, Critical Path: 77.17s\nFAILED: Build did NOT complete successfully\n\n</code></pre>", "body_text": "System information\n\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow): No\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\nTensorFlow installed from (source or binary): Source\nTensorFlow version (use command below): r1.4\nPython version:  2.7.12\nBazel version (if compiling from source): 0.8.1\nGCC/Compiler version (if compiling from source): 5.4.0\nCUDA/cuDNN version: 8.0/7.0.4\nGPU model and memory: 1080 Ti\nExact command to reproduce:\nbazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package --verbose_failures --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" --action_env=\"LD_LIBRARY_PATH=${LD_LIBRARY_PATH}\"\n\nDescribe the problem\nI'm trying to compile TF r1.4 from source but didn't manage to get this working although I tried several fixes:\n\n\nDowngrading bazel from 0.9.0 to 0.8.1 based on #15492\n\n\nsudo sh -c \"echo '/usr/local/cuda-8.0/lib64' >> /etc/ld.so.conf.d/nvidia.conf\"  and sudo ldconfig based on #13481\n\n\nadding the action_env argument based on https://stackoverflow.com/questions/47080760/tensorflow-fails-to-compile/47295278#47295278\n\n\nNote: When installing cudnn, I used both the runtime library and the tar file which i extracted and placed it in the /usr/local/cuda library respective folders.\nSource code / logs\nERROR: /home/kwotsin/tensorflow/tensorflow/core/BUILD:2131:1: C++ compilation of rule '//tensorflow/core:gpu_runtime_impl' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \n  (cd /home/kwotsin/.cache/bazel/_bazel_kwotsin/041f6cc3555a2d9f6211c6d126ede477/execroot/org_tensorflow && \\\n  exec env - \\\n    LD_LIBRARY_PATH=/usr/local/cuda/lib64 \\\n    PATH=/usr/local/cuda/bin:/home/kwotsin/bin:/home/kwotsin/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \\\n    PWD=/proc/self/cwd \\\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections -g0 '-std=c++11' -g0 -MD -MF bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.d '-frandom-seed=bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DSNAPPY -iquote . -iquote bazel-out/host/genfiles -iquote external/bazel_tools -iquote bazel-out/host/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/host/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/host/genfiles/external/local_config_sycl -iquote external/nsync -iquote bazel-out/host/genfiles/external/nsync -iquote external/gif_archive -iquote bazel-out/host/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/host/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/host/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/host/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/host/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/host/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/host/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/host/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/host/genfiles/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/host/genfiles/external/local_config_cuda -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/host/genfiles/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/host/genfiles/external/nsync/public -isystem external/gif_archive/lib -isystem bazel-out/host/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/host/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/host/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/host/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/host/genfiles/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/host/genfiles/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/host/genfiles/external/local_config_cuda/cuda/cuda/include -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' -msse3 -pthread '-DGOOGLE_CUDA=1' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fno-canonical-system-headers -c tensorflow/core/common_runtime/gpu/gpu_device.cc -o bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.o)\nIn file included from ./tensorflow/stream_executor/stream_executor.h:35:0,\n                 from ./tensorflow/core/platform/stream_executor.h:38,\n                 from ./tensorflow/core/common_runtime/gpu/gpu_event_mgr.h:28,\n                 from ./tensorflow/core/common_runtime/gpu/gpu_device.h:30,\n                 from tensorflow/core/common_runtime/gpu/gpu_device.cc:22:\n./tensorflow/stream_executor/stream_executor_pimpl.h:87:63: internal compiler error: Segmentation fault\n   PlatformKind platform_kind() const { return platform_kind_; }\n                                                               ^\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <file:///usr/share/doc/gcc-5/README.Bugs> for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 145.189s, Critical Path: 22.73s\nFAILED: Build did NOT complete successfully\n\n\nThank you.\n====\nFurther updates:\n\n\nI tried switching to the more updated 7.0.5 CuDNN (although some mentioned in #12052 that their build worked with 7.0.4. I'm now using CUDA 9.0 + CuDNN 7.05 for CUDA 9.0, and with bazel 0.8.1. The build unfortunately still doesn't work.\n\n\nCUDA 8.0 + CuDNN 6.0.21 also doesn't work, with the similar reasons as such:\n\n\nC++ compilation of rule '//tensorflow/core/kernels:sparse_conditional_accumulator_op' failed (Exit 1)\nIn file included from tensorflow/core/kernels/sparse_conditional_accumulator_op.cc:19:0:\n./tensorflow/core/kernels/sparse_conditional_accumulator.h: In destructor 'tensorflow::SparseConditionalAccumulator<Device, T>::~SparseConditionalAccumulator() [with Device = Eigen::ThreadPoolDevice; T = float]':\n./tensorflow/core/kernels/sparse_conditional_accumulator.h:68:3: internal compiler error: Segmentation fault\n   };\n   ^\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <file:///usr/share/doc/gcc-5/README.Bugs> for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 505.239s, Critical Path: 114.19s\nFAILED: Build did NOT complete successfully\n\n\nERROR: /home/kwotsin/tensorflow/tensorflow/core/kernels/BUILD:2554:1: C++ compilation of rule '//tensorflow/core/kernels:cwise_op' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \n  (cd /home/kwotsin/.cache/bazel/_bazel_kwotsin/041f6cc3555a2d9f6211c6d126ede477/execroot/org_tensorflow && \\\n  exec env - \\\n    CUDA_TOOLKIT_PATH=/usr/local/cuda \\\n    CUDNN_INSTALL_PATH=/usr/local/cuda-9.0 \\\n    GCC_HOST_COMPILER_PATH=/usr/bin/gcc \\\n    PWD=/proc/self/cwd \\\n    PYTHON_BIN_PATH=/usr/bin/python \\\n    PYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \\\n    TF_CUDA_CLANG=0 \\\n    TF_CUDA_COMPUTE_CAPABILITIES=6.1 \\\n    TF_CUDA_VERSION=9.0 \\\n    TF_CUDNN_VERSION=7.0.5 \\\n    TF_NEED_CUDA=1 \\\n    TF_NEED_OPENCL=0 \\\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections '-march=native' '-std=c++11' '-march=native' '-D_GLIBCXX_USE_CXX11_ABI=0' -MD -MF bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DSNAPPY -iquote . -iquote bazel-out/k8-opt/genfiles -iquote external/nsync -iquote bazel-out/k8-opt/genfiles/external/nsync -iquote external/bazel_tools -iquote bazel-out/k8-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/k8-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/k8-opt/genfiles/external/local_config_sycl -iquote external/gif_archive -iquote bazel-out/k8-opt/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/k8-opt/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/k8-opt/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/k8-opt/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/k8-opt/genfiles/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/k8-opt/genfiles/external/local_config_cuda -isystem external/nsync/public -isystem bazel-out/k8-opt/genfiles/external/nsync/public -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/k8-opt/genfiles/external/eigen_archive -isystem external/gif_archive/lib -isystem bazel-out/k8-opt/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/k8-opt/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/k8-opt/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/k8-opt/genfiles/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda/cuda/include -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' -msse3 -pthread '-DGOOGLE_CUDA=1' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fno-canonical-system-headers -c tensorflow/core/kernels/cwise_op_floor_div.cc -o bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.o)\nIn file included from tensorflow/core/kernels/cwise_op_floor_div.cc:16:0:\n./tensorflow/core/kernels/cwise_ops_common.h: In instantiation of 'void tensorflow::functor::BinaryFunctor<Eigen::ThreadPoolDevice, Functor, NDIMS, false>::BCast(const CPUDevice&, typename tensorflow::TTypes<typename Functor::out_type, NDIMS>::Tensor, typename tensorflow::TTypes<typename Functor::in_type, NDIMS>::ConstTensor, Eigen::array<long int, NDIMS>, typename tensorflow::TTypes<typename Functor::in_type, NDIMS>::ConstTensor, Eigen::array<long int, NDIMS>, bool*) [with Functor = tensorflow::functor::floor_div_real<double>; int NDIMS = 4; tensorflow::functor::CPUDevice = Eigen::ThreadPoolDevice; typename tensorflow::TTypes<typename Functor::out_type, NDIMS>::Tensor = Eigen::TensorMap<Eigen::Tensor<double, 4, 1, long int>, 16, Eigen::MakePointer>; typename tensorflow::TTypes<typename Functor::in_type, NDIMS>::ConstTensor = Eigen::TensorMap<Eigen::Tensor<const double, 4, 1, long int>, 16, Eigen::MakePointer>]':\n./tensorflow/core/kernels/cwise_ops_common.h:136:7:   required from 'void tensorflow::BinaryOp<Device, Functor>::Compute(tensorflow::OpKernelContext*) [with Device = Eigen::ThreadPoolDevice; Functor = tensorflow::functor::floor_div_real<double>]'\ntensorflow/core/kernels/cwise_op_floor_div.cc:53:1:   required from here\n./tensorflow/core/kernels/cwise_ops_common.h:417:3: internal compiler error: Segmentation fault\n   }\n   ^\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <file:///usr/share/doc/gcc-5/README.Bugs> for instructions.\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\nINFO: Elapsed time: 430.853s, Critical Path: 77.17s\nFAILED: Build did NOT complete successfully", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: r1.4\r\n- **Python version**:  2.7.12\r\n- **Bazel version (if compiling from source)**: 0.8.1\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0\r\n- **CUDA/cuDNN version**: 8.0/7.0.4\r\n- **GPU model and memory**: 1080 Ti\r\n- **Exact command to reproduce**: \r\n`bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package --verbose_failures --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" --action_env=\"LD_LIBRARY_PATH=${LD_LIBRARY_PATH}\"`\r\n\r\n\r\n### Describe the problem\r\nI'm trying to compile TF r1.4 from source but didn't manage to get this working although I tried several fixes:\r\n\r\n1. Downgrading bazel from 0.9.0 to 0.8.1 based on #15492 \r\n\r\n2. `sudo sh -c \"echo '/usr/local/cuda-8.0/lib64' >> /etc/ld.so.conf.d/nvidia.conf\"`  and `sudo ldconfig` based on #13481\r\n\r\n3. adding the `action_env` argument based on https://stackoverflow.com/questions/47080760/tensorflow-fails-to-compile/47295278#47295278\r\n\r\nNote: When installing cudnn, I used both the runtime library and the tar file which i extracted and placed it in the /usr/local/cuda library respective folders.\r\n\r\n### Source code / logs\r\n```\r\nERROR: /home/kwotsin/tensorflow/tensorflow/core/BUILD:2131:1: C++ compilation of rule '//tensorflow/core:gpu_runtime_impl' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \r\n  (cd /home/kwotsin/.cache/bazel/_bazel_kwotsin/041f6cc3555a2d9f6211c6d126ede477/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    LD_LIBRARY_PATH=/usr/local/cuda/lib64 \\\r\n    PATH=/usr/local/cuda/bin:/home/kwotsin/bin:/home/kwotsin/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \\\r\n    PWD=/proc/self/cwd \\\r\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections -g0 '-std=c++11' -g0 -MD -MF bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.d '-frandom-seed=bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DSNAPPY -iquote . -iquote bazel-out/host/genfiles -iquote external/bazel_tools -iquote bazel-out/host/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/host/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/host/genfiles/external/local_config_sycl -iquote external/nsync -iquote bazel-out/host/genfiles/external/nsync -iquote external/gif_archive -iquote bazel-out/host/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/host/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/host/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/host/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/host/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/host/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/host/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/host/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/host/genfiles/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/host/genfiles/external/local_config_cuda -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/host/genfiles/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/host/genfiles/external/nsync/public -isystem external/gif_archive/lib -isystem bazel-out/host/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/host/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/host/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/host/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/host/genfiles/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/host/genfiles/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/host/genfiles/external/local_config_cuda/cuda/cuda/include -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' -msse3 -pthread '-DGOOGLE_CUDA=1' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fno-canonical-system-headers -c tensorflow/core/common_runtime/gpu/gpu_device.cc -o bazel-out/host/bin/tensorflow/core/_objs/gpu_runtime_impl/tensorflow/core/common_runtime/gpu/gpu_device.pic.o)\r\nIn file included from ./tensorflow/stream_executor/stream_executor.h:35:0,\r\n                 from ./tensorflow/core/platform/stream_executor.h:38,\r\n                 from ./tensorflow/core/common_runtime/gpu/gpu_event_mgr.h:28,\r\n                 from ./tensorflow/core/common_runtime/gpu/gpu_device.h:30,\r\n                 from tensorflow/core/common_runtime/gpu/gpu_device.cc:22:\r\n./tensorflow/stream_executor/stream_executor_pimpl.h:87:63: internal compiler error: Segmentation fault\r\n   PlatformKind platform_kind() const { return platform_kind_; }\r\n                                                               ^\r\nPlease submit a full bug report,\r\nwith preprocessed source if appropriate.\r\nSee <file:///usr/share/doc/gcc-5/README.Bugs> for instructions.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 145.189s, Critical Path: 22.73s\r\nFAILED: Build did NOT complete successfully\r\n\r\n```\r\n\r\nThank you.\r\n\r\n====\r\n\r\nFurther updates:\r\n\r\n1. I tried switching to the more updated 7.0.5 CuDNN (although some mentioned in #12052 that their build worked with 7.0.4. I'm now using CUDA 9.0 + CuDNN 7.05 for CUDA 9.0, and with bazel 0.8.1. The build unfortunately still doesn't work.\r\n\r\n2. CUDA 8.0 + CuDNN 6.0.21 also doesn't work, with the similar reasons as such:\r\n\r\n```\r\nC++ compilation of rule '//tensorflow/core/kernels:sparse_conditional_accumulator_op' failed (Exit 1)\r\nIn file included from tensorflow/core/kernels/sparse_conditional_accumulator_op.cc:19:0:\r\n./tensorflow/core/kernels/sparse_conditional_accumulator.h: In destructor 'tensorflow::SparseConditionalAccumulator<Device, T>::~SparseConditionalAccumulator() [with Device = Eigen::ThreadPoolDevice; T = float]':\r\n./tensorflow/core/kernels/sparse_conditional_accumulator.h:68:3: internal compiler error: Segmentation fault\r\n   };\r\n   ^\r\nPlease submit a full bug report,\r\nwith preprocessed source if appropriate.\r\nSee <file:///usr/share/doc/gcc-5/README.Bugs> for instructions.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 505.239s, Critical Path: 114.19s\r\nFAILED: Build did NOT complete successfully\r\n\r\n```\r\n\r\n```\r\nERROR: /home/kwotsin/tensorflow/tensorflow/core/kernels/BUILD:2554:1: C++ compilation of rule '//tensorflow/core/kernels:cwise_op' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \r\n  (cd /home/kwotsin/.cache/bazel/_bazel_kwotsin/041f6cc3555a2d9f6211c6d126ede477/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    CUDA_TOOLKIT_PATH=/usr/local/cuda \\\r\n    CUDNN_INSTALL_PATH=/usr/local/cuda-9.0 \\\r\n    GCC_HOST_COMPILER_PATH=/usr/bin/gcc \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/usr/bin/python \\\r\n    PYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \\\r\n    TF_CUDA_CLANG=0 \\\r\n    TF_CUDA_COMPUTE_CAPABILITIES=6.1 \\\r\n    TF_CUDA_VERSION=9.0 \\\r\n    TF_CUDNN_VERSION=7.0.5 \\\r\n    TF_NEED_CUDA=1 \\\r\n    TF_NEED_OPENCL=0 \\\r\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -fPIE -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 -DNDEBUG -ffunction-sections -fdata-sections '-march=native' '-std=c++11' '-march=native' '-D_GLIBCXX_USE_CXX11_ABI=0' -MD -MF bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.o' -fPIC -DEIGEN_MPL2_ONLY -DSNAPPY -iquote . -iquote bazel-out/k8-opt/genfiles -iquote external/nsync -iquote bazel-out/k8-opt/genfiles/external/nsync -iquote external/bazel_tools -iquote bazel-out/k8-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/k8-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/k8-opt/genfiles/external/local_config_sycl -iquote external/gif_archive -iquote bazel-out/k8-opt/genfiles/external/gif_archive -iquote external/jpeg -iquote bazel-out/k8-opt/genfiles/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/k8-opt/genfiles/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/genfiles/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/genfiles/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/genfiles/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/genfiles/external/highwayhash -iquote external/png_archive -iquote bazel-out/k8-opt/genfiles/external/png_archive -iquote external/zlib_archive -iquote bazel-out/k8-opt/genfiles/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/k8-opt/genfiles/external/local_config_cuda -isystem external/nsync/public -isystem bazel-out/k8-opt/genfiles/external/nsync/public -isystem external/bazel_tools/tools/cpp/gcc3 -isystem external/eigen_archive -isystem bazel-out/k8-opt/genfiles/external/eigen_archive -isystem external/gif_archive/lib -isystem bazel-out/k8-opt/genfiles/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/k8-opt/genfiles/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/genfiles/external/farmhash_archive/src -isystem external/png_archive -isystem bazel-out/k8-opt/genfiles/external/png_archive -isystem external/zlib_archive -isystem bazel-out/k8-opt/genfiles/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda/cuda/include -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' -msse3 -pthread '-DGOOGLE_CUDA=1' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fno-canonical-system-headers -c tensorflow/core/kernels/cwise_op_floor_div.cc -o bazel-out/k8-opt/bin/tensorflow/core/kernels/_objs/cwise_op/tensorflow/core/kernels/cwise_op_floor_div.pic.o)\r\nIn file included from tensorflow/core/kernels/cwise_op_floor_div.cc:16:0:\r\n./tensorflow/core/kernels/cwise_ops_common.h: In instantiation of 'void tensorflow::functor::BinaryFunctor<Eigen::ThreadPoolDevice, Functor, NDIMS, false>::BCast(const CPUDevice&, typename tensorflow::TTypes<typename Functor::out_type, NDIMS>::Tensor, typename tensorflow::TTypes<typename Functor::in_type, NDIMS>::ConstTensor, Eigen::array<long int, NDIMS>, typename tensorflow::TTypes<typename Functor::in_type, NDIMS>::ConstTensor, Eigen::array<long int, NDIMS>, bool*) [with Functor = tensorflow::functor::floor_div_real<double>; int NDIMS = 4; tensorflow::functor::CPUDevice = Eigen::ThreadPoolDevice; typename tensorflow::TTypes<typename Functor::out_type, NDIMS>::Tensor = Eigen::TensorMap<Eigen::Tensor<double, 4, 1, long int>, 16, Eigen::MakePointer>; typename tensorflow::TTypes<typename Functor::in_type, NDIMS>::ConstTensor = Eigen::TensorMap<Eigen::Tensor<const double, 4, 1, long int>, 16, Eigen::MakePointer>]':\r\n./tensorflow/core/kernels/cwise_ops_common.h:136:7:   required from 'void tensorflow::BinaryOp<Device, Functor>::Compute(tensorflow::OpKernelContext*) [with Device = Eigen::ThreadPoolDevice; Functor = tensorflow::functor::floor_div_real<double>]'\r\ntensorflow/core/kernels/cwise_op_floor_div.cc:53:1:   required from here\r\n./tensorflow/core/kernels/cwise_ops_common.h:417:3: internal compiler error: Segmentation fault\r\n   }\r\n   ^\r\nPlease submit a full bug report,\r\nwith preprocessed source if appropriate.\r\nSee <file:///usr/share/doc/gcc-5/README.Bugs> for instructions.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 430.853s, Critical Path: 77.17s\r\nFAILED: Build did NOT complete successfully\r\n\r\n```"}