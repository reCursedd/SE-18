{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/326875429", "html_url": "https://github.com/tensorflow/tensorflow/issues/8669#issuecomment-326875429", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/8669", "id": 326875429, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjg3NTQyOQ==", "user": {"login": "oxinabox", "id": 5127634, "node_id": "MDQ6VXNlcjUxMjc2MzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/5127634?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxinabox", "html_url": "https://github.com/oxinabox", "followers_url": "https://api.github.com/users/oxinabox/followers", "following_url": "https://api.github.com/users/oxinabox/following{/other_user}", "gists_url": "https://api.github.com/users/oxinabox/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxinabox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxinabox/subscriptions", "organizations_url": "https://api.github.com/users/oxinabox/orgs", "repos_url": "https://api.github.com/users/oxinabox/repos", "events_url": "https://api.github.com/users/oxinabox/events{/privacy}", "received_events_url": "https://api.github.com/users/oxinabox/received_events", "type": "User", "site_admin": false}, "created_at": "2017-09-04T06:20:08Z", "updated_at": "2017-09-04T06:20:08Z", "author_association": "CONTRIBUTOR", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=88808\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/skye\">@skye</a><br>\nA MWE in julia:</p>\n<div class=\"highlight highlight-source-julia\"><pre><span class=\"pl-k\">using</span> TensorFlow\n\nsess <span class=\"pl-k\">=</span> <span class=\"pl-c1\">Session</span>(<span class=\"pl-c1\">Graph</span>())\ni <span class=\"pl-k\">=</span> <span class=\"pl-c1\">constant</span>(<span class=\"pl-c1\">1</span>)\nend_i\u00a0<span class=\"pl-k\">=</span>\u00a0TensorFlow<span class=\"pl-k\">.</span><span class=\"pl-c1\">while_loop</span>((i<span class=\"pl-k\">-&gt;</span>i\u00a0<span class=\"pl-k\">&lt;=</span>\u00a0<span class=\"pl-c1\">10</span>),\u00a0i<span class=\"pl-k\">-&gt;</span>i<span class=\"pl-k\">+</span><span class=\"pl-c1\">1</span>, [i])\n<span class=\"pl-c1\">run</span>(sess, end_i)</pre></div>\n<p>Using <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=987837\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/malmaud\">@malmaud</a> 's patched version of libtensorflow.so v1.2.0 (<a href=\"https://github.com/malmaud/TensorFlow.jl/blob/master/deps/build_libtensorflow/gpu/upstream_patch\">patch here</a>)<br>\nthe out put is as expected <code>[11]</code></p>\n<p>Using a freshly built libtensorflow.so v1.3.0 (but I can confirm this happened much earlier very similarly)<br>\nthe gives an error on the line starting <code>end_i = TensorFlow.while_loop(...</code></p>\n<pre><code>Tensorflow error: Status: Input 0 ('Const') for 'while/Enter' was not previously added to ShapeRefiner.\n</code></pre>\n<p>I will now attempt to reduce this example down into something in a more supported language.</p>\n<p>The metagraph I can export is below (may be being mangled by the encoding).<br>\nBut I do not think it is useful, as the crash occurs before the graph is fully defined.<br>\nThat metagraph I can reimport just fine.</p>\n<pre><code>\\00\ufffdi\n[\n\ufffdConst\ufffd\ufffdConst\"\\00*\ufffd\n\ufffddtype\ufffd\ufffd0\t*\ufffd\n\ufffd_class\ufffd\n\n\ufffd\ufffd\\00\"\\00*\\002\\00*&amp;\n\ufffdvalue\ufffd\ufffdB\ufffd\ufffd\t\ufffd\ufffd\ufffd\\00\ufffd\\00\"\\00j\\00*\\002\\00:\\00J\\00R\ufffd\ufffdZ\\00b\\00\"\ufffd\ufffd\ufffd\ufffd\\00\ufffd\\00\ufffd\\00\ufffd\\00\"\ufffd\n\ufffdTrainableVariables\ufffd\ufffd\ufffd\\00\"\ufffd\n\fQueueRunners\ufffd\ufffd\ufffd\\00\"$\n\nwhile_context\ufffd\ufffd\ufffd\ufffd\n\ufffd\n\ufffdwhile\ufffd\n\ufffd\ufffd \\00J\\00\"\ufffd\n\tSummaries\ufffd\ufffd\ufffd\\00\"\ufffd\n\tVariables\ufffd\ufffd\ufffd\\00\n</code></pre>", "body_text": "@skye\nA MWE in julia:\nusing TensorFlow\n\nsess = Session(Graph())\ni = constant(1)\nend_i\u00a0=\u00a0TensorFlow.while_loop((i->i\u00a0<=\u00a010),\u00a0i->i+1, [i])\nrun(sess, end_i)\nUsing @malmaud 's patched version of libtensorflow.so v1.2.0 (patch here)\nthe out put is as expected [11]\nUsing a freshly built libtensorflow.so v1.3.0 (but I can confirm this happened much earlier very similarly)\nthe gives an error on the line starting end_i = TensorFlow.while_loop(...\nTensorflow error: Status: Input 0 ('Const') for 'while/Enter' was not previously added to ShapeRefiner.\n\nI will now attempt to reduce this example down into something in a more supported language.\nThe metagraph I can export is below (may be being mangled by the encoding).\nBut I do not think it is useful, as the crash occurs before the graph is fully defined.\nThat metagraph I can reimport just fine.\n\\00\ufffdi\n[\n\ufffdConst\ufffd\ufffdConst\"\\00*\ufffd\n\ufffddtype\ufffd\ufffd0\t*\ufffd\n\ufffd_class\ufffd\n\n\ufffd\ufffd\\00\"\\00*\\002\\00*&\n\ufffdvalue\ufffd\ufffdB\ufffd\ufffd\t\ufffd\ufffd\ufffd\\00\ufffd\\00\"\\00j\\00*\\002\\00:\\00J\\00R\ufffd\ufffdZ\\00b\\00\"\ufffd\ufffd\ufffd\ufffd\\00\ufffd\\00\ufffd\\00\ufffd\\00\"\ufffd\n\ufffdTrainableVariables\ufffd\ufffd\ufffd\\00\"\ufffd\nQueueRunners\ufffd\ufffd\ufffd\\00\"$\n\nwhile_context\ufffd\ufffd\ufffd\ufffd\n\ufffd\n\ufffdwhile\ufffd\n\ufffd\ufffd \\00J\\00\"\ufffd\n\tSummaries\ufffd\ufffd\ufffd\\00\"\ufffd\n\tVariables\ufffd\ufffd\ufffd\\00", "body": "@skye \r\nA MWE in julia:\r\n\r\n```julia\r\nusing TensorFlow\r\n\r\nsess = Session(Graph())\r\ni = constant(1)\r\nend_i\u00a0=\u00a0TensorFlow.while_loop((i->i\u00a0<=\u00a010),\u00a0i->i+1, [i])\r\nrun(sess, end_i)\r\n```\r\n\r\nUsing @malmaud 's patched version of libtensorflow.so v1.2.0 ([patch here](https://github.com/malmaud/TensorFlow.jl/blob/master/deps/build_libtensorflow/gpu/upstream_patch))\r\nthe out put is as expected `[11]`\r\n\r\nUsing a freshly built libtensorflow.so v1.3.0 (but I can confirm this happened much earlier very similarly)\r\nthe gives an error on the line starting `end_i = TensorFlow.while_loop(...`\r\n\r\n```\r\nTensorflow error: Status: Input 0 ('Const') for 'while/Enter' was not previously added to ShapeRefiner.\r\n```\r\n\r\nI will now attempt to reduce this example down into something in a more supported language.\r\n\r\n\r\nThe metagraph I can export is below (may be being mangled by the encoding).\r\nBut I do not think it is useful, as the crash occurs before the graph is fully defined.\r\nThat metagraph I can reimport just fine.\r\n\r\n```\r\n\\00\u0012i\r\n[\r\n\u0005Const\u0012\u0005Const\"\\00*\u000b\r\n\u0005dtype\u0012\u00020\t*\u0014\r\n\u0006_class\u0012\r\n\r\n\b\u001a\\00\"\\00*\\002\\00*&\r\n\u0005value\u0012\u001dB\u001b\b\t\u0012\u0002\u0018\\00\u0018\\00\"\\00j\\00*\\002\\00:\\00J\\00R\u0001\u0001Z\\00b\\00\"\u0006\b\u0018\u0010\\00\u001a\\00\u0018\\00\u0012\\00\"\u0018\r\n\u0012TrainableVariables\u0012\u0002\u0012\\00\"\u0012\r\n\fQueueRunners\u0012\u0002\u0012\\00\"$\r\n\r\nwhile_context\u0012\u0013\u0012\u0011\r\n\u000f\r\n\u0005while\u0010\r\n\u0018\u0001 \\00J\\00\"\u000f\r\n\tSummaries\u0012\u0002\u0012\\00\"\u000f\r\n\tVariables\u0012\u0002\u0012\\00\r\n```\r\n\r\n\r\n"}