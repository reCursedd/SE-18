{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/419625179", "html_url": "https://github.com/tensorflow/tensorflow/issues/21248#issuecomment-419625179", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21248", "id": 419625179, "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTYyNTE3OQ==", "user": {"login": "frotms", "id": 18061450, "node_id": "MDQ6VXNlcjE4MDYxNDUw", "avatar_url": "https://avatars2.githubusercontent.com/u/18061450?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frotms", "html_url": "https://github.com/frotms", "followers_url": "https://api.github.com/users/frotms/followers", "following_url": "https://api.github.com/users/frotms/following{/other_user}", "gists_url": "https://api.github.com/users/frotms/gists{/gist_id}", "starred_url": "https://api.github.com/users/frotms/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frotms/subscriptions", "organizations_url": "https://api.github.com/users/frotms/orgs", "repos_url": "https://api.github.com/users/frotms/repos", "events_url": "https://api.github.com/users/frotms/events{/privacy}", "received_events_url": "https://api.github.com/users/frotms/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-08T09:01:04Z", "updated_at": "2018-09-08T09:03:43Z", "author_association": "NONE", "body_html": "<p>When I run mobilenet_v2, same error in tensorflow 1.10.1and tensorrt 2.0.1, cuda 9.0, cudnn 7. But without error in Inception-V4.</p>\n<p><strong>Code</strong></p>\n<pre><code>from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nfrom threading import Lock\nimport os\nimport sys\nimport cv2\nimport numpy as np\nimport tensorflow as tf\nimport tensorflow.contrib.tensorrt as trt\n\n\ndef GPU_config(rate=0.95):\n    gpuConfig = tf.ConfigProto()\n    gpuConfig.allow_soft_placement = True\n    gpuConfig.gpu_options.allow_growth = True\n    gpuConfig.gpu_options.per_process_gpu_memory_fraction = rate\n    gpuConfig.log_device_placement = False\n    return gpuConfig\n\n\ndef get_graph_def(pb_path):\n    with tf.gfile.GFile(pb_path, \"rb\") as f:\n        graph_read = f.read()\n\n    with tf.Graph().as_default():\n        graph_def = tf.GraphDef()\n        graph_def.ParseFromString(graph_read)\n    return graph_def\n\ndef run_graph(gdef, dumm_inp):\n    gpu_options = GPU_config()\n    tf.reset_default_graph()\n    g = tf.Graph()\n    with g.as_default():\n        tf.import_graph_def(graph_def=gdef,name=\"SAMA\")\n    inp = g.get_tensor_by_name('SAMA/Placeholder_X:0')\n    out = g.get_tensor_by_name('SAMA/Predictions:0')\n    with tf.Session(graph=g, config=gpu_options) as sess:\n        _ = sess.run(out, feed_dict={inp: dumm_inp})\n        start_time = time.time()\n        for i in range(100):\n            val = sess.run(out, feed_dict={inp: dumm_inp})\n        end_time = time.time()\n        print(\"cost time is: \",str((end_time-start_time)*1000),' ms')\n    return val\n\ndef write_trt_graph_to_file(graph_def, graph_name):\n    with tf.gfile.GFile(graph_name, \"wb\") as f:\n      f.write(graph_def.SerializeToString())\n\ndef get_tftrt_name(graph_name, precision_string):\n    return \"tftrt_{}_{}\".format(precision_string.lower(), graph_name)\n\ndef run_calibration(gdef, dumm_inp):\n    \"\"\"Run given calibration graph multiple times.\"\"\"\n    # gpu_options = cpb2.GPUOptions(per_process_gpu_memory_fraction=0.50)\n    gpu_options = GPU_config()\n    ops.reset_default_graph()\n    g = ops.Graph()\n    with g.as_default():\n        tf.import_graph_def(graph_def=gdef, name=\"SAMA\")\n    inp = g.get_tensor_by_name('SAMA/Placeholder_X:0')\n    out = g.get_tensor_by_name('SAMA/Predictions:0')\n    with tf.Session(config=gpu_options, graph=g) as sess:\n        # run over real calibration data here, we are mimicking a calibration set of\n        # 30 different batches. Use as much calibration data as you want\n        for _ in range(30):\n            val = sess.run(out, {inp: dumm_inp})\n    return val\n\nif __name__ == \"__main__\":\n    os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"\n    os.environ[\"CUDA_VISIBLE_DEVICES\"] = str(0)\n    # print('begin...')\n    dummy_input = np.ones((4,224,224,3)).astype(np.float32)\n    pb_path = './core/model/model.pb'\n    precision_mode = \"FP32\"\n    org_graph = get_graph_def(pb_path)\n    # o1 = run_graph(org_graph, dummy_input)\n    # print(\"o1's done!\")\n    # print('o1: ', o1[0])\n\n    trt_graph = trt.create_inference_graph(\n      input_graph_def=org_graph,\n      outputs=[\"Predictions\"],\n      max_batch_size=224,\n      max_workspace_size_bytes=1 &lt;&lt; 25,\n      precision_mode=\"FP32\",  # TRT Engine precision \"FP32\",\"FP16\" or \"INT8\"\n      minimum_segment_size=2  # minimum number of nodes in an engine\n    )\n    o2 = run_graph(trt_graph, dummy_input)\n    print(\"---------------------------\")\n    print(\"o2's done!\")\n    print('o2: ', o2[0])\n</code></pre>\n<p><strong>Log</strong><br>\nWARNING:tensorflow:TensorRT mismatch. Compiled against version 3.0.4, but loaded 4.0.1. Things may not work<br>\n2018-09-08 16:50:50.962847: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count &gt;= 8): 1<br>\n2018-09-08 16:50:51.087941: I tensorflow/contrib/tensorrt/convert/convert_graph.cc:756] MULTIPLE tensorrt candidate conversion: 36<br>\n2018-09-08 16:50:51.089689: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.099422: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.101876: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.104649: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.109036: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.112530: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.116195: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.121674: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.126477: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.131572: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.138909: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.145751: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.152753: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.159423: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.165827: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.172368: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.178878: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.185448: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.192249: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.199121: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.205969: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.213014: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.221183: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.229179: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.237838: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.246279: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.255204: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.263960: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.272671: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.281564: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.290650: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.299656: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.308670: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.318329: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.327576: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.336869: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/scope/hovercard\" href=\"https://github.com/scope\">@scope</a> '', converted to graph<br>\n2018-09-08 16:50:51.347347: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:51.347402: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:53.077100: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:53.077149: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:53.229884: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:53.229922: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:54.000296: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:54.000347: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:54.290206: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:54.290252: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:54.882412: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:54.882443: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:55.481933: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:55.481966: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:55.736761: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:55.736812: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:56.043892: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:56.043917: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:56.881252: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:56.881297: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:57.164363: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:57.164412: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:58.037810: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:58.037856: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:58.286105: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:58.286143: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:50:59.044338: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:50:59.044380: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:01.582217: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:01.582272: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:02.783233: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:02.783283: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:04.294398: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:04.294431: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:06.281261: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:06.281298: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:06.728836: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:06.728879: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:07.039253: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:07.039291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:07.873704: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:07.873759: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:09.072112: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:09.072181: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:09.341916: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:09.341955: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:09.569091: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:09.569141: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:09.836272: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:09.836310: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:10.648372: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:10.648425: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:10.872321: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:10.872359: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:11.096381: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:11.096422: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:11.312129: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:11.312185: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:11.642882: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:11.642919: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:11.850653: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:11.850691: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:12.622117: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:12.622153: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:13.361002: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:13.361034: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:13.579295: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:13.579334: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:14.092344: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:14.092391: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:14.317894: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices<br>\n2018-09-08 16:51:14.317929: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0<br>\n2018-09-08 16:51:14.890015: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>\n2018-09-08 16:51:14.890747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:<br>\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582<br>\npciBusID: 0000:04:00.0<br>\ntotalMemory: 10.92GiB freeMemory: 10.52GiB<br>\n2018-09-08 16:51:14.890768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0<br>\n2018-09-08 16:51:14.890786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:<br>\n2018-09-08 16:51:14.890791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0<br>\n2018-09-08 16:51:14.890799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N<br>\n2018-09-08 16:51:14.891010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10619 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)<br>\n2018-09-08 16:51:15.155748: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger Parameter check failed at: cudnnEngine.cpp::enqueue::267, condition: bindings[x] != nullptr<br>\n2018-09-08 16:51:15.155796: E tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:401] Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16<br>\nTraceback (most recent call last):<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call<br>\nreturn fn(*args)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn<br>\noptions, feed_dict, fetch_list, target_list, run_metadata)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun<br>\nrun_metadata)<br>\ntensorflow.python.framework.errors_impl.InternalError: Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16<br>\n[[Node: SAMA/my_trt_op_16 = TRTEngineOp<a href=\"SAMA/MobilenetV2_1/Conv/Relu6\">InT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"</a>]]</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\nFile \"test_trtdemo.py\", line 103, in <br>\no2 = run_graph(trt_graph, dummy_input)<br>\nFile \"test_trtdemo.py\", line 51, in run_graph<br>\n_ = sess.run(out, feed_dict={inp: dumm_inp})<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 877, in run<br>\nrun_metadata_ptr)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1100, in _run<br>\nfeed_dict_tensor, options, run_metadata)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run<br>\nrun_metadata)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call<br>\nraise type(e)(node_def, op, message)<br>\ntensorflow.python.framework.errors_impl.InternalError: Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16<br>\n[[Node: SAMA/my_trt_op_16 = TRTEngineOp<a href=\"SAMA/MobilenetV2_1/Conv/Relu6\">InT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"</a>]]</p>\n<p>Caused by op 'SAMA/my_trt_op_16', defined at:<br>\nFile \"test_trtdemo.py\", line 103, in <br>\no2 = run_graph(trt_graph, dummy_input)<br>\nFile \"test_trtdemo.py\", line 47, in run_graph<br>\ntf.import_graph_def(graph_def=gdef,name=\"SAMA\")<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func<br>\nreturn func(*args, **kwargs)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/importer.py\", line 442, in import_graph_def<br>\n_ProcessNewOps(graph)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/importer.py\", line 234, in _ProcessNewOps<br>\nfor new_op in graph._add_new_tf_operations(compute_devices=False):  # pylint: disable=protected-access<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3289, in _add_new_tf_operations<br>\nfor c_op in c_api_util.new_tf_operations(self)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3289, in <br>\nfor c_op in c_api_util.new_tf_operations(self)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3180, in _create_op_from_tf_operation<br>\nret = Operation(c_op, self)<br>\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1717, in <strong>init</strong><br>\nself._traceback = tf_stack.extract_stack()</p>\n<p>InternalError (see above for traceback): Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16<br>\n[[Node: SAMA/my_trt_op_16 = TRTEngineOp<a href=\"SAMA/MobilenetV2_1/Conv/Relu6\">InT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"</a>]]</p>", "body_text": "When I run mobilenet_v2, same error in tensorflow 1.10.1and tensorrt 2.0.1, cuda 9.0, cudnn 7. But without error in Inception-V4.\nCode\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nfrom threading import Lock\nimport os\nimport sys\nimport cv2\nimport numpy as np\nimport tensorflow as tf\nimport tensorflow.contrib.tensorrt as trt\n\n\ndef GPU_config(rate=0.95):\n    gpuConfig = tf.ConfigProto()\n    gpuConfig.allow_soft_placement = True\n    gpuConfig.gpu_options.allow_growth = True\n    gpuConfig.gpu_options.per_process_gpu_memory_fraction = rate\n    gpuConfig.log_device_placement = False\n    return gpuConfig\n\n\ndef get_graph_def(pb_path):\n    with tf.gfile.GFile(pb_path, \"rb\") as f:\n        graph_read = f.read()\n\n    with tf.Graph().as_default():\n        graph_def = tf.GraphDef()\n        graph_def.ParseFromString(graph_read)\n    return graph_def\n\ndef run_graph(gdef, dumm_inp):\n    gpu_options = GPU_config()\n    tf.reset_default_graph()\n    g = tf.Graph()\n    with g.as_default():\n        tf.import_graph_def(graph_def=gdef,name=\"SAMA\")\n    inp = g.get_tensor_by_name('SAMA/Placeholder_X:0')\n    out = g.get_tensor_by_name('SAMA/Predictions:0')\n    with tf.Session(graph=g, config=gpu_options) as sess:\n        _ = sess.run(out, feed_dict={inp: dumm_inp})\n        start_time = time.time()\n        for i in range(100):\n            val = sess.run(out, feed_dict={inp: dumm_inp})\n        end_time = time.time()\n        print(\"cost time is: \",str((end_time-start_time)*1000),' ms')\n    return val\n\ndef write_trt_graph_to_file(graph_def, graph_name):\n    with tf.gfile.GFile(graph_name, \"wb\") as f:\n      f.write(graph_def.SerializeToString())\n\ndef get_tftrt_name(graph_name, precision_string):\n    return \"tftrt_{}_{}\".format(precision_string.lower(), graph_name)\n\ndef run_calibration(gdef, dumm_inp):\n    \"\"\"Run given calibration graph multiple times.\"\"\"\n    # gpu_options = cpb2.GPUOptions(per_process_gpu_memory_fraction=0.50)\n    gpu_options = GPU_config()\n    ops.reset_default_graph()\n    g = ops.Graph()\n    with g.as_default():\n        tf.import_graph_def(graph_def=gdef, name=\"SAMA\")\n    inp = g.get_tensor_by_name('SAMA/Placeholder_X:0')\n    out = g.get_tensor_by_name('SAMA/Predictions:0')\n    with tf.Session(config=gpu_options, graph=g) as sess:\n        # run over real calibration data here, we are mimicking a calibration set of\n        # 30 different batches. Use as much calibration data as you want\n        for _ in range(30):\n            val = sess.run(out, {inp: dumm_inp})\n    return val\n\nif __name__ == \"__main__\":\n    os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"\n    os.environ[\"CUDA_VISIBLE_DEVICES\"] = str(0)\n    # print('begin...')\n    dummy_input = np.ones((4,224,224,3)).astype(np.float32)\n    pb_path = './core/model/model.pb'\n    precision_mode = \"FP32\"\n    org_graph = get_graph_def(pb_path)\n    # o1 = run_graph(org_graph, dummy_input)\n    # print(\"o1's done!\")\n    # print('o1: ', o1[0])\n\n    trt_graph = trt.create_inference_graph(\n      input_graph_def=org_graph,\n      outputs=[\"Predictions\"],\n      max_batch_size=224,\n      max_workspace_size_bytes=1 << 25,\n      precision_mode=\"FP32\",  # TRT Engine precision \"FP32\",\"FP16\" or \"INT8\"\n      minimum_segment_size=2  # minimum number of nodes in an engine\n    )\n    o2 = run_graph(trt_graph, dummy_input)\n    print(\"---------------------------\")\n    print(\"o2's done!\")\n    print('o2: ', o2[0])\n\nLog\nWARNING:tensorflow:TensorRT mismatch. Compiled against version 3.0.4, but loaded 4.0.1. Things may not work\n2018-09-08 16:50:50.962847: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count >= 8): 1\n2018-09-08 16:50:51.087941: I tensorflow/contrib/tensorrt/convert/convert_graph.cc:756] MULTIPLE tensorrt candidate conversion: 36\n2018-09-08 16:50:51.089689: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.099422: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.101876: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.104649: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.109036: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.112530: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.116195: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.121674: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.126477: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.131572: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.138909: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.145751: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.152753: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.159423: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.165827: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.172368: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.178878: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.185448: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.192249: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.199121: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.205969: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.213014: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.221183: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.229179: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.237838: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.246279: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.255204: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.263960: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.272671: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.281564: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.290650: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.299656: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.308670: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.318329: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.327576: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.336869: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\n2018-09-08 16:50:51.347347: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:51.347402: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:53.077100: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:53.077149: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:53.229884: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:53.229922: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:54.000296: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:54.000347: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:54.290206: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:54.290252: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:54.882412: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:54.882443: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:55.481933: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:55.481966: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:55.736761: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:55.736812: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:56.043892: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:56.043917: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:56.881252: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:56.881297: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:57.164363: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:57.164412: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:58.037810: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:58.037856: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:58.286105: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:58.286143: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:50:59.044338: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:50:59.044380: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:01.582217: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:01.582272: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:02.783233: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:02.783283: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:04.294398: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:04.294431: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:06.281261: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:06.281298: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:06.728836: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:06.728879: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:07.039253: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:07.039291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:07.873704: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:07.873759: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:09.072112: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:09.072181: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:09.341916: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:09.341955: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:09.569091: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:09.569141: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:09.836272: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:09.836310: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:10.648372: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:10.648425: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:10.872321: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:10.872359: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:11.096381: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:11.096422: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:11.312129: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:11.312185: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:11.642882: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:11.642919: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:11.850653: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:11.850691: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:12.622117: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:12.622153: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:13.361002: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:13.361034: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:13.579295: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:13.579334: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:14.092344: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:14.092391: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:14.317894: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\n2018-09-08 16:51:14.317929: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0\n2018-09-08 16:51:14.890015: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2018-09-08 16:51:14.890747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\npciBusID: 0000:04:00.0\ntotalMemory: 10.92GiB freeMemory: 10.52GiB\n2018-09-08 16:51:14.890768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\n2018-09-08 16:51:14.890786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-09-08 16:51:14.890791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0\n2018-09-08 16:51:14.890799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N\n2018-09-08 16:51:14.891010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10619 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)\n2018-09-08 16:51:15.155748: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger Parameter check failed at: cudnnEngine.cpp::enqueue::267, condition: bindings[x] != nullptr\n2018-09-08 16:51:15.155796: E tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:401] Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\nTraceback (most recent call last):\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\nreturn fn(*args)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn\noptions, feed_dict, fetch_list, target_list, run_metadata)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun\nrun_metadata)\ntensorflow.python.framework.errors_impl.InternalError: Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\n[[Node: SAMA/my_trt_op_16 = TRTEngineOpInT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"test_trtdemo.py\", line 103, in \no2 = run_graph(trt_graph, dummy_input)\nFile \"test_trtdemo.py\", line 51, in run_graph\n_ = sess.run(out, feed_dict={inp: dumm_inp})\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 877, in run\nrun_metadata_ptr)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\nfeed_dict_tensor, options, run_metadata)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\nrun_metadata)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\nraise type(e)(node_def, op, message)\ntensorflow.python.framework.errors_impl.InternalError: Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\n[[Node: SAMA/my_trt_op_16 = TRTEngineOpInT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]]\nCaused by op 'SAMA/my_trt_op_16', defined at:\nFile \"test_trtdemo.py\", line 103, in \no2 = run_graph(trt_graph, dummy_input)\nFile \"test_trtdemo.py\", line 47, in run_graph\ntf.import_graph_def(graph_def=gdef,name=\"SAMA\")\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\nreturn func(*args, **kwargs)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/importer.py\", line 442, in import_graph_def\n_ProcessNewOps(graph)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/importer.py\", line 234, in _ProcessNewOps\nfor new_op in graph._add_new_tf_operations(compute_devices=False):  # pylint: disable=protected-access\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3289, in _add_new_tf_operations\nfor c_op in c_api_util.new_tf_operations(self)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3289, in \nfor c_op in c_api_util.new_tf_operations(self)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3180, in _create_op_from_tf_operation\nret = Operation(c_op, self)\nFile \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1717, in init\nself._traceback = tf_stack.extract_stack()\nInternalError (see above for traceback): Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\n[[Node: SAMA/my_trt_op_16 = TRTEngineOpInT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]]", "body": "When I run mobilenet_v2, same error in tensorflow 1.10.1and tensorrt 2.0.1, cuda 9.0, cudnn 7. But without error in Inception-V4.\r\n\r\n**Code**\r\n```\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n\r\nfrom threading import Lock\r\nimport os\r\nimport sys\r\nimport cv2\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.tensorrt as trt\r\n\r\n\r\ndef GPU_config(rate=0.95):\r\n    gpuConfig = tf.ConfigProto()\r\n    gpuConfig.allow_soft_placement = True\r\n    gpuConfig.gpu_options.allow_growth = True\r\n    gpuConfig.gpu_options.per_process_gpu_memory_fraction = rate\r\n    gpuConfig.log_device_placement = False\r\n    return gpuConfig\r\n\r\n\r\ndef get_graph_def(pb_path):\r\n    with tf.gfile.GFile(pb_path, \"rb\") as f:\r\n        graph_read = f.read()\r\n\r\n    with tf.Graph().as_default():\r\n        graph_def = tf.GraphDef()\r\n        graph_def.ParseFromString(graph_read)\r\n    return graph_def\r\n\r\ndef run_graph(gdef, dumm_inp):\r\n    gpu_options = GPU_config()\r\n    tf.reset_default_graph()\r\n    g = tf.Graph()\r\n    with g.as_default():\r\n        tf.import_graph_def(graph_def=gdef,name=\"SAMA\")\r\n    inp = g.get_tensor_by_name('SAMA/Placeholder_X:0')\r\n    out = g.get_tensor_by_name('SAMA/Predictions:0')\r\n    with tf.Session(graph=g, config=gpu_options) as sess:\r\n        _ = sess.run(out, feed_dict={inp: dumm_inp})\r\n        start_time = time.time()\r\n        for i in range(100):\r\n            val = sess.run(out, feed_dict={inp: dumm_inp})\r\n        end_time = time.time()\r\n        print(\"cost time is: \",str((end_time-start_time)*1000),' ms')\r\n    return val\r\n\r\ndef write_trt_graph_to_file(graph_def, graph_name):\r\n    with tf.gfile.GFile(graph_name, \"wb\") as f:\r\n      f.write(graph_def.SerializeToString())\r\n\r\ndef get_tftrt_name(graph_name, precision_string):\r\n    return \"tftrt_{}_{}\".format(precision_string.lower(), graph_name)\r\n\r\ndef run_calibration(gdef, dumm_inp):\r\n    \"\"\"Run given calibration graph multiple times.\"\"\"\r\n    # gpu_options = cpb2.GPUOptions(per_process_gpu_memory_fraction=0.50)\r\n    gpu_options = GPU_config()\r\n    ops.reset_default_graph()\r\n    g = ops.Graph()\r\n    with g.as_default():\r\n        tf.import_graph_def(graph_def=gdef, name=\"SAMA\")\r\n    inp = g.get_tensor_by_name('SAMA/Placeholder_X:0')\r\n    out = g.get_tensor_by_name('SAMA/Predictions:0')\r\n    with tf.Session(config=gpu_options, graph=g) as sess:\r\n        # run over real calibration data here, we are mimicking a calibration set of\r\n        # 30 different batches. Use as much calibration data as you want\r\n        for _ in range(30):\r\n            val = sess.run(out, {inp: dumm_inp})\r\n    return val\r\n\r\nif __name__ == \"__main__\":\r\n    os.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"\r\n    os.environ[\"CUDA_VISIBLE_DEVICES\"] = str(0)\r\n    # print('begin...')\r\n    dummy_input = np.ones((4,224,224,3)).astype(np.float32)\r\n    pb_path = './core/model/model.pb'\r\n    precision_mode = \"FP32\"\r\n    org_graph = get_graph_def(pb_path)\r\n    # o1 = run_graph(org_graph, dummy_input)\r\n    # print(\"o1's done!\")\r\n    # print('o1: ', o1[0])\r\n\r\n    trt_graph = trt.create_inference_graph(\r\n      input_graph_def=org_graph,\r\n      outputs=[\"Predictions\"],\r\n      max_batch_size=224,\r\n      max_workspace_size_bytes=1 << 25,\r\n      precision_mode=\"FP32\",  # TRT Engine precision \"FP32\",\"FP16\" or \"INT8\"\r\n      minimum_segment_size=2  # minimum number of nodes in an engine\r\n    )\r\n    o2 = run_graph(trt_graph, dummy_input)\r\n    print(\"---------------------------\")\r\n    print(\"o2's done!\")\r\n    print('o2: ', o2[0])\r\n```\r\n\r\n\r\n**Log**\r\nWARNING:tensorflow:TensorRT mismatch. Compiled against version 3.0.4, but loaded 4.0.1. Things may not work\r\n2018-09-08 16:50:50.962847: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count >= 8): 1\r\n2018-09-08 16:50:51.087941: I tensorflow/contrib/tensorrt/convert/convert_graph.cc:756] MULTIPLE tensorrt candidate conversion: 36\r\n2018-09-08 16:50:51.089689: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.099422: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.101876: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.104649: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.109036: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.112530: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.116195: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.121674: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.126477: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.131572: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.138909: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.145751: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.152753: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.159423: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.165827: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.172368: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.178878: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.185448: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.192249: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.199121: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.205969: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.213014: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.221183: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.229179: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.237838: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.246279: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.255204: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.263960: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.272671: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.281564: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.290650: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.299656: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.308670: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.318329: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.327576: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.336869: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2853] Segment @scope '', converted to graph\r\n2018-09-08 16:50:51.347347: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:51.347402: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:53.077100: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:53.077149: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:53.229884: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:53.229922: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:54.000296: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:54.000347: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:54.290206: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:54.290252: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:54.882412: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:54.882443: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:55.481933: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:55.481966: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:55.736761: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:55.736812: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:56.043892: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:56.043917: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:56.881252: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:56.881297: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:57.164363: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:57.164412: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:58.037810: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:58.037856: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:58.286105: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:58.286143: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:50:59.044338: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:50:59.044380: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:01.582217: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:01.582272: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:02.783233: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:02.783283: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:04.294398: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:04.294431: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:06.281261: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:06.281298: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:06.728836: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:06.728879: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:07.039253: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:07.039291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:07.873704: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:07.873759: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:09.072112: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:09.072181: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:09.341916: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:09.341955: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:09.569091: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:09.569141: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:09.836272: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:09.836310: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:10.648372: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:10.648425: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:10.872321: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:10.872359: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:11.096381: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:11.096422: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:11.312129: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:11.312185: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:11.642882: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:11.642919: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:11.850653: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:11.850691: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:12.622117: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:12.622153: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:13.361002: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:13.361034: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:13.579295: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:13.579334: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:14.092344: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:14.092391: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:14.317894: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:720]  Can't find a GPU device to work with. Please instantiate a session to initialize devices\r\n2018-09-08 16:51:14.317929: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:844] Can't identify the cuda device. Running on device 0 \r\n2018-09-08 16:51:14.890015: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-08 16:51:14.890747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:04:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.52GiB\r\n2018-09-08 16:51:14.890768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-08 16:51:14.890786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-08 16:51:14.890791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \r\n2018-09-08 16:51:14.890799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \r\n2018-09-08 16:51:14.891010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10619 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)\r\n2018-09-08 16:51:15.155748: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger Parameter check failed at: cudnnEngine.cpp::enqueue::267, condition: bindings[x] != nullptr\r\n2018-09-08 16:51:15.155796: E tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:401] Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\r\nTraceback (most recent call last):\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\r\n    return fn(*args)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InternalError: Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\r\n\t [[Node: SAMA/my_trt_op_16 = TRTEngineOp[InT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](SAMA/MobilenetV2_1/Conv/Relu6)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"test_trtdemo.py\", line 103, in <module>\r\n    o2 = run_graph(trt_graph, dummy_input)\r\n  File \"test_trtdemo.py\", line 51, in run_graph\r\n    _ = sess.run(out, feed_dict={inp: dumm_inp})\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 877, in run\r\n    run_metadata_ptr)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\r\n    run_metadata)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\r\n\t [[Node: SAMA/my_trt_op_16 = TRTEngineOp[InT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](SAMA/MobilenetV2_1/Conv/Relu6)]]\r\n\r\nCaused by op 'SAMA/my_trt_op_16', defined at:\r\n  File \"test_trtdemo.py\", line 103, in <module>\r\n    o2 = run_graph(trt_graph, dummy_input)\r\n  File \"test_trtdemo.py\", line 47, in run_graph\r\n    tf.import_graph_def(graph_def=gdef,name=\"SAMA\")\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/importer.py\", line 442, in import_graph_def\r\n    _ProcessNewOps(graph)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/importer.py\", line 234, in _ProcessNewOps\r\n    for new_op in graph._add_new_tf_operations(compute_devices=False):  # pylint: disable=protected-access\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3289, in _add_new_tf_operations\r\n    for c_op in c_api_util.new_tf_operations(self)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3289, in <listcomp>\r\n    for c_op in c_api_util.new_tf_operations(self)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 3180, in _create_op_from_tf_operation\r\n    ret = Operation(c_op, self)\r\n  File \"/home/vismarty/.local/lib/python3.5/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInternalError (see above for traceback): Failed to enqueue batch for TRT engine: SAMA/my_trt_op_16\r\n\t [[Node: SAMA/my_trt_op_16 = TRTEngineOp[InT=[DT_FLOAT], OutT=[DT_FLOAT], cached_engine_batches=[224], calibration_data=\"\", fixed_input_size=true, input_shapes=[[?,32,112,112]], max_cached_engines_count=1, output_shapes=[[?,32,112,112]], precision_mode=\"FP32\", segment_funcdef_name=\"my_trt_op_16_native_segment\", serialized_segment=\"h\\n\\000\\00...00\\000\\000\", static_engine=true, workspace_size_bytes=288640, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](SAMA/MobilenetV2_1/Conv/Relu6)]]"}