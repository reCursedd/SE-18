{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/312120363", "html_url": "https://github.com/tensorflow/tensorflow/issues/11122#issuecomment-312120363", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11122", "id": 312120363, "node_id": "MDEyOklzc3VlQ29tbWVudDMxMjEyMDM2Mw==", "user": {"login": "ramanishka", "id": 12480405, "node_id": "MDQ6VXNlcjEyNDgwNDA1", "avatar_url": "https://avatars3.githubusercontent.com/u/12480405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ramanishka", "html_url": "https://github.com/ramanishka", "followers_url": "https://api.github.com/users/ramanishka/followers", "following_url": "https://api.github.com/users/ramanishka/following{/other_user}", "gists_url": "https://api.github.com/users/ramanishka/gists{/gist_id}", "starred_url": "https://api.github.com/users/ramanishka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ramanishka/subscriptions", "organizations_url": "https://api.github.com/users/ramanishka/orgs", "repos_url": "https://api.github.com/users/ramanishka/repos", "events_url": "https://api.github.com/users/ramanishka/events{/privacy}", "received_events_url": "https://api.github.com/users/ramanishka/received_events", "type": "User", "site_admin": false}, "created_at": "2017-06-29T21:59:46Z", "updated_at": "2017-06-29T21:59:46Z", "author_association": "NONE", "body_html": "<p>Faced the same thing running cifar10 example from <a href=\"https://github.com/tensorflow/models\">https://github.com/tensorflow/models</a>.<br>\nHere is the snippet from <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=23068\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/yaroslavvb\">@yaroslavvb</a>, <a href=\"https://gist.github.com/yaroslavvb/53052184e50cdfec35f0a127dd6df843\">link</a></p>\n<pre><code>import os\nos.environ['CUDA_VISIBLE_DEVICES']=''\nimport tensorflow as tf\nfrom tensorflow.contrib.compiler import jit\ntf.reset_default_graph()\njit_scope = jit.experimental_jit_scope\nwith jit_scope(compile_ops=True):\n    N = 500*1000*1000\n    x = tf.Variable(tf.random_uniform(shape=(N,)))\n    y = 0.1*x*x*x*x*x-0.5*x*x*x*x+.25*x*x*x+.75*x*x-1.5*x-2\n    y0 = y[0]\nimport time\nsess = tf.Session()\nsess.run(tf.global_variables_initializer())\nsess.run(y.op)\nstart_time = time.time()\nprint(sess.run(y0))\nend_time = time.time()\nprint(\"%.2f sec\"%(end_time-start_time))\n</code></pre>\n<p>gives:</p>\n<pre><code>2017-06-29 14:37:05.431926: F tensorflow/compiler/xla/statusor.cc:41] Attempting to fetch value instead of handling error Not found: could not find registered computation placer for platform Executor -- check target linkage\n</code></pre>\n<p>After adding <code>with tf.device('/cpu')</code> it works:</p>\n<pre><code>import os\nos.environ['CUDA_VISIBLE_DEVICES']=''\nimport tensorflow as tf\nfrom tensorflow.contrib.compiler import jit\ntf.reset_default_graph()\njit_scope = jit.experimental_jit_scope\nwith jit_scope(compile_ops=True):\n    N = 500*1000*1000\n    with tf.device(\"/cpu\"):\n        x = tf.Variable(tf.random_uniform(shape=(N,)))\n        y = 0.1*x*x*x*x*x-0.5*x*x*x*x+.25*x*x*x+.75*x*x-1.5*x-2\n        y0 = y[0]\nimport time\nsess = tf.Session()\nsess.run(tf.global_variables_initializer())\nsess.run(y.op)\nstart_time = time.time()\nprint(sess.run(y0))\nend_time = time.time()\nprint(\"%.2f sec\"%(end_time-start_time))\n</code></pre>\n<pre><code>2017-06-29 14:52:30.979254: I tensorflow/compiler/xla/service/service.cc:193] XLA service 0x7ff440159ca0 executing computations on platform Host. Devices:\n2017-06-29 14:52:30.979277: I tensorflow/compiler/xla/service/service.cc:201]   StreamExecutor device (0): &lt;undefined&gt;, &lt;undefined&gt;\n-2.7442\n0.68 sec\n</code></pre>\n<p>Built from sources with XLA and CUDA, commit: <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/270a3e8886e352ad563a3431963296e3dc6dae06/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/270a3e8886e352ad563a3431963296e3dc6dae06\"><tt>270a3e8</tt></a></p>", "body_text": "Faced the same thing running cifar10 example from https://github.com/tensorflow/models.\nHere is the snippet from @yaroslavvb, link\nimport os\nos.environ['CUDA_VISIBLE_DEVICES']=''\nimport tensorflow as tf\nfrom tensorflow.contrib.compiler import jit\ntf.reset_default_graph()\njit_scope = jit.experimental_jit_scope\nwith jit_scope(compile_ops=True):\n    N = 500*1000*1000\n    x = tf.Variable(tf.random_uniform(shape=(N,)))\n    y = 0.1*x*x*x*x*x-0.5*x*x*x*x+.25*x*x*x+.75*x*x-1.5*x-2\n    y0 = y[0]\nimport time\nsess = tf.Session()\nsess.run(tf.global_variables_initializer())\nsess.run(y.op)\nstart_time = time.time()\nprint(sess.run(y0))\nend_time = time.time()\nprint(\"%.2f sec\"%(end_time-start_time))\n\ngives:\n2017-06-29 14:37:05.431926: F tensorflow/compiler/xla/statusor.cc:41] Attempting to fetch value instead of handling error Not found: could not find registered computation placer for platform Executor -- check target linkage\n\nAfter adding with tf.device('/cpu') it works:\nimport os\nos.environ['CUDA_VISIBLE_DEVICES']=''\nimport tensorflow as tf\nfrom tensorflow.contrib.compiler import jit\ntf.reset_default_graph()\njit_scope = jit.experimental_jit_scope\nwith jit_scope(compile_ops=True):\n    N = 500*1000*1000\n    with tf.device(\"/cpu\"):\n        x = tf.Variable(tf.random_uniform(shape=(N,)))\n        y = 0.1*x*x*x*x*x-0.5*x*x*x*x+.25*x*x*x+.75*x*x-1.5*x-2\n        y0 = y[0]\nimport time\nsess = tf.Session()\nsess.run(tf.global_variables_initializer())\nsess.run(y.op)\nstart_time = time.time()\nprint(sess.run(y0))\nend_time = time.time()\nprint(\"%.2f sec\"%(end_time-start_time))\n\n2017-06-29 14:52:30.979254: I tensorflow/compiler/xla/service/service.cc:193] XLA service 0x7ff440159ca0 executing computations on platform Host. Devices:\n2017-06-29 14:52:30.979277: I tensorflow/compiler/xla/service/service.cc:201]   StreamExecutor device (0): <undefined>, <undefined>\n-2.7442\n0.68 sec\n\nBuilt from sources with XLA and CUDA, commit: 270a3e8", "body": "Faced the same thing running cifar10 example from https://github.com/tensorflow/models.\r\nHere is the snippet from @yaroslavvb, [link](https://gist.github.com/yaroslavvb/53052184e50cdfec35f0a127dd6df843)\r\n```\r\nimport os\r\nos.environ['CUDA_VISIBLE_DEVICES']=''\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib.compiler import jit\r\ntf.reset_default_graph()\r\njit_scope = jit.experimental_jit_scope\r\nwith jit_scope(compile_ops=True):\r\n    N = 500*1000*1000\r\n    x = tf.Variable(tf.random_uniform(shape=(N,)))\r\n    y = 0.1*x*x*x*x*x-0.5*x*x*x*x+.25*x*x*x+.75*x*x-1.5*x-2\r\n    y0 = y[0]\r\nimport time\r\nsess = tf.Session()\r\nsess.run(tf.global_variables_initializer())\r\nsess.run(y.op)\r\nstart_time = time.time()\r\nprint(sess.run(y0))\r\nend_time = time.time()\r\nprint(\"%.2f sec\"%(end_time-start_time))\r\n```\r\ngives: \r\n```\r\n2017-06-29 14:37:05.431926: F tensorflow/compiler/xla/statusor.cc:41] Attempting to fetch value instead of handling error Not found: could not find registered computation placer for platform Executor -- check target linkage\r\n```\r\nAfter adding `with tf.device('/cpu')` it works:\r\n\r\n```\r\nimport os\r\nos.environ['CUDA_VISIBLE_DEVICES']=''\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib.compiler import jit\r\ntf.reset_default_graph()\r\njit_scope = jit.experimental_jit_scope\r\nwith jit_scope(compile_ops=True):\r\n    N = 500*1000*1000\r\n    with tf.device(\"/cpu\"):\r\n        x = tf.Variable(tf.random_uniform(shape=(N,)))\r\n        y = 0.1*x*x*x*x*x-0.5*x*x*x*x+.25*x*x*x+.75*x*x-1.5*x-2\r\n        y0 = y[0]\r\nimport time\r\nsess = tf.Session()\r\nsess.run(tf.global_variables_initializer())\r\nsess.run(y.op)\r\nstart_time = time.time()\r\nprint(sess.run(y0))\r\nend_time = time.time()\r\nprint(\"%.2f sec\"%(end_time-start_time))\r\n```\r\n\r\n```\r\n2017-06-29 14:52:30.979254: I tensorflow/compiler/xla/service/service.cc:193] XLA service 0x7ff440159ca0 executing computations on platform Host. Devices:\r\n2017-06-29 14:52:30.979277: I tensorflow/compiler/xla/service/service.cc:201]   StreamExecutor device (0): <undefined>, <undefined>\r\n-2.7442\r\n0.68 sec\r\n```\r\nBuilt from sources with XLA and CUDA, commit: 270a3e8886e352ad563a3431963296e3dc6dae06\r\n\r\n"}