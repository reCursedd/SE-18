{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/2847", "id": 73686952, "node_id": "MDExOlB1bGxSZXF1ZXN0NzM2ODY5NTI=", "html_url": "https://github.com/tensorflow/tensorflow/pull/2847", "diff_url": "https://github.com/tensorflow/tensorflow/pull/2847.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/2847.patch", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2847", "number": 2847, "state": "closed", "locked": false, "title": "[WIP] Gradient reversal op", "user": {"login": "pumpikano", "id": 603889, "node_id": "MDQ6VXNlcjYwMzg4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/603889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pumpikano", "html_url": "https://github.com/pumpikano", "followers_url": "https://api.github.com/users/pumpikano/followers", "following_url": "https://api.github.com/users/pumpikano/following{/other_user}", "gists_url": "https://api.github.com/users/pumpikano/gists{/gist_id}", "starred_url": "https://api.github.com/users/pumpikano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pumpikano/subscriptions", "organizations_url": "https://api.github.com/users/pumpikano/orgs", "repos_url": "https://api.github.com/users/pumpikano/repos", "events_url": "https://api.github.com/users/pumpikano/events{/privacy}", "received_events_url": "https://api.github.com/users/pumpikano/received_events", "type": "User", "site_admin": false}, "body": "\"[Unsupervised Domain Adaptation by Backpropagation](http://sites.skoltech.ru/compvision/projects/grl/files/paper.pdf)\" introduces a very simple but effective \"gradient reversal layer\" that is the identity for the forward computation and flips the gradient during backpropagation. This PR implements this as a user op called `FlipGradientOp`. The gradient registration is [here](https://github.com/pumpikano/tf-dann/blob/master/flip_gradient.py) (with a small MNIST experiment in that repo that uses the op).\n\nI created the PR to gauge if there is any interest in getting something like this into core or at least contrib. As you can see, the operation itself is dead simple and very general. The same effect can be achieved by processing gradients before application, but the op implementation means that everything works naturally as a result of autodiff. I may have missed a way to achieve this functionality with existing operations - if so, let me know!\n\nThe example implementation here of `FlipGradientOp` effectively multiplies the gradient by -1. It may be worth generalizing this as a `ScaleGradientOp` that scales the incoming gradient by an arbitrary scalar tensor.\n\nI'm happy to get this in mergeable shape if the tensorflow team approves.\n", "created_at": "2016-06-14T06:36:05Z", "updated_at": "2016-06-28T21:37:57Z", "closed_at": "2016-06-28T21:37:57Z", "merged_at": null, "merge_commit_sha": "b2e0e237697da6e08910be0744d948e52367ab45", "assignee": {"login": "girving", "id": 70511, "node_id": "MDQ6VXNlcjcwNTEx", "avatar_url": "https://avatars1.githubusercontent.com/u/70511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/girving", "html_url": "https://github.com/girving", "followers_url": "https://api.github.com/users/girving/followers", "following_url": "https://api.github.com/users/girving/following{/other_user}", "gists_url": "https://api.github.com/users/girving/gists{/gist_id}", "starred_url": "https://api.github.com/users/girving/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/girving/subscriptions", "organizations_url": "https://api.github.com/users/girving/orgs", "repos_url": "https://api.github.com/users/girving/repos", "events_url": "https://api.github.com/users/girving/events{/privacy}", "received_events_url": "https://api.github.com/users/girving/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "girving", "id": 70511, "node_id": "MDQ6VXNlcjcwNTEx", "avatar_url": "https://avatars1.githubusercontent.com/u/70511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/girving", "html_url": "https://github.com/girving", "followers_url": "https://api.github.com/users/girving/followers", "following_url": "https://api.github.com/users/girving/following{/other_user}", "gists_url": "https://api.github.com/users/girving/gists{/gist_id}", "starred_url": "https://api.github.com/users/girving/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/girving/subscriptions", "organizations_url": "https://api.github.com/users/girving/orgs", "repos_url": "https://api.github.com/users/girving/repos", "events_url": "https://api.github.com/users/girving/events{/privacy}", "received_events_url": "https://api.github.com/users/girving/received_events", "type": "User", "site_admin": false}], "requested_reviewers": [], "requested_teams": [], "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "milestone": null, "commits_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/2847/commits", "review_comments_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/2847/comments", "review_comment_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/2847/comments", "statuses_url": "https://api.github.com/repos/tensorflow/tensorflow/statuses/7474f1c2bf9ca455bfb4c07151e0f52b0cd340de", "head": {"label": "pumpikano:gradient_reversal", "ref": "gradient_reversal", "sha": "7474f1c2bf9ca455bfb4c07151e0f52b0cd340de", "user": {"login": "pumpikano", "id": 603889, "node_id": "MDQ6VXNlcjYwMzg4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/603889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pumpikano", "html_url": "https://github.com/pumpikano", "followers_url": "https://api.github.com/users/pumpikano/followers", "following_url": "https://api.github.com/users/pumpikano/following{/other_user}", "gists_url": "https://api.github.com/users/pumpikano/gists{/gist_id}", "starred_url": "https://api.github.com/users/pumpikano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pumpikano/subscriptions", "organizations_url": "https://api.github.com/users/pumpikano/orgs", "repos_url": "https://api.github.com/users/pumpikano/repos", "events_url": "https://api.github.com/users/pumpikano/events{/privacy}", "received_events_url": "https://api.github.com/users/pumpikano/received_events", "type": "User", "site_admin": false}, "repo": {"id": 60812144, "node_id": "MDEwOlJlcG9zaXRvcnk2MDgxMjE0NA==", "name": "tensorflow", "full_name": "pumpikano/tensorflow", "private": false, "owner": {"login": "pumpikano", "id": 603889, "node_id": "MDQ6VXNlcjYwMzg4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/603889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pumpikano", "html_url": "https://github.com/pumpikano", "followers_url": "https://api.github.com/users/pumpikano/followers", "following_url": "https://api.github.com/users/pumpikano/following{/other_user}", "gists_url": "https://api.github.com/users/pumpikano/gists{/gist_id}", "starred_url": "https://api.github.com/users/pumpikano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pumpikano/subscriptions", "organizations_url": "https://api.github.com/users/pumpikano/orgs", "repos_url": "https://api.github.com/users/pumpikano/repos", "events_url": "https://api.github.com/users/pumpikano/events{/privacy}", "received_events_url": "https://api.github.com/users/pumpikano/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/pumpikano/tensorflow", "description": "Computation using data flow graphs for scalable machine learning", "fork": true, "url": "https://api.github.com/repos/pumpikano/tensorflow", "forks_url": "https://api.github.com/repos/pumpikano/tensorflow/forks", "keys_url": "https://api.github.com/repos/pumpikano/tensorflow/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/pumpikano/tensorflow/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/pumpikano/tensorflow/teams", "hooks_url": "https://api.github.com/repos/pumpikano/tensorflow/hooks", "issue_events_url": "https://api.github.com/repos/pumpikano/tensorflow/issues/events{/number}", "events_url": "https://api.github.com/repos/pumpikano/tensorflow/events", "assignees_url": "https://api.github.com/repos/pumpikano/tensorflow/assignees{/user}", "branches_url": "https://api.github.com/repos/pumpikano/tensorflow/branches{/branch}", "tags_url": "https://api.github.com/repos/pumpikano/tensorflow/tags", "blobs_url": "https://api.github.com/repos/pumpikano/tensorflow/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/pumpikano/tensorflow/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/pumpikano/tensorflow/git/refs{/sha}", "trees_url": "https://api.github.com/repos/pumpikano/tensorflow/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/pumpikano/tensorflow/statuses/{sha}", "languages_url": "https://api.github.com/repos/pumpikano/tensorflow/languages", "stargazers_url": "https://api.github.com/repos/pumpikano/tensorflow/stargazers", "contributors_url": "https://api.github.com/repos/pumpikano/tensorflow/contributors", "subscribers_url": "https://api.github.com/repos/pumpikano/tensorflow/subscribers", "subscription_url": "https://api.github.com/repos/pumpikano/tensorflow/subscription", "commits_url": "https://api.github.com/repos/pumpikano/tensorflow/commits{/sha}", "git_commits_url": "https://api.github.com/repos/pumpikano/tensorflow/git/commits{/sha}", "comments_url": "https://api.github.com/repos/pumpikano/tensorflow/comments{/number}", "issue_comment_url": "https://api.github.com/repos/pumpikano/tensorflow/issues/comments{/number}", "contents_url": "https://api.github.com/repos/pumpikano/tensorflow/contents/{+path}", "compare_url": "https://api.github.com/repos/pumpikano/tensorflow/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/pumpikano/tensorflow/merges", "archive_url": "https://api.github.com/repos/pumpikano/tensorflow/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/pumpikano/tensorflow/downloads", "issues_url": "https://api.github.com/repos/pumpikano/tensorflow/issues{/number}", "pulls_url": "https://api.github.com/repos/pumpikano/tensorflow/pulls{/number}", "milestones_url": "https://api.github.com/repos/pumpikano/tensorflow/milestones{/number}", "notifications_url": "https://api.github.com/repos/pumpikano/tensorflow/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/pumpikano/tensorflow/labels{/name}", "releases_url": "https://api.github.com/repos/pumpikano/tensorflow/releases{/id}", "deployments_url": "https://api.github.com/repos/pumpikano/tensorflow/deployments", "created_at": "2016-06-09T22:53:15Z", "updated_at": "2016-06-09T22:53:23Z", "pushed_at": "2016-06-16T21:07:17Z", "git_url": "git://github.com/pumpikano/tensorflow.git", "ssh_url": "git@github.com:pumpikano/tensorflow.git", "clone_url": "https://github.com/pumpikano/tensorflow.git", "svn_url": "https://github.com/pumpikano/tensorflow", "homepage": "http://tensorflow.org", "size": 44870, "stargazers_count": 0, "watchers_count": 0, "language": "C++", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "forks_count": 0, "mirror_url": null, "archived": false, "open_issues_count": 0, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "tensorflow:master", "ref": "master", "sha": "bdc43730c9e6037c608adb91fe55d6c1a82879a8", "user": {"login": "tensorflow", "id": 15658638, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE1NjU4NjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15658638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tensorflow", "html_url": "https://github.com/tensorflow", "followers_url": "https://api.github.com/users/tensorflow/followers", "following_url": "https://api.github.com/users/tensorflow/following{/other_user}", "gists_url": "https://api.github.com/users/tensorflow/gists{/gist_id}", "starred_url": "https://api.github.com/users/tensorflow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tensorflow/subscriptions", "organizations_url": "https://api.github.com/users/tensorflow/orgs", "repos_url": "https://api.github.com/users/tensorflow/repos", "events_url": "https://api.github.com/users/tensorflow/events{/privacy}", "received_events_url": "https://api.github.com/users/tensorflow/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 45717250, "node_id": "MDEwOlJlcG9zaXRvcnk0NTcxNzI1MA==", "name": "tensorflow", "full_name": "tensorflow/tensorflow", "private": false, "owner": {"login": "tensorflow", "id": 15658638, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE1NjU4NjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15658638?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tensorflow", "html_url": "https://github.com/tensorflow", "followers_url": "https://api.github.com/users/tensorflow/followers", "following_url": "https://api.github.com/users/tensorflow/following{/other_user}", "gists_url": "https://api.github.com/users/tensorflow/gists{/gist_id}", "starred_url": "https://api.github.com/users/tensorflow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tensorflow/subscriptions", "organizations_url": "https://api.github.com/users/tensorflow/orgs", "repos_url": "https://api.github.com/users/tensorflow/repos", "events_url": "https://api.github.com/users/tensorflow/events{/privacy}", "received_events_url": "https://api.github.com/users/tensorflow/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/tensorflow/tensorflow", "description": "An Open Source Machine Learning Framework for Everyone", "fork": false, "url": "https://api.github.com/repos/tensorflow/tensorflow", "forks_url": "https://api.github.com/repos/tensorflow/tensorflow/forks", "keys_url": "https://api.github.com/repos/tensorflow/tensorflow/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/tensorflow/tensorflow/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/tensorflow/tensorflow/teams", "hooks_url": "https://api.github.com/repos/tensorflow/tensorflow/hooks", "issue_events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/events{/number}", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/events", "assignees_url": "https://api.github.com/repos/tensorflow/tensorflow/assignees{/user}", "branches_url": "https://api.github.com/repos/tensorflow/tensorflow/branches{/branch}", "tags_url": "https://api.github.com/repos/tensorflow/tensorflow/tags", "blobs_url": "https://api.github.com/repos/tensorflow/tensorflow/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/tensorflow/tensorflow/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/tensorflow/tensorflow/git/refs{/sha}", "trees_url": "https://api.github.com/repos/tensorflow/tensorflow/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/tensorflow/tensorflow/statuses/{sha}", "languages_url": "https://api.github.com/repos/tensorflow/tensorflow/languages", "stargazers_url": "https://api.github.com/repos/tensorflow/tensorflow/stargazers", "contributors_url": "https://api.github.com/repos/tensorflow/tensorflow/contributors", "subscribers_url": "https://api.github.com/repos/tensorflow/tensorflow/subscribers", "subscription_url": "https://api.github.com/repos/tensorflow/tensorflow/subscription", "commits_url": "https://api.github.com/repos/tensorflow/tensorflow/commits{/sha}", "git_commits_url": "https://api.github.com/repos/tensorflow/tensorflow/git/commits{/sha}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/comments{/number}", "issue_comment_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments{/number}", "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/{+path}", "compare_url": "https://api.github.com/repos/tensorflow/tensorflow/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/tensorflow/tensorflow/merges", "archive_url": "https://api.github.com/repos/tensorflow/tensorflow/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/tensorflow/tensorflow/downloads", "issues_url": "https://api.github.com/repos/tensorflow/tensorflow/issues{/number}", "pulls_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls{/number}", "milestones_url": "https://api.github.com/repos/tensorflow/tensorflow/milestones{/number}", "notifications_url": "https://api.github.com/repos/tensorflow/tensorflow/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/labels{/name}", "releases_url": "https://api.github.com/repos/tensorflow/tensorflow/releases{/id}", "deployments_url": "https://api.github.com/repos/tensorflow/tensorflow/deployments", "created_at": "2015-11-07T01:19:20Z", "updated_at": "2018-11-25T01:43:55Z", "pushed_at": "2018-11-24T18:40:19Z", "git_url": "git://github.com/tensorflow/tensorflow.git", "ssh_url": "git@github.com:tensorflow/tensorflow.git", "clone_url": "https://github.com/tensorflow/tensorflow.git", "svn_url": "https://github.com/tensorflow/tensorflow", "homepage": "https://tensorflow.org", "size": 284546, "stargazers_count": 115177, "watchers_count": 115177, "language": "C++", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "forks_count": 69948, "mirror_url": null, "archived": false, "open_issues_count": 1760, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "forks": 69948, "open_issues": 1760, "watchers": 115177, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/2847"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/2847"}, "issue": {"href": "https://api.github.com/repos/tensorflow/tensorflow/issues/2847"}, "comments": {"href": "https://api.github.com/repos/tensorflow/tensorflow/issues/2847/comments"}, "review_comments": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/2847/comments"}, "review_comment": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/2847/commits"}, "statuses": {"href": "https://api.github.com/repos/tensorflow/tensorflow/statuses/7474f1c2bf9ca455bfb4c07151e0f52b0cd340de"}}, "author_association": "NONE", "body_html": "<p>\"<a href=\"http://sites.skoltech.ru/compvision/projects/grl/files/paper.pdf\" rel=\"nofollow\">Unsupervised Domain Adaptation by Backpropagation</a>\" introduces a very simple but effective \"gradient reversal layer\" that is the identity for the forward computation and flips the gradient during backpropagation. This PR implements this as a user op called <code>FlipGradientOp</code>. The gradient registration is <a href=\"https://github.com/pumpikano/tf-dann/blob/master/flip_gradient.py\">here</a> (with a small MNIST experiment in that repo that uses the op).</p>\n<p>I created the PR to gauge if there is any interest in getting something like this into core or at least contrib. As you can see, the operation itself is dead simple and very general. The same effect can be achieved by processing gradients before application, but the op implementation means that everything works naturally as a result of autodiff. I may have missed a way to achieve this functionality with existing operations - if so, let me know!</p>\n<p>The example implementation here of <code>FlipGradientOp</code> effectively multiplies the gradient by -1. It may be worth generalizing this as a <code>ScaleGradientOp</code> that scales the incoming gradient by an arbitrary scalar tensor.</p>\n<p>I'm happy to get this in mergeable shape if the tensorflow team approves.</p>", "body_text": "\"Unsupervised Domain Adaptation by Backpropagation\" introduces a very simple but effective \"gradient reversal layer\" that is the identity for the forward computation and flips the gradient during backpropagation. This PR implements this as a user op called FlipGradientOp. The gradient registration is here (with a small MNIST experiment in that repo that uses the op).\nI created the PR to gauge if there is any interest in getting something like this into core or at least contrib. As you can see, the operation itself is dead simple and very general. The same effect can be achieved by processing gradients before application, but the op implementation means that everything works naturally as a result of autodiff. I may have missed a way to achieve this functionality with existing operations - if so, let me know!\nThe example implementation here of FlipGradientOp effectively multiplies the gradient by -1. It may be worth generalizing this as a ScaleGradientOp that scales the incoming gradient by an arbitrary scalar tensor.\nI'm happy to get this in mergeable shape if the tensorflow team approves.", "merged": false, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": null, "comments": 7, "review_comments": 0, "maintainer_can_modify": false, "commits": 2, "additions": 40, "deletions": 0, "changed_files": 2}