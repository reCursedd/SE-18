{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/419290536", "html_url": "https://github.com/tensorflow/tensorflow/pull/16175#issuecomment-419290536", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/16175", "id": 419290536, "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTI5MDUzNg==", "user": {"login": "freedomtan", "id": 3395998, "node_id": "MDQ6VXNlcjMzOTU5OTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3395998?v=4", "gravatar_id": "", "url": "https://api.github.com/users/freedomtan", "html_url": "https://github.com/freedomtan", "followers_url": "https://api.github.com/users/freedomtan/followers", "following_url": "https://api.github.com/users/freedomtan/following{/other_user}", "gists_url": "https://api.github.com/users/freedomtan/gists{/gist_id}", "starred_url": "https://api.github.com/users/freedomtan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/freedomtan/subscriptions", "organizations_url": "https://api.github.com/users/freedomtan/orgs", "repos_url": "https://api.github.com/users/freedomtan/repos", "events_url": "https://api.github.com/users/freedomtan/events{/privacy}", "received_events_url": "https://api.github.com/users/freedomtan/received_events", "type": "User", "site_admin": false}, "created_at": "2018-09-07T01:21:15Z", "updated_at": "2018-09-07T01:21:15Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Additional notes.</p>\n<p>Without this patch, I can build pip wheel successfully, but when running something use TF Lite Python binding, e.g., the <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/examples/python/label_image.md\">label_image in TF Lite Python binding</a>, I got error messages the same as what reported in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"350017922\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/21574\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/21574/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/21574\">#21574</a></p>\n<pre><code>ImportError: /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so: undefined symbol: _ZN6tflite12tensor_utils39NeonMatrixBatchVectorMultiplyAccumulateEPKfiiS2_iPfi\n</code></pre>\n<p>And when building something like TF Lite benchmark_model or label_image for TF Lite, I saw</p>\n<pre><code>ERROR: /home/freedom/work/tensorflow/tensorflow/contrib/lite/tools/benchmark/BUILD:19:1: Linking of rule '//tensorflow/contrib/lite/tools/benchmark:benchmark_model' failed (Exit 1)\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::MatrixBatchVectorMultiplyAccumulate(float const*, int, int, float const*, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonMatrixBatchVectorMultiplyAccumulate(float const*, int, int, float const*, int, float*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::MatrixBatchVectorMultiplyAccumulate(signed char const*, int, int, signed char const*, float const*, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonMatrixBatchVectorMultiplyAccumulate(signed char const*, int, int, signed char const*, float const*, int, float*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorVectorCwiseProduct(float const*, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorVectorCwiseProduct(float const*, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorVectorCwiseProductAccumulate(float const*, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorVectorCwiseProductAccumulate(float const*, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorBatchVectorCwiseProduct(float const*, int, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorBatchVectorCwiseProduct(float const*, int, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorBatchVectorCwiseProductAccumulate(float const*, int, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorBatchVectorCwiseProductAccumulate(float const*, int, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::BatchVectorBatchVectorDotProduct(float const*, float const*, int, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonBatchVectorBatchVectorDotProduct(float const*, float const*, int, int, float*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::Sub1Vector(float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonSub1Vector(float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::IsZeroVector(float const*, int): error: undefined reference to 'tflite::tensor_utils::NeonIsZeroVector(float const*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorScalarMultiply(signed char const*, int, float, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorScalarMultiply(signed char const*, int, float, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::ClipVector(float const*, int, float, float*): error: undefined reference to 'tflite::tensor_utils::NeonClipVector(float const*, int, float, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::SymmetricQuantizeFloats(float const*, int, signed char*, float*, float*, float*): error: undefined reference to 'tflite::tensor_utils::NeonSymmetricQuantizeFloats(float const*, int, signed char*, float*, float*, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorShiftLeft(float*, int, float): error: undefined reference to 'tflite::tensor_utils::NeonVectorShiftLeft(float*, int, float)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::ReductionSumVector(float const*, float*, int, int): error: undefined reference to 'tflite::tensor_utils::NeonReductionSumVector(float const*, float*, int, int)'\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/contrib/lite/tools/benchmark:benchmark_model failed to build\n</code></pre>", "body_text": "Additional notes.\nWithout this patch, I can build pip wheel successfully, but when running something use TF Lite Python binding, e.g., the label_image in TF Lite Python binding, I got error messages the same as what reported in #21574\nImportError: /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so: undefined symbol: _ZN6tflite12tensor_utils39NeonMatrixBatchVectorMultiplyAccumulateEPKfiiS2_iPfi\n\nAnd when building something like TF Lite benchmark_model or label_image for TF Lite, I saw\nERROR: /home/freedom/work/tensorflow/tensorflow/contrib/lite/tools/benchmark/BUILD:19:1: Linking of rule '//tensorflow/contrib/lite/tools/benchmark:benchmark_model' failed (Exit 1)\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::MatrixBatchVectorMultiplyAccumulate(float const*, int, int, float const*, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonMatrixBatchVectorMultiplyAccumulate(float const*, int, int, float const*, int, float*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::MatrixBatchVectorMultiplyAccumulate(signed char const*, int, int, signed char const*, float const*, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonMatrixBatchVectorMultiplyAccumulate(signed char const*, int, int, signed char const*, float const*, int, float*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorVectorCwiseProduct(float const*, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorVectorCwiseProduct(float const*, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorVectorCwiseProductAccumulate(float const*, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorVectorCwiseProductAccumulate(float const*, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorBatchVectorCwiseProduct(float const*, int, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorBatchVectorCwiseProduct(float const*, int, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorBatchVectorCwiseProductAccumulate(float const*, int, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorBatchVectorCwiseProductAccumulate(float const*, int, float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::BatchVectorBatchVectorDotProduct(float const*, float const*, int, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonBatchVectorBatchVectorDotProduct(float const*, float const*, int, int, float*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::Sub1Vector(float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonSub1Vector(float const*, int, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::IsZeroVector(float const*, int): error: undefined reference to 'tflite::tensor_utils::NeonIsZeroVector(float const*, int)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorScalarMultiply(signed char const*, int, float, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorScalarMultiply(signed char const*, int, float, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::ClipVector(float const*, int, float, float*): error: undefined reference to 'tflite::tensor_utils::NeonClipVector(float const*, int, float, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::SymmetricQuantizeFloats(float const*, int, signed char*, float*, float*, float*): error: undefined reference to 'tflite::tensor_utils::NeonSymmetricQuantizeFloats(float const*, int, signed char*, float*, float*, float*)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorShiftLeft(float*, int, float): error: undefined reference to 'tflite::tensor_utils::NeonVectorShiftLeft(float*, int, float)'\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::ReductionSumVector(float const*, float*, int, int): error: undefined reference to 'tflite::tensor_utils::NeonReductionSumVector(float const*, float*, int, int)'\ncollect2: error: ld returned 1 exit status\nTarget //tensorflow/contrib/lite/tools/benchmark:benchmark_model failed to build", "body": "Additional notes.\r\n\r\nWithout this patch, I can build pip wheel successfully, but when running something use TF Lite Python binding, e.g., the [label_image in TF Lite Python binding](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/examples/python/label_image.md), I got error messages the same as what reported in https://github.com/tensorflow/tensorflow/issues/21574\r\n\r\n```\r\nImportError: /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so: undefined symbol: _ZN6tflite12tensor_utils39NeonMatrixBatchVectorMultiplyAccumulateEPKfiiS2_iPfi\r\n```\r\n\r\nAnd when building something like TF Lite benchmark_model or label_image for TF Lite, I saw \r\n\r\n```\r\nERROR: /home/freedom/work/tensorflow/tensorflow/contrib/lite/tools/benchmark/BUILD:19:1: Linking of rule '//tensorflow/contrib/lite/tools/benchmark:benchmark_model' failed (Exit 1)\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::MatrixBatchVectorMultiplyAccumulate(float const*, int, int, float const*, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonMatrixBatchVectorMultiplyAccumulate(float const*, int, int, float const*, int, float*, int)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::MatrixBatchVectorMultiplyAccumulate(signed char const*, int, int, signed char const*, float const*, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonMatrixBatchVectorMultiplyAccumulate(signed char const*, int, int, signed char const*, float const*, int, float*, int)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorVectorCwiseProduct(float const*, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorVectorCwiseProduct(float const*, float const*, int, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorVectorCwiseProductAccumulate(float const*, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorVectorCwiseProductAccumulate(float const*, float const*, int, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorBatchVectorCwiseProduct(float const*, int, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorBatchVectorCwiseProduct(float const*, int, float const*, int, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorBatchVectorCwiseProductAccumulate(float const*, int, float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorBatchVectorCwiseProductAccumulate(float const*, int, float const*, int, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::BatchVectorBatchVectorDotProduct(float const*, float const*, int, int, float*, int): error: undefined reference to 'tflite::tensor_utils::NeonBatchVectorBatchVectorDotProduct(float const*, float const*, int, int, float*, int)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::Sub1Vector(float const*, int, float*): error: undefined reference to 'tflite::tensor_utils::NeonSub1Vector(float const*, int, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::IsZeroVector(float const*, int): error: undefined reference to 'tflite::tensor_utils::NeonIsZeroVector(float const*, int)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorScalarMultiply(signed char const*, int, float, float*): error: undefined reference to 'tflite::tensor_utils::NeonVectorScalarMultiply(signed char const*, int, float, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::ClipVector(float const*, int, float, float*): error: undefined reference to 'tflite::tensor_utils::NeonClipVector(float const*, int, float, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::SymmetricQuantizeFloats(float const*, int, signed char*, float*, float*, float*): error: undefined reference to 'tflite::tensor_utils::NeonSymmetricQuantizeFloats(float const*, int, signed char*, float*, float*, float*)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::VectorShiftLeft(float*, int, float): error: undefined reference to 'tflite::tensor_utils::NeonVectorShiftLeft(float*, int, float)'\r\nbazel-out/aarch64-opt/bin/tensorflow/contrib/lite/kernels/internal/_objs/tensor_utils/tensor_utils.o:tensor_utils.cc:function tflite::tensor_utils::ReductionSumVector(float const*, float*, int, int): error: undefined reference to 'tflite::tensor_utils::NeonReductionSumVector(float const*, float*, int, int)'\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/contrib/lite/tools/benchmark:benchmark_model failed to build\r\n```"}