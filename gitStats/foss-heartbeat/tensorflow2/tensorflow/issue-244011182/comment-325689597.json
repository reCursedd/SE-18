{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/325689597", "html_url": "https://github.com/tensorflow/tensorflow/issues/11603#issuecomment-325689597", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11603", "id": 325689597, "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTY4OTU5Nw==", "user": {"login": "vaibhavsood", "id": 3442240, "node_id": "MDQ6VXNlcjM0NDIyNDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/3442240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vaibhavsood", "html_url": "https://github.com/vaibhavsood", "followers_url": "https://api.github.com/users/vaibhavsood/followers", "following_url": "https://api.github.com/users/vaibhavsood/following{/other_user}", "gists_url": "https://api.github.com/users/vaibhavsood/gists{/gist_id}", "starred_url": "https://api.github.com/users/vaibhavsood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vaibhavsood/subscriptions", "organizations_url": "https://api.github.com/users/vaibhavsood/orgs", "repos_url": "https://api.github.com/users/vaibhavsood/repos", "events_url": "https://api.github.com/users/vaibhavsood/events{/privacy}", "received_events_url": "https://api.github.com/users/vaibhavsood/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-29T14:52:39Z", "updated_at": "2017-08-29T14:52:39Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Hi <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=20959853\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/drpngx\">@drpngx</a> , all</p>\n<p>Investigating this further, the relu function from gen_nn_ops calls cwiseMax(..) in eigen here:</p>\n<p><a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/relu_op_functor.h#L35\">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/relu_op_functor.h#L35</a></p>\n<p>Tried to go down further from here, cwiseMax goes to the eigen source code, under eigen found a issue as below:</p>\n<p><strong>There is a bug filed under Eigen which switches the parameters to pmax etc</strong></p>\n<p><a href=\"http://eigen.tuxfamily.org/bz/show_bug.cgi?id=1373\" rel=\"nofollow\">http://eigen.tuxfamily.org/bz/show_bug.cgi?id=1373</a></p>\n<p>The corresponding PR makes changes to Eigen/src/core code files (PacketMath* etc), im not sure if these changes are present under the tensorflow source tree</p>\n<p>Should these changes be incorporated into tensorflow sources? (specifically the ppc changes in files AVX/PacketMath.h etc)</p>\n<p>Also the eigen source files in tensorflow look different from the ones in the eigen repository (for eg. tf has file called PacketMathAVX2.h while eigen has AVX/PacketMath.h), if could get some pointers where these changes would need to be made in tensorflow if needed to fix this issue?</p>\n<p>I am still learning/understanding this part of the code, any further pointers will help a lot!</p>\n<p>Thanks for any help!</p>", "body_text": "Hi @drpngx , all\nInvestigating this further, the relu function from gen_nn_ops calls cwiseMax(..) in eigen here:\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/relu_op_functor.h#L35\nTried to go down further from here, cwiseMax goes to the eigen source code, under eigen found a issue as below:\nThere is a bug filed under Eigen which switches the parameters to pmax etc\nhttp://eigen.tuxfamily.org/bz/show_bug.cgi?id=1373\nThe corresponding PR makes changes to Eigen/src/core code files (PacketMath* etc), im not sure if these changes are present under the tensorflow source tree\nShould these changes be incorporated into tensorflow sources? (specifically the ppc changes in files AVX/PacketMath.h etc)\nAlso the eigen source files in tensorflow look different from the ones in the eigen repository (for eg. tf has file called PacketMathAVX2.h while eigen has AVX/PacketMath.h), if could get some pointers where these changes would need to be made in tensorflow if needed to fix this issue?\nI am still learning/understanding this part of the code, any further pointers will help a lot!\nThanks for any help!", "body": "Hi @drpngx , all\r\n\r\nInvestigating this further, the relu function from gen_nn_ops calls cwiseMax(..) in eigen here:\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/relu_op_functor.h#L35\r\n\r\nTried to go down further from here, cwiseMax goes to the eigen source code, under eigen found a issue as below:\r\n\r\n**There is a bug filed under Eigen which switches the parameters to pmax etc**\r\n\r\nhttp://eigen.tuxfamily.org/bz/show_bug.cgi?id=1373\r\n\r\nThe corresponding PR makes changes to Eigen/src/core code files (PacketMath* etc), im not sure if these changes are present under the tensorflow source tree\r\n\r\nShould these changes be incorporated into tensorflow sources? (specifically the ppc changes in files AVX/PacketMath.h etc) \r\n\r\nAlso the eigen source files in tensorflow look different from the ones in the eigen repository (for eg. tf has file called PacketMathAVX2.h while eigen has AVX/PacketMath.h), if could get some pointers where these changes would need to be made in tensorflow if needed to fix this issue?\r\n\r\nI am still learning/understanding this part of the code, any further pointers will help a lot!\r\n\r\nThanks for any help!\r\n\r\n\r\n\r\n\r\n\r\n"}