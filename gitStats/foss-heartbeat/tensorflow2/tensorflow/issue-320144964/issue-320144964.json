{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19073", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19073/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19073/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19073/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19073", "id": 320144964, "node_id": "MDU6SXNzdWUzMjAxNDQ5NjQ=", "number": 19073, "title": "Tensorflow-GPU costing 3130% cpu resouces not for computation", "user": {"login": "ghostplant", "id": 12099308, "node_id": "MDQ6VXNlcjEyMDk5MzA4", "avatar_url": "https://avatars2.githubusercontent.com/u/12099308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghostplant", "html_url": "https://github.com/ghostplant", "followers_url": "https://api.github.com/users/ghostplant/followers", "following_url": "https://api.github.com/users/ghostplant/following{/other_user}", "gists_url": "https://api.github.com/users/ghostplant/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghostplant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghostplant/subscriptions", "organizations_url": "https://api.github.com/users/ghostplant/orgs", "repos_url": "https://api.github.com/users/ghostplant/repos", "events_url": "https://api.github.com/users/ghostplant/events{/privacy}", "received_events_url": "https://api.github.com/users/ghostplant/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2018-05-04T03:35:21Z", "updated_at": "2018-06-11T02:46:12Z", "closed_at": "2018-06-11T02:46:12Z", "author_association": "CONTRIBUTOR", "body_html": "<p>My host has 16 core cpu (with x2 hyper-thread), when I run resnet50 (weights &amp; sync on gpu) benchmark for Tensorflow CUDA version, it actually not need CPU to do any heavy job since training and weights merge are done at gpu device. But it costs nearly full CPU resources not for computing but for long pulling queries on <code>cuEventQuery</code>, and 99% of <code>cuEventQuery</code> replies NOT_FINISHED, this is extremely bad for cpu utilization, and block all CPU cores from doing other tasks.</p>\n<p>According to my profiling, for Resnet50, Tensorflow costs only 14840 time of model forward and backward, but it gathers all threads to do full-time queries, and should cost 23564854 times to do useless <code>cuEventQuery</code> due to not ready, which is incredibly heavy and triggers 3130% CPU cost on Tensorflow GPU computational version.</p>", "body_text": "My host has 16 core cpu (with x2 hyper-thread), when I run resnet50 (weights & sync on gpu) benchmark for Tensorflow CUDA version, it actually not need CPU to do any heavy job since training and weights merge are done at gpu device. But it costs nearly full CPU resources not for computing but for long pulling queries on cuEventQuery, and 99% of cuEventQuery replies NOT_FINISHED, this is extremely bad for cpu utilization, and block all CPU cores from doing other tasks.\nAccording to my profiling, for Resnet50, Tensorflow costs only 14840 time of model forward and backward, but it gathers all threads to do full-time queries, and should cost 23564854 times to do useless cuEventQuery due to not ready, which is incredibly heavy and triggers 3130% CPU cost on Tensorflow GPU computational version.", "body": "My host has 16 core cpu (with x2 hyper-thread), when I run resnet50 (weights & sync on gpu) benchmark for Tensorflow CUDA version, it actually not need CPU to do any heavy job since training and weights merge are done at gpu device. But it costs nearly full CPU resources not for computing but for long pulling queries on `cuEventQuery`, and 99% of `cuEventQuery` replies NOT_FINISHED, this is extremely bad for cpu utilization, and block all CPU cores from doing other tasks.\r\n\r\nAccording to my profiling, for Resnet50, Tensorflow costs only 14840 time of model forward and backward, but it gathers all threads to do full-time queries, and should cost 23564854 times to do useless `cuEventQuery` due to not ready, which is incredibly heavy and triggers 3130% CPU cost on Tensorflow GPU computational version."}