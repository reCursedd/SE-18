{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1344", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1344/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1344/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/1344/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/1344", "id": 137576785, "node_id": "MDU6SXNzdWUxMzc1NzY3ODU=", "number": 1344, "title": "op.device no longer showing which device an op is actually placed on", "user": {"login": "alquraishi", "id": 5205204, "node_id": "MDQ6VXNlcjUyMDUyMDQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/5205204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alquraishi", "html_url": "https://github.com/alquraishi", "followers_url": "https://api.github.com/users/alquraishi/followers", "following_url": "https://api.github.com/users/alquraishi/following{/other_user}", "gists_url": "https://api.github.com/users/alquraishi/gists{/gist_id}", "starred_url": "https://api.github.com/users/alquraishi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alquraishi/subscriptions", "organizations_url": "https://api.github.com/users/alquraishi/orgs", "repos_url": "https://api.github.com/users/alquraishi/repos", "events_url": "https://api.github.com/users/alquraishi/events{/privacy}", "received_events_url": "https://api.github.com/users/alquraishi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-03-01T13:39:44Z", "updated_at": "2018-04-11T20:59:50Z", "closed_at": "2016-04-15T20:50:02Z", "author_association": "NONE", "body_html": "<p>Using the latest builds, it appears that <code>op.device</code> now returns the device that an op is supposed to be placed on, i.e. what the user specifies, as opposed to what it is actually placed on. I believe this is true because when I set <code>allow_soft_placement</code> to <code>False</code> when starting a <code>Session</code>, some ops, for example <code>global_step</code>, cannot be placed on the GPU. But if I assign them to the GPU and then allow soft placement, <code>op.device</code> returns <code>/gpu:0</code> for ops that were previously not placeable on the GPU.</p>\n<p>This is a break from previous behavior, which showed the actual device an op is placed on. The new behavior makes it very difficult to debug device placement. Is there are any way to probe the actual device that an op is placed on?</p>\n<p>P.S. I'm using a device function for my placement logic. Something like:</p>\n<pre><code>def _device_function(op):\n    if complicated_logic_true:\n        return '/cpu:0'\n    else:\n        return '/gpu:0'\n</code></pre>", "body_text": "Using the latest builds, it appears that op.device now returns the device that an op is supposed to be placed on, i.e. what the user specifies, as opposed to what it is actually placed on. I believe this is true because when I set allow_soft_placement to False when starting a Session, some ops, for example global_step, cannot be placed on the GPU. But if I assign them to the GPU and then allow soft placement, op.device returns /gpu:0 for ops that were previously not placeable on the GPU.\nThis is a break from previous behavior, which showed the actual device an op is placed on. The new behavior makes it very difficult to debug device placement. Is there are any way to probe the actual device that an op is placed on?\nP.S. I'm using a device function for my placement logic. Something like:\ndef _device_function(op):\n    if complicated_logic_true:\n        return '/cpu:0'\n    else:\n        return '/gpu:0'", "body": "Using the latest builds, it appears that `op.device` now returns the device that an op is supposed to be placed on, i.e. what the user specifies, as opposed to what it is actually placed on. I believe this is true because when I set `allow_soft_placement` to `False` when starting a `Session`, some ops, for example `global_step`, cannot be placed on the GPU. But if I assign them to the GPU and then allow soft placement, `op.device` returns `/gpu:0` for ops that were previously not placeable on the GPU.\n\nThis is a break from previous behavior, which showed the actual device an op is placed on. The new behavior makes it very difficult to debug device placement. Is there are any way to probe the actual device that an op is placed on?\n\nP.S. I'm using a device function for my placement logic. Something like:\n\n```\ndef _device_function(op):\n    if complicated_logic_true:\n        return '/cpu:0'\n    else:\n        return '/gpu:0'\n```\n"}