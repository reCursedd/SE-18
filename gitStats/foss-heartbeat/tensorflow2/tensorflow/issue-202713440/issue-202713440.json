{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7031", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7031/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7031/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/7031/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/7031", "id": 202713440, "node_id": "MDU6SXNzdWUyMDI3MTM0NDA=", "number": 7031, "title": "TypeError: Expected int32, got list containing Tensors of type '_Message' instead.", "user": {"login": "deepankar1994", "id": 10565180, "node_id": "MDQ6VXNlcjEwNTY1MTgw", "avatar_url": "https://avatars0.githubusercontent.com/u/10565180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deepankar1994", "html_url": "https://github.com/deepankar1994", "followers_url": "https://api.github.com/users/deepankar1994/followers", "following_url": "https://api.github.com/users/deepankar1994/following{/other_user}", "gists_url": "https://api.github.com/users/deepankar1994/gists{/gist_id}", "starred_url": "https://api.github.com/users/deepankar1994/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deepankar1994/subscriptions", "organizations_url": "https://api.github.com/users/deepankar1994/orgs", "repos_url": "https://api.github.com/users/deepankar1994/repos", "events_url": "https://api.github.com/users/deepankar1994/events{/privacy}", "received_events_url": "https://api.github.com/users/deepankar1994/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sguada", "id": 1766524, "node_id": "MDQ6VXNlcjE3NjY1MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1766524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sguada", "html_url": "https://github.com/sguada", "followers_url": "https://api.github.com/users/sguada/followers", "following_url": "https://api.github.com/users/sguada/following{/other_user}", "gists_url": "https://api.github.com/users/sguada/gists{/gist_id}", "starred_url": "https://api.github.com/users/sguada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sguada/subscriptions", "organizations_url": "https://api.github.com/users/sguada/orgs", "repos_url": "https://api.github.com/users/sguada/repos", "events_url": "https://api.github.com/users/sguada/events{/privacy}", "received_events_url": "https://api.github.com/users/sguada/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 29, "created_at": "2017-01-24T03:08:10Z", "updated_at": "2018-11-20T13:22:56Z", "closed_at": "2017-06-16T21:03:15Z", "author_association": "NONE", "body_html": "<p>Hi,<br>\nI am using TF ver 0.12.head on Ubuntu 16.04 Python 2.7 and following <a href=\"https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb\">this</a> for learning inception model in TF Slim</p>\n<pre><code>\nimport numpy as np\nimport os\nimport tensorflow as tf\nimport urllib2\n\nfrom datasets import imagenet\nfrom nets import inception\nfrom preprocessing import inception_preprocessing\n\nslim = tf.contrib.slim\n\nbatch_size = 3\nimage_size = inception.inception_v1.default_image_size\ncheckpoints_dir = '/tmp/checkpoints/'\nwith tf.Graph().as_default():\n    url = 'https://upload.wikimedia.org/wikipedia/commons/7/70/EnglishCockerSpaniel_simon.jpg'\n    image_string = urllib2.urlopen(url).read()\n    image = tf.image.decode_jpeg(image_string, channels=3)\n    processed_image = inception_preprocessing.preprocess_image(image, image_size, image_size, is_training=False)\n    processed_images  = tf.expand_dims(processed_image, 0)\n    \n    # Create the model, use the default arg scope to configure the batch norm parameters.\n    with slim.arg_scope(inception.inception_v1_arg_scope()):\n        logits, _ = inception.inception_v1(processed_images, num_classes=1001, is_training=False)\n    probabilities = tf.nn.softmax(logits)\n    \n    init_fn = slim.assign_from_checkpoint_fn(\n        os.path.join(checkpoints_dir, 'inception_v1.ckpt'),\n        slim.get_model_variables('InceptionV1'))\n    \n    with tf.Session() as sess:\n        init_fn(sess)\n        np_image, probabilities = sess.run([image, probabilities])\n        probabilities = probabilities[0, 0:]\n        sorted_inds = [i[0] for i in sorted(enumerate(-probabilities), key=lambda x:x[1])]\n        \n    plt.figure()\n    plt.imshow(np_image.astype(np.uint8))\n    plt.axis('off')\n    plt.show()\n\n    names = imagenet.create_readable_names_for_imagenet_labels()\n    for i in range(5):\n        index = sorted_inds[i]\n        print('Probability %0.2f%% =&gt; [%s]' % (probabilities[index], names[index]))\n</code></pre>\n<p>However I am getting the following issue when running this:</p>\n<pre><code>    logits, _ = inception.inception_v1(processed_images, num_classes=1001, is_training=False)\n  File \"/home/deepankar1994/Desktop/MTP/TensorFlowEx/TFSlim/models/slim/nets/inception_v1.py\", line 290, in inception_v1\n    net, end_points = inception_v1_base(inputs, scope=scope)\n  File \"/home/deepankar1994/Desktop/MTP/TensorFlowEx/TFSlim/models/slim/nets/inception_v1.py\", line 96, in inception_v1_base\n    net = tf.concat(3, [branch_0, branch_1, branch_2, branch_3])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1053, in concat\n    dtype=dtypes.int32).get_shape(\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 651, in convert_to_tensor\n    as_ref=False)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 716, in internal_convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/tensor_util.py\", line 367, in make_tensor_proto\n    _AssertCompatible(values, dtype)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/tensor_util.py\", line 302, in _AssertCompatible\n    (dtype.name, repr(mismatch), type(mismatch).__name__))\nTypeError: Expected int32, got list containing Tensors of type '_Message' instead.\n</code></pre>", "body_text": "Hi,\nI am using TF ver 0.12.head on Ubuntu 16.04 Python 2.7 and following this for learning inception model in TF Slim\n\nimport numpy as np\nimport os\nimport tensorflow as tf\nimport urllib2\n\nfrom datasets import imagenet\nfrom nets import inception\nfrom preprocessing import inception_preprocessing\n\nslim = tf.contrib.slim\n\nbatch_size = 3\nimage_size = inception.inception_v1.default_image_size\ncheckpoints_dir = '/tmp/checkpoints/'\nwith tf.Graph().as_default():\n    url = 'https://upload.wikimedia.org/wikipedia/commons/7/70/EnglishCockerSpaniel_simon.jpg'\n    image_string = urllib2.urlopen(url).read()\n    image = tf.image.decode_jpeg(image_string, channels=3)\n    processed_image = inception_preprocessing.preprocess_image(image, image_size, image_size, is_training=False)\n    processed_images  = tf.expand_dims(processed_image, 0)\n    \n    # Create the model, use the default arg scope to configure the batch norm parameters.\n    with slim.arg_scope(inception.inception_v1_arg_scope()):\n        logits, _ = inception.inception_v1(processed_images, num_classes=1001, is_training=False)\n    probabilities = tf.nn.softmax(logits)\n    \n    init_fn = slim.assign_from_checkpoint_fn(\n        os.path.join(checkpoints_dir, 'inception_v1.ckpt'),\n        slim.get_model_variables('InceptionV1'))\n    \n    with tf.Session() as sess:\n        init_fn(sess)\n        np_image, probabilities = sess.run([image, probabilities])\n        probabilities = probabilities[0, 0:]\n        sorted_inds = [i[0] for i in sorted(enumerate(-probabilities), key=lambda x:x[1])]\n        \n    plt.figure()\n    plt.imshow(np_image.astype(np.uint8))\n    plt.axis('off')\n    plt.show()\n\n    names = imagenet.create_readable_names_for_imagenet_labels()\n    for i in range(5):\n        index = sorted_inds[i]\n        print('Probability %0.2f%% => [%s]' % (probabilities[index], names[index]))\n\nHowever I am getting the following issue when running this:\n    logits, _ = inception.inception_v1(processed_images, num_classes=1001, is_training=False)\n  File \"/home/deepankar1994/Desktop/MTP/TensorFlowEx/TFSlim/models/slim/nets/inception_v1.py\", line 290, in inception_v1\n    net, end_points = inception_v1_base(inputs, scope=scope)\n  File \"/home/deepankar1994/Desktop/MTP/TensorFlowEx/TFSlim/models/slim/nets/inception_v1.py\", line 96, in inception_v1_base\n    net = tf.concat(3, [branch_0, branch_1, branch_2, branch_3])\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1053, in concat\n    dtype=dtypes.int32).get_shape(\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 651, in convert_to_tensor\n    as_ref=False)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 716, in internal_convert_to_tensor\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\n    return constant(v, dtype=dtype, name=name)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/tensor_util.py\", line 367, in make_tensor_proto\n    _AssertCompatible(values, dtype)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/tensor_util.py\", line 302, in _AssertCompatible\n    (dtype.name, repr(mismatch), type(mismatch).__name__))\nTypeError: Expected int32, got list containing Tensors of type '_Message' instead.", "body": "Hi,\r\nI am using TF ver 0.12.head on Ubuntu 16.04 Python 2.7 and following [this](https://github.com/tensorflow/models/blob/master/slim/slim_walkthough.ipynb) for learning inception model in TF Slim\r\n```\r\n\r\nimport numpy as np\r\nimport os\r\nimport tensorflow as tf\r\nimport urllib2\r\n\r\nfrom datasets import imagenet\r\nfrom nets import inception\r\nfrom preprocessing import inception_preprocessing\r\n\r\nslim = tf.contrib.slim\r\n\r\nbatch_size = 3\r\nimage_size = inception.inception_v1.default_image_size\r\ncheckpoints_dir = '/tmp/checkpoints/'\r\nwith tf.Graph().as_default():\r\n    url = 'https://upload.wikimedia.org/wikipedia/commons/7/70/EnglishCockerSpaniel_simon.jpg'\r\n    image_string = urllib2.urlopen(url).read()\r\n    image = tf.image.decode_jpeg(image_string, channels=3)\r\n    processed_image = inception_preprocessing.preprocess_image(image, image_size, image_size, is_training=False)\r\n    processed_images  = tf.expand_dims(processed_image, 0)\r\n    \r\n    # Create the model, use the default arg scope to configure the batch norm parameters.\r\n    with slim.arg_scope(inception.inception_v1_arg_scope()):\r\n        logits, _ = inception.inception_v1(processed_images, num_classes=1001, is_training=False)\r\n    probabilities = tf.nn.softmax(logits)\r\n    \r\n    init_fn = slim.assign_from_checkpoint_fn(\r\n        os.path.join(checkpoints_dir, 'inception_v1.ckpt'),\r\n        slim.get_model_variables('InceptionV1'))\r\n    \r\n    with tf.Session() as sess:\r\n        init_fn(sess)\r\n        np_image, probabilities = sess.run([image, probabilities])\r\n        probabilities = probabilities[0, 0:]\r\n        sorted_inds = [i[0] for i in sorted(enumerate(-probabilities), key=lambda x:x[1])]\r\n        \r\n    plt.figure()\r\n    plt.imshow(np_image.astype(np.uint8))\r\n    plt.axis('off')\r\n    plt.show()\r\n\r\n    names = imagenet.create_readable_names_for_imagenet_labels()\r\n    for i in range(5):\r\n        index = sorted_inds[i]\r\n        print('Probability %0.2f%% => [%s]' % (probabilities[index], names[index]))\r\n```\r\nHowever I am getting the following issue when running this:\r\n```\r\n    logits, _ = inception.inception_v1(processed_images, num_classes=1001, is_training=False)\r\n  File \"/home/deepankar1994/Desktop/MTP/TensorFlowEx/TFSlim/models/slim/nets/inception_v1.py\", line 290, in inception_v1\r\n    net, end_points = inception_v1_base(inputs, scope=scope)\r\n  File \"/home/deepankar1994/Desktop/MTP/TensorFlowEx/TFSlim/models/slim/nets/inception_v1.py\", line 96, in inception_v1_base\r\n    net = tf.concat(3, [branch_0, branch_1, branch_2, branch_3])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py\", line 1053, in concat\r\n    dtype=dtypes.int32).get_shape(\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 651, in convert_to_tensor\r\n    as_ref=False)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py\", line 716, in internal_convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/constant_op.py\", line 176, in _constant_tensor_conversion_function\r\n    return constant(v, dtype=dtype, name=name)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/constant_op.py\", line 165, in constant\r\n    tensor_util.make_tensor_proto(value, dtype=dtype, shape=shape, verify_shape=verify_shape))\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/tensor_util.py\", line 367, in make_tensor_proto\r\n    _AssertCompatible(values, dtype)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/tensor_util.py\", line 302, in _AssertCompatible\r\n    (dtype.name, repr(mismatch), type(mismatch).__name__))\r\nTypeError: Expected int32, got list containing Tensors of type '_Message' instead.\r\n```"}