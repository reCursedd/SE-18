{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/277459732", "html_url": "https://github.com/tensorflow/tensorflow/issues/6611#issuecomment-277459732", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/6611", "id": 277459732, "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzQ1OTczMg==", "user": {"login": "szb0", "id": 12994143, "node_id": "MDQ6VXNlcjEyOTk0MTQz", "avatar_url": "https://avatars3.githubusercontent.com/u/12994143?v=4", "gravatar_id": "", "url": "https://api.github.com/users/szb0", "html_url": "https://github.com/szb0", "followers_url": "https://api.github.com/users/szb0/followers", "following_url": "https://api.github.com/users/szb0/following{/other_user}", "gists_url": "https://api.github.com/users/szb0/gists{/gist_id}", "starred_url": "https://api.github.com/users/szb0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/szb0/subscriptions", "organizations_url": "https://api.github.com/users/szb0/orgs", "repos_url": "https://api.github.com/users/szb0/repos", "events_url": "https://api.github.com/users/szb0/events{/privacy}", "received_events_url": "https://api.github.com/users/szb0/received_events", "type": "User", "site_admin": false}, "created_at": "2017-02-04T17:05:10Z", "updated_at": "2017-02-04T17:05:10Z", "author_association": "NONE", "body_html": "<p>My intuition was from looking at the generate_batch function and seeing when data_index was incremented.</p>\n<p>The first loop increments data_index 2 * skip_window + 1 times.</p>\n<p>The next for loop increments data_index (batch_size // num_skips) times.<br>\nSo I use this to calculate the number of steps (2*skip_window + 1  + (batch_size // num_skips)).</p>\n<p>The formula  len(data) // (batch_size // num_skips) allows the data index to be reset to 0 and we begin training at the beginning of the data again for a few steps.</p>\n<p>With a batch size of 128, and a data_index that has a max of 4251300:</p>\n<p>For the formula len(data) // (batch_size // num_skips):<br>\n('Est. Avg loss at step ', 60000, ': ', 13.664521800994873, ' data index 4020067')<br>\n('Est. Avg loss at step ', 61000, ': ', 12.748281367778779, ' data index 4087067')<br>\n('Est. Avg loss at step ', 62000, ': ', 13.45276182770729, ' data index 4154067')<br>\n('Est. Avg loss at step ', 63000, ': ', 12.419636116027831, ' data index 4221067')<br>\n('Est. Avg loss at step ', 64000, ': ', 12.700695453643799, ' data index 36766')<br>\n('Est. Avg loss at step ', 65000, ': ', 11.144913824081421, ' data index 103766')<br>\n('Est. Avg loss at step ', 66000, ': ', 11.105838320016861, ' data index 170766')</p>\n<p>For the formula (2*skip_window + 1  + (batch_size // num_skips)):<br>\n('Est. Avg loss at step ', 59000, ': ', 13.633916213512421, ' data index 3953067')<br>\n('Est. Avg loss at step ', 60000, ': ', 14.011484805822372, ' data index 4020067')<br>\n('Est. Avg loss at step ', 61000, ': ', 12.926126554250716, ' data index 4087067')<br>\n('Est. Avg loss at step ', 62000, ': ', 13.53601130437851, ' data index 4154067')<br>\n('Est. Avg loss at step ', 63000, ': ', 12.231826926708221, ' data index 4221067')</p>", "body_text": "My intuition was from looking at the generate_batch function and seeing when data_index was incremented.\nThe first loop increments data_index 2 * skip_window + 1 times.\nThe next for loop increments data_index (batch_size // num_skips) times.\nSo I use this to calculate the number of steps (2*skip_window + 1  + (batch_size // num_skips)).\nThe formula  len(data) // (batch_size // num_skips) allows the data index to be reset to 0 and we begin training at the beginning of the data again for a few steps.\nWith a batch size of 128, and a data_index that has a max of 4251300:\nFor the formula len(data) // (batch_size // num_skips):\n('Est. Avg loss at step ', 60000, ': ', 13.664521800994873, ' data index 4020067')\n('Est. Avg loss at step ', 61000, ': ', 12.748281367778779, ' data index 4087067')\n('Est. Avg loss at step ', 62000, ': ', 13.45276182770729, ' data index 4154067')\n('Est. Avg loss at step ', 63000, ': ', 12.419636116027831, ' data index 4221067')\n('Est. Avg loss at step ', 64000, ': ', 12.700695453643799, ' data index 36766')\n('Est. Avg loss at step ', 65000, ': ', 11.144913824081421, ' data index 103766')\n('Est. Avg loss at step ', 66000, ': ', 11.105838320016861, ' data index 170766')\nFor the formula (2*skip_window + 1  + (batch_size // num_skips)):\n('Est. Avg loss at step ', 59000, ': ', 13.633916213512421, ' data index 3953067')\n('Est. Avg loss at step ', 60000, ': ', 14.011484805822372, ' data index 4020067')\n('Est. Avg loss at step ', 61000, ': ', 12.926126554250716, ' data index 4087067')\n('Est. Avg loss at step ', 62000, ': ', 13.53601130437851, ' data index 4154067')\n('Est. Avg loss at step ', 63000, ': ', 12.231826926708221, ' data index 4221067')", "body": "My intuition was from looking at the generate_batch function and seeing when data_index was incremented. \r\n\r\nThe first loop increments data_index 2 * skip_window + 1 times.\r\n\r\nThe next for loop increments data_index (batch_size // num_skips) times.\r\nSo I use this to calculate the number of steps (2*skip_window + 1  + (batch_size // num_skips)).\r\n\r\nThe formula  len(data) // (batch_size // num_skips) allows the data index to be reset to 0 and we begin training at the beginning of the data again for a few steps.\r\n\r\nWith a batch size of 128, and a data_index that has a max of 4251300:\r\n\r\nFor the formula len(data) // (batch_size // num_skips):\r\n('Est. Avg loss at step ', 60000, ': ', 13.664521800994873, ' data index 4020067')\r\n('Est. Avg loss at step ', 61000, ': ', 12.748281367778779, ' data index 4087067')\r\n('Est. Avg loss at step ', 62000, ': ', 13.45276182770729, ' data index 4154067')\r\n('Est. Avg loss at step ', 63000, ': ', 12.419636116027831, ' data index 4221067')\r\n('Est. Avg loss at step ', 64000, ': ', 12.700695453643799, ' data index 36766')\r\n('Est. Avg loss at step ', 65000, ': ', 11.144913824081421, ' data index 103766')\r\n('Est. Avg loss at step ', 66000, ': ', 11.105838320016861, ' data index 170766')\r\n\r\n\r\nFor the formula (2*skip_window + 1  + (batch_size // num_skips)):\r\n('Est. Avg loss at step ', 59000, ': ', 13.633916213512421, ' data index 3953067')\r\n('Est. Avg loss at step ', 60000, ': ', 14.011484805822372, ' data index 4020067')\r\n('Est. Avg loss at step ', 61000, ': ', 12.926126554250716, ' data index 4087067')\r\n('Est. Avg loss at step ', 62000, ': ', 13.53601130437851, ' data index 4154067')\r\n('Est. Avg loss at step ', 63000, ': ', 12.231826926708221, ' data index 4221067')\r\n"}