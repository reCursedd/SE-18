{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19742", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19742/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19742/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/19742/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/19742", "id": 328967518, "node_id": "MDU6SXNzdWUzMjg5Njc1MTg=", "number": 19742, "title": "Attr 'Tshape' not found in Python2 but found in Python3", "user": {"login": "mbartling", "id": 5848519, "node_id": "MDQ6VXNlcjU4NDg1MTk=", "avatar_url": "https://avatars3.githubusercontent.com/u/5848519?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbartling", "html_url": "https://github.com/mbartling", "followers_url": "https://api.github.com/users/mbartling/followers", "following_url": "https://api.github.com/users/mbartling/following{/other_user}", "gists_url": "https://api.github.com/users/mbartling/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbartling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbartling/subscriptions", "organizations_url": "https://api.github.com/users/mbartling/orgs", "repos_url": "https://api.github.com/users/mbartling/repos", "events_url": "https://api.github.com/users/mbartling/events{/privacy}", "received_events_url": "https://api.github.com/users/mbartling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "davidsoergel", "id": 1347381, "node_id": "MDQ6VXNlcjEzNDczODE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1347381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidsoergel", "html_url": "https://github.com/davidsoergel", "followers_url": "https://api.github.com/users/davidsoergel/followers", "following_url": "https://api.github.com/users/davidsoergel/following{/other_user}", "gists_url": "https://api.github.com/users/davidsoergel/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidsoergel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidsoergel/subscriptions", "organizations_url": "https://api.github.com/users/davidsoergel/orgs", "repos_url": "https://api.github.com/users/davidsoergel/repos", "events_url": "https://api.github.com/users/davidsoergel/events{/privacy}", "received_events_url": "https://api.github.com/users/davidsoergel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "davidsoergel", "id": 1347381, "node_id": "MDQ6VXNlcjEzNDczODE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1347381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidsoergel", "html_url": "https://github.com/davidsoergel", "followers_url": "https://api.github.com/users/davidsoergel/followers", "following_url": "https://api.github.com/users/davidsoergel/following{/other_user}", "gists_url": "https://api.github.com/users/davidsoergel/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidsoergel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidsoergel/subscriptions", "organizations_url": "https://api.github.com/users/davidsoergel/orgs", "repos_url": "https://api.github.com/users/davidsoergel/repos", "events_url": "https://api.github.com/users/davidsoergel/events{/privacy}", "received_events_url": "https://api.github.com/users/davidsoergel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-06-04T09:02:35Z", "updated_at": "2018-08-09T00:44:35Z", "closed_at": "2018-08-09T00:44:35Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>Working off extension to mnist demo <a href=\"https://github.com/uTensor/utensor-mnist-demo\">here</a>:</li>\n<li><strong>macOS High Sierra 10.13.4</strong>:</li>\n<li><strong>TensorFlow installed from pip</strong>:</li>\n<li><strong>v1.8.0-0-g93bc2e2072 1.8.0</strong>:</li>\n<li><strong>Python 3.6.4, Python 2.7.14</strong>:</li>\n<li><strong>Exact command to reproduce</strong>:</li>\n</ul>\n<h3>Describe the problem</h3>\n<p>While trying to quantize a frozen TF graph I get the following error in Python2, <em>but not in Python3</em>.</p>\n<pre><code>File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/utensor_cgen/code_generator.py\", line 114, in _transform_graph\n    transforms=[\"quantize_weights\", \"quantize_nodes\"])\n  File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/tensorflow/tools/graph_transforms/__init__.py\", line 51, in TransformGraph\n    transforms_string, status)\n  File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py\", line 519, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.NotFoundError: No attr named 'Tshape' in NodeDef:\n\t [[Node: MatMul_eightbit/x/reshape = Reshape[T=DT_FLOAT](x, MatMul_eightbit/x/reshape_dims)]]\n</code></pre>\n<p>FYI, we have a Cloud9 setup as well but we don't experience this issue there. It seems to be Mac only</p>\n<h3>Source code / logs</h3>\n<p>Here is an example to recreate the issue using a model generated by this script <a href=\"https://github.com/uTensor/utensor-mnist-demo/blob/master/tensorflow-models/deep_mlp.ipynb\">https://github.com/uTensor/utensor-mnist-demo/blob/master/tensorflow-models/deep_mlp.ipynb</a>:</p>\n<pre><code>def _transform_graph(self, pb_file):\n  with tf.gfile.FastGFile(pb_file, 'rb') as fid:\n    graph_def = GraphDef()\n    graph_def.ParseFromString(fid.read())\n    # Fails on the following line\n    quant_graph_def = TransformGraph(input_graph_def=graph_def,\n                                     inputs=[],\n                                     outputs=self.output_nodes,\n                                     transforms=[\"quantize_weights\", \"quantize_nodes\"])\n    temp_file.write(quant_graph_def.SerializeToString())\n</code></pre>", "body_text": "System information\n\nWorking off extension to mnist demo here:\nmacOS High Sierra 10.13.4:\nTensorFlow installed from pip:\nv1.8.0-0-g93bc2e2072 1.8.0:\nPython 3.6.4, Python 2.7.14:\nExact command to reproduce:\n\nDescribe the problem\nWhile trying to quantize a frozen TF graph I get the following error in Python2, but not in Python3.\nFile \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/utensor_cgen/code_generator.py\", line 114, in _transform_graph\n    transforms=[\"quantize_weights\", \"quantize_nodes\"])\n  File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/tensorflow/tools/graph_transforms/__init__.py\", line 51, in TransformGraph\n    transforms_string, status)\n  File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py\", line 519, in __exit__\n    c_api.TF_GetCode(self.status.status))\ntensorflow.python.framework.errors_impl.NotFoundError: No attr named 'Tshape' in NodeDef:\n\t [[Node: MatMul_eightbit/x/reshape = Reshape[T=DT_FLOAT](x, MatMul_eightbit/x/reshape_dims)]]\n\nFYI, we have a Cloud9 setup as well but we don't experience this issue there. It seems to be Mac only\nSource code / logs\nHere is an example to recreate the issue using a model generated by this script https://github.com/uTensor/utensor-mnist-demo/blob/master/tensorflow-models/deep_mlp.ipynb:\ndef _transform_graph(self, pb_file):\n  with tf.gfile.FastGFile(pb_file, 'rb') as fid:\n    graph_def = GraphDef()\n    graph_def.ParseFromString(fid.read())\n    # Fails on the following line\n    quant_graph_def = TransformGraph(input_graph_def=graph_def,\n                                     inputs=[],\n                                     outputs=self.output_nodes,\n                                     transforms=[\"quantize_weights\", \"quantize_nodes\"])\n    temp_file.write(quant_graph_def.SerializeToString())", "body": "\r\n### System information\r\n- Working off extension to mnist demo [here](https://github.com/uTensor/utensor-mnist-demo):\r\n- **macOS High Sierra 10.13.4**:\r\n- **TensorFlow installed from pip**:\r\n- **v1.8.0-0-g93bc2e2072 1.8.0**:\r\n- **Python 3.6.4, Python 2.7.14**: \r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nWhile trying to quantize a frozen TF graph I get the following error in Python2, *but not in Python3*.\r\n\r\n```\r\nFile \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/utensor_cgen/code_generator.py\", line 114, in _transform_graph\r\n    transforms=[\"quantize_weights\", \"quantize_nodes\"])\r\n  File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/tensorflow/tools/graph_transforms/__init__.py\", line 51, in TransformGraph\r\n    transforms_string, status)\r\n  File \"/Users/micbar02/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py\", line 519, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.NotFoundError: No attr named 'Tshape' in NodeDef:\r\n\t [[Node: MatMul_eightbit/x/reshape = Reshape[T=DT_FLOAT](x, MatMul_eightbit/x/reshape_dims)]]\r\n```\r\n\r\nFYI, we have a Cloud9 setup as well but we don't experience this issue there. It seems to be Mac only\r\n\r\n### Source code / logs\r\nHere is an example to recreate the issue using a model generated by this script https://github.com/uTensor/utensor-mnist-demo/blob/master/tensorflow-models/deep_mlp.ipynb:\r\n\r\n```\r\ndef _transform_graph(self, pb_file):\r\n  with tf.gfile.FastGFile(pb_file, 'rb') as fid:\r\n    graph_def = GraphDef()\r\n    graph_def.ParseFromString(fid.read())\r\n    # Fails on the following line\r\n    quant_graph_def = TransformGraph(input_graph_def=graph_def,\r\n                                     inputs=[],\r\n                                     outputs=self.output_nodes,\r\n                                     transforms=[\"quantize_weights\", \"quantize_nodes\"])\r\n    temp_file.write(quant_graph_def.SerializeToString())\r\n```\r\n"}