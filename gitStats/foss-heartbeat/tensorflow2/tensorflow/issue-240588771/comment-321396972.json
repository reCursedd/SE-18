{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/321396972", "html_url": "https://github.com/tensorflow/tensorflow/issues/11290#issuecomment-321396972", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11290", "id": 321396972, "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTM5Njk3Mg==", "user": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "created_at": "2017-08-09T22:18:28Z", "updated_at": "2017-08-09T22:34:07Z", "author_association": "MEMBER", "body_html": "<p><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=15676913\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/poxvoculi\">@poxvoculi</a> : I'm not entirely sure about the history behind this as it predates my involvement in the project. Perhaps <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/hovercards?user_id=7943790\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zffchen78\">@zffchen78</a> has some historical knowledge?</p>\n<p>But looking at the code, when we write out a tensor to disk (see <a href=\"https://github.com/tensorflow/tensorflow/blob/r1.3/tensorflow/core/util/tensor_bundle/tensor_bundle.cc#L138\"><code>tensor_bundle.cc</code></a>), it seems we're dumping the raw contents of the <code>TensorBuffer</code>, which will be in the endianness of the architecture it was on. Even when we dump to a proto (<a href=\"https://github.com/tensorflow/tensorflow/blob/r1.3/tensorflow/core/framework/tensor.cc#L727\"><code>Tensor::AsProtoTensorContent</code></a>), the <a href=\"https://github.com/tensorflow/tensorflow/blob/r1.3/tensorflow/core/framework/tensor.cc#L122\">memory buffer is being used as-is</a>). And in neither do we make a note of the endianness of the host when writing it out.</p>\n<p>It doesn't look like we use the endian-safe routines in <code>coding.cc</code> for tensor content.</p>", "body_text": "@poxvoculi : I'm not entirely sure about the history behind this as it predates my involvement in the project. Perhaps @zffchen78 has some historical knowledge?\nBut looking at the code, when we write out a tensor to disk (see tensor_bundle.cc), it seems we're dumping the raw contents of the TensorBuffer, which will be in the endianness of the architecture it was on. Even when we dump to a proto (Tensor::AsProtoTensorContent), the memory buffer is being used as-is). And in neither do we make a note of the endianness of the host when writing it out.\nIt doesn't look like we use the endian-safe routines in coding.cc for tensor content.", "body": "@poxvoculi : I'm not entirely sure about the history behind this as it predates my involvement in the project. Perhaps @zffchen78 has some historical knowledge?\r\n\r\nBut looking at the code, when we write out a tensor to disk (see [`tensor_bundle.cc`](https://github.com/tensorflow/tensorflow/blob/r1.3/tensorflow/core/util/tensor_bundle/tensor_bundle.cc#L138)), it seems we're dumping the raw contents of the `TensorBuffer`, which will be in the endianness of the architecture it was on. Even when we dump to a proto ([`Tensor::AsProtoTensorContent`](https://github.com/tensorflow/tensorflow/blob/r1.3/tensorflow/core/framework/tensor.cc#L727)), the [memory buffer is being used as-is](https://github.com/tensorflow/tensorflow/blob/r1.3/tensorflow/core/framework/tensor.cc#L122)). And in neither do we make a note of the endianness of the host when writing it out.\r\n\r\nIt doesn't look like we use the endian-safe routines in `coding.cc` for tensor content."}