{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/55941790", "pull_request_review_id": null, "id": 55941790, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTQxNzkw", "diff_hunk": "@@ -125,27 +136,46 @@ echo \"whl file path = ${WHL_PATH}\"\n # Install, in user's local home folder\n echo \"Installing pip whl file: ${WHL_PATH}\"\n \n-# Create temporary directory for install test\n+# Create virtualenv directory for install test\n VENV_DIR=\"${PIP_TEST_ROOT}/venv\"\n-rm -rf \"${VENV_DIR}\" && mkdir -p \"${VENV_DIR}\"\n-echo \"Create directory for virtualenv: ${VENV_DIR}\"\n+if [[ -d \"${VENV_DIR}\" ]] &&\n+   [[ ! -z \"${TF_BUILD_NO_CACHING_VIRTUALENV}\" ]] &&\n+   [[ \"${TF_BUILD_NO_CACHING_VIRTUALENV}\" != \"0\" ]]; then\n+  echo \"TF_BUILD_NO_CACHING_VIRTUALENV=${TF_BUILD_NO_CACHING_VIRTUALENV}:\"\n+  echo \"Removing existing virtualenv directory: ${VENV_DIR}\"\n+\n+  rm -rf \"${VENV_DIR}\" || \\\n+      die \"Failed to remove existing virtualenv directory: ${VENV_DIR}\"\n+fi", "path": "tensorflow/tools/ci_build/builds/pip.sh", "position": 57, "original_position": 57, "commit_id": "3b49611933c109b6f589e19ab5827aa586587318", "original_commit_id": "3b49611933c109b6f589e19ab5827aa586587318", "user": {"login": "jendap", "id": 567848, "node_id": "MDQ6VXNlcjU2Nzg0OA==", "avatar_url": "https://avatars0.githubusercontent.com/u/567848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jendap", "html_url": "https://github.com/jendap", "followers_url": "https://api.github.com/users/jendap/followers", "following_url": "https://api.github.com/users/jendap/following{/other_user}", "gists_url": "https://api.github.com/users/jendap/gists{/gist_id}", "starred_url": "https://api.github.com/users/jendap/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jendap/subscriptions", "organizations_url": "https://api.github.com/users/jendap/orgs", "repos_url": "https://api.github.com/users/jendap/repos", "events_url": "https://api.github.com/users/jendap/events{/privacy}", "received_events_url": "https://api.github.com/users/jendap/received_events", "type": "User", "site_admin": false}, "body": "Ok, this style is here on multiple places. But for next time... why not simple remove all these features. The scripts can be considerably simpler by removing all this. And one still have it all. Look...\n\n``` bash\nexport TF_BUILD_NO_CACHING_VIRTUALENV=1\ntensorflow/tools/ci_build/builds/pip.sh CPU\n```\n\nvs\n\n``` bash\nrm -rf pip_test/venv\ntensorflow/tools/ci_build/builds/pip.sh CPU\n```\n\nIt is shorter even outside of he script and you have one less api feature (TF_BUILD_NO_CACHING_VIRTUALENV) to support. 10+ lines of script less.\n", "created_at": "2016-03-13T18:52:41Z", "updated_at": "2016-03-13T18:52:41Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/1472#discussion_r55941790", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1472", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/55941790"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/1472#discussion_r55941790"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/1472"}}, "body_html": "<p>Ok, this style is here on multiple places. But for next time... why not simple remove all these features. The scripts can be considerably simpler by removing all this. And one still have it all. Look...</p>\n<div class=\"highlight highlight-source-shell\"><pre><span class=\"pl-k\">export</span> TF_BUILD_NO_CACHING_VIRTUALENV=1\ntensorflow/tools/ci_build/builds/pip.sh CPU</pre></div>\n<p>vs</p>\n<div class=\"highlight highlight-source-shell\"><pre>rm -rf pip_test/venv\ntensorflow/tools/ci_build/builds/pip.sh CPU</pre></div>\n<p>It is shorter even outside of he script and you have one less api feature (TF_BUILD_NO_CACHING_VIRTUALENV) to support. 10+ lines of script less.</p>", "body_text": "Ok, this style is here on multiple places. But for next time... why not simple remove all these features. The scripts can be considerably simpler by removing all this. And one still have it all. Look...\nexport TF_BUILD_NO_CACHING_VIRTUALENV=1\ntensorflow/tools/ci_build/builds/pip.sh CPU\nvs\nrm -rf pip_test/venv\ntensorflow/tools/ci_build/builds/pip.sh CPU\nIt is shorter even outside of he script and you have one less api feature (TF_BUILD_NO_CACHING_VIRTUALENV) to support. 10+ lines of script less."}