{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4172", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4172/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4172/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/4172/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/4172", "id": 174711005, "node_id": "MDU6SXNzdWUxNzQ3MTEwMDU=", "number": 4172, "title": "Missing files and flag for building linkable archives with `make` on Linux (Ubuntu)", "user": {"login": "ic", "id": 64160, "node_id": "MDQ6VXNlcjY0MTYw", "avatar_url": "https://avatars3.githubusercontent.com/u/64160?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ic", "html_url": "https://github.com/ic", "followers_url": "https://api.github.com/users/ic/followers", "following_url": "https://api.github.com/users/ic/following{/other_user}", "gists_url": "https://api.github.com/users/ic/gists{/gist_id}", "starred_url": "https://api.github.com/users/ic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ic/subscriptions", "organizations_url": "https://api.github.com/users/ic/orgs", "repos_url": "https://api.github.com/users/ic/repos", "events_url": "https://api.github.com/users/ic/events{/privacy}", "received_events_url": "https://api.github.com/users/ic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-09-02T08:51:51Z", "updated_at": "2016-09-28T20:22:22Z", "closed_at": "2016-09-28T20:22:22Z", "author_association": "CONTRIBUTOR", "body_html": "<p>Trying to build under Linux, I have faced two issues, one for PIC missing, and one for a missing file in the source build list.</p>\n<p>I guess the origin of the problem is the <code>Makefile</code> depends on Bazel's build, and changes may be missing.</p>\n<p>How does this looks for you? Here is a temporary <a href=\"https://github.com/tensorflow/tensorflow/compare/master...ic:master\">patch</a>.</p>\n<h3>What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?</h3>\n<h3>Environment info</h3>\n<p>Operating System: Linux 16_04</p>\n<p>Installed version of CUDA and cuDNN: None</p>\n<p>If installed from source, provide</p>\n<ol>\n<li>The commit hash (<code>git rev-parse HEAD</code>): <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/tensorflow/tensorflow/commit/461caa86137aee3d2e40843ea308c216f10c4655/hovercard\" href=\"https://github.com/tensorflow/tensorflow/commit/461caa86137aee3d2e40843ea308c216f10c4655\"><tt>461caa8</tt></a></li>\n<li>The output of <code>bazel version</code>: It does not apply here (using <code>make</code> from the <code>tensor flow/contrib/makefile</code> project.</li>\n</ol>\n<h3>If possible, provide a minimal reproducible example:</h3>\n<pre><code>cd TF_HOME\n./tensorflow/contrib/makefile/download_dependencies.sh\ncd tensorflow/contrib/makefile/downloads/protobuf\nmake &amp;&amp; make check &amp;&amp; sudo make install &amp;&amp; sudo ldconfig\ncd -\nmake -f tensorflow/contrib/makefile/Makefile\n\n# Long build\n# Leading to error when building `benchmark`\n</code></pre>\n<h3>What other attempted solutions have you tried?</h3>\n<p>I have tried to build on Ubuntu 14_04 and Mac OS X (10.10). It worked only on Mac OS X. Then I realized that the build chokes on my Linux boxes for PIC, and then for a missing file. Adding them (see a <a href=\"https://github.com/tensorflow/tensorflow/compare/master...ic:master\">solution here</a>) fixes all.</p>\n<h3>Logs or other output that would be helpful</h3>\n<p>(If logs are large, please upload as attachment or provide link).</p>\n<p>The build fails with (added breaks for readability):</p>\n<pre><code>gcc --std=c++11 -DIS_SLIM_BUILD -O0 -fPIC -I. \n-I./tensorflow/contrib/makefile/downloads/ \n-I./tensorflow/contrib/makefile/downloads/eigen-eigen-9e1b48c333aa \n-I./tensorflow/contrib/makefile/gen/proto/ \n-I./tensorflow/contrib/makefile/gen/proto_text/ -I/usr/local/include \n-o ./tensorflow/contrib/makefile/gen/bin/benchmark\n./tensorflow/contrib/makefile/gen/obj/tensorflow/core/util/reporter.o\n./tensorflow/contrib/makefile/gen/obj/tensorflow/tools/benchmark/benchmark_model.o\n./tensorflow/contrib/makefile/gen/obj/tensorflow/tools/benchmark/benchmark_model_main.o -Wl,--allow-multiple-definition -Wl,--whole-archive ./tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a -L/usr/local/lib -lstdc++ -lprotobuf -lz -lm -ldl -lpthread\n./tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a(conv_ops.o): In function `tensorflow::LaunchDeepConvOp&lt;Eigen::ThreadPoolDevice, float&gt;::Run(tensorflow::OpKernelContext*, tensorflow::Tensor const&amp;, tensorflow::Tensor const&amp;, int, int, int, int, int, int, int, int, int, int, int, int, int, tensorflow::Tensor*, tensorflow::TensorFormat)':\nconv_ops.cc:\n(.text._ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE[_ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE]+0x70): \nundefined reference to `tensorflow::CanUseDeepConv2D(int, int, int, int, int, int, int, int)'\nconv_ops.cc:\n(.text._ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE[_ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE]+0x184): \nundefined reference to `tensorflow::functor::DeepConv2D&lt;Eigen::ThreadPoolDevice, float&gt;::operator()(tensorflow::OpKernelContext*, tensorflow::Conv2DArgs const&amp;, float const*, float const*, float*)'\ncollect2: error: ld returned 1 exit status\n</code></pre>", "body_text": "Trying to build under Linux, I have faced two issues, one for PIC missing, and one for a missing file in the source build list.\nI guess the origin of the problem is the Makefile depends on Bazel's build, and changes may be missing.\nHow does this looks for you? Here is a temporary patch.\nWhat related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\nEnvironment info\nOperating System: Linux 16_04\nInstalled version of CUDA and cuDNN: None\nIf installed from source, provide\n\nThe commit hash (git rev-parse HEAD): 461caa8\nThe output of bazel version: It does not apply here (using make from the tensor flow/contrib/makefile project.\n\nIf possible, provide a minimal reproducible example:\ncd TF_HOME\n./tensorflow/contrib/makefile/download_dependencies.sh\ncd tensorflow/contrib/makefile/downloads/protobuf\nmake && make check && sudo make install && sudo ldconfig\ncd -\nmake -f tensorflow/contrib/makefile/Makefile\n\n# Long build\n# Leading to error when building `benchmark`\n\nWhat other attempted solutions have you tried?\nI have tried to build on Ubuntu 14_04 and Mac OS X (10.10). It worked only on Mac OS X. Then I realized that the build chokes on my Linux boxes for PIC, and then for a missing file. Adding them (see a solution here) fixes all.\nLogs or other output that would be helpful\n(If logs are large, please upload as attachment or provide link).\nThe build fails with (added breaks for readability):\ngcc --std=c++11 -DIS_SLIM_BUILD -O0 -fPIC -I. \n-I./tensorflow/contrib/makefile/downloads/ \n-I./tensorflow/contrib/makefile/downloads/eigen-eigen-9e1b48c333aa \n-I./tensorflow/contrib/makefile/gen/proto/ \n-I./tensorflow/contrib/makefile/gen/proto_text/ -I/usr/local/include \n-o ./tensorflow/contrib/makefile/gen/bin/benchmark\n./tensorflow/contrib/makefile/gen/obj/tensorflow/core/util/reporter.o\n./tensorflow/contrib/makefile/gen/obj/tensorflow/tools/benchmark/benchmark_model.o\n./tensorflow/contrib/makefile/gen/obj/tensorflow/tools/benchmark/benchmark_model_main.o -Wl,--allow-multiple-definition -Wl,--whole-archive ./tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a -L/usr/local/lib -lstdc++ -lprotobuf -lz -lm -ldl -lpthread\n./tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a(conv_ops.o): In function `tensorflow::LaunchDeepConvOp<Eigen::ThreadPoolDevice, float>::Run(tensorflow::OpKernelContext*, tensorflow::Tensor const&, tensorflow::Tensor const&, int, int, int, int, int, int, int, int, int, int, int, int, int, tensorflow::Tensor*, tensorflow::TensorFormat)':\nconv_ops.cc:\n(.text._ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE[_ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE]+0x70): \nundefined reference to `tensorflow::CanUseDeepConv2D(int, int, int, int, int, int, int, int)'\nconv_ops.cc:\n(.text._ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE[_ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE]+0x184): \nundefined reference to `tensorflow::functor::DeepConv2D<Eigen::ThreadPoolDevice, float>::operator()(tensorflow::OpKernelContext*, tensorflow::Conv2DArgs const&, float const*, float const*, float*)'\ncollect2: error: ld returned 1 exit status", "body": "Trying to build under Linux, I have faced two issues, one for PIC missing, and one for a missing file in the source build list.\n\nI guess the origin of the problem is the `Makefile` depends on Bazel's build, and changes may be missing.\n\nHow does this looks for you? Here is a temporary [patch](https://github.com/tensorflow/tensorflow/compare/master...ic:master).\n### What related GitHub issues or StackOverflow threads have you found by searching the web for your problem?\n### Environment info\n\nOperating System: Linux 16_04\n\nInstalled version of CUDA and cuDNN: None\n\nIf installed from source, provide \n1. The commit hash (`git rev-parse HEAD`): 461caa86137aee3d2e40843ea308c216f10c4655\n2. The output of `bazel version`: It does not apply here (using `make` from the `tensor flow/contrib/makefile` project.\n### If possible, provide a minimal reproducible example:\n\n```\ncd TF_HOME\n./tensorflow/contrib/makefile/download_dependencies.sh\ncd tensorflow/contrib/makefile/downloads/protobuf\nmake && make check && sudo make install && sudo ldconfig\ncd -\nmake -f tensorflow/contrib/makefile/Makefile\n\n# Long build\n# Leading to error when building `benchmark`\n```\n### What other attempted solutions have you tried?\n\nI have tried to build on Ubuntu 14_04 and Mac OS X (10.10). It worked only on Mac OS X. Then I realized that the build chokes on my Linux boxes for PIC, and then for a missing file. Adding them (see a [solution here](https://github.com/tensorflow/tensorflow/compare/master...ic:master)) fixes all.\n### Logs or other output that would be helpful\n\n(If logs are large, please upload as attachment or provide link).\n\nThe build fails with (added breaks for readability):\n\n```\ngcc --std=c++11 -DIS_SLIM_BUILD -O0 -fPIC -I. \n-I./tensorflow/contrib/makefile/downloads/ \n-I./tensorflow/contrib/makefile/downloads/eigen-eigen-9e1b48c333aa \n-I./tensorflow/contrib/makefile/gen/proto/ \n-I./tensorflow/contrib/makefile/gen/proto_text/ -I/usr/local/include \n-o ./tensorflow/contrib/makefile/gen/bin/benchmark\n./tensorflow/contrib/makefile/gen/obj/tensorflow/core/util/reporter.o\n./tensorflow/contrib/makefile/gen/obj/tensorflow/tools/benchmark/benchmark_model.o\n./tensorflow/contrib/makefile/gen/obj/tensorflow/tools/benchmark/benchmark_model_main.o -Wl,--allow-multiple-definition -Wl,--whole-archive ./tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a -L/usr/local/lib -lstdc++ -lprotobuf -lz -lm -ldl -lpthread\n./tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a(conv_ops.o): In function `tensorflow::LaunchDeepConvOp<Eigen::ThreadPoolDevice, float>::Run(tensorflow::OpKernelContext*, tensorflow::Tensor const&, tensorflow::Tensor const&, int, int, int, int, int, int, int, int, int, int, int, int, int, tensorflow::Tensor*, tensorflow::TensorFormat)':\nconv_ops.cc:\n(.text._ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE[_ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE]+0x70): \nundefined reference to `tensorflow::CanUseDeepConv2D(int, int, int, int, int, int, int, int)'\nconv_ops.cc:\n(.text._ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE[_ZN10tensorflow16LaunchDeepConvOpIN5Eigen16ThreadPoolDeviceEfE3RunEPNS_15OpKernelContextERKNS_6TensorES8_iiiiiiiiiiiiiPS6_NS_12TensorFormatE]+0x184): \nundefined reference to `tensorflow::functor::DeepConv2D<Eigen::ThreadPoolDevice, float>::operator()(tensorflow::OpKernelContext*, tensorflow::Conv2DArgs const&, float const*, float const*, float*)'\ncollect2: error: ld returned 1 exit status\n```\n"}