{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11713", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11713/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11713/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/11713/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/11713", "id": 245029567, "node_id": "MDU6SXNzdWUyNDUwMjk1Njc=", "number": 11713, "title": "decode_csv is extremely slow", "user": {"login": "sgirkin", "id": 560049, "node_id": "MDQ6VXNlcjU2MDA0OQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/560049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sgirkin", "html_url": "https://github.com/sgirkin", "followers_url": "https://api.github.com/users/sgirkin/followers", "following_url": "https://api.github.com/users/sgirkin/following{/other_user}", "gists_url": "https://api.github.com/users/sgirkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/sgirkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sgirkin/subscriptions", "organizations_url": "https://api.github.com/users/sgirkin/orgs", "repos_url": "https://api.github.com/users/sgirkin/repos", "events_url": "https://api.github.com/users/sgirkin/events{/privacy}", "received_events_url": "https://api.github.com/users/sgirkin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-07-24T09:59:46Z", "updated_at": "2018-06-03T18:46:44Z", "closed_at": "2018-06-03T18:46:44Z", "author_association": "NONE", "body_html": "<h3>System information</h3>\n<ul>\n<li>\n<p><strong>OS Platform and Distribution (e.g., Linux Ubuntu 16.04)</strong>:<br>\nI tested on both MacOS 10, Centos 7, <a href=\"https://pastebin.com/LsADQ89s\" rel=\"nofollow\">https://pastebin.com/LsADQ89s</a></p>\n</li>\n<li>\n<p><strong>TensorFlow installed from (source or binary)</strong>:<br>\nTensorflow 1.2.1, also tried with tensorflow compiled from sources</p>\n</li>\n<li>\n<p><strong>TensorFlow version (use command below)</strong>:<br>\n('v1.2.0-5-g435cdfc', '1.2.1'), also compiled and tested from master</p>\n</li>\n<li>\n<p><strong>Python version</strong>:<br>\n2.7.13</p>\n</li>\n<li>\n<p><strong>CUDA/cuDNN version</strong>:<br>\nno</p>\n</li>\n<li>\n<p><strong>GPU model and memory</strong>:<br>\nno</p>\n</li>\n<li>\n<p><strong>Exact command to reproduce</strong>:<br>\nsee above</p>\n</li>\n</ul>\n<h3>The problem</h3>\n<p>I noticed that a huge amount of training time CPU is idle. I isolated the problem to the code snippet bellow, where I create a string tensor using tf.constant with N rows each of them contains comma separated list of randomly generated numberical values, then I decode these string tensor to rank2 tensor of floats using 3 different approaches.</p>\n<p>I discovered following:<br>\ndecoding tfrecords with <em>tf.parse_example</em> is quite fast<br>\ndecoding csv with <em>decode_csv</em> is ~20 (4 cores) 60 (16 cores) times slower than parse_example and it utilises only 1 core on my machine<br>\ndecoding csv with <em>tf.string_split</em> + <em>tf.string_to_number()</em> is ~20-60 times slower than parse_example.<br>\nIt seems <em>tf.string_to_number()</em> makes it slow, if I comment out the line with <em>tf.string_to_number</em> it is 2-3 times slower than parse example</p>\n<p>The code I used for that:<br>\n<a href=\"https://pastebin.com/ZR152y5M\" rel=\"nofollow\">https://pastebin.com/ZR152y5M</a></p>\n<h3>Source code / logs</h3>\n<p>Running parse_example<br>\nTotal time: 2.01925897598</p>\n<p>Running string_split<br>\nTotal time: 5.52524709702</p>\n<p>Running decode_csv<br>\nTotal time: 22.6595089436</p>", "body_text": "System information\n\n\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):\nI tested on both MacOS 10, Centos 7, https://pastebin.com/LsADQ89s\n\n\nTensorFlow installed from (source or binary):\nTensorflow 1.2.1, also tried with tensorflow compiled from sources\n\n\nTensorFlow version (use command below):\n('v1.2.0-5-g435cdfc', '1.2.1'), also compiled and tested from master\n\n\nPython version:\n2.7.13\n\n\nCUDA/cuDNN version:\nno\n\n\nGPU model and memory:\nno\n\n\nExact command to reproduce:\nsee above\n\n\nThe problem\nI noticed that a huge amount of training time CPU is idle. I isolated the problem to the code snippet bellow, where I create a string tensor using tf.constant with N rows each of them contains comma separated list of randomly generated numberical values, then I decode these string tensor to rank2 tensor of floats using 3 different approaches.\nI discovered following:\ndecoding tfrecords with tf.parse_example is quite fast\ndecoding csv with decode_csv is ~20 (4 cores) 60 (16 cores) times slower than parse_example and it utilises only 1 core on my machine\ndecoding csv with tf.string_split + tf.string_to_number() is ~20-60 times slower than parse_example.\nIt seems tf.string_to_number() makes it slow, if I comment out the line with tf.string_to_number it is 2-3 times slower than parse example\nThe code I used for that:\nhttps://pastebin.com/ZR152y5M\nSource code / logs\nRunning parse_example\nTotal time: 2.01925897598\nRunning string_split\nTotal time: 5.52524709702\nRunning decode_csv\nTotal time: 22.6595089436", "body": "### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nI tested on both MacOS 10, Centos 7, https://pastebin.com/LsADQ89s\r\n\r\n- **TensorFlow installed from (source or binary)**:\r\nTensorflow 1.2.1, also tried with tensorflow compiled from sources\r\n\r\n- **TensorFlow version (use command below)**:\r\n('v1.2.0-5-g435cdfc', '1.2.1'), also compiled and tested from master\r\n\r\n- **Python version**: \r\n2.7.13\r\n\r\n- **CUDA/cuDNN version**:\r\nno\r\n\r\n- **GPU model and memory**:\r\nno\r\n\r\n- **Exact command to reproduce**:\r\nsee above\r\n\r\n### The problem\r\nI noticed that a huge amount of training time CPU is idle. I isolated the problem to the code snippet bellow, where I create a string tensor using tf.constant with N rows each of them contains comma separated list of randomly generated numberical values, then I decode these string tensor to rank2 tensor of floats using 3 different approaches. \r\n\r\n\r\nI discovered following:\r\ndecoding tfrecords with *tf.parse_example* is quite fast\r\ndecoding csv with *decode_csv* is ~20 (4 cores) 60 (16 cores) times slower than parse_example and it utilises only 1 core on my machine\r\ndecoding csv with *tf.string_split* + *tf.string_to_number()* is ~20-60 times slower than parse_example. \r\nIt seems *tf.string_to_number()* makes it slow, if I comment out the line with *tf.string_to_number* it is 2-3 times slower than parse example\r\n\r\n\r\n\r\n\r\nThe code I used for that:\r\nhttps://pastebin.com/ZR152y5M\r\n\r\n\r\n\r\n### Source code / logs\r\nRunning parse_example\r\nTotal time: 2.01925897598\r\n\r\nRunning string_split\r\nTotal time: 5.52524709702\r\n\r\nRunning decode_csv\r\nTotal time: 22.6595089436\r\n\r\n"}