{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/comments/438179301", "html_url": "https://github.com/tensorflow/tensorflow/issues/23655#issuecomment-438179301", "issue_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/23655", "id": 438179301, "node_id": "MDEyOklzc3VlQ29tbWVudDQzODE3OTMwMQ==", "user": {"login": "cielavenir", "id": 1495368, "node_id": "MDQ6VXNlcjE0OTUzNjg=", "avatar_url": "https://avatars3.githubusercontent.com/u/1495368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cielavenir", "html_url": "https://github.com/cielavenir", "followers_url": "https://api.github.com/users/cielavenir/followers", "following_url": "https://api.github.com/users/cielavenir/following{/other_user}", "gists_url": "https://api.github.com/users/cielavenir/gists{/gist_id}", "starred_url": "https://api.github.com/users/cielavenir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cielavenir/subscriptions", "organizations_url": "https://api.github.com/users/cielavenir/orgs", "repos_url": "https://api.github.com/users/cielavenir/repos", "events_url": "https://api.github.com/users/cielavenir/events{/privacy}", "received_events_url": "https://api.github.com/users/cielavenir/received_events", "type": "User", "site_admin": false}, "created_at": "2018-11-13T08:30:37Z", "updated_at": "2018-11-13T08:30:37Z", "author_association": "NONE", "body_html": "<p>Materials (rev1) are in <a href=\"https://gist.github.com/cielavenir/4b55dce31bbf93f5fee5c5b2bfbebfda\">https://gist.github.com/cielavenir/4b55dce31bbf93f5fee5c5b2bfbebfda</a>.</p>\n<p>The main thing win.patch consists of two parts.</p>\n<p>The first is ICU. I needed to add U_STATIC_IMPLEMENTATION flag to link to original symbols, not <code>__imp_</code>. This had to be added also to third_party/icu/BUILD.bazel because udata.cpp tries to link __imp_icudt62_dat, which also we don't want.</p>\n<p>The second is disabling framework_shared_object. I came up with because <code>tensorflow_framework</code> [^1] should be from <code>-ltensorflow_framework</code> or <code>libtensorflow_framework.so</code>. I knew this disabling is a workaround. To understand why disabling this makes the build successful is the next step.</p>\n<p>[^1]: <code>link.exe /nologo /OUT:bazel-out/host/bin/tensorflow/cc/ops/sparse_ops_gen_cc.exe tensorflow_framework /SUBSYSTEM:CONSOLE</code> # this tensorflow_framework is orphaned bad guy.</p>", "body_text": "Materials (rev1) are in https://gist.github.com/cielavenir/4b55dce31bbf93f5fee5c5b2bfbebfda.\nThe main thing win.patch consists of two parts.\nThe first is ICU. I needed to add U_STATIC_IMPLEMENTATION flag to link to original symbols, not __imp_. This had to be added also to third_party/icu/BUILD.bazel because udata.cpp tries to link __imp_icudt62_dat, which also we don't want.\nThe second is disabling framework_shared_object. I came up with because tensorflow_framework [^1] should be from -ltensorflow_framework or libtensorflow_framework.so. I knew this disabling is a workaround. To understand why disabling this makes the build successful is the next step.\n[^1]: link.exe /nologo /OUT:bazel-out/host/bin/tensorflow/cc/ops/sparse_ops_gen_cc.exe tensorflow_framework /SUBSYSTEM:CONSOLE # this tensorflow_framework is orphaned bad guy.", "body": "Materials (rev1) are in https://gist.github.com/cielavenir/4b55dce31bbf93f5fee5c5b2bfbebfda.\r\n\r\nThe main thing win.patch consists of two parts.\r\n\r\nThe first is ICU. I needed to add U_STATIC_IMPLEMENTATION flag to link to original symbols, not `__imp_`. This had to be added also to third_party/icu/BUILD.bazel because udata.cpp tries to link __imp_icudt62_dat, which also we don't want.\r\n\r\nThe second is disabling framework_shared_object. I came up with because `tensorflow_framework` [^1] should be from `-ltensorflow_framework` or `libtensorflow_framework.so`. I knew this disabling is a workaround. To understand why disabling this makes the build successful is the next step.\r\n\r\n[^1]: `link.exe /nologo /OUT:bazel-out/host/bin/tensorflow/cc/ops/sparse_ops_gen_cc.exe tensorflow_framework /SUBSYSTEM:CONSOLE` # this tensorflow_framework is orphaned bad guy."}